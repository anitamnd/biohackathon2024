<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7493373</article-id>
    <article-id pub-id-type="publisher-id">3628</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-020-03628-w</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Metagenomic analysis through the extended Burrows-Wheeler transform</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Guerrini</surname>
          <given-names>Veronica</given-names>
        </name>
        <address>
          <email>veronica.guerrini@di.unipi.it</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Louza</surname>
          <given-names>Felipe A.</given-names>
        </name>
        <address>
          <email>louza@ufu.br</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-5075-1214</contrib-id>
        <name>
          <surname>Rosone</surname>
          <given-names>Giovanna</given-names>
        </name>
        <address>
          <email>giovanna.rosone@unipi.it</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.5395.a</institution-id><institution-id institution-id-type="ISNI">0000 0004 1757 3729</institution-id><institution>Dipartimento di Informatica, </institution><institution>Università di Pisa, </institution></institution-wrap>Largo B. Pontecorvo, 3, Pisa, Italy </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.411284.a</institution-id><institution-id institution-id-type="ISNI">0000 0004 4647 6936</institution-id><institution>Faculty of Electrical Engineering, Federal University of Uberlândia, </institution></institution-wrap>Uberlândia, Brazil </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>16</day>
      <month>9</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>16</day>
      <month>9</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2020</year>
    </pub-date>
    <volume>21</volume>
    <issue>Suppl 8</issue>
    <issue-sponsor>Publication of this supplement has not been supported by sponsorship. Information about the source of funding for publication charges can be found in the individual articles. The articles have undergone the journal's standard peer review process for supplements. The Supplement Editors declare that they have no competing interests.</issue-sponsor>
    <elocation-id>299</elocation-id>
    <history>
      <date date-type="received">
        <day>16</day>
        <month>6</month>
        <year>2020</year>
      </date>
      <date date-type="accepted">
        <day>22</day>
        <month>6</month>
        <year>2020</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2020</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article’s Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article’s Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">The development of Next Generation Sequencing (NGS) has had a major impact on the study of genetic sequences. Among problems that researchers in the field have to face, one of the most challenging is the taxonomic classification of metagenomic reads, i.e., identifying the microorganisms that are present in a sample collected directly from the environment. The analysis of environmental samples (metagenomes) are particularly important to figure out the microbial composition of different ecosystems and it is used in a wide variety of fields: for instance, metagenomic studies in agriculture can help understanding the interactions between plants and microbes, or in ecology, they can provide valuable insights into the functions of environmental communities.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">In this paper, we describe a new lightweight alignment-free and assembly-free framework for metagenomic classification that compares each unknown sequence in the sample to a collection of known genomes. We take advantage of the combinatorial properties of an extension of the Burrows-Wheeler transform, and we sequentially scan the required data structures, so that we can analyze unknown sequences of large collections using little internal memory. The tool LiME (Lightweight Metagenomics via eBWT) is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/veronicaguerrini/LiME">https://github.com/veronicaguerrini/LiME</ext-link>.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p id="Par3">In order to assess the reliability of our approach, we run several experiments on NGS data from two simulated metagenomes among those provided in benchmarking analysis and on a real metagenome from the Human Microbiome Project. The experiment results on the simulated data show that LiME is competitive with the widely used taxonomic classifiers. It achieves high levels of precision and specificity – e.g. 99.9<italic>%</italic> of the positive control reads are correctly assigned and the percentage of classified reads of the negative control is less than 0.01<italic>%</italic> – while keeping a high sensitivity. On the real metagenome, we show that LiME is able to deliver classification results comparable to that of MagicBlast. Overall, the experiments confirm the effectiveness of our method and its high accuracy even in negative control samples.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Metagenomics</kwd>
      <kwd>Next-generation sequencing</kwd>
      <kwd>Classification</kwd>
      <kwd>Alignment-free</kwd>
      <kwd>Assembly-free</kwd>
      <kwd>eBWT</kwd>
      <kwd>LCP Array</kwd>
    </kwd-group>
    <conference xlink:href="http://bioinformatics.it/">
      <conf-name>Annual Meeting of the Bioinformatics Italian Society (BITS 2019)</conf-name>
      <conf-acronym>BITS 2019</conf-acronym>
      <conf-loc>Palermo, Italy</conf-loc>
      <conf-date>26-28 June 2019</conf-date>
    </conference>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2020</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p>Interest in metagenomics has been sparked by the recent advances in “next-generation” DNA sequencing (NGS) technologies [<xref ref-type="bibr" rid="CR1">1</xref>]. Metagenomics refers to the sequencing of microbial DNA collected directly from the environment, without isolation and lab cultivation of individual species. The analysis of environmental samples (i.e., metagenomes) are particularly important to figure out the microbial composition of different ecosystems and it is used in several fields: for example, metagenomic studies in agriculture are being used to explore the relations between microbes and plants and to detect crop diseases. Of fundamental importance is to identify with precision the microorganisms that are present in a metagenomic sample by comparing the biological sequences therein and assigning them to a specific taxon.</p>
    <p>The metagenomic tools can be preliminarily classified into two categories: reference-based (supervised) [<xref ref-type="bibr" rid="CR2">2</xref>–<xref ref-type="bibr" rid="CR7">7</xref>] and reference-free (unsupervised) [<xref ref-type="bibr" rid="CR8">8</xref>, <xref ref-type="bibr" rid="CR9">9</xref>]. In the first case, the metagenomic analysis needs reference genomes and the goal is to match sequences, typically reads or assembled contigs, against a database of microbial genomes in order to identify the taxon of each sequence. In the second case, the aim is to subdivide the reads or the sequences assembled from metagenomic reads into discrete units, without the need of references, so that sequences clustered together display individual populations that comprise the microbial community. This latter approach is known as reference-free binning [<xref ref-type="bibr" rid="CR8">8</xref>].</p>
    <p>In this paper, we focus on the first approach which provides taxonomic classification of individual sequences from a metagenomic sample. A variety of strategies have been used for the matching step of the reference-based metagenomics tools. The following partial list gives a few examples: aligning reads, mapping k-mers, using complete genomes, aligning marker genes only or translating the DNA and aligning to protein sequences (see also [<xref ref-type="bibr" rid="CR10">10</xref>]). One can split these methods into alignment-based and assembly-based approaches or alignment-free and assembly-free approaches [<xref ref-type="bibr" rid="CR11">11</xref>].</p>
    <p>Alignment-based classifiers proceed by aligning metagenome sequences against the genomes in a reference database. The most well-known and commonly used tool for DNA search and alignment is BLAST (Basic Local Alignment Search Tool) [<xref ref-type="bibr" rid="CR12">12</xref>]. BLAST consists of a set of algorithms that attempt to find a short fragment of a query read that aligns with a fragment of a genome stored in the reference database.</p>
    <p>Nevertheless, as reference databases and NGS sequencing datasets have grown in size, this alignment strategy has become computationally expensive and alignment-free methods have been developed. So, several techniques exist to reduce the computational complexity of this approach. In particular, there exist many statistical/computational tools for metagenomic classification (e.g. [<xref ref-type="bibr" rid="CR2">2</xref>–<xref ref-type="bibr" rid="CR4">4</xref>, <xref ref-type="bibr" rid="CR13">13</xref>]), many of these approaches use exact matching of short words of length <italic>k</italic> (k-mers) rather than alignment and are often based on hashing, indexing and counting k-mers.</p>
    <p>Recent surveys (for instance [<xref ref-type="bibr" rid="CR14">14</xref>, <xref ref-type="bibr" rid="CR15">15</xref>]) offer a thorough benchmarking analysis by comparing the majority of the state-of-the-art tools. A recent evaluation of tools for metagenome classification [<xref ref-type="bibr" rid="CR14">14</xref>] presents the most widely used tools tested on complex and realistic datasets. According to this benchmarking analysis, Kraken [<xref ref-type="bibr" rid="CR2">2</xref>] and CLARK [<xref ref-type="bibr" rid="CR3">3</xref>] result to be top-performing tools in terms of both similarity to the correct answer and the fraction of reads classified. Note that these two tools are both <italic>k</italic>-mer based. An alternative approach to fixed <italic>k</italic>-mers is to use spaced seeds, i.e. patterns in which some fixed positions are allowed to be wild-cards. CLARK-S [<xref ref-type="bibr" rid="CR5">5</xref>] is the new version of CLARK that uses spaced seeds<xref ref-type="fn" rid="Fn1">1</xref> and achieves higher sensitivity with the same high precision. The main drawback of these approaches is that they are extremely memory consuming: the memory usage of CLARK-S, as well as of CLARK and Kraken, is high, and the results obtained by running the lightweight version CLARK-L are indicated to be a “draft, or first order approximation” of those obtained by running CLARK or CLARK-S. Recently, a new version of Kraken, named Kraken 2 [<xref ref-type="bibr" rid="CR7">7</xref>], has been introduced. It improves upon Kraken by reducing memory usage by 85%, and allowing to use greater amounts of reference genomic data while maintaining high accuracy. There are, however, other efficient alignment-free methods not based on <italic>k</italic>-mer counting, for instance Centrifuge [<xref ref-type="bibr" rid="CR4">4</xref>], which is based on a read-mapping strategy and uses the FM-index [<xref ref-type="bibr" rid="CR16">16</xref>] to store and index the genome database. Another recent tool based on mapping is TaxMaps [<xref ref-type="bibr" rid="CR6">6</xref>]: it uses a database compression algorithm that eliminates redundancy by performing a lowest common ancestor (LCA) pre-assignment and collapse for k-mers of length greater than a specified read length; this allows GEM mapper [<xref ref-type="bibr" rid="CR17">17</xref>] to conduct non-exact searches in the same manner as it would against the original database, resulting in compression that, for the purpose of taxonomic classification, is lossless. Finally, a novel member of the BLAST family of programs has been introduced recently: Magic-BLAST [<xref ref-type="bibr" rid="CR18">18</xref>] is a new tool for mapping DNA or RNA next-generation sequencing (NGS) runs against a whole genome.</p>
    <p><bold>Our contributions —</bold> We propose a new alignment-free, mapping-free and assembly-free method for comparing sequences (cf. [<xref ref-type="bibr" rid="CR11">11</xref>, <xref ref-type="bibr" rid="CR19">19</xref>, <xref ref-type="bibr" rid="CR20">20</xref>]), which is combinatorial by nature and allows us to use little internal memory with respect to other approaches, since the use of the internal memory mainly depends on the number of reads that one wants to examine at the same time.</p>
    <p>Our method is based on an extension of the Burrows-Wheeler Transform (shortly eBWT) to a collection of sequences [<xref ref-type="bibr" rid="CR21">21</xref>]. The eBWT has been used in several application contexts as the circular pattern matching (cf. [<xref ref-type="bibr" rid="CR22">22</xref>]) and the alignment-free methods for comparing sequences (cf. [<xref ref-type="bibr" rid="CR21">21</xref>, <xref ref-type="bibr" rid="CR23">23</xref>–<xref ref-type="bibr" rid="CR26">26</xref>]). Different distance measures have been defined and successfully applied to several biological datasets, as for instance mitochondrial DNA genomes [<xref ref-type="bibr" rid="CR21">21</xref>, <xref ref-type="bibr" rid="CR23">23</xref>], expressed sequence tags [<xref ref-type="bibr" rid="CR27">27</xref>] and proteins [<xref ref-type="bibr" rid="CR24">24</xref>].</p>
    <p>Usually, when the eBWT is applied to a collection <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {S}$\end{document}</tex-math><mml:math id="M2"><mml:mi mathvariant="script">S</mml:mi></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq1.gif"/></alternatives></inline-formula> of sequences, its output string <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\textsf {ebwt}(\mathcal {S})$\end{document}</tex-math><mml:math id="M4"><mml:mtext mathvariant="sans-serif">ebwt</mml:mtext><mml:mo>(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq2.gif"/></alternatives></inline-formula> is enriched by another data structure, called the document array <inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\textsf {da}(\mathcal {S})$\end{document}</tex-math><mml:math id="M6"><mml:mtext mathvariant="sans-serif">da</mml:mtext><mml:mo>(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq3.gif"/></alternatives></inline-formula>: a different color is assigned to each element of <inline-formula id="IEq4"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {S}$\end{document}</tex-math><mml:math id="M8"><mml:mi mathvariant="script">S</mml:mi></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq4.gif"/></alternatives></inline-formula> and each symbol of <inline-formula id="IEq5"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\textsf {ebwt}(\mathcal {S})$\end{document}</tex-math><mml:math id="M10"><mml:mtext mathvariant="sans-serif">ebwt</mml:mtext><mml:mo>(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq5.gif"/></alternatives></inline-formula> is associated with a color in <inline-formula id="IEq6"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\textsf {da}(\mathcal {S})$\end{document}</tex-math><mml:math id="M12"><mml:mtext mathvariant="sans-serif">da</mml:mtext><mml:mo>(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq6.gif"/></alternatives></inline-formula> [<xref ref-type="bibr" rid="CR28">28</xref>]. In other words, the array <inline-formula id="IEq7"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\textsf {da}(\mathcal {S})$\end{document}</tex-math><mml:math id="M14"><mml:mtext mathvariant="sans-serif">da</mml:mtext><mml:mo>(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq7.gif"/></alternatives></inline-formula> contains a sequence of colors that depends on how the suffixes of the sequences in <inline-formula id="IEq8"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {S}$\end{document}</tex-math><mml:math id="M16"><mml:mi mathvariant="script">S</mml:mi></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq8.gif"/></alternatives></inline-formula> are mixed in the sorted list. In [<xref ref-type="bibr" rid="CR21">21</xref>, <xref ref-type="bibr" rid="CR23">23</xref>], the authors define a class of dissimilarity measures that, by using the eBWT, formalize the intuitive idea that the greater is the number of substrings shared by two sequences <inline-formula id="IEq9"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$u, v \in \mathcal {S}$\end{document}</tex-math><mml:math id="M18"><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="script">S</mml:mi></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq9.gif"/></alternatives></inline-formula>, more their colors are intermixed in <inline-formula id="IEq10"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\textsf {da}(\mathcal {S})$\end{document}</tex-math><mml:math id="M20"><mml:mtext mathvariant="sans-serif">da</mml:mtext><mml:mo>(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq10.gif"/></alternatives></inline-formula>, and the smaller is the “distance” between <italic>u</italic> and <italic>v</italic>.</p>
    <p>In this paper, we present a tool for the metagenomic classification task, called LiME (Lightweight Metagenomics via eBWT), that takes as input the (extended) Burrows-Wheeler Transform enhanced with the document array (DA) and the longest common prefix (LCP) array [<xref ref-type="bibr" rid="CR29">29</xref>]. These are fundamental data structures in string processing and can be built independently from our tool (e.g. [<xref ref-type="bibr" rid="CR30">30</xref>–<xref ref-type="bibr" rid="CR35">35</xref>]).</p>
    <p>The contribution of this paper is twofold, theoretical as well as practical. The theoretical result is the introduction of a novel combinatorial approach, which is alignment-free, mapping-free and assembly-free, that can be the basis of new biological sequence analysis methods. Our approach takes advantage of the combinatorial property of the Burrows-Wheeler Transform (BWT) [<xref ref-type="bibr" rid="CR36">36</xref>], already exploited by BWT-based compressors (see, for instance [<xref ref-type="bibr" rid="CR37">37</xref>–<xref ref-type="bibr" rid="CR39">39</xref>]): the output of BWT shows a local similarity (occurrences of a given letter that precede the same context tend to occur in clusters) [<xref ref-type="bibr" rid="CR40">40</xref>–<xref ref-type="bibr" rid="CR43">43</xref>].</p>
    <p>From a practical viewpoint, unlike other approaches, LiME does not need to build ad-hoc and keep in internal memory the data structures relating to the database of the reference genomes, as it only needs to run sequential scans on the input data structures, that may consist of a simple text file or may be in compression form. For the best of our knowledge, LiME also is the first metagenomic classifier that runs a many-to-many pairwise comparison and that is able to produce a similarity matrix, by comparing all unknown sequences in the sample versus all known genomes in the collection at the same time in order to be able to assign the correct reference to each read. In the future, such matrix could also be used for other metagenomic applications, for instance reference-free (unsupervised) approaches [<xref ref-type="bibr" rid="CR9">9</xref>] or all-vs-all comparison of metagenomes [<xref ref-type="bibr" rid="CR44">44</xref>].</p>
    <p>Moreover, the experiments show that our tool has a very high precision and a high specificity, in fact our tool is able to correctly assign a read to a genome, while being able to establish that random reads must not be assigned to any genome. Our tool can take paired-end read collections as input - we recall that a paired-end read is a pair consisting of two reads (or mates), such that the second read occurs in the genome at a known distance after the first one. LiME is able to process the mates individually while still recognizing the pairing information, when the input set is a paired-end read.</p>
    <p>This work is an extended version of a paper appeared in [<xref ref-type="bibr" rid="CR45">45</xref>], where two of the present authors introduced a new similarity measure, based on the clustering effect of the eBWT. The main idea consists in computing the similarity between a read and a genome by identifying and analyzing the consecutive symbols in the output of the eBWT and their related colors in the DA. The previous strategy did not take into account the symbols in the International Union of Pure and Applied Chemistry (IUPAC)<xref ref-type="fn" rid="Fn2">2</xref> code [<xref ref-type="bibr" rid="CR46">46</xref>], indeed they were considered as placeholders. Moreover, in the preliminary version, several reads were set as ambiguous, and thus not classified, by leaving a more in-depth analysis of them for a further work.</p>
    <p>The additional contributions over those in the conference paper [<xref ref-type="bibr" rid="CR45">45</xref>] are: i) we modify the analysis of the clusters by using two different similarity measure definitions: in the first variant, we count how many matches of symbols there are between each read and each genome in any cluster taking into account also the IUPAC ambiguity code (an ambiguity code can match with themselves or with any letter that is associated with its code); whereas, in the second variant, only the presence of such symbols in clusters is considered and we just distinguish the belonging to different input sequences; ii) we modify the read classification by doing a more in-depth analysis of the ambiguous reads (note that the classification is divided into three phases and only the first phase is in common with [<xref ref-type="bibr" rid="CR45">45</xref>]); iii) we are able not only to classify the reads at a specific taxonomic rank such as genomes, or any level between species and phylum, but also to classify reads at several taxonomic levels by taking advantage of the taxonomic lineage; iv) we implement a multi-threading version of our tool exploiting the fact that it allows a certain degree of parallelization, indeed as stated in [<xref ref-type="bibr" rid="CR45">45</xref>], the analysis of clusters is independent of each other, so each thread can handle distinct parts of the input files by reading it through local buffers; we also extend the experiments showing the performance of our tool on a real dataset.</p>
    <p>The validation is performed by using both simulated metagenomes among those provided in the benchmarking analysis [<xref ref-type="bibr" rid="CR14">14</xref>] and a real metagenome from the Human Microbiome Project (HMP).</p>
    <p>Concerning the simulated datasets, they reproduce size, complexity and characteristics of real metagenomic samples containing around 20 millions of sequences (for the positive control) in addition to a negative control set of about 5 millions of random shuffled reads which mimic sequences from unknown organisms that are likely to appear in metagenomic samples. The experiment results on the simulated data show that LiME is competitive with the state-of-the-art tools. It achieves high levels of precision and specificity– e.g., 99.9<italic>%</italic> of the positive control reads are correctly assigned and the percentage of classified reads of the negative control is less than 0.01<italic>%</italic> – keeping a high sensitivity. Thus, on simulated datasets LiME achieves a high F1 score, which is the harmonic mean between sensitivity and precision. Recall that a classifier obtaining a high F1 score is able to achieve both high precision and high sensitivity. Moreover, LiME is able to deliver classification accuracy comparable to that of Magic-BLAST, TaxMaps and CLARK-S, yet requiring less computational cost.</p>
    <p>On the real metagenome, the accuracy of classification cannot be evaluated, since the “ground truth” for real metagenome is not available, and thus we choose to compare the classification of LiME to the other tools’ classification results. By comparing the experimental results, we observe that LiME classifies identically the same reads as Magic-BLAST more than the other tools do. Moreover, the number of reads that are classified by LiME but not by Magic-BLAST is greater than that computed by CLARK-S, Centrifuge, and Kraken 2, although LiME classifies more reads than CLARK-S, Centrifuge and Kraken 2.</p>
    <p>Overall, the experiments confirm the effectiveness of our method and its high accuracy even in negative control samples.</p>
  </sec>
  <sec id="Sec2">
    <title>Method</title>
    <p>In this section, we present a new eBWT-based strategy to tackle the problem of metagenomic classification that is assembly-, mapping- and alignment-free and uses a little amount of memory, in the sense that we keep the input data structures we use in external memory, and the similarity matrix between the reads and the genomes in internal memory. So, the space in internal memory depends only on the number of sequences that one wants to examine at the same time and it does not depend on the size (number of symbols) of the input.</p>
    <sec id="Sec3">
      <title>Preliminaries and materials</title>
      <p>Let <italic>S</italic> be a string (or sequence) of length <italic>n</italic>, and <italic>Σ</italic> its alphabet set, with <italic>σ</italic>=|<italic>Σ</italic>|. We denote the <italic>i</italic>-th symbol of <italic>S</italic> by <italic>S</italic>[ <italic>i</italic>]. Let <inline-formula id="IEq11"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {S}=\{S_{1},S_{2},\ldots,S_{m}\}$\end{document}</tex-math><mml:math id="M22"><mml:mi mathvariant="script">S</mml:mi><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq11.gif"/></alternatives></inline-formula> be a collection of <italic>m</italic> strings. We assume that each string <inline-formula id="IEq12"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$S_{i} \in \mathcal {S}$\end{document}</tex-math><mml:math id="M24"><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:mi mathvariant="script">S</mml:mi></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq12.gif"/></alternatives></inline-formula> of length <italic>n</italic><sub><italic>i</italic></sub> is followed by a special symbol <italic>S</italic><sub><italic>i</italic></sub>[<italic>n</italic><sub><italic>i</italic></sub>+1]=<italic>$</italic><sub><italic>i</italic></sub>, which is lexicographically smaller than any other characters in <inline-formula id="IEq13"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {S}$\end{document}</tex-math><mml:math id="M26"><mml:mi mathvariant="script">S</mml:mi></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq13.gif"/></alternatives></inline-formula>, and does not appear in <inline-formula id="IEq14"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {S}$\end{document}</tex-math><mml:math id="M28"><mml:mi mathvariant="script">S</mml:mi></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq14.gif"/></alternatives></inline-formula> elsewhere — for implementation purposes, we may simply use a unique end-marker <italic>$</italic> for all strings in <inline-formula id="IEq15"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {S}$\end{document}</tex-math><mml:math id="M30"><mml:mi mathvariant="script">S</mml:mi></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq15.gif"/></alternatives></inline-formula>. The alphabet <italic>Σ</italic> is the biological alphabet {<italic>A</italic>,<italic>C</italic>,<italic>G</italic>,<italic>T</italic>} enhanced with the degenerated base symbols (IUPAC code [<xref ref-type="bibr" rid="CR46">46</xref>]) and the end-marker symbol.</p>
      <p>A <italic>substring</italic> of any <inline-formula id="IEq16"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$S \in \mathcal {S}$\end{document}</tex-math><mml:math id="M32"><mml:mi>S</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="script">S</mml:mi></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq16.gif"/></alternatives></inline-formula> is denoted as <italic>S</italic>[ <italic>i</italic>,<italic>j</italic>]=<italic>S</italic>[ <italic>i</italic>]⋯<italic>S</italic>[ <italic>j</italic>], with <italic>S</italic>[ 1,<italic>j</italic>] being called a <italic>prefix</italic> and <italic>S</italic>[<italic>i</italic>,<italic>n</italic>+1] a <italic>suffix</italic> of <italic>S</italic>. A <italic>range</italic> is delimited by a square bracket if the corresponding endpoint is included.</p>
      <p>The <italic>Burrows-Wheeler Transform</italic> (BWT) [<xref ref-type="bibr" rid="CR36">36</xref>] is a well-known widely used reversible string transformation that can be extended to a collection of strings. Such an extension, known as eBWT or multi-string BWT, is a reversible transformation whose output string (denoted by <inline-formula id="IEq17"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\textsf {ebwt}(\mathcal {S})$\end{document}</tex-math><mml:math id="M34"><mml:mtext mathvariant="sans-serif">ebwt</mml:mtext><mml:mo>(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq17.gif"/></alternatives></inline-formula>) is a permutation of the symbols of all strings in <inline-formula id="IEq18"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {S}$\end{document}</tex-math><mml:math id="M36"><mml:mi mathvariant="script">S</mml:mi></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq18.gif"/></alternatives></inline-formula> [<xref ref-type="bibr" rid="CR21">21</xref>] (see also [<xref ref-type="bibr" rid="CR30">30</xref>, <xref ref-type="bibr" rid="CR31">31</xref>, <xref ref-type="bibr" rid="CR34">34</xref>, <xref ref-type="bibr" rid="CR47">47</xref>, <xref ref-type="bibr" rid="CR48">48</xref>]). The length of <inline-formula id="IEq19"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\textsf {ebwt}(\mathcal {S})$\end{document}</tex-math><mml:math id="M38"><mml:mtext mathvariant="sans-serif">ebwt</mml:mtext><mml:mo>(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq19.gif"/></alternatives></inline-formula> is denoted by <inline-formula id="IEq20"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$N=\left (\sum _{i=1}^{m}n_{i}\right) + m$\end{document}</tex-math><mml:math id="M40"><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:mi>m</mml:mi></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq20.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq21"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\textsf {ebwt}(\mathcal {S})[i]=x$\end{document}</tex-math><mml:math id="M42"><mml:mtext mathvariant="sans-serif">ebwt</mml:mtext><mml:mo>(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo>)</mml:mo><mml:mo>[</mml:mo><mml:mi>i</mml:mi><mml:mo>]</mml:mo><mml:mo>=</mml:mo><mml:mi>x</mml:mi></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq21.gif"/></alternatives></inline-formula>, with 1 ≤ <italic>i</italic> ≤ <italic>N</italic>, if <italic>x</italic> circularly precedes the <italic>i</italic>-th suffix <italic>S</italic><sub><italic>j</italic></sub>[<italic>k</italic>,<italic>n</italic><sub><italic>j</italic></sub>+1] (for some 1≤<italic>j</italic>≤<italic>m</italic> and 1≤<italic>k</italic>≤<italic>n</italic><sub><italic>j</italic></sub> + 1), according to the lexicographic sorting of the suffixes of all strings in <inline-formula id="IEq22"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {S}$\end{document}</tex-math><mml:math id="M44"><mml:mi mathvariant="script">S</mml:mi></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq22.gif"/></alternatives></inline-formula>. In this case, we say that the suffix <italic>S</italic><sub><italic>j</italic></sub>[<italic>k</italic>,<italic>n</italic><sub><italic>j</italic></sub>+1] is associated with the position <italic>i</italic> in <inline-formula id="IEq23"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\textsf {ebwt}(\mathcal {S})$\end{document}</tex-math><mml:math id="M46"><mml:mtext mathvariant="sans-serif">ebwt</mml:mtext><mml:mo>(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq23.gif"/></alternatives></inline-formula> and with the color <inline-formula id="IEq24"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$j\in \{1, 2, \dots, m\}$\end{document}</tex-math><mml:math id="M48"><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo>}</mml:mo></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq24.gif"/></alternatives></inline-formula> in the DA. Then, the output string <inline-formula id="IEq25"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\textsf {ebwt}(\mathcal {S})$\end{document}</tex-math><mml:math id="M50"><mml:mtext mathvariant="sans-serif">ebwt</mml:mtext><mml:mo>(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq25.gif"/></alternatives></inline-formula> is enhanced with the <italic>document array</italic> of <inline-formula id="IEq26"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {S}$\end{document}</tex-math><mml:math id="M52"><mml:mi mathvariant="script">S</mml:mi></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq26.gif"/></alternatives></inline-formula> (denoted by <inline-formula id="IEq27"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\textsf {da}(\mathcal {S})$\end{document}</tex-math><mml:math id="M54"><mml:mtext mathvariant="sans-serif">da</mml:mtext><mml:mo>(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq27.gif"/></alternatives></inline-formula>) of length <italic>N</italic> where <inline-formula id="IEq28"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\textsf {da}(\mathcal {S})[i]=j$\end{document}</tex-math><mml:math id="M56"><mml:mtext mathvariant="sans-serif">da</mml:mtext><mml:mo>(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo>)</mml:mo><mml:mo>[</mml:mo><mml:mi>i</mml:mi><mml:mo>]</mml:mo><mml:mo>=</mml:mo><mml:mi>j</mml:mi></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq28.gif"/></alternatives></inline-formula>, with 1≤<italic>j</italic>≤<italic>m</italic> and 1≤<italic>i</italic>≤<italic>N</italic>, if <inline-formula id="IEq29"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\textsf {ebwt}(\mathcal {S})[\!i]$\end{document}</tex-math><mml:math id="M58"><mml:mtext mathvariant="sans-serif">ebwt</mml:mtext><mml:mo>(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo>)</mml:mo><mml:mo>[</mml:mo><mml:mspace width="0.3em"/><mml:mi>i</mml:mi><mml:mo>]</mml:mo></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq29.gif"/></alternatives></inline-formula> is a symbol of the string <inline-formula id="IEq30"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$S_{j} \in \mathcal {S}$\end{document}</tex-math><mml:math id="M60"><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:mi mathvariant="script">S</mml:mi></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq30.gif"/></alternatives></inline-formula>. In other words, a different color is assigned to each sequence. See Fig. <xref rid="Fig1" ref-type="fig">1</xref> for an example.
<fig id="Fig1"><label>Fig. 1</label><caption><p>The required data structures for our running example. The set <inline-formula id="IEq31"><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {S}$\end{document}</tex-math><mml:math id="M62"><mml:mi mathvariant="script">S</mml:mi></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq31.gif"/></alternatives></inline-formula> is {<italic>S</italic><sub>1</sub>=<italic>G</italic><italic>G</italic><italic>C</italic><italic>G</italic><italic>T</italic><italic>A</italic><italic>C</italic><italic>C</italic><italic>A</italic><italic>$</italic><sub>1</sub>,<italic>S</italic><sub>2</sub>=<italic>G</italic><italic>G</italic><italic>G</italic><italic>G</italic><italic>C</italic><italic>G</italic><italic>T</italic><italic>A</italic><italic>T</italic><italic>$</italic><sub>2</sub>,<italic>S</italic><sub>3</sub>=<italic>A</italic><italic>C</italic><italic>G</italic><italic>A</italic><italic>R</italic><italic>T</italic><italic>A</italic><italic>C</italic><italic>G</italic><italic>A</italic><italic>C</italic><italic>$</italic><sub>3</sub>}, where <italic>S</italic><sub>1</sub> is a read and <italic>S</italic><sub>2</sub> and <italic>S</italic><sub>3</sub> are two genomes. The symbols of <inline-formula id="IEq32"><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\textsf {ebwt}(\mathcal {S})$\end{document}</tex-math><mml:math id="M64"><mml:mtext mathvariant="sans-serif">ebwt</mml:mtext><mml:mo>(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq32.gif"/></alternatives></inline-formula> in the 2-clusters are in bold</p></caption><graphic xlink:href="12859_2020_3628_Fig1_HTML" id="MO1"/></fig></p>
      <p>The <italic>longest common prefix</italic> (LCP) array [<xref ref-type="bibr" rid="CR29">29</xref>] of <inline-formula id="IEq33"><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {S}$\end{document}</tex-math><mml:math id="M66"><mml:mi mathvariant="script">S</mml:mi></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq33.gif"/></alternatives></inline-formula> is the array <inline-formula id="IEq34"><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\textsf {lcp}(\mathcal {S})$\end{document}</tex-math><mml:math id="M68"><mml:mtext mathvariant="sans-serif">lcp</mml:mtext><mml:mo>(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq34.gif"/></alternatives></inline-formula> of length <italic>N</italic>+1, such that <inline-formula id="IEq35"><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\textsf {lcp}(\mathcal {S})[\!i]$\end{document}</tex-math><mml:math id="M70"><mml:mtext mathvariant="sans-serif">lcp</mml:mtext><mml:mo>(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo>)</mml:mo><mml:mo>[</mml:mo><mml:mspace width="0.3em"/><mml:mi>i</mml:mi><mml:mo>]</mml:mo></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq35.gif"/></alternatives></inline-formula>, with 2≤<italic>i</italic>≤<italic>N</italic>, is the length of the longest common prefix between the suffixes associated with the positions <italic>i</italic> and <italic>i</italic>−1 in <inline-formula id="IEq36"><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\textsf {ebwt}(\mathcal {S})$\end{document}</tex-math><mml:math id="M72"><mml:mtext mathvariant="sans-serif">ebwt</mml:mtext><mml:mo>(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq36.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq37"><alternatives><tex-math id="M73">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\textsf {lcp}(\mathcal {S})[\!1] = \textsf {lcp}(\mathcal {S})[N+1]= 0$\end{document}</tex-math><mml:math id="M74"><mml:mtext mathvariant="sans-serif">lcp</mml:mtext><mml:mo>(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo>)</mml:mo><mml:mo>[</mml:mo><mml:mspace width="0.3em"/><mml:mn>1</mml:mn><mml:mo>]</mml:mo><mml:mo>=</mml:mo><mml:mtext mathvariant="sans-serif">lcp</mml:mtext><mml:mo>(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo>)</mml:mo><mml:mo>[</mml:mo><mml:mi>N</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>]</mml:mo><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq37.gif"/></alternatives></inline-formula> by default.</p>
      <p>The set <inline-formula id="IEq38"><alternatives><tex-math id="M75">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {S}$\end{document}</tex-math><mml:math id="M76"><mml:mi mathvariant="script">S</mml:mi></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq38.gif"/></alternatives></inline-formula> will be omitted if it is clear from the context. Moreover, for clarity of description, we denote by <inline-formula id="IEq39"><alternatives><tex-math id="M77">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {L(S)}$\end{document}</tex-math><mml:math id="M78"><mml:mi mathvariant="script">ℒ</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq39.gif"/></alternatives></inline-formula> the sorted list of the suffixes in <inline-formula id="IEq40"><alternatives><tex-math id="M79">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {S}$\end{document}</tex-math><mml:math id="M80"><mml:mi mathvariant="script">S</mml:mi></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq40.gif"/></alternatives></inline-formula>, distinguishing the end-marker symbol <italic>$</italic>, although we do not need it for our computation.</p>
      <p>We call <italic>u</italic>-<italic>occurrence</italic> any substring <italic>u</italic> that occurs in any sequence of <inline-formula id="IEq41"><alternatives><tex-math id="M81">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {S}$\end{document}</tex-math><mml:math id="M82"><mml:mi mathvariant="script">S</mml:mi></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq41.gif"/></alternatives></inline-formula>.</p>
      <sec id="d30e1876">
        <title>
          <bold>Remark 1</bold>
        </title>
        <p>Recall that <inline-formula id="IEq42"><alternatives><tex-math id="M83">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\textsf {ebwt}(\mathcal {S})$\end{document}</tex-math><mml:math id="M84"><mml:mtext mathvariant="sans-serif">ebwt</mml:mtext><mml:mo>(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq42.gif"/></alternatives></inline-formula> is implicitly associated with <inline-formula id="IEq43"><alternatives><tex-math id="M85">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {L(S)}$\end{document}</tex-math><mml:math id="M86"><mml:mi mathvariant="script">ℒ</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq43.gif"/></alternatives></inline-formula> and all the suffixes in <inline-formula id="IEq44"><alternatives><tex-math id="M87">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {S}$\end{document}</tex-math><mml:math id="M88"><mml:mi mathvariant="script">S</mml:mi></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq44.gif"/></alternatives></inline-formula> starting with the same substring <italic>u</italic>, with |<italic>u</italic>|=<italic>k</italic>, must be consecutive entries in <inline-formula id="IEq45"><alternatives><tex-math id="M89">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {L(S)}$\end{document}</tex-math><mml:math id="M90"><mml:mi mathvariant="script">ℒ</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq45.gif"/></alternatives></inline-formula> in the range [ <italic>h</italic>,<italic>j</italic>]. Moreover, <italic>l</italic><italic>c</italic><italic>p</italic>[ <italic>h</italic>]&lt;<italic>k</italic>, <italic>l</italic><italic>c</italic><italic>p</italic>[<italic>j</italic>+1]&lt;<italic>k</italic>, and lcp[ <italic>i</italic>]≥<italic>k</italic> for <italic>i</italic>=<italic>h</italic>+1,…,<italic>j</italic>, and the symbols of <inline-formula id="IEq46"><alternatives><tex-math id="M91">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {S}$\end{document}</tex-math><mml:math id="M92"><mml:mi mathvariant="script">S</mml:mi></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq46.gif"/></alternatives></inline-formula> that are followed by <italic>u</italic>-occurrences coincide with ebwt[ <italic>h</italic>,<italic>j</italic>].</p>
      </sec>
      <sec id="d30e2019">
        <title>
          <bold>Remark 2</bold>
        </title>
        <p>Let <italic>ℓ</italic> be the total number of <italic>u</italic>-occurrences in <inline-formula id="IEq47"><alternatives><tex-math id="M93">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {S}$\end{document}</tex-math><mml:math id="M94"><mml:mi mathvariant="script">S</mml:mi></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq47.gif"/></alternatives></inline-formula>, with |<italic>u</italic>|=<italic>k</italic>, there exist <italic>k</italic>−1 substrings (i.e., all suffixes of <italic>u</italic> that are not equal to <italic>u</italic>) which appear <italic>at least</italic>
<italic>ℓ</italic> times in <inline-formula id="IEq48"><alternatives><tex-math id="M95">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {S}$\end{document}</tex-math><mml:math id="M96"><mml:mi mathvariant="script">S</mml:mi></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq48.gif"/></alternatives></inline-formula>.</p>
      </sec>
      <sec id="d30e2073">
        <title>
          <bold>Example 1</bold>
        </title>
        <p>(running example) Let <inline-formula id="IEq49"><alternatives><tex-math id="M97">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {S}= \{S_{1}=GG\textbf {CGT}ACCA\$_{1}, S_{2}=GGGG\textbf {CGT}AT\$_{2}, S_{3}=ACGARTACGAC\$_{3}\}$\end{document}</tex-math><mml:math id="M98"><mml:mi mathvariant="script">S</mml:mi><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mtext mathvariant="italic">GGCGTACCA</mml:mtext><mml:msub><mml:mrow><mml:mi>$</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mtext mathvariant="italic">GGGGCGTAT</mml:mtext><mml:msub><mml:mrow><mml:mi>$</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mtext mathvariant="italic">ACGARTACGAC</mml:mtext><mml:msub><mml:mrow><mml:mi>$</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq49.gif"/></alternatives></inline-formula>. The substring <italic>CGT</italic> appears exactly once in sequences <italic>S</italic><sub>1</sub> and <italic>S</italic><sub>2</sub>. The two suffixes of <italic>S</italic><sub>1</sub> and <italic>S</italic><sub>2</sub> starting with <italic>CGT</italic>-occurrences occupy consecutive positions, precisely <italic>16</italic> and <italic>17</italic> in Fig. <xref rid="Fig1" ref-type="fig">1</xref>, and lcp[ 17]=4. Moreover, according to Remark <xref rid="Sec3" ref-type="sec">2</xref>, we may note that the number of <italic>GT</italic>-occurrences is 2 and the one of <italic>T</italic>-occurrences is <italic>4</italic>.</p>
      </sec>
    </sec>
    <sec id="Sec4">
      <title>Preprocessing</title>
      <p>We recall that our tool takes as input the files containing <inline-formula id="IEq50"><alternatives><tex-math id="M99">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\textsf {ebwt}(\mathcal {S})$\end{document}</tex-math><mml:math id="M100"><mml:mtext mathvariant="sans-serif">ebwt</mml:mtext><mml:mo>(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq50.gif"/></alternatives></inline-formula>, <inline-formula id="IEq51"><alternatives><tex-math id="M101">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\textsf {da}(\mathcal {S})$\end{document}</tex-math><mml:math id="M102"><mml:mtext mathvariant="sans-serif">da</mml:mtext><mml:mo>(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq51.gif"/></alternatives></inline-formula> and <inline-formula id="IEq52"><alternatives><tex-math id="M103">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\textsf {lcp}(\mathcal {S})$\end{document}</tex-math><mml:math id="M104"><mml:mtext mathvariant="sans-serif">lcp</mml:mtext><mml:mo>(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq52.gif"/></alternatives></inline-formula> of the collection <inline-formula id="IEq53"><alternatives><tex-math id="M105">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {S}$\end{document}</tex-math><mml:math id="M106"><mml:mi mathvariant="script">S</mml:mi></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq53.gif"/></alternatives></inline-formula> of reads and reference genomes.</p>
      <p>Let <inline-formula id="IEq54"><alternatives><tex-math id="M107">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {S}=\{S_{1},\ldots,S_{m}\}$\end{document}</tex-math><mml:math id="M108"><mml:mi mathvariant="script">S</mml:mi><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq54.gif"/></alternatives></inline-formula> be the input collection of biological sequences comprising <italic>r</italic> reads and <italic>g</italic> genomes, where <italic>m</italic>=<italic>r</italic>+<italic>g</italic>. More in details, <inline-formula id="IEq55"><alternatives><tex-math id="M109">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$S_{i} \in \mathcal {S}$\end{document}</tex-math><mml:math id="M110"><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:mi mathvariant="script">S</mml:mi></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq55.gif"/></alternatives></inline-formula> is a read if 1≤<italic>i</italic>≤<italic>r</italic> and <inline-formula id="IEq56"><alternatives><tex-math id="M111">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$S_{j}\in \mathcal {S}$\end{document}</tex-math><mml:math id="M112"><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:mi mathvariant="script">S</mml:mi></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq56.gif"/></alternatives></inline-formula> is a genome if <italic>r</italic>+1≤<italic>j</italic>≤<italic>m</italic>. For simplicity, we denote by <inline-formula id="IEq57"><alternatives><tex-math id="M113">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {R}$\end{document}</tex-math><mml:math id="M114"><mml:mi mathvariant="script">R</mml:mi></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq57.gif"/></alternatives></inline-formula> the subset of reads and by <inline-formula id="IEq58"><alternatives><tex-math id="M115">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {G}$\end{document}</tex-math><mml:math id="M116"><mml:mi mathvariant="script">G</mml:mi></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq58.gif"/></alternatives></inline-formula> the subset of genomes.</p>
      <p>The construction of <inline-formula id="IEq59"><alternatives><tex-math id="M117">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\textsf {ebwt}(\mathcal {S})$\end{document}</tex-math><mml:math id="M118"><mml:mtext mathvariant="sans-serif">ebwt</mml:mtext><mml:mo>(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq59.gif"/></alternatives></inline-formula>, <inline-formula id="IEq60"><alternatives><tex-math id="M119">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\textsf {da}(\mathcal {S})$\end{document}</tex-math><mml:math id="M120"><mml:mtext mathvariant="sans-serif">da</mml:mtext><mml:mo>(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq60.gif"/></alternatives></inline-formula> and <inline-formula id="IEq61"><alternatives><tex-math id="M121">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\textsf {lcp}(\mathcal {S})$\end{document}</tex-math><mml:math id="M122"><mml:mtext mathvariant="sans-serif">lcp</mml:mtext><mml:mo>(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq61.gif"/></alternatives></inline-formula> can be performed in internal or external memory. We can compute <inline-formula id="IEq62"><alternatives><tex-math id="M123">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\textsf {ebwt}(\mathcal {G})$\end{document}</tex-math><mml:math id="M124"><mml:mtext mathvariant="sans-serif">ebwt</mml:mtext><mml:mo>(</mml:mo><mml:mi mathvariant="script">G</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq62.gif"/></alternatives></inline-formula> and <inline-formula id="IEq63"><alternatives><tex-math id="M125">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\textsf {da}(\mathcal {G})$\end{document}</tex-math><mml:math id="M126"><mml:mtext mathvariant="sans-serif">da</mml:mtext><mml:mo>(</mml:mo><mml:mi mathvariant="script">G</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq63.gif"/></alternatives></inline-formula> with algorithm GAP [<xref ref-type="bibr" rid="CR30">30</xref>] or eGSA [<xref ref-type="bibr" rid="CR47">47</xref>]. Then, for each new experiment with a read collection <inline-formula id="IEq64"><alternatives><tex-math id="M127">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {R}$\end{document}</tex-math><mml:math id="M128"><mml:mi mathvariant="script">R</mml:mi></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq64.gif"/></alternatives></inline-formula>, we can compute <inline-formula id="IEq65"><alternatives><tex-math id="M129">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\textsf {ebwt}(\mathcal {R})$\end{document}</tex-math><mml:math id="M130"><mml:mtext mathvariant="sans-serif">ebwt</mml:mtext><mml:mo>(</mml:mo><mml:mi mathvariant="script">R</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq65.gif"/></alternatives></inline-formula> and <inline-formula id="IEq66"><alternatives><tex-math id="M131">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\textsf {da}(\mathcal {R})$\end{document}</tex-math><mml:math id="M132"><mml:mtext mathvariant="sans-serif">da</mml:mtext><mml:mo>(</mml:mo><mml:mi mathvariant="script">R</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq66.gif"/></alternatives></inline-formula> by using the algorithm BCR [<xref ref-type="bibr" rid="CR31">31</xref>, <xref ref-type="bibr" rid="CR32">32</xref>] and merge them with <inline-formula id="IEq67"><alternatives><tex-math id="M133">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\textsf {ebwt}(\mathcal {G})$\end{document}</tex-math><mml:math id="M134"><mml:mtext mathvariant="sans-serif">ebwt</mml:mtext><mml:mo>(</mml:mo><mml:mi mathvariant="script">G</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq67.gif"/></alternatives></inline-formula> and <inline-formula id="IEq68"><alternatives><tex-math id="M135">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\textsf {da}(\mathcal {G})$\end{document}</tex-math><mml:math id="M136"><mml:mtext mathvariant="sans-serif">da</mml:mtext><mml:mo>(</mml:mo><mml:mi mathvariant="script">G</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq68.gif"/></alternatives></inline-formula> to compute <inline-formula id="IEq69"><alternatives><tex-math id="M137">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\textsf {ebwt}(\mathcal {S})$\end{document}</tex-math><mml:math id="M138"><mml:mtext mathvariant="sans-serif">ebwt</mml:mtext><mml:mo>(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq69.gif"/></alternatives></inline-formula> and <inline-formula id="IEq70"><alternatives><tex-math id="M139">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\textsf {da}(\mathcal {S})$\end{document}</tex-math><mml:math id="M140"><mml:mtext mathvariant="sans-serif">da</mml:mtext><mml:mo>(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq70.gif"/></alternatives></inline-formula> by using the algorithm eGAP [<xref ref-type="bibr" rid="CR34">34</xref>], which gives <inline-formula id="IEq71"><alternatives><tex-math id="M141">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\textsf {lcp}(\mathcal {S})$\end{document}</tex-math><mml:math id="M142"><mml:mtext mathvariant="sans-serif">lcp</mml:mtext><mml:mo>(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq71.gif"/></alternatives></inline-formula> as a by-product with no additional costs.</p>
      <p>Notice that the used method does not affect the classification, so one can use other algorithms to construct <inline-formula id="IEq72"><alternatives><tex-math id="M143">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\textsf {ebwt}(\mathcal {S})$\end{document}</tex-math><mml:math id="M144"><mml:mtext mathvariant="sans-serif">ebwt</mml:mtext><mml:mo>(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq72.gif"/></alternatives></inline-formula>, <inline-formula id="IEq73"><alternatives><tex-math id="M145">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\textsf {da}(\mathcal {S})$\end{document}</tex-math><mml:math id="M146"><mml:mtext mathvariant="sans-serif">da</mml:mtext><mml:mo>(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq73.gif"/></alternatives></inline-formula> and <inline-formula id="IEq74"><alternatives><tex-math id="M147">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\textsf {lcp}(\mathcal {S})$\end{document}</tex-math><mml:math id="M148"><mml:mtext mathvariant="sans-serif">lcp</mml:mtext><mml:mo>(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq74.gif"/></alternatives></inline-formula> which is a good feature, since more efficient tools can appear in the literature.</p>
    </sec>
    <sec id="Sec5">
      <title>LiME</title>
      <p>In this section, we describe how computing a similarity value between a short sequence and a genome reference, and then we describe how to handle the reverse complement strand of the sequence or the mates for paired-end read collections.</p>
      <p>We outline the method that we introduced to classify short reads by assigning it to a specific taxon according to the similarity scores computed for any genome in <inline-formula id="IEq75"><alternatives><tex-math id="M149">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {G}$\end{document}</tex-math><mml:math id="M150"><mml:mi mathvariant="script">G</mml:mi></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq75.gif"/></alternatives></inline-formula> through sequential scans on <inline-formula id="IEq76"><alternatives><tex-math id="M151">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\textsf {ebwt}(\mathcal {S})$\end{document}</tex-math><mml:math id="M152"><mml:mtext mathvariant="sans-serif">ebwt</mml:mtext><mml:mo>(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq76.gif"/></alternatives></inline-formula>, <inline-formula id="IEq77"><alternatives><tex-math id="M153">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\textsf {da}(\mathcal {S})$\end{document}</tex-math><mml:math id="M154"><mml:mtext mathvariant="sans-serif">da</mml:mtext><mml:mo>(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq77.gif"/></alternatives></inline-formula> and <inline-formula id="IEq78"><alternatives><tex-math id="M155">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\textsf {lcp}(\mathcal {S})$\end{document}</tex-math><mml:math id="M156"><mml:mtext mathvariant="sans-serif">lcp</mml:mtext><mml:mo>(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq78.gif"/></alternatives></inline-formula>.</p>
      <p>Our notion of similarity between sequences exploits the underlying properties of the eBWT: (i) the clustering effect, i.e., the fact that this transformation tends to group together symbols that occur in similar contexts in the input string collection; (ii) the fact that if a substring <italic>u</italic> occurs in one or more sequences, then the suffixes of the collection starting with <italic>u</italic>-occurrence are likely to be close in the sorted list of suffixes. In other words, the greater the number of substrings shared by two sequences is, the more they are similar.</p>
      <p>Roughly speaking, we consider the symbols of <inline-formula id="IEq79"><alternatives><tex-math id="M157">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {S}$\end{document}</tex-math><mml:math id="M158"><mml:mi mathvariant="script">S</mml:mi></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq79.gif"/></alternatives></inline-formula> followed by the same substrings (i.e., contexts) which are clustered together in <inline-formula id="IEq80"><alternatives><tex-math id="M159">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\textsf {ebwt}(\mathcal {S})$\end{document}</tex-math><mml:math id="M160"><mml:mtext mathvariant="sans-serif">ebwt</mml:mtext><mml:mo>(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq80.gif"/></alternatives></inline-formula> and match one-to-one the symbols belonging to <inline-formula id="IEq81"><alternatives><tex-math id="M161">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {R}$\end{document}</tex-math><mml:math id="M162"><mml:mi mathvariant="script">R</mml:mi></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq81.gif"/></alternatives></inline-formula> to the symbols belonging to <inline-formula id="IEq82"><alternatives><tex-math id="M163">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {G}$\end{document}</tex-math><mml:math id="M164"><mml:mi mathvariant="script">G</mml:mi></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq82.gif"/></alternatives></inline-formula>.</p>
      <p>The overall scheme of the LiME algorithm can be sketched as follows: Step 1. By reading <inline-formula id="IEq83"><alternatives><tex-math id="M165">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\textsf {da}(\mathcal {S})$\end{document}</tex-math><mml:math id="M166"><mml:mtext mathvariant="sans-serif">da</mml:mtext><mml:mo>(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq83.gif"/></alternatives></inline-formula> and <inline-formula id="IEq84"><alternatives><tex-math id="M167">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\textsf {lcp}(\mathcal {S})$\end{document}</tex-math><mml:math id="M168"><mml:mtext mathvariant="sans-serif">lcp</mml:mtext><mml:mo>(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq84.gif"/></alternatives></inline-formula> in a sequential way, we detect <italic>α</italic>-clusters, i.e., the blocks of <inline-formula id="IEq85"><alternatives><tex-math id="M169">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\textsf {ebwt}(\mathcal {S})$\end{document}</tex-math><mml:math id="M170"><mml:mtext mathvariant="sans-serif">ebwt</mml:mtext><mml:mo>(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq85.gif"/></alternatives></inline-formula> containing symbols belonging both to <inline-formula id="IEq86"><alternatives><tex-math id="M171">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {R}$\end{document}</tex-math><mml:math id="M172"><mml:mi mathvariant="script">R</mml:mi></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq86.gif"/></alternatives></inline-formula> and to <inline-formula id="IEq87"><alternatives><tex-math id="M173">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {G}$\end{document}</tex-math><mml:math id="M174"><mml:mi mathvariant="script">G</mml:mi></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq87.gif"/></alternatives></inline-formula> and whose associated suffixes in <inline-formula id="IEq88"><alternatives><tex-math id="M175">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {L(S)}$\end{document}</tex-math><mml:math id="M176"><mml:mi mathvariant="script">ℒ</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq88.gif"/></alternatives></inline-formula> share a common context (<italic>u</italic>-occurrence) of a minimum length <italic>α</italic>; Step 2. We analyze <italic>α</italic>-clusters in order to evaluate a degree of similarity between any read and any genome in <inline-formula id="IEq89"><alternatives><tex-math id="M177">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {S}$\end{document}</tex-math><mml:math id="M178"><mml:mi mathvariant="script">S</mml:mi></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq89.gif"/></alternatives></inline-formula> by using two different approaches:
<list list-type="alpha-lower"><list-item><p>by reading both <inline-formula id="IEq90"><alternatives><tex-math id="M179">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\textsf {da}(\mathcal {S})$\end{document}</tex-math><mml:math id="M180"><mml:mtext mathvariant="sans-serif">da</mml:mtext><mml:mo>(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq90.gif"/></alternatives></inline-formula> and <inline-formula id="IEq91"><alternatives><tex-math id="M181">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\textsf {ebwt}(\mathcal {S})$\end{document}</tex-math><mml:math id="M182"><mml:mtext mathvariant="sans-serif">ebwt</mml:mtext><mml:mo>(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq91.gif"/></alternatives></inline-formula>, and</p></list-item><list-item><p>by reading only <inline-formula id="IEq92"><alternatives><tex-math id="M183">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\textsf {da}(\mathcal {S})$\end{document}</tex-math><mml:math id="M184"><mml:mtext mathvariant="sans-serif">da</mml:mtext><mml:mo>(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq92.gif"/></alternatives></inline-formula>.</p></list-item></list>Step 3. We perform the read assignment: every read is assigned to a specific taxon either at a given taxonomic level (if it is specified) or at any level by taking advantage of the taxonomic lineage of taxa.</p>
      <p><bold>Step 1: build</bold><bold><italic>α</italic></bold><bold>-clusters collection —</bold> In Step 1, inspired by Remark 1, we build the collection <inline-formula id="IEq93"><alternatives><tex-math id="M185">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {C}_{\alpha }$\end{document}</tex-math><mml:math id="M186"><mml:msub><mml:mrow><mml:mi mathvariant="script">C</mml:mi></mml:mrow><mml:mrow><mml:mi>α</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq93.gif"/></alternatives></inline-formula> of <italic>α</italic>-clusters, which are blocks of symbols delimited by a pair of indices.</p>
      <sec id="d30e2985">
        <title>
          <bold>Definition 1</bold>
        </title>
        <p>Let <italic>α</italic> be a positive integer, lcp[1,<italic>N</italic>+1] be the LCP-array and da[1,<italic>N</italic>] the document array associated with ebwt[1,<italic>N</italic>]. An <italic>α</italic><italic>-cluster</italic> of <inline-formula id="IEq94"><alternatives><tex-math id="M187">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\textsf {ebwt}(\mathcal {S})$\end{document}</tex-math><mml:math id="M188"><mml:mtext mathvariant="sans-serif">ebwt</mml:mtext><mml:mo>(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq94.gif"/></alternatives></inline-formula> of size <italic>p</italic><italic>E</italic>−<italic>p</italic><italic>S</italic>+1 is any pair of indices (<italic>p</italic><italic>S</italic>,<italic>p</italic><italic>E</italic>) in [1,<italic>N</italic>] such that ∙ lcp[ <italic>p</italic><italic>S</italic>]&lt;<italic>α</italic>, and lcp[<italic>p</italic><italic>E</italic>+1]&lt;<italic>α</italic>, ∙ lcp[ <italic>i</italic>]≥<italic>α</italic>, for every <italic>p</italic><italic>S</italic>&lt;<italic>i</italic>≤<italic>p</italic><italic>E</italic>, ∙ there exist two indices <italic>s</italic>,<italic>t</italic>, <italic>p</italic><italic>S</italic>≤<italic>s</italic>,<italic>t</italic>≤<italic>p</italic><italic>E</italic>, such that da[ <italic>s</italic>]≤<italic>r</italic> and da[ <italic>t</italic>]&gt;<italic>r</italic>,</p>
        <p>where <italic>r</italic> is the total number of reads in <inline-formula id="IEq95"><alternatives><tex-math id="M189">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {S}$\end{document}</tex-math><mml:math id="M190"><mml:mi mathvariant="script">S</mml:mi></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq95.gif"/></alternatives></inline-formula>.</p>
      </sec>
      <sec id="d30e3137">
        <title>
          <bold>Example 2</bold>
        </title>
        <p>(running example) By setting <italic>r</italic>=1 and <italic>g</italic>=2, we have <inline-formula id="IEq96"><alternatives><tex-math id="M191">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {R}=\{S_{1}\}$\end{document}</tex-math><mml:math id="M192"><mml:mi mathvariant="script">R</mml:mi><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq96.gif"/></alternatives></inline-formula> and <inline-formula id="IEq97"><alternatives><tex-math id="M193">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {G}=\{S_{2},S_{3}\}$\end{document}</tex-math><mml:math id="M194"><mml:mi mathvariant="script">G</mml:mi><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq97.gif"/></alternatives></inline-formula>. For <italic>α</italic>=2, the set <inline-formula id="IEq98"><alternatives><tex-math id="M195">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {C}_{2}$\end{document}</tex-math><mml:math id="M196"><mml:msub><mml:mrow><mml:mi mathvariant="script">C</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq98.gif"/></alternatives></inline-formula> of 2-clusters of the <inline-formula id="IEq99"><alternatives><tex-math id="M197">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\textsf {ebwt}(\mathcal {S})$\end{document}</tex-math><mml:math id="M198"><mml:mtext mathvariant="sans-serif">ebwt</mml:mtext><mml:mo>(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq99.gif"/></alternatives></inline-formula> is given by {(5,8),(14,17),(20,21),(22,25),(26,27),(30,32)}, as depicted in Fig. <xref rid="Fig1" ref-type="fig">1</xref>.</p>
        <p>In other words, we discard the blocks of <inline-formula id="IEq100"><alternatives><tex-math id="M199">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\textsf {ebwt}(\mathcal {S})$\end{document}</tex-math><mml:math id="M200"><mml:mtext mathvariant="sans-serif">ebwt</mml:mtext><mml:mo>(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq100.gif"/></alternatives></inline-formula> whose associated suffixes do not share a prefix of length at least <italic>α</italic> or that contain symbols belonging only to one set (<inline-formula id="IEq101"><alternatives><tex-math id="M201">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {R}$\end{document}</tex-math><mml:math id="M202"><mml:mi mathvariant="script">R</mml:mi></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq101.gif"/></alternatives></inline-formula> or <inline-formula id="IEq102"><alternatives><tex-math id="M203">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {G}$\end{document}</tex-math><mml:math id="M204"><mml:mi mathvariant="script">G</mml:mi></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq102.gif"/></alternatives></inline-formula>). Setting a minimum LCP <italic>α</italic> is to filter out blocks corresponding to short random contexts (<italic>u</italic>-occurrences) which are statistically not significant, while imposing symbols from both sets is appropriate for next step’s calculations. Moreover, since the genomes in <inline-formula id="IEq103"><alternatives><tex-math id="M205">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {G}$\end{document}</tex-math><mml:math id="M206"><mml:mi mathvariant="script">G</mml:mi></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq103.gif"/></alternatives></inline-formula> are (usually) long sequences, the parameter <italic>α</italic> must be chosen smaller than the read length (sequences in <inline-formula id="IEq104"><alternatives><tex-math id="M207">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {R}$\end{document}</tex-math><mml:math id="M208"><mml:mi mathvariant="script">R</mml:mi></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq104.gif"/></alternatives></inline-formula>) to have <inline-formula id="IEq105"><alternatives><tex-math id="M209">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {C}_{\alpha }$\end{document}</tex-math><mml:math id="M210"><mml:msub><mml:mrow><mml:mi mathvariant="script">C</mml:mi></mml:mrow><mml:mrow><mml:mi>α</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq105.gif"/></alternatives></inline-formula> not empty.</p>
        <p>Step 1 can be performed by a sequential scan over <inline-formula id="IEq106"><alternatives><tex-math id="M211">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\textsf {lcp}(\mathcal {S})$\end{document}</tex-math><mml:math id="M212"><mml:mtext mathvariant="sans-serif">lcp</mml:mtext><mml:mo>(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq106.gif"/></alternatives></inline-formula> and <inline-formula id="IEq107"><alternatives><tex-math id="M213">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\textsf {da}(\mathcal {S})$\end{document}</tex-math><mml:math id="M214"><mml:mtext mathvariant="sans-serif">da</mml:mtext><mml:mo>(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq107.gif"/></alternatives></inline-formula> allowing us to keep the input data structures in external memory and use only a small amount of internal memory to detect <italic>α</italic>-clusters. Since the clusters do not overlap, we implemented LiME so that it performs this construction in parallel way, by dividing the data structures appropriately.</p>
        <p>It is easy to see that we compute the similarity between a read <inline-formula id="IEq108"><alternatives><tex-math id="M215">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$S_{i}\in \mathcal {R}$\end{document}</tex-math><mml:math id="M216"><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:mi mathvariant="script">R</mml:mi></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq108.gif"/></alternatives></inline-formula> and a genome <inline-formula id="IEq109"><alternatives><tex-math id="M217">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$S_{j}\in \mathcal {G}$\end{document}</tex-math><mml:math id="M218"><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:mi mathvariant="script">G</mml:mi></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq109.gif"/></alternatives></inline-formula> by analyzing the data structures of the entire set of sequences <inline-formula id="IEq110"><alternatives><tex-math id="M219">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {S}$\end{document}</tex-math><mml:math id="M220"><mml:mi mathvariant="script">S</mml:mi></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq110.gif"/></alternatives></inline-formula>, not only the two sequences <italic>S</italic><sub><italic>i</italic></sub> and <italic>S</italic><sub><italic>j</italic></sub>. This is possible according to the following remark.</p>
      </sec>
      <sec id="d30e3429">
        <title>
          <bold>Remark 3</bold>
        </title>
        <p>Let (<italic>p</italic><italic>S</italic>,<italic>p</italic><italic>E</italic>) be an <italic>α</italic>-cluster of <inline-formula id="IEq111"><alternatives><tex-math id="M221">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\textsf {ebwt}(\mathcal {S})$\end{document}</tex-math><mml:math id="M222"><mml:mtext mathvariant="sans-serif">ebwt</mml:mtext><mml:mo>(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq111.gif"/></alternatives></inline-formula> that contains at least a symbol of <italic>S</italic><sub><italic>i</italic></sub> and at least a symbol of <italic>S</italic><sub><italic>j</italic></sub>. Other symbols that belong to sequences in <inline-formula id="IEq112"><alternatives><tex-math id="M223">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {S}$\end{document}</tex-math><mml:math id="M224"><mml:mi mathvariant="script">S</mml:mi></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq112.gif"/></alternatives></inline-formula> apart from <italic>S</italic><sub><italic>i</italic></sub> and <italic>S</italic><sub><italic>j</italic></sub> may also appear in ebwt[<italic>p</italic><italic>S</italic>,<italic>p</italic><italic>E</italic>]. Nevertheless, we can implicitly get a new cluster (<italic>p</italic><italic>S</italic><sup>′</sup>,<italic>p</italic><italic>E</italic><sup>′</sup>) by deleting from the <inline-formula id="IEq113"><alternatives><tex-math id="M225">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\textsf {ebwt}(\mathcal {S})$\end{document}</tex-math><mml:math id="M226"><mml:mtext mathvariant="sans-serif">ebwt</mml:mtext><mml:mo>(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq113.gif"/></alternatives></inline-formula> all symbols not belonging to <italic>S</italic><sub><italic>i</italic></sub> and <italic>S</italic><sub><italic>j</italic></sub>, and for the properties of the LCP array, it is easy to verify that (<italic>p</italic><italic>S</italic><sup>′</sup>,<italic>p</italic><italic>E</italic><sup>′</sup>) forms an <italic>α</italic>-cluster of ebwt({<italic>S</italic><sub><italic>i</italic></sub>,<italic>S</italic><sub><italic>j</italic></sub>}).</p>
        <p><bold>Step 2: build the similarity matrix —</bold>We compute the <inline-formula id="IEq114"><alternatives><tex-math id="M227">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$|\mathcal {R}| \times |\mathcal {G}|$\end{document}</tex-math><mml:math id="M228"><mml:mo>|</mml:mo><mml:mi mathvariant="script">R</mml:mi><mml:mo>|</mml:mo><mml:mo>×</mml:mo><mml:mo>|</mml:mo><mml:mi mathvariant="script">G</mml:mi><mml:mo>|</mml:mo></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq114.gif"/></alternatives></inline-formula> similarity matrix by analyzing the <italic>α</italic>-clusters detected in the previous step. The idea in this step is to use the information from the clustering effect in <inline-formula id="IEq115"><alternatives><tex-math id="M229">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\textsf {ebwt}(\mathcal {S})$\end{document}</tex-math><mml:math id="M230"><mml:mtext mathvariant="sans-serif">ebwt</mml:mtext><mml:mo>(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq115.gif"/></alternatives></inline-formula> and the mixed colors in <inline-formula id="IEq116"><alternatives><tex-math id="M231">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\textsf {da}(\mathcal {S})$\end{document}</tex-math><mml:math id="M232"><mml:mtext mathvariant="sans-serif">da</mml:mtext><mml:mo>(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq116.gif"/></alternatives></inline-formula>. Also in this step, we perform sequential scans of the input data structures.</p>
        <p>During the second step, we analyze each <italic>α</italic>-cluster of the <inline-formula id="IEq117"><alternatives><tex-math id="M233">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\textsf {ebwt}(\mathcal {S})$\end{document}</tex-math><mml:math id="M234"><mml:mtext mathvariant="sans-serif">ebwt</mml:mtext><mml:mo>(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq117.gif"/></alternatives></inline-formula> by using one of the two approaches:
<list list-type="alpha-lower"><list-item><p>by reading both <inline-formula id="IEq118"><alternatives><tex-math id="M235">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\textsf {da}(\mathcal {S})$\end{document}</tex-math><mml:math id="M236"><mml:mtext mathvariant="sans-serif">da</mml:mtext><mml:mo>(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq118.gif"/></alternatives></inline-formula> and <inline-formula id="IEq119"><alternatives><tex-math id="M237">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\textsf {ebwt}(\mathcal {S})$\end{document}</tex-math><mml:math id="M238"><mml:mtext mathvariant="sans-serif">ebwt</mml:mtext><mml:mo>(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq119.gif"/></alternatives></inline-formula>,</p></list-item><list-item><p>by reading only <inline-formula id="IEq120"><alternatives><tex-math id="M239">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\textsf {da}(\mathcal {S})$\end{document}</tex-math><mml:math id="M240"><mml:mtext mathvariant="sans-serif">da</mml:mtext><mml:mo>(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq120.gif"/></alternatives></inline-formula>,</p></list-item></list></p>
        <p>Then, we measure the degree of similarity between each sequence in <inline-formula id="IEq121"><alternatives><tex-math id="M241">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {R}$\end{document}</tex-math><mml:math id="M242"><mml:mi mathvariant="script">R</mml:mi></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq121.gif"/></alternatives></inline-formula> and each genome in <inline-formula id="IEq122"><alternatives><tex-math id="M243">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {G}$\end{document}</tex-math><mml:math id="M244"><mml:mi mathvariant="script">G</mml:mi></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq122.gif"/></alternatives></inline-formula>.</p>
        <p>In the first approach, whose related measure we call <italic>α</italic><sup>eBWT</sup>-similarity, we consider the symbols that appear in the <italic>α</italic>-clusters by making an exact correspondence between the symbols belonging to <inline-formula id="IEq123"><alternatives><tex-math id="M245">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {R}$\end{document}</tex-math><mml:math id="M246"><mml:mi mathvariant="script">R</mml:mi></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq123.gif"/></alternatives></inline-formula> and <inline-formula id="IEq124"><alternatives><tex-math id="M247">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {G}$\end{document}</tex-math><mml:math id="M248"><mml:mi mathvariant="script">G</mml:mi></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq124.gif"/></alternatives></inline-formula> and taking into account the ambiguity of the IUPAC codes<xref ref-type="fn" rid="Fn3">3</xref>. For each <italic>α</italic>-cluster, we count first the number of occurrences of symbols of each read that we can associate with the occurrences of the same symbol of each genome appearing in the <italic>α</italic>-cluster and then we count the ambiguity symbols of each read (resp. genome) if they match a genome (resp. read) symbol that is associated with its code. Then, we sum these two values.</p>
      </sec>
      <sec id="d30e3793">
        <title>
          <bold>Definition 2</bold>
        </title>
        <p>Let <inline-formula id="IEq125"><alternatives><tex-math id="M249">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {C}_{\alpha }$\end{document}</tex-math><mml:math id="M250"><mml:msub><mml:mrow><mml:mi mathvariant="script">C</mml:mi></mml:mrow><mml:mrow><mml:mi>α</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq125.gif"/></alternatives></inline-formula> be the set of all the <italic>α</italic>-clusters associated with <inline-formula id="IEq126"><alternatives><tex-math id="M251">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\textsf {ebwt}(\mathcal {S})$\end{document}</tex-math><mml:math id="M252"><mml:mtext mathvariant="sans-serif">ebwt</mml:mtext><mml:mo>(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq126.gif"/></alternatives></inline-formula>. We define the <italic>α</italic><sup>eBWT</sup><italic>-similarity</italic> between two sequences <inline-formula id="IEq127"><alternatives><tex-math id="M253">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$S_{i}\in \mathcal {R}$\end{document}</tex-math><mml:math id="M254"><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:mi mathvariant="script">R</mml:mi></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq127.gif"/></alternatives></inline-formula> and <inline-formula id="IEq128"><alternatives><tex-math id="M255">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$S_{j}\in \mathcal {G}$\end{document}</tex-math><mml:math id="M256"><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:mi mathvariant="script">G</mml:mi></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq128.gif"/></alternatives></inline-formula> as the quantity
<disp-formula id="Equa"><alternatives><tex-math id="M257">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ \mathfrak{S}^{\text{eBWT}}_{\alpha}(S_{i},S_{j})=\sum_{x\in\mathcal{C}_{\alpha}} \left(\sum_{a\in\Sigma} \min\,\left(\text{occ}_{a}{(i,x)},\text{occ}_{a}{(j,x)}\right)+ \delta_{IUPAC}\right) $$ \end{document}</tex-math><mml:math id="M258"><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="fraktur">S</mml:mi></mml:mrow><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mtext>eBWT</mml:mtext></mml:mrow></mml:msubsup><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>x</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script">C</mml:mi></mml:mrow><mml:mrow><mml:mi>α</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:mfenced close=")" open="("><mml:mrow><mml:munder><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>a</mml:mi><mml:mo>∈</mml:mo><mml:mi>Σ</mml:mi></mml:mrow></mml:munder><mml:mo>min</mml:mo><mml:mspace width="0.3em"/><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mtext>occ</mml:mtext></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>x</mml:mi><mml:mo>)</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mtext>occ</mml:mtext></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>x</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>δ</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">IUPAC</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:math><graphic xlink:href="12859_2020_3628_Article_Equa.gif" position="anchor"/></alternatives></disp-formula> where occ<sub><italic>a</italic></sub>(<italic>i</italic>,<italic>x</italic>) (resp. occ<sub><italic>a</italic></sub>(<italic>j</italic>,<italic>x</italic>)) is the number of <italic>a</italic>-symbols belonging to <italic>S</italic><sub><italic>i</italic></sub> (resp. <italic>S</italic><sub><italic>j</italic></sub>) in the <italic>α</italic>-cluster <italic>x</italic>, and <italic>δ</italic><sub><italic>IUPAC</italic></sub> is obtained as the sum of the number of matchings between the remaining IUPAC ambiguity symbols of <italic>S</italic><sub><italic>i</italic></sub> (resp. <italic>S</italic><sub><italic>j</italic></sub>) with any remaining symbol associated with its code of <italic>S</italic><sub><italic>j</italic></sub> (resp. <italic>S</italic><sub><italic>i</italic></sub>).</p>
        <p>In the second approach, whose related measure we call <italic>α</italic><sup>DA</sup>-similarity, we only consider the number of symbols from <inline-formula id="IEq129"><alternatives><tex-math id="M259">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$S_{i}\in \mathcal {R}$\end{document}</tex-math><mml:math id="M260"><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:mi mathvariant="script">R</mml:mi></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq129.gif"/></alternatives></inline-formula> and <inline-formula id="IEq130"><alternatives><tex-math id="M261">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$S_{j}\in \mathcal {G}$\end{document}</tex-math><mml:math id="M262"><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:mi mathvariant="script">G</mml:mi></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq130.gif"/></alternatives></inline-formula> appearing in the <italic>α</italic>-clusters, that is, we disregard the correspondence between the symbols <italic>a</italic>∈<italic>Σ</italic> from <italic>S</italic><sub><italic>i</italic></sub> and <italic>S</italic><sub><italic>j</italic></sub> in the <italic>α</italic>-cluster. In order to do this, we scan sequentially the corresponding positions of the <italic>α</italic>-clusters in <inline-formula id="IEq131"><alternatives><tex-math id="M263">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\textsf {da}(\mathcal {S})$\end{document}</tex-math><mml:math id="M264"><mml:mtext mathvariant="sans-serif">da</mml:mtext><mml:mo>(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq131.gif"/></alternatives></inline-formula> counting the colors of <italic>S</italic><sub><italic>i</italic></sub> and <italic>S</italic><sub><italic>j</italic></sub>.</p>
      </sec>
      <sec id="d30e4176">
        <title>
          <bold>Definition 3</bold>
        </title>
        <p>Let <inline-formula id="IEq132"><alternatives><tex-math id="M265">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {C}_{\alpha }$\end{document}</tex-math><mml:math id="M266"><mml:msub><mml:mrow><mml:mi mathvariant="script">C</mml:mi></mml:mrow><mml:mrow><mml:mi>α</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq132.gif"/></alternatives></inline-formula> be the set of all the <italic>α</italic>-clusters associated with <inline-formula id="IEq133"><alternatives><tex-math id="M267">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\textsf {ebwt}(\mathcal {S})$\end{document}</tex-math><mml:math id="M268"><mml:mtext mathvariant="sans-serif">ebwt</mml:mtext><mml:mo>(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq133.gif"/></alternatives></inline-formula>. We define the <italic>α</italic><sup>DA</sup><italic>-similarity</italic> between two sequences <inline-formula id="IEq134"><alternatives><tex-math id="M269">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$S_{i}\in \mathcal {R}$\end{document}</tex-math><mml:math id="M270"><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:mi mathvariant="script">R</mml:mi></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq134.gif"/></alternatives></inline-formula> and <inline-formula id="IEq135"><alternatives><tex-math id="M271">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$S_{j}\in \mathcal {G}$\end{document}</tex-math><mml:math id="M272"><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:mi mathvariant="script">G</mml:mi></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq135.gif"/></alternatives></inline-formula> as the quantity
<disp-formula id="Equb"><alternatives><tex-math id="M273">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ \mathfrak{S}^{\text{DA}}_{\alpha}(S_{i},S_{j})=\sum_{x\in\mathcal{C}_{\alpha}} \min\,\left(\text{occ}{(i,x)},\text{occ}{(j,x)}\right) $$ \end{document}</tex-math><mml:math id="M274"><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="fraktur">S</mml:mi></mml:mrow><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mtext>DA</mml:mtext></mml:mrow></mml:msubsup><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>x</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script">C</mml:mi></mml:mrow><mml:mrow><mml:mi>α</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:mo>min</mml:mo><mml:mspace width="0.3em"/><mml:mfenced close=")" open="("><mml:mrow><mml:mtext>occ</mml:mtext><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>x</mml:mi><mml:mo>)</mml:mo><mml:mo>,</mml:mo><mml:mtext>occ</mml:mtext><mml:mo>(</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>x</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mfenced></mml:mrow></mml:math><graphic xlink:href="12859_2020_3628_Article_Equb.gif" position="anchor"/></alternatives></disp-formula> where occ(<italic>i</italic>,<italic>x</italic>) (resp. occ(j,x)) is the number of symbols belonging to <italic>S</italic><sub><italic>i</italic></sub> (resp. <italic>S</italic><sub><italic>j</italic></sub>) in the <italic>α</italic>-cluster <italic>x</italic>.</p>
        <p>Note that <inline-formula id="IEq136"><alternatives><tex-math id="M275">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$0 \leq \mathfrak {S}^{\text {eBWT}}_{\alpha }(S_{i},S_{j}) \leq \mathfrak {S}^{\text {DA}}_{\alpha }(S_{i},S_{j}) \leq \min (n_{i},n_{j})+1-\alpha $\end{document}</tex-math><mml:math id="M276"><mml:mn>0</mml:mn><mml:mo>≤</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="fraktur">S</mml:mi></mml:mrow><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mtext>eBWT</mml:mtext></mml:mrow></mml:msubsup><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>≤</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="fraktur">S</mml:mi></mml:mrow><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mtext>DA</mml:mtext></mml:mrow></mml:msubsup><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>≤</mml:mo><mml:mo>min</mml:mo><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>α</mml:mi></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq136.gif"/></alternatives></inline-formula>, where <italic>n</italic><sub><italic>i</italic></sub> (resp. <italic>n</italic><sub><italic>j</italic></sub>) is the length of <italic>S</italic><sub><italic>i</italic></sub> (resp. <italic>S</italic><sub><italic>j</italic></sub>). So, we can normalize the similarity values within the range [0,1] dividing them by min(<italic>n</italic><sub><italic>i</italic></sub>,<italic>n</italic><sub><italic>j</italic></sub>)+1−<italic>α</italic>.</p>
        <p>Let <inline-formula id="IEq137"><alternatives><tex-math id="M277">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {S}=\{S_{1}, \ldots, S_{r}, S_{r+1}, \ldots, S_{r+g} \}$\end{document}</tex-math><mml:math id="M278"><mml:mi mathvariant="script">S</mml:mi><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mo>+</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq137.gif"/></alternatives></inline-formula>. For each <italic>i</italic>=1,…,<italic>r</italic> and <italic>k</italic>=1,…,<italic>g</italic>, we build the matrix of similarity <inline-formula id="IEq138"><alternatives><tex-math id="M279">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {M}_{\alpha }$\end{document}</tex-math><mml:math id="M280"><mml:msub><mml:mrow><mml:mi mathvariant="script">ℳ</mml:mi></mml:mrow><mml:mrow><mml:mi>α</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq138.gif"/></alternatives></inline-formula> of dimension <italic>r</italic>×<italic>g</italic>, where
<disp-formula id="Equc"><alternatives><tex-math id="M281">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\mathcal{M}_{\alpha}[i][k]=\frac{\mathfrak{S}^{\text{eBWT}}_{\alpha}(S_{i},S_{j})}{\min(n_{i},n_{j})+1-\alpha}$$ \end{document}</tex-math><mml:math id="M282"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="script">ℳ</mml:mi></mml:mrow><mml:mrow><mml:mi>α</mml:mi></mml:mrow></mml:msub><mml:mo>[</mml:mo><mml:mi>i</mml:mi><mml:mo>]</mml:mo><mml:mo>[</mml:mo><mml:mi>k</mml:mi><mml:mo>]</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="fraktur">S</mml:mi></mml:mrow><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mtext>eBWT</mml:mtext></mml:mrow></mml:msubsup><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>min</mml:mo><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>α</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:math><graphic xlink:href="12859_2020_3628_Article_Equc.gif" position="anchor"/></alternatives></disp-formula> for the first approach, and
<disp-formula id="Equd"><alternatives><tex-math id="M283">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\mathcal{M}_{\alpha}[i][k]=\frac{\mathfrak{S}^{\text{DA}}_{\alpha}(S_{i},S_{j})}{\min(n_{i},n_{j})+1-\alpha}$$ \end{document}</tex-math><mml:math id="M284"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="script">ℳ</mml:mi></mml:mrow><mml:mrow><mml:mi>α</mml:mi></mml:mrow></mml:msub><mml:mo>[</mml:mo><mml:mi>i</mml:mi><mml:mo>]</mml:mo><mml:mo>[</mml:mo><mml:mi>k</mml:mi><mml:mo>]</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="fraktur">S</mml:mi></mml:mrow><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mtext>DA</mml:mtext></mml:mrow></mml:msubsup><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>min</mml:mo><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>α</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:math><graphic xlink:href="12859_2020_3628_Article_Equd.gif" position="anchor"/></alternatives></disp-formula> for the second approach.</p>
      </sec>
      <sec id="d30e4816">
        <title>
          <bold>Example 3</bold>
        </title>
        <p>(running example) For <italic>α</italic>=2, both the <italic>α</italic><sup>eBWT</sup>-similarity and the <italic>α</italic><sup>DA</sup>-similarity between <italic>S</italic><sub>1</sub> and <italic>S</italic><sub>2</sub> are given by the sum 0+1+1+1+1+1=5, which by normalizing holds <inline-formula id="IEq139"><alternatives><tex-math id="M285">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathfrak {S}^{\text {eBWT}}_{2}(S_{1},S_{2})/8=\mathfrak {S}^{\text {DA}}_{2}(S_{1},S_{2})/8=0.625$\end{document}</tex-math><mml:math id="M286"><mml:msubsup><mml:mrow><mml:mi mathvariant="fraktur">S</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mtext>eBWT</mml:mtext></mml:mrow></mml:msubsup><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>/</mml:mo><mml:mn>8</mml:mn><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="fraktur">S</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mtext>DA</mml:mtext></mml:mrow></mml:msubsup><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>/</mml:mo><mml:mn>8</mml:mn><mml:mo>=</mml:mo><mml:mn>0.625</mml:mn></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq139.gif"/></alternatives></inline-formula>.</p>
        <p>On the other hand, the <italic>α</italic><sup>eBWT</sup>-similarity between <italic>S</italic><sub>1</sub> and <italic>S</italic><sub>3</sub> is given by <inline-formula id="IEq140"><alternatives><tex-math id="M287">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathfrak {S}^{\text {eBWT}}_{2}(S_{1},S_{3})= 1+0+0+0+0+1=2$\end{document}</tex-math><mml:math id="M288"><mml:msubsup><mml:mrow><mml:mi mathvariant="fraktur">S</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mtext>eBWT</mml:mtext></mml:mrow></mml:msubsup><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mn>0</mml:mn><mml:mo>+</mml:mo><mml:mn>0</mml:mn><mml:mo>+</mml:mo><mml:mn>0</mml:mn><mml:mo>+</mml:mo><mml:mn>0</mml:mn><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq140.gif"/></alternatives></inline-formula>, by normalizing <inline-formula id="IEq141"><alternatives><tex-math id="M289">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathfrak {S}^{\text {eBWT}}_{2}(S_{1},S_{3})/8=0.250$\end{document}</tex-math><mml:math id="M290"><mml:msubsup><mml:mrow><mml:mi mathvariant="fraktur">S</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mtext>eBWT</mml:mtext></mml:mrow></mml:msubsup><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>/</mml:mo><mml:mn>8</mml:mn><mml:mo>=</mml:mo><mml:mn>0.250</mml:mn></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq141.gif"/></alternatives></inline-formula>. Note that, since the ambiguity symbol <italic>R</italic> is associated with <italic>A</italic> and <italic>G</italic>, we have one match in the last cluster (i.e., <italic>R</italic> matches with <italic>G</italic>). While the <italic>α</italic><sup>DA</sup>-similarity is given by <inline-formula id="IEq142"><alternatives><tex-math id="M291">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathfrak {S}^{\text {DA}}_{2}(S_{1},S_{3})= 1+1+0+0+0+1=3$\end{document}</tex-math><mml:math id="M292"><mml:msubsup><mml:mrow><mml:mi mathvariant="fraktur">S</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mtext>DA</mml:mtext></mml:mrow></mml:msubsup><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mn>0</mml:mn><mml:mo>+</mml:mo><mml:mn>0</mml:mn><mml:mo>+</mml:mo><mml:mn>0</mml:mn><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>=</mml:mo><mml:mn>3</mml:mn></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq142.gif"/></alternatives></inline-formula>, which normalized is 0.375.</p>
        <p>We observe that <inline-formula id="IEq143"><alternatives><tex-math id="M293">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathfrak {S}^{\text {DA}}_{\alpha }(S_{i},S_{j})$\end{document}</tex-math><mml:math id="M294"><mml:msubsup><mml:mrow><mml:mi mathvariant="fraktur">S</mml:mi></mml:mrow><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mtext>DA</mml:mtext></mml:mrow></mml:msubsup><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq143.gif"/></alternatives></inline-formula> differs from <inline-formula id="IEq144"><alternatives><tex-math id="M295">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathfrak {S}^{\text {eBWT}}_{\alpha }(S_{i},S_{j})$\end{document}</tex-math><mml:math id="M296"><mml:msubsup><mml:mrow><mml:mi mathvariant="fraktur">S</mml:mi></mml:mrow><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mtext>eBWT</mml:mtext></mml:mrow></mml:msubsup><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq144.gif"/></alternatives></inline-formula> and from the measure defined in [<xref ref-type="bibr" rid="CR45">45</xref>], since it does not take into account whether a symbol is an ambiguous character or not, so we expect the classification w.r.t. <inline-formula id="IEq145"><alternatives><tex-math id="M297">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathfrak {S}^{\text {eBWT}}_{\alpha }(S_{i},S_{j})$\end{document}</tex-math><mml:math id="M298"><mml:msubsup><mml:mrow><mml:mi mathvariant="fraktur">S</mml:mi></mml:mrow><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mtext>eBWT</mml:mtext></mml:mrow></mml:msubsup><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq145.gif"/></alternatives></inline-formula> to be more precise and less sensitive than that w.r.t. <inline-formula id="IEq146"><alternatives><tex-math id="M299">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathfrak {S}^{\text {DA}}_{\alpha }(S_{i},S_{j})$\end{document}</tex-math><mml:math id="M300"><mml:msubsup><mml:mrow><mml:mi mathvariant="fraktur">S</mml:mi></mml:mrow><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mtext>DA</mml:mtext></mml:mrow></mml:msubsup><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq146.gif"/></alternatives></inline-formula>, while computing <inline-formula id="IEq147"><alternatives><tex-math id="M301">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathfrak {S}^{\text {DA}}_{\alpha }(S_{i},S_{j})$\end{document}</tex-math><mml:math id="M302"><mml:msubsup><mml:mrow><mml:mi mathvariant="fraktur">S</mml:mi></mml:mrow><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mtext>DA</mml:mtext></mml:mrow></mml:msubsup><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq147.gif"/></alternatives></inline-formula> should be faster than <inline-formula id="IEq148"><alternatives><tex-math id="M303">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathfrak {S}^{\text {eBWT}}_{\alpha }(S_{i},S_{j})$\end{document}</tex-math><mml:math id="M304"><mml:msubsup><mml:mrow><mml:mi mathvariant="fraktur">S</mml:mi></mml:mrow><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mtext>eBWT</mml:mtext></mml:mrow></mml:msubsup><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq148.gif"/></alternatives></inline-formula>. The experiments reported on both simulated and real datasets confirm these facts.</p>
        <p>Both approaches of Step 2 allow to analyze <italic>α</italic>-clusters independently: indeed, we can analyze the clusters in <inline-formula id="IEq149"><alternatives><tex-math id="M305">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {C}_{\alpha }$\end{document}</tex-math><mml:math id="M306"><mml:msub><mml:mrow><mml:mi mathvariant="script">C</mml:mi></mml:mrow><mml:mrow><mml:mi>α</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq149.gif"/></alternatives></inline-formula> one by one through <inline-formula id="IEq150"><alternatives><tex-math id="M307">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$|\mathcal {C}_{\alpha }|$\end{document}</tex-math><mml:math id="M308"><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script">C</mml:mi></mml:mrow><mml:mrow><mml:mi>α</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq150.gif"/></alternatives></inline-formula> iterations, or in parallel exploiting the fact that <italic>α</italic>-clusters are pairs of indices not overlapping.</p>
        <p><bold>Single-read and Paired-end read collections —</bold> LiME is designed to work either with single-read collection or with paired-end reads of any insert size. In addition, both the original sequences and their reverse complements must be considered in order to keep reads properly oriented (original reads’ strand directions are unknown). Paired-end reads (and their reverse complement) are treated initially as two single reads, so that they can overlap and align in several ways. Then, our tool exploits the pairing information during the classification step, which we describe in the next paragraph. Therefore, in case of single-read collections, we keep two read sets, <inline-formula id="IEq151"><alternatives><tex-math id="M309">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {R}$\end{document}</tex-math><mml:math id="M310"><mml:mi mathvariant="script">R</mml:mi></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq151.gif"/></alternatives></inline-formula> and <inline-formula id="IEq152"><alternatives><tex-math id="M311">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {R}^{RC}$\end{document}</tex-math><mml:math id="M312"><mml:msup><mml:mrow><mml:mi mathvariant="script">R</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">RC</mml:mtext></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq152.gif"/></alternatives></inline-formula>, with forward and reverse complement. After performing the procedures at Step 1 and Step 2 for the data structures of both <inline-formula id="IEq153"><alternatives><tex-math id="M313">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {R} \cup \mathcal {G}$\end{document}</tex-math><mml:math id="M314"><mml:mi mathvariant="script">R</mml:mi><mml:mo>∪</mml:mo><mml:mi mathvariant="script">G</mml:mi></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq153.gif"/></alternatives></inline-formula> and <inline-formula id="IEq154"><alternatives><tex-math id="M315">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {R}^{RC}\cup \mathcal {G}$\end{document}</tex-math><mml:math id="M316"><mml:msup><mml:mrow><mml:mi mathvariant="script">R</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">RC</mml:mtext></mml:mrow></mml:msup><mml:mo>∪</mml:mo><mml:mi mathvariant="script">G</mml:mi></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq154.gif"/></alternatives></inline-formula>, to perform classification we use the information coming either from <inline-formula id="IEq155"><alternatives><tex-math id="M317">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {R}\cup \mathcal {G}$\end{document}</tex-math><mml:math id="M318"><mml:mi mathvariant="script">R</mml:mi><mml:mo>∪</mml:mo><mml:mi mathvariant="script">G</mml:mi></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq155.gif"/></alternatives></inline-formula> or from the reverse complement <inline-formula id="IEq156"><alternatives><tex-math id="M319">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {R}^{RC}\cup \mathcal {G}$\end{document}</tex-math><mml:math id="M320"><mml:msup><mml:mrow><mml:mi mathvariant="script">R</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">RC</mml:mtext></mml:mrow></mml:msup><mml:mo>∪</mml:mo><mml:mi mathvariant="script">G</mml:mi></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq156.gif"/></alternatives></inline-formula>. On the other hand, if we have a paired-end read collection made of sets <inline-formula id="IEq157"><alternatives><tex-math id="M321">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {R}_{1}$\end{document}</tex-math><mml:math id="M322"><mml:msub><mml:mrow><mml:mi mathvariant="script">R</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq157.gif"/></alternatives></inline-formula> and <inline-formula id="IEq158"><alternatives><tex-math id="M323">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {R}_{2}$\end{document}</tex-math><mml:math id="M324"><mml:msub><mml:mrow><mml:mi mathvariant="script">R</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq158.gif"/></alternatives></inline-formula>, the available information to perform the read classification comes from both paired-end reads and their reverse complements: thus, after performing the first two steps for the four input data structures (<inline-formula id="IEq159"><alternatives><tex-math id="M325">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {R}_{1} \cup \mathcal {G}$\end{document}</tex-math><mml:math id="M326"><mml:msub><mml:mrow><mml:mi mathvariant="script">R</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>∪</mml:mo><mml:mi mathvariant="script">G</mml:mi></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq159.gif"/></alternatives></inline-formula>, <inline-formula id="IEq160"><alternatives><tex-math id="M327">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {R}_{1}^{RC}\cup \mathcal {G}$\end{document}</tex-math><mml:math id="M328"><mml:msubsup><mml:mrow><mml:mi mathvariant="script">R</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">RC</mml:mtext></mml:mrow></mml:msubsup><mml:mo>∪</mml:mo><mml:mi mathvariant="script">G</mml:mi></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq160.gif"/></alternatives></inline-formula>, <inline-formula id="IEq161"><alternatives><tex-math id="M329">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {R}_{2}\cup \mathcal {G}$\end{document}</tex-math><mml:math id="M330"><mml:msub><mml:mrow><mml:mi mathvariant="script">R</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>∪</mml:mo><mml:mi mathvariant="script">G</mml:mi></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq161.gif"/></alternatives></inline-formula> and <inline-formula id="IEq162"><alternatives><tex-math id="M331">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {R}_{2}^{RC}\cup \mathcal {G}$\end{document}</tex-math><mml:math id="M332"><mml:msubsup><mml:mrow><mml:mi mathvariant="script">R</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">RC</mml:mtext></mml:mrow></mml:msubsup><mml:mo>∪</mml:mo><mml:mi mathvariant="script">G</mml:mi></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq162.gif"/></alternatives></inline-formula>), we obtain four similarity matrices, denoted by <inline-formula id="IEq163"><alternatives><tex-math id="M333">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {M}^{1F}_{\alpha }$\end{document}</tex-math><mml:math id="M334"><mml:msubsup><mml:mrow><mml:mi mathvariant="script">ℳ</mml:mi></mml:mrow><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mi>F</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq163.gif"/></alternatives></inline-formula>, <inline-formula id="IEq164"><alternatives><tex-math id="M335">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {M}^{1RC}_{\alpha }$\end{document}</tex-math><mml:math id="M336"><mml:msubsup><mml:mrow><mml:mi mathvariant="script">ℳ</mml:mi></mml:mrow><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mtext mathvariant="italic">RC</mml:mtext></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq164.gif"/></alternatives></inline-formula>, <inline-formula id="IEq165"><alternatives><tex-math id="M337">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {M}^{2F}_{\alpha }$\end{document}</tex-math><mml:math id="M338"><mml:msubsup><mml:mrow><mml:mi mathvariant="script">ℳ</mml:mi></mml:mrow><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>F</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq165.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq166"><alternatives><tex-math id="M339">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {M}^{2RC}_{\alpha }$\end{document}</tex-math><mml:math id="M340"><mml:msubsup><mml:mrow><mml:mi mathvariant="script">ℳ</mml:mi></mml:mrow><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mtext mathvariant="italic">RC</mml:mtext></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq166.gif"/></alternatives></inline-formula>, and to classify the pair of reads, we recollect the pairing information. Actually, our theoretical approach holds also if one uses a unique data structure for both mates and their reverse complements (without replicating the genomes) and if one uses the reverse complement of the genome set (rather than the read set).</p>
        <p><bold>Step 3: classification—</bold> The last step consists in assigning a unique provenance to any read in the input collection. In this step, one can specify a minimum taxonomic level (e.g., genome, species, genus or higher) that will be the minimum rank considered in the classification by LiME. Indeed, LiME can classify at higher levels by taking advantage of the taxonomic lineage of taxa.</p>
        <p>To perform the assignment we need to take into account both strands (forward and reverse-complement) or, if a paired-end reads collection is available, we take both strands of each paired-end read.</p>
        <p>Here, we consider the case where the input collection is paired-end (we have <inline-formula id="IEq167"><alternatives><tex-math id="M341">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$|\mathcal {R}_{1}|=|\mathcal {R}_{2}|=r)$\end{document}</tex-math><mml:math id="M342"><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script">R</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mo>=</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script">R</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mo>=</mml:mo><mml:mi>r</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq167.gif"/></alternatives></inline-formula>. Thus, for any index <italic>i</italic>, with 1≤<italic>i</italic>≤<italic>r</italic>, the entry <inline-formula id="IEq168"><alternatives><tex-math id="M343">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\overline {R}_{i}$\end{document}</tex-math><mml:math id="M344"><mml:msub><mml:mrow><mml:mover accent="false"><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mo accent="true">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq168.gif"/></alternatives></inline-formula> of a paired-end collection is associated with four different reads each one belonging to one of the sets <inline-formula id="IEq169"><alternatives><tex-math id="M345">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {R}_{1}$\end{document}</tex-math><mml:math id="M346"><mml:msub><mml:mrow><mml:mi mathvariant="script">R</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq169.gif"/></alternatives></inline-formula>, <inline-formula id="IEq170"><alternatives><tex-math id="M347">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {R}_{1}^{RC}$\end{document}</tex-math><mml:math id="M348"><mml:msubsup><mml:mrow><mml:mi mathvariant="script">R</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">RC</mml:mtext></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq170.gif"/></alternatives></inline-formula>, <inline-formula id="IEq171"><alternatives><tex-math id="M349">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {R}_{2}$\end{document}</tex-math><mml:math id="M350"><mml:msub><mml:mrow><mml:mi mathvariant="script">R</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq171.gif"/></alternatives></inline-formula>, <inline-formula id="IEq172"><alternatives><tex-math id="M351">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {R}_{2}^{RC}$\end{document}</tex-math><mml:math id="M352"><mml:msubsup><mml:mrow><mml:mi mathvariant="script">R</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">RC</mml:mtext></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq172.gif"/></alternatives></inline-formula>. Recall that, as output of Step 2, we obtained respectively the four similarity matrices <inline-formula id="IEq173"><alternatives><tex-math id="M353">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {M}^{1F}_{\alpha }$\end{document}</tex-math><mml:math id="M354"><mml:msubsup><mml:mrow><mml:mi mathvariant="script">ℳ</mml:mi></mml:mrow><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mi>F</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq173.gif"/></alternatives></inline-formula>, <inline-formula id="IEq174"><alternatives><tex-math id="M355">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {M}^{1RC}_{\alpha }$\end{document}</tex-math><mml:math id="M356"><mml:msubsup><mml:mrow><mml:mi mathvariant="script">ℳ</mml:mi></mml:mrow><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mtext mathvariant="italic">RC</mml:mtext></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq174.gif"/></alternatives></inline-formula>, <inline-formula id="IEq175"><alternatives><tex-math id="M357">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {M}^{2F}_{\alpha }$\end{document}</tex-math><mml:math id="M358"><mml:msubsup><mml:mrow><mml:mi mathvariant="script">ℳ</mml:mi></mml:mrow><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>F</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq175.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq176"><alternatives><tex-math id="M359">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {M}^{2RC}_{\alpha }$\end{document}</tex-math><mml:math id="M360"><mml:msubsup><mml:mrow><mml:mi mathvariant="script">ℳ</mml:mi></mml:mrow><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mtext mathvariant="italic">RC</mml:mtext></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq176.gif"/></alternatives></inline-formula>, each one of size <italic>r</italic>×<italic>g</italic>, where <italic>g</italic> is the size of the genome set <inline-formula id="IEq177"><alternatives><tex-math id="M361">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {G}$\end{document}</tex-math><mml:math id="M362"><mml:mi mathvariant="script">G</mml:mi></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq177.gif"/></alternatives></inline-formula>.</p>
        <p>We remark that if we have a single-read collection, we can proceed similarly skipping the information about the mates <inline-formula id="IEq178"><alternatives><tex-math id="M363">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {R}_{2}$\end{document}</tex-math><mml:math id="M364"><mml:msub><mml:mrow><mml:mi mathvariant="script">R</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq178.gif"/></alternatives></inline-formula> and <inline-formula id="IEq179"><alternatives><tex-math id="M365">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {R}_{2}^{RC}$\end{document}</tex-math><mml:math id="M366"><mml:msubsup><mml:mrow><mml:mi mathvariant="script">R</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">RC</mml:mtext></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq179.gif"/></alternatives></inline-formula>.</p>
        <p>To assign each entry <inline-formula id="IEq180"><alternatives><tex-math id="M367">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\overline {R}_{i}$\end{document}</tex-math><mml:math id="M368"><mml:msub><mml:mrow><mml:mover accent="false"><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mo accent="true">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq180.gif"/></alternatives></inline-formula> to a taxonomic rank, we have to analyze the <italic>i</italic>-th row of each similarity matrix, denoted by <inline-formula id="IEq181"><alternatives><tex-math id="M369">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {M}^{1F}_{\alpha }[\!i]$\end{document}</tex-math><mml:math id="M370"><mml:msubsup><mml:mrow><mml:mi mathvariant="script">ℳ</mml:mi></mml:mrow><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mi>F</mml:mi></mml:mrow></mml:msubsup><mml:mo>[</mml:mo><mml:mspace width="0.3em"/><mml:mi>i</mml:mi><mml:mo>]</mml:mo></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq181.gif"/></alternatives></inline-formula>, <inline-formula id="IEq182"><alternatives><tex-math id="M371">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {M}^{1RC}_{\alpha }[\!i]$\end{document}</tex-math><mml:math id="M372"><mml:msubsup><mml:mrow><mml:mi mathvariant="script">ℳ</mml:mi></mml:mrow><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mtext mathvariant="italic">RC</mml:mtext></mml:mrow></mml:msubsup><mml:mo>[</mml:mo><mml:mspace width="0.3em"/><mml:mi>i</mml:mi><mml:mo>]</mml:mo></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq182.gif"/></alternatives></inline-formula>, <inline-formula id="IEq183"><alternatives><tex-math id="M373">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {M}^{2F}_{\alpha }[\!i]$\end{document}</tex-math><mml:math id="M374"><mml:msubsup><mml:mrow><mml:mi mathvariant="script">ℳ</mml:mi></mml:mrow><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>F</mml:mi></mml:mrow></mml:msubsup><mml:mo>[</mml:mo><mml:mspace width="0.3em"/><mml:mi>i</mml:mi><mml:mo>]</mml:mo></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq183.gif"/></alternatives></inline-formula> and <inline-formula id="IEq184"><alternatives><tex-math id="M375">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {M}^{2RC}_{\alpha }[\!i]$\end{document}</tex-math><mml:math id="M376"><mml:msubsup><mml:mrow><mml:mi mathvariant="script">ℳ</mml:mi></mml:mrow><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mtext mathvariant="italic">RC</mml:mtext></mml:mrow></mml:msubsup><mml:mo>[</mml:mo><mml:mspace width="0.3em"/><mml:mi>i</mml:mi><mml:mo>]</mml:mo></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq184.gif"/></alternatives></inline-formula>.</p>
        <p>Our classification strategy proceeds according to the difficulty in classifying any entry <inline-formula id="IEq185"><alternatives><tex-math id="M377">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\overline {R}_{i}$\end{document}</tex-math><mml:math id="M378"><mml:msub><mml:mrow><mml:mover accent="false"><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mo accent="true">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq185.gif"/></alternatives></inline-formula> by using first separately and then jointly the information belonging to an individual mate.</p>
        <p>We set a threshold value <italic>β</italic> (0≤<italic>β</italic>&lt;1) and we attempt to classify <inline-formula id="IEq186"><alternatives><tex-math id="M379">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\overline {R}_{i}$\end{document}</tex-math><mml:math id="M380"><mml:msub><mml:mrow><mml:mover accent="false"><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mo accent="true">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq186.gif"/></alternatives></inline-formula> only if there is at least one similarity value in <inline-formula id="IEq187"><alternatives><tex-math id="M381">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {M}^{1F}_{\alpha }[\!i]$\end{document}</tex-math><mml:math id="M382"><mml:msubsup><mml:mrow><mml:mi mathvariant="script">ℳ</mml:mi></mml:mrow><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mi>F</mml:mi></mml:mrow></mml:msubsup><mml:mo>[</mml:mo><mml:mspace width="0.3em"/><mml:mi>i</mml:mi><mml:mo>]</mml:mo></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq187.gif"/></alternatives></inline-formula>, <inline-formula id="IEq188"><alternatives><tex-math id="M383">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {M}^{1RC}_{\alpha }[\!i]$\end{document}</tex-math><mml:math id="M384"><mml:msubsup><mml:mrow><mml:mi mathvariant="script">ℳ</mml:mi></mml:mrow><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mtext mathvariant="italic">RC</mml:mtext></mml:mrow></mml:msubsup><mml:mo>[</mml:mo><mml:mspace width="0.3em"/><mml:mi>i</mml:mi><mml:mo>]</mml:mo></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq188.gif"/></alternatives></inline-formula>, <inline-formula id="IEq189"><alternatives><tex-math id="M385">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {M}^{2F}_{\alpha }[\!i]$\end{document}</tex-math><mml:math id="M386"><mml:msubsup><mml:mrow><mml:mi mathvariant="script">ℳ</mml:mi></mml:mrow><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>F</mml:mi></mml:mrow></mml:msubsup><mml:mo>[</mml:mo><mml:mspace width="0.3em"/><mml:mi>i</mml:mi><mml:mo>]</mml:mo></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq189.gif"/></alternatives></inline-formula>, <inline-formula id="IEq190"><alternatives><tex-math id="M387">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {M}^{2RC}_{\alpha }[\!i]$\end{document}</tex-math><mml:math id="M388"><mml:msubsup><mml:mrow><mml:mi mathvariant="script">ℳ</mml:mi></mml:mrow><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mtext mathvariant="italic">RC</mml:mtext></mml:mrow></mml:msubsup><mml:mo>[</mml:mo><mml:mspace width="0.3em"/><mml:mi>i</mml:mi><mml:mo>]</mml:mo></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq190.gif"/></alternatives></inline-formula> greater than <italic>β</italic>. Such a parameter <italic>β</italic> may affect the classification accuracy: it is easy to see that decreasing the value of <italic>β</italic> implies a major number of reads that may be classified (increasing sensitivity) at the cost of a larger probability of error (decreasing precision).</p>
        <p>For each <inline-formula id="IEq191"><alternatives><tex-math id="M389">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\overline {R}_{i}$\end{document}</tex-math><mml:math id="M390"><mml:msub><mml:mrow><mml:mover accent="false"><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mo accent="true">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq191.gif"/></alternatives></inline-formula>, in a first phase, we compute the maximum value <inline-formula id="IEq192"><alternatives><tex-math id="M391">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$M_{i}^{x}$\end{document}</tex-math><mml:math id="M392"><mml:msubsup><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq192.gif"/></alternatives></inline-formula>, with <italic>x</italic>=1<italic>F</italic>, 1<italic>R</italic><italic>C</italic>, 2<italic>F</italic>, 2<italic>R</italic><italic>C</italic>, in each row <inline-formula id="IEq193"><alternatives><tex-math id="M393">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {M}^{x}_{\alpha }[\!i]$\end{document}</tex-math><mml:math id="M394"><mml:msubsup><mml:mrow><mml:mi mathvariant="script">ℳ</mml:mi></mml:mrow><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msubsup><mml:mo>[</mml:mo><mml:mspace width="0.3em"/><mml:mi>i</mml:mi><mml:mo>]</mml:mo></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq193.gif"/></alternatives></inline-formula> and we take the maximum <italic>M</italic><sub><italic>i</italic></sub> of these values, i.e., <inline-formula id="IEq194"><alternatives><tex-math id="M395">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$M_{i}=\max M_{i}^{x}$\end{document}</tex-math><mml:math id="M396"><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>max</mml:mo><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:munderover></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq194.gif"/></alternatives></inline-formula>. In general, we only consider the genomes in <inline-formula id="IEq195"><alternatives><tex-math id="M397">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {G}=\{G_{1},\ldots, G_{g}\}$\end{document}</tex-math><mml:math id="M398"><mml:mi mathvariant="script">G</mml:mi><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq195.gif"/></alternatives></inline-formula> that approximately reach, with the entry <inline-formula id="IEq196"><alternatives><tex-math id="M399">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\overline {R}_{i}$\end{document}</tex-math><mml:math id="M400"><mml:msub><mml:mrow><mml:mover accent="false"><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mo accent="true">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq196.gif"/></alternatives></inline-formula>, a similarity value equal to <italic>M</italic><sub><italic>i</italic></sub> (i.e., with tolerance of 0.02). If <italic>M</italic><sub><italic>i</italic></sub>≤<italic>β</italic> the entry <inline-formula id="IEq197"><alternatives><tex-math id="M401">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\overline {R}_{i}$\end{document}</tex-math><mml:math id="M402"><mml:msub><mml:mrow><mml:mover accent="false"><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mo accent="true">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq197.gif"/></alternatives></inline-formula> is said to be <italic>not classified</italic>.</p>
        <p>If the specified minimum taxonomic rank is genome, the entry <inline-formula id="IEq198"><alternatives><tex-math id="M403">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\overline {R}_{i}$\end{document}</tex-math><mml:math id="M404"><mml:msub><mml:mrow><mml:mover accent="false"><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mo accent="true">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq198.gif"/></alternatives></inline-formula> is said to be <italic>classified</italic> to <italic>G</italic><sub><italic>j</italic></sub> only if there exists a unique <italic>j</italic> such that <inline-formula id="IEq199"><alternatives><tex-math id="M405">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {M}^{x}_{\alpha }[\!i][\!j]$\end{document}</tex-math><mml:math id="M406"><mml:msubsup><mml:mrow><mml:mi mathvariant="script">ℳ</mml:mi></mml:mrow><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msubsup><mml:mo>[</mml:mo><mml:mspace width="0.3em"/><mml:mi>i</mml:mi><mml:mo>]</mml:mo><mml:mo>[</mml:mo><mml:mspace width="0.3em"/><mml:mi>j</mml:mi><mml:mo>]</mml:mo></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq199.gif"/></alternatives></inline-formula> is approximately equal to <italic>M</italic><sub><italic>i</italic></sub>, whereas it is classified to a taxon <italic>T</italic> if all genomes <italic>G</italic><sub><italic>j</italic></sub>, such that <inline-formula id="IEq200"><alternatives><tex-math id="M407">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {M}^{x}_{\alpha }[\!i][\!j]$\end{document}</tex-math><mml:math id="M408"><mml:msubsup><mml:mrow><mml:mi mathvariant="script">ℳ</mml:mi></mml:mrow><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msubsup><mml:mo>[</mml:mo><mml:mspace width="0.3em"/><mml:mi>i</mml:mi><mml:mo>]</mml:mo><mml:mo>[</mml:mo><mml:mspace width="0.3em"/><mml:mi>j</mml:mi><mml:mo>]</mml:mo></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq200.gif"/></alternatives></inline-formula> is approximately equal to <italic>M</italic><sub><italic>i</italic></sub>, belong to the same taxonomic unit <italic>T</italic> within the specified minimum taxonomic rank. In the case there exist more genomes <italic>G</italic><sub><italic>j</italic></sub> (1≤<italic>j</italic>≤<italic>g</italic>), with <inline-formula id="IEq201"><alternatives><tex-math id="M409">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {M}^{x}_{\alpha }[\!i][\!j]$\end{document}</tex-math><mml:math id="M410"><mml:msubsup><mml:mrow><mml:mi mathvariant="script">ℳ</mml:mi></mml:mrow><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msubsup><mml:mo>[</mml:mo><mml:mspace width="0.3em"/><mml:mi>i</mml:mi><mml:mo>]</mml:mo><mml:mo>[</mml:mo><mml:mspace width="0.3em"/><mml:mi>j</mml:mi><mml:mo>]</mml:mo></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq201.gif"/></alternatives></inline-formula> approximately equal to <italic>M</italic><sub><italic>i</italic></sub> belonging to distinct taxonomic units, <inline-formula id="IEq202"><alternatives><tex-math id="M411">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\overline {R}_{i}$\end{document}</tex-math><mml:math id="M412"><mml:msub><mml:mrow><mml:mover accent="false"><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mo accent="true">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq202.gif"/></alternatives></inline-formula> is said to be <italic>ambiguous</italic>. In the next paragraph, we join the paired-end information for a re-examination of ambiguous reads.</p>
        <p><bold>Re-examination of ambiguous reads–</bold> In this second phase, we only consider ambiguous entries. For each entry <inline-formula id="IEq203"><alternatives><tex-math id="M413">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\overline {R}_{i}$\end{document}</tex-math><mml:math id="M414"><mml:msub><mml:mrow><mml:mover accent="false"><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mo accent="true">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq203.gif"/></alternatives></inline-formula>, we build the set <inline-formula id="IEq204"><alternatives><tex-math id="M415">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {I}_{i}$\end{document}</tex-math><mml:math id="M416"><mml:msub><mml:mrow><mml:mi mathvariant="script">I</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq204.gif"/></alternatives></inline-formula> of indices <italic>q</italic> such that, for at least one <italic>x</italic>=1<italic>F</italic>, 1<italic>R</italic><italic>C</italic>, 2<italic>F</italic>, 2<italic>R</italic><italic>C</italic>, <inline-formula id="IEq205"><alternatives><tex-math id="M417">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {M}^{x}_{\alpha }[\!i][\!q]$\end{document}</tex-math><mml:math id="M418"><mml:msubsup><mml:mrow><mml:mi mathvariant="script">ℳ</mml:mi></mml:mrow><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msubsup><mml:mo>[</mml:mo><mml:mspace width="0.3em"/><mml:mi>i</mml:mi><mml:mo>]</mml:mo><mml:mo>[</mml:mo><mml:mspace width="0.3em"/><mml:mi>q</mml:mi><mml:mo>]</mml:mo></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq205.gif"/></alternatives></inline-formula> is approximately equal to the maximum <italic>M</italic><sub><italic>i</italic></sub> (i.e. with tolerance of 0.02).</p>
        <p>For each genome <italic>G</italic><sub><italic>j</italic></sub> such that <inline-formula id="IEq206"><alternatives><tex-math id="M419">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$j \in \mathcal {I}_{i}$\end{document}</tex-math><mml:math id="M420"><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script">I</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq206.gif"/></alternatives></inline-formula>, we take the maximum <inline-formula id="IEq207"><alternatives><tex-math id="M421">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$M_{i}^{'}$\end{document}</tex-math><mml:math id="M422"><mml:msubsup><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow/><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq207.gif"/></alternatives></inline-formula> obtained by summing both <inline-formula id="IEq208"><alternatives><tex-math id="M423">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {M}^{1F}_{\alpha }[\!i][\!j]$\end{document}</tex-math><mml:math id="M424"><mml:msubsup><mml:mrow><mml:mi mathvariant="script">ℳ</mml:mi></mml:mrow><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mi>F</mml:mi></mml:mrow></mml:msubsup><mml:mo>[</mml:mo><mml:mspace width="0.3em"/><mml:mi>i</mml:mi><mml:mo>]</mml:mo><mml:mo>[</mml:mo><mml:mspace width="0.3em"/><mml:mi>j</mml:mi><mml:mo>]</mml:mo></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq208.gif"/></alternatives></inline-formula> and <inline-formula id="IEq209"><alternatives><tex-math id="M425">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {M}^{1RC}_{\alpha }[\!i][\!j]$\end{document}</tex-math><mml:math id="M426"><mml:msubsup><mml:mrow><mml:mi mathvariant="script">ℳ</mml:mi></mml:mrow><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mtext mathvariant="italic">RC</mml:mtext></mml:mrow></mml:msubsup><mml:mo>[</mml:mo><mml:mspace width="0.3em"/><mml:mi>i</mml:mi><mml:mo>]</mml:mo><mml:mo>[</mml:mo><mml:mspace width="0.3em"/><mml:mi>j</mml:mi><mml:mo>]</mml:mo></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq209.gif"/></alternatives></inline-formula> with their corresponding mate. If we have only one genome <italic>G</italic><sub><italic>k</italic></sub> (with <inline-formula id="IEq210"><alternatives><tex-math id="M427">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$k \in \mathcal {I}_{i}$\end{document}</tex-math><mml:math id="M428"><mml:mi>k</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script">I</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq210.gif"/></alternatives></inline-formula>) corresponding to the maximum value <inline-formula id="IEq211"><alternatives><tex-math id="M429">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$M_{i}^{'}$\end{document}</tex-math><mml:math id="M430"><mml:msubsup><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow/><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq211.gif"/></alternatives></inline-formula>, we are able to assign <inline-formula id="IEq212"><alternatives><tex-math id="M431">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\overline {R}_{i}$\end{document}</tex-math><mml:math id="M432"><mml:msub><mml:mrow><mml:mover accent="false"><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mo accent="true">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq212.gif"/></alternatives></inline-formula> to <italic>G</italic><sub><italic>k</italic></sub> or simply to its corresponding taxon at the specified rank. Whereas <inline-formula id="IEq213"><alternatives><tex-math id="M433">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\overline {R}_{i}$\end{document}</tex-math><mml:math id="M434"><mml:msub><mml:mrow><mml:mover accent="false"><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mo accent="true">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq213.gif"/></alternatives></inline-formula> is classified to a taxon <italic>T</italic> if all such genomes <italic>G</italic><sub><italic>k</italic></sub> (with <inline-formula id="IEq214"><alternatives><tex-math id="M435">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$k \in \mathcal {I}_{i}$\end{document}</tex-math><mml:math id="M436"><mml:mi>k</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script">I</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq214.gif"/></alternatives></inline-formula>) that reach <inline-formula id="IEq215"><alternatives><tex-math id="M437">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$M_{i}^{'}$\end{document}</tex-math><mml:math id="M438"><mml:msubsup><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow/><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq215.gif"/></alternatives></inline-formula> belong to the same taxonomic unit <italic>T</italic> within the specified minimum taxonomic rank. Otherwise, <inline-formula id="IEq216"><alternatives><tex-math id="M439">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\overline {R}_{i}$\end{document}</tex-math><mml:math id="M440"><mml:msub><mml:mrow><mml:mover accent="false"><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mo accent="true">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq216.gif"/></alternatives></inline-formula> still remains <italic>ambiguous</italic>, and we proceed with the last classification phase, as follows.</p>
        <p>Then, we compute the maximum <inline-formula id="IEq217"><alternatives><tex-math id="M441">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$M_{i}^{''}$\end{document}</tex-math><mml:math id="M442"><mml:msubsup><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow/><mml:mrow><mml:mo>″</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq217.gif"/></alternatives></inline-formula> obtained by summing both <inline-formula id="IEq218"><alternatives><tex-math id="M443">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {M}^{1F}_{\alpha }[\!i][\!j]$\end{document}</tex-math><mml:math id="M444"><mml:msubsup><mml:mrow><mml:mi mathvariant="script">ℳ</mml:mi></mml:mrow><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mi>F</mml:mi></mml:mrow></mml:msubsup><mml:mo>[</mml:mo><mml:mspace width="0.3em"/><mml:mi>i</mml:mi><mml:mo>]</mml:mo><mml:mo>[</mml:mo><mml:mspace width="0.3em"/><mml:mi>j</mml:mi><mml:mo>]</mml:mo></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq218.gif"/></alternatives></inline-formula> and <inline-formula id="IEq219"><alternatives><tex-math id="M445">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {M}^{1RC}_{\alpha }[\!i][\!j]$\end{document}</tex-math><mml:math id="M446"><mml:msubsup><mml:mrow><mml:mi mathvariant="script">ℳ</mml:mi></mml:mrow><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mtext mathvariant="italic">RC</mml:mtext></mml:mrow></mml:msubsup><mml:mo>[</mml:mo><mml:mspace width="0.3em"/><mml:mi>i</mml:mi><mml:mo>]</mml:mo><mml:mo>[</mml:mo><mml:mspace width="0.3em"/><mml:mi>j</mml:mi><mml:mo>]</mml:mo></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq219.gif"/></alternatives></inline-formula> with their corresponding mate, for all <italic>j</italic>=1,…,<italic>g</italic> (hence not only for <inline-formula id="IEq220"><alternatives><tex-math id="M447">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$j \in \mathcal {I}_{i}$\end{document}</tex-math><mml:math id="M448"><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script">I</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq220.gif"/></alternatives></inline-formula>). We select the indices <italic>h</italic> (1≤<italic>h</italic>≤<italic>g</italic>) such that the sum between either <inline-formula id="IEq221"><alternatives><tex-math id="M449">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {M}^{1F}_{\alpha }[\!i][\!j]$\end{document}</tex-math><mml:math id="M450"><mml:msubsup><mml:mrow><mml:mi mathvariant="script">ℳ</mml:mi></mml:mrow><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mi>F</mml:mi></mml:mrow></mml:msubsup><mml:mo>[</mml:mo><mml:mspace width="0.3em"/><mml:mi>i</mml:mi><mml:mo>]</mml:mo><mml:mo>[</mml:mo><mml:mspace width="0.3em"/><mml:mi>j</mml:mi><mml:mo>]</mml:mo></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq221.gif"/></alternatives></inline-formula> and its mate, or <inline-formula id="IEq222"><alternatives><tex-math id="M451">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {M}^{1RC}_{\alpha }[\!i][\!j]$\end{document}</tex-math><mml:math id="M452"><mml:msubsup><mml:mrow><mml:mi mathvariant="script">ℳ</mml:mi></mml:mrow><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mtext mathvariant="italic">RC</mml:mtext></mml:mrow></mml:msubsup><mml:mo>[</mml:mo><mml:mspace width="0.3em"/><mml:mi>i</mml:mi><mml:mo>]</mml:mo><mml:mo>[</mml:mo><mml:mspace width="0.3em"/><mml:mi>j</mml:mi><mml:mo>]</mml:mo></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq222.gif"/></alternatives></inline-formula> and its mate, is <inline-formula id="IEq223"><alternatives><tex-math id="M453">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$M_{i}^{''}$\end{document}</tex-math><mml:math id="M454"><mml:msubsup><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow/><mml:mrow><mml:mo>″</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq223.gif"/></alternatives></inline-formula>. The procedure then follows as above.</p>
        <p>However, if the entry <inline-formula id="IEq224"><alternatives><tex-math id="M455">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\overline {R}_{i}$\end{document}</tex-math><mml:math id="M456"><mml:msub><mml:mrow><mml:mover accent="false"><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mo accent="true">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq224.gif"/></alternatives></inline-formula> still remains ambiguous, then we are not able to classify. Thus, eventually we can either leave <inline-formula id="IEq225"><alternatives><tex-math id="M457">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\overline {R}_{i}$\end{document}</tex-math><mml:math id="M458"><mml:msub><mml:mrow><mml:mover accent="false"><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mo accent="true">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq225.gif"/></alternatives></inline-formula> as ambiguous, if the taxonomic level of classification is fixed, or classify it at higher ranks by taking advantage of the taxonomic lineage of taxa.</p>
        <p>Note that in both re-examinations, we take the strand that gives the maximum similarity score, rather than using the summed score of both strands, as it might create a bias in the read classification.</p>
      </sec>
    </sec>
  </sec>
  <sec id="Sec6" sec-type="results">
    <title>Results</title>
    <p>In this section, we describe and test our prototype tool, named LiME [<xref ref-type="bibr" rid="CR49">49</xref>], implemented in C++. It is arranged as a pipeline that runs the three steps described in the previous section. We distinguish two approaches according to the used similarities: LiME<sup>eBWT</sup> when <inline-formula id="IEq226"><alternatives><tex-math id="M459">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathfrak {S}^{\text {eBWT}}_{\alpha }$\end{document}</tex-math><mml:math id="M460"><mml:msubsup><mml:mrow><mml:mi mathvariant="fraktur">S</mml:mi></mml:mrow><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mtext>eBWT</mml:mtext></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq226.gif"/></alternatives></inline-formula> is used, and LiME<sup>DA</sup> when <inline-formula id="IEq227"><alternatives><tex-math id="M461">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathfrak {S}^{\text {DA}}_{\alpha }$\end{document}</tex-math><mml:math id="M462"><mml:msubsup><mml:mrow><mml:mi mathvariant="fraktur">S</mml:mi></mml:mrow><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mtext>DA</mml:mtext></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq227.gif"/></alternatives></inline-formula> is used.</p>
    <p>In order to evaluate the performance of LiME, we have designed a series of tests with various paired-end read datasets: on both simulated and real datasets. Moreover, to guarantee a fair evaluation among tools, in these experiments, we used customized uniform reference databases with the aim to eliminate any confounding effects of differences between default databases (as specified in [<xref ref-type="bibr" rid="CR50">50</xref>]).</p>
    <p>We compare LiME with five sswell-known tools recently introduced that allow to build customized databases: CLARK-S [<xref ref-type="bibr" rid="CR5">5</xref>], that uses spaced <italic>k</italic>-mers rather than simple <italic>k</italic>-mers; Centrifuge [<xref ref-type="bibr" rid="CR4">4</xref>], that adapts the data structures of read-mapping algorithms based on the BWT and the FM-index [<xref ref-type="bibr" rid="CR16">16</xref>] (such as Bowtie [<xref ref-type="bibr" rid="CR51">51</xref>], which provides very fast alignment with a relatively small memory footprint); Kraken 2 [<xref ref-type="bibr" rid="CR7">7</xref>], that is based on a probabilistic, compact hash table to map minimizers to lowest common ancestors taxa; TaxMaps [<xref ref-type="bibr" rid="CR6">6</xref>], that is a taxonomic mapping tool, where the reads are mapped in single-end mode to an indexed database using GEM mapper [<xref ref-type="bibr" rid="CR17">17</xref>]; Magic-BLAST [<xref ref-type="bibr" rid="CR18">18</xref>], that is a tool for mapping DNA or RNA sequences against a whole genome or transcriptome<xref ref-type="fn" rid="Fn4">4</xref>. In order to align reads, Magic-BLAST uses a BLAST database that can be customized based on a desired set of sequences. However, unlike Nucleotide-nucleotide BLAST (BLASTN), Magic-BLAST is aware of paired-end sequencing and the best alignments are selected based on the alignment quality of the pair.</p>
    <sec id="Sec7">
      <title>On simulated datasets</title>
      <p><bold>Dataset description.</bold> For the experiments on simulated data, we have used the collections made available by the benchmarking analysis carried out in [<xref ref-type="bibr" rid="CR14">14</xref>]. Indeed, the authors of [<xref ref-type="bibr" rid="CR14">14</xref>] evaluate the most widely used tools for metagenome classification by testing them on complex and realistic datasets, which have been designed ad-hoc for this benchmarking analysis and made publicly available [<xref ref-type="bibr" rid="CR52">52</xref>].</p>
      <p>In particular, we perform the validation of our approach by using two sets of metagenomes, randomly selected, among those provided by Lindgreen et al. [<xref ref-type="bibr" rid="CR14">14</xref>]: the two datasets of paired-end reads <italic>setA2</italic> and <italic>setB2</italic> reproduce the size, complexity and characteristics of real metagenomic samples containing around 20 millions of sequences of length 100 belonging to 17 different phyla. Some phyla are included in equal proportions, whereas some others vary more substantially between the two sets (see ([<xref ref-type="bibr" rid="CR14">14</xref>], Supplementary Table S1)).</p>
      <p>Moreover, as to test the reliability of the tools, each dataset has been enhanced with a set of simulated negative control sequences to mimic sequences from “unknown” organisms (i.e., their genomes are not present in the reference database) that are likely to appear in metagenome samples – see [<xref ref-type="bibr" rid="CR14">14</xref>] for further details. Each of these negative control subsets added to <italic>setA2</italic> and <italic>setB2</italic> includes around 5 million of random shuffled reads.</p>
      <p>We precise that the original datasets, downloadable from [<xref ref-type="bibr" rid="CR14">14</xref>], are not exactly the datasets <italic>setA2</italic> and <italic>setB2</italic> we use for our evaluations [<xref ref-type="bibr" rid="CR53">53</xref>]. In fact, we first removed a group of reads associated with the phylum of Eukaryotes whose species provenance was not specified in [<xref ref-type="bibr" rid="CR14">14</xref>]. Second, since we use a custom database and up-to-date taxonomy data (such as taxonomy id, or accession numbers) downloaded from the NCBI website [<xref ref-type="bibr" rid="CR54">54</xref>], we preferred not to include in sets <italic>setA2</italic> and <italic>setB2</italic> groups of reads associated with 3 genomes whose entries in the NCBI database have been indicated as expiring.</p>
      <p>The reference database <inline-formula id="IEq228"><alternatives><tex-math id="M463">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {G}$\end{document}</tex-math><mml:math id="M464"><mml:mi mathvariant="script">G</mml:mi></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq228.gif"/></alternatives></inline-formula> we use for these experiments comprises 930 genomes from 686 species belonging to 17 phyla as indicated in ([<xref ref-type="bibr" rid="CR14">14</xref>], Supplementary Table S2).</p>
      <p>
        <bold>Validation step.</bold>
      </p>
      <p>In our experiments, we consider only read assignments at species level, and thus all non-random reads assigned to higher taxonomic levels (i.e., more species could be assigned to them) are counted in <italic>FN</italic>.</p>
      <p>As the provenance of the simulated reads is known, we denote by <italic>TP</italic> (true positives) the number of reads correctly classified (i.e., assigned to their right species), by <italic>FP</italic> (false positives) the number of reads erroneously classified, and by <italic>FN</italic> (false negatives) the number of reads unassigned, from which we can calculate the quality metrics: sensitivity SEN, precision PREC, and the F1 score that is the harmonic mean between sensitivity and precision,
<disp-formula id="Eque"><alternatives><tex-math id="M465">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\text{SEN}=\frac{TP}{TP+FN},\quad\text{PREC}=\frac{TP}{TP+FP},\quad\text{F1}=\frac{2TP}{2TP+FP+FN}.$$ \end{document}</tex-math><mml:math id="M466"><mml:mrow><mml:mtext>SEN</mml:mtext><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mtext mathvariant="italic">TP</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">TP</mml:mtext><mml:mo>+</mml:mo><mml:mtext mathvariant="italic">FN</mml:mtext></mml:mrow></mml:mfrac><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:mtext>PREC</mml:mtext><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mtext mathvariant="italic">TP</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">TP</mml:mtext><mml:mo>+</mml:mo><mml:mtext mathvariant="italic">FP</mml:mtext></mml:mrow></mml:mfrac><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:mtext>F1</mml:mtext><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mtext mathvariant="italic">TP</mml:mtext></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mtext mathvariant="italic">TP</mml:mtext><mml:mo>+</mml:mo><mml:mtext mathvariant="italic">FP</mml:mtext><mml:mo>+</mml:mo><mml:mtext mathvariant="italic">FN</mml:mtext></mml:mrow></mml:mfrac><mml:mi>.</mml:mi></mml:mrow></mml:math><graphic xlink:href="12859_2020_3628_Article_Eque.gif" position="anchor"/></alternatives></disp-formula> For simulated negative control sequences that do not belong to any known species, we can set <italic>TN</italic> as the number of random reads that are correctly not mapped to any species, and calculate the specificity
<disp-formula id="Equf"><alternatives><tex-math id="M467">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\text{SPEC}=\frac{TN}{t},\text{ where \textit{t} is the total number of random shuffled reads.}$$ \end{document}</tex-math><mml:math id="M468"><mml:mrow><mml:mtext>SPEC</mml:mtext><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mtext mathvariant="italic">TN</mml:mtext></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>,</mml:mo><mml:mtext>where t is the total number of random shuffled reads.</mml:mtext></mml:mrow></mml:math><graphic xlink:href="12859_2020_3628_Article_Equf.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>
        <bold>Experiments</bold>
      </p>
      <p>Our tool is able to classify the reads to several taxonomic levels such as genomes, species or phylum. For the experiments reported in Figs. <xref rid="Fig2" ref-type="fig">2</xref> and <xref rid="Fig3" ref-type="fig">3</xref>, we set the taxonomic rank of classification to species.
<fig id="Fig2"><label>Fig. 2</label><caption><p>Comparison between LiME and other sequence classification tools. The results here are shown for Sensitivity, Precision, F1-score and Specificity as evaluated at the species rank on the dataset <italic>s</italic><italic>e</italic><italic>t</italic><italic>A</italic>2. Full results are available in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S1</p></caption><graphic xlink:href="12859_2020_3628_Fig2_HTML" id="MO2"/></fig><fig id="Fig3"><label>Fig. 3</label><caption><p>Comparison between LiME and other sequence classification tools. The results here are shown for Sensitivity, Precision, F1-score and Specificity as evaluated at the species rank on the dataset <italic>s</italic><italic>e</italic><italic>t</italic><italic>B</italic>2</p></caption><graphic xlink:href="12859_2020_3628_Fig3_HTML" id="MO3"/></fig></p>
      <p>To run Magic-BLAST, Centrifuge, Kraken 2 and TaxMaps we use the default values provided for paired-end reads. CLARK-S can run with default values only and the results are filtered by using the recommended option –highconfidence (e.g., assignments with confidence score &lt;0.75 and gamma score &lt;0.03 are discarded).</p>
      <p>For LiME, we set the minimum length of the common context <italic>α</italic>=16, since the length of each paired-end read is 100, and we provide results for minimum similarity scores <italic>β</italic>=0.25.</p>
      <p>We additionally processed these datasets with different parameters (see “<xref rid="Sec9" ref-type="sec">Discussion</xref>” section, and Figs. <xref rid="Fig4" ref-type="fig">4</xref> and <xref rid="Fig5" ref-type="fig">5</xref>) and show that for fixed <italic>α</italic>, the greater the value <italic>β</italic> is, the more the sensitivity decreases and the precision increases.
<fig id="Fig4"><label>Fig. 4</label><caption><p>Comparison of accuracy by using on dataset <italic>s</italic><italic>e</italic><italic>t</italic><italic>A</italic>2. The results here are shown for sensitivity, precision, F1-score and Specificity as evaluated at the species using various parameter values on the dataset <italic>s</italic><italic>e</italic><italic>t</italic><italic>A</italic>2. Full results are available in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S1</p></caption><graphic xlink:href="12859_2020_3628_Fig4_HTML" id="MO4"/></fig><fig id="Fig5"><label>Fig. 5</label><caption><p>Comparison of accuracy by using on dataset <italic>s</italic><italic>e</italic><italic>t</italic><italic>B</italic>2. The results here are shown for sensitivity, precision, F1-score and Specificity as evaluated at the species using various parameter values on the dataset <italic>s</italic><italic>e</italic><italic>t</italic><italic>B</italic>2. Full results are available in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S1</p></caption><graphic xlink:href="12859_2020_3628_Fig5_HTML" id="MO5"/></fig></p>
      <p>In Figs. <xref rid="Fig2" ref-type="fig">2</xref> and <xref rid="Fig3" ref-type="fig">3</xref>, we report the classification results for the simulated datasets <italic>s</italic><italic>e</italic><italic>t</italic><italic>A</italic>2 and <italic>s</italic><italic>e</italic><italic>t</italic><italic>B</italic>2. It is possible to observe that both LiME<sup>eBWT</sup> and LiME<sup>DA</sup>, together with Magic-BLAST and Kraken 2, show higher precision than taxMaps, Clark-S and Centrifuge on both datasets. Moreover, both LiME<sup>eBWT</sup> and LiME<sup>DA</sup>, together with Clark-S, Centrifuge, and taxMaps, achieve higher sensitivity than Kraken2 and Magic-BLAST on both datasets. The specificity and the F1 score achieved by both LiME<sup>eBWT</sup> and LiME<sup>DA</sup> are comparable or superior to those of the other classifiers.</p>
      <p>Finally, there is experimental evidence that taking into account the eBWT symbols (LiME<sup>eBWT</sup>) rather than considering only the provenience of the symbols (LiME<sup>DA</sup>) leads to achieve a higher precision at the cost of a lower sensitivity.</p>
    </sec>
    <sec id="Sec8">
      <title>On real datasets</title>
      <p><bold>Dataset description.</bold> For the experiments on real data, we have used a paired-end read collection from the Human Microbiome Project (HMP). The real metagenome <italic>SRR1804065</italic> is a DNA tool sample of a female participant generated by using Illumina sequencing, that has been previously studied in [<xref ref-type="bibr" rid="CR9">9</xref>, <xref ref-type="bibr" rid="CR55">55</xref>]. The paired-end reads have length 100 bps and their total number in the original dataset was 21,873,781. Since the “ground truth” is not available for a real metagenome and a large number of reads may belong to unknown species, we first filtered this dataset by using BLAST: we mapped reads against the whole nucleotide sequence database with a sequence identity of 98%, and discarded the pairs of reads that do not map to any genome. The resulting dataset <italic>SRR1804065</italic> comprises 5,654,624 paired-end reads.</p>
      <p>The reference database <inline-formula id="IEq229"><alternatives><tex-math id="M469">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {G}$\end{document}</tex-math><mml:math id="M470"><mml:mi mathvariant="script">G</mml:mi></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq229.gif"/></alternatives></inline-formula> we use for this experiment comprises 3,423 genomes from 1,499 species belonging to 42 phyla.</p>
      <p>
        <bold>Validation step.</bold>
      </p>
      <p>Because a real metagenomic dataset is from real sequencing experiments, we cannot be certain of the true taxonomic origin of each individual fragment, and consequently we cannot report sensitivity and precision for this dataset. However, we evaluate the concordance between the reads’ classifications performed by the tested tools at the species level. First, we report for each classifier the following quantities: (a) the number of reads that are assigned at the species level, (b) the number of reads with a classification at higher taxonomic levels than species, (c) the number of reads that are not classified.</p>
      <p>Furthermore, with the purpose of comparing our method to the state-of-the-art tools, we represent the reads classified at the species level as set elements. Then, to measure the similarity of classification between two tools, we compute the similarity between the two sets of classified reads by using the <italic>Jaccard similarity</italic> coefficient.</p>
      <p>The Jaccard coefficient <italic>J</italic>(<italic>A</italic>,<italic>B</italic>) is defined as the size of the intersection divided by the size of the union of the two sets <italic>A</italic> and <italic>B</italic>, i.e., |<italic>A</italic>∩<italic>B</italic>|/|<italic>A</italic>∪<italic>B</italic>|.</p>
      <p>For our purposes, the set <italic>A</italic> (resp. <italic>B</italic>) is the set of reads classified by a tool (resp. by a competitor) at the species level, thus we denote by <italic>t</italic> the total number of reads classified joining the two classifications. On the one hand, we can consider the identifiers of the reads, so that the intersection <italic>I</italic><sub><italic>id</italic></sub>=<italic>A</italic>∩<italic>B</italic> is given by those reads that are classified by both tools at the species level. On the other hand, we can consider the species assigned to those reads, so that the intersection <italic>I</italic><sub><italic>as</italic></sub>=<italic>A</italic>∩<italic>B</italic> is given by those reads that are assigned by both tools to the same taxonomic unit. In order to quantify the concordance between the two tools on the basis of the Jaccard coefficient, we calculate the two agreement rates
<disp-formula id="Equg"><alternatives><tex-math id="M471">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$r_{id}=\frac{|I_{id}|}{t} \;\;\text{ and }\;\;r_{as}=\frac{|I_{as}|}{t}.$$ \end{document}</tex-math><mml:math id="M472"><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">id</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">id</mml:mtext></mml:mrow></mml:msub><mml:mo>|</mml:mo></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mspace width="2.77626pt"/><mml:mspace width="2.77626pt"/><mml:mtext>and</mml:mtext><mml:mspace width="2.77626pt"/><mml:mspace width="2.77626pt"/><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">as</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">as</mml:mtext></mml:mrow></mml:msub><mml:mo>|</mml:mo></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mi>.</mml:mi></mml:mrow></mml:math><graphic xlink:href="12859_2020_3628_Article_Equg.gif" position="anchor"/></alternatives></disp-formula></p>
      <p><bold>Experiments</bold> Also for the real metagenome, in order to guarantee a fair evaluation, we use a customed reference database for all the tested tools.</p>
      <p>As for simulated reads, the taxonomic level we choose to classify reads is the deep level of species. In fact, although our tool can classify reads at different taxonomic levels, we fixed the taxonomic level to fairly compare our tools to the others.</p>
      <p>For Magic-BLAST we use default values provided for paired-end reads, and for CLARK-S we use the recommended option –highconfidence to filter the classification results. Centrifuge, Kraken 2 and taxMaps use default values, while LiME uses the parameters <italic>α</italic>=16 and <italic>β</italic>=0.25, as we did for simulated reads.</p>
      <p>Table <xref rid="Tab1" ref-type="table">1</xref> reports for each tool the number of reads that are assigned to a particular species, the number of reads that are assigned to higher taxonomic levels, and the number of unclassified reads. Note that CLARK-S classifies reads only at a given taxonomic level, thus the number of reads assigned to higher ranks is 0.
<table-wrap id="Tab1"><label>Table 1</label><caption><p>Analysis results of the real metagenome (<italic>SRR1804065</italic>) at species level</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"><italic>SRR1804065</italic></th><th align="left">Reads</th><th align="left">%</th><th align="left">Reads</th><th align="left">%</th><th align="left">Reads</th><th align="left">%</th></tr><tr><th align="left"/><th align="left">assigned at</th><th align="left"/><th align="left">assigned at</th><th align="left"/><th align="left">unassigned</th><th align="left"/></tr><tr><th align="left"/><th align="left">species level</th><th align="left"/><th align="left">higher rank</th><th align="left"/><th align="left"/><th align="left"/></tr></thead><tbody><tr><td align="left">LiME<sup>eBWT</sup></td><td align="left">4,524,097</td><td align="left">80.007</td><td align="left">1,019,702</td><td align="left">18.033</td><td align="left">110,825</td><td align="left">1.960</td></tr><tr><td align="left"><italic>α</italic>=16, <italic>β</italic>=0.25</td><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left"/></tr><tr><td align="left">LiME<sup>DA</sup></td><td align="left">4,563,319</td><td align="left"><bold>80.701</bold></td><td align="left">991,361</td><td align="left">17.532</td><td align="left">99,944</td><td align="left">1.767</td></tr><tr><td align="left"><italic>α</italic>=16, <italic>β</italic>=0.25</td><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left"/></tr><tr><td align="left">Kraken 2</td><td align="left">4,497,709</td><td align="left">79.540</td><td align="left">1,085,413</td><td align="left">19.195</td><td align="left">71,502</td><td align="left">1.264</td></tr><tr><td align="left">taxMaps</td><td align="left">4,331,521</td><td align="left">76.601</td><td align="left">1,240,035</td><td align="left">21.930</td><td align="left">83,068</td><td align="left">1.469</td></tr><tr><td align="left">CLARK-S</td><td align="left">4,414,957</td><td align="left">78.077</td><td align="left">0</td><td align="left">0</td><td align="left">1,239,667</td><td align="left">21.923</td></tr><tr><td align="left">Centrifuge</td><td align="left">4,461,655</td><td align="left">78.903</td><td align="left">1,170,321</td><td align="left">20.697</td><td align="left">22,648</td><td align="left"><bold>0.401</bold></td></tr><tr><td align="left">Magic-BLAST</td><td align="left">4,392,446</td><td align="left">77.679</td><td align="left">1,081,523</td><td align="left">19.126</td><td align="left">180,655</td><td align="left">3.195</td></tr></tbody></table><table-wrap-foot><p>Best scores are in bold</p></table-wrap-foot></table-wrap></p>
      <p>On the real metagenome, our approach achieves the highest number of classified reads at the species level: as shown in Table <xref rid="Tab1" ref-type="table">1</xref>, both LiME<sup>eBWT</sup> and LiME<sup>DA</sup> classify a number of reads larger than CLARK-S, Centrifuge, Kraken 2, Magic-BLAST and taxMaps, while the smallest number of unclassified reads is reached by Centrifuge.</p>
      <p>In Table <xref rid="Tab2" ref-type="table">2</xref>, we show numerically how much the classification results differ among pairs of tools. In particular, we perform a direct comparison between our tool and the others tools, for completeness we also report the comparison between Magic-BLAST and the others tools, since we built the customized reference database by means of BLAST. However, we do not report a direct comparison between other pairs of tools, as it is out of the scope of this work. More precisely, in Table <xref rid="Tab2" ref-type="table">2</xref>, we compare the classification results of both LiME<sup>eBWT</sup> and LiME<sup>DA</sup> to those of CLARK-S, Centrifuge, Magic-BLAST, Kraken 2 and taxMaps. By comparing LiME<sup>eBWT</sup> and Magic-BLAST, it results not only that the percentage of individual reads classified by both tools is the 95.2<italic>%</italic> of all classified reads, which is the highest value in Table <xref rid="Tab2" ref-type="table">2</xref>, but also that the 93.6<italic>%</italic> of all classified reads is assigned to the same taxon by LiME<sup>eBWT</sup> and Magic-BLAST. All the other percentages reported in Table <xref rid="Tab2" ref-type="table">2</xref> are strictly lower.
<table-wrap id="Tab2"><label>Table 2</label><caption><p>Classification comparison on real metagenome (<italic>SRR1804065</italic>) by using the agreement rates <italic>r</italic><sub><italic>id</italic></sub>=|<italic>I</italic><sub><italic>id</italic></sub>|/<italic>t</italic> and <italic>r</italic><sub><italic>as</italic></sub>=|<italic>I</italic><sub><italic>as</italic></sub>|/<italic>t</italic></p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"/><th align="left"><italic>t</italic></th><th align="left">|<italic>I</italic><sub><italic>id</italic></sub>|</th><th align="left"><italic>r</italic><sub><italic>id</italic></sub>(%)</th><th align="left">|<italic>I</italic><sub><italic>as</italic></sub>|</th><th align="left"><italic>r</italic><sub><italic>as</italic></sub>(%)</th></tr></thead><tbody><tr><td align="left">LiME<sup>eBWT</sup> and Kraken 2</td><td align="left">4,631,891</td><td align="left">4,389,915</td><td align="left">94.776</td><td align="left">4,270,991</td><td align="left">92.208</td></tr><tr><td align="left">LiME<sup>eBWT</sup> and taxmaps</td><td align="left">4,619,370</td><td align="left">4,236,248</td><td align="left">91.706</td><td align="left">4,171,501</td><td align="left">90.305</td></tr><tr><td align="left">LiME<sup>eBWT</sup> and CLARK-S</td><td align="left">4,898,446</td><td align="left">4,039,348</td><td align="left">82.462</td><td align="left">3,971,990</td><td align="left">81.087</td></tr><tr><td align="left">LiME<sup>eBWT</sup> and Centrifuge</td><td align="left">4,667,402</td><td align="left">4,318,350</td><td align="left">92.521</td><td align="left">4,208,552</td><td align="left">90.169</td></tr><tr><td align="left">LiME<sup>eBWT</sup> and Magic-BLAST</td><td align="left">4,566,885</td><td align="left">4,349,658</td><td align="left"><bold>95.243</bold></td><td align="left">4,274,772</td><td align="left"><bold>93.604</bold></td></tr><tr><td align="left">LiME<sup>DA</sup> and Kraken 2</td><td align="left">4,657,542</td><td align="left">4,403,486</td><td align="left">94.545</td><td align="left">4,274,384</td><td align="left">91.773</td></tr><tr><td align="left">LiME<sup>DA</sup> and taxmaps</td><td align="left">4,648,287</td><td align="left">4,246,553</td><td align="left">91.357</td><td align="left">4,175,008</td><td align="left">89.818</td></tr><tr><td align="left">LiME<sup>DA</sup> and CLARK-S</td><td align="left">4,924,196</td><td align="left">4,054,080</td><td align="left">82.330</td><td align="left">3,976,705</td><td align="left">80.758</td></tr><tr><td align="left">LiME<sup>DA</sup> and Centrifuge</td><td align="left">4,694,705</td><td align="left">4,330,269</td><td align="left">92.237</td><td align="left">4,212,149</td><td align="left">89.721</td></tr><tr><td align="left">LiME<sup>DA</sup> and Magic-BLAST</td><td align="left">4,602,062</td><td align="left">4,353,703</td><td align="left">94.603</td><td align="left">4,276,833</td><td align="left">92.933</td></tr><tr><td align="left">Magic-BLAST and Kraken 2</td><td align="left">4,614,673</td><td align="left">4,275,482</td><td align="left">92.650</td><td align="left">4,186,614</td><td align="left">90.724</td></tr><tr><td align="left">Magic-BLAST and taxmaps</td><td align="left">4,512,340</td><td align="left">4,211,627</td><td align="left">93.336</td><td align="left">4,188,458</td><td align="left">92.822</td></tr><tr><td align="left">Magic-BLAST and CLARK-S</td><td align="left">4,823,733</td><td align="left">3,983,670</td><td align="left">82.585</td><td align="left">3,925,157</td><td align="left">81.372</td></tr><tr><td align="left">Magic-BLAST and Centrifuge</td><td align="left">4,647,144</td><td align="left">4,206,957</td><td align="left">90.528</td><td align="left">4,086,148</td><td align="left">87.928</td></tr></tbody></table><table-wrap-foot><p>Best scores are in bold</p></table-wrap-foot></table-wrap></p>
      <p>Analogously to the experiments on simulated data, our strategy using the first approach (LiME<sup>eBWT</sup>) classifies a smaller number of reads than the second approach (LiME<sup>DA</sup>), however the agreement rates <italic>r</italic><sub><italic>id</italic></sub> and <italic>r</italic><sub><italic>as</italic></sub> in Table <xref rid="Tab2" ref-type="table">2</xref> between Magic-BLAST and our strategy are higher using the first approach. In Fig. <xref rid="Fig6" ref-type="fig">6</xref>, thus, we report only a more in-depth analysis of the classification differences between LiME<sup>eBWT</sup> and the other tools, however similar observations can be deduced for LiME<sup>DA</sup> by looking at Table <xref rid="Tab2" ref-type="table">2</xref>. In Fig. <xref rid="Fig6" ref-type="fig">6</xref>, we evaluate the classification concordance comparing LiME<sup>eBWT</sup>, Magic-BLAST and another tool. In each picture, the sets of classified reads are represented by a Venn diagram: the reads lying in the intersection of two/three sets are those classified by both/all tools. The number of individual reads classified by all the three tools is greater in Fig. <xref rid="Fig6" ref-type="fig">6</xref>c when comparing LiME<sup>eBWT</sup>, Magic-BLAST and Kraken 2, while comparing LiME<sup>eBWT</sup>, Magic-BLAST and CLARK-S such number is the smallest (see Fig. <xref rid="Fig6" ref-type="fig">6</xref>a).
<fig id="Fig6"><label>Fig. 6</label><caption><p>Graphical representations of the results in Table <xref rid="Tab2" ref-type="table">2</xref>: (<bold>a</bold>) related to LiME<sup>eBWT</sup>, Magic-BLAST and CLARK-S, (<bold>b</bold>) related to LiME<sup>eBWT</sup>, Magic-BLAST and Centrifuge, (<bold>c</bold>) related to LiME<sup>eBWT</sup>, Magic-BLAST and Kraken 2, (<bold>d</bold>) related to LiME<sup>eBWT</sup>, Magic-BLAST and taxMaps. The black numbers inside each circle if summed give the number of reads classified by the corresponding tool. The percentage under each number denotes the percentage of classified identically reads among two/three tools (see Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S5)</p></caption><graphic xlink:href="12859_2020_3628_Fig6_HTML" id="MO6"/></fig></p>
      <p>Moreover, we notice that the highest number of reads that are classified by one single tool only is registered for CLARK-S (see Fig. <xref rid="Fig6" ref-type="fig">6</xref>a).</p>
      <p>In Fig. <xref rid="Fig6" ref-type="fig">6</xref>, we report, in addition, the percentage of reads with a concordant classification among both/three tools: the assignments performed by LiME<sup>eBWT</sup> are closer to Magic-BLAST (as shown in Table <xref rid="Tab2" ref-type="table">2</xref>), without however largely differing from those performed by all the other tools. In fact, according to Fig. <xref rid="Fig6" ref-type="fig">6</xref>a, d among the reads that are classified by all the three tools, around 98% of them are assigned to the same taxon by all. Overall, for the real metagenome the agreement rates among the tested tools are high, and LiME classification meets that of state-of-the-art classifiers, such as CLARK-S, Centrifuge, Kraken 2 and taxMaps.</p>
    </sec>
  </sec>
  <sec id="Sec9" sec-type="discussion">
    <title>Discussion</title>
    <p>In this section we analyze the impact of the parameters <italic>α</italic> and <italic>β</italic> and discuss the data structures and the resource usage.</p>
    <p><bold>Parameter sweeps</bold> In Figs. <xref rid="Fig4" ref-type="fig">4</xref> and <xref rid="Fig5" ref-type="fig">5</xref>, we looked at parameters relating to the minimum length <italic>α</italic> of the context in Step 1 and to the threshold value <italic>β</italic> in Step 3. The parameter sweep analyzed values in the interval [16,22] for <italic>α</italic> and in the interval [0.15,0.40] for <italic>β</italic>.</p>
    <p>We note that, in both approaches, the parameter sweeps give approximately the same, near-optimal levels of accuracy (see Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S2, for further details). The experimental results confirm that, fixed <italic>α</italic>, the parameter <italic>β</italic> affects the classification accuracy: indeed, decreasing the value of <italic>β</italic> implies a major sensitivity at the cost of a minor precision. So, the trend of the sensitivity curve decreases, while that of precision increases reaching almost 100%. This suggests performance is not overly sensitive to particular parameter settings. From the analysis of the parameter sweep results and from reported experimental results during the comparisons with other tools, it seems that <italic>α</italic>=16 and <italic>β</italic>=0.25 is a good sensitivity-precision trade-off.</p>
    <p>
      <bold>Observations on the data structures.</bold>
    </p>
    <p>We recall that our tool takes as input the files containing <inline-formula id="IEq230"><alternatives><tex-math id="M473">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\textsf {ebwt}(\mathcal {S})$\end{document}</tex-math><mml:math id="M474"><mml:mtext mathvariant="sans-serif">ebwt</mml:mtext><mml:mo>(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq230.gif"/></alternatives></inline-formula>, <inline-formula id="IEq231"><alternatives><tex-math id="M475">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\textsf {da}(\mathcal {S})$\end{document}</tex-math><mml:math id="M476"><mml:mtext mathvariant="sans-serif">da</mml:mtext><mml:mo>(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq231.gif"/></alternatives></inline-formula> and <inline-formula id="IEq232"><alternatives><tex-math id="M477">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\textsf {lcp}(\mathcal {S})$\end{document}</tex-math><mml:math id="M478"><mml:mtext mathvariant="sans-serif">lcp</mml:mtext><mml:mo>(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq232.gif"/></alternatives></inline-formula> of the collection <inline-formula id="IEq233"><alternatives><tex-math id="M479">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {S}$\end{document}</tex-math><mml:math id="M480"><mml:mi mathvariant="script">S</mml:mi></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq233.gif"/></alternatives></inline-formula> of reads and reference genomes. This task can be achieved using, for example one of the following tools, BCR [<xref ref-type="bibr" rid="CR32">32</xref>, <xref ref-type="bibr" rid="CR56">56</xref>], eGSA [<xref ref-type="bibr" rid="CR47">47</xref>, <xref ref-type="bibr" rid="CR57">57</xref>], gSACA-K [<xref ref-type="bibr" rid="CR58">58</xref>, <xref ref-type="bibr" rid="CR59">59</xref>], GAP [<xref ref-type="bibr" rid="CR30">30</xref>] or eGAP [<xref ref-type="bibr" rid="CR34">34</xref>, <xref ref-type="bibr" rid="CR60">60</xref>]. It is interesting to note that the data structures for the genome database used by our strategy can be built once and stored, and then, for each new experiment, we can build the data structures for the read collection and merge the two data structures. More precisely, as the set <inline-formula id="IEq234"><alternatives><tex-math id="M481">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {G}$\end{document}</tex-math><mml:math id="M482"><mml:mi mathvariant="script">G</mml:mi></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq234.gif"/></alternatives></inline-formula> of genomes is the same for each experiment, we can build the data structures of <inline-formula id="IEq235"><alternatives><tex-math id="M483">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {G}$\end{document}</tex-math><mml:math id="M484"><mml:mi mathvariant="script">G</mml:mi></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq235.gif"/></alternatives></inline-formula> only once, by using eGSA for instance, and keep them stored. Then, for each new experiment, we can build the data structures for each read collection <inline-formula id="IEq236"><alternatives><tex-math id="M485">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {R}$\end{document}</tex-math><mml:math id="M486"><mml:mi mathvariant="script">R</mml:mi></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq236.gif"/></alternatives></inline-formula>, for instance, by using BCR (a tool for very large collection of short reads), and finally, merge the two data structures, by using eGAP, and obtain those for the entire collection <inline-formula id="IEq237"><alternatives><tex-math id="M487">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {S}$\end{document}</tex-math><mml:math id="M488"><mml:mi mathvariant="script">S</mml:mi></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq237.gif"/></alternatives></inline-formula>. On the other hand, by exploiting the mathematical properties of the permutation associated with the eBWT and LCP array, by using BCR [<xref ref-type="bibr" rid="CR31">31</xref>, <xref ref-type="bibr" rid="CR32">32</xref>], we could build once the data structures for <inline-formula id="IEq238"><alternatives><tex-math id="M489">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {G}$\end{document}</tex-math><mml:math id="M490"><mml:mi mathvariant="script">G</mml:mi></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq238.gif"/></alternatives></inline-formula> and then update with the symbols from <inline-formula id="IEq239"><alternatives><tex-math id="M491">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {R}$\end{document}</tex-math><mml:math id="M492"><mml:mi mathvariant="script">R</mml:mi></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq239.gif"/></alternatives></inline-formula> (hence, without constructing the eBWT of reads) in order to obtain the data structures for <inline-formula id="IEq240"><alternatives><tex-math id="M493">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {S}$\end{document}</tex-math><mml:math id="M494"><mml:mi mathvariant="script">S</mml:mi></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq240.gif"/></alternatives></inline-formula>. However, to find the best method for building our data structures is not in the aim of this paper.</p>
    <p>We also remark that the data structures used by our strategy are intrinsically dynamic: by taking advantage of the inherent properties of the eBWT and LCP array (see, in particular, ([<xref ref-type="bibr" rid="CR31">31</xref>], Remark 3.6)), the collection <inline-formula id="IEq241"><alternatives><tex-math id="M495">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {S}$\end{document}</tex-math><mml:math id="M496"><mml:mi mathvariant="script">S</mml:mi></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq241.gif"/></alternatives></inline-formula> can be modified by inserting or removing single sequences. This may allow to modify the read dataset by inserting or removing a group of reads, or to update the reference database with newly arranged set of genomes, allowing us to modify <italic>α</italic>-clusters accordingly.</p>
    <p>Moreover, we note that in the recent literature there are several papers with the aim of introducing new lightweight and parallel computational strategies for building the data structures we use in our tool, see for instance [<xref ref-type="bibr" rid="CR33">33</xref>, <xref ref-type="bibr" rid="CR35">35</xref>].</p>
    <p>In this paper, we use algorithm eGAP [<xref ref-type="bibr" rid="CR34">34</xref>, <xref ref-type="bibr" rid="CR60">60</xref>] to merge <inline-formula id="IEq242"><alternatives><tex-math id="M497">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\textsf {ebwt}(\mathcal {R})$\end{document}</tex-math><mml:math id="M498"><mml:mtext mathvariant="sans-serif">ebwt</mml:mtext><mml:mo>(</mml:mo><mml:mi mathvariant="script">R</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq242.gif"/></alternatives></inline-formula> and <inline-formula id="IEq243"><alternatives><tex-math id="M499">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\textsf {da}(\mathcal {R})$\end{document}</tex-math><mml:math id="M500"><mml:mtext mathvariant="sans-serif">da</mml:mtext><mml:mo>(</mml:mo><mml:mi mathvariant="script">R</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq243.gif"/></alternatives></inline-formula> (built by BCR tool) with <inline-formula id="IEq244"><alternatives><tex-math id="M501">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\textsf {ebwt}(\mathcal {G})$\end{document}</tex-math><mml:math id="M502"><mml:mtext mathvariant="sans-serif">ebwt</mml:mtext><mml:mo>(</mml:mo><mml:mi mathvariant="script">G</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq244.gif"/></alternatives></inline-formula> and <inline-formula id="IEq245"><alternatives><tex-math id="M503">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\textsf {da}(\mathcal {G})$\end{document}</tex-math><mml:math id="M504"><mml:mtext mathvariant="sans-serif">da</mml:mtext><mml:mo>(</mml:mo><mml:mi mathvariant="script">G</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq245.gif"/></alternatives></inline-formula> (built by eGSA tool) and obtain <inline-formula id="IEq246"><alternatives><tex-math id="M505">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\textsf {ebwt}(\mathcal {S})$\end{document}</tex-math><mml:math id="M506"><mml:mtext mathvariant="sans-serif">ebwt</mml:mtext><mml:mo>(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq246.gif"/></alternatives></inline-formula> and <inline-formula id="IEq247"><alternatives><tex-math id="M507">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\textsf {da}(\mathcal {S})$\end{document}</tex-math><mml:math id="M508"><mml:mtext mathvariant="sans-serif">da</mml:mtext><mml:mo>(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq247.gif"/></alternatives></inline-formula>, so that the array <inline-formula id="IEq248"><alternatives><tex-math id="M509">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\textsf {lcp}(\mathcal {S})$\end{document}</tex-math><mml:math id="M510"><mml:mtext mathvariant="sans-serif">lcp</mml:mtext><mml:mo>(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq248.gif"/></alternatives></inline-formula> is given as a by-product of the algorithm. In particular, by using the option –trlcp (see [<xref ref-type="bibr" rid="CR60">60</xref>]), one can compute <inline-formula id="IEq249"><alternatives><tex-math id="M511">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\textsf {lcp}(\mathcal {S})$\end{document}</tex-math><mml:math id="M512"><mml:mtext mathvariant="sans-serif">lcp</mml:mtext><mml:mo>(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2020_3628_Article_IEq249.gif"/></alternatives></inline-formula> with values truncated in <italic>k</italic>, where <italic>k</italic> is the longest string length in the read collection. This merging procedure performs <italic>O</italic>(<italic>N</italic>×<italic>k</italic>) sequential scans. In order to use eGAP for our scope, we can set any <italic>k</italic>&gt;<italic>α</italic> to minimize the number of steps.</p>
    <p><bold>Resources</bold> The construction of the required data structures is independent of our method, so one can use any strategy according to the resources available, preferring for example a tool that works in internal memory rather than in external memory, or vice-versa. In addition, such data structures also allow to efficiently compress the original files (FASTA or FASTQ), see for instance [<xref ref-type="bibr" rid="CR61">61</xref>, <xref ref-type="bibr" rid="CR62">62</xref>]. Note that, the other tools (Centrifuge, CLARK-S, Kraken 2, taxMaps and Magic-BLAST) build ad-hoc data structures for the database used in the classification. For instance, CLARK-S needs about 120 GB of RAM for the database used for its classification of the simulated datasets, while Centrifuge, Kraken 2 and taxMaps need about 10 GB of RAM. Moreover, some tools require some information to be specified at the time of building a database, for instance Clark-S requires to set the rank level and Kraken 2 requires to set the <italic>k</italic>-mer length. Thus, they do not have the same flexibility in choosing how to build these data structures and the same independence from the parameter sweeps as LiME.</p>
    <p>Classification experiments were performed by using a DELL PowerEdge R630 machine, 24-core machine with Intel(R) Xeon(R) CPU E5-2620 v3 at 2.40 GHz, with 128 GB of shared memory. The system is Ubuntu 14.04.2 LTS.</p>
    <p>Regarding the time of classification steps, Kraken 2 is the fastest tool, while Magic-BLAST and taxMaps are the slowest ones (taxMaps took about 13 hours for classifying the simulated dataset <italic>s</italic><italic>e</italic><italic>t</italic><italic>A</italic>2). Full results for the dataset <italic>s</italic><italic>e</italic><italic>t</italic><italic>A</italic>2 are available in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S3.</p>
    <p>Observe that for the classification of the dataset <italic>s</italic><italic>e</italic><italic>t</italic><italic>A</italic>2, Clark-S is the tool that requires the most internal memory. While the internal memory used by LiME is about 19,034 MB for the similarity matrix and 786 MB for the other auxiliary data structures.</p>
    <p>Moreover, we observe that LiME, unlike other methods, processes all the reads at the same time, so that in the current implementation we need to keep in internal memory the whole similarity matrix. If one wanted to run our tool on a system without enough RAM to store the similarity matrix, one could either store that matrix on an external file or one could build the list of the clusters for all the reads, and then consider one read per time analyzing only the clusters that contain symbols of that read. In the latter case, the required time for Step 2 and Step 3 of LiME<sup>eBWT</sup> is a few milliseconds and the maximum resident set size is only 16,240 KB. Full results for the dataset <italic>s</italic><italic>e</italic><italic>t</italic><italic>A</italic>2 are available in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S3.</p>
    <p>So, on the basis of the available resources, one could choose the number of reads to be compared simultaneously, in order to get the desired time-memory trade-off.</p>
    <p>Finally, since our method scans sequentially the required data structures, we could analyze unknown sequences of very large collections by using mainly external memory and reduce the internal memory usage.</p>
    <p>The multi-threading version of our tool exploits the fact that our strategy allows a certain degree of parallelization thanks to the analysis of clusters that is independent of each other, so each thread can handle distinct parts of the input files by reading it through local buffers (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S4).</p>
    <p>Moreover, we noticed that LiME<sup>DA</sup> is faster than LiME<sup>eBWT</sup>. This experimental evidence can be easily understood, as LiME<sup>DA</sup> saves time scanning only the DA, rather than both DA and eBWT during the cluster analysis. More specifically, with respect to our three-step method, LiME<sup>DA</sup> is time-saving concerning the completion of the second step (as the first and the third step are the same for both approaches). However, the execution time of the third step largely depends on the number of not-null similarity scores calculated during the second step. Thus, the higher the sensitivity is, the more likely the execution time of the third step could increase.</p>
  </sec>
  <sec id="Sec10" sec-type="conclusion">
    <title>Conclusion</title>
    <p>In this paper, we present a versatile, alignment-free and lightweight tool for metagenomic classification, named LiME, that, by sequentially scanning fundamental string data structures (eBWT, LCP and DA) allows us to efficiently identify the genome to which each read belongs.</p>
    <p>Our method is based on two possible approaches: the first approach LiME<sup>eBWT</sup> takes into account the different symbols in eBWT that precede a common context between the read and the genome that we are comparing. The second approach LiME<sup>DA</sup> takes into account only the colors in DA of each read and the genome that we are comparing. Experiments on both simulated and real datasets corroborate our intuition that the first approach is more precise and less sensitive than the second approach, while keeping high precision and sensitivity in both cases.</p>
    <p>Moreover, we compare LiME (both approaches) with the state-of-the-art tools: Magic-BLAST, CLARK-S, Centrifuge, Kraken 2 and TaxMaps, which have recently been introduced.</p>
    <p>In the experiments, we focused the attention on species level classification, but LiME can also work at higher taxonomic levels such as genus, family, class or phylum. Further experiments at phylum level on simulated datasets show that the relative phylum abundance estimated by LiME meets the dataset composition designed in [<xref ref-type="bibr" rid="CR14">14</xref>] with very high precision. More precisely, LiME<sup>eBWT</sup> on <italic>s</italic><italic>e</italic><italic>t</italic><italic>A</italic>2 (resp. <italic>setB2</italic>) has 95.55<italic>%</italic> (resp. 95.95<italic>%</italic>) of sensitivity, and thus the F1 score achieved is 97.66<italic>%</italic> (resp. 97.91<italic>%</italic>). In particular, we obtain only 129,470 (resp. 40,895) ambiguous reads and 824,036 (resp. 779,515) not classified reads and we correctly classify 20,478,036 (resp. 19,419,539) in <italic>setA2</italic> (resp. <italic>setB2</italic>).</p>
    <p>For the real metagenome dataset, as the “ground truth” is not available and a large number of reads may belong to unknown species, we first filtered the downloaded dataset by using BLAST and extracted information to build a customized reference database. Since Magic-BLAST is based on BLAST, we may consider the results of Magic-BLAST as a benchmark for the classification results. We can thus observe that only 42,788 reads of the considered real dataset classified by Magic-BLAST are not classified by LiME<sup>eBWT</sup>. Our tool classifies, indeed, the same reads as the aligner Magic-BLAST for the 95.2<italic>%</italic>. Whereas CLARK-S, (resp. Centrifuge, Kraken 2, and TaxMaps) fails to classify 408,776 (resp. 185,489, and 116,964, and 180,819) reads, which on the contrary are classified by Magic-BLAST. Furthermore, our tool assigns 93.6<italic>%</italic> of the reads to the same taxons as the aligner Magic-BLAST does.</p>
    <p>Finally, we observe that the notion of LCP-interval [<xref ref-type="bibr" rid="CR63">63</xref>] is a particular <italic>α</italic>-cluster (<italic>p</italic><italic>S</italic>,<italic>p</italic><italic>E</italic>) in which at least an index <italic>i</italic>, <italic>p</italic><italic>S</italic>&lt;<italic>i</italic>≤<italic>p</italic><italic>E</italic>, is equal to <italic>α</italic>. Moreover, there exist several methods that are based on clustering of eBWT symbols with [<xref ref-type="bibr" rid="CR62">62</xref>, <xref ref-type="bibr" rid="CR64">64</xref>, <xref ref-type="bibr" rid="CR65">65</xref>] or without the LCP array [<xref ref-type="bibr" rid="CR21">21</xref>, <xref ref-type="bibr" rid="CR23">23</xref>]. Unlike these methods based on the partitioning of the LCP values, we do not impose any constraint on the <italic>α</italic>-cluster size.</p>
    <p>In conclusion, we believe that our tool can be useful in a variety of applications both in metagenomics and in genomics.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary information</title>
    <sec id="Sec11">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="12859_2020_3628_MOESM1_ESM.xlsx">
            <caption>
              <p><bold>Additional file 1</bold><bold>Table S1</bold>. Classifier comparison of accuracy on simulated data. <bold>Table S2</bold>. Comparison of LiME accuracy using various parameter values <bold>Table S3</bold>. Comparison of computational performance. <bold>Table S4</bold>. Thread scaling evaluation results. <bold>Table S5</bold>. Microbiome comparison results</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>NGS</term>
        <def>
          <p>Next-generation sequencing</p>
        </def>
      </def-item>
      <def-item>
        <term>BWT</term>
        <def>
          <p>Burrows-wheeler transform</p>
        </def>
      </def-item>
      <def-item>
        <term>eBWT</term>
        <def>
          <p>Extended burrows-wheeler transform</p>
        </def>
      </def-item>
      <def-item>
        <term>DA</term>
        <def>
          <p>Document array</p>
        </def>
      </def-item>
      <def-item>
        <term>LCP</term>
        <def>
          <p>Longest common prefix</p>
        </def>
      </def-item>
      <def-item>
        <term>LiME</term>
        <def>
          <p>Lightweight metagenomics via eBWT</p>
        </def>
      </def-item>
      <def-item>
        <term>BLAST</term>
        <def>
          <p>Basic local alignment search tool</p>
        </def>
      </def-item>
      <def-item>
        <term>IUPAC</term>
        <def>
          <p>International union of pure and applied chemistry</p>
        </def>
      </def-item>
      <def-item>
        <term>LCA</term>
        <def>
          <p>Lowest common ancestor</p>
        </def>
      </def-item>
      <def-item>
        <term>HMP</term>
        <def>
          <p>Human microbiome project</p>
        </def>
      </def-item>
      <def-item>
        <term>FP</term>
        <def>
          <p>False positives</p>
        </def>
      </def-item>
      <def-item>
        <term>TP</term>
        <def>
          <p>True positives</p>
        </def>
      </def-item>
      <def-item>
        <term>FN</term>
        <def>
          <p>False negatives</p>
        </def>
      </def-item>
      <def-item>
        <term>TN</term>
        <def>
          <p>True negatives</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn id="Fn1">
      <label>1</label>
      <p>More formally, a spaced seed <italic>S</italic> (or just a seed) is a binary string of length <italic>k</italic>, where the symbol ‘1’ requires a match in that position, while a symbol ‘0’ allows for “don’t care”. A spaced seed is characterized by its length <italic>k</italic> and by its weight <italic>W</italic>&lt;<italic>k</italic>, which is the number of 1s in the string. A spaced seed always begins and ends with a 1.</p>
    </fn>
    <fn id="Fn2">
      <label>2</label>
      <p>The IUPAC code has defined a standard representation of DNA bases by single characters that specify either a single base (e.g., <italic>G</italic> for guanine, <italic>A</italic> for adenine) or a set of bases (e.g., <italic>R</italic> for either <italic>G</italic> or <italic>A</italic>).</p>
    </fn>
    <fn id="Fn3">
      <label>3</label>
      <p>We clarify that this measure differs from the measure introduced in [<xref ref-type="bibr" rid="CR45">45</xref>], since in the preliminary work the ambiguity symbols could match with any symbol, as if they were placeholders.</p>
    </fn>
    <fn id="Fn4">
      <label>4</label>
      <p>A transcriptome is a collection of RNA molecules derived from genes, whose biological information is required by the cell at a particular time.</p>
    </fn>
    <fn>
      <p>
        <bold>Publisher’s Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <sec>
    <title>Supplementary information</title>
    <p><bold>Supplementary information</bold> accompanies this paper at 10.1186/s12859-020-03628-w.</p>
  </sec>
  <ack>
    <p>The authors are very grateful to the anonymous referees: their remarks were helpful in substantially improving this paper by pointing out some inaccuracies in the first version. Moreover their suggestions have enhanced the readability of the paper.</p>
    <sec id="d30e9853">
      <title>About this supplement</title>
      <p>This article has been published as part of Volume 21, Supplement 8 2020: Italian Society of Bioinformatics (BITS): Annual Meeting 2019. The full contents of the supplement are available at <ext-link ext-link-type="uri" xlink:href="https://bmcbioinformatics.biomedcentral.com/articles/supplements/volume-21-supplement-8">https://bmcbioinformatics.biomedcentral.com/articles/supplements/volume-21-supplement-8</ext-link>.</p>
    </sec>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>VG and GR designed the main approach and the main algorithmic ideas. All authors contributed to improve the design, analysis and algorithms, and wrote the manuscript. VG and FAL implemented the algorithms. VG and GR designed and performed the experiments. All authors read and approved the final manuscript. GR is the PI of the project that supported this study.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>GR is partially, and VG is totally, supported by the project MIUR-SIR CMACBioSeq (“Combinatorial methods for analysis and compression of biological sequences”) grant n. RBSI146R5L. FAL acknowledge the financial support of Brazilian Agencies CNPq and CAPES. Publication costs are funded by the project MIUR-SIR CMACBioSeq grant n. RBSI146R5L.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>The tool LiME is freely available for academic use at <ext-link ext-link-type="uri" xlink:href="https://github.com/veronicaguerrini/LiME">https://github.com/veronicaguerrini/LiME</ext-link>. Information to download the datasets used and analysed in the current study is available in the Datasets directory of the same Github repository. The datasets can also be available from the corresponding author on reasonable request.</p>
  </notes>
  <notes id="FPar1">
    <title>Ethics approval and consent to participate</title>
    <p>Not applicable.</p>
  </notes>
  <notes id="FPar2">
    <title>Consent for publication</title>
    <p>Not applicable.</p>
  </notes>
  <notes id="FPar3" notes-type="COI-statement">
    <title>Competing interests</title>
    <p>The authors declare that they have no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1</label>
      <mixed-citation publication-type="other">Pedersen MW, et al. Ancient and modern environmental DNA. Philos Trans R Soc Lond B Biol Sci. 2015; 370(1660). 10.1098/rstb.2013.0383.</mixed-citation>
    </ref>
    <ref id="CR2">
      <label>2</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wood</surname>
            <given-names>DE</given-names>
          </name>
          <name>
            <surname>Salzberg</surname>
            <given-names>SL</given-names>
          </name>
        </person-group>
        <article-title>Kraken: ultrafast metagenomic sequence classification using exact alignments</article-title>
        <source>Genome Biol</source>
        <year>2014</year>
        <volume>15</volume>
        <issue>3</issue>
        <fpage>46</fpage>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ounit</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Wanamaker</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Close</surname>
            <given-names>TJ</given-names>
          </name>
          <name>
            <surname>Lonardi</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>CLARK: fast and accurate classification of metagenomic and genomic sequences using discriminative k-mers</article-title>
        <source>BMC Genomics</source>
        <year>2015</year>
        <volume>16</volume>
        <issue>1</issue>
        <fpage>236</fpage>
        <?supplied-pmid 25879410?>
        <pub-id pub-id-type="pmid">25879410</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kim</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Song</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Breitwieser</surname>
            <given-names>FP</given-names>
          </name>
          <name>
            <surname>Salzberg</surname>
            <given-names>SL</given-names>
          </name>
        </person-group>
        <article-title>Centrifuge: rapid and sensitive classification of metagenomic sequences</article-title>
        <source>Genome Res</source>
        <year>2016</year>
        <volume>26</volume>
        <issue>12</issue>
        <fpage>1721</fpage>
        <lpage>9</lpage>
        <?supplied-pmid 27852649?>
        <pub-id pub-id-type="pmid">27852649</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ounit</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Lonardi</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Higher classification sensitivity of short metagenomic reads with CLARK-S</article-title>
        <source>Bioinformatics</source>
        <year>2016</year>
        <volume>32</volume>
        <issue>24</issue>
        <fpage>3823</fpage>
        <lpage>5</lpage>
        <?supplied-pmid 27540266?>
        <pub-id pub-id-type="pmid">27540266</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6</label>
      <mixed-citation publication-type="other">Corvelo A, Clarke WE, Robine N, Zody MC. taxMaps: comprehensive and highly accurate taxonomic classification of short-read data in reasonable time. Genome Res. 2018. 10.1101/gr.225276.117.</mixed-citation>
    </ref>
    <ref id="CR7">
      <label>7</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wood</surname>
            <given-names>DE</given-names>
          </name>
          <name>
            <surname>Lu</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Langmead</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Improved metagenomic analysis with kraken 2</article-title>
        <source>Genome Biol</source>
        <year>2019</year>
        <volume>20</volume>
        <issue>1</issue>
        <fpage>257</fpage>
        <?supplied-pmid 31779668?>
        <pub-id pub-id-type="pmid">31779668</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Leung</surname>
            <given-names>HC</given-names>
          </name>
          <name>
            <surname>Yiu</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Chin</surname>
            <given-names>FY</given-names>
          </name>
        </person-group>
        <article-title>MetaCluster 5.0: a two-round binning approach for metagenomic data for low-abundance species in a noisy sample</article-title>
        <source>Bioinformatics</source>
        <year>2012</year>
        <volume>28</volume>
        <issue>18</issue>
        <fpage>356</fpage>
        <lpage>62</lpage>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Girotto</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Pizzi</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Comin</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>MetaProb: accurate metagenomic reads binning based on probabilistic sequence signatures</article-title>
        <source>Bioinformatics</source>
        <year>2016</year>
        <volume>32</volume>
        <issue>17</issue>
        <fpage>567</fpage>
        <lpage>75</lpage>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Breitwieser</surname>
            <given-names>FP</given-names>
          </name>
          <name>
            <surname>Lu</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Salzberg</surname>
            <given-names>SL</given-names>
          </name>
        </person-group>
        <article-title>A review of methods and databases for metagenomic classification and assembly</article-title>
        <source>Brief Bioinforma</source>
        <year>2017</year>
        <volume>20</volume>
        <issue>4</issue>
        <fpage>1125</fpage>
        <lpage>36</lpage>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zielezinski</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Vinga</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Almeida</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Karlowski</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>Alignment-free sequence comparison: Benefits, applications, and tools</article-title>
        <source>Genome Biol</source>
        <year>2017</year>
        <volume>18</volume>
        <fpage>186</fpage>
        <?supplied-pmid 28974235?>
        <pub-id pub-id-type="pmid">28974235</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Altschul</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Gish</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Miller</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Myers</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Lipman</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Basic local alignment search tool</article-title>
        <source>J Mol Biol</source>
        <year>1990</year>
        <volume>215</volume>
        <issue>3</issue>
        <fpage>403</fpage>
        <lpage>10</lpage>
        <?supplied-pmid 2231712?>
        <pub-id pub-id-type="pmid">2231712</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13</label>
      <mixed-citation publication-type="other">Menzel P, Ng KL, Krogh A. Fast and sensitive taxonomic classification for metagenomics with kaiju. Nat Commun. 2016. 10.1038/ncomms11257.</mixed-citation>
    </ref>
    <ref id="CR14">
      <label>14</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lindgreen</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Adair</surname>
            <given-names>KL</given-names>
          </name>
          <name>
            <surname>Gardner</surname>
            <given-names>PP</given-names>
          </name>
        </person-group>
        <article-title>An evaluation of the accuracy and speed of metagenome analysis tools</article-title>
        <source>Sci Rep</source>
        <year>2016</year>
        <volume>6</volume>
        <fpage>19233</fpage>
        <?supplied-pmid 26778510?>
        <pub-id pub-id-type="pmid">26778510</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>McIntyre</surname>
            <given-names>ABR</given-names>
          </name>
          <name>
            <surname>Ounit</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Afshinnekoo</surname>
            <given-names>E</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Comprehensive benchmarking and ensemble approaches for metagenomic classifiers</article-title>
        <source>Genome Biol</source>
        <year>2017</year>
        <volume>18</volume>
        <issue>1</issue>
        <fpage>182</fpage>
        <?supplied-pmid 28934964?>
        <pub-id pub-id-type="pmid">28934964</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16</label>
      <mixed-citation publication-type="other">Ferragina P, Manzini G. Opportunistic data structures with applications. In: 41st Annual Symposium on Foundations of Computer Science, FOCS 2000, 12-14 November 2000, Redondo Beach, California, USA: 2000. p. 390–8. 10.1109/SFCS.2000.892127.</mixed-citation>
    </ref>
    <ref id="CR17">
      <label>17</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Marco-Sola</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Sammeth</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Guigó</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Ribeca</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>The GEM mapper: fast, accurate and versatile alignment by filtration</article-title>
        <source>Nat Methods</source>
        <year>2012</year>
        <volume>9</volume>
        <issue>12</issue>
        <fpage>1185</fpage>
        <lpage>8</lpage>
        <?supplied-pmid 23103880?>
        <pub-id pub-id-type="pmid">23103880</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18</label>
      <mixed-citation publication-type="other">Boratyn GM, Thierry-Mieg J, Thierry-Mieg D, Busby B, Madden TL. Magic-BLAST, an accurate RNA-seq aligner for long and short reads. BMC Bioinformatics. 2019; 20(405). 10.1186/s12859-019-2996-x.</mixed-citation>
    </ref>
    <ref id="CR19">
      <label>19</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Vinga</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Almeida</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Alignment-free sequence comparison – a review</article-title>
        <source>Bioinformatics</source>
        <year>2003</year>
        <volume>19</volume>
        <issue>4</issue>
        <fpage>513</fpage>
        <lpage>23</lpage>
        <?supplied-pmid 12611807?>
        <pub-id pub-id-type="pmid">12611807</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mantaci</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Restivo</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Sciortino</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Distance measures for biological sequences: Some recent approaches</article-title>
        <source>Int J Approx Reasoning</source>
        <year>2008</year>
        <volume>47</volume>
        <issue>1</issue>
        <fpage>109</fpage>
        <lpage>24</lpage>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mantaci</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Restivo</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Rosone</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Sciortino</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>An extension of the Burrows-Wheeler Transform</article-title>
        <source>Theoret Comput Sci</source>
        <year>2007</year>
        <volume>387</volume>
        <issue>3</issue>
        <fpage>298</fpage>
        <lpage>312</lpage>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22</label>
      <mixed-citation publication-type="other">Hon W, Ku T, Lu C, Shah R, Thankachan SV. Efficient algorithm for circular burrows-wheeler transform. In: Combinatorial Pattern Matching - 23rd Annual Symposium, CPM 2012, Helsinki, Finland, July 3-5, 2012. Proceedings: 2012. p. 257–68. 10.1007/978-3-642-31265-6_21.</mixed-citation>
    </ref>
    <ref id="CR23">
      <label>23</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mantaci</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Restivo</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Rosone</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Sciortino</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>A new combinatorial approach to sequence comparison</article-title>
        <source>Theory Comput Syst</source>
        <year>2008</year>
        <volume>42</volume>
        <issue>3</issue>
        <fpage>411</fpage>
        <lpage>29</lpage>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yang</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>The Burrows-Wheeler similarity distribution between biological sequences based on Burrows-Wheeler transform</article-title>
        <source>J Theor Biol</source>
        <year>2010</year>
        <volume>262</volume>
        <issue>4</issue>
        <fpage>742</fpage>
        <lpage>9</lpage>
        <?supplied-pmid 19903487?>
        <pub-id pub-id-type="pmid">19903487</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25</label>
      <mixed-citation publication-type="other">Cox AJ, Jakobi T, Rosone G, Schulz-Trieglaff OB. Comparing DNA sequence collections by direct comparison of compressed text indexes. In: WABI. LNBI 7534: 2012. p. 214–24. 10.1007/978-3-642-33122-0_17.</mixed-citation>
    </ref>
    <ref id="CR26">
      <label>26</label>
      <mixed-citation publication-type="other">Louza FA, Telles GP, Gog S, Zhao L. Algorithms to compute the burrows-wheeler similarity distribution. Theor Comput Sci. 2019; 782:145–56. 10.1016/j.tcs.2019.03.012.</mixed-citation>
    </ref>
    <ref id="CR27">
      <label>27</label>
      <mixed-citation publication-type="other">Ng K-H, Ho C-K, Phon-Amnuaisuk S. A hybrid distance measure for clustering expressed sequence tags originating from the same gene family. PLoS ONE. 2012; 7(10). 10.1371/journal.pone.0047216.</mixed-citation>
    </ref>
    <ref id="CR28">
      <label>28</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Muthukrishnan</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Efficient algorithms for document retrieval problems</article-title>
        <source>Proceedings of the Thirteenth Annual ACM-SIAM Symposium on Discrete Algorithms</source>
        <year>2002</year>
        <publisher-loc>USA</publisher-loc>
        <publisher-name>Society for Industrial and Applied Mathematics</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Manber</surname>
            <given-names>U</given-names>
          </name>
          <name>
            <surname>Myers</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Suffix arrays: A new method for on-line string searches</article-title>
        <source>Proceedings of the First Annual ACM-SIAM Symposium on Discrete Algorithms</source>
        <year>1990</year>
        <publisher-loc>USA</publisher-loc>
        <publisher-name>Society for Industrial and Applied Mathematics</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30</label>
      <mixed-citation publication-type="other">Egidi L, Manzini G. Lightweight BWT and LCP merging via the gap algorithm. In: String Processing and Information Retrieval - 24th International Symposium, SPIRE 2017, Palermo, Italy, September 26-29, 2017, Proceedings: 2017. p. 176–90. 10.1007/978-3-319-67428-5_15.</mixed-citation>
    </ref>
    <ref id="CR31">
      <label>31</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bauer</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Cox</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Rosone</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Lightweight algorithms for constructing and inverting the BWT of string collections</article-title>
        <source>Theor Comput Sci</source>
        <year>2013</year>
        <volume>483</volume>
        <issue>0</issue>
        <fpage>134</fpage>
        <lpage>48</lpage>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cox</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Garofalo</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Rosone</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Sciortino</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Lightweight LCP construction for very large collections of strings</article-title>
        <source>J Discrete Algoritm</source>
        <year>2016</year>
        <volume>37</volume>
        <fpage>17</fpage>
        <lpage>33</lpage>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33</label>
      <mixed-citation publication-type="other">Bonizzoni P, Vedova GD, Nicosia S, Pirola Y, Previtali M, Rizzi R. Divide and conquer computation of the multi-string BWT and LCP array. In: Sailing Routes in the World of Computation - 14th Conference on Computability in Europe, CiE 2018, Kiel, Germany, July 30 - August 3, 2018, Proceedings: 2018. p. 107–17. 10.1007/978-3-319-94418-0_11.</mixed-citation>
    </ref>
    <ref id="CR34">
      <label>34</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Egidi</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Louza</surname>
            <given-names>FA</given-names>
          </name>
          <name>
            <surname>Manzini</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Telles</surname>
            <given-names>GP</given-names>
          </name>
        </person-group>
        <article-title>External memory BWT and LCP computation for sequence collections with applications</article-title>
        <source>Algoritm Mol Biol</source>
        <year>2019</year>
        <volume>14</volume>
        <issue>1</issue>
        <fpage>6</fpage>
        <lpage>1615</lpage>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bonizzoni</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Della Vedova</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Pirola</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Previtali</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Rizzi</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Multithread multistring burrows-wheeler transform and longest common prefix array</article-title>
        <source>J Comput Biol J Comput Mol Cell Biol</source>
        <year>2019</year>
        <volume>26</volume>
        <issue>9</issue>
        <fpage>948</fpage>
        <lpage>61</lpage>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36</label>
      <mixed-citation publication-type="other">Burrows M, Wheeler DJ. A Block Sorting data Compression Algorithm. Technical report, DIGITAL System Research Center. 1994.</mixed-citation>
    </ref>
    <ref id="CR37">
      <label>37</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Restivo</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Rosone</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Balancing and clustering of words in the Burrows-Wheeler transform</article-title>
        <source>Theor Comput Sci</source>
        <year>2011</year>
        <volume>412</volume>
        <issue>27</issue>
        <fpage>3019</fpage>
        <lpage>32</lpage>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mantaci</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Restivo</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Rosone</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Sciortino</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Versari</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>Measuring the clustering effect of BWT via RLE</article-title>
        <source>Theor Comput Sci</source>
        <year>2017</year>
        <volume>698</volume>
        <fpage>79</fpage>
        <lpage>87</lpage>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39</label>
      <mixed-citation publication-type="other">Gagie T, Navarro G, Prezza N. Optimal-time text indexing in bwt-runs bounded space. In: Proceedings of the Twenty-Ninth Annual ACM-SIAM Symposium on Discrete Algorithms, SODA 2018, New Orleans, LA, USA, January 7-10, 2018: 2018. p. 1459–77. 10.1137/1.9781611975031.96.</mixed-citation>
    </ref>
    <ref id="CR40">
      <label>40</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mantaci</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Restivo</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Sciortino</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Burrows-Wheeler transform and Sturmian words</article-title>
        <source>Information Processing Letters</source>
        <year>2003</year>
        <volume>86</volume>
        <fpage>241</fpage>
        <lpage>246</lpage>
      </element-citation>
    </ref>
    <ref id="CR41">
      <label>41</label>
      <mixed-citation publication-type="other">Simpson J, Puglisi SJ. Words with simple Burrows-Wheeler transforms. Electron J Comb. 2008;15(1). <ext-link ext-link-type="uri" xlink:href="https://dblp.uni-trier.de/rec/bibtex/journals/combinatorics/SimpsonP08">https://dblp.uni-trier.de/rec/bibtex/journals/combinatorics/SimpsonP08</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR42">
      <label>42</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Restivo</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Rosone</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Burrows-Wheeler transform and palindromic richness</article-title>
        <source>Theor Comput Sci</source>
        <year>2009</year>
        <volume>410</volume>
        <issue>30-32</issue>
        <fpage>3018</fpage>
        <lpage>26</lpage>
      </element-citation>
    </ref>
    <ref id="CR43">
      <label>43</label>
      <mixed-citation publication-type="other">Ferenczi S, Zamboni LQ. Clustering Words and Interval Exchanges. J Integer Sequences. 2013; 16(2):13–21.</mixed-citation>
    </ref>
    <ref id="CR44">
      <label>44</label>
      <mixed-citation publication-type="other">Choi I, Ponsero AJ, Bomhoff M, Youens-Clark K, Hartman JH, Hurwitz BL. Libra: scalable k-mer-based tool for massive all-vs-all metagenome comparisons. GigaScience. 2018; 8(2). 10.1093/gigascience/giy165.</mixed-citation>
    </ref>
    <ref id="CR45">
      <label>45</label>
      <mixed-citation publication-type="other">Guerrini V, Rosone G. Lightweight metagenomic classification via ebwt. In: Algorithms for Computational Biology - 6th International Conference, AlCoB 2019, Berkeley, CA, USA, May 28-30, 2019, Proceedings. Cham: Springer: 2019. p. 112–24. 10.1007/978-3-030-18174-1_8.</mixed-citation>
    </ref>
    <ref id="CR46">
      <label>46</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cornish-Bowden</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Nomenclature for incompletely specified bases in nucleic acid sequences: rcommendations 1984</article-title>
        <source>Nucleic Acids Res</source>
        <year>1985</year>
        <volume>13</volume>
        <issue>9</issue>
        <fpage>3021</fpage>
        <lpage>30</lpage>
        <?supplied-pmid 2582368?>
        <pub-id pub-id-type="pmid">2582368</pub-id>
      </element-citation>
    </ref>
    <ref id="CR47">
      <label>47</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Louza</surname>
            <given-names>FA</given-names>
          </name>
          <name>
            <surname>Telles</surname>
            <given-names>GP</given-names>
          </name>
          <name>
            <surname>Hoffmann</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>de Aguiar Ciferri</surname>
            <given-names>CD</given-names>
          </name>
        </person-group>
        <article-title>Generalized enhanced suffix array construction in external memory</article-title>
        <source>Algoritm Mol Biol</source>
        <year>2017</year>
        <volume>12</volume>
        <issue>1</issue>
        <fpage>26</fpage>
        <lpage>12616</lpage>
      </element-citation>
    </ref>
    <ref id="CR48">
      <label>48</label>
      <mixed-citation publication-type="other">Prezza N, Rosone G. Space-efficient computation of the LCP array from the burrows-wheeler transform. In: 30th Annual Symposium on Combinatorial Pattern Matching, CPM 2019, June 18-20, 2019, Pisa, Italy: 2019. p. 7–1718. 10.4230/LIPIcs.CPM.2019.7.</mixed-citation>
    </ref>
    <ref id="CR49">
      <label>49</label>
      <mixed-citation publication-type="other">LiME. GitHub repository. <ext-link ext-link-type="uri" xlink:href="https://github.com/veronicaguerrini/LiME">https://github.com/veronicaguerrini/LiME</ext-link>. Accessed 26 March 2020.</mixed-citation>
    </ref>
    <ref id="CR50">
      <label>50</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ye</surname>
            <given-names>SH</given-names>
          </name>
          <name>
            <surname>Siddle</surname>
            <given-names>KJ</given-names>
          </name>
          <name>
            <surname>Park</surname>
            <given-names>PC</given-names>
          </name>
          <name>
            <surname>Sabeti</surname>
            <given-names>DJ</given-names>
          </name>
        </person-group>
        <article-title>Benchmarking metagenomics tools for taxonomic classification</article-title>
        <source>Cell</source>
        <year>2019</year>
        <volume>178</volume>
        <issue>4</issue>
        <fpage>779</fpage>
        <lpage>94</lpage>
        <?supplied-pmid 31398336?>
        <pub-id pub-id-type="pmid">31398336</pub-id>
      </element-citation>
    </ref>
    <ref id="CR51">
      <label>51</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Langmead</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Trapnell</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Pop</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Salzberg</surname>
            <given-names>SL</given-names>
          </name>
        </person-group>
        <article-title>Ultrafast and memory-efficient alignment of short DNA sequences to the human genome</article-title>
        <source>Genome Biol</source>
        <year>2009</year>
        <volume>10</volume>
        <issue>3</issue>
        <fpage>25</fpage>
      </element-citation>
    </ref>
    <ref id="CR52">
      <label>52</label>
      <mixed-citation publication-type="other">Simulated datasets. <ext-link ext-link-type="uri" xlink:href="http://www.gardner-binflab.org/our_research/">http://www.gardner-binflab.org/our_research/</ext-link>. Accessed 1 Nov 2019.</mixed-citation>
    </ref>
    <ref id="CR53">
      <label>53</label>
      <mixed-citation publication-type="other">Datasets. <ext-link ext-link-type="uri" xlink:href="https://github.com/veronicaguerrini/LiME/tree/master/Datasets">https://github.com/veronicaguerrini/LiME/tree/master/Datasets</ext-link>. Accessed 1 Nov 2019.</mixed-citation>
    </ref>
    <ref id="CR54">
      <label>54</label>
      <mixed-citation publication-type="other">NCBI Taxonomy. ftp://ftp.ncbi.nlm.nih.gov/pub/taxonomy. Accessed 1 Nov 2019.</mixed-citation>
    </ref>
    <ref id="CR55">
      <label>55</label>
      <mixed-citation publication-type="other">Sobih A, Tomescu AI, Mäkinen V. Metaflow: Metagenomic profiling based on whole-genome coverage analysis with min-cost flows. In: Research in Computational Molecular Biology: 2016. p. 111–21. 10.1007/978-3-319-31957-5_8.</mixed-citation>
    </ref>
    <ref id="CR56">
      <label>56</label>
      <mixed-citation publication-type="other">BCR_LCP_GSA. GitHub repository. <ext-link ext-link-type="uri" xlink:href="https://github.com/giovannarosone/BCR_LCP_GSA.git">https://github.com/giovannarosone/BCR_LCP_GSA.git</ext-link>. Accessed 1 Nov 2019.</mixed-citation>
    </ref>
    <ref id="CR57">
      <label>57</label>
      <mixed-citation publication-type="other">eGSA. GitHub repository. <ext-link ext-link-type="uri" xlink:href="https://github.com/felipelouza/egsa.git">https://github.com/felipelouza/egsa.git</ext-link>. Accessed 1 Nov 2019.</mixed-citation>
    </ref>
    <ref id="CR58">
      <label>58</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Louza</surname>
            <given-names>FA</given-names>
          </name>
          <name>
            <surname>Gog</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Telles</surname>
            <given-names>GP</given-names>
          </name>
        </person-group>
        <article-title>Inducing enhanced suffix arrays for string collections</article-title>
        <source>Theor Comput Sci</source>
        <year>2017</year>
        <volume>678</volume>
        <fpage>22</fpage>
        <lpage>39</lpage>
      </element-citation>
    </ref>
    <ref id="CR59">
      <label>59</label>
      <mixed-citation publication-type="other">gSACA-K. GitHub repository. <ext-link ext-link-type="uri" xlink:href="https://github.com/felipelouza/gsa-is.git">https://github.com/felipelouza/gsa-is.git</ext-link>. Accessed 1 Nov 2019.</mixed-citation>
    </ref>
    <ref id="CR60">
      <label>60</label>
      <mixed-citation publication-type="other">eGAP. GitHub repository. <ext-link ext-link-type="uri" xlink:href="https://github.com/felipelouza/egap.git">https://github.com/felipelouza/egap.git</ext-link>. Accessed 1 Nov 2019.</mixed-citation>
    </ref>
    <ref id="CR61">
      <label>61</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cox</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Bauer</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Jakobi</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Rosone</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Large-scale compression of genomic sequence databases with the Burrows-Wheeler transform</article-title>
        <source>Bioinformatics</source>
        <year>2012</year>
        <volume>28</volume>
        <issue>11</issue>
        <fpage>1415</fpage>
        <lpage>9</lpage>
        <?supplied-pmid 22556365?>
        <pub-id pub-id-type="pmid">22556365</pub-id>
      </element-citation>
    </ref>
    <ref id="CR62">
      <label>62</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Janin</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Rosone</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Cox</surname>
            <given-names>AJ</given-names>
          </name>
        </person-group>
        <article-title>Adaptive reference-free compression of sequence quality scores</article-title>
        <source>Bioinformatics</source>
        <year>2014</year>
        <volume>30</volume>
        <issue>1</issue>
        <fpage>24</fpage>
        <lpage>30</lpage>
        <?supplied-pmid 23661694?>
        <pub-id pub-id-type="pmid">23661694</pub-id>
      </element-citation>
    </ref>
    <ref id="CR63">
      <label>63</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Abouelhoda</surname>
            <given-names>MI</given-names>
          </name>
          <name>
            <surname>Kurtz</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Ohlebusch</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>Replacing suffix trees with enhanced suffix arrays</article-title>
        <source>J Discrete Algoritm</source>
        <year>2004</year>
        <volume>2</volume>
        <issue>1</issue>
        <fpage>53</fpage>
        <lpage>86</lpage>
      </element-citation>
    </ref>
    <ref id="CR64">
      <label>64</label>
      <mixed-citation publication-type="other">Prezza N, Pisanti N, Sciortino M, Rosone G. Detecting mutations by ebwt. In: 18th International Workshop on Algorithms in Bioinformatics, WABI 2018, August 20-22, 2018, Helsinki, Finland: 2018. p. 3–1315. 10.4230/LIPIcs.WABI.2018.3.</mixed-citation>
    </ref>
    <ref id="CR65">
      <label>65</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Prezza</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Pisanti</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Sciortino</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Rosone</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>SNPs detection by eBWT positional clustering</article-title>
        <source>Algoritm Mol Biol</source>
        <year>2019</year>
        <volume>14</volume>
        <issue>1</issue>
        <fpage>3</fpage>
      </element-citation>
    </ref>
  </ref-list>
</back>
