<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Nat Commun</journal-id>
    <journal-id journal-id-type="iso-abbrev">Nat Commun</journal-id>
    <journal-title-group>
      <journal-title>Nature Communications</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2041-1723</issn>
    <publisher>
      <publisher-name>Nature Publishing Group UK</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10423204</article-id>
    <article-id pub-id-type="pmid">37573342</article-id>
    <article-id pub-id-type="publisher-id">40658</article-id>
    <article-id pub-id-type="doi">10.1038/s41467-023-40658-3</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>SnapFISH: a computational pipeline to identify chromatin loops from multiplexed DNA FISH data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Lee</surname>
          <given-names>Lindsay</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Yu</surname>
          <given-names>Hongyu</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Jia</surname>
          <given-names>Bojing Blair</given-names>
        </name>
        <xref ref-type="aff" rid="Aff4">4</xref>
        <xref ref-type="aff" rid="Aff5">5</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Jussila</surname>
          <given-names>Adam</given-names>
        </name>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-4216-6562</contrib-id>
        <name>
          <surname>Zhu</surname>
          <given-names>Chenxu</given-names>
        </name>
        <xref ref-type="aff" rid="Aff6">6</xref>
        <xref ref-type="aff" rid="Aff7">7</xref>
        <xref ref-type="aff" rid="Aff8">8</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Chen</surname>
          <given-names>Jiawen</given-names>
        </name>
        <xref ref-type="aff" rid="Aff9">9</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Xie</surname>
          <given-names>Liangqi</given-names>
        </name>
        <xref ref-type="aff" rid="Aff10">10</xref>
        <xref ref-type="aff" rid="Aff11">11</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Hafner</surname>
          <given-names>Antonina</given-names>
        </name>
        <xref ref-type="aff" rid="Aff12">12</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Mishra</surname>
          <given-names>Shreya</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wang</surname>
          <given-names>Duan Dennis</given-names>
        </name>
        <xref ref-type="aff" rid="Aff13">13</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-1069-1816</contrib-id>
        <name>
          <surname>Strambio-De-Castillia</surname>
          <given-names>Caterina</given-names>
        </name>
        <xref ref-type="aff" rid="Aff14">14</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Boettiger</surname>
          <given-names>Alistair</given-names>
        </name>
        <xref ref-type="aff" rid="Aff12">12</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ren</surname>
          <given-names>Bing</given-names>
        </name>
        <xref ref-type="aff" rid="Aff6">6</xref>
        <xref ref-type="aff" rid="Aff15">15</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-9275-4189</contrib-id>
        <name>
          <surname>Li</surname>
          <given-names>Yun</given-names>
        </name>
        <address>
          <email>yunli@med.unc.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff9">9</xref>
        <xref ref-type="aff" rid="Aff16">16</xref>
        <xref ref-type="aff" rid="Aff17">17</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-0987-2916</contrib-id>
        <name>
          <surname>Hu</surname>
          <given-names>Ming</given-names>
        </name>
        <address>
          <email>hum@ccf.org</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/03xjacd83</institution-id><institution-id institution-id-type="GRID">grid.239578.2</institution-id><institution-id institution-id-type="ISNI">0000 0001 0675 4725</institution-id><institution>Department of Quantitative Health Sciences, Lerner Research Institute, </institution><institution>Cleveland Clinic Foundation, </institution></institution-wrap>Cleveland, OH USA </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/01y2jtd41</institution-id><institution-id institution-id-type="GRID">grid.14003.36</institution-id><institution-id institution-id-type="ISNI">0000 0001 2167 3675</institution-id><institution>Department of Statistics, </institution><institution>University of Wisconsin Madison, </institution></institution-wrap>Madison, WI USA </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/01y2jtd41</institution-id><institution-id institution-id-type="GRID">grid.14003.36</institution-id><institution-id institution-id-type="ISNI">0000 0001 2167 3675</institution-id><institution>Department of Biochemistry, </institution><institution>University of Wisconsin Madison, </institution></institution-wrap>Madison, WI USA </aff>
      <aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/0168r3w48</institution-id><institution-id institution-id-type="GRID">grid.266100.3</institution-id><institution-id institution-id-type="ISNI">0000 0001 2107 4242</institution-id><institution>Bioinformatics and Systems Biology Graduate Program, </institution><institution>University of California San Diego, </institution></institution-wrap>La Jolla, CA USA </aff>
      <aff id="Aff5"><label>5</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/0168r3w48</institution-id><institution-id institution-id-type="GRID">grid.266100.3</institution-id><institution-id institution-id-type="ISNI">0000 0001 2107 4242</institution-id><institution>Medical Scientist Training Program, </institution><institution>University of California San Diego, </institution></institution-wrap>La Jolla, CA USA </aff>
      <aff id="Aff6"><label>6</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/05qdwtz81</institution-id><institution-id institution-id-type="GRID">grid.1052.6</institution-id><institution-id institution-id-type="ISNI">0000 0000 9737 1625</institution-id><institution>Ludwig Institute for Cancer Research, </institution></institution-wrap>La Jolla, CA USA </aff>
      <aff id="Aff7"><label>7</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/05wf2ga96</institution-id><institution-id institution-id-type="GRID">grid.429884.b</institution-id><institution-id institution-id-type="ISNI">0000 0004 1791 0895</institution-id><institution>New York Genome Center, </institution></institution-wrap>New York, NY USA </aff>
      <aff id="Aff8"><label>8</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/02r109517</institution-id><institution-id institution-id-type="GRID">grid.471410.7</institution-id><institution-id institution-id-type="ISNI">0000 0001 2179 7643</institution-id><institution>Department of Physiology and Biophysics, </institution><institution>Institute for Computational Biomedicine, Weill Cornell Medicine, </institution></institution-wrap>New York, NY USA </aff>
      <aff id="Aff9"><label>9</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/0130frc33</institution-id><institution-id institution-id-type="GRID">grid.10698.36</institution-id><institution-id institution-id-type="ISNI">0000 0001 2248 3208</institution-id><institution>Department of Biostatistics, </institution><institution>University of North Carolina, </institution></institution-wrap>Chapel Hill, NC USA </aff>
      <aff id="Aff10"><label>10</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/03xjacd83</institution-id><institution-id institution-id-type="GRID">grid.239578.2</institution-id><institution-id institution-id-type="ISNI">0000 0001 0675 4725</institution-id><institution>Department of Infection Biology, </institution><institution>Lerner Research Institute, Cleveland Clinic Foundation, </institution></institution-wrap>Cleveland, OH USA </aff>
      <aff id="Aff11"><label>11</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/03xjacd83</institution-id><institution-id institution-id-type="GRID">grid.239578.2</institution-id><institution-id institution-id-type="ISNI">0000 0001 0675 4725</institution-id><institution>Department of Cancer Biology, </institution><institution>Lerner Research Institute, Cleveland Clinic Foundation, </institution></institution-wrap>Cleveland, OH USA </aff>
      <aff id="Aff12"><label>12</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/00f54p054</institution-id><institution-id institution-id-type="GRID">grid.168010.e</institution-id><institution-id institution-id-type="ISNI">0000 0004 1936 8956</institution-id><institution>Department of Developmental Biology, </institution><institution>Stanford University, </institution></institution-wrap>Stanford, CA USA </aff>
      <aff id="Aff13"><label>13</label>Chapel Hill High School, Chapel Hill, NC USA </aff>
      <aff id="Aff14"><label>14</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/0464eyp60</institution-id><institution-id institution-id-type="GRID">grid.168645.8</institution-id><institution-id institution-id-type="ISNI">0000 0001 0742 0364</institution-id><institution>Program in Molecular Medicine, </institution><institution>University of Massachusetts Chan Medical School, </institution></institution-wrap>Worcester, MA USA </aff>
      <aff id="Aff15"><label>15</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/0168r3w48</institution-id><institution-id institution-id-type="GRID">grid.266100.3</institution-id><institution-id institution-id-type="ISNI">0000 0001 2107 4242</institution-id><institution>Center for Epigenomics &amp; Department of Cellular and Molecular Medicine, </institution><institution>University of California San Diego, </institution></institution-wrap>La Jolla, CA USA </aff>
      <aff id="Aff16"><label>16</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/0130frc33</institution-id><institution-id institution-id-type="GRID">grid.10698.36</institution-id><institution-id institution-id-type="ISNI">0000 0001 2248 3208</institution-id><institution>Department of Genetics, </institution><institution>University of North Carolina, </institution></institution-wrap>Chapel Hill, NC USA </aff>
      <aff id="Aff17"><label>17</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/0130frc33</institution-id><institution-id institution-id-type="GRID">grid.10698.36</institution-id><institution-id institution-id-type="ISNI">0000 0001 2248 3208</institution-id><institution>Department of Computer Science, </institution><institution>University of North Carolina, </institution></institution-wrap>Chapel Hill, NC USA </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>12</day>
      <month>8</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>12</day>
      <month>8</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2023</year>
    </pub-date>
    <volume>14</volume>
    <elocation-id>4873</elocation-id>
    <history>
      <date date-type="received">
        <day>11</day>
        <month>5</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>1</day>
        <month>8</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article’s Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article’s Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1">Multiplexed DNA fluorescence in situ hybridization (FISH) imaging technologies have been developed to map the folding of chromatin fibers at tens of nanometers and up to several kilobases in resolution in single cells. However, computational methods to reliably identify chromatin loops from such imaging datasets are still lacking. Here we present a Single-Nucleus Analysis Pipeline for multiplexed DNA FISH (SnapFISH), to process the multiplexed DNA FISH data and identify chromatin loops. SnapFISH can identify known chromatin loops from mouse embryonic stem cells with high sensitivity and accuracy. In addition, SnapFISH obtains comparable results of chromatin loops across datasets generated from diverse imaging technologies. SnapFISH is freely available at <ext-link ext-link-type="uri" xlink:href="https://github.com/HuMingLab/SnapFISH">https://github.com/HuMingLab/SnapFISH</ext-link>.</p>
    </abstract>
    <abstract id="Abs2" abstract-type="web-summary">
      <p id="Par2">Multiplexed DNA FISH technologies are powerful tools to reveal chromatin spatial organisation. Here, the authors developed SnapFISH, a computational pipeline to identify chromatin loops from multiplexed DNA FISH data.</p>
    </abstract>
    <kwd-group kwd-group-type="npg-subject">
      <title>Subject terms</title>
      <kwd>Software</kwd>
      <kwd>Statistical methods</kwd>
      <kwd>Bioinformatics</kwd>
      <kwd>Epigenomics</kwd>
      <kwd>Genetic techniques</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">https://doi.org/10.13039/100000002</institution-id>
            <institution>U.S. Department of Health &amp; Human Services | National Institutes of Health (NIH)</institution>
          </institution-wrap>
        </funding-source>
        <award-id>R35HG011922</award-id>
        <award-id>UM1HG011585</award-id>
        <award-id>U01DA052713</award-id>
        <award-id>R01HL163972</award-id>
        <award-id>U01HG011720</award-id>
        <award-id>U24AR076730</award-id>
        <principal-award-recipient>
          <name>
            <surname>Li</surname>
            <given-names>Yun</given-names>
          </name>
          <name>
            <surname>Hu</surname>
            <given-names>Ming</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>U.S. Department of Health &amp; Human Services | National Institutes of Health (NIH)</institution>
        </funding-source>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>U.S. Department of Health &amp; Human Services | National Institutes of Health (NIH)</institution>
        </funding-source>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>U.S. Department of Health &amp; Human Services | National Institutes of Health (NIH)</institution>
        </funding-source>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>U.S. Department of Health &amp; Human Services | National Institutes of Health (NIH)</institution>
        </funding-source>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>U.S. Department of Health &amp; Human Services | National Institutes of Health (NIH)</institution>
        </funding-source>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© Springer Nature Limited 2023</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1" sec-type="introduction">
    <title>Introduction</title>
    <p id="Par3">How chromatin folds inside the nucleus is a fundamental question in the study of genome structure and function<sup><xref ref-type="bibr" rid="CR1">1</xref></sup>. Disruption of chromatin organization can lead to gene dysregulation, and has been associated with a variety of human developmental disorders, neuropsychiatric diseases, and cancers<sup><xref ref-type="bibr" rid="CR2">2</xref></sup>. Different from proximity-ligation assays<sup><xref ref-type="bibr" rid="CR3">3</xref>,<xref ref-type="bibr" rid="CR4">4</xref></sup> that infer the 3D genome through <italic>indirect</italic> measurement of DNA sequence contacts, chromatin tracing, as an emerging microscopy-based technology, can visualize bright spots corresponding to individual targeted genomic segments arrayed along chromatin fibers, and map their physical location in three-dimensional space. This rich imaging data permits the <italic>direct</italic> measurement of Euclidean distances between targeted genomic segments of interest—such as promoters and distal <italic>cis</italic>-regulatory elements - allowing an intimate look into the organization of chromosomes<sup><xref ref-type="bibr" rid="CR5">5</xref></sup>. During the last decade, a number of chromatin tracing technologies have emerged, including multiplexed DNA fluorescence in situ hybridization (FISH)<sup><xref ref-type="bibr" rid="CR6">6</xref>,<xref ref-type="bibr" rid="CR7">7</xref></sup>, DNA-MERFISH<sup><xref ref-type="bibr" rid="CR8">8</xref></sup>, DNA seqFISH+<sup><xref ref-type="bibr" rid="CR9">9</xref>,<xref ref-type="bibr" rid="CR10">10</xref></sup>, ORCA<sup><xref ref-type="bibr" rid="CR11">11</xref></sup>, MINA<sup><xref ref-type="bibr" rid="CR12">12</xref></sup>, Hi-M<sup><xref ref-type="bibr" rid="CR13">13</xref></sup>, OligoFISSEQ<sup><xref ref-type="bibr" rid="CR14">14</xref></sup> and IGS<sup><xref ref-type="bibr" rid="CR15">15</xref></sup> (more details can be found in recent review articles<sup><xref ref-type="bibr" rid="CR5">5</xref>,<xref ref-type="bibr" rid="CR16">16</xref>,<xref ref-type="bibr" rid="CR17">17</xref></sup>). These techniques can resolve the spatial location of discrete targeted genomic segments with tens of nanometer precision in single cells. They have been used to image the entire mammalian genome at megabase (Mb) resolution<sup><xref ref-type="bibr" rid="CR9">9</xref>,<xref ref-type="bibr" rid="CR10">10</xref></sup>, one full chromosome at 50 kilobase (Kb) resolution<sup><xref ref-type="bibr" rid="CR8">8</xref></sup>, and a few selected regions at 2.5 Kb ~ 30 Kb resolution<sup><xref ref-type="bibr" rid="CR7">7</xref>–<xref ref-type="bibr" rid="CR11">11</xref>,<xref ref-type="bibr" rid="CR18">18</xref>,<xref ref-type="bibr" rid="CR19">19</xref></sup>, promising to uncover novel insights into chromatin folding and its role in gene regulation<sup><xref ref-type="bibr" rid="CR5">5</xref></sup>.</p>
    <p id="Par4">Chromatin loops are a key structural feature of chromatin spatial organization, and may serve as the structural basis of gene regulation. Originally discovered from bulk Hi-C data<sup><xref ref-type="bibr" rid="CR4">4</xref>,<xref ref-type="bibr" rid="CR20">20</xref></sup> as “dots” at the corners of topologically associating domains, and recently identified from single cell Hi-C data<sup><xref ref-type="bibr" rid="CR21">21</xref>,<xref ref-type="bibr" rid="CR22">22</xref></sup> and imaging data<sup><xref ref-type="bibr" rid="CR18">18</xref></sup>, chromatin loops are defined as pairs of genomic loci with closer spatial proximity compared to other pairs of loci in the local neighborhood region<sup><xref ref-type="bibr" rid="CR4">4</xref>,<xref ref-type="bibr" rid="CR20">20</xref></sup>. Chromatin loops between enhancers and promoters have been used to infer target genes for distal enhancers<sup><xref ref-type="bibr" rid="CR23">23</xref></sup>. Chromatin loops between CTCF binding sites are associated with the formation of topological associating domains<sup><xref ref-type="bibr" rid="CR24">24</xref></sup>, which are megabase sized chromatin domains constraining enhancer-promoter interactions. Extensive studies have demonstrated that chromatin loops play an essential role in maintaining the 3D structure of the genome and facilitating gene regulation<sup><xref ref-type="bibr" rid="CR25">25</xref>–<xref ref-type="bibr" rid="CR28">28</xref></sup>.</p>
    <p id="Par5">The functional importance of chromatin loops makes it important to develop loop callers tailored to different input experimental datasets (Supplementary Information Section <xref rid="MOESM1" ref-type="media">1</xref>). All existing loop callers are designed for genomic data generated from proximity-ligation assays, which utilize the <italic>count</italic>-based statistical framework to model chromatin contact frequency<sup><xref ref-type="bibr" rid="CR29">29</xref></sup>. As a result, these tools are inherently not directly applicable to imaging data, which allow the <italic>continuous</italic> measurement of Euclidean distances between targeted genomic segments of interest. To the best of our knowledge, no method is available to identify chromatin loops from such imaging data. In the wake of the rapid development of chromatin tracing technologies, tailored computational methods to reliably identify chromatin loops from imaging data have become more critical. Importantly, such loop analysis methods may advance our understanding of the relationships between genome structure and gene regulation.</p>
    <p id="Par6">In this work, to fill in the abovementioned methodological gap, we develop Single-Nucleus Analysis Pipeline for multiplexed DNA FISH data (SnapFISH), a computational pipeline to identify chromatin loops from multiplexed DNA FISH data. SnapFISH can identify known chromatin loops from mouse embryonic stem cells with high sensitivity and accuracy. In addition, SnapFISH can accommodate datasets generated from diverse imaging technologies.</p>
  </sec>
  <sec id="Sec2" sec-type="results">
    <title>Results</title>
    <sec id="Sec3">
      <title>SnapFISH algorithm</title>
      <p id="Par7">In the same spirit of our recently developed SnapHiC<sup><xref ref-type="bibr" rid="CR21">21</xref></sup> pipeline for single cell Hi-C data, SnapFISH also treats each imaged cell as an independent unit, to boost the statistical power of identifying chromatin loops. Specifically, SnapFISH takes multiplexed DNA FISH single bright spot localization data as input, and outputs the predicted chromosomal location of chromatin loops. Briefly, SnapFISH first collects the 3D localization coordinates of each genomic segment targeted by FISH (hereafter referred to as targeted segment) in each cell (Fig. <xref rid="Fig1" ref-type="fig">1A</xref>), and computes the pairwise Euclidean distances between all imaged targeted segments (Fig. <xref rid="Fig1" ref-type="fig">1B</xref>). SnapFISH then calculates the average Euclidean distance between two targeted segments with the 1D genomic distance of 25Kb (termed as avg.dist.1D.25Kb), and defines the population-level contact frequency between any two targeted segments as the fraction of cells with Euclidean distance smaller than avg.dist.1D.25Kb (Fig. <xref rid="Fig1" ref-type="fig">1C</xref>) (see details in a recent preprint<sup><xref ref-type="bibr" rid="CR30">30</xref></sup>). Next, for all pairs of targeted segments found within a 1D genomic distance range of 100 Kb ~ 1 Mb, SnapFISH compares the pairwise Euclidean distances between the pair of interest and its local neighborhood region (Supplementary Fig. <xref rid="MOESM1" ref-type="media">S1</xref>, see details in Methods) using a two-sample <italic>T</italic>-test (Fig. <xref rid="Fig1" ref-type="fig">1D</xref>). SnapFISH then converts the resulting P-values into false discovery rates (FDRs), and defines a pair of targeted segments as a loop candidate if the average Euclidean distance between the pair of interests is smaller than the average Euclidean distance in its local neighborhood region (i.e., <italic>T</italic>-test statistic &lt;0), and FDR is less than 10% (Fig. <xref rid="Fig1" ref-type="fig">1E</xref>, see details in Methods). Lastly, SnapFISH groups nearby loop candidates into clusters, identifies the pair with the lowest FDR within each cluster (hereafter referred to as the cluster summit), and uses both cluster summits and singletons (i.e., cluster with only one loop candidate) as the final list of chromatin loops (Fig. <xref rid="Fig1" ref-type="fig">1E</xref>, see details in Methods).<fig id="Fig1"><label>Fig. 1</label><caption><title>The flowchart of the SnapFISH algorithm.</title><p><bold>A</bold> The 3D coordinates for each targeted segment in cell 1, 2, …, <italic>K</italic>. Each matrix represents one cell. Each row is one targeted segment and <italic>X</italic>, <italic>Y</italic>, <italic>Z</italic> are the 3D coordinates. <bold>B</bold> Euclidean distance matrices. Again, each matrix is for one cell. The dashed purple block highlighted the pair of targeted segments of interest: between the targeted segment 2 and the targeted segment 4. <bold>C</bold> Population-level contact frequency matrix. Similar to <bold>B</bold>, the dashed purple block highlighted the pair of targeted segments of interest: between the targeted segment 2 and the targeted segment 4. dist.25 Kb: the average Euclidean distance between two targeted segments with the 1D genomic distance of 25 Kb. <bold>D</bold> Two-sample <italic>T</italic>-test comparing the Euclidean distance between the pair of targeted segments of interest and its local neighborhood control region. <bold>E</bold> Post-processing to identify loop candidates and loop summits. The cartoon represents the clustering of nearby loop candidates and the selection of loop summit (i.e., between the targeted segment 3 and the targeted segment 8), which is highlighted by the dashed yellow block (see detailed listed in Methods). Source data are provided as a Source Data file.</p></caption><graphic xlink:href="41467_2023_40658_Fig1_HTML" id="d32e721"/></fig></p>
    </sec>
    <sec id="Sec4">
      <title>Optimizing the SnapFISH algorithm using DNA seqFISH+ data in mESCs</title>
      <p id="Par8">In order to optimize the SnapFISH algorithm, we re-analyzed a publicly available DNA seqFISH+ dataset from mouse embryonic stem cells (mESCs)<sup><xref ref-type="bibr" rid="CR9">9</xref></sup>, where the authors selected one region from each chromosome, with region length ranging from 1.5 Mb ~ 2.35 Mb (Supplementary Table <xref rid="MOESM1" ref-type="media">S1</xref>), and performed DNA seqFISH+ experiment at 25 Kb bin resolution, in two biological replicates (see details in imaging data resource). We combined data across replicates, resulting in 446 cells (i.e., 892 alleles) in total. The average targeted segment detection efficiency, defined as the proportion of imaged targeted segments among all targeted segments, is 65.2%. As the reference loop set (serving as the working truth), we re-analyzed a deeply sequenced mESC bulk Hi-C data<sup><xref ref-type="bibr" rid="CR31">31</xref></sup>, and identified 35 loops with HiCCUPS at both 10 Kb and 25 Kb resolution in the corresponding genomic region where DNA seqFISH+ data is available (Supplementary Table <xref rid="MOESM1" ref-type="media">S2</xref>). We applied SnapFISH to call loops from DNA seqFISH+ data in mESCs, and calculated precision, recall and F1-score based on the reference HiCCUPS loops. Among all tested combinations of SnapFISH parameters, we selected the one corresponding to the highest F1-score, defined as the harmonic mean of the precision and recall (see details in Supplementary Information Section <xref rid="MOESM1" ref-type="media">2</xref> and Table <xref rid="MOESM1" ref-type="media">S3</xref>). With the optimized parameters, SnapFISH identified 16 loops (Supplementary Table <xref rid="MOESM1" ref-type="media">S4A</xref>), where 14 loops overlap HiCCUPS loops (Fig. <xref rid="Fig2" ref-type="fig">2A</xref> and Supplementary Fig. <xref rid="MOESM1" ref-type="media">S2A</xref><bold>~</bold>
<xref rid="MOESM1" ref-type="media">S2H</xref> and Fig. <xref rid="MOESM1" ref-type="media">S3</xref>). The precision, recall and F1-score are 87.5%, 40.0% and 0.549, respectively. Specifically, 9 SnapFISH loops overlap with 16 25Kb HiCCUPS loops (recall = 56.3%), and 5 SnapFISH loops overlap with 19 10 Kb HiCCUPS loops (recall = 26.3%). As we expected, SnapFISH loops identified from imaging data from 446 cells achieved lower sensitivity compared to HiCCUPS loops identified from deeply sequenced bulk Hi-C data, which usually contains ~10<sup>6</sup> cells<sup><xref ref-type="bibr" rid="CR31">31</xref></sup>. SnapFISH achieved higher sensitivity when imaging data and bulk Hi-C data are at the same 25 Kb resolution, and most false negatives are from the finer 10 Kb resolution. In addition, we evaluated how loop strength, measured by population-level contact frequency, affects the sensitivity of SnapFISH. Supplementary Fig. <xref rid="MOESM1" ref-type="media">S2I</xref> shows that the 14 true positives (HiCCUPS loops identified by SnapFISH) have significantly higher average population-level contact frequency (49.7%) than that (37.2%) in the 21 false negatives (HiCCUPS loops missed by SnapFISH) (two-sided two sample <italic>T</italic>-test <italic>P</italic> = 0.0014), suggesting that SnapFISH can achieve higher sensitivity for loops with higher strength.<fig id="Fig2"><label>Fig. 2</label><caption><title>SnapFISH identified chromatin loops with high accuracy.</title><p><bold>A</bold> SnapFISH identified a CTCF-CTCF loop in chromosome 2 from mESC DNA seqFISH+ data. The top three tracks are mESC CTCF, mESC H3K4me3 and mESC H3K27ac ChIP-seq data. The middle three tracks represent HiCCUPS-identified loops at 25 Kb bin resolution, HiCCUPS-identified loops at 10 Kb bin resolution, and SnapFISH-identified loops at 25 Kb bin resolution, respectively. The bottom track is the Refseq gene annotation. Both anchors (dashed red boxes) contain mESC CTCF ChIP-seq peaks. Source data are provided as a Source Data file. <bold>B</bold> SnapFISH identified the <italic>Sox2</italic> enhancer-promoter loop from mESC multiplexed DNA FISH data and mESC ORCA data. The top three tracks are mESC CTCF, mESC H3K4me3, and mESC H3K27ac ChIP-seq data. The middle four tracks represent the HiCCUPS-identified loop from mESC bulk Hi-C data<sup><xref ref-type="bibr" rid="CR31">31</xref></sup>, the SnapFISH-identified loop from 1,416 129 alleles and 1416 CAST alleles, and the SnapFISH-identified loop from mESC ORCA data, respectively. All these loops are at 5 Kb bin resolution. The bottom track is the Refseq gene annotation. The red dashed box on the left and the right represents the location of the promoter of the <italic>Sox2</italic> gene and its super-enhancer, respectively. We allow for a 5 Kb gap between loop anchors and the <italic>Sox2</italic> promoter or super-enhancer (see details in Methods). Source data are provided as a Source Data file. <bold>C</bold> SnapFISH identified an enhancer-promoter loop in chromosome 15 from DNA seqFISH+ data in mouse excitatory neurons. The top five tracks are ATAC-seq, H3K4me1, H3K4me3, H3K27ac and RNA-seq data from cortical excitatory neurons L2/3 collected from mouse frontal cortex tissue (FC_L2_3 for short)<sup><xref ref-type="bibr" rid="CR35">35</xref></sup>. The bottom two tracks are SnapFISH-identified 25 Kb bin resolution loops and the Refseq gene annotation. The left anchor (dashed red box on the left) is at gene <italic>Myc</italic>. The right anchor (dashed red box on the right) is at the transcription end site of gene <italic>Pvt1</italic>, which contains an ATAC peak. Source data are provided as a Source Data file.</p></caption><graphic xlink:href="41467_2023_40658_Fig2_HTML" id="d32e821"/></fig></p>
      <p id="Par9">As one illustrative example in chromosome 2, Fig. <xref rid="Fig2" ref-type="fig">2A</xref> shows that SnapFISH identified a CTCF-CTCF loop, which has also been detected by HiCCUPS from mESC bulk Hi-C data at 25 Kb resolution. The 3 false negatives are all 10 Kb HiCCUPS loops (Fig. <xref rid="Fig2" ref-type="fig">2A</xref>). In another illustrative example in chromosome 3, Supplementary Fig. <xref rid="MOESM1" ref-type="media">S3A</xref> shows that SnapFISH identified 6 loops, where 4 loops overlap with 4 HiCCUPS loops. Notably, the 2 false positives (i.e., not overlapping HiCCUPS loops) are the CTCF-CTCF loop and enhancer-promoter loop, respectively, and both overlap chromatin interactions identified from mESC H3K4me3 PLAC-seq data<sup><xref ref-type="bibr" rid="CR32">32</xref></sup>. Taken together, our results show that when applying to mESC DNA seqFISH+ data, SnapFISH can accurately and reliably identify loops that were previously identified from mESC bulk Hi-C data.</p>
    </sec>
    <sec id="Sec5">
      <title>Applying SnapFISH to multiplexed DNA FISH data and ORCA data in mESCs at the <italic>Sox2</italic> locus</title>
      <p id="Par10">Encouraged by the results from 25 Kb resolution mESC DNA seqFISH+ data, we then applied SnapFISH to the finer resolution (5 Kb) multiplexed DNA FISH data. Specifically, a multiplexed DNA FISH dataset has previously been generated from mESCs to investigate the chromatin conformation at the <italic>Sox2</italic> locus<sup><xref ref-type="bibr" rid="CR18">18</xref></sup> (such data is downloaded from the 4D Nucleome data portal, see details in imaging data resource). The 205 Kb chromosomal target region (mm10: chr3:34,601,078-34,806,078) imaged in the experiments spans both the promoter of the <italic>Sox2</italic> gene and its super-enhancer, which is located ~100 Kb downstream. Previous studies have identified a chromatin loop between the <italic>Sox2</italic> promoter and its super-enhancer via 5C<sup><xref ref-type="bibr" rid="CR33">33</xref></sup>, and validated the functional importance of such loop via the CRISPR experiment, which showed that deletion of the super-enhancer reduces &gt;90% of the <italic>Sox2</italic> expression<sup><xref ref-type="bibr" rid="CR34">34</xref></sup>. The mESCs used in the original study<sup><xref ref-type="bibr" rid="CR18">18</xref></sup> have two haplotypes: the CAST allele and the 129 allele. Distinct from the abovementioned mESC DNA seqFISH+ data where one cannot differentiate between the paternal and maternal alleles, the CAST allele contains a 7.5Kb insertion containing 4 CTCF-binding sites (hereafter referred to as 4CBS) between the <italic>Sox2</italic> promoter and its super-enhancer, while the 129 allele does not contain the insertion. The multiplexed DNA FISH experiments involved 41 probe sets, each corresponding to individual 5 Kb genomic target segments tiling the 205 Kb region of interest. In addition, there was one extra probe for the 7.5 Kb insertion on the CAST allele, which permits the differential identification of the CAST allele and the 129 allele in the same nucleus. A previous study<sup><xref ref-type="bibr" rid="CR18">18</xref></sup> showed that the CAST allele-specific 7.5 Kb 4CBS insertion resulted in weaker chromatin looping strength between the <italic>Sox2</italic> promoter and its super-enhancer.</p>
      <p id="Par11">We re-analyzed the multiplexed DNA FISH data (see details in Methods) from a total of 1416 cells (i.e., 1416 CAST alleles and 1416 129 alleles) using SnapFISH. The average targeted segment detection efficiency is 71.9% and 69.3% for the CAST allele and the 129 allele, respectively. We first computed the average Euclidean distances (Supplementary Fig. <xref rid="MOESM1" ref-type="media">S4A</xref>) and population-level contact frequency (Supplementary Fig. <xref rid="MOESM1" ref-type="media">S4B</xref>) between all pairs of 5 Kb genomic targeted segment in these experiments, and compared that with the 5 Kb bin resolution chromatin contact frequency in the mESC bulk Hi-C data<sup><xref ref-type="bibr" rid="CR18">18</xref></sup> in an allele-specific manner (Supplementary Fig. <xref rid="MOESM1" ref-type="media">S4C</xref>). As we expected, both average spatial distance and population-level contact frequency measured from multiplexed DNA FISH data are closely correlated with the Hi-C contact frequency. The Pearson correlation coefficient between Hi-C contact frequency and the inverse of average Euclidean distances is 0.812 and 0.805 for the CAST allele and the 129 allele, respectively. Consistently, the Pearson correlation coefficient between Hi-C contact frequency and population-level contact frequency measured from multiplexed DNA FISH data is 0.788 and 0.768 for the CAST allele and the 129 allele, respectively. Applying SnapFISH to 1,416 CAST alleles and 1,416 129 alleles identified 44 and 61 loop candidates, respectively (Supplementary Fig. <xref rid="MOESM1" ref-type="media">S4D</xref>). Finally, SnapFISH grouped neighboring loop candidates, and detected a single chromatin loop summit between the <italic>Sox2</italic> promoter and the super-enhancer in both CAST and 129 alleles (Fig. <xref rid="Fig2" ref-type="fig">2B</xref>). As a comparison, we applied HiCCUPS to identify 5Kb bin resolution chromatin loops from mESC bulk Hi-C data<sup><xref ref-type="bibr" rid="CR31">31</xref></sup>, and found that SnapFISH-identified loops are also near the HiCCUPS loop (Fig. <xref rid="Fig2" ref-type="fig">2B</xref>).</p>
      <p id="Par12">Next, we evaluated the sensitivity of SnapFISH using different numbers of input target alleles. Specifically, we ranked all 1416 CAST alleles by their targeted segment detection efficiency, and selected the top 1400, 1200, 1000, 800, 600, 400, 200, 100, and 50 CAST alleles as input for SnapFISH. We performed the same analysis with the 129 allele. Consistent with previous findings<sup><xref ref-type="bibr" rid="CR18">18</xref></sup> indicating that the strength of the <italic>Sox2</italic> enhancer-promoter loop is weaker in the CAST allele compared to that in the 129 allele, SnapFISH found fewer loop candidates among the CAST allele than that in the 129 allele (Supplementary Table <xref rid="MOESM1" ref-type="media">S5</xref>), due to the CAST-specific 4CBS insertion. However, despite these differences, we observed that SnapFISH can accurately identify the <italic>Sox2</italic> enhancer-promoter loop with as few as 200 CAST alleles (Supplementary Fig. <xref rid="MOESM1" ref-type="media">S5A</xref>) and 100 129 alleles (Supplementary Fig. <xref rid="MOESM1" ref-type="media">S5B</xref>). Our results suggest that SnapFISH achieves high sensitivity even with a small number of cells.</p>
      <p id="Par13">Since not all targeted segments can be detected in the multiplexed DNA FISH data, we further evaluated how targeted segment detection efficiency affects the sensitivity of SnapFISH. Specifically, we again ranked all 1416 CAST alleles by their targeted segment detection efficiency, and then equally divided them into three groups, where each group consisted of 472 CAST alleles. We stratified them as “high”, “median” and “low” targeted segment detection efficiency groups, with an average targeted segment detection efficiency of 85.4%, 73.2%, and 57.0%, respectively. We performed the same analysis for the 1416 129 alleles, and similarly created three 129 allele groups, with an average targeted segment detection efficiency of 82.6%, 70.4%, and 55.0%, respectively. We applied SnapFISH to each of the six groups and examined the identified loop candidates and loop summits. In the CAST alleles where the <italic>Sox2</italic> enhancer-promoter loop strength is weak due to the CAST-specific 4CBS insertion, SnapFISH can detect the loop in both “high” and “median” detection efficiency groups, but it reports 3 false positives in the “low” detection efficiency group (Supplementary Fig. <xref rid="MOESM1" ref-type="media">S5C</xref> and Table <xref rid="MOESM1" ref-type="media">S6</xref>). In contrast, in the 129 alleles, SnapFISH can detect the loop in all three detection efficiency groups without false positives (Supplementary Fig. <xref rid="MOESM1" ref-type="media">S5C</xref> and Table <xref rid="MOESM1" ref-type="media">S6</xref>). As expected, our results suggest that targeted segment detection efficiency can influence the sensitivity of detecting chromatin loops.</p>
      <p id="Par14">Additionally, we evaluated the performance of SnapFISH on an ORCA dataset<sup><xref ref-type="bibr" rid="CR11">11</xref></sup> generated at the same <italic>Sox2</italic> locus in mESCs (see details in imaging data resource). Specifically, Mateo et al. imaged the 170 Kb region around the <italic>Sox2</italic> gene (mm10: chr3:34,601,078-34,771,078) in mESCs, which consists of 34 5 Kb targeted segments. Across all 6007 imaged alleles, the average targeted segment detection efficiency is 56.9%. Consistent with the results in multiplexed DNA FISH data, SnapFISH identified the <italic>Sox2</italic> enhancer-promoter loop (Fig. <xref rid="Fig2" ref-type="fig">2B</xref>). Taken together, our data show that SnapFISH can accurately identify the <italic>Sox2</italic> enhancer-promoter loop, which had previously been identified by mESC bulk Hi-C data, from both multiplexed DNA FISH data and ORCA data.</p>
    </sec>
    <sec id="Sec6">
      <title>Applying SnapFISH to DNA seqFISH+ data in mouse excitatory neurons</title>
      <p id="Par15">We additionally re-analyzed another publicly available 25Kb resolution DNA seqFISH+ dataset from mouse cerebral cortex tissue<sup><xref ref-type="bibr" rid="CR10">10</xref></sup>. The dataset also included RNA seqFISH data simultaneously generated from the same cells<sup><xref ref-type="bibr" rid="CR10">10</xref></sup>, which can be used to group and annotate distinct cell clusters. We combined the three biological replicates of DNA seqFISH+ datasets to obtain a total of 2,762 cells (i.e., 5,24 alleles), with an average targeted segment detection efficiency of 40.9%. Due to the relatively low targeted segment detection efficiency, we only applied SnapFISH to the excitatory neurons<sup><xref ref-type="bibr" rid="CR10">10</xref></sup> consisting of 1,895 cells (i.e., 3790 alleles, with an average targeted segment detection efficiency of 43.1%), and identified 87 loops (Table <xref rid="MOESM1" ref-type="media">S4B</xref>).</p>
      <p id="Par16">To the best of our knowledge, there is no publicly available bulk Hi-C data or single cell Hi-C data generated from excitatory neurons in mouse cerebral cortex tissue. To evaluate the functional relevance of these SnapFISH identified loops, we used recently published Paired-Tag data<sup><xref ref-type="bibr" rid="CR35">35</xref></sup> to obtain transcriptomic data and epigenetic data from cortical excitatory neurons L2/3 collected from mouse frontal cortex tissue (FC_L2_3 for short), including active promoter mark H3K4me3, two active enhancer marks H3K27ac and H3K4me1, and the open chromatin region mark ATAC. Figure <xref rid="Fig2" ref-type="fig">2C</xref> shows an illustrative example of the enhancer-promoter loop in chromosome 15, where the loop connects the promoter of gene <italic>Myc</italic> and the transcription end site of gene <italic>Pvt1</italic>. Both loop anchors overlap H3K27ac peaks and ATAC-seq peaks. We obtained similar results when applying SnapFISH to three additional mouse brain cell types (Supplementary Information Section <xref rid="MOESM1" ref-type="media">3</xref> and Supplementary Fig. <xref rid="MOESM1" ref-type="media">S6</xref>). Taken together, our results suggest that SnapFISH is able to identify putative enhancer-promoter loops from DNA seqFISH+ data in mouse brain tissue sample.</p>
    </sec>
  </sec>
  <sec id="Sec7" sec-type="discussion">
    <title>Discussion</title>
    <p id="Par17">In this work, we report SnapFISH, the first computational pipeline to identify de novo chromatin loops from multiplexed DNA FISH data, without prior knowledge of potential loop anchor regions. We applied SnapFISH to multiplexed DNA FISH, ORCA and DNA seqFISH+ experiments in both mouse mESCs and mouse excitatory neurons, and benchmarked the performance of SnapFISH-identified chromatin loops using chromatin loops identified from bulk Hi-C data. We also showed the high reproducibility of SnapFISH between biological replicates (Supplementary Information Section <xref rid="MOESM1" ref-type="media">4</xref>, Supplementary Fig. <xref rid="MOESM1" ref-type="media">S7</xref>, and Tables <xref rid="MOESM1" ref-type="media">S7</xref>, <xref rid="MOESM1" ref-type="media">S8</xref>), and the robustness of SnapFISH against different levels of measurement errors in the multiplexed DNA FISH experiments (Supplementary Information Section <xref rid="MOESM1" ref-type="media">5</xref>, Supplementary Fig. <xref rid="MOESM1" ref-type="media">S8</xref> and Table <xref rid="MOESM1" ref-type="media">S9</xref>). Additionally, we provide the option of the non-parametric Wilcoxon test, as an alternative to the default two sample <italic>T</italic>-test (Supplementary Information Section <xref rid="MOESM1" ref-type="media">6</xref> and Figs. <xref rid="MOESM1" ref-type="media">S9</xref>, <xref rid="MOESM1" ref-type="media">S10</xref>). SnapFISH is computationally efficient, with the computing time increasing linearly with the number of cells (Supplementary Information Section <xref rid="MOESM1" ref-type="media">7</xref> and Fig. <xref rid="MOESM1" ref-type="media">S11</xref>).</p>
    <p id="Par18">Building upon these promising results, we envision at least four directions that warrant further investigation. First of all, the sensitivity of SnapFISH can be further improved, in particular when applying to DNA seqFISH+ data in mESCs. As we showed in the analysis of multiplexed DNA FISH data in mESCs (Supplementary Fig. <xref rid="MOESM1" ref-type="media">S5C</xref> and Table <xref rid="MOESM1" ref-type="media">S6</xref>), a low level of targeted segment detection efficiency can reduce the sensitivity of loop detection. We expect that imputing missing 3D coordinates and missing Euclidean distance between genomic loci of interest may increase the sample size for the two sample <italic>T</italic>-test used in the SnapFISH algorithm (Fig. <xref rid="Fig1" ref-type="fig">1D</xref>), and help to enhance the statistical power of loop detection.</p>
    <p id="Par19">Second, we only considered pair-wise chromatin interactions in this work. Multiplexed DNA FISH data provide rich information on multi-way chromatin interactions, making it feasible to detect events where one enhancer interacts with multiple target genes, or one gene’s promoter interacts with multiple enhancers simultaneously. We will extend our SnapFISH framework to identify multi-way chromatin interactions, and benchmark our findings with data generated from orthogonal technologies, including immunoGAM<sup><xref ref-type="bibr" rid="CR36">36</xref></sup> and scSPRITE<sup><xref ref-type="bibr" rid="CR37">37</xref></sup>.</p>
    <p id="Par20">In addition, encouraged by the success in the integrative modeling of 3D chromatin architecture datasets<sup><xref ref-type="bibr" rid="CR38">38</xref></sup>, method developers would benefit from simulators that generate realistic multiplexed DNA FISH data, allowing flexible allocations of true loops and random collisions, precise control of the distribution of loop strength, as well as cell-to-cell variability. However, limited publicly available real data may not yet allow us to comprehensively evaluate whether data produced by a simulator is sufficiently realistic. Future studies are warranted as more data becomes available.</p>
    <p id="Par21">Last but not least, other genomic data modalities, including transcriptome and epigenome, can be imaged together with DNA in the same cell<sup><xref ref-type="bibr" rid="CR9">9</xref>–<xref ref-type="bibr" rid="CR12">12</xref></sup>. Integrating chromatin loops identified from SnapFISH with other genomic data modalities at single cell resolution, and characterizing their cell-to-cell variability, have the potential to reveal novel mechanisms of transcriptional regulation.</p>
    <p id="Par22">In summary, we developed SnapFISH, the first computational pipeline to identify de novo chromatin loops from multiplexed DNA FISH data. As high-resolution multiplexed DNA FISH data are increasingly available, we consider SnapFISH a valuable tool for analyzing such data, facilitating a better understanding of genome structure and genome function.</p>
  </sec>
  <sec id="Sec8">
    <title>Methods</title>
    <sec id="Sec9">
      <title>Definition of local neighborhood regions</title>
      <p id="Par23">For both 5 Kb bin resolution multiplexed DNA FISH data in mESCs, 5 Kb bin resolution OCRA data in mESCs, and 25 Kb bin resolution DNA seqFISH+ data in mESCs and mouse excitatory neurons, we define the local neighborhood of a given targeted segment pair as all of the identified pairs that fall within a square with 25 Kb ~ 50 Kb in 1D genomic distance from the targeted segment pair of interest. Specifically, Supplementary Fig. <xref rid="MOESM1" ref-type="media">S1</xref> shows the definition of local neighborhood regions, which is similar to the definition that has been used in the HiCCUPS algorithm<sup><xref ref-type="bibr" rid="CR4">4</xref></sup>, and our recently developed SnapHiC algorithm<sup><xref ref-type="bibr" rid="CR21">21</xref></sup>. The union of blue areas consists of the “circle” region that defines the local neighborhood.</p>
    </sec>
    <sec id="Sec10">
      <title>Two sample <italic>T</italic>-test</title>
      <p id="Par24">For each given targeted segment pair in each cell, we calculated the average Euclidean distance among all targeted segment pairs in its local neighborhood regions, as used such average Euclidean distance as the control. Due to the missing data in multiplexed DNA FISH data, not all targeted segments are observed. Therefore, we applied two sample <italic>T</italic>-test, instead of paired <italic>T</italic>-test, to evaluate the statistical significance of the difference in Euclidean distance between a given targeted segment pair and its local neighborhood. In addition, SnapFISH provided the non-parametric Wilcoxon test, as an alternative to the default two sample <italic>T</italic>-test.</p>
    </sec>
    <sec id="Sec11">
      <title>Identification of loop candidates</title>
      <p id="Par25">We define a pair of segments as a loop candidate if and only its average Euclidean distance is smaller than that of the average Euclidean distance for segment pairs in the local neighborhood (T &lt; 0) and FDR &lt; 10% (Fig. <xref rid="Fig1" ref-type="fig">1E</xref>).</p>
    </sec>
    <sec id="Sec12">
      <title>Identification of loop summits</title>
      <p id="Par26">We group nearby loop candidates within a pre-specified gap into clusters, where the gap is twice the size of the bin resolution. In other words, we define the gap to be 10 Kb for 5 Kb resolution multiplexed DNA FISH data and 5 Kb resolution OCRA data, and 50 Kb for 25 Kb resolution DNA seqFISH+ data. Among each cluster, we select the pair of targeted segments with the minimal FDR as the summit. The final loop list consists of cluster summits with population-level contact frequency &gt;=1/3, and singletons with population-level contact frequency &gt;=1/2. Detailed justification of threshold values can be found in Supplementary Information Section <xref rid="MOESM1" ref-type="media">1</xref>.</p>
    </sec>
    <sec id="Sec13">
      <title>Overlap of SnapFISH-identified loop with <italic>Sox2</italic> enhancer-promoter loop</title>
      <p id="Par27">We defined chr3:34,645,000–34,655,000 and chr3:34,755,000–34,765,000 as the two 10 Kb bins containing <italic>Sox2</italic> promoter and super-enhancer, respectively. We further defined a SnapFISH-identified 5 Kb bin resolution loop as “overlapped” with the <italic>Sox2</italic> enhancer-promoter, if and only if the SnapFISH loop anchors are within 10 Kb of <italic>Sox2</italic> promoter-super-enhancer loop anchors.</p>
    </sec>
    <sec id="Sec14">
      <title>Statistics and reproducibility</title>
      <p id="Par28">In this study, we re-analyzed the publicly available datasets (see details in the “Data Availability” section below). No statistical method was used to predetermine sample size. No data were excluded from the analyses. The experiments were not randomized. The investigators were not blinded to allocating during experiments and outcome assessment. In addition, we evaluated the reproducibility of SnapFISH among biological replicates (see details in Supplementary Information Section <xref rid="MOESM1" ref-type="media">4</xref>).</p>
    </sec>
    <sec id="Sec15">
      <title>Reporting summary</title>
      <p id="Par29">Further information on research design is available in the <xref rid="MOESM6" ref-type="media">Nature Portfolio Reporting Summary</xref> linked to this article.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <sec id="Sec16">
      <title>Supplementary information</title>
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="41467_2023_40658_MOESM1_ESM.pdf">
            <caption>
              <p>Supplementary Information</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="41467_2023_40658_MOESM2_ESM.pdf">
            <caption>
              <p>Peer Review File</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM3">
          <media xlink:href="41467_2023_40658_MOESM3_ESM.pdf">
            <caption>
              <p>Description of Additional Supplementary Files</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM4">
          <media xlink:href="41467_2023_40658_MOESM4_ESM.csv">
            <caption>
              <p>Supplementary Dataset 1</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM5">
          <media xlink:href="41467_2023_40658_MOESM5_ESM.xlsx">
            <caption>
              <p>Supplementary Dataset 2</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM6">
          <media xlink:href="41467_2023_40658_MOESM6_ESM.pdf">
            <caption>
              <p>Reporting Summary</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
    <sec id="Sec17">
      <title>Source data</title>
      <p>
        <supplementary-material content-type="local-data" id="MOESM7">
          <media xlink:href="41467_2023_40658_MOESM7_ESM.zip">
            <caption>
              <p>Source Data</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p><bold>Publisher’s note</bold> Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <sec>
    <title>Supplementary information</title>
    <p>The online version contains supplementary material available at 10.1038/s41467-023-40658-3.</p>
  </sec>
  <ack>
    <title>Acknowledgements</title>
    <p>We thank 4D Nucleome consortium investigators for their comments and suggestions on the early version of this work. This study was funded by the NIH grants R35HG011922 (to M.H.) and U01DA052713 (to Y.L.). M.H. was also partially funded by the NIH grant UM1HG011585. Y.L. was also partially funded by the NIH grants R01MH125236, R01HL163972, U01HG011720, and U24AR076730.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author contributions</title>
    <p>L.L. and H.Y. implemented the SnapFISH software. Y.L. and M.H. supervised the project. B.J., A.J., C.Z., J.C., and A.H. analyzed the data. L.X., S.M., D.W., C.S., A.B., and B.R. evaluated the method. L.L., Y.L., and M.H. wrote the manuscript with input from all the authors. All authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="peer-review">
    <title>Peer review</title>
    <sec id="FPar1">
      <title>Peer review information</title>
      <p id="Par30"><italic>Nature Communications</italic> thanks the anonymous reviewer(s) for their contribution to the peer review of this work. A peer review file is available.</p>
    </sec>
  </notes>
  <notes notes-type="data-availability">
    <title>Data availability</title>
    <p>All relevant data supporting the key findings of this study are available within the article and its Supplementary Information files. Imaging data resource. 25 Kb bin resolution DNA seqFISH+ data from mESC. We downloaded DNA seqFISH+ data from the website <ext-link ext-link-type="uri" xlink:href="https://zenodo.org/record/3735329">https://zenodo.org/record/3735329</ext-link>, and used two files (DNAseqFISH+25kbloci-E14-replicate1.csv and DNAseqFISH+25kbloci-E14-replicate2.csv). Such data are originally used in the Takei et al. study<sup><xref ref-type="bibr" rid="CR9">9</xref></sup>. 5 Kb bin resolution multiplexed DNA FISH data from mESC at the <italic>Sox2</italic> gene locus. We downloaded multiplexed DNA FISH data from the 4D Nucleome data portal (<ext-link ext-link-type="uri" xlink:href="https://data.4dnucleome.org/experiment-set-replicates/4DNESC5PKTQ9/">https://data.4dnucleome.org/experiment-set-replicates/4DNESC5PKTQ9/</ext-link>), which were originally used in the Huang et al. study<sup><xref ref-type="bibr" rid="CR18">18</xref></sup>. 5 Kb bin resolution ORCA data from mESC at the <italic>Sox2</italic> locus. ORCA data are shared by Dr. Boettiger, which were originally used in the Mateo et al. study<sup><xref ref-type="bibr" rid="CR11">11</xref></sup>. We shared ORCA data as the file “Supplementary Dataset 1.csv” in this paper. 25 Kb bin resolution DNA seqFISH+ data from mouse cerebral cortex tissue. We downloaded DNA seqFISH+ data from the website <ext-link ext-link-type="uri" xlink:href="https://zenodo.org/record/4708112">https://zenodo.org/record/4708112</ext-link>, and used the file (TableS8_brain_DNAseqFISH_25kb_voxel_coordinates_2762cells.csv). Such data are originally used in the Takei et al. study<sup><xref ref-type="bibr" rid="CR10">10</xref></sup>. 2. mESC ChIP-seq data resource mESC H3K4me3 ChIP-seq data is from our previous study<sup><xref ref-type="bibr" rid="CR32">32</xref></sup>. mESC H3K27ac ChIP-seq data is downloaded from the ENCODE website: <ext-link ext-link-type="uri" xlink:href="https://www.encodeproject.org/experiments/ENCSR000CGQ/">https://www.encodeproject.org/experiments/ENCSR000CGQ/</ext-link>. mESC CTCF ChIP-seq data is downloaded from the ENCODE website: <ext-link ext-link-type="uri" xlink:href="https://www.encodeproject.org/experiments/ENCSR000CCB/">https://www.encodeproject.org/experiments/ENCSR000CCB/</ext-link>. Reference genomes We used mm10 for imaging data generated from mESCs and mouse excitatory neurons. <xref ref-type="sec" rid="Sec17">Source data</xref> are provided with this paper.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Code availability</title>
    <p>SnapFISH is freely available at <ext-link ext-link-type="uri" xlink:href="https://github.com/HuMingLab/SnapFISH">https://github.com/HuMingLab/SnapFISH</ext-link>. SnapFISH source code<sup><xref ref-type="bibr" rid="CR39">39</xref></sup> is available at <ext-link ext-link-type="uri" xlink:href="https://zenodo.org/record/8083569">https://zenodo.org/record/8083569</ext-link>.</p>
  </notes>
  <notes id="FPar2" notes-type="COI-statement">
    <title>Competing interests</title>
    <p id="Par31">B.R. is a cofounder and shareholder of Arima Genomics, Inc. and Epigenome Technologies, Inc. The remaining authors declare no competing interest.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schmitt</surname>
            <given-names>AD</given-names>
          </name>
          <name>
            <surname>Hu</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Ren</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Genome-wide mapping and analysis of chromosome architecture</article-title>
        <source>Nat. Rev. Mol. Cell Biol.</source>
        <year>2016</year>
        <volume>17</volume>
        <fpage>743</fpage>
        <lpage>755</lpage>
        <pub-id pub-id-type="doi">10.1038/nrm.2016.104</pub-id>
        <?supplied-pmid 27580841?>
        <pub-id pub-id-type="pmid">27580841</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Krijger</surname>
            <given-names>PH</given-names>
          </name>
          <name>
            <surname>de Laat</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>Regulation of disease-associated gene expression in the 3D genome</article-title>
        <source>Nat. Rev. Mol. Cell Biol.</source>
        <year>2016</year>
        <volume>17</volume>
        <fpage>771</fpage>
        <lpage>782</lpage>
        <pub-id pub-id-type="doi">10.1038/nrm.2016.138</pub-id>
        <?supplied-pmid 27826147?>
        <pub-id pub-id-type="pmid">27826147</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lieberman-Aiden</surname>
            <given-names>E</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Comprehensive mapping of long-range interactions reveals folding principles of the human genome</article-title>
        <source>Science</source>
        <year>2009</year>
        <volume>326</volume>
        <fpage>289</fpage>
        <lpage>293</lpage>
        <pub-id pub-id-type="doi">10.1126/science.1181369</pub-id>
        <?supplied-pmid 19815776?>
        <pub-id pub-id-type="pmid">19815776</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rao</surname>
            <given-names>SuhasSP</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A 3D map of the human genome at kilobase resolution reveals principles of chromatin looping</article-title>
        <source>Cell</source>
        <year>2014</year>
        <volume>159</volume>
        <fpage>1665</fpage>
        <lpage>1680</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2014.11.021</pub-id>
        <?supplied-pmid 25497547?>
        <pub-id pub-id-type="pmid">25497547</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <mixed-citation publication-type="other">Hafner, A. &amp; Boettiger, A. The spatial organization of transcriptional control. <italic>Nat. Rev. Genet</italic>10.1038/s41576-022-00526-0 (2022).</mixed-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Spatial organization of chromatin domains and compartments in single chromosomes</article-title>
        <source>Science</source>
        <year>2016</year>
        <volume>353</volume>
        <fpage>598</fpage>
        <lpage>602</lpage>
        <pub-id pub-id-type="doi">10.1126/science.aaf8084</pub-id>
        <?supplied-pmid 27445307?>
        <pub-id pub-id-type="pmid">27445307</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bintu</surname>
            <given-names>B</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Super-resolution chromatin tracing reveals domains and cooperative interactions in single cells</article-title>
        <source>Science</source>
        <year>2018</year>
        <volume>362</volume>
        <fpage>eaau1783</fpage>
        <pub-id pub-id-type="doi">10.1126/science.aau1783</pub-id>
        <?supplied-pmid 30361340?>
        <pub-id pub-id-type="pmid">30361340</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Su</surname>
            <given-names>JH</given-names>
          </name>
          <name>
            <surname>Zheng</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Kinrot</surname>
            <given-names>SS</given-names>
          </name>
          <name>
            <surname>Bintu</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Zhuang</surname>
            <given-names>X</given-names>
          </name>
        </person-group>
        <article-title>Genome-scale imaging of the 3D organization and transcriptional activity of chromatin</article-title>
        <source>Cell</source>
        <year>2020</year>
        <volume>182</volume>
        <fpage>1641</fpage>
        <lpage>1659.e1626</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2020.07.032</pub-id>
        <?supplied-pmid 32822575?>
        <pub-id pub-id-type="pmid">32822575</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Takei</surname>
            <given-names>Y</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Integrated spatial genomics reveals global architecture of single nuclei</article-title>
        <source>Nature</source>
        <year>2021</year>
        <volume>590</volume>
        <fpage>344</fpage>
        <lpage>350</lpage>
        <pub-id pub-id-type="doi">10.1038/s41586-020-03126-2</pub-id>
        <?supplied-pmid 33505024?>
        <pub-id pub-id-type="pmid">33505024</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Takei</surname>
            <given-names>Y</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell nuclear architecture across cell types in the mouse brain</article-title>
        <source>Science</source>
        <year>2021</year>
        <volume>374</volume>
        <fpage>586</fpage>
        <lpage>594</lpage>
        <pub-id pub-id-type="doi">10.1126/science.abj1966</pub-id>
        <?supplied-pmid 34591592?>
        <pub-id pub-id-type="pmid">34591592</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mateo</surname>
            <given-names>LJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Visualizing DNA folding and RNA in embryos at single-cell resolution</article-title>
        <source>Nature</source>
        <year>2019</year>
        <volume>568</volume>
        <fpage>49</fpage>
        <lpage>54</lpage>
        <pub-id pub-id-type="doi">10.1038/s41586-019-1035-4</pub-id>
        <?supplied-pmid 30886393?>
        <pub-id pub-id-type="pmid">30886393</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Multiplexed imaging of nucleome architectures in single cells of mammalian tissue</article-title>
        <source>Nat. Commun.</source>
        <year>2020</year>
        <volume>11</volume>
        <fpage>2907</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-020-16732-5</pub-id>
        <?supplied-pmid 32518300?>
        <pub-id pub-id-type="pmid">32518300</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cardozo Gizzi</surname>
            <given-names>AM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Microscopy-based chromosome conformation capture enables simultaneous visualization of genome organization and transcription in intact organisms</article-title>
        <source>Mol. Cell</source>
        <year>2019</year>
        <volume>74</volume>
        <fpage>212</fpage>
        <lpage>222.e215</lpage>
        <pub-id pub-id-type="doi">10.1016/j.molcel.2019.01.011</pub-id>
        <?supplied-pmid 30795893?>
        <pub-id pub-id-type="pmid">30795893</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nguyen</surname>
            <given-names>HQ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>3D mapping and accelerated super-resolution imaging of the human genome using in situ sequencing</article-title>
        <source>Nat. Methods</source>
        <year>2020</year>
        <volume>17</volume>
        <fpage>822</fpage>
        <lpage>832</lpage>
        <pub-id pub-id-type="doi">10.1038/s41592-020-0890-0</pub-id>
        <?supplied-pmid 32719531?>
        <pub-id pub-id-type="pmid">32719531</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Payne</surname>
            <given-names>AC</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>In situ genome sequencing resolves DNA sequence and structure in intact biological samples</article-title>
        <source>Science</source>
        <year>2021</year>
        <volume>371</volume>
        <fpage>eaay3446</fpage>
        <pub-id pub-id-type="doi">10.1126/science.aay3446</pub-id>
        <?supplied-pmid 33384301?>
        <pub-id pub-id-type="pmid">33384301</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhuang</surname>
            <given-names>X</given-names>
          </name>
        </person-group>
        <article-title>Spatially resolved single-cell genomics and transcriptomics by imaging</article-title>
        <source>Nat. Methods</source>
        <year>2021</year>
        <volume>18</volume>
        <fpage>18</fpage>
        <lpage>22</lpage>
        <pub-id pub-id-type="doi">10.1038/s41592-020-01037-8</pub-id>
        <?supplied-pmid 33408406?>
        <pub-id pub-id-type="pmid">33408406</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hu</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Chromatin tracing: imaging 3D genome and nucleome</article-title>
        <source>Trends Cell Biol.</source>
        <year>2021</year>
        <volume>31</volume>
        <fpage>5</fpage>
        <lpage>8</lpage>
        <pub-id pub-id-type="doi">10.1016/j.tcb.2020.10.006</pub-id>
        <?supplied-pmid 33191055?>
        <pub-id pub-id-type="pmid">33191055</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huang</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>CTCF mediates dosage- and sequence-context-dependent transcriptional insulation by forming local chromatin domains</article-title>
        <source>Nat. Genet</source>
        <year>2021</year>
        <volume>53</volume>
        <fpage>1064</fpage>
        <lpage>1074</lpage>
        <pub-id pub-id-type="doi">10.1038/s41588-021-00863-6</pub-id>
        <?supplied-pmid 34002095?>
        <pub-id pub-id-type="pmid">34002095</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cheng</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Hu</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>TAD-like single-cell domain structures exist on both active and inactive X chromosomes and persist under epigenetic perturbations</article-title>
        <source>Genome Biol.</source>
        <year>2021</year>
        <volume>22</volume>
        <fpage>309</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-021-02523-8</pub-id>
        <?supplied-pmid 34749781?>
        <pub-id pub-id-type="pmid">34749781</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>W</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Understanding regulatory mechanisms of brain function and disease through 3D genome organization</article-title>
        <source>Genes</source>
        <year>2022</year>
        <volume>13</volume>
        <fpage>586</fpage>
        <pub-id pub-id-type="doi">10.3390/genes13040586</pub-id>
        <?supplied-pmid 35456393?>
        <pub-id pub-id-type="pmid">35456393</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yu</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>SnapHiC: a computational pipeline to identify chromatin loops from single-cell Hi-C data</article-title>
        <source>Nat. Methods</source>
        <year>2021</year>
        <volume>18</volume>
        <fpage>1056</fpage>
        <lpage>1059</lpage>
        <pub-id pub-id-type="doi">10.1038/s41592-021-01231-2</pub-id>
        <?supplied-pmid 34446921?>
        <pub-id pub-id-type="pmid">34446921</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <mixed-citation publication-type="other">Yu, M., Li, Y. &amp; Hu, M. Mapping chromatin loops in single cells. <italic>Trends Genet</italic>10.1016/j.tig.2022.03.007 (2022).</mixed-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <mixed-citation publication-type="other">Fulco, C. P. et al. Activity-by-Contact model of enhancer specificity from thousands of CRISPR perturbations. 529990 10.1101/529990 (2019).</mixed-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dixon</surname>
            <given-names>JR</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Topological domains in mammalian genomes identified by analysis of chromatin interactions</article-title>
        <source>Nature</source>
        <year>2012</year>
        <volume>485</volume>
        <fpage>376</fpage>
        <lpage>380</lpage>
        <pub-id pub-id-type="doi">10.1038/nature11082</pub-id>
        <?supplied-pmid 22495300?>
        <pub-id pub-id-type="pmid">22495300</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Hu</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Shen</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>Gene regulation in the 3D genome</article-title>
        <source>Hum. Mol. Genet</source>
        <year>2018</year>
        <volume>27</volume>
        <fpage>R228</fpage>
        <lpage>R233</lpage>
        <pub-id pub-id-type="doi">10.1093/hmg/ddy164</pub-id>
        <?supplied-pmid 29767704?>
        <pub-id pub-id-type="pmid">29767704</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zheng</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Xie</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>The role of 3D genome organization in development and cell differentiation</article-title>
        <source>Nat. Rev. Mol. Cell Biol.</source>
        <year>2019</year>
        <volume>20</volume>
        <fpage>535</fpage>
        <lpage>550</lpage>
        <pub-id pub-id-type="doi">10.1038/s41580-019-0132-4</pub-id>
        <?supplied-pmid 31197269?>
        <pub-id pub-id-type="pmid">31197269</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mirny</surname>
            <given-names>LA</given-names>
          </name>
          <name>
            <surname>Solovei</surname>
            <given-names>I</given-names>
          </name>
        </person-group>
        <article-title>Keeping chromatin in the loop(s)</article-title>
        <source>Nat. Rev. Mol. Cell Biol.</source>
        <year>2021</year>
        <volume>22</volume>
        <fpage>439</fpage>
        <lpage>440</lpage>
        <pub-id pub-id-type="doi">10.1038/s41580-021-00337-x</pub-id>
        <?supplied-pmid 33504981?>
        <pub-id pub-id-type="pmid">33504981</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bonev</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Cavalli</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Organization and function of the 3D genome</article-title>
        <source>Nat. Rev. Genet</source>
        <year>2016</year>
        <volume>17</volume>
        <fpage>661</fpage>
        <lpage>678</lpage>
        <pub-id pub-id-type="doi">10.1038/nrg.2016.112</pub-id>
        <?supplied-pmid 27739532?>
        <pub-id pub-id-type="pmid">27739532</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Forcato</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Comparison of computational methods for Hi-C data analysis</article-title>
        <source>Nat. Methods</source>
        <year>2017</year>
        <volume>14</volume>
        <fpage>679</fpage>
        <lpage>685</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.4325</pub-id>
        <?supplied-pmid 28604721?>
        <pub-id pub-id-type="pmid">28604721</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <mixed-citation publication-type="other">Hafner, A., Park, M., Berger, S. E., Nora, E. P. &amp; Boettiger, A. N. Loop stacking organizes genome folding from TADs to chromosomes. <italic>bioRxiv</italic>, 10.1101/2022.07.13.499982 (2022).</mixed-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bonev</surname>
            <given-names>B</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Multiscale 3D genome rewiring during mouse neural development</article-title>
        <source>Cell</source>
        <year>2017</year>
        <volume>171</volume>
        <fpage>557</fpage>
        <lpage>572.e524</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2017.09.043</pub-id>
        <?supplied-pmid 29053968?>
        <pub-id pub-id-type="pmid">29053968</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Juric</surname>
            <given-names>I</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>MAPS: model-based analysis of long-range chromatin interactions from PLAC-seq and HiChIP experiments</article-title>
        <source>PLoS Comput. Biol.</source>
        <year>2019</year>
        <volume>15</volume>
        <fpage>e1006982</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1006982</pub-id>
        <?supplied-pmid 30986246?>
        <pub-id pub-id-type="pmid">30986246</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Phillips-Cremins</surname>
            <given-names>JE</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Architectural protein subclasses shape 3D organization of genomes during lineage commitment</article-title>
        <source>Cell</source>
        <year>2013</year>
        <volume>153</volume>
        <fpage>1281</fpage>
        <lpage>1295</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2013.04.053</pub-id>
        <?supplied-pmid 23706625?>
        <pub-id pub-id-type="pmid">23706625</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>Y</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>CRISPR reveals a distal super-enhancer required for Sox2 expression in mouse embryonic stem cells</article-title>
        <source>PloS One</source>
        <year>2014</year>
        <volume>9</volume>
        <fpage>e114485</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0114485</pub-id>
        <?supplied-pmid 25486255?>
        <pub-id pub-id-type="pmid">25486255</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhu</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Joint profiling of histone modifications and transcriptome in single cells from mouse brain</article-title>
        <source>Nat. Methods</source>
        <year>2021</year>
        <volume>18</volume>
        <fpage>283</fpage>
        <lpage>292</lpage>
        <pub-id pub-id-type="doi">10.1038/s41592-021-01060-3</pub-id>
        <?supplied-pmid 33589836?>
        <pub-id pub-id-type="pmid">33589836</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Winick-Ng</surname>
            <given-names>W</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Cell-type specialization is encoded by specific chromatin topologies</article-title>
        <source>Nature</source>
        <year>2021</year>
        <volume>599</volume>
        <fpage>684</fpage>
        <lpage>691</lpage>
        <pub-id pub-id-type="doi">10.1038/s41586-021-04081-2</pub-id>
        <?supplied-pmid 34789882?>
        <pub-id pub-id-type="pmid">34789882</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Arrastia</surname>
            <given-names>MV</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell measurement of higher-order 3D genome organization with scSPRITE</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2022</year>
        <volume>40</volume>
        <fpage>64</fpage>
        <lpage>73</lpage>
        <pub-id pub-id-type="doi">10.1038/s41587-021-00998-1</pub-id>
        <?supplied-pmid 34426703?>
        <pub-id pub-id-type="pmid">34426703</pub-id>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Boninsegna</surname>
            <given-names>L</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Integrative genome modeling platform reveals essentiality of rare contact events in 3D genome organizations</article-title>
        <source>Nat. Methods</source>
        <year>2022</year>
        <volume>19</volume>
        <fpage>938</fpage>
        <lpage>949</lpage>
        <pub-id pub-id-type="doi">10.1038/s41592-022-01527-x</pub-id>
        <?supplied-pmid 35817938?>
        <pub-id pub-id-type="pmid">35817938</pub-id>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <mixed-citation publication-type="other">Lee, L. SnapFISH: a computational pipeline to identify chromatin loops from multiplexed DNA FISH data. 10.5281/zenodo.8083569 (2023).</mixed-citation>
    </ref>
  </ref-list>
</back>
<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Nat Commun</journal-id>
    <journal-id journal-id-type="iso-abbrev">Nat Commun</journal-id>
    <journal-title-group>
      <journal-title>Nature Communications</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2041-1723</issn>
    <publisher>
      <publisher-name>Nature Publishing Group UK</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10423204</article-id>
    <article-id pub-id-type="pmid">37573342</article-id>
    <article-id pub-id-type="publisher-id">40658</article-id>
    <article-id pub-id-type="doi">10.1038/s41467-023-40658-3</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>SnapFISH: a computational pipeline to identify chromatin loops from multiplexed DNA FISH data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Lee</surname>
          <given-names>Lindsay</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Yu</surname>
          <given-names>Hongyu</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Jia</surname>
          <given-names>Bojing Blair</given-names>
        </name>
        <xref ref-type="aff" rid="Aff4">4</xref>
        <xref ref-type="aff" rid="Aff5">5</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Jussila</surname>
          <given-names>Adam</given-names>
        </name>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-4216-6562</contrib-id>
        <name>
          <surname>Zhu</surname>
          <given-names>Chenxu</given-names>
        </name>
        <xref ref-type="aff" rid="Aff6">6</xref>
        <xref ref-type="aff" rid="Aff7">7</xref>
        <xref ref-type="aff" rid="Aff8">8</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Chen</surname>
          <given-names>Jiawen</given-names>
        </name>
        <xref ref-type="aff" rid="Aff9">9</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Xie</surname>
          <given-names>Liangqi</given-names>
        </name>
        <xref ref-type="aff" rid="Aff10">10</xref>
        <xref ref-type="aff" rid="Aff11">11</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Hafner</surname>
          <given-names>Antonina</given-names>
        </name>
        <xref ref-type="aff" rid="Aff12">12</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Mishra</surname>
          <given-names>Shreya</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wang</surname>
          <given-names>Duan Dennis</given-names>
        </name>
        <xref ref-type="aff" rid="Aff13">13</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-1069-1816</contrib-id>
        <name>
          <surname>Strambio-De-Castillia</surname>
          <given-names>Caterina</given-names>
        </name>
        <xref ref-type="aff" rid="Aff14">14</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Boettiger</surname>
          <given-names>Alistair</given-names>
        </name>
        <xref ref-type="aff" rid="Aff12">12</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ren</surname>
          <given-names>Bing</given-names>
        </name>
        <xref ref-type="aff" rid="Aff6">6</xref>
        <xref ref-type="aff" rid="Aff15">15</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-9275-4189</contrib-id>
        <name>
          <surname>Li</surname>
          <given-names>Yun</given-names>
        </name>
        <address>
          <email>yunli@med.unc.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff9">9</xref>
        <xref ref-type="aff" rid="Aff16">16</xref>
        <xref ref-type="aff" rid="Aff17">17</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-0987-2916</contrib-id>
        <name>
          <surname>Hu</surname>
          <given-names>Ming</given-names>
        </name>
        <address>
          <email>hum@ccf.org</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/03xjacd83</institution-id><institution-id institution-id-type="GRID">grid.239578.2</institution-id><institution-id institution-id-type="ISNI">0000 0001 0675 4725</institution-id><institution>Department of Quantitative Health Sciences, Lerner Research Institute, </institution><institution>Cleveland Clinic Foundation, </institution></institution-wrap>Cleveland, OH USA </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/01y2jtd41</institution-id><institution-id institution-id-type="GRID">grid.14003.36</institution-id><institution-id institution-id-type="ISNI">0000 0001 2167 3675</institution-id><institution>Department of Statistics, </institution><institution>University of Wisconsin Madison, </institution></institution-wrap>Madison, WI USA </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/01y2jtd41</institution-id><institution-id institution-id-type="GRID">grid.14003.36</institution-id><institution-id institution-id-type="ISNI">0000 0001 2167 3675</institution-id><institution>Department of Biochemistry, </institution><institution>University of Wisconsin Madison, </institution></institution-wrap>Madison, WI USA </aff>
      <aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/0168r3w48</institution-id><institution-id institution-id-type="GRID">grid.266100.3</institution-id><institution-id institution-id-type="ISNI">0000 0001 2107 4242</institution-id><institution>Bioinformatics and Systems Biology Graduate Program, </institution><institution>University of California San Diego, </institution></institution-wrap>La Jolla, CA USA </aff>
      <aff id="Aff5"><label>5</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/0168r3w48</institution-id><institution-id institution-id-type="GRID">grid.266100.3</institution-id><institution-id institution-id-type="ISNI">0000 0001 2107 4242</institution-id><institution>Medical Scientist Training Program, </institution><institution>University of California San Diego, </institution></institution-wrap>La Jolla, CA USA </aff>
      <aff id="Aff6"><label>6</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/05qdwtz81</institution-id><institution-id institution-id-type="GRID">grid.1052.6</institution-id><institution-id institution-id-type="ISNI">0000 0000 9737 1625</institution-id><institution>Ludwig Institute for Cancer Research, </institution></institution-wrap>La Jolla, CA USA </aff>
      <aff id="Aff7"><label>7</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/05wf2ga96</institution-id><institution-id institution-id-type="GRID">grid.429884.b</institution-id><institution-id institution-id-type="ISNI">0000 0004 1791 0895</institution-id><institution>New York Genome Center, </institution></institution-wrap>New York, NY USA </aff>
      <aff id="Aff8"><label>8</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/02r109517</institution-id><institution-id institution-id-type="GRID">grid.471410.7</institution-id><institution-id institution-id-type="ISNI">0000 0001 2179 7643</institution-id><institution>Department of Physiology and Biophysics, </institution><institution>Institute for Computational Biomedicine, Weill Cornell Medicine, </institution></institution-wrap>New York, NY USA </aff>
      <aff id="Aff9"><label>9</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/0130frc33</institution-id><institution-id institution-id-type="GRID">grid.10698.36</institution-id><institution-id institution-id-type="ISNI">0000 0001 2248 3208</institution-id><institution>Department of Biostatistics, </institution><institution>University of North Carolina, </institution></institution-wrap>Chapel Hill, NC USA </aff>
      <aff id="Aff10"><label>10</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/03xjacd83</institution-id><institution-id institution-id-type="GRID">grid.239578.2</institution-id><institution-id institution-id-type="ISNI">0000 0001 0675 4725</institution-id><institution>Department of Infection Biology, </institution><institution>Lerner Research Institute, Cleveland Clinic Foundation, </institution></institution-wrap>Cleveland, OH USA </aff>
      <aff id="Aff11"><label>11</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/03xjacd83</institution-id><institution-id institution-id-type="GRID">grid.239578.2</institution-id><institution-id institution-id-type="ISNI">0000 0001 0675 4725</institution-id><institution>Department of Cancer Biology, </institution><institution>Lerner Research Institute, Cleveland Clinic Foundation, </institution></institution-wrap>Cleveland, OH USA </aff>
      <aff id="Aff12"><label>12</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/00f54p054</institution-id><institution-id institution-id-type="GRID">grid.168010.e</institution-id><institution-id institution-id-type="ISNI">0000 0004 1936 8956</institution-id><institution>Department of Developmental Biology, </institution><institution>Stanford University, </institution></institution-wrap>Stanford, CA USA </aff>
      <aff id="Aff13"><label>13</label>Chapel Hill High School, Chapel Hill, NC USA </aff>
      <aff id="Aff14"><label>14</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/0464eyp60</institution-id><institution-id institution-id-type="GRID">grid.168645.8</institution-id><institution-id institution-id-type="ISNI">0000 0001 0742 0364</institution-id><institution>Program in Molecular Medicine, </institution><institution>University of Massachusetts Chan Medical School, </institution></institution-wrap>Worcester, MA USA </aff>
      <aff id="Aff15"><label>15</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/0168r3w48</institution-id><institution-id institution-id-type="GRID">grid.266100.3</institution-id><institution-id institution-id-type="ISNI">0000 0001 2107 4242</institution-id><institution>Center for Epigenomics &amp; Department of Cellular and Molecular Medicine, </institution><institution>University of California San Diego, </institution></institution-wrap>La Jolla, CA USA </aff>
      <aff id="Aff16"><label>16</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/0130frc33</institution-id><institution-id institution-id-type="GRID">grid.10698.36</institution-id><institution-id institution-id-type="ISNI">0000 0001 2248 3208</institution-id><institution>Department of Genetics, </institution><institution>University of North Carolina, </institution></institution-wrap>Chapel Hill, NC USA </aff>
      <aff id="Aff17"><label>17</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/0130frc33</institution-id><institution-id institution-id-type="GRID">grid.10698.36</institution-id><institution-id institution-id-type="ISNI">0000 0001 2248 3208</institution-id><institution>Department of Computer Science, </institution><institution>University of North Carolina, </institution></institution-wrap>Chapel Hill, NC USA </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>12</day>
      <month>8</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>12</day>
      <month>8</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2023</year>
    </pub-date>
    <volume>14</volume>
    <elocation-id>4873</elocation-id>
    <history>
      <date date-type="received">
        <day>11</day>
        <month>5</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>1</day>
        <month>8</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article’s Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article’s Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1">Multiplexed DNA fluorescence in situ hybridization (FISH) imaging technologies have been developed to map the folding of chromatin fibers at tens of nanometers and up to several kilobases in resolution in single cells. However, computational methods to reliably identify chromatin loops from such imaging datasets are still lacking. Here we present a Single-Nucleus Analysis Pipeline for multiplexed DNA FISH (SnapFISH), to process the multiplexed DNA FISH data and identify chromatin loops. SnapFISH can identify known chromatin loops from mouse embryonic stem cells with high sensitivity and accuracy. In addition, SnapFISH obtains comparable results of chromatin loops across datasets generated from diverse imaging technologies. SnapFISH is freely available at <ext-link ext-link-type="uri" xlink:href="https://github.com/HuMingLab/SnapFISH">https://github.com/HuMingLab/SnapFISH</ext-link>.</p>
    </abstract>
    <abstract id="Abs2" abstract-type="web-summary">
      <p id="Par2">Multiplexed DNA FISH technologies are powerful tools to reveal chromatin spatial organisation. Here, the authors developed SnapFISH, a computational pipeline to identify chromatin loops from multiplexed DNA FISH data.</p>
    </abstract>
    <kwd-group kwd-group-type="npg-subject">
      <title>Subject terms</title>
      <kwd>Software</kwd>
      <kwd>Statistical methods</kwd>
      <kwd>Bioinformatics</kwd>
      <kwd>Epigenomics</kwd>
      <kwd>Genetic techniques</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">https://doi.org/10.13039/100000002</institution-id>
            <institution>U.S. Department of Health &amp; Human Services | National Institutes of Health (NIH)</institution>
          </institution-wrap>
        </funding-source>
        <award-id>R35HG011922</award-id>
        <award-id>UM1HG011585</award-id>
        <award-id>U01DA052713</award-id>
        <award-id>R01HL163972</award-id>
        <award-id>U01HG011720</award-id>
        <award-id>U24AR076730</award-id>
        <principal-award-recipient>
          <name>
            <surname>Li</surname>
            <given-names>Yun</given-names>
          </name>
          <name>
            <surname>Hu</surname>
            <given-names>Ming</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>U.S. Department of Health &amp; Human Services | National Institutes of Health (NIH)</institution>
        </funding-source>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>U.S. Department of Health &amp; Human Services | National Institutes of Health (NIH)</institution>
        </funding-source>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>U.S. Department of Health &amp; Human Services | National Institutes of Health (NIH)</institution>
        </funding-source>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>U.S. Department of Health &amp; Human Services | National Institutes of Health (NIH)</institution>
        </funding-source>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>U.S. Department of Health &amp; Human Services | National Institutes of Health (NIH)</institution>
        </funding-source>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© Springer Nature Limited 2023</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1" sec-type="introduction">
    <title>Introduction</title>
    <p id="Par3">How chromatin folds inside the nucleus is a fundamental question in the study of genome structure and function<sup><xref ref-type="bibr" rid="CR1">1</xref></sup>. Disruption of chromatin organization can lead to gene dysregulation, and has been associated with a variety of human developmental disorders, neuropsychiatric diseases, and cancers<sup><xref ref-type="bibr" rid="CR2">2</xref></sup>. Different from proximity-ligation assays<sup><xref ref-type="bibr" rid="CR3">3</xref>,<xref ref-type="bibr" rid="CR4">4</xref></sup> that infer the 3D genome through <italic>indirect</italic> measurement of DNA sequence contacts, chromatin tracing, as an emerging microscopy-based technology, can visualize bright spots corresponding to individual targeted genomic segments arrayed along chromatin fibers, and map their physical location in three-dimensional space. This rich imaging data permits the <italic>direct</italic> measurement of Euclidean distances between targeted genomic segments of interest—such as promoters and distal <italic>cis</italic>-regulatory elements - allowing an intimate look into the organization of chromosomes<sup><xref ref-type="bibr" rid="CR5">5</xref></sup>. During the last decade, a number of chromatin tracing technologies have emerged, including multiplexed DNA fluorescence in situ hybridization (FISH)<sup><xref ref-type="bibr" rid="CR6">6</xref>,<xref ref-type="bibr" rid="CR7">7</xref></sup>, DNA-MERFISH<sup><xref ref-type="bibr" rid="CR8">8</xref></sup>, DNA seqFISH+<sup><xref ref-type="bibr" rid="CR9">9</xref>,<xref ref-type="bibr" rid="CR10">10</xref></sup>, ORCA<sup><xref ref-type="bibr" rid="CR11">11</xref></sup>, MINA<sup><xref ref-type="bibr" rid="CR12">12</xref></sup>, Hi-M<sup><xref ref-type="bibr" rid="CR13">13</xref></sup>, OligoFISSEQ<sup><xref ref-type="bibr" rid="CR14">14</xref></sup> and IGS<sup><xref ref-type="bibr" rid="CR15">15</xref></sup> (more details can be found in recent review articles<sup><xref ref-type="bibr" rid="CR5">5</xref>,<xref ref-type="bibr" rid="CR16">16</xref>,<xref ref-type="bibr" rid="CR17">17</xref></sup>). These techniques can resolve the spatial location of discrete targeted genomic segments with tens of nanometer precision in single cells. They have been used to image the entire mammalian genome at megabase (Mb) resolution<sup><xref ref-type="bibr" rid="CR9">9</xref>,<xref ref-type="bibr" rid="CR10">10</xref></sup>, one full chromosome at 50 kilobase (Kb) resolution<sup><xref ref-type="bibr" rid="CR8">8</xref></sup>, and a few selected regions at 2.5 Kb ~ 30 Kb resolution<sup><xref ref-type="bibr" rid="CR7">7</xref>–<xref ref-type="bibr" rid="CR11">11</xref>,<xref ref-type="bibr" rid="CR18">18</xref>,<xref ref-type="bibr" rid="CR19">19</xref></sup>, promising to uncover novel insights into chromatin folding and its role in gene regulation<sup><xref ref-type="bibr" rid="CR5">5</xref></sup>.</p>
    <p id="Par4">Chromatin loops are a key structural feature of chromatin spatial organization, and may serve as the structural basis of gene regulation. Originally discovered from bulk Hi-C data<sup><xref ref-type="bibr" rid="CR4">4</xref>,<xref ref-type="bibr" rid="CR20">20</xref></sup> as “dots” at the corners of topologically associating domains, and recently identified from single cell Hi-C data<sup><xref ref-type="bibr" rid="CR21">21</xref>,<xref ref-type="bibr" rid="CR22">22</xref></sup> and imaging data<sup><xref ref-type="bibr" rid="CR18">18</xref></sup>, chromatin loops are defined as pairs of genomic loci with closer spatial proximity compared to other pairs of loci in the local neighborhood region<sup><xref ref-type="bibr" rid="CR4">4</xref>,<xref ref-type="bibr" rid="CR20">20</xref></sup>. Chromatin loops between enhancers and promoters have been used to infer target genes for distal enhancers<sup><xref ref-type="bibr" rid="CR23">23</xref></sup>. Chromatin loops between CTCF binding sites are associated with the formation of topological associating domains<sup><xref ref-type="bibr" rid="CR24">24</xref></sup>, which are megabase sized chromatin domains constraining enhancer-promoter interactions. Extensive studies have demonstrated that chromatin loops play an essential role in maintaining the 3D structure of the genome and facilitating gene regulation<sup><xref ref-type="bibr" rid="CR25">25</xref>–<xref ref-type="bibr" rid="CR28">28</xref></sup>.</p>
    <p id="Par5">The functional importance of chromatin loops makes it important to develop loop callers tailored to different input experimental datasets (Supplementary Information Section <xref rid="MOESM1" ref-type="media">1</xref>). All existing loop callers are designed for genomic data generated from proximity-ligation assays, which utilize the <italic>count</italic>-based statistical framework to model chromatin contact frequency<sup><xref ref-type="bibr" rid="CR29">29</xref></sup>. As a result, these tools are inherently not directly applicable to imaging data, which allow the <italic>continuous</italic> measurement of Euclidean distances between targeted genomic segments of interest. To the best of our knowledge, no method is available to identify chromatin loops from such imaging data. In the wake of the rapid development of chromatin tracing technologies, tailored computational methods to reliably identify chromatin loops from imaging data have become more critical. Importantly, such loop analysis methods may advance our understanding of the relationships between genome structure and gene regulation.</p>
    <p id="Par6">In this work, to fill in the abovementioned methodological gap, we develop Single-Nucleus Analysis Pipeline for multiplexed DNA FISH data (SnapFISH), a computational pipeline to identify chromatin loops from multiplexed DNA FISH data. SnapFISH can identify known chromatin loops from mouse embryonic stem cells with high sensitivity and accuracy. In addition, SnapFISH can accommodate datasets generated from diverse imaging technologies.</p>
  </sec>
  <sec id="Sec2" sec-type="results">
    <title>Results</title>
    <sec id="Sec3">
      <title>SnapFISH algorithm</title>
      <p id="Par7">In the same spirit of our recently developed SnapHiC<sup><xref ref-type="bibr" rid="CR21">21</xref></sup> pipeline for single cell Hi-C data, SnapFISH also treats each imaged cell as an independent unit, to boost the statistical power of identifying chromatin loops. Specifically, SnapFISH takes multiplexed DNA FISH single bright spot localization data as input, and outputs the predicted chromosomal location of chromatin loops. Briefly, SnapFISH first collects the 3D localization coordinates of each genomic segment targeted by FISH (hereafter referred to as targeted segment) in each cell (Fig. <xref rid="Fig1" ref-type="fig">1A</xref>), and computes the pairwise Euclidean distances between all imaged targeted segments (Fig. <xref rid="Fig1" ref-type="fig">1B</xref>). SnapFISH then calculates the average Euclidean distance between two targeted segments with the 1D genomic distance of 25Kb (termed as avg.dist.1D.25Kb), and defines the population-level contact frequency between any two targeted segments as the fraction of cells with Euclidean distance smaller than avg.dist.1D.25Kb (Fig. <xref rid="Fig1" ref-type="fig">1C</xref>) (see details in a recent preprint<sup><xref ref-type="bibr" rid="CR30">30</xref></sup>). Next, for all pairs of targeted segments found within a 1D genomic distance range of 100 Kb ~ 1 Mb, SnapFISH compares the pairwise Euclidean distances between the pair of interest and its local neighborhood region (Supplementary Fig. <xref rid="MOESM1" ref-type="media">S1</xref>, see details in Methods) using a two-sample <italic>T</italic>-test (Fig. <xref rid="Fig1" ref-type="fig">1D</xref>). SnapFISH then converts the resulting P-values into false discovery rates (FDRs), and defines a pair of targeted segments as a loop candidate if the average Euclidean distance between the pair of interests is smaller than the average Euclidean distance in its local neighborhood region (i.e., <italic>T</italic>-test statistic &lt;0), and FDR is less than 10% (Fig. <xref rid="Fig1" ref-type="fig">1E</xref>, see details in Methods). Lastly, SnapFISH groups nearby loop candidates into clusters, identifies the pair with the lowest FDR within each cluster (hereafter referred to as the cluster summit), and uses both cluster summits and singletons (i.e., cluster with only one loop candidate) as the final list of chromatin loops (Fig. <xref rid="Fig1" ref-type="fig">1E</xref>, see details in Methods).<fig id="Fig1"><label>Fig. 1</label><caption><title>The flowchart of the SnapFISH algorithm.</title><p><bold>A</bold> The 3D coordinates for each targeted segment in cell 1, 2, …, <italic>K</italic>. Each matrix represents one cell. Each row is one targeted segment and <italic>X</italic>, <italic>Y</italic>, <italic>Z</italic> are the 3D coordinates. <bold>B</bold> Euclidean distance matrices. Again, each matrix is for one cell. The dashed purple block highlighted the pair of targeted segments of interest: between the targeted segment 2 and the targeted segment 4. <bold>C</bold> Population-level contact frequency matrix. Similar to <bold>B</bold>, the dashed purple block highlighted the pair of targeted segments of interest: between the targeted segment 2 and the targeted segment 4. dist.25 Kb: the average Euclidean distance between two targeted segments with the 1D genomic distance of 25 Kb. <bold>D</bold> Two-sample <italic>T</italic>-test comparing the Euclidean distance between the pair of targeted segments of interest and its local neighborhood control region. <bold>E</bold> Post-processing to identify loop candidates and loop summits. The cartoon represents the clustering of nearby loop candidates and the selection of loop summit (i.e., between the targeted segment 3 and the targeted segment 8), which is highlighted by the dashed yellow block (see detailed listed in Methods). Source data are provided as a Source Data file.</p></caption><graphic xlink:href="41467_2023_40658_Fig1_HTML" id="d32e721"/></fig></p>
    </sec>
    <sec id="Sec4">
      <title>Optimizing the SnapFISH algorithm using DNA seqFISH+ data in mESCs</title>
      <p id="Par8">In order to optimize the SnapFISH algorithm, we re-analyzed a publicly available DNA seqFISH+ dataset from mouse embryonic stem cells (mESCs)<sup><xref ref-type="bibr" rid="CR9">9</xref></sup>, where the authors selected one region from each chromosome, with region length ranging from 1.5 Mb ~ 2.35 Mb (Supplementary Table <xref rid="MOESM1" ref-type="media">S1</xref>), and performed DNA seqFISH+ experiment at 25 Kb bin resolution, in two biological replicates (see details in imaging data resource). We combined data across replicates, resulting in 446 cells (i.e., 892 alleles) in total. The average targeted segment detection efficiency, defined as the proportion of imaged targeted segments among all targeted segments, is 65.2%. As the reference loop set (serving as the working truth), we re-analyzed a deeply sequenced mESC bulk Hi-C data<sup><xref ref-type="bibr" rid="CR31">31</xref></sup>, and identified 35 loops with HiCCUPS at both 10 Kb and 25 Kb resolution in the corresponding genomic region where DNA seqFISH+ data is available (Supplementary Table <xref rid="MOESM1" ref-type="media">S2</xref>). We applied SnapFISH to call loops from DNA seqFISH+ data in mESCs, and calculated precision, recall and F1-score based on the reference HiCCUPS loops. Among all tested combinations of SnapFISH parameters, we selected the one corresponding to the highest F1-score, defined as the harmonic mean of the precision and recall (see details in Supplementary Information Section <xref rid="MOESM1" ref-type="media">2</xref> and Table <xref rid="MOESM1" ref-type="media">S3</xref>). With the optimized parameters, SnapFISH identified 16 loops (Supplementary Table <xref rid="MOESM1" ref-type="media">S4A</xref>), where 14 loops overlap HiCCUPS loops (Fig. <xref rid="Fig2" ref-type="fig">2A</xref> and Supplementary Fig. <xref rid="MOESM1" ref-type="media">S2A</xref><bold>~</bold>
<xref rid="MOESM1" ref-type="media">S2H</xref> and Fig. <xref rid="MOESM1" ref-type="media">S3</xref>). The precision, recall and F1-score are 87.5%, 40.0% and 0.549, respectively. Specifically, 9 SnapFISH loops overlap with 16 25Kb HiCCUPS loops (recall = 56.3%), and 5 SnapFISH loops overlap with 19 10 Kb HiCCUPS loops (recall = 26.3%). As we expected, SnapFISH loops identified from imaging data from 446 cells achieved lower sensitivity compared to HiCCUPS loops identified from deeply sequenced bulk Hi-C data, which usually contains ~10<sup>6</sup> cells<sup><xref ref-type="bibr" rid="CR31">31</xref></sup>. SnapFISH achieved higher sensitivity when imaging data and bulk Hi-C data are at the same 25 Kb resolution, and most false negatives are from the finer 10 Kb resolution. In addition, we evaluated how loop strength, measured by population-level contact frequency, affects the sensitivity of SnapFISH. Supplementary Fig. <xref rid="MOESM1" ref-type="media">S2I</xref> shows that the 14 true positives (HiCCUPS loops identified by SnapFISH) have significantly higher average population-level contact frequency (49.7%) than that (37.2%) in the 21 false negatives (HiCCUPS loops missed by SnapFISH) (two-sided two sample <italic>T</italic>-test <italic>P</italic> = 0.0014), suggesting that SnapFISH can achieve higher sensitivity for loops with higher strength.<fig id="Fig2"><label>Fig. 2</label><caption><title>SnapFISH identified chromatin loops with high accuracy.</title><p><bold>A</bold> SnapFISH identified a CTCF-CTCF loop in chromosome 2 from mESC DNA seqFISH+ data. The top three tracks are mESC CTCF, mESC H3K4me3 and mESC H3K27ac ChIP-seq data. The middle three tracks represent HiCCUPS-identified loops at 25 Kb bin resolution, HiCCUPS-identified loops at 10 Kb bin resolution, and SnapFISH-identified loops at 25 Kb bin resolution, respectively. The bottom track is the Refseq gene annotation. Both anchors (dashed red boxes) contain mESC CTCF ChIP-seq peaks. Source data are provided as a Source Data file. <bold>B</bold> SnapFISH identified the <italic>Sox2</italic> enhancer-promoter loop from mESC multiplexed DNA FISH data and mESC ORCA data. The top three tracks are mESC CTCF, mESC H3K4me3, and mESC H3K27ac ChIP-seq data. The middle four tracks represent the HiCCUPS-identified loop from mESC bulk Hi-C data<sup><xref ref-type="bibr" rid="CR31">31</xref></sup>, the SnapFISH-identified loop from 1,416 129 alleles and 1416 CAST alleles, and the SnapFISH-identified loop from mESC ORCA data, respectively. All these loops are at 5 Kb bin resolution. The bottom track is the Refseq gene annotation. The red dashed box on the left and the right represents the location of the promoter of the <italic>Sox2</italic> gene and its super-enhancer, respectively. We allow for a 5 Kb gap between loop anchors and the <italic>Sox2</italic> promoter or super-enhancer (see details in Methods). Source data are provided as a Source Data file. <bold>C</bold> SnapFISH identified an enhancer-promoter loop in chromosome 15 from DNA seqFISH+ data in mouse excitatory neurons. The top five tracks are ATAC-seq, H3K4me1, H3K4me3, H3K27ac and RNA-seq data from cortical excitatory neurons L2/3 collected from mouse frontal cortex tissue (FC_L2_3 for short)<sup><xref ref-type="bibr" rid="CR35">35</xref></sup>. The bottom two tracks are SnapFISH-identified 25 Kb bin resolution loops and the Refseq gene annotation. The left anchor (dashed red box on the left) is at gene <italic>Myc</italic>. The right anchor (dashed red box on the right) is at the transcription end site of gene <italic>Pvt1</italic>, which contains an ATAC peak. Source data are provided as a Source Data file.</p></caption><graphic xlink:href="41467_2023_40658_Fig2_HTML" id="d32e821"/></fig></p>
      <p id="Par9">As one illustrative example in chromosome 2, Fig. <xref rid="Fig2" ref-type="fig">2A</xref> shows that SnapFISH identified a CTCF-CTCF loop, which has also been detected by HiCCUPS from mESC bulk Hi-C data at 25 Kb resolution. The 3 false negatives are all 10 Kb HiCCUPS loops (Fig. <xref rid="Fig2" ref-type="fig">2A</xref>). In another illustrative example in chromosome 3, Supplementary Fig. <xref rid="MOESM1" ref-type="media">S3A</xref> shows that SnapFISH identified 6 loops, where 4 loops overlap with 4 HiCCUPS loops. Notably, the 2 false positives (i.e., not overlapping HiCCUPS loops) are the CTCF-CTCF loop and enhancer-promoter loop, respectively, and both overlap chromatin interactions identified from mESC H3K4me3 PLAC-seq data<sup><xref ref-type="bibr" rid="CR32">32</xref></sup>. Taken together, our results show that when applying to mESC DNA seqFISH+ data, SnapFISH can accurately and reliably identify loops that were previously identified from mESC bulk Hi-C data.</p>
    </sec>
    <sec id="Sec5">
      <title>Applying SnapFISH to multiplexed DNA FISH data and ORCA data in mESCs at the <italic>Sox2</italic> locus</title>
      <p id="Par10">Encouraged by the results from 25 Kb resolution mESC DNA seqFISH+ data, we then applied SnapFISH to the finer resolution (5 Kb) multiplexed DNA FISH data. Specifically, a multiplexed DNA FISH dataset has previously been generated from mESCs to investigate the chromatin conformation at the <italic>Sox2</italic> locus<sup><xref ref-type="bibr" rid="CR18">18</xref></sup> (such data is downloaded from the 4D Nucleome data portal, see details in imaging data resource). The 205 Kb chromosomal target region (mm10: chr3:34,601,078-34,806,078) imaged in the experiments spans both the promoter of the <italic>Sox2</italic> gene and its super-enhancer, which is located ~100 Kb downstream. Previous studies have identified a chromatin loop between the <italic>Sox2</italic> promoter and its super-enhancer via 5C<sup><xref ref-type="bibr" rid="CR33">33</xref></sup>, and validated the functional importance of such loop via the CRISPR experiment, which showed that deletion of the super-enhancer reduces &gt;90% of the <italic>Sox2</italic> expression<sup><xref ref-type="bibr" rid="CR34">34</xref></sup>. The mESCs used in the original study<sup><xref ref-type="bibr" rid="CR18">18</xref></sup> have two haplotypes: the CAST allele and the 129 allele. Distinct from the abovementioned mESC DNA seqFISH+ data where one cannot differentiate between the paternal and maternal alleles, the CAST allele contains a 7.5Kb insertion containing 4 CTCF-binding sites (hereafter referred to as 4CBS) between the <italic>Sox2</italic> promoter and its super-enhancer, while the 129 allele does not contain the insertion. The multiplexed DNA FISH experiments involved 41 probe sets, each corresponding to individual 5 Kb genomic target segments tiling the 205 Kb region of interest. In addition, there was one extra probe for the 7.5 Kb insertion on the CAST allele, which permits the differential identification of the CAST allele and the 129 allele in the same nucleus. A previous study<sup><xref ref-type="bibr" rid="CR18">18</xref></sup> showed that the CAST allele-specific 7.5 Kb 4CBS insertion resulted in weaker chromatin looping strength between the <italic>Sox2</italic> promoter and its super-enhancer.</p>
      <p id="Par11">We re-analyzed the multiplexed DNA FISH data (see details in Methods) from a total of 1416 cells (i.e., 1416 CAST alleles and 1416 129 alleles) using SnapFISH. The average targeted segment detection efficiency is 71.9% and 69.3% for the CAST allele and the 129 allele, respectively. We first computed the average Euclidean distances (Supplementary Fig. <xref rid="MOESM1" ref-type="media">S4A</xref>) and population-level contact frequency (Supplementary Fig. <xref rid="MOESM1" ref-type="media">S4B</xref>) between all pairs of 5 Kb genomic targeted segment in these experiments, and compared that with the 5 Kb bin resolution chromatin contact frequency in the mESC bulk Hi-C data<sup><xref ref-type="bibr" rid="CR18">18</xref></sup> in an allele-specific manner (Supplementary Fig. <xref rid="MOESM1" ref-type="media">S4C</xref>). As we expected, both average spatial distance and population-level contact frequency measured from multiplexed DNA FISH data are closely correlated with the Hi-C contact frequency. The Pearson correlation coefficient between Hi-C contact frequency and the inverse of average Euclidean distances is 0.812 and 0.805 for the CAST allele and the 129 allele, respectively. Consistently, the Pearson correlation coefficient between Hi-C contact frequency and population-level contact frequency measured from multiplexed DNA FISH data is 0.788 and 0.768 for the CAST allele and the 129 allele, respectively. Applying SnapFISH to 1,416 CAST alleles and 1,416 129 alleles identified 44 and 61 loop candidates, respectively (Supplementary Fig. <xref rid="MOESM1" ref-type="media">S4D</xref>). Finally, SnapFISH grouped neighboring loop candidates, and detected a single chromatin loop summit between the <italic>Sox2</italic> promoter and the super-enhancer in both CAST and 129 alleles (Fig. <xref rid="Fig2" ref-type="fig">2B</xref>). As a comparison, we applied HiCCUPS to identify 5Kb bin resolution chromatin loops from mESC bulk Hi-C data<sup><xref ref-type="bibr" rid="CR31">31</xref></sup>, and found that SnapFISH-identified loops are also near the HiCCUPS loop (Fig. <xref rid="Fig2" ref-type="fig">2B</xref>).</p>
      <p id="Par12">Next, we evaluated the sensitivity of SnapFISH using different numbers of input target alleles. Specifically, we ranked all 1416 CAST alleles by their targeted segment detection efficiency, and selected the top 1400, 1200, 1000, 800, 600, 400, 200, 100, and 50 CAST alleles as input for SnapFISH. We performed the same analysis with the 129 allele. Consistent with previous findings<sup><xref ref-type="bibr" rid="CR18">18</xref></sup> indicating that the strength of the <italic>Sox2</italic> enhancer-promoter loop is weaker in the CAST allele compared to that in the 129 allele, SnapFISH found fewer loop candidates among the CAST allele than that in the 129 allele (Supplementary Table <xref rid="MOESM1" ref-type="media">S5</xref>), due to the CAST-specific 4CBS insertion. However, despite these differences, we observed that SnapFISH can accurately identify the <italic>Sox2</italic> enhancer-promoter loop with as few as 200 CAST alleles (Supplementary Fig. <xref rid="MOESM1" ref-type="media">S5A</xref>) and 100 129 alleles (Supplementary Fig. <xref rid="MOESM1" ref-type="media">S5B</xref>). Our results suggest that SnapFISH achieves high sensitivity even with a small number of cells.</p>
      <p id="Par13">Since not all targeted segments can be detected in the multiplexed DNA FISH data, we further evaluated how targeted segment detection efficiency affects the sensitivity of SnapFISH. Specifically, we again ranked all 1416 CAST alleles by their targeted segment detection efficiency, and then equally divided them into three groups, where each group consisted of 472 CAST alleles. We stratified them as “high”, “median” and “low” targeted segment detection efficiency groups, with an average targeted segment detection efficiency of 85.4%, 73.2%, and 57.0%, respectively. We performed the same analysis for the 1416 129 alleles, and similarly created three 129 allele groups, with an average targeted segment detection efficiency of 82.6%, 70.4%, and 55.0%, respectively. We applied SnapFISH to each of the six groups and examined the identified loop candidates and loop summits. In the CAST alleles where the <italic>Sox2</italic> enhancer-promoter loop strength is weak due to the CAST-specific 4CBS insertion, SnapFISH can detect the loop in both “high” and “median” detection efficiency groups, but it reports 3 false positives in the “low” detection efficiency group (Supplementary Fig. <xref rid="MOESM1" ref-type="media">S5C</xref> and Table <xref rid="MOESM1" ref-type="media">S6</xref>). In contrast, in the 129 alleles, SnapFISH can detect the loop in all three detection efficiency groups without false positives (Supplementary Fig. <xref rid="MOESM1" ref-type="media">S5C</xref> and Table <xref rid="MOESM1" ref-type="media">S6</xref>). As expected, our results suggest that targeted segment detection efficiency can influence the sensitivity of detecting chromatin loops.</p>
      <p id="Par14">Additionally, we evaluated the performance of SnapFISH on an ORCA dataset<sup><xref ref-type="bibr" rid="CR11">11</xref></sup> generated at the same <italic>Sox2</italic> locus in mESCs (see details in imaging data resource). Specifically, Mateo et al. imaged the 170 Kb region around the <italic>Sox2</italic> gene (mm10: chr3:34,601,078-34,771,078) in mESCs, which consists of 34 5 Kb targeted segments. Across all 6007 imaged alleles, the average targeted segment detection efficiency is 56.9%. Consistent with the results in multiplexed DNA FISH data, SnapFISH identified the <italic>Sox2</italic> enhancer-promoter loop (Fig. <xref rid="Fig2" ref-type="fig">2B</xref>). Taken together, our data show that SnapFISH can accurately identify the <italic>Sox2</italic> enhancer-promoter loop, which had previously been identified by mESC bulk Hi-C data, from both multiplexed DNA FISH data and ORCA data.</p>
    </sec>
    <sec id="Sec6">
      <title>Applying SnapFISH to DNA seqFISH+ data in mouse excitatory neurons</title>
      <p id="Par15">We additionally re-analyzed another publicly available 25Kb resolution DNA seqFISH+ dataset from mouse cerebral cortex tissue<sup><xref ref-type="bibr" rid="CR10">10</xref></sup>. The dataset also included RNA seqFISH data simultaneously generated from the same cells<sup><xref ref-type="bibr" rid="CR10">10</xref></sup>, which can be used to group and annotate distinct cell clusters. We combined the three biological replicates of DNA seqFISH+ datasets to obtain a total of 2,762 cells (i.e., 5,24 alleles), with an average targeted segment detection efficiency of 40.9%. Due to the relatively low targeted segment detection efficiency, we only applied SnapFISH to the excitatory neurons<sup><xref ref-type="bibr" rid="CR10">10</xref></sup> consisting of 1,895 cells (i.e., 3790 alleles, with an average targeted segment detection efficiency of 43.1%), and identified 87 loops (Table <xref rid="MOESM1" ref-type="media">S4B</xref>).</p>
      <p id="Par16">To the best of our knowledge, there is no publicly available bulk Hi-C data or single cell Hi-C data generated from excitatory neurons in mouse cerebral cortex tissue. To evaluate the functional relevance of these SnapFISH identified loops, we used recently published Paired-Tag data<sup><xref ref-type="bibr" rid="CR35">35</xref></sup> to obtain transcriptomic data and epigenetic data from cortical excitatory neurons L2/3 collected from mouse frontal cortex tissue (FC_L2_3 for short), including active promoter mark H3K4me3, two active enhancer marks H3K27ac and H3K4me1, and the open chromatin region mark ATAC. Figure <xref rid="Fig2" ref-type="fig">2C</xref> shows an illustrative example of the enhancer-promoter loop in chromosome 15, where the loop connects the promoter of gene <italic>Myc</italic> and the transcription end site of gene <italic>Pvt1</italic>. Both loop anchors overlap H3K27ac peaks and ATAC-seq peaks. We obtained similar results when applying SnapFISH to three additional mouse brain cell types (Supplementary Information Section <xref rid="MOESM1" ref-type="media">3</xref> and Supplementary Fig. <xref rid="MOESM1" ref-type="media">S6</xref>). Taken together, our results suggest that SnapFISH is able to identify putative enhancer-promoter loops from DNA seqFISH+ data in mouse brain tissue sample.</p>
    </sec>
  </sec>
  <sec id="Sec7" sec-type="discussion">
    <title>Discussion</title>
    <p id="Par17">In this work, we report SnapFISH, the first computational pipeline to identify de novo chromatin loops from multiplexed DNA FISH data, without prior knowledge of potential loop anchor regions. We applied SnapFISH to multiplexed DNA FISH, ORCA and DNA seqFISH+ experiments in both mouse mESCs and mouse excitatory neurons, and benchmarked the performance of SnapFISH-identified chromatin loops using chromatin loops identified from bulk Hi-C data. We also showed the high reproducibility of SnapFISH between biological replicates (Supplementary Information Section <xref rid="MOESM1" ref-type="media">4</xref>, Supplementary Fig. <xref rid="MOESM1" ref-type="media">S7</xref>, and Tables <xref rid="MOESM1" ref-type="media">S7</xref>, <xref rid="MOESM1" ref-type="media">S8</xref>), and the robustness of SnapFISH against different levels of measurement errors in the multiplexed DNA FISH experiments (Supplementary Information Section <xref rid="MOESM1" ref-type="media">5</xref>, Supplementary Fig. <xref rid="MOESM1" ref-type="media">S8</xref> and Table <xref rid="MOESM1" ref-type="media">S9</xref>). Additionally, we provide the option of the non-parametric Wilcoxon test, as an alternative to the default two sample <italic>T</italic>-test (Supplementary Information Section <xref rid="MOESM1" ref-type="media">6</xref> and Figs. <xref rid="MOESM1" ref-type="media">S9</xref>, <xref rid="MOESM1" ref-type="media">S10</xref>). SnapFISH is computationally efficient, with the computing time increasing linearly with the number of cells (Supplementary Information Section <xref rid="MOESM1" ref-type="media">7</xref> and Fig. <xref rid="MOESM1" ref-type="media">S11</xref>).</p>
    <p id="Par18">Building upon these promising results, we envision at least four directions that warrant further investigation. First of all, the sensitivity of SnapFISH can be further improved, in particular when applying to DNA seqFISH+ data in mESCs. As we showed in the analysis of multiplexed DNA FISH data in mESCs (Supplementary Fig. <xref rid="MOESM1" ref-type="media">S5C</xref> and Table <xref rid="MOESM1" ref-type="media">S6</xref>), a low level of targeted segment detection efficiency can reduce the sensitivity of loop detection. We expect that imputing missing 3D coordinates and missing Euclidean distance between genomic loci of interest may increase the sample size for the two sample <italic>T</italic>-test used in the SnapFISH algorithm (Fig. <xref rid="Fig1" ref-type="fig">1D</xref>), and help to enhance the statistical power of loop detection.</p>
    <p id="Par19">Second, we only considered pair-wise chromatin interactions in this work. Multiplexed DNA FISH data provide rich information on multi-way chromatin interactions, making it feasible to detect events where one enhancer interacts with multiple target genes, or one gene’s promoter interacts with multiple enhancers simultaneously. We will extend our SnapFISH framework to identify multi-way chromatin interactions, and benchmark our findings with data generated from orthogonal technologies, including immunoGAM<sup><xref ref-type="bibr" rid="CR36">36</xref></sup> and scSPRITE<sup><xref ref-type="bibr" rid="CR37">37</xref></sup>.</p>
    <p id="Par20">In addition, encouraged by the success in the integrative modeling of 3D chromatin architecture datasets<sup><xref ref-type="bibr" rid="CR38">38</xref></sup>, method developers would benefit from simulators that generate realistic multiplexed DNA FISH data, allowing flexible allocations of true loops and random collisions, precise control of the distribution of loop strength, as well as cell-to-cell variability. However, limited publicly available real data may not yet allow us to comprehensively evaluate whether data produced by a simulator is sufficiently realistic. Future studies are warranted as more data becomes available.</p>
    <p id="Par21">Last but not least, other genomic data modalities, including transcriptome and epigenome, can be imaged together with DNA in the same cell<sup><xref ref-type="bibr" rid="CR9">9</xref>–<xref ref-type="bibr" rid="CR12">12</xref></sup>. Integrating chromatin loops identified from SnapFISH with other genomic data modalities at single cell resolution, and characterizing their cell-to-cell variability, have the potential to reveal novel mechanisms of transcriptional regulation.</p>
    <p id="Par22">In summary, we developed SnapFISH, the first computational pipeline to identify de novo chromatin loops from multiplexed DNA FISH data. As high-resolution multiplexed DNA FISH data are increasingly available, we consider SnapFISH a valuable tool for analyzing such data, facilitating a better understanding of genome structure and genome function.</p>
  </sec>
  <sec id="Sec8">
    <title>Methods</title>
    <sec id="Sec9">
      <title>Definition of local neighborhood regions</title>
      <p id="Par23">For both 5 Kb bin resolution multiplexed DNA FISH data in mESCs, 5 Kb bin resolution OCRA data in mESCs, and 25 Kb bin resolution DNA seqFISH+ data in mESCs and mouse excitatory neurons, we define the local neighborhood of a given targeted segment pair as all of the identified pairs that fall within a square with 25 Kb ~ 50 Kb in 1D genomic distance from the targeted segment pair of interest. Specifically, Supplementary Fig. <xref rid="MOESM1" ref-type="media">S1</xref> shows the definition of local neighborhood regions, which is similar to the definition that has been used in the HiCCUPS algorithm<sup><xref ref-type="bibr" rid="CR4">4</xref></sup>, and our recently developed SnapHiC algorithm<sup><xref ref-type="bibr" rid="CR21">21</xref></sup>. The union of blue areas consists of the “circle” region that defines the local neighborhood.</p>
    </sec>
    <sec id="Sec10">
      <title>Two sample <italic>T</italic>-test</title>
      <p id="Par24">For each given targeted segment pair in each cell, we calculated the average Euclidean distance among all targeted segment pairs in its local neighborhood regions, as used such average Euclidean distance as the control. Due to the missing data in multiplexed DNA FISH data, not all targeted segments are observed. Therefore, we applied two sample <italic>T</italic>-test, instead of paired <italic>T</italic>-test, to evaluate the statistical significance of the difference in Euclidean distance between a given targeted segment pair and its local neighborhood. In addition, SnapFISH provided the non-parametric Wilcoxon test, as an alternative to the default two sample <italic>T</italic>-test.</p>
    </sec>
    <sec id="Sec11">
      <title>Identification of loop candidates</title>
      <p id="Par25">We define a pair of segments as a loop candidate if and only its average Euclidean distance is smaller than that of the average Euclidean distance for segment pairs in the local neighborhood (T &lt; 0) and FDR &lt; 10% (Fig. <xref rid="Fig1" ref-type="fig">1E</xref>).</p>
    </sec>
    <sec id="Sec12">
      <title>Identification of loop summits</title>
      <p id="Par26">We group nearby loop candidates within a pre-specified gap into clusters, where the gap is twice the size of the bin resolution. In other words, we define the gap to be 10 Kb for 5 Kb resolution multiplexed DNA FISH data and 5 Kb resolution OCRA data, and 50 Kb for 25 Kb resolution DNA seqFISH+ data. Among each cluster, we select the pair of targeted segments with the minimal FDR as the summit. The final loop list consists of cluster summits with population-level contact frequency &gt;=1/3, and singletons with population-level contact frequency &gt;=1/2. Detailed justification of threshold values can be found in Supplementary Information Section <xref rid="MOESM1" ref-type="media">1</xref>.</p>
    </sec>
    <sec id="Sec13">
      <title>Overlap of SnapFISH-identified loop with <italic>Sox2</italic> enhancer-promoter loop</title>
      <p id="Par27">We defined chr3:34,645,000–34,655,000 and chr3:34,755,000–34,765,000 as the two 10 Kb bins containing <italic>Sox2</italic> promoter and super-enhancer, respectively. We further defined a SnapFISH-identified 5 Kb bin resolution loop as “overlapped” with the <italic>Sox2</italic> enhancer-promoter, if and only if the SnapFISH loop anchors are within 10 Kb of <italic>Sox2</italic> promoter-super-enhancer loop anchors.</p>
    </sec>
    <sec id="Sec14">
      <title>Statistics and reproducibility</title>
      <p id="Par28">In this study, we re-analyzed the publicly available datasets (see details in the “Data Availability” section below). No statistical method was used to predetermine sample size. No data were excluded from the analyses. The experiments were not randomized. The investigators were not blinded to allocating during experiments and outcome assessment. In addition, we evaluated the reproducibility of SnapFISH among biological replicates (see details in Supplementary Information Section <xref rid="MOESM1" ref-type="media">4</xref>).</p>
    </sec>
    <sec id="Sec15">
      <title>Reporting summary</title>
      <p id="Par29">Further information on research design is available in the <xref rid="MOESM6" ref-type="media">Nature Portfolio Reporting Summary</xref> linked to this article.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <sec id="Sec16">
      <title>Supplementary information</title>
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="41467_2023_40658_MOESM1_ESM.pdf">
            <caption>
              <p>Supplementary Information</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="41467_2023_40658_MOESM2_ESM.pdf">
            <caption>
              <p>Peer Review File</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM3">
          <media xlink:href="41467_2023_40658_MOESM3_ESM.pdf">
            <caption>
              <p>Description of Additional Supplementary Files</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM4">
          <media xlink:href="41467_2023_40658_MOESM4_ESM.csv">
            <caption>
              <p>Supplementary Dataset 1</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM5">
          <media xlink:href="41467_2023_40658_MOESM5_ESM.xlsx">
            <caption>
              <p>Supplementary Dataset 2</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM6">
          <media xlink:href="41467_2023_40658_MOESM6_ESM.pdf">
            <caption>
              <p>Reporting Summary</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
    <sec id="Sec17">
      <title>Source data</title>
      <p>
        <supplementary-material content-type="local-data" id="MOESM7">
          <media xlink:href="41467_2023_40658_MOESM7_ESM.zip">
            <caption>
              <p>Source Data</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p><bold>Publisher’s note</bold> Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <sec>
    <title>Supplementary information</title>
    <p>The online version contains supplementary material available at 10.1038/s41467-023-40658-3.</p>
  </sec>
  <ack>
    <title>Acknowledgements</title>
    <p>We thank 4D Nucleome consortium investigators for their comments and suggestions on the early version of this work. This study was funded by the NIH grants R35HG011922 (to M.H.) and U01DA052713 (to Y.L.). M.H. was also partially funded by the NIH grant UM1HG011585. Y.L. was also partially funded by the NIH grants R01MH125236, R01HL163972, U01HG011720, and U24AR076730.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author contributions</title>
    <p>L.L. and H.Y. implemented the SnapFISH software. Y.L. and M.H. supervised the project. B.J., A.J., C.Z., J.C., and A.H. analyzed the data. L.X., S.M., D.W., C.S., A.B., and B.R. evaluated the method. L.L., Y.L., and M.H. wrote the manuscript with input from all the authors. All authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="peer-review">
    <title>Peer review</title>
    <sec id="FPar1">
      <title>Peer review information</title>
      <p id="Par30"><italic>Nature Communications</italic> thanks the anonymous reviewer(s) for their contribution to the peer review of this work. A peer review file is available.</p>
    </sec>
  </notes>
  <notes notes-type="data-availability">
    <title>Data availability</title>
    <p>All relevant data supporting the key findings of this study are available within the article and its Supplementary Information files. Imaging data resource. 25 Kb bin resolution DNA seqFISH+ data from mESC. We downloaded DNA seqFISH+ data from the website <ext-link ext-link-type="uri" xlink:href="https://zenodo.org/record/3735329">https://zenodo.org/record/3735329</ext-link>, and used two files (DNAseqFISH+25kbloci-E14-replicate1.csv and DNAseqFISH+25kbloci-E14-replicate2.csv). Such data are originally used in the Takei et al. study<sup><xref ref-type="bibr" rid="CR9">9</xref></sup>. 5 Kb bin resolution multiplexed DNA FISH data from mESC at the <italic>Sox2</italic> gene locus. We downloaded multiplexed DNA FISH data from the 4D Nucleome data portal (<ext-link ext-link-type="uri" xlink:href="https://data.4dnucleome.org/experiment-set-replicates/4DNESC5PKTQ9/">https://data.4dnucleome.org/experiment-set-replicates/4DNESC5PKTQ9/</ext-link>), which were originally used in the Huang et al. study<sup><xref ref-type="bibr" rid="CR18">18</xref></sup>. 5 Kb bin resolution ORCA data from mESC at the <italic>Sox2</italic> locus. ORCA data are shared by Dr. Boettiger, which were originally used in the Mateo et al. study<sup><xref ref-type="bibr" rid="CR11">11</xref></sup>. We shared ORCA data as the file “Supplementary Dataset 1.csv” in this paper. 25 Kb bin resolution DNA seqFISH+ data from mouse cerebral cortex tissue. We downloaded DNA seqFISH+ data from the website <ext-link ext-link-type="uri" xlink:href="https://zenodo.org/record/4708112">https://zenodo.org/record/4708112</ext-link>, and used the file (TableS8_brain_DNAseqFISH_25kb_voxel_coordinates_2762cells.csv). Such data are originally used in the Takei et al. study<sup><xref ref-type="bibr" rid="CR10">10</xref></sup>. 2. mESC ChIP-seq data resource mESC H3K4me3 ChIP-seq data is from our previous study<sup><xref ref-type="bibr" rid="CR32">32</xref></sup>. mESC H3K27ac ChIP-seq data is downloaded from the ENCODE website: <ext-link ext-link-type="uri" xlink:href="https://www.encodeproject.org/experiments/ENCSR000CGQ/">https://www.encodeproject.org/experiments/ENCSR000CGQ/</ext-link>. mESC CTCF ChIP-seq data is downloaded from the ENCODE website: <ext-link ext-link-type="uri" xlink:href="https://www.encodeproject.org/experiments/ENCSR000CCB/">https://www.encodeproject.org/experiments/ENCSR000CCB/</ext-link>. Reference genomes We used mm10 for imaging data generated from mESCs and mouse excitatory neurons. <xref ref-type="sec" rid="Sec17">Source data</xref> are provided with this paper.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Code availability</title>
    <p>SnapFISH is freely available at <ext-link ext-link-type="uri" xlink:href="https://github.com/HuMingLab/SnapFISH">https://github.com/HuMingLab/SnapFISH</ext-link>. SnapFISH source code<sup><xref ref-type="bibr" rid="CR39">39</xref></sup> is available at <ext-link ext-link-type="uri" xlink:href="https://zenodo.org/record/8083569">https://zenodo.org/record/8083569</ext-link>.</p>
  </notes>
  <notes id="FPar2" notes-type="COI-statement">
    <title>Competing interests</title>
    <p id="Par31">B.R. is a cofounder and shareholder of Arima Genomics, Inc. and Epigenome Technologies, Inc. The remaining authors declare no competing interest.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schmitt</surname>
            <given-names>AD</given-names>
          </name>
          <name>
            <surname>Hu</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Ren</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Genome-wide mapping and analysis of chromosome architecture</article-title>
        <source>Nat. Rev. Mol. Cell Biol.</source>
        <year>2016</year>
        <volume>17</volume>
        <fpage>743</fpage>
        <lpage>755</lpage>
        <pub-id pub-id-type="doi">10.1038/nrm.2016.104</pub-id>
        <?supplied-pmid 27580841?>
        <pub-id pub-id-type="pmid">27580841</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Krijger</surname>
            <given-names>PH</given-names>
          </name>
          <name>
            <surname>de Laat</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>Regulation of disease-associated gene expression in the 3D genome</article-title>
        <source>Nat. Rev. Mol. Cell Biol.</source>
        <year>2016</year>
        <volume>17</volume>
        <fpage>771</fpage>
        <lpage>782</lpage>
        <pub-id pub-id-type="doi">10.1038/nrm.2016.138</pub-id>
        <?supplied-pmid 27826147?>
        <pub-id pub-id-type="pmid">27826147</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lieberman-Aiden</surname>
            <given-names>E</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Comprehensive mapping of long-range interactions reveals folding principles of the human genome</article-title>
        <source>Science</source>
        <year>2009</year>
        <volume>326</volume>
        <fpage>289</fpage>
        <lpage>293</lpage>
        <pub-id pub-id-type="doi">10.1126/science.1181369</pub-id>
        <?supplied-pmid 19815776?>
        <pub-id pub-id-type="pmid">19815776</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rao</surname>
            <given-names>SuhasSP</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A 3D map of the human genome at kilobase resolution reveals principles of chromatin looping</article-title>
        <source>Cell</source>
        <year>2014</year>
        <volume>159</volume>
        <fpage>1665</fpage>
        <lpage>1680</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2014.11.021</pub-id>
        <?supplied-pmid 25497547?>
        <pub-id pub-id-type="pmid">25497547</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <mixed-citation publication-type="other">Hafner, A. &amp; Boettiger, A. The spatial organization of transcriptional control. <italic>Nat. Rev. Genet</italic>10.1038/s41576-022-00526-0 (2022).</mixed-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Spatial organization of chromatin domains and compartments in single chromosomes</article-title>
        <source>Science</source>
        <year>2016</year>
        <volume>353</volume>
        <fpage>598</fpage>
        <lpage>602</lpage>
        <pub-id pub-id-type="doi">10.1126/science.aaf8084</pub-id>
        <?supplied-pmid 27445307?>
        <pub-id pub-id-type="pmid">27445307</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bintu</surname>
            <given-names>B</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Super-resolution chromatin tracing reveals domains and cooperative interactions in single cells</article-title>
        <source>Science</source>
        <year>2018</year>
        <volume>362</volume>
        <fpage>eaau1783</fpage>
        <pub-id pub-id-type="doi">10.1126/science.aau1783</pub-id>
        <?supplied-pmid 30361340?>
        <pub-id pub-id-type="pmid">30361340</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Su</surname>
            <given-names>JH</given-names>
          </name>
          <name>
            <surname>Zheng</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Kinrot</surname>
            <given-names>SS</given-names>
          </name>
          <name>
            <surname>Bintu</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Zhuang</surname>
            <given-names>X</given-names>
          </name>
        </person-group>
        <article-title>Genome-scale imaging of the 3D organization and transcriptional activity of chromatin</article-title>
        <source>Cell</source>
        <year>2020</year>
        <volume>182</volume>
        <fpage>1641</fpage>
        <lpage>1659.e1626</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2020.07.032</pub-id>
        <?supplied-pmid 32822575?>
        <pub-id pub-id-type="pmid">32822575</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Takei</surname>
            <given-names>Y</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Integrated spatial genomics reveals global architecture of single nuclei</article-title>
        <source>Nature</source>
        <year>2021</year>
        <volume>590</volume>
        <fpage>344</fpage>
        <lpage>350</lpage>
        <pub-id pub-id-type="doi">10.1038/s41586-020-03126-2</pub-id>
        <?supplied-pmid 33505024?>
        <pub-id pub-id-type="pmid">33505024</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Takei</surname>
            <given-names>Y</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell nuclear architecture across cell types in the mouse brain</article-title>
        <source>Science</source>
        <year>2021</year>
        <volume>374</volume>
        <fpage>586</fpage>
        <lpage>594</lpage>
        <pub-id pub-id-type="doi">10.1126/science.abj1966</pub-id>
        <?supplied-pmid 34591592?>
        <pub-id pub-id-type="pmid">34591592</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mateo</surname>
            <given-names>LJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Visualizing DNA folding and RNA in embryos at single-cell resolution</article-title>
        <source>Nature</source>
        <year>2019</year>
        <volume>568</volume>
        <fpage>49</fpage>
        <lpage>54</lpage>
        <pub-id pub-id-type="doi">10.1038/s41586-019-1035-4</pub-id>
        <?supplied-pmid 30886393?>
        <pub-id pub-id-type="pmid">30886393</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Multiplexed imaging of nucleome architectures in single cells of mammalian tissue</article-title>
        <source>Nat. Commun.</source>
        <year>2020</year>
        <volume>11</volume>
        <fpage>2907</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-020-16732-5</pub-id>
        <?supplied-pmid 32518300?>
        <pub-id pub-id-type="pmid">32518300</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cardozo Gizzi</surname>
            <given-names>AM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Microscopy-based chromosome conformation capture enables simultaneous visualization of genome organization and transcription in intact organisms</article-title>
        <source>Mol. Cell</source>
        <year>2019</year>
        <volume>74</volume>
        <fpage>212</fpage>
        <lpage>222.e215</lpage>
        <pub-id pub-id-type="doi">10.1016/j.molcel.2019.01.011</pub-id>
        <?supplied-pmid 30795893?>
        <pub-id pub-id-type="pmid">30795893</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nguyen</surname>
            <given-names>HQ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>3D mapping and accelerated super-resolution imaging of the human genome using in situ sequencing</article-title>
        <source>Nat. Methods</source>
        <year>2020</year>
        <volume>17</volume>
        <fpage>822</fpage>
        <lpage>832</lpage>
        <pub-id pub-id-type="doi">10.1038/s41592-020-0890-0</pub-id>
        <?supplied-pmid 32719531?>
        <pub-id pub-id-type="pmid">32719531</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Payne</surname>
            <given-names>AC</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>In situ genome sequencing resolves DNA sequence and structure in intact biological samples</article-title>
        <source>Science</source>
        <year>2021</year>
        <volume>371</volume>
        <fpage>eaay3446</fpage>
        <pub-id pub-id-type="doi">10.1126/science.aay3446</pub-id>
        <?supplied-pmid 33384301?>
        <pub-id pub-id-type="pmid">33384301</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhuang</surname>
            <given-names>X</given-names>
          </name>
        </person-group>
        <article-title>Spatially resolved single-cell genomics and transcriptomics by imaging</article-title>
        <source>Nat. Methods</source>
        <year>2021</year>
        <volume>18</volume>
        <fpage>18</fpage>
        <lpage>22</lpage>
        <pub-id pub-id-type="doi">10.1038/s41592-020-01037-8</pub-id>
        <?supplied-pmid 33408406?>
        <pub-id pub-id-type="pmid">33408406</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hu</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Chromatin tracing: imaging 3D genome and nucleome</article-title>
        <source>Trends Cell Biol.</source>
        <year>2021</year>
        <volume>31</volume>
        <fpage>5</fpage>
        <lpage>8</lpage>
        <pub-id pub-id-type="doi">10.1016/j.tcb.2020.10.006</pub-id>
        <?supplied-pmid 33191055?>
        <pub-id pub-id-type="pmid">33191055</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huang</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>CTCF mediates dosage- and sequence-context-dependent transcriptional insulation by forming local chromatin domains</article-title>
        <source>Nat. Genet</source>
        <year>2021</year>
        <volume>53</volume>
        <fpage>1064</fpage>
        <lpage>1074</lpage>
        <pub-id pub-id-type="doi">10.1038/s41588-021-00863-6</pub-id>
        <?supplied-pmid 34002095?>
        <pub-id pub-id-type="pmid">34002095</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cheng</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Hu</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>TAD-like single-cell domain structures exist on both active and inactive X chromosomes and persist under epigenetic perturbations</article-title>
        <source>Genome Biol.</source>
        <year>2021</year>
        <volume>22</volume>
        <fpage>309</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-021-02523-8</pub-id>
        <?supplied-pmid 34749781?>
        <pub-id pub-id-type="pmid">34749781</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>W</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Understanding regulatory mechanisms of brain function and disease through 3D genome organization</article-title>
        <source>Genes</source>
        <year>2022</year>
        <volume>13</volume>
        <fpage>586</fpage>
        <pub-id pub-id-type="doi">10.3390/genes13040586</pub-id>
        <?supplied-pmid 35456393?>
        <pub-id pub-id-type="pmid">35456393</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yu</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>SnapHiC: a computational pipeline to identify chromatin loops from single-cell Hi-C data</article-title>
        <source>Nat. Methods</source>
        <year>2021</year>
        <volume>18</volume>
        <fpage>1056</fpage>
        <lpage>1059</lpage>
        <pub-id pub-id-type="doi">10.1038/s41592-021-01231-2</pub-id>
        <?supplied-pmid 34446921?>
        <pub-id pub-id-type="pmid">34446921</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <mixed-citation publication-type="other">Yu, M., Li, Y. &amp; Hu, M. Mapping chromatin loops in single cells. <italic>Trends Genet</italic>10.1016/j.tig.2022.03.007 (2022).</mixed-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <mixed-citation publication-type="other">Fulco, C. P. et al. Activity-by-Contact model of enhancer specificity from thousands of CRISPR perturbations. 529990 10.1101/529990 (2019).</mixed-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dixon</surname>
            <given-names>JR</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Topological domains in mammalian genomes identified by analysis of chromatin interactions</article-title>
        <source>Nature</source>
        <year>2012</year>
        <volume>485</volume>
        <fpage>376</fpage>
        <lpage>380</lpage>
        <pub-id pub-id-type="doi">10.1038/nature11082</pub-id>
        <?supplied-pmid 22495300?>
        <pub-id pub-id-type="pmid">22495300</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Hu</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Shen</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>Gene regulation in the 3D genome</article-title>
        <source>Hum. Mol. Genet</source>
        <year>2018</year>
        <volume>27</volume>
        <fpage>R228</fpage>
        <lpage>R233</lpage>
        <pub-id pub-id-type="doi">10.1093/hmg/ddy164</pub-id>
        <?supplied-pmid 29767704?>
        <pub-id pub-id-type="pmid">29767704</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zheng</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Xie</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>The role of 3D genome organization in development and cell differentiation</article-title>
        <source>Nat. Rev. Mol. Cell Biol.</source>
        <year>2019</year>
        <volume>20</volume>
        <fpage>535</fpage>
        <lpage>550</lpage>
        <pub-id pub-id-type="doi">10.1038/s41580-019-0132-4</pub-id>
        <?supplied-pmid 31197269?>
        <pub-id pub-id-type="pmid">31197269</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mirny</surname>
            <given-names>LA</given-names>
          </name>
          <name>
            <surname>Solovei</surname>
            <given-names>I</given-names>
          </name>
        </person-group>
        <article-title>Keeping chromatin in the loop(s)</article-title>
        <source>Nat. Rev. Mol. Cell Biol.</source>
        <year>2021</year>
        <volume>22</volume>
        <fpage>439</fpage>
        <lpage>440</lpage>
        <pub-id pub-id-type="doi">10.1038/s41580-021-00337-x</pub-id>
        <?supplied-pmid 33504981?>
        <pub-id pub-id-type="pmid">33504981</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bonev</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Cavalli</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Organization and function of the 3D genome</article-title>
        <source>Nat. Rev. Genet</source>
        <year>2016</year>
        <volume>17</volume>
        <fpage>661</fpage>
        <lpage>678</lpage>
        <pub-id pub-id-type="doi">10.1038/nrg.2016.112</pub-id>
        <?supplied-pmid 27739532?>
        <pub-id pub-id-type="pmid">27739532</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Forcato</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Comparison of computational methods for Hi-C data analysis</article-title>
        <source>Nat. Methods</source>
        <year>2017</year>
        <volume>14</volume>
        <fpage>679</fpage>
        <lpage>685</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.4325</pub-id>
        <?supplied-pmid 28604721?>
        <pub-id pub-id-type="pmid">28604721</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <mixed-citation publication-type="other">Hafner, A., Park, M., Berger, S. E., Nora, E. P. &amp; Boettiger, A. N. Loop stacking organizes genome folding from TADs to chromosomes. <italic>bioRxiv</italic>, 10.1101/2022.07.13.499982 (2022).</mixed-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bonev</surname>
            <given-names>B</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Multiscale 3D genome rewiring during mouse neural development</article-title>
        <source>Cell</source>
        <year>2017</year>
        <volume>171</volume>
        <fpage>557</fpage>
        <lpage>572.e524</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2017.09.043</pub-id>
        <?supplied-pmid 29053968?>
        <pub-id pub-id-type="pmid">29053968</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Juric</surname>
            <given-names>I</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>MAPS: model-based analysis of long-range chromatin interactions from PLAC-seq and HiChIP experiments</article-title>
        <source>PLoS Comput. Biol.</source>
        <year>2019</year>
        <volume>15</volume>
        <fpage>e1006982</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1006982</pub-id>
        <?supplied-pmid 30986246?>
        <pub-id pub-id-type="pmid">30986246</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Phillips-Cremins</surname>
            <given-names>JE</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Architectural protein subclasses shape 3D organization of genomes during lineage commitment</article-title>
        <source>Cell</source>
        <year>2013</year>
        <volume>153</volume>
        <fpage>1281</fpage>
        <lpage>1295</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2013.04.053</pub-id>
        <?supplied-pmid 23706625?>
        <pub-id pub-id-type="pmid">23706625</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>Y</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>CRISPR reveals a distal super-enhancer required for Sox2 expression in mouse embryonic stem cells</article-title>
        <source>PloS One</source>
        <year>2014</year>
        <volume>9</volume>
        <fpage>e114485</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0114485</pub-id>
        <?supplied-pmid 25486255?>
        <pub-id pub-id-type="pmid">25486255</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhu</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Joint profiling of histone modifications and transcriptome in single cells from mouse brain</article-title>
        <source>Nat. Methods</source>
        <year>2021</year>
        <volume>18</volume>
        <fpage>283</fpage>
        <lpage>292</lpage>
        <pub-id pub-id-type="doi">10.1038/s41592-021-01060-3</pub-id>
        <?supplied-pmid 33589836?>
        <pub-id pub-id-type="pmid">33589836</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Winick-Ng</surname>
            <given-names>W</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Cell-type specialization is encoded by specific chromatin topologies</article-title>
        <source>Nature</source>
        <year>2021</year>
        <volume>599</volume>
        <fpage>684</fpage>
        <lpage>691</lpage>
        <pub-id pub-id-type="doi">10.1038/s41586-021-04081-2</pub-id>
        <?supplied-pmid 34789882?>
        <pub-id pub-id-type="pmid">34789882</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Arrastia</surname>
            <given-names>MV</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell measurement of higher-order 3D genome organization with scSPRITE</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2022</year>
        <volume>40</volume>
        <fpage>64</fpage>
        <lpage>73</lpage>
        <pub-id pub-id-type="doi">10.1038/s41587-021-00998-1</pub-id>
        <?supplied-pmid 34426703?>
        <pub-id pub-id-type="pmid">34426703</pub-id>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Boninsegna</surname>
            <given-names>L</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Integrative genome modeling platform reveals essentiality of rare contact events in 3D genome organizations</article-title>
        <source>Nat. Methods</source>
        <year>2022</year>
        <volume>19</volume>
        <fpage>938</fpage>
        <lpage>949</lpage>
        <pub-id pub-id-type="doi">10.1038/s41592-022-01527-x</pub-id>
        <?supplied-pmid 35817938?>
        <pub-id pub-id-type="pmid">35817938</pub-id>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <mixed-citation publication-type="other">Lee, L. SnapFISH: a computational pipeline to identify chromatin loops from multiplexed DNA FISH data. 10.5281/zenodo.8083569 (2023).</mixed-citation>
    </ref>
  </ref-list>
</back>
