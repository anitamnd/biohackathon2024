<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Genome Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">Genome Biol</journal-id>
    <journal-title-group>
      <journal-title>Genome Biology</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1474-7596</issn>
    <issn pub-type="epub">1474-760X</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">9295346</article-id>
    <article-id pub-id-type="publisher-id">2726</article-id>
    <article-id pub-id-type="doi">10.1186/s13059-022-02726-7</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Method</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Integration of single-cell multi-omics data by regression analysis on unpaired observations</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Yuan</surname>
          <given-names>Qiuyue</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-4685-811X</contrib-id>
        <name>
          <surname>Duren</surname>
          <given-names>Zhana</given-names>
        </name>
        <address>
          <email>zduren@clemson.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <aff id="Aff1"><institution-wrap><institution-id institution-id-type="GRID">grid.26090.3d</institution-id><institution-id institution-id-type="ISNI">0000 0001 0665 0280</institution-id><institution>Center for Human Genetics and Department of Genetics and Biochemistry, </institution><institution>Clemson University, </institution></institution-wrap>Greenwood, SC 29646 USA </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>19</day>
      <month>7</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>19</day>
      <month>7</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2022</year>
    </pub-date>
    <volume>23</volume>
    <elocation-id>160</elocation-id>
    <history>
      <date date-type="received">
        <day>22</day>
        <month>2</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>6</day>
        <month>7</month>
        <year>2022</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2022</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold>This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1">Despite recent developments, it is hard to profile all multi-omics single-cell data modalities on the same cell. Thus, huge amounts of single-cell genomics data of unpaired observations on different cells are generated. We propose a method named UnpairReg for the regression analysis on unpaired observations to integrate single-cell multi-omics data. On real and simulated data, UnpairReg provides an accurate estimation of cell gene expression where only chromatin accessibility data is available. The <italic>cis</italic>-regulatory network inferred from UnpairReg is highly consistent with eQTL mapping. UnpairReg improves cell type identification accuracy by joint analysis of single-cell gene expression and chromatin accessibility data.</p>
      <sec>
        <title>Supplementary Information</title>
        <p>The online version contains supplementary material available at 10.1186/s13059-022-02726-7.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Single-cell multi-omics</kwd>
      <kwd>Regression model on unpaired observations</kwd>
      <kwd><italic>Cis</italic>-regulatory network</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000057</institution-id>
            <institution>National Institute of General Medical Sciences</institution>
          </institution-wrap>
        </funding-source>
        <award-id>P20 GM139769</award-id>
        <principal-award-recipient>
          <name>
            <surname>Duren</surname>
            <given-names>Zhana</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2022</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par2">Recent advances in technology enable one to study heterogeneous mixtures of cell populations at the single-cell level. Single-cell RNA sequencing (scRNA-seq) [<xref ref-type="bibr" rid="CR1">1</xref>] provides whole-genome transcription profiling, single-cell ATAC-seq (scATAC-seq) [<xref ref-type="bibr" rid="CR2">2</xref>] identifies accessible chromatin regions, single-cell bisulfite sequencing [<xref ref-type="bibr" rid="CR3">3</xref>] measures DNA methylation, and single-cell CUT&amp;Tag [<xref ref-type="bibr" rid="CR4">4</xref>] profiles histone modifications or transcription factors all at the single-cell level. Several single-cell multi-modality sequencing technologies have been developed, such as single-cell CITE-seq [<xref ref-type="bibr" rid="CR5">5</xref>] for joint profiling of gene expression and protein expression, single-cell multiome [<xref ref-type="bibr" rid="CR6">6</xref>] for joint profiling of gene expression and chromatin accessibility, and single-cell Paired-Tag [<xref ref-type="bibr" rid="CR7">7</xref>] for joint profiling of gene expression and histone modification. However, it is difficult to observe all genomics profiles in the same single cell at the same time. One alternative way is to generate some modalities of genomics data on some cells and generate other modalities on other cells but from the same heterogeneous population.</p>
    <p id="Par3">Multi-omics analyses have been reported to provide a comprehensive understanding of cellular processes through the integration of different types of molecular data. Traditionally, expression and accessibility profiling are done separately on different sub-samples from the heterogeneous population. Huge amounts of such unpaired scRNA-seq and scATAC-seq, not profiled from the same cell, have been generated [<xref ref-type="bibr" rid="CR8">8</xref>–<xref ref-type="bibr" rid="CR13">13</xref>]. Integrative analysis of scRNA-seq with scATAC-seq could identify the subpopulations more accurately and provide more detail about the gene regulation [<xref ref-type="bibr" rid="CR14">14</xref>–<xref ref-type="bibr" rid="CR18">18</xref>]. For jointly analyzing these two types of data, all these methods require a linking function between <italic>cis</italic>-regulatory elements (REs) and target genes (TGs). For example, SOMatic [<xref ref-type="bibr" rid="CR16">16</xref>] links the RE to the nearest gene. Our previously developed methods, Coupled NMF [<xref ref-type="bibr" rid="CR18">18</xref>] and DC3 [<xref ref-type="bibr" rid="CR17">17</xref>], learn the RE-TG connection from external bulk data from diverse cellular contexts and bulk 3D chromatin contact data, respectively. Distance-based linkage is problematic as some REs do not regulate the nearest genes [<xref ref-type="bibr" rid="CR19">19</xref>]. Proper external bulk data are not always available, and the association learned from the external bulk data will omit the RE-TG relations specific to those subpopulations that have not been included in the database [<xref ref-type="bibr" rid="CR15">15</xref>]. A more general format of the linking function is using chromatin accessibility to predict gene expression. Many methods, including Seurat [<xref ref-type="bibr" rid="CR20">20</xref>] and Signac [<xref ref-type="bibr" rid="CR21">21</xref>], calculate a gene activity score for scATAC-seq cells, which was defined as the read count in the gene body and promoter region. A different version of gene activity score has been defined in Cicero [<xref ref-type="bibr" rid="CR22">22</xref>], which is a weighted sum of nearby REs where the weight is dependent on the correlation of RE and promoter accessibility; MAESTRO [<xref ref-type="bibr" rid="CR15">15</xref>] defines gene activity score as a weighted sum of nearby REs where the weight is an exponentially decreasing function of RE-TG distances; SnapATAC [<xref ref-type="bibr" rid="CR23">23</xref>] defines a gene accessibility score by smoothing the read count in the gene body [<xref ref-type="bibr" rid="CR17">17</xref>–<xref ref-type="bibr" rid="CR19">19</xref>]. An accurate linking function, RE-TG linking or a prediction of TG expression from REs, is a key to whether these methods perform well. A statistical method to learn such linking functions without using external data is in urgent need.</p>
    <p id="Par4">The main contribution of this paper is to fill this gap by the introduction of a regression model to predict the gene expression from chromatin accessibility on unpaired cells. This model allows unpaired observation of feature and response variables, say accessibility of REs are features and expression of target genes are response variables. The traditional regression model requires observation of feature variables and response variables on the same samples (we call it paired observation). Note that here we have multiple response variables and multiple feature variables. We transfer the regression problem into a covariance level quadratic equation, in which the inner products of response variables are represented as a quadratic of the inner product of feature variables. By fitting such equations, we learn the coefficient for each RE and predict gene expression of cells for which only chromatin accessibility is measured. The <italic>cis</italic>-regulation learned from this model would help understand the cell type-specific regulatory mechanism. The predicted gene expression from our model is a weighted sum of accessibility of gene nearby REs where the weights are the coefficients that we learned from the statistical model. Thus, this method should provide a much more accurate estimation of gene expression than previous methods. An accurate prediction of gene expression would increase the power of cell type identification and be useful for joint analysis.</p>
  </sec>
  <sec id="Sec2">
    <title>Results</title>
    <sec id="Sec3">
      <title>Regression analysis on unpaired observations</title>
      <p id="Par5">We propose a statistical method for integrative analysis of unpaired single-cell gene expression and chromatin accessibility data from the same tissue/context but from different cells. Our method is based on a regression model on unpaired observations, so we name it unpaired regression (UnpairReg). Figure <xref rid="Fig1" ref-type="fig">1</xref> shows the schematic overview of UnpairReg. Our goals are (1) to predict gene expression for cells for which only chromatin accessibility data is available and (2) to learn the <italic>cis</italic>-regulatory relations between regulatory elements (REs) and target genes (TGs). Let <italic>O</italic> be a <italic>n</italic><sub>1</sub> by <italic>p</italic><sub>1</sub> matrix representing chromatin accessibility on <italic>p</italic><sub>1</sub> REs for <italic>n</italic><sub>1</sub> cells from the first sample. The expression of TGs is noted in the <italic>E</italic> matrix, where <italic>E</italic> is a <italic>n</italic><sub>2</sub> by <italic>p</italic><sub>2</sub> matrix of gene expression data on <italic>p</italic><sub>2</sub> genes and <italic>n</italic><sub>2</sub> cells from the second sample. If we have both gene expression and chromatin accessibility data measured on the same cells (paired data), we can learn the RE-TG association by fitting a regression model <italic>E</italic> = <italic>Oβ</italic> + <italic>ε</italic>, where the expression of a TG is represented as a weighted sum of accessibility of REs close to this gene and the <italic>β</italic> represents the coefficients to be estimated (Fig. <xref rid="Fig1" ref-type="fig">1</xref>A). However, such a type of regression analysis is not feasible for unpaired data, where gene expression and chromatin accessibility are not measured on the same cell (Fig. <xref rid="Fig1" ref-type="fig">1</xref> B).<fig id="Fig1"><label>Fig. 1</label><caption><p>Schematic overview of UnpairReg model. <bold>A</bold> Schematic of the linear regression model based on paired chromatin accessibility and gene expression data. Gene expression level and chromatin accessibility are observed in the same cell. TG1 and TG2 are from two different genomic locations. RE1-TG1 regulation, RE5-TG2 regulation, TG1-TG2 correlation, and RE1-RE5 correlation are observed by data. <bold>B</bold> Schematic of the UnpairReg model based on unpaired data. Gene expression level is observed only for cell 1 to cell 5, while chromatin accessibility is observed for cell 6 to cell 10. TG1-TG2 correlation and RE1-RE5 correlation are observed in this data but no other significant correlation between REs and TGs. So, we infer RE1-TG1 regulation and RE5-TG2 regulation</p></caption><graphic xlink:href="13059_2022_2726_Fig1_HTML" id="MO1"/></fig></p>
      <p id="Par6">We propose UnpairReg as a method for integrative analysis of unpaired data. First, we introduce the main idea of UnpairReg by an intuitive example in Fig. <xref rid="Fig1" ref-type="fig">1</xref>. Assume that we have two strongly correlated genes, TG1 and TG2, each of which has three nearby REs denoted by {RE1, RE2, RE3} and {RE4, RE5, RE6} respectively. For chromatin accessibility data, if we observe that RE1 and RE5 have a strong correlation, but the other pairs do not correlate, then we can easily infer that the regulator of TG1 is more likely to be RE1 rather than {RE2, RE3}, and the regulator of TG2 is more likely to be RE5 rather than {RE4, RE6}.</p>
      <p id="Par7">In unpaired data, the chromatin accessibility of REs is not observed for the cells on which the gene expression is available, which we call RNA-seq cells. Thus, we cannot learn the association of RE-TG by linear regression model (Fig. <xref rid="Fig1" ref-type="fig">1</xref>B). The remaining information, RE1-RE5 and TG1-TG2 correlations, and the information on genome location are very informative in identifying the regulation of RE to TG. Fetching information of the remaining RE-RE and TG-TG correlations from covariance matrices, UnpairReg can infer the <italic>cis</italic>-regulatory information and predict gene expression for the cells for which only chromatin accessibility data is available (ATAC-seq cells). Mathematically, the gene-gene covariance matrix is a quadratic of the RE-RE covariance matrix. We transfer this linear regression problem into a regression on covariance matrix under some assumption <italic>E</italic><sup><italic>T</italic></sup><italic>E</italic> = <italic>β</italic><sup><italic>T</italic></sup><italic>O</italic><sup><italic>T</italic></sup><italic>Oβ</italic> + <italic>ε</italic><sup><italic>T</italic></sup><italic>ε</italic>, where the <italic>E</italic><sup><italic>T</italic></sup><italic>E</italic> represents the gene-gene covariance matrix, and <italic>O</italic><sup><italic>T</italic></sup><italic>O</italic> represents the RE-RE covariance matrix. This covariance regression allows us to obtain coefficients similar to the coefficients from linear regression (see the “<xref rid="Sec10" ref-type="sec">Methods</xref>” section for detail). We designed a fast algorithm for solving this problem by making full use of the sparse structure (i.e., REs on chromosome 1 do not regulate TGs on chromosome 2) of the coefficient matrix to iteratively update the coefficient of one gene at a time (see the “<xref rid="Sec10" ref-type="sec">Methods</xref>” section for detail). The estimated regression coefficients reflect the <italic>cis</italic>-regulation, and they also can be used to predict the gene expression level for the cells for which only chromatin accessibility data is available. To further improve the prediction of gene expression, we developed an optimization model to fine-tune the predicted gene expression by preserving both cell-cell covariance and gene-gene covariance in the predicted gene expression data (see the “<xref rid="Sec10" ref-type="sec">Methods</xref>” section for detail).</p>
    </sec>
    <sec id="Sec4">
      <title>Performance evaluation using in silico mixture of cells</title>
      <p id="Par8">To illustrate the efficacy of UnpairReg in <italic>cis</italic>-regulatory inference and gene expression prediction, we simulate <italic>cis</italic>-regulatory coefficients, gene expression, and chromatin accessibility data under different dropout rates (see Additional file <xref rid="MOESM1" ref-type="media">1</xref> for detail).</p>
      <p id="Par9">First, we evaluate the effectiveness of the coefficient estimation. Taking the unpaired data as input, we estimate <italic>cis</italic>-regulatory coefficients by UnpairReg. Since we know the real <italic>cis</italic>-regulatory coefficient in this simulation data, we compare the estimated coefficient with the ground truth by calculating Pearson correlation coefficients (PCC) to evaluate the coefficient estimation. Figure <xref rid="Fig2" ref-type="fig">2</xref>A shows that the PCC ranges from 0.1 to 0.4 under a 0.6 to 0.9 dropout rate, which suggests that UnpairReg estimates the coefficient accurately.<fig id="Fig2"><label>Fig. 2</label><caption><p>Performance of UnpairReg in silico mixture of cells. <bold>A</bold> PCC of UnpairReg predicted coefficient beta and real beta under different dropout rates. <bold>B</bold> The mean cell-level PCCs between predicted gene expression level and real gene expression. Cell-level PCC is PCC calculated for each cell across genes. Color in <bold>B</bold> to <bold>E</bold> indicates the different types of predicted gene expression data. Orange represents for UnpairReg predicted gene expression; blue represents observed gene expression after drop-out; grey represents random data. <bold>C</bold> The average of gene-level PCCs between predicted gene expression level and ground truth. Gene level PCC is PCC calculated for each gene across cells. <bold>D</bold> Cell-level PCC for each cell under a dropout rate of 0.87. The value labeled is the -log10 <italic>p</italic>-value of the one-sample <italic>t</italic>-test. <bold>E</bold> Gene level PCC under a dropout rate of 0.87. The value labeled is the same as <bold>D</bold>. Dropout rate is defined by the percentage of 0 in the single-cell data</p></caption><graphic xlink:href="13059_2022_2726_Fig2_HTML" id="MO2"/></fig></p>
      <p id="Par10">To evaluate the performance of gene expression prediction, we take the real gene expression data as ground truth and calculate the PCC between our prediction and ground truth. Here, we calculate PCC for each cell across genes, named cell-level PCC, as well as the gene-level PCC for each gene across cells. Taking the real gene expression data as ground truth, we compare our method with the observed gene expression data. Note that the real gene expression data is different from the observed gene expression data. They both are not observed for unpaired data. The former reflects the actual level of gene expression in every single cell and cannot be observed by sequencing technologies. The latter can be measured by single-cell multiome data (paired data), and it provides a rough estimation of the gene expression as it is affected by dropout. Figure <xref rid="Fig2" ref-type="fig">2</xref>B shows the average cell-level PCC of our method and the observed gene expression data. The average cell-level PCC of observed gene expression decreases from 0.23 to 0.11 along with the increasing dropout rate, while the PCC of the predicted gene expression drops from 0.89 to 0.78. It shows the cell-level PCCs of UnpairReg are larger than that of observed gene expression data at each dropout rate. The average gene-level PCC of observed gene expression decreases from 0.15 to 0.07 along with the increasing dropout rate, while the PCC of the predicted gene expression decreases from 0.70 to 0.48 (Fig. <xref rid="Fig2" ref-type="fig">2</xref>C). Figure <xref rid="Fig2" ref-type="fig">2</xref>D shows the boxplot of the cell-level PCC at the 0.87 dropout rate. We compare our prediction with observed gene expression data as well as randomly generated gene expression data by one-sample <italic>t</italic>-test (<italic>p</italic>-values: 10<sup>−6066</sup> and 10<sup>−7008</sup>). We perform the same comparison for gene-level PCC and observe a remarkable difference between our prediction and the other two predictions (<italic>p</italic>-values: 10<sup>−312</sup> and 10<sup>−391</sup>, Fig. <xref rid="Fig2" ref-type="fig">2</xref>E).</p>
      <p id="Par11">The simulation data described above contains an equal proportion of each cell type. We generate four other simulation datasets. One of the datasets contains random numbers of cell types, and the other three include one to three cell types with a minor population (see Additional file <xref rid="MOESM1" ref-type="media">1</xref> for detail). We observe similar results for the other four datasets (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. N1 A to F). Collectively, these results suggest that UnpairReg accurately predicts the gene expression at different dropout level data and that the prediction accuracy is even more precise than the observed data.</p>
    </sec>
    <sec id="Sec5">
      <title>Predicted gene expression from UnpairReg is consistent with the multiome data</title>
      <p id="Par12">To evaluate the accuracy of UnpairReg in predicting gene expression on actual single-cell data, we apply our method to peripheral blood mononuclear cells (PBMC) and human healthy brain tissue (HHBT) multiome data from 10X Genomics (see the “<xref rid="Sec10" ref-type="sec">Methods</xref>” section for detail). We compare UnpairReg with another gene expression prediction method named gene activity score (GAS) [<xref ref-type="bibr" rid="CR21">21</xref>]. GAS is the method used to integrate scRNA-seq and scATAC-seq in Seurat [<xref ref-type="bibr" rid="CR20">20</xref>], and it is defined as the number of fragments overlapping the gene body and a 2-kb upstream region for each gene. We will systematically compare UnpairReg-predicted gene expression with GAS.</p>
      <p id="Par13">We first evaluate the accuracy of gene expression prediction for each cell by taking the gene expression count matrix as the ground truth. Figure <xref rid="Fig3" ref-type="fig">3</xref>A and Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Fig S2A show the cell-level PCCs of all cells, in which the <italic>y</italic>-axis represents our method and the <italic>x</italic>-axis represents the GAS for PBMC and HHBT data, respectively. These results show that UnpairReg performs better for almost all cells (100% for PBMC and 99% for HHBT). For PBMC data, the average cell-level PCC is 0.55, which is 5-fold larger than the average PCC of GAS 0.11 (one-sample <italic>t</italic>-test, <italic>p</italic>-value 10<sup>−3959</sup>); for HHBT data, the average PCCs are 0.39 and 0.19 for UnpairReg and GAS (2-fold and one-sample <italic>t</italic>-test, <italic>p</italic>-value 10<sup>−734</sup>). Then, we compare the gene level PCC with GAS for all genes. UnpairReg achieves higher PCCs than GAS for 91.8% of genes for PBMC and 80.7% for HHBT. The average gene-level PCC for PBMC is 0.15, which is 4-fold higher than that of GAS (Fig. <xref rid="Fig3" ref-type="fig">3</xref>B), while the average PCC of HHBT is 0.27 (4-fold) (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Fig. S2C). Even though 4-fold increases the gene level PCCs, the actual PCCs of 0.15 and 0.27 cannot be considered as high correlations. We think one possible reason is that the ground truth data is affected by the dropout, and so it may not be able to reflect the real gene expression level. To duel with the dropout [<xref ref-type="bibr" rid="CR24">24</xref>], we impute the gene expression data and then compare our prediction with the imputed gene expression data. When we take the imputed gene expression data as ground truth, cell-level PCC and gene-level PCC increase to 0.84 and 0.47 for PBMC (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Fig. S1 A and B), while that of HHBT increases to 0.56 and 0.53 (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Fig. S2 B and D). To investigate the prediction result in detail, we choose one cell and show the pattern of observed versus predicted expression (Fig. <xref rid="Fig3" ref-type="fig">3</xref>C). The imputation may induce bias so that these PCCs may not be accurate. The real PCCs should be in the range of PCCs calculated under raw data and PCCs calculated under imputed data.<fig id="Fig3"><label>Fig. 3</label><caption><p>UnpairReg gene expression prediction is consistent with the paired data. <bold>A</bold> Cell-level PCC between the predicted and multiome gene expression. The <italic>x</italic>-axis represents the cell-level PCC between UnapirReg predicted gene expression and multiome gene expression, while the <italic>y</italic>-axis gives the cell-level PCC between GAS and multiome data. Color in <bold>A</bold> to <bold>C</bold> indicates the different methods. Orange represents for UnpairReg, and green represents GAS. <bold>B</bold> Gene-level PCC between predicted and multiome gene expression. The <italic>x</italic>-axis represents the gene-level PCC between UnapirReg predicted gene expression and multiome gene expression, while the <italic>y</italic>-axis represents the gene level PCC of GAS and multiome data. <bold>C</bold> Gene expression of multiome and UnpairReg for one gene. <italic>R</italic><sup>2</sup> is the <italic>r</italic>-squared as a goodness-of-fit measure for the linear regression model. <italic>p</italic>-value is for the <italic>F</italic>-test of linear regression. The <italic>y</italic>-axis and <italic>x</italic>-axis give predicted gene expression and log<sub>10</sub> (1 + count) in a cell. <bold>D</bold> Alignment error of predicted gene expression. For each cell, represented by the predicted gene expression vector, we compute its distance with all cells (observed gene expression). Alignment error for a cell is defined as the number of cells that have a closer distance than the true match (the same cell). <bold>E</bold> The performance metrics AUPR for UnpairReg <italic>cis</italic>-regulatory coefficients and other methods. The ground truth is the variant-gene links from eQTLGen. We divide RE-TG pairs into different groups based on the distance of RE and the TSS of TG. There are 8634, 5791, 7431, 21,282, and 33,205 RE-TG pairs in 0–3k, 3–10k, 10–20k, 20–50k, 50–100k, and 100–150k, respectively. PCC denotes the Pearson’s correlation coefficient of RE promoter. Distance denotes the decay function of the distance to the TSS; random denotes the uniform distribution. This figure corresponds to the PMBC data</p></caption><graphic xlink:href="13059_2022_2726_Fig3_HTML" id="MO3"/></fig></p>
      <p id="Par14">In addition to quantifying the accuracy of gene expression prediction for each cell by correlation, we further quantify it by alignment error, defined as the number of cells that have a closer distance than the true match (see the “<xref rid="Sec10" ref-type="sec">Methods</xref>” section for detail). Taking the gene expression count matrix as ground truth, UnpairReg achieves the lower alignment error of cells on both PBMC and HHBT datasets (Fig. <xref rid="Fig3" ref-type="fig">3</xref>D, one-sample <italic>t</italic>-test <italic>p</italic>-value 10<sup>−1027</sup> for PBMC; Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Fig. S2E, one-sample <italic>t</italic>-test <italic>p</italic>-value 10<sup>−213</sup> for HHBT). UnpairReg achieves the lower alignment error by taking the imputed data as ground truth (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Fig. S1C, one-sample <italic>t</italic>-test <italic>p</italic>-value 10<sup>−696</sup> for PBMC; Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Fig. S2F, one-sample <italic>t</italic>-test <italic>p</italic>-value 10<sup>−98</sup> for HHBT).</p>
      <p id="Par15">To evaluate UnpairReg more generally, we perform a systematical comparison, adding one more dataset, three more metrics, and three more methods for comparison. We apply our method to the embryonic E18 mouse brain (EEMB) (see the “<xref rid="Sec10" ref-type="sec">Methods</xref>” section for detail). In addition to PCC as the similarity metric, we add two similarity metrics, Spearman correlation coefficient, and cosine similarity, as well as one distance, root mean square error (RMSE). Other methods to calculate GAS include Cicero [<xref ref-type="bibr" rid="CR22">22</xref>], SnapATAC [<xref ref-type="bibr" rid="CR23">23</xref>], and MAESTRO [<xref ref-type="bibr" rid="CR15">15</xref>]. UnpairReg achieves higher similarity, lower distance (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Fig. S3 A, B, and C), and lower alignment error (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Fig. S3 D, E, and F) than other methods across all datasets. Overall, the predicted gene expression from UnpairReg is consistent with the single-cell multiome data and has much better performance than the predicted gene expression in previous studies.</p>
      <p id="Par16">To assess the ability of our method to infer <italic>cis</italic>-regulation, we calculate the consistency of the <italic>cis</italic>-regulatory coefficients with expression quantitative trait loci (eQTL) studies that link genotype variants to their target genes. We download variant-gene links defined by eQTL in whole blood from GTEx [<xref ref-type="bibr" rid="CR25">25</xref>] and eQTLGen [<xref ref-type="bibr" rid="CR26">26</xref>] and use them to validate the RE-TG prediction. As the distance between RE and TG is important for the prediction, we divide RE-TG pairs into different groups based on their distance (0–3 kb, 3–10 kb, 10–20 kb, 20–50 kb, 50–100 kb, and 100–150 kb). In each distance group, taking the eQTL data as ground truth, we computed a performance metric, area under the precision-recall curve (AUPR), by sliding the <italic>cis</italic>-regulatory score. We compared our method with a distance-based method, PCC between enhancer and promoter accessibility, and random predictions. UnpairReg achieves higher AUPR than other methods in all different distance groups (Fig. <xref rid="Fig3" ref-type="fig">3</xref>E, Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Fig. S1D). The reason for very low AUPR of PCC in the 0–3k group is that REs in the upstream 2k of TSS are considered as promoters. These results show that UnpairReg not only can accurately predict gene expression but also can provide insight into <italic>cis</italic>-regulation.</p>
    </sec>
    <sec id="Sec6">
      <title>UnpairReg predicted gene expression improves the identification of cell types</title>
      <p id="Par17">To illustrate UnpairReg’s capacity to identify the cell types or cell subpopulations, we measure whether the cluster structure embodied in the predicted gene expression data agrees with the ground truths cell type labels. Here, we use cell type annotation of PBMC data from the 10X Genomics R&amp;D team [<xref ref-type="bibr" rid="CR27">27</xref>] as ground truth. We compare our method with GAS and the observed gene expression data. We first perform principal component analysis (PCA) for the predicted or observed expression matrix to generate a reduced dimension matrix and choose 2nd to 20th PCs for further analysis (the first dimension tends to be highly correlated with the read depth) [<xref ref-type="bibr" rid="CR9">9</xref>]. Figure <xref rid="Fig4" ref-type="fig">4</xref>A–C shows the UMAP based on the PCs of UnpairReg predicted gene expression, GAS, and observed gene expression data. We find minor populations are better separated in the UnpairReg than GAS. For example, plasmacytoid DC and non-classical monocytes. In contrast, plasmacytoid DC cells are divided into two subclusters, and non-classical monocytes are mixed with intermediate in the UMAP of GAS. We also compare our results with the observed gene expression data. Figure <xref rid="Fig4" ref-type="fig">4</xref>C shows that Native CD8 T cells are mixed with naive CD4 T cells in the UMAP of observed gene expression data, but they form one separate cluster in the UMAP of UnpariReg.<fig id="Fig4"><label>Fig. 4</label><caption><p>UnpairReg enhances cell type identification. <bold>A</bold> UMAP of the predicted gene expression from UnpairReg. Color in <bold>A</bold> to <bold>E</bold> indicates the ground truth label of PBMC data. The circled cell types from left to right are non-classical monocytes, plasmacytoid DC, memory B cells, and naïve B cells, respectively. <bold>B</bold> UMAP of the gene expression predicted by GAS. <bold>C</bold> UMAP of observed gene expression from the multiome data. <bold>D</bold> Silhouette index (SI) of cells based on predicted gene expression from UnpairReg and GAS. <italic>p</italic>-value is the significant level of the one-sample <italic>t</italic>-test. <bold>E</bold> SI of cells based on UnpairReg-predicted gene expression and the observed multiome gene expression data. <italic>p</italic>-value is the same as <bold>D</bold></p></caption><graphic xlink:href="13059_2022_2726_Fig4_HTML" id="MO4"/></fig></p>
      <p id="Par18">We further evaluate the clustering result of predicted gene expression systematically by two types of clustering analysis, single modality clustering, and coupled clustering (see the “<xref rid="Sec10" ref-type="sec">Methods</xref>” section for detail). The first method is based on the predicted gene expression of ATAC-seq cells, and the second combines it with the gene expression of RNA-seq cells. For the single modality clustering method, we identify the cluster via the Louvain algorithm [<xref ref-type="bibr" rid="CR28">28</xref>] based on the reduced dimension matrix (PCs). We cluster cells based on UnpairReg predicted gene expression, GAS, observed gene expression data, and impute gene expression data, respectively. We then calculate the normalized mutual information (NMI) and Adjusted Rand Index (ARI) based on the surrogate ground truth to evaluate the clusterings. Clustering based on UnpairReg predicted gene expression achieves the highest NMI and ARI (NMI 0.742 for UnpairReg, 0.582 for GAS, 0.714 for observed, and 0.724 for imputation data; ARI 0.643 for UnpairReg, 0.441 for GAS, 0.621 for observed, and 0.469 for impute). For the coupled clustering, we perform canonical correlation analysis (CCA) on the predicted gene expression of ATAC-seq cell and the observed gene expression of RNA-seq cells. Compared with the first method, NMI and ARI of UnpairReg improve to 0.791 and 0.742, respectively, while those of GAS improve to 0.700 and 0.577.</p>
      <p id="Par19">To quantify the capacity of cell type identification, we calculate the silhouette index (SI) [<xref ref-type="bibr" rid="CR29">29</xref>] for each cell based on the top PCs (see the “<xref rid="Sec10" ref-type="sec">Methods</xref>” section for detail). A higher SI value indicates that the cell is more similar to those sharing its label than other cell types. Figure <xref rid="Fig4" ref-type="fig">4</xref>D shows that UnpairReg achieves higher SI than GAS for 84.70% of cells. The mean SI of UnpairReg (0.31) is significantly higher than GAS (0.08), with a one-sample <italic>t</italic>-test <italic>p</italic>-value 10<sup>−701</sup> and a fold change of 3.88. Figure <xref rid="Fig4" ref-type="fig">4</xref>E shows a similar result by comparing UnpairReg and observed gene expression data. UnpairReg achieves higher SI than the observed gene expression for 75.60% of cells. The average SI of UnpairReg (0.31) is 2.04-fold of the observed gene expression (0.15), and the difference is significant (one-sample <italic>t</italic>-test <italic>p</italic>-value:10<sup>−383</sup>).</p>
      <p id="Par20">We show the NMI and ARI of both single modality and coupled clustering, as well as the SI of 4 GAS score prediction methods in Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Fig. S3G. UnpairReg outperforms other methods across all metrics and all methods. Together, the predicted gene expression from UnpairReg performs better in identifying distinctive cell types than the GAS and the observed gene expression data.</p>
    </sec>
    <sec id="Sec7">
      <title>UnpairReg improves co-embedding of gene expression and chromatin accessibility</title>
      <p id="Par21">Co-embedding of scRNA-seq and unpaired scATAC-seq data helps to match the cells from these two sources, identify the subpopulations, and reveal cell type-specific regulatory networks. To perform co-embedding of unpaired gene expression and chromatin accessibility data, we propose a procedure based on UnpairReg and CoupledNMF [<xref ref-type="bibr" rid="CR18">18</xref>]. We first run UnpairReg to obtain the cis-regulatory coefficients and run CoupledNMF by taking the <italic>cis</italic>-regulatory coefficient as the coupling matrix (see the “<xref rid="Sec10" ref-type="sec">Methods</xref>” section). To validate the performance of this procedure in subpopulation identification and to remove batch variation between data types, we apply our method to unpaired single-cell data from the primary bone marrow mononuclear cells (BMMC) population. The annotation of cell labels of this data is generated based on the cell type markers from bulk data analysis [<xref ref-type="bibr" rid="CR30">30</xref>]. We compare the results with Seurat V3 co-embedding analysis [<xref ref-type="bibr" rid="CR20">20</xref>], which links ATAC-seq cells with RNA-seq cells via canonical correlation analysis (CCA) based on GAS and gene expression data.</p>
      <p id="Par22">We first assess the performance of co-embedding at removing batch variation (RNA-seq and ATAC-seq) by graph connectivity (GC) [<xref ref-type="bibr" rid="CR31">31</xref>] score, which ranges from 0 to 1 (see the “<xref rid="Sec10" ref-type="sec">Methods</xref>” section for detail). A larger GC suggests cells of the same cell type from RNA-seq and ATAC-seq are close to one another in the co-embedding. From the co-embedding visualizations in Fig. <xref rid="Fig5" ref-type="fig">5</xref>A and C via UMAP and GC score, our method performs better in batch mixing.<fig id="Fig5"><label>Fig. 5</label><caption><p>UnpairReg improves co-embedding of gene expression and chromatin accessibility. <bold>A</bold>, <bold>B</bold> UMAP of CoupledNMF co-embedding. Color in <bold>A</bold> and <bold>C</bold> indicates the data type of cells. Color in <bold>B</bold> and <bold>D</bold> indicates cell type of ground truth for the BMMC population. <bold>C</bold>, <bold>D</bold> UMAP of Seurat co-embedding. <bold>E</bold> Sankey plot for subpopulations of CoupledNMF, ground truth, and Seurat. Small subpopulations including Mono, HSC, CD8, GMP, and MEP are merged into the “Others” cluster</p></caption><graphic xlink:href="13059_2022_2726_Fig5_HTML" id="MO5"/></fig></p>
      <p id="Par23">To assess the clustering performance, we compare the clustering labels with the surrogate ground truth labels by calculating normalized mutual information (NMI) and Adjusted Rand Index (ARI) [<xref ref-type="bibr" rid="CR32">32</xref>]. Figure <xref rid="Fig5" ref-type="fig">5</xref>B and D show the corresponding UMAPs colored by the surrogate ground truth labels. Our method achieves an NMI of 0.727 and ARI of 0.769, which are much higher than that of Seurat (NMI = 0.688, ARI = 0.704). To visualize the mapping of clustering labels and the ground truth, we use the Sankey plot to compare three labels: the Seurat label, ground truth labels, and our labels (Fig. <xref rid="Fig5" ref-type="fig">5</xref>E). To make the plot clear, we merge the 7 different progenitors’ cells (CLP, CMP, GMP, HSC, LMPP, MEP, MPP) into one cell type named progenitors cells in the ground truth since the proportion of those cells is very small and cannot be detected by current methods. Most of the CD4 cells in the surrogate ground truth map to cluster 0 and cluster 1 by Seurat and our method, respectively. In Seurat, 15.34% of CD4 RNA-seq cells are mismatched to other clusters, while this percentage in our method is 8.90%. In Addition, 67.02% of progenitor cells are mapped to cluster 6 in our method (76.47% for RNA-seq cells and 61.75% for ATAC-seq cells), while these cells are scattered in all Seurat clustering. Overall, UnpairReg identifies the clusters with higher accuracy.</p>
    </sec>
  </sec>
  <sec id="Sec8">
    <title>Discussion</title>
    <p id="Par24">This paper proposes a linear regression model, UnpairReg, allowing unpaired observation of feature and response variables. We apply UnpairReg to unpaired single-cell genomic data and utilize RE-RE and TG-TG correlations to infer <italic>cis</italic>-regulation and predict gene expression. Both simulation studies and real data analysis show that UnpairReg effectively recovers enhancer-target gene regulation and accurately predicts the gene expression. Predicted gene expression from UnpairReg is consistent with the multiome data. The inferred <italic>cis</italic>-regulation provides an accurate RE-TG connection for co-embedding analysis. The results show superior accuracy and robustness of UnpairReg.</p>
    <p id="Par25">From the machine learning point of view, the linear regression model using paired data to predict gene expression belongs to supervised learning, in which the feature is chromatin accessibility, and the label is gene expression. For supervised learning, features and labels are accessible for each sample. Current gene expression estimation methods, such as gene activity score, only use the chromatin accessibility data. These methods belong to unsupervised learning, in which the data is not labelled. UnpairReg falls between unsupervised and supervised learning. In detail, for each cell (sample) from scATAC-seq data, chromatin accessibility (feature) is accessible, but gene expression (label) is not accessible. For each sample in single-cell RNA-seq data, the label is accessible, but the feature is not. Taking the advantage of the input data having multiple response variables and features, UnpairReg solves this problem by building the connection between the covariance matrices of response variables and features.</p>
    <p id="Par26">At last, we discuss the limitation of our method. UnpairReg is based on the assumption that the expression of different genes is independent under the condition of REs accessibility given. But some transcription factors could regulate some target genes without changing the accessibility of REs. For those target genes, this assumption does not hold anymore, which may cause bias. The validation results reported above show that our method is already useful for many types of inference and predictions despite this. Thus, we expect that the independence assumption will not cause serious bias in the application of this method. Another limitation is that there are dropouts in the observed (raw) data. To generate data with fewer dropouts, we impute the data and use the imputation data as ground truth for several analyses. However, imputation might induce bias, although we use a naïve method to impute the raw data to avoid bias.</p>
  </sec>
  <sec id="Sec9">
    <title>Conclusions</title>
    <p id="Par27">As a linear regression-based model, UnpairReg remarkably allows unpaired observation of feature and response variables. As an integrative analysis of single-cell unpaired multi-omics data where different modalities are measured on different cells, UnpairReg yields the gene expression prediction and the <italic>cis</italic>-regulatory network of REs and TGs. Taking the single-cell RNA-seq data as ground truth, we compare the mean cell-level PCC and the gene-level PCC of UnpairReg and the other four methods across three datasets. The predicted gene expression from UnpairReg is about 1.67–9.93-fold (cell-level PCC) and 1.12–5.78 (gene-level PCC) fold more accurate than the widely used gene activity score, offering a good method to obtain gene expression and chromatin accessibility on the same cell. The inferred <italic>cis</italic>-regulatory network from UnpairReg serves as an accurate linking function of REs and TGs for a multitude of integrative analysis methods of scRNA-seq with scATAC-seq. Therefore, UnpairReg expands the opportunities in single-cell integration.</p>
  </sec>
  <sec id="Sec10">
    <title>Methods</title>
    <sec id="Sec11">
      <title>UnpairReg model</title>
      <p id="Par28">UnpairReg attempts to perform linear regression on the unpaired data. In the classical linear regression model, both predictors and responses are observed for each sample. We call such data paired data. Here, unpaired data allows missing predictors or responses for some samples. None of the samples has the simultaneous observation of predictor and response variables. Unpaired single-cell RNA-seq and ATAC-seq data is a good example, missing gene expression or chromatin accessibility for each cell.</p>
      <p id="Par29">We describe the UnpairReg model based on the unpaired single-cell data. Let <italic>O</italic> be a <italic>n</italic><sub>1</sub> by <italic>p</italic><sub>1</sub> matrix representing chromatin accessibility on <italic>p</italic><sub>1</sub> REs for <italic>n</italic><sub>1</sub> cells from the first sample. The expression of TGs is noted in the <italic>E</italic> matrix, where <italic>E</italic> is a <italic>n</italic><sub>2</sub> by <italic>p</italic><sub>2</sub> matrix of gene expression data on <italic>p</italic><sub>2</sub> genes and <italic>n</italic><sub>2</sub> cells from the second sample. For paired data, we can use the following linear regression model.<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$E=\ O\beta+\varepsilon$$\end{document}</tex-math><mml:math id="M2" display="block"><mml:mrow><mml:mi>E</mml:mi><mml:mo>=</mml:mo><mml:mspace width="4pt"/><mml:mi>O</mml:mi><mml:mi>β</mml:mi><mml:mo>+</mml:mo><mml:mi>ε</mml:mi></mml:mrow></mml:math><graphic xlink:href="13059_2022_2726_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula>where <italic>β</italic> is the regression coefficient, and <italic>ε</italic> is the error term. This model does not work for unpaired data, due to the <italic>n</italic><sub>1</sub> cells and <italic>n</italic><sub>2</sub> cells being mismatched.</p>
      <p id="Par30">We transfer this linear regression problem (<xref rid="Equ1" ref-type="">1</xref>) into a regression on the covariance matrix under an assumption of the expression of different genes is an independent column under the accessibility of REs given.<disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{E}^{T}}E={{\beta}^{T}}{O^{T}}O\beta +{{\varepsilon}^{T}}\varepsilon$$\end{document}</tex-math><mml:math id="M4" display="block"><mml:mrow><mml:msup><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:mi>E</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:msup><mml:mi>O</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mi>O</mml:mi><mml:mi>β</mml:mi><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mi>ε</mml:mi></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:mi>ε</mml:mi></mml:mrow></mml:math><graphic xlink:href="13059_2022_2726_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula>where the <italic>E</italic><sup><italic>T</italic></sup><italic>E</italic> represents the gene-gene covariance matrix if each gene is normalized to 0 across cells, and <italic>O</italic><sup><italic>T</italic></sup><italic>O</italic> represents the RE-RE covariance matrix if each RE is normalized.</p>
      <p id="Par31">Due to the <italic>cis</italic>-regulation decays along with the increase of genomic distance [<xref ref-type="bibr" rid="CR33">33</xref>], the elements of <italic>β</italic> which represent RE-TG regulations should also decay following the distance. Thus, we add the regularization form to penalize the long-distance regulation by an exponential transform of the distance matrix as follows.<disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\underset{\upbeta}{\min }{\left\Vert {E}^{T}E-{\beta}^{T}{O}^{T} O\beta \right\Vert}^{2}+\lambda {\left\Vert {A}^{\ast}\beta \right\Vert}^{2}$$\end{document}</tex-math><mml:math id="M6" display="block"><mml:mrow><mml:munder><mml:mo movablelimits="false">min</mml:mo><mml:mi mathvariant="normal">β</mml:mi></mml:munder><mml:msup><mml:mrow><mml:mfenced close="∥" open="∥"><mml:msup><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:mi>E</mml:mi><mml:mo>-</mml:mo><mml:msup><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:msup><mml:mrow><mml:mi>O</mml:mi></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:mi>O</mml:mi><mml:mi>β</mml:mi></mml:mfenced></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:mi>λ</mml:mi><mml:msup><mml:mrow><mml:mfenced close="∥" open="∥"><mml:msup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mo>*</mml:mo></mml:msup><mml:mi>β</mml:mi></mml:mfenced></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math><graphic xlink:href="13059_2022_2726_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula>Here, <inline-formula id="IEq1"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${A}_{ij}=\exp \left(\frac{d_{ij}}{d_0}\right)$$\end{document}</tex-math><mml:math id="M8"><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>exp</mml:mo><mml:mfenced close=")" open="("><mml:mfrac><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>d</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mfrac></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="13059_2022_2726_Article_IEq1.gif"/></alternatives></inline-formula> is an <italic>p</italic><sub>1</sub> × <italic>p</italic><sub>2</sub> matrix for regularizing <italic>β</italic>; <italic>d</italic><sub><italic>ij</italic></sub> is the distance between the <italic>i</italic>th RE and the <italic>j</italic>th TG (infinity for different chromosomes); * denotes Hadamard product. To avoid the spurious RE-TG regulatory on different chromosomes or far apart on the same chromosome, <italic>β</italic><sub><italic>ij</italic></sub> is fixed to 0 if <italic>d</italic><sub><italic>ij</italic></sub> is larger than a given distance <italic>D</italic><sub>0</sub> (200k in our study).</p>
    </sec>
    <sec id="Sec12">
      <title>Algorithm</title>
      <p id="Par32">We design a fast linear approximation algorithm for UnpairReg, taking into account the high sparsity of the <italic>cis</italic>-regulatory coefficient. We update <italic>β</italic> for one gene at a time (correspond to one column), just using the nearby REs. For one gene this step is to solve a linear ridge regression model with dozens of explanatory variables. The input of our algorithm is 4 matrices, scRNA-seq <italic>E</italic>, scATAC-seq <italic>O</italic>, <italic>cis</italic>-regulatory coefficient <italic>β</italic><sub>0</sub>, and the distance between genes and REs <italic>D</italic>. The output is <italic>cis</italic>-regulatory coefficient and paired gene expression. Additionally, there are 2 tuning parameters, <italic>λ</italic> and <italic>d</italic><sub>0</sub>, which have the default value of <italic>λ</italic> = 10<sup>7</sup>and <italic>d</italic><sub>0</sub> = 10000 in this study.</p>
      <p id="Par33">We solve β by an iteration algorithm.</p>
      <p id="Par34">Let <italic>β</italic> = <italic>β</italic><sub>0</sub>, <inline-formula id="IEq2"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${A}_{ij}=\exp \left(\frac{d_{ij}}{d_0}\right)$$\end{document}</tex-math><mml:math id="M10"><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>exp</mml:mo><mml:mfenced close=")" open="("><mml:mfrac><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>d</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mfrac></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="13059_2022_2726_Article_IEq2.gif"/></alternatives></inline-formula>, <italic>X</italic> = <italic>β</italic><sup><italic>T</italic></sup><italic>O</italic><sup><italic>T</italic></sup><italic>O</italic>, and <italic>Y</italic> = <italic>E</italic><sup><italic>T</italic></sup><italic>E</italic>. Then, the quadratic equation <italic>E</italic><sup><italic>T</italic></sup><italic>E</italic> = <italic>β</italic><sup><italic>T</italic></sup><italic>O</italic><sup><italic>T</italic></sup><italic>Oβ</italic> can be transformed into linear equation <italic>Y</italic> = <italic>Xβ</italic>.</p>
      <p id="Par35">For each gene, we renew the corresponding column of <italic>β</italic>. Note <italic>β</italic><sub><italic>ij</italic></sub> is fixed to 0, if <italic>d</italic><sub><italic>ij</italic></sub> is greater than the given distance <italic>D</italic><sub>0</sub> (200 kbp in our study). Thus, instead of using all columns of <italic>X</italic> and <italic>A</italic>, we only retain the enhancers nearby the gene. We denoted the set of nearby enhancers of the <italic>j</italic>th gene as <italic>S</italic><sub><italic>j</italic></sub>, the corresponding columns of <italic>X</italic> as <inline-formula id="IEq3"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hat{x}\ \left({X}_{.,{S}_j}\right)$$\end{document}</tex-math><mml:math id="M12"><mml:mrow><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mspace width="4pt"/><mml:mfenced close=")" open="("><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="13059_2022_2726_Article_IEq3.gif"/></alternatives></inline-formula>, and corresponding rows of the <italic>j</italic>th gene of <italic>A</italic> as <inline-formula id="IEq4"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hat{a}\ \left({A}_{S_j,j}\right)$$\end{document}</tex-math><mml:math id="M14"><mml:mrow><mml:mover accent="true"><mml:mi>a</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mspace width="4pt"/><mml:mfenced close=")" open="("><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="13059_2022_2726_Article_IEq4.gif"/></alternatives></inline-formula>. We renew the <italic>j</italic>th column and the rows of nearby enhancers of <italic>β</italic> as <inline-formula id="IEq5"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\left({\hat{x}}^T\hat{x}+\lambda {\hat{a}}^T\hat{a}\right)}^{-1}{\hat{x}}^T{Y}_{.,j}$$\end{document}</tex-math><mml:math id="M16"><mml:mrow><mml:msup><mml:mrow><mml:mfenced close=")" open="("><mml:msup><mml:mrow><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>+</mml:mo><mml:mi>λ</mml:mi><mml:msup><mml:mrow><mml:mover accent="true"><mml:mi>a</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:mover accent="true"><mml:mi>a</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mfenced></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13059_2022_2726_Article_IEq5.gif"/></alternatives></inline-formula>. Afterward, we renew the <italic>j</italic>th row of <italic>X</italic> with <italic>β</italic><sub>.<italic>j</italic></sub> by <inline-formula id="IEq6"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${X}_j.={\beta}_{.j}^T{O}^TO$$\end{document}</tex-math><mml:math id="M18"><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>.</mml:mo><mml:mo>=</mml:mo><mml:msubsup><mml:mi>β</mml:mi><mml:mrow><mml:mo>.</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mi>T</mml:mi></mml:msubsup><mml:msup><mml:mrow><mml:mi>O</mml:mi></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:mi>O</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13059_2022_2726_Article_IEq6.gif"/></alternatives></inline-formula>.</p>
      <p id="Par36">Specify a finite number of iterations and repeat step (<xref rid="Equ2" ref-type="">2</xref>) and finally obtain <italic>β</italic>.</p>
      <p id="Par37">Predict paired gene expression <inline-formula id="IEq7"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hat{E}= O\beta$$\end{document}</tex-math><mml:math id="M20"><mml:mrow><mml:mover accent="true"><mml:mi>E</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mi>O</mml:mi><mml:mi>β</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13059_2022_2726_Article_IEq7.gif"/></alternatives></inline-formula>.</p>
    </sec>
    <sec id="Sec13">
      <title>Data pre-processing</title>
      <p id="Par38">We filter genes and REs only being active in less than 1% of cells of <italic>E</italic> and <italic>O</italic> matrix, and then, we impute these two matrices for each cell by averaging <italic>K</italic> nearest cell (<italic>K</italic> is 100 in our study). To measure the distance between cells, we use PCA to generate a lower-dimensional representation of the cells and compute the Euclidean distance by only retaining the 2nd through 20th dimensions (the first dimension tends to be highly correlated with the read depth) [<xref ref-type="bibr" rid="CR9">9</xref>]. We also denoted the gene expression and chromatin accessibility matrix after pre-processing as <italic>E</italic> and <italic>O</italic> respectively.</p>
    </sec>
    <sec id="Sec14">
      <title>Initialize cis-regulatory coefficient</title>
      <p id="Par39">To initialize the <italic>cis</italic>-regulatory coefficient, we sketchily estimate the gene expression matrix paired with the ATAC-seq and then compute the initialization of the <italic>cis</italic>-regulatory coefficient by solving (<xref rid="Equ1" ref-type="">1</xref>).</p>
      <p id="Par40">We estimate gene expression <inline-formula id="IEq8"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\hat{E}}_{k_1j}$$\end{document}</tex-math><mml:math id="M22"><mml:msub><mml:mover accent="true"><mml:mi>E</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2022_2726_Article_IEq8.gif"/></alternatives></inline-formula> for the cell <italic>k</italic><sub>1</sub> and the gene <italic>j</italic> by a combination of the mean expression of gene <italic>j</italic> and relative cell depth of <italic>k</italic><sub>1</sub>:<disp-formula id="Equ4"><label>4</label><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\hat{E}}_{k_{1}j}=\frac{\exp\left(\frac{10}{M}\sum_{i=1}^{p_{1}}{\mathbf{1}}_{\left(\mathbf{0},+\infty\right)}\left({O}_{k_{1}i}\right)\right)}{\frac{1}{n_{1}}\sum_{k=1}^{n_{1}}\exp\left(\frac{10}{M}\sum_{i=1}^{p_{1}}{\mathbf{1}}_{\left(\mathbf{0},+\infty \right)}\left({O}_{ki}\right)\right)}\frac{1}{n_{2}}{\sum_{k=1}^{n_{2}}{E}_{kj}}$$\end{document}</tex-math><mml:math id="M24" display="block"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>E</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo>exp</mml:mo><mml:mfenced close=")" open="("><mml:mfrac><mml:mn>10</mml:mn><mml:mi>M</mml:mi></mml:mfrac><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:msubsup><mml:msub><mml:mn mathvariant="bold">1</mml:mn><mml:mfenced close=")" open="("><mml:mn mathvariant="bold">0</mml:mn><mml:mo>,</mml:mo><mml:mo>+</mml:mo><mml:mi>∞</mml:mi></mml:mfenced></mml:msub><mml:mfenced close=")" open="("><mml:msub><mml:mi>O</mml:mi><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mfenced></mml:mfenced></mml:mrow><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mfrac><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:msubsup><mml:mo>exp</mml:mo><mml:mfenced close=")" open="("><mml:mfrac><mml:mn>10</mml:mn><mml:mi>M</mml:mi></mml:mfrac><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:msubsup><mml:msub><mml:mn mathvariant="bold">1</mml:mn><mml:mfenced close=")" open="("><mml:mn mathvariant="bold">0</mml:mn><mml:mo>,</mml:mo><mml:mo>+</mml:mo><mml:mi>∞</mml:mi></mml:mfenced></mml:msub><mml:mfenced close=")" open="("><mml:msub><mml:mi>O</mml:mi><mml:mrow><mml:mi mathvariant="italic">ki</mml:mi></mml:mrow></mml:msub></mml:mfenced></mml:mfenced></mml:mrow></mml:mfrac><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mfrac><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:munderover><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi mathvariant="italic">kj</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math><graphic xlink:href="13059_2022_2726_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq9"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf{1}}_{\boldsymbol{A}}\left(\boldsymbol{x}\right)=\left\{\begin{array}{l}1, if\ x\in A\\ {}0, else\end{array}\right.$$\end{document}</tex-math><mml:math id="M26"><mml:mrow><mml:msub><mml:mn mathvariant="bold">1</mml:mn><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mfenced open="{"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mi>f</mml:mi><mml:mspace width="4pt"/><mml:mi>x</mml:mi><mml:mo>∈</mml:mo><mml:mi>A</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mrow/><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>e</mml:mi><mml:mi>l</mml:mi><mml:mi>s</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="13059_2022_2726_Article_IEq9.gif"/></alternatives></inline-formula>; <inline-formula id="IEq10"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sum_{i=1}^{p_1}{\mathbf{1}}_{\left(\mathbf{0},+\infty \right)}\left({O}_{k_1i}\right)$$\end{document}</tex-math><mml:math id="M28"><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:msubsup><mml:msub><mml:mn mathvariant="bold">1</mml:mn><mml:mfenced close=")" open="("><mml:mn mathvariant="bold">0</mml:mn><mml:mo>,</mml:mo><mml:mo>+</mml:mo><mml:mi>∞</mml:mi></mml:mfenced></mml:msub><mml:mfenced close=")" open="("><mml:msub><mml:mi>O</mml:mi><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="13059_2022_2726_Article_IEq10.gif"/></alternatives></inline-formula> is the number of nonzero REs in cell <italic>k</italic><sub>1</sub>, denoting the cell depth. We transform this value to <inline-formula id="IEq11"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\exp \left(\frac{10}{M}\sum_{i=1}^{p_1}{\mathbf{1}}_{\left(\mathbf{0},+\infty \right)}\left({O}_{k_1i}\right)\right)$$\end{document}</tex-math><mml:math id="M30"><mml:mrow><mml:mo>exp</mml:mo><mml:mfenced close=")" open="("><mml:mfrac><mml:mn>10</mml:mn><mml:mi>M</mml:mi></mml:mfrac><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:msubsup><mml:msub><mml:mn mathvariant="bold">1</mml:mn><mml:mfenced close=")" open="("><mml:mn mathvariant="bold">0</mml:mn><mml:mo>,</mml:mo><mml:mo>+</mml:mo><mml:mi>∞</mml:mi></mml:mfenced></mml:msub><mml:mfenced close=")" open="("><mml:msub><mml:mi>O</mml:mi><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mfenced></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="13059_2022_2726_Article_IEq11.gif"/></alternatives></inline-formula> by an exponential transformation, also denoting a metric of cell depth; <inline-formula id="IEq12"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\frac{1}{n_1}\sum_{k=1}^{n_1}\exp \left(\frac{10}{M}\sum_{i=1}^{p_1}{\mathbf{1}}_{\left(\mathbf{0},+\infty \right)}\left({O}_{ki}\right)\right)$$\end{document}</tex-math><mml:math id="M32"><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mfrac><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:msubsup><mml:mo>exp</mml:mo><mml:mfenced close=")" open="("><mml:mfrac><mml:mn>10</mml:mn><mml:mi>M</mml:mi></mml:mfrac><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:msubsup><mml:msub><mml:mn mathvariant="bold">1</mml:mn><mml:mfenced close=")" open="("><mml:mn mathvariant="bold">0</mml:mn><mml:mo>,</mml:mo><mml:mo>+</mml:mo><mml:mi>∞</mml:mi></mml:mfenced></mml:msub><mml:mfenced close=")" open="("><mml:msub><mml:mi>O</mml:mi><mml:mrow><mml:mi mathvariant="italic">ki</mml:mi></mml:mrow></mml:msub></mml:mfenced></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="13059_2022_2726_Article_IEq12.gif"/></alternatives></inline-formula> denotes the mean cell depth. Therefore, <inline-formula id="IEq13"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\frac{\exp \left(\frac{10}{M}\sum_{i=1}^{p_1}{\mathbf{1}}_{\left(\mathbf{0},+\infty \right)}\left({O}_{k_1i}\right)\right)}{\frac{1}{n_1}\sum_{k=1}^{n_1}\exp \left(\frac{10}{M}\sum_{i=1}^{p_1}{\mathbf{1}}_{\left(\mathbf{0},+\infty \right)}\left({O}_{ki}\right)\right)}$$\end{document}</tex-math><mml:math id="M34"><mml:mfrac><mml:mrow><mml:mo>exp</mml:mo><mml:mfenced close=")" open="("><mml:mfrac><mml:mn>10</mml:mn><mml:mi>M</mml:mi></mml:mfrac><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:msubsup><mml:msub><mml:mn mathvariant="bold">1</mml:mn><mml:mfenced close=")" open="("><mml:mn mathvariant="bold">0</mml:mn><mml:mo>,</mml:mo><mml:mo>+</mml:mo><mml:mi>∞</mml:mi></mml:mfenced></mml:msub><mml:mfenced close=")" open="("><mml:msub><mml:mi>O</mml:mi><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mfenced></mml:mfenced></mml:mrow><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mfrac><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:msubsup><mml:mo>exp</mml:mo><mml:mfenced close=")" open="("><mml:mfrac><mml:mn>10</mml:mn><mml:mi>M</mml:mi></mml:mfrac><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:msubsup><mml:msub><mml:mn mathvariant="bold">1</mml:mn><mml:mfenced close=")" open="("><mml:mn mathvariant="bold">0</mml:mn><mml:mo>,</mml:mo><mml:mo>+</mml:mo><mml:mi>∞</mml:mi></mml:mfenced></mml:msub><mml:mfenced close=")" open="("><mml:msub><mml:mi>O</mml:mi><mml:mrow><mml:mi mathvariant="italic">ki</mml:mi></mml:mrow></mml:msub></mml:mfenced></mml:mfenced></mml:mrow></mml:mfrac></mml:math><inline-graphic xlink:href="13059_2022_2726_Article_IEq13.gif"/></alternatives></inline-formula> is a fold change, denoting the relative cell depth of cell <italic>k</italic><sub>1</sub>; <inline-formula id="IEq14"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\frac{1}{n_2}\sum_{k=1}^{n_2}{E}_{kj}$$\end{document}</tex-math><mml:math id="M36"><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mfrac><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:msubsup><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi mathvariant="italic">kj</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13059_2022_2726_Article_IEq14.gif"/></alternatives></inline-formula> denotes the mean expression of the cell <italic>j</italic>. The rationale here is combining the mean expression level for each gene from RNA-seq data and the expression level for each cell (cell depth) from ATAC-seq data to predict gene expression in ATAC-seq data. Then, we perform linear regression based on the predicted gene expression and the imputed chromatin accessibility matrix <italic>O</italic>, and generate <italic>β</italic><sub>0</sub> as the initial value of the regulatory matrix. <italic>β</italic><sub>0</sub> is given by <inline-formula id="IEq15"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\beta}_0={\left({O}^TO\right)}^{-1}{(O)}^T\hat{E}$$\end{document}</tex-math><mml:math id="M38"><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mfenced close=")" open="("><mml:msup><mml:mrow><mml:mi>O</mml:mi></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:mi>O</mml:mi></mml:mfenced></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>O</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:mover accent="true"><mml:mi>E</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:math><inline-graphic xlink:href="13059_2022_2726_Article_IEq15.gif"/></alternatives></inline-formula>.
</p>
    </sec>
    <sec id="Sec15">
      <title>Fine-tuning of gene expression</title>
      <p id="Par41">We have gained the predicted gene expression from the algorithm above based on the gene-gene covariance and RE-RE covariance. To improve the gene expression in preserving both cell-cell covariance and gene-gene covariance better, we developed an optimization model to fine-tune the predicted gene expression further. We design an optimization model to find a fine-tuned gene expression X, so that the predicted gene-gene covariance (<italic>X</italic><sup><italic>T</italic></sup><italic>X</italic>) is the same with the real gene-gene covariance (<italic>R</italic><sub>1</sub>), and meanwhile, the predicted RE-RE covariance (<italic>XX</italic><sup><italic>T</italic></sup>) is the same with the real one:<disp-formula id="Equ5"><label>5</label><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\underset{\mathrm{X}}{\min}\left\Vert {R}_1-{X}^TX\right\Vert {}_F{}^2+{\lambda}_1\left\Vert {R}_2-{XX}^T\right\Vert {}_F{}^2$$\end{document}</tex-math><mml:math id="M40" display="block"><mml:mrow><mml:munder><mml:mo movablelimits="false">min</mml:mo><mml:mi mathvariant="normal">X</mml:mi></mml:munder><mml:mfenced close="∥" open="∥"><mml:msub><mml:mi>R</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:mi>X</mml:mi></mml:mfenced><mml:msub><mml:mrow/><mml:mi>F</mml:mi></mml:msub><mml:msup><mml:mrow/><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mfenced close="∥" open="∥"><mml:msub><mml:mi>R</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="italic">XX</mml:mi></mml:mrow><mml:mi>T</mml:mi></mml:msup></mml:mfenced><mml:msub><mml:mrow/><mml:mi>F</mml:mi></mml:msub><mml:msup><mml:mrow/><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math><graphic xlink:href="13059_2022_2726_Article_Equ5.gif" position="anchor"/></alternatives></disp-formula>Here, <inline-formula id="IEq16"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\left\Vert {R}_1-{X}^TX\right\Vert}_F^2$$\end{document}</tex-math><mml:math id="M42"><mml:msubsup><mml:mfenced close="∥" open="∥"><mml:msub><mml:mi>R</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:mi>X</mml:mi></mml:mfenced><mml:mi>F</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2022_2726_Article_IEq16.gif"/></alternatives></inline-formula> aims to preserve gene-gene covariance, where <inline-formula id="IEq17"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${R}_1=\frac{n_1}{n_2}{E}^TE$$\end{document}</tex-math><mml:math id="M44"><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mfrac><mml:msup><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:mi>E</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13059_2022_2726_Article_IEq17.gif"/></alternatives></inline-formula> is the gene-gene covariance, defined by <italic>E</italic><sup><italic>T</italic></sup><italic>E</italic> timing a scaling factor, the ratio of the number of cells, to eliminate the gap of cell number between RNA-seq and ATAC-seq, matching the scale of <italic>E</italic><sup><italic>T</italic></sup><italic>E</italic> and <italic>X</italic><sup><italic>T</italic></sup><italic>X</italic>. <inline-formula id="IEq18"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\left\Vert {R}_2-X{X}^T\right\Vert}_F^2$$\end{document}</tex-math><mml:math id="M46"><mml:msubsup><mml:mfenced close="∥" open="∥"><mml:msub><mml:mi>R</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:mi>X</mml:mi><mml:msup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mi>T</mml:mi></mml:msup></mml:mfenced><mml:mi>F</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2022_2726_Article_IEq18.gif"/></alternatives></inline-formula> aims to preserve cell-cell covariance, where <inline-formula id="IEq19"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${R}_2=\frac{\mu_2}{\mu 1}O{O}^T$$\end{document}</tex-math><mml:math id="M48"><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi>μ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mrow><mml:mi>μ</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:mfrac><mml:mi>O</mml:mi><mml:msup><mml:mrow><mml:mi>O</mml:mi></mml:mrow><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="13059_2022_2726_Article_IEq19.gif"/></alternatives></inline-formula> is the cell-cell covariance, defined by <italic>OO</italic><sup><italic>T</italic></sup> timing another scaling factor the ratio of the mean of <italic>EE</italic><sup><italic>T</italic></sup> and <italic>OO</italic><sup><italic>T</italic></sup> to eliminate the difference of data type. <italic>λ</italic><sub>1</sub> is a tuning parameter to weight the two objectives. The scaling factor is introduced. We design a fixed point iterative algorithm, taking <inline-formula id="IEq20"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hat{E}= O\beta$$\end{document}</tex-math><mml:math id="M50"><mml:mrow><mml:mover accent="true"><mml:mi>E</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mi>O</mml:mi><mml:mi>β</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13059_2022_2726_Article_IEq20.gif"/></alternatives></inline-formula> as the start point, renewing <italic>X</italic> by <inline-formula id="IEq21"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${X}_{ij}={X}_{ij}\frac{B_{ij}}{C_{ij}}$$\end{document}</tex-math><mml:math id="M52"><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mfrac><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:mfrac></mml:mrow></mml:math><inline-graphic xlink:href="13059_2022_2726_Article_IEq21.gif"/></alternatives></inline-formula>, where <italic>B</italic> = <italic>XR</italic><sub>1</sub> + <italic>λ</italic><sub>1</sub><italic>R</italic><sub>2</sub><italic>X</italic> and <italic>C</italic> = (1 + <italic>λ</italic><sub>1</sub>)<italic>XX</italic><sup><italic>T</italic></sup><italic>X</italic>.</p>
    </sec>
    <sec id="Sec16">
      <title>Simulation</title>
      <p id="Par42">To illustrate the efficacy of UnpairReg in regulatory inference and gene expression prediction, we performed a simulation study. We simulate the scATAC-seq data according to the method proposed in ref [<xref ref-type="bibr" rid="CR34">34</xref>] taking bulk ATAC-seq count matrix [<xref ref-type="bibr" rid="CR35">35</xref>] as input. We use Lun [<xref ref-type="bibr" rid="CR36">36</xref>] to simulate scRNA-seq data. The detail about the simulation pipeline is described in the Additional file <xref rid="MOESM1" ref-type="media">1</xref>.</p>
    </sec>
    <sec id="Sec17">
      <title>PBMC 10x data</title>
      <p id="Par43">We download the PBMC 10K data from the 10X genomics website <ext-link ext-link-type="uri" xlink:href="https://support.10xgenomics.com/single-cell-multiome-atac-gex/datasets">https://support.10xgenomics.com/single-cell-multiome-atac-gex/datasets</ext-link>. Note that it contains 11,909 cells, and the granulocytes were removed by cell sorting of this dataset. We use the filtered cells by features matrix from the output of 10X genomics software Cell Ranger ARC as input and perform the downstream analysis. First, we perform Seurat 4.0 [<xref ref-type="bibr" rid="CR37">37</xref>] weighted nearest neighbor (WNN) analysis and it removes 1497 cells. We also remove the cells that do not have surrogate ground truth and it results in 9543 cells. Then, we generate the unpaired data by randomly selecting 4771 cells as ATAC-seq data with the remaining 4772 cells as RNA-seq data. We next perform the UnpairReg procedure, remaining 33,050 peaks and 11,277 genes when preprocessing data, only considering the REs within 200 kbp from TSS. The ground truth of predicted gene expression is the RNA-seq data of the 4771 cells.</p>
    </sec>
    <sec id="Sec18">
      <title>HHBT 10x data</title>
      <p id="Par44">We download the HHTB data from the 10X genomics website <ext-link ext-link-type="uri" xlink:href="https://support.10xgenomics.com/single-cell-multiome-atac-gex/datasets">https://support.10xgenomics.com/single-cell-multiome-atac-gex/datasets</ext-link>. We use the filtered cells by features matrix from the output of the 10X genomics software Cell Ranger ARC as input and perform the downstream analysis. It contains 3332 cells. We generate unpaired data by taking all cells as RNA-seq cells and ATAC-seq cells. We next perform the UnpairReg procedure, remaining 48,053 peaks and 15,980 genes when preprocessing data, only considering the REs within 200 kbp from TSS. The ground truth of predicted gene expression is the RNA-seq data of the 3332 cells.</p>
    </sec>
    <sec id="Sec19">
      <title>EEMB 10x data</title>
      <p id="Par45">We download the EEMB data from the 10x genomics website <ext-link ext-link-type="uri" xlink:href="https://support.10xgenomics.com/single-cell-multiome-atac-gex/datasets">https://support.10xgenomics.com/single-cell-multiome-atac-gex/datasets</ext-link>. We use the same pipeline to analyze the data, generating scRNA-seq data with 15,109 genes and 4881 cells, as well as scATAC-seq data with 37,758 peaks and 4881 cells.</p>
    </sec>
    <sec id="Sec20">
      <title>Clustering of cells</title>
      <p id="Par46">We identify the cluster by 2 methods. For the first method, we perform PCA based on the gene expression data and nomalize each PC, rescaling the standard deviation to 1. Then, we perform Louvain algrithm based on the 2nd to the 20th PCs. In the second method, we perform canonical correlation analysis (CCA) taking predicted gene expression data of ATAC-seq cells and the gene expression data of RNA-seq cells as input. The output of CCA is a co-embedding of ATAC-seq and RNA-seq cells. We cluster the cells via Louvain algorithm based on the co-embedding.</p>
    </sec>
    <sec id="Sec21">
      <title>Alignment error</title>
      <p id="Par47">Alignment error is used to evaluate the alignment accuracy of each cell. Denote <italic>X</italic> and <italic>Y</italic> as the predicted gene expression matrix and ground truth of gene expression. The alignment error for the <italic>k</italic>th cell is defined as:<disp-formula id="Equ6"><label>6</label><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${A}_k={n}_1^{(k)}+{n}_2^{(k)}$$\end{document}</tex-math><mml:math id="M54" display="block"><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mn>1</mml:mn><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mn>2</mml:mn><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math><graphic xlink:href="13059_2022_2726_Article_Equ6.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ7"><label>7</label><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\displaystyle \begin{array}{c}{n}_1^k=\sum_{i=1}^K{1}_{d\left({x}_{k.},{y}_{i.}\right)&lt;d\left({x}_{k.},{y}_{k.}\right)}\left(d\left({x}_{k.},{y}_{i.}\right),d\left({x}_{k.},{y}_{k.}\right)\right)\end{array}}$$\end{document}</tex-math><mml:math id="M56" display="block"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msubsup><mml:mi>n</mml:mi><mml:mn>1</mml:mn><mml:mi>k</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>K</mml:mi></mml:msubsup><mml:msub><mml:mn>1</mml:mn><mml:mrow><mml:mi>d</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:msub></mml:mfenced><mml:mo>&lt;</mml:mo><mml:mi>d</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:msub></mml:mfenced></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mi>d</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:msub></mml:mfenced><mml:mo>,</mml:mo><mml:mi>d</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:msub></mml:mfenced></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math><graphic xlink:href="13059_2022_2726_Article_Equ7.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ8"><label>8</label><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\displaystyle \begin{array}{c}{n}_2^k=\sum_{i=1}^K{1}_{d\left({x}_{i.},{y}_{k.}\right)&lt;d\left({x}_{k.},{y}_{k.}\right)}\left(d\left({x}_{i.},{y}_{k.}\right),d\left({x}_{k.},{y}_{k.}\right)\right)\end{array}}$$\end{document}</tex-math><mml:math id="M58" display="block"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msubsup><mml:mi>n</mml:mi><mml:mn>2</mml:mn><mml:mi>k</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>K</mml:mi></mml:msubsup><mml:msub><mml:mn>1</mml:mn><mml:mrow><mml:mi>d</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:msub></mml:mfenced><mml:mo>&lt;</mml:mo><mml:mi>d</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:msub></mml:mfenced></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mi>d</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:msub></mml:mfenced><mml:mo>,</mml:mo><mml:mi>d</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:msub></mml:mfenced></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math><graphic xlink:href="13059_2022_2726_Article_Equ8.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq22"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${n}_1^k$$\end{document}</tex-math><mml:math id="M60"><mml:msubsup><mml:mi>n</mml:mi><mml:mn>1</mml:mn><mml:mi>k</mml:mi></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2022_2726_Article_IEq22.gif"/></alternatives></inline-formula> is the number of cells which is closer to the <italic>k</italic>th cell than the same cell in the ground truth gene expression data, <italic>d</italic> is the Euclidean distance, and <italic>x</italic><sub><italic>k</italic>.</sub> <italic>and y</italic><sub><italic>k</italic></sub>. represent the predicted and ground truth gene expression of the <italic>k</italic>th cell, respectively.</p>
    </sec>
    <sec id="Sec22">
      <title>SI</title>
      <p id="Par48">Based on the 2nd to the 20th PCs obtained from the first clustering method, we compute SI [<xref ref-type="bibr" rid="CR29">29</xref>] for each cell using cosine distance.</p>
    </sec>
    <sec id="Sec23">
      <title>Co-embedding analysis for BMMC population</title>
      <p id="Par49">BMMC data is unpaired single-cell data with 2760 cells from scRNA-seq and 3928 cells from scATAC-seq (GEO under accession number GSE159417). After we get regulatory matrix <italic>β</italic> , we perform CoupledNMF [<xref ref-type="bibr" rid="CR18">18</xref>] replacing the <italic>A</italic> matrix in (<xref rid="Equ3" ref-type="">3</xref>) by <italic>β</italic>. <italic>H</italic><sub>1</sub> and <italic>H</italic><sub>2</sub> give the cluster membership (7 clusters) of ATAC-seq and RNA-seq cells. We perform CCA for co-embedding by finding linear combinations of <italic>H</italic><sub>1</sub> and <italic>H</italic><sub>2</sub> which have a maximum correlation with each other. We get a co-embedding matrix via CCA, the embedding of scRNA-seq and scATAC-seq cells, for further analysis, including UMAP and computing graph connectivity score.</p>
      <p id="Par50">The optimization problem for CoupledNMF is as follows:<disp-formula id="Equ9"><label>9</label><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\displaystyle \begin{array}{c}{\min_{W_1,{H}_1,{W}_2,{H}_2\ge 0}} \frac{1}{2}{\parallel O-{W}_1{H}_1\parallel}_F^2+\frac{\lambda_1}{2}{\parallel E-{W}_2{H}_2\parallel}_F^2-{\lambda}_2\mathrm{tr}\left({W}_2^TA{W}_1\right)+\mu \left({\parallel {W}_1\parallel}_F^2+{\parallel {W}_2\parallel}_F^2\right)\end{array}}$$\end{document}</tex-math><mml:math id="M62" display="block"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mo movablelimits="true">min</mml:mo><mml:mrow><mml:msub><mml:mi>W</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>W</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>≥</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:msubsup><mml:mrow><mml:mo stretchy="false">‖</mml:mo><mml:mi>O</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mi>W</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>H</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">‖</mml:mo></mml:mrow><mml:mi>F</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:mfrac><mml:msub><mml:mi>λ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mn>2</mml:mn></mml:mfrac><mml:msubsup><mml:mrow><mml:mo stretchy="false">‖</mml:mo><mml:mi>E</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mi>W</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>H</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">‖</mml:mo></mml:mrow><mml:mi>F</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>-</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mi mathvariant="normal">tr</mml:mi><mml:mfenced close=")" open="("><mml:msubsup><mml:mi>W</mml:mi><mml:mn>2</mml:mn><mml:mi>T</mml:mi></mml:msubsup><mml:mi>A</mml:mi><mml:msub><mml:mi>W</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mfenced><mml:mo>+</mml:mo><mml:mi>μ</mml:mi><mml:mfenced close=")" open="("><mml:msubsup><mml:mrow><mml:mo stretchy="false">‖</mml:mo><mml:msub><mml:mi>W</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">‖</mml:mo></mml:mrow><mml:mi>F</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mo stretchy="false">‖</mml:mo><mml:msub><mml:mi>W</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">‖</mml:mo></mml:mrow><mml:mi>F</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math><graphic xlink:href="13059_2022_2726_Article_Equ9.gif" position="anchor"/></alternatives></disp-formula>Seurat co-embedding analysis follows the “integrating scRNA-seq and scATAC-seq data” vignette (<ext-link ext-link-type="uri" xlink:href="https://satijalab.org/seurat/articles/atacseq_integration_vignette.html">https://satijalab.org/seurat/articles/atacseq_integration_vignette.html</ext-link>).</p>
    </sec>
    <sec id="Sec24">
      <title>Graph connectivity</title>
      <p id="Par51">The graph connectivity metric assesses whether cells of the same type from different batches (RNA and ATAC in our study) are close to one another in the embedding. This is evaluated by computing a <italic>k</italic>-nearest neighbor (kNN) graph, <italic>G</italic>(<italic>N</italic>; <italic>E</italic>), on the co-embedding using Euclidean distances. We then check if all cells with the same cell type label are connected on this kNN graph. For each cell type label <italic>c</italic>, we generate the subset kNN graph <italic>G</italic>(<italic>N</italic><sub><italic>c</italic></sub>; <italic>E</italic><sub><italic>c</italic></sub>), which contains only cells from a given label. Using these subset kNN graphs, we compute the graph connectivity score:<disp-formula id="Equ10"><label>10</label><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\displaystyle \begin{array}{c} gc=\frac{1}{\left|C\right|}\sum_{c\in C}\kern0.1em \frac{\left| LCC\left(G\left({N}_c;{E}_c\right)\right)\right|}{\left|{N}_c\right|}\end{array}}$$\end{document}</tex-math><mml:math id="M64" display="block"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mi>g</mml:mi><mml:mi>c</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mfenced close="|" open="|"><mml:mi>C</mml:mi></mml:mfenced></mml:mfrac><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mi>c</mml:mi><mml:mo>∈</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msub><mml:mspace width="1.00006pt"/><mml:mfrac><mml:mfenced close="|" open="|"><mml:mi>L</mml:mi><mml:mi>C</mml:mi><mml:mi>C</mml:mi><mml:mfenced close=")" open="("><mml:mi>G</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>N</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo>;</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mfenced></mml:mfenced></mml:mfenced><mml:mfenced close="|" open="|"><mml:msub><mml:mi>N</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mfenced></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math><graphic xlink:href="13059_2022_2726_Article_Equ10.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par52">Here, <italic>C</italic> represents the set of cell type labels, |<italic>LCC</italic>(<italic>G</italic>(<italic>N</italic><sub><italic>c</italic></sub>; <italic>E</italic><sub><italic>c</italic></sub>))| is the number of nodes in the largest connected component of the graph, and |<italic>N</italic><sub><italic>c</italic></sub>| is the number of nodes with cell type <italic>c</italic>. The resulting score has a range of (0, 1], where 1 indicates that all cells with the same cell type are connected in the integrated kNN graph.</p>
    </sec>
    <sec id="Sec25">
      <title>Comparison of PCCs from two different methods</title>
      <p id="Par53">We use a one-sample <italic>t</italic>-test to compare the two groups because the samples are a sample of the two groups. So, we test whether the mean difference of the two group is different from zero, which is a one-sample <italic>t</italic>-test.</p>
    </sec>
    <sec id="Sec26">
      <title>Model parameters</title>
      <p id="Par54">We use the default parameters of UnpairReg for all analyses in this manuscript. We set the fixed distance <italic>d</italic><sub>0</sub> in matrix A from (3) 10,000 as the default value. The tuning parameters in the <italic>λ</italic> in (3) and <italic>λ</italic><sub>1</sub> in (5) are set as 10<sup>7</sup> and 0.5, respectively. We use default parameters for methods for comparison, including Signac, Cicero, MAESTRO, and snapATAC. For Signac, we use the GeneActivity function from Signac R package 1.4.1 to get the gene activity score following the tutorial on Signac website <ext-link ext-link-type="uri" xlink:href="https://satijalab.org/signac/articles/pbmc_vignette.html">https://satijalab.org/signac/articles/pbmc_vignette.html</ext-link>. For Cicero, we calculate the score by normalize_gene_activities function implemented in the Cicero R package 1.3.5. We follow the recommended analysis protocol <ext-link ext-link-type="uri" xlink:href="https://cole-trapnell-lab.github.io/cicero-release/docs_m3/">https://cole-trapnell-lab.github.io/cicero-release/docs_m3/</ext-link> from the Cicero website. For MAESTRO, we perform the calculate_RP_score function from MAESTRO R package 1.5.1. For snapATAC, we take the standard pipeline, analyzing the 5k PBMC dataset from 10X genomics <ext-link ext-link-type="uri" xlink:href="https://kzhang.org/SnapATAC2/tutorials/pbmc.html">https://kzhang.org/SnapATAC2/tutorials/pbmc.html</ext-link>, as reference. The version of the SNAPATAC2 python module is 1.99.99.3. The gene activity score is calculated by the snap.pp.make_gene_matrix function.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Information</title>
    <sec id="Sec27">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="13059_2022_2726_MOESM1_ESM.pdf">
            <caption>
              <p><bold>Additional file 1:.</bold> The simulation and algorithm details include simulation pipeline, simulation result, algorithm performance, and figures.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="13059_2022_2726_MOESM2_ESM.pdf">
            <caption>
              <p><bold>Additional file 2: Fig S1.</bold> UnpairReg gene expression prediction is consistent with the paired data. <bold>Fig S2.</bold> UnpairReg gene expression prediction of HHBT is consistent with the paired data. <bold>Fig S3.</bold> Systematical evaluating the performance of UnpairReg. (A) to (C) The mean gene level and cell level similarity/distance of predicted gene expression and raw data. RMSE is scaled by dividing by the maximum of 5 methods.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM3">
          <media xlink:href="13059_2022_2726_MOESM3_ESM.docx">
            <caption>
              <p><bold>Additional file 3..</bold> Review history.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher’s Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <ack>
    <sec id="FPar1">
      <title>Peer review information</title>
      <p id="Par55">Stephanie McClelland was the primary editor of this article and managed its editorial process and peer review in collaboration with the rest of the editorial team.</p>
    </sec>
    <sec id="FPar2">
      <title>Review history</title>
      <p id="Par56">Review history is available as Supplementary Information <xref rid="MOESM3" ref-type="media">3</xref>.</p>
    </sec>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>Z.D. conceived the project. Z.D. designed the analytical approach. Q.Y. performed the data analysis with the help of Z.D. Q.Y. and Z.D. wrote the software. Q.Y. and Z.D. wrote, revised, and contributed to the final manuscript. The authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>This work was partially supported by NIH grants P20 GM139769.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>The multiome data (PBMC and HHBT) used during this study are downloaded from the 10X Genomics website [<xref ref-type="bibr" rid="CR38">38</xref>]. BMMC data is downloaded from the NCBI Gene Expression Omnibus (GEO, <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/">https://www.ncbi.nlm.nih.gov/geo/</ext-link>) under accession number GSE159417 [<xref ref-type="bibr" rid="CR30">30</xref>].</p>
    <p>The software is available at GitHub at <ext-link ext-link-type="uri" xlink:href="https://github.com/Durenlab/UnpairReg">https://github.com/Durenlab/UnpairReg</ext-link> [<xref ref-type="bibr" rid="CR39">39</xref>] and the Zenodo repository under the GPLv3 license [<xref ref-type="bibr" rid="CR40">40</xref>].</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar3">
      <title>Ethics approval and consent to participate</title>
      <p id="Par57">Not applicable.</p>
    </notes>
    <notes id="FPar4">
      <title>Consent for publication</title>
      <p id="Par58">Not applicable.</p>
    </notes>
    <notes id="FPar5" notes-type="COI-statement">
      <title>Competing interests</title>
      <p id="Par59">The authors declare that they have no competing interests.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tang</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Barbacioru</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>Y</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>mRNA-Seq whole-transcriptome analysis of a single cell</article-title>
        <source>Nat Methods</source>
        <year>2009</year>
        <volume>6</volume>
        <fpage>377</fpage>
        <lpage>382</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.1315</pub-id>
        <pub-id pub-id-type="pmid">19349980</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Buenrostro</surname>
            <given-names>JD</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Litzenburger</surname>
            <given-names>UM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell chromatin accessibility reveals principles of regulatory variation</article-title>
        <source>Nature</source>
        <year>2015</year>
        <volume>523</volume>
        <fpage>486</fpage>
        <lpage>490</lpage>
        <pub-id pub-id-type="doi">10.1038/nature14590</pub-id>
        <pub-id pub-id-type="pmid">26083756</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Smallwood</surname>
            <given-names>SA</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>HJ</given-names>
          </name>
          <name>
            <surname>Angermueller</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell genome-wide bisulfite sequencing for assessing epigenetic heterogeneity</article-title>
        <source>Nat Methods</source>
        <year>2014</year>
        <volume>11</volume>
        <fpage>817</fpage>
        <lpage>820</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.3035</pub-id>
        <pub-id pub-id-type="pmid">25042786</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kaya-Okur</surname>
            <given-names>HS</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>SJ</given-names>
          </name>
          <name>
            <surname>Codomo</surname>
            <given-names>CA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>CUT&amp;tag for efficient epigenomic profiling of small samples and single cells</article-title>
        <source>Nat Commun.</source>
        <year>2019</year>
        <volume>10</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>10</lpage>
        <pub-id pub-id-type="doi">10.1038/s41467-019-09982-5</pub-id>
        <pub-id pub-id-type="pmid">30602773</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stoeckius</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Hafemeister</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Stephenson</surname>
            <given-names>W</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Simultaneous epitope and transcriptome measurement in single cells</article-title>
        <source>Nat Methods</source>
        <year>2017</year>
        <volume>14</volume>
        <fpage>865</fpage>
        <lpage>868</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.4380</pub-id>
        <pub-id pub-id-type="pmid">28759029</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Belhocine</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Demare</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Habern</surname>
            <given-names>O</given-names>
          </name>
        </person-group>
        <article-title>Single-cell multiomics: simultaneous epigenetic and transcriptional profiling</article-title>
        <source>Genet Eng Biotechnol News</source>
        <year>2021</year>
        <volume>41</volume>
        <fpage>66</fpage>
        <lpage>68</lpage>
        <pub-id pub-id-type="doi">10.1089/gen.41.01.17</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhu</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>YE</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Joint profiling of histone modifications and transcriptome in single cells from mouse brain</article-title>
        <source>Nat Methods</source>
        <year>2021</year>
        <volume>18</volume>
        <fpage>283</fpage>
        <lpage>292</lpage>
        <pub-id pub-id-type="doi">10.1038/s41592-021-01060-3</pub-id>
        <pub-id pub-id-type="pmid">33589836</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cao</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>O’Day</surname>
            <given-names>DR</given-names>
          </name>
          <name>
            <surname>Pliner</surname>
            <given-names>HA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A human cell atlas of fetal gene expression</article-title>
        <source>Science</source>
        <year>1979</year>
        <volume>2020</volume>
        <fpage>370</fpage>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Domcke</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Hill</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Daza</surname>
            <given-names>RM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A human cell atlas of fetal chromatin accessibility</article-title>
        <source>Science</source>
        <year>1979</year>
        <volume>2020</volume>
        <fpage>370</fpage>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Hocker</surname>
            <given-names>JD</given-names>
          </name>
          <name>
            <surname>Miller</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A single-cell atlas of chromatin accessibility in the human genome</article-title>
        <source>Cell</source>
        <year>2021</year>
        <volume>184</volume>
        <fpage>5985</fpage>
        <lpage>6001.e19</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2021.10.024</pub-id>
        <pub-id pub-id-type="pmid">34774128</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cao</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Packer</surname>
            <given-names>JS</given-names>
          </name>
          <name>
            <surname>Ramani</surname>
            <given-names>V</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Comprehensive single-cell transcriptional profiling of a multicellular organism</article-title>
        <source>Science</source>
        <year>2017</year>
        <volume>357</volume>
        <issue>6352</issue>
        <fpage>661</fpage>
        <lpage>667</lpage>
        <pub-id pub-id-type="doi">10.1126/science.aam8940</pub-id>
        <pub-id pub-id-type="pmid">28818938</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schaum</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Karkanias</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Neff</surname>
            <given-names>NF</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell transcriptomics of 20 mouse organs creates a tabula Muris</article-title>
        <source>Nature</source>
        <year>2018</year>
        <volume>562</volume>
        <fpage>367</fpage>
        <lpage>372</lpage>
        <pub-id pub-id-type="doi">10.1038/s41586-018-0590-4</pub-id>
        <pub-id pub-id-type="pmid">30283141</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>B</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell chromatin accessibility landscape in kidney identifies additional cell-of-origin in heterogenous papillary renal cell carcinoma</article-title>
        <source>Nature. Communications.</source>
        <year>2022</year>
        <volume>13</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>12</lpage>
        <pub-id pub-id-type="doi">10.1038/s41467-021-27699-2</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <mixed-citation publication-type="other">Zhang Z, Yang C, Zhang X. Learning latent embedding of multi-modal single cell data and cross-modality relationship simultaneously. bioRxiv. (2021).</mixed-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <mixed-citation publication-type="other">Wang C, Sun D, Huang X, et al. Integrative analyses of single-cell transcriptome and regulome using MAESTRO. Genome Biol. 2020;21(1):1-28.</mixed-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <mixed-citation publication-type="other">Jansen C, Ramirez RN, El-Ali NC, et al. Building gene regulatory networks from scATAC-seq and scRNA-seq using linked self organizing maps. PLoS Comput Biol. 2019;15(11): e1006555.</mixed-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <mixed-citation publication-type="other">Zeng W, Chen X, Duren Z, et al. DC3 is a method for deconvolution and coupled clustering from bulk and single-cell genomics data. Nature. Communications. 2019;10(1):1-11.</mixed-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Duren</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Zamanighomi</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Integrative analysis of single-cell genomics data by coupled nonnegative matrix factorizations</article-title>
        <source>Proc Natl Acad Sci U S A</source>
        <year>2018</year>
        <volume>115</volume>
        <fpage>7723</fpage>
        <lpage>7728</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.1805681115</pub-id>
        <pub-id pub-id-type="pmid">29987051</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jung</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Schmitt</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Diao</surname>
            <given-names>Y</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A compendium of promoter-centered long-range chromatin interactions in the human genome</article-title>
        <source>Nat Genet</source>
        <year>2019</year>
        <volume>51</volume>
        <fpage>1442</fpage>
        <lpage>1449</lpage>
        <pub-id pub-id-type="doi">10.1038/s41588-019-0494-8</pub-id>
        <pub-id pub-id-type="pmid">31501517</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stuart</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Butler</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Hoffman</surname>
            <given-names>P</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Comprehensive integration of single-cell data</article-title>
        <source>Cell</source>
        <year>2019</year>
        <volume>177</volume>
        <fpage>1888</fpage>
        <lpage>1902.e21</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2019.05.031</pub-id>
        <pub-id pub-id-type="pmid">31178118</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stuart</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Srivastava</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Madad</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell chromatin state analysis with Signac</article-title>
        <source>Nat Methods</source>
        <year>2021</year>
        <volume>18</volume>
        <fpage>1333</fpage>
        <lpage>1341</lpage>
        <pub-id pub-id-type="doi">10.1038/s41592-021-01282-5</pub-id>
        <pub-id pub-id-type="pmid">34725479</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pliner</surname>
            <given-names>HA</given-names>
          </name>
          <name>
            <surname>Packer</surname>
            <given-names>JS</given-names>
          </name>
          <name>
            <surname>McFaline-Figueroa</surname>
            <given-names>JL</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Cicero predicts cis-regulatory DNA interactions from single-cell chromatin accessibility data</article-title>
        <source>Mol Cell</source>
        <year>2018</year>
        <volume>71</volume>
        <fpage>858</fpage>
        <lpage>871.e8</lpage>
        <pub-id pub-id-type="doi">10.1016/j.molcel.2018.06.044</pub-id>
        <pub-id pub-id-type="pmid">30078726</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <mixed-citation publication-type="other">Fang R, Preissl S, Li Y, et al. Comprehensive analysis of single cell ATAC-seq data with SnapATAC. Nat Commun. 2021;12(1):1-15.</mixed-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <mixed-citation publication-type="other">Li WV, Li JJ. An accurate and robust imputation method scImpute for single-cell RNA-seq data. Nat Commun. 2018;9(1):1-9.</mixed-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fairfax</surname>
            <given-names>BP</given-names>
          </name>
          <name>
            <surname>Humburg</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Makino</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Innate immune activity conditions the effect of regulatory variants upon monocyte gene expression</article-title>
        <source>Science</source>
        <year>1979</year>
        <volume>2014</volume>
        <fpage>343</fpage>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Võsa</surname>
            <given-names>U</given-names>
          </name>
          <name>
            <surname>Claringbould</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Westra</surname>
            <given-names>HJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Large-scale cis- and trans-eQTL analyses identify thousands of genetic loci and polygenic scores that regulate blood gene expression</article-title>
        <source>Nat Genet</source>
        <year>2021</year>
        <volume>53</volume>
        <fpage>1300</fpage>
        <lpage>1310</lpage>
        <pub-id pub-id-type="doi">10.1038/s41588-021-00913-z</pub-id>
        <pub-id pub-id-type="pmid">34475573</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kashima</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Sakamoto</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Kaneko</surname>
            <given-names>K</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell sequencing techniques from individual to multiomics analyses</article-title>
        <source>Exp Mol Med</source>
        <year>2020</year>
        <volume>52</volume>
        <fpage>1419</fpage>
        <lpage>1427</lpage>
        <pub-id pub-id-type="doi">10.1038/s12276-020-00499-2</pub-id>
        <pub-id pub-id-type="pmid">32929221</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Blondel</surname>
            <given-names>VD</given-names>
          </name>
          <name>
            <surname>Guillaume</surname>
            <given-names>JL</given-names>
          </name>
          <name>
            <surname>Lambiotte</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Fast unfolding of communities in large networks</article-title>
        <source>J Stat Mech: Theory Exper.</source>
        <year>2008</year>
        <volume>2008</volume>
        <fpage>10008</fpage>
        <pub-id pub-id-type="doi">10.1088/1742-5468/2008/10/P10008</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <mixed-citation publication-type="other">Rousseeuw PJ. Silhouettes: a graphical aid to the interpretation and validation of cluster analysis. J Comput Appl Math. 1987;20:53-65.</mixed-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <mixed-citation publication-type="other">Duren Z, Lu WS, Arthur JG, et al. Sc-compReg enables the comparison of gene regulatory networks between conditions using single-cell data. Nature Commun. 2021;12(1):1-13.</mixed-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <mixed-citation publication-type="other">Luecken MD, Büttner M, Chaichoompu K, et al. Benchmarking atlas-level data integration in single-cell genomics. Nature methods. (2022)19(1):41-50.</mixed-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <mixed-citation publication-type="other">Ma W, Su K, Wu H. Evaluation of some aspects in supervised cell type identification for single-cell RNA-seq: classifier, feature selection, and reference construction. Genome Biol. 2021;22(1):1-23.</mixed-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Javierre</surname>
            <given-names>BM</given-names>
          </name>
          <name>
            <surname>Sewitz</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Cairns</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Lineage-specific genome architecture links enhancers and non-coding disease variants to target gene promoters</article-title>
        <source>Cell</source>
        <year>2016</year>
        <volume>167</volume>
        <fpage>1369</fpage>
        <lpage>1384.e19</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2016.09.037</pub-id>
        <pub-id pub-id-type="pmid">27863249</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <mixed-citation publication-type="other">Chen H, Lareau C, Andreani T, et al. Assessment of computational methods for the analysis of single-cell ATAC-seq data. Genome Biol. 2019;20(1):1-25.</mixed-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gontarz</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Fu</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Xing</surname>
            <given-names>X</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Comparison of differential accessibility analysis strategies for ATAC-seq data</article-title>
        <source>Sci Rep.</source>
        <year>2020</year>
        <volume>10</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>13</lpage>
        <pub-id pub-id-type="doi">10.1038/s41598-020-66998-4</pub-id>
        <pub-id pub-id-type="pmid">31913322</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lun</surname>
            <given-names>ATL</given-names>
          </name>
          <name>
            <surname>Bach</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Marioni</surname>
            <given-names>JC</given-names>
          </name>
        </person-group>
        <article-title>Pooling across cells to normalize single-cell RNA sequencing data with many zero counts</article-title>
        <source>Genome Biol.</source>
        <year>2016</year>
        <volume>17</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>14</lpage>
        <pub-id pub-id-type="doi">10.1186/s13059-015-0866-z</pub-id>
        <pub-id pub-id-type="pmid">26753840</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hao</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Hao</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Andersen-Nissen</surname>
            <given-names>E</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Integrated analysis of multimodal single-cell data</article-title>
        <source>Cell</source>
        <year>2021</year>
        <volume>184</volume>
        <fpage>3573</fpage>
        <lpage>3587.e29</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2021.04.048</pub-id>
        <pub-id pub-id-type="pmid">34062119</pub-id>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <mixed-citation publication-type="other">PBMCs from C57BL/6 mice (v1, 150x150). Single cell immune profiling dataset by cell ranger 3.1.0. 10x Genomics. 2019. <ext-link ext-link-type="uri" xlink:href="https://support.10xgenomics.com/single-cell-multiome-atac-gex/datasets">https://support.10xgenomics.com/single-cell-multiome-atac-gex/datasets</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <mixed-citation publication-type="other">Qiuyue Y, Duren Z. Integration of single cell multi-omics data by regression analysis on unpaired observations. GitHub. (2022) <ext-link ext-link-type="uri" xlink:href="https://github.com/Durenlab/UnpairReg">https://github.com/Durenlab/UnpairReg</ext-link>. Accessed 19 Jan 2022.</mixed-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <mixed-citation publication-type="other">Qiuyue Y, Duren Z. Integration of single cell multi-omics data by regression analysis on unpaired observations. Zendo. 2022. 10.5281/zenodo.6789088.</mixed-citation>
    </ref>
  </ref-list>
</back>
