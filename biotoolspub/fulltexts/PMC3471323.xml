<?DTDIdentifier.IdentifierValue article.dtd?>
<?DTDIdentifier.IdentifierType system?>
<?SourceDTD.DTDName article.dtd?>
<?SourceDTD.Version 1.0?>
<?ConverterInfo.XSLTName bmc2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">3471323</article-id>
    <article-id pub-id-type="publisher-id">1471-2105-13-31</article-id>
    <article-id pub-id-type="pmid">22333067</article-id>
    <article-id pub-id-type="doi">10.1186/1471-2105-13-31</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>PANDAseq: paired-end assembler for illumina sequences</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" id="A1">
        <name>
          <surname>Masella</surname>
          <given-names>Andre P</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <email>amasella@uwaterloo.ca</email>
      </contrib>
      <contrib contrib-type="author" id="A2">
        <name>
          <surname>Bartram</surname>
          <given-names>Andrea K</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <email>akbartra@uwaterloo.ca</email>
      </contrib>
      <contrib contrib-type="author" id="A3">
        <name>
          <surname>Truszkowski</surname>
          <given-names>Jakub M</given-names>
        </name>
        <xref ref-type="aff" rid="I2">2</xref>
        <email>jmtruszkowski@uwaterloo.ca</email>
      </contrib>
      <contrib contrib-type="author" id="A4">
        <name>
          <surname>Brown</surname>
          <given-names>Daniel G</given-names>
        </name>
        <xref ref-type="aff" rid="I2">2</xref>
        <email>browndg@uwaterloo.ca</email>
      </contrib>
      <contrib contrib-type="author" corresp="yes" id="A5">
        <name>
          <surname>Neufeld</surname>
          <given-names>Josh D</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <email>jneufeld@uwaterloo.ca</email>
      </contrib>
    </contrib-group>
    <aff id="I1"><label>1</label>Department of Biology, University of Waterloo, Waterloo, Ontario, Canada</aff>
    <aff id="I2"><label>2</label>David R. Cheriton School of Computer Science, University of Waterloo, Waterloo, Ontario, Canada</aff>
    <pub-date pub-type="collection">
      <year>2012</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>14</day>
      <month>2</month>
      <year>2012</year>
    </pub-date>
    <volume>13</volume>
    <fpage>31</fpage>
    <lpage>31</lpage>
    <history>
      <date date-type="received">
        <day>23</day>
        <month>9</month>
        <year>2011</year>
      </date>
      <date date-type="accepted">
        <day>14</day>
        <month>2</month>
        <year>2012</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Copyright ©2012 Masella et al.; licensee BioMed Central Ltd.</copyright-statement>
      <copyright-year>2012</copyright-year>
      <copyright-holder>Masella et al.; licensee BioMed Central Ltd.</copyright-holder>
      <license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/2.0">
        <license-p>This is an open access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/2.0">http://creativecommons.org/licenses/by/2.0</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="http://www.biomedcentral.com/1471-2105/13/31"/>
    <abstract>
      <sec>
        <title>Background</title>
        <p>Illumina paired-end reads are used to analyse microbial communities by targeting amplicons of the 16S rRNA gene. Publicly available tools are needed to assemble overlapping paired-end reads while correcting mismatches and uncalled bases; many errors could be corrected to obtain higher sequence yields using quality information.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p>PANDAseq assembles paired-end reads rapidly and with the correction of most errors. Uncertain error corrections come from reads with many low-quality bases identified by upstream processing. Benchmarks were done using real error masks on simulated data, a pure source template, and a pooled template of genomic DNA from known organisms. PANDAseq assembled reads more rapidly and with reduced error incorporation compared to alternative methods.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p>PANDAseq rapidly assembles sequences and scales to billions of paired-end reads. Assembly of control libraries showed a 4-50% increase in the number of assembled sequences over naïve assembly with negligible loss of "good" sequence.</p>
      </sec>
    </abstract>
  </article-meta>
</front>
<body>
  <sec>
    <title>Background</title>
    <p>Single-gene sequencing has become the benchmark for studying microbial taxonomic composition of environmental samples, by amplification of hypervariable regions of the 16S rRNA gene. Next-generation sequencing platforms, such as Illumina, are now adapted for the generation of multi-million-member sequence libraries for sample comparisons [<xref ref-type="bibr" rid="B1">1</xref>-<xref ref-type="bibr" rid="B4">4</xref>]. The PCR amplicons used for sequencing typically encompass one or more 16S rRNA gene hypervariable regions and amplicon lengths typically extend beyond the sequencing limit of the Illumina single-read method, which is typically less than 150 bases. Because the Illumina platform can generate amplicon sequences in a paired-end format, based on each template's position on the flow cell, paired reads can be directly matched and assembled. The prefiltering step of the genome assembly software PHRAP can be used to assemble reads [<xref ref-type="bibr" rid="B3">3</xref>]. Although the Needleman-Wunsch algorithm [<xref ref-type="bibr" rid="B5">5</xref>] embedded in Merger (<ext-link ext-link-type="uri" xlink:href="http://emboss.sourceforge.net/apps/release/6.2/emboss/apps/merger.html">http://emboss.sourceforge.net/apps/release/6.2/emboss/apps/merger.html</ext-link>) has been used to assemble Illumina paired-end reads [<xref ref-type="bibr" rid="B6">6</xref>], PANDAseq makes use of Illumina-specific properties, including the low probability of gap-inclusion.</p>
    <p>Assembly of the Illumina paired-end sequences can be done naïvely requiring perfect match in the region of overlap, to produce large numbers of correct sequences, as in the first iteration of our assembly software [<xref ref-type="bibr" rid="B1">1</xref>]. However, approximately 40% of the sequences were discarded due to uncalled or miscalled bases. The proportion of discarded paired-end reads, due to bases uncalled or miscalled, will increase as read lengths increase, decreasing naïve assembly effectiveness. We suggest a more sophisticated method that corrects errors probabilistically with the overlap data from the paired-end reads. When the overlap between the forward and reverse reads is substantial, many uncalled or miscalled bases can be corrected using the complementary sequence. Our software, PANDAseq, uses paired-end Illumina reads, determines the proper amount of overlap and reconstructs the entire sequence by correcting errors in the overlapping region (Figure <xref ref-type="fig" rid="F1">1</xref>). Assembly is extremely fast and millions of paired-end reads can be rapidly assembled on a desktop computer.</p>
    <fig id="F1" position="float">
      <label>Figure 1</label>
      <caption>
        <p><bold>Schematic of paired-end assembly</bold>. Typical scenario: forward and reverse reads are overlapped and the primer regions are removed to reconstruct the sequences. Highly overlapping scenario: for short templates, the overlapping region may include the primer regions.</p>
      </caption>
      <graphic xlink:href="1471-2105-13-31-1"/>
    </fig>
  </sec>
  <sec>
    <title>Implementation</title>
    <p>PANDAseq aligns each set of paired-end sequence reads in a three-step process. First, it determines the locations of the amplification primers, if they are specified and were sequenced. Then, it identifies the optimal overlap. Finally, it reconstructs the complete sequence, correcting any errors, and checks for various constraints, such as length and quality.</p>
    <p>To score alignments, we calculate the probability that the true nucleotides, <inline-formula><inline-graphic xlink:href="1471-2105-13-31-i1.gif"/></inline-formula> and <inline-formula><inline-graphic xlink:href="1471-2105-13-31-i2.gif"/></inline-formula>, are the same, given the observed nucleotides, <italic>X </italic>and <italic>Y</italic>. We estimate this with the included quality information found in the Illumina reads. For each base, CASAVA provides an encoded quality score, which is the probability of the base being miscalled. This probability (<italic>ϵ</italic>) is approximated by <inline-formula><mml:math id="M1" name="1471-2105-13-31-i3" overflow="scroll"><mml:mn>1</mml:mn><mml:msup><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mo class="MathClass-bin">-</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo class="MathClass-bin">-</mml:mo><mml:mn>64</mml:mn></mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:msup><mml:mo class="MathClass-rel">=</mml:mo><mml:mn>1</mml:mn><mml:msup><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mo class="MathClass-bin">-</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo class="MathClass-bin">-</mml:mo><mml:mn>33</mml:mn></mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:msup></mml:math></inline-formula> where <italic>A</italic><sub>0 </sub>is the ASCII quality value in the Illumina analysis pipeline versions before CASAVA 1.8 and <italic>A</italic><sub><italic>1 </italic></sub>is the ASCII value used in CASAVA 1.8. [<xref ref-type="bibr" rid="B7">7</xref>]</p>
    <p>Assuming all nucleotides are equally likely (i.e., the prior probability that the true bases match is <inline-formula><mml:math id="M2" name="1471-2105-13-31-i4" overflow="scroll"><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:mfrac></mml:math></inline-formula>), and that sequencing errors are independent and result in equiprobable choices over the other three nucleotides, the probability that the true bases match, given that the sequenced bases match, is:</p>
    <p>
      <disp-formula>
        <mml:math id="M3" name="1471-2105-13-31-i5" overflow="scroll">
          <mml:mrow>
            <mml:mtext>Pr</mml:mtext>
            <mml:mrow>
              <mml:mo class="MathClass-open">[</mml:mo>
              <mml:mrow>
                <mml:mover accent="true">
                  <mml:mrow>
                    <mml:mi>X</mml:mi>
                  </mml:mrow>
                  <mml:mo class="MathClass-op"> ^</mml:mo>
                </mml:mover>
                <mml:mo class="MathClass-rel">=</mml:mo>
                <mml:mi>Ŷ</mml:mi>
                <mml:mo class="MathClass-rel">|</mml:mo>
                <mml:mi>X</mml:mi>
                <mml:mo class="MathClass-rel">=</mml:mo>
                <mml:mi>Y</mml:mi>
              </mml:mrow>
              <mml:mo class="MathClass-close">]</mml:mo>
            </mml:mrow>
            <mml:mo class="MathClass-rel">=</mml:mo>
            <mml:mrow>
              <mml:mo class="MathClass-open">(</mml:mo>
              <mml:mrow>
                <mml:mn>1</mml:mn>
                <mml:mo class="MathClass-bin">-</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>ε</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>X</mml:mi>
                  </mml:mrow>
                </mml:msub>
              </mml:mrow>
              <mml:mo class="MathClass-close">)</mml:mo>
            </mml:mrow>
            <mml:mrow>
              <mml:mo class="MathClass-open">(</mml:mo>
              <mml:mrow>
                <mml:mn>1</mml:mn>
                <mml:mo class="MathClass-bin">-</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>ε</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>Y</mml:mi>
                  </mml:mrow>
                </mml:msub>
              </mml:mrow>
              <mml:mo class="MathClass-close">)</mml:mo>
            </mml:mrow>
            <mml:mo class="MathClass-bin">+</mml:mo>
            <mml:mfrac>
              <mml:mrow>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>ε</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>X</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>ε</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>Y</mml:mi>
                  </mml:mrow>
                </mml:msub>
              </mml:mrow>
              <mml:mrow>
                <mml:mn>3</mml:mn>
              </mml:mrow>
            </mml:mfrac>
          </mml:mrow>
        </mml:math>
      </disp-formula>
    </p>
    <p>and the probability that the true bases match, given the sequenced bases mismatch, is:</p>
    <p>
      <disp-formula>
        <mml:math id="M4" name="1471-2105-13-31-i6" overflow="scroll">
          <mml:mtable columnalign="left" class="align">
            <mml:mtr>
              <mml:mtd columnalign="right" class="align-odd">
                <mml:mtext>Pr</mml:mtext>
                <mml:mrow>
                  <mml:mo class="MathClass-open">[</mml:mo>
                  <mml:mrow>
                    <mml:mover accent="true">
                      <mml:mrow>
                        <mml:mi>X</mml:mi>
                      </mml:mrow>
                      <mml:mo class="MathClass-op"> ^</mml:mo>
                    </mml:mover>
                    <mml:mo class="MathClass-rel">=</mml:mo>
                    <mml:mi>Ŷ</mml:mi>
                    <mml:mo class="MathClass-rel">|</mml:mo>
                    <mml:mi>X</mml:mi>
                    <mml:mo class="MathClass-rel">≠</mml:mo>
                    <mml:mi>Y</mml:mi>
                  </mml:mrow>
                  <mml:mo class="MathClass-close">]</mml:mo>
                </mml:mrow>
              </mml:mtd>
              <mml:mtd class="align-even">
                <mml:mo class="MathClass-rel">=</mml:mo>
                <mml:mspace width="1em" class="quad"/>
                <mml:mfrac>
                  <mml:mrow>
                    <mml:mn>1</mml:mn>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mn>3</mml:mn>
                  </mml:mrow>
                </mml:mfrac>
                <mml:mrow>
                  <mml:mo class="MathClass-open">(</mml:mo>
                  <mml:mrow>
                    <mml:mn>1</mml:mn>
                    <mml:mo class="MathClass-bin">-</mml:mo>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>ε</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>X</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                  </mml:mrow>
                  <mml:mo class="MathClass-close">)</mml:mo>
                </mml:mrow>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>ε</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>Y</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mspace width="2em"/>
              </mml:mtd>
            </mml:mtr>
            <mml:mtr>
              <mml:mtd columnalign="right" class="align-odd"/>
              <mml:mtd class="align-even">
                <mml:mspace width="1em" class="quad"/>
                <mml:mo class="MathClass-bin">+</mml:mo>
                <mml:mfrac>
                  <mml:mrow>
                    <mml:mn>1</mml:mn>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mn>3</mml:mn>
                  </mml:mrow>
                </mml:mfrac>
                <mml:mrow>
                  <mml:mo class="MathClass-open">(</mml:mo>
                  <mml:mrow>
                    <mml:mn>1</mml:mn>
                    <mml:mo class="MathClass-bin">-</mml:mo>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>ε</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>Y</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                  </mml:mrow>
                  <mml:mo class="MathClass-close">)</mml:mo>
                </mml:mrow>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>ε</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>X</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mspace width="2em"/>
              </mml:mtd>
            </mml:mtr>
            <mml:mtr>
              <mml:mtd columnalign="right" class="align-odd"/>
              <mml:mtd class="align-even">
                <mml:mspace width="1em" class="quad"/>
                <mml:mo class="MathClass-bin">+</mml:mo>
                <mml:mfrac>
                  <mml:mrow>
                    <mml:mn>2</mml:mn>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mn>9</mml:mn>
                  </mml:mrow>
                </mml:mfrac>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>ε</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>X</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>ε</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>Y</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mspace width="2em"/>
              </mml:mtd>
            </mml:mtr>
            <mml:mtr>
              <mml:mtd columnalign="right" class="align-odd"/>
              <mml:mtd class="align-even">
                <mml:mspace width="2em"/>
              </mml:mtd>
            </mml:mtr>
          </mml:mtable>
        </mml:math>
      </disp-formula>
    </p>
    <p>If one of the bases is an uncalled base, N, then the probability that the bases match is:</p>
    <p>
      <disp-formula>
        <mml:math id="M5" name="1471-2105-13-31-i7" overflow="scroll">
          <mml:mrow>
            <mml:mtext>Pr</mml:mtext>
            <mml:mrow>
              <mml:mo class="MathClass-open">[</mml:mo>
              <mml:mrow>
                <mml:mover accent="true">
                  <mml:mrow>
                    <mml:mi>X</mml:mi>
                  </mml:mrow>
                  <mml:mo class="MathClass-op"> ^</mml:mo>
                </mml:mover>
                <mml:mo class="MathClass-rel">=</mml:mo>
                <mml:mi>Ŷ</mml:mi>
                <mml:mo class="MathClass-rel">|</mml:mo>
                <mml:mi>Y</mml:mi>
                <mml:mo class="MathClass-rel">=</mml:mo>
                <mml:mi>N</mml:mi>
              </mml:mrow>
              <mml:mo class="MathClass-close">]</mml:mo>
            </mml:mrow>
            <mml:mo class="MathClass-rel">=</mml:mo>
            <mml:mfrac>
              <mml:mrow>
                <mml:mn>1</mml:mn>
              </mml:mrow>
              <mml:mrow>
                <mml:mn>4</mml:mn>
              </mml:mrow>
            </mml:mfrac>
          </mml:mrow>
        </mml:math>
      </disp-formula>
    </p>
    <p>Using these probabilities, PANDAseq begins the assembly process by determining the positions of forward and reverse primers, if supplied. To accomplish this, the program finds the first offset, <italic>x</italic>, where the primer aligns. For a primer <italic>P </italic>and a sequence <italic>S</italic>, the program calculates</p>
    <p>
      <disp-formula>
        <mml:math id="M6" name="1471-2105-13-31-i8" overflow="scroll">
          <mml:mrow>
            <mml:munderover accentunder="false" accent="false">
              <mml:mrow>
                <mml:mo mathsize="big">∏</mml:mo>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>i</mml:mi>
                <mml:mo class="MathClass-rel">=</mml:mo>
                <mml:mn>0</mml:mn>
              </mml:mrow>
              <mml:mrow>
                <mml:mfenced open="|" close="|">
                  <mml:mrow>
                    <mml:mi>P</mml:mi>
                  </mml:mrow>
                </mml:mfenced>
                <mml:mo class="MathClass-bin">-</mml:mo>
                <mml:mn>1</mml:mn>
              </mml:mrow>
            </mml:munderover>
            <mml:mtext>Pr</mml:mtext>
            <mml:mrow>
              <mml:mo class="MathClass-open">[</mml:mo>
              <mml:mrow>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>Ŝ</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>i</mml:mi>
                    <mml:mo class="MathClass-bin">+</mml:mo>
                    <mml:mi>x</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo class="MathClass-rel">=</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>P</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>i</mml:mi>
                  </mml:mrow>
                </mml:msub>
              </mml:mrow>
              <mml:mo class="MathClass-close">]</mml:mo>
            </mml:mrow>
          </mml:mrow>
        </mml:math>
      </disp-formula>
    </p>
    <p>while assuming that <inline-formula><mml:math id="M7" name="1471-2105-13-31-i9" overflow="scroll"><mml:msub><mml:mrow><mml:mi>ε</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo class="MathClass-rel">=</mml:mo><mml:mn>1</mml:mn><mml:mo class="MathClass-bin">-</mml:mo><mml:mn>1</mml:mn><mml:msup><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mo class="MathClass-bin">-</mml:mo><mml:mn>4</mml:mn><mml:mi>.</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula>, which is the highest value score assigned by Illumina [<xref ref-type="bibr" rid="B8">8</xref>] and, intuitively, assuming that <inline-formula><inline-graphic xlink:href="1471-2105-13-31-i10.gif"/></inline-formula> is <italic>P.</italic></p>
    <p>The program then finds the best overlap greater than a specified threshold for the forward and reverse sequences, <italic>F </italic>and <italic>R</italic>, respectively. If no suitable overlap is found, then the read pair is discarded. This is done for the entire read, even if there are primers to be removed, as it is possible for the overlap to be sufficiently long to be in the primer region. A schematic is shown in Figure <xref ref-type="fig" rid="F1">1</xref>.</p>
    <p>The value of <italic>c </italic>∈ [1, min(|<italic>F</italic>|, |<italic>R</italic>|)) is chosen which maximises this formula:</p>
    <p>
      <disp-formula>
        <mml:math id="M8" name="1471-2105-13-31-i11" overflow="scroll">
          <mml:mtable columnalign="left" class="align">
            <mml:mtr>
              <mml:mtd columnalign="right" class="align-odd">
                <mml:mtext>Pr</mml:mtext>
                <mml:mrow>
                  <mml:mo class="MathClass-open">[</mml:mo>
                  <mml:mrow>
                    <mml:mi>F</mml:mi>
                    <mml:mo class="MathClass-punc">,</mml:mo>
                    <mml:mi>R</mml:mi>
                    <mml:mo class="MathClass-rel">|</mml:mo>
                    <mml:mi>c</mml:mi>
                  </mml:mrow>
                  <mml:mo class="MathClass-close">]</mml:mo>
                </mml:mrow>
              </mml:mtd>
              <mml:mtd class="align-even">
                <mml:mo class="MathClass-rel">=</mml:mo>
                <mml:mspace width="1em" class="quad"/>
                <mml:munder class="msub">
                  <mml:mrow>
                    <mml:mo mathsize="big"> ∏</mml:mo>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>i</mml:mi>
                    <mml:mo class="MathClass-rel">=</mml:mo>
                    <mml:mn>1</mml:mn>
                    <mml:mo>…</mml:mo>
                    <mml:mi>f</mml:mi>
                  </mml:mrow>
                </mml:munder>
                <mml:mtext>Pr</mml:mtext>
                <mml:mrow>
                  <mml:mo class="MathClass-open">[</mml:mo>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>F</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>i</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                  </mml:mrow>
                  <mml:mo class="MathClass-close">]</mml:mo>
                </mml:mrow>
                <mml:mspace width="2em"/>
              </mml:mtd>
            </mml:mtr>
            <mml:mtr>
              <mml:mtd columnalign="right" class="align-odd"/>
              <mml:mtd class="align-even">
                <mml:mspace width="1em" class="quad"/>
                <mml:mo class="MathClass-bin">⋅</mml:mo>
                <mml:munder class="msub">
                  <mml:mrow>
                    <mml:mo mathsize="big">∏</mml:mo>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>i</mml:mi>
                    <mml:mo class="MathClass-rel">=</mml:mo>
                    <mml:mn>1</mml:mn>
                    <mml:mo>…</mml:mo>
                    <mml:mi>c</mml:mi>
                  </mml:mrow>
                </mml:munder>
                <mml:mtext>Pr</mml:mtext>
                <mml:mrow>
                  <mml:mo class="MathClass-open">[</mml:mo>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mover accent="true">
                          <mml:mrow>
                            <mml:mi>F</mml:mi>
                          </mml:mrow>
                          <mml:mo> ^</mml:mo>
                        </mml:mover>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>i</mml:mi>
                        <mml:mo class="MathClass-bin">+</mml:mo>
                        <mml:mi>f</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo class="MathClass-rel">=</mml:mo>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mover accent="true">
                          <mml:mrow>
                            <mml:mi>R</mml:mi>
                          </mml:mrow>
                          <mml:mo> ^</mml:mo>
                        </mml:mover>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>i</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                  </mml:mrow>
                  <mml:mo class="MathClass-close">]</mml:mo>
                </mml:mrow>
                <mml:mspace width="2em"/>
              </mml:mtd>
            </mml:mtr>
            <mml:mtr>
              <mml:mtd columnalign="right" class="align-odd"/>
              <mml:mtd class="align-even">
                <mml:mspace width="1em" class="quad"/>
                <mml:mo class="MathClass-bin">⋅</mml:mo>
                <mml:munder class="msub">
                  <mml:mrow>
                    <mml:mo mathsize="big">∏</mml:mo>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>i</mml:mi>
                    <mml:mo class="MathClass-rel">=</mml:mo>
                    <mml:mn>1</mml:mn>
                    <mml:mo>…</mml:mo>
                    <mml:mi>r</mml:mi>
                  </mml:mrow>
                </mml:munder>
                <mml:mtext>Pr</mml:mtext>
                <mml:mrow>
                  <mml:mo class="MathClass-open">[</mml:mo>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>R</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>i</mml:mi>
                        <mml:mo class="MathClass-bin">+</mml:mo>
                        <mml:mi>c</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                  </mml:mrow>
                  <mml:mo class="MathClass-close">]</mml:mo>
                </mml:mrow>
                <mml:mspace width="2em"/>
              </mml:mtd>
            </mml:mtr>
            <mml:mtr>
              <mml:mtd columnalign="right" class="align-odd"/>
              <mml:mtd class="align-even">
                <mml:mspace width="2em"/>
              </mml:mtd>
            </mml:mtr>
          </mml:mtable>
        </mml:math>
      </disp-formula>
    </p>
    <p>where <inline-formula><mml:math id="M9" name="1471-2105-13-31-i12" overflow="scroll"><mml:mtext>Pr</mml:mtext><mml:mrow><mml:mo class="MathClass-open">[</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo class="MathClass-close">]</mml:mo></mml:mrow><mml:mo class="MathClass-rel">=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:mfrac></mml:math></inline-formula> and <inline-formula><mml:math id="M10" name="1471-2105-13-31-i13" overflow="scroll"><mml:mtext>Pr</mml:mtext><mml:mrow><mml:mo class="MathClass-open">[</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo class="MathClass-close">]</mml:mo></mml:mrow><mml:mo class="MathClass-rel">=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:mfrac></mml:math></inline-formula> and the remainder is as above with e fixed at a value determined empirically to be the average error rate. This value of <italic>ϵ </italic>was calculated by counting the mismatch rate in known index tags in a defined community data set (described below). This parameter need not be retuned as it is only an estimate of the error. Because the index read is short and sequenced earlier in the process, it likely has fewer errors and, therefore, its error rate should underestimate the true error rate. Regardless, the error rate specified for this step should not negatively affect the ability of PANDAseq to identify the best overlap for the forward and reverse reads.</p>
    <p>Once the overlap is selected, the output sequence is constructed and an overall quality score is calculated. During this process, the primer regions are disregarded if primers were specified. The unpaired regions are copied from the available strands and the quality score for these regions is the product of the probability of those bases being correct. For the overlapping region, the decision-making process is more complex. If the bases agree, the base is included and the quality of this base is assumed to be <inline-formula><mml:math id="M11" name="1471-2105-13-31-i14" overflow="scroll"><mml:mtext>Pr</mml:mtext><mml:mrow><mml:mo class="MathClass-open">[</mml:mo><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mo class="MathClass-op"> ^</mml:mo></mml:mover><mml:mo class="MathClass-rel">=</mml:mo><mml:mi>Ŷ</mml:mi><mml:mo class="MathClass-rel">|</mml:mo><mml:mi>X</mml:mi><mml:mo class="MathClass-rel">=</mml:mo><mml:mi>Y</mml:mi></mml:mrow><mml:mo class="MathClass-close">]</mml:mo></mml:mrow></mml:math></inline-formula>. If the bases disagree, the base with the higher quality score is chosen and the quality of this base is assumed to be <inline-formula><mml:math id="M12" name="1471-2105-13-31-i15" overflow="scroll"><mml:mtext>Pr</mml:mtext><mml:mrow><mml:mo class="MathClass-open">[</mml:mo><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mo class="MathClass-op"> ^</mml:mo></mml:mover><mml:mo class="MathClass-rel">=</mml:mo><mml:mi>Ŷ</mml:mi><mml:mo class="MathClass-rel">|</mml:mo><mml:mi>X</mml:mi><mml:mo class="MathClass-rel">≠</mml:mo><mml:mi>Y</mml:mi></mml:mrow><mml:mo class="MathClass-close">]</mml:mo></mml:mrow></mml:math></inline-formula>. If either or both bases are uncalled, they are considered to always match, noting that unassigned bases are always associated with the lowest quality score by CASAVA [<xref ref-type="bibr" rid="B8">8</xref>].</p>
    <p>In certain cases, the CASAVA pipeline masks the quality score at the end of the read, replacing all quality scores with the lowest quality score [<xref ref-type="bibr" rid="B8">8</xref>]. In this case, special quality scoring is used by PANDAseq. If one base is masked, the probability of the other base is used if the bases match or uniformly random, <inline-formula><mml:math id="M13" name="1471-2105-13-31-i4" overflow="scroll"><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:mfrac></mml:math></inline-formula>, is used if they do not match. If both are in the masked region, the quality is assumed to be uniformly random, <inline-formula><mml:math id="M14" name="1471-2105-13-31-i4" overflow="scroll"><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:mfrac></mml:math></inline-formula>.</p>
    <p>The constructed sequence can then be validated against user-specified criteria. The quality score assigned to the assembled sequence is the geometric mean of the quality scores calculated above, which compensates for the variable lengths of the final sequences. PANDAseq enables users to reject sequences based on low quality score, lengths that are too short or too long, or the presence of uncalled bases. A module system is also available within PANDAseq to allow more sophisticated validation of user sequences, such as verification of known secondary structure or conserved regions. Note that there is a detailed manual included with the software that describes example usage scenarios.</p>
  </sec>
  <sec>
    <title>Results and discussion</title>
    <p>To validate PANDAseq, we used three experimental tests: (1) a test using simulated data to verify algorithmic correctness, (2) a test using sequence data from a single-template PCR amplicon to verify the quality of assembled reads, and (3) a test with experimental data obtained from a defined mixture of genomic DNA fragments to compare PANDAseq assembly yields with naïve assembly.</p>
    <p>Simulated data was useful in determining how real quality scores affect sequence assembly. We used a previously published Illumina sequencing run of V3 hypervariable regions from a defined library (described below) [<xref ref-type="bibr" rid="B1">1</xref>] and replaced the sequence with the corresponding region from <italic>Sinorhizobium meliloti </italic>(135 bases, region amplified by 341f and 518r excluding primers [<xref ref-type="bibr" rid="B9">9</xref>]), up to the length of the original reads. Although this V3 sequence was taken from the published genome, it corresponds to the region being sequenced in the experimental data such that any sequencing quality problems due to secondary structure are preserved. This provides simulated error-free reads with experimental quality scores. Though the assembly was then performed without a quality filter, all 1 350 602 synthesized paired-end sequences assembled with quality scores greater than 0.9 (Figure <xref ref-type="fig" rid="F2">2</xref>). This value establishes an upper limit on the quality score independent of sequencing errors; that is, setting the quality threshold higher than 0.9 would demand that reads have fewer errors than data known to be perfectly correct and is, in effect, demanding the underlying read quality be better than is necessary to reconstruct the sequence.</p>
    <fig id="F2" position="float">
      <label>Figure 2</label>
      <caption>
        <p><bold>Quality scores of assembled masked data</bold>. A perfect 16S rRNA sequence from <italic>Sinorhizobium meliloti </italic>was masked using real Illumina quality scores and the resulting paired-end sequences were assembled with PANDAseq. A histogram of quality scores for the assembled sequences is shown.</p>
      </caption>
      <graphic xlink:href="1471-2105-13-31-2"/>
    </fig>
    <p>Further analysis was performed on a library constructed from a <italic>Methylococcus capsulatus </italic>(ATCC 33009) full length 16S rRNA gene amplification products cloned into the TOPO vector using the TOPO TA cloning kit (Invitrogen). The resulting construct was used as template for 16S rRNA gene amplification and sequencing on an Illumina GAIIx as previously described [<xref ref-type="bibr" rid="B1">1</xref>], with the exception of the PCR product gel excision and purification step, which used the Wizard SV Gel and PCR Clean-Up System (Promega). Sequencing produced 673 845 paired-end 108-base reads, available at <ext-link ext-link-type="uri" xlink:href="http://neufeldserver.uwaterloo.ca/~apmasell/pandaseq_sampledata.tar">http://neufeldserver.uwaterloo.ca/~apmasell/pandaseq_sampledata.tar</ext-link>. Of these, 598 775 sequences were assembled with an assembly quality score greater than or equal to 0.9. We assembled the same single-template data with a quality threshold of 0.6 and this increased the number of sequences assembled by 9%, yielding 652 249 sequences. The errors in the original, individual reads and the reconstructed sequences were counted and error information is shown in Table <xref ref-type="table" rid="T1">1</xref>. Only two reads contained uncalled bases and were excluded. PANDAseq improved the correctness of the reconstructed sequence relative to the original reads or preserved the correctness of good reads. Depending on the quality threshold, only about 0.02-0.08% of output read contained errors introduced by the PANDAseq assembly process, as calculated from the results in Table <xref ref-type="table" rid="T1">1</xref>; these introduced errors were substantially less than the 5-8% of sequences with errors corrected by PANDAseq. Given an assembly threshold of 0.9 as an upper limit, we then attempted to determine the lower limit for the quality threshold by looking at a comparable quality score of the unassembled reads. We determined the geometric mean of the read qualities of the sequences which assembled to be no lower than 0.7. Only 0.04% of reads had a quality score between 0.6 and 0.7. Therefore, if a sequence assembles, it is probably correct, given the quality of the underlying read, regardless of quality score.</p>
    <table-wrap id="T1" position="float">
      <label>Table 1</label>
      <caption>
        <p>Read error correction frequencies</p>
      </caption>
      <table frame="hsides" rules="groups">
        <thead>
          <tr>
            <th align="left">Quality (Geometric Mean)</th>
            <th align="right">0.9 - 1.0</th>
            <th align="right">0.6 - 0.9</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td align="left">Error-free Input and Output</td>
            <td align="right">544 669</td>
            <td align="right">21 095</td>
          </tr>
          <tr>
            <td align="left">All Errors Retained</td>
            <td align="right">4 023</td>
            <td align="right">4 675</td>
          </tr>
          <tr>
            <td align="left">Input Errors Reduced</td>
            <td align="right">50 082</td>
            <td align="right">27 668</td>
          </tr>
          <tr>
            <td align="left">Errors Introduced</td>
            <td align="right">0</td>
            <td align="right">37</td>
          </tr>
          <tr>
            <td colspan="3">
              <hr/>
            </td>
          </tr>
          <tr>
            <td align="left">Total</td>
            <td align="right">598 774</td>
            <td align="right">53 475</td>
          </tr>
        </tbody>
      </table>
      <table-wrap-foot>
        <p>Summary of error frequencies in assembled Illumina paired-end reads generated from sequenced V3-region amplicons of <italic>Methylococcus capsulatus </italic>strain Bath.</p>
        <p>All error data were analyzed solely within the region of overlap, which was relevant to PANDAseq assembly. Low-abundance "contamination" was observed in the dataset (data not shown), possibly due to reagents used for PCR. These will contribute to the counts of sequences that had errors that were retained. This category will also contain sequences in which both reads contain low-quality bases with quality scores masked by CASAVA.</p>
      </table-wrap-foot>
    </table-wrap>
    <p>We compared the quality of PANDAseq assembly against the existing assemblers: SHERA [<xref ref-type="bibr" rid="B10">10</xref>], iTags (using PHRAP) [<xref ref-type="bibr" rid="B3">3</xref>], and BIPES (using Merger) [<xref ref-type="bibr" rid="B6">6</xref>]. For this <italic>M. capsulatus </italic>library assembly, reads used still contained primers; primer removal was not a preprocessing step. If assembling sequences where the overlap region is large, it is possible that the end of one read would overlap the primer region of the other (see the highlyoverlapping scenario shown in Figure <xref ref-type="fig" rid="F1">1</xref>). PANDAseq assembled all sequences within 2 minutes 25 seconds, which is much faster than the second fastest method tested, SHERA, at 73 minutes. The other two programs were at least 100 times slower than PANDAseq. We were unable to use Merger on our test environment, a Macintosh Pro with 2 quad-core Intel Xeon 2.93 GHz processors, and so the BIPES assembler was run on a Linux machine with a quad-core Intel i5 3.2 GHz processor. Shown in Figure <xref ref-type="fig" rid="F3">3</xref> is a scatter plot of accuracy versus coverage for the four different methods we considered. PANDAseq assembles the fewest reads in the dataset, but was, by far, the most accurate. iTags/PHRAP was inferior in coverage and accuracy to BIPES/Merger and to SHERA (Figure <xref ref-type="fig" rid="F3">3</xref>). Comparing average errors in the output sequence, PANDAseq performed the best with 0.38 nucleotide errors per sequence as compared to a minimum of 1.08 errors per sequence for SHERA and BIPES. However, as mentioned previously, PANDAseq assembled the fewest sequences at 95.5% of the dataset. SHERA assembled all sequences in the dataset, but it is worth noting that, upon inspection, many of the products assembled exclusively by SHERA were incorrect as an erroneous overlap region had been selected (data not shown). The number of error-free sequences in the overlap region is shown in Table <xref ref-type="table" rid="T2">2</xref>. While SHERA has a larger number of sequences with correct overlaps, these represent a smaller fraction of the output compared to PANDAseq. Many of these sequences produced by SHERA with correct overlaps were rejected by PANDAseq due to low quality scores.</p>
    <fig id="F3" position="float">
      <label>Figure 3</label>
      <caption>
        <p><bold>Comparison of output of various assemblers</bold>. A scatter plot of the percentage of paired-end sequence assemblies from sequenced V3-region amplicons of <italic>Methylococcus capsulatus </italic>strain Bath against the average number of mismatching nucleotides between the assembled sequence and the reference sequence. The comparison was done between PANDAseq and three alternative assemblers (see text).</p>
      </caption>
      <graphic xlink:href="1471-2105-13-31-3"/>
    </fig>
    <table-wrap id="T2" position="float">
      <label>Table 2</label>
      <caption>
        <p>Number of sequences with correct overlap regions</p>
      </caption>
      <table frame="hsides" rules="groups">
        <thead>
          <tr>
            <th align="left">Assember</th>
            <th align="right">Correct Assemblies</th>
            <th align="right">Percentage of Output</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td align="left">PANDAseq</td>
            <td align="right">628 131</td>
            <td align="right">96.30</td>
          </tr>
          <tr>
            <td align="left">BIPES (Merger)</td>
            <td align="right">621 357</td>
            <td align="right">94.63</td>
          </tr>
          <tr>
            <td align="left">SHERA</td>
            <td align="right">637 646</td>
            <td align="right">92.35</td>
          </tr>
          <tr>
            <td align="left">iTags (PHRAP)</td>
            <td align="right">3 578</td>
            <td align="right">0.55</td>
          </tr>
        </tbody>
      </table>
      <table-wrap-foot>
        <p>Summary of the number of correct overlap sequences in assembled output from sequenced V3-region ampli-cons of <italic>Methylococcus capsulatus </italic>strain Bath.</p>
        <p>The percentage of sequences with error-free overlap regions is shown as a fraction of the total output for each assembler.</p>
      </table-wrap-foot>
    </table-wrap>
    <p>Finally, we used a composite of previously published duplicate control library [<xref ref-type="bibr" rid="B1">1</xref>], made from mixed pure bacterial cultures (NCBI SRA accession SRA024100), to compare naïve assembly and PANDAseq. In this composite library, the most abundant sequences are from the added pure cultures, but there are other contaminant sequences, likely from the growth media used [<xref ref-type="bibr" rid="B1">1</xref>]. We performed the naïve assembly with the software used previously [<xref ref-type="bibr" rid="B1">1</xref>] and the PANDAseq assembler, discarding any sequences with uncalled bases. The assembled sequences were clustered at 97% identity using CD-HIT [<xref ref-type="bibr" rid="B11">11</xref>] and abundance curves were generated from the resulting clustered operational taxonomic units (OTUs; Figure <xref ref-type="fig" rid="F4">4</xref>). At a threshold of 0.9, the number of sequences increased 3.9% in total over naıve assembly, yielding an average increase of 2.1% in the most abundant clusters. There were 83 OTUs in which PANDAseq had fewer sequences than naïve assembly: 71 of them were OTUs for which the naïve assembly found a single sequence, while the PANDAseq assembly found zero. Relaxing the quality threshold increased sequence recoveries substantially. When the quality threshold was reduced to 0.6, the total number of sequences increased by 50% and the number of sequences in the most abundant clusters increased by 85%. Even if the quality threshold was lowered below 0.6, no new OTU sequences were assembled by PANDAseq. New, low-abundance OTUs were formed from some of the additional sequences, which, although they do not match the pure-culture organisms, classify taxonomically using the RDP classifier [<xref ref-type="bibr" rid="B12">12</xref>,<xref ref-type="bibr" rid="B13">13</xref>] (data not shown).</p>
    <fig id="F4" position="float">
      <label>Figure 4</label>
      <caption>
        <p><bold>Rank abundance curves for control libraries</bold>. Rank-abundance curves for defined multi-organism libraries [<xref ref-type="bibr" rid="B1">1</xref>] assembled at two different quality thresholds using PANDAseq and naïve assembly followed by clustering with CD-HIT into OTUs of 97% identity.</p>
      </caption>
      <graphic xlink:href="1471-2105-13-31-4"/>
    </fig>
    <p>Assembling 1350 602 reads took just 364 seconds on a Macintosh Pro with 2 quad-core Intel Xeon 2.93 GHz processors. Profiling indicated that cache faults are the limiting factor in performance (data not shown), and the current design minimises cache faults during analysis of each sequence pair.</p>
    <p>There is a concern that, when making a choice between two disagreeing bases, the reconstructed sequence does not reflect the true sequence. For the control library, the disagreeing bases were dominated by mismatches in the quality-masked region of the reads, where both bases were of low quality and the decision would be arbitrary because there is no reasonable way to discern which base is better. In those cases, the entire reads are of low quality and likely to be discarded due to the quality threshold. However, mismatches generally occur between a base with a high quality score and a base with a low quality score, simplifying the choice of which base is correct. In control library data, only 20% of mismatched bases both had quality scores masked by CASAVA. Since the quality masked region must be quite long for this to occur, only few sequences suffer strongly from these mismatched quality-masked bases. This is due to the overlap region typically being longer than the quality-masked regions.</p>
  </sec>
  <sec sec-type="conclusions">
    <title>Conclusions</title>
    <p>PANDAseq produces additional high-quality assemblies from Illumina paired-end reads than naïve assembly for minimal computational cost and provided more rapid and higher quality results compared to existing assemblers. Error correction, particularly of uncalled bases, increases the number of assembled sequences. Although it is possible for PANDAseq to produce incorrect assemblies, most assemblies are correct because incorrect assemblies have low quality scores, as these mismatches occur in quality-masked regions of both reads, and are discarded. This software provides a versatile and powerful way to assemble paired-end Illumina reads without otherwise discarding high-quality sequence data.</p>
  </sec>
  <sec>
    <title>Availability and Requirements</title>
    <p><bold>Project name</bold>: PANDAseq</p>
    <p><bold>Project home page</bold>: <ext-link ext-link-type="uri" xlink:href="https://github.com/neufeld/pandaseq">https://github.com/neufeld/pandaseq</ext-link></p>
    <p><bold>Operating system(s)</bold>: POSIX-compliant (Windows, Linux, and MacOS)</p>
    <p><bold>Programming language</bold>: C</p>
    <p><bold>Other requirements</bold>: None</p>
    <p><bold>License</bold>: GNU GPL</p>
    <p><bold>Any restrictions to use by non-academics</bold>:</p>
    <p>None</p>
  </sec>
  <sec>
    <title>Authors' contributions</title>
    <p>The program requirements and experimental framework were developed by JDN and APM. The PANDAseq software was written by APM. The libraries used were constructed by AKB. Analysis and development of the error models was shared by JMT and DGB. All authors have read and approved the final version of the manuscript.</p>
  </sec>
</body>
<back>
  <sec>
    <title>Acknowledgements</title>
    <p>This research was supported by the Natural Sciences and Engineering Research Council of Canada, through Discovery Grants to JDN and to DGB and through a Strategic Projects Grant to JDN, and by Early Researcher Awards from the Government of Ontario to JDN and to DGB.</p>
  </sec>
  <ref-list>
    <ref id="B1">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Bartram</surname>
          <given-names>AK</given-names>
        </name>
        <name>
          <surname>Lynch</surname>
          <given-names>MDJ</given-names>
        </name>
        <name>
          <surname>Stearns</surname>
          <given-names>JC</given-names>
        </name>
        <name>
          <surname>Moreno-Hagelsieb</surname>
          <given-names>G</given-names>
        </name>
        <name>
          <surname>Neufeld</surname>
          <given-names>JD</given-names>
        </name>
        <article-title>Generation of multimillion-sequence 16S rRNA gene libraries from complex microbial communities by assembling paired-end Illumina reads</article-title>
        <source>Appl Environ Microbiol</source>
        <year>2011</year>
        <volume>77</volume>
        <fpage>3846</fpage>
        <lpage>3852</lpage>
        <ext-link ext-link-type="uri" xlink:href="http://aem.asm.org/cgi/content/abstract/77/11/3846">http://aem.asm.org/cgi/content/abstract/77/11/3846</ext-link>
        <pub-id pub-id-type="doi">10.1128/AEM.02772-10</pub-id>
        <pub-id pub-id-type="pmid">21460107</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B2">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Gloor</surname>
          <given-names>GB</given-names>
        </name>
        <name>
          <surname>Hummelen</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Macklaim</surname>
          <given-names>JM</given-names>
        </name>
        <name>
          <surname>Dickson</surname>
          <given-names>RJ</given-names>
        </name>
        <name>
          <surname>Fernandes</surname>
          <given-names>AD</given-names>
        </name>
        <name>
          <surname>MacPhee</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Reid</surname>
          <given-names>G</given-names>
        </name>
        <article-title>Microbiome Profiling by Illumina sequencing of combinatorial sequence-tagged PCR products</article-title>
        <source>PLoS ONE</source>
        <year>2010</year>
        <volume>5</volume>
        <fpage>e15406</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0015406</pub-id>
        <pub-id pub-id-type="pmid">21048977</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B3">
      <mixed-citation publication-type="other">
        <name>
          <surname>Degnan</surname>
          <given-names>PH</given-names>
        </name>
        <name>
          <surname>Ochman</surname>
          <given-names>H</given-names>
        </name>
        <article-title>Illumina-based analysis of microbial community diversity</article-title>
        <source>ISME J</source>
        <year>2011</year>
        <ext-link ext-link-type="uri" xlink:href="http://www.nature.com/ismej/journal/v6/n1/full/ismej201174a.html">http://www.nature.com/ismej/journal/v6/n1/full/ismej201174a.html</ext-link>
      </mixed-citation>
    </ref>
    <ref id="B4">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Caporaso</surname>
          <given-names>JG</given-names>
        </name>
        <name>
          <surname>Lauber</surname>
          <given-names>CL</given-names>
        </name>
        <name>
          <surname>Walters</surname>
          <given-names>WA</given-names>
        </name>
        <name>
          <surname>Berg-Lyons</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Lozupone</surname>
          <given-names>CA</given-names>
        </name>
        <name>
          <surname>Turnbaugh</surname>
          <given-names>PJ</given-names>
        </name>
        <name>
          <surname>Fierer</surname>
          <given-names>N</given-names>
        </name>
        <name>
          <surname>Knight</surname>
          <given-names>R</given-names>
        </name>
        <article-title>Global patterns of 16S rRNA diversity at a depth of millions of sequences per sample</article-title>
        <source>Proc Natl Acad Sci USA</source>
        <year>2011</year>
        <volume>108</volume>
        <issue>Suppl 1</issue>
        <fpage>4516</fpage>
        <lpage>4522</lpage>
        <ext-link ext-link-type="uri" xlink:href="http://genomebiology.com/2011/12/5/R50">http://genomebiology.com/2011/12/5/R50</ext-link>
        <pub-id pub-id-type="pmid">20534432</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B5">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Needleman</surname>
          <given-names>SB</given-names>
        </name>
        <name>
          <surname>Wunsch</surname>
          <given-names>CD</given-names>
        </name>
        <article-title>A general method applicable to the search for similarities in the amino acid sequence of two proteins</article-title>
        <source>J Mol Biol</source>
        <year>1970</year>
        <volume>48</volume>
        <fpage>443</fpage>
        <lpage>453</lpage>
        <pub-id pub-id-type="doi">10.1016/0022-2836(70)90057-4</pub-id>
        <pub-id pub-id-type="pmid">5420325</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B6">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Zhou</surname>
          <given-names>HW</given-names>
        </name>
        <name>
          <surname>Li</surname>
          <given-names>DF</given-names>
        </name>
        <name>
          <surname>Tam</surname>
          <given-names>NF</given-names>
        </name>
        <name>
          <surname>Jiang</surname>
          <given-names>XT</given-names>
        </name>
        <name>
          <surname>Zhang</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>Sheng</surname>
          <given-names>HF</given-names>
        </name>
        <name>
          <surname>Qin</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Liu</surname>
          <given-names>X</given-names>
        </name>
        <name>
          <surname>Zou</surname>
          <given-names>F</given-names>
        </name>
        <article-title>BIPES, a cost-effective high-throughput method for assessing microbial diversity</article-title>
        <source>ISME J</source>
        <year>2011</year>
        <volume>5</volume>
        <fpage>741</fpage>
        <lpage>749</lpage>
        <ext-link ext-link-type="uri" xlink:href="http://www.nature.com/ismej/journal/v5/n4/abs/ismej2010160a.html">http://www.nature.com/ismej/journal/v5/n4/abs/ismej2010160a.html</ext-link>
        <pub-id pub-id-type="doi">10.1038/ismej.2010.160</pub-id>
        <pub-id pub-id-type="pmid">20962877</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B7">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Cock</surname>
          <given-names>PJA</given-names>
        </name>
        <name>
          <surname>Fields</surname>
          <given-names>CJ</given-names>
        </name>
        <name>
          <surname>Goto</surname>
          <given-names>N</given-names>
        </name>
        <name>
          <surname>Heuer</surname>
          <given-names>ML</given-names>
        </name>
        <name>
          <surname>Rice</surname>
          <given-names>PM</given-names>
        </name>
        <article-title>The Sanger FASTQ file format for sequences with quality scores, and the Solexa/Illumina FASTQ variants</article-title>
        <source>Nucleic Acids Res</source>
        <year>2010</year>
        <volume>38</volume>
        <issue>6</issue>
        <fpage>1767</fpage>
        <lpage>1771</lpage>
        <ext-link ext-link-type="uri" xlink:href="http://nar.oxfordjournals.org/content/38/6/1767.abstract">http://nar.oxfordjournals.org/content/38/6/1767.abstract</ext-link>
        <pub-id pub-id-type="doi">10.1093/nar/gkp1137</pub-id>
        <pub-id pub-id-type="pmid">20015970</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B8">
      <mixed-citation publication-type="book">
        <collab>Illumina, Inc</collab>
        <source>CASAVA Software Version 1.7 User Guide</source>
        <year>2010</year>
        <publisher-name>Illumina, Inc</publisher-name>
      </mixed-citation>
    </ref>
    <ref id="B9">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Muyzer</surname>
          <given-names>G</given-names>
        </name>
        <name>
          <surname>de Waal</surname>
          <given-names>EC</given-names>
        </name>
        <name>
          <surname>Uitterlinden</surname>
          <given-names>AG</given-names>
        </name>
        <article-title>Profiling of complex microbial populations by denaturing gradient gel electrophoresis analysis of polymerase chain reaction-amplified genes coding for 16S rRNA</article-title>
        <source>Appl Environ Microbiol</source>
        <year>1993</year>
        <volume>59</volume>
        <fpage>695</fpage>
        <lpage>700</lpage>
        <ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/pmc/articles/PMC202176/">http://www.ncbi.nlm.nih.gov/pmc/articles/PMC202176/</ext-link>
        <pub-id pub-id-type="pmid">7683183</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B10">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Rodrigue</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Materna</surname>
          <given-names>AC</given-names>
        </name>
        <name>
          <surname>Timberlake</surname>
          <given-names>SC</given-names>
        </name>
        <name>
          <surname>Blackburn</surname>
          <given-names>MC</given-names>
        </name>
        <name>
          <surname>Malmstrom</surname>
          <given-names>RR</given-names>
        </name>
        <name>
          <surname>Alm</surname>
          <given-names>EJ</given-names>
        </name>
        <name>
          <surname>Chisholm</surname>
          <given-names>SW</given-names>
        </name>
        <article-title>Unlocking short read sequencing for metagenomics</article-title>
        <source>PLoS ONE</source>
        <year>2010</year>
        <volume>5</volume>
        <fpage>e11840</fpage>
        <ext-link ext-link-type="uri" xlink:href="http://www.plosone.org/article/info%3Adoi%2F10.1371%2Fjournal.pone.0011840">http://www.plosone.org/article/info%3Adoi%2F10.1371%2Fjournal.pone.0011840</ext-link>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0011840</pub-id>
        <pub-id pub-id-type="pmid">20676378</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B11">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Li</surname>
          <given-names>W</given-names>
        </name>
        <name>
          <surname>Godzik</surname>
          <given-names>A</given-names>
        </name>
        <article-title>Cd-hit: a fast program for clustering and comparing large sets of protein or nucleotide sequences</article-title>
        <source>Bioinformatics</source>
        <year>2006</year>
        <volume>22</volume>
        <fpage>1658</fpage>
        <lpage>1659</lpage>
        <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/content/22/13/1658.long">http://bioinformatics.oxfordjournals.org/content/22/13/1658.long</ext-link>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btl158</pub-id>
        <pub-id pub-id-type="pmid">16731699</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B12">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Cole</surname>
          <given-names>JR</given-names>
        </name>
        <name>
          <surname>Wang</surname>
          <given-names>Q</given-names>
        </name>
        <name>
          <surname>Cardenas</surname>
          <given-names>E</given-names>
        </name>
        <name>
          <surname>Fish</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Chai</surname>
          <given-names>B</given-names>
        </name>
        <name>
          <surname>Farris</surname>
          <given-names>RJ</given-names>
        </name>
        <name>
          <surname>Kulam-Syed-Mohideen</surname>
          <given-names>AS</given-names>
        </name>
        <name>
          <surname>McGarrell</surname>
          <given-names>DM</given-names>
        </name>
        <name>
          <surname>Marsh</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Garrity</surname>
          <given-names>GM</given-names>
        </name>
        <name>
          <surname>Tiedje</surname>
          <given-names>JM</given-names>
        </name>
        <article-title>The Ribosomal Database Project: improved alignments and new tools for rRNA analysis</article-title>
        <source>Nucleic Acids Res</source>
        <year>2009</year>
        <volume>37</volume>
        <issue>Database issue</issue>
        <fpage>D141</fpage>
        <lpage>145</lpage>
        <pub-id pub-id-type="pmid">19004872</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B13">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Cole</surname>
          <given-names>JR</given-names>
        </name>
        <name>
          <surname>Chai</surname>
          <given-names>B</given-names>
        </name>
        <name>
          <surname>Farris</surname>
          <given-names>RJ</given-names>
        </name>
        <name>
          <surname>Wang</surname>
          <given-names>Q</given-names>
        </name>
        <name>
          <surname>Kulam-Syed-Mohideen</surname>
          <given-names>AS</given-names>
        </name>
        <name>
          <surname>McGarrell</surname>
          <given-names>DM</given-names>
        </name>
        <name>
          <surname>Bandela</surname>
          <given-names>AM</given-names>
        </name>
        <name>
          <surname>Cardenas</surname>
          <given-names>E</given-names>
        </name>
        <name>
          <surname>Garrity</surname>
          <given-names>GM</given-names>
        </name>
        <name>
          <surname>Tiedje</surname>
          <given-names>JM</given-names>
        </name>
        <article-title>The ribosomal database project (RDP-II): introducing myRDP space and quality controlled public data</article-title>
        <source>Nucleic Acids Res</source>
        <year>2007</year>
        <volume>35</volume>
        <issue>Database issue</issue>
        <fpage>D169</fpage>
        <lpage>172</lpage>
        <pub-id pub-id-type="pmid">17090583</pub-id>
      </mixed-citation>
    </ref>
  </ref-list>
</back>
