<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10919945</article-id>
    <article-id pub-id-type="pmid">37963064</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btad681</article-id>
    <article-id pub-id-type="publisher-id">btad681</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Note</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Genome Analysis</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>EMVC-2: an efficient single-nucleotide variant caller based on expectation maximization</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-6125-5603</contrib-id>
        <name>
          <surname>Dufort y Álvarez</surname>
          <given-names>Guillermo</given-names>
        </name>
        <aff><institution>INCO, Facultad de Ingeniería, Universidad de la República</institution>, Montevideo 11300, <country country="UY">Uruguay</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Xargay-Ferrer</surname>
          <given-names>Martí</given-names>
        </name>
        <aff><institution>SPCOM Group, Universitat Politècnica de Catalunya – BarcelonaTech (UPC)</institution>, 08034 Barcelona, <country country="ES">Spain</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Pagès-Zamora</surname>
          <given-names>Alba</given-names>
        </name>
        <aff><institution>SPCOM Group, Universitat Politècnica de Catalunya – BarcelonaTech (UPC)</institution>, 08034 Barcelona, <country country="ES">Spain</country></aff>
        <xref rid="btad681-cor1" ref-type="corresp"/>
        <!--alba.pages@upc.edu-->
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Ochoa</surname>
          <given-names>Idoia</given-names>
        </name>
        <aff><institution>Department of Electrical Engineering, Tecnun, University of Navarra</institution>, 20018 Donostia, <country country="ES">Spain</country></aff>
        <xref rid="btad681-cor2" ref-type="corresp"/>
        <!--iochoal@unav.es-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Kendziorski</surname>
          <given-names>Christina</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btad681-cor1">Corresponding authors. SPCOM Group, Universitat Politècnica de Catalunya – BarcelonaTech (UPC), Campus Nord D5 C/ Jordi Girona 1-3, 08034 Barcelona, Spain. E-mail: <email>alba.pages@upc.edu</email> (A.P.-Z.)</corresp>
      <corresp id="btad681-cor2">Department of Electrical Engineering, Tecnun, University of Navarra, Manuel Lardizabal Ibilbidea, 13, 20018 Donostia, Spain. E-mail: <email>iochoal@unav.es</email> (I.O.)</corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>3</month>
      <year>2024</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2023-11-14">
      <day>14</day>
      <month>11</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>14</day>
      <month>11</month>
      <year>2023</year>
    </pub-date>
    <volume>40</volume>
    <issue>3</issue>
    <elocation-id>btad681</elocation-id>
    <history>
      <date date-type="received">
        <day>06</day>
        <month>7</month>
        <year>2023</year>
      </date>
      <date date-type="rev-recd">
        <day>18</day>
        <month>10</month>
        <year>2023</year>
      </date>
      <date date-type="editorial-decision">
        <day>01</day>
        <month>11</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>13</day>
        <month>11</month>
        <year>2023</year>
      </date>
      <date date-type="corrected-typeset">
        <day>07</day>
        <month>3</month>
        <year>2024</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2023</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btad681.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>Single-nucleotide variants (SNVs) are the most common type of genetic variation in the human genome. Accurate and efficient detection of SNVs from next-generation sequencing (NGS) data is essential for various applications in genomics and personalized medicine. However, SNV calling methods usually suffer from high computational complexity and limited accuracy. In this context, there is a need for new methods that overcome these limitations and provide fast reliable results.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>We present EMVC-2, a novel method for SNV calling from NGS data. EMVC-2 uses a multi-class ensemble classification approach based on the expectation–maximization algorithm that infers at each locus the most likely genotype from multiple labels provided by different learners. The inferred variants are then validated by a decision tree that filters out unlikely ones. We evaluate EMVC-2 on several publicly available real human NGS data for which the set of SNVs is available, and demonstrate that it outperforms state-of-the-art variant callers in terms of accuracy and speed, on average.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>EMVC-2 is coded in C and Python, and is freely available for download at: <ext-link xlink:href="https://github.com/guilledufort/EMVC-2" ext-link-type="uri">https://github.com/guilledufort/EMVC-2</ext-link>. EMVC-2 is also available in Bioconda.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Universidad de la República; Ramon y Cajal</institution>
          </institution-wrap>
        </funding-source>
        <award-id>RYC2019-028578-I</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Gipuzkoa Fellows</institution>
          </institution-wrap>
        </funding-source>
        <award-id>2022-FELL-000003–01</award-id>
        <award-id>PID2021-126718OA-I00</award-id>
        <award-id>PID2019-104958RB-C41</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="3"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Next-generation sequencing (NGS) has become indispensable in several fields, specially in personalized medicine. Analysis of NGS data normally starts with variant calling, which consists of identifying the differences or <italic toggle="yes">variants</italic> between the sequenced genome and a reference genome of the same species. Most common variants are in the form of single-nucleotide variants (SNVs) and short insertions or deletions (INDELs). SNVs and INDELs can have significant effects on individuals from a clinical setting perspective, e.g. higher risk of certain diseases, predisposition to certain types of cancer, or impact on drug metabolism and response. Thus, it is crucial to design efficient variant callers that accurately identify an individual’s variants.</p>
    <p>Available variant callers are still not 100% accurate, and some suffer from high computational complexity. Here, we build upon the previously proposed SNV caller EMVC (<xref rid="btad681-B7" ref-type="bibr">Pagès-Zamora <italic toggle="yes">et al.</italic> 2022</xref>) to provide an efficient and accurate variant caller competitive with the state-of-the-art. The main improvements of EMVC-2 include the addition of a decision tree model to filter out incorrectly inferred variants, and a fast and efficient implementation of the algorithm that is publicly available and ready to use by the community.</p>
  </sec>
  <sec>
    <title>2 Methods and experimental results</title>
    <p>The EMVC-2 method presented here consists of two steps. Firstly, a set of SNV candidates is identified by the EMVC algorithm presented in our previous work (<xref rid="btad681-B7" ref-type="bibr">Pagès-Zamora <italic toggle="yes">et al.</italic> 2022</xref>), which solves the variant calling problem as an unsupervised multi-class ensemble classification task using the expectation–maximization (EM) based iterative approach (<xref rid="btad681-B2" ref-type="bibr">Dempster <italic toggle="yes">et al.</italic> 1997</xref>). Indeed, the EMVC algorithm is an ensemble classifier, meaning that it combines tags provided by numerous individual classifiers taking into account their reliability, which is inferred by the algorithm itself. Furthermore, EMVC is an unsupervised algorithm, as it operates without the need for labeled ground-truth data for training, and it is a multi-class classifier, as opposed to a binary one since it sorts the observed data into more than two classes. Briefly, EMVC proceeds as follows. For each locus or position in the genome, EMVC estimates the posterior probability of ten classes, each corresponding to one of the possible genotypes <inline-formula id="IE1"><mml:math id="IM1" display="inline" overflow="scroll"><mml:mrow><mml:mo>{</mml:mo><mml:mi>A</mml:mi><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:mi>G</mml:mi><mml:mi>G</mml:mi><mml:mo>,</mml:mo><mml:mi>T</mml:mi><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mi>A</mml:mi><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:mi>A</mml:mi><mml:mi>G</mml:mi><mml:mo>,</mml:mo><mml:mi>A</mml:mi><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi><mml:mi>G</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mi>G</mml:mi><mml:mi>T</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula>. The class with the highest probability is selected. A position is marked as an SNV candidate if the decided genotype for that position differs from the reference in at least one nucleotide. Secondly, EMVC-2 uses a Decision Tree Classifier (DTC) (<xref rid="btad681-B8" ref-type="bibr">Pedregosa <italic toggle="yes">et al.</italic> 2011</xref>) to filter the untrue SNV candidates identified in the first step. A DTC is chosen as models based on DTs have been shown to discriminate well between true and false called variants in similar settings (<xref rid="btad681-B10" ref-type="bibr">Zhang and Ochoa 2020</xref>, <xref rid="btad681-B1" ref-type="bibr">Cooke <italic toggle="yes">et al.</italic> 2021</xref>). Moreover, we refrain from using more complex models such as neural networks due to overfitting concerns. The DTC takes a set of features for each SNV candidate as input and decides whether to keep the SNV or not. The selected features are the genotype; the depth, which is the number of reads that map to that position; the percentage of reads at that position with an alternate nucleotide, i.e. different from the reference; and the entropy of the class probability distribution estimated in the first step, where lower entropy means higher confidence in the selected class. The DTC is trained on a 15×-coverage pair-end Whole Genome Sequenced (WGS) dataset for which the set of true SNVs is known and assumed to be correct (see <xref rid="sup1" ref-type="supplementary-material">Supplementary Material</xref>). We use a DTC with a low tree depth of 5 to prevent overfitting and to capture general statistical patterns. The training results show that the class entropy and the percentage of alternate nucleotides at the position are the key features for filtering out untrue variants. See <xref rid="sup1" ref-type="supplementary-material">Supplementary Material</xref> for more details on the method.</p>
    <p>The proposed method EMVC-2 is evaluated using a collection of public human NGS datasets with a coverage between 15× and 30× from different subjects for which a <italic toggle="yes">ground truth</italic> or set of true SNVs is available. <xref rid="btad681-T1" ref-type="table">Table 1</xref> summarizes the characteristics of the datasets, such as coverage, subject ID, and size. Data availability information is detailed in the <xref rid="sup1" ref-type="supplementary-material">Supplementary Material</xref>.</p>
    <table-wrap position="float" id="btad681-T1">
      <label>Table 1.</label>
      <caption>
        <p>Recall, precision, and f1-score of SNV callers EMVC-2, GATK, Platypus, and Strelka2 on different human datasets.<sup>a</sup></p>
      </caption>
      <table frame="hsides" rules="groups">
        <colgroup span="1">
          <col valign="top" align="left" span="1"/>
          <col valign="top" align="center" span="1"/>
          <col valign="top" align="center" span="1"/>
          <col valign="top" align="char" char="." span="1"/>
          <col valign="top" align="char" char="." span="1"/>
          <col valign="top" align="char" char="." span="1"/>
          <col valign="top" align="char" char="." span="1"/>
          <col valign="top" align="char" char="." span="1"/>
          <col valign="top" align="char" char="." span="1"/>
          <col valign="top" align="char" char="." span="1"/>
          <col valign="top" align="char" char="." span="1"/>
          <col valign="top" align="char" char="." span="1"/>
          <col valign="top" align="char" char="." span="1"/>
          <col valign="top" align="char" char="." span="1"/>
          <col valign="top" align="char" char="." span="1"/>
          <col valign="top" align="char" char="." span="1"/>
        </colgroup>
        <thead>
          <tr>
            <th rowspan="2" colspan="1">Dataset</th>
            <th rowspan="2" colspan="1">Coverage</th>
            <th rowspan="2" colspan="1">Subject ID</th>
            <th rowspan="2" colspan="1">Size (GB)</th>
            <th colspan="3" align="center" rowspan="1">EMVC-2<hr/></th>
            <th colspan="3" align="center" rowspan="1">GATK<hr/></th>
            <th colspan="3" align="center" rowspan="1">Platypus<hr/></th>
            <th colspan="3" align="center" rowspan="1">Strelka2<hr/></th>
          </tr>
          <tr>
            <th align="center" rowspan="1" colspan="1">Recall</th>
            <th align="center" rowspan="1" colspan="1">Precision</th>
            <th align="center" rowspan="1" colspan="1">f1-score</th>
            <th align="center" rowspan="1" colspan="1">Recall</th>
            <th align="center" rowspan="1" colspan="1">Precision</th>
            <th align="center" rowspan="1" colspan="1">f1-score</th>
            <th align="center" rowspan="1" colspan="1">Recall</th>
            <th align="center" rowspan="1" colspan="1">Precision</th>
            <th align="center" rowspan="1" colspan="1">f1-score</th>
            <th align="center" rowspan="1" colspan="1">Recall</th>
            <th align="center" rowspan="1" colspan="1">Precision</th>
            <th align="center" rowspan="1" colspan="1">f1-score</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td rowspan="1" colspan="1">
              <italic toggle="yes">ERR262997</italic>
            </td>
            <td rowspan="1" colspan="1">30×</td>
            <td rowspan="1" colspan="1">HG001</td>
            <td rowspan="1" colspan="1">104</td>
            <td rowspan="1" colspan="1">0.980</td>
            <td rowspan="1" colspan="1">0.981</td>
            <td rowspan="1" colspan="1">0.980</td>
            <td rowspan="1" colspan="1">0.975</td>
            <td rowspan="1" colspan="1">0.815</td>
            <td rowspan="1" colspan="1">0.888</td>
            <td rowspan="1" colspan="1">0.940</td>
            <td rowspan="1" colspan="1">
              <bold>0.993</bold>
            </td>
            <td rowspan="1" colspan="1">0.966</td>
            <td rowspan="1" colspan="1">
              <bold>0.985</bold>
            </td>
            <td rowspan="1" colspan="1">0.991</td>
            <td rowspan="1" colspan="1">
              <bold>0.988</bold>
            </td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">
              <italic toggle="yes">NovaSeq</italic>
            </td>
            <td rowspan="1" colspan="1">25×</td>
            <td rowspan="1" colspan="1">HG001</td>
            <td rowspan="1" colspan="1">49</td>
            <td rowspan="1" colspan="1">0.991</td>
            <td rowspan="1" colspan="1">0.989</td>
            <td rowspan="1" colspan="1">0.990</td>
            <td rowspan="1" colspan="1">
              <bold>0.994</bold>
            </td>
            <td rowspan="1" colspan="1">0.995</td>
            <td rowspan="1" colspan="1">
              <bold>0.995</bold>
            </td>
            <td rowspan="1" colspan="1">0.965</td>
            <td rowspan="1" colspan="1">0.995</td>
            <td rowspan="1" colspan="1">0.980</td>
            <td rowspan="1" colspan="1">0.991</td>
            <td rowspan="1" colspan="1">
              <bold>0.999</bold>
            </td>
            <td rowspan="1" colspan="1">
              <bold>0.995</bold>
            </td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">
              <italic toggle="yes">Ashkenazim son</italic>
            </td>
            <td rowspan="1" colspan="1">25×</td>
            <td rowspan="1" colspan="1">HG002</td>
            <td rowspan="1" colspan="1">48</td>
            <td rowspan="1" colspan="1">0.886</td>
            <td rowspan="1" colspan="1">0.937</td>
            <td rowspan="1" colspan="1">0.911</td>
            <td rowspan="1" colspan="1">
              <bold>0.913</bold>
            </td>
            <td rowspan="1" colspan="1">0.962</td>
            <td rowspan="1" colspan="1">
              <bold>0.937</bold>
            </td>
            <td rowspan="1" colspan="1">0.842</td>
            <td rowspan="1" colspan="1">
              <bold>0.983</bold>
            </td>
            <td rowspan="1" colspan="1">0.907</td>
            <td rowspan="1" colspan="1">0.840</td>
            <td rowspan="1" colspan="1">0.788</td>
            <td rowspan="1" colspan="1">0.813</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">
              <italic toggle="yes">pangenomics2</italic>
            </td>
            <td rowspan="1" colspan="1">30×</td>
            <td rowspan="1" colspan="1">HG002</td>
            <td rowspan="1" colspan="1">61</td>
            <td rowspan="1" colspan="1">0.991</td>
            <td rowspan="1" colspan="1">0.982</td>
            <td rowspan="1" colspan="1">0.986</td>
            <td rowspan="1" colspan="1">
              <bold>0.993</bold>
            </td>
            <td rowspan="1" colspan="1">0.996</td>
            <td rowspan="1" colspan="1">
              <bold>0.994</bold>
            </td>
            <td rowspan="1" colspan="1">0.964</td>
            <td rowspan="1" colspan="1">0.995</td>
            <td rowspan="1" colspan="1">0.979</td>
            <td rowspan="1" colspan="1">0.990</td>
            <td rowspan="1" colspan="1">
              <bold>0.999</bold>
            </td>
            <td rowspan="1" colspan="1">
              <bold>0.994</bold>
            </td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">
              <italic toggle="yes">pangenomics3</italic>
            </td>
            <td rowspan="1" colspan="1">30×</td>
            <td rowspan="1" colspan="1">HG003</td>
            <td rowspan="1" colspan="1">66</td>
            <td rowspan="1" colspan="1">
              <bold>0.991</bold>
            </td>
            <td rowspan="1" colspan="1">0.986</td>
            <td rowspan="1" colspan="1">0.988</td>
            <td rowspan="1" colspan="1">
              <bold>0.992</bold>
            </td>
            <td rowspan="1" colspan="1">0.996</td>
            <td rowspan="1" colspan="1">
              <bold>0.994</bold>
            </td>
            <td rowspan="1" colspan="1">0.964</td>
            <td rowspan="1" colspan="1">0.995</td>
            <td rowspan="1" colspan="1">0.979</td>
            <td rowspan="1" colspan="1">0.990</td>
            <td rowspan="1" colspan="1">
              <bold>0.999</bold>
            </td>
            <td rowspan="1" colspan="1">
              <bold>0.994</bold>
            </td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">
              <italic toggle="yes">pangenomics4</italic>
            </td>
            <td rowspan="1" colspan="1">30×</td>
            <td rowspan="1" colspan="1">HG004</td>
            <td rowspan="1" colspan="1">61</td>
            <td rowspan="1" colspan="1">0.991</td>
            <td rowspan="1" colspan="1">0.982</td>
            <td rowspan="1" colspan="1">0.986</td>
            <td rowspan="1" colspan="1">
              <bold>0.993</bold>
            </td>
            <td rowspan="1" colspan="1">0.996</td>
            <td rowspan="1" colspan="1">
              <bold>0.994</bold>
            </td>
            <td rowspan="1" colspan="1">0.965</td>
            <td rowspan="1" colspan="1">0.995</td>
            <td rowspan="1" colspan="1">0.980</td>
            <td rowspan="1" colspan="1">0.990</td>
            <td rowspan="1" colspan="1">
              <bold>0.999</bold>
            </td>
            <td rowspan="1" colspan="1">
              <bold>0.994</bold>
            </td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">
              <italic toggle="yes">Chinese Son</italic>
            </td>
            <td rowspan="1" colspan="1">15×</td>
            <td rowspan="1" colspan="1">HG005</td>
            <td rowspan="1" colspan="1">34</td>
            <td rowspan="1" colspan="1">
              <bold>0.971</bold>
            </td>
            <td rowspan="1" colspan="1">0.989</td>
            <td rowspan="1" colspan="1">0.980</td>
            <td rowspan="1" colspan="1">
              <bold>0.971</bold>
            </td>
            <td rowspan="1" colspan="1">0.993</td>
            <td rowspan="1" colspan="1">
              <bold>0.982</bold>
            </td>
            <td rowspan="1" colspan="1">0.934</td>
            <td rowspan="1" colspan="1">0.994</td>
            <td rowspan="1" colspan="1">0.963</td>
            <td rowspan="1" colspan="1">0.964</td>
            <td rowspan="1" colspan="1">
              <bold>0.993</bold>
            </td>
            <td rowspan="1" colspan="1">0.978</td>
          </tr>
          <tr>
            <td colspan="4" rowspan="1">Average</td>
            <td rowspan="1" colspan="1">0.971</td>
            <td rowspan="1" colspan="1">0.978</td>
            <td rowspan="1" colspan="1">
              <bold>0.975</bold>
            </td>
            <td rowspan="1" colspan="1">
              <bold>0.976</bold>
            </td>
            <td rowspan="1" colspan="1">0.965</td>
            <td rowspan="1" colspan="1">0.969</td>
            <td rowspan="1" colspan="1">0.939</td>
            <td rowspan="1" colspan="1">
              <bold>0.993</bold>
            </td>
            <td rowspan="1" colspan="1">0.965</td>
            <td rowspan="1" colspan="1">0.964</td>
            <td rowspan="1" colspan="1">0.967</td>
            <td rowspan="1" colspan="1">0.965</td>
          </tr>
        </tbody>
      </table>
      <table-wrap-foot>
        <fn id="tblfn1">
          <label>a</label>
          <p>Best results are highlighted in bold.</p>
        </fn>
      </table-wrap-foot>
    </table-wrap>
    <p>EMVC-2 is compared with three state-of-the-art variant callers: GATK (<xref rid="btad681-B6" ref-type="bibr">McKenna <italic toggle="yes">et al.</italic> 2010</xref>), Platypus (<xref rid="btad681-B9" ref-type="bibr">Rimmer <italic toggle="yes">et al.</italic> 2014</xref>), and Strelka2 (<xref rid="btad681-B3" ref-type="bibr">Kim <italic toggle="yes">et al.</italic> 2018</xref>). Each tool is run with its default configuration. For GATK, its best practice pipeline is followed, which involves aligning the data to the corresponding reference using bwa (<xref rid="btad681-B5" ref-type="bibr">Li and Durbin 2009</xref>), marking duplicates and re-calibrating quality scores with Picard, and calling variants with the HaplotypeCaller in GVCF mode. Note that EMVC-2, Platypus, and Strelka2 only require the alignment as a preprocessing step, which is also done with bwa. See <xref rid="sup1" ref-type="supplementary-material">Supplementary Material</xref> for additional details and specific commands, and for a comparison to EMVC (<xref rid="btad681-B7" ref-type="bibr">Pagès-Zamora <italic toggle="yes">et al.</italic> 2022</xref>). As shown in <xref rid="sup1" ref-type="supplementary-material">Table 4</xref> in the <xref rid="sup1" ref-type="supplementary-material">Supplementary Material</xref>, the proposed EMVC-2 method, which combines EMVC with a DTC, provides a higher f1-score than EMVC alone for all datasets considered.</p>
    <p>The <italic toggle="yes">hap.py</italic> pipeline (<xref rid="btad681-B4" ref-type="bibr">Krusche <italic toggle="yes">et al.</italic> 2018</xref>) is used to compare the VCFs generated by each tool with the ground truth and to compute three measures of accuracy: precision, recall, and f1-score. Precision is the fraction of true variants among all the variants called by a tool. Recall is the fraction of true variants that are correctly called by a tool. F1-score is the harmonic mean of precision and recall, and it reflects the overall accuracy of a tool.</p>
    <p>All experiments are conducted on a server with 80 64 bit x86 Intel Xeon CPUs, 503.5 GB of RAM memory, and CentOS Linux 7.7.1908; each tool is configured to run with the maximum number of threads.</p>
    <p>The performance of each tool on the selected datasets is provided in <xref rid="btad681-T1" ref-type="table">Table 1</xref>. The results indicate that EMVC-2 is the most accurate tool on average across all the datasets, with an average f1-score of 0.975, followed by GATK with an average f1-score of 0.969. Platypus has the highest precision on average (0.993), but it is much less sensitive than the other tools. On another note, both GATK and Strelka2 achieve the highest number of individual best f1-score results across the datasets, but lack the consistency achieved by EMVC-2 to be the best on average.</p>
    <p>The computational performance of the tools is assessed by measuring the processing speed, defined as the size of the dataset, in MB, divided by the time in seconds needed to obtain the variants after performing the alignment, and memory in GB required to process each dataset. In the experiments, Platypus was the fastest tool, with an average processing speed of 168 MB/s, followed by EMVC-2 with 53 MB/s, which was 3.7× times faster that Strelka2 and 106× times faster than GATK (see <xref rid="btad681-F1" ref-type="fig">Fig. 1</xref>). Strelka2 was the most memory-efficient, using a maximum of 0.6 GB of RAM during the processing of the datasets, while EMVC-2, Platypus, and GATK, used a maximum of 6.0, 3.59, and 39.4 GB of RAM, respectively. A comparison with EMVC is omitted due to a lack of an efficient implementation.</p>
    <fig position="float" id="btad681-F1">
      <label>Figure 1.</label>
      <caption>
        <p>Average f1-score versus processing speed for EMVC-2, GATK, Strelka2, and Platypus.</p>
      </caption>
      <graphic xlink:href="btad681f1" position="float"/>
    </fig>
    <p>In conclusion, EMVC-2 offers a great trade-off between SNV variant call accuracy and computational efficiency, thus adding to the available toolset of variant callers.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btad681_Supplementary_Data</label>
      <media xlink:href="btad681_supplementary_data.pdf"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <sec>
    <title>Supplementary data</title>
    <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics</italic> online.</p>
  </sec>
  <sec sec-type="COI-statement">
    <title>Conflict of interest</title>
    <p>None declared.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>This work was partially supported by Universidad de la República; Ramon y Cajal [contract number RYC2019-028578-I]; and Gipuzkoa Fellows [grant numbers 2022-FELL-000003–01, PID2021-126718OA-I00, PID2019-104958RB-C41] funded by MCIN/AEI/10.13039/501100011033.</p>
  </sec>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btad681-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Cooke</surname><given-names>DP</given-names></string-name>, <string-name><surname>Wedge</surname><given-names>DC</given-names></string-name>, <string-name><surname>Lunter</surname><given-names>G.</given-names></string-name></person-group><article-title>A unified haplotype-based method for accurate and comprehensive variant calling</article-title>. <source>Nat Biotechnol</source><year>2021</year>;<volume>39</volume>:<fpage>885</fpage>–<lpage>92</lpage>.<pub-id pub-id-type="pmid">33782612</pub-id></mixed-citation>
    </ref>
    <ref id="btad681-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Dempster</surname><given-names>AP</given-names></string-name>, <string-name><surname>Laird</surname><given-names>NM</given-names></string-name>, <string-name><surname>Rubin</surname><given-names>DB.</given-names></string-name></person-group><article-title>Maximum likelihood from incomplete data via the EM algorithm</article-title>. <source>J R Stat Soc Ser B (Methodological)</source><year>1977</year>;<volume>39</volume>:<fpage>1</fpage>–<lpage>22</lpage>.</mixed-citation>
    </ref>
    <ref id="btad681-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kim</surname><given-names>S</given-names></string-name>, <string-name><surname>Scheffler</surname><given-names>K</given-names></string-name>, <string-name><surname>Halpern</surname><given-names>A</given-names></string-name></person-group>, <etal>et al</etal><article-title>Strelka2: fast and accurate calling of germline and somatic variants</article-title>. <source>Nat Methods</source><year>2018</year>;<volume>15</volume>:<fpage>591</fpage>–<lpage>4</lpage>.<pub-id pub-id-type="pmid">30013048</pub-id></mixed-citation>
    </ref>
    <ref id="btad681-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Krusche</surname><given-names>P</given-names></string-name>, <string-name><surname>Trigg</surname><given-names>L</given-names></string-name>, <string-name><surname>Boutros</surname><given-names>P</given-names></string-name></person-group><etal>et al</etal>; <collab>Global Alliance for Genomics and Health Benchmarking Team</collab>. <article-title>Best practices for benchmarking germline small variant calls in human genomes</article-title>. <source>Nat Biotechnol</source><year>2018</year>;<volume>37</volume>:<fpage>555</fpage>–<lpage>60</lpage>.</mixed-citation>
    </ref>
    <ref id="btad681-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Li</surname><given-names>H</given-names></string-name>, <string-name><surname>Durbin</surname><given-names>R.</given-names></string-name></person-group><article-title>Fast and accurate short read alignment with Burrows–Wheeler transform</article-title>. <source>Bioinformatics</source><year>2009</year>;<volume>25</volume>:<fpage>1754</fpage>–<lpage>60</lpage>.<pub-id pub-id-type="pmid">19451168</pub-id></mixed-citation>
    </ref>
    <ref id="btad681-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>McKenna</surname><given-names>A</given-names></string-name>, <string-name><surname>Hanna</surname><given-names>M</given-names></string-name>, <string-name><surname>Banks</surname><given-names>E</given-names></string-name></person-group><etal>et al</etal><article-title>The genome analysis toolkit: a MapReduce framework for analyzing next-generation DNA sequencing data</article-title>. <source>Genome Res</source><year>2010</year>;<volume>20</volume>:<fpage>1297</fpage>–<lpage>303</lpage>.<pub-id pub-id-type="pmid">20644199</pub-id></mixed-citation>
    </ref>
    <ref id="btad681-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pagès-Zamora</surname><given-names>A</given-names></string-name>, <string-name><surname>Ochoa</surname><given-names>I</given-names></string-name>, <string-name><surname>Cavero</surname><given-names>G</given-names></string-name></person-group><etal>et al</etal><article-title>Unsupervised ensemble learning for genome sequencing</article-title>. <source>Patt Recognit</source><year>2022</year>;<volume>129</volume>:<fpage>108721</fpage>.</mixed-citation>
    </ref>
    <ref id="btad681-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pedregosa</surname><given-names>F</given-names></string-name>, <string-name><surname>Varoquaux</surname><given-names>G</given-names></string-name>, <string-name><surname>Gramfort</surname><given-names>A</given-names></string-name></person-group><etal>et al</etal><article-title>Scikit-learn: machine learning in Python</article-title>. <source>J Mach Learn Res</source><year>2011</year>;<volume>12</volume>:<fpage>2825</fpage>–<lpage>30</lpage>.</mixed-citation>
    </ref>
    <ref id="btad681-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Rimmer</surname><given-names>A</given-names></string-name>, <string-name><surname>Phan</surname><given-names>H</given-names></string-name>, <string-name><surname>Mathieson</surname><given-names>I</given-names></string-name></person-group><etal>et al</etal>; <collab>WGS500 Consortium</collab>. <article-title>Integrating mapping-, assembly-and haplotype-based approaches for calling variants in clinical sequencing applications</article-title>. <source>Nat Genet</source><year>2014</year>;<volume>46</volume>:<fpage>912</fpage>–<lpage>8</lpage>.<pub-id pub-id-type="pmid">25017105</pub-id></mixed-citation>
    </ref>
    <ref id="btad681-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhang</surname><given-names>C</given-names></string-name>, <string-name><surname>Ochoa</surname><given-names>I.</given-names></string-name></person-group><article-title>VEF: a variant filtering tool based on ensemble methods</article-title>. <source>Bioinformatics</source><year>2020</year>;<volume>36</volume>:<fpage>2328</fpage>–<lpage>36</lpage>.<pub-id pub-id-type="pmid">31873730</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10919945</article-id>
    <article-id pub-id-type="pmid">37963064</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btad681</article-id>
    <article-id pub-id-type="publisher-id">btad681</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Note</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Genome Analysis</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>EMVC-2: an efficient single-nucleotide variant caller based on expectation maximization</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-6125-5603</contrib-id>
        <name>
          <surname>Dufort y Álvarez</surname>
          <given-names>Guillermo</given-names>
        </name>
        <aff><institution>INCO, Facultad de Ingeniería, Universidad de la República</institution>, Montevideo 11300, <country country="UY">Uruguay</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Xargay-Ferrer</surname>
          <given-names>Martí</given-names>
        </name>
        <aff><institution>SPCOM Group, Universitat Politècnica de Catalunya – BarcelonaTech (UPC)</institution>, 08034 Barcelona, <country country="ES">Spain</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Pagès-Zamora</surname>
          <given-names>Alba</given-names>
        </name>
        <aff><institution>SPCOM Group, Universitat Politècnica de Catalunya – BarcelonaTech (UPC)</institution>, 08034 Barcelona, <country country="ES">Spain</country></aff>
        <xref rid="btad681-cor1" ref-type="corresp"/>
        <!--alba.pages@upc.edu-->
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Ochoa</surname>
          <given-names>Idoia</given-names>
        </name>
        <aff><institution>Department of Electrical Engineering, Tecnun, University of Navarra</institution>, 20018 Donostia, <country country="ES">Spain</country></aff>
        <xref rid="btad681-cor2" ref-type="corresp"/>
        <!--iochoal@unav.es-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Kendziorski</surname>
          <given-names>Christina</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btad681-cor1">Corresponding authors. SPCOM Group, Universitat Politècnica de Catalunya – BarcelonaTech (UPC), Campus Nord D5 C/ Jordi Girona 1-3, 08034 Barcelona, Spain. E-mail: <email>alba.pages@upc.edu</email> (A.P.-Z.)</corresp>
      <corresp id="btad681-cor2">Department of Electrical Engineering, Tecnun, University of Navarra, Manuel Lardizabal Ibilbidea, 13, 20018 Donostia, Spain. E-mail: <email>iochoal@unav.es</email> (I.O.)</corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>3</month>
      <year>2024</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2023-11-14">
      <day>14</day>
      <month>11</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>14</day>
      <month>11</month>
      <year>2023</year>
    </pub-date>
    <volume>40</volume>
    <issue>3</issue>
    <elocation-id>btad681</elocation-id>
    <history>
      <date date-type="received">
        <day>06</day>
        <month>7</month>
        <year>2023</year>
      </date>
      <date date-type="rev-recd">
        <day>18</day>
        <month>10</month>
        <year>2023</year>
      </date>
      <date date-type="editorial-decision">
        <day>01</day>
        <month>11</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>13</day>
        <month>11</month>
        <year>2023</year>
      </date>
      <date date-type="corrected-typeset">
        <day>07</day>
        <month>3</month>
        <year>2024</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2023</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btad681.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>Single-nucleotide variants (SNVs) are the most common type of genetic variation in the human genome. Accurate and efficient detection of SNVs from next-generation sequencing (NGS) data is essential for various applications in genomics and personalized medicine. However, SNV calling methods usually suffer from high computational complexity and limited accuracy. In this context, there is a need for new methods that overcome these limitations and provide fast reliable results.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>We present EMVC-2, a novel method for SNV calling from NGS data. EMVC-2 uses a multi-class ensemble classification approach based on the expectation–maximization algorithm that infers at each locus the most likely genotype from multiple labels provided by different learners. The inferred variants are then validated by a decision tree that filters out unlikely ones. We evaluate EMVC-2 on several publicly available real human NGS data for which the set of SNVs is available, and demonstrate that it outperforms state-of-the-art variant callers in terms of accuracy and speed, on average.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>EMVC-2 is coded in C and Python, and is freely available for download at: <ext-link xlink:href="https://github.com/guilledufort/EMVC-2" ext-link-type="uri">https://github.com/guilledufort/EMVC-2</ext-link>. EMVC-2 is also available in Bioconda.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Universidad de la República; Ramon y Cajal</institution>
          </institution-wrap>
        </funding-source>
        <award-id>RYC2019-028578-I</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Gipuzkoa Fellows</institution>
          </institution-wrap>
        </funding-source>
        <award-id>2022-FELL-000003–01</award-id>
        <award-id>PID2021-126718OA-I00</award-id>
        <award-id>PID2019-104958RB-C41</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="3"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Next-generation sequencing (NGS) has become indispensable in several fields, specially in personalized medicine. Analysis of NGS data normally starts with variant calling, which consists of identifying the differences or <italic toggle="yes">variants</italic> between the sequenced genome and a reference genome of the same species. Most common variants are in the form of single-nucleotide variants (SNVs) and short insertions or deletions (INDELs). SNVs and INDELs can have significant effects on individuals from a clinical setting perspective, e.g. higher risk of certain diseases, predisposition to certain types of cancer, or impact on drug metabolism and response. Thus, it is crucial to design efficient variant callers that accurately identify an individual’s variants.</p>
    <p>Available variant callers are still not 100% accurate, and some suffer from high computational complexity. Here, we build upon the previously proposed SNV caller EMVC (<xref rid="btad681-B7" ref-type="bibr">Pagès-Zamora <italic toggle="yes">et al.</italic> 2022</xref>) to provide an efficient and accurate variant caller competitive with the state-of-the-art. The main improvements of EMVC-2 include the addition of a decision tree model to filter out incorrectly inferred variants, and a fast and efficient implementation of the algorithm that is publicly available and ready to use by the community.</p>
  </sec>
  <sec>
    <title>2 Methods and experimental results</title>
    <p>The EMVC-2 method presented here consists of two steps. Firstly, a set of SNV candidates is identified by the EMVC algorithm presented in our previous work (<xref rid="btad681-B7" ref-type="bibr">Pagès-Zamora <italic toggle="yes">et al.</italic> 2022</xref>), which solves the variant calling problem as an unsupervised multi-class ensemble classification task using the expectation–maximization (EM) based iterative approach (<xref rid="btad681-B2" ref-type="bibr">Dempster <italic toggle="yes">et al.</italic> 1997</xref>). Indeed, the EMVC algorithm is an ensemble classifier, meaning that it combines tags provided by numerous individual classifiers taking into account their reliability, which is inferred by the algorithm itself. Furthermore, EMVC is an unsupervised algorithm, as it operates without the need for labeled ground-truth data for training, and it is a multi-class classifier, as opposed to a binary one since it sorts the observed data into more than two classes. Briefly, EMVC proceeds as follows. For each locus or position in the genome, EMVC estimates the posterior probability of ten classes, each corresponding to one of the possible genotypes <inline-formula id="IE1"><mml:math id="IM1" display="inline" overflow="scroll"><mml:mrow><mml:mo>{</mml:mo><mml:mi>A</mml:mi><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:mi>G</mml:mi><mml:mi>G</mml:mi><mml:mo>,</mml:mo><mml:mi>T</mml:mi><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mi>A</mml:mi><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:mi>A</mml:mi><mml:mi>G</mml:mi><mml:mo>,</mml:mo><mml:mi>A</mml:mi><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi><mml:mi>G</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mi>G</mml:mi><mml:mi>T</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula>. The class with the highest probability is selected. A position is marked as an SNV candidate if the decided genotype for that position differs from the reference in at least one nucleotide. Secondly, EMVC-2 uses a Decision Tree Classifier (DTC) (<xref rid="btad681-B8" ref-type="bibr">Pedregosa <italic toggle="yes">et al.</italic> 2011</xref>) to filter the untrue SNV candidates identified in the first step. A DTC is chosen as models based on DTs have been shown to discriminate well between true and false called variants in similar settings (<xref rid="btad681-B10" ref-type="bibr">Zhang and Ochoa 2020</xref>, <xref rid="btad681-B1" ref-type="bibr">Cooke <italic toggle="yes">et al.</italic> 2021</xref>). Moreover, we refrain from using more complex models such as neural networks due to overfitting concerns. The DTC takes a set of features for each SNV candidate as input and decides whether to keep the SNV or not. The selected features are the genotype; the depth, which is the number of reads that map to that position; the percentage of reads at that position with an alternate nucleotide, i.e. different from the reference; and the entropy of the class probability distribution estimated in the first step, where lower entropy means higher confidence in the selected class. The DTC is trained on a 15×-coverage pair-end Whole Genome Sequenced (WGS) dataset for which the set of true SNVs is known and assumed to be correct (see <xref rid="sup1" ref-type="supplementary-material">Supplementary Material</xref>). We use a DTC with a low tree depth of 5 to prevent overfitting and to capture general statistical patterns. The training results show that the class entropy and the percentage of alternate nucleotides at the position are the key features for filtering out untrue variants. See <xref rid="sup1" ref-type="supplementary-material">Supplementary Material</xref> for more details on the method.</p>
    <p>The proposed method EMVC-2 is evaluated using a collection of public human NGS datasets with a coverage between 15× and 30× from different subjects for which a <italic toggle="yes">ground truth</italic> or set of true SNVs is available. <xref rid="btad681-T1" ref-type="table">Table 1</xref> summarizes the characteristics of the datasets, such as coverage, subject ID, and size. Data availability information is detailed in the <xref rid="sup1" ref-type="supplementary-material">Supplementary Material</xref>.</p>
    <table-wrap position="float" id="btad681-T1">
      <label>Table 1.</label>
      <caption>
        <p>Recall, precision, and f1-score of SNV callers EMVC-2, GATK, Platypus, and Strelka2 on different human datasets.<sup>a</sup></p>
      </caption>
      <table frame="hsides" rules="groups">
        <colgroup span="1">
          <col valign="top" align="left" span="1"/>
          <col valign="top" align="center" span="1"/>
          <col valign="top" align="center" span="1"/>
          <col valign="top" align="char" char="." span="1"/>
          <col valign="top" align="char" char="." span="1"/>
          <col valign="top" align="char" char="." span="1"/>
          <col valign="top" align="char" char="." span="1"/>
          <col valign="top" align="char" char="." span="1"/>
          <col valign="top" align="char" char="." span="1"/>
          <col valign="top" align="char" char="." span="1"/>
          <col valign="top" align="char" char="." span="1"/>
          <col valign="top" align="char" char="." span="1"/>
          <col valign="top" align="char" char="." span="1"/>
          <col valign="top" align="char" char="." span="1"/>
          <col valign="top" align="char" char="." span="1"/>
          <col valign="top" align="char" char="." span="1"/>
        </colgroup>
        <thead>
          <tr>
            <th rowspan="2" colspan="1">Dataset</th>
            <th rowspan="2" colspan="1">Coverage</th>
            <th rowspan="2" colspan="1">Subject ID</th>
            <th rowspan="2" colspan="1">Size (GB)</th>
            <th colspan="3" align="center" rowspan="1">EMVC-2<hr/></th>
            <th colspan="3" align="center" rowspan="1">GATK<hr/></th>
            <th colspan="3" align="center" rowspan="1">Platypus<hr/></th>
            <th colspan="3" align="center" rowspan="1">Strelka2<hr/></th>
          </tr>
          <tr>
            <th align="center" rowspan="1" colspan="1">Recall</th>
            <th align="center" rowspan="1" colspan="1">Precision</th>
            <th align="center" rowspan="1" colspan="1">f1-score</th>
            <th align="center" rowspan="1" colspan="1">Recall</th>
            <th align="center" rowspan="1" colspan="1">Precision</th>
            <th align="center" rowspan="1" colspan="1">f1-score</th>
            <th align="center" rowspan="1" colspan="1">Recall</th>
            <th align="center" rowspan="1" colspan="1">Precision</th>
            <th align="center" rowspan="1" colspan="1">f1-score</th>
            <th align="center" rowspan="1" colspan="1">Recall</th>
            <th align="center" rowspan="1" colspan="1">Precision</th>
            <th align="center" rowspan="1" colspan="1">f1-score</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td rowspan="1" colspan="1">
              <italic toggle="yes">ERR262997</italic>
            </td>
            <td rowspan="1" colspan="1">30×</td>
            <td rowspan="1" colspan="1">HG001</td>
            <td rowspan="1" colspan="1">104</td>
            <td rowspan="1" colspan="1">0.980</td>
            <td rowspan="1" colspan="1">0.981</td>
            <td rowspan="1" colspan="1">0.980</td>
            <td rowspan="1" colspan="1">0.975</td>
            <td rowspan="1" colspan="1">0.815</td>
            <td rowspan="1" colspan="1">0.888</td>
            <td rowspan="1" colspan="1">0.940</td>
            <td rowspan="1" colspan="1">
              <bold>0.993</bold>
            </td>
            <td rowspan="1" colspan="1">0.966</td>
            <td rowspan="1" colspan="1">
              <bold>0.985</bold>
            </td>
            <td rowspan="1" colspan="1">0.991</td>
            <td rowspan="1" colspan="1">
              <bold>0.988</bold>
            </td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">
              <italic toggle="yes">NovaSeq</italic>
            </td>
            <td rowspan="1" colspan="1">25×</td>
            <td rowspan="1" colspan="1">HG001</td>
            <td rowspan="1" colspan="1">49</td>
            <td rowspan="1" colspan="1">0.991</td>
            <td rowspan="1" colspan="1">0.989</td>
            <td rowspan="1" colspan="1">0.990</td>
            <td rowspan="1" colspan="1">
              <bold>0.994</bold>
            </td>
            <td rowspan="1" colspan="1">0.995</td>
            <td rowspan="1" colspan="1">
              <bold>0.995</bold>
            </td>
            <td rowspan="1" colspan="1">0.965</td>
            <td rowspan="1" colspan="1">0.995</td>
            <td rowspan="1" colspan="1">0.980</td>
            <td rowspan="1" colspan="1">0.991</td>
            <td rowspan="1" colspan="1">
              <bold>0.999</bold>
            </td>
            <td rowspan="1" colspan="1">
              <bold>0.995</bold>
            </td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">
              <italic toggle="yes">Ashkenazim son</italic>
            </td>
            <td rowspan="1" colspan="1">25×</td>
            <td rowspan="1" colspan="1">HG002</td>
            <td rowspan="1" colspan="1">48</td>
            <td rowspan="1" colspan="1">0.886</td>
            <td rowspan="1" colspan="1">0.937</td>
            <td rowspan="1" colspan="1">0.911</td>
            <td rowspan="1" colspan="1">
              <bold>0.913</bold>
            </td>
            <td rowspan="1" colspan="1">0.962</td>
            <td rowspan="1" colspan="1">
              <bold>0.937</bold>
            </td>
            <td rowspan="1" colspan="1">0.842</td>
            <td rowspan="1" colspan="1">
              <bold>0.983</bold>
            </td>
            <td rowspan="1" colspan="1">0.907</td>
            <td rowspan="1" colspan="1">0.840</td>
            <td rowspan="1" colspan="1">0.788</td>
            <td rowspan="1" colspan="1">0.813</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">
              <italic toggle="yes">pangenomics2</italic>
            </td>
            <td rowspan="1" colspan="1">30×</td>
            <td rowspan="1" colspan="1">HG002</td>
            <td rowspan="1" colspan="1">61</td>
            <td rowspan="1" colspan="1">0.991</td>
            <td rowspan="1" colspan="1">0.982</td>
            <td rowspan="1" colspan="1">0.986</td>
            <td rowspan="1" colspan="1">
              <bold>0.993</bold>
            </td>
            <td rowspan="1" colspan="1">0.996</td>
            <td rowspan="1" colspan="1">
              <bold>0.994</bold>
            </td>
            <td rowspan="1" colspan="1">0.964</td>
            <td rowspan="1" colspan="1">0.995</td>
            <td rowspan="1" colspan="1">0.979</td>
            <td rowspan="1" colspan="1">0.990</td>
            <td rowspan="1" colspan="1">
              <bold>0.999</bold>
            </td>
            <td rowspan="1" colspan="1">
              <bold>0.994</bold>
            </td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">
              <italic toggle="yes">pangenomics3</italic>
            </td>
            <td rowspan="1" colspan="1">30×</td>
            <td rowspan="1" colspan="1">HG003</td>
            <td rowspan="1" colspan="1">66</td>
            <td rowspan="1" colspan="1">
              <bold>0.991</bold>
            </td>
            <td rowspan="1" colspan="1">0.986</td>
            <td rowspan="1" colspan="1">0.988</td>
            <td rowspan="1" colspan="1">
              <bold>0.992</bold>
            </td>
            <td rowspan="1" colspan="1">0.996</td>
            <td rowspan="1" colspan="1">
              <bold>0.994</bold>
            </td>
            <td rowspan="1" colspan="1">0.964</td>
            <td rowspan="1" colspan="1">0.995</td>
            <td rowspan="1" colspan="1">0.979</td>
            <td rowspan="1" colspan="1">0.990</td>
            <td rowspan="1" colspan="1">
              <bold>0.999</bold>
            </td>
            <td rowspan="1" colspan="1">
              <bold>0.994</bold>
            </td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">
              <italic toggle="yes">pangenomics4</italic>
            </td>
            <td rowspan="1" colspan="1">30×</td>
            <td rowspan="1" colspan="1">HG004</td>
            <td rowspan="1" colspan="1">61</td>
            <td rowspan="1" colspan="1">0.991</td>
            <td rowspan="1" colspan="1">0.982</td>
            <td rowspan="1" colspan="1">0.986</td>
            <td rowspan="1" colspan="1">
              <bold>0.993</bold>
            </td>
            <td rowspan="1" colspan="1">0.996</td>
            <td rowspan="1" colspan="1">
              <bold>0.994</bold>
            </td>
            <td rowspan="1" colspan="1">0.965</td>
            <td rowspan="1" colspan="1">0.995</td>
            <td rowspan="1" colspan="1">0.980</td>
            <td rowspan="1" colspan="1">0.990</td>
            <td rowspan="1" colspan="1">
              <bold>0.999</bold>
            </td>
            <td rowspan="1" colspan="1">
              <bold>0.994</bold>
            </td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">
              <italic toggle="yes">Chinese Son</italic>
            </td>
            <td rowspan="1" colspan="1">15×</td>
            <td rowspan="1" colspan="1">HG005</td>
            <td rowspan="1" colspan="1">34</td>
            <td rowspan="1" colspan="1">
              <bold>0.971</bold>
            </td>
            <td rowspan="1" colspan="1">0.989</td>
            <td rowspan="1" colspan="1">0.980</td>
            <td rowspan="1" colspan="1">
              <bold>0.971</bold>
            </td>
            <td rowspan="1" colspan="1">0.993</td>
            <td rowspan="1" colspan="1">
              <bold>0.982</bold>
            </td>
            <td rowspan="1" colspan="1">0.934</td>
            <td rowspan="1" colspan="1">0.994</td>
            <td rowspan="1" colspan="1">0.963</td>
            <td rowspan="1" colspan="1">0.964</td>
            <td rowspan="1" colspan="1">
              <bold>0.993</bold>
            </td>
            <td rowspan="1" colspan="1">0.978</td>
          </tr>
          <tr>
            <td colspan="4" rowspan="1">Average</td>
            <td rowspan="1" colspan="1">0.971</td>
            <td rowspan="1" colspan="1">0.978</td>
            <td rowspan="1" colspan="1">
              <bold>0.975</bold>
            </td>
            <td rowspan="1" colspan="1">
              <bold>0.976</bold>
            </td>
            <td rowspan="1" colspan="1">0.965</td>
            <td rowspan="1" colspan="1">0.969</td>
            <td rowspan="1" colspan="1">0.939</td>
            <td rowspan="1" colspan="1">
              <bold>0.993</bold>
            </td>
            <td rowspan="1" colspan="1">0.965</td>
            <td rowspan="1" colspan="1">0.964</td>
            <td rowspan="1" colspan="1">0.967</td>
            <td rowspan="1" colspan="1">0.965</td>
          </tr>
        </tbody>
      </table>
      <table-wrap-foot>
        <fn id="tblfn1">
          <label>a</label>
          <p>Best results are highlighted in bold.</p>
        </fn>
      </table-wrap-foot>
    </table-wrap>
    <p>EMVC-2 is compared with three state-of-the-art variant callers: GATK (<xref rid="btad681-B6" ref-type="bibr">McKenna <italic toggle="yes">et al.</italic> 2010</xref>), Platypus (<xref rid="btad681-B9" ref-type="bibr">Rimmer <italic toggle="yes">et al.</italic> 2014</xref>), and Strelka2 (<xref rid="btad681-B3" ref-type="bibr">Kim <italic toggle="yes">et al.</italic> 2018</xref>). Each tool is run with its default configuration. For GATK, its best practice pipeline is followed, which involves aligning the data to the corresponding reference using bwa (<xref rid="btad681-B5" ref-type="bibr">Li and Durbin 2009</xref>), marking duplicates and re-calibrating quality scores with Picard, and calling variants with the HaplotypeCaller in GVCF mode. Note that EMVC-2, Platypus, and Strelka2 only require the alignment as a preprocessing step, which is also done with bwa. See <xref rid="sup1" ref-type="supplementary-material">Supplementary Material</xref> for additional details and specific commands, and for a comparison to EMVC (<xref rid="btad681-B7" ref-type="bibr">Pagès-Zamora <italic toggle="yes">et al.</italic> 2022</xref>). As shown in <xref rid="sup1" ref-type="supplementary-material">Table 4</xref> in the <xref rid="sup1" ref-type="supplementary-material">Supplementary Material</xref>, the proposed EMVC-2 method, which combines EMVC with a DTC, provides a higher f1-score than EMVC alone for all datasets considered.</p>
    <p>The <italic toggle="yes">hap.py</italic> pipeline (<xref rid="btad681-B4" ref-type="bibr">Krusche <italic toggle="yes">et al.</italic> 2018</xref>) is used to compare the VCFs generated by each tool with the ground truth and to compute three measures of accuracy: precision, recall, and f1-score. Precision is the fraction of true variants among all the variants called by a tool. Recall is the fraction of true variants that are correctly called by a tool. F1-score is the harmonic mean of precision and recall, and it reflects the overall accuracy of a tool.</p>
    <p>All experiments are conducted on a server with 80 64 bit x86 Intel Xeon CPUs, 503.5 GB of RAM memory, and CentOS Linux 7.7.1908; each tool is configured to run with the maximum number of threads.</p>
    <p>The performance of each tool on the selected datasets is provided in <xref rid="btad681-T1" ref-type="table">Table 1</xref>. The results indicate that EMVC-2 is the most accurate tool on average across all the datasets, with an average f1-score of 0.975, followed by GATK with an average f1-score of 0.969. Platypus has the highest precision on average (0.993), but it is much less sensitive than the other tools. On another note, both GATK and Strelka2 achieve the highest number of individual best f1-score results across the datasets, but lack the consistency achieved by EMVC-2 to be the best on average.</p>
    <p>The computational performance of the tools is assessed by measuring the processing speed, defined as the size of the dataset, in MB, divided by the time in seconds needed to obtain the variants after performing the alignment, and memory in GB required to process each dataset. In the experiments, Platypus was the fastest tool, with an average processing speed of 168 MB/s, followed by EMVC-2 with 53 MB/s, which was 3.7× times faster that Strelka2 and 106× times faster than GATK (see <xref rid="btad681-F1" ref-type="fig">Fig. 1</xref>). Strelka2 was the most memory-efficient, using a maximum of 0.6 GB of RAM during the processing of the datasets, while EMVC-2, Platypus, and GATK, used a maximum of 6.0, 3.59, and 39.4 GB of RAM, respectively. A comparison with EMVC is omitted due to a lack of an efficient implementation.</p>
    <fig position="float" id="btad681-F1">
      <label>Figure 1.</label>
      <caption>
        <p>Average f1-score versus processing speed for EMVC-2, GATK, Strelka2, and Platypus.</p>
      </caption>
      <graphic xlink:href="btad681f1" position="float"/>
    </fig>
    <p>In conclusion, EMVC-2 offers a great trade-off between SNV variant call accuracy and computational efficiency, thus adding to the available toolset of variant callers.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btad681_Supplementary_Data</label>
      <media xlink:href="btad681_supplementary_data.pdf"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <sec>
    <title>Supplementary data</title>
    <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics</italic> online.</p>
  </sec>
  <sec sec-type="COI-statement">
    <title>Conflict of interest</title>
    <p>None declared.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>This work was partially supported by Universidad de la República; Ramon y Cajal [contract number RYC2019-028578-I]; and Gipuzkoa Fellows [grant numbers 2022-FELL-000003–01, PID2021-126718OA-I00, PID2019-104958RB-C41] funded by MCIN/AEI/10.13039/501100011033.</p>
  </sec>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btad681-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Cooke</surname><given-names>DP</given-names></string-name>, <string-name><surname>Wedge</surname><given-names>DC</given-names></string-name>, <string-name><surname>Lunter</surname><given-names>G.</given-names></string-name></person-group><article-title>A unified haplotype-based method for accurate and comprehensive variant calling</article-title>. <source>Nat Biotechnol</source><year>2021</year>;<volume>39</volume>:<fpage>885</fpage>–<lpage>92</lpage>.<pub-id pub-id-type="pmid">33782612</pub-id></mixed-citation>
    </ref>
    <ref id="btad681-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Dempster</surname><given-names>AP</given-names></string-name>, <string-name><surname>Laird</surname><given-names>NM</given-names></string-name>, <string-name><surname>Rubin</surname><given-names>DB.</given-names></string-name></person-group><article-title>Maximum likelihood from incomplete data via the EM algorithm</article-title>. <source>J R Stat Soc Ser B (Methodological)</source><year>1977</year>;<volume>39</volume>:<fpage>1</fpage>–<lpage>22</lpage>.</mixed-citation>
    </ref>
    <ref id="btad681-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kim</surname><given-names>S</given-names></string-name>, <string-name><surname>Scheffler</surname><given-names>K</given-names></string-name>, <string-name><surname>Halpern</surname><given-names>A</given-names></string-name></person-group>, <etal>et al</etal><article-title>Strelka2: fast and accurate calling of germline and somatic variants</article-title>. <source>Nat Methods</source><year>2018</year>;<volume>15</volume>:<fpage>591</fpage>–<lpage>4</lpage>.<pub-id pub-id-type="pmid">30013048</pub-id></mixed-citation>
    </ref>
    <ref id="btad681-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Krusche</surname><given-names>P</given-names></string-name>, <string-name><surname>Trigg</surname><given-names>L</given-names></string-name>, <string-name><surname>Boutros</surname><given-names>P</given-names></string-name></person-group><etal>et al</etal>; <collab>Global Alliance for Genomics and Health Benchmarking Team</collab>. <article-title>Best practices for benchmarking germline small variant calls in human genomes</article-title>. <source>Nat Biotechnol</source><year>2018</year>;<volume>37</volume>:<fpage>555</fpage>–<lpage>60</lpage>.</mixed-citation>
    </ref>
    <ref id="btad681-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Li</surname><given-names>H</given-names></string-name>, <string-name><surname>Durbin</surname><given-names>R.</given-names></string-name></person-group><article-title>Fast and accurate short read alignment with Burrows–Wheeler transform</article-title>. <source>Bioinformatics</source><year>2009</year>;<volume>25</volume>:<fpage>1754</fpage>–<lpage>60</lpage>.<pub-id pub-id-type="pmid">19451168</pub-id></mixed-citation>
    </ref>
    <ref id="btad681-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>McKenna</surname><given-names>A</given-names></string-name>, <string-name><surname>Hanna</surname><given-names>M</given-names></string-name>, <string-name><surname>Banks</surname><given-names>E</given-names></string-name></person-group><etal>et al</etal><article-title>The genome analysis toolkit: a MapReduce framework for analyzing next-generation DNA sequencing data</article-title>. <source>Genome Res</source><year>2010</year>;<volume>20</volume>:<fpage>1297</fpage>–<lpage>303</lpage>.<pub-id pub-id-type="pmid">20644199</pub-id></mixed-citation>
    </ref>
    <ref id="btad681-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pagès-Zamora</surname><given-names>A</given-names></string-name>, <string-name><surname>Ochoa</surname><given-names>I</given-names></string-name>, <string-name><surname>Cavero</surname><given-names>G</given-names></string-name></person-group><etal>et al</etal><article-title>Unsupervised ensemble learning for genome sequencing</article-title>. <source>Patt Recognit</source><year>2022</year>;<volume>129</volume>:<fpage>108721</fpage>.</mixed-citation>
    </ref>
    <ref id="btad681-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pedregosa</surname><given-names>F</given-names></string-name>, <string-name><surname>Varoquaux</surname><given-names>G</given-names></string-name>, <string-name><surname>Gramfort</surname><given-names>A</given-names></string-name></person-group><etal>et al</etal><article-title>Scikit-learn: machine learning in Python</article-title>. <source>J Mach Learn Res</source><year>2011</year>;<volume>12</volume>:<fpage>2825</fpage>–<lpage>30</lpage>.</mixed-citation>
    </ref>
    <ref id="btad681-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Rimmer</surname><given-names>A</given-names></string-name>, <string-name><surname>Phan</surname><given-names>H</given-names></string-name>, <string-name><surname>Mathieson</surname><given-names>I</given-names></string-name></person-group><etal>et al</etal>; <collab>WGS500 Consortium</collab>. <article-title>Integrating mapping-, assembly-and haplotype-based approaches for calling variants in clinical sequencing applications</article-title>. <source>Nat Genet</source><year>2014</year>;<volume>46</volume>:<fpage>912</fpage>–<lpage>8</lpage>.<pub-id pub-id-type="pmid">25017105</pub-id></mixed-citation>
    </ref>
    <ref id="btad681-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhang</surname><given-names>C</given-names></string-name>, <string-name><surname>Ochoa</surname><given-names>I.</given-names></string-name></person-group><article-title>VEF: a variant filtering tool based on ensemble methods</article-title>. <source>Bioinformatics</source><year>2020</year>;<volume>36</volume>:<fpage>2328</fpage>–<lpage>36</lpage>.<pub-id pub-id-type="pmid">31873730</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10919945</article-id>
    <article-id pub-id-type="pmid">37963064</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btad681</article-id>
    <article-id pub-id-type="publisher-id">btad681</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Note</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Genome Analysis</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>EMVC-2: an efficient single-nucleotide variant caller based on expectation maximization</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-6125-5603</contrib-id>
        <name>
          <surname>Dufort y Álvarez</surname>
          <given-names>Guillermo</given-names>
        </name>
        <aff><institution>INCO, Facultad de Ingeniería, Universidad de la República</institution>, Montevideo 11300, <country country="UY">Uruguay</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Xargay-Ferrer</surname>
          <given-names>Martí</given-names>
        </name>
        <aff><institution>SPCOM Group, Universitat Politècnica de Catalunya – BarcelonaTech (UPC)</institution>, 08034 Barcelona, <country country="ES">Spain</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Pagès-Zamora</surname>
          <given-names>Alba</given-names>
        </name>
        <aff><institution>SPCOM Group, Universitat Politècnica de Catalunya – BarcelonaTech (UPC)</institution>, 08034 Barcelona, <country country="ES">Spain</country></aff>
        <xref rid="btad681-cor1" ref-type="corresp"/>
        <!--alba.pages@upc.edu-->
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Ochoa</surname>
          <given-names>Idoia</given-names>
        </name>
        <aff><institution>Department of Electrical Engineering, Tecnun, University of Navarra</institution>, 20018 Donostia, <country country="ES">Spain</country></aff>
        <xref rid="btad681-cor2" ref-type="corresp"/>
        <!--iochoal@unav.es-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Kendziorski</surname>
          <given-names>Christina</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btad681-cor1">Corresponding authors. SPCOM Group, Universitat Politècnica de Catalunya – BarcelonaTech (UPC), Campus Nord D5 C/ Jordi Girona 1-3, 08034 Barcelona, Spain. E-mail: <email>alba.pages@upc.edu</email> (A.P.-Z.)</corresp>
      <corresp id="btad681-cor2">Department of Electrical Engineering, Tecnun, University of Navarra, Manuel Lardizabal Ibilbidea, 13, 20018 Donostia, Spain. E-mail: <email>iochoal@unav.es</email> (I.O.)</corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>3</month>
      <year>2024</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2023-11-14">
      <day>14</day>
      <month>11</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>14</day>
      <month>11</month>
      <year>2023</year>
    </pub-date>
    <volume>40</volume>
    <issue>3</issue>
    <elocation-id>btad681</elocation-id>
    <history>
      <date date-type="received">
        <day>06</day>
        <month>7</month>
        <year>2023</year>
      </date>
      <date date-type="rev-recd">
        <day>18</day>
        <month>10</month>
        <year>2023</year>
      </date>
      <date date-type="editorial-decision">
        <day>01</day>
        <month>11</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>13</day>
        <month>11</month>
        <year>2023</year>
      </date>
      <date date-type="corrected-typeset">
        <day>07</day>
        <month>3</month>
        <year>2024</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2023</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btad681.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>Single-nucleotide variants (SNVs) are the most common type of genetic variation in the human genome. Accurate and efficient detection of SNVs from next-generation sequencing (NGS) data is essential for various applications in genomics and personalized medicine. However, SNV calling methods usually suffer from high computational complexity and limited accuracy. In this context, there is a need for new methods that overcome these limitations and provide fast reliable results.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>We present EMVC-2, a novel method for SNV calling from NGS data. EMVC-2 uses a multi-class ensemble classification approach based on the expectation–maximization algorithm that infers at each locus the most likely genotype from multiple labels provided by different learners. The inferred variants are then validated by a decision tree that filters out unlikely ones. We evaluate EMVC-2 on several publicly available real human NGS data for which the set of SNVs is available, and demonstrate that it outperforms state-of-the-art variant callers in terms of accuracy and speed, on average.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>EMVC-2 is coded in C and Python, and is freely available for download at: <ext-link xlink:href="https://github.com/guilledufort/EMVC-2" ext-link-type="uri">https://github.com/guilledufort/EMVC-2</ext-link>. EMVC-2 is also available in Bioconda.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Universidad de la República; Ramon y Cajal</institution>
          </institution-wrap>
        </funding-source>
        <award-id>RYC2019-028578-I</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Gipuzkoa Fellows</institution>
          </institution-wrap>
        </funding-source>
        <award-id>2022-FELL-000003–01</award-id>
        <award-id>PID2021-126718OA-I00</award-id>
        <award-id>PID2019-104958RB-C41</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="3"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Next-generation sequencing (NGS) has become indispensable in several fields, specially in personalized medicine. Analysis of NGS data normally starts with variant calling, which consists of identifying the differences or <italic toggle="yes">variants</italic> between the sequenced genome and a reference genome of the same species. Most common variants are in the form of single-nucleotide variants (SNVs) and short insertions or deletions (INDELs). SNVs and INDELs can have significant effects on individuals from a clinical setting perspective, e.g. higher risk of certain diseases, predisposition to certain types of cancer, or impact on drug metabolism and response. Thus, it is crucial to design efficient variant callers that accurately identify an individual’s variants.</p>
    <p>Available variant callers are still not 100% accurate, and some suffer from high computational complexity. Here, we build upon the previously proposed SNV caller EMVC (<xref rid="btad681-B7" ref-type="bibr">Pagès-Zamora <italic toggle="yes">et al.</italic> 2022</xref>) to provide an efficient and accurate variant caller competitive with the state-of-the-art. The main improvements of EMVC-2 include the addition of a decision tree model to filter out incorrectly inferred variants, and a fast and efficient implementation of the algorithm that is publicly available and ready to use by the community.</p>
  </sec>
  <sec>
    <title>2 Methods and experimental results</title>
    <p>The EMVC-2 method presented here consists of two steps. Firstly, a set of SNV candidates is identified by the EMVC algorithm presented in our previous work (<xref rid="btad681-B7" ref-type="bibr">Pagès-Zamora <italic toggle="yes">et al.</italic> 2022</xref>), which solves the variant calling problem as an unsupervised multi-class ensemble classification task using the expectation–maximization (EM) based iterative approach (<xref rid="btad681-B2" ref-type="bibr">Dempster <italic toggle="yes">et al.</italic> 1997</xref>). Indeed, the EMVC algorithm is an ensemble classifier, meaning that it combines tags provided by numerous individual classifiers taking into account their reliability, which is inferred by the algorithm itself. Furthermore, EMVC is an unsupervised algorithm, as it operates without the need for labeled ground-truth data for training, and it is a multi-class classifier, as opposed to a binary one since it sorts the observed data into more than two classes. Briefly, EMVC proceeds as follows. For each locus or position in the genome, EMVC estimates the posterior probability of ten classes, each corresponding to one of the possible genotypes <inline-formula id="IE1"><mml:math id="IM1" display="inline" overflow="scroll"><mml:mrow><mml:mo>{</mml:mo><mml:mi>A</mml:mi><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:mi>G</mml:mi><mml:mi>G</mml:mi><mml:mo>,</mml:mo><mml:mi>T</mml:mi><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mi>A</mml:mi><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:mi>A</mml:mi><mml:mi>G</mml:mi><mml:mo>,</mml:mo><mml:mi>A</mml:mi><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi><mml:mi>G</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mi>G</mml:mi><mml:mi>T</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula>. The class with the highest probability is selected. A position is marked as an SNV candidate if the decided genotype for that position differs from the reference in at least one nucleotide. Secondly, EMVC-2 uses a Decision Tree Classifier (DTC) (<xref rid="btad681-B8" ref-type="bibr">Pedregosa <italic toggle="yes">et al.</italic> 2011</xref>) to filter the untrue SNV candidates identified in the first step. A DTC is chosen as models based on DTs have been shown to discriminate well between true and false called variants in similar settings (<xref rid="btad681-B10" ref-type="bibr">Zhang and Ochoa 2020</xref>, <xref rid="btad681-B1" ref-type="bibr">Cooke <italic toggle="yes">et al.</italic> 2021</xref>). Moreover, we refrain from using more complex models such as neural networks due to overfitting concerns. The DTC takes a set of features for each SNV candidate as input and decides whether to keep the SNV or not. The selected features are the genotype; the depth, which is the number of reads that map to that position; the percentage of reads at that position with an alternate nucleotide, i.e. different from the reference; and the entropy of the class probability distribution estimated in the first step, where lower entropy means higher confidence in the selected class. The DTC is trained on a 15×-coverage pair-end Whole Genome Sequenced (WGS) dataset for which the set of true SNVs is known and assumed to be correct (see <xref rid="sup1" ref-type="supplementary-material">Supplementary Material</xref>). We use a DTC with a low tree depth of 5 to prevent overfitting and to capture general statistical patterns. The training results show that the class entropy and the percentage of alternate nucleotides at the position are the key features for filtering out untrue variants. See <xref rid="sup1" ref-type="supplementary-material">Supplementary Material</xref> for more details on the method.</p>
    <p>The proposed method EMVC-2 is evaluated using a collection of public human NGS datasets with a coverage between 15× and 30× from different subjects for which a <italic toggle="yes">ground truth</italic> or set of true SNVs is available. <xref rid="btad681-T1" ref-type="table">Table 1</xref> summarizes the characteristics of the datasets, such as coverage, subject ID, and size. Data availability information is detailed in the <xref rid="sup1" ref-type="supplementary-material">Supplementary Material</xref>.</p>
    <table-wrap position="float" id="btad681-T1">
      <label>Table 1.</label>
      <caption>
        <p>Recall, precision, and f1-score of SNV callers EMVC-2, GATK, Platypus, and Strelka2 on different human datasets.<sup>a</sup></p>
      </caption>
      <table frame="hsides" rules="groups">
        <colgroup span="1">
          <col valign="top" align="left" span="1"/>
          <col valign="top" align="center" span="1"/>
          <col valign="top" align="center" span="1"/>
          <col valign="top" align="char" char="." span="1"/>
          <col valign="top" align="char" char="." span="1"/>
          <col valign="top" align="char" char="." span="1"/>
          <col valign="top" align="char" char="." span="1"/>
          <col valign="top" align="char" char="." span="1"/>
          <col valign="top" align="char" char="." span="1"/>
          <col valign="top" align="char" char="." span="1"/>
          <col valign="top" align="char" char="." span="1"/>
          <col valign="top" align="char" char="." span="1"/>
          <col valign="top" align="char" char="." span="1"/>
          <col valign="top" align="char" char="." span="1"/>
          <col valign="top" align="char" char="." span="1"/>
          <col valign="top" align="char" char="." span="1"/>
        </colgroup>
        <thead>
          <tr>
            <th rowspan="2" colspan="1">Dataset</th>
            <th rowspan="2" colspan="1">Coverage</th>
            <th rowspan="2" colspan="1">Subject ID</th>
            <th rowspan="2" colspan="1">Size (GB)</th>
            <th colspan="3" align="center" rowspan="1">EMVC-2<hr/></th>
            <th colspan="3" align="center" rowspan="1">GATK<hr/></th>
            <th colspan="3" align="center" rowspan="1">Platypus<hr/></th>
            <th colspan="3" align="center" rowspan="1">Strelka2<hr/></th>
          </tr>
          <tr>
            <th align="center" rowspan="1" colspan="1">Recall</th>
            <th align="center" rowspan="1" colspan="1">Precision</th>
            <th align="center" rowspan="1" colspan="1">f1-score</th>
            <th align="center" rowspan="1" colspan="1">Recall</th>
            <th align="center" rowspan="1" colspan="1">Precision</th>
            <th align="center" rowspan="1" colspan="1">f1-score</th>
            <th align="center" rowspan="1" colspan="1">Recall</th>
            <th align="center" rowspan="1" colspan="1">Precision</th>
            <th align="center" rowspan="1" colspan="1">f1-score</th>
            <th align="center" rowspan="1" colspan="1">Recall</th>
            <th align="center" rowspan="1" colspan="1">Precision</th>
            <th align="center" rowspan="1" colspan="1">f1-score</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td rowspan="1" colspan="1">
              <italic toggle="yes">ERR262997</italic>
            </td>
            <td rowspan="1" colspan="1">30×</td>
            <td rowspan="1" colspan="1">HG001</td>
            <td rowspan="1" colspan="1">104</td>
            <td rowspan="1" colspan="1">0.980</td>
            <td rowspan="1" colspan="1">0.981</td>
            <td rowspan="1" colspan="1">0.980</td>
            <td rowspan="1" colspan="1">0.975</td>
            <td rowspan="1" colspan="1">0.815</td>
            <td rowspan="1" colspan="1">0.888</td>
            <td rowspan="1" colspan="1">0.940</td>
            <td rowspan="1" colspan="1">
              <bold>0.993</bold>
            </td>
            <td rowspan="1" colspan="1">0.966</td>
            <td rowspan="1" colspan="1">
              <bold>0.985</bold>
            </td>
            <td rowspan="1" colspan="1">0.991</td>
            <td rowspan="1" colspan="1">
              <bold>0.988</bold>
            </td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">
              <italic toggle="yes">NovaSeq</italic>
            </td>
            <td rowspan="1" colspan="1">25×</td>
            <td rowspan="1" colspan="1">HG001</td>
            <td rowspan="1" colspan="1">49</td>
            <td rowspan="1" colspan="1">0.991</td>
            <td rowspan="1" colspan="1">0.989</td>
            <td rowspan="1" colspan="1">0.990</td>
            <td rowspan="1" colspan="1">
              <bold>0.994</bold>
            </td>
            <td rowspan="1" colspan="1">0.995</td>
            <td rowspan="1" colspan="1">
              <bold>0.995</bold>
            </td>
            <td rowspan="1" colspan="1">0.965</td>
            <td rowspan="1" colspan="1">0.995</td>
            <td rowspan="1" colspan="1">0.980</td>
            <td rowspan="1" colspan="1">0.991</td>
            <td rowspan="1" colspan="1">
              <bold>0.999</bold>
            </td>
            <td rowspan="1" colspan="1">
              <bold>0.995</bold>
            </td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">
              <italic toggle="yes">Ashkenazim son</italic>
            </td>
            <td rowspan="1" colspan="1">25×</td>
            <td rowspan="1" colspan="1">HG002</td>
            <td rowspan="1" colspan="1">48</td>
            <td rowspan="1" colspan="1">0.886</td>
            <td rowspan="1" colspan="1">0.937</td>
            <td rowspan="1" colspan="1">0.911</td>
            <td rowspan="1" colspan="1">
              <bold>0.913</bold>
            </td>
            <td rowspan="1" colspan="1">0.962</td>
            <td rowspan="1" colspan="1">
              <bold>0.937</bold>
            </td>
            <td rowspan="1" colspan="1">0.842</td>
            <td rowspan="1" colspan="1">
              <bold>0.983</bold>
            </td>
            <td rowspan="1" colspan="1">0.907</td>
            <td rowspan="1" colspan="1">0.840</td>
            <td rowspan="1" colspan="1">0.788</td>
            <td rowspan="1" colspan="1">0.813</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">
              <italic toggle="yes">pangenomics2</italic>
            </td>
            <td rowspan="1" colspan="1">30×</td>
            <td rowspan="1" colspan="1">HG002</td>
            <td rowspan="1" colspan="1">61</td>
            <td rowspan="1" colspan="1">0.991</td>
            <td rowspan="1" colspan="1">0.982</td>
            <td rowspan="1" colspan="1">0.986</td>
            <td rowspan="1" colspan="1">
              <bold>0.993</bold>
            </td>
            <td rowspan="1" colspan="1">0.996</td>
            <td rowspan="1" colspan="1">
              <bold>0.994</bold>
            </td>
            <td rowspan="1" colspan="1">0.964</td>
            <td rowspan="1" colspan="1">0.995</td>
            <td rowspan="1" colspan="1">0.979</td>
            <td rowspan="1" colspan="1">0.990</td>
            <td rowspan="1" colspan="1">
              <bold>0.999</bold>
            </td>
            <td rowspan="1" colspan="1">
              <bold>0.994</bold>
            </td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">
              <italic toggle="yes">pangenomics3</italic>
            </td>
            <td rowspan="1" colspan="1">30×</td>
            <td rowspan="1" colspan="1">HG003</td>
            <td rowspan="1" colspan="1">66</td>
            <td rowspan="1" colspan="1">
              <bold>0.991</bold>
            </td>
            <td rowspan="1" colspan="1">0.986</td>
            <td rowspan="1" colspan="1">0.988</td>
            <td rowspan="1" colspan="1">
              <bold>0.992</bold>
            </td>
            <td rowspan="1" colspan="1">0.996</td>
            <td rowspan="1" colspan="1">
              <bold>0.994</bold>
            </td>
            <td rowspan="1" colspan="1">0.964</td>
            <td rowspan="1" colspan="1">0.995</td>
            <td rowspan="1" colspan="1">0.979</td>
            <td rowspan="1" colspan="1">0.990</td>
            <td rowspan="1" colspan="1">
              <bold>0.999</bold>
            </td>
            <td rowspan="1" colspan="1">
              <bold>0.994</bold>
            </td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">
              <italic toggle="yes">pangenomics4</italic>
            </td>
            <td rowspan="1" colspan="1">30×</td>
            <td rowspan="1" colspan="1">HG004</td>
            <td rowspan="1" colspan="1">61</td>
            <td rowspan="1" colspan="1">0.991</td>
            <td rowspan="1" colspan="1">0.982</td>
            <td rowspan="1" colspan="1">0.986</td>
            <td rowspan="1" colspan="1">
              <bold>0.993</bold>
            </td>
            <td rowspan="1" colspan="1">0.996</td>
            <td rowspan="1" colspan="1">
              <bold>0.994</bold>
            </td>
            <td rowspan="1" colspan="1">0.965</td>
            <td rowspan="1" colspan="1">0.995</td>
            <td rowspan="1" colspan="1">0.980</td>
            <td rowspan="1" colspan="1">0.990</td>
            <td rowspan="1" colspan="1">
              <bold>0.999</bold>
            </td>
            <td rowspan="1" colspan="1">
              <bold>0.994</bold>
            </td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">
              <italic toggle="yes">Chinese Son</italic>
            </td>
            <td rowspan="1" colspan="1">15×</td>
            <td rowspan="1" colspan="1">HG005</td>
            <td rowspan="1" colspan="1">34</td>
            <td rowspan="1" colspan="1">
              <bold>0.971</bold>
            </td>
            <td rowspan="1" colspan="1">0.989</td>
            <td rowspan="1" colspan="1">0.980</td>
            <td rowspan="1" colspan="1">
              <bold>0.971</bold>
            </td>
            <td rowspan="1" colspan="1">0.993</td>
            <td rowspan="1" colspan="1">
              <bold>0.982</bold>
            </td>
            <td rowspan="1" colspan="1">0.934</td>
            <td rowspan="1" colspan="1">0.994</td>
            <td rowspan="1" colspan="1">0.963</td>
            <td rowspan="1" colspan="1">0.964</td>
            <td rowspan="1" colspan="1">
              <bold>0.993</bold>
            </td>
            <td rowspan="1" colspan="1">0.978</td>
          </tr>
          <tr>
            <td colspan="4" rowspan="1">Average</td>
            <td rowspan="1" colspan="1">0.971</td>
            <td rowspan="1" colspan="1">0.978</td>
            <td rowspan="1" colspan="1">
              <bold>0.975</bold>
            </td>
            <td rowspan="1" colspan="1">
              <bold>0.976</bold>
            </td>
            <td rowspan="1" colspan="1">0.965</td>
            <td rowspan="1" colspan="1">0.969</td>
            <td rowspan="1" colspan="1">0.939</td>
            <td rowspan="1" colspan="1">
              <bold>0.993</bold>
            </td>
            <td rowspan="1" colspan="1">0.965</td>
            <td rowspan="1" colspan="1">0.964</td>
            <td rowspan="1" colspan="1">0.967</td>
            <td rowspan="1" colspan="1">0.965</td>
          </tr>
        </tbody>
      </table>
      <table-wrap-foot>
        <fn id="tblfn1">
          <label>a</label>
          <p>Best results are highlighted in bold.</p>
        </fn>
      </table-wrap-foot>
    </table-wrap>
    <p>EMVC-2 is compared with three state-of-the-art variant callers: GATK (<xref rid="btad681-B6" ref-type="bibr">McKenna <italic toggle="yes">et al.</italic> 2010</xref>), Platypus (<xref rid="btad681-B9" ref-type="bibr">Rimmer <italic toggle="yes">et al.</italic> 2014</xref>), and Strelka2 (<xref rid="btad681-B3" ref-type="bibr">Kim <italic toggle="yes">et al.</italic> 2018</xref>). Each tool is run with its default configuration. For GATK, its best practice pipeline is followed, which involves aligning the data to the corresponding reference using bwa (<xref rid="btad681-B5" ref-type="bibr">Li and Durbin 2009</xref>), marking duplicates and re-calibrating quality scores with Picard, and calling variants with the HaplotypeCaller in GVCF mode. Note that EMVC-2, Platypus, and Strelka2 only require the alignment as a preprocessing step, which is also done with bwa. See <xref rid="sup1" ref-type="supplementary-material">Supplementary Material</xref> for additional details and specific commands, and for a comparison to EMVC (<xref rid="btad681-B7" ref-type="bibr">Pagès-Zamora <italic toggle="yes">et al.</italic> 2022</xref>). As shown in <xref rid="sup1" ref-type="supplementary-material">Table 4</xref> in the <xref rid="sup1" ref-type="supplementary-material">Supplementary Material</xref>, the proposed EMVC-2 method, which combines EMVC with a DTC, provides a higher f1-score than EMVC alone for all datasets considered.</p>
    <p>The <italic toggle="yes">hap.py</italic> pipeline (<xref rid="btad681-B4" ref-type="bibr">Krusche <italic toggle="yes">et al.</italic> 2018</xref>) is used to compare the VCFs generated by each tool with the ground truth and to compute three measures of accuracy: precision, recall, and f1-score. Precision is the fraction of true variants among all the variants called by a tool. Recall is the fraction of true variants that are correctly called by a tool. F1-score is the harmonic mean of precision and recall, and it reflects the overall accuracy of a tool.</p>
    <p>All experiments are conducted on a server with 80 64 bit x86 Intel Xeon CPUs, 503.5 GB of RAM memory, and CentOS Linux 7.7.1908; each tool is configured to run with the maximum number of threads.</p>
    <p>The performance of each tool on the selected datasets is provided in <xref rid="btad681-T1" ref-type="table">Table 1</xref>. The results indicate that EMVC-2 is the most accurate tool on average across all the datasets, with an average f1-score of 0.975, followed by GATK with an average f1-score of 0.969. Platypus has the highest precision on average (0.993), but it is much less sensitive than the other tools. On another note, both GATK and Strelka2 achieve the highest number of individual best f1-score results across the datasets, but lack the consistency achieved by EMVC-2 to be the best on average.</p>
    <p>The computational performance of the tools is assessed by measuring the processing speed, defined as the size of the dataset, in MB, divided by the time in seconds needed to obtain the variants after performing the alignment, and memory in GB required to process each dataset. In the experiments, Platypus was the fastest tool, with an average processing speed of 168 MB/s, followed by EMVC-2 with 53 MB/s, which was 3.7× times faster that Strelka2 and 106× times faster than GATK (see <xref rid="btad681-F1" ref-type="fig">Fig. 1</xref>). Strelka2 was the most memory-efficient, using a maximum of 0.6 GB of RAM during the processing of the datasets, while EMVC-2, Platypus, and GATK, used a maximum of 6.0, 3.59, and 39.4 GB of RAM, respectively. A comparison with EMVC is omitted due to a lack of an efficient implementation.</p>
    <fig position="float" id="btad681-F1">
      <label>Figure 1.</label>
      <caption>
        <p>Average f1-score versus processing speed for EMVC-2, GATK, Strelka2, and Platypus.</p>
      </caption>
      <graphic xlink:href="btad681f1" position="float"/>
    </fig>
    <p>In conclusion, EMVC-2 offers a great trade-off between SNV variant call accuracy and computational efficiency, thus adding to the available toolset of variant callers.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btad681_Supplementary_Data</label>
      <media xlink:href="btad681_supplementary_data.pdf"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <sec>
    <title>Supplementary data</title>
    <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics</italic> online.</p>
  </sec>
  <sec sec-type="COI-statement">
    <title>Conflict of interest</title>
    <p>None declared.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>This work was partially supported by Universidad de la República; Ramon y Cajal [contract number RYC2019-028578-I]; and Gipuzkoa Fellows [grant numbers 2022-FELL-000003–01, PID2021-126718OA-I00, PID2019-104958RB-C41] funded by MCIN/AEI/10.13039/501100011033.</p>
  </sec>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btad681-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Cooke</surname><given-names>DP</given-names></string-name>, <string-name><surname>Wedge</surname><given-names>DC</given-names></string-name>, <string-name><surname>Lunter</surname><given-names>G.</given-names></string-name></person-group><article-title>A unified haplotype-based method for accurate and comprehensive variant calling</article-title>. <source>Nat Biotechnol</source><year>2021</year>;<volume>39</volume>:<fpage>885</fpage>–<lpage>92</lpage>.<pub-id pub-id-type="pmid">33782612</pub-id></mixed-citation>
    </ref>
    <ref id="btad681-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Dempster</surname><given-names>AP</given-names></string-name>, <string-name><surname>Laird</surname><given-names>NM</given-names></string-name>, <string-name><surname>Rubin</surname><given-names>DB.</given-names></string-name></person-group><article-title>Maximum likelihood from incomplete data via the EM algorithm</article-title>. <source>J R Stat Soc Ser B (Methodological)</source><year>1977</year>;<volume>39</volume>:<fpage>1</fpage>–<lpage>22</lpage>.</mixed-citation>
    </ref>
    <ref id="btad681-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kim</surname><given-names>S</given-names></string-name>, <string-name><surname>Scheffler</surname><given-names>K</given-names></string-name>, <string-name><surname>Halpern</surname><given-names>A</given-names></string-name></person-group>, <etal>et al</etal><article-title>Strelka2: fast and accurate calling of germline and somatic variants</article-title>. <source>Nat Methods</source><year>2018</year>;<volume>15</volume>:<fpage>591</fpage>–<lpage>4</lpage>.<pub-id pub-id-type="pmid">30013048</pub-id></mixed-citation>
    </ref>
    <ref id="btad681-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Krusche</surname><given-names>P</given-names></string-name>, <string-name><surname>Trigg</surname><given-names>L</given-names></string-name>, <string-name><surname>Boutros</surname><given-names>P</given-names></string-name></person-group><etal>et al</etal>; <collab>Global Alliance for Genomics and Health Benchmarking Team</collab>. <article-title>Best practices for benchmarking germline small variant calls in human genomes</article-title>. <source>Nat Biotechnol</source><year>2018</year>;<volume>37</volume>:<fpage>555</fpage>–<lpage>60</lpage>.</mixed-citation>
    </ref>
    <ref id="btad681-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Li</surname><given-names>H</given-names></string-name>, <string-name><surname>Durbin</surname><given-names>R.</given-names></string-name></person-group><article-title>Fast and accurate short read alignment with Burrows–Wheeler transform</article-title>. <source>Bioinformatics</source><year>2009</year>;<volume>25</volume>:<fpage>1754</fpage>–<lpage>60</lpage>.<pub-id pub-id-type="pmid">19451168</pub-id></mixed-citation>
    </ref>
    <ref id="btad681-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>McKenna</surname><given-names>A</given-names></string-name>, <string-name><surname>Hanna</surname><given-names>M</given-names></string-name>, <string-name><surname>Banks</surname><given-names>E</given-names></string-name></person-group><etal>et al</etal><article-title>The genome analysis toolkit: a MapReduce framework for analyzing next-generation DNA sequencing data</article-title>. <source>Genome Res</source><year>2010</year>;<volume>20</volume>:<fpage>1297</fpage>–<lpage>303</lpage>.<pub-id pub-id-type="pmid">20644199</pub-id></mixed-citation>
    </ref>
    <ref id="btad681-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pagès-Zamora</surname><given-names>A</given-names></string-name>, <string-name><surname>Ochoa</surname><given-names>I</given-names></string-name>, <string-name><surname>Cavero</surname><given-names>G</given-names></string-name></person-group><etal>et al</etal><article-title>Unsupervised ensemble learning for genome sequencing</article-title>. <source>Patt Recognit</source><year>2022</year>;<volume>129</volume>:<fpage>108721</fpage>.</mixed-citation>
    </ref>
    <ref id="btad681-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pedregosa</surname><given-names>F</given-names></string-name>, <string-name><surname>Varoquaux</surname><given-names>G</given-names></string-name>, <string-name><surname>Gramfort</surname><given-names>A</given-names></string-name></person-group><etal>et al</etal><article-title>Scikit-learn: machine learning in Python</article-title>. <source>J Mach Learn Res</source><year>2011</year>;<volume>12</volume>:<fpage>2825</fpage>–<lpage>30</lpage>.</mixed-citation>
    </ref>
    <ref id="btad681-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Rimmer</surname><given-names>A</given-names></string-name>, <string-name><surname>Phan</surname><given-names>H</given-names></string-name>, <string-name><surname>Mathieson</surname><given-names>I</given-names></string-name></person-group><etal>et al</etal>; <collab>WGS500 Consortium</collab>. <article-title>Integrating mapping-, assembly-and haplotype-based approaches for calling variants in clinical sequencing applications</article-title>. <source>Nat Genet</source><year>2014</year>;<volume>46</volume>:<fpage>912</fpage>–<lpage>8</lpage>.<pub-id pub-id-type="pmid">25017105</pub-id></mixed-citation>
    </ref>
    <ref id="btad681-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhang</surname><given-names>C</given-names></string-name>, <string-name><surname>Ochoa</surname><given-names>I.</given-names></string-name></person-group><article-title>VEF: a variant filtering tool based on ensemble methods</article-title>. <source>Bioinformatics</source><year>2020</year>;<volume>36</volume>:<fpage>2328</fpage>–<lpage>36</lpage>.<pub-id pub-id-type="pmid">31873730</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
