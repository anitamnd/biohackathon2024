<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Res Notes</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Res Notes</journal-id>
    <journal-title-group>
      <journal-title>BMC Research Notes</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1756-0500</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">9166323</article-id>
    <article-id pub-id-type="publisher-id">6085</article-id>
    <article-id pub-id-type="doi">10.1186/s13104-022-06085-1</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Note</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>dsSurvival: Privacy preserving survival models for federated individual patient meta-analysis in DataSHIELD</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes" equal-contrib="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-7748-9885</contrib-id>
        <name>
          <surname>Banerjee</surname>
          <given-names>Soumya</given-names>
        </name>
        <address>
          <email>sb2333@cam.ac.uk</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Sofack</surname>
          <given-names>Ghislain N.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Papakonstantinou</surname>
          <given-names>Thodoris</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Avraam</surname>
          <given-names>Demetris</given-names>
        </name>
        <xref ref-type="aff" rid="Aff4">4</xref>
        <xref ref-type="aff" rid="Aff5">5</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Burton</surname>
          <given-names>Paul</given-names>
        </name>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Zöller</surname>
          <given-names>Daniela</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Bishop</surname>
          <given-names>Tom R. P.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.5335.0</institution-id><institution-id institution-id-type="ISNI">0000000121885934</institution-id><institution>Medical Research Council Epidemiology Unit, </institution><institution>University of Cambridge School of Clinical Medicine, </institution></institution-wrap>Cambridge, United Kingdom </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.5963.9</institution-id><institution>Faculty of Medicine and Medical Center, Institute of Medical Biometry and Statistics, </institution><institution>University of Freiburg, </institution></institution-wrap>Breisgau, Germany </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="GRID">grid.5963.9</institution-id><institution>Freiburg Center for Data Analysis and Modelling, </institution><institution>University of Freiburg, </institution></institution-wrap>Breisgau, Germany </aff>
      <aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="GRID">grid.1006.7</institution-id><institution-id institution-id-type="ISNI">0000 0001 0462 7212</institution-id><institution>Population Health Sciences Institute, </institution><institution>Newcastle University, </institution></institution-wrap>Newcastle, United Kingdom </aff>
      <aff id="Aff5"><label>5</label><institution-wrap><institution-id institution-id-type="GRID">grid.5254.6</institution-id><institution-id institution-id-type="ISNI">0000 0001 0674 042X</institution-id><institution>Department of Public Health, </institution><institution>University of Copenhagen, </institution></institution-wrap>Copenhagen, Denmark </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>3</day>
      <month>6</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>3</day>
      <month>6</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2022</year>
    </pub-date>
    <volume>15</volume>
    <elocation-id>197</elocation-id>
    <history>
      <date date-type="received">
        <day>5</day>
        <month>1</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>24</day>
        <month>5</month>
        <year>2022</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2022</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold>This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Objective</title>
        <p id="Par1">Achieving sufficient statistical power in a survival analysis usually requires large amounts of data from different sites. Sensitivity of individual-level data, ethical and practical considerations regarding data sharing across institutions could be a potential challenge for achieving this added power. Hence we implemented a federated meta-analysis approach of survival models in DataSHIELD, where only anonymous aggregated data are shared across institutions, while simultaneously allowing for exploratory, interactive modelling. In this case, meta-analysis techniques to combine analysis results from each site are a solution, but an analytic workflow involving local analysis undertaken at individual studies hinders exploration. Thus, the aim is to provide a framework for performing meta-analysis of Cox regression models across institutions without manual analysis steps for the data providers.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">We introduce a package (dsSurvival) which allows privacy preserving meta-analysis of survival models, including the calculation of hazard ratios. Our tool can be of great use in biomedical research where there is a need for building survival models and there are privacy concerns about sharing data.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Survival analysis</kwd>
      <kwd>Meta-analysis</kwd>
      <kwd>Federated analysis</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>EUCAN-Connect under the European Union’s Horizon 2020 research and innovation programme (grant agreement no. 824989)</institution>
        </funding-source>
        <award-id>grant agreement number 824989</award-id>
        <principal-award-recipient>
          <name>
            <surname>Banerjee</surname>
            <given-names>Soumya</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2022</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Introduction</title>
    <p id="Par4">Survival models are widely used in biomedical research for analyzing survival data [<xref ref-type="bibr" rid="CR1">1</xref>]. These models help researchers compare the effect of exposures on mortality or other outcomes of interest [<xref ref-type="bibr" rid="CR2">2</xref>]. The Cox proportional hazards model [<xref ref-type="bibr" rid="CR3">3</xref>] is one of the most popular survival analysis models and was primarily developed to determine the importance of predictors in survival, by using covariate information to make individual predictions [<xref ref-type="bibr" rid="CR4">4</xref>].</p>
    <p id="Par5">Achieving sufficient power in survival analysis usually requires large amounts of data from several sites or institutions. Multi-site analysis across studies with different population characteristics help us understand how diseases affect different populations and what it is about these populations that cause these differences. However, the number of cases at a single site is often rather small, making statistical analysis challenging. Also due to the sensitivity of individual-level biomedical data, ethical and practical considerations related to data transmission, and institutional policies, it may sometimes be difficult to share individual-level data [<xref ref-type="bibr" rid="CR5">5</xref>].</p>
    <p id="Par6">In consortia, this issue is often addressed by manual analysis in each site, followed by a manual meta-analysis of the analysis results from the individual sites. This process is very time-consuming and error-prone, making exploratory analysis (e.g., for understanding different effect patterns in each site) impractical. As an alternative, the DataSHIELD framework can be used.</p>
    <p id="Par7">DataSHIELD is a framework that enables the remote and privacy preserving analysis of sensitive research data [<xref ref-type="bibr" rid="CR6">6</xref>]. The framework is based on the programming language R [<xref ref-type="bibr" rid="CR7">7</xref>, <xref ref-type="bibr" rid="CR8">8</xref>]. In each site, specifically requested aggregated anonymous analysis results can be requested, which are then combined in a central analysis server. The requirement is that the analysis be privacy preserving and be conducted across globally distributed cohorts.</p>
    <p id="Par8">We have implemented a meta-analysis approach based on the Cox-model in DataSHIELD using individual patient data that are distributed across several sites, without moving those data to a central site i.e., the individual-level data remain within each site and only non-disclosive aggregated data are shared. Our software package for DataSHIELD allows building of survival models and analyzing results in a federated privacy preserving fashion.</p>
    <p id="Par9">Remote federated meta-analysis allows the analysis to come to the data and enables multiple research groups to collate their data [<xref ref-type="bibr" rid="CR7">7</xref>, <xref ref-type="bibr" rid="CR8">8</xref>]. This is an alternative to literature based meta-analysis since study variables and outcomes can be harmonised [<xref ref-type="bibr" rid="CR9">9</xref>]. Our package offers considerable advantages over: (1) literature based meta-analysis, which suffers from publication bias as well as restricting the analytic endpoints you may wish to use; (2) central pooling of data, which provides important governance challenges and can engender privacy risks; and (3) asking researchers in each location to do local analyses based on a shared analysis plan, which all too often demands numerous emails, with repeated reminders, to disseminate analytic protocols and return results for meta-analysis, which is typically time-consuming and can be error prone. Our tool can be of great use in domains where there is a need for building survival models and there are privacy concerns about sharing data.</p>
  </sec>
  <sec id="Sec2">
    <title>Main text</title>
    <sec id="Sec3">
      <title>Basics of survival analysis</title>
      <p id="Par10">Survival analysis can be used to analyze clinical data if there are records of patient mortality and time to event data. The key quantity is a survival function:<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} S(t) = Pr (T &gt; t) \end{aligned}$$\end{document}</tex-math><mml:math id="M2" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>S</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>P</mml:mi><mml:mi>r</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mo>&gt;</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13104_2022_6085_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula>where <italic>S</italic>(<italic>t</italic>) is the survival function, <italic>t</italic> is the current time, and <italic>T</italic> is a random variable denoting time of death. <italic>Pr</italic>() is the probability that the time of death is greater than time <italic>t</italic> i.e., the probability of surviving till time <italic>t</italic>.</p>
      <p id="Par11">The instantaneous hazard [<inline-formula id="IEq1"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda (t)$$\end{document}</tex-math><mml:math id="M4"><mml:mrow><mml:mi>λ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13104_2022_6085_Article_IEq1.gif"/></alternatives></inline-formula>] is the probability of death occurring within time period [ t, t + <inline-formula id="IEq2"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\delta$$\end{document}</tex-math><mml:math id="M6"><mml:mi>δ</mml:mi></mml:math><inline-graphic xlink:href="13104_2022_6085_Article_IEq2.gif"/></alternatives></inline-formula> t ] given survival till time <italic>t</italic>. This is related to the survival function as follows:<disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} S(t) = \exp \left( - \int _{0}^{t} \lambda (z) dz \right) \end{aligned}$$\end{document}</tex-math><mml:math id="M8" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>S</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo>exp</mml:mo><mml:mfenced close=")" open="("><mml:mo>-</mml:mo><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mi>λ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>d</mml:mi><mml:mi>z</mml:mi></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13104_2022_6085_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula>The proportional hazards model assumes that the effect of covariates is proportional to the hazard. This is modelled as follows using the hazard function <inline-formula id="IEq3"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda (t)$$\end{document}</tex-math><mml:math id="M10"><mml:mrow><mml:mi>λ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13104_2022_6085_Article_IEq3.gif"/></alternatives></inline-formula>:<disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \lambda (t | X_{i} ) = \lambda _{0}(t) \exp \left( \sum _{j=1}^{p} \beta _{j} X_{ij} \right) \end{aligned}$$\end{document}</tex-math><mml:math id="M12" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>λ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>exp</mml:mo><mml:mfenced close=")" open="("><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>p</mml:mi></mml:munderover><mml:msub><mml:mi>β</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13104_2022_6085_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq4"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda _{0}(t)$$\end{document}</tex-math><mml:math id="M14"><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13104_2022_6085_Article_IEq4.gif"/></alternatives></inline-formula> is called the baseline hazard and <inline-formula id="IEq5"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda (t)$$\end{document}</tex-math><mml:math id="M16"><mml:mrow><mml:mi>λ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13104_2022_6085_Article_IEq5.gif"/></alternatives></inline-formula> is the hazard at time <italic>t</italic>. <inline-formula id="IEq6"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta$$\end{document}</tex-math><mml:math id="M18"><mml:mi>β</mml:mi></mml:math><inline-graphic xlink:href="13104_2022_6085_Article_IEq6.gif"/></alternatives></inline-formula> denotes the parameters and <inline-formula id="IEq7"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$X_{ij}$$\end{document}</tex-math><mml:math id="M20"><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13104_2022_6085_Article_IEq7.gif"/></alternatives></inline-formula> is the <italic>j</italic>th covariate for the <italic>i</italic> th subject. We aim to meta-analyze these log hazard ratios.</p>
    </sec>
    <sec id="Sec4">
      <title>Implementation</title>
      <p id="Par12">DataSHIELD operates on a distributed architecture that only allows restricted computation. DataSHIELD has a client-server architecture (Fig. <xref rid="Fig1" ref-type="fig">1</xref>). There are multiple servers located on separate sites and there is a single analysis client. Assign functions in DataSHIELD perform computation and ultimately create objects that persist on the servers and are not shared with the analysis client. These server-side objects can then be used for subsequent computations. Aggregate functions in DataSHIELD perform computation on each site, check for disclosure risks, and send aggregated results back to a client. The results do not persist on the servers, but can be saved on the client. This is shown in Fig. <xref rid="Fig1" ref-type="fig">1</xref>.<fig id="Fig1"><label>Fig. 1</label><caption><p>Client-server architecture of DataSHIELD. The diagram shows four study sites/servers (DC) each having data stored in the Original.DB. The analyst (client) sends commands from the analysis computer (AC) to each study site to request the specific data (Assigned.Data) to be analyzed. This could be all the variables or specific variables stored in Analysis.DB. R commands are also sent from the analysis computer to every study telling it to create survival objects and fit the Cox proportional hazard model. Each site responds to instructions sent by creating the survival object and fitting the model. This fitting is carried out in the R environment of each study. The coefficient matrices, standard errors, and odds ratios from each site are then pooled and meta-analyzed using fixed optimization methods, and only non-disclosive statistics are returned to the analyst</p></caption><graphic xlink:href="13104_2022_6085_Fig1_HTML" id="MO4"/></fig></p>
      <p id="Par13">The communication between the client and server for the survival models is shown in Fig. <xref rid="Fig2" ref-type="fig">2</xref> for an assign function [<italic> ds.Surv()</italic> to create survival objects on the servers] and aggregate function [<italic> ds.coxphSLMA()</italic> to perform a meta-analysis of Cox regression models]. This shows an asynchronous mode of operation in DataSHIELD where multiple parties (sites) perform secure computation. The client-side package is called dsSurvivalClient and the server-side package is called dsSurvival.<fig id="Fig2"><label>Fig. 2</label><caption><p>Architecture of client and server side functions for building survival models in dsSurvival. Left panel: an assign function for creating a server-side survival object using <italic>ds.Surv()</italic>. Right panel: an aggregate function for a Cox proportional hazards model using <italic>ds.coxphSLMA()</italic></p></caption><graphic xlink:href="13104_2022_6085_Fig2_HTML" id="MO5"/></fig></p>
      <p id="Par14">The server-side package dsSurvival 1.0.0 contains the functions <italic>SurvDS()</italic> and <italic>coxphSLMADS()</italic>. These functions are configured to reside in modified R environments located behind a firewall at each institution and process the individual-level data at each distinct repository.</p>
      <p id="Par15">dsSurvivalClient contains the functions <italic> ds.Surv()</italic> and <italic> ds.coxphSLMA()</italic>. These functions reside on the conventional R environment of the analyst. The <italic> ds.Surv()</italic> (assign function) calls the server-side function <italic> SurvDS() </italic> to assign survival objects in each site. This can then be used as the response variable in the <italic> ds.coxphSLMA()</italic> (aggregate) function. The <italic> ds.coxphSLMA()</italic> function calls and controls the corresponding server-side functions <italic> coxphSLMADS() </italic> and performs the regression analysis at different sites. These functions implement study-level meta-analysis (SLMA). The estimates from each site are combined and then pooled using fixed effects or random effects meta-analysis.</p>
    </sec>
    <sec id="Sec5">
      <title>Computational pipeline and use case</title>
      <p id="Par16">We outline the development and code for implementing survival models (Cox regression) and meta-analysis of hazard ratios in our package (dsSurvival).</p>
      <p id="Par17">A tutorial in bookdown format is available here:</p>
      <p id="Par18">
        <ext-link ext-link-type="uri" xlink:href="https://neelsoumya.github.io/dsSurvivalbookdown/">https://neelsoumya.github.io/dsSurvivalbookdown/</ext-link>
      </p>
      <p id="Par19">In the following, we demonstrate the computational steps using synthetic data. The first step is using DataSHIELD to connect to the server and loading the survival data. We assume that the reader is familiar with these details. We show the steps using synthetic data. There are 3 data sets that are held on the same server but can be considered to be on separate servers/sites.</p>
      <p id="Par20">The variable <italic>EVENT</italic> holds the event information and variables <italic>STARTTIME</italic> and <italic>ENDTIME</italic> hold the time information. There is also age and gender information in variables named age and female, respectively. We will look at how age and gender affect survival time and then meta-analyze the hazard ratios. For details on how to setup the variables, please see the bookdown above.</p>
      <graphic position="anchor" xlink:href="13104_2022_6085_Figa_HTML" id="MO6"/>
      <p id="Par21">The log-hazard ratios and their standard errors from each study can be found after running <italic>ds.coxphSLMA()</italic>. The hazard ratios can then be meta-analyzed using the <italic>metafor</italic> package [<xref ref-type="bibr" rid="CR10">10</xref>]. Fig. <xref rid="Fig3" ref-type="fig">3</xref> shows an example forest plot with meta-analysed hazard ratios. The plot shows the log hazard ratios corresponding to age in the survival model.<fig id="Fig3"><label>Fig. 3</label><caption><p>A plot showing the meta-analyzed hazard ratios generated from dsSurvival. A Cox proportional hazards model was fit to synthetic data. The hazard ratios correspond to age in a survival model</p></caption><graphic xlink:href="13104_2022_6085_Fig3_HTML" id="MO7"/></fig></p>
      <p id="Par22">There are two options to generate the survival object. The analyst can generate it separately or inline [for example, by the following command: <italic>dsSurvivalClient::ds.coxph.SLMA(formula = ’survival::Surv(time=SURVTIME,event=EVENT)</italic>
<inline-formula id="IEq8"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sim$$\end{document}</tex-math><mml:math id="M22"><mml:mo>∼</mml:mo></mml:math><inline-graphic xlink:href="13104_2022_6085_Article_IEq8.gif"/></alternatives></inline-formula>
<italic>D$age+D$female’) </italic>]. If a survival object is generated separately, it is stored on the server and can be used later in an assign function [<italic>ds.coxphSLMAassign()</italic>]. This allows the survival model to be stored on the server and can be used later for diagnostics.</p>
    </sec>
    <sec id="Sec6">
      <title>Preserving privacy and disclosure checks</title>
      <p id="Par23">Disclosure checks are an integral part of DataSHIELD and dsSurvival. dsSurvival leverages the DataSHIELD framework to ensure that multiple parties perform secure computation and only the relevant aggregated statistical details are shared. We disallow any Cox models where the number of covariate terms are greater than a fraction (default set to 20%) of the number of data points. The number of data points is the number of entries (for all patients) in the survival data. This fraction can be also be changed by the data custodian or administrator in DataSHIELD. We also deny any access to the baseline hazard function.</p>
    </sec>
    <sec id="Sec7">
      <title>Diagnostics for Cox proportional hazards models</title>
      <p id="Par24">We generate diagnostics for Cox models using the function dsSurvivalClient::ds.cox.zphSLMA(). These diagnostics can allow an analyst to determine if the proportional hazards assumption in Cox proportional hazards models is satisfied. If the p-values returned by dsSurvivalClient::ds.cox.zphSLMA() are greater than 0.05 for a covariate, then the proportional hazards assumption is likely correct for that covariate.</p>
      <p id="Par25">If the proportional hazards assumptions are violated, then the analyst may wish to modify the model. Modifications may include introducing strata or using time-dependent covariates.</p>
    </sec>
    <sec id="Sec8">
      <title>Discussion and conclusion</title>
      <p id="Par26">dsSurvival is a DataSHIELD package for privacy preserving meta-analysis of survival data distributed across different sites. dsSurvival also performs federated calculation of hazard ratios. Its implementation relies exclusively on the distributed algorithm of the DataSHIELD environment. DataSHIELD facilitates important research particularly amongst institutions that are not allowed to transmit patient-level data to an outside server.</p>
      <p id="Par27">Previously building survival models in DataSHIELD involved using approximations like piecewise exponential models. This involves defining time buckets and is an additional burden on the researcher. A lack of familiarity with this approach also makes people less trusting of the results.</p>
      <p id="Par28">Previous work has looked at reducing the dimensions of a survival model and the reduced feature space model is then shared amongst multiple parties [<xref ref-type="bibr" rid="CR11">11</xref>]. Survival analysis is also possible in DataSHIELD using dsSwissKnife [<xref ref-type="bibr" rid="CR12">12</xref>]. However, our package offers advantages such as storing the model on the server-side, diagnostics, integration with client-side meta-analysis and future plans to add in more functionality such as survival curves.</p>
      <p id="Par29">We have released an R package for privacy preserving survival analysis in DataSHIELD. Our tool can be of great use in domains where there is a need for building survival models and there are privacy concerns about sharing data. We hope this suite of tools and tutorials will serve as a guideline on how to use survival analysis in a federated environment.</p>
    </sec>
  </sec>
  <sec id="Sec9">
    <title>Limitations</title>
    <p id="Par30">Our approach implements study-level meta-analysis. This is a computationally faster approach but is also a limitation, especially if the units of meta-analysis are centres within a study. This may reduce the number of events per center and normality approximations implicit in two-stage meta-analysis may be violated. In the future we will implement functionality of iteratively fitting a single model across all studies. We will also develop plotting of privacy preserving survival curves and the ability to have time-dependent covariates in survival models. Our package also does not return Schoenfeld or Martingale residuals (due to privacy concerns), which are used as diagnostics for survival models. Finally in the future we will apply our package on real world data and solve any practical issues that arise.</p>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviation</title>
    <def-list>
      <def-item>
        <term>SLMA</term>
        <def>
          <p id="Par3">Study level meta-analysis</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher’s Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
    <fn>
      <p>Soumya Banerjee and Ghislain N. Sofack are equal first authors</p>
    </fn>
    <fn>
      <p>Daniela Zöller and Tom R. P. Bishop are equal senior authors</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>We acknowledge the help and support of the DataSHIELD technical team. We are especially grateful to Stephen Sharp, Elaine Smith, Stuart Wheater, Patricia Ryser-Welch, Sharreen Tan and Wolfgang Viechtbauer for fruitful discussions and feedback.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author contributions</title>
    <p>SB and GS carried out the analysis and implementation, participated in the design of the study and drafted the manuscript. TP, DA and PB gave critical comments and edited the manuscript. TB and DZ directed the study. All the authors read and approved the final manucript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>This work was funded by EUCAN-Connect under the European Union’s Horizon 2020 research and innovation programme (Grant Agreement No. 824989). The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript. The views expressed are those of the authors and not necessarily those of the funders.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availibility of data and materials</title>
    <p>This study does not generate any data. A tutorial in bookdown format with code, diagnostics, plots and synthetic data is available here: <ext-link ext-link-type="uri" xlink:href="https://neelsoumya.github.io/dsSurvivalbookdown/">https://neelsoumya.github.io/dsSurvivalbookdown/</ext-link>. All code is available from the following repositories: <ext-link ext-link-type="uri" xlink:href="https://github.com/neelsoumya/dsSurvivalClient/">https://github.com/neelsoumya/dsSurvivalClient/</ext-link>.<ext-link ext-link-type="uri" xlink:href="https://github.com/neelsoumya/dsSurvival/">https://github.com/neelsoumya/dsSurvival/</ext-link>. Our package can provide figures for downstream analysis. An example script for generating forest plots for hazard ratios is available here: <ext-link ext-link-type="uri" xlink:href="https://github.com/neelsoumya/dsSurvival/blob/main/forestplot_FINAL.R">https://github.com/neelsoumya/dsSurvival/blob/main/forestplot_FINAL.R</ext-link>.</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar2">
      <title>Ethics approval and consent to participate</title>
      <p id="Par31">No ethics approval and consent to participate was necessary.</p>
    </notes>
    <notes id="FPar1" notes-type="COI-statement">
      <title>Competing interests</title>
      <p id="Par32">All authors declare they have no competing interests to disclose.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Altman</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>De Stavola</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Love</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Stepniewska</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>Review of survival analyses published in cancer journals</article-title>
        <source>Br J Cancer</source>
        <year>1995</year>
        <volume>72</volume>
        <fpage>511</fpage>
        <lpage>518</lpage>
        <pub-id pub-id-type="doi">10.1038/bjc.1995.364</pub-id>
        <pub-id pub-id-type="pmid">7640241</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Machin</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Cheung</surname>
            <given-names>YB</given-names>
          </name>
          <name>
            <surname>Parmar</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <source>Survival analysis: a practical approach</source>
        <year>2006</year>
        <publisher-loc>Hoboken</publisher-loc>
        <publisher-name>Wiley</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cox</surname>
            <given-names>DR</given-names>
          </name>
        </person-group>
        <article-title>Regression models and life-tables</article-title>
        <source>J R Stat Soc</source>
        <year>1972</year>
        <volume>34</volume>
        <fpage>187</fpage>
        <lpage>202</lpage>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hartmann</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Schuetz</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Albrich</surname>
            <given-names>WC</given-names>
          </name>
          <name>
            <surname>Anker</surname>
            <given-names>SD</given-names>
          </name>
          <name>
            <surname>Mueller</surname>
            <given-names>B</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Time-dependent cox regression: serial measurement of the cardiovascular biomarker proadrenomedullin improves survival prediction in patients with lower respiratory tract infection</article-title>
        <source>Int J Cardiol</source>
        <year>2012</year>
        <volume>161</volume>
        <fpage>166</fpage>
        <lpage>173</lpage>
        <pub-id pub-id-type="doi">10.1016/j.ijcard.2012.09.014</pub-id>
        <pub-id pub-id-type="pmid">23017815</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Blasimme</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Fadda</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Schneider</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Vayena</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>Data sharing for precision medicine: policy lessons and future directions</article-title>
        <source>Health Aff</source>
        <year>2018</year>
        <volume>37</volume>
        <fpage>702</fpage>
        <lpage>709</lpage>
        <pub-id pub-id-type="doi">10.1377/hlthaff.2017.1558</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gaye</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Marcon</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Isaeva</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>LaFlamme</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Turner</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Datashield: taking the analysis to the data, not the data to the analysis</article-title>
        <source>Int J Epidemiol</source>
        <year>2014</year>
        <volume>43</volume>
        <fpage>1929</fpage>
        <lpage>1944</lpage>
        <pub-id pub-id-type="doi">10.1093/ije/dyu188</pub-id>
        <pub-id pub-id-type="pmid">25261970</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <mixed-citation publication-type="other">Banerjee S, Bishop T. dsSynthetic: synthetic data generation for the DataSHIELD federated analysis system, DataSHIELD | DataSHIELD | Newcastle University. <ext-link ext-link-type="uri" xlink:href="https://osf.io/tkxqm">https://osf.io/tkxqm</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <mixed-citation publication-type="other">EUCAN Connect. <ext-link ext-link-type="uri" xlink:href="https://www.eucanconnect.eu/">https://www.eucanconnect.eu/</ext-link>. Accessed May 2022.</mixed-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pastorino</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Bishop</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Crozier</surname>
            <given-names>SR</given-names>
          </name>
          <name>
            <surname>Granström</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Kordas</surname>
            <given-names>K</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Associations between maternal physical activity in early and late pregnancy and offspring birth size: remote federated individual level meta-analysis from eight cohort studies</article-title>
        <source>BJOG Int J Obstet Gynaecol</source>
        <year>2019</year>
        <volume>126</volume>
        <fpage>459</fpage>
        <lpage>470</lpage>
        <pub-id pub-id-type="doi">10.1111/1471-0528.15476</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Viechtbauer</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>Conducting meta-analyses in R with the metafor Package</article-title>
        <source>J Stat Softw</source>
        <year>2010</year>
        <volume>36</volume>
        <fpage>1</fpage>
        <lpage>48</lpage>
        <pub-id pub-id-type="doi">10.18637/jss.v036.i03</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yu</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Fung</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Rosales</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Krishnan</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Rao</surname>
            <given-names>RB</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Privacy-preserving cox regression for survival analysis</article-title>
        <source>Proc ACM SIGKDD Int Conf Knowl Discov Data Min</source>
        <year>2008</year>
        <pub-id pub-id-type="doi">10.1145/1401890.1402013</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dragan</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Sparsø</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Kuznetsov</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Slieker</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Ibberson</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>dsSwissKnife: an R package for federated data analysis</article-title>
        <source>bioRxiv</source>
        <year>2020</year>
        <pub-id pub-id-type="doi">10.1101/2020.11.17.386813</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
