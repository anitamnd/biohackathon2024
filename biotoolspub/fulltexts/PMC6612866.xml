<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6612866</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btz392</article-id>
    <article-id pub-id-type="publisher-id">btz392</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Ismb/Eccb 2019 Conference Proceedings</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Population Genomics and Molecular Evolution</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Inference of clonal selection in cancer populations using single-cell sequencing data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Skums</surname>
          <given-names>Pavel</given-names>
        </name>
        <xref ref-type="aff" rid="btz392-aff1">1</xref>
        <xref ref-type="corresp" rid="btz392-cor1"/>
        <!--<email>pskums@gsu.edu</email>-->
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Tsyvina</surname>
          <given-names>Viachaslau</given-names>
        </name>
        <xref ref-type="aff" rid="btz392-aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Zelikovsky</surname>
          <given-names>Alex</given-names>
        </name>
        <xref ref-type="aff" rid="btz392-aff1">1</xref>
        <xref ref-type="aff" rid="btz392-aff2">2</xref>
      </contrib>
    </contrib-group>
    <aff id="btz392-aff1"><label>1</label>Department of Computer Science, Georgia State University, Atlanta, GA, USA</aff>
    <aff id="btz392-aff2"><label>2</label>The Laboratory of Bioinformatics, I.M. Sechenov First Moscow State Medical University, Moscow, Russia</aff>
    <author-notes>
      <corresp id="btz392-cor1">To whom correspondence should be addressed. <email>pskums@gsu.edu</email></corresp>
    </author-notes>
    <pub-date pub-type="ppub">
      <month>7</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2019-07-05">
      <day>05</day>
      <month>7</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>05</day>
      <month>7</month>
      <year>2019</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. -->
    <volume>35</volume>
    <issue>14</issue>
    <fpage>i398</fpage>
    <lpage>i407</lpage>
    <permissions>
      <copyright-statement>© The Author(s) 2019. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2019</copyright-year>
      <license license-type="cc-by-nc" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/">http://creativecommons.org/licenses/by-nc/4.0/</ext-link>), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.com</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btz392.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Summary</title>
        <p>Intra-tumor heterogeneity is one of the major factors influencing cancer progression and treatment outcome. However, evolutionary dynamics of cancer clone populations remain poorly understood. Quantification of clonal selection and inference of fitness landscapes of tumors is a key step to understanding evolutionary mechanisms driving cancer. These problems could be addressed using single-cell sequencing (scSeq), which provides an unprecedented insight into intra-tumor heterogeneity allowing to study and quantify selective advantages of individual clones. Here, we present Single Cell Inference of FItness Landscape (SCIFIL), a computational tool for inference of fitness landscapes of heterogeneous cancer clone populations from scSeq data. SCIFIL allows to estimate maximum likelihood fitnesses of clone variants, measure their selective advantages and order of appearance by fitting an evolutionary model into the tumor phylogeny. We demonstrate the accuracy our approach, and show how it could be applied to experimental tumor data to study clonal selection and infer evolutionary history. SCIFIL can be used to provide new insight into the evolutionary dynamics of cancer.</p>
      </sec>
      <sec id="s2">
        <title>Availability and implementation</title>
        <p>Its source code is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/compbel/SCIFIL">https://github.com/compbel/SCIFIL</ext-link>.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">NIH</named-content>
          <named-content content-type="funder-identifier">10.13039/100000002</named-content>
        </funding-source>
        <award-id>5R01EB025022</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="10"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Cancer is responsible for more than 600 000 deaths in the USA annually (<xref rid="btz392-B37" ref-type="bibr">Siegel <italic>et al.</italic>, 2018</xref>). It is a disease driven by the uncontrolled growth of cancer cells having series of somatic mutations acquired during the tumor evolution. Cancer clones form heterogeneous populations, which include multiple subpopulations constantly evolving to compete for resources, metastasize, escape immune system and therapy (<xref rid="btz392-B9" ref-type="bibr">Doyle <italic>et al.</italic>, 2014</xref>; <xref rid="btz392-B13" ref-type="bibr">Greaves and Maley, 2012</xref>; <xref rid="btz392-B21" ref-type="bibr">Kuipers <italic>et al.</italic>, 2017a</xref>; <xref rid="btz392-B43" ref-type="bibr">Yates and Campbell, 2012</xref>). Clonal heterogeneity plays key role in tumor progression (<xref rid="btz392-B28" ref-type="bibr">Merlo <italic>et al.</italic>, 2010</xref>), and has important implications for diagnostics and therapy, since rare drug resistant variants could become dominant and lead to relapse in the patient (<xref rid="btz392-B9" ref-type="bibr">Doyle <italic>et al.</italic>, 2014</xref>; <xref rid="btz392-B23" ref-type="bibr">Landau <italic>et al.</italic>, 2013</xref>). Therefore, cancer is now viewed as a dynamic evolutionary process defined by complex interactions between clonal variants, which include both competition and cooperation (<xref rid="btz392-B3" ref-type="bibr">Bonavia <italic>et al.</italic>, 2011</xref>; <xref rid="btz392-B13" ref-type="bibr">Greaves and Maley, 2012</xref>; <xref rid="btz392-B43" ref-type="bibr">Yates and Campbell, 2012</xref>).</p>
    <p>Recent advances in sequencing technologies promise to have a profound effect on oncological research. Study of genomic data for different tumors produced by next-generation sequencing (NGS) led to progress in understanding evolutionary mechanisms of cancer (<xref rid="btz392-B13" ref-type="bibr">Greaves and Maley, 2012</xref>; <xref rid="btz392-B21" ref-type="bibr">Kuipers <italic>et al.</italic>, 2017a</xref>; <xref rid="btz392-B43" ref-type="bibr">Yates and Campbell, 2012</xref>). Most of cancer data have been obtained using bulk sequencing, which produces admixed populations of cells. Recently, the most promising technological breakthrough was the advent of <italic>single-cell sequencing</italic> (scSeq), which allows to access cancer clone populations at the finest possible resolution. scSeq protocols combined with NGS allow to analyze genomes of individual cells, thus providing deeper insight into biological mechanisms of tumor progression.</p>
    <p>The cornerstone of such analysis is an estimation of parameters defining the evolution of heterogeneous clonal populations. Currently, there is no scientific consensus about the rules guiding the evolution of cancer cells (<xref rid="btz392-B6" ref-type="bibr">Davis <italic>et al.</italic>, 2017</xref>; <xref rid="btz392-B32" ref-type="bibr">Noorbakhsh and Chuang, 2017</xref>; <xref rid="btz392-B38" ref-type="bibr">Tarabichi <italic>et al.</italic>, 2018</xref>; <xref rid="btz392-B41" ref-type="bibr">Williams <italic>et al.</italic>, 2018</xref>), with multiple competing theories being advanced by different researchers. The open questions include the rules of evolution (neutral, linear, branching or punctuated), ways of interaction between clonal variants (competition or cooperation) and the role of epistasis (non-linear interaction of single nucleotide variant (SNVs) or genes). These questions could be addressed by estimation of evolutionary parameters for cancer lineages from NGS data (<xref rid="btz392-B38" ref-type="bibr">Tarabichi <italic>et al.</italic>, 2018</xref>; <xref rid="btz392-B41" ref-type="bibr">Williams <italic>et al.</italic>, 2018</xref>).</p>
    <p>One of the most important evolutionary parameters is the collection of replicative fitnesses of individual genomic variants, commonly termed <italic>fitness landscape</italic> in evolutionary biology (<xref rid="btz392-B12" ref-type="bibr">Gavrilets, 2004</xref>). Several computational tools have been proposed for <italic>in vitro</italic> estimation of fitness landscapes (<xref rid="btz392-B11" ref-type="bibr">Ferguson <italic>et al.</italic>, 2013</xref>; <xref rid="btz392-B15" ref-type="bibr">Hinkley <italic>et al.</italic>, 2011</xref>; <xref rid="btz392-B25" ref-type="bibr">Ma <italic>et al.</italic>, 2010</xref>; <xref rid="btz392-B35" ref-type="bibr">Segal <italic>et al.</italic>, 2004</xref>). However, <italic>in vitro</italic> studies are cost- and labor-intensive, consider organisms removed from their natural environments and does not allow to capture all population genetic diversity (<xref rid="btz392-B36" ref-type="bibr">Seifert <italic>et al.</italic>, 2014</xref>). One of the possible ways to infer fitness landscape <italic>in vivo</italic> is to analyze follow-up samples taken from a patient at multiple time points and compute fitnesses directly by measuring changes of frequencies of genomic variants over time. However, follow-up samples are very scarce, and the overwhelming majority of data represent individual samples.</p>
    <p>Quantification of clonal selection from individual samples is computationally challenging, but extremely important for understanding mechanisms of cancer progression (<xref rid="btz392-B38" ref-type="bibr">Tarabichi <italic>et al.</italic>, 2018</xref>; <xref rid="btz392-B41" ref-type="bibr">Williams <italic>et al.</italic>, 2018</xref>). In particular, recent findings on structures of fitness landscapes of cancer from bulk sequencing data (<xref rid="btz392-B40" ref-type="bibr">Williams <italic>et al.</italic>, 2016</xref>) initiated a lively scientific discussion published in several papers (<xref rid="btz392-B32" ref-type="bibr">Noorbakhsh and Chuang, 2017</xref>; <xref rid="btz392-B38" ref-type="bibr">Tarabichi <italic>et al.</italic>, 2018</xref>; <xref rid="btz392-B41" ref-type="bibr">Williams <italic>et al.</italic>, 2018</xref>). It can be anticipated that scSeq data will be able to shed light into this important problem. It is known that relative abundances of genomic variants alone are not indicative of variant fitnesses (<xref rid="btz392-B36" ref-type="bibr">Seifert <italic>et al.</italic>, 2014</xref>). Existing methods for inference of fitnesses from single samples utilize more sophisticated approaches, but have various limitations including reliance on the assumption that the population is in equilibrium state, or disregard of population heterogeneity and variability of fitness landscapes, or customization to bulk sequencing data (<xref rid="btz392-B7" ref-type="bibr">Deforche <italic>et al.</italic>, 2008</xref>; <xref rid="btz392-B36" ref-type="bibr">Seifert <italic>et al.</italic>, 2014</xref>; <xref rid="btz392-B41" ref-type="bibr">Williams <italic>et al.</italic>, 2018</xref>).</p>
    <sec>
      <title>1.1 Contributions</title>
      <p>We propose a computational method Single Cell Inference of FItness Landscape (SCIFIL) for <italic>in vivo</italic> inference of clonal selection and estimate of fitness landscapes of heterogeneous cancer clone populations from scSeq data. SCIFIL estimates fitnesses of clonal variants rather than alleles, and does not assume allele independence which allows to take into account the effects of epistasis. Instead of assuming that sampled populations are in the equilibrium state, our method estimates fitnesses of individual clone types using a maximum likelihood approach. We demonstrate that the proposed method allows for accurate inference of fitness landscapes and quantification of clonal selection. We conclude by applying SCIFIL to real tumor data.</p>
    </sec>
  </sec>
  <sec>
    <title>2 Materials and Methods</title>
    <p>We propose a maximum likelihood approach, which estimates fitnesses of individual clonal variants by fitting into the tumor phylogeny an evolutionary model with the parameters explaining the observed data with the highest probability. We first establish the ordinary differential equations (ODE) model for the tumor evolutionary dynamics, and define the likelihood of the observed data given the model parameters. We conclude with finding fitnesses maximizing the likelihood by reducing the problem to finding the most likely mutation order and applying branch-and-bound search to solve that problem.</p>
    <p>Traditionally, evolutionary histories are represented using binary phylogenetic trees. Following <xref rid="btz392-B17" ref-type="bibr">Jahn <italic>et al.</italic> (2016)</xref>, we use an alternative representation of an evolutionary history of a tumor using a <italic>mutation tree</italic>. The internal nodes of a mutation tree represent mutations, leafs represent single cells, internal nodes are connected according to their order of appearance during the tumor evolution and the mutation profile of each cell equals the set of mutations on its path to the root (<xref ref-type="fig" rid="btz392-F1">Fig. 1</xref>). In addition, we accumulate all leafs attached to the same internal node into a single leaf with an abundance representing a particular clone. For simplicity, we assume that there is a leaf attached to every internal node, with some leafs having an abundance 0 (or rather a small number <italic>δ </italic>≪ 1). Generally, we do not need to employ the infinite site assumption, i.e. repeats of mutations are allowed provided that mutation profiles of all clones in a tree are unique. It agrees with recent findings (<xref rid="btz392-B22" ref-type="bibr">Kuipers <italic>et al.</italic>, 2017b</xref>). A mutation tree can be constructed using currently available tools, such as SCITE (<xref rid="btz392-B17" ref-type="bibr">Jahn <italic>et al.</italic>, 2016</xref>), infSCITE (<xref rid="btz392-B22" ref-type="bibr">Kuipers <italic>et al.</italic>, 2017b</xref>) or SiFit (<xref rid="btz392-B44" ref-type="bibr">Zafar <italic>et al.</italic>, 2017</xref>).
</p>
    <fig id="btz392-F1" orientation="portrait" position="float">
      <label>Fig. 1.</label>
      <caption>
        <p>Mutation tree</p>
      </caption>
      <graphic xlink:href="btz392f1"/>
    </fig>
    <p>Formally, we consider the following algorithmic problem. Given are:
<list list-type="bullet"><list-item><p>mutation tree <italic>T</italic> with <italic>n</italic> + 1 leafs corresponding to clonal variants. We assume that internal nodes of <italic>T</italic> are labeled 0, 1,…, <italic>n</italic> and the <italic>i</italic>th clone is attached to the node <italic>i</italic>. The root of <italic>T</italic> correspond to the mutation 0, which represent absence of somatic mutations or healthy tissue.</p></list-item><list-item><p>observed relative abundances <inline-formula id="IE1"><mml:math id="IM1"><mml:mrow><mml:mi mathvariant="script">A</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> of clones.</p></list-item><list-item><p>Mean cancer cells mutation rate <italic>θ</italic>. This is a well-studied parameter with estimations provided by prior studies (<xref rid="btz392-B14" ref-type="bibr">Hao <italic>et al.</italic>, 2016</xref>).</p></list-item></list></p>
    <p>The goal is to find fitnesses <inline-formula id="IE2"><mml:math id="IM2"><mml:mrow><mml:mi mathvariant="script">F</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> maximizing the likelihood
<disp-formula id="E1"><label>(1)</label><mml:math id="M1"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="script">A</mml:mi><mml:mo>|</mml:mo><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="script">F</mml:mi><mml:mo>,</mml:mo><mml:mo>θ</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></disp-formula></p>
    <p>This section is organized as follows. First, we introduce our evolutionary model of choice and the definition of the probability (1). Next, we describe how the likelihood is modified to transform the maximum likelihood problem (1) into a discrete optimization problem. Finally, we describe the method of estimation of fitnesses <inline-formula id="IE3"><mml:math id="IM3"><mml:mi mathvariant="script">F</mml:mi></mml:math></inline-formula> maximizing (1).</p>
    <sec>
      <title>2.1 Evolutionary model</title>
      <p>We consider tumor evolution as a branching process described by the mutation tree <italic>T</italic>. Let <italic>V</italic>(<italic>T</italic>), <italic>V</italic><sub><italic>I</italic></sub>(<italic>T</italic>) and <italic>E</italic>(<italic>T</italic>) be the node set, the internal node set and an the arc set of <italic>T</italic>, respectively. Let also <italic>p<sub>i</sub></italic> denote the parent of a node <inline-formula id="IE4"><mml:math id="IM4"><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mi>I</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. We assume that nodes <italic>V</italic><sub><italic>I</italic></sub>(<italic>T</italic>) represent mutation events, with <italic>j</italic>th event occurring at rate <italic>θ<sub>j</sub></italic>. The mutation event corresponding to a node <italic>i</italic> happens at time <italic>t<sub>i</sub></italic>; at the event the clonal variant corresponding to the parent node <italic>p<sub>i</sub></italic> gives birth to a variant <italic>i</italic>. The dynamics of the cancer clone population is described by the <italic>piecewise continuous</italic> function <inline-formula id="IE5"><mml:math id="IM5"><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, where <inline-formula id="IE6"><mml:math id="IM6"><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is the relative abundance of the <italic>i</italic>th clonal variant. The discontinuity points of <italic>x</italic> correspond to mutation events. Let <italic>r</italic>, <italic>i</italic>, <italic>j</italic> be three consecutive mutation events with times <inline-formula id="IE7"><mml:math id="IM7"><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mi>r</mml:mi></mml:msub><mml:mo>&lt;</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>&lt;</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, and <inline-formula id="IE8"><mml:math id="IM8"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mi>k</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> be the restriction of <italic>x<sub>i</sub></italic> to the interval [<italic>t<sub>i</sub></italic>, <italic>t<sub>j</sub></italic>]. Between mutation events <italic>i</italic> and <italic>j</italic> clonal frequencies <inline-formula id="IE9"><mml:math id="IM9"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mi>k</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> follow the system of ODEs (<xref rid="btz392-B34" ref-type="bibr">Nowak and May, 2000</xref>):
<disp-formula id="E2"><label>(2)</label><mml:math id="M2"><mml:mrow><mml:mfrac><mml:mi>d</mml:mi><mml:mrow><mml:mi mathvariant="italic">dt</mml:mi></mml:mrow></mml:mfrac><mml:msubsup><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mi>k</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:msubsup><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mi>k</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mi>k</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mi>l</mml:mi></mml:msub></mml:mrow><mml:msubsup><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mi>l</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math></disp-formula>
with initial conditions
<disp-formula id="E3"><label>(3)</label><mml:math id="M3"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mi>k</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="true">{</mml:mo><mml:mrow><mml:mtable><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mo>ε</mml:mo><mml:msubsup><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mtext>if</mml:mtext><mml:mo> </mml:mo><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mo>ε</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:msubsup><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mi>k</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mtext>if</mml:mtext><mml:mo> </mml:mo><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mi>k</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mtext>otherwise</mml:mtext><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula></p>
      <p>Subtraction of the term <inline-formula id="IE10"><mml:math id="IM10"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mi>k</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:mrow><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mi>l</mml:mi></mml:msub></mml:mrow><mml:msubsup><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mi>l</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> ensures that relative abundances of variants sum up to 1. Initial conditions (3) link clone abundances before and after the mutation event <italic>i</italic> and indicate that at time <italic>t<sub>i</sub></italic> the clone <italic>i</italic> is generated by the clone <italic>p<sub>i</sub></italic>. The parameter <inline-formula id="IE11"><mml:math id="IM11"><mml:mrow><mml:mo>ε</mml:mo><mml:mo>≪</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> is a small number. At time 0, the root clonal variant (healthy tissue) gives birth to the first mutation, with the corresponding clones having relative abundances 1 − <italic>ε</italic> and <italic>ε</italic>. The model (2) is a branching-type variant of the quasispecies model, which is applicable to cancer evolution (<xref rid="btz392-B42" ref-type="bibr">Wodarz and Komarova, 2005</xref>) and agrees or extends several classical population genetics concepts (<xref rid="btz392-B39" ref-type="bibr">Wilke, 2005</xref>), including those describing genetic systems governed by mutation and selection (<xref rid="btz392-B20" ref-type="bibr">Kimura and Maruyama, 1966</xref>; <xref rid="btz392-B29" ref-type="bibr">Moran, 1976</xref>). It does not include specific assumptions about clonal competition or cooperation.</p>
    </sec>
    <sec>
      <title>2.2 Likelihood definition</title>
      <p>In addition to <italic>n</italic> mutation events, we consider the (<italic>n </italic>+<italic> </italic>1)th event representing cell sampling. Suppose that times of mutation events <inline-formula id="IE12"><mml:math id="IM12"><mml:mrow><mml:mo>Ω</mml:mo><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> and mutation rates between events <inline-formula id="IE13"><mml:math id="IM13"><mml:mrow><mml:mo>Θ</mml:mo><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> are given. Let <inline-formula id="IE14"><mml:math id="IM14"><mml:mrow><mml:mo>σ</mml:mo><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> be the permutation of events in order of their appearance, i.e. <inline-formula id="IE15"><mml:math id="IM15"><mml:mrow><mml:mn>0</mml:mn><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:mo>…</mml:mo><mml:mo>&lt;</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>. The probability of observing abundances <inline-formula id="IE16"><mml:math id="IM16"><mml:mi mathvariant="script">A</mml:mi></mml:math></inline-formula> given <italic>T</italic>,<inline-formula id="IE17"><mml:math id="IM17"><mml:mi mathvariant="script">F</mml:mi></mml:math></inline-formula>, Ω, Θ and <italic>θ</italic> is defined as the product of probabilities of mutation events and probabilities of observed clone abundances.</p>
      <p>The mutation event in the vertex <italic>σ<sub>j</sub></italic> occurs if two conditions are met:
<list list-type="alpha-lower"><list-item><p>no mutation events have been observed over the time interval <inline-formula id="IE18"><mml:math id="IM18"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>;</p></list-item><list-item><p>at time <inline-formula id="IE19"><mml:math id="IM19"><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> the mutation happened in the clone <inline-formula id="IE20"><mml:math id="IM20"><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> rather than in other clones which exist at that time.</p></list-item></list></p>
      <p>Appearance of mutation is a classical rare event, and therefore we assume that the time intervals between consecutive mutation events <italic>i</italic> and <italic>j</italic> follow a Poisson distribution with the mean <inline-formula id="IE21"><mml:math id="IM21"><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula>. Mutation rates are distributed normally with the mean <italic>θ</italic> and the standard deviation <italic>ν</italic>. Assuming that mutations are random, the probability of (b) is equal to the frequency <inline-formula id="IE22"><mml:math id="IM22"><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> of the clone <inline-formula id="IE23"><mml:math id="IM23"><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> at time <inline-formula id="IE24"><mml:math id="IM24"><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> according to the system (2). Finally, we assume that the probability of seeing observed frequencies given model-based frequencies at the sampling time follows a multinomial distribution <inline-formula id="IE25"><mml:math id="IM25"><mml:mrow><mml:mi mathvariant="script">M</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. After putting all probabilities together, we have
<disp-formula id="E4"><label>(4)</label><mml:math id="M4"><mml:mtable><mml:mtr><mml:mtd><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="script">A</mml:mi><mml:mo>|</mml:mo><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="script">F</mml:mi><mml:mo>,</mml:mo><mml:mo>Ω</mml:mo><mml:mo>,</mml:mo><mml:mo>θ</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:mi>P</mml:mi><mml:mi>o</mml:mi><mml:mi mathvariant="italic">is</mml:mi><mml:mo stretchy="true">(</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo stretchy="true">)</mml:mo><mml:mo>·</mml:mo><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:mi mathvariant="script">N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mo>θ</mml:mo><mml:mo>,</mml:mo><mml:mo>ν</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>·</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>×</mml:mo><mml:mi mathvariant="script">M</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula></p>
      <p>Our goal is to find best fitting fitnesses <inline-formula id="IE26"><mml:math id="IM26"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="script">F</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ML</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, rates Θ<sub><italic>ML</italic></sub> and times Ω<sub><italic>ML</italic></sub> by solving the following maximum likelihood problem:
<disp-formula id="E5"><label>(5)</label><mml:math id="M5"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script">F</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ML</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo>Θ</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ML</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo>Ω</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ML</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mtext>arg</mml:mtext><mml:mtext>max</mml:mtext></mml:mrow><mml:mrow><mml:mi mathvariant="script">F</mml:mi><mml:mo>,</mml:mo><mml:mo>Θ</mml:mo><mml:mo>,</mml:mo><mml:mo>Ω</mml:mo></mml:mrow></mml:munder><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="script">A</mml:mi><mml:mo>|</mml:mo><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="script">F</mml:mi><mml:mo>,</mml:mo><mml:mo>Ω</mml:mo><mml:mo>,</mml:mo><mml:mo>θ</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></disp-formula></p>
      <p>The probabilities <inline-formula id="IE27"><mml:math id="IM27"><mml:mrow><mml:msubsup><mml:mo>∏</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mi>P</mml:mi><mml:mi>o</mml:mi><mml:mi mathvariant="italic">is</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo stretchy="true">)</mml:mo><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:msubsup><mml:mo>∏</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:mi mathvariant="script">N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mo>θ</mml:mo><mml:mo>,</mml:mo><mml:mo>ν</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:msubsup><mml:mo>∏</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE28"><mml:math id="IM28"><mml:mrow><mml:mi mathvariant="script">M</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> are further referred to as <italic>time likelihood</italic>, <italic>rate likelihood</italic>, <italic>mutation likelihood</italic> and <italic>abundance likelihood</italic>, respectively. For the tree shown in <xref ref-type="fig" rid="btz392-F2">Figure 2</xref>, it is equally feasible that the mutation 2 appeared before the mutation 3 or vice versa. However, clone 2 later produces mutations 4 and 5, and therefore the mutation likelihood suggests that at that mutation events it had high abundance. This situation is probable if either 2nd mutation appeared earlier or it appeared later but has a high fitness. Time, rate and abundance likelihoods allow to choose between these two alternatives.
</p>
      <fig id="btz392-F2" orientation="portrait" position="float">
        <label>Fig. 2.</label>
        <caption>
          <p>Depiction of the evolutionary model. Tree nodes represent mutation events whose times are marked on the time axis. Leafs represent the sampling event. For each node, the distribution of clone abundances after the corresponding event is shown</p>
        </caption>
        <graphic xlink:href="btz392f2"/>
      </fig>
    </sec>
    <sec>
      <title>2.3 Reduction to discrete optimization</title>
      <p>The standard way to solve the maximum likelihood problem (5) is to optimize <inline-formula id="IE29"><mml:math id="IM29"><mml:mi mathvariant="script">F</mml:mi></mml:math></inline-formula>, Θ and Ω jointly using Markov Chain Monte Carlo (MCMC) sampling. However, our experiments have shown that the function (1) has too many local optima which makes MCMC search over the continuous space of possible solutions inefficient. Therefore, we suggest an alternative heuristic approach, which transforms the problem (5) into a discrete optimization problem akin to a scheduling problem. This problem is then solved using a specifically designed combinatorial heuristic search.</p>
      <p>First, we assume that all fitnesses are relative with respect to a fitness of a clone 0 which is set to be <inline-formula id="IE30"><mml:math id="IM30"><mml:mrow><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>. By default, this clone corresponds to the normal tissue. For the problem of inference of clonal selection such assumption does not restrict the predictive power. Next, we observe that any assignment of event times Ω defines the order of appearance <italic>μ<sub>i</sub></italic> for each node <inline-formula id="IE31"><mml:math id="IM31"><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mi>V</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> (e.g. in <xref ref-type="fig" rid="btz392-F2">Fig. 2</xref><inline-formula id="IE32"><mml:math id="IM32"><mml:mrow><mml:msub><mml:mrow><mml:mo>μ</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:math></inline-formula> for <inline-formula id="IE33"><mml:math id="IM33"><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:math></inline-formula>). This order agrees with the natural vertex order induced by <italic>T</italic>, i.e. <inline-formula id="IE34"><mml:math id="IM34"><mml:mrow><mml:msub><mml:mrow><mml:mo>μ</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>&lt;</mml:mo><mml:msub><mml:mrow><mml:mo>μ</mml:mo></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> whenever <italic>i</italic> is an ancestor of <italic>j</italic>. It turned out that conversely any order <italic>μ</italic> defines times <inline-formula id="IE35"><mml:math id="IM35"><mml:mrow><mml:msup><mml:mrow><mml:mo>Ω</mml:mo></mml:mrow><mml:mo>μ</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula>, rates <inline-formula id="IE36"><mml:math id="IM36"><mml:mrow><mml:msup><mml:mrow><mml:mo>Θ</mml:mo></mml:mrow><mml:mo>μ</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula> and fitnesses <inline-formula id="IE37"><mml:math id="IM37"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">F</mml:mi></mml:mrow><mml:mo>μ</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula> which maximize the partial likelihood
<disp-formula id="E6"><label>(6)</label><mml:math id="M6"><mml:mtable><mml:mtr><mml:mtd><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:mi>P</mml:mi><mml:mi>o</mml:mi><mml:mi mathvariant="italic">is</mml:mi><mml:mo stretchy="true">(</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo stretchy="true">)</mml:mo><mml:mo>·</mml:mo><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:mi mathvariant="script">N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mo>θ</mml:mo><mml:mo>,</mml:mo><mml:mo>ν</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>·</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>×</mml:mo><mml:mi mathvariant="script">M</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula></p>
      <p>More precisely, the following proposition holds.</p>
      <p>
        <statement id="mthst1">
          <label>Proposition 1.</label>
          <p><italic> For a given order vector μ, times</italic><inline-formula id="IE38"><mml:math id="IM38"><mml:mrow><mml:msup><mml:mrow><mml:mo>Ω</mml:mo></mml:mrow><mml:mo>μ</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula><italic>, rates</italic><inline-formula id="IE39"><mml:math id="IM39"><mml:mrow><mml:msup><mml:mrow><mml:mo>Θ</mml:mo></mml:mrow><mml:mo>μ</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula><italic>and fitnesses</italic><inline-formula id="IE40"><mml:math id="IM40"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">F</mml:mi></mml:mrow><mml:mo>μ</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula><italic>maximizing (6) can be estimated as follows:</italic><disp-formula id="E7"><label>(7)</label><mml:math id="M7"><mml:mrow><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mo>θ</mml:mo><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mo>μ</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>θ</mml:mo></mml:mfrac><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mi>n</mml:mi><mml:mo>θ</mml:mo></mml:mfrac></mml:mrow></mml:math></disp-formula><disp-formula id="E8"><label>(8)</label><mml:math id="M8"><mml:mrow><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mo>θ</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>∖</mml:mo><mml:mo>{</mml:mo><mml:mn>0</mml:mn><mml:mo>}</mml:mo></mml:mrow></mml:munder><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mo>μ</mml:mo></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac></mml:mrow><mml:mo> </mml:mo><mml:mtext>log</mml:mtext><mml:mo stretchy="true">(</mml:mo><mml:mfrac><mml:mo>ε</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mo>ε</mml:mo></mml:mrow></mml:mfrac><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mo stretchy="true">)</mml:mo><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula><italic>Here</italic>, <italic>A<sub>i</sub> is the set of ancestors of a node i (including itself).</italic></p>
        </statement>
      </p>
      <p>
        <statement id="mthst2">
          <label>Proof.</label>
          <p> Poisson and Gaussian probabilities achieve maximums at their means, i.e. the rate and time likelihoods are maximal, when for consecutive events <italic>i</italic>, <italic>j</italic> we have <inline-formula id="IE41"><mml:math id="IM41"><mml:mrow><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mo>θ</mml:mo><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mo>θ</mml:mo></mml:mfrac></mml:mrow></mml:math></inline-formula>. This yields the solution (7). The multinomial probability <inline-formula id="IE42"><mml:math id="IM42"><mml:mrow><mml:mi mathvariant="script">M</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is maximal when <inline-formula id="IE43"><mml:math id="IM43"><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> for all <inline-formula id="IE44"><mml:math id="IM44"><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula>. This can be rewritten as
<disp-formula id="E9"><label>(9)</label><mml:math id="M9"><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mtext>for</mml:mtext><mml:mo> </mml:mo><mml:mtext>all</mml:mtext><mml:mo> </mml:mo><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p>
          <p>Our goal is to find fitnesses <inline-formula id="IE45"><mml:math id="IM45"><mml:mi mathvariant="script">F</mml:mi></mml:math></inline-formula> such that (9) holds. We find an approximate solution to this problem by disregarding the discontinuity of the abundances <inline-formula id="IE46"><mml:math id="IM46"><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula>. We use the observation that the system (2) is invariant with respect to the transition to relative abundances of any pair of clones. Namely, for each clone pair <inline-formula id="IE47"><mml:math id="IM47"><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math></inline-formula> dynamics of their relative abundances with respect to each other <inline-formula id="IE48"><mml:math id="IM48"><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE49"><mml:math id="IM49"><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula> is described by the system of ODEs of the same form as (2):
<disp-formula id="E10"><label>(10)</label><mml:math id="M10"><mml:mrow><mml:mtable><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mstyle displaystyle="true"><mml:mover><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>.</mml:mo></mml:mover></mml:mstyle><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mstyle displaystyle="true"><mml:mover><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>.</mml:mo></mml:mover></mml:mstyle><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula></p>
          <p>On the interval <inline-formula id="IE50"><mml:math id="IM50"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula> relative abundance <inline-formula id="IE51"><mml:math id="IM51"><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula> satisfy the system (10) with the initial condition <inline-formula id="IE52"><mml:math id="IM52"><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mo>ε</mml:mo></mml:mrow></mml:math></inline-formula>. After shifting time interval to <inline-formula id="IE53"><mml:math id="IM53"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula>, this system can be linearized and solved in closed form, producing a solution
<disp-formula id="E11"><label>(11)</label><mml:math id="M11"><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo>ε</mml:mo><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mi>t</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mo>ε</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mo>ε</mml:mo><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mi>t</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula></p>
          <p>After putting the expressions (11) into the <xref ref-type="disp-formula" rid="E9">equation (9)</xref> with <inline-formula id="IE54"><mml:math id="IM54"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, we get the following system of equations to find fitnesses <inline-formula id="IE55"><mml:math id="IM55"><mml:mi mathvariant="script">F</mml:mi></mml:math></inline-formula>:
<disp-formula id="E12"><label>(12)</label><mml:math id="M12"><mml:mrow><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mtext>log</mml:mtext><mml:mo stretchy="true">(</mml:mo><mml:mfrac><mml:mo>ε</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mo>ε</mml:mo></mml:mrow></mml:mfrac><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mo stretchy="true">)</mml:mo><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mo>;</mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></disp-formula></p>
          <p>Solving it with <italic>t<sub>i</sub></italic> described by (7) yields the solution (8). □</p>
          <p>Using Proposition 1, we replace the maximum likelihood problem (5) with the following discrete problem: find the ordering <italic>μ</italic> maximizing the mutation log-likelihood
<disp-formula id="E13"><label>(13)</label><mml:math id="M13"><mml:mrow><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mo>μ</mml:mo></mml:msub><mml:mo>=</mml:mo><mml:mtext>log</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>μ</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:mrow><mml:mo> </mml:mo><mml:mtext>log</mml:mtext><mml:mo> </mml:mo></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></disp-formula>
with times <inline-formula id="IE56"><mml:math id="IM56"><mml:mrow><mml:msup><mml:mrow><mml:mo>Ω</mml:mo></mml:mrow><mml:mo>μ</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula> and fitnesses <inline-formula id="IE57"><mml:math id="IM57"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">F</mml:mi></mml:mrow><mml:mo>μ</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula> described by (7), (8) subject to the constraint that <italic>μ</italic> agrees with the ancestral-descendant order of <italic>T</italic>.</p>
        </statement>
      </p>
    </sec>
    <sec>
      <title>2.4 Finding optimal ordering</title>
      <p>The problem (13) could be considered as a variant of scheduling problem with precedent constraints and with non-linear cumulative cost function (<xref rid="btz392-B8" ref-type="bibr">Dolgui <italic>et al.</italic>, 2012</xref>). Here, mutations play roles of jobs, ordering of mutations corresponds to scheduling of jobs on a single processor, mutation tree represent job precedence constraints and the objective (13) indicates that the cost of job processing depends on the previously processed jobs. Such problems are usually NP-hard (<xref rid="btz392-B8" ref-type="bibr">Dolgui <italic>et al.</italic>, 2012</xref>). For small number of mutations, it can be solved by a branch-and-bound search in the space of feasible orderings via backtracking over the mutation tree. In general, we solve it by a heuristic approach combined with the search in the space of feasible sub-orderings of nodes of the mutation tree <italic>T</italic>. The proposed scheme is described by Algorithm 1. The algorithm starts with the initial tree <inline-formula id="IE58"><mml:math id="IM58"><mml:mrow><mml:mi>T</mml:mi><mml:mo>′</mml:mo><mml:mo>=</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:math></inline-formula> and iteratively transforms it into a total order as follows. We call two simple paths of <inline-formula id="IE59"><mml:math id="IM59"><mml:mrow><mml:mi>T</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:math></inline-formula><italic>sibling paths</italic>, if they share the starting vertex. We traverse the nodes of <inline-formula id="IE60"><mml:math id="IM60"><mml:mrow><mml:mi>T</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:math></inline-formula> in a bottom-up direction and merge sibling paths into one path representing optimal sub-order of their nodes with respect to the objective (13). The algorithm stops when all nodes form a single path.
</p>
      <p>
        <boxed-text id="btz392-BOX1" position="float" orientation="portrait">
          <label>Algorithm 1. </label>
          <caption>
            <p>Algorithm for node ordering</p>
          </caption>
          <p> 1: Let <italic>U</italic> be the list of nodes of <italic>T</italic> sorted in inverse order of their discovery by Breadth First Search from the root; <inline-formula id="IE61"><mml:math id="IM61"><mml:mrow><mml:mi>T</mml:mi><mml:mo>′</mml:mo><mml:mo>=</mml:mo><mml:mi>T</mml:mi><mml:mo>;</mml:mo></mml:mrow></mml:math></inline-formula></p>
          <p>2: <bold>for</bold><inline-formula id="IE62"><mml:math id="IM62"><mml:mrow><mml:mi>u</mml:mi><mml:mo>∈</mml:mo><mml:mi>U</mml:mi></mml:mrow></mml:math></inline-formula><bold>do</bold></p>
          <p>3: <bold>while</bold><italic>u</italic> has more than 1 child <bold>do</bold></p>
          <p>4: Choose sibling paths <italic>P</italic><sub>1</sub> and <italic>P</italic><sub>2</sub> with the start node <italic>u</italic></p>
          <p>5: Join <italic>P</italic><sub>1</sub> and <italic>P</italic><sub>2</sub> into a single path <italic>P</italic> using Algorithm 2</p>
          <p>6: Modify <inline-formula id="IE63"><mml:math id="IM63"><mml:mrow><mml:mi>T</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:math></inline-formula> by replacing <italic>P</italic><sub>1</sub> and <italic>P</italic><sub>2</sub> by <italic>P</italic></p>
          <p>7: <bold>end while</bold></p>
          <p>8: <bold>end for</bold></p>
        </boxed-text>
      </p>
      <p>
        <boxed-text id="btz392-BOX2" position="float" orientation="portrait">
          <label>Algorithm 2. </label>
          <caption>
            <p>Algorithm for path joining</p>
          </caption>
          <p><bold>Input</bold> Sibling paths <italic>P</italic><sub>1</sub> and <italic>P</italic><sub>2</sub></p>
          <p><bold>Output</bold> is calculated by calling <bold>MergePaths(</bold><inline-formula id="IE64"><mml:math id="IM64"><mml:mo>φ,</mml:mo></mml:math></inline-formula><bold>1)</bold></p>
          <p>
            <bold>MergePaths(<italic>Y</italic>, <italic>i</italic>)</bold>
          </p>
          <p>▹ <italic>Y is the current k-subset, i is the next element to be added to it</italic></p>
          <p>▹ <italic>μ<sub>opt</sub> and opt are the current optimal order and its likelihood</italic></p>
          <p>1: <bold>if</bold><inline-formula id="IE65"><mml:math id="IM65"><mml:mrow><mml:mo>|</mml:mo><mml:mi>Y</mml:mi><mml:mo>|</mml:mo><mml:mo>=</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:math></inline-formula><bold>or</bold><inline-formula id="IE66"><mml:math id="IM66"><mml:mrow><mml:mi>i</mml:mi><mml:mo>&gt;</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:math></inline-formula><bold>then</bold></p>
          <p>2: <bold>return</bold></p>
          <p>3: <bold>end if</bold></p>
          <p>4: <inline-formula id="IE67"><mml:math id="IM67"><mml:mrow><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">new</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>Y</mml:mi><mml:mo>∪</mml:mo><mml:mo>{</mml:mo><mml:mi>i</mml:mi><mml:mo>}</mml:mo><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mo>μ</mml:mo><mml:mo>′</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mo>μ</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">new</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula></p>
          <p>5: <bold>while</bold><inline-formula id="IE68"><mml:math id="IM68"><mml:mrow><mml:mo>μ</mml:mo><mml:mo>′</mml:mo></mml:mrow></mml:math></inline-formula><bold>is not a total order do</bold></p>
          <p>6: <inline-formula id="IE69"><mml:math id="IM69"><mml:mrow><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mn>1</mml:mn><mml:mi>Y</mml:mi></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mn>2</mml:mn><mml:mi>Y</mml:mi></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mo>|</mml:mo><mml:mo>μ</mml:mo><mml:mo>′</mml:mo><mml:mo>|</mml:mo><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula></p>
          <p>7: <inline-formula id="IE70"><mml:math id="IM70"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>j</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>θ</mml:mo></mml:mfrac><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mtext>log</mml:mtext><mml:mo stretchy="true">(</mml:mo><mml:mfrac><mml:mo>ε</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mo>ε</mml:mo></mml:mrow></mml:mfrac><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:math></inline-formula>,</p>
          <p>8: <inline-formula id="IE71"><mml:math id="IM71"><mml:mrow><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mtext>log</mml:mtext><mml:mo stretchy="true">(</mml:mo><mml:mfrac><mml:mo>ε</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mo>ε</mml:mo></mml:mrow></mml:mfrac><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:math></inline-formula></p>
          <p>9: <bold>if</bold><inline-formula id="IE72"><mml:math id="IM72"><mml:mrow><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>≤</mml:mo><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula><bold>then</bold></p>
          <p>10: <inline-formula id="IE73"><mml:math id="IM73"><mml:mrow><mml:mo>μ</mml:mo><mml:mo>′</mml:mo><mml:mo>=</mml:mo><mml:mo>μ</mml:mo><mml:mo>′</mml:mo><mml:mo>∪</mml:mo><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>}</mml:mo><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:msubsup><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mn>1</mml:mn><mml:mi>Y</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mn>1</mml:mn><mml:mi>Y</mml:mi></mml:msubsup><mml:mo>∖</mml:mo><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula></p>
          <p>11: <bold>else</bold></p>
          <p>12: <inline-formula id="IE74"><mml:math id="IM74"><mml:mrow><mml:mo>μ</mml:mo><mml:mo>′</mml:mo><mml:mo>=</mml:mo><mml:mo>μ</mml:mo><mml:mo>′</mml:mo><mml:mo>∪</mml:mo><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>}</mml:mo><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:msubsup><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mn>2</mml:mn><mml:mi>Y</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mn>2</mml:mn><mml:mi>Y</mml:mi></mml:msubsup><mml:mo>∖</mml:mo><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula></p>
          <p>13: <bold>end if</bold></p>
          <p>14: <bold>end while</bold></p>
          <p>15: <bold>MergePaths</bold> (<italic>Y</italic>, <italic>i </italic>+<italic> </italic>1)</p>
          <p>16: <bold>if</bold><inline-formula id="IE75"><mml:math id="IM75"><mml:mrow><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo>μ</mml:mo></mml:mrow><mml:mi>Y</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:mi mathvariant="italic">opt</mml:mi></mml:mrow></mml:math></inline-formula><bold>then</bold></p>
          <p>17: <inline-formula id="IE76"><mml:math id="IM76"><mml:mrow><mml:mi mathvariant="italic">opt</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mo>μ</mml:mo><mml:mo>′</mml:mo></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mrow><mml:mo>μ</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="italic">opt</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>μ</mml:mo><mml:mo>′</mml:mo></mml:mrow></mml:math></inline-formula></p>
          <p>18: <bold>MergePaths</bold> (<italic>Y<sub>new</sub></italic>, <italic>i </italic>+<italic> </italic>1)</p>
          <p>19: <bold>end if</bold></p>
        </boxed-text>
      </p>
      <p>Merging of sibling paths <italic>P</italic><sub>1</sub> and <italic>P</italic><sub>2</sub> is performed by Algorithm 2. We note that feasible orders of paths’ nodes bijectively correspond to <italic>k</italic>-subsets of the set <inline-formula id="IE77"><mml:math id="IM77"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mi>l</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula>: for a given <italic>k</italic>-subset <italic>X</italic>, a feasible order <italic>μ<sub>X</sub></italic> is obtained by placing nodes from <inline-formula id="IE78"><mml:math id="IM78"><mml:mrow><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>∖</mml:mo><mml:mo>{</mml:mo><mml:mi>u</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula> (resp., <inline-formula id="IE79"><mml:math id="IM79"><mml:mrow><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>∖</mml:mo><mml:mo>{</mml:mo><mml:mi>u</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula>) at positions from <italic>X</italic> (resp., <inline-formula id="IE80"><mml:math id="IM80"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mi>l</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>∖</mml:mo><mml:mi>X</mml:mi></mml:mrow></mml:math></inline-formula>) in order of their appearance in <italic>P</italic><sub>1</sub> (resp., <italic>P</italic><sub>2</sub>); inverse is also true. Algorithm 2 recursively generates <italic>k</italic>-subsets via branching and prune branches, if the corresponding orders are likely to be sub-optimal.</p>
      <p>The <italic>k</italic>-subsets are generated recursively (<xref rid="btz392-B31" ref-type="bibr">Nijenhuis and Wilf, 2014</xref>) using the property that every <italic>k</italic>-subset <italic>X</italic> of <inline-formula id="IE81"><mml:math id="IM81"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mi>l</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula> is either <italic>k</italic>-subset of the set <inline-formula id="IE82"><mml:math id="IM82"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>2</mml:mn><mml:mo>:</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mi>l</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula> or has the form <inline-formula id="IE83"><mml:math id="IM83"><mml:mrow><mml:mi>X</mml:mi><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:mn>1</mml:mn><mml:mo>}</mml:mo><mml:mo>∪</mml:mo><mml:mi>Y</mml:mi></mml:mrow></mml:math></inline-formula>, where <italic>Y</italic> is a <italic>k</italic> − 1-subset of <inline-formula id="IE84"><mml:math id="IM84"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>2</mml:mn><mml:mo>:</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mi>l</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula>. Suppose that at a given iteration a partial <inline-formula id="IE85"><mml:math id="IM85"><mml:mrow><mml:mi>k</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:math></inline-formula>-subset <italic>Y</italic>, <inline-formula id="IE86"><mml:math id="IM86"><mml:mrow><mml:mi>k</mml:mi><mml:mo>′</mml:mo><mml:mo>≤</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:math></inline-formula>, and the corresponding pre-order <italic>μ<sub>Y</sub></italic>has been constructed. For all nodes <italic>v</italic> covered by <italic>μ<sub>Y</sub></italic>, we calculate their appearance times <italic>t<sub>v</sub></italic> and fitnesses <italic>f<sub>v</sub></italic> using (7), (8), and abundance distributions <inline-formula id="IE87"><mml:math id="IM87"><mml:mrow><mml:msup><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mi>v</mml:mi></mml:msup><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mi>v</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mi>v</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> from the system (2)–(3) (in fact, it is not necessary to recalculate all values since some of them has been already calculated at previous iterations). Next, we heuristically extend <italic>μ<sub>Y</sub></italic>to a total order as described below. If the likelihood of the constructed solution is below the current optimum, then the recursion tree branch of the partial solution <italic>Y</italic> is pruned. Otherwise, the current optimum is updated and the recursion continues.</p>
      <p>Finally, we describe how an order <italic>μ<sub>Y</sub></italic>is extended (lines 5–14 of Algorithm 2). We consider the subpaths <inline-formula id="IE88"><mml:math id="IM88"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mn>1</mml:mn><mml:mi>Y</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE89"><mml:math id="IM89"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mn>2</mml:mn><mml:mi>Y</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> formed by the nodes of <italic>P</italic><sup>1</sup> and <italic>P</italic><sup>2</sup> that are not covered by <italic>μ<sub>Y</sub></italic>. For the first nodes of these subpaths, we calculate their provisional fitnesses under the assumption that each node is added to <italic>μ<sub>Y</sub></italic>as the next element. The node with the smaller provisional fitness is added to <italic>μ<sub>Y</sub></italic>. This procedure is repeated until <italic>μ<sub>Y</sub></italic>covers all nodes. The logic behind this approach is based on the observation that according to (2) the frequency of a clone grows while its fitness is larger than the average fitness of the population, and declines otherwise. For a given iteration, adding clone with a smaller fitness slows down the average fitness growth. As a result, for preceding clones probabilities of appearances of their children in the future may become higher.</p>
    </sec>
  </sec>
  <sec>
    <title>3 Results</title>
    <sec>
      <title>3.1 Simulated data</title>
      <p>We simulated 100 test examples with the numbers of mutations ranging from <italic>m </italic>=<italic> </italic>30 to <italic>m </italic>=<italic> </italic>120, which correspond to numbers of mutations for real scSeq data analyzed in previous studies (<xref rid="btz392-B17" ref-type="bibr">Jahn <italic>et al.</italic>, 2016</xref>; <xref rid="btz392-B21" ref-type="bibr">Kuipers <italic>et al.</italic>, 2017a</xref>; <xref rid="btz392-B24" ref-type="bibr">Leung <italic>et al.</italic>, 2017</xref>). For each test example, clonal evolution was simulated as follows. (a) Mutations 1,…, <italic>m</italic> are generated randomly. For the time interval between mutation events <italic>i</italic> and <italic>i </italic>+<italic> </italic>1 the current mutation rate <italic>θ<sub>i</sub></italic> is sampled from the normal distribution with the mean <italic>θ</italic> = 0.01 and standard deviation <inline-formula id="IE90"><mml:math id="IM90"><mml:mrow><mml:mo>σ</mml:mo><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mn>0.1</mml:mn><mml:mo>·</mml:mo><mml:mo>θ</mml:mo><mml:mo>,</mml:mo><mml:mn>0.5</mml:mn><mml:mo>·</mml:mo><mml:mo>θ</mml:mo><mml:mo>,</mml:mo><mml:mn>0.9</mml:mn><mml:mo>·</mml:mo><mml:mo>θ</mml:mo><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula>. At each moment of time of that interval a mutation event happens with the probability <italic>θ<sub>i</sub></italic>; at the event a random clone <italic>p</italic> selected with the probability equal to its current relative abundance gives birth to a new clone <italic>j</italic> with the random fitness <italic>f<sub>j</sub></italic> by acquiring a random mutation <italic>i </italic>+<italic> </italic>1. In our primary fitness sampling scheme, new fitness is sampled uniformly from the interval <inline-formula id="IE91"><mml:math id="IM91"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mo>ϕ</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">max</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula>, where <italic>ϕ</italic> is an average fitness of the population at the time of mutation event. This scheme accounts for the fact that according to the evolutionary model (2) the clone with the fitness below <italic>ϕ</italic> is not viable and will not be observed at sampling time. In additional set of experiments, the secondary sampling scheme has been employed, when new fitness is sampled uniformly from the interval <inline-formula id="IE92"><mml:math id="IM92"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">min</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">max</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula> (by default <inline-formula id="IE93"><mml:math id="IM93"><mml:mrow><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">min</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">max</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1.2</mml:mn></mml:mrow></mml:math></inline-formula>). When there is no mutation event, abundances of existing clones are updated according to (2). After the end of the simulation, final abundances were randomly perturbed by 10% to incorporate the possible noise in their estimation. The simulated mutation tree and clone abundances were used as an input for SCIFIL.</p>
      <p>It should be noted that the construction of the proposed algorithm implies that its performance would be higher on mutation trees with monoclonal structure, both in terms of speed and accuracy. However, our simulation scheme predominantly produces trees with polyclonal structures (see <xref ref-type="fig" rid="btz392-F3">Fig. 3</xref>), thus providing no a priori advantage to SCIFIL.
</p>
      <fig id="btz392-F3" orientation="portrait" position="float">
        <label>Fig. 3.</label>
        <caption>
          <p>Example of simulated mutation tree</p>
        </caption>
        <graphic xlink:href="btz392f3"/>
      </fig>
      <p>We quantified the performance of SCIFIL using two measures:
<list list-type="order"><list-item><p>Mean relative accuracy <inline-formula id="IE94"><mml:math id="IM94"><mml:mrow><mml:mi mathvariant="italic">MRA</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>n</mml:mi></mml:mfrac><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:mrow><mml:mfrac><mml:mrow><mml:mo>|</mml:mo><mml:msubsup><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mi>i</mml:mi><mml:mo>*</mml:mo></mml:msubsup><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>|</mml:mo></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mi>i</mml:mi><mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:mfrac></mml:mrow></mml:mrow></mml:math></inline-formula>, where <inline-formula id="IE95"><mml:math id="IM95"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mi>i</mml:mi><mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula> and <italic>f<sub>i</sub></italic> are true and inferred fitnesses, respectively.</p></list-item><list-item><p>Spearman correlation <italic>SC</italic> between true and inferred fitnesses.</p></list-item></list></p>
      <p><italic>MRA</italic> and <italic>SC</italic> highlight different aspects of the problem. MRA measure the accuracy of fitness value estimation, while SC measures how well we are able to qualitatively detect selective advantage of particular clones over other clones. Fitness ranking can be used in evolutionary studies even when actual fitness values are missing or inaccurate (<xref rid="btz392-B5" ref-type="bibr">Crona <italic>et al.</italic>, 2017</xref>).</p>
      <p>The results of SCIFIL evaluation on simulated data are shown in <xref ref-type="fig" rid="btz392-F4">Figures 4</xref> and <xref ref-type="fig" rid="btz392-F5">5</xref>. The algorithm demonstrated high accuracy as measured by both parameters. The number of mutations (<xref ref-type="fig" rid="btz392-F4">Fig. 4</xref>) does not have a great impact on the Spearman correlation, which averages 97.35% (standard deviation 1.2%) over all analyzed test cases. MRA decreases when the number of mutations grows, but remains above 88% for all datasets. Increase in variation of mutation rate (<xref ref-type="fig" rid="btz392-F5">Fig. 5</xref>) does not significantly affect SC, and results in slight decrease of average MRA. Relative robustness of SCIFIL to the variation of mutation rates (which also introduce variation in mutation times) indirectly suggests, that the proposed algorithm is able to well approximate the original maximum likelihood problem (4). In the case of near-neutral selection (<italic>f<sub>max</sub></italic> = 1.01), MRA does not significantly change and SC declines to 87.54%.
</p>
      <fig id="btz392-F4" orientation="portrait" position="float">
        <label>Fig. 4.</label>
        <caption>
          <p>Performance of SCIFIL on simulated data with <italic>m</italic> mutations and fixed standard deviation of mutation rate. (<bold>Left</bold>): Mean relative accuracy of fitness estimation. (<bold>Right</bold>): Spearman correlation between true and inferred fitness vectors</p>
        </caption>
        <graphic xlink:href="btz392f4"/>
      </fig>
      <fig id="btz392-F5" orientation="portrait" position="float">
        <label>Fig. 5.</label>
        <caption>
          <p>Performance of SCIFIL on simulated data with <italic>m </italic>=<italic> </italic>50 mutations and different standard deviations of mutations rates. (<bold>Left</bold>) Mean relative accuracy of fitness estimation. (<bold>Right</bold>) Spearman correlation between true and inferred fitness vectors</p>
        </caption>
        <graphic xlink:href="btz392f5"/>
      </fig>
      <p>Additionally, we have compared SCIFIL output with the topology of input mutation trees to evaluate the contribution of the tree-based prior information to the algorithm’s accuracy. Specifically, the clones have been ranked by their estimated fitnesses and by their tree heights, and Spearman correlation <italic>SC<sup>T</sup></italic> between fitnesses and tree ranks have been calculated (combined with the permutation test to account for the presence of clones of the same rank). The experiment has been repeated two times using the primary and secondary fitness sampling schemes, with the latter being a completely random uniform sampling from the constant interval. For the first sampling scheme, the average correlation between fitness and tree ranks was <inline-formula id="IE96"><mml:math id="IM96"><mml:mrow><mml:mi>S</mml:mi><mml:msubsup><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mn>1</mml:mn><mml:mi>T</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0.698</mml:mn></mml:mrow></mml:math></inline-formula> (with <inline-formula id="IE97"><mml:math id="IM97"><mml:mrow><mml:mi mathvariant="italic">SC</mml:mi><mml:mo>=</mml:mo><mml:mi>S</mml:mi><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>0.969</mml:mn></mml:mrow></mml:math></inline-formula>). For the second sampling scheme, <italic>SC<sup>T</sup></italic> drops to <inline-formula id="IE98"><mml:math id="IM98"><mml:mrow><mml:mi>S</mml:mi><mml:msubsup><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mn>2</mml:mn><mml:mi>T</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0.314</mml:mn></mml:mrow></mml:math></inline-formula>, while the correlation between real and estimated fitnesses decreases to <italic>SC</italic><sub>2</sub> = 0.871. The value <inline-formula id="IE99"><mml:math id="IM99"><mml:mrow><mml:mo>τ</mml:mo><mml:mo>=</mml:mo><mml:mn>100</mml:mn><mml:mo>·</mml:mo><mml:mfrac><mml:mrow><mml:mi>S</mml:mi><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:mi>S</mml:mi><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:mi>S</mml:mi><mml:msubsup><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mn>1</mml:mn><mml:mi>T</mml:mi></mml:msubsup><mml:mo>−</mml:mo><mml:mi>S</mml:mi><mml:msubsup><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mn>2</mml:mn><mml:mi>T</mml:mi></mml:msubsup></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula> (decrease in accuracy per one percent decrease in tree/fitness correlation) may serve as a measure of contribution of a tree topology to the SCIFIL quality. In our case, this value is equal to 25.7%. Transition to near-neutral selection (<italic>f<sub>max</sub></italic> = 1.01) has the similar effect, with the correlations being <italic>SC</italic> = 0.875 and <italic>SC<sup>T</sup></italic> = 0.379.</p>
      <p>ScSeq data are prone to errors. To evaluate SCIFIL’s robustness to trees inferred from noisy data, random errors were introduced to clone mutation profiles at false negative rates <inline-formula id="IE100"><mml:math id="IM100"><mml:mrow><mml:mo>α</mml:mo><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mn>0.1</mml:mn><mml:mo>,</mml:mo><mml:mn>0.2</mml:mn><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula> and the false positive rate <italic>β</italic> = 10<sup>–</sup><sup>5</sup>, and mutation trees were reconstructed from these profiles using the state-of-the-art tool SCITE (<xref rid="btz392-B17" ref-type="bibr">Jahn <italic>et al.</italic>, 2016</xref>). The simulated/reconstructed mutation trees were used as an input for SCIFIL. It turned out that in ∼8% of cases SCIFIL was not able to produce a feasible solution. This issue could be resolved by performing several additional steps of the local search with the same tree modification operations as SCITE and with the objective (4). With this modification, SCIFIL reconstructs fitnesses accurately, although, as expected, the accuracy decreases with the error rate’s growth (<xref ref-type="fig" rid="btz392-F6">Fig. 6</xref>). To check the influence of undersampling, we assumed that <italic>γ</italic>  = 10% of clones with lowest frequencies were not observed at the sampling time. For such clones, the auxiliary frequency <italic>δ </italic>≪ <italic>ε</italic> has been assigned before running SCITE. For <italic>m </italic>=<italic> </italic>50, the average MRA decreased from 0.99 to 0.96 in comparison to the complete data, but SC remained stable (0.972 and 0.968, respectively).
</p>
      <fig id="btz392-F6" orientation="portrait" position="float">
        <label>Fig. 6.</label>
        <caption>
          <p>Performance of SCIFIL on simulated data with different false negative error rates <italic>α</italic> and with mutation trees reconstructed by SCITE (<xref rid="btz392-B17" ref-type="bibr">Jahn <italic>et al.</italic>, 2016</xref>). (<bold>Left</bold>) Mean relative accuracy of fitness estimation. (<bold>Right</bold>) Spearman correlation between true and inferred fitness vectors</p>
        </caption>
        <graphic xlink:href="btz392f6"/>
      </fig>
      <p>Finally, we compared our approach with the previously published tool QuasiFit (<xref rid="btz392-B36" ref-type="bibr">Seifert <italic>et al.</italic>, 2014</xref>). Although originally designed for viruses, QuasiFit is based on quasispecies model, which is applicable to both intra-host viral populations and cancer clone populations (<xref rid="btz392-B42" ref-type="bibr">Wodarz and Komarova, 2005</xref>) and is essentially a fully continuous version of the model used by SCIFIL. Both QuasiFit and SCIFIL reconstruct replicative fitnesses of individual clones (rather than alleles). In addition to genomic data, both algorithms utilize other information: SCIFIL uses a mutation tree, while QuasiFit assumes that the population is in equilibrium state of the quasispecies model. Thus, SCIFIL has access to information about partial clones order encoded by the mutation tree, while equilibrium site assumption allows QuasiFit to eliminate from consideration the temporal component. Furthermore, SCIFIL is a discrete optimization approach, while QuasiFit implements MCMC sampling.</p>
      <p>QuasiFit was run with the per-cell mutation rate <italic>μ </italic>= <italic>εθ</italic> (which is a fully continuous analog of the parameters used by SCIFIL) and fitnesses were estimated after a burn-in of 10<sup>5</sup> iterations. As QuasiFit uses a different fitness vector normalization, following <xref rid="btz392-B36" ref-type="bibr">Seifert <italic>et al.</italic> (2014)</xref>, we used only the parameter <italic>SC</italic> for the comparison. The results are shown in <xref ref-type="fig" rid="btz392-F7">Fig. 7</xref>(left). On our simulated data, SCIFIL outperforms QuasiFit indicating that in certain settings the proposed model could be more accurate for the inference of clonal selection than the equilibrium state assumption.
</p>
      <fig id="btz392-F7" orientation="portrait" position="float">
        <label>Fig. 7.</label>
        <caption>
          <p>(<bold>Left</bold>) Spearman correlation between true and inferred fitness vectors for QuasiFit and SCIFIL. (<bold>Right</bold>) Running time of SCIFIL</p>
        </caption>
        <graphic xlink:href="btz392f7"/>
      </fig>
      <p>Computational experiments suggest that the algorithm’s running time scales quadratically with the number of mutations (<xref ref-type="fig" rid="btz392-F7">Fig. 7</xref>, correlation = 0.981). It allows SCIFIL to finish in a few seconds for all analyzed datasets when run on a simple desktop computer.</p>
    </sec>
    <sec>
      <title>3.2 Experimental data</title>
      <sec>
        <title>3.2.1 Fitness landscapes</title>
        <p>We used SCIFIL to infer fitness landscapes for two recently published experimental cancer datasets. The first dataset is scSeq data from a JAK2-negative myeloproliferative neoplasm (essential thrombocythemia) (<xref rid="btz392-B16" ref-type="bibr">Hou <italic>et al.</italic>, 2012</xref>), the second one represents metastatic colon cancer (<xref rid="btz392-B24" ref-type="bibr">Leung <italic>et al.</italic>, 2017</xref>). The latter dataset includes SNVs sampled from the main tumor and two metastases. We confined our analysis only to the primary tumor, since it is biologically meaningful to compare fitnesses of clones sampled from the same environment. For both datasets, their mutation trees were reconstructed using SCITE (<xref rid="btz392-B17" ref-type="bibr">Jahn <italic>et al.</italic>, 2016</xref>), and fitnesses and mutation appearance times were inferred by SCIFIL with the cell-wise mutation rate 10<sup>–</sup><sup>6</sup>. It is important to note that varying SCIFIL parameters may change absolute values of inferred fitnesses, but preserve relations between them. The relations are the most informative factors for evolutionary analysis.</p>
        <p>We visualized inferred fitness landscapes as follows. We calculated pairwise distances between clones defined as the sum of their hamming distance and the absolute difference of their orders of appearance. The distances were used to map clones to the plain <inline-formula id="IE101"><mml:math id="IM101"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula> using multidimensional scaling. Fitness values of the points corresponding to clones were interpolated using biharmonic splines, and the resulting surface was visualized as a contour plot (<xref ref-type="fig" rid="btz392-F8">Fig. 8</xref>), where colors represent fitness values, and distance from each tree node to the root reflects its appearance time.
</p>
        <fig id="btz392-F8" orientation="portrait" position="float">
          <label>Fig. 8.</label>
          <caption>
            <p>Fitness landscape and mutation tree for JAK2-negative myeloproliferative neoplasm (<xref rid="btz392-B16" ref-type="bibr">Hou <italic>et al.</italic>, 2012</xref>) (<bold>left</bold>) and colorectal cancer (<bold>right</bold>) (<xref rid="btz392-B24" ref-type="bibr">Leung <italic>et al.</italic>, 2017</xref>) inferred by SCIFIL. Colors represent fitness values and distance from each tree node to the root is approximately proportional to its time of appearance</p>
          </caption>
          <graphic xlink:href="btz392f8"/>
        </fig>
        <p>For myeloproliferative neoplasm (<xref ref-type="fig" rid="btz392-F8">Fig. 8</xref>, left) we observe linear accumulation of mutations with slight selective advantages at the beginning of tumor evolution, followed by the subclone expansion of two lineages with significantly faster fitness growth. The rate of fitness growth after the branching event is ∼3 times higher than before it. Thus, answering the question posed in <xref rid="btz392-B17" ref-type="bibr">Jahn <italic>et al.</italic> (2016)</xref>, we may predict that recent subclones will replace ancestral clones. However, based on the available information it is hard to decide whether one of the subclone lineages will out-compete the other one, or they will continue to coexist.</p>
        <p>Evolution of the colon tumor (<xref ref-type="fig" rid="btz392-F8">Fig. 8</xref>, right) follows different scenarios, with three independent lineages co-existing at the beginning without a clear selective advantage enjoyed by any of them. This stage is followed by the fast expansion of one of the lineages, which climbs a fitness peak and acquires selective advantage over other lineages. Exactly, at this stage, the advantageous lineage seeded the metastatic tumor at two seeding events (highlighted in black in <xref ref-type="fig" rid="btz392-F8">Fig. 8</xref>).</p>
        <p>Experimental data also allow to emphasize how SCIFIL estimations extend predictions implied by the underlying evolutionary model. Although the model suggests positive selection with fitness growth along each path of the mutation tree as the most probable scenario, it does not imply any restrictions on the comparative fitnesses of different lineages. In particular, fitness advantages of clones are not defined only by their distances from the root, as emphasized by the fitness landscape of the colon tumor, where, for instance, the node highlighted in purple has higher fitness than the node highlighted in red. The reason is that clone abundances contribute to the estimation of fitness values as much as the evolutionary model and the topology of mutation tree.</p>
      </sec>
      <sec>
        <title>3.1.2 Recurrent mutations</title>
        <p>Until recently, most studies of tumor evolution utilized <italic>infinite sites assumption</italic>, which states that every genomic position mutates at most once over the evolutionary history. However, recently it has been demonstrated using ScSeq data, that the infinite site assumption could be violated, with the same genomic positions mutationally affected multiple times over the tumor evolution (<xref rid="btz392-B22" ref-type="bibr">Kuipers <italic>et al.</italic>, 2017b</xref>). Without infinite site assumption, the number of possible alternative evolutionary histories accurately explaining the observed ScSeq data increases, and it becomes challenging to choose the most appropriate one.</p>
        <p>We utilized SCIFIL for the analysis possible evolutionary histories with recurrent mutations for a JAK2-negative myeloproliferative neoplasm (<xref rid="btz392-B16" ref-type="bibr">Hou <italic>et al.</italic>, 2012</xref>). We used infSCITE (<xref rid="btz392-B22" ref-type="bibr">Kuipers <italic>et al.</italic>, 2017b</xref>) to generate the perfect phylogeny and 18 mutation trees <inline-formula id="IE102"><mml:math id="IM102"><mml:mrow><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> under the assumption that one of 18 mutations <italic>m<sub>i</sub></italic> has a recurrence (<italic>recurrence trees</italic>). Just as reported in <xref rid="btz392-B22" ref-type="bibr">Kuipers <italic>et al.</italic> (2017b</xref>), the results strongly support recurrent mutations: the average log-likelihood for recurrence trees produced by infSCITE in our experiments was −313.45 (standard deviation 1.065), while the log-likelihood of the perfect phylogeny was equal to −319.08 (<xref ref-type="fig" rid="btz392-F9">Fig. 9</xref>). However, differences between log-likelihoods of recurrence trees were small in comparison to their difference with the one of the perfect phylogeny, thus impeding the reliable selection of the single most likely recurrence tree. To choose such tree, we utilized evolutionary likelihood estimated by SCIFIL. Among 18 trees, only two have evolutionary likelihoods higher than for the perfect phylogeny (<xref ref-type="fig" rid="btz392-F9">Fig. 9</xref>). Notably, the log-likelihood of the tree <italic>T<sub>ASNS</sub></italic> is significantly higher than for other recurrence trees (−518.62 versus −674.696 in average (standard deviation 25.62)), thus providing the strong support for that particular evolutionary history with respect to other possible histories. These results indicate that SCIFIL’s can be efficiently used in conjunction with infSCITE or other similar tool for detection of the most probable evolutionary scenarios.
</p>
        <fig id="btz392-F9" orientation="portrait" position="float">
          <label>Fig. 9.</label>
          <caption>
            <p>Log-likelihoods of trees with and without recurrent mutations. (<bold>Left</bold>) Log-likelihoods produced by infSCITE. (<bold>Right</bold>) Evolutionary likelihoods produced by SCIFIL. Likelihoods of perfect phylogeny are shown in green. Purple and red: trees with the evolutionary likelihoods higher than for the perfect phylogeny</p>
          </caption>
          <graphic xlink:href="btz392f9"/>
        </fig>
      </sec>
    </sec>
  </sec>
  <sec>
    <title>4 Discussion</title>
    <p>Intra-tumor heterogeneity is one of the major factors influencing cancer progression and treatment outcome. Cancer clones form complex populations of genomic variants constantly evolving to compete for resources, proliferate, metastasize and escape immune system and therapy. Quantification of clonal selection for tumors may provide valuable information for understanding mechanisms of disease progression and for design of personalized treatment. scSeq provides an unprecedented insight into intra-tumor heterogeneity allowing to study fitness landscapes at finest possible resolution and quantify selective advantages on the level of individual clones.</p>
    <p>In this paper, we presented SCIFIL, a likelihood-based method for inference of fitnesses of clonal variants. Unlike other available methods for related problems, SCIFIL takes full advantage of the information about structure and evolutionary history of clonal population provided by scSeq. It uses individual cells as evolutionary units, in contrast to the tools based on bulk sequencing which perform their analysis on the level of subpopulations or lineages. Furthermore, SCIFIL can also handle bulk sequencing data as long as clones are reconstructed and mutation tree is constructed using available tools such as AncesTree (<xref rid="btz392-B10" ref-type="bibr">El-Kebir <italic>et al.</italic>, 2015</xref>), PhyloSub (<xref rid="btz392-B18" ref-type="bibr">Jiao <italic>et al.</italic>, 2014</xref>) and CITUP (<xref rid="btz392-B26" ref-type="bibr">Malikic <italic>et al.</italic>, 2015</xref>).</p>
    <p>In contrast to previous approaches, SCIFIL employs dynamic evolutionary model rather than assumption that the population achieved the equilibrium state. We have demonstrated that our approach allows for accurate inference of fitness landscapes and can be used for analysis of evolutionary history and clonal selection for real tumors. We envision that SCIFIL can be also used to infer epistasic interactions and to identify combinations of mutations driving the tumor growth. In addition, it can be applied to other highly mutable heterogeneous populations, such as viral quasispecies or bacterial communities.</p>
    <p>The proposed approach has limitations which should be addressed in the future work. Fitness is not defined by the genetic composition alone and depends on the environment. Thus SCIFIL quantitative predictions are more reliable when the analyzed clones are sampled from the same tumor. Fitness inference relies on the observed clone abundances, and therefore significant inaccuracies in abundance estimation may affect accuracy of fitness reconstruction. For single-cell data, it is particularly important owing to its susceptibility to allelic dropouts and PCR bias. However, this problem can be addressed by using a combination of bulk and scSeq data. There exist a plethora of tools which can estimate clone abundances from composite bulk and scSeq data (see, e.g. <xref rid="btz392-B1" ref-type="bibr">Baron <italic>et al.</italic>, 2016</xref>; <xref rid="btz392-B30" ref-type="bibr">Mukherjee <italic>et al.</italic>, 2018</xref>). In addition, such composite data can be employed to increase an accuracy of mutation trees reconstruction (<xref rid="btz392-B27" ref-type="bibr">Malikic <italic>et al.</italic>, 2017</xref>). We expect SCIFIL reliability to increase when it will be combined with these tools.</p>
    <p>Another set of limitations arise from the selected evolutionary model (2). It was selected due to its generality (<xref rid="btz392-B42" ref-type="bibr">Wodarz and Komarova, 2005</xref>) and suitability for fitness landscape inference (<xref rid="btz392-B33" ref-type="bibr">Nowak, 2006</xref>). However, it has certain underlying assumptions: the mutation rates are supposed to be normally distributed, while the dynamical system (2) implies positive selection with the gradual growth of average population fitness. It should be noted that in many cases such assumptions are sufficiently realistic, and have been used in several studies to obtain valuable insights into the dynamics of tumor evolution (<xref rid="btz392-B4" ref-type="bibr">Bozic <italic>et al.</italic>, 2010</xref>; <xref rid="btz392-B19" ref-type="bibr">Jones <italic>et al.</italic>, 2008</xref>). In particular, other studies demonstrated that even a normal mutation rate is sufficient to produce significant intra-tumor heterogeneity and emphasized the relative importance of selection over both the size of the cell population and the mutation rate (<xref rid="btz392-B2" ref-type="bibr">Beerenwinkel <italic>et al.</italic>, 2007</xref>). Although <xref ref-type="disp-formula" rid="E12">equations (12)</xref> suggest that in most cases fitness growths along each path of the mutation tree, the model does not imply any restrictions on the comparative fitnesses of different lineages. Furthermore, observed relative abundances of clones are independent of the model, and their contribution to the estimated fitness values is paramount. Nevertheless, we expect that our approach can be extended by incorporating other models capturing different evolutionary scenarios, such as gradual mutation rate growth over the course of tumor evolution, and clonal competition/cooperation, as well as spatial tumor heterogeneity. It should be noted, though, that currently there is no universal evolutionary model for tumor progression. Alternative models will inevitably introduce other limitations and can be less practical for fitness estimation.</p>
    <p>On algorithmic side, the optimization problem behind our approach can be viewed as the type of scheduling problem with precedent constraints and with non-linear objective (<xref rid="btz392-B8" ref-type="bibr">Dolgui <italic>et al.</italic>, 2012</xref>). Such problems are generally NP-hard, although the complexity of our problem is unknown. It is known that for certain simple objectives and well-structured precedence constraints (e.g. defined by series-parallel graphs) the corresponding scheduling problems are polynomially solvable (<xref rid="btz392-B8" ref-type="bibr">Dolgui <italic>et al.</italic>, 2012</xref>). For our problem precedence, constraints have the form of a tree. It gives a certain hope of existence of exact polynomial or a good approximation algorithm, although the complex objective function may keep our problem NP-hard. This question requires additional study.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>This work was supported by NIH grant 5R01EB025022.</p>
  </sec>
</body>
<back>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btz392-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Baron</surname><given-names>M.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>A single-cell transcriptomic map of the human and mouse pancreas reveals inter-and intra-cell population structure</article-title>. <source>Cell Syst</source>., <volume>3</volume>, <fpage>346</fpage>–<lpage>360</lpage>.<pub-id pub-id-type="pmid">27667365</pub-id></mixed-citation>
    </ref>
    <ref id="btz392-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Beerenwinkel</surname><given-names>N.</given-names></name></person-group><etal>et al</etal> (<year>2007</year>) 
<article-title>Genetic progression and the waiting time to cancer</article-title>. <source>PLoS Comput. Biol</source>., <volume>3</volume>, <fpage>e225.</fpage><pub-id pub-id-type="pmid">17997597</pub-id></mixed-citation>
    </ref>
    <ref id="btz392-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Bonavia</surname><given-names>R.</given-names></name></person-group><etal>et al</etal> (<year>2011</year>) 
<article-title>Heterogeneity maintenance in glioblastoma: a social network</article-title>. <source>Cancer Res</source>., <volume>71</volume>, <fpage>4055</fpage>–<lpage>4060</lpage>.<pub-id pub-id-type="pmid">21628493</pub-id></mixed-citation>
    </ref>
    <ref id="btz392-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Bozic</surname><given-names>I.</given-names></name></person-group><etal>et al</etal> (<year>2010</year>) 
<article-title>Accumulation of driver and passenger mutations during tumor progression</article-title>. <source>Proc. Natl. Acad. Sci. USA</source>, <volume>107</volume>, <fpage>18545</fpage>–<lpage>18550</lpage>.<pub-id pub-id-type="pmid">20876136</pub-id></mixed-citation>
    </ref>
    <ref id="btz392-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Crona</surname><given-names>K.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>Inferring genetic interactions from comparative fitness data</article-title>. <source>eLife</source>, <volume>6</volume>, <fpage>e28629</fpage>.<pub-id pub-id-type="pmid">29260711</pub-id></mixed-citation>
    </ref>
    <ref id="btz392-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Davis</surname><given-names>A.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>Tumor evolution: linear, branching, neutral or punctuated?</article-title><source>Biochim. Biophys. Acta</source>, <volume>1867</volume>, <fpage>151</fpage>–<lpage>161</lpage>.</mixed-citation>
    </ref>
    <ref id="btz392-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Deforche</surname><given-names>K.</given-names></name></person-group><etal>et al</etal> (<year>2008</year>) 
<article-title>Estimation of an in vivo fitness landscape experienced by HIV-1 under drug selective pressure useful for prediction of drug resistance evolution during treatment</article-title>. <source>Bioinformatics</source>, <volume>24</volume>, <fpage>34</fpage>–<lpage>41</lpage>.<pub-id pub-id-type="pmid">18024973</pub-id></mixed-citation>
    </ref>
    <ref id="btz392-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Dolgui</surname><given-names>A.</given-names></name></person-group><etal>et al</etal> (<year>2012</year>) 
<article-title>Single machine scheduling with precedence constraints and positionally dependent processing times</article-title>. <source>Comput. Oper. Res</source>., <volume>39</volume>, <fpage>1218</fpage>–<lpage>1224</lpage>.</mixed-citation>
    </ref>
    <ref id="btz392-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Doyle</surname><given-names>M.A.</given-names></name></person-group><etal>et al</etal> (<year>2014</year>) 
<article-title>Studying cancer genomics through next-generation DNA sequencing and bioinformatics</article-title>. <source>Clin. Bioinform</source>., <volume>1168</volume>, <fpage>83</fpage>–<lpage>98</lpage>.</mixed-citation>
    </ref>
    <ref id="btz392-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>El-Kebir</surname><given-names>M.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>Reconstruction of clonal trees and tumor composition from multi-sample sequencing data</article-title>. <source>Bioinformatics</source>, <volume>31</volume>, <fpage>i62</fpage>–<lpage>i70</lpage>.<pub-id pub-id-type="pmid">26072510</pub-id></mixed-citation>
    </ref>
    <ref id="btz392-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Ferguson</surname><given-names>A.L.</given-names></name></person-group><etal>et al</etal> (<year>2013</year>) 
<article-title>Translating HIV sequences into quantitative fitness landscapes predicts viral vulnerabilities for rational immunogen design</article-title>. <source>Immunity</source>, <volume>38</volume>, <fpage>606</fpage>–<lpage>617</lpage>.<pub-id pub-id-type="pmid">23521886</pub-id></mixed-citation>
    </ref>
    <ref id="btz392-B12">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name name-style="western"><surname>Gavrilets</surname><given-names>S.</given-names></name></person-group> (<year>2004</year>) <source>Fitness Landscapes and the Origin of Species (MPB-41)</source>, Vol. <volume>41</volume>
<publisher-name>Princeton University Press</publisher-name>, 
<publisher-loc>Princeton, NY</publisher-loc>.</mixed-citation>
    </ref>
    <ref id="btz392-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Greaves</surname><given-names>M.</given-names></name>, <name name-style="western"><surname>Maley</surname><given-names>C.C.</given-names></name></person-group> (<year>2012</year>) 
<article-title>Clonal evolution in cancer</article-title>. <source>Nature</source>, <volume>481</volume>, <fpage>306.</fpage><pub-id pub-id-type="pmid">22258609</pub-id></mixed-citation>
    </ref>
    <ref id="btz392-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Hao</surname><given-names>D.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>Distinct mutation accumulation rates among tissues determine the variation in cancer risk</article-title>. <source>Sci. Rep</source>., <volume>6</volume>, <fpage>19458</fpage>.<pub-id pub-id-type="pmid">26785814</pub-id></mixed-citation>
    </ref>
    <ref id="btz392-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Hinkley</surname><given-names>T.</given-names></name></person-group><etal>et al</etal> (<year>2011</year>) 
<article-title>A systems analysis of mutational effects in HIV-1 protease and reverse transcriptase</article-title>. <source>Nat. Genet</source>., <volume>43</volume>, <fpage>487.</fpage><pub-id pub-id-type="pmid">21441930</pub-id></mixed-citation>
    </ref>
    <ref id="btz392-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Hou</surname><given-names>Y.</given-names></name></person-group><etal>et al</etal> (<year>2012</year>) 
<article-title>Single-cell exome sequencing and monoclonal evolution of a jak2-negative myeloproliferative neoplasm</article-title>. <source>Cell</source>, <volume>148</volume>, <fpage>873</fpage>–<lpage>885</lpage>.<pub-id pub-id-type="pmid">22385957</pub-id></mixed-citation>
    </ref>
    <ref id="btz392-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Jahn</surname><given-names>K.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>Tree inference for single-cell data</article-title>. <source>Genome Biol</source>., <volume>17</volume>, <fpage>86.</fpage><pub-id pub-id-type="pmid">27149953</pub-id></mixed-citation>
    </ref>
    <ref id="btz392-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Jiao</surname><given-names>W.</given-names></name></person-group><etal>et al</etal> (<year>2014</year>) 
<article-title>Inferring clonal evolution of tumors from single nucleotide somatic mutations</article-title>. <source>BMC Bioinform</source>., <volume>15</volume>, <fpage>35.</fpage></mixed-citation>
    </ref>
    <ref id="btz392-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Jones</surname><given-names>S.</given-names></name></person-group><etal>et al</etal> (<year>2008</year>) 
<article-title>Comparative lesion sequencing provides insights into tumor evolution</article-title>. <source>Proc. Natl. Acad. Sci. USA</source>, <volume>105</volume>, <fpage>4283</fpage>–<lpage>4288</lpage>.<pub-id pub-id-type="pmid">18337506</pub-id></mixed-citation>
    </ref>
    <ref id="btz392-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Kimura</surname><given-names>M.</given-names></name>, <name name-style="western"><surname>Maruyama</surname><given-names>T.</given-names></name></person-group> (<year>1966</year>) 
<article-title>The mutational load with epistatic gene interactions in fitness</article-title>. <source>Genetics</source>, <volume>54</volume>, <fpage>1337.</fpage><pub-id pub-id-type="pmid">17248359</pub-id></mixed-citation>
    </ref>
    <ref id="btz392-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Kuipers</surname><given-names>J.</given-names></name></person-group><etal>et al</etal> (<year>2017a</year>) 
<article-title>Advances in understanding tumour evolution through single-cell sequencing</article-title>. <source>Biochim. Biophys. Acta</source>, <volume>1867</volume>, <fpage>127</fpage>–<lpage>138</lpage>.</mixed-citation>
    </ref>
    <ref id="btz392-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Kuipers</surname><given-names>J.</given-names></name></person-group><etal>et al</etal> (<year>2017b</year>) 
<article-title>Single-cell sequencing data reveal widespread recurrence and loss of mutational hits in the life histories of tumors</article-title>. <source>Genome Res</source>., <volume>27</volume>, <fpage>1885</fpage>–<lpage>1894</lpage>.<pub-id pub-id-type="pmid">29030470</pub-id></mixed-citation>
    </ref>
    <ref id="btz392-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Landau</surname><given-names>D.A.</given-names></name></person-group><etal>et al</etal> (<year>2013</year>) 
<article-title>Evolution and impact of subclonal mutations in chronic lymphocytic leukemia</article-title>. <source>Cell</source>, <volume>152</volume>, <fpage>714</fpage>–<lpage>726</lpage>.<pub-id pub-id-type="pmid">23415222</pub-id></mixed-citation>
    </ref>
    <ref id="btz392-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Leung</surname><given-names>M.L.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>Single cell DNA sequencing reveals a late-dissemination model in metastatic colorectal cancer</article-title>. <source>Genome Res</source>., <volume>27,</volume><fpage>1287</fpage>–<lpage>1299</lpage>.<pub-id pub-id-type="pmid">28546418</pub-id></mixed-citation>
    </ref>
    <ref id="btz392-B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Ma</surname><given-names>J.</given-names></name></person-group><etal>et al</etal> (<year>2010</year>) 
<article-title>vfitness: a web-based computing tool for improving estimation of in vitro HIV-1 fitness experiments</article-title>. <source>BMC Bioinform</source>., <volume>11</volume>, <fpage>261.</fpage></mixed-citation>
    </ref>
    <ref id="btz392-B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Malikic</surname><given-names>S.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>Clonality inference in multiple tumor samples using phylogeny</article-title>. <source>Bioinformatics</source>, <volume>31</volume>, <fpage>1349</fpage>–<lpage>1356</lpage>.<pub-id pub-id-type="pmid">25568283</pub-id></mixed-citation>
    </ref>
    <ref id="btz392-B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Malikic</surname><given-names>S.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>Integrative inference of subclonal tumour evolution from single-cell and bulk sequencing data</article-title>. <source>bioRxiv</source>, <fpage>234914</fpage>.</mixed-citation>
    </ref>
    <ref id="btz392-B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Merlo</surname><given-names>L.M.</given-names></name></person-group><etal>et al</etal> (<year>2010</year>) 
<article-title>A comprehensive survey of clonal diversity measures in Barrett’s esophagus as biomarkers of progression to esophageal adenocarcinoma</article-title>. <source>Cancer Prev. Res</source>., <volume>3</volume>, <fpage>1388</fpage>–<lpage>1397</lpage>.</mixed-citation>
    </ref>
    <ref id="btz392-B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Moran</surname><given-names>P.A.</given-names></name></person-group> (<year>1976</year>) 
<article-title>Global stability of genetic systems governed by mutation and selection</article-title>. <source>Math. Proc. Cambridge Philos. Soc</source>., <volume>80</volume>, <fpage>331</fpage>–<lpage>336</lpage>.</mixed-citation>
    </ref>
    <ref id="btz392-B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Mukherjee</surname><given-names>S.</given-names></name></person-group><etal>et al</etal> (<year>2018</year>) 
<article-title>Scalable preprocessing for sparse scrna-seq data exploiting prior knowledge</article-title>. <source>Bioinformatics</source>, <volume>34</volume>, <fpage>i124</fpage>–<lpage>i132</lpage>.<pub-id pub-id-type="pmid">29949988</pub-id></mixed-citation>
    </ref>
    <ref id="btz392-B31">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name name-style="western"><surname>Nijenhuis</surname><given-names>A.</given-names></name>, <name name-style="western"><surname>Wilf</surname><given-names>H.S.</given-names></name></person-group> (<year>2014</year>) <source>Combinatorial Algorithms: For Computers and Calculators</source>. 
<publisher-name>Academic Press, Inc</publisher-name>, 
<publisher-loc>New York, USA</publisher-loc>.</mixed-citation>
    </ref>
    <ref id="btz392-B32">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Noorbakhsh</surname><given-names>J.</given-names></name>, <name name-style="western"><surname>Chuang</surname><given-names>J.H.</given-names></name></person-group> (<year>2017</year>) 
<article-title>Uncertainties in tumor allele frequencies limit power to infer evolutionary pressures</article-title>. <source>Nat. Genet</source>., <volume>49</volume>, <fpage>1288.</fpage><pub-id pub-id-type="pmid">28854177</pub-id></mixed-citation>
    </ref>
    <ref id="btz392-B33">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name name-style="western"><surname>Nowak</surname><given-names>M.A.</given-names></name></person-group> (<year>2006</year>) <source>Evolutionary Dynamics</source>. 
<publisher-name>Harvard University Press</publisher-name>, 
<publisher-loc>Cambridge, MA</publisher-loc>.</mixed-citation>
    </ref>
    <ref id="btz392-B34">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name name-style="western"><surname>Nowak</surname><given-names>M.A.</given-names></name>, <name name-style="western"><surname>May</surname><given-names>R.M.</given-names></name></person-group> (<year>2000</year>) <source>Virus Dynamics</source>. 
<publisher-name>Oxford University Press</publisher-name>, 
<publisher-loc>Oxford, UK</publisher-loc>.</mixed-citation>
    </ref>
    <ref id="btz392-B35">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Segal</surname><given-names>M.R.</given-names></name></person-group><etal>et al</etal> (<year>2004</year>) 
<article-title>Relating HIV-1 sequence variation to replication capacity via trees and forests</article-title>. <source>Stat. Appl. Genet. Mol. Biol</source>., <volume>3</volume>, <fpage>1</fpage>–<lpage>18</lpage>.</mixed-citation>
    </ref>
    <ref id="btz392-B36">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Seifert</surname><given-names>D.</given-names></name></person-group><etal>et al</etal> (<year>2014</year>) 
<article-title>A framework for inferring fitness landscapes of patient-derived viruses using quasispecies theory</article-title>. <source>Genetics</source>, <volume>199</volume>, <fpage>191</fpage>–<lpage>203</lpage>.<pub-id pub-id-type="pmid">25406469</pub-id></mixed-citation>
    </ref>
    <ref id="btz392-B37">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Siegel</surname><given-names>R.L.</given-names></name></person-group><etal>et al</etal> (<year>2018</year>) 
<article-title>Cancer statistics, 2018</article-title>. <source>Cancer J. Clin</source>., <volume>68</volume>, <fpage>7</fpage>–<lpage>30</lpage>.</mixed-citation>
    </ref>
    <ref id="btz392-B38">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Tarabichi</surname><given-names>M.</given-names></name></person-group><etal>et al</etal> (<year>2018</year>) 
<article-title>Neutral tumor evolution?</article-title><source>Nat. Genet</source>., <volume>50</volume>, <fpage>1630</fpage>–<lpage>1633</lpage>.<pub-id pub-id-type="pmid">30374075</pub-id></mixed-citation>
    </ref>
    <ref id="btz392-B39">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Wilke</surname><given-names>C.O.</given-names></name></person-group> (<year>2005</year>) 
<article-title>Quasispecies theory in the context of population genetics</article-title>. <source>BMC Evol. Biol</source>., <volume>5</volume>, <fpage>1.</fpage><pub-id pub-id-type="pmid">15629062</pub-id></mixed-citation>
    </ref>
    <ref id="btz392-B40">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Williams</surname><given-names>M.J.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>Identification of neutral tumor evolution across cancer types</article-title>. <source>Nat. Genet</source>., <volume>48</volume>, <fpage>238.</fpage><pub-id pub-id-type="pmid">26780609</pub-id></mixed-citation>
    </ref>
    <ref id="btz392-B41">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Williams</surname><given-names>M.J.</given-names></name></person-group><etal>et al</etal> (<year>2018</year>) 
<article-title>Quantification of subclonal selection in cancer from bulk sequencing data</article-title>. <source>Nat. Genet</source>., <volume>50</volume>, <fpage>895</fpage>–<lpage>903</lpage>.<pub-id pub-id-type="pmid">29808029</pub-id></mixed-citation>
    </ref>
    <ref id="btz392-B42">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name name-style="western"><surname>Wodarz</surname><given-names>D.</given-names></name>, <name name-style="western"><surname>Komarova</surname><given-names>N.</given-names></name></person-group> (<year>2005</year>) <source>Computational Biology of Cancer: Lecture Notes and Mathematical Modeling</source>. 
<publisher-name>World Scientific</publisher-name>, 
<publisher-loc>Singapore</publisher-loc>.</mixed-citation>
    </ref>
    <ref id="btz392-B43">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Yates</surname><given-names>L.R.</given-names></name>, <name name-style="western"><surname>Campbell</surname><given-names>P.J.</given-names></name></person-group> (<year>2012</year>) 
<article-title>Evolution of the cancer genome</article-title>. <source>Nat. Rev. Genet</source>., <volume>13</volume>, <fpage>795.</fpage><pub-id pub-id-type="pmid">23044827</pub-id></mixed-citation>
    </ref>
    <ref id="btz392-B44">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Zafar</surname><given-names>H.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>SiFit: inferring tumor trees from single-cell sequencing data under finite-sites models</article-title>. <source>Genome Biol</source>., <volume>18</volume>, <fpage>178.</fpage><pub-id pub-id-type="pmid">28927434</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
