<?DTDIdentifier.IdentifierValue article.dtd?>
<?DTDIdentifier.IdentifierType system?>
<?SourceDTD.DTDName article.dtd?>
<?SourceDTD.Version 1.0?>
<?ConverterInfo.XSLTName bmc2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Syst Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Syst Biol</journal-id>
    <journal-title-group>
      <journal-title>BMC Systems Biology</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1752-0509</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">3656802</article-id>
    <article-id pub-id-type="publisher-id">1752-0509-7-26</article-id>
    <article-id pub-id-type="pmid">23531303</article-id>
    <article-id pub-id-type="doi">10.1186/1752-0509-7-26</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Methodology Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>AMBIENT: Active Modules for Bipartite Networks - using high-throughput transcriptomic data to dissect metabolic response</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes" id="A1">
        <name>
          <surname>Bryant</surname>
          <given-names>William A</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <email>w.bryant@imperial.ac.uk</email>
      </contrib>
      <contrib contrib-type="author" id="A2">
        <name>
          <surname>Sternberg</surname>
          <given-names>Michael JE</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <email>m.sternberg@imperial.ac.uk</email>
      </contrib>
      <contrib contrib-type="author" corresp="yes" id="A3">
        <name>
          <surname>Pinney</surname>
          <given-names>John W</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <email>j.pinney@imperial.ac.uk</email>
      </contrib>
    </contrib-group>
    <aff id="I1"><label>1</label>Centre for Integrative Systems Biology and Bioinformatics, Imperial College London, London, SW7 2AZ, UK</aff>
    <pub-date pub-type="collection">
      <year>2013</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>25</day>
      <month>3</month>
      <year>2013</year>
    </pub-date>
    <volume>7</volume>
    <fpage>26</fpage>
    <lpage>26</lpage>
    <history>
      <date date-type="received">
        <day>21</day>
        <month>9</month>
        <year>2012</year>
      </date>
      <date date-type="accepted">
        <day>1</day>
        <month>3</month>
        <year>2013</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Copyright © 2013 Bryant et al.; licensee BioMed Central Ltd.</copyright-statement>
      <copyright-year>2013</copyright-year>
      <copyright-holder>Bryant et al.; licensee BioMed Central Ltd.</copyright-holder>
      <license license-type="open-access">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (http://creativecommons.org/licenses/by/2.0), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="http://www.biomedcentral.com/1752-0509/7/26"/>
    <abstract>
      <sec>
        <title>Background</title>
        <p>With the continued proliferation of high-throughput biological experiments, there is a pressing need for tools to integrate the data produced in ways that produce biologically meaningful conclusions. Many microarray studies have analysed transcriptomic data from a pathway perspective, for instance by testing for KEGG pathway enrichment in sets of upregulated genes. However, the increasing availability of species-specific metabolic models provides the opportunity to analyse these data in a more objective, system-wide manner.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p>Here we introduce <monospace>ambient</monospace> (Active Modules for Bipartite Networks), a simulated annealing approach to the discovery of metabolic subnetworks (modules) that are significantly affected by a given genetic or environmental change. The metabolic modules returned by <monospace>ambient</monospace> are connected parts of the bipartite network that change coherently between conditions, providing a more detailed view of metabolic changes than standard approaches based on pathway enrichment.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p><monospace>ambient</monospace> is an effective and flexible tool for the analysis of high-throughput data in a metabolic context. The same approach can be applied to any system in which reactions (or metabolites) can be assigned a score based on some biological observation, without the limitation of predefined pathways. A Python implementation of <monospace>ambient</monospace> is available at <ext-link ext-link-type="uri" xlink:href="http://www.theosysbio.bio.ic.ac.uk/ambient">http://www.theosysbio.bio.ic.ac.uk/ambient</ext-link>.</p>
      </sec>
    </abstract>
    <kwd-group>
      <kwd>Metabolic networks</kwd>
      <kwd>Simulated annealing</kwd>
      <kwd>High-throughput data</kwd>
      <kwd>Stress response</kwd>
      <kwd>Network analysis</kwd>
    </kwd-group>
  </article-meta>
</front>
<body>
  <sec>
    <title>Background</title>
    <p>The increasing availability of high-throughput biological data sets promises a deeper understanding of cellular processes than has ever previously been accessible. Many of these high-throughput experiments directly or indirectly measure metabolic changes within a cell, for example microarrays indirectly measure enzyme concentration and metabolomics experiments directly measure changing metabolite concentrations. The metabolism of any organism is a complex system with thousands of interacting entities, meaning that an integrated, network-based analysis is required in order to extract the maximum amount of knowledge from these data.</p>
    <p>Common methods for proteome and transcriptome analysis include GO or KEGG enrichment analysis using Fisher’s exact test or gene set enrichment analysis (GSEA [<xref ref-type="bibr" rid="B1">1</xref>]). These approaches look for predefined pathways (or gene sets) that are enriched for genes with highly changed transcription (or translation), usually using a two-fold up- or down-regulation cutoff to define these highly changed genes. However, if biologically important pathways cross multiple predefined pathways (or gene sets) they might not be picked up by these approaches, which do not allow flexibility in pathway definitions.</p>
    <p>Other approaches have analysed such data using simple protein interaction graphs. Ideker et al. [<xref ref-type="bibr" rid="B2">2</xref>] have developed a method called Active Modules, which employs simulated annealing to search for connected components of a protein-protein interaction (PPI) network that are significantly changed according to some microarray dataset, thus giving an insight into how a coordinated response occurs in the PPI network without the need for such predefined pathways or gene-sets.</p>
    <p>In order to find significantly changed pathways in metabolism, Breitling et al. [<xref ref-type="bibr" rid="B3">3</xref>] developed GiGA (Graph-based iterative Group Analysis), an alternative to the Active Modules approach, which uses a greedy algorithm to build connected components of a gene-gene graph that are significantly enriched with genes having a low p-value for expression change. The chief innovation of GiGA as applied to metabolic network analysis is the ability to link genes by any given set of associations. In [<xref ref-type="bibr" rid="B3">3</xref>] these associations are made through metabolites in KEGG pathways, linking genes that encode enzymes sharing a particular metabolite as substrate or product. The gene-gene graph is then a representation of the metabolic network, within which GiGA finds connected components that are enriched for significant gene changes. Such analyses, when applied in the metabolic context, can be thought of as pathway finding methods, uncovering linked modules (or pathways) of genes or proteins that undergo coordinated change as a result of some environmental or genetic perturbation. These modules give a better view of the coordination specifically of metabolic changes and when accompanied by expert interpretation can reveal insights into system-level responses.</p>
    <p>Several other recent methods have been developed to take explicit advantage of the underlying metabolic network structure controlled by transcriptional changes in order to determine network-based gene neighbourhoods. PathExpress [<xref ref-type="bibr" rid="B4">4</xref>] takes a set of genes of interest (such as genes with p-values for change below a certain cutoff) as an input and for each enzyme finds whether there is enrichment of genes of interest around that enzyme. This ‘enzyme neighbourhood’ is defined through gene-reaction-metabolite relationships in KEGG. However, these neighbourhoods are predefined by the metabolic network before analysis, rather than allowed to take any shape or size. KEGG spider [<xref ref-type="bibr" rid="B5">5</xref>] does a similar analysis, but is limited to those organisms covered by the KEGG orthology database. Both of these approaches have similar limitations: they discard information about fold-changes of the entire transcriptome by demanding a significance cutoff for each gene and they also limit the shape and size of inferred modules. Recently Schramm et al. [<xref ref-type="bibr" rid="B6">6</xref>] developed a network-topology based approach to finding gene regulatory relationships in the context of metabolism, but this is currently applicable to a limited number of organisms and relies on KEGG annotations of those organisms and KEGG pathway maps.</p>
    <p>Whilst GiGA and Active Modules can both find arbitrary modules in simple gene-gene interaction graphs, there are several problems in using such graphs to represent metabolic networks. Genes in these networks connect to all other genes associated with a particular metabolite, such that so-called currency metabolites (compounds involved in many reactions, for instance water, carbon dioxide and ATP) can link large swathes of metabolism to create large (complete) subnetworks. Currency metabolites can potentially falsely link unrelated parts of metabolism in pathway-building approaches and must therefore be accounted for. Usually this is done by <italic>a priori</italic> manual removal of these metabolites [<xref ref-type="bibr" rid="B4">4</xref>] or simply assigning a maximum connectivity, above which a metabolite will be discarded from the network [<xref ref-type="bibr" rid="B3">3</xref>]. However, both approaches require a somewhat arbitrary classification of compounds that may result in the loss of useful information. Figure <xref ref-type="fig" rid="F1">1</xref> shows the conceptual problems with these approaches. In the case where a highly connected metabolite is not a currency metabolite, important structural information about the network can be lost by ‘over-connection’ of the network (as in Figure <xref ref-type="fig" rid="F1">1</xref>B). However, in the case where this metabolite is removed (Figure <xref ref-type="fig" rid="F1">1</xref>C) the potential for a crossover between the pathways, even supported by experimental evidence, is eliminated.</p>
    <fig id="F1" position="float">
      <label>Figure 1</label>
      <caption>
        <p><bold>Differing representations of metabolic networks.</bold> Showing a bipartite representation of two pathways (<italic>abc</italic> and <italic>def</italic>) linked by a highly connected metabolite (I), as used in <monospace>ambient</monospace> and a reaction-only representation (II), such as that used in GiGA. In representation <bold>A</bold>, penalising metabolite 5 allows for pathways including only <italic>abc</italic>, or only <italic>def</italic>, as well as pathway crossover if there is sufficient evidence for it. Representation <bold>B</bold> shows how the network would be construed if metabolites were used to link reactions together; the original pathways are lost in this case. Representation <bold>C</bold> shows the network if metabolite 5 were deemed to be a currency metabolite. This retains the two original pathways, but would never link the two pathways even if there were evidence for crossover.</p>
      </caption>
      <graphic xlink:href="1752-0509-7-26-1"/>
    </fig>
    <p>Genes encoding enzymes with the same function (isozymes) can also be problematic: often the quantity of real interest for a particular reaction is the net change in flux or flux capacity for that reaction, thus multiple gene changes related to a single reaction should be accounted for together rather than as separate nodes in a graph representation of metabolism. In contrast, multi-function enzymes can potentially erroneously link two separate parts of metabolism and cause inferred modules to consist of otherwise disconnected pathways within the metabolic network.</p>
    <p>The bipartite metabolite-reaction representation of metabolism solves all of these problems by representing both metabolites and reactions as nodes and mapping data onto these entities separately. Figure <xref ref-type="fig" rid="F1">1</xref>A shows such a bipartite network (circles representing metabolites and squares representing reactions). This representation allows the full relationship between reactions and metabolites to be used in the investigation of metabolic changes. No metabolites need be removed from the initial network because they can be individually assessed for inclusion in any pathway prediction (in conjunction with the <monospace>ambient</monospace> scoring system as detailed in the Methods section). Since reactions, rather than genes, are used for mapping data onto the network, isozymes and multifunctional enzymes can be amalgamated and separated respectively according to actual enzymatic function (also in conjunction with the <monospace>ambient</monospace> scoring system), eliminating the problems of gene-centric metabolic network representations.</p>
    <p>The analysis of such a network representation requires that there is information mapping genes to reactions. Until recently this would have limited the use of this approach to organisms with published manually curated metabolic models (for example [<xref ref-type="bibr" rid="B7">7</xref>]) and organisms that are present in such metabolic network databases as KEGG [<xref ref-type="bibr" rid="B8">8</xref>] and BioCyc [<xref ref-type="bibr" rid="B9">9</xref>], many of which are not subject to any curation. However, Henry et al. [<xref ref-type="bibr" rid="B10">10</xref>] have implemented a system to automatically reconstruct a draft-quality metabolic model for any prokaryotic organism with a complete genome sequence, thus enabling bipartite metabolic networks with gene-reaction mappings to be produced for any of these organisms.</p>
    <p>In this paper we introduce <monospace>ambient</monospace>, a new method for high-throughput data analysis in the context of metabolic models. <monospace>ambient</monospace> is an extension of the Active Modules approach such that it accommodates bipartite (reaction and metabolite) networks, allowing coordinated metabolic pathway changes to be discovered from transcriptomic or metabolomic data. Simulated annealing is used to find modules (i.e. connected components) containing reactions associated with genes that are highly changed in expression and metabolites that have low overall connectivity (low weights, after Croes et al. [<xref ref-type="bibr" rid="B11">11</xref>]).</p>
    <p><monospace>ambient</monospace> has several advantages over previous approaches to the discovery of metabolic modules. The bipartite representation of metabolism offers a systematic objective representation of metabolism which enables unbiased pathway finding. It also treats all metabolites equivalently, so information about the metabolic network is not lost through arbitrary decisions about which metabolites should be considered currency metabolites. In this paper we compare <monospace>ambient</monospace> to GiGA [<xref ref-type="bibr" rid="B3">3</xref>] to show how it complements and improves on existing approaches to metabolic module finding in high-throughput data analyses.</p>
  </sec>
  <sec sec-type="methods">
    <title>Methods</title>
    <p>The algorithm implemented in <monospace>ambient</monospace> is based on the Active Modules approach of Ideker et al. [<xref ref-type="bibr" rid="B2">2</xref>], extended to a bipartite network. The largest modification of the approach apart from the changed network representation is to toggle edge membership rather than node membership in candidate subnetworks, as described below. A Python implementation of <monospace>ambient</monospace> is provided at <ext-link ext-link-type="uri" xlink:href="http://www.theosysbio.bio.ic.ac.uk/ambient">http://www.theosysbio.bio.ic.ac.uk/ambient</ext-link>.</p>
    <sec>
      <title>Input data and outputs</title>
      <p><monospace>ambient</monospace> requires as input a metabolic model and scores for those reactions for which data is available. By default, metabolite scores are calculated using their degree in the metabolic network (as described below) so their scores need not be specified by the user. For models with gene-protein-reaction (GPR) relationships, scores for genes can be provided, which are converted into scores for reactions. The metabolic model is represented by an undirected bipartite network, where an edge links a reaction node with a metabolite node when the metabolite is either a substrate or product of that reaction. Scores for reactions for which there are no data are by default set as the median score of the set of known reaction scores.</p>
      <p>The Python implementation of <monospace>ambient</monospace> outputs three files: a ‘.tsv’ flatfile results table of all nodes from each significant module, a GraphML file for results visualisation and a ‘.dat’ file in the Python <monospace>shelve</monospace> format containing all input and output variables.</p>
    </sec>
    <sec>
      <title>Scoring nodes</title>
      <p>Reaction nodes must each be assigned a score, according to the data being analysed. Although in principle this can be based on any dataset, in this work we have investigated the use of <monospace>ambient</monospace> with microarray data, so reactions have been scored according to the transcriptomic data for the enzymatic genes known to be involved in the catalysis of those reactions. The scores of each reaction have been assigned in the following way: where a reaction is linked to a single gene in its GPR the reaction is given the value of the fold-change of that gene’s transcript.</p>
      <p>Where a reaction is catalysed by a single enzyme made up of multiple different gene products the mean of the fold-changes of those genes is assigned to the reaction. In this way error propagation from individual gene transcript measurements is reduced. Without any knowledge of relative activities of enzymes for each reaction, if a reaction is catalysed by multiple enzymes the mean of the inferred enzyme fold-changes is used. This takes into account all of the enzyme level changes affecting single reactions in a single fold-change score.</p>
    </sec>
    <sec>
      <title>Scoring modules</title>
      <p>A module <italic>m</italic> is defined as the union of a subset <italic>r</italic><sup><italic>m</italic></sup> of reactions and a subset <italic>c</italic><sup><italic>m</italic></sup> of metabolites that subtend a connected subgraph within the bipartite metabolic graph. The score <italic>S</italic> of a module is given by </p>
      <p>
        <disp-formula>
          <mml:math id="M1" name="1752-0509-7-26-i1" overflow="scroll">
            <mml:mrow>
              <mml:mi>S</mml:mi>
              <mml:mo>(</mml:mo>
              <mml:mi>m</mml:mi>
              <mml:mo>)</mml:mo>
              <mml:mo>=</mml:mo>
              <mml:mo>ln</mml:mo>
              <mml:mo>(</mml:mo>
              <mml:mi>q</mml:mi>
              <mml:mo>)</mml:mo>
              <mml:mfenced open="(" close=")">
                <mml:mrow>
                  <mml:munder>
                    <mml:mrow>
                      <mml:mi mathsize="big">∑</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>i</mml:mi>
                    </mml:mrow>
                  </mml:munder>
                  <mml:mi>s</mml:mi>
                  <mml:mo>(</mml:mo>
                  <mml:msubsup>
                    <mml:mrow>
                      <mml:mi>r</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>i</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>m</mml:mi>
                    </mml:mrow>
                  </mml:msubsup>
                  <mml:mo>)</mml:mo>
                  <mml:mo>-</mml:mo>
                  <mml:mi>α</mml:mi>
                  <mml:munder>
                    <mml:mrow>
                      <mml:mi mathsize="big">∑</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>j</mml:mi>
                    </mml:mrow>
                  </mml:munder>
                  <mml:mi>w</mml:mi>
                  <mml:mo>(</mml:mo>
                  <mml:msubsup>
                    <mml:mrow>
                      <mml:mi>c</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>j</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>m</mml:mi>
                    </mml:mrow>
                  </mml:msubsup>
                  <mml:mo>)</mml:mo>
                </mml:mrow>
              </mml:mfenced>
              <mml:mo>,</mml:mo>
            </mml:mrow>
          </mml:math>
        </disp-formula>
      </p>
      <p> where <italic>q</italic> = |<italic>r</italic><sup><italic>m</italic></sup>| + |<italic>c</italic><sup><italic>m</italic></sup>| is the number of nodes in the module <italic>m</italic>, <inline-formula><mml:math id="M2" name="1752-0509-7-26-i2" overflow="scroll"><mml:mi>s</mml:mi><mml:mo>(</mml:mo><mml:msubsup><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msubsup><mml:mo>)</mml:mo></mml:math></inline-formula> is the score of the <italic>i</italic><sup>th</sup> reaction in the module, <inline-formula><mml:math id="M3" name="1752-0509-7-26-i3" overflow="scroll"><mml:mi>w</mml:mi><mml:mo>(</mml:mo><mml:msubsup><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msubsup><mml:mo>)</mml:mo></mml:math></inline-formula> is the weight (the degree in the original network) of the <italic>j</italic><sup>th</sup> metabolite in the module and <italic>α</italic> is a constant given by </p>
      <p>
        <disp-formula>
          <mml:math id="M4" name="1752-0509-7-26-i4" overflow="scroll">
            <mml:mrow>
              <mml:mi>α</mml:mi>
              <mml:mo>=</mml:mo>
              <mml:mfrac>
                <mml:mrow>
                  <mml:mo>|</mml:mo>
                  <mml:mi>c</mml:mi>
                  <mml:mo>|</mml:mo>
                  <mml:munder>
                    <mml:mrow>
                      <mml:mo mathsize="big">∑</mml:mo>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>i</mml:mi>
                    </mml:mrow>
                  </mml:munder>
                  <mml:mi>s</mml:mi>
                  <mml:mo>(</mml:mo>
                  <mml:msubsup>
                    <mml:mrow>
                      <mml:mi>r</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>i</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mo>+</mml:mo>
                    </mml:mrow>
                  </mml:msubsup>
                  <mml:mo>)</mml:mo>
                </mml:mrow>
                <mml:mrow>
                  <mml:mo>|</mml:mo>
                  <mml:msup>
                    <mml:mrow>
                      <mml:mi>r</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mo>+</mml:mo>
                    </mml:mrow>
                  </mml:msup>
                  <mml:mo>|</mml:mo>
                  <mml:munder>
                    <mml:mrow>
                      <mml:mo mathsize="big">∑</mml:mo>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>j</mml:mi>
                    </mml:mrow>
                  </mml:munder>
                  <mml:mi>w</mml:mi>
                  <mml:mo>(</mml:mo>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>c</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>j</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>)</mml:mo>
                </mml:mrow>
              </mml:mfrac>
              <mml:mo>,</mml:mo>
            </mml:mrow>
          </mml:math>
        </disp-formula>
      </p>
      <p>
        <disp-formula>
          <mml:math id="M5" name="1752-0509-7-26-i5" overflow="scroll">
            <mml:mrow>
              <mml:mtext>where</mml:mtext>
              <mml:mspace width="0.3em"/>
              <mml:mspace width="0.3em"/>
              <mml:msup>
                <mml:mrow>
                  <mml:mi>r</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mo>+</mml:mo>
                </mml:mrow>
              </mml:msup>
              <mml:mo>⊆</mml:mo>
              <mml:mi>r</mml:mi>
              <mml:mo>:</mml:mo>
              <mml:mi>s</mml:mi>
              <mml:mo>(</mml:mo>
              <mml:msubsup>
                <mml:mrow>
                  <mml:mi>r</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>i</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mo>+</mml:mo>
                </mml:mrow>
              </mml:msubsup>
              <mml:mo>)</mml:mo>
              <mml:mo>&gt;</mml:mo>
              <mml:mn>0</mml:mn>
              <mml:mspace width="2.22198pt"/>
              <mml:mo>∀</mml:mo>
              <mml:mspace width="2.22198pt"/>
              <mml:msubsup>
                <mml:mrow>
                  <mml:mi>r</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>i</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mo>+</mml:mo>
                </mml:mrow>
              </mml:msubsup>
              <mml:mo>∈</mml:mo>
              <mml:msup>
                <mml:mrow>
                  <mml:mi>r</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mo>+</mml:mo>
                </mml:mrow>
              </mml:msup>
              <mml:mi>.</mml:mi>
            </mml:mrow>
          </mml:math>
        </disp-formula>
      </p>
      <p><italic>α</italic> is defined here as the mean score of all reactions for which <italic>s</italic> &gt; 0, divided by the mean value of <italic>w</italic> over the complete network. This formula for <italic>α</italic> is chosen to ensure that modules are not needlessly restricted by metabolite weights, but do not extend to cover large, biologically meaningless regions of the network. This algorithm tracks all module scores, the logarithmic term being added to bias exploration towards larger modules, without generating extremely large, biologically meaningless modules.</p>
      <p>As in the original Active Modules algorithm, the aim is to find the set of non-overlapping modules with the highest total score. Finding global maximum scoring modules is NP-Hard [<xref ref-type="bibr" rid="B2">2</xref>], so a simulated annealing approach is taken. In order to search the space of all modules efficiently, a random set of edges (rather than a single edge) is toggled at each step of the simulated annealing.</p>
      <p>In many cases, modules describing downregulated regions of the network are of as much interest as upregulated regions. These modules can be investigated by multiplying reaction scores by -1, which gives the most reduced reaction the highest score, and leaving the metabolite scores negative. With this transformation, downregulated modules can be found using the same algorithm as upregulated ones.</p>
    </sec>
    <sec>
      <title><monospace><bold>Ambient</bold></monospace> algorithm</title>
      <p>The algorithm for finding high scoring modules is outlined here (for a complete description of the method, see the Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>): </p>
      <p>1. Set <italic>t</italic> = <italic>t</italic><sub><italic>init</italic></sub>, <italic>t</italic> = <italic>t</italic><sub><italic>init</italic></sub>,</p>
      <p>2. Select a random set of edges, <italic>E</italic>, of size <italic>t</italic>, as the initial edge set,</p>
      <p>3. Calculate the score <inline-formula><mml:math id="M6" name="1752-0509-7-26-i6" overflow="scroll"><mml:mi>σ</mml:mi><mml:mo>(</mml:mo><mml:mi>E</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:munder><mml:mi>S</mml:mi><mml:mo>(</mml:mo><mml:msubsup><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>E</mml:mi></mml:mrow></mml:msubsup><mml:mo>)</mml:mo></mml:math></inline-formula>, where <italic>m</italic><sup><italic>E</italic></sup> is the set of connected components induced by <italic>E</italic>,</p>
      <p>4. Select <italic>t</italic> edges at random to form the toggle set, <italic>F</italic>,</p>
      <p>5. Propose a new edge set, <italic>P</italic> = <italic>E</italic> ∪ <italic>F</italic> - <italic>E</italic> ∩ <italic>F</italic>,</p>
      <p>6. Calculate <inline-formula><mml:math id="M7" name="1752-0509-7-26-i7" overflow="scroll"><mml:mi>σ</mml:mi><mml:mo>(</mml:mo><mml:mi>P</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:munder><mml:mi>S</mml:mi><mml:mo>(</mml:mo><mml:msubsup><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:msubsup><mml:mo>)</mml:mo></mml:math></inline-formula>,</p>
      <p>7. If <inline-formula><mml:math id="M8" name="1752-0509-7-26-i8" overflow="scroll"><mml:mi>ρ</mml:mi><mml:mo>&lt;</mml:mo><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mfrac><mml:mrow><mml:mi>σ</mml:mi><mml:mo>(</mml:mo><mml:mi>P</mml:mi><mml:mo>)</mml:mo><mml:mo>-</mml:mo><mml:mi>σ</mml:mi><mml:mo>(</mml:mo><mml:mi>E</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:msup></mml:math></inline-formula>, where <italic>ρ</italic> is a random number drawn from [0,1), accept the proposed move and set E = P,</p>
      <p>8. Repeat steps 4 to 7 until the temperature reduction criterion (see below and Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>) is met,</p>
      <p>9. Set <italic>t</italic> = 0.9<italic>t</italic> and <italic>T</italic> = 0.9<italic>T</italic>, </p>
      <p>10. If the maximum number of annealing steps is reached then END, otherwise go to step 3.</p>
      <p>Here, <italic>t</italic> is the number of edges to toggle during any one toggle step and <italic>T</italic> is the effective temperature for annealing, determining the tolerance for accepting negatively scoring steps. <italic>t</italic><sub><italic>init</italic></sub> and <italic>t</italic><sub><italic>init</italic></sub> are determined from the number of nodes and node scores respectively, as described in the Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>. The temperature reduction criterion is based on adaptive simulated annealing, giving a highly efficient cooling schedule. For any particular temperature, annealing steps are taken until the system reaches thermal equilibrium (in this case when the sum of the scores of the modules over, say, 5000 steps does not change by more than 5%) and this represents the temperature reduction criterion. If this is met, or a cutoff number of steps is reached (i.e. the score fails to converge over a long period) then the algorithm moves to step 9.</p>
    </sec>
    <sec>
      <title>Determining module statistical significance</title>
      <p>The significance values of modules found by <monospace>ambient</monospace> are found empirically because the distribution of module scores for different sized modules is not known <italic>a priori</italic>. For each module, the number of reactions and metabolites contained in that module are determined. A random sample of scores for that number of reactions and metabolites is summed to produce a random score for a module of that size. This is repeated <italic>P</italic> times (set by the -P option at the command line, default =10000) and the empirical p-value is equal to the number of scores in this sample greater than the module score from annealing divided by <italic>P</italic>. This is determined for the top <italic>M</italic> modules. These <italic>M</italic> p-values are corrected for multiple testing using the Benjamini-Hochberg correction.</p>
    </sec>
    <sec>
      <title>Module visualization</title>
      <p>All network diagrams were created using Cytoscape v2.8.2 [<xref ref-type="bibr" rid="B12">12</xref>].</p>
    </sec>
  </sec>
  <sec>
    <title>Results and discussion</title>
    <sec>
      <title>Case study: diauxic shift in <italic>Saccharomyces cerevisiae</italic></title>
      <p>The data used to validate the <monospace>ambient</monospace> tool were taken from an experiment by DeRisi et al. [<xref ref-type="bibr" rid="B13">13</xref>], investigating the transcriptional response of <italic>S. cerevisiae</italic> to glucose depletion. The gene scores used were the log fold-changes between the 0 hour timepoint (glucose rich) and 20.5 hour timepoint (glucose starved) of that experiment. The YEASTNET yeast model [<xref ref-type="bibr" rid="B14">14</xref>] was taken as the basis metabolic network. This network is available in SBML format so could be used directly by <monospace>ambient</monospace>, and was also converted into a simple protein interaction network with edges induced by shared metabolites for input to GiGA [<xref ref-type="bibr" rid="B3">3</xref>].</p>
      <p>Overall the DeRisi dataset covers 6153 genes, of which 903 are present in the YEASTNET model, which through the gene-reaction relationships in that model provide scores for 1239 of the 1865 reactions in the model. Since the overall change in metabolism was being investigated, those reactions for which there were no data were assigned the median score of the reactions with known scores. Due to the formulation of the method, <monospace>ambient</monospace> modules may include reactions for which there is no data, as long as the scores from the surrounding reactions support such an inclusion.</p>
      <p><monospace>ambient</monospace> was run with all parameters set as default except the maximum number of annealing steps <italic>N</italic>, which was set to 1,000,000. GiGA was run with all parameters at default values, ignoring metabolites with degree greater than 20 (currency metabolites) and restricting the number of genes per module to 40. Since GiGA does not make predictions about which metabolites are in particular modules, a simple rule was followed: where any non-currency metabolite was connected to more than one reaction in a GiGA module, it was included in that module. The analysis was run twice for each method, to find both up- and down-regulated modules; of particular interest was whether the main result of [<xref ref-type="bibr" rid="B13">13</xref>], of the rerouting of carbon in the Glycolysis/Gluconeogenesis (GLY/GNG) pathway and the TCA cycle, were recapitulated with this metabolic model.</p>
      <p>Table <xref ref-type="table" rid="T1">1</xref> summarises the results obtained from GiGA and <monospace>ambient</monospace>. The <monospace>ambient</monospace> analysis in both directions produced many positive scoring modules, of which four were significantly up-regulated and one was significantly down-regulated at the <italic>q</italic> &lt; 0.05 level (all of these had q-values of &lt; 10<sup>-4</sup>). The highest weight (connectivity) metabolite found to be in one of these modules is cytoplasmic L-glutamine, connected in the full metabolic network to 19 reactions. Figure <xref ref-type="fig" rid="F2">2</xref> shows the top up-regulated module and Additional file <xref ref-type="supplementary-material" rid="S2">2</xref>: Figures S1 (up-) and S2 (down-) show all of the other modules found by <monospace>ambient</monospace>, along with their overlap with the GiGA modules found. The corresponding diagrams for GiGA are in Additional file <xref ref-type="supplementary-material" rid="S2">2</xref>: Figures S3 and S4. Additional file <xref ref-type="supplementary-material" rid="S2">2</xref>: Figure S2 shows the very large single <monospace>ambient</monospace> down-regulated module consisting of 333 reactions and metabolites. This large module indicates that the general downshift of metabolism between hour 0 and hour 20.5 in the experiment is captured in the <monospace>ambient</monospace> analysis. The module shows the reduction of lipid biosynthesis, amino acid production and also includes the biomass production reaction itself, as well as picking out the GLY/GNG pathway discussed below.</p>
      <table-wrap position="float" id="T1">
        <label>Table 1</label>
        <caption>
          <p>
            <bold>Summary comparison between</bold>
            <monospace>ambient</monospace>
            <bold>and GiGA</bold>
          </p>
        </caption>
        <table frame="hsides" rules="groups" border="1">
          <colgroup>
            <col align="left"/>
            <col align="center"/>
            <col align="center"/>
          </colgroup>
          <thead valign="top">
            <tr>
              <th align="left"> </th>
              <th align="center">
                <monospace>
                  <bold>ambient</bold>
                </monospace>
              </th>
              <th align="center">
                <bold>GiGA</bold>
              </th>
            </tr>
          </thead>
          <tbody valign="top">
            <tr>
              <td align="center" valign="bottom">No. of significant modules<hr/></td>
              <td align="center" valign="bottom">4<hr/></td>
              <td align="center" valign="bottom">6<hr/></td>
            </tr>
            <tr>
              <td align="center" valign="bottom">No. of reactions in significant modules<hr/></td>
              <td align="center" valign="bottom">164<hr/></td>
              <td align="center" valign="bottom">220<hr/></td>
            </tr>
            <tr>
              <td align="center" valign="bottom">Q-value of top module<hr/></td>
              <td align="center" valign="bottom">&lt;10<sup>-4</sup><hr/></td>
              <td align="center" valign="bottom">&lt;10<sup>-50</sup><hr/></td>
            </tr>
            <tr>
              <td align="center" valign="bottom">No. of reactions in top module<hr/></td>
              <td align="center" valign="bottom">112<hr/></td>
              <td align="center" valign="bottom">75<hr/></td>
            </tr>
            <tr>
              <td colspan="3" align="center" valign="bottom">
                <bold>Comparison</bold>
                <hr/>
              </td>
            </tr>
            <tr>
              <td align="center" valign="bottom">F-measure (significant modules)<hr/></td>
              <td colspan="2" align="center" valign="bottom">0.363<hr/></td>
            </tr>
            <tr>
              <td align="center" valign="bottom">F-measure (top modules)<hr/></td>
              <td colspan="2" align="center" valign="bottom">0.461<hr/></td>
            </tr>
            <tr>
              <td align="center">Adjusted Rand</td>
              <td colspan="2" align="center">0.288</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <p>Summary statistics comparing the GiGA and <monospace>ambient</monospace> approaches to analysing the diauxic shift of <italic>Saccharomyces cerevisiae</italic> on glucose starvation.</p>
        </table-wrap-foot>
      </table-wrap>
      <fig id="F2" position="float">
        <label>Figure 2</label>
        <caption>
          <p><bold>Up-regulated module 1 from </bold><monospace><bold>ambient</bold></monospace><bold> analysis over yeast diauxic shift.</bold> Showing the complete set of reactions and metabolites inferred by <monospace>ambient</monospace> to be present in the highest scoring (and largest) coordinately changed part of metabolism. Reactions outlined in black are indicated in the DeRisi analysis of the same data to be the upregulated part of metabolism responsible for carbon rerouting in central carbon metabolism due to the diauxic shift induced in that experiment [<xref ref-type="bibr" rid="B13">13</xref>]. Orange coloured nodes are only found in the <monospace>ambient</monospace> module, whilst those coloured brown are also present in a module returned by GiGA. Metabolites in different compartments are explicitly treated as different metabolites in metabolic models such as this, so can be seen more than once (along with an indication of the compartment for each one).</p>
        </caption>
        <graphic xlink:href="1752-0509-7-26-2"/>
      </fig>
      <p>The yeast model used is compartmentalised, so mitochondrial and cytosolic reactions and metabolites are separated. Both GiGA and <monospace>ambient</monospace> recapitulate the main conclusions of previous analyses [<xref ref-type="bibr" rid="B3">3</xref>,<xref ref-type="bibr" rid="B13">13</xref>], namely that the most significantly affected parts of metabolism are the TCA cycle and associated respiratory chain complexes. They also both capture the TCA cycle in the mitochondrial compartment, as expected in yeast.</p>
      <p>Each of the three parts of the central carbon metabolism show up in different modules in the <monospace>ambient</monospace> analysis. Detailed results for these pathways can be found in Table <xref ref-type="table" rid="T2">2</xref> which shows inferences for <monospace>ambient</monospace>, GiGA and from expert manual inspection [<xref ref-type="bibr" rid="B13">13</xref>]. This table shows the extent to which each computational method recapitulates the manually observed carbon rerouting through central metabolism in the diauxic shift induced in <italic>S. cerevisiae</italic>. To assess the similarity between the two computational approaches and the DeRisi analysis, the recall, precision and F-measure were calculated, with the results as shown in Table <xref ref-type="table" rid="T3">3</xref>. These data indicate that <monospace>ambient</monospace> agrees somewhat better with expert interpretation of data for both the GLY/GNG top pathway and the TCA cycle results. Whilst recall is much better for the TCA connection pathway, <monospace>ambient</monospace> has a very poor precision. This reduced precision is because the down-regulated pathway found by <monospace>ambient</monospace> is very large, reflecting the general downshift in metabolism rather than just the most highly repressed enzymes. As seen in Additional file <xref ref-type="supplementary-material" rid="S2">2</xref>: Figures S3 and S4, each of the GiGA modules is separated into unconnected modules from the conversion between the simple gene-gene evidence graph used in the analysis to the bipartite metabolite-reaction representation. This is due to genes being involved in more than one reaction, where metabolites do not necessarily overlap between these reactions.</p>
      <table-wrap position="float" id="T2">
        <label>Table 2</label>
        <caption>
          <p>Details of the reactions regulated in diauxic shift in the GLY/GNG pathway and the TCA Cycle</p>
        </caption>
        <table frame="hsides" rules="groups" border="1">
          <colgroup>
            <col align="left"/>
            <col align="center"/>
            <col align="center"/>
            <col align="center"/>
            <col align="center"/>
            <col align="center"/>
          </colgroup>
          <thead valign="top">
            <tr>
              <th align="left" valign="bottom">
                <bold>Loci</bold>
                <hr/>
              </th>
              <th align="right" valign="bottom">
                <bold>ID</bold>
                <hr/>
              </th>
              <th align="right" valign="bottom">
                <bold>Value</bold>
                <hr/>
              </th>
              <th align="center" valign="bottom">
                <monospace>
                  <bold>ambient</bold>
                </monospace>
                <hr/>
              </th>
              <th align="center" valign="bottom">
                <bold>GiGA</bold>
                <hr/>
              </th>
              <th align="center" valign="bottom">
                <bold>Diff. expressed</bold>
                <hr/>
              </th>
            </tr>
            <tr>
              <th align="left"> </th>
              <th align="left"> </th>
              <th align="left"> </th>
              <th align="center">
                <bold>Module</bold>
              </th>
              <th align="center">
                <bold>Module</bold>
              </th>
              <th align="center">
                <bold>Reactions</bold>
                <bold>(DeRisi)</bold>
              </th>
            </tr>
          </thead>
          <tbody valign="top">
            <tr>
              <td align="left" valign="bottom">
                <bold>Glycolysis/Gluconeogenesis - top</bold>
                <hr/>
              </td>
              <td align="right" valign="bottom"> <hr/></td>
              <td align="right" valign="bottom"> <hr/></td>
              <td align="center" valign="bottom"> <hr/></td>
              <td align="center" valign="bottom"> <hr/></td>
              <td> </td>
            </tr>
            <tr>
              <td align="left" valign="bottom">NTH1,2, ATH1<hr/></td>
              <td align="right" valign="bottom">2868<hr/></td>
              <td align="right" valign="bottom">1.87<hr/></td>
              <td align="center" valign="bottom">u2<hr/></td>
              <td align="center" valign="bottom">u2<hr/></td>
              <td align="center" valign="bottom">1<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom">TPS1,2, TSL1, TPS3<hr/></td>
              <td align="right" valign="bottom">2870<hr/></td>
              <td align="right" valign="bottom">1.21<hr/></td>
              <td align="center" valign="bottom">0<hr/></td>
              <td align="center" valign="bottom">u2<hr/></td>
              <td align="center" valign="bottom">1<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom">GSY1,2, GLG1,2<hr/></td>
              <td align="right" valign="bottom">3204<hr/></td>
              <td align="right" valign="bottom">2.35<hr/></td>
              <td align="center" valign="bottom">u2<hr/></td>
              <td align="center" valign="bottom">u2<hr/></td>
              <td align="center" valign="bottom">1<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom">GLC3<hr/></td>
              <td align="right" valign="bottom">2663<hr/></td>
              <td align="right" valign="bottom">2.87<hr/></td>
              <td align="center" valign="bottom">u2<hr/></td>
              <td align="center" valign="bottom">u2<hr/></td>
              <td align="center" valign="bottom">1<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom">UGP1<hr/></td>
              <td align="right" valign="bottom">3729<hr/></td>
              <td align="right" valign="bottom">1.01<hr/></td>
              <td align="center" valign="bottom">u2<hr/></td>
              <td align="center" valign="bottom">0<hr/></td>
              <td align="center" valign="bottom">1<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom">GDB1<hr/></td>
              <td align="right" valign="bottom">3154<hr/></td>
              <td align="right" valign="bottom">2.6<hr/></td>
              <td align="center" valign="bottom">u2<hr/></td>
              <td align="center" valign="bottom">u2<hr/></td>
              <td align="center" valign="bottom">1<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom">PGM1,2<hr/></td>
              <td align="right" valign="bottom">3518<hr/></td>
              <td align="right" valign="bottom">1.56<hr/></td>
              <td align="center" valign="bottom">u2<hr/></td>
              <td align="center" valign="bottom">u2<hr/></td>
              <td align="center" valign="bottom">1<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom">PGI1<hr/></td>
              <td align="right" valign="bottom">3160<hr/></td>
              <td align="right" valign="bottom">0.48<hr/></td>
              <td align="center" valign="bottom">0<hr/></td>
              <td align="center" valign="bottom">0<hr/></td>
              <td align="center" valign="bottom">0<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom">GPH1<hr/></td>
              <td align="right" valign="bottom">3205<hr/></td>
              <td align="right" valign="bottom">0.43<hr/></td>
              <td align="center" valign="bottom">u2<hr/></td>
              <td align="center" valign="bottom">0<hr/></td>
              <td align="center" valign="bottom">0<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom">FBP1<hr/></td>
              <td align="right" valign="bottom">3140<hr/></td>
              <td align="right" valign="bottom">3.84<hr/></td>
              <td align="center" valign="bottom">0<hr/></td>
              <td align="center" valign="bottom">u2<hr/></td>
              <td align="center" valign="bottom">1<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom">HXK1, GLK1, HXK2<hr/></td>
              <td align="right" valign="bottom">3230<hr/></td>
              <td align="right" valign="bottom">0.18<hr/></td>
              <td align="center" valign="bottom">0<hr/></td>
              <td align="center" valign="bottom">u2<hr/></td>
              <td align="center" valign="bottom">1<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom">
                <bold>TCA Cycle</bold>
                <hr/>
              </td>
              <td align="right" valign="bottom"> <hr/></td>
              <td align="right" valign="bottom"> <hr/></td>
              <td align="center" valign="bottom"> <hr/></td>
              <td align="center" valign="bottom"> <hr/></td>
              <td align="center" valign="bottom"> <hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom">PCK1<hr/></td>
              <td align="right" valign="bottom">3514<hr/></td>
              <td align="right" valign="bottom">3.88<hr/></td>
              <td align="center" valign="bottom">u1<hr/></td>
              <td align="center" valign="bottom">0<hr/></td>
              <td align="center" valign="bottom">1<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom">PYC1,2<hr/></td>
              <td align="right" valign="bottom">3594<hr/></td>
              <td align="right" valign="bottom">1.59<hr/></td>
              <td align="center" valign="bottom">u1<hr/></td>
              <td align="center" valign="bottom">0<hr/></td>
              <td align="center" valign="bottom">1<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom">PDA1,2, PDB1, LPD1, PDX1<hr/></td>
              <td align="right" valign="bottom">3597<hr/></td>
              <td align="right" valign="bottom">0.1<hr/></td>
              <td align="center" valign="bottom">u1<hr/></td>
              <td align="center" valign="bottom">0<hr/></td>
              <td align="center" valign="bottom">0<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom">ACS1,2<hr/></td>
              <td align="right" valign="bottom">2785<hr/></td>
              <td align="right" valign="bottom">3.7<hr/></td>
              <td align="center" valign="bottom">u1<hr/></td>
              <td align="center" valign="bottom">u1<hr/></td>
              <td align="center" valign="bottom">1<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom">ALD2<hr/></td>
              <td align="right" valign="bottom">2860<hr/></td>
              <td align="right" valign="bottom">2.25<hr/></td>
              <td align="center" valign="bottom">0<hr/></td>
              <td align="center" valign="bottom">0<hr/></td>
              <td align="center" valign="bottom">1<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom">CIT1<hr/></td>
              <td align="right" valign="bottom">2985<hr/></td>
              <td align="right" valign="bottom">2.72<hr/></td>
              <td align="center" valign="bottom">u1<hr/></td>
              <td align="center" valign="bottom">u1<hr/></td>
              <td align="center" valign="bottom">1<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom">ACO1<hr/></td>
              <td align="right" valign="bottom">2965<hr/></td>
              <td align="right" valign="bottom">2.63<hr/></td>
              <td align="center" valign="bottom">u1<hr/></td>
              <td align="center" valign="bottom">u1<hr/></td>
              <td align="center" valign="bottom">1<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom">IDH1,2<hr/></td>
              <td align="right" valign="bottom">3286<hr/></td>
              <td align="right" valign="bottom">1.49<hr/></td>
              <td align="center" valign="bottom">u1<hr/></td>
              <td align="center" valign="bottom">0<hr/></td>
              <td align="center" valign="bottom">1<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom">KGD1,2, LPD1<hr/></td>
              <td align="right" valign="bottom">3462<hr/></td>
              <td align="right" valign="bottom">2.17<hr/></td>
              <td align="center" valign="bottom">u1<hr/></td>
              <td align="center" valign="bottom">u1<hr/></td>
              <td align="center" valign="bottom">1<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom">LSC2<hr/></td>
              <td align="right" valign="bottom">3660<hr/></td>
              <td align="right" valign="bottom">0.71<hr/></td>
              <td align="center" valign="bottom">u1<hr/></td>
              <td align="center" valign="bottom">u1<hr/></td>
              <td align="center" valign="bottom">1<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom">SDH1,2,3,4<hr/></td>
              <td align="right" valign="bottom">3658<hr/></td>
              <td align="right" valign="bottom">2.53<hr/></td>
              <td align="center" valign="bottom">u1<hr/></td>
              <td align="center" valign="bottom">u1<hr/></td>
              <td align="center" valign="bottom">1<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom">FUM1<hr/></td>
              <td align="right" valign="bottom">3142<hr/></td>
              <td align="right" valign="bottom">1.89<hr/></td>
              <td align="center" valign="bottom">u1<hr/></td>
              <td align="center" valign="bottom">0<hr/></td>
              <td align="center" valign="bottom">1<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom">MDH1<hr/></td>
              <td align="right" valign="bottom">3346<hr/></td>
              <td align="right" valign="bottom">2.57<hr/></td>
              <td align="center" valign="bottom">u1<hr/></td>
              <td align="center" valign="bottom">u1<hr/></td>
              <td align="center" valign="bottom">1<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom">IDP2<hr/></td>
              <td align="right" valign="bottom">3287<hr/></td>
              <td align="right" valign="bottom">3.27<hr/></td>
              <td align="center" valign="bottom">u1<hr/></td>
              <td align="center" valign="bottom">u1<hr/></td>
              <td align="center" valign="bottom">1<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom">ICL1<hr/></td>
              <td align="right" valign="bottom">3290<hr/></td>
              <td align="right" valign="bottom">3.7<hr/></td>
              <td align="center" valign="bottom">u1<hr/></td>
              <td align="center" valign="bottom">u1<hr/></td>
              <td align="center" valign="bottom">1<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom">MLS1<hr/></td>
              <td align="right" valign="bottom">3349<hr/></td>
              <td align="right" valign="bottom">3.22<hr/></td>
              <td align="center" valign="bottom">u1<hr/></td>
              <td align="center" valign="bottom">u1<hr/></td>
              <td align="center" valign="bottom">1<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom">MDH2<hr/></td>
              <td align="right" valign="bottom">3345<hr/></td>
              <td align="right" valign="bottom">1.38<hr/></td>
              <td align="center" valign="bottom">u1<hr/></td>
              <td align="center" valign="bottom">0<hr/></td>
              <td align="center" valign="bottom">1<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom">
                <bold>GLY/GNG - TCA connection pathway</bold>
                <hr/>
              </td>
              <td align="right" valign="bottom"> <hr/></td>
              <td align="right" valign="bottom"> <hr/></td>
              <td align="center" valign="bottom"> <hr/></td>
              <td align="center" valign="bottom"> <hr/></td>
              <td> </td>
            </tr>
            <tr>
              <td align="left" valign="bottom">PFK1, PFK2<hr/></td>
              <td align="right" valign="bottom">3516<hr/></td>
              <td align="right" valign="bottom">-1.02<hr/></td>
              <td align="center" valign="bottom">d1<hr/></td>
              <td align="center" valign="bottom">0<hr/></td>
              <td align="center" valign="bottom">-1<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom">FBA1<hr/></td>
              <td align="right" valign="bottom">3010<hr/></td>
              <td align="right" valign="bottom">-1.25<hr/></td>
              <td align="center" valign="bottom">d1<hr/></td>
              <td align="center" valign="bottom">0<hr/></td>
              <td align="center" valign="bottom">-1<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom">TPI1<hr/></td>
              <td align="right" valign="bottom">3698<hr/></td>
              <td align="right" valign="bottom">-1.12<hr/></td>
              <td align="center" valign="bottom">d1<hr/></td>
              <td align="center" valign="bottom">0<hr/></td>
              <td align="center" valign="bottom">-1<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom">TDH1,2,3<hr/></td>
              <td align="right" valign="bottom">3182<hr/></td>
              <td align="right" valign="bottom">-0.55<hr/></td>
              <td align="center" valign="bottom">0<hr/></td>
              <td align="center" valign="bottom">0<hr/></td>
              <td align="center" valign="bottom">0<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom">PGK1<hr/></td>
              <td align="right" valign="bottom">3522<hr/></td>
              <td align="right" valign="bottom">-0.51<hr/></td>
              <td align="center" valign="bottom">0<hr/></td>
              <td align="center" valign="bottom">0<hr/></td>
              <td align="center" valign="bottom">0<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom">GPM1<hr/></td>
              <td align="right" valign="bottom">3523<hr/></td>
              <td align="right" valign="bottom">-1.72<hr/></td>
              <td align="center" valign="bottom">d1<hr/></td>
              <td align="center" valign="bottom">0<hr/></td>
              <td align="center" valign="bottom">-1<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom">ENO1,2<hr/></td>
              <td align="right" valign="bottom">3055<hr/></td>
              <td align="right" valign="bottom">-1.18<hr/></td>
              <td align="center" valign="bottom">d1<hr/></td>
              <td align="center" valign="bottom">0<hr/></td>
              <td align="center" valign="bottom">-1<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom">PDC1,5,6<hr/></td>
              <td align="right" valign="bottom">3595<hr/></td>
              <td align="right" valign="bottom">-1.91<hr/></td>
              <td align="center" valign="bottom">0<hr/></td>
              <td align="center" valign="bottom">d1<hr/></td>
              <td align="center" valign="bottom">-1<hr/></td>
            </tr>
            <tr>
              <td align="left">PYK1</td>
              <td align="right">3598</td>
              <td align="right">-1.81</td>
              <td align="center">d1</td>
              <td align="center">d1</td>
              <td align="center">-1</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <p>A list of genes in central carbon metabolism that are involved in the regulated response to diauxic shift (identified in [<xref ref-type="bibr" rid="B13">13</xref>]) and the reactions for which they encode enzymes, along with their inferred transcriptional changes (Value, mean log fold-change). ID represents ID of the relevant reaction node in the <monospace>ambient</monospace> network. The final three columns represent which genes and reactions are up- or down-regulated according to <monospace>ambient</monospace>, GiGA and [<xref ref-type="bibr" rid="B13">13</xref>] (expert curation). The <monospace>ambient</monospace> and GiGA columns indicate which modules the reactions are in and the the Identified Reactions column shows those curated manually. ‘Diff.’ stands for ‘differentially’.</p>
        </table-wrap-foot>
      </table-wrap>
      <table-wrap position="float" id="T3">
        <label>Table 3</label>
        <caption>
          <p>A statistical comparison of central carbon metabolism modules</p>
        </caption>
        <table frame="hsides" rules="groups" border="1">
          <colgroup>
            <col align="left"/>
            <col align="center"/>
            <col align="center"/>
          </colgroup>
          <thead valign="top">
            <tr>
              <th align="left"> </th>
              <th align="center">
                <monospace>
                  <bold>ambient</bold>
                </monospace>
              </th>
              <th align="center">
                <bold>GiGA</bold>
              </th>
            </tr>
          </thead>
          <tbody valign="top">
            <tr>
              <td align="left" valign="bottom">
                <bold>Glycolysis/Gluconeogenesis - top</bold>
                <hr/>
              </td>
              <td align="center" valign="bottom"> <hr/></td>
              <td align="center" valign="bottom"> <hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom">Module<hr/></td>
              <td align="center" valign="bottom">u2<hr/></td>
              <td align="center" valign="bottom">u2<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom">Recall<hr/></td>
              <td align="center" valign="bottom">.67<hr/></td>
              <td align="center" valign="bottom">.89<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom">Precision<hr/></td>
              <td align="center" valign="bottom">.33<hr/></td>
              <td align="center" valign="bottom">.23<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom">F-measure<hr/></td>
              <td align="center" valign="bottom">.44<hr/></td>
              <td align="center" valign="bottom">.36<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom">
                <bold>TCA Cycle</bold>
                <hr/>
              </td>
              <td align="center" valign="bottom"> <hr/></td>
              <td align="center" valign="bottom"> <hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom">Module<hr/></td>
              <td align="center" valign="bottom">u1<hr/></td>
              <td align="center" valign="bottom">u1<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom">Recall<hr/></td>
              <td align="center" valign="bottom">.94<hr/></td>
              <td align="center" valign="bottom">.63<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom">Precision<hr/></td>
              <td align="center" valign="bottom">.19<hr/></td>
              <td align="center" valign="bottom">.13<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom">F-measure<hr/></td>
              <td align="center" valign="bottom">.32<hr/></td>
              <td align="center" valign="bottom">.22<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom">
                <bold>GLY/GLN - TCA connection pathway</bold>
                <hr/>
              </td>
              <td align="center" valign="bottom"> <hr/></td>
              <td align="center" valign="bottom"> <hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom">Module<hr/></td>
              <td align="center" valign="bottom">d1<hr/></td>
              <td align="center" valign="bottom">d1<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom">Recall<hr/></td>
              <td align="center" valign="bottom">.86<hr/></td>
              <td align="center" valign="bottom">.29<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom">Precision<hr/></td>
              <td align="center" valign="bottom">.03<hr/></td>
              <td align="center" valign="bottom">.05<hr/></td>
            </tr>
            <tr>
              <td align="left">F-measure</td>
              <td align="center">.05</td>
              <td align="center">.09</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <p>Values of recall, precision and F-measure for the comparison between the two computational inference methods for metabolic modules and the expert curation of DeRisi et al. [<xref ref-type="bibr" rid="B13">13</xref>]. The modules containing the relevant parts of metabolism for each computational method are indicated on the table, where ‘u’ and ‘d’ represent up- and down-regulated modules and the number corresponds to the numbers of the modules found in order of significance by the two methods. Diagrams for these can be found in the Additional file <xref ref-type="supplementary-material" rid="S2">2</xref> except <monospace>ambient</monospace> u1, which can be seen in Figure <xref ref-type="fig" rid="F2">2</xref>.</p>
        </table-wrap-foot>
      </table-wrap>
    </sec>
    <sec>
      <title>Additional insights from <monospace><bold>ambient</bold></monospace></title>
      <p>In addition to finding the important parts of metabolism discovered by previous methods, <monospace>ambient</monospace> finds several linked but previously undiscovered pathways which add to our appreciation of the full metabolic response of <italic>S. cerevisiae</italic> to glucose depletion and diauxic shift. It is clear from the upregulated modules (Figure <xref ref-type="fig" rid="F2">2</xref> - module u1, Additional file <xref ref-type="supplementary-material" rid="S2">2</xref>: Figure S1 - modules u2 to u4) that <monospace>ambient</monospace> finds the important changes in the TCA cycle and respiratory chain complexes discovered previously by GiGA. Additional file <xref ref-type="supplementary-material" rid="S2">2</xref>: Figures S1-4 show the parts of metabolism identified by <monospace>ambient</monospace> that connect to and between the GiGA modules found and the overlap between <monospace>ambient</monospace> and GiGA pathways. There are several pathways picked out by <monospace>ambient</monospace> that show some expression change and link between the metabolic pathways that have already been identified by others [<xref ref-type="bibr" rid="B3">3</xref>,<xref ref-type="bibr" rid="B13">13</xref>] to change on diauxic shift in yeast. This indicates a larger scale coherent metabolic response than has previously been recognised.</p>
      <p><monospace>ambient</monospace> identifies a further pathway linking mitochondrial oxaloacetate to succinate (central orange pathway in Figure <xref ref-type="fig" rid="F2">2</xref>, outlined in red) which forms part of the 2-methylcitrate cycle, converting propionate to pyruvate. Additional file <xref ref-type="supplementary-material" rid="S2">2</xref>: Figure S1A shows that in addition to the glycogen metabolic pathways, galactose metabolic pathways are also activated. S-Adenosyl-L-methionine is important for DNA methylation and although <italic>S. cerevisiae</italic> has little methylation in its regulation, Figure <xref ref-type="fig" rid="F2">2</xref> shows that metabolism around this chemical is activated on diauxic shift (outlined in blue). Malate and oxaloacetate metabolism also show a coordinated increase (outlined in pink). Overall, these results show that there is a considerable response to glucose starvation in yeast, and <monospace>ambient</monospace> has found modules that extend beyond the boundaries of conventionally accepted pathways.</p>
    </sec>
    <sec>
      <title>Differences between <monospace><bold>ambient</bold></monospace> and GiGA</title>
      <p>It can be seen that there is a large overlap between the results of the two algorithms compared here, however the <monospace>ambient</monospace> algorithm has found some additional changed reactions that appear to be part of the coordinated response of <italic>S. cerevisiae</italic> to glucose starvation. GiGA identifies some reactions that are not in significant <monospace>ambient</monospace> modules. In the upregulated results it finds many transport reactions, though these are mostly disconnected from the rest of the GiGA modules, so do not appear to be parts of coordinated pathways at the transcriptomic level. The cytosolic pentose phosphate pathway is identified by GiGA (Additional file <xref ref-type="supplementary-material" rid="S2">2</xref>: Figure S3B) as being up-regulated, which indicates a potential limitation of <monospace>ambient</monospace>’s pathfinding ability, though being a small part of a larger metabolically disconnected module the significance of the transcriptional change of that part by itself is not known. This is also true of the top down-regulated module identified by GiGA (Additional file <xref ref-type="supplementary-material" rid="S2">2</xref>: Figure S4A) which contains several small pathways absent from <monospace>ambient</monospace>, but for which there are not individual significance values.</p>
      <p>The use of metabolite information is important in metabolic network analysis. Highly connected metabolites have limited utility for constructing modules of coordinated responses to metabolic and environmental perturbations because they carry little information about the flow of material through the metabolic network. It can therefore be asserted that for the purposes of pathfinding, links in metabolic modules through more highly connected metabolites are less significant than those through metabolites connected to fewer reactions. GiGA deals with this problem by excluding a predefined set of currency metabolites, whilst in <monospace>ambient</monospace> the relative weights in the metabolic network are taken explicitly into account. In the analysis presented here, the two approaches appear to be somewhat equivalent, as the highest degree metabolite node in the <monospace>ambient</monospace> results has a degree of 19.</p>
      <p>The advantage of mapping gene scores onto reactions and finding reaction-metabolite modules rather than protein-protein modules is apparent when looking at the relationship between reactions and genes. Approximately half of all genes in the yeast model are associated with more than one reaction, and some are associated with many reactions. For instance, gene YKR009C (FOX2) which is present in GiGA module 3 encodes a multifunctional enzyme associated with 29 reactions in the yeast model. Using GiGA (or any analysis method relying on a gene- or protein-centric representation of metabolism) will fail to distinguish between potentially very different reactions catalysed by such multifunctional proteins and will infer either all or none of them as parts of a metabolic module. This approach will therefore always lack the specificity inherent in the reaction-metabolite bipartite network representation of metabolism and results in unconnected ‘modules’, as seen in Additional file <xref ref-type="supplementary-material" rid="S2">2</xref>: Figures S3-4. A number of the reactions associated with YKR009C are in modules returned by the <monospace>ambient</monospace> analysis, but none of these modules are statistically significant.</p>
      <p>Another important advance in <monospace>ambient</monospace> over previous approaches to module-finding is that it encourages larger modules to form which might otherwise be hidden due to individual interconnecting low-scoring (or negative scoring) nodes or due to missing experimental data. This advantage, inherited from the simulated annealing approach, means that a fuller picture of how metabolic responses are coordinated can appear from the same data used in previous approaches, as can be seen in the good coverage of previously known and newly discovered affected parts of metabolism shown in Figure <xref ref-type="fig" rid="F2">2</xref>.</p>
      <p>Against these advantages, it should be noted that the GiGA approach is much faster than <monospace>ambient</monospace> in this case study, taking approximately 30 seconds on a 2.4 GHz chip, as opposed to <monospace>ambient</monospace>’s two hours.</p>
    </sec>
    <sec>
      <title>Consistency between <monospace><bold>ambient</bold></monospace> runs</title>
      <p>Since <monospace>ambient</monospace> is not a deterministic algorithm, it arrives at slightly different solutions each time it is run. <monospace>ambient</monospace> was run ten times with the settings and data described above and the the consistency of the results was assessed. Each run produces what is in effect a partition of the set of all nodes, with each partition being a significant module, except the largest partition which consists of all nodes not in significant modules. The Adjusted Rand index [<xref ref-type="bibr" rid="B15">15</xref>] was used to quantify the similarity of results. The ten runs compared with each other produced an Adjusted Rand value of 0.71±0.07, indicating highly consistent results between runs, despite the stochastic nature of the algorithm.</p>
    </sec>
    <sec>
      <title>Limits to the discovery potential of <monospace><bold>ambient</bold></monospace></title>
      <p>While <monospace>ambient</monospace> is very effective for elucidating metabolic changes from transcriptomic datasets it does have several limitations that should be borne in mind. Firstly it does not in any way take into account regulation except in as much as the regulation is apparent in the changes of transcription levels of genes encoding enzymes. Secondly, as with all other current methods for mapping transcription onto metabolic networks, if genes with enzymatic products are not mapped onto the metabolic network then information about their changes cannot be used to investigate the changes in metabolism. Due to this inability, <monospace>ambient</monospace> does not extract all of the information possible from transcriptomic data, but just the information from genes with known functions. The elucidation of metabolic functions for uncharacterised genes would therefore require a different approach.</p>
      <p>The best way to interpret transcriptomic changes in terms of their effect on reaction rates is an open question. With the approach to reaction scoring presented here, mismapping between mRNAs (transcripts) and reactions could impact on the effectiveness of <monospace>ambient</monospace>. Also the best way in which transcript values are combined for each reaction is not known. If some knowledge of the relative activity of various enzymes for each reaction were integrated into this approach a more refined way of combining enzyme inferred changes could be used to score each reaction. Despite these potential limitations <monospace>ambient</monospace> has recapitulated the results produced by a very different computational approach and by expert curation of the same data used here, so some confidence can be drawn concerning the scoring system presented here.</p>
    </sec>
    <sec>
      <title>Potential applications and future developments</title>
      <p><monospace>ambient</monospace> has been applied here to transcriptional data looking at yeast diauxic shift. This approach is of course applicable to any dataset containing two (or more) microarray measurements in differing conditions. However, due to the information now available in many metabolic models, and the use of a bipartite representation of metabolism, any information that can be mapped to genes, enzymes, reactions or metabolites can be included in an <monospace>ambient</monospace> analysis. The explicit links available between genes, proteins and reactions means that transcriptomic (as shown here), proteomic or fluxomic data could be mapped onto the metabolic network under study. Furthermore, metabolites were scored here purely by weight in the metabolic network, but if metabolomic information were available this could easily be incorporated into the scoring system.</p>
      <p>In order to look at the overall changes in yeast diauxic shift, the scores for reactions were left as mean log fold-changes of gene transcription. In order to further dissect any transcriptomic dataset, it would be possible to set the median reaction score to zero, therefore just search for especially up- and down-regulated pathways.</p>
      <p>Future developments will include methods for combining several different datasets into a single module-finding problem. Since the metabolic models used for this analysis can also be used in flux balance analysis (FBA), methods to combine computational flux estimates obtained from FBA with experimental data will be of particular interest in order to extend and refine our understanding of metabolic network function.</p>
    </sec>
  </sec>
  <sec sec-type="conclusions">
    <title>Conclusions</title>
    <p>In this paper we have presented <monospace>ambient</monospace>, a method for finding metabolic modules that represent coordinated metabolic differences between two environments or conditions. Using simulated annealing, <monospace>ambient</monospace> can go beyond previous approaches to the system level analysis of metabolic changes, as demonstrated here using transcriptomic data from a yeast glucose runout experiment. The bipartite representation of metabolism allows a much greater specificity of analysis and can incorporate information about metabolites, giving an objective view of the changes in cells during the diauxic shift.</p>
    <p>This approach has the potential to integrate many different types of high-throughput data obtained in a single experiment. It is hoped that <monospace>ambient</monospace> will enable the analysis of disparate data that would otherwise be difficult to integrate, thus improving the biological understanding accessible using high-throughput experimental techniques.</p>
  </sec>
  <sec>
    <title>Competing interests</title>
    <p>The authors declare that they have no competing interests.</p>
  </sec>
  <sec>
    <title>Authors’ contributions</title>
    <p>JP and MS conceived the project, WB and JP developed the tool and WB wrote the manuscript. All authors read and approved the final manuscript.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="S1">
      <caption>
        <title>Additional file 1</title>
        <p><bold>Supplementary Methods.</bold> Further details on the <monospace>ambient</monospace> algorithm and scoring system.</p>
      </caption>
      <media xlink:href="1752-0509-7-26-S1.pdf">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="S2">
      <caption>
        <title>Additional file 2</title>
        <p><bold>Supplementary Figures.</bold> Figures S1-S4: diagrams of the positive and negative modules found by both <monospace>ambient</monospace> and GiGA.</p>
      </caption>
      <media xlink:href="1752-0509-7-26-S2.pdf">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <sec>
    <title>Acknowledgements</title>
    <p>This work was supported by the BBSRC, grant BB/G020434/1. JP is supported by a University Research Fellowship from the Royal Society.</p>
  </sec>
  <ref-list>
    <ref id="B1">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Mootha</surname>
          <given-names>VK</given-names>
        </name>
        <name>
          <surname>Lindgren</surname>
          <given-names>CM</given-names>
        </name>
        <name>
          <surname>Eriksson</surname>
          <given-names>KF</given-names>
        </name>
        <name>
          <surname>Subramanian</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Sihag</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Lehar</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Puigserver</surname>
          <given-names>P</given-names>
        </name>
        <name>
          <surname>Carlsson</surname>
          <given-names>E</given-names>
        </name>
        <name>
          <surname>Ridderstråle</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Laurila</surname>
          <given-names>E</given-names>
        </name>
        <name>
          <surname>Houstis</surname>
          <given-names>N</given-names>
        </name>
        <name>
          <surname>Daly</surname>
          <given-names>MJ</given-names>
        </name>
        <name>
          <surname>Patterson</surname>
          <given-names>N</given-names>
        </name>
        <name>
          <surname>Mesirov</surname>
          <given-names>JP</given-names>
        </name>
        <name>
          <surname>Golub</surname>
          <given-names>TR</given-names>
        </name>
        <name>
          <surname>Tamayo</surname>
          <given-names>P</given-names>
        </name>
        <name>
          <surname>Spiegelman</surname>
          <given-names>B</given-names>
        </name>
        <name>
          <surname>Lander</surname>
          <given-names>ES</given-names>
        </name>
        <name>
          <surname>Hirschhorn</surname>
          <given-names>JN</given-names>
        </name>
        <name>
          <surname>Altshuler</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Groop</surname>
          <given-names>LC</given-names>
        </name>
        <article-title>PGC-1alpha-responsive genes involved in oxidative phosphorylation are coordinately downregulated in human diabetes</article-title>
        <source>Nat Genet</source>
        <year>2003</year>
        <volume>34</volume>
        <issue>3</issue>
        <fpage>267</fpage>
        <lpage>273</lpage>
        <pub-id pub-id-type="doi">10.1038/ng1180</pub-id>
        <?supplied-pmid 12808457?>
        <pub-id pub-id-type="pmid">12808457</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B2">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Ideker</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Ozier</surname>
          <given-names>O</given-names>
        </name>
        <name>
          <surname>Schwikowski</surname>
          <given-names>B</given-names>
        </name>
        <name>
          <surname>Siegel</surname>
          <given-names>AF</given-names>
        </name>
        <article-title>Discovering regulatory and signalling circuits in molecular interaction networks</article-title>
        <source>Bioinformatics</source>
        <year>2002</year>
        <volume>18</volume>
        <issue>Suppl 1</issue>
        <fpage>S233—S240</fpage>
        <?supplied-pmid 12169552?>
        <pub-id pub-id-type="pmid">12169552</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B3">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Breitling</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Amtmann</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Herzyk</surname>
          <given-names>P</given-names>
        </name>
        <article-title>Graph-based iterative group analysis enhances microarray interpretation</article-title>
        <source>BMC Bioinformatics</source>
        <year>2004</year>
        <volume>5</volume>
        <fpage>100</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-5-100</pub-id>
        <?supplied-pmid 15272936?>
        <pub-id pub-id-type="pmid">15272936</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B4">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Goffard</surname>
          <given-names>N</given-names>
        </name>
        <name>
          <surname>Frickey</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Weiller</surname>
          <given-names>G</given-names>
        </name>
        <article-title>PathExpress update: the enzyme neighbourhood method of associating gene-expression data with metabolic pathways</article-title>
        <source>Nucleic Acids Res</source>
        <year>2009</year>
        <volume>37</volume>
        <issue>Web Server</issue>
        <fpage>W335—W339</fpage>
        <?supplied-pmid 19474337?>
        <pub-id pub-id-type="pmid">19474337</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B5">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Antonov</surname>
          <given-names>AV</given-names>
        </name>
        <name>
          <surname>Dietmann</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Mewes</surname>
          <given-names>HW</given-names>
        </name>
        <article-title>KEGG spider: interpretation of genomics data in the context of the global gene metabolic network</article-title>
        <source>Genome Biol</source>
        <year>2008</year>
        <volume>9</volume>
        <issue>12</issue>
        <fpage>R179</fpage>
        <pub-id pub-id-type="doi">10.1186/gb-2008-9-12-r179</pub-id>
        <?supplied-pmid 19094223?>
        <pub-id pub-id-type="pmid">19094223</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B6">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Schramm</surname>
          <given-names>G</given-names>
        </name>
        <name>
          <surname>Wiesberg</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Diessl</surname>
          <given-names>N</given-names>
        </name>
        <name>
          <surname>Kranz</surname>
          <given-names>AL</given-names>
        </name>
        <name>
          <surname>Sagulenko</surname>
          <given-names>V</given-names>
        </name>
        <name>
          <surname>Oswald</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Reinelt</surname>
          <given-names>G</given-names>
        </name>
        <name>
          <surname>Westermann</surname>
          <given-names>F</given-names>
        </name>
        <name>
          <surname>Eils</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>König</surname>
          <given-names>R</given-names>
        </name>
        <article-title>PathWave: discovering patterns of differentially regulated enzymes in metabolic pathways</article-title>
        <source>Bioinformatics</source>
        <year>2010</year>
        <volume>26</volume>
        <issue>9</issue>
        <fpage>1225</fpage>
        <lpage>1231</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btq113</pub-id>
        <?supplied-pmid 20335275?>
        <pub-id pub-id-type="pmid">20335275</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B7">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Feist</surname>
          <given-names>AM</given-names>
        </name>
        <name>
          <surname>Henry</surname>
          <given-names>CS</given-names>
        </name>
        <name>
          <surname>Reed</surname>
          <given-names>JL</given-names>
        </name>
        <name>
          <surname>Krummenacker</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Joyce</surname>
          <given-names>AR</given-names>
        </name>
        <name>
          <surname>Karp</surname>
          <given-names>PD</given-names>
        </name>
        <name>
          <surname>Broadbelt</surname>
          <given-names>LJ</given-names>
        </name>
        <name>
          <surname>Hatzimanikatis</surname>
          <given-names>V</given-names>
        </name>
        <name>
          <surname>Palsson</surname>
          <given-names>BØ</given-names>
        </name>
        <article-title>A genome-scale metabolic reconstruction for Escherichia coli K-12 MG1655 that accounts for 1260 ORFs and thermodynamic information</article-title>
        <source>Mol Syst Biol</source>
        <year>2007</year>
        <volume>3</volume>
        <fpage>121</fpage>
        <?supplied-pmid 17593909?>
        <pub-id pub-id-type="pmid">17593909</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B8">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Kanehisa</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Goto</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Sato</surname>
          <given-names>Y</given-names>
        </name>
        <name>
          <surname>Furumichi</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Tanabe</surname>
          <given-names>M</given-names>
        </name>
        <article-title>KEGG for integration and interpretation of large-scale molecular data sets</article-title>
        <source>Nucleic Acids Res</source>
        <year>2012</year>
        <volume>40</volume>
        <issue>Database issue</issue>
        <fpage>D109—D114</fpage>
        <?supplied-pmid 22080510?>
        <pub-id pub-id-type="pmid">22080510</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B9">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Caspi</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Foerster</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>Fulcher</surname>
          <given-names>CA</given-names>
        </name>
        <name>
          <surname>Kaipa</surname>
          <given-names>P</given-names>
        </name>
        <article-title>The MetaCyc database of metabolic pathways and enzymes and the BioCyc collection of pathway/genome databases</article-title>
        <source>Nucleic Acids Res</source>
        <year>2008</year>
        <volume>36</volume>
        <issue>Database issue</issue>
        <fpage>D623—D631</fpage>
        <?supplied-pmid 17965431?>
        <pub-id pub-id-type="pmid">17965431</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B10">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Henry</surname>
          <given-names>CS</given-names>
        </name>
        <name>
          <surname>DeJongh</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Best</surname>
          <given-names>AA</given-names>
        </name>
        <name>
          <surname>Frybarger</surname>
          <given-names>PM</given-names>
        </name>
        <name>
          <surname>Linsay</surname>
          <given-names>B</given-names>
        </name>
        <name>
          <surname>Stevens</surname>
          <given-names>RL</given-names>
        </name>
        <article-title>High-throughput generation, optimization and analysis of genome-scale metabolic models</article-title>
        <source>Nat Biotechnol</source>
        <year>2010</year>
        <volume>28</volume>
        <issue>9</issue>
        <fpage>969</fpage>
        <lpage>974</lpage>
      </mixed-citation>
    </ref>
    <ref id="B11">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Croes</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Couche</surname>
          <given-names>F</given-names>
        </name>
        <name>
          <surname>Wodak</surname>
          <given-names>SJ</given-names>
        </name>
        <name>
          <surname>van Helden</surname>
          <given-names>J</given-names>
        </name>
        <article-title>Inferring meaningful pathways in weighted metabolic networks</article-title>
        <source>J Mol Biol</source>
        <year>2006</year>
        <volume>356</volume>
        <fpage>222</fpage>
        <lpage>236</lpage>
        <pub-id pub-id-type="doi">10.1016/j.jmb.2005.09.079</pub-id>
        <?supplied-pmid 16337962?>
        <pub-id pub-id-type="pmid">16337962</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B12">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Smoot</surname>
          <given-names>ME</given-names>
        </name>
        <name>
          <surname>Ono</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Ruscheinski</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Wang</surname>
          <given-names>PL</given-names>
        </name>
        <name>
          <surname>Ideker</surname>
          <given-names>T</given-names>
        </name>
        <article-title>Cytoscape 2.8: new features for data integration and network visualization</article-title>
        <source>Bioinformatics</source>
        <year>2011</year>
        <volume>27</volume>
        <issue>3</issue>
        <fpage>431</fpage>
        <lpage>432</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btq675</pub-id>
        <?supplied-pmid 21149340?>
        <pub-id pub-id-type="pmid">21149340</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B13">
      <mixed-citation publication-type="journal">
        <name>
          <surname>DeRisi</surname>
          <given-names>JL</given-names>
        </name>
        <article-title>Exploring the metabolic and genetic control of gene expression on a genomic scale</article-title>
        <source>Science</source>
        <year>1997</year>
        <volume>278</volume>
        <issue>5338</issue>
        <fpage>680</fpage>
        <lpage>686</lpage>
        <pub-id pub-id-type="doi">10.1126/science.278.5338.680</pub-id>
        <?supplied-pmid 9381177?>
        <pub-id pub-id-type="pmid">9381177</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B14">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Herrgård</surname>
          <given-names>MJ</given-names>
        </name>
        <name>
          <surname>Swainston</surname>
          <given-names>N</given-names>
        </name>
        <name>
          <surname>Dobson</surname>
          <given-names>P</given-names>
        </name>
        <name>
          <surname>Dunn</surname>
          <given-names>WB</given-names>
        </name>
        <name>
          <surname>Arga</surname>
          <given-names>KY</given-names>
        </name>
        <name>
          <surname>Arvas</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Blüthgen</surname>
          <given-names>N</given-names>
        </name>
        <name>
          <surname>Borger</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Costenoble</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Heinemann</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Hucka</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Le Novère</surname>
          <given-names>N</given-names>
        </name>
        <name>
          <surname>Li</surname>
          <given-names>P</given-names>
        </name>
        <name>
          <surname>Liebermeister</surname>
          <given-names>W</given-names>
        </name>
        <name>
          <surname>Mo</surname>
          <given-names>ML</given-names>
        </name>
        <name>
          <surname>Oliveira</surname>
          <given-names>AP</given-names>
        </name>
        <name>
          <surname>Petranovic</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Pettifer</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Simeonidis</surname>
          <given-names>E</given-names>
        </name>
        <name>
          <surname>Smallbone</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Weichart</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Brent</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Broomhead</surname>
          <given-names>DS</given-names>
        </name>
        <name>
          <surname>Westerhoff</surname>
          <given-names>HV</given-names>
        </name>
        <name>
          <surname>Kirdar</surname>
          <given-names>B</given-names>
        </name>
        <name>
          <surname>Klipp</surname>
          <given-names>E</given-names>
        </name>
        <name>
          <surname>Palsson BØ</surname>
          <given-names>Sauer</given-names>
          <suffix>U</suffix>
        </name>
        <name>
          <surname>Oliver</surname>
          <given-names>SG</given-names>
        </name>
        <name>
          <surname>Mendes</surname>
          <given-names>P</given-names>
        </name>
        <name>
          <surname>Nielsen</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Kell</surname>
          <given-names>DB</given-names>
        </name>
        <collab>Spasić I</collab>
        <article-title>A consensus yeast metabolic network reconstruction obtained from a community approach to systems biology</article-title>
        <source>Nat Biotechnol</source>
        <year>2008</year>
        <volume>26</volume>
        <issue>10</issue>
        <fpage>1155</fpage>
        <lpage>1160</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt1492</pub-id>
        <?supplied-pmid 18846089?>
        <pub-id pub-id-type="pmid">18846089</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B15">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Hubert</surname>
          <given-names>L</given-names>
        </name>
        <name>
          <surname>Arabie</surname>
          <given-names>P</given-names>
        </name>
        <article-title>Comparing partitions</article-title>
        <source>J Classif</source>
        <year>1985</year>
        <volume>2</volume>
        <fpage>193</fpage>
        <lpage>218</lpage>
        <pub-id pub-id-type="doi">10.1007/BF01908075</pub-id>
      </mixed-citation>
    </ref>
  </ref-list>
</back>
