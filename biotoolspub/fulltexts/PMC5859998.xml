<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-id journal-id-type="hwp">bioinfo</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">5859998</article-id>
    <article-id pub-id-type="pmid">26454273</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btv589</article-id>
    <article-id pub-id-type="publisher-id">btv589</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Notes</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Sequence Analysis</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Jflow: a workflow management system for web applications</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Mariette</surname>
          <given-names>Jérôme</given-names>
        </name>
        <xref ref-type="aff" rid="btv589-AFF1">1</xref>
        <xref ref-type="corresp" rid="btv589-COR1">*</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Escudié</surname>
          <given-names>Frédéric</given-names>
        </name>
        <xref ref-type="aff" rid="btv589-AFF1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Bardou</surname>
          <given-names>Philippe</given-names>
        </name>
        <xref ref-type="aff" rid="btv589-AFF2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Nabihoudine</surname>
          <given-names>Ibouniyamine</given-names>
        </name>
        <xref ref-type="aff" rid="btv589-AFF1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Noirot</surname>
          <given-names>Céline</given-names>
        </name>
        <xref ref-type="aff" rid="btv589-AFF1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Trotard</surname>
          <given-names>Marie-Stéphane</given-names>
        </name>
        <xref ref-type="aff" rid="btv589-AFF1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Gaspin</surname>
          <given-names>Christine</given-names>
        </name>
        <xref ref-type="aff" rid="btv589-AFF1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Klopp</surname>
          <given-names>Christophe</given-names>
        </name>
        <xref ref-type="aff" rid="btv589-AFF1">1</xref>
        <xref ref-type="aff" rid="btv589-AFF2">2</xref>
      </contrib>
    </contrib-group>
    <aff id="btv589-AFF1"><label><sup>1</sup></label>Plate-forme Bio-informatique Genotoul, INRA, UR875 Mathmatiques et Informatique Appliques Toulouse, Castanet-Tolosan, France and </aff>
    <aff id="btv589-AFF2"><label><sup>2</sup></label>Plate-forme SIGENAE, INRA, GenPhyse, Castanet-Tolosan Cedex, France</aff>
    <author-notes>
      <corresp id="btv589-COR1">*To whom correspondence should be addressed.</corresp>
      <fn id="FN1">
        <p>Associate Editor: John Hancock</p>
      </fn>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>01</day>
      <month>2</month>
      <year>2016</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2015-10-10">
      <day>10</day>
      <month>10</month>
      <year>2015</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>10</day>
      <month>10</month>
      <year>2015</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. -->
    <volume>32</volume>
    <issue>3</issue>
    <fpage>456</fpage>
    <lpage>458</lpage>
    <history>
      <date date-type="received">
        <day>30</day>
        <month>6</month>
        <year>2015</year>
      </date>
      <date date-type="rev-recd">
        <day>2</day>
        <month>10</month>
        <year>2015</year>
      </date>
      <date date-type="accepted">
        <day>7</day>
        <month>10</month>
        <year>2015</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author 2015. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2015</copyright-year>
      <license license-type="cc-by-nc" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/">http://creativecommons.org/licenses/by-nc/4.0/</ext-link>), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.com</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btv589.pdf"/>
    <abstract>
      <title>Abstract</title>
      <p><bold>Summary:</bold> Biologists produce large data sets and are in demand of rich and simple web portals in which they can upload and analyze their files. Providing such tools requires to mask the complexity induced by the needed High Performance Computing (HPC) environment. The connection between interface and computing infrastructure is usually specific to each portal. With Jflow, we introduce a Workflow Management System (WMS), composed of jQuery plug-ins which can easily be embedded in any web application and a Python library providing all requested features to setup, run and monitor workflows.</p>
      <p><bold>Availability and implementation:</bold> Jflow is available under the GNU General Public License (GPL) at <ext-link ext-link-type="uri" xlink:href="http://bioinfo.genotoul.fr/jflow">http://bioinfo.genotoul.fr/jflow</ext-link>. The package is coming with full documentation, quick start and a running test portal.</p>
      <p>
        <bold>Contact:</bold>
        <email>Jerome.Mariette@toulouse.inra.fr</email>
      </p>
    </abstract>
    <counts>
      <page-count count="3"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Building rich web environments aimed at helping scientists analyze their data is a common trend in bioinformatics. Specialized web portals such as MG-RAST (<xref rid="btv589-B10" ref-type="bibr">Meyer <italic>et al</italic>., 2008</xref>), MetaVir (<xref rid="btv589-B12" ref-type="bibr">Roux <italic>et al</italic>., 2011</xref>) or NG6 (<xref rid="btv589-B8" ref-type="bibr">Mariette <italic>et al</italic>., 2012</xref>) provide multiple services and analysis tools in an integrated manner for specific experiments or data types. These applications require WMS features to manage and execute their computational pipelines.</p>
    <p>Generic WMS, such as Galaxy (<xref rid="btv589-B4" ref-type="bibr">Goecks <italic>et al</italic>., 2010</xref>), Ergatis (<xref rid="btv589-B11" ref-type="bibr">Orvis <italic>et al</italic>., 2010</xref>) or Mobyle (<xref rid="btv589-B13" ref-type="bibr">Néron <italic>et al</italic>., 2009</xref>) provide a user friendly graphical interface easing workflow creation and execution. Unfortunately, such environments come with their own interface, complicating their integration within already existing web tools. Other WMS such as weaver (<xref rid="btv589-B2" ref-type="bibr">Bui <italic>et al</italic>., 2012</xref>), Snakemake (<xref rid="btv589-B6" ref-type="bibr">Koster <italic>et al</italic>., 2012</xref>), Ruffus (<xref rid="btv589-B5" ref-type="bibr">Goodstadt, 2010</xref>) or Cosmos (<xref rid="btv589-B3" ref-type="bibr">Gafni <italic>et al</italic>., 2014</xref>) provide a framework or a domain-specific language to developers wanting to build and run workflows. These software packages offer the flexibility and power of a high-level programming language, but they do not provide a user interface, enable component and workflow definition.</p>
    <p>JFlow combines a user friendly interface with an intuitive python API. It is, to our knowledge, the only WMS designed to be embedded in any web application, thanks to its organization as jQuery (<ext-link ext-link-type="uri" xlink:href="http://jquery.com/">http://jquery.com/</ext-link>) plug-ins.</p>
  </sec>
  <sec>
    <title>2 Methods</title>
    <p>Jflow user interface gathers five jQuery plug-ins providing user oriented views.
</p>
    <list list-type="bullet">
      <list-item>
        <p><italic>availablewf</italic> lists all runnable workflows accessible to users,</p>
      </list-item>
      <list-item>
        <p><italic>activewf</italic> monitors all started, completed, failed, aborted and reseted workflows,</p>
      </list-item>
      <list-item>
        <p><italic>wfform</italic> presents workflow editable parameters in a form,</p>
      </list-item>
      <list-item>
        <p><italic>wfoutputs</italic> displays all outputs produced by the workflow organized per component,</p>
      </list-item>
      <list-item>
        <p><italic>wfstatus</italic> shows the workflow execution state as a list or an execution graph. The graph visualization uses the Cytoscape web JavaScript plug-in (<xref rid="btv589-B7" ref-type="bibr">Lopes <italic>et al</italic>., 2010</xref>).</p>
      </list-item>
    </list>
    <p>The plug-ins give access to multiple communication methods and events. They interact with the server side through Jflow’s REST API, running under a cherrypy (<ext-link ext-link-type="uri" xlink:href="http://www.cherrypy.org/">http://www.cherrypy.org/</ext-link>) web server. The included server uses the JSONP communication technique enabling cross-domain requests.</p>
    <p>To be available from the different jQuery plug-ins, the workflows have to be implemented using the Jflow API. A Jflow component is in charge of an execution step. Adding a component to the system requires to write a Python <italic>Component</italic> subclass. In Jflow, different solutions are available to ease component creation. To wrap a single command line, the developer can give a position or a flag for each parameter. Jflow also embeds an XML parser which allows to run genuine Mobyle (<xref rid="btv589-B13" ref-type="bibr">Néron <italic>et al</italic>., 2009</xref>) components. Finally, to allow developers to integrate components from other WMS, Jflow provides a skeleton class. This class only requires to implement the parsing step. A workflow chains components. It is represented by a directed acyclic graph (DAG) where nodes represent jobs and edges links between inputs and outputs. When paths are disjoint, jobs are run in parallel. A Jflow workflow is built as a <italic>Workflow</italic> subclass. Components are added to the workflow as variables and chained linking outputs and inputs.</p>
    <p>To define the parameters presented to the final user, Jflow gives access to different class methods. Each parameter has at least a name, a user help text and a data type. For file or directory parameters, it is possible to set required file format, size limitation and location. Jflow handles server side files with regular expressions, but also URLs and client side files, in which case, it automatically uploads them. Before running the workflow, Jflow checks data type compliance for each parameter. Job submission, status checking and error handling, rely on Makeflow (<xref rid="btv589-B1" ref-type="bibr">Albrecht <italic>et al</italic>., 2012</xref>) and weaver (<xref rid="btv589-B2" ref-type="bibr">Bui <italic>et al</italic>., 2012</xref>). Therefore Jflow manages error recovery and supports most distributed resource management systems (Condor, SGE, Work Queue or a single multi core machine, …). Replacing Makeflow by an other job submitter requires to implement a new <italic>Engine</italic> subclass. This class creates and executes the workflow DAG.</p>
  </sec>
  <sec>
    <title>3 Example</title>
    <p>Jflow user interface has been designed to allow an easy integration in mash up web applications. Hereunder, we present its integration in NG6, which provides a user-friendly interface to process, store and download high-throughput sequencing data. The environment displays sequencing runs as a table. From this view, the user can add new data by running workflows in charge of loading the data and checking its quality. Different workflows are available considering data type and sequencing technology.</p>
    <p>Workflows are listed by the <italic>availablewf</italic> plug-in built within a NG6 modal box. A <italic>select.availablewf</italic> event thrown by the <italic>availablewf</italic> plug-in is listened and caught to generate the parameter form using the <italic>wfform</italic> plug-in. Considering the parameter type, Jflow adapts its display. For example, a date is shown as a calendar and a boolean as a check box.</p>
    <p>Biologists use NG6 to check sequencing reads quality, including experimental samples contamination measure. The first input of this analysis is the contaminant reference genome fasta file, displayed as a file selector. The second input is a parameter set describing the biological samples. It includes the read files and metadata such as sample name, tissue and development stage. To help biologists populate it, Jflow uses a structured data input rendered by the <italic>wfform</italic> plug-in as a spreadsheet. It allows to copy and paste multiple lines. Jflow iterates then on the table content to launch each sample processing in parallel.</p>
    <p>To monitor running workflows, NG6 provides a table in a specific page. The table is filled by the <italic>activewf</italic> plug-in. In the same way as described above, the <italic>wfstatus</italic> is built on a modal box when a <italic>select.activewf</italic> event is thrown by the <italic>activewf</italic> plug-in, as presented in <xref ref-type="fig" rid="btv589-F1">Figure 1</xref>. This view shows the workflow’s execution graph where nodes represent components and edges links between inputs and outputs.
</p>
    <fig id="btv589-F1" orientation="portrait" position="float">
      <label>Fig. 1.</label>
      <caption>
        <p>Jflow integration: (<bold>a</bold>) a piece of the NG6 HTML code source in which is positioned an empty div to build the <italic>activewf</italic> plug-in and a modal box for the <italic>wfstatus</italic> plug-in. (<bold>b</bold>) The jQuery code in charge to build Jflow plug-ins and manage user action. When the <italic>select.activewf</italic> event is thrown from <italic>activewf-div</italic>, a function is called with two parameters: <italic>event</italic> and <italic>workflow</italic>. The last parameter stores all the workflow’s information, such as its name and its id, used in this example to update the modal box title and to build the <italic>wfstatus</italic> plug-in. (<bold>c</bold>) The status of the illumina_qc workflow with the id 26 displayed as a graph in the NG6 application</p>
      </caption>
      <graphic xlink:href="btv589f1p"/>
    </fig>
    <p>NG6 was first implemented using the Ergatis (<xref rid="btv589-B11" ref-type="bibr">Orvis <italic>et al</italic>., 2010</xref>) WMS, which had a separate user interface. With Jflow, all actions are now available from the same application, which makes it user friendly.</p>
  </sec>
  <sec>
    <title>4 Conclusion</title>
    <p>Jflow is a simple and efficient solution to embed WMS features within a web application. It is, to our knowledge, the only WMS designed with this purpose. It is already embedded in RNAbrowse (<xref rid="btv589-B9" ref-type="bibr">Mariette <italic>et al</italic>., 2014</xref>) and NG6 (<xref rid="btv589-B8" ref-type="bibr">Mariette <italic>et al</italic>., 2012</xref>), where it has been used to process more than 2000 sequencing runs on a 5000 cores HPC environment.</p>
    <p><italic>Conflict of Interest:</italic> none declared.</p>
  </sec>
</body>
<back>
  <ref-list>
    <title>References</title>
    <ref id="btv589-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Albrecht</surname><given-names>M.</given-names></name><etal/></person-group> (<year>2012</year>) <article-title>Makeflow: a portable abstraction for data intensive computing on clusters, clouds, and grids</article-title>. <source>SWEET at ACM SIGMOD</source>, <volume>20</volume><comment>. doi: 10.1145/2443416.2443417</comment>. </mixed-citation>
    </ref>
    <ref id="btv589-B2">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Bui</surname><given-names>P.</given-names></name></person-group> (<year>2012</year>) <comment>Compiler Toolchain For Data Intensive Scientific Workflows. <italic>Ph.D. Thesis, University of Notre Dame</italic></comment>.</mixed-citation>
    </ref>
    <ref id="btv589-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gafni</surname><given-names>E.</given-names></name><etal/></person-group> (<year>2014</year>) <article-title>COSMOS: python library for massively parallel workflows</article-title>. <source>Bioinformatics</source>, <volume>30</volume>, <fpage>2956</fpage>–<lpage>2958</lpage>.<pub-id pub-id-type="pmid">24982428</pub-id></mixed-citation>
    </ref>
    <ref id="btv589-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Goecks</surname><given-names>J.</given-names></name><etal/></person-group> (<year>2010</year>) <article-title>Galaxy: a comprehensive approach for supporting accessible, reproducible, and transparent computational research in the life sciences</article-title>, <source>Genome Biol.</source>, <volume>11</volume>, <fpage>R86</fpage>.<pub-id pub-id-type="pmid">20738864</pub-id></mixed-citation>
    </ref>
    <ref id="btv589-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Goodstadt</surname><given-names>L.</given-names></name></person-group> (<year>2010</year>) <article-title>Ruffus: a lightweight Python library for computational pipelines</article-title>. <source>Bioinformatics</source>, <volume>26</volume>, <fpage>2778</fpage>–<lpage>2779</lpage>.<pub-id pub-id-type="pmid">20847218</pub-id></mixed-citation>
    </ref>
    <ref id="btv589-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Koster</surname><given-names>J.</given-names></name><name><surname>Rahmann</surname><given-names>S.</given-names></name></person-group> (<year>2012</year>) <article-title>Snakemake—a scalable bioinformatics workflow engine</article-title>. <source>Bioinformatics</source>, <volume>28</volume>, <fpage>2520</fpage>–<lpage>2522</lpage>.<pub-id pub-id-type="pmid">22908215</pub-id></mixed-citation>
    </ref>
    <ref id="btv589-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lopes</surname><given-names>C.T.</given-names></name><etal/></person-group> (<year>2010</year>) <article-title>Cytoscape Web: an interactive web-based network browser</article-title>, <source>Bioinformatics</source>, <volume>26</volume>, <fpage>2347</fpage>–<lpage>2348</lpage>.<pub-id pub-id-type="pmid">20656902</pub-id></mixed-citation>
    </ref>
    <ref id="btv589-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mariette</surname><given-names>J.</given-names></name><etal/></person-group> (<year>2012</year>) <article-title>NG6: Integrated next generation sequencing storage and processing environment</article-title>. <source>BMC Genomics</source>, <volume>13</volume>, <fpage>462</fpage>.<pub-id pub-id-type="pmid">22958229</pub-id></mixed-citation>
    </ref>
    <ref id="btv589-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mariette</surname><given-names>J.</given-names></name><etal/></person-group> (<year>2014</year>) <article-title>RNAbrowse: RNA-seq de novo assembly results browser</article-title>. <source>PLoS ONE</source>, <volume>9</volume><comment>, e96821</comment>.</mixed-citation>
    </ref>
    <ref id="btv589-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Meyer</surname><given-names>F.</given-names></name><etal/></person-group> (<year>2008</year>) <article-title>The metagenomics RAST server a public resource for the automatic phylogenetic and functional analysis of metagenomes</article-title>, <source>BMC Bioinformatics</source>, <volume>9</volume>, <fpage>386</fpage>.<pub-id pub-id-type="pmid">18803844</pub-id></mixed-citation>
    </ref>
    <ref id="btv589-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Néron</surname><given-names>B.</given-names></name><etal/></person-group> (<year>2009</year>) <article-title>Mobyle: a new full web bioinformatics framework</article-title>, <volume>25</volume>, <fpage>3005</fpage>–<lpage>3011</lpage>.</mixed-citation>
    </ref>
    <ref id="btv589-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Orvis</surname><given-names>J.</given-names></name><etal/></person-group> (<year>2010</year>) <article-title>Ergatis: a web interface and scalable software system for bioinformatics workflows</article-title>. <source>Bioinformatics</source>, <volume>15</volume>, <fpage>26</fpage>.</mixed-citation>
    </ref>
    <ref id="btv589-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Roux</surname><given-names>S.</given-names></name><etal/></person-group> (<year>2011</year>) <article-title>Metavir: a web server dedicated to virome analysis</article-title>, <source>Bioinformatics</source>, <volume>21</volume>, <fpage>3074</fpage>–<lpage>3075</lpage>.</mixed-citation>
    </ref>
  </ref-list>
</back>
