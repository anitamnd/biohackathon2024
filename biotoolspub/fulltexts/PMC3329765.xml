<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Syst Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">Syst. Biol</journal-id>
    <journal-id journal-id-type="hwp">sysbio</journal-id>
    <journal-id journal-id-type="publisher-id">sysbio</journal-id>
    <journal-title-group>
      <journal-title>Systematic Biology</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1063-5157</issn>
    <issn pub-type="epub">1076-836X</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">3329765</article-id>
    <article-id pub-id-type="pmid">22357727</article-id>
    <article-id pub-id-type="doi">10.1093/sysbio/sys029</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software for Systematics and Evolution</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>MrBayes 3.2: Efficient Bayesian Phylogenetic Inference and Model Choice Across a Large Model Space</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Ronquist</surname>
          <given-names>Fredrik</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">1</xref>
        <xref ref-type="corresp" rid="cor1">*</xref>
        <!--<email>fredrik.ronquist@nrm.se</email>-->
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Teslenko</surname>
          <given-names>Maxim</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>van der Mark</surname>
          <given-names>Paul</given-names>
        </name>
        <xref ref-type="aff" rid="aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ayres</surname>
          <given-names>Daniel L.</given-names>
        </name>
        <xref ref-type="aff" rid="aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Darling</surname>
          <given-names>Aaron</given-names>
        </name>
        <xref ref-type="aff" rid="aff4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Höhna</surname>
          <given-names>Sebastian</given-names>
        </name>
        <xref ref-type="aff" rid="aff5">5</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Larget</surname>
          <given-names>Bret</given-names>
        </name>
        <xref ref-type="aff" rid="aff6">6</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Liu</surname>
          <given-names>Liang</given-names>
        </name>
        <xref ref-type="aff" rid="aff7">7</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Suchard</surname>
          <given-names>Marc A.</given-names>
        </name>
        <xref ref-type="aff" rid="aff8">8</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Huelsenbeck</surname>
          <given-names>John P.</given-names>
        </name>
        <xref ref-type="aff" rid="aff9">9</xref>
      </contrib>
    </contrib-group>
    <aff id="aff1"><label>1</label>Department of Biodiversity Informatics, Swedish Museum of Natural History, SE-10405 Stockholm, Sweden</aff>
    <aff id="aff2"><label>2</label>Department of Scientific Computing, Florida State University, FL 32306, USA</aff>
    <aff id="aff3"><label>3</label>Center for Bioinformatics and Computational Biology, University of Maryland, College Park, MD 20742, USA</aff>
    <aff id="aff4"><label>4</label>Genome Center, University of California, Davis, CA 95616, USA</aff>
    <aff id="aff5"><label>5</label>Department of Mathematics, Stockholm University, SE-10691 Stockholm, Sweden</aff>
    <aff id="aff6"><label>6</label>Departments of Statistics and Botany, University of Wisconsin, Madison, WI 53706, USA</aff>
    <aff id="aff7"><label>7</label>Departments of Agriculture and Natural Resources, Delaware State University, Dover, DE 19901, USA</aff>
    <aff id="aff8"><label>8</label>Departments of Biomathematics, Biostatistics and Human Genetics, University of California, Los Angeles, CA 90095, USA</aff>
    <aff id="aff9"><label>9</label>Department of Integrative Biology, University of California, Berkeley, CA 94720, USA</aff>
    <author-notes>
      <corresp id="cor1"><label>*</label>Correspondence to be sent to: Department of Biodiversity Informatics, Swedish Museum of Natural History, SE-10405 Stockholm, Sweden; E-mail: <email>fredrik.ronquist@nrm.se</email>.</corresp>
      <fn>
        <p>
          <italic>Associate Editor: David Posada</italic>
        </p>
      </fn>
    </author-notes>
    <pub-date pub-type="ppub">
      <month>5</month>
      <year>2012</year>
    </pub-date>
    <pub-date iso-8601-date="2012-02-22" pub-type="epub">
      <day>22</day>
      <month>2</month>
      <year>2012</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>22</day>
      <month>2</month>
      <year>2012</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. -->
    <volume>61</volume>
    <issue>3</issue>
    <fpage>539</fpage>
    <lpage>542</lpage>
    <history>
      <date date-type="received">
        <day>13</day>
        <month>8</month>
        <year>2011</year>
      </date>
      <date date-type="rev-recd">
        <day>20</day>
        <month>9</month>
        <year>2011</year>
      </date>
      <date date-type="accepted">
        <day>06</day>
        <month>2</month>
        <year>2012</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2012. Published by Oxford University Press, on behalf of the Society of Systematic Biologists. All rights reserved.</copyright-statement>
      <copyright-year>2012</copyright-year>
      <license license-type="cc-by-nc" xlink:href="http://creativecommons.org/licenses/by-nc/3.0">
        <license-p><!--CREATIVE COMMONS-->This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/3.0">http://creativecommons.org/licenses/by-nc/3.0</ext-link>), which permits unrestricted non-commercial use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="sys029.pdf"/>
    <abstract>
      <title>Abstract</title>
      <p>Since its introduction in 2001, MrBayes has grown in popularity as a software package for Bayesian phylogenetic inference using Markov chain Monte Carlo (MCMC) methods. With this note, we announce the release of version 3.2, a major upgrade to the latest official release presented in 2003. The new version provides convergence diagnostics and allows multiple analyses to be run in parallel with convergence progress monitored on the fly. The introduction of new proposals and automatic optimization of tuning parameters has improved convergence for many problems. The new version also sports significantly faster likelihood calculations through streaming single-instruction-multiple-data extensions (SSE) and support of the BEAGLE library, allowing likelihood calculations to be delegated to graphics processing units (GPUs) on compatible hardware. Speedup factors range from around 2 with SSE code to more than 50 with BEAGLE for codon problems. Checkpointing across all models allows long runs to be completed even when an analysis is prematurely terminated. New models include relaxed clocks, dating, model averaging across time-reversible substitution models, and support for hard, negative, and partial (backbone) tree constraints. Inference of species trees from gene trees is supported by full incorporation of the Bayesian estimation of species trees (BEST) algorithms. Marginal model likelihoods for Bayes factor tests can be estimated accurately across the entire model space using the stepping stone method. The new version provides more output options than previously, including samples of ancestral states, site rates, site <italic>d</italic><sub><italic>N</italic></sub>/<italic>d</italic><sub><italic>S</italic></sub> rations, branch rates, and node dates. A wide range of statistics on tree parameters can also be output for visualization in FigTree and compatible software.</p>
    </abstract>
    <kwd-group>
      <kwd>Bayes factor</kwd>
      <kwd>Bayesian inference</kwd>
      <kwd>MCMC</kwd>
      <kwd>model averaging</kwd>
      <kwd>model choice</kwd>
    </kwd-group>
    <counts>
      <page-count count="4"/>
    </counts>
  </article-meta>
</front>
<body>
  <p>Bayesian Markov chain Monte Carlo (MCMC) methods quickly gained in popularity after they were introduced in statistical phylogenetics in the late 1990's (<xref rid="bib18" ref-type="bibr">Mau and Newton 1997</xref>, <xref rid="bib32" ref-type="bibr">Yang and Rannala 1997</xref>, <xref rid="bib14" ref-type="bibr">Larget and Simon 1999</xref>, <xref rid="bib19" ref-type="bibr">Mau et al. 1999</xref>). This was due to the inherent advantages of the approach but also to the availability of easy-to-use software packages, such as MrBayes (<xref rid="bib12" ref-type="bibr">Huelsenbeck and Ronquist 2001</xref>). Originally, MrBayes only supported simple phylogenetic models, but the model space expanded considerably in version 3.0 (<xref rid="bib26" ref-type="bibr">Ronquist and Huelsenbeck 2003</xref>). In addition to a wide range of models on binary, “standard” (morphology), nucleotide and amino acid data, version 3.0 also supported mixed models. The latter allow different data partitions to be combined in the same model, with parameters linked or unlinked across partitions according to user specifications. MrBayes 3.0 was apparently the first statistical phylogenetics package to support such models (<xref rid="bib23" ref-type="bibr">Rannala and Yang 2008</xref>).</p>
  <p>Bayesian phylogenetic inference using MCMC has developed in leaps and bounds since the release of MrBayes 3.0. In particular, the relative ease with which complex models can be tackled using the MCMC machinery has led to an explosion in the development of probabilistic evolutionary models (for a review, see <xref rid="bib25" ref-type="bibr">Ronquist and Deans 2010</xref>). We have also seen the appearance of better MCMC algorithms and more sophisticated convergence diagnostics for phylogenetic models, and methods for Bayesian model choice have improved considerably.</p>
  <p>With this note, we announce the official release of version 3.2 of MrBayes. Version 3.2 was originally intended as a relatively modest expansion of version 3.1, which added convergence diagnostics to the original features in version 3.0. Over the years, however, a number of significant new features were added to version 3.2, and large parts of the program were rewritten. When we now officially release version 3.2, it is every bit as significant in the evolution of the program as the release of version 3.0 almost a decade ago.</p>
  <sec>
    <title>D<sc>ESCRIPTION OF</sc> N<sc>EW</sc> F<sc>EATURES</sc></title>
    <sec>
      <title>Convergence</title>
      <p>The phylogenetics community has come to accept as good practice that Bayesian MCMC results be accompanied by a critical assessment of convergence. Arguably, the best way of accomplishing this is to compare samples obtained from independent MCMC analyses. It is typically the tree samples that are most divergent in phylogenetic analyses, and we therefore introduced the average standard deviation of split frequencies (ASDSF) in MrBayes to allow quantitative assessment of the similarity among such samples.</p>
      <p>ASDSF is calculated by comparing split or clade frequencies across multiple independent MCMC runs that ideally should be started from different randomly chosen starting trees (<xref rid="bib13" ref-type="bibr">Lakner et al. 2008</xref>). ASDSF should approach 0.0 as runs converge to the same distribution. The frequencies of rare splits or clades are difficult to estimate accurately and these groupings are usually of marginal interest. Therefore, it may be advantageous to exclude them from the diagnostic. MrBayes allows the user to set a cutoff frequency (default value 0.10); all splits or clades occurring minimally at that frequency in at least one of the runs will be incorporated in the ASDSF.</p>
      <p>To allow users to monitor MCMC progress, MrBayes can run several analyses in parallel and report the average (ASDSF) or maximum standard deviation of split frequencies at regular intervals. More detailed diagnostics can be obtained using the “sump” and “sumt” commands after the run has completed. They include ASDSF across runs for each of the sampled clades in addition to the potential scale reduction factor (PSRF; <xref rid="bib5" ref-type="bibr">Gelman and Rubin 1992</xref>) for branch lengths, node times, and substitution model parameters. PSRF compares the variance within and between runs and should approach 1.0 as runs converge. MrBayes 3.2 also reports the effective sample size, widely used for single-run convergence diagnostics.</p>
      <p>MrBayes 3.2 also introduces several new features intended to improve MCMC convergence rates. A number of new tree proposal mechanisms have been added, including subtree-swapping moves and extending subtree-pruning-and-regrafting moves, and the default mix of proposals has been optimized (<xref rid="bib13" ref-type="bibr">Lakner et al. 2008</xref>). MrBayes 3.2 further includes a completely new type of tree proposal that is guided using parsimony scores. The details of the parsimony-biased proposals will be presented elsewhere; however, tentative empirical results show that they can improve the speed of convergence by an order of magnitude on some problems (see also <xref rid="bib8" ref-type="bibr">Höhna and Drummond 2012</xref>). For nontree proposals, MrBayes 3.2 implements auto-tuning that automatically adjusts tuning parameters such that a target acceptance frequency is reached (<xref rid="bib24" ref-type="bibr">Roberts and Rosenthal 2009</xref>). Since previous versions, MrBayes supports Metropolis coupling (heated chains) to accelerate convergence. To simplify monitoring of convergence, MrBayes 3.2 prints ASDSF values, acceptance rates of moves, and acceptance rates of swaps between Metropolis-coupled chains to a separate file with a “.mcmc” suffix during runs.</p>
    </sec>
    <sec>
      <title>Faster and More Convenient Computation</title>
      <p>Much of the computational effort in a phylogenetic MCMC analysis is spent calculating likelihoods. To improve speed, MrBayes 3.2 now employs streaming single-instruction-multiple-data extensions (SSE) for all likelihood calculations. SSE instructions are supported by most current CPUs and provide low-level parallelization of arithmetic operations. Importantly, MrBayes 3.2 also supports the use of the BEAGLE library for likelihood calculations (<xref rid="bib2" ref-type="bibr">Ayres et al. 2012</xref>). With BEAGLE, the likelihood calculations can be farmed out to one or more graphics processing units (GPUs) on compatible hardware, resulting in significant speedups for codon and amino acid models in particular. BEAGLE can also be used for likelihood computation on the CPU.</p>
      <p>MrBayes 3.2 does not support multithreading, but it does implement the message passing interface (MPI) for efficient parallel processing across large computer clusters (<xref rid="bib1" ref-type="bibr">Altekar et al. 2004</xref>). On many hardware platforms, including Mac OS and Linux, it is possible to use the MPI-enabled Unix version of MrBayes to take advantage of multiple cores. However, MPI parallelization is across chains, which means that the maximum number of cores or processors that can be used by MrBayes is the same as the total number of heated and nonheated chains across all simultaneous runs. For instance, two runs of four chains each would be maximally accelerated on a system with eight processors or cores. The MPI version can be combined with BEAGLE to further expand the opportunity for computational parallelization.</p>
      <p>Finally, to facilitate long runs, MrBayes 3.2 implements checkpointing across all models. At a frequency determined by the user, all parameter samples are printed to a “.ckp” file. If desired, the analysis can later be restarted from the checkpoint file, and the final results will appear as if the run had never been stopped.</p>
    </sec>
    <sec>
      <title>New Models</title>
      <p>Many phylogenetic hypotheses concern the structure of the phylogenetic tree. To facilitate such analyses, MrBayes 3.2 implements three types of constraints on the tree: hard, negative, and partial. A hard constraint forces a split or clade to be present in all trees sampled in the MCMC analysis, whereas a negative constraint forces a split or clade to be absent. Unlike hard and negative constraints, a partial constraint (or backbone constraint) can leave the position of some taxa indeterminate. The indeterminate taxa are allowed to appear on either side of the specified split if the tree is unrooted, or either within or outside the specified clade if the tree is rooted. Several hard, negative, and partial constraints can be combined into complicated priors on the shape of the tree. However, constraints are either on or off; they cannot be associated with probabilities in the current version.</p>
      <p>Unlike previous versions, MrBayes 3.2 supports relaxed clock models and dating. Three different relaxed clock models are available: the Compound Poisson Process (CPP; <xref rid="bib10" ref-type="bibr">Huelsenbeck et al. 2000</xref>), the Thorne–Kishino 2002 (TK02; <xref rid="bib30" ref-type="bibr">Thorne and Kishino 2002</xref>), and the Independent Gamma Rate (IGR; <xref rid="bib16" ref-type="bibr">Lepage et al. 2007</xref>) models.</p>
      <p>The CPP model is a discrete autocorrelated model, in which rate multipliers appear on the tree according to a Poisson process. The MrBayes implementation uses a lognormal distribution for the rate multipliers instead of the modified gamma distribution proposed originally (<xref rid="bib10" ref-type="bibr">Huelsenbeck et al. 2000</xref>). It also includes novel algorithms to allow sampling across tree space since the original paper only dealt with fixed trees.</p>
      <p>The TK02 model is a continuous autocorrelated model. In the particular version we implemented (<xref rid="bib30" ref-type="bibr">Thorne and Kishino 2002</xref>), the rate of a descendant node is drawn from a lognormal distribution, the mean of which is the same as the ancestral rate and the variance of which is proportional to the length of the branch (measured in expected substitutions per site at the base rate of the clock).</p>
      <p>The IGR model is a continuous uncorrelated model. First published as the “white noise” model (<xref rid="bib16" ref-type="bibr">Lepage et al. 2007</xref>), it is similar to the uncorrelated gamma model (<xref rid="bib3" ref-type="bibr">Drummond et al. 2006</xref>) but is mathematically more elegant in that it truly lacks time structure. In the IGR model, effective branch lengths are drawn from a gamma distribution, in which the mean is the same as, and the variance proportional to, the branch length.</p>
      <p>Dating can be achieved in MrBayes 3.2 by calibrating interior or tip nodes in the tree; calibrated interior nodes need to be associated with hard constraints to be valid. Calibration points can be either fixed or associated with uncertainty. The birth–death prior model on clock trees has been expanded to incorporate recent progress in the understanding of the linear constant birth–death process with complete sampling (<xref rid="bib6" ref-type="bibr">Gernhard 2008</xref>), with random incomplete sampling (<xref rid="bib28" ref-type="bibr">Stadler 2009</xref>), or with clustered or diversified sampling (<xref rid="bib9" ref-type="bibr">Höhna et al. 2011</xref>). The tree moves on clock and relaxed clock trees have also been improved considerably over those that were available in previous versions.</p>
      <p>Bayesian phylogenetic inference of species trees from multiple gene trees was first accomplished in the Bayesian estimation of species trees (BEST) software using a complex computational machinery, in which MrBayes was one of the components (<xref rid="bib4" ref-type="bibr">Edwards et al. 2007</xref>, <xref rid="bib17" ref-type="bibr">Liu and Pearl 2007</xref>). Despite later improvements to BEST, the analyses remained slow and computationally demanding. The multispecies coalescent model has now been fully integrated in MrBayes 3.2, and several of the original algorithms have been rewritten to speed up the calculations.</p>
    </sec>
    <sec>
      <title>Model Averaging and Model Choice</title>
      <p>It is standard practice today to select a substitution model for Bayesian phylogenetic inference using a priori model selection procedures (<xref rid="bib7" ref-type="bibr">Goldman 1993</xref>, <xref rid="bib21" ref-type="bibr">Posada 1998</xref>, <xref rid="bib22" ref-type="bibr">Posada 2008</xref>, <xref rid="bib29" ref-type="bibr">Suchard et al. 2001</xref>). An alternative is to use Bayesian model jumping during the MCMC simulation to integrate out the uncertainty concerning the correct substitution model (<xref rid="bib11" ref-type="bibr">Huelsenbeck et al. 2004</xref>). The latter procedure is now implemented in MrBayes 3.2. Rather than selecting a substitution model before the analysis, the user can now sample across all 203 possible time-reversible rate matrices according to their posterior probability. The model-jumping approach is available in all models where a four-by-four nucleotide model is a component, including doublet and codon models in addition to the ordinary nucleotide models.</p>
      <p>Bayesian model choice using Bayes factors is rapidly gaining in popularity. Since earlier versions, MrBayes has reported the harmonic mean of the likelihoods from the MCMC sample, which can be used as a rough estimate of the model likelihood from which the Bayes factor is calculated (<xref rid="bib20" ref-type="bibr">Newton and Raftery 1994</xref>). However, there are now considerably more accurate, albeit computationally more demanding, methods (<xref rid="bib15" ref-type="bibr">Lartillot and Philippe 2006</xref>). Of these, MrBayes 3.2 implements the recently proposed stepping stone method (<xref rid="bib31" ref-type="bibr">Xie et al. 2011</xref>) that uses MCMC to sample from a series of so-called power posterior distributions connecting the posterior distribution with the prior distribution. The samples across these distributions are then used to estimate the model likelihood. The stepping stone algorithm in MrBayes 3.2 uses the full MCMC machinery, including convergence diagnostics and Metropolis coupling, and can be applied to any model available in the program. For instance, it can be used to test various topological hypotheses or substitution models against each other.</p>
    </sec>
    <sec>
      <title>More Output Options</title>
      <p>MrBayes 3.2 provides more extensive output options than previous versions. The user can now request sampling of site rates, site selection coefficients, site positive selection probabilities, and ancestral states of particular nodes. A wide range of tree statistics, including the mean and variance of split or clade frequencies, node times, and branch rates, are now added as annotations to the consensus tree by the “sumt” command and can be displayed using FigTree and compatible tree viewers.</p>
    </sec>
  </sec>
  <sec>
    <title>B<sc>ENCHMARK AND</sc> B<sc>IOLOGICAL</sc> E<sc>XAMPLES</sc></title>
    <p>Benchmark data on the GPU-accelerated code are provided by <xref rid="bib2" ref-type="bibr">Ayres et al. (2012)</xref>. A number of example data sets are distributed with the program, and tutorials illustrating most of the new features are included in the program manual. Many of the dating features in MrBayes 3.2 are discussed in some detail and used in an empirical context in <xref rid="bib27" ref-type="bibr">Ronquist et al. (2012)</xref>.</p>
  </sec>
  <sec>
    <title>A<sc>VAILABILITY</sc></title>
    <p>MrBayes 3.2 is freely available under the GNU General Public License version 3.0. The program web site (<ext-link ext-link-type="uri" xlink:href="http://www.mrbayes.net">http://www.mrbayes.net</ext-link>) provides download links to both source code for compilation on Unix systems and to convenient installers for Windows and Mac OS systems. The installers include both MrBayes and the required BEAGLE libraries, but the BEAGLE libraries can also be installed separately using the BEAGLE installer, available at <ext-link ext-link-type="uri" xlink:href="http://beagle-lib.googlecode.com">http://beagle-lib.googlecode.com</ext-link>. The program comes with a manual and example files. Further help is available on the program web site, which also provides instructions for reporting bugs and signing up for the MrBayes e-mail list. Instructions for accessing the MrBayes source code repository can be found at <ext-link ext-link-type="uri" xlink:href="http://sourceforge.net/projects/mrbayes/develop">http://sourceforge.net/projects/mrbayes/develop</ext-link>.</p>
  </sec>
  <sec>
    <title>F<sc>UNDING</sc></title>
    <p>The development of version 3.2 of MrBayes would not have been possible without generous support from the Swedish Research Council [2008-5629 to F.R.]; the National Institutes of Health [GM-069801 to J.P.H. and GM-086887, HG-006139 to M.A.S.]; and the National Science Foundation [DEB-0445453 to J.P.H., DEB-0949121 and DEB-0936214 to B.L., and DBI-0755048 to D.L.A.]. Incorporation of the BEST algorithms and support for the BEAGLE library was greatly facilitated by a workshop in October 2010 sponsored by the Mathematical Biosciences Institute at Ohio State University [NSF-DMS-0931642], hosted by Dennis Pearl and Marty Golubitsky.</p>
  </sec>
</body>
<back>
  <ack>
    <p>F.R., with the assistance of M.T. and P.v.d.M., did most of the programming for version 3.2, whereas J.P.H., assisted by F.R., was responsible for the software architecture and initial code base. D.L.A., A.D., and M.A.S. helped with the BEAGLE integration and the related performance testing. L.L. assisted in the incorporation of the BEST algorithms, whereas B.L. and S.H. contributed to the implementation of particular models. We would like to thank Chris Anderson for additional assistance with the BEST algorithms. We would also like to express our deep gratitude to the many MrBayes users, who have generously contributed to the project by submitting bug reports, bug fixes, feature requests, and other comments on the software. David Posada, Leonardo Martins, and Jeremy Brown provided constructive criticism that helped improve the manuscript.</p>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="bib1">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Altekar</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Dwarkadas</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Huelsenbeck</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Parallel metropolis coupled Markov chain Monte Carlo for Bayesian phylogenetic inference</article-title>
        <source>Bioinformatics</source>
        <year>2004</year>
        <volume>20</volume>
        <fpage>407</fpage>
        <lpage>425</lpage>
        <pub-id pub-id-type="pmid">14960467</pub-id>
      </element-citation>
    </ref>
    <ref id="bib2">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ayres</surname>
            <given-names>DL</given-names>
          </name>
          <name>
            <surname>Darling</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Zwickl</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>Beerli</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Holder</surname>
            <given-names>MT</given-names>
          </name>
          <name>
            <surname>Lewis</surname>
            <given-names>PO</given-names>
          </name>
          <name>
            <surname>Huelsenbeck</surname>
            <given-names>JP</given-names>
          </name>
          <name>
            <surname>Ronquist</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Swofford</surname>
            <given-names>DL</given-names>
          </name>
          <name>
            <surname>Cummings</surname>
            <given-names>MP</given-names>
          </name>
          <name>
            <surname>Rambaut</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Suchard</surname>
            <given-names>MA</given-names>
          </name>
        </person-group>
        <article-title>BEAGLE: an application programming interface and high-performance computing library for statistical phylogenetics</article-title>
        <source>Syst. Biol.</source>
        <year>2012</year>
        <volume>61</volume>
        <fpage>170</fpage>
        <lpage>173</lpage>
        <pub-id pub-id-type="pmid">21963610</pub-id>
      </element-citation>
    </ref>
    <ref id="bib3">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Drummond</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Ho</surname>
            <given-names>SYW</given-names>
          </name>
          <name>
            <surname>Phillips</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Rambaut</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Relaxed phylogenetics and dating with confidence</article-title>
        <source>PLoS Biol</source>
        <year>2006</year>
        <volume>4</volume>
        <fpage>e88</fpage>
        <pub-id pub-id-type="pmid">16683862</pub-id>
      </element-citation>
    </ref>
    <ref id="bib4">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Edwards</surname>
            <given-names>SV</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Pearl</surname>
            <given-names>DK</given-names>
          </name>
        </person-group>
        <article-title>High-resolution species trees without concatenation</article-title>
        <source>Proc. Natl. Acad. Sci. U.S.A</source>
        <year>2007</year>
        <volume>104</volume>
        <fpage>5936</fpage>
        <lpage>5941</lpage>
        <pub-id pub-id-type="pmid">17392434</pub-id>
      </element-citation>
    </ref>
    <ref id="bib5">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gelman</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Rubin</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Inference from iterative simulation using multiple sequences</article-title>
        <source>Stat. Sci.</source>
        <year>1992</year>
        <volume>7</volume>
        <fpage>457</fpage>
        <lpage>472</lpage>
      </element-citation>
    </ref>
    <ref id="bib6">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gernhard</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>The conditioned reconstructed process</article-title>
        <source>J. Theor. Biol.</source>
        <year>2008</year>
        <volume>253</volume>
        <fpage>769</fpage>
        <lpage>778</lpage>
        <pub-id pub-id-type="pmid">18538793</pub-id>
      </element-citation>
    </ref>
    <ref id="bib7">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Goldman</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>Statistical tests of models of DNA substitution</article-title>
        <source>J. Mol. Evol.</source>
        <year>1993</year>
        <volume>36</volume>
        <fpage>182</fpage>
        <lpage>198</lpage>
        <pub-id pub-id-type="pmid">7679448</pub-id>
      </element-citation>
    </ref>
    <ref id="bib8">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Höhna</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Drummond</surname>
            <given-names>AJ</given-names>
          </name>
        </person-group>
        <article-title>Guided tree topology proposal for Bayesian phylogenetic inference</article-title>
        <source>Syst. Biol.</source>
        <year>2012</year>
        <volume>61</volume>
        <fpage>1</fpage>
        <lpage>11</lpage>
        <pub-id pub-id-type="pmid">21828081</pub-id>
      </element-citation>
    </ref>
    <ref id="bib9">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Höhna</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Stadler</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Ronquist</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Britton</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Inferring speciation and extinction rates under different species sampling schemes</article-title>
        <source>Mol. Biol. Evol.</source>
        <year>2011</year>
        <volume>28</volume>
        <fpage>2577</fpage>
        <lpage>2589</lpage>
        <pub-id pub-id-type="pmid">21482666</pub-id>
      </element-citation>
    </ref>
    <ref id="bib10">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huelsenbeck</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Larget</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Swofford</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>A compound Poisson process for relaxing the molecular clock</article-title>
        <source>Genetics</source>
        <year>2000</year>
        <volume>154</volume>
        <fpage>1879</fpage>
        <lpage>1892</lpage>
        <pub-id pub-id-type="pmid">10747076</pub-id>
      </element-citation>
    </ref>
    <ref id="bib11">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huelsenbeck</surname>
            <given-names>JP</given-names>
          </name>
          <name>
            <surname>Larget</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Alfaro</surname>
            <given-names>ME</given-names>
          </name>
        </person-group>
        <article-title>Bayesian phylogenetic model selection using reversible jump Markov chain Monte Carlo</article-title>
        <source>Mol. Biol. Evol.</source>
        <year>2004</year>
        <volume>21</volume>
        <fpage>1123</fpage>
        <lpage>1133</lpage>
        <pub-id pub-id-type="pmid">15034130</pub-id>
      </element-citation>
    </ref>
    <ref id="bib12">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huelsenbeck</surname>
            <given-names>JP</given-names>
          </name>
          <name>
            <surname>Ronquist</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>MRBAYES: Bayesian inference of phylogenetic trees</article-title>
        <source>Bioinformatics</source>
        <year>2001</year>
        <volume>17</volume>
        <fpage>754</fpage>
        <lpage>755</lpage>
        <pub-id pub-id-type="pmid">11524383</pub-id>
      </element-citation>
    </ref>
    <ref id="bib13">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lakner</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>van der Mark</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Huelsenbeck</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Larget</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Ronquist</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>Efficiency of Markov chain Monte Carlo tree proposals in Bayesian phylogenetics</article-title>
        <source>Syst. Biol.</source>
        <year>2008</year>
        <volume>57</volume>
        <fpage>86</fpage>
        <lpage>103</lpage>
        <pub-id pub-id-type="pmid">18278678</pub-id>
      </element-citation>
    </ref>
    <ref id="bib14">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Larget</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Simon</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Markov chain Monte Carlo algorithms for the Bayesian analysis of phylogenetic trees</article-title>
        <source>Mol. Biol. Evol.</source>
        <year>1999</year>
        <volume>16</volume>
        <fpage>750</fpage>
        <lpage>759</lpage>
      </element-citation>
    </ref>
    <ref id="bib15">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lartillot</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Philippe</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Computing Bayes factors using thermodynamic integration</article-title>
        <source>Syst. Biol.</source>
        <year>2006</year>
        <volume>55</volume>
        <fpage>195</fpage>
        <lpage>207</lpage>
        <pub-id pub-id-type="pmid">16522570</pub-id>
      </element-citation>
    </ref>
    <ref id="bib16">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lepage</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Bryant</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Philippe</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Lartillot</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>A general comparison of relaxed molecular clock models</article-title>
        <source>Mol. Biol. Evol.</source>
        <year>2007</year>
        <volume>24</volume>
        <fpage>2669</fpage>
        <lpage>2680</lpage>
        <pub-id pub-id-type="pmid">17890241</pub-id>
      </element-citation>
    </ref>
    <ref id="bib17">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Pearl</surname>
            <given-names>DK</given-names>
          </name>
        </person-group>
        <article-title>Species trees from gene trees: reconstructing Bayesian posterior distributions of a species phylogeny using estimated gene tree distributions</article-title>
        <source>Syst. Biol.</source>
        <year>2007</year>
        <volume>56</volume>
        <fpage>504</fpage>
        <lpage>514</lpage>
        <pub-id pub-id-type="pmid">17562474</pub-id>
      </element-citation>
    </ref>
    <ref id="bib18">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mau</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Newton</surname>
            <given-names>MA</given-names>
          </name>
        </person-group>
        <article-title>Phylogenetic inference for binary data on dendograms using Markov chain Monte Carlo</article-title>
        <source>J. Comput. Graph. Stat</source>
        <year>1997</year>
        <volume>6</volume>
        <fpage>122</fpage>
        <lpage>131</lpage>
      </element-citation>
    </ref>
    <ref id="bib19">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mau</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Newton</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Larget</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Bayesian phylogenetic inference via Markov chain Monte Carlo methods</article-title>
        <source>Biometrics</source>
        <year>1999</year>
        <volume>55</volume>
        <fpage>1</fpage>
        <lpage>12</lpage>
        <pub-id pub-id-type="pmid">11318142</pub-id>
      </element-citation>
    </ref>
    <ref id="bib20">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Newton</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Raftery</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Approximate Bayesian inference with the weighted likelihood bootstrap</article-title>
        <source>J. R. Stat. Soc. B Stat. Methodol</source>
        <year>1994</year>
        <volume>56</volume>
        <fpage>3</fpage>
        <lpage>48</lpage>
      </element-citation>
    </ref>
    <ref id="bib21">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Posada</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Modeltest: testing the model of DNA substitution</article-title>
        <source>Bioinformatics</source>
        <year>1998</year>
        <volume>14</volume>
        <fpage>817</fpage>
        <lpage>818</lpage>
        <pub-id pub-id-type="pmid">9918953</pub-id>
      </element-citation>
    </ref>
    <ref id="bib22">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Posada</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>jModelTest: phylogenetic model averaging</article-title>
        <source>Mol. Biol. Evol.</source>
        <year>2008</year>
        <volume>25</volume>
        <fpage>1253</fpage>
        <lpage>1256</lpage>
        <pub-id pub-id-type="pmid">18397919</pub-id>
      </element-citation>
    </ref>
    <ref id="bib23">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rannala</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>Z</given-names>
          </name>
        </person-group>
        <article-title>Phylogenetic inference using whole genomes</article-title>
        <source>Annu. Rev. Genomics Hum. Genet.</source>
        <year>2008</year>
        <volume>9</volume>
        <fpage>217</fpage>
        <lpage>231</lpage>
        <pub-id pub-id-type="pmid">18767964</pub-id>
      </element-citation>
    </ref>
    <ref id="bib24">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Roberts</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Rosenthal</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Examples of adaptive MCMC</article-title>
        <source>J. Comput. Graph. Stat</source>
        <year>2009</year>
        <volume>18</volume>
        <fpage>349</fpage>
        <lpage>367</lpage>
      </element-citation>
    </ref>
    <ref id="bib25">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ronquist</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Deans</surname>
            <given-names>AR</given-names>
          </name>
        </person-group>
        <article-title>Bayesian phylogenetics and its influence on insect systematics</article-title>
        <source>Annu. Rev. Entomol</source>
        <year>2010</year>
        <volume>55</volume>
        <fpage>189</fpage>
        <lpage>206</lpage>
        <pub-id pub-id-type="pmid">19961329</pub-id>
      </element-citation>
    </ref>
    <ref id="bib26">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ronquist</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Huelsenbeck</surname>
            <given-names>JP</given-names>
          </name>
        </person-group>
        <article-title>Mrbayes 3: Bayesian phylogenetic inference under mixed models</article-title>
        <source>Bioinformatics</source>
        <year>2003</year>
        <volume>19</volume>
        <fpage>1572</fpage>
        <lpage>1574</lpage>
        <pub-id pub-id-type="pmid">12912839</pub-id>
      </element-citation>
    </ref>
    <ref id="bib27">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ronquist</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Klopfstein</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Vilhelmsen</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Schulmeister</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Murray</surname>
            <given-names>DL</given-names>
          </name>
          <name>
            <surname>Rasnitsyn</surname>
            <given-names>AP</given-names>
          </name>
        </person-group>
        <article-title>Forthcoming</article-title>
        <article-title>A total-evidence approach to dating with fossils, applied to the early radiation of the Hymenoptera</article-title>
        <source>Syst. Biol</source>
        <year>2012</year>
      </element-citation>
    </ref>
    <ref id="bib28">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stadler</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>On incomplete sampling under birth-death models and connections to the sampling-based coalescent</article-title>
        <source>J. Theor. Biol.</source>
        <year>2009</year>
        <volume>261</volume>
        <fpage>58</fpage>
        <lpage>66</lpage>
        <pub-id pub-id-type="pmid">19631666</pub-id>
      </element-citation>
    </ref>
    <ref id="bib29">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Suchard</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Weiss</surname>
            <given-names>RE</given-names>
          </name>
          <name>
            <surname>Sinsheimer</surname>
            <given-names>JS</given-names>
          </name>
        </person-group>
        <article-title>Bayesian selection of continuous-time Markov chain evolutionary models</article-title>
        <source>Mol. Biol. Evol.</source>
        <year>2001</year>
        <volume>18</volume>
        <fpage>1001</fpage>
        <lpage>1013</lpage>
        <pub-id pub-id-type="pmid">11371589</pub-id>
      </element-citation>
    </ref>
    <ref id="bib30">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Thorne</surname>
            <given-names>JL</given-names>
          </name>
          <name>
            <surname>Kishino</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Divergence time and evolutionary rate estimation with multilocus data</article-title>
        <source>Syst. Biol.</source>
        <year>2002</year>
        <volume>51</volume>
        <fpage>689</fpage>
        <lpage>702</lpage>
        <pub-id pub-id-type="pmid">12396584</pub-id>
      </element-citation>
    </ref>
    <ref id="bib31">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Xie</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Lewis</surname>
            <given-names>PO</given-names>
          </name>
          <name>
            <surname>Fan</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Kuo</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>M-H</given-names>
          </name>
        </person-group>
        <article-title>Improving marginal likelihood estimation for Bayesian phylogenetic model selection</article-title>
        <source>Syst. Biol.</source>
        <year>2011</year>
        <volume>60</volume>
        <fpage>150</fpage>
        <lpage>160</lpage>
        <pub-id pub-id-type="pmid">21187451</pub-id>
      </element-citation>
    </ref>
    <ref id="bib32">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yang</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Rannala</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Bayesian phylogenetic inference using DNA sequences: a Markov chain Monte Carlo method</article-title>
        <source>Mol. Biol. Evol.</source>
        <year>1997</year>
        <volume>14</volume>
        <fpage>717</fpage>
        <lpage>724</lpage>
        <pub-id pub-id-type="pmid">9214744</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
