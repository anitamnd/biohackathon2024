<?properties open_access?>
<?subarticle pone.0231738.r001?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 39.96?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS One</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS ONE</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-id journal-id-type="pmc">plosone</journal-id>
    <journal-title-group>
      <journal-title>PLoS ONE</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1932-6203</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, CA USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7255610</article-id>
    <article-id pub-id-type="publisher-id">PONE-D-19-16932</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pone.0231738</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and life sciences</subject>
        <subj-group>
          <subject>Biochemistry</subject>
          <subj-group>
            <subject>Nucleic acids</subject>
            <subj-group>
              <subject>RNA</subject>
              <subj-group>
                <subject>Non-coding RNA</subject>
                <subj-group>
                  <subject>Natural antisense transcripts</subject>
                  <subj-group>
                    <subject>MicroRNAs</subject>
                  </subj-group>
                </subj-group>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and life sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Gene expression</subject>
            <subj-group>
              <subject>Gene regulation</subject>
              <subj-group>
                <subject>MicroRNAs</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and life sciences</subject>
        <subj-group>
          <subject>Biochemistry</subject>
          <subj-group>
            <subject>Nucleic acids</subject>
            <subj-group>
              <subject>RNA</subject>
              <subj-group>
                <subject>Non-coding RNA</subject>
                <subj-group>
                  <subject>Small nuclear RNA</subject>
                  <subj-group>
                    <subject>Small nucleolar RNA</subject>
                  </subj-group>
                </subj-group>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and life sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Gene expression</subject>
            <subj-group>
              <subject>Gene regulation</subject>
              <subj-group>
                <subject>Small nucleolar RNA</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Computational Biology</subject>
          <subj-group>
            <subject>Genome Complexity</subject>
            <subj-group>
              <subject>Introns</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Genomics</subject>
            <subj-group>
              <subject>Genome Complexity</subject>
              <subj-group>
                <subject>Introns</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Animal Studies</subject>
          <subj-group>
            <subject>Experimental Organism Systems</subject>
            <subj-group>
              <subject>Model Organisms</subject>
              <subj-group>
                <subject>Arabidopsis Thaliana</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Model Organisms</subject>
          <subj-group>
            <subject>Arabidopsis Thaliana</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Organisms</subject>
          <subj-group>
            <subject>Eukaryota</subject>
            <subj-group>
              <subject>Plants</subject>
              <subj-group>
                <subject>Brassica</subject>
                <subj-group>
                  <subject>Arabidopsis Thaliana</subject>
                </subj-group>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Animal Studies</subject>
          <subj-group>
            <subject>Experimental Organism Systems</subject>
            <subj-group>
              <subject>Plant and Algal Models</subject>
              <subj-group>
                <subject>Arabidopsis Thaliana</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Computational Biology</subject>
          <subj-group>
            <subject>Genome Analysis</subject>
            <subj-group>
              <subject>Genome Annotation</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Genomics</subject>
            <subj-group>
              <subject>Genome Analysis</subject>
              <subj-group>
                <subject>Genome Annotation</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and life sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Gene expression</subject>
            <subj-group>
              <subject>Gene regulation</subject>
              <subj-group>
                <subject>Small interfering RNAs</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and life sciences</subject>
        <subj-group>
          <subject>Biochemistry</subject>
          <subj-group>
            <subject>Nucleic acids</subject>
            <subj-group>
              <subject>RNA</subject>
              <subj-group>
                <subject>Non-coding RNA</subject>
                <subj-group>
                  <subject>Small interfering RNAs</subject>
                </subj-group>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Animal Studies</subject>
          <subj-group>
            <subject>Experimental Organism Systems</subject>
            <subj-group>
              <subject>Model Organisms</subject>
              <subj-group>
                <subject>Zebrafish</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Model Organisms</subject>
          <subj-group>
            <subject>Zebrafish</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Animal Studies</subject>
          <subj-group>
            <subject>Experimental Organism Systems</subject>
            <subj-group>
              <subject>Animal Models</subject>
              <subj-group>
                <subject>Zebrafish</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Organisms</subject>
          <subj-group>
            <subject>Eukaryota</subject>
            <subj-group>
              <subject>Animals</subject>
              <subj-group>
                <subject>Vertebrates</subject>
                <subj-group>
                  <subject>Fish</subject>
                  <subj-group>
                    <subject>Osteichthyes</subject>
                    <subj-group>
                      <subject>Zebrafish</subject>
                    </subj-group>
                  </subj-group>
                </subj-group>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and life sciences</subject>
        <subj-group>
          <subject>Molecular biology</subject>
          <subj-group>
            <subject>Molecular biology techniques</subject>
            <subj-group>
              <subject>Sequencing techniques</subject>
              <subj-group>
                <subject>RNA sequencing</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and analysis methods</subject>
        <subj-group>
          <subject>Molecular biology techniques</subject>
          <subj-group>
            <subject>Sequencing techniques</subject>
            <subj-group>
              <subject>RNA sequencing</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>mmannot: How to improve small–RNA annotation?</article-title>
      <alt-title alt-title-type="running-head">mmannot: How to improve small–RNA annotation?</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-4895-8731</contrib-id>
        <name>
          <surname>Zytnicki</surname>
          <given-names>Matthias</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Conceptualization</role>
        <role content-type="http://credit.casrai.org/">Software</role>
        <role content-type="http://credit.casrai.org/">Validation</role>
        <role content-type="http://credit.casrai.org/">Writing – original draft</role>
        <role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff001"/>
        <xref ref-type="corresp" rid="cor001">*</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Gaspin</surname>
          <given-names>Christine</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Conceptualization</role>
        <role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff001"/>
      </contrib>
    </contrib-group>
    <aff id="aff001">
      <addr-line>Unité de Mathématiques et Informatique Appliquées, Toulouse INRA, Castanet Tolosan, France</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Rizzo</surname>
          <given-names>Francesca</given-names>
        </name>
        <role>Editor</role>
        <xref ref-type="aff" rid="edit1"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">
      <addr-line>University of Salerno, ITALY</addr-line>
    </aff>
    <author-notes>
      <fn fn-type="COI-statement" id="coi001">
        <p><bold>Competing Interests: </bold>The authors have declared that no competing interests exist.</p>
      </fn>
      <corresp id="cor001">* E-mail: <email>matthias.zytnicki@inra.fr</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>28</day>
      <month>5</month>
      <year>2020</year>
    </pub-date>
    <volume>15</volume>
    <issue>5</issue>
    <elocation-id>e0231738</elocation-id>
    <history>
      <date date-type="received">
        <day>27</day>
        <month>6</month>
        <year>2019</year>
      </date>
      <date date-type="accepted">
        <day>30</day>
        <month>3</month>
        <year>2020</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2020 Zytnicki, Gaspin</copyright-statement>
      <copyright-year>2020</copyright-year>
      <copyright-holder>Zytnicki, Gaspin</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:href="pone.0231738.pdf"/>
    <abstract>
      <p>High-throughput sequencing makes it possible to provide the genome-wide distribution of small non coding RNAs in a single experiment, and contributed greatly to the identification and understanding of these RNAs in the last decade. Small non coding RNAs gather a wide collection of classes, such as microRNAs, tRNA-derived fragments, small nucleolar RNAs and small nuclear RNAs, to name a few. As usual in RNA-seq studies, the sequencing step is followed by a feature quantification step: when a genome is available, the reads are aligned to the genome, their genomic positions are compared to the already available annotations, and the corresponding features are quantified. However, problem arises when many reads map at several positions and while different strategies exist to circumvent this problem, all of them are biased. In this article, we present a new strategy that compares all the reads that map at several positions, and their annotations when available. In many cases, all the hits co-localize with the same feature annotation (a duplicated miRNA or a duplicated gene, for instance). When different annotations exist for a given read, we propose to merge existing features and provide the counts for the merged features. This new strategy has been implemented in a tool, mmannot, freely available at <ext-link ext-link-type="uri" xlink:href="https://github.com/mzytnicki/mmannot">https://github.com/mzytnicki/mmannot</ext-link>.</p>
    </abstract>
    <funding-group>
      <funding-statement>The author(s) received no specific funding for this work.</funding-statement>
    </funding-group>
    <counts>
      <fig-count count="9"/>
      <table-count count="2"/>
      <page-count count="19"/>
    </counts>
    <custom-meta-group>
      <custom-meta id="data-availability">
        <meta-name>Data Availability</meta-name>
        <meta-value>Software is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/mzytnicki/mmannot">https://github.com/mzytnicki/mmannot</ext-link>.</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
  <notes>
    <title>Data Availability</title>
    <p>Software is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/mzytnicki/mmannot">https://github.com/mzytnicki/mmannot</ext-link>.</p>
  </notes>
</front>
<body>
  <sec sec-type="intro" id="sec001">
    <title>Introduction</title>
    <p>Eukaryotic small RNAs (sRNAs) are defined as &lt;200-bp long, usually untranslated, RNAs. They have been shown to participate in many aspects of cell life [<xref rid="pone.0231738.ref001" ref-type="bibr">1</xref>, <xref rid="pone.0231738.ref002" ref-type="bibr">2</xref>].</p>
    <p>They are generally classified according to their specific size range, biogenesis, and functional pathway. Among them, microRNAs (miRNAs) are certainly the most studied. Mature miRNAs are products of long primary transcripts, which fold into pre-miRNA stem-loop secondary structures that are recognized by the maturation machinery. Other sRNA classes can also be accurately identified, because they are part of a well-characterized structure: small nucleolar RNAs (snoRNAs), small nuclear RNAs (snRNAs or U-RNAs), and tRNA-derived small RNAs (tsRNAs).</p>
    <p>On the contrary, other sRNAs have no known structure. Some classes are only defined by their positions relative to a protein coding gene, or a long non-coding RNA [<xref rid="pone.0231738.ref003" ref-type="bibr">3</xref>]. Some sRNAs are known to accumulate near TSS, near exon/intron junctions, in the promoter of the gene, or in the downstream regions. Last, some classes have very few distinctive patterns (no clear secondary structure nor easily detectable primary transcript): small interfering RNAs (siRNAs), piwi-associated RNAs (piRNAs) and repeat-associated siRNAs (rasiRNAs).</p>
    <p>Although very diverse, these sRNAs can be captured in a single experiment, and several protocols have been devised to perform this task [<xref rid="pone.0231738.ref004" ref-type="bibr">4</xref>]. Briefly, the protocol includes RNA purification, size selection, possibly enrichment of terminal 5’ phosphate molecules, and sequencing. Depending on the technology used, and the multiplexing, a few dozen of millions reads are produced.</p>
    <p>It is then usual to assess the abundance of each sRNA class. To do so, the most straightforward way is to map the reads to a genome (usually with BWA [<xref rid="pone.0231738.ref005" ref-type="bibr">5</xref>] or bowtie [<xref rid="pone.0231738.ref006" ref-type="bibr">6</xref>]), and compare the mapped reads with an annotation file, which includes the positions of the known annotated sRNAs on the genome. This is the <italic>annotation</italic> step, which is executed for each read. The sRNA classes are then quantified by counting the number of reads co-localizing with the members of each class.</p>
    <p>Although simple and widely used, this strategy does not work in several ambiguous cases, which are described in <xref ref-type="fig" rid="pone.0231738.g001">Fig 1</xref>.</p>
    <list list-type="order">
      <list-item>
        <p>A read maps at several loci: if two different regions of the genome are identical (usually after a genome duplication), a read may map equally well at different locations (<xref ref-type="fig" rid="pone.0231738.g001">Fig 1A</xref>).</p>
      </list-item>
      <list-item>
        <p>Two different annotations overlap in the genome and a hit (i.e. a read mapping) overlaps both: In this case the hit may be attributed to either annotation (<xref ref-type="fig" rid="pone.0231738.g001">Fig 1B</xref>).</p>
      </list-item>
      <list-item>
        <p>A hit co-localizes two different annotations, even though the annotations do not overlap themselves: The hit is usually at the frontier of the annotations (<xref ref-type="fig" rid="pone.0231738.g001">Fig 1C</xref>).</p>
      </list-item>
    </list>
    <fig id="pone.0231738.g001" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pone.0231738.g001</object-id>
      <label>Fig 1</label>
      <caption>
        <title>Ambiguous cases of sRNA class quantification.</title>
        <p>In each figure, the read is in blue, intergenic regions are grey, and known annotated sRNAs are red. <italic>(A)</italic> The read A maps at two different locations, and each mapping overlaps with a different sRNA annotation class. <italic>(B)</italic> Two sRNA annotation classes overlap in the annotation file. <italic>(C)</italic> The read overlaps two different sRNAs annotation classes that do not overlap each other.</p>
      </caption>
      <graphic xlink:href="pone.0231738.g001"/>
    </fig>
    <p>The first source of ambiguity is probably the most well-known and hard to tackle. Some sRNAs are known to co-localize with duplicated regions (such as piRNAs or siRNAs), or to be included into duplicated genes (miRNAs and tsRNAs). To circumvent these problems, several strategies were used:</p>
    <list list-type="bullet">
      <list-item>
        <p>discard multi-mapping reads,</p>
      </list-item>
      <list-item>
        <p>use a random hit,</p>
      </list-item>
      <list-item>
        <p>weight each hit (if a read maps <italic>n</italic> times, each hit counts for 1/<italic>n</italic>).</p>
      </list-item>
    </list>
    <p specific-use="continuation">However, every strategy presents obvious biases. The first strategy discards a usually sizeable proportion of the reads, the second one makes a random guess, and the last one may over-estimate the wrong classes, whereas it under-estimates the true class. Note that if a gene is duplicated, and a read maps uniquely to both of the duplicated genes, the two last strategies do work and provide the expected quantification.</p>
    <p>There is, in principle, a fourth strategy, implemented by tools such as MMR [<xref rid="pone.0231738.ref007" ref-type="bibr">7</xref>]. MMR infers an optimal mapping location for a read, based on the expression of the putative <italic>loci</italic>. However, MMR, developed for long RNA sequencing, supposes that the distribution of reads is somewhat constant over a transcript. This is far from true in short RNA-Seq reads, especially for sRNAs silencing genes, where only a small region is targeted. Second, the real advantage of MMR is that it uses the coverage observed from non-ambiguous regions, to infer the read distribution over ambiguous regions. This strategy cannot simply work for miRNAs, where each read occupies the full length of the mature transcript.</p>
    <p>A final strategy, implemented in ShortStack [<xref rid="pone.0231738.ref008" ref-type="bibr">8</xref>], adapts the previous idea to sRNA-Seq. Here, the estimation of the profile expression models the highly irregular expression profile, which is used to assign the multi-mapping reads.</p>
    <p>Some papers, such as [<xref rid="pone.0231738.ref009" ref-type="bibr">9</xref>], use a radically different pipe-line. They first collect different nucleotidic databases (usually, one for each class), then map the reads to the databases. A read mapping to the database of a given class suggests that the read belongs to this class. However, this pipe-line does not solve <italic>per se</italic> the problem of the multi-mapping reads, since one read can map to several databases.</p>
    <p>The second source of ambiguity, where several annotations overlap, may have two causes. First, there may be an inconsistency in the annotation. For instance, miRNAs are not known to co-localize with snoRNAs. However, we found that snoRNAs are sometimes detected as miRNAs, and so the two annotations may conflict in the same annotation data set. Second, the annotations may be on different levels. For instance, a miRNA may be localized inside an intron. If the user finds a read overlapping a miRNA which is an intron, the read will be probably attributed to the miRNA, and not to the intron.</p>
    <p>The last source of ambiguity may arise when the annotations are not correctly defined.</p>
    <p>Although these ambiguities do exist in the (long) RNA-Seq context, usual RNA-Seq quantification tools, such as featureCounts [<xref rid="pone.0231738.ref010" ref-type="bibr">10</xref>], cannot be readily used. First, these quantification tools count the number of reads per gene, and not per class. Second, regions producing small RNAs, such as introns and gene flanking regions, are not present in the annotation files, and are thus disregarded by these tools. Third, quantification tools usually expect the library to be stranded, or unstranded. Therefore, it is not (directly) possible to quantify reads which are antisense with respect to a gene, and the reads that can adopt any direction (for instance, in flanking regions), in a single run. Last, multi-mapping reads are usually discarded (this is the default behavior), or counted once per gene.</p>
    <p>To solve these ambiguities, we propose a new strategy which is implemented into a sRNA class quantification tool, called mmannot. mmannot is freely available at <ext-link ext-link-type="uri" xlink:href="https://github.com/mzytnicki/mmannot">https://github.com/mzytnicki/mmannot</ext-link>. In this work, we compared mmannot with the other five methods described here.</p>
  </sec>
  <sec sec-type="results" id="sec002">
    <title>Results</title>
    <p>We compared our method with other possible approaches on several real-world, publicly available data sets, encompassing several organisms: <italic>Arabidopsis thaliana</italic> (see <xref ref-type="fig" rid="pone.0231738.g002">Fig 2</xref>), <italic>Homo sapiens</italic> (see <xref ref-type="fig" rid="pone.0231738.g003">Fig 3</xref>), <italic>Danio rerio</italic> (see <xref ref-type="fig" rid="pone.0231738.g004">Fig 4</xref>), and <italic>Sus scrofa</italic> (see <xref ref-type="fig" rid="pone.0231738.g005">Fig 5</xref>). We also benchmarked our tool on a synthetic data set that we generated (see <xref ref-type="fig" rid="pone.0231738.g006">Fig 6</xref>).</p>
    <fig id="pone.0231738.g002" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pone.0231738.g002</object-id>
      <label>Fig 2</label>
      <caption>
        <title>Comparison of the different strategies on the <italic>A. thaliana</italic> data sets.</title>
        <p>Each chart provides the result on one sequencing data set, using the previous strategies presented before. The “unique” strategy only considers uniquely mapping reads. The “random” strategy chooses arbitrarily a hit for each read. The “ratio” strategy counts 1/<italic>n</italic> per feature, if a read maps <italic>n</italic> times. Our method uses BWA for read mapping, and is named “mmannot BWA”. In the “mmannot rev” lines, the order of the lines of the configuration files are reversed. The “mmannot bowtie” line gives the result of the “mmannot” strategy using bowtie instead of BWA for mapping reads. The “ShortStack”, “MMR”, and “featureCounts” columns gives the annotation results, based on their strategies. Last, we mapped the reads to sequences of sRNAs (instead of the genome), and provided the results in the “sequence” bars. Each column provides the percentage of reads, classified by annotation. The ambiguous category includes hits that overlap several annotations. sRNAs with low counts were grouped into the category “other”. The dots in the bars provide the percentages of the reads that where annotated.</p>
      </caption>
      <graphic xlink:href="pone.0231738.g002"/>
    </fig>
    <fig id="pone.0231738.g003" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pone.0231738.g003</object-id>
      <label>Fig 3</label>
      <caption>
        <title>Comparison of the different strategies on the <italic>H. sapiens</italic> data sets.</title>
        <p>See <xref ref-type="fig" rid="pone.0231738.g002">Fig 2</xref> for a legend of the plot.</p>
      </caption>
      <graphic xlink:href="pone.0231738.g003"/>
    </fig>
    <fig id="pone.0231738.g004" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pone.0231738.g004</object-id>
      <label>Fig 4</label>
      <caption>
        <title>Comparison of the different strategies on the <italic>D. rerio</italic> data sets.</title>
        <p>See <xref ref-type="fig" rid="pone.0231738.g002">Fig 2</xref> for a legend of the plot.</p>
      </caption>
      <graphic xlink:href="pone.0231738.g004"/>
    </fig>
    <fig id="pone.0231738.g005" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pone.0231738.g005</object-id>
      <label>Fig 5</label>
      <caption>
        <title>Comparison of the different strategies on the <italic>S. scrofa</italic> data sets.</title>
        <p>See <xref ref-type="fig" rid="pone.0231738.g002">Fig 2</xref> for a legend of the plot.</p>
      </caption>
      <graphic xlink:href="pone.0231738.g005"/>
    </fig>
    <fig id="pone.0231738.g006" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pone.0231738.g006</object-id>
      <label>Fig 6</label>
      <caption>
        <title>Comparison of the different strategies on the simulated data sets.</title>
        <p>The results of all but the last bars are explained in <xref ref-type="fig" rid="pone.0231738.g002">Fig 2</xref>. The “truth” bar gives the fraction of each sRNA class generated by our method.</p>
      </caption>
      <graphic xlink:href="pone.0231738.g006"/>
    </fig>
    <sec id="sec003">
      <title>Mapping only unique reads provides a highly distorted image of the sRNA class repertoire</title>
      <p>Strikingly, the “unique” method provides very biased results in terms of representative percentage of the class. For the <italic>A. thaliana</italic> data sets (see <xref ref-type="fig" rid="pone.0231738.g002">Fig 2</xref>), the “unique” strategy annotates around 40% of reads as miRNAs, whereas the other strategies, when considering multi-mapping reads, annotate only around 20% of the reads in the miRNA class. Indeed, multi-mapping aware strategies can annotate the numerous reads produced by the highly repeated ribosomal RNA, and mmannot also annotates a high percentage of ambiguous reads. Moreover, we found that the “unique” method finds that between 126 and 137 miRNAs are expressed, whereas mmannot finds 149–159 expressed miRNAs. Whereas this difference is not great, one miRNA family, <italic>miR157</italic>, which contains three members exactly duplicated in the genome, produces 35k to 110k reads. Missing only one miRNA family (but several genomic loci) may have a dramatic influence on the results.</p>
      <p>Likewise, the proportion of miRNAs are over-estimated in the human and the zebrafish data sets.</p>
      <p>As a result, using uniquely mapping reads only provides a highly distorted image of the complete sRNA class repertoire associated to a data set.</p>
    </sec>
    <sec id="sec004">
      <title>Multi-mapping aware strategies increase the number of annotated reads</title>
      <p>For all data sets, using multi-mapping strategies increases considerably the percentage of annotated reads, showing that the repertoire of expressed regions is largely associated to repeated regions in all genomes. For the <italic>A. thaliana</italic> data set, the number of annotated reads is 0.8–1.8M using the “unique” strategy, whereas it is 1.4M–3.0M for featureCounts, 2.1M–4.4M for MMR, 2.1M–4.3M for ShortStack, 2.2M–4.5M for the “random” and “ratio” strategies, and 2.5M–5.2M using mmannot. The “sequence” strategy gives similar results as mmannot.</p>
      <p>All the other real-life benchmarks rank the tools similarly. The “unique” and “featureCounts” use the least number of reads (since they behave similarly). “mmannot” and “sequence” use the greatest number of reads.</p>
      <p>Some multi-mapping reads may have hits that do not co-localize with any annotation. These reads may be unannotated by the “random” strategy, and the associated weight in the “ratio” strategy is lost. These reads can also be misplaced by MMR and ShortStack. As a consequence, some of these reads are not quantified, resulting in less annotated reads. In the “mmannot” strategy, all the hits of a read are compared with an annotation, and used to annotate the read.</p>
      <p><xref ref-type="fig" rid="pone.0231738.g007">Fig 7</xref> displays the actual annotation rate —the number of reads used for the annotation, divided by the number of reads sequenced— on all the datasets. Notice that the actual annotation rate is impacted by the sequencing quality, since low quality reads are removed during preliminary filtering (see Supporting Information for the quality filters used), and are often unable to map to the genome. The <italic>H. sapiens</italic> dataset provides the best annotation rate (almost up to 100%), because the quality of the reads is extremely good (we cannot exclude that low quality reads have been removed by the sequencing facility), and because the annotation is also exhaustive. <xref ref-type="fig" rid="pone.0231738.g007">Fig 7</xref> confirms that mmannot gives the best annotation rates, together with the “sequence” method, while the “unique” and “featureCounts” methods provide worst results.</p>
      <fig id="pone.0231738.g007" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0231738.g007</object-id>
        <label>Fig 7</label>
        <caption>
          <title>Actual annotation rates of the methods.</title>
          <p>The actual annotation rate is the number of reads used for the annotation, divided by the number of reads sequenced. The bars give the minimum and the maximum annotation rates for each method.</p>
        </caption>
        <graphic xlink:href="pone.0231738.g007"/>
      </fig>
      <p>Finally, we wanted to confirm that mmannot uses significantly more reads than other methods. We performed a one-sided Wilcoxon signed-rank test between the number of reads used by mmannot on all datasets, and the number of reads used by the other methods. Results, shown in <xref rid="pone.0231738.t001" ref-type="table">Table 1</xref>, clearly show that mmannot significantly uses more reads. Note, however, that the “MMR” and “sequence” methods seem to give slightly better results than other methods. This is however, only caused by the fact that these methods could not be used for the <italic>H. sapiens</italic> dataset. The test is thus less powerful in these cases.</p>
      <table-wrap id="pone.0231738.t001" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0231738.t001</object-id>
        <label>Table 1</label>
        <caption>
          <title>Statistical evidence that mmannot significantly more reads.</title>
          <p>For each method, we tested whether our method uses significantly more reads with a one-sided Wilcoxon signed-rank test. Each column is a method to which we compared mmannot. The second row gives the p-value of the test. We did not compare with the “mmannot rev” method, because the number of reads used is exactly the same.</p>
        </caption>
        <alternatives>
          <graphic id="pone.0231738.t001g" xlink:href="pone.0231738.t001"/>
          <table frame="box" rules="all" border="0">
            <colgroup span="1">
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th align="left" style="border-right:thick;border-bottom:thick" rowspan="1" colspan="1">method</th>
                <th align="center" style="border-bottom:thick" rowspan="1" colspan="1">unique</th>
                <th align="center" style="border-bottom:thick" rowspan="1" colspan="1">random</th>
                <th align="center" style="border-bottom:thick" rowspan="1" colspan="1">ratio</th>
                <th align="center" style="border-bottom:thick" rowspan="1" colspan="1">mmannot bowtie</th>
                <th align="center" style="border-bottom:thick" rowspan="1" colspan="1">ShortStack</th>
                <th align="center" style="border-bottom:thick" rowspan="1" colspan="1">MMR</th>
                <th align="center" style="border-bottom:thick" rowspan="1" colspan="1">featureCounts</th>
                <th align="center" style="border-bottom:thick" rowspan="1" colspan="1">sequence</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" style="border-right:thick" rowspan="1" colspan="1">
                  <bold>p-value</bold>
                </td>
                <td align="center" rowspan="1" colspan="1">1.10<sup>−6</sup></td>
                <td align="center" rowspan="1" colspan="1">1.10<sup>−6</sup></td>
                <td align="center" rowspan="1" colspan="1">1.10<sup>−6</sup></td>
                <td align="center" rowspan="1" colspan="1">4.10<sup>−6</sup></td>
                <td align="center" rowspan="1" colspan="1">4.10<sup>−6</sup></td>
                <td align="center" rowspan="1" colspan="1">2.10<sup>−4</sup></td>
                <td align="center" rowspan="1" colspan="1">4.10<sup>−6</sup></td>
                <td align="center" rowspan="1" colspan="1">2.10<sup>−4</sup></td>
              </tr>
            </tbody>
          </table>
        </alternatives>
      </table-wrap>
      <p>Thus, mmannot improves considerably our knowledge of the structural and functional annotation of the gene repertoire associated to small RNA-seq data sets.</p>
    </sec>
    <sec id="sec005">
      <title>mmannot controls the number of misplaced reads</title>
      <p>The “random” strategy randomly places reads. As seen in <xref ref-type="fig" rid="pone.0231738.g008">Fig 8</xref>, this method yields a high number of false negatives. ShortStack and MMR can be seen as improvements of the previous method, as they try to place reads in the most likely locus. However, as seen on the same figure, these methods sometimes provide wrong results. About 10% of the reads are either placed in a locus that contains another annotation, or placed in a locus that contains no annotation. With mmannot, the right annotation is almost always given.</p>
      <fig id="pone.0231738.g008" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0231738.g008</object-id>
        <label>Fig 8</label>
        <caption>
          <title>Results on the simulated data set.</title>
          <p>The number of true positives (#TP), false positives (#FP), and false negatives (#FN) are given for each method. We classified a multi-mapping read as true positive if at least one of the annotation given by mmannot is the correct one.</p>
        </caption>
        <graphic xlink:href="pone.0231738.g008"/>
      </fig>
      <p>The “sequence” method maps many reads, but it also randomly attributes multi-mapping reads. Strikingly, the profile displayed by this method on the zebrafish and pig stands out, and are probably mis-annotations, although the synthetic data set does not detect many wrongly mapped reads.</p>
    </sec>
    <sec id="sec006">
      <title>Both mapping tools yield similar results</title>
      <p>Results on almost all datasets show that BWA maps slightly more reads. Moreover, BWA also provides much more hits per read than bowtie. This is a probably an advantage for BWA. However, the number of misplaced reads is close to zero in both cases (see <xref ref-type="fig" rid="pone.0231738.g008">Fig 8</xref>). Our results show that both tools give a similar picture of the sRNA repertoire.</p>
      <p>The only exception is <italic>D. rerio</italic>, where BWA maps substantially more reads, and most of these reads are ambiguous. After inspection of these reads, we discovered that these reads match highly repeated regions: they match piRNA annotations, as well as gene flanking regions and introns. This confirms that BWA can find more hits per read than bowtie.</p>
      <p>Note that choosing other parameters for the mapping tools could lead to dramatic changes in the results. Exploring the space of possible parameters is out of the scope of this article, even though we believe that the parameters we have chosen yield close to optimum results.</p>
    </sec>
    <sec id="sec007">
      <title>Changing the order of the priorities does not change the quantification profile given by mmannot</title>
      <p>The data sets show the quantification of the sRNA classes for two types of configuration files. The “mmannot BWA” uses a somewhat expected configuration file, where one read mapping both a miRNA and a piRNA would count for a miRNA. We reversed the ordering of the priorities in the “rev” columns. Strikingly, the results do not significantly differ.</p>
      <p>The only exception is the human data set. Using the expected configuration file, the number of miRNAs is strictly greater than the number of piRNA. However, using the reverse configuration file, the number of piRNAs is much greater. To understand why, we compared the miRNA and the piRNA annotations. It turns out that 1178 out of the 3934 annotated miRNAs overlap a piRNA annotation. The most likely reason is that a great fraction of the piRNAs are probably mis-annotated, and using a meaningful configuration file is sometimes crucial for the analysis of small RNAs.</p>
    </sec>
    <sec id="sec008">
      <title>mmannot predictions are more comprehensive</title>
      <p>As seen on <xref ref-type="fig" rid="pone.0231738.g008">Fig 8</xref>, only mmannot and the “sequence” strategy give no false negatives. Of note, MMR and ShortStack quantifications are correct in general (see <xref ref-type="fig" rid="pone.0231738.g006">Fig 6</xref>). However, individual reads are sometimes attributed to the wrong class. This observation is a direct consequence of the wrongly guessed placement of the reads. This can be a problem when the user wants to inspect the localizations of a given multi-mapping read.</p>
    </sec>
    <sec id="sec009">
      <title>All strategies leave a high number of reads unannotated</title>
      <p>Whatever the multi-mapping strategy used, or the organism under study, all data sets show a high percentage of reads that are located in intergenic regions, located away from upstream and downstream regions, and for which no annotation is available (up more than 20% for <italic>A. thaliana</italic>). This lack of annotation is partially resolved with ambiguous annotations for <italic>D. rerio</italic> data sets (where about 25% of the reads are annotated as ambiguous).</p>
    </sec>
    <sec id="sec010">
      <title>Analysis of the ambiguous reads of <italic>A. thaliana</italic> data set</title>
      <p>We focused on the ambiguous reads of the <italic>A. thaliana</italic> data set in order to analyze their origin in that organism. Most of them come from downstream–upstream regions, which are probably intergenic duplicated regions. Then, the most frequent ambiguous annotations involve a transcribed region within the downstream, upstream, or intron regions. These elements might be produced by the unannotated regions to target genes, or belong to a non-functional genomic duplication. Interestingly, the most frequent ambiguous annotation involving two transcribed regions is miRNA–gene (−). In plants, a miRNA and its target may be 100% identical, and this poses a real problem to the annotation of the reads. We decided to study the pairs of miRNAs–genes that were involved in this class, with at least 100 reads supporting this association. We found well-known miRNAs and their targets: <italic>miR156</italic>/<italic>miR157</italic> with <italic>SPL</italic> [<xref rid="pone.0231738.ref011" ref-type="bibr">11</xref>], <italic>miR163</italic> with <italic>PXMT1</italic> [<xref rid="pone.0231738.ref012" ref-type="bibr">12</xref>], <italic>miR171</italic> with <italic>ATHAM</italic> [<xref rid="pone.0231738.ref013" ref-type="bibr">13</xref>], <italic>miR400</italic> with <italic>PPR1</italic> [<xref rid="pone.0231738.ref014" ref-type="bibr">14</xref>], <italic>miR403</italic> with <italic>Ago2</italic> [<xref rid="pone.0231738.ref015" ref-type="bibr">15</xref>] and <italic>miR824</italic> with <italic>AGL</italic> [<xref rid="pone.0231738.ref016" ref-type="bibr">16</xref>]. Note that these reads cannot be correctly annotated by any other method, and the expression of the miRNAs are thus under-estimated.</p>
    </sec>
  </sec>
  <sec sec-type="conclusions" id="sec011">
    <title>Discussion</title>
    <p>A high proportion of reads produced by sRNA-Seq maps to multiple loci, and this poses a major challenge to the annotation and quantification tasks. As a result, all the reads cannot be unambiguously annotated. To date, most of the tools do not report these ambiguous reads, because they remove these reads, or they weight the expression of the possible targets, using a model which can, or cannot be verified. We present here a new method, mmannot, which improves the sRNA annotation step, and improves the reliability of the small RNA feature quantification. The power of mmannot resides in a strategy that combines an effective use of multi-mapping reads and an on-the-fly annotation merging. Compared to the other strategies described in this paper, but also considering other strategies such as RSEM [<xref rid="pone.0231738.ref017" ref-type="bibr">17</xref>], the advantage of mmannot over the other methods is sixfold. First, mmannot introduces no bias in the annotation, as it does not favor less duplicated classes. Second, it uses more reads than any other method to annotate the sRNA transcriptome. Third, it provides the proportion of reads that are actually ambiguous (something that the other methods cannot control). Fourth, mmannot has a better sensitivity and specificity than all other methods. Fifth, since it clearly pinpoints the annotations that are involved in these ambiguous reads, mmannot suggests candidates for possible regulatory RNAs, together with their targets. Sixth, it also identifies possible suspicious annotations, which are revealed by unexpected merged features. We hope that this method will contribute to the understanding of the repeated, dark matter of the genomes.</p>
    <p>By nature, mmannot heavily rely on the accuracy of the available annotation. We saw, on the human data set, that the piRNA annotation might be flawed, and this dramatically alters the read annotation produced by our method. However, a simple, common-sense, ordering of the annotation types (favor “miRNA” when a read overlaps a miRNA annotation and a piRNA annotation) produces the expected results. Alternatively, discarding unexpected annotations (<italic>e.g</italic>. piRNAs in brain) might also be a sensible method.</p>
    <p>In the future, we would like to find a way to optimally sort the annotation types. Most annotation methods, including mmannot, use simple rules for annotating the reads, mostly based on priorities given to annotation types. For instance, a read co-localizing with a miRNA and an intron is annotated as “miRNA”. Whereas simple rules exist (“miRNA” &gt; “introns”), other rules are arbitrary (“miRNA” is not comparable with “snoRNA”). In this article, we used an arbitrary ordering of the annotation types. We showed that mmannot gives similar results, even when the ordering is altered. However, finding a good set of rules would be desirable for this task.</p>
  </sec>
  <sec sec-type="materials|methods" id="sec012">
    <title>Materials and methods</title>
    <sec id="sec013">
      <title>Solving different sources of ambiguity</title>
      <p>To solve the first source of ambiguity, we provide a new method inspired by [<xref rid="pone.0231738.ref018" ref-type="bibr">18</xref>] which works on read annotation. Briefly, our method scans all the hits of a given read. If all the hits belong to the same annotation class and/or some of them are orphan of annotation, the read is annotated accordingly. Otherwise, the read is declared ambiguous, and all related annotations are provided. This method has several advantages:</p>
      <list list-type="bullet">
        <list-item>
          <p>it is less biased,</p>
        </list-item>
        <list-item>
          <p>it makes use of all the reads,</p>
        </list-item>
        <list-item>
          <p>since ambiguous annotations are reported, related loci can be inspected,</p>
        </list-item>
        <list-item>
          <p>it makes use of all the hits.</p>
        </list-item>
      </list>
      <p>The second source of ambiguity usually comes when different annotations classes overlap. In that case, our strategy consists in ordering the types of annotation. For example, users can decide that miRNAs have a higher rank than introns, and thus this ambiguity is solved. On the other hand, if miRNAs and another class such as snoRNAs have the same rank and a read overlaps both, the read will be declared ambiguous.</p>
      <p>To solve the last source of ambiguity, where a read overlaps several annotations, the user can provide an overlap threshold, expressed in number of nucleotides or percentage of the size of the read. If the size of the overlap is lower than the threshold, the annotation is not considered. If several annotations can still be assigned to the read, the read is declared ambiguous, as previously.</p>
    </sec>
    <sec id="sec014">
      <title>Annotation strategy</title>
      <p>mmannot requires three input files, and proceeds in three main steps (see <xref ref-type="fig" rid="pone.0231738.g009">Fig 9</xref>):</p>
      <list list-type="bullet">
        <list-item>
          <p>First, mmannot parses a configuration file.</p>
        </list-item>
        <list-item>
          <p>Second, mmannot parses the annotation file (given by the user) and stores the annotation into memory.</p>
        </list-item>
        <list-item>
          <p>Third, mmannot reads the read file, and annotates each read.</p>
        </list-item>
      </list>
      <p specific-use="continuation">Notice that some annotations are missing from a standard annotation file: introns and proximal regions are usually not mentioned, because they can be inferred from the provided annotations. To this end, mmannot automatically extracts introns of the features selected by the users, and adds them in the in-memory annotation data set (leaving the input file unchanged). Similarly, coding sequences (CDS), 5’ and 3’ untranslated regions (UTRs), down- and upstream regions of the annotations (the size of the down- and upstream regions are defined by the user) can be extracted. The user can also specify a strand orientation of the read with respect to the annotation (collinear or antisense). This way, intronic, sense, antisense, down- and upstream regions can also be quantified. <xref ref-type="fig" rid="pone.0231738.g009">Fig 9A</xref> presents a simple GTF file, which contains one coding gene and five miRNAs. The source field (the second field) is not provided, and the feature field gives the annotation type.</p>
      <fig id="pone.0231738.g009" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0231738.g009</object-id>
        <label>Fig 9</label>
        <caption>
          <title>Detail of the mmannot process.</title>
          <p><italic>(A)</italic> Simple GTF file, which contains one coding gene and five miRNAs. <italic>(B)</italic> Excerpt of an mmannot configuration file. <italic>(C)</italic> Genomic localization of the annotation and the reads (for space reasons, the figure is not on scale). <italic>(D)</italic> Read annotation. <italic>(E)</italic> Quantification. <italic>(F)</italic> Feature quantification.</p>
        </caption>
        <graphic xlink:href="pone.0231738.g009"/>
      </fig>
      <p>A configuration file (<xref ref-type="fig" rid="pone.0231738.g009">Fig 9B</xref>) is also required to select the annotations that should be quantified. The first section, <monospace>Introns</monospace>, provides the list of the features where the introns will be extracted. Here, a gene is automatically reconstructed from the GTF file, where the feature is <monospace>exon</monospace>. The next section, <monospace>Vicinity</monospace>, provides the list of the features where the up- and down-stream regions will be extracted. The 5’ and 3’ UTRs of the gene also are automatically inferred. The last section, <monospace>Order</monospace>, provides the features that will be quantified. The colon (:) is the separator between the source field (<italic>i.e</italic>. the second columns of the GTF file) and the feature field (the third column of the GTF file). <monospace>.:CDS</monospace> thus means source. and feature <monospace>CDS</monospace>. As a result, if the line <monospace>.:CDS</monospace> is provided in the <monospace>Order</monospace> section, mmannot will count the number of reads that co-localize with all the annotations with feature <monospace>CDS</monospace> present in the annotation file. If a feature is followed by the plus (<monospace>+</monospace>) sign, like <monospace>.:CDS +</monospace>, mmannot will only count reads which are collinear with the annotation. In this context, a read in the plus strand overlapping with a CDS in the minus strand would not be used for the quantification. If a feature is followed by the minus (<monospace>-</monospace>) sign, mmannot will only count reads which are antisense with respect to the annotation. The annotation are ordered by priority, so that <monospace>CDS +</monospace> is before <monospace>intron</monospace> in the example given in <xref ref-type="fig" rid="pone.0231738.g009">Fig 9B</xref>. However, since <monospace>CDS +</monospace> and <monospace>5’UTR</monospace> are on the same line, they have the same priority.</p>
      <p>Read annotation proceeds in two steps. The first step aims at finding the matching annotations of a given hit (<xref ref-type="fig" rid="pone.0231738.g009">Fig 9C</xref>). If a hit matches several different annotations, the annotation with highest priority is kept (e.g. read C in the example). If several annotations have the same priority, then all of them are kept and the hit is already ambiguous (read E in the example). In the example, the annotations related to the gene are provided in shades of green and black. The miRNAs are in red, and reads, in yellow, are labelled A to G. Note that reads D, F, and G appear twice, because they can be mapped at two different locations. The reads are supposed to be stranded, and the arrow indicates the strand.</p>
      <p>The second step resolves the ambiguities and annotates each read. The general method is:</p>
      <list list-type="bullet">
        <list-item>
          <p>If a read maps uniquely, with no ambiguity, the count of the corresponding annotation is incremented.</p>
        </list-item>
        <list-item>
          <p>If a read maps at different locations, but all the hits match the same annotation, the read is declared <italic>rescued</italic>, and the corresponding annotation count is also incremented (read D). Likewise, if a read maps only one annotation and intergenic regions, then the read belongs to this annotation, and the read is rescued.</p>
        </list-item>
        <list-item>
          <p>If the read or a hit overlaps several annotations, the annotations with highest priority are kept. However, if there is only one annotation with highest priority, the read or the hit is not ambiguous.</p>
        </list-item>
        <list-item>
          <p>Otherwise, there is an ambiguity. A new annotation type, called a <italic>merged annotation</italic>, is created. It is the concatenation of the matching annotations (as suggested in [<xref rid="pone.0231738.ref018" ref-type="bibr">18</xref>]), and its count is incremented.</p>
        </list-item>
      </list>
      <p specific-use="continuation">The annotation table (<xref ref-type="fig" rid="pone.0231738.g009">Fig 9D</xref>) can be provided by mmannot.</p>
      <p>In the example, the read A only maps one region, which only overlaps the upstream region of the gene. It can thus be unambiguously attributed to this feature. The read B uniquely overlaps the CDS of the gene. However, the read is in the − strand, and the gene is on the + strand. The configuration file specifies that only collinear reads should be attributed to the CDS, and thus this case cannot apply. However, the line <monospace>gene -</monospace> of the configuration file qualifies and the read is attributed to this feature. The read C uniquely maps to a miRNA and an intron. Since the miRNA has a higher priority, the read is attributed to this feature. The read D maps at two different locations, but both these locations overlap a miRNA. The read can still be attributed to a miRNA, and mmannot mentions that this read has been <italic>rescued</italic>. Read E overlaps a CDS and a miRNA, and these annotations have the same priority. The ambiguity cannot be resolved, and we attribute E to <monospace>CDS (+)-miRNA</monospace>. Read F maps at two different locations. The first location overlaps the 3’UTR, whereas the second location overlaps a miRNA. Again, the ambiguity cannot be resolved, and we attribute F to <monospace>3’UTR (+)-miRNA</monospace>. Last, G overlaps the 5’UTR and an intergenic region. In this case, we assign G to 5’UTR and we declare the read rescued.</p>
      <p>After having scanned all the reads, the quantification table is produced (<xref ref-type="fig" rid="pone.0231738.g009">Fig 9E</xref>).</p>
      <p>The feature quantification table (<xref ref-type="fig" rid="pone.0231738.g009">Fig 9F</xref>) can also be provided by mmannot. It counts the number of reads per (possibly merged) feature. Here, the user can pinpoint that there may be some interaction between miRNA E and the 3’UTR, and a possible inconsistency between the annotations of the CDS and miRNA B.</p>
    </sec>
    <sec id="sec015">
      <title>Details of the implementation</title>
      <p>The algorithm used by mmannot is the following. mmannot scans the annotation file, extracts annotation intervals, sorts them, and stores them into non-overlapping bins. mmannot then reads the mapped read file, extracts the possibly overlapping bins, and compares the related annotations with the read. The matching annotations of a given read are kept into memory. When the last hit is scanned, the count of the (possibly merged) annotation is increased, and the read information is discarded from memory. In practice, the search is approximately linear with respect to the number of reads. mmannot can run on a standard computer, and each SAM/BAM file can be scanned by a dedicated thread.</p>
      <p>mmannot either supposes that the <monospace>NH</monospace> tag of the input SAM/BAM mapped read file provides the number of hits per read, or that the alternative hits are given in the <monospace>XA</monospace> tag. Unfortunately, some widely used mapping tools such as bowtie [<xref rid="pone.0231738.ref006" ref-type="bibr">6</xref>] use one line per hit, and do not set the <monospace>NH</monospace> tag. We provide a companion tool that reads the SAM output file of bowtie and adds the correct <monospace>NH</monospace> tag. mmannot may produce three different output files.</p>
      <p>The first file is the count table, which includes merged annotations. The second (optional) file provides the quantification of all the annotations (<xref ref-type="fig" rid="pone.0231738.g009">Fig 9F</xref>). This file provides detailed information of merged features, and makes it possible to investigate possible interactions between the features, or to correct the annotation. The third (optional) file gives the matching annotations of every read (<xref ref-type="fig" rid="pone.0231738.g009">Fig 9D</xref>). This file makes it possible to manually inspect all the reads that support a merged feature.</p>
    </sec>
    <sec id="sec016">
      <title>Data used</title>
      <p>We used published data sets, covering several eukaryotic organisms, where the related articles provided a quantification of the expression of the sRNA classes. <xref rid="pone.0231738.t002" ref-type="table">Table 2</xref> summarizes the data used.</p>
      <table-wrap id="pone.0231738.t002" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0231738.t002</object-id>
        <label>Table 2</label>
        <caption>
          <title>Data used.</title>
          <p>For each experiment, the reads were annotated using mmannot and available annotation files. The meaning of each row follows. 1: Organism. 2: SRA id. 3: Related publication. 4: Tissue from which the RNA was extracted. 5: Number of sRNA-Seq data sets. 6: Number of reads per sample. 7: Percentage of reads which passed the quality threshold. 8: Number of mapped reads (given by BWA) in each data set. 9: Percentage of unmapped reads, <italic>i.e</italic>. the proportion of reads that cannot be placed on the genome. 10: Number of hits, <italic>i.e</italic>. the number of possible positions for the reads (given by BWA). 11: Number of features in the annotation, extracted from the annotation file. 12: Time spent by mmannot for each data set, in minutes.</p>
        </caption>
        <alternatives>
          <graphic id="pone.0231738.t002g" xlink:href="pone.0231738.t002"/>
          <table frame="box" rules="all" border="0">
            <colgroup span="1">
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th align="left" style="border-right:thick;border-bottom:thick" rowspan="1" colspan="1">Organism</th>
                <th align="center" style="border-bottom:thick" rowspan="1" colspan="1">
                  <italic>A. thaliana</italic>
                </th>
                <th align="center" style="border-bottom:thick" rowspan="1" colspan="1">
                  <italic>D. rerio</italic>
                </th>
                <th align="center" style="border-bottom:thick" rowspan="1" colspan="1">
                  <italic>H. sapiens</italic>
                </th>
                <th align="center" style="border-bottom:thick" rowspan="1" colspan="1">
                  <italic>S. scrofa</italic>
                </th>
                <th align="center" style="border-bottom:thick" rowspan="1" colspan="1">Simulated</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" style="border-right:thick" rowspan="1" colspan="1">
                  <bold>SR</bold>
                </td>
                <td align="center" rowspan="1" colspan="1">SRR671950</td>
                <td align="center" rowspan="1" colspan="1">SRR1265741</td>
                <td align="center" rowspan="1" colspan="1">SRR5398624</td>
                <td align="center" rowspan="1" colspan="1">SRR1744343</td>
                <td align="center" rowspan="1" colspan="1">—</td>
              </tr>
              <tr>
                <td align="left" style="border-right:thick" rowspan="1" colspan="1"><bold>Ref</bold>.</td>
                <td align="center" rowspan="1" colspan="1">[<xref rid="pone.0231738.ref019" ref-type="bibr">19</xref>]</td>
                <td align="center" rowspan="1" colspan="1">[<xref rid="pone.0231738.ref020" ref-type="bibr">20</xref>]</td>
                <td align="center" rowspan="1" colspan="1">[<xref rid="pone.0231738.ref021" ref-type="bibr">21</xref>]</td>
                <td align="center" rowspan="1" colspan="1">[<xref rid="pone.0231738.ref022" ref-type="bibr">22</xref>]</td>
                <td align="center" rowspan="1" colspan="1">—</td>
              </tr>
              <tr>
                <td align="left" style="border-right:thick" rowspan="1" colspan="1">
                  <bold>tissue</bold>
                </td>
                <td align="center" rowspan="1" colspan="1">roots</td>
                <td align="center" rowspan="1" colspan="1">brain</td>
                <td align="center" rowspan="1" colspan="1">amygdala</td>
                <td align="center" rowspan="1" colspan="1">testis</td>
                <td align="center" rowspan="1" colspan="1">—</td>
              </tr>
              <tr>
                <td align="left" style="border-right:thick" rowspan="1" colspan="1">
                  <bold># data sets</bold>
                </td>
                <td align="center" rowspan="1" colspan="1">4</td>
                <td align="center" rowspan="1" colspan="1">6</td>
                <td align="center" rowspan="1" colspan="1">6</td>
                <td align="center" rowspan="1" colspan="1">2</td>
                <td align="center" rowspan="1" colspan="1">1</td>
              </tr>
              <tr>
                <td align="left" style="border-right:thick" rowspan="1" colspan="1">
                  <bold># reads</bold>
                </td>
                <td align="center" rowspan="1" colspan="1">4–8M</td>
                <td align="center" rowspan="1" colspan="1">3–15M</td>
                <td align="center" rowspan="1" colspan="1">12–17M</td>
                <td align="center" rowspan="1" colspan="1">6–7M</td>
                <td align="center" rowspan="1" colspan="1">5M</td>
              </tr>
              <tr>
                <td align="left" style="border-right:thick" rowspan="1" colspan="1">
                  <bold>% quality reads</bold>
                </td>
                <td align="center" rowspan="1" colspan="1">72–89%</td>
                <td align="center" rowspan="1" colspan="1">76–99%</td>
                <td align="center" rowspan="1" colspan="1">95–98%</td>
                <td align="center" rowspan="1" colspan="1">92–94%</td>
                <td align="center" rowspan="1" colspan="1">100%</td>
              </tr>
              <tr>
                <td align="left" style="border-right:thick" rowspan="1" colspan="1">
                  <bold># mapped reads</bold>
                </td>
                <td align="center" rowspan="1" colspan="1">3–6M</td>
                <td align="center" rowspan="1" colspan="1">2–13M</td>
                <td align="center" rowspan="1" colspan="1">10–17M</td>
                <td align="center" rowspan="1" colspan="1">6–7M</td>
                <td align="center" rowspan="1" colspan="1">5M</td>
              </tr>
              <tr>
                <td align="left" style="border-right:thick" rowspan="1" colspan="1">
                  <bold>% unmapped reads</bold>
                </td>
                <td align="center" rowspan="1" colspan="1">1%</td>
                <td align="center" rowspan="1" colspan="1">2–3%</td>
                <td align="center" rowspan="1" colspan="1">5–10%</td>
                <td align="center" rowspan="1" colspan="1">3%</td>
                <td align="center" rowspan="1" colspan="1">0%</td>
              </tr>
              <tr>
                <td align="left" style="border-right:thick" rowspan="1" colspan="1">
                  <bold># hits</bold>
                </td>
                <td align="center" rowspan="1" colspan="1">12–26M</td>
                <td align="center" rowspan="1" colspan="1">102–530M</td>
                <td align="center" rowspan="1" colspan="1">39–111M</td>
                <td align="center" rowspan="1" colspan="1">19–28M</td>
                <td align="center" rowspan="1" colspan="1">40M</td>
              </tr>
              <tr>
                <td align="left" style="border-right:thick" rowspan="1" colspan="1">
                  <bold># features</bold>
                </td>
                <td align="center" rowspan="1" colspan="1">512,908</td>
                <td align="center" rowspan="1" colspan="1">4,372,617</td>
                <td align="center" rowspan="1" colspan="1">13,040,803</td>
                <td align="center" rowspan="1" colspan="1">2,136,213</td>
                <td align="center" rowspan="1" colspan="1">5,770</td>
              </tr>
              <tr>
                <td align="left" style="border-right:thick" rowspan="1" colspan="1">
                  <bold>time</bold>
                </td>
                <td align="center" rowspan="1" colspan="1">1–4</td>
                <td align="center" rowspan="1" colspan="1">11–51</td>
                <td align="center" rowspan="1" colspan="1">2–66</td>
                <td align="center" rowspan="1" colspan="1">12–19</td>
                <td align="center" rowspan="1" colspan="1">6</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
      </table-wrap>
      <p>The <italic>H. sapiens</italic> data set originally contained 16 samples. We display here only the five first samples, for the sake of brevety. The other sample produce similar results.</p>
      <p>Note that at most 10% of the reads are unmapped, and the average percentage of unmapped is around 3%. Although not analyzing unmapped read may bias the results of the study, we believe that the impact is greatly limited.</p>
      <p>In this benchmark, we recorded the time spent by mmannot with the output statistics files option enabled. These files take substantial time to be computed, and mmannot is much faster with default options.</p>
      <p>The most recent annotation, from Ensembl v69 [<xref rid="pone.0231738.ref023" ref-type="bibr">23</xref>] was downloaded, except for <italic>A. thaliana</italic> (we used TAIR 10 [<xref rid="pone.0231738.ref024" ref-type="bibr">24</xref>]). We extracted all the sRNAs from the annotation, as well as CDS, UTRs, introns, and proximal regions of the coding genes (± 3kb).</p>
      <p>For <italic>D. rerio</italic>, <italic>H. sapiens</italic>, and <italic>S. scrofa</italic>, we downloaded a piRNA annotation from piRBase [<xref rid="pone.0231738.ref025" ref-type="bibr">25</xref>], and we added this annotation to the existing annotations (which usually do not include piRNAs).</p>
    </sec>
    <sec id="sec017">
      <title>Benchmarking</title>
      <p>We computed an exhaustive benchmark of our method, which assesses its performance and its robustness. Our aim was to show how each annotation strategy impacts the results of quantification in each class. We benchmarked several complex organisms, from the animal and plant reign (see <xref ref-type="fig" rid="pone.0231738.g002">Fig 2</xref>, <xref ref-type="fig" rid="pone.0231738.g004">4</xref>, <xref ref-type="fig" rid="pone.0231738.g003">3</xref> and <xref ref-type="fig" rid="pone.0231738.g005">5</xref>). We also added a synthetic data set, where the truth in known (<xref ref-type="fig" rid="pone.0231738.g006">Fig 6</xref>).</p>
      <sec id="sec018">
        <title>Evaluated features of mmannot</title>
        <p><bold>Comparison on several organisms</bold>. We compared all the methods on several organisms: <italic>A. thaliana</italic>, <italic>D. rerio</italic>, <italic>H. sapiens</italic>, and <italic>S. scrofa</italic>. These model organisms are well annotated, include a wide diversity of small RNA classes, and contain a high proportion of duplicated regions. They constitute a complex testbed for the annotation problem.</p>
        <p><bold>Comparison on a simulated data set</bold>. We generated a synthetic data set using the method developed to evaluate ShortStack [<xref rid="pone.0231738.ref008" ref-type="bibr">8</xref>]. This method provides both the reads, and the annotation. However, the annotation only consists of three types of sRNAs, and very few reads were ambiguous, contrary to our observations on the real data sets. <xref ref-type="fig" rid="pone.0231738.g008">Fig 8</xref> provides accuracies and specificities of the methods.</p>
        <p><bold>Comparison with other approaches</bold>. We first compared our results with three strategies mentioned previously also implemented in mmannot: the “unique”, the “random”, and the “ratio” strategies.</p>
        <p>We also mapped our reads using ShortStack [<xref rid="pone.0231738.ref008" ref-type="bibr">8</xref>], which provides an informed placement of the reads. ShortStack has been developed for sRNAs.</p>
        <p>We used MMR [<xref rid="pone.0231738.ref007" ref-type="bibr">7</xref>], which also provides an informed placement of the reads. Contrary to ShortStack, MMR was developed for messenger RNA-Seq. MMR was used on the reads mapped with bowtie, because it does not interpret correctly the alternative read hits as given by BWA. MMR requires a substantial amount of RAM. It exited with memory error on the human data set, after requiring more than 32GB of RAM.</p>
        <p>We also compared our tool with the widely used featureCounts [<xref rid="pone.0231738.ref010" ref-type="bibr">10</xref>], with the caveats we mentioned in the Introduction. First, we extracted the small RNA classes from the annotation file, added missing features (introns and flanking regions), and generated another annotation file in SAF format (read by featureCounts). An example script (used for the <italic>A. thaliana</italic> data set) is given as Supporting Information. Second, we used featureCounts as usual. Of note, featureCounts either discards multi-mapping reads, or counts one hit per mapping gene. We chose the first option.</p>
        <p>We also implemented a last strategy. We extracted the sequences from the previously generated annotation file, and the genome sequence. We thus built a nucleotidic database of the sequences of the regions of interest. We then mapped the reads to this database. However, we noticed an unwanted behavior: some reads, which mapped with no error on the genome (this information was given by the standard genome mapping strategy we used for mmannot), mapped with one or more errors on the database. As a result, this strategy classifies them as belonging to one of the known class, whereas they most likely come from some unknown locus. In order to avoid this bias, we also included the whole genome in the database. If a read maps to the genome and a known sRNA class (with the same number of errors), the reads will be attributed to the sRNA. If a read maps to the genome with <italic>n</italic> errors, and a known sRNA class with <italic>m</italic> &gt; <italic>n</italic> errors, the read will be declared unannotated. However, this strategy does not solve the multi-mapping problem, and a read can map to several sRNA classes. In this case, we attributed the multi-mapping read to the first class given by the mapping tool (here, BWA). The code used to generate the database, and map the reads is given in Supporting Information. Of note, this strategy requires substantially much more memory, since each read may map to the genome, and its sRNA sequence, on both strands. As a result, we could not use it on our computer on the human data set, because it required more that 32GB or RAM.</p>
        <p><bold>mmannot robustness to the ordering of the features</bold>. The configuration file sorts all the features that will be annotated and quantified (e.g. miRNAs, piRNAs, etc.). By essence, every priority scheme between the features is arbitrary. We prepared new configuration files, where the order has been reversed: all the features that were top priority are bottom priority. However, untranscribed regions (introns, downstream, upstream, intergenic) still have the lowest priorities.</p>
        <p><bold>mmannot robustness to the mapping tool</bold>. The community mainly uses two mapping tools, BWA [<xref rid="pone.0231738.ref005" ref-type="bibr">5</xref>] and bowtie [<xref rid="pone.0231738.ref006" ref-type="bibr">6</xref>]. As suggested by [<xref rid="pone.0231738.ref026" ref-type="bibr">26</xref>], we selected BWA as our primary mapping tool, but we still compared the results with bowtie.</p>
      </sec>
    </sec>
    <sec id="sec019">
      <title>Data preparation</title>
      <p>Data were imported from SRA with fastq-dump [<xref rid="pone.0231738.ref027" ref-type="bibr">27</xref>]. Adapters were trimmed with fastx clipper [<xref rid="pone.0231738.ref028" ref-type="bibr">28</xref>]. Only sequences with sizes greater than 14bp were conserved. Low complexity reads were removed by using dust [<xref rid="pone.0231738.ref029" ref-type="bibr">29</xref>]. Remaining reads were mapped with BWA [<xref rid="pone.0231738.ref006" ref-type="bibr">6</xref>]. We also mapped the reads with bowtie [<xref rid="pone.0231738.ref006" ref-type="bibr">6</xref>]. The <monospace>NH</monospace> tag was added to the SAM file provided by bowtie. Files were then sorted and converted to BAM with samtools [<xref rid="pone.0231738.ref030" ref-type="bibr">30</xref>]. Quantification of the expression of the sRNA classes was realized with mmannot using “unique”, “random” and “ratio” strategies. Our method is named “mmannot”. The mapped reads were also filtered with MMR, which gives uniquely mapping reads, then quantification was done with mmannot. We also compared mmannot with ShortStack, which also assigns reads to a unique locus, and with featureCounts, which discards multi-mapping reads. Reads were also mapped to the sequence of sRNAs using BWA (the “sequence” strategy). The simulated data set was generated by the script <monospace>sim_sRNA_library.py</monospace> [<xref rid="pone.0231738.ref008" ref-type="bibr">8</xref>], which was trained on our first <italic>A. thaliana</italic> sRNA-Seq data set and miRBase v22.1 [<xref rid="pone.0231738.ref031" ref-type="bibr">31</xref>]. We added coding genes, pseudogenes, and transposable element annotations (given by TAIR10) to the <monospace>MIRNA</monospace>, <monospace>TAS</monospace> and <monospace>HET</monospace> annotation (generated by the script).</p>
      <p>All the experiments were performed on a machine with 6 Intel Xeon CPU E5-1650 v4 cores at 3.60GHz and 32GB RAM running Ubuntu 19.04.</p>
      <p>All the commands used in this analysis are given as Supporting Information.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material" id="sec020">
    <title>Supporting information</title>
    <supplementary-material content-type="local-data" id="pone.0231738.s001">
      <label>S1 File</label>
      <caption>
        <title>Version of the tools, and scripts used in the benchmark.</title>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0231738.s001.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0231738.s002">
      <label>S2 File</label>
      <caption>
        <title>Raw expression quantification given by each method.</title>
        <p>(GZ)</p>
      </caption>
      <media xlink:href="pone.0231738.s002.gz">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ref-list>
    <title>References</title>
    <ref id="pone.0231738.ref001">
      <label>1</label>
      <mixed-citation publication-type="journal"><name><surname>Stefani</surname><given-names>G</given-names></name>, <name><surname>Slack</surname><given-names>FJ</given-names></name>. <article-title>Small non-coding RNAs in animal development</article-title>. <source>Nature Reviews Molecular Cell Biology</source>. <year>2008</year>;<volume>9</volume>:<fpage>219</fpage>–<lpage>230</lpage>. <pub-id pub-id-type="doi">10.1038/nrm2347</pub-id><?supplied-pmid 18270516?><pub-id pub-id-type="pmid">18270516</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0231738.ref002">
      <label>2</label>
      <mixed-citation publication-type="journal"><name><surname>Borges</surname><given-names>F</given-names></name>, <name><surname>Martienssen</surname><given-names>RA</given-names></name>. <article-title>The expanding world of small RNAs in plants</article-title>. <source>Nature Reviews Molecular Cell Biology</source>. <year>2015</year>;<volume>16</volume>:<fpage>727</fpage>–<lpage>741</lpage>. <pub-id pub-id-type="doi">10.1038/nrm4085</pub-id><?supplied-pmid 26530390?><pub-id pub-id-type="pmid">26530390</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0231738.ref003">
      <label>3</label>
      <mixed-citation publication-type="journal"><name><surname>Affymetrix/Cold Spring Harbor Laboratory ENCODE Transcriptome</surname><given-names>Project</given-names></name>. <article-title>Post-transcriptional processing generates a diversity of 5’-modified long and short RNAs</article-title>. <source>Nature</source>. <year>2009</year>;<volume>457</volume>:<fpage>1028</fpage>–<lpage>1032</lpage>. <pub-id pub-id-type="doi">10.1038/nature07759</pub-id><pub-id pub-id-type="pmid">19169241</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0231738.ref004">
      <label>4</label>
      <mixed-citation publication-type="journal"><name><surname>Dard-Dascot</surname><given-names>C</given-names></name>, <name><surname>Naquin</surname><given-names>D</given-names></name>, <name><surname>d’Aubenton Carafa</surname><given-names>Y</given-names></name>, <name><surname>Alix</surname><given-names>K</given-names></name>, <name><surname>Thermes</surname><given-names>C</given-names></name>, <name><surname>van Dijk</surname><given-names>E</given-names></name>. <article-title>Systematic comparison of small RNA library preparation protocols for next-generation sequencing</article-title>. <source>BMC Genomics</source>. <year>2018</year>;<volume>19</volume>:<fpage>118</fpage><pub-id pub-id-type="doi">10.1186/s12864-018-4491-6</pub-id><?supplied-pmid 29402217?><pub-id pub-id-type="pmid">29402217</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0231738.ref005">
      <label>5</label>
      <mixed-citation publication-type="journal"><name><surname>Li</surname><given-names>H</given-names></name>, <name><surname>Durbin</surname><given-names>R</given-names></name>. <article-title>Fast and accurate short read alignment with Burrows–Wheeler transform</article-title>. <source>Bioinformatics</source>. <year>2009</year>;<volume>25</volume>:<fpage>1754</fpage>–<lpage>1760</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btp324</pub-id><?supplied-pmid 19451168?><pub-id pub-id-type="pmid">19451168</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0231738.ref006">
      <label>6</label>
      <mixed-citation publication-type="journal"><name><surname>Langmead</surname><given-names>B</given-names></name>, <name><surname>Trapnell</surname><given-names>C</given-names></name>, <name><surname>Pop</surname><given-names>M</given-names></name>, <name><surname>Salzberg</surname><given-names>SL</given-names></name>. <article-title>Ultrafast and memory-efficient alignment of short DNA sequences to the human genome</article-title>. <source>Genome Biology</source>. <year>2009</year>;<volume>10</volume>:<fpage>R25</fpage><pub-id pub-id-type="doi">10.1186/gb-2009-10-3-r25</pub-id><?supplied-pmid 19261174?><pub-id pub-id-type="pmid">19261174</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0231738.ref007">
      <label>7</label>
      <mixed-citation publication-type="journal"><name><surname>Kahles</surname><given-names>A</given-names></name>, <name><surname>Behr</surname><given-names>J</given-names></name>, <name><surname>Rätsch</surname><given-names>G</given-names></name>. <article-title>MMR: a tool for read multi-mapper resolution</article-title>. <source>Bioinformatics</source>. <year>2015</year>;<volume>32</volume>:<fpage>770</fpage>–<lpage>772</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btv624</pub-id><?supplied-pmid 26519503?><pub-id pub-id-type="pmid">26519503</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0231738.ref008">
      <label>8</label>
      <mixed-citation publication-type="journal"><name><surname>Johnson</surname><given-names>NR</given-names></name>, <name><surname>Yeoh</surname><given-names>JM</given-names></name>, <name><surname>Coruh</surname><given-names>C</given-names></name>, <name><surname>Axtell</surname><given-names>MJ</given-names></name>. <article-title>Improved Placement of Multi-mapping Small RNAs</article-title>. <source>G3: Genes, Genomes, Genetics</source>. <year>2016</year>;<volume>6</volume>:<fpage>2103</fpage>–<lpage>2111</lpage>. <pub-id pub-id-type="doi">10.1534/g3.116.030452</pub-id><pub-id pub-id-type="pmid">27175019</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0231738.ref009">
      <label>9</label>
      <mixed-citation publication-type="journal"><name><surname>Vaz</surname><given-names>C</given-names></name>, <name><surname>Wee</surname><given-names>CW</given-names></name>, <name><surname>Lee</surname><given-names>GPS</given-names></name>, <name><surname>Ingham</surname><given-names>PW</given-names></name>, <name><surname>Tanavde</surname><given-names>V</given-names></name>, <name><surname>Mathavan</surname><given-names>S</given-names></name>. <article-title>Deep sequencing of small RNA facilitates tissue and sex associated microRNA discovery in zebrafish</article-title>. <source>BMC Genomics</source>. <year>2015</year>;<volume>19</volume>:<fpage>950</fpage><pub-id pub-id-type="doi">10.1186/s12864-015-2135-7</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0231738.ref010">
      <label>10</label>
      <mixed-citation publication-type="journal"><name><surname>Liao</surname><given-names>Y</given-names></name>, <name><surname>Smyth</surname><given-names>GK</given-names></name>, <name><surname>Shi</surname><given-names>W</given-names></name>. <article-title>featureCounts: an efficient general purpose program for assigning sequence reads to genomic features</article-title>. <source>Bioinformatics</source>. <year>2013</year>;<volume>30</volume>:<fpage>923</fpage>–<lpage>930</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btt656</pub-id><?supplied-pmid 24227677?><pub-id pub-id-type="pmid">24227677</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0231738.ref011">
      <label>11</label>
      <mixed-citation publication-type="journal"><name><surname>Gandikota</surname><given-names>M</given-names></name>, <name><surname>Birkenbihl</surname><given-names>RP</given-names></name>, <name><surname>Höhmann</surname><given-names>S</given-names></name>, <name><surname>Cardon</surname><given-names>GH</given-names></name>, <name><surname>Saedler</surname><given-names>H</given-names></name>, <name><surname>Huijser</surname><given-names>P</given-names></name>. <article-title>The miRNA156/157 recognition element in the 3’ UTR of the Arabidopsis SBP box gene SPL3 prevents early flowering by translational inhibition in seedlings</article-title>. <source>The Plant Journal</source>. <year>2007</year>;<volume>49</volume>:<fpage>683</fpage>–<lpage>693</lpage>. <pub-id pub-id-type="doi">10.1111/j.1365-313X.2006.02983.x</pub-id><?supplied-pmid 17217458?><pub-id pub-id-type="pmid">17217458</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0231738.ref012">
      <label>12</label>
      <mixed-citation publication-type="journal"><name><surname>Allen</surname><given-names>E</given-names></name>, <name><surname>Xie</surname><given-names>Z</given-names></name>, <name><surname>Gustafson</surname><given-names>AM</given-names></name>, <name><surname>Sung</surname><given-names>GH</given-names></name>, <name><surname>Spatafora</surname><given-names>JW</given-names></name>, <name><surname>Carrington</surname><given-names>JC</given-names></name>. <article-title>Evolution of microRNA genes by inverted duplication of target gene sequences in <italic>Arabidopsis thaliana</italic></article-title>. <source>Nature Genetics</source>. <year>2004</year>;<volume>36</volume>:<fpage>1282</fpage>–<lpage>1290</lpage>. <pub-id pub-id-type="doi">10.1038/ng1478</pub-id><?supplied-pmid 15565108?><pub-id pub-id-type="pmid">15565108</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0231738.ref013">
      <label>13</label>
      <mixed-citation publication-type="journal"><name><surname>Brodersen</surname><given-names>P</given-names></name>, <name><surname>Sakvarelidze-Achard</surname><given-names>L</given-names></name>, <name><surname>Bruun-Rasmussen</surname><given-names>M</given-names></name>, <name><surname>Dunoyer</surname><given-names>P</given-names></name>, <name><surname>Yamamoto</surname><given-names>YY</given-names></name>, <name><surname>Sieburth</surname><given-names>L</given-names></name>, <etal>et al</etal><article-title>Widespread Translational Inhibition by Plant miRNAs and siRNAs</article-title>. <source>Science</source>. <year>2008</year>;<volume>320</volume>:<fpage>1185</fpage>–<lpage>1190</lpage>. <pub-id pub-id-type="doi">10.1126/science.1159151</pub-id><?supplied-pmid 18483398?><pub-id pub-id-type="pmid">18483398</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0231738.ref014">
      <label>14</label>
      <mixed-citation publication-type="journal"><name><surname>Park</surname><given-names>YJ</given-names></name>, <name><surname>Lee</surname><given-names>HJ</given-names></name>, <name><surname>Kwak</surname><given-names>KJ</given-names></name>, <name><surname>Lee</surname><given-names>K</given-names></name>, <name><surname>Hong</surname><given-names>SW</given-names></name>, <name><surname>Kang</surname><given-names>H</given-names></name>. <article-title>MicroRNA400-Guided Cleavage of Pentatricopeptide Repeat Protein mRNAs Renders Arabidopsis thaliana More Susceptible to Pathogenic Bacteria and Fungi</article-title>. <source>Plant and Cell Physiology</source>. <year>2014</year>;<volume>55</volume>:<fpage>1660</fpage>–<lpage>1668</lpage>. <pub-id pub-id-type="doi">10.1093/pcp/pcu096</pub-id><?supplied-pmid 25008976?><pub-id pub-id-type="pmid">25008976</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0231738.ref015">
      <label>15</label>
      <mixed-citation publication-type="journal"><name><surname>Allen</surname><given-names>E</given-names></name>, <name><surname>Xie</surname><given-names>Z</given-names></name>, <name><surname>Gustafson</surname><given-names>AM</given-names></name>, <name><surname>Carrington</surname><given-names>JC</given-names></name>. <article-title>microRNA-Directed Phasing during <italic>Trans</italic>-Acting siRNA Biogenesis in Plants</article-title>. <source>Cell</source>. <year>2005</year>;<volume>121</volume>:<fpage>207</fpage>–<lpage>221</lpage>. <pub-id pub-id-type="doi">10.1016/j.cell.2005.04.004</pub-id><?supplied-pmid 15851028?><pub-id pub-id-type="pmid">15851028</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0231738.ref016">
      <label>16</label>
      <mixed-citation publication-type="journal"><name><surname>Kutter</surname><given-names>C</given-names></name>, <name><surname>Schöb</surname><given-names>H</given-names></name>, <name><surname>Stadler</surname><given-names>M</given-names></name>, <name><surname>Meins</surname><given-names>F</given-names></name>, <name><surname>Si-Ammour</surname><given-names>A</given-names></name>. <article-title>MicroRNA-Mediated Regulation of Stomatal Development in Arabidopsis</article-title>. <source>The Plant Cell</source>. <year>2007</year>;<volume>19</volume>:<fpage>2417</fpage>–<lpage>2429</lpage>. <pub-id pub-id-type="doi">10.1105/tpc.107.050377</pub-id><?supplied-pmid 17704216?><pub-id pub-id-type="pmid">17704216</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0231738.ref017">
      <label>17</label>
      <mixed-citation publication-type="journal"><name><surname>Li</surname><given-names>B</given-names></name>, <name><surname>Dewey</surname><given-names>CN</given-names></name>. <article-title>RSEM: accurate transcript quantification from RNA-Seq data with or without a reference genome</article-title>. <source>BMC Bioinformatics</source>. <year>2011</year>;<volume>12</volume>:<fpage>323</fpage><pub-id pub-id-type="doi">10.1186/1471-2105-12-323</pub-id><?supplied-pmid 21816040?><pub-id pub-id-type="pmid">21816040</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0231738.ref018">
      <label>18</label>
      <mixed-citation publication-type="journal"><name><surname>Robert</surname><given-names>C</given-names></name>, <name><surname>Watson</surname><given-names>M</given-names></name>. <article-title>Errors in RNA-Seq quantification affect genes of relevance to human disease</article-title>. <source>Genome Biology</source>. <year>2015</year>;<volume>16</volume>:<fpage>177</fpage><pub-id pub-id-type="doi">10.1186/s13059-015-0734-x</pub-id><?supplied-pmid 26335491?><pub-id pub-id-type="pmid">26335491</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0231738.ref019">
      <label>19</label>
      <mixed-citation publication-type="journal"><name><surname>Vidal</surname><given-names>EA</given-names></name>, <name><surname>Moyano</surname><given-names>TC</given-names></name>, <name><surname>Krouk</surname><given-names>G</given-names></name>, <name><surname>Katari</surname><given-names>MS</given-names></name>, <name><surname>Tanurdzic</surname><given-names>M</given-names></name>, <name><surname>McCombie</surname><given-names>WR</given-names></name>, <etal>et al</etal><article-title>Integrated RNA-seq and sRNA-seq analysis identifies novel nitrate-responsive genes in <italic>Arabidopsis thaliana</italic> roots</article-title>. <source>BMC Genomics</source>. <year>2013</year>;<volume>14</volume>:<fpage>701</fpage><pub-id pub-id-type="doi">10.1186/1471-2164-14-701</pub-id><?supplied-pmid 24119003?><pub-id pub-id-type="pmid">24119003</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0231738.ref020">
      <label>20</label>
      <mixed-citation publication-type="journal"><name><surname>Vaz</surname><given-names>C</given-names></name>, <name><surname>Wee</surname><given-names>CW</given-names></name>, <name><surname>Lee</surname><given-names>GPS</given-names></name>, <name><surname>Ingham</surname><given-names>PW</given-names></name>, <name><surname>Tanavde</surname><given-names>V</given-names></name>, <name><surname>Mathavan</surname><given-names>S</given-names></name>. <article-title>Deep sequencing of small RNA facilitates tissue and sex associated microRNA discovery in zebrafish</article-title>. <source>BMC Genomics</source>. <year>2015</year>;<volume>16</volume>:<fpage>950</fpage><pub-id pub-id-type="doi">10.1186/s12864-015-2135-7</pub-id><?supplied-pmid 26574018?><pub-id pub-id-type="pmid">26574018</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0231738.ref021">
      <label>21</label>
      <mixed-citation publication-type="journal"><name><surname>Pantano</surname><given-names>L</given-names></name>, <name><surname>Friedländer</surname><given-names>MR</given-names></name>, <name><surname>Escaramís</surname><given-names>G</given-names></name>, <name><surname>Lizano</surname><given-names>E</given-names></name>, <name><surname>Pallarès-Albanell</surname><given-names>J</given-names></name>, <name><surname>Ferrer</surname><given-names>I</given-names></name>, <etal>et al</etal><article-title>Specific small-RNA signatures in the amygdala at premotor and motor stages of Parkinson’s disease revealed by deep sequencing analysis</article-title>. <source>Bioinformatics</source>. <year>2016</year>;<volume>32</volume>:<fpage>673</fpage>–<lpage>681</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btv632</pub-id><?supplied-pmid 26530722?><pub-id pub-id-type="pmid">26530722</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0231738.ref022">
      <label>22</label>
      <mixed-citation publication-type="journal"><name><surname>Liu</surname><given-names>X</given-names></name>, <name><surname>Zhu</surname><given-names>L</given-names></name>, <name><surname>Liao</surname><given-names>S</given-names></name>, <name><surname>Xu</surname><given-names>Z</given-names></name>, <name><surname>Zhou</surname><given-names>Y</given-names></name>. <article-title>The Porcine MicroRNA Transcriptome Response to Transmissible Gastroenteritis Virus Infection</article-title>. <source>PLOS ONE</source>. <year>2015</year>;<volume>10</volume>:<fpage>1</fpage>–<lpage>16</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0231738.ref023">
      <label>23</label>
      <mixed-citation publication-type="journal"><name><surname>Aken</surname><given-names>BL</given-names></name>, <name><surname>Ayling</surname><given-names>S</given-names></name>, <name><surname>Barrell</surname><given-names>D</given-names></name>, <name><surname>Clarke</surname><given-names>L</given-names></name>, <name><surname>Curwen</surname><given-names>V</given-names></name>, <name><surname>Fairley</surname><given-names>S</given-names></name>, <etal>et al</etal><article-title>The Ensembl gene annotation system</article-title>. <source>Database</source>. <year>2016</year>;<volume>2016</volume>:<fpage>baw093</fpage><pub-id pub-id-type="doi">10.1093/database/baw093</pub-id><?supplied-pmid 27337980?><pub-id pub-id-type="pmid">27337980</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0231738.ref024">
      <label>24</label>
      <mixed-citation publication-type="journal"><name><surname>Berardini</surname><given-names>TZ</given-names></name>, <name><surname>Reiser</surname><given-names>L</given-names></name>, <name><surname>Li</surname><given-names>D</given-names></name>, <name><surname>Mezheritsky</surname><given-names>Y</given-names></name>, <name><surname>Muller</surname><given-names>R</given-names></name>, <name><surname>Strait</surname><given-names>E</given-names></name>, <etal>et al</etal><article-title>The Arabidopsis Information Resource: Making and mining the “gold standard” annotated reference plant genome</article-title>. <source>Genesis</source>. <year>2015</year>;<volume>53</volume>:<fpage>474</fpage>–<lpage>485</lpage>. <pub-id pub-id-type="doi">10.1002/dvg.22877</pub-id><?supplied-pmid 26201819?><pub-id pub-id-type="pmid">26201819</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0231738.ref025">
      <label>25</label>
      <mixed-citation publication-type="journal"><name><surname>Wang</surname><given-names>J</given-names></name>, <name><surname>Zhang</surname><given-names>P</given-names></name>, <name><surname>Lu</surname><given-names>Y</given-names></name>, <name><surname>Li</surname><given-names>Y</given-names></name>, <name><surname>Zheng</surname><given-names>Y</given-names></name>, <name><surname>Kan</surname><given-names>Y</given-names></name>, <etal>et al</etal><article-title>piRBase: a comprehensive database of piRNA sequences</article-title>. <source>Nucleic Acids Research</source>. <year>2018</year>;<volume>47</volume>:<fpage>D175</fpage>–<lpage>D180</lpage>. <pub-id pub-id-type="doi">10.1093/nar/gky1043</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0231738.ref026">
      <label>26</label>
      <mixed-citation publication-type="journal"><name><surname>Tam</surname><given-names>S</given-names></name>, <name><surname>Tsao</surname><given-names>MS</given-names></name>, <name><surname>McPherson</surname><given-names>JD</given-names></name>. <article-title>Optimization of miRNA-seq data preprocessing</article-title>. <source>Briefings in Bioinformatics</source>. <year>2015</year>;<volume>16</volume>:<fpage>950</fpage>–<lpage>963</lpage>. <pub-id pub-id-type="doi">10.1093/bib/bbv019</pub-id><?supplied-pmid 25888698?><pub-id pub-id-type="pmid">25888698</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0231738.ref027">
      <label>27</label>
      <mixed-citation publication-type="other">NCBI. SRA-Tools; 2017. <ext-link ext-link-type="uri" xlink:href="http://ncbi.github.io/sra-tools/">http://ncbi.github.io/sra-tools/</ext-link>.</mixed-citation>
    </ref>
    <ref id="pone.0231738.ref028">
      <label>28</label>
      <mixed-citation publication-type="other">The Hannon Lab. FASTX-Toolkit; 2010. <ext-link ext-link-type="uri" xlink:href="http://hannonlab.cshl.edu/fastx_toolkit/index.html">http://hannonlab.cshl.edu/fastx_toolkit/index.html</ext-link>.</mixed-citation>
    </ref>
    <ref id="pone.0231738.ref029">
      <label>29</label>
      <mixed-citation publication-type="journal"><name><surname>Morgulis</surname><given-names>A</given-names></name>, <name><surname>Gertz</surname><given-names>EM</given-names></name>, <name><surname>Schäffer</surname><given-names>AA</given-names></name>, <name><surname>Agarwala</surname><given-names>R</given-names></name>. <article-title>A Fast and Symmetric DUST Implementation to Mask Low-Complexity DNA Sequences</article-title>. <source>Journal of Computational Biology</source>. <year>2006</year>;<volume>13</volume>:<fpage>1028</fpage>–<lpage>1040</lpage>. <pub-id pub-id-type="doi">10.1089/cmb.2006.13.1028</pub-id><?supplied-pmid 16796549?><pub-id pub-id-type="pmid">16796549</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0231738.ref030">
      <label>30</label>
      <mixed-citation publication-type="journal"><name><surname>Li</surname><given-names>H</given-names></name>, <name><surname>Handsaker</surname><given-names>B</given-names></name>, <name><surname>Wysoker</surname><given-names>A</given-names></name>, <name><surname>Fennell</surname><given-names>T</given-names></name>, <name><surname>Ruan</surname><given-names>J</given-names></name>, <name><surname>Homer</surname><given-names>N</given-names></name>, <etal>et al</etal><article-title>The Sequence alignment/map (SAM) format and SAMtools</article-title>. <source>Bioinformatics</source>. <year>2009</year>;<volume>25</volume>:<fpage>2078</fpage>–<lpage>2079</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btp352</pub-id><?supplied-pmid 19505943?><pub-id pub-id-type="pmid">19505943</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0231738.ref031">
      <label>31</label>
      <mixed-citation publication-type="journal"><name><surname>Kozomara</surname><given-names>A</given-names></name>, <name><surname>Griffiths-Jones</surname><given-names>S</given-names></name>. <article-title>miRBase: integrating microRNA annotation and deep-sequencing data</article-title>. <source>Nucleic Acids Research</source>. <year>2010</year>;<volume>39</volume>:<fpage>D152</fpage>–<lpage>D157</lpage>. <pub-id pub-id-type="doi">10.1093/nar/gkq1027</pub-id><?supplied-pmid 21037258?><pub-id pub-id-type="pmid">21037258</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
<sub-article id="pone.0231738.r001" article-type="aggregated-review-documents">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pone.0231738.r001</article-id>
    <title-group>
      <article-title>Decision Letter 0</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Rizzo</surname>
          <given-names>Francesca</given-names>
        </name>
        <role>Academic Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2020 Francesca Rizzo</copyright-statement>
      <copyright-year>2020</copyright-year>
      <copyright-holder>Francesca Rizzo</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article id="rel-obj001" ext-link-type="doi" xlink:href="10.1371/journal.pone.0231738" related-article-type="reviewed-article"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>0</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">31 Jul 2019</named-content>
    </p>
    <p>PONE-D-19-16932</p>
    <p>mmAnnot: How to improve small–RNA annotation?</p>
    <p>PLOS ONE</p>
    <p>Dear Dr Zytnicki,</p>
    <p>Thank you for submitting your manuscript to PLOS ONE. After careful consideration, we feel that it has merit but does not fully meet PLOS ONE’s publication criteria as it currently stands. Therefore, we invite you to submit a revised version of the manuscript that addresses the points raised during the review process.</p>
    <p>Reviewers have evaluated your manuscript but major changes are necessary to be acceptable for publication. Reviewers have provided detailed comments and suggestions. I invite you to revise the manuscript accordingly, in particular a main modification required is an extension of small RNA classes considered in the tool. Specifically, piRNA and tRNA-derived fragments should be included among the available categories. In addition the comparison with other available tools is not satisfactory, more tools should be considered.</p>
    <p>We would appreciate receiving your revised manuscript by Sep 14 2019 11:59PM. When you are ready to submit your revision, log on to <ext-link ext-link-type="uri" xlink:href="https://www.editorialmanager.com/pone/">https://www.editorialmanager.com/pone/</ext-link> and select the 'Submissions Needing Revision' folder to locate your manuscript file.</p>
    <p>If you would like to make changes to your financial disclosure, please include your updated statement in your cover letter.</p>
    <p>To enhance the reproducibility of your results, we recommend that if applicable you deposit your laboratory protocols in protocols.io, where a protocol can be assigned its own identifier (DOI) such that it can be cited independently in the future. For instructions see: <ext-link ext-link-type="uri" xlink:href="http://journals.plos.org/plosone/s/submission-guidelines#loc-laboratory-protocols">http://journals.plos.org/plosone/s/submission-guidelines#loc-laboratory-protocols</ext-link></p>
    <p>Please include the following items when submitting your revised manuscript:</p>
    <p>
      <list list-type="bullet">
        <list-item>
          <p>A rebuttal letter that responds to each point raised by the academic editor and reviewer(s). This letter should be uploaded as separate file and labeled 'Response to Reviewers'.</p>
        </list-item>
        <list-item>
          <p>A marked-up copy of your manuscript that highlights changes made to the original version. This file should be uploaded as separate file and labeled 'Revised Manuscript with Track Changes'.</p>
        </list-item>
        <list-item>
          <p>An unmarked version of your revised paper without tracked changes. This file should be uploaded as separate file and labeled 'Manuscript'.</p>
        </list-item>
      </list>
    </p>
    <p>Please note while forming your response, if your article is accepted, you may have the opportunity to make the peer review history publicly available. The record will include editor decision letters (with reviews) and your responses to reviewer comments. If eligible, we will contact you to opt in or out.</p>
    <p>We look forward to receiving your revised manuscript.</p>
    <p>Kind regards,</p>
    <p>Francesca Rizzo, PhD</p>
    <p>Academic Editor</p>
    <p>PLOS ONE</p>
    <p>Journal Requirements:</p>
    <p>When submitting your revision, we need you to address these additional requirements.</p>
    <p>1. Please ensure that your manuscript meets PLOS ONE's style requirements, including those for file naming. The PLOS ONE style templates can be found at</p>
    <p><ext-link ext-link-type="uri" xlink:href="http://www.journals.plos.org/plosone/s/file?id=wjVg/PLOSOne_formatting_sample_main_body.pdf">http://www.journals.plos.org/plosone/s/file?id=wjVg/PLOSOne_formatting_sample_main_body.pdf</ext-link> and <ext-link ext-link-type="uri" xlink:href="http://www.journals.plos.org/plosone/s/file?id=ba62/PLOSOne_formatting_sample_title_authors_affiliations.pdf">http://www.journals.plos.org/plosone/s/file?id=ba62/PLOSOne_formatting_sample_title_authors_affiliations.pdf</ext-link></p>
    <p>2. Thank you for stating the following financial disclosure:</p>
    <p>"The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript."</p>
    <p>
      <list list-type="order">
        <list-item>
          <p>Please provide an amended Funding Statement that declares *all* the funding or sources of support received during this specific study (whether external or internal to your organization) as detailed online in our guide for authors at <ext-link ext-link-type="uri" xlink:href="http://journals.plos.org/plosone/s/submit-now">http://journals.plos.org/plosone/s/submit-now</ext-link>.  </p>
        </list-item>
      </list>
      <list list-type="order">
        <list-item>
          <p>Please state what role the funders took in the study.  If any authors received a salary from any of your funders, please state which authors and which funder. If the funders had no role, please state: "The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript."</p>
        </list-item>
      </list>
    </p>
    <p>c. Please include your amended statements within your cover letter; we will change the online submission form on your behalf.</p>
    <p>[Note: HTML markup is below. Please do not edit.]</p>
    <p>Reviewers' comments:</p>
    <p>Reviewer's Responses to Questions</p>
    <p>
      <bold>Comments to the Author</bold>
    </p>
    <p>1. Is the manuscript technically sound, and do the data support the conclusions?</p>
    <p>The manuscript must describe a technically sound piece of scientific research with data that supports the conclusions. Experiments must have been conducted rigorously, with appropriate controls, replication, and sample sizes. The conclusions must be drawn appropriately based on the data presented. </p>
    <p>Reviewer #1: Partly</p>
    <p>Reviewer #2: Partly</p>
    <p>**********</p>
    <p>2. Has the statistical analysis been performed appropriately and rigorously? </p>
    <p>Reviewer #1: Yes</p>
    <p>Reviewer #2: Yes</p>
    <p>**********</p>
    <p>3. Have the authors made all data underlying the findings in their manuscript fully available?</p>
    <p>The <ext-link ext-link-type="uri" xlink:href="http://www.plosone.org/static/policies.action#sharing">PLOS Data policy</ext-link> requires authors to make all data underlying the findings described in their manuscript fully available without restriction, with rare exception (please refer to the Data Availability Statement in the manuscript PDF file). The data should be provided as part of the manuscript or its supporting information, or deposited to a public repository. For example, in addition to summary statistics, the data points behind means, medians and variance measures should be available. If there are restrictions on publicly sharing data—e.g. participant privacy or use of data from a third party—those must be specified.</p>
    <p>Reviewer #1: No</p>
    <p>Reviewer #2: Yes</p>
    <p>**********</p>
    <p>4. Is the manuscript presented in an intelligible fashion and written in standard English?</p>
    <p>PLOS ONE does not copyedit accepted manuscripts, so the language in submitted articles must be clear, correct, and unambiguous. Any typographical or grammatical errors should be corrected at revision, so please note any specific errors here.</p>
    <p>Reviewer #1: Yes</p>
    <p>Reviewer #2: Yes</p>
    <p>**********</p>
    <p>5. Review Comments to the Author</p>
    <p>Please use the space provided to explain your answers to the questions above. You may also include additional comments for the author, including concerns about dual publication, research ethics, or publication ethics. (Please upload your review as an attachment if it exceeds 20,000 characters)</p>
    <p>Reviewer #1: In this manuscript the authors proposed a tool to annotate small RNA based on user given annotation file. Their strategy is outputting all the annotation information to those small RNAs that mapped to genome. Although this strategy may work in several ambiguous cases, there are several concerns before acceptance this paper.</p>
    <p>1. The intrinsic flaw of the tool leads to the result that it can only annotate RNAs that mapped to genome. However, 10% or more RNAs cannot map to genome due to post-transcriptional splicing/modification or other mechanism, which resulting in reduced accuracy of the tool. In this case, all the analysis in this work are biased.</p>
    <p>2. The authors mentioned piRNAs and tRNA-derived fragments in the manuscript, but didn't show them in the results, are they classified in the ambiguous category or others?</p>
    <p>3. Although the authors emphasized the advantage of their annotation strategy, the accuracy is based on the reference file the user choose. The annotation category of Ambiguous could be very high when adding piRNA database into account.</p>
    <p>4. The exact annotation results corresponding to the figures could not be found in the supplemental files, which made the validation process unavailable.</p>
    <p>5. Since tRNA fragment is also named as tRNA-derived small RNA (tsRNA for short) in several literatures (Schorn AJ, Gutbrod MJ, LeBlanc C, et al. Cell 2017; 170:61–71., Chen Q, Yan M, Cao Z, et al. Science 2016; 351:397–400.), I would suggest to stay in line with the literature, in order to maximize the visibility of the tool (and the chance of it being found through search engines).</p>
    <p>Reviewer #2: Summary:</p>
    <p>The manuscript by Zytnicki and Gaspin presents a newly developed small RNA annotation tool that uses a new method in order to improve small RNA annotation. Specifically it proposes a different way to handle multi-mapping sequences compared to previous methods, such as discarding multi-mapping reads, assigning ambiguous hits randomly, weighting hits (reads/n hits) or including information of expression of the hits vicinity. Their tool, mmannot, declares reads that map to different feature classes as ambiguous and provides the different assigned features to each read. As input, mmannot requires a GTF and a BAM file, while it outputs read counts for each feature, such as cds, intron, miRNA etc. The manuscript/tool is potentially a valuable addition to the field, since information on the proportion of ambiguous reads in a dataset is useful, however there are some concerns that should be addressed before publication.</p>
    <p>Major comments:</p>
    <p>1) Nowhere in the results do the authors discuss figure 3. Figure 3 importantly shows that the introduction of the "ambiguous" fraction does not necessarily improve the overall annotation result/overview. Here, shortstack is the tool that provides the annotation that is most similar to the "truth". As a user I would find it useful to know many reads are "ambiguous" but in the end go with shortstack anyway as it seems to be closer to the true situation. The authors should point to putative advantages of mmannot oder shortstack.</p>
    <p>2) The authors compare mmannot to the existing tool shortstack and at some places also to MMR. However, they should compare it to other tools as well, such as the widely used featureCounts (which also takes BAM and GTF to counts features) and possibly, although this would just be a suggestion, to tools that do not use genome map files, but rather use reference sequences from several sources and databases.</p>
    <p>Minor comments:</p>
    <p>1) When describing the results on human and zebrafish datasets (page 4, lines 93-99 and page 5, lines 134-139) the authors provide no referral to the corresponding supplementary figures. Also the results from Fig S3 (pig) are not discussed.</p>
    <p>2) It should be mentioned which organs/tissues the datasets are generated from.</p>
    <p>3) Figure S2 is extremely wide. The aspect ratio of the image should be changed.</p>
    <p>4) The order of methods for test datasets is not ideal. mmannot, BWA, mmannot re and mmannot bowtie should be grouped together.</p>
    <p>5) The caption of figure 3 provides too little information.</p>
    <p>6) Page 3, line 80: Remove the commas after 3, "(see Fig 2, 3, , ,)"</p>
    <p>7) Typo in caption of Fig 2: "Our method is uses BWA..."</p>
    <p>8) On pages 6-8 Fig 5A-F is incorrectly reffered to as Fig 4A-F</p>
    <p>**********</p>
    <p>6. PLOS authors have the option to publish the peer review history of their article (<ext-link ext-link-type="uri" xlink:href="https://journals.plos.org/plosone/s/editorial-and-peer-review-process#loc-peer-review-history">what does this mean?</ext-link>). If published, this will include your full peer review and any attached files.</p>
    <p>If you choose “no”, your identity will remain anonymous but your review may still be made public.</p>
    <p><bold>Do you want your identity to be public for this peer review?</bold> For information about this choice, including consent withdrawal, please see our <ext-link ext-link-type="uri" xlink:href="https://www.plos.org/privacy-policy">Privacy Policy</ext-link>.</p>
    <p>Reviewer #1: No</p>
    <p>Reviewer #2: No</p>
    <p>[NOTE: If reviewer comments were submitted as an attachment file, they will be attached to this email and accessible via the submission site. Please log into your account, locate the manuscript record, and check for the action link "View Attachments". If this link does not appear, there are no attachment files to be viewed.]</p>
    <p>While revising your submission, please upload your figure files to the Preflight Analysis and Conversion Engine (PACE) digital diagnostic tool, <ext-link ext-link-type="uri" xlink:href="https://pacev2.apexcovantage.com/">https://pacev2.apexcovantage.com/</ext-link>. PACE helps ensure that figures meet PLOS requirements. To use PACE, you must first register as a user. Registration is free. Then, login and navigate to the UPLOAD tab, where you will find detailed instructions on how to use the tool. If you encounter any issues or have any questions when using PACE, please email us at <email>figures@plos.org</email>. Please note that Supporting Information files do not need this step.</p>
  </body>
</sub-article>
<sub-article id="pone.0231738.r002" article-type="author-comment">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pone.0231738.r002</article-id>
    <title-group>
      <article-title>Author response to Decision Letter 0</article-title>
    </title-group>
    <related-article id="rel-obj002" ext-link-type="doi" xlink:href="10.1371/journal.pone.0231738" related-article-type="editor-report"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>1</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="author-response-date">16 Sep 2019</named-content>
    </p>
    <p>Reviewer #1: In this manuscript the authors proposed a tool to annotate small RNA based on user given annotation file. Their strategy is outputting all the annotation information to those small RNAs that</p>
    <p>mapped to genome. Although this strategy may work in several ambiguous cases, there are several concerns before acceptance this paper.</p>
    <p>1. The intrinsic flaw of the tool leads to the result that it can only annotate RNAs that mapped to genome. However, 10% or more RNAs cannot map to genome due to post-transcriptional splicing/modification or</p>
    <p>other mechanism, which resulting in reduced accuracy of the tool. In this case, all the analysis in this work are biased.</p>
    <p> --&gt; We found that at most 10% of the reads cannot be mapped on our data set, and, most of the time, the results are closer to 2-3%.</p>
    <p> These results have been added to Table 2.</p>
    <p> We cannot exclude that these missing reads would bias the results (especially if most of them are edited miRNAs, for instance), but we think that the impact on the whole classification is limited.</p>
    <p>2. The authors mentioned piRNAs and tRNA-derived fragments in the manuscript, but didn't show them in the results, are they classified in the ambiguous category or others?</p>
    <p> --&gt; We added the piRNA in our study, using an external database.</p>
    <p> They now show up in the results.</p>
    <p> It turns out that they do not significantly change the results, except that more reads are annotated.</p>
    <p> Strikingly, the number of ambiguous reads does not change significantly.</p>
    <p> tRNA-derived fragments, on the other hand, constitute a very small fraction of the sRNAs.</p>
    <p> They are thus clustered in the ``Other'' group.</p>
    <p>3. Although the authors emphasized the advantage of their annotation strategy, the accuracy is based on the reference file the user choose. The annotation category of Ambiguous could be very high when adding</p>
    <p>piRNA database into account.</p>
    <p> --&gt; This is very true, and it is precisely the point of the method.</p>
    <p> The limitation of sRNA-Seq is that it is sometimes impossible to locus which generated a given read, without making a guess, which can be wrong.</p>
    <p> mmannot does not hide this and clearly states the proportion of reads which can be ambiguously mapped.</p>
    <p> I made your point clear in the discussion:</p>
    <p> ===</p>
    <p> A high percentage of reads produced by sRNA-Seq map to multiple loci, and this poses a major challenge to the annotation and quantification tasks.</p>
    <p> As a result, all the reads cannot be unambiguously annotated.</p>
    <p> To date, most of the tools does not report these ambiguous reads, because they remove these reads, or they weight the expression of the possible targets, using a model which can, or cannot be verified.}</p>
    <p> ===</p>
    <p> Yet, to answer your concern, we did not find that piRNAs significantly increase the number of ambiguous reads.</p>
    <p>4. The exact annotation results corresponding to the figures could not be found in the supplemental files, which made the validation process unavailable.</p>
    <p> --&gt; We included them in the second Supporting Information.</p>
    <p>5. Since tRNA fragment is also named as tRNA-derived small RNA (tsRNA for short) in several literatures (Schorn AJ, Gutbrod MJ, LeBlanc C, et al. Cell 2017; 170:61–71., Chen Q, Yan M, Cao Z, et al. Science</p>
    <p>2016; 351:397–400.), I would suggest to stay in line with the literature, in order to maximize the visibility of the tool (and the chance of it being found through search engines).</p>
    <p> --&gt; I preferred to use the world coined by the discoverers (YS Lee, Y Shibata, A Malhotra and A Dutta, Genes and Development, 2009).</p>
    <p> Yet, I changed the name as you suggested.</p>
    <p>Reviewer #2: Summary:</p>
    <p>The manuscript by Zytnicki and Gaspin presents a newly developed small RNA annotation tool that uses a new method in order to improve small RNA annotation. Specifically it proposes a different way to handle</p>
    <p>multi-mapping sequences compared to previous methods, such as discarding multi-mapping reads, assigning ambiguous hits randomly, weighting hits (reads/n hits) or including information of expression of the</p>
    <p>hits vicinity. Their tool, mmannot, declares reads that map to different feature classes as ambiguous and provides the different assigned features to each read. As input, mmannot requires a GTF and a BAM</p>
    <p>file, while it outputs read counts for each feature, such as cds, intron, miRNA etc. The manuscript/tool is potentially a valuable addition to the field, since information on the proportion of ambiguous</p>
    <p>reads in a data set is useful, however there are some concerns that should be addressed before publication.</p>
    <p>Major comments:</p>
    <p>1) Nowhere in the results do the authors discuss figure 3. Figure 3 importantly shows that the introduction of the "ambiguous" fraction does not necessarily improve the overall annotation result/overview.</p>
    <p>Here, shortstack is the tool that provides the annotation that is most similar to the "truth". As a user I would find it useful to know many reads are "ambiguous" but in the end go with shortstack anyway as</p>
    <p>it seems to be closer to the true situation. The authors should point to putative advantages of mmannot oder shortstack.</p>
    <p> --&gt; True.</p>
    <p> Actually, reads were ambiguous because they were both in the HET regions (created by the simulation tool) and the transposable elements.</p>
    <p> This was obviously a mistake, since the HET region is mainly transposable elements.</p>
    <p> We removed the transposable elements from the configuration file, and this solves the problem.</p>
    <p> Yet, Fig 7 now shows that reads can be mis-attributed (even if the results in general may look right).</p>
    <p> We made this clear in the new section ``mmannot predictions are correct''.</p>
    <p>2) The authors compare mmannot to the existing tool shortstack and at some places also to MMR. However, they should compare it to other tools as well, such as the widely used featureCounts (which also takes</p>
    <p>BAM and GTF to counts features) and possibly, although this would just be a suggestion, to tools that do not use genome map files, but rather use reference sequences from several sources and databases.</p>
    <p> --&gt; We have never read a paper using featureCounts for quantifying the small RNA repertoire.</p>
    <p> Rather, we know it is widely used to quantify the expression of individual features (e.g. miR156).</p>
    <p> Moreover, featureCounts supposes that the library is either stranded or unstranded.</p>
    <p> As a result, it is not (directly) possible to count the reads on the reverse strand of a gene (excluding collinear reads), and the reads in either strand of the upstream region.</p>
    <p> Yet, we address this issue in the article, and we also implemented the other strategy you mentioned.</p>
    <p> The code used to generate the annotation file is given in Supporting Information.</p>
    <p>Minor comments:</p>
    <p>1) When describing the results on human and zebrafish data sets (page 4, lines 93-99 and page 5, lines 134-139) the authors provide no referral to the corresponding supplementary figures. Also the results</p>
    <p>from Fig S3 (pig) are not discussed.</p>
    <p> --&gt; We finally included these figures in the main text, and discussed them in the text.</p>
    <p>2) It should be mentioned which organs/tissues the data sets are generated from.</p>
    <p> --&gt; This has been added to the Table 1. We have ``transposed'' the table, for it was otherwise too wide.</p>
    <p>3) Figure S2 is extremely wide. The aspect ratio of the image should be changed.</p>
    <p> --&gt; We now provide only the five first samples. The results are very similar, and the other samples do not provide much more information.</p>
    <p>4) The order of methods for test data sets is not ideal. mmannot, BWA, mmannot re and mmannot bowtie should be grouped together.</p>
    <p> --&gt; Done.</p>
    <p>5) The caption of figure 3 provides too little information.</p>
    <p> --&gt; We have added this in the caption.</p>
    <p> The results of all but the last bars is explained in Fig 2.</p>
    <p> The ``truth'' bar gives the fraction of each sRNA class generated by our method.</p>
    <p>6) Page 3, line 80: Remove the commas after 3, "(see Fig 2, 3, , ,)"</p>
    <p> --&gt; For some unknown reason, LaTeX does not seem to cross-reference right.</p>
    <p> We hard-coded the missing references.</p>
    <p>7) Typo in caption of Fig 2: "Our method is uses BWA..."</p>
    <p> --&gt; Thanks, corrected!</p>
    <p>8) On pages 6-8 Fig 5A-F is incorrectly reffered to as Fig 4A-F</p>
    <p> --&gt; This was probably a problem issued by the PLOS LaTeX compiler.</p>
    <p> On pages 6-8, there are no mention of Fig 4, only Fig 5.</p>
    <p> We will try to be careful during the proof production.</p>
    <supplementary-material content-type="local-data" id="pone.0231738.s003">
      <label>Attachment</label>
      <caption>
        <p>Submitted filename: <named-content content-type="submitted-filename">response.txt</named-content></p>
      </caption>
      <media xlink:href="pone.0231738.s003.txt">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </body>
</sub-article>
<sub-article id="pone.0231738.r003" article-type="aggregated-review-documents">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pone.0231738.r003</article-id>
    <title-group>
      <article-title>Decision Letter 1</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Rizzo</surname>
          <given-names>Francesca</given-names>
        </name>
        <role>Academic Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2020 Francesca Rizzo</copyright-statement>
      <copyright-year>2020</copyright-year>
      <copyright-holder>Francesca Rizzo</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article id="rel-obj003" ext-link-type="doi" xlink:href="10.1371/journal.pone.0231738" related-article-type="reviewed-article"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>1</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">1 Oct 2019</named-content>
    </p>
    <p>PONE-D-19-16932R1</p>
    <p>mmannot: How to improve small–RNA annotation?</p>
    <p>PLOS ONE</p>
    <p>Dear Dr Zytnicki,</p>
    <p>Thank you for submitting your manuscript to PLOS ONE. After careful consideration, we feel that it has merit but does not fully meet PLOS ONE’s publication criteria as it currently stands. Therefore, we invite you to submit a revised version of the manuscript that addresses the points raised during the review process.</p>
    <p>One reviewer still have major concerns about this revised version. Please carefully revise this manuscript again following the reviewers' suggestion.</p>
    <p>We would appreciate receiving your revised manuscript by Nov 15 2019 11:59PM. When you are ready to submit your revision, log on to <ext-link ext-link-type="uri" xlink:href="https://www.editorialmanager.com/pone/">https://www.editorialmanager.com/pone/</ext-link> and select the 'Submissions Needing Revision' folder to locate your manuscript file.</p>
    <p>If you would like to make changes to your financial disclosure, please include your updated statement in your cover letter.</p>
    <p>To enhance the reproducibility of your results, we recommend that if applicable you deposit your laboratory protocols in protocols.io, where a protocol can be assigned its own identifier (DOI) such that it can be cited independently in the future. For instructions see: <ext-link ext-link-type="uri" xlink:href="http://journals.plos.org/plosone/s/submission-guidelines#loc-laboratory-protocols">http://journals.plos.org/plosone/s/submission-guidelines#loc-laboratory-protocols</ext-link></p>
    <p>Please include the following items when submitting your revised manuscript:</p>
    <p>
      <list list-type="bullet">
        <list-item>
          <p>A rebuttal letter that responds to each point raised by the academic editor and reviewer(s). This letter should be uploaded as separate file and labeled 'Response to Reviewers'.</p>
        </list-item>
        <list-item>
          <p>A marked-up copy of your manuscript that highlights changes made to the original version. This file should be uploaded as separate file and labeled 'Revised Manuscript with Track Changes'.</p>
        </list-item>
        <list-item>
          <p>An unmarked version of your revised paper without tracked changes. This file should be uploaded as separate file and labeled 'Manuscript'.</p>
        </list-item>
      </list>
    </p>
    <p>Please note while forming your response, if your article is accepted, you may have the opportunity to make the peer review history publicly available. The record will include editor decision letters (with reviews) and your responses to reviewer comments. If eligible, we will contact you to opt in or out.</p>
    <p>We look forward to receiving your revised manuscript.</p>
    <p>Kind regards,</p>
    <p>Francesca Rizzo, PhD</p>
    <p>Academic Editor</p>
    <p>PLOS ONE</p>
    <p>[Note: HTML markup is below. Please do not edit.]</p>
    <p>Reviewers' comments:</p>
    <p>Reviewer's Responses to Questions</p>
    <p>
      <bold>Comments to the Author</bold>
    </p>
    <p>1. If the authors have adequately addressed your comments raised in a previous round of review and you feel that this manuscript is now acceptable for publication, you may indicate that here to bypass the “Comments to the Author” section, enter your conflict of interest statement in the “Confidential to Editor” section, and submit your "Accept" recommendation.</p>
    <p>Reviewer #1: (No Response)</p>
    <p>Reviewer #2: (No Response)</p>
    <p>**********</p>
    <p>2. Is the manuscript technically sound, and do the data support the conclusions?</p>
    <p>The manuscript must describe a technically sound piece of scientific research with data that supports the conclusions. Experiments must have been conducted rigorously, with appropriate controls, replication, and sample sizes. The conclusions must be drawn appropriately based on the data presented. </p>
    <p>Reviewer #1: No</p>
    <p>Reviewer #2: Partly</p>
    <p>**********</p>
    <p>3. Has the statistical analysis been performed appropriately and rigorously? </p>
    <p>Reviewer #1: No</p>
    <p>Reviewer #2: N/A</p>
    <p>**********</p>
    <p>4. Have the authors made all data underlying the findings in their manuscript fully available?</p>
    <p>The <ext-link ext-link-type="uri" xlink:href="http://www.plosone.org/static/policies.action#sharing">PLOS Data policy</ext-link> requires authors to make all data underlying the findings described in their manuscript fully available without restriction, with rare exception (please refer to the Data Availability Statement in the manuscript PDF file). The data should be provided as part of the manuscript or its supporting information, or deposited to a public repository. For example, in addition to summary statistics, the data points behind means, medians and variance measures should be available. If there are restrictions on publicly sharing data—e.g. participant privacy or use of data from a third party—those must be specified.</p>
    <p>Reviewer #1: Yes</p>
    <p>Reviewer #2: Yes</p>
    <p>**********</p>
    <p>5. Is the manuscript presented in an intelligible fashion and written in standard English?</p>
    <p>PLOS ONE does not copyedit accepted manuscripts, so the language in submitted articles must be clear, correct, and unambiguous. Any typographical or grammatical errors should be corrected at revision, so please note any specific errors here.</p>
    <p>Reviewer #1: No</p>
    <p>Reviewer #2: Yes</p>
    <p>**********</p>
    <p>6. Review Comments to the Author</p>
    <p>Please use the space provided to explain your answers to the questions above. You may also include additional comments for the author, including concerns about dual publication, research ethics, or publication ethics. (Please upload your review as an attachment if it exceeds 20,000 characters)</p>
    <p>Reviewer #1: The revised manuscript by Zytnicki and Gaspin is improved indeed. However, my concerns still exist before consider to recommend this work to get published.</p>
    <p>Major concerns:</p>
    <p>1. The authors “think” the unmapped rate is as low as 2-3% and the impact is limited based on their selected datasets. However, this conclusion is not true for some, if not for most datasets (e.g. datasets mentioned in RNA Biology, 11(11), 1375–1385. doi:10.1080/15476286.2014.996465, the unmapped rate is as high as 27%-48%). Since they didn’t solve this problem in the revised manuscript, the intrinsic flaw of the tool is still existing.</p>
    <p>2. The authors may not claim their annotation method is a correct one by only using a simulated data set, as well as the annotation of a sequence is hard to define correctly without determining their function in a biological way. In this case, they may change the subtitle ''mmannot predictions are correct'' to a more appropriate one, maybe ''mmannot predictions are more comprehensive”.</p>
    <p>3. The authors claimed they did not find that piRNAs significantly increase the number of ambiguous reads, while it might be true in their selected datasets, I am highly suspect if the authors chose the appropriate piRNA database or have done the appropriate analysis in their work. According to this published work (Commun Biol. 2018 Jan 22;1:2. doi: 10.1038/s42003-017-0001-7) and my knowledge, the overlapping annotations between piRNA and other RNA species are not negligible.</p>
    <p>Minor concerns:</p>
    <p>1. Fig 1 is missing in the revised manuscript.</p>
    <p>2. Please clarify which piRNA database the authors used in this work.</p>
    <p>Reviewer #2: Most concern have been adequately addressed by the authors. However, some minor issues are still present or have newly arisen within the revision of the manuscript.</p>
    <p>Page 1, line 9: Typo, "nuclear" not "nuclar"</p>
    <p>Page 1, line 9: Typo, lacking "."</p>
    <p>Page 3, lines 99/100: "For all data sets (see Fig 2 to 5), the miRNA and the piRNA classes are generally the 99 most represented whatever the used strategy." I am sure the authors don't want to imply this, but Plants (as A. thaliana (Fig 2)) do not have piRNAs. The sentence gives this false impression, however.</p>
    <p>Page 5, lines 136/137: "The “random” strategy randomly places reads. As seen in Fig 7, this method yields a 136 high number of false positives." This seems to be the case in the old version of the figure, but not in the current version. #FP is very low.</p>
    <p>Page 6, line 173: Typo, "piRNA annotation" not "piRNA annotion"</p>
    <p>Page 6, line 177: "As seen on Fig 7, only mmannot and the “sequence” strategy give no false positives." This is confusing and does not seem to overlap with the content of the figure. Do the authors mean false negatives?</p>
    <p>Page 6, line 208: Typo, "do" not "does"</p>
    <p>Page 10, Table 1: It's an improvement that the authors include tissues of the data sets. However: 1. "several" for D. rerio is no gain in information. I would also suggest to include the tissues within the figures for each individual data set.</p>
    <p>Figure 3: It is unlikely that human brain tissues, such as amygdala, would contain any piRNAs, but 30/50%-90% seems highly doubtful. The database used here seems flawed. Often such databases wrongly include miRNAs (as the authors mention) but also tRNA-fragments, among others. This worsens mmannot's annotation. Figure 5 - Sus scrofa testis - however, looks realistic concerning piRNA content. Presumably this piRNA database can only be reliably used on germline tissues.</p>
    <p>**********</p>
    <p>7. PLOS authors have the option to publish the peer review history of their article (<ext-link ext-link-type="uri" xlink:href="https://journals.plos.org/plosone/s/editorial-and-peer-review-process#loc-peer-review-history">what does this mean?</ext-link>). If published, this will include your full peer review and any attached files.</p>
    <p>If you choose “no”, your identity will remain anonymous but your review may still be made public.</p>
    <p><bold>Do you want your identity to be public for this peer review?</bold> For information about this choice, including consent withdrawal, please see our <ext-link ext-link-type="uri" xlink:href="https://www.plos.org/privacy-policy">Privacy Policy</ext-link>.</p>
    <p>Reviewer #1: No</p>
    <p>Reviewer #2: No</p>
    <p>[NOTE: If reviewer comments were submitted as an attachment file, they will be attached to this email and accessible via the submission site. Please log into your account, locate the manuscript record, and check for the action link "View Attachments". If this link does not appear, there are no attachment files to be viewed.]</p>
    <p>While revising your submission, please upload your figure files to the Preflight Analysis and Conversion Engine (PACE) digital diagnostic tool, <ext-link ext-link-type="uri" xlink:href="https://pacev2.apexcovantage.com/">https://pacev2.apexcovantage.com/</ext-link>. PACE helps ensure that figures meet PLOS requirements. To use PACE, you must first register as a user. Registration is free. Then, login and navigate to the UPLOAD tab, where you will find detailed instructions on how to use the tool. If you encounter any issues or have any questions when using PACE, please email us at <email>figures@plos.org</email>. Please note that Supporting Information files do not need this step.</p>
  </body>
</sub-article>
<sub-article id="pone.0231738.r004" article-type="author-comment">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pone.0231738.r004</article-id>
    <title-group>
      <article-title>Author response to Decision Letter 1</article-title>
    </title-group>
    <related-article id="rel-obj004" ext-link-type="doi" xlink:href="10.1371/journal.pone.0231738" related-article-type="editor-report"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>2</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="author-response-date">27 Nov 2019</named-content>
    </p>
    <p>Dear reviewers, we would like to thank you for providing us crucial feedback in order to improve the quality of the article.</p>
    <p>We tried to address all the questions they had, especially about the read mapping rate, at the end of this file.</p>
    <p>Best regads,</p>
    <p>Christine Gaspin and Matthias Zytnicki.</p>
    <p>===</p>
    <p>Reviewer #1: The revised manuscript by Zytnicki and Gaspin is improved indeed. However, my concerns still exist before consider to recommend this work to get published.</p>
    <p>Major concerns:</p>
    <p>1. The authors “think” the unmapped rate is as low as 2-3\\% and the impact is limited based on their selected datasets. However, this conclusion is not true for some, if not for most datasets (e.g. datasets mentioned in RNA Biology, 11(11), 1375–1385. doi:10.1080/15476286.2014.996465, the unmapped rate is as high as 27%-48%). Since they didn’t solve this problem in the revised manuscript, the intrinsic flaw of the tool is still existing.</p>
    <p> --&gt; We downloaded five data sets used in the paper (actually, all the data sets where the mapping rate was provided in detail): SRR039615, SRR191522, SRR191529, SRR191552, and SRR372670.</p>
    <p> We used the following commands for each fastq file:</p>
    <p> - fastx_clipper -a &lt;adapter&gt; -l 15 -i file.fastq &gt; file_trimmed1.fastq</p>
    <p> - fastq_quality_trimmer -l 15 -t 20 &lt; file_trimmed1.fastq &gt; file_trimmed2.fastq</p>
    <p> - fastq_quality_filter -q 20 -p 80 &lt; file_trimmed2.fastq &gt; file_trimmed3.fastq</p>
    <p> - fastq2fasta &lt; file_trimmed3.fastq &gt; file_trimmed3.fasta</p>
    <p> - dust file_trimmed3.fasta &gt; file_trimmed4.fasta</p>
    <p> - fasta2fastq &lt; file_trimmed4.fasta &gt; file_trimmed4.fastq</p>
    <p> - bowtie -S -a --best --strata -p 6 database file_trimmed4.fastq &gt; file.sam</p>
    <p> (The adapters are TCGTATGCCGTCTTCTGCTTG TTGGTTCGTATGCCGTC TCCACTCGTATGCCGTCTTT TCATCTCGTATGCCGTCTTC ATCTCGTATGCCGTCTTC)</p>
    <p> We had the following results.</p>
    <p> # reads # trimmed % not mapping</p>
    <p> ----------------------------------------------------</p>
    <p> SRR039615 9,288,038 7,415,686 1.32%</p>
    <p> SRR191522 71,025 57,895 2.50%</p>
    <p> SRR191529 11,730 7,356 4.69%</p>
    <p> SRR191552 385,594 287,964 5.56%</p>
    <p> SRR372670 48,415,574 2,8822,982 17.17%</p>
    <p> It is true that the last sample did not map well, however, we could not confirm an unmapping rate of 27%-48%.</p>
    <p> It is also likely that the trimming we used might be more drastic that the one used in the paper.</p>
    <p> What we would like to stress here, is that a mapping rate of &lt;5% is now not uncommon, provided that the reads have been efficiently trimmed.</p>
    <p>2. The authors may not claim their annotation method is a correct one by only using a simulated data set, as well as the annotation of a sequence is hard to define correctly without determining their function in a biological way. In this case, they may change the subtitle ''mmannot predictions are correct'' to a more appropriate one, maybe ''mmannot predictions are more comprehensive”.</p>
    <p> --&gt; True, we should not over-sell our method. We made the suggested modification. We also changed "unbiased" to "less biased."</p>
    <p>3. The authors claimed they did not find that piRNAs significantly increase the number of ambiguous reads, while it might be true in their selected datasets, I am highly suspect if the authors chose the appropriate piRNA database or have done the appropriate analysis in their work. According to this published work (Commun Biol. 2018 Jan 22;1:2. doi: 10.1038/s42003-017-0001-7) and my knowledge, the overlapping annotations between piRNA and other RNA species are not negligible.</p>
    <p>--&gt; This is very true, and we made this clear in the article (already in the previous revision):</p>
    <p> [...] we compared the miRNA and the piRNA annotations.</p>
    <p> It turns out that 1178 out of the 3934 annotated miRNAs overlap a piRNA annotation.</p>
    <p> The most likely reason is that a great fraction of the piRNAs are probably mis-annotated</p>
    <p> In fact, we simply used the annotation from published database "piRBase".</p>
    <p> We felt that discovering piRNAs transcripts was outside the scope of the analysis.</p>
    <p>Minor concerns:</p>
    <p>1. Fig 1 is missing in the revised manuscript.</p>
    <p> --&gt; Probably a problem during the upload. We corrected this.</p>
    <p>2. Please clarify which piRNA database the authors used in this work.</p>
    <p> --&gt; We used the annotation from piRBase. We added the following in the manuscript:</p>
    <p> For D. rerio, H. sapiens, and S. scrofa, we downloaded a piRNA annotation from piRBase, and we added this annotation to the existing annotations (which usually do not include piRNAs).</p>
    <p>Reviewer #2: Most concern have been adequately addressed by the authors. However, some minor issues are still present or have newly arisen within the revision of the manuscript.</p>
    <p>Page 1, line 9: Typo, "nuclear" not "nuclar"</p>
    <p> --&gt; Done.</p>
    <p>Page 1, line 9: Typo, lacking "."</p>
    <p> --&gt; Done.</p>
    <p>Page 3, lines 99/100: "For all data sets (see Fig 2 to 5), the miRNA and the piRNA classes are generally the 99 most represented whatever the used strategy." I am sure the authors don't want to imply this, but Plants (as A. thaliana (Fig 2)) do not have piRNAs. The sentence gives this false impression, however.</p>
    <p> --&gt; Very well, we removed this sentence.</p>
    <p>Page 5, lines 136/137: "The “random” strategy randomly places reads. As seen in Fig 7, this method yields a 136 high number of false positives." This seems to be the case in the old version of the figure, but not in the current version. #FP is very low.</p>
    <p> --&gt; True, we meant "false negatives". This has been corrected.</p>
    <p>Page 6, line 173: Typo, "piRNA annotation" not "piRNA annotion"</p>
    <p> --&gt; Done.</p>
    <p>Page 6, line 177: "As seen on Fig 7, only mmannot and the “sequence” strategy give no false positives." This is confusing and does not seem to overlap with the content of the figure. Do the authors mean false negatives?</p>
    <p>--&gt; True, we also meant "false negatives". This has also been corrected.</p>
    <p>Page 6, line 208: Typo, "do" not "does"</p>
    <p> --&gt; Done.</p>
    <p>Page 10, Table 1: It's an improvement that the authors include tissues of the data sets. However: 1. "several" for D. rerio is no gain in information. I would also suggest to include the tissues within the figures for each individual data set.</p>
    <p> --&gt; We forgot to mention that the samples that we used here were extracted from brain tissue. We corrected this on the manuscript.</p>
    <p>Figure 3: It is unlikely that human brain tissues, such as amygdala, would contain any piRNAs, but 30/50%-90% seems highly doubtful. The database used here seems flawed. Often such databases wrongly include miRNAs (as the authors mention) but also tRNA-fragments, among others. This worsens mmannot's annotation. Figure 5 - Sus scrofa testis - however, looks realistic concerning piRNA content. Presumably this piRNA database can only be reliably used on germline tissues.</p>
    <p> --&gt; This is very true. We mentioned this in the "Results" section</p>
    <p> Using the expected configuration file, the number of miRNAs is strictly greater than the number of piRNA.</p>
    <p> However, using the reverse configuration file, the number of piRNAs is much greater.</p>
    <p> To understand why, we compared the miRNA and the piRNA annotations.</p>
    <p> It turns out that 1178 out of the 3934 annotated miRNAs overlap a piRNA \\hl{annotation}.</p>
    <p> The most likely reason is that a great fraction of the piRNAs are probably mis-annotated, and using a meaningful configuration file is sometimes crucial for the analysis of small RNAs.</p>
    <p> To make it even more clear, we also added a new paragraph in the "Discussion":</p>
    <p> By nature, mmannot heavily rely on the accuracy of the available annotation.</p>
    <p> We saw, on the human data set, that the piRNA annotation might be flawed, and this dramatically alters the read annotation produced by our method.</p>
    <p> However, a simple, common-sense, ordering of the annotation types (favor ``miRNA'' when a read overlaps a miRNA annotation and a piRNA annotation) produces the expected results.</p>
    <p> Alternatively, discarding unexpected annotations (\\textit{e.g.} piRNAs in brain) might also be a sensible method.</p>
    <supplementary-material content-type="local-data" id="pone.0231738.s004">
      <label>Attachment</label>
      <caption>
        <p>Submitted filename: <named-content content-type="submitted-filename">response.txt</named-content></p>
      </caption>
      <media xlink:href="pone.0231738.s004.txt">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </body>
</sub-article>
<sub-article id="pone.0231738.r005" article-type="aggregated-review-documents">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pone.0231738.r005</article-id>
    <title-group>
      <article-title>Decision Letter 2</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Rizzo</surname>
          <given-names>Francesca</given-names>
        </name>
        <role>Academic Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2020 Francesca Rizzo</copyright-statement>
      <copyright-year>2020</copyright-year>
      <copyright-holder>Francesca Rizzo</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article id="rel-obj005" ext-link-type="doi" xlink:href="10.1371/journal.pone.0231738" related-article-type="reviewed-article"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>2</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">18 Dec 2019</named-content>
    </p>
    <p>PONE-D-19-16932R2</p>
    <p>mmannot: How to improve small–RNA annotation?</p>
    <p>PLOS ONE</p>
    <p>Dear Dr Zytnicki,</p>
    <p>Thank you for submitting your manuscript to PLOS ONE. After careful consideration, we feel that it has merit but does not fully meet PLOS ONE’s publication criteria as it currently stands. Therefore, we invite you to submit a revised version of the manuscript that addresses the points raised during the review process.</p>
    <p>We would appreciate receiving your revised manuscript by Feb 01 2020 11:59PM. When you are ready to submit your revision, log on to <ext-link ext-link-type="uri" xlink:href="https://www.editorialmanager.com/pone/">https://www.editorialmanager.com/pone/</ext-link> and select the 'Submissions Needing Revision' folder to locate your manuscript file.</p>
    <p>If you would like to make changes to your financial disclosure, please include your updated statement in your cover letter.</p>
    <p>To enhance the reproducibility of your results, we recommend that if applicable you deposit your laboratory protocols in protocols.io, where a protocol can be assigned its own identifier (DOI) such that it can be cited independently in the future. For instructions see: <ext-link ext-link-type="uri" xlink:href="http://journals.plos.org/plosone/s/submission-guidelines#loc-laboratory-protocols">http://journals.plos.org/plosone/s/submission-guidelines#loc-laboratory-protocols</ext-link></p>
    <p>Please include the following items when submitting your revised manuscript:</p>
    <p>
      <list list-type="bullet">
        <list-item>
          <p>A rebuttal letter that responds to each point raised by the academic editor and reviewer(s). This letter should be uploaded as separate file and labeled 'Response to Reviewers'.</p>
        </list-item>
        <list-item>
          <p>A marked-up copy of your manuscript that highlights changes made to the original version. This file should be uploaded as separate file and labeled 'Revised Manuscript with Track Changes'.</p>
        </list-item>
        <list-item>
          <p>An unmarked version of your revised paper without tracked changes. This file should be uploaded as separate file and labeled 'Manuscript'.</p>
        </list-item>
      </list>
    </p>
    <p>Please note while forming your response, if your article is accepted, you may have the opportunity to make the peer review history publicly available. The record will include editor decision letters (with reviews) and your responses to reviewer comments. If eligible, we will contact you to opt in or out.</p>
    <p>We look forward to receiving your revised manuscript.</p>
    <p>Kind regards,</p>
    <p>Francesca Rizzo, PhD</p>
    <p>Academic Editor</p>
    <p>PLOS ONE</p>
    <p>[Note: HTML markup is below. Please do not edit.]</p>
    <p>Reviewers' comments:</p>
    <p>Reviewer's Responses to Questions</p>
    <p>
      <bold>Comments to the Author</bold>
    </p>
    <p>1. If the authors have adequately addressed your comments raised in a previous round of review and you feel that this manuscript is now acceptable for publication, you may indicate that here to bypass the “Comments to the Author” section, enter your conflict of interest statement in the “Confidential to Editor” section, and submit your "Accept" recommendation.</p>
    <p>Reviewer #1: All comments have been addressed</p>
    <p>Reviewer #2: All comments have been addressed</p>
    <p>**********</p>
    <p>2. Is the manuscript technically sound, and do the data support the conclusions?</p>
    <p>The manuscript must describe a technically sound piece of scientific research with data that supports the conclusions. Experiments must have been conducted rigorously, with appropriate controls, replication, and sample sizes. The conclusions must be drawn appropriately based on the data presented. </p>
    <p>Reviewer #1: Yes</p>
    <p>Reviewer #2: Yes</p>
    <p>**********</p>
    <p>3. Has the statistical analysis been performed appropriately and rigorously? </p>
    <p>Reviewer #1: Yes</p>
    <p>Reviewer #2: Yes</p>
    <p>**********</p>
    <p>4. Have the authors made all data underlying the findings in their manuscript fully available?</p>
    <p>The <ext-link ext-link-type="uri" xlink:href="http://www.plosone.org/static/policies.action#sharing">PLOS Data policy</ext-link> requires authors to make all data underlying the findings described in their manuscript fully available without restriction, with rare exception (please refer to the Data Availability Statement in the manuscript PDF file). The data should be provided as part of the manuscript or its supporting information, or deposited to a public repository. For example, in addition to summary statistics, the data points behind means, medians and variance measures should be available. If there are restrictions on publicly sharing data—e.g. participant privacy or use of data from a third party—those must be specified.</p>
    <p>Reviewer #1: Yes</p>
    <p>Reviewer #2: Yes</p>
    <p>**********</p>
    <p>5. Is the manuscript presented in an intelligible fashion and written in standard English?</p>
    <p>PLOS ONE does not copyedit accepted manuscripts, so the language in submitted articles must be clear, correct, and unambiguous. Any typographical or grammatical errors should be corrected at revision, so please note any specific errors here.</p>
    <p>Reviewer #1: Yes</p>
    <p>Reviewer #2: Yes</p>
    <p>**********</p>
    <p>6. Review Comments to the Author</p>
    <p>Please use the space provided to explain your answers to the questions above. You may also include additional comments for the author, including concerns about dual publication, research ethics, or publication ethics. (Please upload your review as an attachment if it exceeds 20,000 characters)</p>
    <p>Reviewer #1: Based on the parameters the authors provided in the response, I understand that the mapping rate issue based on the reference database they chose to map. In this way, the actual annotation rate might be provided to clarify the advantage of their software among others.</p>
    <p>Reviewer #2: (No Response)</p>
    <p>**********</p>
    <p>7. PLOS authors have the option to publish the peer review history of their article (<ext-link ext-link-type="uri" xlink:href="https://journals.plos.org/plosone/s/editorial-and-peer-review-process#loc-peer-review-history">what does this mean?</ext-link>). If published, this will include your full peer review and any attached files.</p>
    <p>If you choose “no”, your identity will remain anonymous but your review may still be made public.</p>
    <p><bold>Do you want your identity to be public for this peer review?</bold> For information about this choice, including consent withdrawal, please see our <ext-link ext-link-type="uri" xlink:href="https://www.plos.org/privacy-policy">Privacy Policy</ext-link>.</p>
    <p>Reviewer #1: No</p>
    <p>Reviewer #2: No</p>
    <p>[NOTE: If reviewer comments were submitted as an attachment file, they will be attached to this email and accessible via the submission site. Please log into your account, locate the manuscript record, and check for the action link "View Attachments". If this link does not appear, there are no attachment files to be viewed.]</p>
    <p>While revising your submission, please upload your figure files to the Preflight Analysis and Conversion Engine (PACE) digital diagnostic tool, <ext-link ext-link-type="uri" xlink:href="https://pacev2.apexcovantage.com/">https://pacev2.apexcovantage.com/</ext-link>. PACE helps ensure that figures meet PLOS requirements. To use PACE, you must first register as a user. Registration is free. Then, login and navigate to the UPLOAD tab, where you will find detailed instructions on how to use the tool. If you encounter any issues or have any questions when using PACE, please email us at <email>figures@plos.org</email>. Please note that Supporting Information files do not need this step.</p>
  </body>
</sub-article>
<sub-article id="pone.0231738.r006" article-type="author-comment">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pone.0231738.r006</article-id>
    <title-group>
      <article-title>Author response to Decision Letter 2</article-title>
    </title-group>
    <related-article id="rel-obj006" ext-link-type="doi" xlink:href="10.1371/journal.pone.0231738" related-article-type="editor-report"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>3</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="author-response-date">30 Jan 2020</named-content>
    </p>
    <p>Dear reviewer,</p>
    <p>We would like to thank you for providing us crucial feedback in order to improve the quality of the article.</p>
    <p>As suggested, we computed the actual annotation rates, which are the number of reads used for the annotation, divided by the number of reads sequenced.</p>
    <p>We added a figure with all the annotation rates, and it confirms that almost all the reads can be used for annotating the genome, as long as the sequencing quality is good, and the annotation exhaustive.</p>
    <p>Best regards,</p>
    <p>Christine Gaspin and Matthias Zytnicki.</p>
    <supplementary-material content-type="local-data" id="pone.0231738.s005">
      <label>Attachment</label>
      <caption>
        <p>Submitted filename: <named-content content-type="submitted-filename">response.txt</named-content></p>
      </caption>
      <media xlink:href="pone.0231738.s005.txt">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </body>
</sub-article>
<sub-article id="pone.0231738.r007" article-type="aggregated-review-documents">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pone.0231738.r007</article-id>
    <title-group>
      <article-title>Decision Letter 3</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Rizzo</surname>
          <given-names>Francesca</given-names>
        </name>
        <role>Academic Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2020 Francesca Rizzo</copyright-statement>
      <copyright-year>2020</copyright-year>
      <copyright-holder>Francesca Rizzo</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article id="rel-obj007" ext-link-type="doi" xlink:href="10.1371/journal.pone.0231738" related-article-type="reviewed-article"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>3</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">19 Feb 2020</named-content>
    </p>
    <p>PONE-D-19-16932R3</p>
    <p>mmannot: How to improve small–RNA annotation?</p>
    <p>PLOS ONE</p>
    <p>Dear Dr Zytnicki,</p>
    <p>Thank you for submitting your manuscript to PLOS ONE. After careful consideration, we feel that it has merit but does not fully meet PLOS ONE’s publication criteria as it currently stands. Therefore, we invite you to submit a revised version of the manuscript that addresses the points raised during the review process.</p>
    <p>We would appreciate receiving your revised manuscript by Apr 04 2020 11:59PM. When you are ready to submit your revision, log on to <ext-link ext-link-type="uri" xlink:href="https://www.editorialmanager.com/pone/">https://www.editorialmanager.com/pone/</ext-link> and select the 'Submissions Needing Revision' folder to locate your manuscript file.</p>
    <p>If you would like to make changes to your financial disclosure, please include your updated statement in your cover letter.</p>
    <p>To enhance the reproducibility of your results, we recommend that if applicable you deposit your laboratory protocols in protocols.io, where a protocol can be assigned its own identifier (DOI) such that it can be cited independently in the future. For instructions see: <ext-link ext-link-type="uri" xlink:href="http://journals.plos.org/plosone/s/submission-guidelines#loc-laboratory-protocols">http://journals.plos.org/plosone/s/submission-guidelines#loc-laboratory-protocols</ext-link></p>
    <p>Please include the following items when submitting your revised manuscript:</p>
    <p>
      <list list-type="bullet">
        <list-item>
          <p>A rebuttal letter that responds to each point raised by the academic editor and reviewer(s). This letter should be uploaded as separate file and labeled 'Response to Reviewers'.</p>
        </list-item>
        <list-item>
          <p>A marked-up copy of your manuscript that highlights changes made to the original version. This file should be uploaded as separate file and labeled 'Revised Manuscript with Track Changes'.</p>
        </list-item>
        <list-item>
          <p>An unmarked version of your revised paper without tracked changes. This file should be uploaded as separate file and labeled 'Manuscript'.</p>
        </list-item>
      </list>
    </p>
    <p>Please note while forming your response, if your article is accepted, you may have the opportunity to make the peer review history publicly available. The record will include editor decision letters (with reviews) and your responses to reviewer comments. If eligible, we will contact you to opt in or out.</p>
    <p>We look forward to receiving your revised manuscript.</p>
    <p>Kind regards,</p>
    <p>Francesca Rizzo, PhD</p>
    <p>Academic Editor</p>
    <p>PLOS ONE</p>
    <p>[Note: HTML markup is below. Please do not edit.]</p>
    <p>Reviewers' comments:</p>
    <p>Reviewer's Responses to Questions</p>
    <p>
      <bold>Comments to the Author</bold>
    </p>
    <p>1. If the authors have adequately addressed your comments raised in a previous round of review and you feel that this manuscript is now acceptable for publication, you may indicate that here to bypass the “Comments to the Author” section, enter your conflict of interest statement in the “Confidential to Editor” section, and submit your "Accept" recommendation.</p>
    <p>Reviewer #1: All comments have been addressed</p>
    <p>**********</p>
    <p>2. Is the manuscript technically sound, and do the data support the conclusions?</p>
    <p>The manuscript must describe a technically sound piece of scientific research with data that supports the conclusions. Experiments must have been conducted rigorously, with appropriate controls, replication, and sample sizes. The conclusions must be drawn appropriately based on the data presented. </p>
    <p>Reviewer #1: Partly</p>
    <p>**********</p>
    <p>3. Has the statistical analysis been performed appropriately and rigorously? </p>
    <p>Reviewer #1: No</p>
    <p>**********</p>
    <p>4. Have the authors made all data underlying the findings in their manuscript fully available?</p>
    <p>The <ext-link ext-link-type="uri" xlink:href="http://www.plosone.org/static/policies.action#sharing">PLOS Data policy</ext-link> requires authors to make all data underlying the findings described in their manuscript fully available without restriction, with rare exception (please refer to the Data Availability Statement in the manuscript PDF file). The data should be provided as part of the manuscript or its supporting information, or deposited to a public repository. For example, in addition to summary statistics, the data points behind means, medians and variance measures should be available. If there are restrictions on publicly sharing data—e.g. participant privacy or use of data from a third party—those must be specified.</p>
    <p>Reviewer #1: Yes</p>
    <p>**********</p>
    <p>5. Is the manuscript presented in an intelligible fashion and written in standard English?</p>
    <p>PLOS ONE does not copyedit accepted manuscripts, so the language in submitted articles must be clear, correct, and unambiguous. Any typographical or grammatical errors should be corrected at revision, so please note any specific errors here.</p>
    <p>Reviewer #1: Yes</p>
    <p>**********</p>
    <p>6. Review Comments to the Author</p>
    <p>Please use the space provided to explain your answers to the questions above. You may also include additional comments for the author, including concerns about dual publication, research ethics, or publication ethics. (Please upload your review as an attachment if it exceeds 20,000 characters)</p>
    <p>Reviewer #1: Most of my concerns are addressed in the latest revised manuscript. The new figure 7 confirmed my points that the annotation rate varies in different species. A statistical analysis might be performed among different software in this figure.</p>
    <p>**********</p>
    <p>7. PLOS authors have the option to publish the peer review history of their article (<ext-link ext-link-type="uri" xlink:href="https://journals.plos.org/plosone/s/editorial-and-peer-review-process#loc-peer-review-history">what does this mean?</ext-link>). If published, this will include your full peer review and any attached files.</p>
    <p>If you choose “no”, your identity will remain anonymous but your review may still be made public.</p>
    <p><bold>Do you want your identity to be public for this peer review?</bold> For information about this choice, including consent withdrawal, please see our <ext-link ext-link-type="uri" xlink:href="https://www.plos.org/privacy-policy">Privacy Policy</ext-link>.</p>
    <p>Reviewer #1: No</p>
    <p>[NOTE: If reviewer comments were submitted as an attachment file, they will be attached to this email and accessible via the submission site. Please log into your account, locate the manuscript record, and check for the action link "View Attachments". If this link does not appear, there are no attachment files to be viewed.]</p>
    <p>While revising your submission, please upload your figure files to the Preflight Analysis and Conversion Engine (PACE) digital diagnostic tool, <ext-link ext-link-type="uri" xlink:href="https://pacev2.apexcovantage.com/">https://pacev2.apexcovantage.com/</ext-link>. PACE helps ensure that figures meet PLOS requirements. To use PACE, you must first register as a user. Registration is free. Then, login and navigate to the UPLOAD tab, where you will find detailed instructions on how to use the tool. If you encounter any issues or have any questions when using PACE, please email us at <email>figures@plos.org</email>. Please note that Supporting Information files do not need this step.</p>
  </body>
</sub-article>
<sub-article id="pone.0231738.r008" article-type="author-comment">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pone.0231738.r008</article-id>
    <title-group>
      <article-title>Author response to Decision Letter 3</article-title>
    </title-group>
    <related-article id="rel-obj008" ext-link-type="doi" xlink:href="10.1371/journal.pone.0231738" related-article-type="editor-report"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>4</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="author-response-date">25 Mar 2020</named-content>
    </p>
    <p>Dear Reviewer,</p>
    <p>First, we would like to thank you for providing us crucial feedback in order to improve the quality of the article.</p>
    <p>We counted the number of reads used by our method and other methods, and we tested (using a one-sided Wilcoxon signed-rank test) if we used significantly more reads.</p>
    <p>The p-value are always not greater than 2e-4.</p>
    <p>These results are summarized in a new Table, which we added in the manuscript.</p>
    <p>We hope that you will find this revision acceptable.</p>
    <p>Best regads,</p>
    <p>Christine Gaspin and Matthias Zytnicki.</p>
    <supplementary-material content-type="local-data" id="pone.0231738.s006">
      <label>Attachment</label>
      <caption>
        <p>Submitted filename: <named-content content-type="submitted-filename">response.pdf</named-content></p>
      </caption>
      <media xlink:href="pone.0231738.s006.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </body>
</sub-article>
<sub-article id="pone.0231738.r009" article-type="editor-report">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pone.0231738.r009</article-id>
    <title-group>
      <article-title>Decision Letter 4</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Rizzo</surname>
          <given-names>Francesca</given-names>
        </name>
        <role>Academic Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2020 Francesca Rizzo</copyright-statement>
      <copyright-year>2020</copyright-year>
      <copyright-holder>Francesca Rizzo</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article id="rel-obj009" ext-link-type="doi" xlink:href="10.1371/journal.pone.0231738" related-article-type="reviewed-article"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>4</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">31 Mar 2020</named-content>
    </p>
    <p>mmannot: How to improve small–RNA annotation?</p>
    <p>PONE-D-19-16932R4</p>
    <p>Dear Dr. Zytnicki,</p>
    <p>We are pleased to inform you that your manuscript has been judged scientifically suitable for publication and will be formally accepted for publication once it complies with all outstanding technical requirements.</p>
    <p>Within one week, you will receive an e-mail containing information on the amendments required prior to publication. When all required modifications have been addressed, you will receive a formal acceptance letter and your manuscript will proceed to our production department and be scheduled for publication.</p>
    <p>Shortly after the formal acceptance letter is sent, an invoice for payment will follow. To ensure an efficient production and billing process, please log into Editorial Manager at <ext-link ext-link-type="uri" xlink:href="https://www.editorialmanager.com/pone/">https://www.editorialmanager.com/pone/</ext-link>, click the "Update My Information" link at the top of the page, and update your user information. If you have any billing related questions, please contact our Author Billing department directly at <email>authorbilling@plos.org</email>.</p>
    <p>If your institution or institutions have a press office, please notify them about your upcoming paper to enable them to help maximize its impact. If they will be preparing press materials for this manuscript, you must inform our press team as soon as possible and no later than 48 hours after receiving the formal acceptance. Your manuscript will remain under strict press embargo until 2 pm Eastern Time on the date of publication. For more information, please contact <email>onepress@plos.org</email>.</p>
    <p>With kind regards,</p>
    <p>Francesca Rizzo, PhD</p>
    <p>Academic Editor</p>
    <p>PLOS ONE</p>
  </body>
</sub-article>
<sub-article id="pone.0231738.r010" article-type="editor-report">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pone.0231738.r010</article-id>
    <title-group>
      <article-title>Acceptance letter</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Rizzo</surname>
          <given-names>Francesca</given-names>
        </name>
        <role>Academic Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2020 Francesca Rizzo</copyright-statement>
      <copyright-year>2020</copyright-year>
      <copyright-holder>Francesca Rizzo</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article id="rel-obj010" ext-link-type="doi" xlink:href="10.1371/journal.pone.0231738" related-article-type="reviewed-article"/>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">3 Apr 2020</named-content>
    </p>
    <p>PONE-D-19-16932R4 </p>
    <p>mmannot: How to improve small–RNA annotation? </p>
    <p>Dear Dr. Matthias:</p>
    <p>I am pleased to inform you that your manuscript has been deemed suitable for publication in PLOS ONE. Congratulations! Your manuscript is now with our production department. </p>
    <p>If your institution or institutions have a press office, please notify them about your upcoming paper at this point, to enable them to help maximize its impact. If they will be preparing press materials for this manuscript, please inform our press team within the next 48 hours. Your manuscript will remain under strict press embargo until 2 pm Eastern Time on the date of publication. For more information please contact <email>onepress@plos.org</email>.</p>
    <p>For any other questions or concerns, please email <email>plosone@plos.org</email>. </p>
    <p>Thank you for submitting your work to PLOS ONE.</p>
    <p>With kind regards,</p>
    <p>PLOS ONE Editorial Office Staff</p>
    <p>on behalf of</p>
    <p>Dr. Francesca Rizzo </p>
    <p>Academic Editor</p>
    <p>PLOS ONE</p>
  </body>
</sub-article>
