<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">5870705</article-id>
    <article-id pub-id-type="pmid">28882001</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btx269</article-id>
    <article-id pub-id-type="publisher-id">btx269</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Ismb/Eccb 2017: The 25th Annual Conference Intelligent Systems for Molecular Biology Held Jointly with the 16th Annual European Conference on Computational Biology, Prague, Czech Republic, July 21–25, 2017</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>RNA</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Efficient approximations of RNA kinetics landscape using non-redundant sampling</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Michálik</surname>
          <given-names>Juraj</given-names>
        </name>
        <xref ref-type="aff" rid="btx269-aff1">1</xref>
        <xref ref-type="aff" rid="btx269-aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Touzet</surname>
          <given-names>Hélène</given-names>
        </name>
        <xref ref-type="aff" rid="btx269-aff3">3</xref>
        <xref ref-type="aff" rid="btx269-aff4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ponty</surname>
          <given-names>Yann</given-names>
        </name>
        <xref ref-type="aff" rid="btx269-aff1">1</xref>
        <xref ref-type="aff" rid="btx269-aff2">2</xref>
        <xref ref-type="corresp" rid="btx269-cor1"/>
        <!--<email>yann.ponty@lix.polytechnique.fr</email>-->
      </contrib>
    </contrib-group>
    <aff id="btx269-aff1"><label>1</label>AMIB project, Inria Saclay, Palaiseau, France</aff>
    <aff id="btx269-aff2"><label>2</label>LIX CNRS UMR 7161, Ecole Polytechnique, Palaiseau, France</aff>
    <aff id="btx269-aff3"><label>3</label>CNRS, CRIStAL (UMR 9189, University of Lille), Villeneuve d’Ascq, France</aff>
    <aff id="btx269-aff4"><label>4</label>Bonsai project, Inria Lille-Nord Europe, Villeneuve d’Ascq, France</aff>
    <author-notes>
      <corresp id="btx269-cor1">To whom correspondence should be addressed. Email: <email>yann.ponty@lix.polytechnique.fr</email></corresp>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>15</day>
      <month>7</month>
      <year>2017</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2017-07-12">
      <day>12</day>
      <month>7</month>
      <year>2017</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>12</day>
      <month>7</month>
      <year>2017</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. -->
    <volume>33</volume>
    <issue>14</issue>
    <fpage>i283</fpage>
    <lpage>i292</lpage>
    <permissions>
      <copyright-statement>© The Author 2017. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2017</copyright-year>
      <license license-type="cc-by-nc" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/">http://creativecommons.org/licenses/by-nc/4.0/</ext-link>), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.com</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btx269.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="SA1">
        <title>Motivation</title>
        <p>Kinetics is key to understand many phenomena involving RNAs, such as co-transcriptional folding and riboswitches. Exact out-of-equilibrium studies induce extreme computational demands, leading state-of-the-art methods to rely on approximated kinetics landscapes, obtained using sampling strategies that strive to generate the key landmarks of the landscape topology. However, such methods are impeded by a large level of redundancy within sampled sets. Such a redundancy is uninformative, and obfuscates important intermediate states, leading to an incomplete vision of RNA dynamics.</p>
      </sec>
      <sec id="SA2">
        <title>Results</title>
        <p>We introduce RNANR, a new set of algorithms for the exploration of RNA kinetics landscapes at the secondary structure level. RNANR considers locally optimal structures, a reduced set of RNA conformations, in order to focus its sampling on basins in the kinetic landscape. Along with an exhaustive enumeration, RNANR implements a novel non-redundant stochastic sampling, and offers a rich array of structural parameters. Our tests on both real and random RNAs reveal that RNANR allows to generate more unique structures in a given time than its competitors, and allows a deeper exploration of kinetics landscapes.</p>
      </sec>
      <sec id="SA3">
        <title>Availability and implementation</title>
        <p>RNANR is freely available at <ext-link ext-link-type="uri" xlink:href="https://project.inria.fr/rnalands/rnanr">https://project.inria.fr/rnalands/rnanr</ext-link>.</p>
      </sec>
    </abstract>
    <counts>
      <page-count count="10"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>RiboNucleic Acids (RNAs) are fascinating biopolymers. Beyond their coding capacities, they can serve as a medium for the transmission of genetic information, as in the case of highly structured RNA viruses such as Ebola or HIV (<xref rid="btx269-B43" ref-type="bibr">Wilkinson <italic>et al.</italic>, 2008</xref>). They can also perform a large diversity of catalytic and regulatory functions, as demonstrated by the 2474 functional families found in the current release of the RFAM database (<xref rid="btx269-B30" ref-type="bibr">Nawrocki <italic>et al.</italic>, 2015</xref>). This versatility is such that RNA is currently considered by a whole scientific community as the most parsimonious explanation for the molecular basis of the origin of life (<xref rid="btx269-B5" ref-type="bibr">Cech, 2015</xref>). This versatility, coupled with the combinatorial specificity of its interactions with other nucleic acids, makes RNA a tool of choice for designing nanoarchitectures through programmable self-assembly (<xref rid="btx269-B19" ref-type="bibr">Li <italic>et al.</italic>, 2011</xref>), or in the blooming field of synthetic biology (<xref rid="btx269-B18" ref-type="bibr">Kushwaha <italic>et al.</italic>, 2016</xref>).</p>
    <p>A substantial proportion of the functions performed by RNAs critically relies on the adoption of a stable 3D structure through a pairing of its nucleotides, mediated by hydrogen bonds. A precise structural modeling of RNA structure, possibly in interaction with other molecules, is thus required to identify binding and catalytic sites, and more generally formulate functional hypotheses <xref rid="btx269-B6" ref-type="bibr">Cruz and Westhof (2011)</xref>. Despite recent progress, such as SHAPE chemistry (<xref rid="btx269-B37" ref-type="bibr">Smola <italic>et al.</italic>, 2015</xref>), experimental techniques for RNA structure resolution are still lagging behind high-throughput sequencing techniques, leading to a striking asymmetry between the amount of available structure and sequence data. It is a current challenge of RNA bioinformatics, and the object of ongoing efforts for a whole community, to accurately predict the structure of RNA from its sequence by integrating data of various origins (<xref rid="btx269-B28" ref-type="bibr">Miao <italic>et al.</italic>, 2015</xref>).</p>
    <p>RNA folding is inherently stochastic, and governed by the laws of statistical physics (<xref rid="btx269-B27" ref-type="bibr">McCaskill, 1990</xref>). It is generally believed to be hierarchical (<xref rid="btx269-B38" ref-type="bibr">Tinoco and Bustamante, 1999</xref>) which, in conjunction with intrinsic computational limitations (<xref rid="btx269-B1" ref-type="bibr">Akutsu, 2000</xref>; <xref rid="btx269-B36" ref-type="bibr">Sheikh <italic>et al.</italic>, 2012</xref>), has led to an initial dismissal of complex topological motifs such as pseudoknots within computational methods (<xref rid="btx269-B16" ref-type="bibr">Isambert, 2009</xref>). The seminal work of <xref rid="btx269-B27" ref-type="bibr">McCaskill (1990)</xref> has demonstrated the computability in polynomial-time of the partition function and the subsequent derivation of base-pairing probabilities which provide realistic notion of supports for predicted base pairs (<xref rid="btx269-B26" ref-type="bibr">Mathews, 2004</xref>).</p>
    <p>However the assumption of a thermodynamic equilibrium fails to account for the observed behavior of certain RNAs, which strongly suggests the prevalence of kinetics effects in their folding process. Perhaps the most prominent example can be found in riboswitches (<xref rid="btx269-B4" ref-type="bibr">Baumstark <italic>et al.</italic>, 1997</xref>; <xref rid="btx269-B33" ref-type="bibr">Schultes and Bartel, 2000</xref>), RNAs that have been found to adopt different conformations depending on the presence/absence of a ligand, despite a significant difference in free energies between the two conformers. This is hardly compatible with the assumption of a thermodynamic equilibrium, which would dictate the main adoption of the Minimal Free Energy (MFE) structure regardless of the presence of the ligand. This is however consistent with a kinetics-inspired model, where the ligand modulates an energy barrier separating the two conformers in the folding landscape, modifying the convergence speed towards the thermodynamic equilibrium (<xref rid="btx269-B3" ref-type="bibr">Badelt <italic>et al.</italic>, 2015</xref>). The prevalence of kinetics effects can also be suspected in instances of co-transcriptional folding (<xref rid="btx269-B42" ref-type="bibr">Watters <italic>et al.</italic>, 2016</xref>), or when transcripts undergo a fast degradation and the half-life of some transcript are much shorter than the time taken to converge towards the thermodynamic equilibrium (<xref rid="btx269-B35" ref-type="bibr">Sharova <italic>et al.</italic>, 2009</xref>).</p>
    <p>Computational methods for the study of RNA kinetics essentially fall into two categories. A first category of methods, dubbed <italic>simulation methods</italic>, perform a stochastic simulation of the folding process at the base-pair (<xref rid="btx269-B13" ref-type="bibr">Flamm <italic>et al.</italic>, 2000</xref>, Kinfold) or helix (<xref rid="btx269-B7" ref-type="bibr">Danilova <italic>et al.</italic>, 2006</xref>, RNAKinetics) step resolution, possibly allowing for the presence of pseudoknots (<xref rid="btx269-B46" ref-type="bibr">Xayaphoummine <italic>et al.</italic>, 2007</xref>, kinefold). Sets of generated folding trajectories are analyzed and main conformers, along with the evolution of their concentrations through time, is easily obtained.</p>
    <p>However, as noted in <xref rid="btx269-B12" ref-type="bibr">Flamm and Hofacker (2008)</xref>, the number of trajectories required to obtain reproducible results quickly becomes prohibitively large as the size of RNAs increases. For this reason, a second type of computational methods analyze RNA kinetics as a continuous Markov process, adopting a general four-steps program: <bold>Generation</bold> of a representative subset of conformations; <bold>Embedding</bold> of representative conformations into adjacency structure, whose main alternatives are barrier trees used by barrier (<xref rid="btx269-B15" ref-type="bibr">Flamm <italic>et al.</italic>, 2002</xref>), and the basin hopping graphs of BHGBuilder (<xref rid="btx269-B17" ref-type="bibr">Kucharik <italic>et al.</italic>, 2014</xref>); <bold>Estimation</bold> of transition rates from (approximate) energy barriers. The exact computation of this quantity requires solving an NP-hard problem (<xref rid="btx269-B25" ref-type="bibr">Maňuch <italic>et al.</italic>, 2011</xref>), and available methods rely on direct path heuristics (<xref rid="btx269-B29" ref-type="bibr">Morgan and Higgs, 1998</xref>), or on upper bounds based on 2D projections of folding landscapes (<xref rid="btx269-B21" ref-type="bibr">Lorenz <italic>et al.</italic>, 2009</xref>; <xref rid="btx269-B34" ref-type="bibr">Senter <italic>et al.</italic>, 2015</xref>); <bold>Analysis</bold> of the evolution of concentrations through time, typically through numerical integration as provided by treekin (<xref rid="btx269-B44" ref-type="bibr">Wolfinger <italic>et al.</italic>, 2004</xref>).</p>
    <p>The present work pertains to the <italic>generation</italic> step, arguably the most critical aspect of kinetics analysis. A first category of approaches, such that RNASLOpt (<xref rid="btx269-B20" ref-type="bibr">Li and Zhang, 2011</xref>) and RNAsubopt (<xref rid="btx269-B45" ref-type="bibr">Wuchty <italic>et al.</italic>, 1999</xref>), rely on an exhaustive enumeration of suboptimal structures within some predefined energy distance of the MFE. Popular alternatives, such as RNALocmin (<xref rid="btx269-B17" ref-type="bibr">Kucharik <italic>et al.</italic>, 2014</xref>) and RNALocopt (<xref rid="btx269-B23" ref-type="bibr">Lorenz and Clote, 2011</xref>), rely on some variation on Boltzmann-Gibbs sampling. <xref rid="btx269-B17" ref-type="bibr">Kucharik <italic>et al.</italic> (2014)</xref> have noted the difficulties of existing approaches relying on sampling to generate unique conformations, leading to the adoption by RNALocmin of an adaptive heuristics similar to simulated-annealing called <italic>ξ</italic>-scheduling to increase the sample diversity as the Bolzmann ensemble of low-energy becomes saturated. Despite such specific efforts, as shown in <xref ref-type="fig" rid="btx269-F1">Figure 1</xref>, the number of distinct structures decreases as the number of sample increases, making it hard to reach alternative structures beyond a few kcal.mol<sup>−1</sup> of the MFE structure.</p>
    <fig id="btx269-F1" orientation="portrait" position="float">
      <label>Fig. 1.</label>
      <caption>
        <p>Comparison of local minima production speed for the SV11 RNA switch L07337_1 (115 nt). Experiment reproduced from <xref rid="btx269-B17" ref-type="bibr">Kucharik <italic>et al.</italic> (2014)</xref></p>
      </caption>
      <graphic xlink:href="btx269f1"/>
    </fig>
  </sec>
  <sec>
    <title>2 Approach</title>
    <p>We introduce the concept of <bold>non-redundant sampling</bold> to study RNA kinetics, using <bold>locally optimal secondary structures</bold> as representative structures. Working with a reduced conformation space allows to mitigate the limitations of existing (redundant) sampling approaches. The problem of constructing all locally optimal secondary structures was addressed in <xref rid="btx269-B32" ref-type="bibr">Saffarian <italic>et al.</italic> (2012)</xref>. Here, we describe an alternative generation algorithm which is efficient, and allows the specification of comprehensive structural restrictions (Section 2.2). We then define the first non-redundant sampling algorithm for locally optimal RNA structures (Section 2.3), allowing for the exploration of RNA folding landscape. The two algorithms are implemented within the standalone software RNANR.</p>
    <sec>
      <title>2.1 Definitions</title>
      <p>An <bold>RNA</bold> sequence <italic>w</italic> is a nucleotide sequence of length <italic>n</italic> over the alphabet <inline-formula id="IE1"><mml:math id="IEQ1"><mml:mrow><mml:mo>{</mml:mo><mml:mi mathvariant="normal">A</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">C</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">G</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">U</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula>. The symbol at position <italic>i</italic> is denoted by <inline-formula id="IE2"><mml:math id="IEQ2"><mml:mrow><mml:mi>w</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula>. A <bold>secondary structure</bold><italic>S</italic> is set of pairs of positions in <italic>w</italic>, called <bold>base pairs</bold>, that are pairwise <bold>juxtaposed</bold> or <bold>nested</bold>. Specifically, if two base pairs (<italic>i</italic>, <italic>j</italic>) and <inline-formula id="IE3"><mml:math id="IEQ3"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mo>ℓ</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> are such that <inline-formula id="IE4"><mml:math id="IEQ4"><mml:mrow><mml:mi>i</mml:mi><mml:mo>≤</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:math></inline-formula>, then either <inline-formula id="IE5"><mml:math id="IEQ5"><mml:mrow><mml:mi>i</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>j</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>k</mml:mi><mml:mo>&lt;</mml:mo><mml:mo>ℓ</mml:mo></mml:mrow></mml:math></inline-formula> or <inline-formula id="IE6"><mml:math id="IEQ6"><mml:mrow><mml:mi>i</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>k</mml:mi><mml:mo>&lt;</mml:mo><mml:mo>ℓ</mml:mo><mml:mo>&lt;</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:math></inline-formula>. This definition implies that a secondary structure is non-crossing, or <bold>pseudoknot-free</bold>, and each position is involved in at most one base pair. As a consequence, it can be encoded by a <italic>dot-parenthesis</italic> expression, where each base pair is a pair of matching brackets and unpaired positions are reprented by a dot. We also require that each pair (<italic>i</italic>, <italic>j</italic>) in <italic>S</italic> is <bold>valid</bold>, i.e. <inline-formula id="IE7"><mml:math id="IEQ7"><mml:mrow><mml:mo>{</mml:mo><mml:mi>w</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>,</mml:mo><mml:mi>w</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula> is in <inline-formula id="IE8"><mml:math id="IEQ8"><mml:mrow><mml:mo>{</mml:mo><mml:mo>{</mml:mo><mml:mi mathvariant="normal">A</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">U</mml:mi><mml:mo>}</mml:mo><mml:mo>,</mml:mo><mml:mo>{</mml:mo><mml:mi mathvariant="normal">C</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">G</mml:mi><mml:mo>}</mml:mo><mml:mo>,</mml:mo><mml:mo>{</mml:mo><mml:mi mathvariant="normal">U</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">G</mml:mi><mml:mo>}</mml:mo><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula>. Given a base pair (<italic>x</italic>, <italic>y</italic>), we denote <inline-formula id="IE9"><mml:math id="IEQ9"><mml:mrow><mml:msup><mml:mi>h</mml:mi><mml:mi>p</mml:mi></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> the <bold>helix</bold> of length <italic>p</italic> stemming from (<italic>x</italic>, <italic>y</italic>): this is the set of base pairs <inline-formula id="IE10"><mml:math id="IEQ10"><mml:mrow><mml:mo>{</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>+</mml:mo><mml:mi>p</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>−</mml:mo><mml:mi>p</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula>.</p>
      <sec>
        <title>2.1.1 Structural restrictions</title>
        <p>The set of secondary structures on a given sequence can be further restricted by enforcing additional constraints, giving rise to more realistic structures. Those restrictions include: a) the <bold>minimum helix length</bold><italic>α</italic>. In particular, isolated base pairs are forbidden for any value <inline-formula id="IE11"><mml:math id="IEQ11"><mml:mrow><mml:mo>α</mml:mo><mml:mo>&gt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>; b) the <bold>maximum number of consecutive unpaired bases</bold> in the structure <italic>β</italic>; c) the <bold>maximum number of branches</bold> within a multiloop <inline-formula id="IE12"><mml:math id="IEQ12"><mml:mrow><mml:mo>γ</mml:mo><mml:mo>≥</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, which defines the maximum allowed number of outermost base pairs within another base pair; d) the <bold>minimum length of a hairpin loop</bold><italic>θ</italic>. These parameters are illustrated on <xref ref-type="fig" rid="btx269-F2">Figure 2</xref>. The special case <italic>α</italic> = 1, <inline-formula id="IE13"><mml:math id="IEQ13"><mml:mrow><mml:mo>β</mml:mo><mml:mo>=</mml:mo><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mo>γ</mml:mo><mml:mo>=</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math></inline-formula> and <italic>θ</italic> = 1 corresponds to the whole set of secondary structures.</p>
        <fig id="btx269-F2" orientation="portrait" position="float">
          <label>Fig. 2.</label>
          <caption>
            <p>Graphical representation of the structural restrictions supported by RNANR. <italic>α</italic> is the lower bound on the size of helices. <italic>θ</italic> is the minimum length of a hairpin. <italic>γ</italic> limits the maximum number of branches within multiloops. Finally, <italic>β</italic> is the maximum number of nucleotides in unpaired regions</p>
          </caption>
          <graphic xlink:href="btx269f2"/>
        </fig>
        <p>Subsequently, we will use <inline-formula id="IE14"><mml:math id="IEQ14"><mml:mi mathvariant="script">S</mml:mi></mml:math></inline-formula> as a shorthand for this <bold>search space</bold>, i.e. the restriction of secondary structures that respect those parameters. Within this search space, we define the <bold>neighborhood</bold> of a secondary structure <italic>S</italic> as the subset of secondary structures on <italic>w</italic> that can be obtained by adding or removing a single base pair in <italic>S</italic>.</p>
      </sec>
      <sec>
        <title>2.1.2 Energy models</title>
        <p>For a given secondary structure <italic>S</italic> on <italic>w</italic>, we associate a <bold>free energy</bold><italic>E<sub>S</sub></italic>, computed with respect to a specific energy model. In this work, we consider two energy models. The first model is a simple base-pairing model where the energy is the number of base pairs. We call it the <bold>Nussinov</bold> model in the spirit of (<xref rid="btx269-B31" ref-type="bibr">Nussinov and Jacobson, 1980</xref>), even if structural restrictions introduced in the preceding paragraph significantly reduce the set of secondary structures. The second model is the 2004 version of the <bold>Turner</bold> thermodynamic model (<xref rid="btx269-B40" ref-type="bibr">Turner <italic>et al.</italic>, 1988</xref>; <xref rid="btx269-B39" ref-type="bibr">Turner and Mathews, 2010</xref>). For a given free energy model, we say that a secondary structure is <bold>locally optimal</bold> if, and only if, it has minimal free energy within its neighborhood. We respectively denote by <inline-formula id="IE15"><mml:math id="IEQ15"><mml:mrow><mml:msub><mml:mi>ℓ</mml:mi><mml:mi mathvariant="script">N</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE16"><mml:math id="IEQ16"><mml:mrow><mml:msub><mml:mi>ℓ</mml:mi><mml:mi mathvariant="script">T</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> the <bold>sets of locally optimal secondary structures (LOSSes)</bold> with respect to the Nussinov and Turner energy models, and will respectively refer to them as Nussinov LOSSes and Turner LOSSes in the following.</p>
      </sec>
      <sec>
        <title>2.1.3 Thermodynamic concepts</title>
        <p>From a free-energy model, one computes the <bold>Boltzmann factor</bold><inline-formula id="IE17"><mml:math id="IEQ17"><mml:mrow><mml:msub><mml:mi mathvariant="script">B</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> of a secondary structure as <inline-formula id="IE18"><mml:math id="IEQ18"><mml:mrow><mml:msub><mml:mi mathvariant="script">Z</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mfrac><mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> where <inline-formula id="IE19"><mml:math id="IEQ19"><mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> is the free energy of <italic>s</italic>, <italic>k</italic> is the Boltzmann constant and <italic>T</italic> is the temperature in Kelvin. The <bold>partition function</bold><inline-formula id="IE20"><mml:math id="IEQ20"><mml:mi mathvariant="script">Z</mml:mi></mml:math></inline-formula> is obtained by summing the Boltzmann factors of all the conformations in a set <inline-formula id="IE21"><mml:math id="IEQ21"><mml:mi mathvariant="script">S</mml:mi></mml:math></inline-formula>:
<disp-formula id="E1"><label>(1)</label><mml:math id="EQ1"><mml:mrow><mml:mi mathvariant="script">Z</mml:mi><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="script">S</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:msub><mml:mi mathvariant="script">B</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></disp-formula>
The <bold>Boltzmann probability</bold> of a given structure <italic>s</italic> in <inline-formula id="IE22"><mml:math id="IEQ22"><mml:mi mathvariant="script">S</mml:mi></mml:math></inline-formula> is then simply defined as <inline-formula id="IE23"><mml:math id="IEQ23"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi mathvariant="script">B</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:mrow><mml:mi mathvariant="script">Z</mml:mi></mml:mfrac></mml:mrow></mml:math></inline-formula>. Finally, given a set of structures <inline-formula id="IE24"><mml:math id="IEQ24"><mml:mrow><mml:mi mathvariant="script">T</mml:mi><mml:mo>⊂</mml:mo><mml:mi mathvariant="script">S</mml:mi></mml:mrow></mml:math></inline-formula>, we define the <bold>coverage</bold><inline-formula id="IE25"><mml:math id="IEQ25"><mml:mrow><mml:mi>c</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="script">T</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> as the accumulated Boltzmann probability in the set, also expressed as
<disp-formula id="E2"><label>(2)</label><mml:math id="EQ2"><mml:mrow><mml:mi>c</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="script">T</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="script">T</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:msub><mml:mi mathvariant="script">B</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:mrow><mml:mi mathvariant="script">Z</mml:mi></mml:mfrac></mml:mrow></mml:math></disp-formula></p>
      </sec>
    </sec>
    <sec>
      <title>2.2 Building LOSSes in the restrained Nussinov model</title>
      <p>In <xref rid="btx269-B32" ref-type="bibr">Saffarian <italic>et al.</italic> (2012)</xref>, it is shown that locally optimal secondary structures without structural restrictions can be built from substructures that are maximal by juxtaposition, called here <bold>flat structures</bold> in short. We elaborate on this idea in order to account for the expressive set of structural restrictions introduced in Section 2.1.</p>
      <sec>
        <title>2.2.1 Flat structures</title>
        <p>For any interval <inline-formula id="IE26"><mml:math id="IEQ26"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula> in <italic>w</italic>, a flat structure <italic>f</italic> is a sequence of juxtaposed (non-nested) helices which is <bold>maximal</bold>, meaning that it cannot be completed by a valid base pair between the positions left accessible by the helices. In other words, let <inline-formula id="IE27"><mml:math id="IEQ27"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mo>ℓ</mml:mo></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mo>ℓ</mml:mo></mml:msub></mml:mrow></mml:math></inline-formula> be positions in <italic>w</italic>, such that <inline-formula id="IE28"><mml:math id="IEQ28"><mml:mrow><mml:mi>i</mml:mi><mml:mo>≤</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>&lt;</mml:mo><mml:mo>…</mml:mo><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mo>ℓ</mml:mo></mml:msub><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mo>ℓ</mml:mo></mml:msub><mml:mo>≤</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:math></inline-formula> and such that <inline-formula id="IE29"><mml:math id="IEQ29"><mml:mrow><mml:msup><mml:mi>h</mml:mi><mml:mo>α</mml:mo></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is a valid helix for each <italic>k</italic>, <inline-formula id="IE30"><mml:math id="IEQ30"><mml:mrow><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>k</mml:mi><mml:mo>≤</mml:mo><mml:mo>ℓ</mml:mo></mml:mrow></mml:math></inline-formula>. This sequence of helices is a flat structure <italic>f</italic> on <inline-formula id="IE31"><mml:math id="IEQ31"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula> if, and only if: for each secondary structure <italic>S</italic> on <inline-formula id="IE32"><mml:math id="IEQ32"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula> containing <italic>f</italic>, if (<italic>x</italic>, <italic>y</italic>) is in <italic>S</italic> and not in <italic>f</italic>, then (<italic>x</italic>, <italic>y</italic>) is nested in (<italic>x<sub>k</sub></italic>, <italic>y<sub>k</sub></italic>) for some <inline-formula id="IE33"><mml:math id="IEQ33"><mml:mrow><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>k</mml:mi><mml:mo>≤</mml:mo><mml:mo>ℓ</mml:mo></mml:mrow></mml:math></inline-formula>. We further assume that <inline-formula id="IE34"><mml:math id="IEQ34"><mml:mrow><mml:mo>ℓ</mml:mo><mml:mo>≤</mml:mo><mml:mo>γ</mml:mo><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:mo>α</mml:mo><mml:mo>≥</mml:mo><mml:mo>θ</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE35"><mml:math id="IEQ35"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>≤</mml:mo><mml:mo>β</mml:mo></mml:mrow></mml:math></inline-formula> to meet the requirements on <italic>β</italic>, <italic>δ</italic> and <italic>θ</italic>. We denote by <inline-formula id="IE36"><mml:math id="IEQ36"><mml:mrow><mml:msubsup><mml:mo>⊕</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>ℓ</mml:mo></mml:msubsup><mml:msup><mml:mi>h</mml:mi><mml:mo>α</mml:mo></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> such a flat structure, assuming that <inline-formula id="IE37"><mml:math id="IEQ37"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>&lt;</mml:mo><mml:mo>…</mml:mo><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mo>ℓ</mml:mo></mml:msub></mml:mrow></mml:math></inline-formula>. We denote by <inline-formula id="IE38"><mml:math id="IEQ38"><mml:mrow><mml:msub><mml:mi mathvariant="script">F</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> the <bold>complete set of flat structures</bold> associated with the region <inline-formula id="IE39"><mml:math id="IEQ39"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula> in <italic>w</italic>, as illustrated by <xref ref-type="fig" rid="btx269-F3">Figure 3</xref>. When an interval <inline-formula id="IE40"><mml:math id="IEQ40"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula> is not associated with any flat structure, we have <inline-formula id="IE41"><mml:math id="IEQ41"><mml:mrow><mml:msub><mml:mi mathvariant="script">F</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:mo>ε</mml:mo><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula> (<italic>ε</italic> is the <bold>empty</bold> flat structure) whenever <inline-formula id="IE42"><mml:math id="IEQ42"><mml:mrow><mml:mi>j</mml:mi><mml:mo>−</mml:mo><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mo>θ</mml:mo></mml:mrow></mml:math></inline-formula>, and <inline-formula id="IE43"><mml:math id="IEQ43"><mml:mrow><mml:msub><mml:mi mathvariant="script">F</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>∅</mml:mo></mml:mrow></mml:math></inline-formula> (empty set) otherwise. <inline-formula id="IE44"><mml:math id="IEQ44"><mml:mrow><mml:msub><mml:mi mathvariant="script">F</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> can be computed using a dynamic programming scheme adapted from Section 3.1.2, Theorem 2 in <xref rid="btx269-B32" ref-type="bibr">Saffarian <italic>et al.</italic> (2012)</xref>.</p>
        <fig id="btx269-F3" orientation="portrait" position="float">
          <label>Fig. 3.</label>
          <caption>
            <p>Examples of flat structures. For the structural parameters <italic>α</italic> = 2, <italic>δ</italic> = 3, <italic>θ</italic> = 1 and <italic>γ</italic> = 3, the set <inline-formula id="IE45"><mml:math id="IEQ45"><mml:mrow><mml:msub><mml:mi mathvariant="script">F</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>18</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> of flat structures associated with the interval <inline-formula id="IE46"><mml:math id="IEQ46"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>18</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula> consists of the five flat structures <inline-formula id="IE47"><mml:math id="IEQ47"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>⋯</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mn>5</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>. Note that <inline-formula id="IE48"><mml:math id="IEQ48"><mml:mrow><mml:msup><mml:mi>h</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>7</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>⊕</mml:mo><mml:msup><mml:mi>h</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mn>8</mml:mn><mml:mo>,</mml:mo><mml:mn>14</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> does not meet the condition on <italic>γ</italic>, as positions 15 and 18 are left unpaired, and thus is not a valid flat structure</p>
          </caption>
          <graphic xlink:href="btx269f3"/>
        </fig>
        <fig id="btx269-F4" orientation="portrait" position="float">
          <label>Fig. 4.</label>
          <caption>
            <p>All locally optimal secondary structures of <inline-formula id="IE49"><mml:math id="IEQ49"><mml:mrow><mml:msub><mml:mi>ℓ</mml:mi><mml:mi mathvariant="script">N</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> generated by the grammar <italic>G<sub>w</sub></italic> for the sequence, and using structural restrictions, described in Figure 3</p>
          </caption>
          <graphic xlink:href="btx269f4"/>
        </fig>
      </sec>
      <sec>
        <title>2.2.2 A grammar for <inline-formula id="IE50"><mml:math id="IEQ50"><mml:mrow><mml:msub><mml:mi>ℓ</mml:mi><mml:mi mathvariant="script">N</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula></title>
        <p>Now comes the crucial observation that any locally optimal secondary structure of <inline-formula id="IE51"><mml:math id="IEQ51"><mml:mrow><mml:msub><mml:mi>ℓ</mml:mi><mml:mi mathvariant="script">N</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> can be built up from a set of flat structures, completed with <bold>helix extensions</bold> as illustrated by<xref ref-type="fig" rid="btx269-F4"> Figure 4</xref>. Given a helix <inline-formula id="IE52"><mml:math id="IEQ52"><mml:mrow><mml:msup><mml:mi>h</mml:mi><mml:mi>p</mml:mi></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> of length <italic>p</italic>, an extension is the addition of the valid base pair <inline-formula id="IE53"><mml:math id="IEQ53"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>+</mml:mo><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>−</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> to form <inline-formula id="IE54"><mml:math id="IEQ54"><mml:mrow><mml:msup><mml:mi>h</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. The dot-parenthesis notations for the set of all structures of <inline-formula id="IE55"><mml:math id="IEQ55"><mml:mrow><mml:msub><mml:mi>ℓ</mml:mi><mml:mi mathvariant="script">N</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> associated with an RNA <italic>w</italic> can be modeled as a context-free language generated by the grammar <inline-formula id="IE56"><mml:math id="IEQ56"><mml:mrow><mml:msub><mml:mi>G</mml:mi><mml:mi>w</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mo>,</mml:mo><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mi>R</mml:mi><mml:mo>,</mml:mo><mml:mi>Y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, where
<list list-type="bullet"><list-item><p><inline-formula id="IE57"><mml:math id="IEQ57"><mml:mrow><mml:mi>N</mml:mi><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:msubsup><mml:mi>A</mml:mi><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>H</mml:mi><mml:mi>j</mml:mi><mml:mi>j</mml:mi></mml:msubsup><mml:mo>;</mml:mo><mml:mo> </mml:mo><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>i</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>j</mml:mi><mml:mo>≤</mml:mo><mml:mi>n</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula> is the set of non-terminal symbols. <inline-formula id="IE58"><mml:math id="IEQ58"><mml:mrow><mml:msubsup><mml:mi>A</mml:mi><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> represents all locally optimal substructures within the interval <inline-formula id="IE59"><mml:math id="IEQ59"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula>, and <inline-formula id="IE60"><mml:math id="IEQ60"><mml:mrow><mml:msubsup><mml:mi>H</mml:mi><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> represents the choice between a helix extension with the base pair (<italic>i</italic>, <italic>j</italic>) or starting a new substructure on the same interval;</p></list-item><list-item><p><inline-formula id="IE61"><mml:math id="IEQ61"><mml:mrow><mml:mi>T</mml:mi><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mo>,</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula> is the set of terminal symbols;</p></list-item><list-item><p><italic>R</italic> is the set of production rules:
<disp-formula id="E3"><label>(P1)</label><mml:math id="EQ3"><mml:mrow><mml:msubsup><mml:mi>H</mml:mi><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:msubsup><mml:mo>→</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mo> </mml:mo><mml:msubsup><mml:mi>H</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo> </mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mtext> if </mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mtext> valid for </mml:mtext><mml:mi>w</mml:mi><mml:mtext> and </mml:mtext><mml:mo> </mml:mo><mml:mi mathvariant="normal">j</mml:mi><mml:mo>-</mml:mo><mml:mi mathvariant="normal">i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>≥</mml:mo><mml:mo>θ</mml:mo></mml:mrow></mml:math></disp-formula><disp-formula id="E4"><label>(P2)</label><mml:math id="EQ4"><mml:mrow><mml:msubsup><mml:mi>H</mml:mi><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:msubsup><mml:mo>→</mml:mo><mml:msubsup><mml:mi>A</mml:mi><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:msubsup></mml:mrow></mml:math></disp-formula><disp-formula id="E5"><label>(P3)</label><mml:math id="EQ5"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:msubsup><mml:mi>A</mml:mi><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:msubsup><mml:mo>→</mml:mo><mml:msup><mml:mo>.</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msup><mml:mtext> </mml:mtext><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∏</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>k</mml:mi><mml:mo>≤</mml:mo><mml:mi>ℓ</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:msup><mml:mrow><mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>α</mml:mi></mml:msup><mml:mtext> </mml:mtext><mml:msubsup><mml:mi>H</mml:mi><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mi>α</mml:mi></mml:mrow></mml:msubsup><mml:mtext> </mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>α</mml:mi></mml:msup><mml:mtext> </mml:mtext><mml:msup><mml:mo>.</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mtext>for each </mml:mtext><mml:msubsup><mml:mo>⊕</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>ℓ</mml:mi></mml:msubsup><mml:msup><mml:mi>h</mml:mi><mml:mi>α</mml:mi></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>∈</mml:mo><mml:msub><mml:mi mathvariant="script">F</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mtext> such that </mml:mtext></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:menclose notation="updiagonalstrike"><mml:mo>=</mml:mo></mml:menclose><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>∨</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:menclose notation="updiagonalstrike"><mml:mo>=</mml:mo></mml:menclose><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mtext> whenever </mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:menclose notation="updiagonalstrike"><mml:mo>=</mml:mo></mml:menclose><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mtext>and where </mml:mtext><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>ℓ</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>j</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula></p></list-item></list>Using classic language notations, <inline-formula id="IE62"><mml:math id="IEQ62"><mml:mstyle displaystyle="true"><mml:mo>∏</mml:mo></mml:mstyle></mml:math></inline-formula> is the concatenation operator and <italic>l<sup>i</sup></italic> denotes <inline-formula id="IE63"><mml:math id="IEQ63"><mml:mrow><mml:mi>i</mml:mi><mml:mo>≥</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> copies of the letter <italic>l</italic>. <inline-formula id="IE64"><mml:math id="IEQ64"><mml:mrow><mml:msubsup><mml:mi>A</mml:mi><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> represents all locally optimal substructures within the interval <inline-formula id="IE65"><mml:math id="IEQ65"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula> (P3), and <inline-formula id="IE66"><mml:math id="IEQ66"><mml:mrow><mml:msubsup><mml:mi>H</mml:mi><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> represents the choice between a helix extension with the base pair (<italic>i</italic>, <italic>j</italic>) (P1), or starting a new substructure on the same interval (P2);
<list list-type="bullet"><list-item><p><inline-formula id="IE67"><mml:math id="IEQ67"><mml:mrow><mml:mi>Y</mml:mi><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:msubsup><mml:mi>A</mml:mi><mml:mn>1</mml:mn><mml:mi>n</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> is the start symbol.</p></list-item></list></p>
        <p>This grammar has <inline-formula id="IE68"><mml:math id="IEQ68"><mml:mrow><mml:mo>Θ</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> non-terminal symbols and <inline-formula id="IE69"><mml:math id="IEQ69"><mml:mrow><mml:mo>Θ</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mi mathvariant="script">F</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> productions. The proof of its completeness with respect to <inline-formula id="IE70"><mml:math id="IEQ70"><mml:mrow><mml:msub><mml:mi>ℓ</mml:mi><mml:mi mathvariant="script">N</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> can be adapted from the proof of Theorem 1 in <xref rid="btx269-B32" ref-type="bibr">Saffarian <italic>et al.</italic> (2012)</xref>.</p>
        <p>The condition <inline-formula id="IE71"><mml:math id="IEQ71"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:menclose notation="updiagonalstrike"><mml:mo>=</mml:mo></mml:menclose><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>∨</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:menclose notation="updiagonalstrike"><mml:mo>=</mml:mo></mml:menclose><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> in P3 ensures that <italic>G<sub>w</sub></italic> is unambiguous, and can be used as a conceptual template to derive other algorithms, <italic>e.g.</italic> to compute the partition function (<xref rid="btx269-B41" ref-type="bibr">Waldispühl and Clote, 2007</xref>) or base-pairing probabilities. Here, we use it on two related applications: exhaustive enumeration of structures and non-redundant statistical sampling of structures. While the former can be obtained in a straightforward fashion, being the language of the grammar, the latter is more involved and is the object of the next section.</p>
      </sec>
    </sec>
    <sec>
      <title>2.3 Non-redundant sampling algorithm</title>
      <p>The large redundancy of stochastic sampling methods has been identified by previous studies as one of the major shortcomings of existing methods. <italic>Ah hoc</italic> heuristics, such as the <italic>ξ</italic>-scheduling technique inspired by simulated annealing, have been introduced to circumvent such limitations, sometimes at the cost of a control over the sampled distribution (<xref rid="btx269-B17" ref-type="bibr">Kucharik <italic>et al.</italic>, 2014</xref>). Here, we propose another approach based on an explicit avoidance of redundancy within the sampling, adapting principles introduced by <xref rid="btx269-B24" ref-type="bibr">Lorenz and Ponty (2013)</xref>.</p>
      <p>For the sake of simplicity, we illustrate those ideas by describing a uniform sampling algorithm for structures of <inline-formula id="IE72"><mml:math id="IEQ72"><mml:mrow><mml:msub><mml:mi>ℓ</mml:mi><mml:mi mathvariant="script">N</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> that are compatible with a given RNA sequence. Starting from the precomputed sets <inline-formula id="IE73"><mml:math id="IEQ73"><mml:mrow><mml:msub><mml:mi mathvariant="script">F</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> of flat structures, the algorithm computes the number of locally optimal structures for each interval <inline-formula id="IE74"><mml:math id="IEQ74"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula> using DP equations. Those equations are isomorphic to the productions of grammar <italic>G<sub>w</sub></italic>.
<disp-formula id="E6"><mml:math id="EQ6"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mi mathvariant="normal">h</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>∑</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mtable><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mi mathvariant="normal">h</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mtext>if</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mtext>is</mml:mtext><mml:mo> </mml:mo><mml:mtext>valid</mml:mtext><mml:mo>;</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mi mathvariant="normal">a</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"/></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mi mathvariant="normal">a</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:munder><mml:mo>∏</mml:mo><mml:mrow><mml:msup><mml:mi>h</mml:mi><mml:mo>α</mml:mo></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>∈</mml:mo><mml:mi>f</mml:mi></mml:mrow></mml:munder><mml:mi mathvariant="normal">h</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mo>α</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mo>α</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mo> </mml:mo><mml:mtext>for</mml:mtext><mml:mo> </mml:mo><mml:mtext>all</mml:mtext><mml:mo> </mml:mo><mml:mi>f</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi mathvariant="script">F</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo> </mml:mo><mml:mtext>and</mml:mtext><mml:mo> </mml:mo><mml:mtext>when</mml:mtext><mml:mo> </mml:mo><mml:mi>j</mml:mi><mml:mo>−</mml:mo><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>≥</mml:mo><mml:mo>θ</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula>
A <bold>stochastic backtrack</bold>, a concept independently introduced in enumerative combinatorics (<xref rid="btx269-B8" ref-type="bibr">Denise <italic>et al.</italic>, 2010</xref>; <xref rid="btx269-B11" ref-type="bibr">Flajolet <italic>et al.</italic>, 1994</xref>) and RNA bioinformatics (<xref rid="btx269-B9" ref-type="bibr">Ding and Lawrence, 2003</xref>), can then be used to generate elements of <inline-formula id="IE75"><mml:math id="IEQ75"><mml:mrow><mml:msub><mml:mi>ℓ</mml:mi><mml:mi mathvariant="script">N</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> uniformly. Such a procedure chooses at every step one of the possible productions of the grammar, with probability proportional to its contribution to the overall number/weights of words. It considers a triplet (<italic>i</italic>, <italic>j</italic>, <italic>m</italic>), where <inline-formula id="IE76"><mml:math id="IEQ76"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula> is the current interval and <italic>m</italic> is the current matrix, initially starting from <inline-formula id="IE77"><mml:math id="IEQ77"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">a</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. At each step, it proceeds as follows, depending on the value of <italic>m</italic>:
<list list-type="bullet"><list-item><p><inline-formula id="IE78"><mml:math id="IEQ78"><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="normal">h</mml:mi></mml:mrow></mml:math></inline-formula>: Choose <inline-formula id="IE79"><mml:math id="IEQ79"><mml:mrow><mml:mi mathvariant="normal">a</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> with probability <inline-formula id="IE80"><mml:math id="IEQ80"><mml:mrow><mml:mi mathvariant="normal">a</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>/</mml:mo><mml:mi mathvariant="normal">h</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> and backtrack over the triplet <inline-formula id="IE81"><mml:math id="IEQ81"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">a</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, otherwise append the base-pair (<italic>i</italic>, <italic>j</italic>) to the output, and backtrack over <inline-formula id="IE82"><mml:math id="IEQ82"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal">h</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>;</p></list-item><list-item><p><inline-formula id="IE83"><mml:math id="IEQ83"><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="normal">a</mml:mi></mml:mrow></mml:math></inline-formula>: Choose a flat structure <inline-formula id="IE84"><mml:math id="IEQ84"><mml:mrow><mml:mi>f</mml:mi><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>h</mml:mi><mml:mo>α</mml:mo></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>ℓ</mml:mo></mml:msubsup><mml:mo>∈</mml:mo><mml:msub><mml:mi mathvariant="script">F</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> with probability 
<disp-formula id="E7"><mml:math id="EQ7"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>f</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:munder><mml:mo>∏</mml:mo><mml:mrow><mml:msup><mml:mi>h</mml:mi><mml:mo>α</mml:mo></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>∈</mml:mo><mml:mi>f</mml:mi></mml:mrow></mml:munder><mml:mi mathvariant="normal">h</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mo>α</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mo>α</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">a</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula></p></list-item></list>append all the helices in the chosen <italic>f</italic> to the output, and backtrack over the triplets <inline-formula id="IE85"><mml:math id="IEQ85"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mo>α</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mo>α</mml:mo><mml:mo>,</mml:mo><mml:mi mathvariant="normal">h</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> (if any).</p>
      <p>Note that the sets <inline-formula id="IE86"><mml:math id="IEQ86"><mml:mrow><mml:msub><mml:mi mathvariant="script">F</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> are explicitly computed, and so are the probabilities <italic>p<sub>f</sub></italic> of choosing any flat structure <italic>f</italic> during the backtrack. It is thus possible to order the flat structures in <inline-formula id="IE87"><mml:math id="IEQ87"><mml:mrow><mml:msub><mml:mi mathvariant="script">F</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> by decreasing probability, leading to a substantial speed-up during the backtrack.</p>
      <sec>
        <title>2.3.1 Non-redundant sampling</title>
        <p>The stochastic backtrack becomes much more involved in the presence of a predefined set of <bold>forbidden structures</bold>, <italic>e.g.</italic> singled out to avoid redundancy, as the probabilities of the backtrack on disjoint intervals can no longer be considered independent.</p>
        <p>As a minimal illustration, consider two intervals <italic>I</italic><sub>1</sub> and <italic>I</italic><sub>2</sub> where local sets of substructures <inline-formula id="IE88"><mml:math id="IEQ88"><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi>S</mml:mi><mml:msub><mml:mo>′</mml:mo><mml:mn>1</mml:mn></mml:msub><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE89"><mml:math id="IEQ89"><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi>S</mml:mi><mml:msub><mml:mo>′</mml:mo><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi>S</mml:mi><mml:mo>′</mml:mo><mml:msub><mml:mo>′</mml:mo><mml:mn>2</mml:mn></mml:msub><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula> can be respectively chosen, leading to the generation of 6 different structures. Clearly, in the absence of forbidden sets, one simply needs to choose uniformly within each set to draw each structure with probability 1/6, i.e. in the uniform distribution. However, if a given combination of structures has to be avoided, say <inline-formula id="IE90"><mml:math id="IEQ90"><mml:mrow><mml:mi>S</mml:mi><mml:msub><mml:mo>′</mml:mo><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>S</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>, then the choice over <italic>I</italic><sub>1</sub> now influences the valid combinations, and thus the probabilities, of choosing a structure over <italic>I</italic><sub>2</sub>. Namely, choosing <inline-formula id="IE91"><mml:math id="IEQ91"><mml:mrow><mml:mi>S</mml:mi><mml:msub><mml:mo>′</mml:mo><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> for <italic>I</italic><sub>1</sub> only allows access to 2 viable alternatives for <italic>I</italic><sub>2</sub>, while choosing <italic>S</italic><sub>1</sub> for <italic>I</italic><sub>1</sub> enables 3 alternatives over <italic>I</italic><sub>2</sub>. In order to be uniform, a stochastic backtrack must therefore choose <italic>S</italic><sub>1</sub> with probability 3/5, and <inline-formula id="IE92"><mml:math id="IEQ92"><mml:mrow><mml:mi>S</mml:mi><mml:msub><mml:mo>′</mml:mo><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> with probability 2/5. Once chosen, the remaining choice is uniform over <inline-formula id="IE93"><mml:math id="IEQ93"><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi>S</mml:mi><mml:msub><mml:mo>′</mml:mo><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi>S</mml:mi><mml:mo>′</mml:mo><mml:msub><mml:mo>′</mml:mo><mml:mn>2</mml:mn></mml:msub><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula> if <italic>S</italic><sub>1</sub> is chosen (prob.<inline-formula id="IE94"><mml:math id="IEQ94"><mml:mrow><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mo>/</mml:mo><mml:mn>5</mml:mn><mml:mo>×</mml:mo><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mn>2</mml:mn><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:math></inline-formula>), or over <inline-formula id="IE95"><mml:math id="IEQ95"><mml:mrow><mml:mo>{</mml:mo><mml:mi>S</mml:mi><mml:msub><mml:mo>′</mml:mo><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi>S</mml:mi><mml:mo>′</mml:mo><mml:msub><mml:mo>′</mml:mo><mml:mn>2</mml:mn></mml:msub><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula> (prob.<inline-formula id="IE96"><mml:math id="IEQ96"><mml:mrow><mml:mo>=</mml:mo><mml:mn>3</mml:mn><mml:mo>/</mml:mo><mml:mn>5</mml:mn><mml:mo>×</mml:mo><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mn>3</mml:mn><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:math></inline-formula>) if <inline-formula id="IE97"><mml:math id="IEQ97"><mml:mrow><mml:mi>S</mml:mi><mml:msub><mml:mo>′</mml:mo><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> is chosen.</p>
        <p>More generally, in order to pick local alternatives in a way that is consistent with a predetermined distribution, one needs to access (or compute) the overall mass of forbidden structures that can be generated before and after the choice. The idea of <xref rid="btx269-B24" ref-type="bibr">Lorenz and Ponty (2013)</xref> consists in maintaining a dedicated data structure <italic>μ</italic>, which enables efficient access to the overall count/weight <inline-formula id="IE98"><mml:math id="IEQ98"><mml:mrow><mml:mo>μ</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> of accessible forbidden structures from the current state f the backtracking stack <italic>T</italic>.</p>
        <p>The modified <bold>non-redundant backtrack</bold> is similar in structure to the classic one, but uses different derivation probabilities, starting from a stack <inline-formula id="IE99"><mml:math id="IEQ99"><mml:mrow><mml:mi>T</mml:mi><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">a</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula>. Let <inline-formula id="IE100"><mml:math id="IEQ100"><mml:mrow><mml:mi>N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:munder><mml:mo>∏</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>∈</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:munder><mml:mi>m</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> denote the overall number/weight of structures accessible from a given state. At each iteration, it extracts a triplet (<italic>i</italic>, <italic>j</italic>, <italic>m</italic>) from <italic>T</italic>:
<list list-type="bullet"><list-item><p>If <inline-formula id="IE101"><mml:math id="IEQ101"><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="normal">h</mml:mi></mml:mrow></mml:math></inline-formula>, choose <inline-formula id="IE102"><mml:math id="IEQ102"><mml:mrow><mml:mi mathvariant="normal">a</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> with probability
<disp-formula id="E8"><mml:math id="EQ8"><mml:mrow><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">a</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>×</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mo>′</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mo>μ</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mo>′</mml:mo><mml:mo>∪</mml:mo><mml:mo>{</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">a</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>}</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mo>μ</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula>
where <inline-formula id="IE103"><mml:math id="IEQ103"><mml:mrow><mml:mi>T</mml:mi><mml:mo>′</mml:mo><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:mi>T</mml:mi><mml:mo>−</mml:mo><mml:mo>{</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>}</mml:mo><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula> and backtrack over <inline-formula id="IE104"><mml:math id="IEQ104"><mml:mrow><mml:mi>T</mml:mi><mml:mo>′</mml:mo><mml:mo>∪</mml:mo><mml:mo>{</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">a</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula>, or otherwise backtrack over <inline-formula id="IE105"><mml:math id="IEQ105"><mml:mrow><mml:mi>T</mml:mi><mml:mo>′</mml:mo><mml:mo>∪</mml:mo><mml:mo>{</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal">h</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula>, after adding (<italic>i</italic>, <italic>j</italic>) to the output;</p></list-item><list-item><p>If <inline-formula id="IE106"><mml:math id="IEQ106"><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="normal">a</mml:mi></mml:mrow></mml:math></inline-formula>, choose a flat structure <inline-formula id="IE107"><mml:math id="IEQ107"><mml:mrow><mml:mi>f</mml:mi><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>h</mml:mi><mml:mo>α</mml:mo></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>ℓ</mml:mo></mml:msubsup><mml:mo>∈</mml:mo><mml:msub><mml:mi mathvariant="script">F</mml:mi><mml:mo>α</mml:mo></mml:msub><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:math></inline-formula> with probability 
<disp-formula id="E9"><mml:math id="EQ9"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>f</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mtable><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mi>k</mml:mi><mml:mo>|</mml:mo></mml:mrow></mml:munderover><mml:mi mathvariant="normal">h</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mo>α</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mo>α</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>×</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mo>′</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo>−</mml:mo><mml:mo>μ</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mo>′</mml:mo><mml:mo>∪</mml:mo><mml:msub><mml:mrow><mml:mo>{</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mo>α</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mo>α</mml:mo><mml:mo>,</mml:mo><mml:mi mathvariant="normal">h</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>}</mml:mo></mml:mrow><mml:mi>l</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mo>μ</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula>
where <inline-formula id="IE108"><mml:math id="IEQ108"><mml:mrow><mml:mi>T</mml:mi><mml:mo>′</mml:mo><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:mi>T</mml:mi><mml:mo>−</mml:mo><mml:mo>{</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>}</mml:mo><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula>, and backtrack over the stack <inline-formula id="IE109"><mml:math id="IEQ109"><mml:mrow><mml:mi>T</mml:mi><mml:mo>′</mml:mo><mml:mo>∪</mml:mo><mml:msub><mml:mrow><mml:mo>{</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mo>α</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mo>α</mml:mo><mml:mo>,</mml:mo><mml:mi mathvariant="normal">h</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>}</mml:mo></mml:mrow><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> after adding the chosen <italic>f</italic> to the output.</p></list-item></list></p>
        <p>In practice, both the data structure <italic>μ</italic> and the <italic>N</italic>(<italic>T</italic>) can be updated <italic>on-the-fly</italic> during the backtrack, so that the non-redundancy retains the same asymptotic complexity as the redundant one.</p>
      </sec>
      <sec>
        <title>2.3.2 Turner energy model and expressive structural restrictions</title>
        <p>The various contributions of the loops in the Turner energy model can easily be identified in the grammar. Namely, stacking pairs are generated by rule (P1), while rule (P2) generates terminal loops (hairpins) when <inline-formula id="IE110"><mml:math id="IEQ110"><mml:mrow><mml:mi>f</mml:mi><mml:mo>=</mml:mo><mml:mo>∅</mml:mo></mml:mrow></mml:math></inline-formula>, internal loops and bulges when <inline-formula id="IE111"><mml:math id="IEQ111"><mml:mrow><mml:mo>|</mml:mo><mml:mi>f</mml:mi><mml:mo>|</mml:mo><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, or multiple loops when <inline-formula id="IE112"><mml:math id="IEQ112"><mml:mrow><mml:mo>|</mml:mo><mml:mi>f</mml:mi><mml:mo>|</mml:mo><mml:mo>&gt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>. Finally, the exterior loop corresponds to <inline-formula id="IE113"><mml:math id="IEQ113"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>.</p>
        <p>This enables the incorporation of Boltzmann weights, based on the Turner energy model as weights in each of the DP equations. The incorporation of such weights during the stochastic (non-redundant) backtrack leads to an algorithm for Boltzmann sampling, whose details and (sketch of) proof of correctness are provided in Supp. Mat. 1.</p>
      </sec>
    </sec>
  </sec>
  <sec>
    <title>3 Materials and Methods</title>
    <p>All experiments were run on a laptop with Intel Core i7 5600 CPU equipped with a quad core at 2.6 GHz with 16 GB of RAM under Ubuntu 16.04 LTS.</p>
    <p>RNANR was implemented in C, and is freely available. It interfaces the RNALib, using the C ++ API provided in the Vienna package (<xref rid="btx269-B22" ref-type="bibr">Lorenz <italic>et al.</italic>, 2011</xref>), to access the individual contributions of the 2004 version of the Turner energy model. The tests were done on a version compiled with gcc using GNU99 standard.</p>
    <p>Gradient walks were performed used the move_gradient function of the ViennaRNA package (<xref rid="btx269-B22" ref-type="bibr">Lorenz <italic>et al.</italic>, 2011</xref>), which performs a gradient descent in the Turner energy landscape and return one of the closest local minima.</p>
    <sec>
      <title>3.1 Datasets</title>
      <p>Three datasets were considered in our validation effort. The <bold>uniform dataset</bold> consists in random, uniformly distributed, RNA sequences of length from 10 to 140 nt increasing by 10 nt, with 50 samples per length.</p>
      <p>In order to assess the characteristics of real RNAs, we also gathered the <bold>RNAStrand dataset</bold>, which consists of the 154 RNA sequences of length between 120 and 170 nt downloaded from RNAStrand database (<xref rid="btx269-B2" ref-type="bibr">Andronescu <italic>et al.</italic>, 2008</xref>), filtering out undefined symbols.</p>
      <p>Finally, since currently available kinetics data is too scarce to allow for a quantitative comparison of tools, we created a dataset of 250 <bold>bistable sequences</bold> of length 100 nt. A bistable RNA sequence presents two stable conformations differing by a sufficient number of base pairs. We generated random uniform sequences of length 100 nt, and retained only those whose most stable LOSS (MFE) had free-energy lower than -30 kcal.mol<sup>–1</sup> according to RNAEval (<xref rid="btx269-B22" ref-type="bibr">Lorenz <italic>et al.</italic>, 2011</xref>). Remaining sequences were then subjected to non-redundant sampling of 1000 LOSSes using RNANR. We finally kept the sequences which, within the sampled set, featured an alternative <bold>metastable</bold> LOSS, differing by <inline-formula id="IE114"><mml:math id="IEQ114"><mml:mo>≥</mml:mo></mml:math></inline-formula>20 base-pairs from the MFE structure, and having free-energy <inline-formula id="IE115"><mml:math id="IEQ115"><mml:mrow><mml:mo>≤</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:math></inline-formula> kcal.mol<sup>–1</sup> higher than the MFE.</p>
    </sec>
    <sec>
      <title>3.2 Program parameters</title>
      <p>Unless noted otherwise, the settings of the different programs used in our comparisons are those described in this section.</p>
      <p>For RNANR, the default mode is that of non-redundant sampling, with 20 samples. The structural restrictions include a minimum helix length <italic>α</italic> = 3, a minimal base pair distance <italic>θ</italic> = 3, a maximal unpaired region length <italic>δ</italic> = 7, and a maximal number of helices in multiloop <italic>β</italic> = 4.</p>
      <p>For RNALocopt the number of returned samples is the same and the temperature was set to 310.15K.</p>
      <p>For RNASLOpt, the suboptimality percentage was set to 100%, meaning that all LOSSes with energy ranging between the MFE and 0 are returned. Since we are interested in LOSSes independently of their stability, we set the barrier_cutoff to an arbitrarily large value of 30 kcal.mol<sup>–1</sup> to speed up the computations by avoiding the computation of the energy barriers. Likewise, the number of top stable LOSSes can be chosen arbitrarily, here its value is set to 3.</p>
      <p>RNALocmin was run using the second version of the built-in <italic>adaptative search</italic> script, referred to as asearch and coded in Python (<xref rid="btx269-B17" ref-type="bibr">Kucharik <italic>et al.</italic>, 2014</xref>). The parameters used are those by default, i.e. 10 000, 10 and 0.1 respectively for the number of samples per iteration, number of iterations and convergence parameter.</p>
    </sec>
    <sec>
      <title>3.3 Theoretical speed-up of non-redundant sampling</title>
      <p>We propose a closed-form formula to quantify the <bold>speed-up</bold> factor induced by non-redundant sampling, i.e. the average number of occurrence of each unique samples. Let us consider a fixed sequence of <italic>i unique</italic> structures, and let <italic>R<sub>i</sub></italic> be the number of structures, generated by a redundant Boltzmann sampling algorithm, before returning a novel <italic>i</italic> + 1-th structure.</p>
      <p>It is easy to show (<xref rid="btx269-B10" ref-type="bibr">du Boisberranger <italic>et al.</italic>, 2012</xref>) that
<disp-formula id="E10"><label>(3)</label><mml:math id="EQ10"><mml:mrow><mml:mi mathvariant="double-struck">E</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>i</mml:mi></mml:munderover><mml:mrow><mml:mfrac><mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mfrac><mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:msup></mml:mrow><mml:mi mathvariant="script">Z</mml:mi></mml:mfrac></mml:mrow></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></disp-formula>
where <italic>E<sub>j</sub></italic> is the energy of <italic>j</italic>-th secondary structure, <italic>k</italic> the Boltzmann constant and <italic>T</italic> the temperature in Kelvin. Since, for a given samples sequence, the <italic>R<sub>j</sub></italic> are independent, then the overall number of generations needed to obtain <italic>k</italic> distinct elements via redundant sampling is given by <inline-formula id="IE116"><mml:math id="IEQ116"><mml:mrow><mml:mi>T</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mi>k</mml:mi></mml:msubsup><mml:mi mathvariant="double-struck">E</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> and the speed-up factor is simply <inline-formula id="IE117"><mml:math id="IEQ117"><mml:mrow><mml:mi>T</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>/</mml:mo><mml:mi>k</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:math></inline-formula></p>
    </sec>
    <sec>
      <title>3.4 Time benchmarking RNANR against its competitors</title>
      <p>We reproduced, and report in <xref ref-type="fig" rid="btx269-F1">Figure 1</xref>, the benchmark of <xref rid="btx269-B17" ref-type="bibr">Kucharik <italic>et al.</italic> (2014)</xref> which compares the rates at which different sampling methods produce unique local minima. It focuses on the SV11 L07337_1 RNA switch, a challenging 115 nt RNA whose landscape is particularly deep and steep. For RNANR, the total number of generated samples was <inline-formula id="IE118"><mml:math id="IEQ118"><mml:mrow><mml:mn>4000</mml:mn></mml:mrow></mml:math></inline-formula>. RNALocmin was run using both first and second versions of asearch for maximum of 30 iterations. For both tools, the sampled structures are not necessary Turner LOSSes, so a gradient walk is performed, and duplicates were removed. The time spent by the gradient walk is added to the generation time in the benchmark. Finally, the total number of samples generated by RNALocopt was set to <inline-formula id="IE119"><mml:math id="IEQ119"><mml:mrow><mml:mn>6</mml:mn><mml:mo> </mml:mo><mml:mn>000</mml:mn><mml:mo> </mml:mo><mml:mn>000</mml:mn></mml:mrow></mml:math></inline-formula>. Other parameters were the same as those specified above.</p>
    </sec>
    <sec>
      <title>3.5 Comparison of folding landscape analysis efficiency</title>
      <p>To compare the quality of sampled sets of structures, we considered an artificial bistable dataset described in Section 3.1, and produced representative sets of structures using the four programs mentioned in Section 3.2. We analyzed sampled sets using a standard kinetic analysis pipeline based on an estimation of energy barriers for each pair of structures, followed by a numerical integration using treekin.</p>
      <p>For each sequence in the bistable dataset, each program was used to generate <inline-formula id="IE120"><mml:math id="IEQ120"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mtext>sam</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> = 50, 75 and 100 samples (output truncated if necessary). Gradient walks were performed to each sample set, and duplicated Turner LOSSes were removed. As a control, we also included the results of RNAsubopt -e, adjusting <inline-formula id="IE121"><mml:math id="IEQ121"><mml:mrow><mml:mo>Δ</mml:mo><mml:mi>E</mml:mi></mml:mrow></mml:math></inline-formula> to return at least <inline-formula id="IE122"><mml:math id="IEQ122"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mtext>sam</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> LOSSes. Next, we estimated the energy barriers using the single path heuristics implemented by the findpath tool (<xref rid="btx269-B14" ref-type="bibr">Flamm <italic>et al.</italic>, 2001</xref>). Due to the high computational cost of this operation, we restricted it to pairs of states having base-pair distance at most <inline-formula id="IE123"><mml:math id="IEQ123"><mml:mrow><mml:mi>b</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mtext>lim</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>. For each sequence, the value of <inline-formula id="IE124"><mml:math id="IEQ124"><mml:mrow><mml:mi>b</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mtext>lim</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> was set in such a way that landscapes sampled by all tools were connected (with the possible exception of RNAsubopt).</p>
      <p>We then used Arrhenius rule to estimate the transition rate <inline-formula id="IE125"><mml:math id="IEQ125"><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>→</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> from a structure <italic>i</italic> to a structure <italic>j</italic> as
<disp-formula id="E11"><mml:math id="EQ11"><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>→</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mfrac><mml:mrow><mml:mo>−</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>→</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:msup><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
where <inline-formula id="IE126"><mml:math id="IEQ126"><mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>→</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is the free energy of the barrier, <italic>E<sub>i</sub></italic> the free-energy of state <italic>i</italic>, <italic>k</italic> the Boltzmann constant and <italic>T</italic> the absolute temperature. The rate between unconnected LOSSes was set to be 0. These rates were used to generate transition matrix. For each sampled set, we identified a minimal free-energy (MFE) and a metastable LOSSes as the most similar structures to the reference ones (see Section 3.1) for the sequence.</p>
      <p>Finally, we considered a scenario where the starting concentration of the metastable structure (or its closest neighbor in the sampled set) is set to 1. We used treekin to determine the evolution of the concentration of all LOSSes in the sampled set. Finally, we report the <bold>switching time</bold>, <italic>i.e.</italic> the time at which the MFE structure eventually achieves higher concentration becomes more frequent than the metastable structure.</p>
    </sec>
  </sec>
  <sec>
    <title>4 Discussion</title>
    <sec>
      <title>4.1 Validating Nussinov LOSSes as key landmarks of kinetic landscapes</title>
      <sec>
        <title>4.1.1 Nussinov LOSSes are less numerous than Turner LOSSes</title>
        <p>We compared the numbers of LOSSes returned by RNANR, RNALocopt and RNASLOpt. For each sequence in the uniform dataset, these sequences were subjected to runs of each software. For RNANR, we performed three runs, each with different value of <italic>γ</italic> (no limit, 4 and 3 respectively). For RNALocopt and RNASLOpt we performed one run for each with parameters as specified in 3.2. The values of each run were then aggregated by the sequence length. The results are shown on <xref ref-type="fig" rid="btx269-F5">Figure 5</xref>.</p>
        <fig id="btx269-F5" orientation="portrait" position="float">
          <label>Fig. 5.</label>
          <caption>
            <p>Comparison of RNANR with RNALocopt and RNASLOpt. (<bold>A</bold>) Number of structures returned by each program and in case of RNANR, for different upper limits of <italic>γ.</italic> (<bold>B</bold>) Number of flat structures returned by RNANR for different values of <italic>γ.</italic> (<bold>C</bold>) Benchmark for different programs, for the same cases as (A)</p>
          </caption>
          <graphic xlink:href="btx269f5"/>
        </fig>
        <p><xref ref-type="fig" rid="btx269-F5">Figure 5A</xref> shows the evolution of number of LOSSes for different programs in function of sequence length. We observe that RNASLOpt returns the smallest number of results. This is consistent with the primary objective of <xref rid="btx269-B20" ref-type="bibr">Li and Zhang (2011)</xref> to reduce the number of structures as a way to reduce the complexity. Besides aggressive structural constraints, RNASLOpt returns only LOSSes that have negative free energy, which is not the case for both RNANR and RNALocopt. On the other hand, RNANR presents a lower number of solutions than RNALocopt. This stems both from the reduction of search space by RNANR due to the structural restrictions, and to our focus on Turner LOSSes, while RNALocopt arguably considers a larger neighborhood (<xref rid="btx269-B23" ref-type="bibr">Lorenz and Clote, 2011</xref>). Our search space reduction, while not as aggressive as that of RNASLOpt, leads to a substantial reduction of the complexity, both theoretically and practically, as shown in <xref ref-type="fig" rid="btx269-F5">Figure 5</xref>.</p>
        <p>Of interesting note is the comparison between the numbers of flat structures returned by RNANR for different values of <italic>γ</italic> (<xref ref-type="fig" rid="btx269-F5">Fig. 5B</xref>). While the number of flat structures noticeably decreases for lower values of <italic>γ</italic>, the number of LOSSes does not seem to be particularly affected (<xref ref-type="fig" rid="btx269-F5">Fig. 5A</xref>). This could be explained by the fact the excluded flat structures participate in few of the complete LOSSes, as substantiated by the fact that, for shorter sequences, the formation of multiloops with high number of branches is improbable. This interpretation is consistent with an analysis of RNAStrand structures (<xref ref-type="fig" rid="btx269-F6">Fig. 6</xref>), which shows that very few (0.1%) RNAs of length under 140 nt features multiloops of degree greater than 4 branches. For shorter sequences, it thus seems reasonable to limit <italic>γ</italic>, which results in lowered time complexity. Naturally, as shown by <xref ref-type="fig" rid="btx269-F6">Figure 6</xref>, this ceases to be the case for longer sequences. While for sequences shorter 300 nt the number of ignored structures for <italic>γ</italic> = 4 is still low (1.92%), for sequences shorter than 400 nt the number of multiloops with at least 5 branches accounts for 15.82% of all structures. Overall, we found that setting <italic>γ</italic> to 5 constitutes a reasonable tradeoff, reducing the computation time while keeping the number of undetected LOSSes reasonable.</p>
        <fig id="btx269-F6" orientation="portrait" position="float">
          <label>Fig. 6.</label>
          <caption>
            <p>Rationale for our restricted search space. Effect of structural limitations on structure counts obtained from RNAStrand database (<xref rid="btx269-B2" ref-type="bibr">Andronescu <italic>et al.</italic>, 2008</xref>). (<bold>A</bold>) Proportion of structures having maximal multi loop branches below a given threshold. A branch number within multi loop is the number of stems sorting from a multiloop and is equal to <italic>γ</italic> + 1. (<bold>B</bold>) Proportion of helices having at least given length</p>
          </caption>
          <graphic xlink:href="btx269f6"/>
        </fig>
      </sec>
      <sec>
        <title>4.1.2 Nussinov LOSSes are very close to turner LOSSes</title>
        <p>We used gradient walks to determine how distant are Nussinov LOSSes, output by RNANR, to their counterpart in the Turner energy model. For each sequence in the RNAStrand dataset, a non-redundant sampling of 1000 distinct structures was performed by RNANR. These structures were then subject to a gradient descent, resulting in a Turner LOSS. We tracked the modifications, both in term of energy and base pairs, induced by the walk. Our results are summarized in <xref rid="btx269-T1" ref-type="table">Table 1</xref>.
<table-wrap id="btx269-T1" orientation="portrait" position="float"><label>Table 1.</label><caption><p>Discrepancy between Nussinov and Turner LOSSes</p></caption><table frame="hsides" rules="groups"><colgroup span="1"><col valign="top" align="left" span="1"/><col valign="top" align="char" char="" span="1"/><col valign="top" align="char" char="" span="1"/><col valign="top" align="char" char="" span="1"/></colgroup><thead align="left"><tr><th rowspan="1" colspan="1"/><th rowspan="1" colspan="1">Samples%</th><th rowspan="1" colspan="1"><inline-formula id="IE127"><mml:math id="IEQ127"><mml:mrow><mml:mo>Δ</mml:mo><mml:mo>Δ</mml:mo><mml:mi>G</mml:mi></mml:mrow></mml:math></inline-formula></th><th rowspan="1" colspan="1">Base pair dist.</th></tr><tr><th rowspan="1" colspan="1"/><th rowspan="1" colspan="1">Avg (SD)</th><th rowspan="1" colspan="1">Avg (SD)</th><th rowspan="1" colspan="1">Avg (SD)</th></tr></thead><tbody><tr><td rowspan="1" colspan="1">Within search space</td><td rowspan="1" colspan="1">59.57% (21.00)</td><td rowspan="1" colspan="1">0.071 (0.309)</td><td rowspan="1" colspan="1">0.129 (0.289)</td></tr><tr><td rowspan="1" colspan="1">Outside search space</td><td rowspan="1" colspan="1">40.42% (21.00)</td><td rowspan="1" colspan="1">1.248 (0.925)</td><td rowspan="1" colspan="1">1.550 (0.619)</td></tr><tr><td rowspan="1" colspan="1">Global average</td><td rowspan="1" colspan="1">100.00% (—)</td><td rowspan="1" colspan="1"><bold>0.547</bold> (0.817)</td><td rowspan="1" colspan="1"><bold>0.703</bold> (0.757)</td></tr></tbody></table><table-wrap-foot><fn id="tblfn1"><p>For our RNAStrand dataset, 1000 Nussinov LOSSes were generated. For each structure, one of the closest Turner LOSS was determined using a gradient descent. On average, a Nussinov LOSS is distant by ≤<inline-formula id="IE128"><mml:math id="IEQ128"><mml:mrow><mml:mn>0.547</mml:mn></mml:mrow></mml:math></inline-formula> kcal.mol<sup>–1</sup>, and by 0.7 base pairs, from its closest Turner LOSS.</p></fn></table-wrap-foot></table-wrap></p>
        <p>Overall, 52.49% of the Nussinov LOSSes were already local minima with respect to the Turner energy model. Moreover, our analysis shows that, from a Nussinov LOSS, it is sufficient to add or remove an average of 0.703 base pairs, contributing an average 0.547 kcal.mol<sup>–1</sup>, to reach a Turner LOSS. A further analysis reveals differing behaviors of whether or not the Turner LOSS, obtained as the outcome of the gradient descent, belongs to the restricted search space.</p>
        <p>Finally, it is worth stressing that the structures obtained after the gradient walk are overwhelmingly unique (99.1%), suggesting a homogenous coverage of the Turner LOSSes by the Nussinov LOSSes. We thus conclude that the structures generated by RNANR can reliably used as representatives for Turner LOSSes within the folding landscape.</p>
      </sec>
    </sec>
    <sec>
      <title>4.2 Efficiency of sampling methods for LOSSes</title>
      <p>A first time benchmark, whose results are given on <xref ref-type="fig" rid="btx269-F5">Figure 5C</xref> was performed on our uniform dataset. We observe that, without limiting <italic>γ</italic>, RNANR is fastest for sequences of length under 80 nt. Around this length, it is briefly matched by RNASLOpt, whose execution time increases spectacularly around 110 nt. RNALocopt is faster than RNASLOpt or RNANR (no limitation on <italic>γ</italic>) for longer sequences (more than 120 nt) due to the polynomial nature of the underlying algorithm. However, for values of <italic>γ</italic> set to 3 or 4, the execution time of RNANR becomes polynomial, and RNANR becomes considerably faster in practice than its competitors. Of course, one needs to exercise caution before setting restrictions that could lead to the omission of important conformations, and it would probably not be wise to set <italic>γ</italic> = 3 for RNAs beyond 80 nt. However, setting <italic>γ</italic> = 4 makes RNANR faster than any other tested software, while only missing a negligible proportion of existing conformations (cf <xref ref-type="fig" rid="btx269-F6">Fig. 6</xref>, for multiloop branch number equal to 6) for sequences beyond 300 nt.</p>
      <p>A second basic time benchmark, described in Section 3.4 and in <xref ref-type="fig" rid="btx269-F1">Figure 1</xref>, measures the rate of production of distinct Turner LOSSes generated using different software. We observe that RNANR returns more unique LOSSes in a given time, even when including the time for precomputations and gradient descents, than both versions of RNALocmin and RNALocopt (note that RNASLOpt does not perform sampling). This is mainly due to the redundancy within the returned samples, as indicated by the diminishing production speeds for both methods. The second version of asearch uses an alternative strategy for <italic>ξ</italic>-scheduling which increases its number of samples linearly between iterations, and seems to eventually perform better than its initial version. However it starts slower, proving that the redundancy is still an issue.</p>
    </sec>
    <sec>
      <title>4.3 Non-redundant sampling allows a deeper exploration of kinetic landscapes</title>
      <p>The main new contribution of RNANR is its non-redundant sampling algorithm, which allows to obtain a set of locally optimal secondary structures, each of whom appears at most once. This method of sampling has its advantages which will be discussed in this and next subsection. The more obvious one, discussed here, is the fact it allows to obtain higher number of different samples faster. Instead of sampling same structures with free energy close to the minimal free-energy over and over, it consecutively picks up the structures with higher energies which were not sampled previously.</p>
      <p>To demonstrate this point, we first computed the value of speed-up <italic>T</italic>(<italic>k</italic>)∕<italic>k</italic> as defined in Section 3.3 on two sequences: a 123 nt 5S ribosomal RNA of <italic>Thermoplasma acidophilum</italic>, and a 154 nt telomerase RNA of Tetrahymena silvana. A non-redundant sampling was performed, until a coverage of 0.99% was achieved, and the evolution of the speed-up was calculated. The results are shown on <xref ref-type="fig" rid="btx269-F7">Figure 7A and B</xref>. The purple dots mark the points with <inline-formula id="IE129"><mml:math id="IEQ129"><mml:mrow><mml:mi>c</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mo>ε</mml:mo></mml:mrow></mml:math></inline-formula> for <inline-formula id="IE130"><mml:math id="IEQ130"><mml:mrow><mml:mo>ε</mml:mo><mml:mo>=</mml:mo><mml:mn>5</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math></inline-formula>, 1% and 0.1% for the final coverage.</p>
      <fig id="btx269-F7" orientation="portrait" position="float">
        <label>Fig. 7.</label>
        <caption>
          <p>Comparison of classical and non-redundant sampling. (<bold>A</bold>) Theoretical speed-up <italic>T</italic>(<italic>k</italic>)∕<italic>k</italic> using non-redundant sampling when compared to redundant sampling for a 5S ribosomal RNA of Thermoplasma acidophilum (123 nt). (<bold>B</bold>) Same test for a telomerase RNA of Tetrahymena silvana (154 nt). Purple points indicate the coverage of <inline-formula id="IE131"><mml:math id="IEQ131"><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mo>ε</mml:mo></mml:mrow></mml:math></inline-formula>, for <inline-formula id="IE132"><mml:math id="IEQ132"><mml:mrow><mml:mo>ε</mml:mo><mml:mo>=</mml:mo><mml:mn>5</mml:mn><mml:mo>%</mml:mo><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math></inline-formula> and 0.1% respectively. (<bold>C</bold>) Number of unique LOSSes and coverage <italic>c</italic> from 1000 samples generated by RNALocopt on our uniform artificial dataset. The number of unique LOSSes, generated using RNANR in order to achieve a coverage <italic>c</italic>, is plotted in (<bold>D</bold>)</p>
        </caption>
        <graphic xlink:href="btx269f7"/>
      </fig>
      <p>The value of <italic>T</italic>(<italic>k</italic>)∕<italic>k</italic> increases with <italic>k</italic>, which is expected since the probability of generating a novel structure decreases with each iteration. The speed-up thus becomes more important for higher values of <italic>c</italic> (or lower values of <inline-formula id="IE133"><mml:math id="IEQ133"><mml:mi mathvariant="normal">ϵ</mml:mi></mml:math></inline-formula>), where the probability of a new unique structure almost vanishes. This means that the structures with higher free energies are considerably easier to generate by non-redundant sampling than by their redundant counterpart, since their initial probability increases along with the sampling. Moreover, different sequences exhibit different evolutions for <italic>c</italic>, as shown on <xref ref-type="fig" rid="btx269-F7">Figure 7A and B</xref>, depending on the concentration of the Boltzmann distribution around a few conformations. This means that higher values of <italic>c</italic> will be more difficult to attain for some sequences than for others, and for these cases the usage of non-redundant sampling might prove more advantageous.</p>
      <p>Our second test consisted in creating the samples using redundant generation, and comparing these results with the non-redundant sampler of RNANR. For this purpose, we used RNALocopt to generate 1000 LOSSes for each sequence of our uniform dataset. For each set of structures, the number of unique samples and the coverage <italic>c</italic> were computed. RNANR was then used to generate a set of structures achieving the same coverage <italic>c</italic>. The averaged number of structures for each length was reported, leading to the values shown in <xref ref-type="fig" rid="btx269-F7">Figure 7C and D</xref>.</p>
      <p>While the number of unique structures returned by RNALocopt increases with the sequence length, the coverage value <italic>c</italic> diminishes. This is caused by the increasing number of local minima for longer sequences, which results in lower Boltzmann probabilities for individual structures. This means that, to attain a given coverage <italic>c</italic>, a sharply increasing number of LOSSes must be generated for longer sequences, leading to a higher number of repeats. <xref ref-type="fig" rid="btx269-F7">Figure 7D</xref> shows that the number of samples necessary to achieve identical <italic>c</italic> by RNANR as the one achieved by RNALocopt is considerably lower. This partially stems from the fact that while RNALocopt encompasses the entirety of Turner LOSSes, RNANR explores a much more drastically reduced search space, and thus requires less samples to achieve a given coverage. On the other hand, this also means that a target coverage is achieved faster while generating most of interesting structures with the correct parameter settings, meaning that RNANR can considerably speed up and simplify the analysis of the folding landscape.</p>
    </sec>
    <sec>
      <title>4.4 Non-redundant sampling of Turner LOSS enables a faster, more accurate analysis of RNA kinetics</title>
      <p>The main interest of non-redundant sampling is, besides its inherent speed-up, its capacity to dig deeper within the space of suboptimal structures when approximating the folding landscape of a given RNA. In this final validation, we tested whether this increased diversity translates into sampled sets of higher quality, leading to more accurate kinetics analysis.</p>
      <p>More specifically, we evaluated the capacity of a simple, <italic>real-life</italic>, analysis pipeline to estimate the switching time of bistable artificial RNAs from samples of small size, generated using RNANR, RNALocmin, RNASLOpt, RNALocopt and RNAsubopt. Details are described in Section 3.5, and the results are summarized by <xref ref-type="fig" rid="btx269-F8">Figure 8</xref>, and illustrated by <xref ref-type="fig" rid="btx269-F9">Figure 9</xref>.</p>
      <p>First, we observe that RNANR detects structures that are similar to both the MFE and metastable LOSSes more consistently than its competitors. This is not overly surprising, since these two structures were initially identified from an independent execution of RNANR (albeit from a much larger sampled set, see Section 3.1). This however means that RNANR generates sets of structures that, while not strictly overlapping, represent the main dominant conformations even for small sampled sets, and may be used for reproducible further analysis. RNALocmin and RNALocopt both suffered from redundancy, and generally failed to identify the two dominant conformation for about <inline-formula id="IE134"><mml:math id="IEQ134"><mml:mrow><mml:mo>∼</mml:mo><mml:mn>80</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math></inline-formula> of the bistable RNAs. RNASLOpt exhibit the same tend, probably due to an aggressive filtering of LOSSes.</p>
      <p>Then we compared the switching time, defined in Section 3.5, as predicted by our pipeline from the different sampled sets. We reasoned that, since both undersampled landscapes and single-path heuristics lead to an overestimation of energy barriers, a good sampled set, by populating important energy basins, would be associated to a fast perceived kinetics, i.e. a fast switching time. On the other hand, a set of scattered, or highly similar, structures would practically disconnect the landscape, leading to slow predicted kinetics. Faster predicted switching times therefore indicate better approximate folding landscapes.</p>
      <p>Our results, summarized in <xref ref-type="fig" rid="btx269-F8">Figure 8</xref>, show that using RNANR leads to the shortest switching time ∼70% of the time, irrespectively of the number of samples. RNASLOpt is a clear second, and dominates other tools with respect to the switching time in about 20% of the sequences. While high computational demands, on both the design and analysis tasks, disallowed us to repeat this on larger bistable sequences, we expect this trend to carry for larger sequences and sets.</p>
      <fig id="btx269-F8" orientation="portrait" position="float">
        <label>Fig. 8.</label>
        <caption>
          <p>Efficiency of analysis performed by existing sampling software on bistable structures. (<bold>A</bold>) Proportion of artificial bistable sequences for which structures close to the reference states are generated. (<bold>B</bold>) Distribution of best-performing software, as assessed by the lowest predicted switch time, for different values of <inline-formula id="IE135"><mml:math id="IEQ135"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mtext>sam</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula></p>
        </caption>
        <graphic xlink:href="btx269f8"/>
      </fig>
      <fig id="btx269-F9" orientation="portrait" position="float">
        <label>Fig. 9.</label>
        <caption>
          <p>Illustration of bistable RNA analysis. Starting from an artificial 100 nt bistable RNA (<bold>A</bold>), metastable (<bold>B</bold>) and MFE (<bold>D</bold>) states are identified, along with key landmarks of the kinetic landscapes, using the non-redundant sampling of RNANR (C, left) and RNASLOpt (<bold>C</bold>, right). Due to the stochastic nature of the landscape reconstruction methods, the metastable structure identified by RNANR has 3 extra base pairs (B, colored in red). Numerical integration of the master equation using Treekin (D) predicts a shorter switching time for RNANR kinetics landscape than its competitors, suggesting a better coverage of important kinetic intermediate structures</p>
        </caption>
        <graphic xlink:href="btx269f9"/>
      </fig>
    </sec>
  </sec>
</body>
<back>
  <ack>
    <title>Acknowledgements</title>
    <p>The authors wish to thank Ronny Lorenz and Gregor Entzian for their invaluable help in interfacing the versatile Vienna RNAlib, and Ivo Hofacker for his feedback and suggestions at an earlier stage of this work.</p>
    <sec>
      <title>Funding</title>
      <p>All authors acknowledge support from the RNALands project, jointly funded by the French <italic>Agence Nationale de la Recherche</italic> (ANR-14-CE34-0011) and the Austrian <italic>Fonds zur Förderung der wissenschaftlichen Forschung</italic> (FWF-I-1804-N28).</p>
      <p><italic>Conflict of Interest</italic>: none declared.</p>
    </sec>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="btx269-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Akutsu</surname><given-names>T.</given-names></name></person-group> (<year>2000</year>) 
<article-title>Dynamic programming algorithms for RNA secondary structure prediction with pseudoknots</article-title>. <source>Discrete Appl. Math</source>., <volume>104</volume>, <fpage>45</fpage>–<lpage>62</lpage>.</mixed-citation>
    </ref>
    <ref id="btx269-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Andronescu</surname><given-names>M.</given-names></name></person-group><etal>et al</etal> (<year>2008</year>) 
<article-title>RNA strand: the RNA secondary structure and statistical analysis database</article-title>. <source>BMC Bioinf</source>., <volume>9</volume>, <fpage>340</fpage>.</mixed-citation>
    </ref>
    <ref id="btx269-B3">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name name-style="western"><surname>Badelt</surname><given-names>S.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) <chapter-title>Chapter eight – thermodynamic and kinetic folding of riboswitches</chapter-title> In: <person-group person-group-type="editor"><name name-style="western"><surname>Chen</surname><given-names>S.-J.</given-names></name>, <name name-style="western"><surname>Burke-Aguero</surname><given-names>D.H.</given-names></name></person-group> (eds.) <source>Computational Methods for Understanding Riboswitches, Volume 553 of Methods in Enzymology</source>. 
<publisher-name>Academic Press</publisher-name>, 
<publisher-loc>Cambridge, MA, USA</publisher-loc>, pp. <fpage>193</fpage>–<lpage>213</lpage>.</mixed-citation>
    </ref>
    <ref id="btx269-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Baumstark</surname><given-names>T.</given-names></name></person-group><etal>et al</etal> (<year>1997</year>) 
<article-title>Viroid processing: switch from cleavage to ligation is driven by a change from a tetraloop to a loop e conformation</article-title>. <source>EMBO J</source>., <volume>16</volume>, <fpage>599</fpage>–<lpage>610</lpage>.<pub-id pub-id-type="pmid">9034342</pub-id></mixed-citation>
    </ref>
    <ref id="btx269-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Cech</surname><given-names>T.R.</given-names></name></person-group> (<year>2015</year>) 
<article-title>RNA world research-still evolving</article-title>. <source>RNA (New York, N.Y.)</source>, <volume>21</volume>, <fpage>474</fpage>–<lpage>475</lpage>.</mixed-citation>
    </ref>
    <ref id="btx269-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Cruz</surname><given-names>J.A.</given-names></name>, <name name-style="western"><surname>Westhof</surname><given-names>E.</given-names></name></person-group> (<year>2011</year>) 
<article-title>Sequence-based identification of 3d structural modules in RNA with rmdetect</article-title>. <source>Nat. Methods</source>, <volume>8</volume>, <fpage>513</fpage>–<lpage>521</lpage>.<pub-id pub-id-type="pmid">21552257</pub-id></mixed-citation>
    </ref>
    <ref id="btx269-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Danilova</surname><given-names>L.V.</given-names></name></person-group><etal>et al</etal> (<year>2006</year>) 
<article-title>RNAkinetics: a web server that models secondary structure kinetics of an elongating RNA</article-title>. <source>J. Bioinf. Comput. Biol</source>., <volume>4</volume>, <fpage>589</fpage>–<lpage>596</lpage>.</mixed-citation>
    </ref>
    <ref id="btx269-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Denise</surname><given-names>A.</given-names></name></person-group><etal>et al</etal> (<year>2010</year>) 
<article-title>Controlled non-uniform random generation of decomposable structures</article-title>. <source>Theoret. Comput. Sci</source>., <volume>411</volume>, <fpage>3527</fpage>–<lpage>3552</lpage>.</mixed-citation>
    </ref>
    <ref id="btx269-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Ding</surname><given-names>Y.</given-names></name>, <name name-style="western"><surname>Lawrence</surname><given-names>E.</given-names></name></person-group> (<year>2003</year>) 
<article-title>A statistical sampling algorithm for RNA secondary structure prediction</article-title>. <source>Nucleic Acids Res</source>., <volume>31</volume>, <fpage>7280</fpage>–<lpage>7301</lpage>.<pub-id pub-id-type="pmid">14654704</pub-id></mixed-citation>
    </ref>
    <ref id="btx269-B10">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><name name-style="western"><surname>du Boisberranger</surname><given-names>J.</given-names></name></person-group><etal>et al</etal> (<year>2012</year>). The weighted words collector. In: <italic>23rd Intern. Meeting on Probabilistic, Combinatorial, and Asymptotic Methods in the Analysis of Algorithms, AofA</italic>, volume AQ of <italic>DMTCS Proceedings</italic>, pp. <fpage>243</fpage>–<lpage>264</lpage>.</mixed-citation>
    </ref>
    <ref id="btx269-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Flajolet</surname><given-names>P.</given-names></name></person-group><etal>et al</etal> (<year>1994</year>) 
<article-title>Calculus for the random generation of labelled combinatorial structures</article-title>. <source>Theoret. Comput. Sci</source>., <volume>132</volume>, <fpage>1</fpage>–<lpage>35</lpage>. A preliminary version is available in INRIA Research Report RR-1830.</mixed-citation>
    </ref>
    <ref id="btx269-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Flamm</surname><given-names>C.</given-names></name>, <name name-style="western"><surname>Hofacker</surname><given-names>I.L.</given-names></name></person-group> (<year>2008</year>) 
<article-title>Beyond energy minimization: approaches to the kinetic folding of RNA</article-title>. <source>Monatshefte Für Chemie Chem. Mon</source>., <volume>139</volume>, <fpage>447</fpage>–<lpage>457</lpage>.</mixed-citation>
    </ref>
    <ref id="btx269-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Flamm</surname><given-names>C.</given-names></name></person-group><etal>et al</etal> (<year>2000</year>) 
<article-title>RNA folding at elementary step resolution</article-title>. <source>RNA (New York, N.Y.)</source>, <volume>6</volume>, <fpage>325</fpage>–<lpage>338</lpage>.</mixed-citation>
    </ref>
    <ref id="btx269-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Flamm</surname><given-names>C.</given-names></name></person-group><etal>et al</etal> (<year>2001</year>) 
<article-title>Design of multistable RNA molecules</article-title>. <source>RNA (New York, N.Y.)</source>, <volume>7</volume>, <fpage>254</fpage>–<lpage>265</lpage>.</mixed-citation>
    </ref>
    <ref id="btx269-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Flamm</surname><given-names>C.</given-names></name></person-group><etal>et al</etal> (<year>2002</year>) 
<article-title>Barrier trees of degenerate landscapes</article-title>. <source>Zeitschrift Für Physikalische Chemie</source>, <volume>216</volume>, <fpage>155</fpage>.</mixed-citation>
    </ref>
    <ref id="btx269-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Isambert</surname><given-names>H.</given-names></name></person-group> (<year>2009</year>) 
<article-title>The jerky and knotty dynamics of RNA</article-title>. <source>Methods (San Diego, Calif.)</source>, <volume>49</volume>, <fpage>189</fpage>–<lpage>196</lpage>.</mixed-citation>
    </ref>
    <ref id="btx269-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Kucharik</surname><given-names>M.</given-names></name></person-group><etal>et al</etal> (<year>2014</year>) 
<article-title>Basin hopping graph: a computational framework to characterize RNA folding landscapes</article-title>. <source>Bioinformatics (Oxford, England)</source>, <volume>30</volume>, <fpage>2009</fpage>–<lpage>2017</lpage>.</mixed-citation>
    </ref>
    <ref id="btx269-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Kushwaha</surname><given-names>M.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>Using RNA as molecular code for programming cellular function</article-title>. <source>ACS Synth. Biol</source>., <volume>5</volume>, <fpage>795</fpage>–<lpage>809</lpage>.<pub-id pub-id-type="pmid">26999422</pub-id></mixed-citation>
    </ref>
    <ref id="btx269-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Li</surname><given-names>H.</given-names></name></person-group><etal>et al</etal> (<year>2011</year>) 
<article-title>Nucleic acid-based nanoengineering: novel structures for biomedical applications</article-title>. <source>Interface Focus</source>, <volume>1</volume>, <fpage>702</fpage>–<lpage>724</lpage>.<pub-id pub-id-type="pmid">23050076</pub-id></mixed-citation>
    </ref>
    <ref id="btx269-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Li</surname><given-names>Y.</given-names></name>, <name name-style="western"><surname>Zhang</surname><given-names>S.</given-names></name></person-group> (<year>2011</year>) 
<article-title>Finding stable local optimal RNA secondary structures</article-title>. <source>Bioinformatics (Oxford, England)</source>, <volume>27</volume>, <fpage>2994</fpage>–<lpage>3001</lpage>.</mixed-citation>
    </ref>
    <ref id="btx269-B21">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name name-style="western"><surname>Lorenz</surname><given-names>R.</given-names></name></person-group><etal>et al</etal> (<year>2009</year>). <chapter-title>2d projections of RNA folding landscapes</chapter-title> In <person-group person-group-type="editor"><name name-style="western"><surname>Grosse</surname><given-names>I.</given-names></name></person-group><etal>et al</etal> (eds.) <source>German Conference on Bioinformatics 2009, Volume 157 of Lecture Notes in Informatics</source>. 
<publisher-name>Gesellschaft f. Informatik</publisher-name>, 
<publisher-loc>Bonn</publisher-loc>, pp. <fpage>11</fpage>–<lpage>20</lpage>.</mixed-citation>
    </ref>
    <ref id="btx269-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Lorenz</surname><given-names>R.</given-names></name></person-group><etal>et al</etal> (<year>2011</year>) 
<article-title>ViennaRNA package 2.0</article-title>. <source>Algorithms Mol. Biol. AMB</source>, <volume>6</volume>, <fpage>26</fpage>.<pub-id pub-id-type="pmid">22115189</pub-id></mixed-citation>
    </ref>
    <ref id="btx269-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Lorenz</surname><given-names>W.A.</given-names></name>, <name name-style="western"><surname>Clote</surname><given-names>P.</given-names></name></person-group> (<year>2011</year>) 
<article-title>Computing the partition function for kinetically trapped RNA secondary structures</article-title>. <source>PLoS One</source>, <volume>6</volume>, <fpage>e16178</fpage>.<pub-id pub-id-type="pmid">21297972</pub-id></mixed-citation>
    </ref>
    <ref id="btx269-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Lorenz</surname><given-names>W.A.</given-names></name>, <name name-style="western"><surname>Ponty</surname><given-names>Y.</given-names></name></person-group> (<year>2013</year>) 
<article-title>Non-redundant random generation algorithms for weighted context-free grammars</article-title>. <source>Theoret. Comput. Sci</source>., <volume>502</volume>, <fpage>177</fpage>–<lpage>194</lpage>.</mixed-citation>
    </ref>
    <ref id="btx269-B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Maňuch</surname><given-names>J.</given-names></name></person-group><etal>et al</etal> (<year>2011</year>) 
<article-title>Np-completeness of the energy barrier problem without pseudoknots and temporary arcs</article-title>. <source>Nat. Comput</source>., <volume>10</volume>, <fpage>391</fpage>–<lpage>405</lpage>.</mixed-citation>
    </ref>
    <ref id="btx269-B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Mathews</surname><given-names>D.H.</given-names></name></person-group> (<year>2004</year>) 
<article-title>Using an RNA secondary structure partition function to determine confidence in base pairs predicted by free energy minimization</article-title>. <source>RNA (New York, N.Y.)</source>, <volume>10</volume>, <fpage>1178</fpage>–<lpage>1190</lpage>.</mixed-citation>
    </ref>
    <ref id="btx269-B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>McCaskill</surname><given-names>J.S.</given-names></name></person-group> (<year>1990</year>) 
<article-title>The equilibrium partition function and base pair binding probabilities for RNA secondary structure</article-title>. <source>Biopolymers</source>, <volume>29</volume>, <fpage>1105</fpage>–<lpage>1119</lpage>.<pub-id pub-id-type="pmid">1695107</pub-id></mixed-citation>
    </ref>
    <ref id="btx269-B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Miao</surname><given-names>Z.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>RNA-puzzles round ii: assessment of RNA structure prediction programs applied to three large RNA structures</article-title>. <source>RNA (New York, N.Y.)</source>, <volume>21</volume>, <fpage>1066</fpage>–<lpage>1084</lpage>.</mixed-citation>
    </ref>
    <ref id="btx269-B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Morgan</surname><given-names>S.R.</given-names></name>, <name name-style="western"><surname>Higgs</surname><given-names>P.G.</given-names></name></person-group> (<year>1998</year>) 
<article-title>Barrier heights between ground states in a model of RNA secondary structure</article-title>. <source>J. Phys. A Math. Gen</source>., <volume>31</volume>, <fpage>3153</fpage>.</mixed-citation>
    </ref>
    <ref id="btx269-B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Nawrocki</surname><given-names>E.P.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>Rfam 12.0: updates to the RNA families database</article-title>. <source>Nucleic Acids Res</source>., <volume>43</volume>, <fpage>D130</fpage>–<lpage>D137</lpage>.<pub-id pub-id-type="pmid">25392425</pub-id></mixed-citation>
    </ref>
    <ref id="btx269-B31">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Nussinov</surname><given-names>R.</given-names></name>, <name name-style="western"><surname>Jacobson</surname><given-names>A.B.</given-names></name></person-group> (<year>1980</year>) 
<article-title>Fast algorithm for predicting the secondary structure of single-stranded RNA</article-title>. <source>Proc. Natl. Acad. Sci. U. S. A</source>., <volume>77</volume>, <fpage>6309</fpage>–<lpage>6313</lpage>.<pub-id pub-id-type="pmid">6161375</pub-id></mixed-citation>
    </ref>
    <ref id="btx269-B32">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Saffarian</surname><given-names>A.</given-names></name></person-group><etal>et al</etal> (<year>2012</year>) 
<article-title>RNA locally optimal secondary structures</article-title>. <source>J. Comput. Biol. J. Comput. Mol. Cell Biol</source>., <volume>19</volume>, <fpage>1120</fpage>–<lpage>1133</lpage>.</mixed-citation>
    </ref>
    <ref id="btx269-B33">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Schultes</surname><given-names>E.A.</given-names></name>, <name name-style="western"><surname>Bartel</surname><given-names>D.P.</given-names></name></person-group> (<year>2000</year>) 
<article-title>One sequence, two ribozymes: implications for the emergence of new ribozyme folds</article-title>. <source>Science (New York, N.Y.)</source>, <volume>289</volume>, <fpage>448</fpage>–<lpage>452</lpage>.</mixed-citation>
    </ref>
    <ref id="btx269-B34">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Senter</surname><given-names>E.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>RNA folding pathways and kinetics using 2d energy landscapes</article-title>. <source>J. Math. Biol</source>., <volume>70</volume>, <fpage>173</fpage>–<lpage>196</lpage>.<pub-id pub-id-type="pmid">24515409</pub-id></mixed-citation>
    </ref>
    <ref id="btx269-B35">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Sharova</surname><given-names>L.V.</given-names></name></person-group><etal>et al</etal> (<year>2009</year>) 
<article-title>Database for mRNA half-life of 19 977 genes obtained by DNA microarray analysis of pluripotent and differentiating mouse embryonic stem cells</article-title>. <source>DNA Res. Int. J. Rapid Publ. Rep. Genes Genomes</source>, <volume>16</volume>, <fpage>45</fpage>–<lpage>58</lpage>.</mixed-citation>
    </ref>
    <ref id="btx269-B36">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name name-style="western"><surname>Sheikh</surname><given-names>S.</given-names></name></person-group><etal>et al</etal> (<year>2012</year>). <chapter-title>Impact of the energy model on the complexity of RNA folding with pseudoknots</chapter-title> In: <person-group person-group-type="editor"><name name-style="western"><surname>Kärkkäinen</surname><given-names>J.</given-names></name>, <name name-style="western"><surname>Stoye</surname><given-names>J.</given-names></name></person-group> (eds.) <source>Combinatorial Pattern Matching, Volume 7354 of Lecture Notes in Computer Science</source>. 
<publisher-name>Springer</publisher-name>, 
<publisher-loc>Berlin, Heidelberg</publisher-loc>, pp. <fpage>321</fpage>–<lpage>333</lpage>.</mixed-citation>
    </ref>
    <ref id="btx269-B37">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Smola</surname><given-names>M.J.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>Selective 2’-hydroxyl acylation analyzed by primer extension and mutational profiling (shape-map) for direct, versatile and accurate RNA structure analysis</article-title>. <source>Nat. Protoc</source>., <volume>10</volume>, <fpage>1643</fpage>–<lpage>1669</lpage>.<pub-id pub-id-type="pmid">26426499</pub-id></mixed-citation>
    </ref>
    <ref id="btx269-B38">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Tinoco</surname><given-names>I.</given-names></name>, <name name-style="western"><surname>Bustamante</surname><given-names>C.</given-names></name></person-group> (<year>1999</year>) 
<article-title>How RNA folds</article-title>. <source>J. Mol. Biol</source>., <volume>293</volume>, <fpage>271</fpage>–<lpage>281</lpage>.<pub-id pub-id-type="pmid">10550208</pub-id></mixed-citation>
    </ref>
    <ref id="btx269-B39">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Turner</surname><given-names>D.H.</given-names></name>, <name name-style="western"><surname>Mathews</surname><given-names>D.H.</given-names></name></person-group> (<year>2010</year>) 
<article-title>Nndb: the nearest neighbor parameter database for predicting stability of nucleic acid secondary structure</article-title>. <source>Nucleic Acids Res</source>., <volume>38</volume>, <fpage>D280</fpage>–<lpage>D282</lpage>.<pub-id pub-id-type="pmid">19880381</pub-id></mixed-citation>
    </ref>
    <ref id="btx269-B40">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Turner</surname><given-names>D.H.</given-names></name></person-group><etal>et al</etal> (<year>1988</year>) 
<article-title>RNA structure prediction</article-title>. <source>Annu. Rev. Biophys. Biophys. Chem</source>., <volume>17</volume>, <fpage>167</fpage>–<lpage>192</lpage>.<pub-id pub-id-type="pmid">2456074</pub-id></mixed-citation>
    </ref>
    <ref id="btx269-B41">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Waldispühl</surname><given-names>J.</given-names></name>, <name name-style="western"><surname>Clote</surname><given-names>P.</given-names></name></person-group> (<year>2007</year>) 
<article-title>Computing the partition function and sampling for saturated secondary structures of RNA, with respect to the turner energy model</article-title>. <source>J. Comput. Biol. J. Comput. Mol. Cell Biol</source>., <volume>14</volume>, <fpage>190</fpage>–<lpage>215</lpage>.</mixed-citation>
    </ref>
    <ref id="btx269-B42">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Watters</surname><given-names>K.E.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>Cotranscriptional folding of a riboswitch at nucleotide resolution</article-title>. <source>Nat. Struct. Mol. Biol</source>., <volume>23</volume>, <fpage>1124</fpage>–<lpage>1131</lpage>.<pub-id pub-id-type="pmid">27798597</pub-id></mixed-citation>
    </ref>
    <ref id="btx269-B43">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Wilkinson</surname><given-names>K.A.</given-names></name></person-group><etal>et al</etal> (<year>2008</year>) 
<article-title>High-throughput shape analysis reveals structures in hiv-1 genomic RNA strongly conserved across distinct biological states</article-title>. <source>PLoS Biol</source>., <volume>6</volume>, <fpage>e96</fpage>.<pub-id pub-id-type="pmid">18447581</pub-id></mixed-citation>
    </ref>
    <ref id="btx269-B44">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Wolfinger</surname><given-names>M.T.</given-names></name></person-group><etal>et al</etal> (<year>2004</year>) 
<article-title>Efficient computation of RNA folding dynamics</article-title>. <source>J. Phys. A Math</source>., <volume>37</volume>,</mixed-citation>
    </ref>
    <ref id="btx269-B45">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Wuchty</surname><given-names>S.</given-names></name></person-group><etal>et al</etal> (<year>1999</year>) 
<article-title>Complete suboptimal folding of RNA and the stability of secondary structures</article-title>. <source>Biopol</source>, <volume>49</volume>, <fpage>145</fpage>–<lpage>164</lpage>.</mixed-citation>
    </ref>
    <ref id="btx269-B46">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Xayaphoummine</surname><given-names>A.</given-names></name></person-group><etal>et al</etal> (<year>2007</year>) 
<article-title>Encoding folding paths of RNA switches</article-title>. <source>Nucleic Acids Res</source>., <volume>35</volume>, <fpage>614</fpage>–<lpage>622</lpage>.<pub-id pub-id-type="pmid">17178750</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
