<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Sensors (Basel)</journal-id>
    <journal-id journal-id-type="iso-abbrev">Sensors (Basel)</journal-id>
    <journal-id journal-id-type="publisher-id">sensors</journal-id>
    <journal-title-group>
      <journal-title>Sensors (Basel, Switzerland)</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1424-8220</issn>
    <publisher>
      <publisher-name>MDPI</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7766988</article-id>
    <article-id pub-id-type="doi">10.3390/s20247302</article-id>
    <article-id pub-id-type="publisher-id">sensors-20-07302</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Platform for Analysis and Labeling of Medical Time Series</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="true">https://orcid.org/0000-0002-3047-9329</contrib-id>
        <name>
          <surname>Fedjajevs</surname>
          <given-names>Andrejs</given-names>
        </name>
        <xref rid="c1-sensors-20-07302" ref-type="corresp">*</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Groenendaal</surname>
          <given-names>Willemijn</given-names>
        </name>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Agell</surname>
          <given-names>Carlos</given-names>
        </name>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Hermeling</surname>
          <given-names>Evelien</given-names>
        </name>
      </contrib>
    </contrib-group>
    <aff id="af1-sensors-20-07302">Stichting Imec the Netherlands, 5656 AE Eindhoven, The Netherlands; <email>willemijn.groenendaal@imec.nl</email> (W.G.); <email>carlos.agell@imec.nl</email> (C.A.); <email>evelien.hermeling@imec.nl</email> (E.H.)</aff>
    <author-notes>
      <corresp id="c1-sensors-20-07302"><label>*</label>Correspondence: <email>andrejs.fedjajevs@imec.nl</email></corresp>
    </author-notes>
    <pub-date pub-type="epub">
      <day>19</day>
      <month>12</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="collection">
      <month>12</month>
      <year>2020</year>
    </pub-date>
    <volume>20</volume>
    <issue>24</issue>
    <elocation-id>7302</elocation-id>
    <history>
      <date date-type="received">
        <day>26</day>
        <month>11</month>
        <year>2020</year>
      </date>
      <date date-type="accepted">
        <day>16</day>
        <month>12</month>
        <year>2020</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2020 by the authors.</copyright-statement>
      <copyright-year>2020</copyright-year>
      <license license-type="open-access">
        <license-p>Licensee MDPI, Basel, Switzerland. This article is an open access article distributed under the terms and conditions of the Creative Commons Attribution (CC BY) license (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>).</license-p>
      </license>
    </permissions>
    <abstract>
      <p>Reliable and diverse labeled reference data are essential for the development of high-quality processing algorithms for medical signals, such as electrocardiogram (ECG) and photoplethysmogram (PPG). Here, we present the Platform for Analysis and Labeling of Medical time Series (PALMS) designed in Python. Its graphical user interface (GUI) facilitates three main types of manual annotations—(1) fiducials, e.g., R-peaks of ECG; (2) events with an adjustable duration, e.g., arrhythmic episodes; and (3) signal quality, e.g., data parts corrupted by motion artifacts. All annotations can be attributed to the same signal simultaneously in an ergonomic and user-friendly manner. Configuration for different data and annotation types is straightforward and flexible in order to use a wide range of data sources and to address many different use cases. Above all, configuration of PALMS allows plugging-in existing algorithms to display outcomes of automated processing, such as automatic R-peak detection, and to manually correct them where needed. This enables fast annotation and can be used to further improve algorithms. The GUI is currently complemented by ECG and PPG algorithms that detect characteristic points with high accuracy. The ECG algorithm reached 99% on the MIT/BIH arrhythmia database. The PPG algorithm was validated on two public databases with an F1-score above 98%. The GUI and optional algorithms result in an advanced software tool that allows the creation of diverse reference sets for existing datasets.</p>
    </abstract>
    <kwd-group>
      <kwd>annotation</kwd>
      <kwd>peak detection</kwd>
      <kwd>photoplethysmography signal</kwd>
      <kwd>QRS detection</kwd>
      <kwd>software tool</kwd>
      <kwd>user interface</kwd>
    </kwd-group>
  </article-meta>
</front>
<body>
  <sec sec-type="intro" id="sec1-sensors-20-07302">
    <title>1. Introduction</title>
    <p>Recent developments in personalized medicine and wearable sensors have resulted in a great increase in time series datasets [<xref rid="B1-sensors-20-07302" ref-type="bibr">1</xref>] being acquired in clinical and ambulatory settings over a variety of applications [<xref rid="B2-sensors-20-07302" ref-type="bibr">2</xref>,<xref rid="B3-sensors-20-07302" ref-type="bibr">3</xref>]. To fully exploit the data, automated feature extraction algorithms are in high demand. Training and validation of these algorithms requires large annotated datasets focusing on various scenarios. To allow fast and accurate annotation of these datasets a software tool is needed that meets the following requirements: it should (1) be flexible for different time series input data from various applications, (2) allow different types of annotation to be used and (3) allow customization to facilitate annotations. </p>
    <p>First, to be able to address a wide range of applications, the tool needs to accept and ensure similar functionality for many different data sources, e.g., respiratory, cardiac, or neurological signals. This implies no restrictions on input signal type, number of channels, and source of signals, as well as no predefined data structure. Such annotation tool should support loading of public, standardized, and unconventional datasets with multiple time-series signals. Related to that, it should be possible to (re)load the output of the tool again in itself as well as in standard programming languages.</p>
    <p>Second, the tool should allow for different types of annotation. Biomedical signals are often annotated for specific event occurrence by their timestamp and/or amplitude, e.g., R-peaks in electrocardiogram (ECG) signal. In addition, signals are frequently annotated for quality evaluations, e.g., to label motion artifacts, or for labeling of fixed duration time segments, e.g., sleep apnea labeling in 30-s intervals. </p>
    <p>Another requirement is the need for a high-quality user experience. Manual labeling requires high concentration and is prone to errors [<xref rid="B4-sensors-20-07302" ref-type="bibr">4</xref>,<xref rid="B5-sensors-20-07302" ref-type="bibr">5</xref>]. Facilitating easy and smooth annotation could reduce the number of errors in the annotations. Therefore, a rapid and easy to operate graphical user interface (GUI) is required. The GUI needs to be able to load heavy datasets with many recordings. Browsing through the datasets should be implemented in an ergonomic manner, including intuitive zooming and scrolling and on-demand plotting of synchronized reference signals.</p>
    <p>Preferably, the software should provide an interface for custom processing of the data. Plug-ins such as filtering or resampling operations allow flexible data explorations when dealing with generic data from various sources. Ultimately, if plug-ins themselves are more advanced algorithms, such as R-peak detection, working with the tool can be faster by enabling automatic labeling with subsequent manual adjustments and corrections. In this case, the GUI should clearly display pre-loaded or pre-detected annotations and provide a way to effectively delete or correct these.</p>
    <p>Currently, several software solutions with manual annotation are available [<xref rid="B6-sensors-20-07302" ref-type="bibr">6</xref>,<xref rid="B7-sensors-20-07302" ref-type="bibr">7</xref>,<xref rid="B8-sensors-20-07302" ref-type="bibr">8</xref>,<xref rid="B9-sensors-20-07302" ref-type="bibr">9</xref>,<xref rid="B10-sensors-20-07302" ref-type="bibr">10</xref>,<xref rid="B11-sensors-20-07302" ref-type="bibr">11</xref>,<xref rid="B12-sensors-20-07302" ref-type="bibr">12</xref>,<xref rid="B13-sensors-20-07302" ref-type="bibr">13</xref>,<xref rid="B14-sensors-20-07302" ref-type="bibr">14</xref>,<xref rid="B15-sensors-20-07302" ref-type="bibr">15</xref>]. However, to the best of the authors’ knowledge none of these tools meet all requirements listed above. An often-encountered limitation is that they only work for one signal type—predominantly, ECG [<xref rid="B6-sensors-20-07302" ref-type="bibr">6</xref>,<xref rid="B7-sensors-20-07302" ref-type="bibr">7</xref>,<xref rid="B8-sensors-20-07302" ref-type="bibr">8</xref>,<xref rid="B9-sensors-20-07302" ref-type="bibr">9</xref>,<xref rid="B10-sensors-20-07302" ref-type="bibr">10</xref>,<xref rid="B11-sensors-20-07302" ref-type="bibr">11</xref>,<xref rid="B12-sensors-20-07302" ref-type="bibr">12</xref>,<xref rid="B13-sensors-20-07302" ref-type="bibr">13</xref>,<xref rid="B14-sensors-20-07302" ref-type="bibr">14</xref>] or respiration [<xref rid="B15-sensors-20-07302" ref-type="bibr">15</xref>]. Furthermore, the list of characteristic points is predefined: a user can annotate a single fiducial (R-peak) [<xref rid="B10-sensors-20-07302" ref-type="bibr">10</xref>,<xref rid="B14-sensors-20-07302" ref-type="bibr">14</xref>] or an extended, but fixed set of points (P, Q, R, S, and T waves) [<xref rid="B12-sensors-20-07302" ref-type="bibr">12</xref>,<xref rid="B13-sensors-20-07302" ref-type="bibr">13</xref>]. </p>
    <p>The focus in both literature and commercially available medical tools and data on the annotation of ECG signals (electrical activity of the heart) is understandable, since ECG is the standard screening method for diagnosis of many cardiovascular conditions and the most often collected data stream related to heart disease. Clinically relevant information is extracted from amplitudes and intervals of fiducial points of ECG waveform (<xref ref-type="fig" rid="sensors-20-07302-f001">Figure 1</xref>) [<xref rid="B16-sensors-20-07302" ref-type="bibr">16</xref>]. Namely, the R-peak located within the QRS complex is of major importance for heart rate (HR) and heart rate variability (HRV) analysis [<xref rid="B17-sensors-20-07302" ref-type="bibr">17</xref>]. As a consequence, many R-peak detection algorithms exist based on different approaches—digital filters, derivatives, and wavelets [<xref rid="B18-sensors-20-07302" ref-type="bibr">18</xref>,<xref rid="B19-sensors-20-07302" ref-type="bibr">19</xref>,<xref rid="B20-sensors-20-07302" ref-type="bibr">20</xref>], as well as, more recently, machine learning and neural networks [<xref rid="B21-sensors-20-07302" ref-type="bibr">21</xref>]. Kohler et al. [<xref rid="B22-sensors-20-07302" ref-type="bibr">22</xref>] published an extensive review of the approaches proposed over the last decades.</p>
    <p>Another often-used physiological time series is the PPG signal, an optical-based method that captures volumetric change of blood vessels over time. PPG beat-to-beat intervals correlate closely to the ECG intervals, as they belong to the same cardiac cycle, therefore, PPG modality is considered an ECG surrogate for HR [<xref rid="B23-sensors-20-07302" ref-type="bibr">23</xref>] and HRV [<xref rid="B24-sensors-20-07302" ref-type="bibr">24</xref>,<xref rid="B25-sensors-20-07302" ref-type="bibr">25</xref>,<xref rid="B26-sensors-20-07302" ref-type="bibr">26</xref>] extraction, but can also provide additional information [<xref rid="B27-sensors-20-07302" ref-type="bibr">27</xref>,<xref rid="B28-sensors-20-07302" ref-type="bibr">28</xref>]. Over the last years, PPG has gained a lot of attraction due to its higher wearability. However, that comes with the cost of new signal processing challenges: the PPG signal is very sensitive to motion. In addition, the morphology of the PPG pulse is very different from that of the ECG (<xref ref-type="fig" rid="sensors-20-07302-f001">Figure 1</xref>), hence, different algorithms are needed for processing of the PPG signal. The pool of mature PPG algorithms is sparser compared to ECG [<xref rid="B29-sensors-20-07302" ref-type="bibr">29</xref>,<xref rid="B30-sensors-20-07302" ref-type="bibr">30</xref>,<xref rid="B31-sensors-20-07302" ref-type="bibr">31</xref>,<xref rid="B32-sensors-20-07302" ref-type="bibr">32</xref>], and this is partially due to lack of proper public benchmarking datasets.</p>
    <p>One of the most important sources of labeled clinical signals is the Physionet platform [<xref rid="B33-sensors-20-07302" ref-type="bibr">33</xref>], which includes dozens of ECG datasets aggregating to millions of ECG beats. The MIT–BIH dataset [<xref rid="B34-sensors-20-07302" ref-type="bibr">34</xref>] is a dataset within the Physionet platform and has become the de-facto standard for QRS detectors validation, because of its versatile set of waveforms with clinically significant arrythmias and annotated R-peaks. Even international medical standards for ECG processing [<xref rid="B35-sensors-20-07302" ref-type="bibr">35</xref>] use the MIT–BIH dataset as a reference.</p>
    <p>In contrast, for many other physiological time series, such a large, annotated reference dataset does not exist. Indeed, public PPG datasets are scarcer, and published algorithms report validation results on in-house recorded small-scale databases with less than 10 subjects [<xref rid="B36-sensors-20-07302" ref-type="bibr">36</xref>].</p>
    <p>The Platform for Analysis and Labeling of Medical time Series (PALMS), a flexible tool that meets the requirements listed above, was made to enable the creation of such benchmarking datasets for algorithm development. In this paper, we present the platform, a fusion of a GUI and signal-processing algorithms, providing means for (optional) automatic detection, display, and manual correction of reference information (annotations) to biomedical time-series data. In the rest of the document, PALMS functionality, GUI, and algorithms are demonstrated on two of the most often used physiological signals: ECG and PPG. The PALMS ECG algorithm is a wavelet-based method for reliable R-peaks identification. The PALMS PPG algorithm is a time-domain fiducial point detector based on the derivative of the PPG. It detects multiple pulse fiducials’ locations per heartbeat, including a maximum peak amplitude, a time of a foot (onset), and an upstroke (<xref ref-type="fig" rid="sensors-20-07302-f001">Figure 1</xref>). In addition to the description of PALMS, this paper presents validation results of the two algorithms and discusses the applicability of the framework.</p>
  </sec>
  <sec id="sec2-sensors-20-07302">
    <title>2. Materials and Methods</title>
    <p>The design and functionality of PALMS including a role-based system is explained below. It describes the role-based control system, the user interface, the configuration process, and the two fiducial point algorithms.</p>
    <p>PALMS has a role-based design that defines the responsibility and functionality of each of the three roles, namely, the developer, the data manager, and the annotator (<xref ref-type="fig" rid="sensors-20-07302-f002">Figure 2</xref>). PALMS developers improve the platform, integrate algorithms, and make the tool available to users. Data managers (advanced users) are responsible for setting up PALMS for annotators by following well-defined steps (i.e., creating a configuration file). Finally, annotators (e.g., clinical specialists) only intend to annotate data and, hence, need to have access to the data, configuration, and PALMS software.</p>
    <sec id="sec2dot1-sensors-20-07302">
      <title>2.1. PALMS User Interface</title>
      <p>The GUI used by annotators was developed in Python 3 using an open-source software project “timeview” [<xref rid="B37-sensors-20-07302" ref-type="bibr">37</xref>] distributed under the MIT license as a backbone for creating the main window style. The main window (<xref ref-type="fig" rid="sensors-20-07302-f003">Figure 3</xref>) is split into three sections: (1) plot area, (2) plot-controls, and (3) the menu bar.</p>
      <p>The plot area, where timeseries data and annotations are visualized, occupies the largest part of the window. There is no limit on how many signals can be shown simultaneously in the plot area. Alternatively, to comfortably observe three or more waveforms, it is possible to split the plot area into several synchronized display panels. In <xref ref-type="fig" rid="sensors-20-07302-f003">Figure 3</xref>, for example, the PPG derivative (blue) and the ECG (red) signals serve as references for the PPG (black).</p>
      <p>The plot-controls area on the right of each display panel contains options for changing the visibility and appearance of the plots. A submenu can be reached by a right mouse click in the controls area and this menu allows to plot additional signals (e.g., derivatives, filtered versions) of any original wave. This feature is helpful when annotating fiducials like PPG upstroke, which are defined by the local maximum of the derivative of the PPG signal. In addition, inter-beat intervals of any fiducial can be added to the plot to instantly see possible false positive or false negative annotation locations, visible by spikes or dips in the heart rate.</p>
      <p>In the menu bar annotators can find tabs with specified set of commands: File—for restarting the tool, switching to the previous or the next record; Track and Panel tabs—for controlling the appearance of corresponding objects; the Navigation commands (alternative to the mouse wheel and keyboard) allow continuous browsing through signals without delays; the tool documentation and the list of shortcuts is accessible under the Help tab; and primary functionality controls are located in the Annotation menu: (1) Save and Load action buttons export all workspace data to the hard drive and load the data for (re)editing, and (2) mode selection dialog switches the tool into one of three modes—annotation, partition, or epoch mode. </p>
      <p>The default annotation mode is used to register instantaneous events, which have no duration. It is well suited for labeling several fiducials (R-peak, T-wave, etc.). By adding an additional label close to the regular annotations one can indicate the fiducial’s specific property or type, e.g., R-peak of an ectopic, irregular beat (see also the partition mode for the same purpose). In <xref ref-type="fig" rid="sensors-20-07302-f003">Figure 3</xref>, three fiducials (square markers) are annotated simultaneously for a single PPG signal: foot (black), upstroke (green), and peak (red). The mouse is used as the main control unit with left and right buttons configured to place a new or to delete a label, respectively. To distinguish between label types, preset keyboard keys should be pressed before the click. Annotation settings can be initialized in the database configuration file (see B. PALMS Configuration), but are accessible from the GUI too. PALMS implements several features to streamline the process of labeling, such as a user-defined minimum distance between two labels and/or automatic pinning of an event timestamp to the nearest peak or valley regardless of the exact position the annotator has clicked.</p>
      <p>Contrary to the annotation mode where events belong to a single timestamp, the partition mode is designed to register events with a certain duration, like, e.g., artefacts, interventions, or other segments of explicit interest. In this case, each partition possesses a start and end timestamp and a name—all defined at runtime. Partitions may have arbitrary names and durations. After switching the mode, mouse clicks also change their functionality to create, delete, or move partitions. An example of multi-partition annotation is shown in <xref ref-type="fig" rid="sensors-20-07302-f004">Figure 4</xref>. </p>
      <p>The main goal of the epoch mode in PALMS is to facilitate quality annotation. Such datasets are rare and can form a valuable training or validation set for creating signal quality indicators or artefact detectors. <xref ref-type="fig" rid="sensors-20-07302-f005">Figure 5</xref> visualizes a PPG signal of which 10 s chunks can be binned into three quality levels—low (blue), acceptable (green), and high (red). Quality labels and the epoch length can be adjusted in configuration. The labeling is done using the keyboard left/right arrows for navigation and up/down for assigning the level. The epoch mode can also be used for event annotation in applications such as electroencephalography (EEG), where conventionally each 30-s epoch is labelled depending on the neural responses present in the signal.</p>
    </sec>
    <sec id="sec2dot2-sensors-20-07302">
      <title>2.2. PALMS Configuration</title>
      <p>Prior to labeling a dataset, a configuration file should be created in which a new instance of the Database class is described. The configuration file is made by the data-manager. It encapsulates information about the source and the operations. The class contains several methods (get data, set annotations, save, and load) and fields describing dataset attributes such as source and output folders or filename template. Most of the fields in the Database class have default values, and a number of built-in automatic tests guide data managers through the configuration procedure.</p>
      <p>The method get data is triggered when an annotator starts the GUI and selects a recording from a database in a pop-up window. For every new dataset, this method needs to be defined by the data manager as it is the only one without a default (inherited) implementation. Inside get data, the data structure of the corresponding database is “explained” and arbitrary preprocessing steps, e.g., filtering, can be introduced. Execution of get data results in all relevant time-series signals being packaged into Track objects (see C. PALMS Architecture).</p>
      <p>Next, set annotations is executed in the background. Its implementation can be left blank, alternatively, via this method it is possible to add prior knowledge about annotations to avoid labeling from scratch. For example, as implemented in the current version of PALMS, we integrated ECG and PPG fiducial detectors within the annotation tool. Those algorithms are then run by set annotations on matching signals, which then stores outputs in corresponding Annotation class instances. Alternatively, it can contain interface code to load existing annotation files (e.g., Physionet standard) and bind them to raw data. Such code would be reusable for any database of that kind.</p>
      <p>After these automated procedures, the user can browse through time-series data and manually create (edit) annotations. Using default save and load methods, the workspace can be stored (in HDF5 format [<xref rid="B38-sensors-20-07302" ref-type="bibr">38</xref>]) or loaded for reediting at any moment. PALMS is provided together with Python and MATLAB scripts for opening of output. h5 files.</p>
      <p>The overhead from configuration procedure is limited as it has to be done once per dataset and the file can be reused by all annotators, whereas customizable configuration removes restrictions on input data format and underlying preprocessing steps, and thereby creates the flexibility required to use PALMS for a variety of applications.</p>
    </sec>
    <sec id="sec2dot3-sensors-20-07302">
      <title>2.3. PALMS Architecture</title>
      <p>The software was designed in Python using object-oriented style with three top-level classes—Database, Track, and Annotation. Annotation objects store information about fiducials, partitions, and epochs belonging to one of the signals (Tracks). User interaction with annotations is implicit: corresponding objects are updated as soon as user makes changes in the data via the GUI. Each Track object represents a signal in the dataset in terms of sampling rate, amplitude values, time offset, etc. Annotators can control which tracks are displayed and infer new tracks (e.g., time derivative) from existing ones. All tracks together form a Database object, which is an interface between PALMS and arbitrary annotation project. Each Database is described by dataset managers using configuration file templates. The PALMS source code remains independent from configuration and does not have to be changed. Moreover, developers can create a portable executable version of PALMS and distribute it among annotators, which allows them to use PALMS without having to change or even access the source code. Python environment installation is also not required: users need to run the stand-alone PALMS executable placed in the same folder as configuration files.</p>
    </sec>
    <sec id="sec2dot4-sensors-20-07302">
      <title>2.4. PALMS ECG Fiducial Detector</title>
      <p>The QRS complex is the most prominent part in the ECG waveform and is exploited in heartbeat detection algorithms [<xref rid="B22-sensors-20-07302" ref-type="bibr">22</xref>]. The block-diagram of the R-peak detection algorithm incorporated into PALMS is shown in <xref ref-type="fig" rid="sensors-20-07302-f006">Figure 6</xref>. The detection process is split into two stages—peak enhancement and peak detection—each with several sub-steps. All operations are done sequentially on the ECG blocks of 0.5 s duration. A special state variable maintains information transfer from the previous block to the next in order to detect heartbeats split between two or three blocks. This significantly reduces the required buffer size and removes the need for processing with overlapping segments.</p>
      <p>The algorithm employs a similar approach as Romero et al. [<xref rid="B39-sensors-20-07302" ref-type="bibr">39</xref>], with several modifications. After R-peak enhancement by the discretized continuous wavelet transformation (CWT) and applying the modulus maxima operation (<xref ref-type="fig" rid="sensors-20-07302-f007">Figure 7</xref>), the signal Y is compared to the threshold. In contrast to Romero et al. where a universal preset threshold of 30% of the maximum value was used, PALMS ECG recalculates the threshold for each signal block value (blue block in <xref ref-type="fig" rid="sensors-20-07302-f006">Figure 6</xref>) based on the weighted sum of the noise and signal level. The noise level is calculated as the running average of the standard deviation (STD) of each data block. This prevents false detections in the presence of noise. The signal level is calculated by a quasi-peak detector (QPD), a 1st order IIR filter with a bandwidth that reacts to the difference of the current and the previous samples. Noise level and QPD output are summed and scaled to form the threshold value. Scaling is done to balance between detecting true early peaks (premature beats or atrial fibrillation) and misdetecting high amplitude T-waves. </p>
      <p>Another adjustment to Romero et al. concerns precise R-peak location being now refined by quadratic interpolation method—fitting a second-order polynomial across the detected maximum and two adjacent samples. An exact R-peak location is calculated to allow intra-sample precision at the maximum of the fitted curve.</p>
    </sec>
    <sec id="sec2dot5-sensors-20-07302">
      <title>2.5. PALMS PPG Fiducial Detector</title>
      <p>PPG fiducial detection algorithm included into PALMS is based on the first derivative with the idea being similar to Li et al. [<xref rid="B40-sensors-20-07302" ref-type="bibr">40</xref>]. Authors focused on arterial blood pressure (ABP) signals to detect systolic peak, onset (foot), and dicrotic notch (DN) locations. PALMS PPG benefits from the fact that ABP signals are morphologically analogous to PPG, but extra decision logic is introduced to detect more fiducials: the upstroke, secondary peak (SP), and shoulder (SH).</p>
      <p>In a nutshell, the proposed algorithm uses the upstroke detection as starting operation, which is split into preprocessing and beat detection stages followed by an additional block responsible for derivation of other fiducials as is shown in the block-diagram at <xref ref-type="fig" rid="sensors-20-07302-f008">Figure 8</xref>. At the first step, data are band-pass filtered by a combination of a low pass filter (LPF) with the default cut-off at 10 Hz and a differentiator. The latter outputs a differentiated (dLPF) signal that is used in the beat detection stage, at which fiducials’ locations (and, subsequently, amplitudes) are estimated.</p>
      <p>The main fiducial point to be extracted is the upstroke being the local maximum of the dLPF. As the polarity of the upstroke is always positive, we apply a zero-clamp block to force all negative values to zero. The output of the operation is abs_dLPFS, further used in the custom peak finding function. The function implements a state machine with adaptive amplitude threshold and previous state preservation analog to the procedures used in the ECG beat detector.</p>
      <p>If the upstroke location was found, other fiducials are estimated as indicated in <xref ref-type="fig" rid="sensors-20-07302-f009">Figure 9</xref>. Foot and systolic peak are defined as the last zero-crossing before and first downwards oriented zero-crossing after the upstroke, respectively. Only if upstroke, systolic peak, and foot are found, the beat is valid and the algorithm proceeds with finding secondary fiducials: SH, SP, and DN. It checks for a shoulder presence as the first trough in derivative between the upstroke and the peak. For SP and DN, a search time and amplitude windows are defined as proportions of foot-to-peak rise-time and amplitude change. Both SP and DN are present if additional abs dLPFS zero-crossings are discovered within the time limits given as parameters. If some fiducials are not found, their values are set to not-a-number. Using fiducials’ timestamps, multiple features are calculated inside the algorithm: rise and decay times, amplitudes, and their ratios.</p>
    </sec>
    <sec id="sec2dot6-sensors-20-07302">
      <title>2.6. Algorithms’ Validation</title>
      <p>The value of fiducial point detectors within PALMS depends on the accuracy of the algorithms, therefore, both algorithms were validated using public annotated datasets and in-house labeling done by the authors.</p>
      <p>During development, the optimal set of parameters was defined using multiple databases with more than two million beats in total. In addition to several publicly available datasets (the MIT-BIH and the European ST-T Database), we also used in-house ECG data from healthy volunteers doing different activities, and datasets collected at Ziekenhuis Oost-Limburg (Genk, Belgium) from patients included in a rehabilitation program and patients admitted to a sleep clinic, and datasets collected at Maastricht University (Maastricht, the Netherlands) from healthy population during daily activities [<xref rid="B41-sensors-20-07302" ref-type="bibr">41</xref>,<xref rid="B42-sensors-20-07302" ref-type="bibr">42</xref>,<xref rid="B43-sensors-20-07302" ref-type="bibr">43</xref>]. To include underrepresented morphologies, we simulated examples of ECG with varying QRS width, QT intervals, and HR using the ECGSYN [<xref rid="B33-sensors-20-07302" ref-type="bibr">33</xref>] software package.</p>
      <p>The ECG algorithm was tested on the full MIT–BIH database (48 half-hour recordings with a total number of 109,494 beats). All estimated beats were binned into true positives (TP), false positives, and false negatives. To assess TP, the value of error tolerance τ needs to be defined, i.e., the maximum allowed time between the true (annotated) R-peak and the detected R-peak by the PALMS ECG fiducial detector. The value of the error tolerance is a major determinant of the F1 score and the error rate. In many publications, the value τ is not reported. Therefore, we used two: 50 ms and 125 ms [<xref rid="B19-sensors-20-07302" ref-type="bibr">19</xref>]. The reasoning is that 50 ms is about half of the normal QRS complex width, and 125 ms—corresponds to the half of the highest physiological HR of 240 bpm. Because the number of true negatives cannot be defined, performance was quantified by the F1 score [<xref rid="B44-sensors-20-07302" ref-type="bibr">44</xref>] and error rate as the ratio of false detections and TP.</p>
      <p>We evaluated the performance of PALMS PPG on two publicly available databases (BIDMC PPG and respiration dataset [<xref rid="B45-sensors-20-07302" ref-type="bibr">45</xref>] and IEEE TBME respiratory benchmark dataset [<xref rid="B15-sensors-20-07302" ref-type="bibr">15</xref>]). Datasets contained 53 and 42 8-min recordings, respectively. Assuming PPG waveshape uniformity within each recording and diversity between recordings, we extracted one 30-s segment from each recording. Then foot, upstroke, and peak of every PPG beat was labeled from scratch taking into account that the reference ECG signal labeling was done by one annotator with experience in biomedical engineering and PPG annotations. For quantifying performance, we used an approach similar to ECG with τ = 50 ms.</p>
    </sec>
    <sec id="sec2dot7-sensors-20-07302">
      <title>2.7. Dataset Labeling Example</title>
      <p>To illustrate the potential benefit of using PALMS, we evaluated the annotation of a dataset from the Physionet Computing in Cardiology Challenge 2011 [<xref rid="B33-sensors-20-07302" ref-type="bibr">33</xref>] with quality annotations (see <xref ref-type="fig" rid="sensors-20-07302-f005">Figure 5</xref>). Originally the dataset was annotated with two quality levels. For more advanced algorithm development, the data was reannotated with 5 different labels (<xref rid="sensors-20-07302-t001" ref-type="table">Table 1</xref>) resulting from two-fold evaluation: each ECG trace of 10 s could get Q0 (low), Q1 (acceptable), or Q2 (high) for quality score, and M0 (low) or M1 (high) for morphology score with definitions as in <xref rid="sensors-20-07302-t002" ref-type="table">Table 2</xref>. Recordings were annotated by four experts, and each recording was labeled by at least three experts. In case of disagreement among them, recordings were first reviewed by the fourth reviewer and then, if no 3-to-1 majority reached, by the whole group of annotators together to assign a definite label.</p>
      <p>PALMS configuration and annotation rules for this task are available as one of the examples together with the source code. The task can be repeated after downloading the Physionet dataset to a local folder.</p>
    </sec>
  </sec>
  <sec sec-type="results" id="sec3-sensors-20-07302">
    <title>3. Results</title>
    <p>In this work, we presented PALMS—a novel software solution for annotating time-series data. <xref ref-type="fig" rid="sensors-20-07302-f003">Figure 3</xref>, <xref ref-type="fig" rid="sensors-20-07302-f004">Figure 4</xref> and <xref ref-type="fig" rid="sensors-20-07302-f005">Figure 5</xref> show the visual appearance of PALMS GUI. It is built in open-source Python, can be packaged into one file, and distributed without any additional software and the source code, which makes primary functionality (annotation) available even to non-technical users. At the same time, a well-designed configuration procedure allows PALMS to work with various formats and data sources, thus the annotation capabilities are not restricted to a particular signal type. Furthermore, annotations themselves can be of three types: zero-duration fiducials (timestamp and amplitude information), time events in which the start and end time are annotated (partitions), and epoch that allows scoring of signal quality or other features for a prescribed time window. Multiple fiducials can be simultaneously annotated in the same signal, e.g., it is possible to mark locations of R-peaks and T-waves of the ECG or systolic and diastolic peaks of the PPG at the same time. </p>
    <p>To further assist human annotators, PALMS provides a semi-automatic labeling option: advanced users (developers) of the platform can integrate custom algorithms with minimum effort. Currently, the platform contains fiducial detectors for both ECG and PPG signals to promote faster processing of physiological data. PALMS ECG isolated validation showed an F1 score of 99% for τ = 50 ms and 99.5% for τ = 125 ms, the error rate of 2% and 1% correspondingly. Visual inspection reveals that algorithmic errors are often related to abnormal and ectopic beats. PPG algorithm validation results for each fiducial and database shown separately in <xref rid="sensors-20-07302-t003" ref-type="table">Table 3</xref>.</p>
    <p>In addition, we provided a demonstration of PALMS by adding a set of new labels for signal quality with custom rules to enhance an existing public dataset. New annotators found the tool intuitive to work with and enabling fast and accurate annotation. In particular, labeling of about 40% of ECG segments from the Physionet 2011 Challenge took less than 5 s per segment. It can be said that PALMS operational delays due to data loading, visualization, and saving of results are negligible to the time experts need to observe the data and make a decision.</p>
  </sec>
  <sec sec-type="discussion" id="sec4-sensors-20-07302">
    <title>4. Discussion</title>
    <p>The performance of PALMS was evaluated in several ways. Isolated PALMS ECG performance is high and similar to other ECG fiducial point detector in literature. The well-known Pan et al. algorithm [<xref rid="B46-sensors-20-07302" ref-type="bibr">46</xref>] reported an error rate of 0.7%, although higher than PALMS ECG on specific recordings. The Li et al. [<xref rid="B47-sensors-20-07302" ref-type="bibr">47</xref>] algorithm resolved the same database with 99.9% sensitivity and predictive value of 99.94%, but high accuracy is partially achieved by introducing a post-processing step, during which redundant detections are discarded. The Romero et al. [<xref rid="B39-sensors-20-07302" ref-type="bibr">39</xref>] algorithm is similar in design and reported results in sensitivity and predictivity above 99.6%. Since not all studies used a full version of the MIT–BIH and few reported detection error tolerance value, direct comparison is not always valid.</p>
    <p>Future development should further investigate PALMS ECG performance for abnormal beats to tell if any particular abnormalities (large T-wave, broad QRS, irregular HR, or else) cause systematic misdetection. Automatic parameter optimization would allow to deal with some abnormalities on case-by-case basis.</p>
    <p>The performance of PALMS PPG cannot be compared to other algorithms because they make use of different datasets. Luo et al. [<xref rid="B32-sensors-20-07302" ref-type="bibr">32</xref>] presented a beat onset and peak detection framework based on prior estimation of baseline and the power spectrum, which scored 99% accuracy on 100 short PPG segments. Tran et al. [<xref rid="B48-sensors-20-07302" ref-type="bibr">48</xref>] proposed a combination of an adaptive peak detection threshold and the “random error method” and reported a failed detection rate of 1.1%. Our validation shows slight variation in scores between foot, peak, and upstroke with minor advantage of the latter. This may come from the fact that PPG extremums are more prone to noise than steep rising edge, where the upstroke is located. This implies upstroke is potentially a better choice for PPG beat detection if millisecond-level precision is important.</p>
    <p>PALMS PPG was validated on two datasets acquired in rest conditions. Although, high performance was reached, such validation does not cover some applications, e.g., HR tracking during sports. A post-processing block to revise detected points once full information is available also could improve the performance.</p>
    <p>The current version of PALMS already has large flexibility and conforms to the requirements stated in the beginning, but further developments could even widen its applicability. Future updates may bring functionality to annotate multiple signals at once, e.g., for multi-channel ExG signals. Another useful features may be an automatic comparison and merging of several annotation files done by different experts. To promote PALMS usage with more novel datasets, it should be accompanied with corresponding algorithms. For instance, motion- (accelerometer) or respiration-related algorithms would be easy to build into PALMS as black boxes. They would provide a good initial guess for annotations, which, after manual corrections, could be used to develop improved algorithms’ versions. </p>
  </sec>
  <sec sec-type="conclusions" id="sec5-sensors-20-07302">
    <title>5. Conclusions</title>
    <p>PALMS is a Python-based GUI for rapid annotation of biomedical time-series datasets. The main advantage of the platform is the ability to integrate annotation algorithms and its high level of customization. Its role-based design allows discrimination between clinical annotators (ignorant of the underlying object-oriented design), data-managers (can configure PALMS for a specific database and application), and developers who can use this tool to develop and improve their algorithms. Annotators can assign labels of three types (fiducials, events, and signal quality) simultaneously to one signal. Beyond the two cardiovascular signals, ECG and PPG, analyzed in this paper, PALMS accepts other types of data from different sources, e.g., bio-impedance signals for respiratory monitoring, ExG from brain or muscles, accelerometer from gait, and more. However, the potential benefit of PALMS is not limited to the biomedical domain, it could be applied in any field where domain expert knowledge is required for classification and labeling of time series data. To the best of our knowledge, none of the existing software solutions provide comparable functionality. </p>
    <p>PALMS GUI is available free of charge under the GNU General Public License (GNU GPLv3+) license and can be downloaded from <uri xlink:href="https://github.com/PALMS-gui/PALMS">https://github.com/PALMS-gui/PALMS</uri>. Demo videos are available at <uri xlink:href="https://vimeo.com/user129053181">https://vimeo.com/user129053181</uri>.</p>
  </sec>
</body>
<back>
  <ack>
    <title>Acknowledgments</title>
    <p>We would like to thank Ziekenhuis Oost Limburg and Maastricht University for providing datasets. </p>
  </ack>
  <fn-group>
    <fn>
      <p><bold>Publisher’s Note:</bold> MDPI stays neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <notes>
    <title>Author Contributions</title>
    <p>Conceptualization, A.F., W.G., and E.H.; data curation, A.F. and W.G.; methodology, A.F., W.G., and E.H.; software, A.F.; supervision, C.A.; validation, E.H. and W.G.; visualization, A.F.; writing—original draft, A.F.; writing—review and editing, W.G., C.A., and E.H. All authors have read and agreed to the published version of the manuscript.</p>
  </notes>
  <notes>
    <title>Funding</title>
    <p>This research was funded by ITEA INNO4HEALTH 19008 project.</p>
  </notes>
  <notes notes-type="COI-statement">
    <title>Conflicts of Interest</title>
    <p>The authors declare no conflict of interest. The funders had no role in the design of the study; in the collection, analyses, or interpretation of data; in the writing of the manuscript, or in the decision to publish the results.</p>
  </notes>
  <notes>
    <title>Ethical Statement</title>
    <p>All subjects gave their informed consent for inclusion before they participated in the study. The study was conducted in accordance with the Declaration of Helsinki, and the protocol was approved by the Ethics Committees of corresponding institutions.</p>
  </notes>
  <ref-list>
    <title>References</title>
    <ref id="B1-sensors-20-07302">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Smets</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Velazquez</surname>
            <given-names>E.R.</given-names>
          </name>
          <name>
            <surname>Schiavone</surname>
            <given-names>G.</given-names>
          </name>
          <name>
            <surname>Chakroun</surname>
            <given-names>I.</given-names>
          </name>
          <name>
            <surname>D’Hondt</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>de Raedt</surname>
            <given-names>W.</given-names>
          </name>
          <name>
            <surname>Cornelis</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Janssens</surname>
            <given-names>O.</given-names>
          </name>
          <name>
            <surname>van Hoecke</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Claes</surname>
            <given-names>S.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Large-scale wearable data reveal digital phenotypes for daily-life stress detection</article-title>
        <source>Npj Digit. Med.</source>
        <year>2018</year>
        <volume>1</volume>
        <fpage>1</fpage>
        <lpage>10</lpage>
        <pub-id pub-id-type="doi">10.1038/s41746-018-0074-9</pub-id>
        <?supplied-pmid 31304344?>
        <pub-id pub-id-type="pmid">31304287</pub-id>
      </element-citation>
    </ref>
    <ref id="B2-sensors-20-07302">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Koydemir</surname>
            <given-names>H.C.</given-names>
          </name>
          <name>
            <surname>Ozcan</surname>
            <given-names>A.</given-names>
          </name>
        </person-group>
        <article-title>Wearable and Implantable Sensors for Biomedical Applications</article-title>
        <source>Annu. Rev. Anal. Chem.</source>
        <year>2018</year>
        <volume>11</volume>
        <fpage>127</fpage>
        <lpage>146</lpage>
        <pub-id pub-id-type="doi">10.1146/annurev-anchem-061417-125956</pub-id>
        <?supplied-pmid 29490190?>
        <pub-id pub-id-type="pmid">29490190</pub-id>
      </element-citation>
    </ref>
    <ref id="B3-sensors-20-07302">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ponmozhi</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Frias</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Marques</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Frazão</surname>
            <given-names>O.</given-names>
          </name>
        </person-group>
        <article-title>Smart sensors/actuators for biomedical applications: Review</article-title>
        <source>Measurement</source>
        <year>2012</year>
        <volume>45</volume>
        <fpage>1675</fpage>
        <lpage>1688</lpage>
        <pub-id pub-id-type="doi">10.1016/j.measurement.2012.02.006</pub-id>
      </element-citation>
    </ref>
    <ref id="B4-sensors-20-07302">
      <label>4.</label>
      <element-citation publication-type="confproc">
        <person-group person-group-type="author">
          <name>
            <surname>Schaekermann</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Beaton</surname>
            <given-names>G.</given-names>
          </name>
          <name>
            <surname>Sanoubari</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Lim</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Larson</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Law</surname>
            <given-names>E.</given-names>
          </name>
        </person-group>
        <article-title>Ambiguity-aware AI Assistants for Medical Data Analysis</article-title>
        <source>Proceedings of the 2020 CHI Conference on Human Factors in Computing Systems–CHI’20</source>
        <conf-loc>Honolulu, HI, USA</conf-loc>
        <conf-date>25–30 April 2020</conf-date>
        <publisher-name>Association for Computing Machinery</publisher-name>
        <publisher-loc>New York, NY, USA</publisher-loc>
        <year>2020</year>
        <fpage>1</fpage>
        <lpage>14</lpage>
      </element-citation>
    </ref>
    <ref id="B5-sensors-20-07302">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cairns</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Bond</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Breen</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Finlay</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Geldenring</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Peace</surname>
            <given-names>A.</given-names>
          </name>
        </person-group>
        <article-title>Variability of human-annotations of 12-lead ECG features collected using a web system: Students vs. practitioners</article-title>
        <source>J. Electrocardiol.</source>
        <year>2017</year>
        <pub-id pub-id-type="doi">10.1016/j.jelectrocard.2017.08.041</pub-id>
      </element-citation>
    </ref>
    <ref id="B6-sensors-20-07302">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Winslow</surname>
            <given-names>R.L.</given-names>
          </name>
          <name>
            <surname>Granite</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Jurado</surname>
            <given-names>C.</given-names>
          </name>
        </person-group>
        <article-title>WaveformECG: A platform for visualizing, annotating, and analyzing ECG data</article-title>
        <source>Comput. Sci. Eng.</source>
        <year>2016</year>
        <volume>18</volume>
        <fpage>36</fpage>
        <lpage>46</lpage>
        <pub-id pub-id-type="doi">10.1109/MCSE.2016.91</pub-id>
        <pub-id pub-id-type="pmid">28642673</pub-id>
      </element-citation>
    </ref>
    <ref id="B7-sensors-20-07302">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Vicente</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Johannesen</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Galeotti</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Strauss</surname>
            <given-names>D.G.</given-names>
          </name>
        </person-group>
        <article-title>ECGlab: User friendly ECG/VCG analysis tool for research environments</article-title>
        <source>Comput. Cardiol.</source>
        <year>2013</year>
        <volume>40</volume>
        <fpage>775</fpage>
        <lpage>778</lpage>
      </element-citation>
    </ref>
    <ref id="B8-sensors-20-07302">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pichot</surname>
            <given-names>V.</given-names>
          </name>
          <name>
            <surname>Roche</surname>
            <given-names>F.</given-names>
          </name>
          <name>
            <surname>Celle</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Barthélémy</surname>
            <given-names>J.C.</given-names>
          </name>
          <name>
            <surname>Chouchou</surname>
            <given-names>F.</given-names>
          </name>
        </person-group>
        <article-title>HRV analysis: A free software for analyzing cardiac autonomic activity</article-title>
        <source>Front. Physiol.</source>
        <year>2016</year>
        <volume>7</volume>
        <fpage>557</fpage>
        <pub-id pub-id-type="doi">10.3389/fphys.2016.00557</pub-id>
        <pub-id pub-id-type="pmid">27920726</pub-id>
      </element-citation>
    </ref>
    <ref id="B9-sensors-20-07302">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rodenhauser</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Good</surname>
            <given-names>W.W.</given-names>
          </name>
          <name>
            <surname>Zenger</surname>
            <given-names>B.</given-names>
          </name>
          <name>
            <surname>Tate</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Aras</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Burton</surname>
            <given-names>B.</given-names>
          </name>
          <name>
            <surname>MacLeod</surname>
            <given-names>R.S.</given-names>
          </name>
        </person-group>
        <article-title>PFEIFER: Preprocessing Framework for Electrograms Intermittently Fiducialized from Experimental Recordings</article-title>
        <source>J. Open Source Softw.</source>
        <year>2018</year>
        <volume>3</volume>
        <fpage>472</fpage>
        <pub-id pub-id-type="doi">10.21105/joss.00472</pub-id>
        <pub-id pub-id-type="pmid">30259008</pub-id>
      </element-citation>
    </ref>
    <ref id="B10-sensors-20-07302">
      <label>10.</label>
      <element-citation publication-type="confproc">
        <person-group person-group-type="author">
          <name>
            <surname>Vollmer</surname>
            <given-names>M.</given-names>
          </name>
        </person-group>
        <article-title>HRVTool—An Open-Source Matlab Toolbox for Analyzing Heart Rate Variability</article-title>
        <source>Proceedings of the 2019 Computing in Cardiology Conference (CinC)</source>
        <conf-loc>Singapore</conf-loc>
        <conf-date>8–11 September 2019</conf-date>
      </element-citation>
    </ref>
    <ref id="B11-sensors-20-07302">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bartels</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Neumamm</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Peçanha</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Carvalho</surname>
            <given-names>A.R.S.</given-names>
          </name>
        </person-group>
        <article-title>SinusCor: An advanced tool for heart rate variability analysis</article-title>
        <source>Biomed. Eng. Online</source>
        <year>2017</year>
        <volume>16</volume>
        <fpage>110</fpage>
        <pub-id pub-id-type="doi">10.1186/s12938-017-0401-4</pub-id>
        <pub-id pub-id-type="pmid">28923061</pub-id>
      </element-citation>
    </ref>
    <ref id="B12-sensors-20-07302">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mali</surname>
            <given-names>B.</given-names>
          </name>
          <name>
            <surname>Zulj</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Magjarevic</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Miklavcic</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Jarm</surname>
            <given-names>T.</given-names>
          </name>
        </person-group>
        <article-title>Matlab-based tool for ECG and HRV analysis</article-title>
        <source>Biomed. Signal Process. Control</source>
        <year>2014</year>
        <volume>10</volume>
        <fpage>108</fpage>
        <lpage>116</lpage>
        <pub-id pub-id-type="doi">10.1016/j.bspc.2014.01.011</pub-id>
      </element-citation>
    </ref>
    <ref id="B13-sensors-20-07302">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>L-Ziarjawey</surname>
            <given-names>H.A.</given-names>
          </name>
        </person-group>
        <article-title>Heart Rate Monitoring and PQRST Detection Based on Graphical User Interface with Matlab</article-title>
        <source>Int. J. Inf. Electron. Eng.</source>
        <year>2015</year>
        <volume>5</volume>
        <fpage>311</fpage>
      </element-citation>
    </ref>
    <ref id="B14-sensors-20-07302">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Moeyersons</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Amoni</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Huffel</surname>
            <given-names>S.V.</given-names>
          </name>
          <name>
            <surname>Willems</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Varon</surname>
            <given-names>C.</given-names>
          </name>
        </person-group>
        <article-title>R-DECO: An open-source Matlab based graphical user interface for the detection and correction of R-peaks</article-title>
        <source>PeerJ Comput. Sci.</source>
        <year>2019</year>
        <volume>5</volume>
        <fpage>e226</fpage>
        <pub-id pub-id-type="doi">10.7717/peerj-cs.226</pub-id>
      </element-citation>
    </ref>
    <ref id="B15-sensors-20-07302">
      <label>15.</label>
      <element-citation publication-type="confproc">
        <person-group person-group-type="author">
          <name>
            <surname>Karlen</surname>
            <given-names>W.</given-names>
          </name>
          <name>
            <surname>Turner</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Cooke</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Dumont</surname>
            <given-names>G.A.</given-names>
          </name>
          <name>
            <surname>Ansermino</surname>
            <given-names>J.M.</given-names>
          </name>
        </person-group>
        <article-title>CapnoBase: Signal database and tools to collect, share and annotate respiratory signals</article-title>
        <source>Proceedings of the Annual Meeting of the Society for Technology in Anesthesia (STA)</source>
        <conf-loc>West Palm Beach, FL, USA</conf-loc>
        <conf-date>13–16 January 2010</conf-date>
      </element-citation>
    </ref>
    <ref id="B16-sensors-20-07302">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rautaharju</surname>
            <given-names>P.M.</given-names>
          </name>
          <name>
            <surname>Surawicz</surname>
            <given-names>B.</given-names>
          </name>
          <name>
            <surname>Gettes</surname>
            <given-names>L.S.</given-names>
          </name>
        </person-group>
        <article-title>AHA/ACCF/HRS Recommendations for the Standardization and Interpretation of the Electrocardiogram: Part IV: The ST segment, T and U waves, and the QT interval: A scientific statement from the American Heart Association Electrocardiography and Arrhythmias Committee, Council on Clinical Cardiology; the American College of Cardiology Foundation; and the Heart Rhythm Society: Endorsed by the International Society for Computerized Electrocardiology</article-title>
        <source>J. Am. Coll. Cardiol.</source>
        <year>2009</year>
        <volume>119</volume>
        <fpage>e241</fpage>
        <lpage>e250</lpage>
      </element-citation>
    </ref>
    <ref id="B17-sensors-20-07302">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shaffer</surname>
            <given-names>F.</given-names>
          </name>
          <name>
            <surname>Ginsberg</surname>
            <given-names>J.P.</given-names>
          </name>
        </person-group>
        <article-title>An Overview of Heart Rate Variability Metrics and Norms</article-title>
        <source>Front. Public Health</source>
        <year>2017</year>
        <volume>5</volume>
        <fpage>258</fpage>
        <pub-id pub-id-type="doi">10.3389/fpubh.2017.00258</pub-id>
        <pub-id pub-id-type="pmid">29034226</pub-id>
      </element-citation>
    </ref>
    <ref id="B18-sensors-20-07302">
      <label>18.</label>
      <element-citation publication-type="confproc">
        <person-group person-group-type="author">
          <name>
            <surname>Zong</surname>
            <given-names>W.</given-names>
          </name>
          <name>
            <surname>Moody</surname>
            <given-names>G.B.</given-names>
          </name>
          <name>
            <surname>Jiang</surname>
            <given-names>D.</given-names>
          </name>
        </person-group>
        <article-title>A robust open-source algorithm to detect onset and duration of QRS complexes</article-title>
        <source>Proceedings of the Computers in Cardiology</source>
        <conf-loc>Thessaloniki Chalkidiki, Greece</conf-loc>
        <conf-date>21–24 September 2003</conf-date>
      </element-citation>
    </ref>
    <ref id="B19-sensors-20-07302">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Khamis</surname>
            <given-names>H.</given-names>
          </name>
          <name>
            <surname>Weiss</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Xie</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Chang</surname>
            <given-names>C.W.</given-names>
          </name>
          <name>
            <surname>Lovell</surname>
            <given-names>N.H.</given-names>
          </name>
          <name>
            <surname>Redmond</surname>
            <given-names>S.J.</given-names>
          </name>
        </person-group>
        <article-title>QRS Detection Algorithm for Telehealth Electrocardiogram Recordings</article-title>
        <source>IEEE Trans. Biomed. Eng.</source>
        <year>2016</year>
        <volume>63</volume>
        <fpage>1377</fpage>
        <lpage>1388</lpage>
        <pub-id pub-id-type="doi">10.1109/TBME.2016.2549060</pub-id>
        <pub-id pub-id-type="pmid">27046889</pub-id>
      </element-citation>
    </ref>
    <ref id="B20-sensors-20-07302">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Elgendi</surname>
            <given-names>M.</given-names>
          </name>
        </person-group>
        <article-title>Fast QRS Detection with an Optimized Knowledge-Based Method: Evaluation on 11 Standard ECG Databases</article-title>
        <source>PLoS ONE</source>
        <year>2013</year>
        <volume>8</volume>
        <elocation-id>e73557</elocation-id>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0073557</pub-id>
        <pub-id pub-id-type="pmid">24066054</pub-id>
      </element-citation>
    </ref>
    <ref id="B21-sensors-20-07302">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Saini</surname>
            <given-names>I.</given-names>
          </name>
          <name>
            <surname>Singh</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Khosla</surname>
            <given-names>A.</given-names>
          </name>
        </person-group>
        <article-title>QRS detection using K-Nearest Neighbor algorithm (KNN) and evaluation on standard ECG databases</article-title>
        <source>J. Adv. Res.</source>
        <year>2013</year>
        <volume>4</volume>
        <fpage>331</fpage>
        <lpage>344</lpage>
        <pub-id pub-id-type="doi">10.1016/j.jare.2012.05.007</pub-id>
        <pub-id pub-id-type="pmid">25685438</pub-id>
      </element-citation>
    </ref>
    <ref id="B22-sensors-20-07302">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Köhler</surname>
            <given-names>B.U.</given-names>
          </name>
          <name>
            <surname>Hennig</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Orglmeister</surname>
            <given-names>R.</given-names>
          </name>
        </person-group>
        <article-title>The principles of software QRS detection</article-title>
        <source>IEEE Eng. Med. Biol. Mag.</source>
        <year>2002</year>
        <volume>21</volume>
        <fpage>42</fpage>
        <lpage>57</lpage>
        <pub-id pub-id-type="doi">10.1109/51.993193</pub-id>
        <pub-id pub-id-type="pmid">11935987</pub-id>
      </element-citation>
    </ref>
    <ref id="B23-sensors-20-07302">
      <label>23.</label>
      <element-citation publication-type="confproc">
        <person-group person-group-type="author">
          <name>
            <surname>Saquib</surname>
            <given-names>N.</given-names>
          </name>
          <name>
            <surname>Papon</surname>
            <given-names>M.T.I.</given-names>
          </name>
          <name>
            <surname>Ahmad</surname>
            <given-names>I.</given-names>
          </name>
          <name>
            <surname>Rahman</surname>
            <given-names>A.</given-names>
          </name>
        </person-group>
        <article-title>Measurement of heart rate using photoplethysmography</article-title>
        <source>Proceedings of the 2015 International Conference on Networking Systems and Security (NSysS)</source>
        <conf-loc>Dhaka, Bangladesh</conf-loc>
        <conf-date>5–7 January 2015</conf-date>
      </element-citation>
    </ref>
    <ref id="B24-sensors-20-07302">
      <label>24.</label>
      <element-citation publication-type="confproc">
        <person-group person-group-type="author">
          <name>
            <surname>Bolanos</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Nazeran</surname>
            <given-names>H.</given-names>
          </name>
          <name>
            <surname>Haltiwanger</surname>
            <given-names>E.</given-names>
          </name>
        </person-group>
        <article-title>Comparison of heart rate variability signal features derived from electrocardiography and photoplethysmography in healthy individuals</article-title>
        <source>Proceedings of the 2006 International Conference of the IEEE Engineering in Medicine and Biology Society</source>
        <conf-loc>New York, NY, USA</conf-loc>
        <conf-date>30 August–3 September 2006</conf-date>
        <fpage>4289</fpage>
        <lpage>4294</lpage>
      </element-citation>
    </ref>
    <ref id="B25-sensors-20-07302">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schäfer</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Vagedes</surname>
            <given-names>J.</given-names>
          </name>
        </person-group>
        <article-title>How accurate is pulse rate variability as an estimate of heart rate variability? A review on studies comparing photoplethysmographic technology with an electrocardiogram</article-title>
        <source>Int. J. Cardiol.</source>
        <year>2013</year>
        <volume>166</volume>
        <fpage>15</fpage>
        <lpage>29</lpage>
        <pub-id pub-id-type="doi">10.1016/j.ijcard.2012.03.119</pub-id>
        <pub-id pub-id-type="pmid">22809539</pub-id>
      </element-citation>
    </ref>
    <ref id="B26-sensors-20-07302">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Malik</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Camm</surname>
            <given-names>A.J.</given-names>
          </name>
          <name>
            <surname>Bigger</surname>
            <given-names>J.T.</given-names>
          </name>
          <name>
            <surname>Breithardt</surname>
            <given-names>G.</given-names>
          </name>
          <name>
            <surname>Cerutti</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Cohen</surname>
            <given-names>R.J.</given-names>
          </name>
          <name>
            <surname>Coumel</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Fallen</surname>
            <given-names>E.L.</given-names>
          </name>
          <name>
            <surname>Kennedy</surname>
            <given-names>H.L.</given-names>
          </name>
          <name>
            <surname>Kleiger</surname>
            <given-names>R.E.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Heart rate variability. Standards of measurement, physiological interpretation, and clinical use</article-title>
        <source>Eur. Heart J.</source>
        <year>1996</year>
        <volume>17</volume>
        <fpage>354</fpage>
        <lpage>381</lpage>
        <pub-id pub-id-type="doi">10.1111/j.1542-474X.1996.tb00275.x</pub-id>
        <pub-id pub-id-type="pmid">8737210</pub-id>
      </element-citation>
    </ref>
    <ref id="B27-sensors-20-07302">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stojanovic</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Karadaglic</surname>
            <given-names>D.</given-names>
          </name>
        </person-group>
        <article-title>Design of an oximeter based on LED-LED configuration and FPGA technology</article-title>
        <source>Sensors</source>
        <year>2013</year>
        <volume>13</volume>
        <fpage>574</fpage>
        <lpage>586</lpage>
        <pub-id pub-id-type="doi">10.3390/s130100574</pub-id>
        <?supplied-pmid 23291575?>
        <pub-id pub-id-type="pmid">23291575</pub-id>
      </element-citation>
    </ref>
    <ref id="B28-sensors-20-07302">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pilt</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Meigas</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Ferenets</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Temitski</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Viigimaa</surname>
            <given-names>M.</given-names>
          </name>
        </person-group>
        <article-title>Photoplethysmographic signal waveform index for detection of increased arterial stiffness</article-title>
        <source>Physiol. Meas.</source>
        <year>2014</year>
        <volume>35</volume>
        <fpage>2027</fpage>
        <pub-id pub-id-type="doi">10.1088/0967-3334/35/10/2027</pub-id>
        <?supplied-pmid 25238409?>
        <pub-id pub-id-type="pmid">25238409</pub-id>
      </element-citation>
    </ref>
    <ref id="B29-sensors-20-07302">
      <label>29.</label>
      <element-citation publication-type="confproc">
        <person-group person-group-type="author">
          <name>
            <surname>Wei</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Sheng</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Lihua</surname>
            <given-names>G.</given-names>
          </name>
          <name>
            <surname>Yuquan</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Min</surname>
            <given-names>P.</given-names>
          </name>
        </person-group>
        <article-title>Study on conditioning and feature extraction algorithm of photoplethysmography signal for physiological parameters detection</article-title>
        <source>Proceedings of the 4th International Congress on Image and Signal Processing (CISP)</source>
        <conf-loc>Shanghai, China</conf-loc>
        <conf-date>15–17 October 2011</conf-date>
      </element-citation>
    </ref>
    <ref id="B30-sensors-20-07302">
      <label>30.</label>
      <element-citation publication-type="confproc">
        <person-group person-group-type="author">
          <name>
            <surname>Peterek</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Prauzek</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Penhaker</surname>
            <given-names>M.</given-names>
          </name>
        </person-group>
        <article-title>A new method for identification of the significant point in the plethysmografical record</article-title>
        <source>Proceedings of the 2nd International Conference on Signal Processing Systems</source>
        <conf-loc>Dalian, China</conf-loc>
        <conf-date>5–7 July 2010</conf-date>
      </element-citation>
    </ref>
    <ref id="B31-sensors-20-07302">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shin</surname>
            <given-names>H.S.</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>M.</given-names>
          </name>
        </person-group>
        <article-title>Adaptive threshold method for the peak detection of photoplethysmographic waveform</article-title>
        <source>Comput. Biol. Med.</source>
        <year>2009</year>
        <volume>39</volume>
        <fpage>1145</fpage>
        <lpage>1152</lpage>
        <pub-id pub-id-type="doi">10.1016/j.compbiomed.2009.10.006</pub-id>
        <?supplied-pmid 19883905?>
        <pub-id pub-id-type="pmid">19883905</pub-id>
      </element-citation>
    </ref>
    <ref id="B32-sensors-20-07302">
      <label>32.</label>
      <element-citation publication-type="confproc">
        <person-group person-group-type="author">
          <name>
            <surname>Luo</surname>
            <given-names>F.</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Yun</surname>
            <given-names>F.</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>X.</given-names>
          </name>
        </person-group>
        <article-title>An improved algorithm for the detection of photoplethysmographic percussion peaks</article-title>
        <source>Proceedings of the 7th International Congress on Image and Signal Processing (CISP)</source>
        <conf-loc>Dalian, China</conf-loc>
        <conf-date>14–16 October 2014</conf-date>
      </element-citation>
    </ref>
    <ref id="B33-sensors-20-07302">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Goldberger</surname>
            <given-names>A.L.</given-names>
          </name>
          <name>
            <surname>Amaral</surname>
            <given-names>L.A.</given-names>
          </name>
          <name>
            <surname>Glass</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Hausdorff</surname>
            <given-names>J.M.</given-names>
          </name>
          <name>
            <surname>Ivanov</surname>
            <given-names>P.C.</given-names>
          </name>
          <name>
            <surname>Mark</surname>
            <given-names>R.G.</given-names>
          </name>
          <name>
            <surname>Mietus</surname>
            <given-names>J.E.</given-names>
          </name>
          <name>
            <surname>Moody</surname>
            <given-names>G.B.</given-names>
          </name>
          <name>
            <surname>Peng</surname>
            <given-names>C.K.</given-names>
          </name>
          <name>
            <surname>Stanley</surname>
            <given-names>H.E.</given-names>
          </name>
        </person-group>
        <article-title>PhysioBank, PhysioToolkit, and PhysioNet: Components of a new research resource for complex physiologic signals</article-title>
        <source>Circulation</source>
        <year>2000</year>
        <volume>101</volume>
        <fpage>e215</fpage>
        <lpage>e220</lpage>
        <pub-id pub-id-type="doi">10.1161/01.CIR.101.23.e215</pub-id>
        <?supplied-pmid 10851218?>
        <pub-id pub-id-type="pmid">10851218</pub-id>
      </element-citation>
    </ref>
    <ref id="B34-sensors-20-07302">
      <label>34.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Moody</surname>
            <given-names>G.B.</given-names>
          </name>
          <name>
            <surname>Mark</surname>
            <given-names>R.G.</given-names>
          </name>
        </person-group>
        <article-title>The impact of the MIT-BIH arrhythmia database</article-title>
        <source>IEEE Eng. Med. Biol. Mag.</source>
        <year>2001</year>
        <volume>20</volume>
        <fpage>45</fpage>
        <lpage>50</lpage>
        <pub-id pub-id-type="doi">10.1109/51.932724</pub-id>
        <?supplied-pmid 11446209?>
        <pub-id pub-id-type="pmid">11446209</pub-id>
      </element-citation>
    </ref>
    <ref id="B35-sensors-20-07302">
      <label>35.</label>
      <element-citation publication-type="book">
        <source>Medical Electrical Equipment Part 2–47: Particular Requirements for the Basic Safety and Essential Performance of Ambulatory Electrocardiographic Systems</source>
        <publisher-name>IEC 60601-2-47:2012</publisher-name>
        <publisher-loc>Geneva, Switzerland</publisher-loc>
        <year>2012</year>
      </element-citation>
    </ref>
    <ref id="B36-sensors-20-07302">
      <label>36.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Orjuela-Cañón</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Posada-Quintero</surname>
            <given-names>H.</given-names>
          </name>
          <name>
            <surname>Delisle-Rodríguez</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Cuadra-Sanz</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>de la Vara-Prieto</surname>
            <given-names>R.F.</given-names>
          </name>
          <name>
            <surname>López-Delis</surname>
            <given-names>A.</given-names>
          </name>
        </person-group>
        <article-title>Onset and Peak Detection over Pulse Wave Using Supervised SOM Network</article-title>
        <source>Int. J. Biosci. Biochem. Bioinform.</source>
        <year>2013</year>
        <volume>3</volume>
        <fpage>133</fpage>
        <pub-id pub-id-type="doi">10.7763/IJBBB.2013.V3.181</pub-id>
      </element-citation>
    </ref>
    <ref id="B37-sensors-20-07302">
      <label>37.</label>
      <element-citation publication-type="web">
        <article-title>TimeView, GitHub</article-title>
        <comment>Available online: <ext-link ext-link-type="uri" xlink:href="https://github.com/TimeViewers/timeview">https://github.com/TimeViewers/timeview</ext-link></comment>
        <date-in-citation content-type="access-date" iso-8601-date="2020-11-14">(accessed on 14 November 2020)</date-in-citation>
      </element-citation>
    </ref>
    <ref id="B38-sensors-20-07302">
      <label>38.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Koranne</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Koranne</surname>
            <given-names>S.</given-names>
          </name>
        </person-group>
        <article-title>Hierarchical Data Format 5: HDF5</article-title>
        <source>Handbook of Open Source Tools</source>
        <publisher-name>Springer</publisher-name>
        <publisher-loc>Boston, MA, USA</publisher-loc>
        <year>2011</year>
      </element-citation>
    </ref>
    <ref id="B39-sensors-20-07302">
      <label>39.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Legarreta</surname>
            <given-names>I.R.</given-names>
          </name>
          <name>
            <surname>Addison</surname>
            <given-names>P.S.</given-names>
          </name>
          <name>
            <surname>Reed</surname>
            <given-names>M.J.</given-names>
          </name>
          <name>
            <surname>Grubb</surname>
            <given-names>N.</given-names>
          </name>
          <name>
            <surname>Clegg</surname>
            <given-names>G.R.</given-names>
          </name>
          <name>
            <surname>Robertson</surname>
            <given-names>C.E.</given-names>
          </name>
          <name>
            <surname>Watson</surname>
            <given-names>J.N.</given-names>
          </name>
        </person-group>
        <article-title>Continuous wavelet transform modulus maxima analysis of the electrocardiogram: Beat characterisation and beat-to-beat measurement</article-title>
        <source>Int. J. Wavelets Multiresolut. Inf. Process.</source>
        <year>2005</year>
        <volume>3</volume>
        <fpage>19</fpage>
        <lpage>42</lpage>
        <pub-id pub-id-type="doi">10.1142/S0219691305000774</pub-id>
      </element-citation>
    </ref>
    <ref id="B40-sensors-20-07302">
      <label>40.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>B.N.</given-names>
          </name>
          <name>
            <surname>Dong</surname>
            <given-names>M.C.</given-names>
          </name>
          <name>
            <surname>Vai</surname>
            <given-names>M.I.</given-names>
          </name>
        </person-group>
        <article-title>On an automatic delineator for arterial blood pressure waveforms</article-title>
        <source>Biomed. Signal Process. Control</source>
        <year>2010</year>
        <volume>5</volume>
        <fpage>76</fpage>
        <lpage>81</lpage>
        <pub-id pub-id-type="doi">10.1016/j.bspc.2009.06.002</pub-id>
      </element-citation>
    </ref>
    <ref id="B41-sensors-20-07302">
      <label>41.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Taddei</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Distante</surname>
            <given-names>G.</given-names>
          </name>
          <name>
            <surname>Emdin</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Pisani</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Moody</surname>
            <given-names>G.B.</given-names>
          </name>
          <name>
            <surname>Zeelenberg</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Marchesi</surname>
            <given-names>C.</given-names>
          </name>
        </person-group>
        <article-title>The European ST-T database: Standard for evaluating systems for the analysis of ST-T changes in ambulatory electrocardiography</article-title>
        <source>Eur. Heart J.</source>
        <year>1992</year>
        <volume>13</volume>
        <fpage>1164</fpage>
        <lpage>1172</lpage>
        <pub-id pub-id-type="doi">10.1093/oxfordjournals.eurheartj.a060332</pub-id>
        <pub-id pub-id-type="pmid">1396824</pub-id>
      </element-citation>
    </ref>
    <ref id="B42-sensors-20-07302">
      <label>42.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>De Cannière</surname>
            <given-names>H.</given-names>
          </name>
          <name>
            <surname>Smeets</surname>
            <given-names>C.J.</given-names>
          </name>
          <name>
            <surname>Schoutteten</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Varon</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>van Hoof</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>van Huffel</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Groenendaal</surname>
            <given-names>W.</given-names>
          </name>
          <name>
            <surname>Vandervoort</surname>
            <given-names>P.</given-names>
          </name>
        </person-group>
        <article-title>Using Biosensors and Digital Biomarkers to Assess Response to Cardiac Rehabilitation: Observational Study</article-title>
        <source>J. Med. Internet Res.</source>
        <year>2020</year>
        <volume>22</volume>
        <fpage>e17326</fpage>
        <pub-id pub-id-type="doi">10.2196/17326</pub-id>
        <pub-id pub-id-type="pmid">32432552</pub-id>
      </element-citation>
    </ref>
    <ref id="B43-sensors-20-07302">
      <label>43.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Van Steenkiste</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Groenendaal</surname>
            <given-names>W.</given-names>
          </name>
          <name>
            <surname>Dreesen</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Klerkx</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>De Francisco</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Deschrijver</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Dhaene</surname>
            <given-names>T.</given-names>
          </name>
        </person-group>
        <article-title>Portable Detection of Apnea and Hypopnea Events Using Bio-Impedance of the Chest and Deep Learning</article-title>
        <source>IEEE J. Biomed. Health Inform.</source>
        <year>2020</year>
        <volume>24</volume>
        <fpage>2589</fpage>
        <lpage>2598</lpage>
        <pub-id pub-id-type="doi">10.1109/JBHI.2020.2967872</pub-id>
        <?supplied-pmid 31976919?>
        <pub-id pub-id-type="pmid">31976919</pub-id>
      </element-citation>
    </ref>
    <ref id="B44-sensors-20-07302">
      <label>44.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hripcsak</surname>
            <given-names>G.</given-names>
          </name>
          <name>
            <surname>Rothschild</surname>
            <given-names>A.S.</given-names>
          </name>
        </person-group>
        <article-title>Agreement, the F-measure, and reliability in information retrieval</article-title>
        <source>J. Am. Med Inform. Assoc.</source>
        <year>2005</year>
        <volume>12</volume>
        <fpage>296</fpage>
        <lpage>298</lpage>
        <pub-id pub-id-type="doi">10.1197/jamia.M1733</pub-id>
        <?supplied-pmid 15684123?>
        <pub-id pub-id-type="pmid">15684123</pub-id>
      </element-citation>
    </ref>
    <ref id="B45-sensors-20-07302">
      <label>45.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pimentel</surname>
            <given-names>M.A.</given-names>
          </name>
          <name>
            <surname>Johnson</surname>
            <given-names>A.E.</given-names>
          </name>
          <name>
            <surname>Charlton</surname>
            <given-names>P.H.</given-names>
          </name>
          <name>
            <surname>Birrenkott</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Watkinson</surname>
            <given-names>P.J.</given-names>
          </name>
          <name>
            <surname>Tarassenko</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Clifton</surname>
            <given-names>D.A.</given-names>
          </name>
        </person-group>
        <article-title>Toward a robust estimation of respiratory rate from pulse oximeters</article-title>
        <source>IEEE Trans. Biomed. Eng.</source>
        <year>2016</year>
        <volume>64</volume>
        <fpage>1914</fpage>
        <lpage>1923</lpage>
        <pub-id pub-id-type="doi">10.1109/TBME.2016.2613124</pub-id>
        <?supplied-pmid 27875128?>
        <pub-id pub-id-type="pmid">27875128</pub-id>
      </element-citation>
    </ref>
    <ref id="B46-sensors-20-07302">
      <label>46.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pan</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Tompkins</surname>
            <given-names>W.J.</given-names>
          </name>
        </person-group>
        <article-title>A Real-Time QRS Detection Algorithm</article-title>
        <source>IEEE Trans. Biomed. Eng.</source>
        <year>1985</year>
        <volume>3</volume>
        <fpage>230</fpage>
        <lpage>236</lpage>
        <pub-id pub-id-type="doi">10.1109/TBME.1985.325532</pub-id>
        <?supplied-pmid 3997178?>
        <pub-id pub-id-type="pmid">3997178</pub-id>
      </element-citation>
    </ref>
    <ref id="B47-sensors-20-07302">
      <label>47.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Zheng</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Tai</surname>
            <given-names>C.</given-names>
          </name>
        </person-group>
        <article-title>Detection of ECG Characteristic Points Using Wavelet Transforms</article-title>
        <source>IEEE Trans. Biomed. Eng.</source>
        <year>1995</year>
        <volume>42</volume>
        <fpage>21</fpage>
        <lpage>28</lpage>
        <?supplied-pmid 7851927?>
        <pub-id pub-id-type="pmid">7851927</pub-id>
      </element-citation>
    </ref>
    <ref id="B48-sensors-20-07302">
      <label>48.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tran</surname>
            <given-names>T.V.</given-names>
          </name>
          <name>
            <surname>Chung</surname>
            <given-names>W.Y.</given-names>
          </name>
        </person-group>
        <article-title>A robust peak detection algorithm for photoplethysmographic waveforms in mobile devices</article-title>
        <source>J. Med. Imaging Health Inform.</source>
        <year>2017</year>
        <volume>7</volume>
        <fpage>1617</fpage>
        <lpage>1623</lpage>
        <pub-id pub-id-type="doi">10.1166/jmihi.2017.2175</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
<floats-group>
  <fig id="sensors-20-07302-f001" orientation="portrait" position="float">
    <label>Figure 1</label>
    <caption>
      <p>Example signals of one cardiac cycle with corresponding fiducials: P, Q, R, S and T waves’ peaks for electrocardiogram (ECG) (blue); and foot, upstroke, shoulder, peak, dicrotic notch (DN), and secondary peak (SP) for photoplethysmogram (PPG) (red).</p>
    </caption>
    <graphic xlink:href="sensors-20-07302-g001"/>
  </fig>
  <fig id="sensors-20-07302-f002" orientation="portrait" position="float">
    <label>Figure 2</label>
    <caption>
      <p>Different roles within the Platform for Analysis and Labeling of Medical time Series (PALMS), for each role the responsibility is depicted in the orange boxes, required information in gray boxes, and the information direction is given by the arrows. GUI—graphical user interface.</p>
    </caption>
    <graphic xlink:href="sensors-20-07302-g002"/>
  </fig>
  <fig id="sensors-20-07302-f003" orientation="portrait" position="float">
    <label>Figure 3</label>
    <caption>
      <p>Main window: plot area (1) is split into two panels, plot controls (2) displaying three tracks, and the menu (3).</p>
    </caption>
    <graphic xlink:href="sensors-20-07302-g003"/>
  </fig>
  <fig id="sensors-20-07302-f004" orientation="portrait" position="float">
    <label>Figure 4</label>
    <caption>
      <p>Example PPG signal in partition mode: one can label activities, motion artefacts, and other regions of interest.</p>
    </caption>
    <graphic xlink:href="sensors-20-07302-g004"/>
  </fig>
  <fig id="sensors-20-07302-f005" orientation="portrait" position="float">
    <label>Figure 5</label>
    <caption>
      <p>Example PPG signal in epoch mode: blue, green, and red color bars stand for different signal quality levels assigned to 10 s segments.</p>
    </caption>
    <graphic xlink:href="sensors-20-07302-g005"/>
  </fig>
  <fig id="sensors-20-07302-f006" orientation="portrait" position="float">
    <label>Figure 6</label>
    <caption>
      <p>PALMS ECG algorithm block diagram: CWT (continuous wavelet transformation), Y (absolute value of CWT), STD (standard deviation), QPD (quasi-peak detector), and T (threshold).</p>
    </caption>
    <graphic xlink:href="sensors-20-07302-g006"/>
  </fig>
  <fig id="sensors-20-07302-f007" orientation="portrait" position="float">
    <label>Figure 7</label>
    <caption>
      <p>Example of the ECG wavelet transform with the following threshold generation: original ECG (top), wavelet transformation (CWT, bottom, black), absolute value of the CWT signal (bottom, dashed blue), and detection threshold (bottom, red).</p>
    </caption>
    <graphic xlink:href="sensors-20-07302-g007"/>
  </fig>
  <fig id="sensors-20-07302-f008" orientation="portrait" position="float">
    <label>Figure 8</label>
    <caption>
      <p>PPG algorithm’s block diagram: each PPG block is processed to find locations of characteristic points (orange): LPF (low-pass filter), Y (zero-clamped LPF), STD (standard deviation), QPD (quasi-peak detector), and T (threshold).</p>
    </caption>
    <graphic xlink:href="sensors-20-07302-g008"/>
  </fig>
  <fig id="sensors-20-07302-f009" orientation="portrait" position="float">
    <label>Figure 9</label>
    <caption>
      <p>PPG algorithm fiducials’ definition: every beat must have foot, upstroke, and peak, other fiducials may be present depending on exact waveform. DN—dicrotic notch, SH—shoulder, SP—secondary peak.</p>
    </caption>
    <graphic xlink:href="sensors-20-07302-g009"/>
  </fig>
  <table-wrap id="sensors-20-07302-t001" orientation="portrait" position="float">
    <object-id pub-id-type="pii">sensors-20-07302-t001_Table 1</object-id>
    <label>Table 1</label>
    <caption>
      <p>Annotation labels.</p>
    </caption>
    <table frame="hsides" rules="groups">
      <thead>
        <tr>
          <th align="center" valign="middle" style="border-top:solid thin;border-bottom:solid thin" rowspan="1" colspan="1">Label</th>
          <th align="center" valign="middle" style="border-top:solid thin;border-bottom:solid thin" rowspan="1" colspan="1">Code</th>
          <th align="center" valign="middle" style="border-top:solid thin;border-bottom:solid thin" rowspan="1" colspan="1">Explanation</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td align="center" valign="middle" rowspan="1" colspan="1">0</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">Q0</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">Bad quality</td>
        </tr>
        <tr>
          <td align="center" valign="middle" rowspan="1" colspan="1">1</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">Q1 M0</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">Acceptable quality, not good morphology</td>
        </tr>
        <tr>
          <td align="center" valign="middle" rowspan="1" colspan="1">2</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">Q1 M1</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">Acceptable quality, good morphology</td>
        </tr>
        <tr>
          <td align="center" valign="middle" rowspan="1" colspan="1">3</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">Q2 M0</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">Good quality, not good morphology</td>
        </tr>
        <tr>
          <td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">4</td>
          <td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">Q2 M1</td>
          <td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">Good quality, good morphology</td>
        </tr>
      </tbody>
    </table>
  </table-wrap>
  <table-wrap id="sensors-20-07302-t002" orientation="portrait" position="float">
    <object-id pub-id-type="pii">sensors-20-07302-t002_Table 2</object-id>
    <label>Table 2</label>
    <caption>
      <p>ECG annotation conventions.</p>
    </caption>
    <table frame="hsides" rules="groups">
      <thead>
        <tr>
          <th colspan="2" align="center" valign="middle" style="border-top:solid thin;border-bottom:solid thin" rowspan="1">Signal Quality</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td align="center" valign="middle" rowspan="1" colspan="1">Q0</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">&lt;80% of QRS complexes are undoubtfully identified, reliable heart rate (HR) calculation not possible</td>
        </tr>
        <tr>
          <td align="center" valign="middle" rowspan="1" colspan="1">Q1</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">≥80% QRS complexes are undoubtfully identified, HR calculation is credible</td>
        </tr>
        <tr>
          <td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">Q2</td>
          <td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">Q1 and no R-peak position uncertainty, no artifact, heart rate variability (HRV) calculation is possible</td>
        </tr>
        <tr>
          <td colspan="2" align="center" valign="middle" style="border-bottom:solid thin" rowspan="1">
            <bold>Signal Morphology</bold>
          </td>
        </tr>
        <tr>
          <td align="center" valign="middle" rowspan="1" colspan="1">M1</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">P- and T-wave can be seen in nearly all QRS complexes</td>
        </tr>
        <tr>
          <td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">M0</td>
          <td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">Not M1</td>
        </tr>
      </tbody>
    </table>
  </table-wrap>
  <table-wrap id="sensors-20-07302-t003" orientation="portrait" position="float">
    <object-id pub-id-type="pii">sensors-20-07302-t003_Table 3</object-id>
    <label>Table 3</label>
    <caption>
      <p>PALMS PPG validation results (F1 score).</p>
    </caption>
    <table frame="hsides" rules="groups">
      <thead>
        <tr>
          <th align="center" valign="middle" style="border-top:solid thin;border-bottom:solid thin" rowspan="1" colspan="1">
</th>
          <th align="center" valign="middle" style="border-top:solid thin;border-bottom:solid thin" rowspan="1" colspan="1">TBME <sup>1</sup></th>
          <th align="center" valign="middle" style="border-top:solid thin;border-bottom:solid thin" rowspan="1" colspan="1">BIDMC <sup>2</sup></th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td align="center" valign="middle" rowspan="1" colspan="1">Foot</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">94.6%</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">96.8%</td>
        </tr>
        <tr>
          <td align="center" valign="middle" rowspan="1" colspan="1">Upstroke</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">98.6%</td>
          <td align="center" valign="middle" rowspan="1" colspan="1">98%</td>
        </tr>
        <tr>
          <td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">Peak</td>
          <td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">97.6%</td>
          <td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">96.8%</td>
        </tr>
      </tbody>
    </table>
    <table-wrap-foot>
      <fn>
        <p><sup>1</sup> IEEE TBME respiratory benchmark dataset [<xref rid="B15-sensors-20-07302" ref-type="bibr">15</xref>]. <sup>2</sup> BIDMC PPG and respiration dataset [<xref rid="B45-sensors-20-07302" ref-type="bibr">45</xref>]</p>
      </fn>
    </table-wrap-foot>
  </table-wrap>
</floats-group>
