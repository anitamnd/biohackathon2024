<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8371782</article-id>
    <article-id pub-id-type="publisher-id">4320</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-021-04320-3</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>CHIPIN: ChIP-seq inter-sample normalization based on signal invariance across transcriptionally constant genes</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Polit</surname>
          <given-names>Lélia</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Kerdivel</surname>
          <given-names>Gwenneg</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Gregoricchio</surname>
          <given-names>Sebastian</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Esposito</surname>
          <given-names>Michela</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Guillouf</surname>
          <given-names>Christel</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-4382-7185</contrib-id>
        <name>
          <surname>Boeva</surname>
          <given-names>Valentina</given-names>
        </name>
        <address>
          <email>valentina.boeva@inf.ethz.ch</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.508487.6</institution-id><institution-id institution-id-type="ISNI">0000 0004 7885 7602</institution-id><institution>Institut Cochin, Inserm U1016, CNRS UMR 8104, </institution><institution>Paris Descartes University UMR-S1016, </institution></institution-wrap>75014 Paris, France </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.14925.3b</institution-id><institution-id institution-id-type="ISNI">0000 0001 2284 9388</institution-id><institution>INSERM UMR1170, Equipe Labellisée Ligue Nationale Contre Le Cancer, Gustave Roussy, </institution><institution>Paris-Saclay University, </institution></institution-wrap>94800 Villejuif, France </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="GRID">grid.5801.c</institution-id><institution-id institution-id-type="ISNI">0000 0001 2156 2780</institution-id><institution>Department of Computer Science, Institute for Machine Learning, </institution><institution>ETH Zurich, </institution></institution-wrap>8092 Zurich, Switzerland </aff>
      <aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="GRID">grid.419765.8</institution-id><institution-id institution-id-type="ISNI">0000 0001 2223 3006</institution-id><institution>Swiss Institute for Bioinformatics (SIB), </institution></institution-wrap>Zürich, Switzerland </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>17</day>
      <month>8</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>17</day>
      <month>8</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2021</year>
    </pub-date>
    <volume>22</volume>
    <elocation-id>407</elocation-id>
    <history>
      <date date-type="received">
        <day>17</day>
        <month>10</month>
        <year>2020</year>
      </date>
      <date date-type="accepted">
        <day>30</day>
        <month>7</month>
        <year>2021</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2021</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold>This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">Multiple studies rely on ChIP-seq experiments to assess the effect of gene modulation and drug treatments on protein binding and chromatin structure. However, most methods commonly used for the normalization of ChIP-seq binding intensity signals across conditions, <italic>e.g.</italic>, the normalization to the same number of reads, either assume a constant signal-to-noise ratio across conditions or base the estimates of correction factors on genomic regions with intrinsically different signals between conditions. Inaccurate normalization of ChIP-seq signal may, in turn, lead to erroneous biological conclusions.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">We developed a new R package, CHIPIN, that allows normalizing ChIP-seq signals across different conditions/samples when spike-in information is not available, but gene expression data are at hand. Our normalization technique is based on the assumption that, on average, no differences in ChIP-seq signals should be observed in the regulatory regions of genes whose expression levels are constant across samples/conditions. In addition to normalizing ChIP-seq signals, CHIPIN provides as output a number of graphs and calculates statistics allowing the user to assess the efficiency of the normalization and qualify the specificity of the antibody used. In addition to ChIP-seq, CHIPIN can be used without restriction on open chromatin ATAC-seq or DNase hypersensitivity data. We validated the CHIPIN method on several ChIP-seq data sets and documented its superior performance in comparison to several commonly used normalization techniques.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p id="Par3">The CHIPIN method provides a new way for ChIP-seq signal normalization across conditions when spike-in experiments are not available. The method is implemented in a user-friendly R package available on GitHub: <ext-link ext-link-type="uri" xlink:href="https://github.com/BoevaLab/CHIPIN">https://github.com/BoevaLab/CHIPIN</ext-link></p>
      </sec>
      <sec>
        <title>Supplementary Information</title>
        <p>The online version contains supplementary material available at 10.1186/s12859-021-04320-3.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>ChIP-seq</kwd>
      <kwd>Open chromatin</kwd>
      <kwd>Normalization</kwd>
      <kwd>Density profiles</kwd>
      <kwd>Gene expression</kwd>
      <kwd>Algorithm</kwd>
      <kwd>R package</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100004097</institution-id>
            <institution>Fondation ARC pour la Recherche sur le Cancer</institution>
          </institution-wrap>
        </funding-source>
        <award-id>ARC-RAC16002KSA-R15093KS</award-id>
        <principal-award-recipient>
          <name>
            <surname>Boeva</surname>
            <given-names>Valentina</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100001665</institution-id>
            <institution>Agence Nationale de la Recherche</institution>
          </institution-wrap>
        </funding-source>
        <award-id>ANR-11-IDEX-0005-02</award-id>
        <principal-award-recipient>
          <name>
            <surname>Boeva</surname>
            <given-names>Valentina</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100006364</institution-id>
            <institution>Institut National Du Cancer</institution>
          </institution-wrap>
        </funding-source>
        <award-id>INCA-DGOS-INSERM_12561</award-id>
        <award-id>20141PLBIO06-1</award-id>
        <principal-award-recipient>
          <name>
            <surname>Kerdivel</surname>
            <given-names>Gwenneg</given-names>
          </name>
          <name>
            <surname>Guillouf</surname>
            <given-names>Christel</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2021</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par9">In the last decade, chromatin immunoprecipitation followed by sequencing (ChIP-seq) became an important technology to study genome-wide protein-DNA interactions. In particular, application of the ChIP-seq technique allowed studying mechanisms of gene transcription including getting insights into the role of transcription factors and posttranslational modifications of histone proteins. For instance, it was demonstrated that histone modifications (acetylation, methylation, phosphorylation, ubiquitination and SUMOylation) were often involved in transcriptional regulation. Acetylation of lysine (<italic>e</italic>.<italic>g</italic>., the lysine 27 of the histone H3, H3K27ac) was linked to gene expression activation while methylation of lysine (<italic>e</italic>.<italic>g</italic>., H3K27me3 and H3K9me3) was often associated with transcriptional repression [<xref ref-type="bibr" rid="CR1">1</xref>]. Using the ChIP-seq technology, exact position of histone modifications and transcription factors binding sites could be obtained.</p>
    <p id="Par10">ChIP-seq technology includes three main steps: (1) covalent crosslink of proteins such as histones or transcription factors to their genomic DNA substrates in living cells; (2) isolation and fragmentation to capture the protein-DNA complexes using an antibody specific for the protein of interest; (3) analysis of the immunoprecipitated DNA by high-throughput sequencing after reversal of cross links and purification. ChIP-seq technology has been often used to compare DNA binding of the protein of interest in two or multiple conditions. However, due to technical biases, comparing ChIP-seq signals in several conditions still remains a challenging issue. First, the signal comparison is impeded by variable efficiency of chromatin immunoprecipitation across samples. Second, ChIP-seq experiments are subject to variability in fragment length distributions and can exhibit differences in read counts caused by the DNA amplification bias. Together these biases can cause artefactual variations in ChIP-seq signal and lead to erroneous biological conclusions. Therefore, there is a strong need for a normalization procedure that could correct the aforementioned effects, especially when spike-in information [<xref ref-type="bibr" rid="CR2">2</xref>], relying on the addition of chromatin and antibody (Spike-in) from a different organism and allowing for better inter-sample normalization, is not available. Indeed, today most experimental work involving ChIP-seq does not use spike-in information [<xref ref-type="bibr" rid="CR2">2</xref>].</p>
    <p id="Par11">In most studies, the ChIP-seq signal normalization is performed using the total number of sequenced fragments per sample. The data is scaled by a constant factor, for instance using the function “<italic>bamCompare</italic>” provided by the “deepTools” package [<xref ref-type="bibr" rid="CR3">3</xref>]. Unfortunately, this normalization approach does not account for differences in the efficiency of immunoprecipitation and DNA amplification biases. Other methods such as Normalization of ChIP-Seq (NCIS) by Liang and Keleş [<xref ref-type="bibr" rid="CR4">4</xref>], which extended CisGenome [<xref ref-type="bibr" rid="CR5">5</xref>], use for the signal normalization the control sample. Here, the genome is divided into non-overlapping bins; a normalization factor is calculated as <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r = \frac{{\mathop \sum \nolimits_{i \in B} {\text{ChIP}}\_{\text{signal}}}}{{\mathop \sum \nolimits_{i \in B} {\text{Control}}\_{\text{signal}}}}$$\end{document}</tex-math><mml:math id="M2"><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:msub><mml:mtext>ChIP</mml:mtext><mml:mi>_</mml:mi><mml:mtext>signal</mml:mtext></mml:mrow><mml:mrow><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:msub><mml:mtext>Control</mml:mtext><mml:mi>_</mml:mi><mml:mtext>signal</mml:mtext></mml:mrow></mml:mfrac></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4320_Article_IEq1.gif"/></alternatives></inline-formula>, where <italic>B</italic> corresponds to the set of bins that belong to the background. In CisGenome [<xref ref-type="bibr" rid="CR5">5</xref>], the authors determine background regions as regions with total counts <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t \le 1$$\end{document}</tex-math><mml:math id="M4"><mml:mrow><mml:mi>t</mml:mi><mml:mo>≤</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4320_Article_IEq2.gif"/></alternatives></inline-formula> and bin-width <inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$w = 100$$\end{document}</tex-math><mml:math id="M6"><mml:mrow><mml:mi>w</mml:mi><mml:mo>=</mml:mo><mml:mn>100</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4320_Article_IEq3.gif"/></alternatives></inline-formula>, and the normalization factor <inline-formula id="IEq4"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r$$\end{document}</tex-math><mml:math id="M8"><mml:mi>r</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4320_Article_IEq4.gif"/></alternatives></inline-formula> is computed given these parameters. In NCIS, the marginal ChIP/Control ratio against total counts is used to determine the optimal value of <inline-formula id="IEq5"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t$$\end{document}</tex-math><mml:math id="M10"><mml:mi>t</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4320_Article_IEq5.gif"/></alternatives></inline-formula> and <inline-formula id="IEq6"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$w$$\end{document}</tex-math><mml:math id="M12"><mml:mi>w</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4320_Article_IEq6.gif"/></alternatives></inline-formula> in a data-adaptive manner and finally define set <italic>B</italic>.</p>
    <p id="Par12">More sophisticated methods [<xref ref-type="bibr" rid="CR6">6</xref>–<xref ref-type="bibr" rid="CR8">8</xref>] allow the user to determine differentially enriched regions, while addressing normalization problem but do not provide the resulting normalized profiles. For instance, in ChIPnorm [<xref ref-type="bibr" rid="CR7">7</xref>], the background is estimated, the local genomic bias is removed and finally the normalization problem is addressed using quantile normalization. MACS2, one of the most used ChIP-seq analysis tools [<xref ref-type="bibr" rid="CR9">9</xref>], permits identifying differential peaks (function <italic>bdgdiff</italic>) but the resulting normalized profiles are not provided. A two-step non-linear normalization method based on locally weighted regression (LOESS) approach was developed by Taslim et al. [<xref ref-type="bibr" rid="CR8">8</xref>]. To compare ChIP-seq data across multiple samples, the method models the difference using an Exponential-Normal<sub>K</sub> mixture model and uses the fitted model to select regions associated with differential binding sites based on local false discovery rate. ChIPseqSpikeInFree [<xref ref-type="bibr" rid="CR6">6</xref>] is a recent normalization method based on the computation of the slope of the cumulative read counts curve for each sample. Although powerful, these methods for differential peak calling do not provide normalized ChIP-seq density profiles as output.</p>
    <p id="Par13">Our team has recently developed a simple normalization method, LILY, based on matching the signal within strong peaks common to all conditions [<xref ref-type="bibr" rid="CR10">10</xref>]. The normalization factor is computed as the ratio of density values in these common regions. Importantly, the LILY pipeline is based on the ChIP-seq profiles explicitly corrected for copy number variation [<xref ref-type="bibr" rid="CR11">11</xref>] and thus can be used to compare signal between different cancer samples or between cancer and healthy tissues.</p>
    <p id="Par14">In sum, existing methods usually evaluate the normalization parameters based on common ChIP-seq peaks, or by using only the control, and do not accept additional information, <italic>e</italic>.<italic>g</italic>., gene expression, to establish a baseline. In this paper, we fill this gap by creating a user-friendly R package for ChIP-seq data inter-sample normalization. This method is based on the biological assumption that genes with constant expression across samples have, on average, similar protein binding intensities. Indeed, the correlation between gene expression and the deposition of chromatin marks or transcription factor binding has been documented by a number of studies [<xref ref-type="bibr" rid="CR12">12</xref>–<xref ref-type="bibr" rid="CR15">15</xref>] (see also Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S1).</p>
  </sec>
  <sec id="Sec2">
    <title>Implementation</title>
    <p id="Par15">We propose a normalization method called ChIPIN for ChIP-seq Inter-sample Normalization of fragment density signals across multiple conditions. Our method is based on the following assumption: on average, no difference in true ChIP-seq signal should be observed in the regulatory regions of genes whose expression is constant across samples/conditions. Our algorithm comprises three main steps (Fig. <xref rid="Fig1" ref-type="fig">1</xref>A). An additional, 4th step allows the user to verify the specificity of the antibody used. The tool is implemented as a user-friendly R package available online on GitHub (<ext-link ext-link-type="uri" xlink:href="https://github.com/BoevaLab/CHIPIN">https://github.com/BoevaLab/CHIPIN</ext-link>). The first three steps correspond to the first function of the package, called <italic>CHIPIN_normalize</italic>, described in “<xref rid="Sec4" ref-type="sec">Determining genes with constant expression between conditions/samples</xref>”, “<xref rid="Sec5" ref-type="sec">Building matrix containing ChIP-seq intensity values</xref>” and “<xref rid="Sec6" ref-type="sec">Performing the normalization</xref>” sections. The additional step is executed by the second function of the package, called <italic>plot_expression</italic>, described in “<xref rid="Sec9" ref-type="sec">Profiling ChIP-seq intensity around TSS as a function of gene expression level</xref>” section.<fig id="Fig1"><label>Fig. 1</label><caption><p>Outline of the CHIPIN package. <bold>A</bold> Four step approach implemented in CHIPIN. <bold>B</bold> Definition of “constant genes” (red) used as a baseline for the ChIP-seq signal normalization: “constant genes” are 10% (default) of genes with the lowest standard deviation of read counts selected from different ranges of gene expression (100 bins). <bold>C</bold> Gene body regions of “constant genes” and surrounding flanking regions (± <italic>n</italic> Kb, <italic>n</italic> = 4 Kb by default) are rescaled to 40 Kb (default) and segmented into bins (default bin length: 10 bp). TSS: transcription start site; TE: transcription end site. <bold>D</bold> Main steps of the quantile normalization. In CHIPIN the quantile normalization is applied separately to subsets of genes within a certain range of ChIP-seq intensity signal (<italic>k</italic> groups, <italic>k</italic> = <italic>20</italic> by default). <bold>E</bold> Difference in areas under the density curves is used for the evaluation of the success of the normalization process</p></caption><graphic xlink:href="12859_2021_4320_Fig1_HTML" id="MO1"/></fig></p>
    <p id="Par16">The output of our package consists of normalized.bigWig files which are directly viewable on the IGV software. The normalized profiles can be used as input into software for calling differential binding, <italic>e</italic>.<italic>g</italic>., HMCan-diff [<xref ref-type="bibr" rid="CR16">16</xref>].</p>
    <sec id="Sec3">
      <title>Determining genes with constant expression between conditions/samples</title>
      <p id="Par17">The CHIPIN method is based on the assumption that, on average, no difference in true ChIP-seq signal should be observed in the regulatory regions of genes whose expression stays constant across samples/conditions. These genes are determined by the package using gene expression data (RNA-seq or micro-array). For this purpose, we compute the mean and the standard deviation of the Count Per Million (CPM) values for each gene from RNA-seq experiments or unlogged microarray values. To extract an equal percentage of “constant genes” in each range of expression values, we divide all genes into 100 equal-size groups according to the mean values of gene expression. We define the least variable, “constant” genes as genes that show the smallest standard deviation values across samples/conditions (default: 10%) in each expression group (Fig. <xref rid="Fig1" ref-type="fig">1</xref>B, “constant genes” are depicted in red). The output of this step is a standard.bed file with gene coordinates.</p>
      <p id="Par18">In addition to the CPM format, the user can provide expression data in the form of Fragments Per Kilobase per Million mapped reads (FPKM) or Transcripts Per Kilobase Million reads (TPM), where read counts are normalized for the gene length; in this case, CHIPIN will transform the FPKM or TPM counts into values proportional to CPM using available transcript annotations (exon lengths).</p>
    </sec>
    <sec id="Sec4">
      <title>Building matrix containing ChIP-seq intensity values</title>
      <p id="Par19">Using.bigWig density files provided by the user and the .bed file containing coordinates of “constant genes”, CHIPIN computes for each sample/condition the density of signal across “constant genes” and their flanking regions (± n Kb, n = 4 by default) (Fig. <xref rid="Fig1" ref-type="fig">1</xref>C). For this step, we use the function “<italic>computeMatrix</italic>” provided by the “deepTools” package [<xref ref-type="bibr" rid="CR3">3</xref>]. The <italic>computeMatrix</italic> function offers the possibility to rescale all genes to the same length (default: 40 kb). The rescaled gene body regions and their additional flanking regions upstream and downstream of the gene body are then segmented into bins (default bin size: 10 bp). Finally, the average signal per bin for each gene is calculated. The output of this step is one matrix per sample/condition with element corresponding to the cumulated density signal per bin and per gene (Fig. <xref rid="Fig1" ref-type="fig">1</xref>C).</p>
      <p id="Par20">Of note, CHIPIN does not explicitly take into account Input or IgG control tracks. Instead, we recommend the users to work with densities tracks already normalized for the background signal using one of the available tools. In this study, we used the .bigWig output of the HMCan software [<xref ref-type="bibr" rid="CR11">11</xref>]. Indeed, peak calling with HMCan allows for the correction of the ChIP-seq signal for copy number and GC-content biases; it reduces the background noise by subtracting the control signal with a constant reflecting the noise ratio of the ChIP sample.</p>
    </sec>
    <sec id="Sec5">
      <title>Performing the normalization</title>
      <p id="Par21">For each sample/condition, the matrices obtained by “deepTools” at the previous step are used to infer normalization parameters. The user can choose between two normalization strategies: quantile and linear normalization, described below. CHIPIN also provides indicators illustrating the success of normalization process: (i) statistics showing the relative difference between average signal curves before and after the normalization procedure; and (ii) visualization of the signal around transcription start sites (TSSs) of “constant genes” before and after the normalization. We further describe two possible normalization strategies the user can choose from.</p>
      <sec id="Sec6">
        <title>Linear regression with non-zero intercept</title>
        <p id="Par22">The goal of this step is to make density values in all samples/conditions comparable. Here, we choose one of the conditions as a reference (default: sample with the median signal intensity across all conditions). We separately calculate regression coefficients for each sample using the reference density profile and then normalize density profiles using these coefficients. In more detail, for each sample and the reference we first calculate the average signal per bin from the density matrices computed in “<xref rid="Sec5" ref-type="sec">Building matrix containing ChIP-seq intensity values</xref>” section (Fig. <xref rid="Fig1" ref-type="fig">1</xref>C). Then, we perform linear regression with non-zero intercept on these average intensity values: <inline-formula id="IEq7"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\overline{S}_{Current\,Sample}$$\end{document}</tex-math><mml:math id="M14"><mml:msub><mml:mover><mml:mi>S</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mrow><mml:mi>C</mml:mi><mml:mi>u</mml:mi><mml:mi>r</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi><mml:mspace width="0.166667em"/><mml:mi>S</mml:mi><mml:mi>a</mml:mi><mml:mi>m</mml:mi><mml:mi>p</mml:mi><mml:mi>l</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4320_Article_IEq7.gif"/></alternatives></inline-formula> versus the reference sample <inline-formula id="IEq8"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\overline{S}_{Reference\,Sample}$$\end{document}</tex-math><mml:math id="M16"><mml:msub><mml:mover><mml:mi>S</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mrow><mml:mi>R</mml:mi><mml:mi>e</mml:mi><mml:mi>f</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>c</mml:mi><mml:mi>e</mml:mi><mml:mspace width="0.166667em"/><mml:mi>S</mml:mi><mml:mi>a</mml:mi><mml:mi>m</mml:mi><mml:mi>p</mml:mi><mml:mi>l</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4320_Article_IEq8.gif"/></alternatives></inline-formula>. For each sample, a linear regression with non-zero intercept provides <inline-formula id="IEq9"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha$$\end{document}</tex-math><mml:math id="M18"><mml:mi>α</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4320_Article_IEq9.gif"/></alternatives></inline-formula> and <inline-formula id="IEq10"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta$$\end{document}</tex-math><mml:math id="M20"><mml:mi>β</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4320_Article_IEq10.gif"/></alternatives></inline-formula> that minimize the sum of square errors <italic>ε</italic> in:<disp-formula id="Equa"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\overline{S}_{Current\,Sample} = \alpha *\overline{S}_{Reference\,Sample} + \beta + \varepsilon .$$\end{document}</tex-math><mml:math id="M22" display="block"><mml:mrow><mml:msub><mml:mover><mml:mi>S</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mrow><mml:mi>C</mml:mi><mml:mi>u</mml:mi><mml:mi>r</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi><mml:mspace width="0.166667em"/><mml:mi>S</mml:mi><mml:mi>a</mml:mi><mml:mi>m</mml:mi><mml:mi>p</mml:mi><mml:mi>l</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>α</mml:mi><mml:mrow/><mml:mo>∗</mml:mo><mml:msub><mml:mover><mml:mi>S</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mrow><mml:mi>R</mml:mi><mml:mi>e</mml:mi><mml:mi>f</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>c</mml:mi><mml:mi>e</mml:mi><mml:mspace width="0.166667em"/><mml:mi>S</mml:mi><mml:mi>a</mml:mi><mml:mi>m</mml:mi><mml:mi>p</mml:mi><mml:mi>l</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>β</mml:mi><mml:mo>+</mml:mo><mml:mi>ε</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:math><graphic xlink:href="12859_2021_4320_Article_Equa.gif" position="anchor"/></alternatives></disp-formula></p>
        <p id="Par23">Given <inline-formula id="IEq11"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha$$\end{document}</tex-math><mml:math id="M24"><mml:mi>α</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4320_Article_IEq11.gif"/></alternatives></inline-formula> and <inline-formula id="IEq12"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta$$\end{document}</tex-math><mml:math id="M26"><mml:mi>β</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4320_Article_IEq12.gif"/></alternatives></inline-formula> for each sample/condition, the density profile in each condition is then corrected:<disp-formula id="Equb"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S_{Current\,Sample\,corrected} = \max \left( {0,\left( {S_{Current\,Sample} - \beta } \right)/\alpha } \right).$$\end{document}</tex-math><mml:math id="M28" display="block"><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mi>u</mml:mi><mml:mi>r</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi><mml:mspace width="0.166667em"/><mml:mi>S</mml:mi><mml:mi>a</mml:mi><mml:mi>m</mml:mi><mml:mi>p</mml:mi><mml:mi>l</mml:mi><mml:mi>e</mml:mi><mml:mspace width="0.166667em"/><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo movablelimits="true">max</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mi>u</mml:mi><mml:mi>r</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi><mml:mspace width="0.166667em"/><mml:mi>S</mml:mi><mml:mi>a</mml:mi><mml:mi>m</mml:mi><mml:mi>p</mml:mi><mml:mi>l</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:mi>β</mml:mi></mml:mrow></mml:mfenced><mml:mo stretchy="false">/</mml:mo><mml:mi>α</mml:mi></mml:mrow></mml:mfenced><mml:mo>.</mml:mo></mml:mrow></mml:math><graphic xlink:href="12859_2021_4320_Article_Equb.gif" position="anchor"/></alternatives></disp-formula></p>
        <p id="Par24">This transformation is applied on the ChIP-seq signal intensity values available in the original.bigWig files.</p>
      </sec>
      <sec id="Sec7">
        <title>Quantile normalization</title>
        <p id="Par25">To perform quantile normalization, ChIP-seq signal intensity matrix calculated in “<xref rid="Sec5" ref-type="sec">Building matrix containing ChIP-seq intensity values</xref>” section is first averaged for genes with similar binding intensity (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Figure S2, default number of gene groups <inline-formula id="IEq13"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k$$\end{document}</tex-math><mml:math id="M30"><mml:mi>k</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4320_Article_IEq13.gif"/></alternatives></inline-formula> = 20). The quantile normalization is then performed on averaged intensities of these <inline-formula id="IEq14"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k$$\end{document}</tex-math><mml:math id="M32"><mml:mi>k</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4320_Article_IEq14.gif"/></alternatives></inline-formula> gene groups (Fig. <xref rid="Fig1" ref-type="fig">1</xref>D) and the discovered normalization function is applied to the original ChIP-seq signal intensity values from .bigWig file. The mathematical transformation to obtain the normalized values from the non-normalized values for each group is learned using functions “smooth.spline” and “predict” from the R package “stats”.</p>
      </sec>
    </sec>
    <sec id="Sec8">
      <title>Profiling ChIP-seq intensity around TSS as a function of gene expression level</title>
      <p id="Par26">The CHIPIN package offers the possibility to profile the average ChIP-seq signal around gene TSSs according to gene expression values. Gene expression data, FPKM values or microarray values of all genes, are separated into three groups using <italic>k</italic>-means clustering: high-, medium- and low-expressed genes. Then the ChIP-seq signal around TSSs of these three groups of genes is visualized using a density profile (see “<xref rid="Sec15" ref-type="sec">Qualification of the specificity of the antibody used</xref>” section for an example of application).</p>
    </sec>
  </sec>
  <sec id="Sec9">
    <title>Results</title>
    <p id="Par27">We validated CHIPIN in comparison with three other normalization techniques: (i) normalization to the same number of reads, (ii) the LILY method based on the idea of matching the signal in the strongest shared peaks [<xref ref-type="bibr" rid="CR10">10</xref>], and (iii) one of the most recent normalization methods, ChIPSeqSpikeInFree, based on matching the signal in genomic sliding windows via the calculation of turning points in density distributions [<xref ref-type="bibr" rid="CR6">6</xref>]. We included the normalization to the same number of reads into the comparison because it has been so far the most widely used normalization technique for ChIP-seq signals. And indeed, when applied to conditions characterized within the same technical replicate, this normalization strategy provides stable and trustable results. The two other methods, although not covering the whole spectrum of normalization approaches, are representative of the two hypotheses behind normalization strategies: the one based on the strongest and the other – on overall signal.</p>
    <p id="Par28">To perform the comparison, we used ChIP-seq densities (.bigWig files) obtained with the HMCan software [<xref ref-type="bibr" rid="CR11">11</xref>]. In our comparison of the methods, we addressed two questions: (i) Can the CHIPIN normalization strategy efficiently match signal densities across conditions and across replicates? and (ii) Does the CHIPIN normalization preserve biological differences between protein binding density signals?</p>
    <sec id="Sec10">
      <title>CHIPIN efficiently matches average density profiles for regions surrounding the TSS of “constant genes”</title>
      <p id="Par29">We assessed the performance of CHIPIN to match ChIP-seq density profiles in genomic regions corresponding to genes with low transcriptional variation across conditions. This analysis was performed on two data sets: five human adrenocortical carcinoma samples profiled for H3K27ac (unpublished data) and the erythroleukemic murine cell line, with doxycycline inducible shRNA against Spi1, further called shSpi1-A2B profiled for H3K27ac in two conditions: (1) with Spi1-overexpressed: Spi1++, and (2) Spi1-repressed: Spi1− [<xref ref-type="bibr" rid="CR17">17</xref>].</p>
      <sec id="Sec11">
        <title>Results for human adrenocortical carcinoma samples</title>
        <p id="Par30">First, we applied two CHIPIN normalization methods (linear regression and quantile normalization) and the three other techniques to H3K27ac profiles obtained for five human adrenocortical carcinoma samples. To assess the effect of the normalization procedure, we calculated and compared the average ChIP-seq density values around TSSs of “constant genes” before and after the normalization. In contrast to the three other methods, both linear and quantile normalization by CHIPIN allowed to remove significant differences between the H3K27ac average density values for this group of low-variability genes (Fig. <xref rid="Fig2" ref-type="fig">2</xref>).<fig id="Fig2"><label>Fig. 2</label><caption><p>Comparison of normalization efficiency on five H3K27ac data sets of adrenocortical carcinoma. Average density signal is shown for 8 kb regions surrounding TSSs of “constant genes”. The first plot corresponds to the average signal before the normalization. Antibody: ab4729 (rabbit polyclonal, Abcam)</p></caption><graphic xlink:href="12859_2021_4320_Fig2_HTML" id="MO2"/></fig></p>
        <p id="Par31">We quantified the differences between the density curves of the five samples before and after each normalization procedure (Table <xref rid="Tab1" ref-type="table">1</xref>). For that, we divided the region of 8 kb around the TSSs of “constant genes” into 3 zones, Zone 1 (− 4 Kb, − 1 Kb), Zone 2 (− 1 Kb, + 1 Kb), and Zone 3 (+ 1 Kb, + 4 Kb) (Fig. <xref rid="Fig1" ref-type="fig">1</xref>E). The discrepancy between each sample/condition was evaluated by the average difference in percentage of area under the density curves (Table <xref rid="Tab1" ref-type="table">1</xref>). In the central region (Zone 2) corresponding to promoter regions and involved in the regulation of gene expression, CHIPIN achieved much better performance than the other approaches. Indeed, initial difference of 34.75% before the normalization was shrunk by CHIPIN to only 1.8% (quantile normalization), while the best public method, LILY, resulted in 18% of difference between the normalized profiles.<table-wrap id="Tab1"><label>Table 1</label><caption><p>Average percentage difference between average density curves (Fig. <xref rid="Fig2" ref-type="fig">2</xref>) in the three zones surrounding TSSs of “constant genes” (Fig. <xref rid="Fig1" ref-type="fig">1</xref>E)</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"/><th align="left">Zone 1 (%)</th><th align="left">Zone 2 (%)</th><th align="left">Zone 3 (%)</th></tr></thead><tbody><tr><td align="left">Before normalization</td><td align="left">27.5</td><td align="left">34.75</td><td align="left">28.25</td></tr><tr><td align="left">Quantile Normalization by CHIPIN</td><td align="left">15.3</td><td align="left"><bold>1.8</bold></td><td align="left">7.9</td></tr><tr><td align="left">Linear Regression by CHIPIN</td><td align="left">21</td><td align="left">4.5</td><td align="left">19.2</td></tr><tr><td align="left">Same number of reads</td><td align="left">7.5</td><td align="left">23</td><td align="left"><bold>6.5</bold></td></tr><tr><td align="left">LILY</td><td align="left"><bold>6.5</bold></td><td align="left">18</td><td align="left">6.7</td></tr><tr><td align="left">ChIPseqSpikeInFree</td><td align="left">29</td><td align="left">27</td><td align="left">29.5</td></tr></tbody></table><table-wrap-foot><p>The smallest value for each zone is shown in bold</p></table-wrap-foot></table-wrap></p>
      </sec>
      <sec id="Sec12">
        <title>Results for murine shSpi1-A2B cell line</title>
        <p id="Par32">To further validate the performance of CHIPIN, we analyzed the second data set, the shSpi1-A2B cell line profiled for H3K27ac in two conditions: (i) Spi1-overexpressed: Spi1++, and (ii) Spi1-repressed: Spi1−. For each condition, we had two available technical replicates: replicate 1 and 2. To show the importance of correction for the batch effect, we further used replicate 1 for the Spi1++ condition and replicate 2 for the Spi1− condition for the validation of the CHIPIN method. At the same time, normalization to the same number of reads within Replicate 1 provided us with the ground truth (Fig. <xref rid="Fig3" ref-type="fig">3</xref>A).<fig id="Fig3"><label>Fig. 3</label><caption><p>Comparison of normalization efficiency for H3K27ac profiles in the shSpi1-A2B cell line within replicates (<bold>A</bold>) and across replicates (<bold>B</bold>). Average density signal is shown for 8 kb regions surrounding TSSs of “constant genes”. The first plot corresponds to the average signal before the normalization. Antibody: rabbit polyclonal against H3K27ac (ab4729, Abcam); conditions: Spi1++—Spi1 overexpressed, Spi1−—Spi1 repressed by a doxycycline-inducible shRNA</p></caption><graphic xlink:href="12859_2021_4320_Fig3_HTML" id="MO3"/></fig></p>
        <p id="Par33">We applied CHIPIN (linear and quantile normalization) and the three other normalization techniques to H3K27ac densities calculated for Spi1++ and Spi1− conditions (Fig. <xref rid="Fig3" ref-type="fig">3</xref>B, Table <xref rid="Tab2" ref-type="table">2</xref>). CHIPIN resulted in almost perfect match of the two average density curves for “constant genes” using both quantile normalization and linear regression (0.06% and 0.1% of difference after the normalization <italic>vs</italic> 38% of difference before the normalization for the central Zone 2). Application of all other methods also allowed shrinking the difference in ChIP-seq signals between the two conditions (from 38% to 7.6%, 11.9% and 17.2% for the normalization using same number of reads, ChIPSeqSpikeInFree and LILY, respectively), without however reaching the performance of CHIPIN (Fig. <xref rid="Fig3" ref-type="fig">3</xref>B, Table <xref rid="Tab2" ref-type="table">2</xref>).<table-wrap id="Tab2"><label>Table 2</label><caption><p>Percentage difference between H3K27ac density curves (Fig. <xref rid="Fig3" ref-type="fig">3</xref>B) in the three zones surrounding TSSs of “constant genes” (Fig. <xref rid="Fig1" ref-type="fig">1</xref>E)</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"/><th align="left">Zone 1 (%)</th><th align="left">Zone 2 (%)</th><th align="left">Zone 3 (%)</th></tr></thead><tbody><tr><td align="left">Before normalization</td><td align="left">32</td><td align="left">38</td><td align="left">30</td></tr><tr><td align="left">Quantile Normalization by CHIPIN</td><td align="left">4.6</td><td align="left"><bold>0.06</bold></td><td align="left">8.6</td></tr><tr><td align="left">Linear Regression by CHIPIN</td><td align="left"><bold>1.5</bold></td><td align="left">0.1</td><td align="left">5.3</td></tr><tr><td align="left">Same number of reads</td><td align="left">2.8</td><td align="left">7.6</td><td align="left">2.3</td></tr><tr><td align="left">LILY</td><td align="left">6.8</td><td align="left">17.2</td><td align="left"><bold>1.9</bold></td></tr><tr><td align="left">ChIPSeqSpikeInFree</td><td align="left">15.6</td><td align="left">11.9</td><td align="left">18.2</td></tr></tbody></table><table-wrap-foot><p>The smallest value for each zone is shown in bold</p></table-wrap-foot></table-wrap></p>
      </sec>
    </sec>
    <sec id="Sec13">
      <title>CHIPIN preserves biological differences in ChIP-seq density signals between conditions</title>
      <p id="Par34">As the CHIPIN normalization procedure uses exclusively genomic regions surrounding “constant genes”, we assessed the method efficiency for maintaining biological differences in ChIP-seq signal for genes that are differentially expressed across the conditions. We extracted genes differentially expressed between the Spi1++ and the Spi1− conditions in the shSpi1-A2B mouse cell line (FC &gt; 1.5, FDR-adjusted t-test p-value &lt; 0.05) and then analyzed density profiles of the activator histone mark H3K27ac in the vicinity of TSS of genes up- and down-regulated in the Spi1++ condition after applying the normalization procedures (Fig. <xref rid="Fig4" ref-type="fig">4</xref>).<fig id="Fig4"><label>Fig. 4</label><caption><p>Comparison of normalization efficiency by CHIPIN and the three other methods in genomic regions corresponding to differentially expressed genes in the shSpi1-A2B cells (across replicates). <bold>A</bold> H3K27ac density profiles around TSSs of genes down- and up-regulated by Spi1 in two conditions: “Spi1++”—Spi1 overexpressed, “Spi1−”—Spi1 repressed. <bold>B</bold> Differences in H3K27ac signal in zones 1–3 (Fig. <xref rid="Fig1" ref-type="fig">1</xref>E) in gene promoters for genes up- and down-regulated by Spi1; axes show differences between density values in conditions Spi1++ and Spi1−. Correct normalization procedures would result in observations laying close to the diagonal (<inline-formula id="IEq16"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$y = x$$\end{document}</tex-math><mml:math id="M34"><mml:mrow><mml:mi>y</mml:mi><mml:mo>=</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4320_Article_IEq16.gif"/></alternatives></inline-formula>, grey dotted line)</p></caption><graphic xlink:href="12859_2021_4320_Fig4_HTML" id="MO4"/></fig></p>
      <p id="Par35">Given the strong linear correlation between gene transcriptional levels and the H3K27ac promoter signal (Pearson R = 0.83, Additional file <xref rid="MOESM3" ref-type="media">3</xref>: Figure S3), we could estimate the expected shift between H3K27ac densities around gene TSSs in the Spi1++ and Spi1− conditions for up- and down-regulated genes: predicted average shifts for down- and up-regulated genes were -22.7 and 19.2, respectively, which corresponded to the ratio of 1.18 between the absolute shift values (Fig. <xref rid="Fig4" ref-type="fig">4</xref>C). Indeed, the within replicate normalization for the same number of reads resulted in comparable shift ratio of the signals (Figs. <xref rid="Fig4" ref-type="fig">4</xref>C and S2), corroborating our modelling strategy.</p>
      <p id="Par36">When normalizing across conditions, out of the four tested methods, CHIPIN (using both linear and quantile normalization) provided the results closest to the expected (Fig. <xref rid="Fig4" ref-type="fig">4</xref>B, C). Application of LILY and the normalization to the same number of reads resulted in differences between H3K27ac density curves in the Spi1++ and Spi1− conditions being much stronger for genes down-regulated by Spi1 than for the up-regulated genes (Fig. <xref rid="Fig4" ref-type="fig">4</xref>A). Inversely, the normalization by ChIPSeqSpikeInFree resulted in a much higher differences in the H3K27ac densities for the up-regulated than for the down-regulated genes. Thus, we concluded that CHIPIN outperformed on this biological example the three other methods.</p>
    </sec>
    <sec id="Sec14">
      <title>Qualification of the specificity of the antibody used</title>
      <p id="Par37">The quality of a ChIP-seq experiment relies a lot on the efficiency and the specificity of the antibody used. Indeed, using unspecific antibodies may lead to erroneous biological conclusions. Thus, profiling the average ChIP-seq signal around gene TSSs according to gene expression values is a good way to verify that known biological patterns are respected [<xref ref-type="bibr" rid="CR18">18</xref>]. One can use <italic>a priory</italic> known information about the effects of binding of the protein of interest on gene expression: highly expressed genes tend to have stronger signal of “active” histone marks (<italic>e</italic>.<italic>g</italic>., H3K27ac and H3K4me3) and transcription factor binding around in their promoters, while silent genes or genes with low expression tend to have stronger signal of “repressor” histone marks (<italic>e</italic>.<italic>g</italic>., H3K27me3 and H3K9me3) in the vicinity of their TSS [<xref ref-type="bibr" rid="CR19">19</xref>].</p>
      <p id="Par38">Here, we provide an example how the <italic>plot_expression</italic> function of the CHIPIN package allowed detection on unspecific binding of an antibody (Fig. <xref rid="Fig5" ref-type="fig">5</xref>).<fig id="Fig5"><label>Fig. 5</label><caption><p>Graphs generated by CHIPIN allowing evaluating specificity of two antibodies used: <bold>A</bold> antibody ab4729 (Abcam) against H3K27ac in an adrenocortical carcinoma sample (unpublished), and <bold>B</bold> antibody ACM39155 (Active Motif) against H3K27me3 in the shSpi1-A2B cells (unpublished). For ab4729, as expected, highly expressed genes show a higher level of H3K27ac than genes of medium or low expression; while for ACM39155, highly expressed genes show an increase of intensities for H3K27me3 downstream TSS (red). This suggests a potential non-specific binding of this antibody targeting H3K27 methylation to acetylated lysines, also documented by Rothbart et al. [<xref ref-type="bibr" rid="CR20">20</xref>]</p></caption><graphic xlink:href="12859_2021_4320_Fig5_HTML" id="MO5"/></fig></p>
      <p id="Par39">We applied CHIPIN on two ChIP-seq experiments: H3K27ac in adrenocortical carcinoma samples (antibody ab4729, Abcam) and H3K27me3 in the shSpi1-A2B cells (antibody ACM39155, Active Motif). The histone modification ChIP-seq data were coupled with RNA-seq experiments measuring gene expression in the corresponding samples. CHIPIN generated profiles of average density distributions around TSSs for three groups of genes: low, medium and highly expressed genes (Fig. <xref rid="Fig5" ref-type="fig">5</xref>).</p>
      <p id="Par40">As expected, for the adrenocortical carcinoma samples, the density around the gene TSS of the profiled H3K27ac mark positively correlated with gene expression confirming the specificity and high quality of the antibody used (Fig. <xref rid="Fig5" ref-type="fig">5</xref>A). Surprisingly however, in the shSpi1-A2B cells the highly expressed genes (Fig. <xref rid="Fig5" ref-type="fig">5</xref>B, red) showed a very high average density signal of H3K27me3 in gene immediate downstream region (up to 1 kb downstream TSS). This increase was also seen at some extent for the medium- and low-expressed genes and was likely to be linked to a non-specific binding of the antibody ACM39155 targeting H3K27 methylation we used for this experiment. Indeed, a recent study of antibody specificities showed that, in addition to the targeted repressive mark H3K27me3, the Active Motif antibody 39155 could also bind to several activator marks such as acetylated lysines [<xref ref-type="bibr" rid="CR20">20</xref>]. This example demonstrated the utility of CHIPIN in assessing antibody specificities and in evaluating quality of a ChIP-seq data set.</p>
    </sec>
  </sec>
  <sec id="Sec15">
    <title>Discussion</title>
    <p id="Par41">We provide a new R package, CHIPIN, for inter-sample or inter-condition normalization of ChIP-seq density signals, which is a mandatory step to enable comparison of transcription factor or histone mark binding intensities across biological conditions. We provide two choices of normalization methods: linear regression with non-zero intercept and quantile normalization. Both methods are more efficient than other published normalization approaches we tested (Figs. <xref rid="Fig2" ref-type="fig">2</xref>, <xref rid="Fig3" ref-type="fig">3</xref>, <xref rid="Fig4" ref-type="fig">4</xref>).</p>
    <p id="Par42">CHIPIN uses as input .bigWig files that are generated by the majority of peak callers. However, in our validation study we gave preference to the HMCan software [<xref ref-type="bibr" rid="CR11">11</xref>]. Indeed, HMCan is a peak-caller that corrects for the GC-content and copy number biases and removes the background signal if an Input experiment is provided. The use of HMCan is strongly recommended for the comparison of cancer samples with differences in the copy number aberration profiles.</p>
    <p id="Par43">Our method was initially developed for ChIP-seq data and it can be used without any limitation to other density profiles such as those constructed for ATAC-seq or DNase hypersensitivity data. Recently, a study by Reske et al. [<xref ref-type="bibr" rid="CR21">21</xref>] demonstrated that the choice of the normalization method for the comparison of chromatin accessibility in different regions, from ATAC-seq experiments, was of crucial importance in helping avoid false biological interpretations. As it has been reported that promoter accessibility positively correlates with gene expression [<xref ref-type="bibr" rid="CR22">22</xref>], using genes whose expression is constant across conditions/samples, as implemented in CHIPIN, represents an appropriate solution for normalizing ATAC-seq data.</p>
    <p id="Par44">Of note, our method should not be used when the targeted protein is overexpressed or silenced in one of the samples/conditions. Instead, spike-in protocols should be employed, followed by a normalization with an appropriate method accounting for spike-in information, <italic>e</italic>.<italic>g</italic>., HMCan-diff [<xref ref-type="bibr" rid="CR16">16</xref>], to determine differentially enriched regions.</p>
    <p id="Par45">Here, we used two data sets to compare CHIPIN with other available normalization methods. For the second data set, profiling H3K27ac in the shSpi1-A2B cell line in two conditions, two replicates were available for each condition. For the validation of our method, we chose replicate 1 for the first condition and replicate 2 for the second condition to have a stronger batch effect. In this comparison, CHIPIN outperformed the other methods (Figs. <xref rid="Fig3" ref-type="fig">3</xref>, <xref rid="Fig4" ref-type="fig">4</xref>; Tables <xref rid="Tab1" ref-type="table">1</xref>, <xref rid="Tab2" ref-type="table">2</xref>). However, we also assessed the performance of CHIPIN in the setting where we were normalizing ChIP-seq density profiles obtained within the same replicate/batch (Fig. <xref rid="Fig3" ref-type="fig">3</xref>A, <xref rid="Fig4" ref-type="fig">4</xref>A, Additional file <xref rid="MOESM4" ref-type="media">4</xref>: Figure S4 and Additional file <xref rid="MOESM5" ref-type="media">5</xref>: Table S1). Importantly, in this case as well, CHIPIN outperformed the other normalization methods. It could be however seen that the normalization to the same number of reads also provided almost perfect results (Additional file <xref rid="MOESM5" ref-type="media">5</xref>: Table S1, Additional file <xref rid="MOESM4" ref-type="media">4</xref>: Figure S4). This analysis demonstrated the importance of inter-sample normalization when comparing different replicates, while the normalization to the same number of reads could be applied on experiments performed within the same batch.</p>
  </sec>
  <sec id="Sec16">
    <title>Conclusions</title>
    <p id="Par46">Here, we present a novel method for the inter-condition normalization of ChIP-seq data when spike-in data are not available. The method is based on the assumption that, on average, protein binding in regulatory regions of genes stably expressed or silent across the conditions is also constant across the conditions. We provide a choice of normalization parameters and options. In particular, the user can choose between a linear normalization with a non-zero intercept and quantile normalization. The method is implemented in a user-friendly R package available on GitHub: <ext-link ext-link-type="uri" xlink:href="https://github.com/BoevaLab/CHIPIN">https://github.com/BoevaLab/CHIPIN</ext-link>. Several examples are presented in the GitHub vignette and test data are provided.</p>
  </sec>
  <sec id="Sec17">
    <title>Availability and requirements</title>
    <p id="Par47">Project name: CHIPIN</p>
    <p id="Par48">Project home page: <ext-link ext-link-type="uri" xlink:href="https://github.com/BoevaLab/CHIPIN">https://github.com/BoevaLab/CHIPIN</ext-link></p>
    <p id="Par49">Operating system(s): Linux</p>
    <p id="Par50">Programming language: R</p>
    <p id="Par51">Other requirements: deepTools</p>
    <p id="Par52">License: GNU GPL</p>
    <p id="Par53">Any restrictions to use by non-academics: no restriction</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Information</title>
    <sec id="Sec18">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="12859_2021_4320_MOESM1_ESM.pdf">
            <caption>
              <p><bold>Additional file 1: Figure S1.</bold> ChIP-seq density profiles for selected transcription factors in the K562 cell line as a function of gene expression. ENCODE data sets used: ENCSR492FKD (ZNF257), ENCSR271RRH (ZNF253), ENCSR121SPB (KLF10), ENCSR844JVU (TCFL5), ENCSR946BXO (BRCA1), ENCSR153HNT (STAG1), ENCSR549PVK (PATZ1), ENCSR017EJY (DLX4). Gene expression was assessed an average across two replicates: ENCFF928NYA and ENCFF003XKT [<xref ref-type="bibr" rid="CR23">23</xref>].</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="12859_2021_4320_MOESM2_ESM.png">
            <caption>
              <p><bold>Additional file 2: Figure S2</bold>. Gene group definition of the quantile normalization. The quantile normalization is performed on the concatenated binding intensities averaged over <italic>k</italic> groups of genes (default <italic>k</italic> = 20); gene groups are defined based on the strength of the overall binding signal (averaged across all samples), so that each gene group corresponds to the specific ChIP-seq signal intensity: from the lowest (group 1) to the highest (group <italic>k</italic>). To obtain gene groups, we concatenate matrices with ChIP-seq density values (built by deepTools) over all samples (<bold>A</bold>, two samples are shown), compute the average values of signal intensity across bins and samples for each gene (<bold>B</bold>), sort genes according to the overall average intensity values (<bold>C</bold>), and then build <italic>k</italic> gene groups by splitting the whole set of genes (<bold>D</bold>) so that each gene group represents a certain range of ChIP-seq intensity signal.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM3">
          <media xlink:href="12859_2021_4320_MOESM3_ESM.pdf">
            <caption>
              <p><bold>Additional file 3: Figure S3.</bold> Linear regression fit between gene expression in the Spi1++ condition and H3K27ac densities. Gene expression was evaluated in FPKM, and ChIP-seq H3K27ac maximal density corresponds to the maximal density in the 2 Kb window surrounding gene TSS averaged between Replicate 1 and 2. The ChIP-seq signal was normalized for the CG-content, copy number bias and background noise by HMCan [<xref ref-type="bibr" rid="CR11">11</xref>].</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM4">
          <media xlink:href="12859_2021_4320_MOESM4_ESM.pdf">
            <caption>
              <p><bold>Additional file 4: Figure S4.</bold> Comparison of normalization efficiency by CHIPIN and the three other methods in genomic regions corresponding to differentially expressed genes in the shSpi1-A2B cells (replicate 1 is used for both conditions). Antibody: ab4729 (Abcam) against H3K27ac; <bold>A</bold> H3K27ac density profiles around TSSs of genes down- and up-regulated by Spi1 in two conditions: “Spi1++ ”—Spi1 overexpressed, “Spi1−”—Spi1 repressed. <bold>B</bold> Differences in H3K27ac signal in zones 1–3 (Fig. <xref rid="Fig1" ref-type="fig">1</xref>E) in gene promoters for genes up- and down-regulated by Spi1; axes show differences between density values in conditions Spi1++ and Spi1−. Correct normalization procedures would result in observations laying close to the diagonal (<inline-formula id="IEq15"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$y = x$$\end{document}</tex-math><mml:math id="M36"><mml:mrow><mml:mi>y</mml:mi><mml:mo>=</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4320_Article_IEq15.gif"/></alternatives></inline-formula>, grey dotted line).</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM5">
          <media xlink:href="12859_2021_4320_MOESM5_ESM.docx">
            <caption>
              <p><bold>Additional file 5: Table S1.</bold> Percentage difference between H3K27ac density curves (Fig. <xref rid="Fig3" ref-type="fig">3</xref>A) in the three zones surrounding TSSs of “constant genes” (Fig. <xref rid="Fig1" ref-type="fig">1</xref>E).</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>ChIP-seq</term>
        <def>
          <p id="Par4">Chromatin immunoprecipitation followed by sequencing</p>
        </def>
      </def-item>
      <def-item>
        <term>CPM</term>
        <def>
          <p id="Par5">Count Per Million</p>
        </def>
      </def-item>
      <def-item>
        <term>FPKM</term>
        <def>
          <p id="Par6">Fragments Per Kilobase per Million mapped reads</p>
        </def>
      </def-item>
      <def-item>
        <term>TPM</term>
        <def>
          <p id="Par7">Transcripts Per Kilobase Million reads</p>
        </def>
      </def-item>
      <def-item>
        <term>TSS</term>
        <def>
          <p id="Par8">Transcription Start Site</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher's Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>We thank Guillaume Assié and Jérôme Bertherat for providing adrenocortical carcinoma tumor samples for method validation in Fig. <xref rid="Fig2" ref-type="fig">2</xref>.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors' contributions</title>
    <p>LP developed the method, conducted the analysis and drafted the manuscript. VB guided the analysis and revised the manuscript. GK, SG, ME and CG generated the data. All authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>This work was funded through institutional support from Centre National de la Recherche Scientifique, Institut National de la Santé et de la Recherche Médicale, ATIP-Avenir, the ARC Foundation [ARC-RAC16002KSA-R15093KS], and the “Who Am I?” Laboratory of Excellence ANR-11-LABX-0071, funded by the French Government through its Investissement d′Avenir program, operated by the French National Research Agency [ANR-11-IDEX-0005-02] to V.B. (salary, data generation, infrastructure); the SIRIC CARPEM [No. INCA-DGOS-INSERM_12561] to G.K. (salary); l’Institut National du Cancer [20141PLBIO06-1] to C.G., M.E. (data generation); Institut Thématique Multi-Organisme-cancer [C13104L] to C.G (data generation); Ministère de l’Enseignement Supérieur to S.G; Région Ile-de-France [ARDoC, N° 17012698] to L.P. (salary).</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>The code of CHIPIN, examples and readme are available at <ext-link ext-link-type="uri" xlink:href="https://github.com/BoevaLab/CHIPIN">https://github.com/BoevaLab/CHIPIN</ext-link>. Unpublished ChIP-seq data sets used in this study are available upon the request.</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar1">
      <title>Ethics approval and consent to participate</title>
      <p id="Par54">Not applicable.</p>
    </notes>
    <notes id="FPar2">
      <title>Consent for publication</title>
      <p id="Par55">Not applicable.</p>
    </notes>
    <notes id="FPar3" notes-type="COI-statement">
      <title>Competing interests</title>
      <p id="Par56">The authors declare that they have no competing interests.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kouzarides</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Chromatin modifications and their function</article-title>
        <source>Cell</source>
        <year>2007</year>
        <volume>128</volume>
        <fpage>693</fpage>
        <lpage>705</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2007.02.005</pub-id>
        <pub-id pub-id-type="pmid">17320507</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>K</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The overlooked fact: fundamental need for spike-in control for virtually all genome-wide analyses</article-title>
        <source>Mol Cell Biol</source>
        <year>2016</year>
        <volume>36</volume>
        <fpage>662</fpage>
        <lpage>667</lpage>
        <pub-id pub-id-type="doi">10.1128/MCB.00970-14</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ramírez</surname>
            <given-names>F</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>deepTools2: a next generation web server for deep-sequencing data analysis</article-title>
        <source>Nucleic Acids Res</source>
        <year>2016</year>
        <volume>44</volume>
        <fpage>W160</fpage>
        <lpage>165</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkw257</pub-id>
        <pub-id pub-id-type="pmid">27079975</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liang</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Keleş</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Normalization of ChIP-seq data with control</article-title>
        <source>BMC Bioinformatics</source>
        <year>2012</year>
        <volume>13</volume>
        <fpage>199</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-13-199</pub-id>
        <pub-id pub-id-type="pmid">22883957</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ji</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>An integrated software system for analyzing ChIP-chip and ChIP-seq data</article-title>
        <source>Nat Biotechnol</source>
        <year>2008</year>
        <volume>26</volume>
        <fpage>1293</fpage>
        <lpage>1300</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.1505</pub-id>
        <pub-id pub-id-type="pmid">18978777</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jin</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>ChIPseqSpikeInFree: a ChIP-seq normalization approach to reveal global changes in histone modifications without spike-in</article-title>
        <source>Bioinformatics</source>
        <year>2020</year>
        <volume>36</volume>
        <fpage>1270</fpage>
        <lpage>1272</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btz720</pub-id>
        <pub-id pub-id-type="pmid">31566663</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nair</surname>
            <given-names>NU</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>ChIPnorm: a statistical method for normalizing and identifying differential regions in histone modification ChIP-seq libraries</article-title>
        <source>PLoS ONE</source>
        <year>2012</year>
        <volume>7</volume>
        <fpage>e39573</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0039573</pub-id>
        <pub-id pub-id-type="pmid">22870189</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Taslim</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Comparative Study on ChIP-seq data: normalization and binding pattern characterization</article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>25</volume>
        <fpage>2334</fpage>
        <lpage>2340</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btp384</pub-id>
        <pub-id pub-id-type="pmid">19561022</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>Y</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Model-based analysis of ChIP-Seq (MACS)</article-title>
        <source>Genome Biol</source>
        <year>2008</year>
        <volume>9</volume>
        <fpage>R137</fpage>
        <pub-id pub-id-type="doi">10.1186/gb-2008-9-9-r137</pub-id>
        <pub-id pub-id-type="pmid">18798982</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Boeva</surname>
            <given-names>V</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Heterogeneity of neuroblastoma cell identity defined by transcriptional circuitries</article-title>
        <source>Nat Genet</source>
        <year>2017</year>
        <volume>49</volume>
        <fpage>1408</fpage>
        <lpage>1413</lpage>
        <pub-id pub-id-type="doi">10.1038/ng.3921</pub-id>
        <pub-id pub-id-type="pmid">28740262</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ashoor</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>HMCan: a method for detecting chromatin modifications in cancer samples using ChIP-seq data</article-title>
        <source>Bioinformatics</source>
        <year>2013</year>
        <volume>29</volume>
        <fpage>2979</fpage>
        <lpage>2986</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btt524</pub-id>
        <pub-id pub-id-type="pmid">24021381</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Barski</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>High-resolution profiling of histone methylations in the human genome</article-title>
        <source>Cell</source>
        <year>2007</year>
        <volume>129</volume>
        <fpage>823</fpage>
        <lpage>837</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2007.05.009</pub-id>
        <pub-id pub-id-type="pmid">17512414</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Guillon</surname>
            <given-names>N</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The Oncogenic EWS-FLI1 Protein Binds In Vivo GGAA Microsatellite Sequences with Potential Transcriptional Activation Function</article-title>
        <source>PLoS ONE</source>
        <year>2009</year>
        <volume>4</volume>
        <fpage>e4932</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0004932</pub-id>
        <pub-id pub-id-type="pmid">19305498</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Karlić</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Histone modification levels are predictive for gene expression</article-title>
        <source>Proc Natl Acad Sci</source>
        <year>2010</year>
        <volume>107</volume>
        <fpage>2926</fpage>
        <lpage>2931</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.0909344107</pub-id>
        <pub-id pub-id-type="pmid">20133639</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ridinger-Saison</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Spi-1/PU.1 activates transcription through clustered DNA occupancy in erythroleukemia</article-title>
        <source>Nucleic Acids Res</source>
        <year>2012</year>
        <volume>40</volume>
        <fpage>8927</fpage>
        <lpage>8941</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gks659</pub-id>
        <pub-id pub-id-type="pmid">22790984</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ashoor</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>HMCan-diff: a method to detect changes in histone modifications in cells with different genetic characteristics</article-title>
        <source>Nucleic Acids Res</source>
        <year>2017</year>
        <volume>45</volume>
        <fpage>e58</fpage>
        <lpage>e58</lpage>
        <?supplied-pmid 28053124?>
        <pub-id pub-id-type="pmid">28053124</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rimmelé</surname>
            <given-names>P</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Spi-1/PU.1 participates in erythroleukemogenesis by inhibiting apoptosis in cooperation with Epo signaling and by blocking erythroid differentiation</article-title>
        <source>Blood</source>
        <year>2007</year>
        <volume>109</volume>
        <fpage>3007</fpage>
        <lpage>3014</lpage>
        <pub-id pub-id-type="doi">10.1182/blood-2006-03-006718</pub-id>
        <pub-id pub-id-type="pmid">17132716</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nie</surname>
            <given-names>Y</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The patterns of histone modifications in the vicinity of transcription factor binding sites in human lymphoblastoid cell lines</article-title>
        <source>PLoS ONE</source>
        <year>2013</year>
        <volume>8</volume>
        <fpage>e60002</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0060002</pub-id>
        <pub-id pub-id-type="pmid">23527292</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Young</surname>
            <given-names>MD</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>ChIP-seq analysis reveals distinct H3K27me3 profiles that correlate with transcriptional activity</article-title>
        <source>Nucleic Acids Res</source>
        <year>2011</year>
        <volume>39</volume>
        <fpage>7415</fpage>
        <lpage>7427</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkr416</pub-id>
        <pub-id pub-id-type="pmid">21652639</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rothbart</surname>
            <given-names>SB</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>An interactive database for the assessment of histone antibody specificity</article-title>
        <source>Mol Cell</source>
        <year>2015</year>
        <volume>59</volume>
        <fpage>502</fpage>
        <lpage>511</lpage>
        <pub-id pub-id-type="doi">10.1016/j.molcel.2015.06.022</pub-id>
        <pub-id pub-id-type="pmid">26212453</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Reske</surname>
            <given-names>JJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>ATAC-seq normalization method can significantly affect differential accessibility analysis and interpretation</article-title>
        <source>Epigenetics Chromatin</source>
        <year>2020</year>
        <volume>13</volume>
        <fpage>22</fpage>
        <pub-id pub-id-type="doi">10.1186/s13072-020-00342-y</pub-id>
        <pub-id pub-id-type="pmid">32321567</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cao</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Joint profiling of chromatin accessibility and gene expression in thousands of single cells</article-title>
        <source>Science</source>
        <year>2018</year>
        <volume>361</volume>
        <fpage>1380</fpage>
        <lpage>1385</lpage>
        <pub-id pub-id-type="doi">10.1126/science.aau0730</pub-id>
        <pub-id pub-id-type="pmid">30166440</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Davis</surname>
            <given-names>CA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The encyclopedia of DNA elements (ENCODE): data portal update</article-title>
        <source>Nucleic Acids Res</source>
        <year>2018</year>
        <volume>46</volume>
        <fpage>D794</fpage>
        <lpage>D801</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkx1081</pub-id>
        <pub-id pub-id-type="pmid">29126249</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
