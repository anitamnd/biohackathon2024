<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10576641</article-id>
    <article-id pub-id-type="pmid">37725369</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btad579</article-id>
    <article-id pub-id-type="publisher-id">btad579</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Paper</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Sequence Analysis</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>pLM-BLAST: distant homology detection based on direct comparison of sequence representations from protein language models</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Kaminski</surname>
          <given-names>Kamil</given-names>
        </name>
        <aff><institution>Institute of Evolutionary Biology, Faculty of Biology, Biological and Chemical Research Centre, University of Warsaw</institution>, Warsaw 02-089, <country country="PL">Poland</country></aff>
        <aff><institution>Laboratory of Structural Bioinformatics, Centre of New Technologies, University of Warsaw</institution>, Warsaw 02-097, <country country="PL">Poland</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-3487-5433</contrib-id>
        <name>
          <surname>Ludwiczak</surname>
          <given-names>Jan</given-names>
        </name>
        <aff><institution>Institute of Evolutionary Biology, Faculty of Biology, Biological and Chemical Research Centre, University of Warsaw</institution>, Warsaw 02-089, <country country="PL">Poland</country></aff>
        <xref rid="btad579-FM1" ref-type="author-notes"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Pawlicki</surname>
          <given-names>Kamil</given-names>
        </name>
        <aff><institution>Institute of Evolutionary Biology, Faculty of Biology, Biological and Chemical Research Centre, University of Warsaw</institution>, Warsaw 02-089, <country country="PL">Poland</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-1188-473X</contrib-id>
        <name>
          <surname>Alva</surname>
          <given-names>Vikram</given-names>
        </name>
        <aff><institution>Department of Protein Evolution, Max Planck Institute for Biology Tübingen</institution>, Tübingen 72076, <country country="DE">Germany</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-4581-1558</contrib-id>
        <name>
          <surname>Dunin-Horkawicz</surname>
          <given-names>Stanislaw</given-names>
        </name>
        <aff><institution>Institute of Evolutionary Biology, Faculty of Biology, Biological and Chemical Research Centre, University of Warsaw</institution>, Warsaw 02-089, <country country="PL">Poland</country></aff>
        <aff><institution>Department of Protein Evolution, Max Planck Institute for Biology Tübingen</institution>, Tübingen 72076, <country country="DE">Germany</country></aff>
        <!--stanislaw.dunin-horkawicz@tuebingen.mpg.de-->
        <xref rid="btad579-cor1" ref-type="corresp"/>
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Cowen</surname>
          <given-names>Lenore</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <fn id="btad579-FM1">
        <p>Present address: Prescient Design, Genentech Research &amp; Early Development, Roche Group, Grenzacherstrasse 124, 4070 Basel, Switzerland.</p>
      </fn>
      <corresp id="btad579-cor1">Corresponding author. Institute of Evolutionary Biology, Faculty of Biology, Biological and Chemical Research Centre, University of Warsaw, Zwirki i Wigury 101, Warsaw 02-089, Poland; Department of Protein Evolution, Max Planck Institute for Biology Tübingen, Tübingen 72076, Germany. E-mail: <email>stanislaw.dunin-horkawicz@tuebingen.mpg.de</email> (S.D.-H.)</corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>10</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2023-09-19">
      <day>19</day>
      <month>9</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>19</day>
      <month>9</month>
      <year>2023</year>
    </pub-date>
    <volume>39</volume>
    <issue>10</issue>
    <elocation-id>btad579</elocation-id>
    <history>
      <date date-type="received">
        <day>27</day>
        <month>11</month>
        <year>2022</year>
      </date>
      <date date-type="rev-recd">
        <day>09</day>
        <month>7</month>
        <year>2023</year>
      </date>
      <date date-type="editorial-decision">
        <day>20</day>
        <month>8</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>15</day>
        <month>9</month>
        <year>2023</year>
      </date>
      <date date-type="corrected-typeset">
        <day>14</day>
        <month>10</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2023</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btad579.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>The detection of homology through sequence comparison is a typical first step in the study of protein function and evolution. In this work, we explore the applicability of protein language models to this task.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>We introduce pLM-BLAST, a tool inspired by BLAST, that detects distant homology by comparing single-sequence representations (embeddings) derived from a protein language model, ProtT5. Our benchmarks reveal that pLM-BLAST maintains a level of accuracy on par with HHsearch for both highly similar sequences (with &gt;50% identity) and markedly divergent sequences (with &lt;30% identity), while being significantly faster. Additionally, pLM-BLAST stands out among other embedding-based tools due to its ability to compute local alignments. We show that these local alignments, produced by pLM-BLAST, often connect highly divergent proteins, thereby highlighting its potential to uncover previously undiscovered homologous relationships and improve protein annotation.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>pLM-BLAST is accessible via the MPI Bioinformatics Toolkit as a web server for searching precomputed databases (<ext-link xlink:href="https://toolkit.tuebingen.mpg.de/tools/plmblast" ext-link-type="uri">https://toolkit.tuebingen.mpg.de/tools/plmblast</ext-link>). It is also available as a standalone tool for building custom databases and performing batch searches (<ext-link xlink:href="https://github.com/labstructbioinf/pLM-BLAST" ext-link-type="uri">https://github.com/labstructbioinf/pLM-BLAST</ext-link>).</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Foundation for Polish Science</institution>
            <institution-id institution-id-type="DOI">10.13039/501100001870</institution-id>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>European Regional Development Fund</institution>
            <institution-id institution-id-type="DOI">10.13039/501100008530</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>POIR.04.04.00-00-5CF1/18-00</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Max Planck Society</institution>
            <institution-id institution-id-type="DOI">10.13039/501100004189</institution-id>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="9"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1. Introduction</title>
    <p>Homology, i.e. descent from a common ancestor, and its inference are fundamental to comparative, evolutionary, and molecular biology. In the case of proteins, statistically significant local or global sequence similarity is accepted as the primary marker for inferring homology. When the similarity between the protein sequences being compared is high (<inline-formula id="IE1"><mml:math id="IM1" display="inline" overflow="scroll"><mml:mrow><mml:mo>≥</mml:mo><mml:mn>30</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math></inline-formula>), homology can be readily detected using methods based on sequence-to-sequence and sequence-to-profile comparisons such as BLAST or PSI-BLAST (<xref rid="btad579-B1" ref-type="bibr">Altschul <italic toggle="yes">et al.</italic> 1997</xref>). However, when similarity is low (<inline-formula id="IE2"><mml:math id="IM2" display="inline" overflow="scroll"><mml:mrow><mml:mo>&lt;</mml:mo><mml:mn>30</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math></inline-formula>), methods based on profile HMMs, such as HMMER and HHsearch, are currently our best tools to infer homology (<xref rid="btad579-B10" ref-type="bibr">Eddy 2011</xref>, <xref rid="btad579-B31" ref-type="bibr">Steinegger <italic toggle="yes">et al.</italic> 2019</xref>).</p>
    <p>In the case of highly distant evolutionary relationships, sequences may have diverged to the point where we can no longer detect their relatedness. Because structures diverge much more slowly than sequences, their similarity is often used to infer homology in such cases. In fact, owing to the recent revolution in structure prediction (<xref rid="btad579-B16" ref-type="bibr">Jumper <italic toggle="yes">et al.</italic> 2021</xref>, <xref rid="btad579-B21" ref-type="bibr">Lin <italic toggle="yes">et al.</italic> 2022, 2023</xref>), predicted structures are available for a large proportion of known proteins, and structural similarity is increasingly being used to infer homology. However, similar structures, particularly at the domain and subdomain levels, may have evolved convergently due to the limited number of structural solutions available to a folded polypeptide chain, and thus structural similarity is often not conclusive evidence of common ancestry. To address this issue, several deep learning-based methods have sought to detect weak sequence signals between highly divergent proteins in recent years (<xref rid="btad579-B19" ref-type="bibr">Li <italic toggle="yes">et al.</italic> 2017</xref>, <xref rid="btad579-B35" ref-type="bibr">Zheng <italic toggle="yes">et al.</italic> 2019</xref>, <xref rid="btad579-B12" ref-type="bibr">Gao and Skolnick 2021</xref>). The most promising of these methods, such as knnProtT5 (<xref rid="btad579-B29" ref-type="bibr">Schütze <italic toggle="yes">et al.</italic> 2022</xref>), EBA (<xref rid="btad579-B27" ref-type="bibr">Pantolini <italic toggle="yes">et al.</italic> 2022</xref>), TM-Vec (<xref rid="btad579-B14" ref-type="bibr">Hamamsy <italic toggle="yes">et al.</italic> 2022</xref>), DeepBLAST (<xref rid="btad579-B25" ref-type="bibr">Morton <italic toggle="yes">et al.</italic> 2023</xref>), and DEDAL (<xref rid="btad579-B22" ref-type="bibr">Llinares-López <italic toggle="yes">et al.</italic> 2023</xref>), rely on single-sequence representations obtained from protein language models (pLMs) (<xref rid="btad579-B4" ref-type="bibr">Bepler and Berger 2021</xref>). pLMs are neural networks trained in a self-supervised manner on a large number of natural protein sequences, i.e. with tasks such as guessing masked residues based on contextual information (<xref rid="btad579-B11" ref-type="bibr">Elnaggar <italic toggle="yes">et al.</italic> 2022</xref>, <xref rid="btad579-B21" ref-type="bibr">Lin <italic toggle="yes">et al.</italic> 2023</xref>). Once trained, pLMs can be used to rapidly compute the aforementioned representations (also referred to as embeddings), i.e. numerical descriptors of protein sequences that place them in the context of the total knowledge collected by the network. Because of their high information content, sequence embeddings have been successfully applied to many other tasks, including prediction of tertiary structures (<xref rid="btad579-B21" ref-type="bibr">Lin <italic toggle="yes">et al.</italic> 2023</xref>), transmembrane segments (<xref rid="btad579-B5" ref-type="bibr">Bernhofer and Rost 2022</xref>), and signal peptides (<xref rid="btad579-B33" ref-type="bibr">Teufel <italic toggle="yes">et al.</italic> 2022</xref>).</p>
    <p>In this article, we describe pLM-BLAST, a new tool for detecting local homology between protein sequences that combines pLM representations with a local similarity detection algorithm inspired by BLAST (<xref rid="btad579-B1" ref-type="bibr">Altschul <italic toggle="yes">et al.</italic> 1997</xref>). In contrast to TM-vec and DEDAL, pLM-BLAST is based on an unsupervised approach that does not require training of a specialized deep-learning model or defining positive labels based on structurally similar or homologous protein pairs. Furthermore, unlike methods such as TM-vec and EBA, which only provide global alignments, pLM-BLAST has the ability to compute both local and global alignments, which is essential for determining distant homology relationships that may depend on the conservation of short subdomain fragments (<xref rid="btad579-B2" ref-type="bibr">Alva <italic toggle="yes">et al.</italic> 2015</xref>, <xref rid="btad579-B18" ref-type="bibr">Kolodny <italic toggle="yes">et al.</italic> 2021</xref>). pLM-BLAST is based on an implementation of a modified Smith-Waterman algorithm, in which the substitution matrix is generated directly from the raw pLM representations of the two sequences to be compared. In this work, we used the pLM ProtT5 (<xref rid="btad579-B11" ref-type="bibr">Elnaggar <italic toggle="yes">et al.</italic> 2022</xref>), but this approach can be used in conjunction with other pLMs to generate local and global alignments. In benchmarks using domain pairs from the ECOD protein classification database (<xref rid="btad579-B9" ref-type="bibr">Cheng <italic toggle="yes">et al.</italic> 2014</xref>), pLM-BLAST demonstrated its suitability for fast pairwise comparisons and database searches to detect distant homology and produce highly precise alignments.</p>
  </sec>
  <sec>
    <title>2. Materials and methods</title>
    <p>pLM-BLAST extends the concept of BLAST by replacing invariant substitution matrices, such as BLOSUM62 (<xref rid="btad579-B15" ref-type="bibr">Henikoff and Henikoff 1992</xref>), with per-residue similarities between protein embeddings. Consequently, the similarity between a given pair of residues is entirely context-dependent. Such sequence context information has been shown to significantly improve the sensitivity of sequence search methods and enable the detection of nontrivial conserved patterns (<xref rid="btad579-B6" ref-type="bibr">Biegert and Söding 2009</xref>, <xref rid="btad579-B28" ref-type="bibr">Remmert <italic toggle="yes">et al.</italic> 2011</xref>). The workflow of the method is shown subsequently and in <xref rid="btad579-F1" ref-type="fig">Fig. 1</xref>.</p>
    <fig position="float" id="btad579-F1">
      <label>Figure 1.</label>
      <caption>
        <p>(A) Embeddings for the two sequences to be aligned. The <italic toggle="yes">y</italic>-axis represents the sequence dimension from N- to C-terminus, and the <italic toggle="yes">x</italic>-axis represents the embedding dimension (which is a 1024-element vector in the case of the ProtT5 protein language model). The substitution matrix is computed by matrix multiplication of both embeddings, after each residue has been normalized. (B) The scoring matrix is computed to detect continuous high-scoring regions in the substitution matrix. (C) A modified traceback procedure is used to traverse the scoring matrix to extract potentially matching regions, called paths. (D) The possible paths are mapped back onto the substitution matrix, and a moving window of defined length is used to extract high-scoring subpaths, i.e. local alignments.</p>
      </caption>
      <graphic xlink:href="btad579f1" position="float"/>
    </fig>
    <sec>
      <title>2.1 Substitution matrix</title>
      <p>The embedding of a sequence <inline-formula id="IE3"><mml:math id="IM3" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mtext>seq</mml:mtext></mml:mrow></mml:mrow><mml:mi>l</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> is given by a matrix <inline-formula id="IE4"><mml:math id="IM4" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mi>l</mml:mi></mml:msub></mml:mrow><mml:mo> </mml:mo><mml:mo>∋</mml:mo><mml:mo> </mml:mo><mml:mo>{</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula> of size <inline-formula id="IE5"><mml:math id="IM5" display="inline" overflow="scroll"><mml:mrow><mml:mi>n</mml:mi><mml:mo>×</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:math></inline-formula>, where <italic toggle="yes">n</italic> and <italic toggle="yes">m</italic> denote the number of residues and the size of the embedding, respectively. To obtain standardized and comparable results, the values for each residue embedding are normalized by dividing them by the Euclidean norm of the row</p>
      <disp-formula id="E1">
        <label>(1)</label>
        <mml:math id="M1" display="block" overflow="scroll">
          <mml:mrow>
            <mml:mrow>
              <mml:msubsup>
                <mml:mrow>
                  <mml:mi>e</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>i</mml:mi>
                  <mml:mi>j</mml:mi>
                </mml:mrow>
                <mml:mo>†</mml:mo>
              </mml:msubsup>
            </mml:mrow>
            <mml:mo>=</mml:mo>
            <mml:mrow>
              <mml:mfrac>
                <mml:mn>1</mml:mn>
                <mml:mrow>
                  <mml:msqrt>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:munderover>
                          <mml:mo>∑</mml:mo>
                          <mml:mrow>
                            <mml:mi>j</mml:mi>
                            <mml:mo>=</mml:mo>
                            <mml:mi>m</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>j</mml:mi>
                            <mml:mo>=</mml:mo>
                            <mml:mn>0</mml:mn>
                          </mml:mrow>
                        </mml:munderover>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mrow>
                          <mml:msubsup>
                            <mml:mrow>
                              <mml:mi>e</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>i</mml:mi>
                              <mml:mi>j</mml:mi>
                            </mml:mrow>
                            <mml:mn>2</mml:mn>
                          </mml:msubsup>
                        </mml:mrow>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:msqrt>
                </mml:mrow>
              </mml:mfrac>
            </mml:mrow>
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mi>e</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>i</mml:mi>
                  <mml:mi>j</mml:mi>
                </mml:mrow>
              </mml:msub>
            </mml:mrow>
          </mml:mrow>
          <mml:mo>,</mml:mo>
        </mml:math>
      </disp-formula>
      <p>where <inline-formula id="IE6"><mml:math id="IM6" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> denotes the <inline-formula id="IE7"><mml:math id="IM7" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mi>l</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> matrix element in the <italic toggle="yes">i</italic>-th row and <italic toggle="yes">j</italic>-th column, and <inline-formula id="IE8"><mml:math id="IM8" display="inline" overflow="scroll"><mml:mo>†</mml:mo></mml:math></inline-formula> is the normalization operator. In pLM-BLAST, a substitution matrix <inline-formula id="IE9"><mml:math id="IM9" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> (<xref rid="btad579-F1" ref-type="fig">Fig. 1A</xref>) for two sequences <inline-formula id="IE10"><mml:math id="IM10" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mtext>seq</mml:mtext></mml:mrow></mml:mrow><mml:mi>l</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE11"><mml:math id="IM11" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mtext>seq</mml:mtext></mml:mrow></mml:mrow><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> is calculated as</p>
      <disp-formula id="E2">
        <label>(2)</label>
        <mml:math id="M2" display="block" overflow="scroll">
          <mml:mrow>
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mi>S</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>l</mml:mi>
                  <mml:mi>k</mml:mi>
                </mml:mrow>
              </mml:msub>
            </mml:mrow>
            <mml:mo>=</mml:mo>
            <mml:mrow>
              <mml:msubsup>
                <mml:mrow>
                  <mml:mi>E</mml:mi>
                </mml:mrow>
                <mml:mi>l</mml:mi>
                <mml:mrow>
                  <mml:mo>†</mml:mo>
                  <mml:mi>T</mml:mi>
                </mml:mrow>
              </mml:msubsup>
            </mml:mrow>
            <mml:mrow>
              <mml:msubsup>
                <mml:mrow>
                  <mml:mi>E</mml:mi>
                </mml:mrow>
                <mml:mi>k</mml:mi>
                <mml:mo>†</mml:mo>
              </mml:msubsup>
            </mml:mrow>
          </mml:mrow>
          <mml:mo>.</mml:mo>
        </mml:math>
      </disp-formula>
      <p>The element <inline-formula id="IE12"><mml:math id="IM12" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> of the matrix <inline-formula id="IE13"><mml:math id="IM13" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> is in the interval <inline-formula id="IE14"><mml:math id="IM14" display="inline" overflow="scroll"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> and denotes the embedding similarity of the <italic toggle="yes">i</italic>-th residue of <inline-formula id="IE15"><mml:math id="IM15" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mtext>seq</mml:mtext></mml:mrow></mml:mrow><mml:mi>l</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> and the <italic toggle="yes">j</italic>-th residue of <inline-formula id="IE16"><mml:math id="IM16" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mtext>seq</mml:mtext></mml:mrow></mml:mrow><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>. This is equivalent to calculating the cosine similarity of each pair of residues from <inline-formula id="IE17"><mml:math id="IM17" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mtext>seq</mml:mtext></mml:mrow></mml:mrow><mml:mi>l</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE18"><mml:math id="IM18" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mtext>seq</mml:mtext></mml:mrow></mml:mrow><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> placing them in a 2D array indexed by the residues of each sequence.</p>
    </sec>
    <sec>
      <title>2.2 Scoring matrix</title>
      <p>To obtain local alignments, a scheme adapted from the Smith-Waterman algorithm is used to create a scoring matrix (<xref rid="btad579-F1" ref-type="fig">Fig. 1B</xref>) <inline-formula id="IE19"><mml:math id="IM19" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>L</mml:mi><mml:mi>K</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>∋</mml:mo><mml:mo>{</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula> of size <inline-formula id="IE20"><mml:math id="IM20" display="inline" overflow="scroll"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>|</mml:mo><mml:mi>L</mml:mi><mml:mo>|</mml:mo><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>×</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mo>|</mml:mo><mml:mi>K</mml:mi><mml:mo>|</mml:mo><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, where the first row and column are filled with zeros and the rest of the matrix is filled using the following procedure:</p>
      <disp-formula id="E3">
        <label>(3)</label>
        <mml:math id="M3" display="block" overflow="scroll">
          <mml:mrow>
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mi>h</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>i</mml:mi>
                  <mml:mi>j</mml:mi>
                </mml:mrow>
              </mml:msub>
            </mml:mrow>
            <mml:mo>=</mml:mo>
            <mml:mi>max</mml:mi>
            <mml:mrow>
              <mml:mo stretchy="true">{</mml:mo>
              <mml:mrow>
                <mml:mtable>
                  <mml:mtr columnalign="left">
                    <mml:mtd columnalign="left">
                      <mml:mrow>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>h</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>i</mml:mi>
                              <mml:mo>−</mml:mo>
                              <mml:mn>1</mml:mn>
                              <mml:mo>,</mml:mo>
                              <mml:mi>j</mml:mi>
                              <mml:mo>−</mml:mo>
                              <mml:mn>1</mml:mn>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mo>+</mml:mo>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>s</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>i</mml:mi>
                              <mml:mi>j</mml:mi>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                      </mml:mrow>
                    </mml:mtd>
                  </mml:mtr>
                  <mml:mtr columnalign="left">
                    <mml:mtd columnalign="left">
                      <mml:mrow>
                        <mml:mrow>
                          <mml:munder>
                            <mml:mrow>
                              <mml:mi>max</mml:mi>
                            </mml:mrow>
                            <mml:mi>p</mml:mi>
                          </mml:munder>
                        </mml:mrow>
                        <mml:mo>{</mml:mo>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>h</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>i</mml:mi>
                              <mml:mo>−</mml:mo>
                              <mml:mi>p</mml:mi>
                              <mml:mo>,</mml:mo>
                              <mml:mi>j</mml:mi>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mo>}</mml:mo>
                      </mml:mrow>
                    </mml:mtd>
                  </mml:mtr>
                  <mml:mtr columnalign="left">
                    <mml:mtd columnalign="left">
                      <mml:mrow>
                        <mml:mrow>
                          <mml:munder>
                            <mml:mrow>
                              <mml:mi>max</mml:mi>
                            </mml:mrow>
                            <mml:mi>s</mml:mi>
                          </mml:munder>
                        </mml:mrow>
                        <mml:mo>{</mml:mo>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>h</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>i</mml:mi>
                              <mml:mo>,</mml:mo>
                              <mml:mi>j</mml:mi>
                              <mml:mo>−</mml:mo>
                              <mml:mi>s</mml:mi>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mo>}</mml:mo>
                      </mml:mrow>
                    </mml:mtd>
                  </mml:mtr>
                </mml:mtable>
              </mml:mrow>
            </mml:mrow>
          </mml:mrow>
          <mml:mo>.</mml:mo>
        </mml:math>
      </disp-formula>
      <p>Unlike the original Smith–Waterman algorithm, pLM-BLAST does not use gap penalties because the <inline-formula id="IE21"><mml:math id="IM21" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> values for dissimilar regions are negative or close to zero due to the cosine similarity property. In addition, the above equation does not truncate the values to zero, which results in a more severe penalty for dissimilar regions, thus reducing the total number of potential alignments.</p>
    </sec>
    <sec>
      <title>2.3 Traceback procedure</title>
      <p>To identify possible matching regions for a given pair of sequences, a traceback procedure is used to traverse the scoring matrix (<xref rid="btad579-F1" ref-type="fig">Fig. 1C</xref>). Unlike the SW algorithm, we do not start with the highest value in the scoring matrix, but traverse from all sequence boundaries. Thus, in our approach, the traceback procedure does not produce a single alignment, but multiple candidates for possible alignments. For this purpose, <italic toggle="yes">n</italic> possible paths <italic toggle="yes">P</italic> are constructed, starting from the right and bottom edges of the matrix <italic toggle="yes">H</italic>. The path <inline-formula id="IE22"><mml:math id="IM22" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> is a set of coordinates from the matrix <inline-formula id="IE23"><mml:math id="IM23" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>L</mml:mi><mml:mi>K</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, where <inline-formula id="IE24"><mml:math id="IM24" display="inline" overflow="scroll"><mml:mrow><mml:mi>n</mml:mi><mml:mo>∈</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:math></inline-formula> and <italic toggle="yes">N</italic> equals <inline-formula id="IE25"><mml:math id="IM25" display="inline" overflow="scroll"><mml:mrow><mml:mo>|</mml:mo><mml:mi>L</mml:mi><mml:mo>|</mml:mo><mml:mo>+</mml:mo><mml:mo>|</mml:mo><mml:mi>K</mml:mi><mml:mo>|</mml:mo></mml:mrow></mml:math></inline-formula>.</p>
      <p>
        <boxed-text id="btad579-BOX1" position="float">
          <caption>
            <p>Algorithm 1 outputs set P</p>
          </caption>
          <p><bold>Require:</bold> <italic toggle="yes">H</italic></p>
          <p>1:  <bold>for</bold><inline-formula id="IE26"><mml:math id="IM26" display="inline" overflow="scroll"><mml:mrow><mml:mi>n</mml:mi><mml:mo>∈</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:math></inline-formula><bold>do</bold></p>
          <p>2:     Initialize <inline-formula id="IE27"><mml:math id="IM27" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> with an empty list</p>
          <p>3:    Set <inline-formula id="IE28"><mml:math id="IM28" display="inline" overflow="scroll"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mo>′</mml:mo></mml:msup></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mo>′</mml:mo></mml:msup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> to <italic toggle="yes">n</italic>-th border coordinates</p>
          <p>4:    <bold>while</bold><inline-formula id="IE29"><mml:math id="IM29" display="inline" overflow="scroll"><mml:mrow><mml:mi>i</mml:mi><mml:mo>≥</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> and j <inline-formula id="IE30"><mml:math id="IM30" display="inline" overflow="scroll"><mml:mrow><mml:mo>≥</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula><bold>do</bold></p>
          <p>5:      <inline-formula id="IE31"><mml:math id="IM31" display="inline" overflow="scroll"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mo>′</mml:mo></mml:msup></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mo>′</mml:mo></mml:msup></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mtext>argmax</mml:mtext></mml:mrow></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula></p>
          <p>6:      <bold>if</bold><inline-formula id="IE32"><mml:math id="IM32" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mo>′</mml:mo></mml:msup></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:mrow></mml:msub></mml:mrow><mml:mo>≤</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula><bold>then</bold></p>
          <p>8:        <inline-formula id="IE33"><mml:math id="IM33" display="inline" overflow="scroll"><mml:mrow><mml:mtext>break</mml:mtext></mml:mrow></mml:math></inline-formula></p>
          <p>9:      <bold>else</bold></p>
          <p>10:        Append <inline-formula id="IE34"><mml:math id="IM34" display="inline" overflow="scroll"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mo>′</mml:mo></mml:msup></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mo>′</mml:mo></mml:msup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> to <inline-formula id="IE35"><mml:math id="IM35" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula></p>
          <p>11:        Decrement <italic toggle="yes">i</italic>, <italic toggle="yes">j</italic> by one</p>
          <p>12:      <bold>end if</bold></p>
          <p>13:    <bold>end while</bold></p>
          <p>14:  <bold>end for</bold></p>
        </boxed-text>
      </p>
    </sec>
    <sec>
      <title>2.4 Local alignment</title>
      <p>Each path generated by the traceback algorithm is scanned for the presence of high-scoring subpaths (i.e. local alignments) using the values of the corresponding region in the substitution matrix. To this end, a moving average with a defined fixed window length is applied to each path <inline-formula id="IE36"><mml:math id="IM36" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> and subpaths whose average score is above the sigma threshold are captured. By default, the threshold is set to 2 sigmas, which is defined as two times the average standard deviation of the substitution matrix. Our tests showed that the standard deviation of the substitution matrix tends to be ∼0.075, while the path score for meaningful alignments is an order of magnitude higher. However, increasing (<inline-formula id="IE37"><mml:math id="IM37" display="inline" overflow="scroll"><mml:mrow><mml:mo>&gt;</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula>) or decreasing (<inline-formula id="IE38"><mml:math id="IM38" display="inline" overflow="scroll"><mml:mrow><mml:mo>&lt;</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula>) the standard deviation cutoff makes the algorithm more strict or more permissive, respectively.</p>
    </sec>
    <sec>
      <title>2.5 Global alignment</title>
      <p>In addition to local alignments, pLM-BLAST can also perform global alignments using the Needleman–Wunsch algorithm (<xref rid="btad579-B26" ref-type="bibr">Needleman and Wunsch 1970</xref>). The original algorithm remains the same except that the similarity matrix is replaced by the embedding-based substitution matrix <italic toggle="yes">S</italic> and the gap penalty is set to zero.</p>
    </sec>
    <sec id="sec2.6">
      <title>2.6 Homology benchmark</title>
      <p>To evaluate the ability of pLM-BLAST and other methods to detect homology between protein sequences, we constructed two benchmark sets based on the ECOD database (<xref rid="btad579-B9" ref-type="bibr">Cheng <italic toggle="yes">et al.</italic> 2014</xref>): first, “hard,” which focuses on difficult cases where the similarity between sequences does not exceed 30%; and second, “easy,” where we test the methods in detecting homology between sequences with 50%–70% similarity.</p>
      <p>To construct the “hard” set, the sequences of all ECOD domains (version 20220912), excluding nested domains, with a length of 50–600 amino acids were obtained using the <italic toggle="yes">localpdb</italic> ECOD plugin (<xref rid="btad579-B24" ref-type="bibr">Ludwiczak <italic toggle="yes">et al.</italic> 2022</xref>) and clustered using MMSeqs2 with a sequence identity cutoff of 30% (<xref rid="btad579-B30" ref-type="bibr">Steinegger and Söding 2017</xref>). The longest sequences were selected as cluster representatives and those belonging to H-groups with less than five members were removed. The final benchmark set was created by randomly selecting five domains from 300 H-groups, i.e. ECOD levels that group together homologous domains with common ancestry. This procedure was designed to select domains from different T-groups; a T-group is a sublevel that groups together homologous domains within an H-group that are topologically similar. As a result, we obtained a set of 1500 ECOD domains from 300 H-groups, none of which shared &gt;30% sequence identity.</p>
      <p>For each ECOD domain in the benchmark set, an HMM profile and sequence embedding were calculated using three iterations of HHblits over the UniRef30 database with default settings (<xref rid="btad579-B31" ref-type="bibr">Steinegger <italic toggle="yes">et al.</italic> 2019</xref>) and ProtT5 (<monospace>prot_t5_xl_half_uniref</monospace>50<monospace>-enc</monospace>) (<xref rid="btad579-B11" ref-type="bibr">Elnaggar <italic toggle="yes">et al.</italic> 2022</xref>), respectively. The embeddings were compared all-against-all with pLM-BLAST (in local and global mode), TM-Vec, and EBA, while the HMM profiles were compared with HHsearch. Matches between domains of the same H-group were considered true positives, matches between different H-groups belonging to the same X-group (an ECOD classification level that groups H-groups that may be homologous) were considered neutral, and finally matches between different X-groups were considered false positives. For the calculation of precision-recall curves (<xref rid="btad579-F2" ref-type="fig">Fig. 2A</xref>), we filled missing data (i.e. pairs for which a given method did not provide a score) with zeros, assuming that the lack of prediction can be considered a negative prediction. In <xref rid="btad579-F2" ref-type="fig">Fig. 2A</xref>, the regions of the curves resulting from such a completion procedure have been omitted for clarity (the complete curves are available as <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S1</xref>). We used the HHsearch match probability, the EBA max score, and the raw pLM-BLAST and TM-Vec scores to calculate the plots.</p>
      <fig position="float" id="btad579-F2">
        <label>Figure 2.</label>
        <caption>
          <p>Performance of pLM-BLAST and other methods in detecting homology and analogy between protein sequences. (A) Benchmark for the task of reconstructing H-groups as defined in the ECOD database. The left panel shows the precision-recall curve and the right panel shows the number of true and false positives. The false positives are plotted on a logarithmic scale. (B) A comparison of methods on a set of 89 analogous protein pairs. The percentages denote the fraction of pairs for which a particular method yields a score. These cases are quantified in terms of the returned score (<italic toggle="yes">x</italic>-axis) and the coverage of the analogous region shared by the pairs (<italic toggle="yes">y</italic>-axis). The red vertical dashed lines correspond to the average score for homologous pairs.</p>
        </caption>
        <graphic xlink:href="btad579f2" position="float"/>
      </fig>
      <p>A similar procedure was used to construct the “easy” benchmark set. As with the “hard” set, the ECOD was first clustered using MMSeqs2 with a 70% sequence identity cutoff to remove redundancy. The resulting sequences were then clustered again using a 50% sequence identity cutoff, and those from clusters containing less than seven members or containing members from more than one ECOD H-group were removed. Finally, for each H-group, only the largest MMSeqs2 cluster was retained. As a result, we obtained 1032 ECOD domains grouped into 103 clusters. In the “easy” benchmark, we used a stricter definition of positives and negatives, defining sequence pairs belonging to the same cluster as positives and the rest as negatives.</p>
    </sec>
    <sec>
      <title>2.7 Analogy benchmark</title>
      <p>To assess the ability of the methods to distinguish homologous from analogous sequences, we used the MALISAM database (<xref rid="btad579-B8" ref-type="bibr">Cheng <italic toggle="yes">et al.</italic> 2008</xref>), which collects examples of protein pairs that share similar structural motifs that have evolved convergently. Eighty-nine such cases were obtained from the database website (<ext-link xlink:href="http://prodata.swmed.edu/malisam/" ext-link-type="uri">http://prodata.swmed.edu/malisam/</ext-link>) and processed to define structurally alignable pairs of residues belonging to the analogous motifs. Each pair of sequences was aligned using pLM-BLAST in local and global modes, HHsearch, and EBA, and the resulting aligned pairs were compared with those from the MALISAM database. Based on these comparisons, the total coverage of the analogous motif and the score of the respective alignment were defined for each case (<xref rid="btad579-F2" ref-type="fig">Fig. 2B</xref>).</p>
    </sec>
    <sec id="sec2.8">
      <title>2.8 Alignment quality benchmark</title>
      <p>To evaluate the quality of the alignments generated by HHsearch, pLM-BLAST, EBA, and BLAST, we followed a procedure previously described in <xref rid="btad579-B28" ref-type="bibr">Remmert <italic toggle="yes">et al.</italic> (2011)</xref>. First, we extracted all pairs from the “hard” benchmark set (see above) for which all methods produced an alignment. Then, for each pair, we computed the structural alignment using the USalign tool (<xref rid="btad579-B34" ref-type="bibr">Zhang <italic toggle="yes">et al.</italic> 2022</xref>) and discarded those for which the TM score was &lt;0.5, resulting in 444 pairs. The structure-based sequence alignments provided by USalign defined the ground truth against which the alignments of each method were compared. Specifically, we considered the precision, i.e. the fraction of correctly aligned pairs out of all aligned pairs, and the sensitivity, i.e. the fraction of correctly aligned pairs out of all structurally alignable pairs. The precision and sensitivity values were averaged for each method and plotted (<xref rid="btad579-F3" ref-type="fig">Fig. 3</xref>). We also attempted to evaluate TM-Vec alignments, but for technical reasons were unable to run the DeepBlast model (<xref rid="btad579-B25" ref-type="bibr">Morton <italic toggle="yes">et al.</italic> 2023</xref>) required for alignment generation, but we expect it to perform with an accuracy comparable to other global alignment methods.</p>
      <fig position="float" id="btad579-F3">
        <label>Figure 3.</label>
        <caption>
          <p>Alignment quality benchmark. Each point represents the average per-residue sensitivity (<italic toggle="yes">y</italic>-axis) and per-residue precision (<italic toggle="yes">x</italic>-axis) achieved in the reconstruction of 444 structure-based alignments by a specific method.</p>
        </caption>
        <graphic xlink:href="btad579f3" position="float"/>
      </fig>
    </sec>
    <sec>
      <title>2.9 Speed benchmark</title>
      <p>To evaluate the speed of pLM-BLAST and other methods, we performed a benchmark using five query sequences (<xref rid="sup1" ref-type="supplementary-material">Supplementary File S1</xref>) of different lengths and folds to search the ECOD70 database, i.e. the ECOD database filtered to maximum 70% identity with MMseqs2. To generate the HHsearch database, we used HHblits run with three iterations on the UniRef30 database (UniRef database filtered to maximum 30% sequence identity), version 2022_02. The benchmark covered the time needed to prepare a given query (embedding calculation or HHblits search) and to search the database. pLM-BLAST was used with cosine similarity pre-filtering (see the next subsection) with the cutoff set at the 90th percentile. All calculations were performed for a fixed computer specification of a 6-core CPU and a single GPU. The benchmark was run four times for each method and the run times were averaged.</p>
    </sec>
    <sec id="sec2.10">
      <title>2.10 Cosine similarity prefiltering</title>
      <p>Typically, when dealing with embeddings, protein similarity is inferred as the cosine similarity between perprotein embeddings (global representations). This approach is very fast, but suffers from the loss of information stored in the per-residue embeddings (local representations) due to the averaging that occurs when the representation is converted to a fixed-size vector. This loss of information makes it impossible to capture local similarities and significantly reduces the ability to detect distant homology. With this in mind, we have developed a procedure that provides a tradeoff between the use of global and local representations.</p>
      <p>For a given pair of sequences (e.g. the query and one of the database sequences), per-residue embeddings are taken and treated as 2D images (<xref rid="btad579-F1" ref-type="fig">Fig. 1A</xref>), where one dimension is the sequence length and the other is the embedding size (1024 for ProtT5). We then convolve one embedding with another, where the first dimension of each convolution window is user-defined (30 by default) and the second dimension is fixed and equal to the size of the embedding dimension (1024 for ProtT5). This approach produces a 2D matrix in which each element represents the cosine similarity between each embedding slice of the two sequences. Finally, only if the resulting matrix has a value above the user-specified threshold, the corresponding sequences are passed to the actual pLM-BLAST method.</p>
    </sec>
  </sec>
  <sec>
    <title>3. Results and discussion</title>
    <sec>
      <title>3.1 Homology detection</title>
      <p>To assess the performance of pLM-BLAST in homology detection, we conducted a comparison with state-of-the-art methods such as BLAST and HHsearch, as well as other embedding-based methods (TM-Vec and EBA), using the Evolutionary Classification of Protein Domains (ECOD) database as a reference (<xref rid="btad579-B9" ref-type="bibr">Cheng <italic toggle="yes">et al.</italic> 2014</xref>). The ECOD database categorizes protein domains based on their evolutionary relationships and structural similarities and organizes them into families, topologies, homologous groups (H-groups), possibly homologous groups (X-groups), and architectures. To evaluate the ability of each method to reconstruct 300 selected ECOD H-groups, two metrics were used: the precision-recall curve and the ratio of true positives to false positives (as shown in <xref rid="btad579-F2" ref-type="fig">Fig. 2</xref>). For this study, we specifically curated the benchmark set to ensure that no pair of sequences exceeded 30% similarity, which led to a particularly challenging dataset that we refer to as the “hard” set.</p>
      <p>In the “hard” benchmark, EBA performed best, followed by HHsearch and pLM-BLAST, both of which offer similar levels of accuracy; meanwhile, TM-Vec and BLAST underperformed (<xref rid="btad579-F2" ref-type="fig">Fig. 2</xref>). The unexpected discrepancy in performance between EBA, TM-Vec, and pLM-BLAST is noteworthy, given they all use the same representations derived from the ProtT5 language model. Unlike the better-performing methods, pLM-BLAST and EBA, which rely solely on unsupervised comparisons of raw representations, TM-Vec, the worst-performing method, uses ProtT5 representations as input for a specially trained end-to-end deep learning model to generate structural alignments. This suggests that the raw embeddings carry sufficient information for homology detection, whereas the structural similarity predicted by TM-Vec serves as a much less informative marker for homology.</p>
      <p>The superior performance of EBA among ProtT5-based methods can be attributed to its utilization of an efficient signal enhancement procedure, which facilitates a more effective comparison of representations (<xref rid="btad579-B27" ref-type="bibr">Pantolini <italic toggle="yes">et al.</italic> 2022</xref>). It should also be noted that EBA provides only global alignments, which are expected to perform better than local alignments on a benchmark set consisting of domains, rather than full-length sequences. This relationship is evident in the performance comparison between pLM-BLAST running in local and global modes, with the latter consistently outperforming the former.</p>
    </sec>
    <sec>
      <title>3.2 Analogy detection</title>
      <p>Given the strong performance of pLM-BLAST and EBA in the distant homology detection benchmark, where they achieved accuracies comparable to HHsearch (<xref rid="btad579-F2" ref-type="fig">Fig. 2A</xref>), we further tested them for their ability to distinguish homology from analogy (i.e. sequence similarity resulting from convergent evolution rather than common ancestry). To do this, we used 89 cases from the MALISAM database (<xref rid="btad579-B8" ref-type="bibr">Cheng <italic toggle="yes">et al.</italic> 2008</xref>), which collects examples of protein motifs that share similar structures due to analogous origins. HHsearch and pLM-BLAST’s local alignments covered the analogous regions in only 2% and 3% of the test cases, respectively, all with scores below those expected for clearly homologous pairs (<xref rid="btad579-F2" ref-type="fig">Fig. 2B</xref>). In contrast, pLM-BLAST and EBA global alignments covered analogous regions in 31% and 33% of cases, respectively, but also with scores below those expected for homologous sequences. These results suggest that embedding-based methods, much like HHsearch, are not misled by analogous signals, especially when local alignments are used.</p>
    </sec>
    <sec>
      <title>3.3 Alignment quality</title>
      <p>The benchmarks described above focused on the detection of homologous domain pairs based on the provided scores. However, an equally important aspect is the extent to which the generated alignments are correct at the per-residue level. To evaluate this, we used structure-based sequence alignments as a reference point against which the individual sequence-based alignments were compared. For each method, we calculated per-residue precision and sensitivity coefficients (see <xref rid="sec2.8" ref-type="sec">Section 2.8</xref> for details). The results obtained indicate that pLM-BLAST global, EBA global, and HHsearch all provided very good alignments, with EBA global slightly less effective in terms of precision (<xref rid="btad579-F3" ref-type="fig">Fig. 3</xref>). The pLM-BLAST in local mode also provided good precision but lower sensitivity, indicating that its alignments are as precise as those of HHsearch and other embedding-based methods, which run in global mode but shorter, thus not covering all structurally alignable pairs. As we will illustrate later in the text, such short alignments may correspond to ancestral fragments (<xref rid="btad579-B2" ref-type="bibr">Alva <italic toggle="yes">et al.</italic> 2015</xref>, <xref rid="btad579-B18" ref-type="bibr">Kolodny <italic toggle="yes">et al.</italic> 2021</xref>) that are shared between different protein folds.</p>
    </sec>
    <sec>
      <title>3.4 Comparison of similar sequences</title>
      <p>Above, we discussed pLM-BLAST and related methods in the context of detecting homology between highly divergent sequences that share &lt;30% pairwise sequence identity. However, sequences sharing ≥50% identity are also routinely compared in bioinformatics tasks. Bearing this in mind, we considered an additional “easy” benchmark set, where homologous sequences share between 50% and 70% identity (see <xref rid="sec2.6" ref-type="sec">Section 2.6</xref> for details). This benchmark was also based on domain sequences from the ECOD database, but it aimed to reconstruct clusters defined by MMseqs2 instead of ECOD H-groups</p>
      <p>The results obtained indicate that pLM-BLAST and all other benchmarked methods perform almost perfectly in this task (<xref rid="btad579-F4" ref-type="fig">Fig. 4</xref>). Only at precision and recall rates &gt;95% can minor differences be observed, with BLAST outperforming the others and TM-Vec demonstrating the lowest accuracy. pLM-BLAST and EBA in global alignment mode perform equally well, closely followed by HHsearch and pLM-BLAST in local mode. The strong performance of pLM-BLAST, EBA, and TM-Vec in this test suggests that embedding-based methods are a viable option for comparing similar sequences and should be considered in the development of new tools for sequence searching and clustering, akin to DIAMOND (<xref rid="btad579-B7" ref-type="bibr">Buchfink <italic toggle="yes">et al.</italic> 2021</xref>) or MMseqs2 (<xref rid="btad579-B30" ref-type="bibr">Steinegger and Söding 2017</xref>).</p>
      <fig position="float" id="btad579-F4">
        <label>Figure 4.</label>
        <caption>
          <p>Performance of pLM-BLAST and other methods in classifying sequences with 50%–70% identity. (A) Precision-recall curve. (B) The same precision-recall curve as in (A) is shown, but it is limited to the precision and recall ranges that are &gt;95%.</p>
        </caption>
        <graphic xlink:href="btad579f4" position="float"/>
      </fig>
    </sec>
    <sec>
      <title>3.5 Speed benchmark</title>
      <p>A critical aspect of large-scale analyses is computational speed. Bearing this in mind, we evaluated the speed of pLM-BLAST, EBA, HHsearch, and TM-Vec while searching the ECOD70 database (over 62 000 records) using five example queries of varying lengths (<xref rid="sup1" ref-type="supplementary-material">Supplementary File S1</xref>).</p>
      <p>The results reveal (<xref rid="btad579-T1" ref-type="table">Table 1</xref>) that TM-Vec is the fastest method, despite being the worst performer in the homology detection benchmark (<xref rid="btad579-F2" ref-type="fig">Fig. 2</xref>). pLM-BLAST, the second fastest method, is on average twice as fast as HHsearch and three times faster than EBA. The only case where HHsearch outperformed pLM-BLAST was a coiled-coil domain (query 2 in <xref rid="btad579-T1" ref-type="table">Table 1</xref>), where only a few homologous sequences could be detected. These results suggest that pLM-BLAST offers an optimal balance between accuracy and speed, with its performance being comparable to HHsearch (see <xref rid="btad579-F2" ref-type="fig">Figs. 2</xref> and <xref rid="btad579-F3" ref-type="fig">3</xref>), yet faster, and offering new insights into protein evolution, as discussed later. EBA, which delivered the best performance in the homology detection benchmark, was also the slowest method. This is probably because it lacks the pre-filtering step employed by pLM-BLAST (see <xref rid="sec2.10" ref-type="sec">Section 2.10</xref>).</p>
      <table-wrap position="float" id="btad579-T1">
        <label>Table 1.</label>
        <caption>
          <p>Speed comparison between pLM-BLAST and other methods.<xref rid="tblfn1" ref-type="table-fn"><sup>a</sup></xref></p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th rowspan="1" colspan="1">Method</th>
              <th rowspan="1" colspan="1">Query 1 (269)</th>
              <th rowspan="1" colspan="1">Query 2 (55)</th>
              <th rowspan="1" colspan="1">Query 3 (379)</th>
              <th rowspan="1" colspan="1">Query 4 (88)</th>
              <th rowspan="1" colspan="1">Query 5 (132)</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">pLM-BLAST local</td>
              <td rowspan="1" colspan="1">2 min 5 s</td>
              <td rowspan="1" colspan="1">54 s</td>
              <td rowspan="1" colspan="1">2 min 30 s</td>
              <td rowspan="1" colspan="1">1 min 3 s</td>
              <td rowspan="1" colspan="1">1 min 27 s</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">HHsearch</td>
              <td rowspan="1" colspan="1">5 min 9 s</td>
              <td rowspan="1" colspan="1">38 s</td>
              <td rowspan="1" colspan="1">3 min 4 s</td>
              <td rowspan="1" colspan="1">4 min 2 s</td>
              <td rowspan="1" colspan="1">2 min 57 s</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">EBA</td>
              <td rowspan="1" colspan="1">7 min 10 s</td>
              <td rowspan="1" colspan="1">3 min 15 s</td>
              <td rowspan="1" colspan="1">7 min 23 s</td>
              <td rowspan="1" colspan="1">3 min 46 s</td>
              <td rowspan="1" colspan="1">5 min 0 s</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">TM-Vec</td>
              <td rowspan="1" colspan="1">15 s</td>
              <td rowspan="1" colspan="1">15 s</td>
              <td rowspan="1" colspan="1">15 s</td>
              <td rowspan="1" colspan="1">15 s</td>
              <td rowspan="1" colspan="1">15 s</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <fn id="tblfn1">
            <label>a</label>
            <p>The runtimes are presented in seconds, and the length of each query sequence is provided in brackets.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
    </sec>
    <sec>
      <title>3.5 Potential to discover new homology relationships</title>
      <p>Given the ability of pLM-BLAST to detect homology (<xref rid="btad579-F2" ref-type="fig">Fig. 2A</xref>), distinguish between homology and analogy (<xref rid="btad579-F2" ref-type="fig">Fig. 2B</xref>), and provide high-precision alignments (<xref rid="btad579-F3" ref-type="fig">Fig. 3</xref>), we speculated that some of the high-scoring connections between different H-groups of the same X-group, or even different X-groups, could reflect true homology.</p>
      <p>In the benchmark of pLM-BLAST run in the local mode, the most number of connections between H-groups were found in the Alpha-beta plaits and Flavodoxin-like X-groups (see <xref rid="sup1" ref-type="supplementary-material">Supplementary File S2</xref> for the full list of connected H-groups). Most of these intra-X-group matches were not detected by either HHsearch, which is expected since it was used to define homologous relationships in the ECOD database (<xref rid="btad579-B9" ref-type="bibr">Cheng <italic toggle="yes">et al.</italic> 2014</xref>), or EBA, which typically yielded low scores. We also detected connections between domains of different X-groups, often hinged on the presence of a subdomain-sized fragment (<xref rid="btad579-B2" ref-type="bibr">Alva <italic toggle="yes">et al.</italic> 2015</xref>, <xref rid="btad579-B18" ref-type="bibr">Kolodny <italic toggle="yes">et al.</italic> 2021</xref>; <xref rid="sup1" ref-type="supplementary-material">Supplementary File S3</xref>); for example, between the P-loop, Rossmann, and Flavodoxin folds (<xref rid="btad579-B23" ref-type="bibr">Longo <italic toggle="yes">et al.</italic> 2020</xref>, <xref rid="btad579-B17" ref-type="bibr">Kolodny 2021</xref>). Among these cases, we found a fragment conserved between domains of two different sandwich folds, namely cupredoxin (ECOD H-group 3156.1) and immunoglobulin (11.1, 5 A). Despite a global structural similarity (DALI Z-score = 2.7), the sequences of these two proteins could be aligned only over a short region corresponding to a beta-hairpin motif. This motif may represent an ancestral fragment that has been independently “decorated” with secondary structural elements, resulting in the two observed structures. In such a scenario, only the two beta-hairpin motifs would be truly homologous, while the overall structural similarity could be attributed to convergent evolution. Moreover, a homologous relationship between these two domains has been discussed previously (<xref rid="btad579-B13" ref-type="bibr">Gough and Chothia 2004</xref>, <xref rid="btad579-B32" ref-type="bibr">Stevens 2008</xref>), and a pLM-BLAST scan of the entire ECOD database using a cupredoxin domain as a query revealed additional connections to other Ig-like domains (<xref rid="btad579-F5" ref-type="fig">Fig. 5</xref>). Among them, we identified structures from different ECOD H-groups of the immunoglobulin-like beta-sandwich X-group (also see <xref rid="sup1" ref-type="supplementary-material">Supplementary File S3</xref>), suggesting homology in the region of the beta-hairpin motif. Interestingly, the matches also included a significantly different jelly-roll fold. Although the structural similarity between cupredoxin and jelly-roll folds is not as apparent as that of the of the cupredoxin and Ig-like folds, all share a Greek key motif in their core, lending credence to a hypothesis of a common origin.</p>
      <fig position="float" id="btad579-F5">
        <label>Figure 5.</label>
        <caption>
          <p>pLM-BLAST scan of the ECOD database using the sequence of the cupredoxin domain. (A) A substitution matrix illustrating the similarity between cupredoxin and immunoglobulin folds. The numbered axes indicate consecutive residues. The lighter the color, the higher the similarity between the sequences in a given region. The best local alignment is indicated by a red line. (B) Structures of cupredoxin and immunoglobulin folds, with the homologous region detected by pLM-BLAST highlighted in red. (C) Graphical representation of the scan results. Bars correspond to hits, color-coded according to their ECOD X-group membership.</p>
        </caption>
        <graphic xlink:href="btad579f5" position="float"/>
      </fig>
      <p>In our benchmark, we used HHsearch’s homology predictions as a ground truth and reference point for pLM-BLAST and other methods. However, it is important to note that homology cannot be definitively proven, and the benchmark is essentially a comparison of one hypothesis against another. While HHsearch is a well-established method, and its predictions have provided crucial insights in numerous studies, our results suggest that embedding-based methods such as pLM-BLAST could potentially detect homology beyond the boundaries defined by HHsearch.</p>
    </sec>
  </sec>
  <sec>
    <title>4 Conclusions</title>
    <p>pLM-BLAST is a sensitive tool for remote homology detection that is based on comparison of sequence representations obtained from the pLM ProtT5. It provides both global and local alignments, with the latter being crucial for detecting distant evolutionary relationships (<xref rid="btad579-F5" ref-type="fig">Fig. 5</xref>). Additionally, it is efficient in database searching (<xref rid="btad579-T1" ref-type="table">Table 1</xref>) due to the use of a prefiltering step. pLM-BLAST is available both as a stand-alone package and as an easy-to-use web server within the MPI Bioinformatics Toolkit (<xref rid="btad579-B36" ref-type="bibr">Zimmermann <italic toggle="yes">et al.</italic> 2018</xref>), where it can be used to search precomputed databases. Currently, the primary limitations of pLM-BLAST are the maximum size of the target database (as searching enormous, redundant databases containing millions of sequences would be computationally costly), and the fact that in local mode, it typically produces highly precise but shorter alignments than HHsearch. However, as demonstrated in <xref rid="btad579-F5" ref-type="fig">Fig. 5</xref>, these shorter alignments can indeed be meaningful. The significance of these alignments, often being subalignments of those provided by HHsearch (if any are provided), from an evolutionary perspective remains to be explored. We anticipate that pLM-BLAST will prove beneficial in studying protein function and evolution, including in the cases of singletons/orphan sequences and taxonomically restricted genes (<xref rid="btad579-B3" ref-type="bibr">Barrera-Redondo <italic toggle="yes">et al.</italic> 2022</xref>), for which deep HMM profiles cannot be calculated.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btad579_Supplementary_Data</label>
      <media xlink:href="btad579_supplementary_data.zip">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <sec>
    <title>Supplementary data</title>
    <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics</italic> online.</p>
  </sec>
  <sec sec-type="COI-statement">
    <title>Conflict of interest</title>
    <p>None declared.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>This work was supported by the First TEAM program of the Foundation for Polish Science, co-financed by the European Union under the European Regional Development Fund (grant POIR.04.04.00-00-5CF1/18-00). V.A. and S.D.-H. were supported by institutional funds from the Max Planck Society.</p>
  </sec>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btad579-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Altschul</surname><given-names>SF</given-names></string-name>, <string-name><surname>Madden</surname><given-names>TL</given-names></string-name>, <string-name><surname>Schäffer</surname><given-names>AA</given-names></string-name></person-group><etal>et al</etal><article-title>Gapped BLAST and PSI-BLAST: a new generation of protein database search programs</article-title>. <source>Nucleic Acids Res</source><year>1997</year>;<volume>25</volume>:<fpage>3389</fpage>–<lpage>402</lpage>.<pub-id pub-id-type="pmid">9254694</pub-id></mixed-citation>
    </ref>
    <ref id="btad579-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Alva</surname><given-names>V</given-names></string-name>, <string-name><surname>Söding</surname><given-names>J</given-names></string-name>, <string-name><surname>Lupas</surname><given-names>AN.</given-names></string-name></person-group><article-title>A vocabulary of ancient peptides at the origin of folded proteins</article-title>. <source>Elife</source><year>2015</year>;<volume>4</volume>:<fpage>e09410</fpage>.<pub-id pub-id-type="pmid">26653858</pub-id></mixed-citation>
    </ref>
    <ref id="btad579-B3">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Barrera-Redondo</surname><given-names>J</given-names></string-name>, <string-name><surname>Lotharukpong</surname><given-names>JS</given-names></string-name>, <string-name><surname>Drost</surname><given-names>H-G</given-names></string-name></person-group><etal>et al</etal> Uncovering gene-family founder events during major evolutionary transitions in animals, plants and fungi using GenEra. bioRxiv, <pub-id pub-id-type="doi">10.1101/2022.07.07.498977</pub-id>, January <year>2022</year>, preprint: not peer reviewed.</mixed-citation>
    </ref>
    <ref id="btad579-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bepler</surname><given-names>T</given-names></string-name>, <string-name><surname>Berger</surname><given-names>B.</given-names></string-name></person-group><article-title>Learning the protein language: evolution, structure, and function</article-title>. <source>Cell Syst</source><year>2021</year>;<volume>12</volume>:<fpage>654</fpage>–<lpage>69.e3</lpage>.<pub-id pub-id-type="pmid">34139171</pub-id></mixed-citation>
    </ref>
    <ref id="btad579-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bernhofer</surname><given-names>M</given-names></string-name>, <string-name><surname>Rost</surname><given-names>B.</given-names></string-name></person-group><article-title>TMbed: transmembrane proteins predicted through language model embeddings</article-title>. <source>BMC Bioinform</source><year>2022</year>;<volume>23</volume>:<fpage>326</fpage>.</mixed-citation>
    </ref>
    <ref id="btad579-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Biegert</surname><given-names>A</given-names></string-name>, <string-name><surname>Söding</surname><given-names>J.</given-names></string-name></person-group><article-title>Sequence context-specific profiles for homology searching</article-title>. <source>Proc Natl Acad Sci USA</source><year>2009</year>;<volume>106</volume>:<fpage>3770</fpage>–<lpage>5</lpage>.<pub-id pub-id-type="pmid">19234132</pub-id></mixed-citation>
    </ref>
    <ref id="btad579-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Buchfink</surname><given-names>B</given-names></string-name>, <string-name><surname>Reuter</surname><given-names>K</given-names></string-name>, <string-name><surname>Drost</surname><given-names>H-G.</given-names></string-name></person-group><article-title>Sensitive protein alignments at tree-of-life scale using DIAMOND</article-title>. <source>Nat Methods</source><year>2021</year>;<volume>18</volume>:<fpage>366</fpage>–<lpage>8</lpage>.<pub-id pub-id-type="pmid">33828273</pub-id></mixed-citation>
    </ref>
    <ref id="btad579-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Cheng</surname><given-names>H</given-names></string-name>, <string-name><surname>Kim</surname><given-names>B-H</given-names></string-name>, <string-name><surname>Grishin</surname><given-names>NV.</given-names></string-name></person-group><article-title>MALISAM: a database of structurally analogous motifs in proteins</article-title>. <source>Nucleic Acids Res</source><year>2008</year>;<volume>36</volume>:<fpage>D211</fpage>–<lpage>7</lpage>.<pub-id pub-id-type="pmid">17855399</pub-id></mixed-citation>
    </ref>
    <ref id="btad579-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Cheng</surname><given-names>H</given-names></string-name>, <string-name><surname>Schaeffer</surname><given-names>RD</given-names></string-name>, <string-name><surname>Liao</surname><given-names>Y</given-names></string-name></person-group><etal>et al</etal><article-title>ECOD: an Evolutionary Classification of Protein Domains</article-title>. <source>PLoS Comput Biol</source><year>2014</year>;<volume>10</volume>:<fpage>e1003926</fpage>.<pub-id pub-id-type="pmid">25474468</pub-id></mixed-citation>
    </ref>
    <ref id="btad579-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Eddy</surname><given-names>SR.</given-names></string-name></person-group><article-title>Accelerated profile HMM searches</article-title>. <source>PLoS Comput Biol</source><year>2011</year>;<volume>7</volume>:<fpage>e1002195</fpage>.<pub-id pub-id-type="pmid">22039361</pub-id></mixed-citation>
    </ref>
    <ref id="btad579-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Elnaggar</surname><given-names>A</given-names></string-name>, <string-name><surname>Heinzinger</surname><given-names>M</given-names></string-name>, <string-name><surname>Dallago</surname><given-names>C</given-names></string-name></person-group><etal>et al</etal><article-title>ProtTrans: towards cracking the language of lifes code through self-supervised deep learning and high performance computing</article-title>. <source>IEEE Trans Pattern Anal Mach Intell</source><year>2022</year>;<volume>44</volume>:<fpage>7112</fpage>–<lpage>27</lpage>.<pub-id pub-id-type="pmid">34232869</pub-id></mixed-citation>
    </ref>
    <ref id="btad579-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gao</surname><given-names>M</given-names></string-name>, <string-name><surname>Skolnick</surname><given-names>J.</given-names></string-name></person-group><article-title>A novel sequence alignment algorithm based on deep learning of the protein folding code</article-title>. <source>Bioinformatics</source><year>2021</year>;<volume>37</volume>:<fpage>490</fpage>–<lpage>6</lpage>.<pub-id pub-id-type="pmid">32960943</pub-id></mixed-citation>
    </ref>
    <ref id="btad579-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gough</surname><given-names>J</given-names></string-name>, <string-name><surname>Chothia</surname><given-names>C.</given-names></string-name></person-group><article-title>The linked conservation of structure and function in a family of high diversity</article-title>. <source>Structure</source><year>2004</year>;<volume>12</volume>:<fpage>917</fpage>–<lpage>25</lpage>.<pub-id pub-id-type="pmid">15274913</pub-id></mixed-citation>
    </ref>
    <ref id="btad579-B14">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Hamamsy</surname><given-names>T</given-names></string-name>, <string-name><surname>Morton</surname><given-names>JT</given-names></string-name>, <string-name><surname>Berenberg</surname><given-names>D</given-names></string-name></person-group><etal>et al</etal> TM-Vec: template modeling vectors for fast homology detection and alignment. bioRxiv, <pub-id pub-id-type="doi">10.1101/2022.07.25.501437</pub-id>, January <year>2022</year>, preprint: not peer reviewed.</mixed-citation>
    </ref>
    <ref id="btad579-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Henikoff</surname><given-names>S</given-names></string-name>, <string-name><surname>Henikoff</surname><given-names>JG.</given-names></string-name></person-group><article-title>Amino acid substitution matrices from protein blocks</article-title>. <source>Proc Natl Acad Sci U S A</source><year>1992</year>;<volume>89</volume>:<fpage>10915</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">1438297</pub-id></mixed-citation>
    </ref>
    <ref id="btad579-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Jumper</surname><given-names>J</given-names></string-name>, <string-name><surname>Evans</surname><given-names>R</given-names></string-name>, <string-name><surname>Pritzel</surname><given-names>A</given-names></string-name></person-group><etal>et al</etal><article-title>Highly accurate protein structure prediction with AlphaFold</article-title>. <source>Nature</source><year>2021</year>;<volume>596</volume>:<fpage>583</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">34265844</pub-id></mixed-citation>
    </ref>
    <ref id="btad579-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kolodny</surname><given-names>R.</given-names></string-name></person-group><article-title>Searching protein space for ancient Sub-domain segments</article-title>. <source>Curr Opin Struct Biol</source><year>2021</year>;<volume>68</volume>:<fpage>105</fpage>–<lpage>12</lpage>.<pub-id pub-id-type="pmid">33476896</pub-id></mixed-citation>
    </ref>
    <ref id="btad579-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kolodny</surname><given-names>R</given-names></string-name>, <string-name><surname>Nepomnyachiy</surname><given-names>S</given-names></string-name>, <string-name><surname>Tawfik</surname><given-names>DS</given-names></string-name></person-group><etal>et al</etal><article-title>Bridging themes: short protein segments found in different architectures</article-title>. <source>Mol Biol Evol</source><year>2021</year>;<volume>38</volume>:<fpage>2191</fpage>–<lpage>208</lpage>.<pub-id pub-id-type="pmid">33502503</pub-id></mixed-citation>
    </ref>
    <ref id="btad579-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Li</surname><given-names>S</given-names></string-name>, <string-name><surname>Chen</surname><given-names>J</given-names></string-name>, <string-name><surname>Liu</surname><given-names>B.</given-names></string-name></person-group><article-title>Protein remote homology detection based on bidirectional long short-term memory</article-title>. <source>BMC Bioinform</source><year>2017</year>;<volume>18</volume>:<fpage>443</fpage>.</mixed-citation>
    </ref>
    <ref id="btad579-B20">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Li</surname><given-names>Z</given-names></string-name>, <string-name><surname>Liu</surname><given-names>X</given-names></string-name>, <string-name><surname>Chen</surname><given-names>W</given-names></string-name></person-group><etal>et al</etal> Uni-Fold: an open-source platform for developing protein folding models beyond AlphaFold. bioRxiv, <pub-id pub-id-type="doi">10.1101/2022.08.04.502811</pub-id>, January <year>2022</year>, preprint: not peer reviewed.</mixed-citation>
    </ref>
    <ref id="btad579-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lin</surname><given-names>Z</given-names></string-name>, <string-name><surname>Akin</surname><given-names>H</given-names></string-name>, <string-name><surname>Rao</surname><given-names>R</given-names></string-name></person-group><etal>et al</etal><article-title>Evolutionary-scale prediction of atomic-level protein structure with a language model</article-title>. <source>Science</source><year>2023</year>;<volume>379</volume>:<fpage>1123</fpage>–<lpage>30</lpage>.<pub-id pub-id-type="pmid">36927031</pub-id></mixed-citation>
    </ref>
    <ref id="btad579-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Llinares-López</surname><given-names>F</given-names></string-name>, <string-name><surname>Berthet</surname><given-names>Q</given-names></string-name>, <string-name><surname>Blondel</surname><given-names>M</given-names></string-name></person-group><etal>et al</etal><article-title>Deep embedding and alignment of protein sequences</article-title>. <source>Nat Methods</source><year>2023</year>;<volume>20</volume>:<fpage>104</fpage>–<lpage>11</lpage>.<pub-id pub-id-type="pmid">36522501</pub-id></mixed-citation>
    </ref>
    <ref id="btad579-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Longo</surname><given-names>LM</given-names></string-name>, <string-name><surname>Jabłońska</surname><given-names>J</given-names></string-name>, <string-name><surname>Vyas</surname><given-names>P</given-names></string-name></person-group><etal>et al</etal><article-title>On the emergence of P-Loop NTPase and Rossmann enzymes from a Beta-Alpha-Beta ancestral fragment</article-title>. <source>Elife</source><year>2020</year>;<volume>9</volume>:e64415.</mixed-citation>
    </ref>
    <ref id="btad579-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ludwiczak</surname><given-names>J</given-names></string-name>, <string-name><surname>Winski</surname><given-names>A</given-names></string-name>, <string-name><surname>Dunin-Horkawicz</surname><given-names>S.</given-names></string-name></person-group><article-title>Localpdb—a python package to manage protein structures and their annotations</article-title>. <source>Bioinformatics (Oxford, England)</source><year>2022</year>;<volume>38</volume>:<fpage>2633</fpage>–<lpage>5</lpage>.<pub-id pub-id-type="pmid">35199148</pub-id></mixed-citation>
    </ref>
    <ref id="btad579-B25">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Morton</surname><given-names>JT</given-names></string-name>, <string-name><surname>Strauss</surname><given-names>CEM</given-names></string-name>, <string-name><surname>Blackwell</surname><given-names>R</given-names></string-name></person-group><etal>et al</etal> Protein structural alignments from sequence. bioRxiv, <pub-id pub-id-type="doi">10.1101/2020.11.03.365932,</pub-id> January <year>2023</year>, preprint: not peer reviewed.</mixed-citation>
    </ref>
    <ref id="btad579-B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Needleman</surname><given-names>SB</given-names></string-name>, <string-name><surname>Wunsch</surname><given-names>CD.</given-names></string-name></person-group><article-title>A general method applicable to the search for similarities in the amino acid sequence of two proteins</article-title>. <source>J Mol Biol</source><year>1970</year>;<volume>48</volume>:<fpage>443</fpage>–<lpage>53</lpage>.<pub-id pub-id-type="pmid">5420325</pub-id></mixed-citation>
    </ref>
    <ref id="btad579-B27">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Pantolini</surname><given-names>L</given-names></string-name>, <string-name><surname>Studer</surname><given-names>G</given-names></string-name>, <string-name><surname>Pereira</surname><given-names>J</given-names></string-name></person-group><etal>et al</etal> Embedding-based alignment: combining protein language models and alignment approaches to detect structural similarities in the twilight-zone. bioRxiv, <pub-id pub-id-type="doi">10.1101/2022.12.13.520313</pub-id>, January <year>2022</year>, preprint: not peer reviewed.</mixed-citation>
    </ref>
    <ref id="btad579-B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Remmert</surname><given-names>M</given-names></string-name>, <string-name><surname>Biegert</surname><given-names>A</given-names></string-name>, <string-name><surname>Hauser</surname><given-names>A</given-names></string-name></person-group><etal>et al</etal><article-title>HHblits: lightning-fast iterative protein sequence searching by HMM-HMM alignment</article-title>. <source>Nat Methods</source><year>2011</year>;<volume>9</volume>:<fpage>173</fpage>–<lpage>5</lpage>.<pub-id pub-id-type="pmid">22198341</pub-id></mixed-citation>
    </ref>
    <ref id="btad579-B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Schütze</surname><given-names>K</given-names></string-name>, <string-name><surname>Heinzinger</surname><given-names>M</given-names></string-name>, <string-name><surname>Steinegger</surname><given-names>M</given-names></string-name></person-group><etal>et al</etal><article-title>Nearest neighbor search on embeddings rapidly identifies distant protein relations</article-title>. <source>Front Bioinform</source><year>2022</year>;<volume>2</volume>:<fpage>1033775</fpage>.<pub-id pub-id-type="pmid">36466147</pub-id></mixed-citation>
    </ref>
    <ref id="btad579-B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Steinegger</surname><given-names>M</given-names></string-name>, <string-name><surname>Söding</surname><given-names>J.</given-names></string-name></person-group><article-title>MMseqs2 enables sensitive protein sequence searching for the analysis of massive data sets</article-title>. <source>Nat Biotechnol</source><year>2017</year>;<volume>35</volume>:<fpage>1026</fpage>–<lpage>8</lpage>.<pub-id pub-id-type="pmid">29035372</pub-id></mixed-citation>
    </ref>
    <ref id="btad579-B31">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Steinegger</surname><given-names>M</given-names></string-name>, <string-name><surname>Meier</surname><given-names>M</given-names></string-name>, <string-name><surname>Mirdita</surname><given-names>M</given-names></string-name></person-group><etal>et al</etal><article-title>HH-suite3 for fast remote homology detection and deep protein annotation</article-title>. <source>BMC Bioinform</source><year>2019</year>;<volume>20</volume>:<fpage>473</fpage>–<lpage>1471</lpage>.</mixed-citation>
    </ref>
    <ref id="btad579-B32">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Stevens</surname><given-names>FJ.</given-names></string-name></person-group><article-title>Homology versus analogy: possible evolutionary relationship of immunoglobulins, cupredoxins, and Cu,Zn-superoxide dismutase</article-title>. <source>J Mol Recognit</source><year>2008</year>;<volume>21</volume>:<fpage>20</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">18080994</pub-id></mixed-citation>
    </ref>
    <ref id="btad579-B33">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Teufel</surname><given-names>F</given-names></string-name>, <string-name><surname>Almagro Armenteros</surname><given-names>JJ</given-names></string-name>, <string-name><surname>Johansen</surname><given-names>AR</given-names></string-name></person-group><etal>et al</etal><article-title>SignalP 6.0 predicts all five types of signal peptides using protein language models</article-title>. <source>Nat Biotechnol</source><year>2022</year>;<volume>40</volume>:<fpage>1023</fpage>–<lpage>5</lpage>.<pub-id pub-id-type="pmid">34980915</pub-id></mixed-citation>
    </ref>
    <ref id="btad579-B34">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhang</surname><given-names>C</given-names></string-name>, <string-name><surname>Shine</surname><given-names>M</given-names></string-name>, <string-name><surname>Pyle</surname><given-names>AM</given-names></string-name></person-group><etal>et al</etal><article-title>US-align: universal structure alignments of proteins, nucleic acids, and macromolecular complexes</article-title>. <source>Nat Methods</source><year>2022</year>;<volume>19</volume>:<fpage>1109</fpage>–<lpage>15</lpage>.<pub-id pub-id-type="pmid">36038728</pub-id></mixed-citation>
    </ref>
    <ref id="btad579-B35">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zheng</surname><given-names>W</given-names></string-name>, <string-name><surname>Wuyun</surname><given-names>Q</given-names></string-name>, <string-name><surname>Li</surname><given-names>Y</given-names></string-name></person-group><etal>et al</etal><article-title>Detecting distant-homology protein structures by aligning deep neural-network based contact maps</article-title>. <source>PLoS Comput Biol</source><year>2019</year>;<volume>15</volume>:<fpage>e1007411</fpage>.<pub-id pub-id-type="pmid">31622328</pub-id></mixed-citation>
    </ref>
    <ref id="btad579-B36">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zimmermann</surname><given-names>L</given-names></string-name>, <string-name><surname>Stephens</surname><given-names>A</given-names></string-name>, <string-name><surname>Nam</surname><given-names>S-Z</given-names></string-name></person-group><etal>et al</etal><article-title>A completely reimplemented MPI bioinformatics toolkit with a new HHpred server at its core</article-title>. <source>J Mol Biol</source><year>2018</year>;<volume>430</volume>:<fpage>2237</fpage>–<lpage>43</lpage>.<pub-id pub-id-type="pmid">29258817</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10576641</article-id>
    <article-id pub-id-type="pmid">37725369</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btad579</article-id>
    <article-id pub-id-type="publisher-id">btad579</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Paper</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Sequence Analysis</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>pLM-BLAST: distant homology detection based on direct comparison of sequence representations from protein language models</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Kaminski</surname>
          <given-names>Kamil</given-names>
        </name>
        <aff><institution>Institute of Evolutionary Biology, Faculty of Biology, Biological and Chemical Research Centre, University of Warsaw</institution>, Warsaw 02-089, <country country="PL">Poland</country></aff>
        <aff><institution>Laboratory of Structural Bioinformatics, Centre of New Technologies, University of Warsaw</institution>, Warsaw 02-097, <country country="PL">Poland</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-3487-5433</contrib-id>
        <name>
          <surname>Ludwiczak</surname>
          <given-names>Jan</given-names>
        </name>
        <aff><institution>Institute of Evolutionary Biology, Faculty of Biology, Biological and Chemical Research Centre, University of Warsaw</institution>, Warsaw 02-089, <country country="PL">Poland</country></aff>
        <xref rid="btad579-FM1" ref-type="author-notes"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Pawlicki</surname>
          <given-names>Kamil</given-names>
        </name>
        <aff><institution>Institute of Evolutionary Biology, Faculty of Biology, Biological and Chemical Research Centre, University of Warsaw</institution>, Warsaw 02-089, <country country="PL">Poland</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-1188-473X</contrib-id>
        <name>
          <surname>Alva</surname>
          <given-names>Vikram</given-names>
        </name>
        <aff><institution>Department of Protein Evolution, Max Planck Institute for Biology Tübingen</institution>, Tübingen 72076, <country country="DE">Germany</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-4581-1558</contrib-id>
        <name>
          <surname>Dunin-Horkawicz</surname>
          <given-names>Stanislaw</given-names>
        </name>
        <aff><institution>Institute of Evolutionary Biology, Faculty of Biology, Biological and Chemical Research Centre, University of Warsaw</institution>, Warsaw 02-089, <country country="PL">Poland</country></aff>
        <aff><institution>Department of Protein Evolution, Max Planck Institute for Biology Tübingen</institution>, Tübingen 72076, <country country="DE">Germany</country></aff>
        <!--stanislaw.dunin-horkawicz@tuebingen.mpg.de-->
        <xref rid="btad579-cor1" ref-type="corresp"/>
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Cowen</surname>
          <given-names>Lenore</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <fn id="btad579-FM1">
        <p>Present address: Prescient Design, Genentech Research &amp; Early Development, Roche Group, Grenzacherstrasse 124, 4070 Basel, Switzerland.</p>
      </fn>
      <corresp id="btad579-cor1">Corresponding author. Institute of Evolutionary Biology, Faculty of Biology, Biological and Chemical Research Centre, University of Warsaw, Zwirki i Wigury 101, Warsaw 02-089, Poland; Department of Protein Evolution, Max Planck Institute for Biology Tübingen, Tübingen 72076, Germany. E-mail: <email>stanislaw.dunin-horkawicz@tuebingen.mpg.de</email> (S.D.-H.)</corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>10</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2023-09-19">
      <day>19</day>
      <month>9</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>19</day>
      <month>9</month>
      <year>2023</year>
    </pub-date>
    <volume>39</volume>
    <issue>10</issue>
    <elocation-id>btad579</elocation-id>
    <history>
      <date date-type="received">
        <day>27</day>
        <month>11</month>
        <year>2022</year>
      </date>
      <date date-type="rev-recd">
        <day>09</day>
        <month>7</month>
        <year>2023</year>
      </date>
      <date date-type="editorial-decision">
        <day>20</day>
        <month>8</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>15</day>
        <month>9</month>
        <year>2023</year>
      </date>
      <date date-type="corrected-typeset">
        <day>14</day>
        <month>10</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2023</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btad579.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>The detection of homology through sequence comparison is a typical first step in the study of protein function and evolution. In this work, we explore the applicability of protein language models to this task.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>We introduce pLM-BLAST, a tool inspired by BLAST, that detects distant homology by comparing single-sequence representations (embeddings) derived from a protein language model, ProtT5. Our benchmarks reveal that pLM-BLAST maintains a level of accuracy on par with HHsearch for both highly similar sequences (with &gt;50% identity) and markedly divergent sequences (with &lt;30% identity), while being significantly faster. Additionally, pLM-BLAST stands out among other embedding-based tools due to its ability to compute local alignments. We show that these local alignments, produced by pLM-BLAST, often connect highly divergent proteins, thereby highlighting its potential to uncover previously undiscovered homologous relationships and improve protein annotation.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>pLM-BLAST is accessible via the MPI Bioinformatics Toolkit as a web server for searching precomputed databases (<ext-link xlink:href="https://toolkit.tuebingen.mpg.de/tools/plmblast" ext-link-type="uri">https://toolkit.tuebingen.mpg.de/tools/plmblast</ext-link>). It is also available as a standalone tool for building custom databases and performing batch searches (<ext-link xlink:href="https://github.com/labstructbioinf/pLM-BLAST" ext-link-type="uri">https://github.com/labstructbioinf/pLM-BLAST</ext-link>).</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Foundation for Polish Science</institution>
            <institution-id institution-id-type="DOI">10.13039/501100001870</institution-id>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>European Regional Development Fund</institution>
            <institution-id institution-id-type="DOI">10.13039/501100008530</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>POIR.04.04.00-00-5CF1/18-00</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Max Planck Society</institution>
            <institution-id institution-id-type="DOI">10.13039/501100004189</institution-id>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="9"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1. Introduction</title>
    <p>Homology, i.e. descent from a common ancestor, and its inference are fundamental to comparative, evolutionary, and molecular biology. In the case of proteins, statistically significant local or global sequence similarity is accepted as the primary marker for inferring homology. When the similarity between the protein sequences being compared is high (<inline-formula id="IE1"><mml:math id="IM1" display="inline" overflow="scroll"><mml:mrow><mml:mo>≥</mml:mo><mml:mn>30</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math></inline-formula>), homology can be readily detected using methods based on sequence-to-sequence and sequence-to-profile comparisons such as BLAST or PSI-BLAST (<xref rid="btad579-B1" ref-type="bibr">Altschul <italic toggle="yes">et al.</italic> 1997</xref>). However, when similarity is low (<inline-formula id="IE2"><mml:math id="IM2" display="inline" overflow="scroll"><mml:mrow><mml:mo>&lt;</mml:mo><mml:mn>30</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math></inline-formula>), methods based on profile HMMs, such as HMMER and HHsearch, are currently our best tools to infer homology (<xref rid="btad579-B10" ref-type="bibr">Eddy 2011</xref>, <xref rid="btad579-B31" ref-type="bibr">Steinegger <italic toggle="yes">et al.</italic> 2019</xref>).</p>
    <p>In the case of highly distant evolutionary relationships, sequences may have diverged to the point where we can no longer detect their relatedness. Because structures diverge much more slowly than sequences, their similarity is often used to infer homology in such cases. In fact, owing to the recent revolution in structure prediction (<xref rid="btad579-B16" ref-type="bibr">Jumper <italic toggle="yes">et al.</italic> 2021</xref>, <xref rid="btad579-B21" ref-type="bibr">Lin <italic toggle="yes">et al.</italic> 2022, 2023</xref>), predicted structures are available for a large proportion of known proteins, and structural similarity is increasingly being used to infer homology. However, similar structures, particularly at the domain and subdomain levels, may have evolved convergently due to the limited number of structural solutions available to a folded polypeptide chain, and thus structural similarity is often not conclusive evidence of common ancestry. To address this issue, several deep learning-based methods have sought to detect weak sequence signals between highly divergent proteins in recent years (<xref rid="btad579-B19" ref-type="bibr">Li <italic toggle="yes">et al.</italic> 2017</xref>, <xref rid="btad579-B35" ref-type="bibr">Zheng <italic toggle="yes">et al.</italic> 2019</xref>, <xref rid="btad579-B12" ref-type="bibr">Gao and Skolnick 2021</xref>). The most promising of these methods, such as knnProtT5 (<xref rid="btad579-B29" ref-type="bibr">Schütze <italic toggle="yes">et al.</italic> 2022</xref>), EBA (<xref rid="btad579-B27" ref-type="bibr">Pantolini <italic toggle="yes">et al.</italic> 2022</xref>), TM-Vec (<xref rid="btad579-B14" ref-type="bibr">Hamamsy <italic toggle="yes">et al.</italic> 2022</xref>), DeepBLAST (<xref rid="btad579-B25" ref-type="bibr">Morton <italic toggle="yes">et al.</italic> 2023</xref>), and DEDAL (<xref rid="btad579-B22" ref-type="bibr">Llinares-López <italic toggle="yes">et al.</italic> 2023</xref>), rely on single-sequence representations obtained from protein language models (pLMs) (<xref rid="btad579-B4" ref-type="bibr">Bepler and Berger 2021</xref>). pLMs are neural networks trained in a self-supervised manner on a large number of natural protein sequences, i.e. with tasks such as guessing masked residues based on contextual information (<xref rid="btad579-B11" ref-type="bibr">Elnaggar <italic toggle="yes">et al.</italic> 2022</xref>, <xref rid="btad579-B21" ref-type="bibr">Lin <italic toggle="yes">et al.</italic> 2023</xref>). Once trained, pLMs can be used to rapidly compute the aforementioned representations (also referred to as embeddings), i.e. numerical descriptors of protein sequences that place them in the context of the total knowledge collected by the network. Because of their high information content, sequence embeddings have been successfully applied to many other tasks, including prediction of tertiary structures (<xref rid="btad579-B21" ref-type="bibr">Lin <italic toggle="yes">et al.</italic> 2023</xref>), transmembrane segments (<xref rid="btad579-B5" ref-type="bibr">Bernhofer and Rost 2022</xref>), and signal peptides (<xref rid="btad579-B33" ref-type="bibr">Teufel <italic toggle="yes">et al.</italic> 2022</xref>).</p>
    <p>In this article, we describe pLM-BLAST, a new tool for detecting local homology between protein sequences that combines pLM representations with a local similarity detection algorithm inspired by BLAST (<xref rid="btad579-B1" ref-type="bibr">Altschul <italic toggle="yes">et al.</italic> 1997</xref>). In contrast to TM-vec and DEDAL, pLM-BLAST is based on an unsupervised approach that does not require training of a specialized deep-learning model or defining positive labels based on structurally similar or homologous protein pairs. Furthermore, unlike methods such as TM-vec and EBA, which only provide global alignments, pLM-BLAST has the ability to compute both local and global alignments, which is essential for determining distant homology relationships that may depend on the conservation of short subdomain fragments (<xref rid="btad579-B2" ref-type="bibr">Alva <italic toggle="yes">et al.</italic> 2015</xref>, <xref rid="btad579-B18" ref-type="bibr">Kolodny <italic toggle="yes">et al.</italic> 2021</xref>). pLM-BLAST is based on an implementation of a modified Smith-Waterman algorithm, in which the substitution matrix is generated directly from the raw pLM representations of the two sequences to be compared. In this work, we used the pLM ProtT5 (<xref rid="btad579-B11" ref-type="bibr">Elnaggar <italic toggle="yes">et al.</italic> 2022</xref>), but this approach can be used in conjunction with other pLMs to generate local and global alignments. In benchmarks using domain pairs from the ECOD protein classification database (<xref rid="btad579-B9" ref-type="bibr">Cheng <italic toggle="yes">et al.</italic> 2014</xref>), pLM-BLAST demonstrated its suitability for fast pairwise comparisons and database searches to detect distant homology and produce highly precise alignments.</p>
  </sec>
  <sec>
    <title>2. Materials and methods</title>
    <p>pLM-BLAST extends the concept of BLAST by replacing invariant substitution matrices, such as BLOSUM62 (<xref rid="btad579-B15" ref-type="bibr">Henikoff and Henikoff 1992</xref>), with per-residue similarities between protein embeddings. Consequently, the similarity between a given pair of residues is entirely context-dependent. Such sequence context information has been shown to significantly improve the sensitivity of sequence search methods and enable the detection of nontrivial conserved patterns (<xref rid="btad579-B6" ref-type="bibr">Biegert and Söding 2009</xref>, <xref rid="btad579-B28" ref-type="bibr">Remmert <italic toggle="yes">et al.</italic> 2011</xref>). The workflow of the method is shown subsequently and in <xref rid="btad579-F1" ref-type="fig">Fig. 1</xref>.</p>
    <fig position="float" id="btad579-F1">
      <label>Figure 1.</label>
      <caption>
        <p>(A) Embeddings for the two sequences to be aligned. The <italic toggle="yes">y</italic>-axis represents the sequence dimension from N- to C-terminus, and the <italic toggle="yes">x</italic>-axis represents the embedding dimension (which is a 1024-element vector in the case of the ProtT5 protein language model). The substitution matrix is computed by matrix multiplication of both embeddings, after each residue has been normalized. (B) The scoring matrix is computed to detect continuous high-scoring regions in the substitution matrix. (C) A modified traceback procedure is used to traverse the scoring matrix to extract potentially matching regions, called paths. (D) The possible paths are mapped back onto the substitution matrix, and a moving window of defined length is used to extract high-scoring subpaths, i.e. local alignments.</p>
      </caption>
      <graphic xlink:href="btad579f1" position="float"/>
    </fig>
    <sec>
      <title>2.1 Substitution matrix</title>
      <p>The embedding of a sequence <inline-formula id="IE3"><mml:math id="IM3" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mtext>seq</mml:mtext></mml:mrow></mml:mrow><mml:mi>l</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> is given by a matrix <inline-formula id="IE4"><mml:math id="IM4" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mi>l</mml:mi></mml:msub></mml:mrow><mml:mo> </mml:mo><mml:mo>∋</mml:mo><mml:mo> </mml:mo><mml:mo>{</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula> of size <inline-formula id="IE5"><mml:math id="IM5" display="inline" overflow="scroll"><mml:mrow><mml:mi>n</mml:mi><mml:mo>×</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:math></inline-formula>, where <italic toggle="yes">n</italic> and <italic toggle="yes">m</italic> denote the number of residues and the size of the embedding, respectively. To obtain standardized and comparable results, the values for each residue embedding are normalized by dividing them by the Euclidean norm of the row</p>
      <disp-formula id="E1">
        <label>(1)</label>
        <mml:math id="M1" display="block" overflow="scroll">
          <mml:mrow>
            <mml:mrow>
              <mml:msubsup>
                <mml:mrow>
                  <mml:mi>e</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>i</mml:mi>
                  <mml:mi>j</mml:mi>
                </mml:mrow>
                <mml:mo>†</mml:mo>
              </mml:msubsup>
            </mml:mrow>
            <mml:mo>=</mml:mo>
            <mml:mrow>
              <mml:mfrac>
                <mml:mn>1</mml:mn>
                <mml:mrow>
                  <mml:msqrt>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:munderover>
                          <mml:mo>∑</mml:mo>
                          <mml:mrow>
                            <mml:mi>j</mml:mi>
                            <mml:mo>=</mml:mo>
                            <mml:mi>m</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>j</mml:mi>
                            <mml:mo>=</mml:mo>
                            <mml:mn>0</mml:mn>
                          </mml:mrow>
                        </mml:munderover>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mrow>
                          <mml:msubsup>
                            <mml:mrow>
                              <mml:mi>e</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>i</mml:mi>
                              <mml:mi>j</mml:mi>
                            </mml:mrow>
                            <mml:mn>2</mml:mn>
                          </mml:msubsup>
                        </mml:mrow>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:msqrt>
                </mml:mrow>
              </mml:mfrac>
            </mml:mrow>
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mi>e</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>i</mml:mi>
                  <mml:mi>j</mml:mi>
                </mml:mrow>
              </mml:msub>
            </mml:mrow>
          </mml:mrow>
          <mml:mo>,</mml:mo>
        </mml:math>
      </disp-formula>
      <p>where <inline-formula id="IE6"><mml:math id="IM6" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> denotes the <inline-formula id="IE7"><mml:math id="IM7" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mi>l</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> matrix element in the <italic toggle="yes">i</italic>-th row and <italic toggle="yes">j</italic>-th column, and <inline-formula id="IE8"><mml:math id="IM8" display="inline" overflow="scroll"><mml:mo>†</mml:mo></mml:math></inline-formula> is the normalization operator. In pLM-BLAST, a substitution matrix <inline-formula id="IE9"><mml:math id="IM9" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> (<xref rid="btad579-F1" ref-type="fig">Fig. 1A</xref>) for two sequences <inline-formula id="IE10"><mml:math id="IM10" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mtext>seq</mml:mtext></mml:mrow></mml:mrow><mml:mi>l</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE11"><mml:math id="IM11" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mtext>seq</mml:mtext></mml:mrow></mml:mrow><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> is calculated as</p>
      <disp-formula id="E2">
        <label>(2)</label>
        <mml:math id="M2" display="block" overflow="scroll">
          <mml:mrow>
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mi>S</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>l</mml:mi>
                  <mml:mi>k</mml:mi>
                </mml:mrow>
              </mml:msub>
            </mml:mrow>
            <mml:mo>=</mml:mo>
            <mml:mrow>
              <mml:msubsup>
                <mml:mrow>
                  <mml:mi>E</mml:mi>
                </mml:mrow>
                <mml:mi>l</mml:mi>
                <mml:mrow>
                  <mml:mo>†</mml:mo>
                  <mml:mi>T</mml:mi>
                </mml:mrow>
              </mml:msubsup>
            </mml:mrow>
            <mml:mrow>
              <mml:msubsup>
                <mml:mrow>
                  <mml:mi>E</mml:mi>
                </mml:mrow>
                <mml:mi>k</mml:mi>
                <mml:mo>†</mml:mo>
              </mml:msubsup>
            </mml:mrow>
          </mml:mrow>
          <mml:mo>.</mml:mo>
        </mml:math>
      </disp-formula>
      <p>The element <inline-formula id="IE12"><mml:math id="IM12" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> of the matrix <inline-formula id="IE13"><mml:math id="IM13" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> is in the interval <inline-formula id="IE14"><mml:math id="IM14" display="inline" overflow="scroll"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> and denotes the embedding similarity of the <italic toggle="yes">i</italic>-th residue of <inline-formula id="IE15"><mml:math id="IM15" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mtext>seq</mml:mtext></mml:mrow></mml:mrow><mml:mi>l</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> and the <italic toggle="yes">j</italic>-th residue of <inline-formula id="IE16"><mml:math id="IM16" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mtext>seq</mml:mtext></mml:mrow></mml:mrow><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>. This is equivalent to calculating the cosine similarity of each pair of residues from <inline-formula id="IE17"><mml:math id="IM17" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mtext>seq</mml:mtext></mml:mrow></mml:mrow><mml:mi>l</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE18"><mml:math id="IM18" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mtext>seq</mml:mtext></mml:mrow></mml:mrow><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> placing them in a 2D array indexed by the residues of each sequence.</p>
    </sec>
    <sec>
      <title>2.2 Scoring matrix</title>
      <p>To obtain local alignments, a scheme adapted from the Smith-Waterman algorithm is used to create a scoring matrix (<xref rid="btad579-F1" ref-type="fig">Fig. 1B</xref>) <inline-formula id="IE19"><mml:math id="IM19" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>L</mml:mi><mml:mi>K</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>∋</mml:mo><mml:mo>{</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula> of size <inline-formula id="IE20"><mml:math id="IM20" display="inline" overflow="scroll"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>|</mml:mo><mml:mi>L</mml:mi><mml:mo>|</mml:mo><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>×</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mo>|</mml:mo><mml:mi>K</mml:mi><mml:mo>|</mml:mo><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, where the first row and column are filled with zeros and the rest of the matrix is filled using the following procedure:</p>
      <disp-formula id="E3">
        <label>(3)</label>
        <mml:math id="M3" display="block" overflow="scroll">
          <mml:mrow>
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mi>h</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>i</mml:mi>
                  <mml:mi>j</mml:mi>
                </mml:mrow>
              </mml:msub>
            </mml:mrow>
            <mml:mo>=</mml:mo>
            <mml:mi>max</mml:mi>
            <mml:mrow>
              <mml:mo stretchy="true">{</mml:mo>
              <mml:mrow>
                <mml:mtable>
                  <mml:mtr columnalign="left">
                    <mml:mtd columnalign="left">
                      <mml:mrow>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>h</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>i</mml:mi>
                              <mml:mo>−</mml:mo>
                              <mml:mn>1</mml:mn>
                              <mml:mo>,</mml:mo>
                              <mml:mi>j</mml:mi>
                              <mml:mo>−</mml:mo>
                              <mml:mn>1</mml:mn>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mo>+</mml:mo>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>s</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>i</mml:mi>
                              <mml:mi>j</mml:mi>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                      </mml:mrow>
                    </mml:mtd>
                  </mml:mtr>
                  <mml:mtr columnalign="left">
                    <mml:mtd columnalign="left">
                      <mml:mrow>
                        <mml:mrow>
                          <mml:munder>
                            <mml:mrow>
                              <mml:mi>max</mml:mi>
                            </mml:mrow>
                            <mml:mi>p</mml:mi>
                          </mml:munder>
                        </mml:mrow>
                        <mml:mo>{</mml:mo>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>h</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>i</mml:mi>
                              <mml:mo>−</mml:mo>
                              <mml:mi>p</mml:mi>
                              <mml:mo>,</mml:mo>
                              <mml:mi>j</mml:mi>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mo>}</mml:mo>
                      </mml:mrow>
                    </mml:mtd>
                  </mml:mtr>
                  <mml:mtr columnalign="left">
                    <mml:mtd columnalign="left">
                      <mml:mrow>
                        <mml:mrow>
                          <mml:munder>
                            <mml:mrow>
                              <mml:mi>max</mml:mi>
                            </mml:mrow>
                            <mml:mi>s</mml:mi>
                          </mml:munder>
                        </mml:mrow>
                        <mml:mo>{</mml:mo>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>h</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>i</mml:mi>
                              <mml:mo>,</mml:mo>
                              <mml:mi>j</mml:mi>
                              <mml:mo>−</mml:mo>
                              <mml:mi>s</mml:mi>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mo>}</mml:mo>
                      </mml:mrow>
                    </mml:mtd>
                  </mml:mtr>
                </mml:mtable>
              </mml:mrow>
            </mml:mrow>
          </mml:mrow>
          <mml:mo>.</mml:mo>
        </mml:math>
      </disp-formula>
      <p>Unlike the original Smith–Waterman algorithm, pLM-BLAST does not use gap penalties because the <inline-formula id="IE21"><mml:math id="IM21" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> values for dissimilar regions are negative or close to zero due to the cosine similarity property. In addition, the above equation does not truncate the values to zero, which results in a more severe penalty for dissimilar regions, thus reducing the total number of potential alignments.</p>
    </sec>
    <sec>
      <title>2.3 Traceback procedure</title>
      <p>To identify possible matching regions for a given pair of sequences, a traceback procedure is used to traverse the scoring matrix (<xref rid="btad579-F1" ref-type="fig">Fig. 1C</xref>). Unlike the SW algorithm, we do not start with the highest value in the scoring matrix, but traverse from all sequence boundaries. Thus, in our approach, the traceback procedure does not produce a single alignment, but multiple candidates for possible alignments. For this purpose, <italic toggle="yes">n</italic> possible paths <italic toggle="yes">P</italic> are constructed, starting from the right and bottom edges of the matrix <italic toggle="yes">H</italic>. The path <inline-formula id="IE22"><mml:math id="IM22" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> is a set of coordinates from the matrix <inline-formula id="IE23"><mml:math id="IM23" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>L</mml:mi><mml:mi>K</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, where <inline-formula id="IE24"><mml:math id="IM24" display="inline" overflow="scroll"><mml:mrow><mml:mi>n</mml:mi><mml:mo>∈</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:math></inline-formula> and <italic toggle="yes">N</italic> equals <inline-formula id="IE25"><mml:math id="IM25" display="inline" overflow="scroll"><mml:mrow><mml:mo>|</mml:mo><mml:mi>L</mml:mi><mml:mo>|</mml:mo><mml:mo>+</mml:mo><mml:mo>|</mml:mo><mml:mi>K</mml:mi><mml:mo>|</mml:mo></mml:mrow></mml:math></inline-formula>.</p>
      <p>
        <boxed-text id="btad579-BOX1" position="float">
          <caption>
            <p>Algorithm 1 outputs set P</p>
          </caption>
          <p><bold>Require:</bold> <italic toggle="yes">H</italic></p>
          <p>1:  <bold>for</bold><inline-formula id="IE26"><mml:math id="IM26" display="inline" overflow="scroll"><mml:mrow><mml:mi>n</mml:mi><mml:mo>∈</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:math></inline-formula><bold>do</bold></p>
          <p>2:     Initialize <inline-formula id="IE27"><mml:math id="IM27" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> with an empty list</p>
          <p>3:    Set <inline-formula id="IE28"><mml:math id="IM28" display="inline" overflow="scroll"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mo>′</mml:mo></mml:msup></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mo>′</mml:mo></mml:msup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> to <italic toggle="yes">n</italic>-th border coordinates</p>
          <p>4:    <bold>while</bold><inline-formula id="IE29"><mml:math id="IM29" display="inline" overflow="scroll"><mml:mrow><mml:mi>i</mml:mi><mml:mo>≥</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> and j <inline-formula id="IE30"><mml:math id="IM30" display="inline" overflow="scroll"><mml:mrow><mml:mo>≥</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula><bold>do</bold></p>
          <p>5:      <inline-formula id="IE31"><mml:math id="IM31" display="inline" overflow="scroll"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mo>′</mml:mo></mml:msup></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mo>′</mml:mo></mml:msup></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mtext>argmax</mml:mtext></mml:mrow></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula></p>
          <p>6:      <bold>if</bold><inline-formula id="IE32"><mml:math id="IM32" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mo>′</mml:mo></mml:msup></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:mrow></mml:msub></mml:mrow><mml:mo>≤</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula><bold>then</bold></p>
          <p>8:        <inline-formula id="IE33"><mml:math id="IM33" display="inline" overflow="scroll"><mml:mrow><mml:mtext>break</mml:mtext></mml:mrow></mml:math></inline-formula></p>
          <p>9:      <bold>else</bold></p>
          <p>10:        Append <inline-formula id="IE34"><mml:math id="IM34" display="inline" overflow="scroll"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mo>′</mml:mo></mml:msup></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mo>′</mml:mo></mml:msup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> to <inline-formula id="IE35"><mml:math id="IM35" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula></p>
          <p>11:        Decrement <italic toggle="yes">i</italic>, <italic toggle="yes">j</italic> by one</p>
          <p>12:      <bold>end if</bold></p>
          <p>13:    <bold>end while</bold></p>
          <p>14:  <bold>end for</bold></p>
        </boxed-text>
      </p>
    </sec>
    <sec>
      <title>2.4 Local alignment</title>
      <p>Each path generated by the traceback algorithm is scanned for the presence of high-scoring subpaths (i.e. local alignments) using the values of the corresponding region in the substitution matrix. To this end, a moving average with a defined fixed window length is applied to each path <inline-formula id="IE36"><mml:math id="IM36" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> and subpaths whose average score is above the sigma threshold are captured. By default, the threshold is set to 2 sigmas, which is defined as two times the average standard deviation of the substitution matrix. Our tests showed that the standard deviation of the substitution matrix tends to be ∼0.075, while the path score for meaningful alignments is an order of magnitude higher. However, increasing (<inline-formula id="IE37"><mml:math id="IM37" display="inline" overflow="scroll"><mml:mrow><mml:mo>&gt;</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula>) or decreasing (<inline-formula id="IE38"><mml:math id="IM38" display="inline" overflow="scroll"><mml:mrow><mml:mo>&lt;</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula>) the standard deviation cutoff makes the algorithm more strict or more permissive, respectively.</p>
    </sec>
    <sec>
      <title>2.5 Global alignment</title>
      <p>In addition to local alignments, pLM-BLAST can also perform global alignments using the Needleman–Wunsch algorithm (<xref rid="btad579-B26" ref-type="bibr">Needleman and Wunsch 1970</xref>). The original algorithm remains the same except that the similarity matrix is replaced by the embedding-based substitution matrix <italic toggle="yes">S</italic> and the gap penalty is set to zero.</p>
    </sec>
    <sec id="sec2.6">
      <title>2.6 Homology benchmark</title>
      <p>To evaluate the ability of pLM-BLAST and other methods to detect homology between protein sequences, we constructed two benchmark sets based on the ECOD database (<xref rid="btad579-B9" ref-type="bibr">Cheng <italic toggle="yes">et al.</italic> 2014</xref>): first, “hard,” which focuses on difficult cases where the similarity between sequences does not exceed 30%; and second, “easy,” where we test the methods in detecting homology between sequences with 50%–70% similarity.</p>
      <p>To construct the “hard” set, the sequences of all ECOD domains (version 20220912), excluding nested domains, with a length of 50–600 amino acids were obtained using the <italic toggle="yes">localpdb</italic> ECOD plugin (<xref rid="btad579-B24" ref-type="bibr">Ludwiczak <italic toggle="yes">et al.</italic> 2022</xref>) and clustered using MMSeqs2 with a sequence identity cutoff of 30% (<xref rid="btad579-B30" ref-type="bibr">Steinegger and Söding 2017</xref>). The longest sequences were selected as cluster representatives and those belonging to H-groups with less than five members were removed. The final benchmark set was created by randomly selecting five domains from 300 H-groups, i.e. ECOD levels that group together homologous domains with common ancestry. This procedure was designed to select domains from different T-groups; a T-group is a sublevel that groups together homologous domains within an H-group that are topologically similar. As a result, we obtained a set of 1500 ECOD domains from 300 H-groups, none of which shared &gt;30% sequence identity.</p>
      <p>For each ECOD domain in the benchmark set, an HMM profile and sequence embedding were calculated using three iterations of HHblits over the UniRef30 database with default settings (<xref rid="btad579-B31" ref-type="bibr">Steinegger <italic toggle="yes">et al.</italic> 2019</xref>) and ProtT5 (<monospace>prot_t5_xl_half_uniref</monospace>50<monospace>-enc</monospace>) (<xref rid="btad579-B11" ref-type="bibr">Elnaggar <italic toggle="yes">et al.</italic> 2022</xref>), respectively. The embeddings were compared all-against-all with pLM-BLAST (in local and global mode), TM-Vec, and EBA, while the HMM profiles were compared with HHsearch. Matches between domains of the same H-group were considered true positives, matches between different H-groups belonging to the same X-group (an ECOD classification level that groups H-groups that may be homologous) were considered neutral, and finally matches between different X-groups were considered false positives. For the calculation of precision-recall curves (<xref rid="btad579-F2" ref-type="fig">Fig. 2A</xref>), we filled missing data (i.e. pairs for which a given method did not provide a score) with zeros, assuming that the lack of prediction can be considered a negative prediction. In <xref rid="btad579-F2" ref-type="fig">Fig. 2A</xref>, the regions of the curves resulting from such a completion procedure have been omitted for clarity (the complete curves are available as <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S1</xref>). We used the HHsearch match probability, the EBA max score, and the raw pLM-BLAST and TM-Vec scores to calculate the plots.</p>
      <fig position="float" id="btad579-F2">
        <label>Figure 2.</label>
        <caption>
          <p>Performance of pLM-BLAST and other methods in detecting homology and analogy between protein sequences. (A) Benchmark for the task of reconstructing H-groups as defined in the ECOD database. The left panel shows the precision-recall curve and the right panel shows the number of true and false positives. The false positives are plotted on a logarithmic scale. (B) A comparison of methods on a set of 89 analogous protein pairs. The percentages denote the fraction of pairs for which a particular method yields a score. These cases are quantified in terms of the returned score (<italic toggle="yes">x</italic>-axis) and the coverage of the analogous region shared by the pairs (<italic toggle="yes">y</italic>-axis). The red vertical dashed lines correspond to the average score for homologous pairs.</p>
        </caption>
        <graphic xlink:href="btad579f2" position="float"/>
      </fig>
      <p>A similar procedure was used to construct the “easy” benchmark set. As with the “hard” set, the ECOD was first clustered using MMSeqs2 with a 70% sequence identity cutoff to remove redundancy. The resulting sequences were then clustered again using a 50% sequence identity cutoff, and those from clusters containing less than seven members or containing members from more than one ECOD H-group were removed. Finally, for each H-group, only the largest MMSeqs2 cluster was retained. As a result, we obtained 1032 ECOD domains grouped into 103 clusters. In the “easy” benchmark, we used a stricter definition of positives and negatives, defining sequence pairs belonging to the same cluster as positives and the rest as negatives.</p>
    </sec>
    <sec>
      <title>2.7 Analogy benchmark</title>
      <p>To assess the ability of the methods to distinguish homologous from analogous sequences, we used the MALISAM database (<xref rid="btad579-B8" ref-type="bibr">Cheng <italic toggle="yes">et al.</italic> 2008</xref>), which collects examples of protein pairs that share similar structural motifs that have evolved convergently. Eighty-nine such cases were obtained from the database website (<ext-link xlink:href="http://prodata.swmed.edu/malisam/" ext-link-type="uri">http://prodata.swmed.edu/malisam/</ext-link>) and processed to define structurally alignable pairs of residues belonging to the analogous motifs. Each pair of sequences was aligned using pLM-BLAST in local and global modes, HHsearch, and EBA, and the resulting aligned pairs were compared with those from the MALISAM database. Based on these comparisons, the total coverage of the analogous motif and the score of the respective alignment were defined for each case (<xref rid="btad579-F2" ref-type="fig">Fig. 2B</xref>).</p>
    </sec>
    <sec id="sec2.8">
      <title>2.8 Alignment quality benchmark</title>
      <p>To evaluate the quality of the alignments generated by HHsearch, pLM-BLAST, EBA, and BLAST, we followed a procedure previously described in <xref rid="btad579-B28" ref-type="bibr">Remmert <italic toggle="yes">et al.</italic> (2011)</xref>. First, we extracted all pairs from the “hard” benchmark set (see above) for which all methods produced an alignment. Then, for each pair, we computed the structural alignment using the USalign tool (<xref rid="btad579-B34" ref-type="bibr">Zhang <italic toggle="yes">et al.</italic> 2022</xref>) and discarded those for which the TM score was &lt;0.5, resulting in 444 pairs. The structure-based sequence alignments provided by USalign defined the ground truth against which the alignments of each method were compared. Specifically, we considered the precision, i.e. the fraction of correctly aligned pairs out of all aligned pairs, and the sensitivity, i.e. the fraction of correctly aligned pairs out of all structurally alignable pairs. The precision and sensitivity values were averaged for each method and plotted (<xref rid="btad579-F3" ref-type="fig">Fig. 3</xref>). We also attempted to evaluate TM-Vec alignments, but for technical reasons were unable to run the DeepBlast model (<xref rid="btad579-B25" ref-type="bibr">Morton <italic toggle="yes">et al.</italic> 2023</xref>) required for alignment generation, but we expect it to perform with an accuracy comparable to other global alignment methods.</p>
      <fig position="float" id="btad579-F3">
        <label>Figure 3.</label>
        <caption>
          <p>Alignment quality benchmark. Each point represents the average per-residue sensitivity (<italic toggle="yes">y</italic>-axis) and per-residue precision (<italic toggle="yes">x</italic>-axis) achieved in the reconstruction of 444 structure-based alignments by a specific method.</p>
        </caption>
        <graphic xlink:href="btad579f3" position="float"/>
      </fig>
    </sec>
    <sec>
      <title>2.9 Speed benchmark</title>
      <p>To evaluate the speed of pLM-BLAST and other methods, we performed a benchmark using five query sequences (<xref rid="sup1" ref-type="supplementary-material">Supplementary File S1</xref>) of different lengths and folds to search the ECOD70 database, i.e. the ECOD database filtered to maximum 70% identity with MMseqs2. To generate the HHsearch database, we used HHblits run with three iterations on the UniRef30 database (UniRef database filtered to maximum 30% sequence identity), version 2022_02. The benchmark covered the time needed to prepare a given query (embedding calculation or HHblits search) and to search the database. pLM-BLAST was used with cosine similarity pre-filtering (see the next subsection) with the cutoff set at the 90th percentile. All calculations were performed for a fixed computer specification of a 6-core CPU and a single GPU. The benchmark was run four times for each method and the run times were averaged.</p>
    </sec>
    <sec id="sec2.10">
      <title>2.10 Cosine similarity prefiltering</title>
      <p>Typically, when dealing with embeddings, protein similarity is inferred as the cosine similarity between perprotein embeddings (global representations). This approach is very fast, but suffers from the loss of information stored in the per-residue embeddings (local representations) due to the averaging that occurs when the representation is converted to a fixed-size vector. This loss of information makes it impossible to capture local similarities and significantly reduces the ability to detect distant homology. With this in mind, we have developed a procedure that provides a tradeoff between the use of global and local representations.</p>
      <p>For a given pair of sequences (e.g. the query and one of the database sequences), per-residue embeddings are taken and treated as 2D images (<xref rid="btad579-F1" ref-type="fig">Fig. 1A</xref>), where one dimension is the sequence length and the other is the embedding size (1024 for ProtT5). We then convolve one embedding with another, where the first dimension of each convolution window is user-defined (30 by default) and the second dimension is fixed and equal to the size of the embedding dimension (1024 for ProtT5). This approach produces a 2D matrix in which each element represents the cosine similarity between each embedding slice of the two sequences. Finally, only if the resulting matrix has a value above the user-specified threshold, the corresponding sequences are passed to the actual pLM-BLAST method.</p>
    </sec>
  </sec>
  <sec>
    <title>3. Results and discussion</title>
    <sec>
      <title>3.1 Homology detection</title>
      <p>To assess the performance of pLM-BLAST in homology detection, we conducted a comparison with state-of-the-art methods such as BLAST and HHsearch, as well as other embedding-based methods (TM-Vec and EBA), using the Evolutionary Classification of Protein Domains (ECOD) database as a reference (<xref rid="btad579-B9" ref-type="bibr">Cheng <italic toggle="yes">et al.</italic> 2014</xref>). The ECOD database categorizes protein domains based on their evolutionary relationships and structural similarities and organizes them into families, topologies, homologous groups (H-groups), possibly homologous groups (X-groups), and architectures. To evaluate the ability of each method to reconstruct 300 selected ECOD H-groups, two metrics were used: the precision-recall curve and the ratio of true positives to false positives (as shown in <xref rid="btad579-F2" ref-type="fig">Fig. 2</xref>). For this study, we specifically curated the benchmark set to ensure that no pair of sequences exceeded 30% similarity, which led to a particularly challenging dataset that we refer to as the “hard” set.</p>
      <p>In the “hard” benchmark, EBA performed best, followed by HHsearch and pLM-BLAST, both of which offer similar levels of accuracy; meanwhile, TM-Vec and BLAST underperformed (<xref rid="btad579-F2" ref-type="fig">Fig. 2</xref>). The unexpected discrepancy in performance between EBA, TM-Vec, and pLM-BLAST is noteworthy, given they all use the same representations derived from the ProtT5 language model. Unlike the better-performing methods, pLM-BLAST and EBA, which rely solely on unsupervised comparisons of raw representations, TM-Vec, the worst-performing method, uses ProtT5 representations as input for a specially trained end-to-end deep learning model to generate structural alignments. This suggests that the raw embeddings carry sufficient information for homology detection, whereas the structural similarity predicted by TM-Vec serves as a much less informative marker for homology.</p>
      <p>The superior performance of EBA among ProtT5-based methods can be attributed to its utilization of an efficient signal enhancement procedure, which facilitates a more effective comparison of representations (<xref rid="btad579-B27" ref-type="bibr">Pantolini <italic toggle="yes">et al.</italic> 2022</xref>). It should also be noted that EBA provides only global alignments, which are expected to perform better than local alignments on a benchmark set consisting of domains, rather than full-length sequences. This relationship is evident in the performance comparison between pLM-BLAST running in local and global modes, with the latter consistently outperforming the former.</p>
    </sec>
    <sec>
      <title>3.2 Analogy detection</title>
      <p>Given the strong performance of pLM-BLAST and EBA in the distant homology detection benchmark, where they achieved accuracies comparable to HHsearch (<xref rid="btad579-F2" ref-type="fig">Fig. 2A</xref>), we further tested them for their ability to distinguish homology from analogy (i.e. sequence similarity resulting from convergent evolution rather than common ancestry). To do this, we used 89 cases from the MALISAM database (<xref rid="btad579-B8" ref-type="bibr">Cheng <italic toggle="yes">et al.</italic> 2008</xref>), which collects examples of protein motifs that share similar structures due to analogous origins. HHsearch and pLM-BLAST’s local alignments covered the analogous regions in only 2% and 3% of the test cases, respectively, all with scores below those expected for clearly homologous pairs (<xref rid="btad579-F2" ref-type="fig">Fig. 2B</xref>). In contrast, pLM-BLAST and EBA global alignments covered analogous regions in 31% and 33% of cases, respectively, but also with scores below those expected for homologous sequences. These results suggest that embedding-based methods, much like HHsearch, are not misled by analogous signals, especially when local alignments are used.</p>
    </sec>
    <sec>
      <title>3.3 Alignment quality</title>
      <p>The benchmarks described above focused on the detection of homologous domain pairs based on the provided scores. However, an equally important aspect is the extent to which the generated alignments are correct at the per-residue level. To evaluate this, we used structure-based sequence alignments as a reference point against which the individual sequence-based alignments were compared. For each method, we calculated per-residue precision and sensitivity coefficients (see <xref rid="sec2.8" ref-type="sec">Section 2.8</xref> for details). The results obtained indicate that pLM-BLAST global, EBA global, and HHsearch all provided very good alignments, with EBA global slightly less effective in terms of precision (<xref rid="btad579-F3" ref-type="fig">Fig. 3</xref>). The pLM-BLAST in local mode also provided good precision but lower sensitivity, indicating that its alignments are as precise as those of HHsearch and other embedding-based methods, which run in global mode but shorter, thus not covering all structurally alignable pairs. As we will illustrate later in the text, such short alignments may correspond to ancestral fragments (<xref rid="btad579-B2" ref-type="bibr">Alva <italic toggle="yes">et al.</italic> 2015</xref>, <xref rid="btad579-B18" ref-type="bibr">Kolodny <italic toggle="yes">et al.</italic> 2021</xref>) that are shared between different protein folds.</p>
    </sec>
    <sec>
      <title>3.4 Comparison of similar sequences</title>
      <p>Above, we discussed pLM-BLAST and related methods in the context of detecting homology between highly divergent sequences that share &lt;30% pairwise sequence identity. However, sequences sharing ≥50% identity are also routinely compared in bioinformatics tasks. Bearing this in mind, we considered an additional “easy” benchmark set, where homologous sequences share between 50% and 70% identity (see <xref rid="sec2.6" ref-type="sec">Section 2.6</xref> for details). This benchmark was also based on domain sequences from the ECOD database, but it aimed to reconstruct clusters defined by MMseqs2 instead of ECOD H-groups</p>
      <p>The results obtained indicate that pLM-BLAST and all other benchmarked methods perform almost perfectly in this task (<xref rid="btad579-F4" ref-type="fig">Fig. 4</xref>). Only at precision and recall rates &gt;95% can minor differences be observed, with BLAST outperforming the others and TM-Vec demonstrating the lowest accuracy. pLM-BLAST and EBA in global alignment mode perform equally well, closely followed by HHsearch and pLM-BLAST in local mode. The strong performance of pLM-BLAST, EBA, and TM-Vec in this test suggests that embedding-based methods are a viable option for comparing similar sequences and should be considered in the development of new tools for sequence searching and clustering, akin to DIAMOND (<xref rid="btad579-B7" ref-type="bibr">Buchfink <italic toggle="yes">et al.</italic> 2021</xref>) or MMseqs2 (<xref rid="btad579-B30" ref-type="bibr">Steinegger and Söding 2017</xref>).</p>
      <fig position="float" id="btad579-F4">
        <label>Figure 4.</label>
        <caption>
          <p>Performance of pLM-BLAST and other methods in classifying sequences with 50%–70% identity. (A) Precision-recall curve. (B) The same precision-recall curve as in (A) is shown, but it is limited to the precision and recall ranges that are &gt;95%.</p>
        </caption>
        <graphic xlink:href="btad579f4" position="float"/>
      </fig>
    </sec>
    <sec>
      <title>3.5 Speed benchmark</title>
      <p>A critical aspect of large-scale analyses is computational speed. Bearing this in mind, we evaluated the speed of pLM-BLAST, EBA, HHsearch, and TM-Vec while searching the ECOD70 database (over 62 000 records) using five example queries of varying lengths (<xref rid="sup1" ref-type="supplementary-material">Supplementary File S1</xref>).</p>
      <p>The results reveal (<xref rid="btad579-T1" ref-type="table">Table 1</xref>) that TM-Vec is the fastest method, despite being the worst performer in the homology detection benchmark (<xref rid="btad579-F2" ref-type="fig">Fig. 2</xref>). pLM-BLAST, the second fastest method, is on average twice as fast as HHsearch and three times faster than EBA. The only case where HHsearch outperformed pLM-BLAST was a coiled-coil domain (query 2 in <xref rid="btad579-T1" ref-type="table">Table 1</xref>), where only a few homologous sequences could be detected. These results suggest that pLM-BLAST offers an optimal balance between accuracy and speed, with its performance being comparable to HHsearch (see <xref rid="btad579-F2" ref-type="fig">Figs. 2</xref> and <xref rid="btad579-F3" ref-type="fig">3</xref>), yet faster, and offering new insights into protein evolution, as discussed later. EBA, which delivered the best performance in the homology detection benchmark, was also the slowest method. This is probably because it lacks the pre-filtering step employed by pLM-BLAST (see <xref rid="sec2.10" ref-type="sec">Section 2.10</xref>).</p>
      <table-wrap position="float" id="btad579-T1">
        <label>Table 1.</label>
        <caption>
          <p>Speed comparison between pLM-BLAST and other methods.<xref rid="tblfn1" ref-type="table-fn"><sup>a</sup></xref></p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th rowspan="1" colspan="1">Method</th>
              <th rowspan="1" colspan="1">Query 1 (269)</th>
              <th rowspan="1" colspan="1">Query 2 (55)</th>
              <th rowspan="1" colspan="1">Query 3 (379)</th>
              <th rowspan="1" colspan="1">Query 4 (88)</th>
              <th rowspan="1" colspan="1">Query 5 (132)</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">pLM-BLAST local</td>
              <td rowspan="1" colspan="1">2 min 5 s</td>
              <td rowspan="1" colspan="1">54 s</td>
              <td rowspan="1" colspan="1">2 min 30 s</td>
              <td rowspan="1" colspan="1">1 min 3 s</td>
              <td rowspan="1" colspan="1">1 min 27 s</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">HHsearch</td>
              <td rowspan="1" colspan="1">5 min 9 s</td>
              <td rowspan="1" colspan="1">38 s</td>
              <td rowspan="1" colspan="1">3 min 4 s</td>
              <td rowspan="1" colspan="1">4 min 2 s</td>
              <td rowspan="1" colspan="1">2 min 57 s</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">EBA</td>
              <td rowspan="1" colspan="1">7 min 10 s</td>
              <td rowspan="1" colspan="1">3 min 15 s</td>
              <td rowspan="1" colspan="1">7 min 23 s</td>
              <td rowspan="1" colspan="1">3 min 46 s</td>
              <td rowspan="1" colspan="1">5 min 0 s</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">TM-Vec</td>
              <td rowspan="1" colspan="1">15 s</td>
              <td rowspan="1" colspan="1">15 s</td>
              <td rowspan="1" colspan="1">15 s</td>
              <td rowspan="1" colspan="1">15 s</td>
              <td rowspan="1" colspan="1">15 s</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <fn id="tblfn1">
            <label>a</label>
            <p>The runtimes are presented in seconds, and the length of each query sequence is provided in brackets.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
    </sec>
    <sec>
      <title>3.5 Potential to discover new homology relationships</title>
      <p>Given the ability of pLM-BLAST to detect homology (<xref rid="btad579-F2" ref-type="fig">Fig. 2A</xref>), distinguish between homology and analogy (<xref rid="btad579-F2" ref-type="fig">Fig. 2B</xref>), and provide high-precision alignments (<xref rid="btad579-F3" ref-type="fig">Fig. 3</xref>), we speculated that some of the high-scoring connections between different H-groups of the same X-group, or even different X-groups, could reflect true homology.</p>
      <p>In the benchmark of pLM-BLAST run in the local mode, the most number of connections between H-groups were found in the Alpha-beta plaits and Flavodoxin-like X-groups (see <xref rid="sup1" ref-type="supplementary-material">Supplementary File S2</xref> for the full list of connected H-groups). Most of these intra-X-group matches were not detected by either HHsearch, which is expected since it was used to define homologous relationships in the ECOD database (<xref rid="btad579-B9" ref-type="bibr">Cheng <italic toggle="yes">et al.</italic> 2014</xref>), or EBA, which typically yielded low scores. We also detected connections between domains of different X-groups, often hinged on the presence of a subdomain-sized fragment (<xref rid="btad579-B2" ref-type="bibr">Alva <italic toggle="yes">et al.</italic> 2015</xref>, <xref rid="btad579-B18" ref-type="bibr">Kolodny <italic toggle="yes">et al.</italic> 2021</xref>; <xref rid="sup1" ref-type="supplementary-material">Supplementary File S3</xref>); for example, between the P-loop, Rossmann, and Flavodoxin folds (<xref rid="btad579-B23" ref-type="bibr">Longo <italic toggle="yes">et al.</italic> 2020</xref>, <xref rid="btad579-B17" ref-type="bibr">Kolodny 2021</xref>). Among these cases, we found a fragment conserved between domains of two different sandwich folds, namely cupredoxin (ECOD H-group 3156.1) and immunoglobulin (11.1, 5 A). Despite a global structural similarity (DALI Z-score = 2.7), the sequences of these two proteins could be aligned only over a short region corresponding to a beta-hairpin motif. This motif may represent an ancestral fragment that has been independently “decorated” with secondary structural elements, resulting in the two observed structures. In such a scenario, only the two beta-hairpin motifs would be truly homologous, while the overall structural similarity could be attributed to convergent evolution. Moreover, a homologous relationship between these two domains has been discussed previously (<xref rid="btad579-B13" ref-type="bibr">Gough and Chothia 2004</xref>, <xref rid="btad579-B32" ref-type="bibr">Stevens 2008</xref>), and a pLM-BLAST scan of the entire ECOD database using a cupredoxin domain as a query revealed additional connections to other Ig-like domains (<xref rid="btad579-F5" ref-type="fig">Fig. 5</xref>). Among them, we identified structures from different ECOD H-groups of the immunoglobulin-like beta-sandwich X-group (also see <xref rid="sup1" ref-type="supplementary-material">Supplementary File S3</xref>), suggesting homology in the region of the beta-hairpin motif. Interestingly, the matches also included a significantly different jelly-roll fold. Although the structural similarity between cupredoxin and jelly-roll folds is not as apparent as that of the of the cupredoxin and Ig-like folds, all share a Greek key motif in their core, lending credence to a hypothesis of a common origin.</p>
      <fig position="float" id="btad579-F5">
        <label>Figure 5.</label>
        <caption>
          <p>pLM-BLAST scan of the ECOD database using the sequence of the cupredoxin domain. (A) A substitution matrix illustrating the similarity between cupredoxin and immunoglobulin folds. The numbered axes indicate consecutive residues. The lighter the color, the higher the similarity between the sequences in a given region. The best local alignment is indicated by a red line. (B) Structures of cupredoxin and immunoglobulin folds, with the homologous region detected by pLM-BLAST highlighted in red. (C) Graphical representation of the scan results. Bars correspond to hits, color-coded according to their ECOD X-group membership.</p>
        </caption>
        <graphic xlink:href="btad579f5" position="float"/>
      </fig>
      <p>In our benchmark, we used HHsearch’s homology predictions as a ground truth and reference point for pLM-BLAST and other methods. However, it is important to note that homology cannot be definitively proven, and the benchmark is essentially a comparison of one hypothesis against another. While HHsearch is a well-established method, and its predictions have provided crucial insights in numerous studies, our results suggest that embedding-based methods such as pLM-BLAST could potentially detect homology beyond the boundaries defined by HHsearch.</p>
    </sec>
  </sec>
  <sec>
    <title>4 Conclusions</title>
    <p>pLM-BLAST is a sensitive tool for remote homology detection that is based on comparison of sequence representations obtained from the pLM ProtT5. It provides both global and local alignments, with the latter being crucial for detecting distant evolutionary relationships (<xref rid="btad579-F5" ref-type="fig">Fig. 5</xref>). Additionally, it is efficient in database searching (<xref rid="btad579-T1" ref-type="table">Table 1</xref>) due to the use of a prefiltering step. pLM-BLAST is available both as a stand-alone package and as an easy-to-use web server within the MPI Bioinformatics Toolkit (<xref rid="btad579-B36" ref-type="bibr">Zimmermann <italic toggle="yes">et al.</italic> 2018</xref>), where it can be used to search precomputed databases. Currently, the primary limitations of pLM-BLAST are the maximum size of the target database (as searching enormous, redundant databases containing millions of sequences would be computationally costly), and the fact that in local mode, it typically produces highly precise but shorter alignments than HHsearch. However, as demonstrated in <xref rid="btad579-F5" ref-type="fig">Fig. 5</xref>, these shorter alignments can indeed be meaningful. The significance of these alignments, often being subalignments of those provided by HHsearch (if any are provided), from an evolutionary perspective remains to be explored. We anticipate that pLM-BLAST will prove beneficial in studying protein function and evolution, including in the cases of singletons/orphan sequences and taxonomically restricted genes (<xref rid="btad579-B3" ref-type="bibr">Barrera-Redondo <italic toggle="yes">et al.</italic> 2022</xref>), for which deep HMM profiles cannot be calculated.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btad579_Supplementary_Data</label>
      <media xlink:href="btad579_supplementary_data.zip">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <sec>
    <title>Supplementary data</title>
    <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics</italic> online.</p>
  </sec>
  <sec sec-type="COI-statement">
    <title>Conflict of interest</title>
    <p>None declared.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>This work was supported by the First TEAM program of the Foundation for Polish Science, co-financed by the European Union under the European Regional Development Fund (grant POIR.04.04.00-00-5CF1/18-00). V.A. and S.D.-H. were supported by institutional funds from the Max Planck Society.</p>
  </sec>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btad579-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Altschul</surname><given-names>SF</given-names></string-name>, <string-name><surname>Madden</surname><given-names>TL</given-names></string-name>, <string-name><surname>Schäffer</surname><given-names>AA</given-names></string-name></person-group><etal>et al</etal><article-title>Gapped BLAST and PSI-BLAST: a new generation of protein database search programs</article-title>. <source>Nucleic Acids Res</source><year>1997</year>;<volume>25</volume>:<fpage>3389</fpage>–<lpage>402</lpage>.<pub-id pub-id-type="pmid">9254694</pub-id></mixed-citation>
    </ref>
    <ref id="btad579-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Alva</surname><given-names>V</given-names></string-name>, <string-name><surname>Söding</surname><given-names>J</given-names></string-name>, <string-name><surname>Lupas</surname><given-names>AN.</given-names></string-name></person-group><article-title>A vocabulary of ancient peptides at the origin of folded proteins</article-title>. <source>Elife</source><year>2015</year>;<volume>4</volume>:<fpage>e09410</fpage>.<pub-id pub-id-type="pmid">26653858</pub-id></mixed-citation>
    </ref>
    <ref id="btad579-B3">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Barrera-Redondo</surname><given-names>J</given-names></string-name>, <string-name><surname>Lotharukpong</surname><given-names>JS</given-names></string-name>, <string-name><surname>Drost</surname><given-names>H-G</given-names></string-name></person-group><etal>et al</etal> Uncovering gene-family founder events during major evolutionary transitions in animals, plants and fungi using GenEra. bioRxiv, <pub-id pub-id-type="doi">10.1101/2022.07.07.498977</pub-id>, January <year>2022</year>, preprint: not peer reviewed.</mixed-citation>
    </ref>
    <ref id="btad579-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bepler</surname><given-names>T</given-names></string-name>, <string-name><surname>Berger</surname><given-names>B.</given-names></string-name></person-group><article-title>Learning the protein language: evolution, structure, and function</article-title>. <source>Cell Syst</source><year>2021</year>;<volume>12</volume>:<fpage>654</fpage>–<lpage>69.e3</lpage>.<pub-id pub-id-type="pmid">34139171</pub-id></mixed-citation>
    </ref>
    <ref id="btad579-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bernhofer</surname><given-names>M</given-names></string-name>, <string-name><surname>Rost</surname><given-names>B.</given-names></string-name></person-group><article-title>TMbed: transmembrane proteins predicted through language model embeddings</article-title>. <source>BMC Bioinform</source><year>2022</year>;<volume>23</volume>:<fpage>326</fpage>.</mixed-citation>
    </ref>
    <ref id="btad579-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Biegert</surname><given-names>A</given-names></string-name>, <string-name><surname>Söding</surname><given-names>J.</given-names></string-name></person-group><article-title>Sequence context-specific profiles for homology searching</article-title>. <source>Proc Natl Acad Sci USA</source><year>2009</year>;<volume>106</volume>:<fpage>3770</fpage>–<lpage>5</lpage>.<pub-id pub-id-type="pmid">19234132</pub-id></mixed-citation>
    </ref>
    <ref id="btad579-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Buchfink</surname><given-names>B</given-names></string-name>, <string-name><surname>Reuter</surname><given-names>K</given-names></string-name>, <string-name><surname>Drost</surname><given-names>H-G.</given-names></string-name></person-group><article-title>Sensitive protein alignments at tree-of-life scale using DIAMOND</article-title>. <source>Nat Methods</source><year>2021</year>;<volume>18</volume>:<fpage>366</fpage>–<lpage>8</lpage>.<pub-id pub-id-type="pmid">33828273</pub-id></mixed-citation>
    </ref>
    <ref id="btad579-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Cheng</surname><given-names>H</given-names></string-name>, <string-name><surname>Kim</surname><given-names>B-H</given-names></string-name>, <string-name><surname>Grishin</surname><given-names>NV.</given-names></string-name></person-group><article-title>MALISAM: a database of structurally analogous motifs in proteins</article-title>. <source>Nucleic Acids Res</source><year>2008</year>;<volume>36</volume>:<fpage>D211</fpage>–<lpage>7</lpage>.<pub-id pub-id-type="pmid">17855399</pub-id></mixed-citation>
    </ref>
    <ref id="btad579-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Cheng</surname><given-names>H</given-names></string-name>, <string-name><surname>Schaeffer</surname><given-names>RD</given-names></string-name>, <string-name><surname>Liao</surname><given-names>Y</given-names></string-name></person-group><etal>et al</etal><article-title>ECOD: an Evolutionary Classification of Protein Domains</article-title>. <source>PLoS Comput Biol</source><year>2014</year>;<volume>10</volume>:<fpage>e1003926</fpage>.<pub-id pub-id-type="pmid">25474468</pub-id></mixed-citation>
    </ref>
    <ref id="btad579-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Eddy</surname><given-names>SR.</given-names></string-name></person-group><article-title>Accelerated profile HMM searches</article-title>. <source>PLoS Comput Biol</source><year>2011</year>;<volume>7</volume>:<fpage>e1002195</fpage>.<pub-id pub-id-type="pmid">22039361</pub-id></mixed-citation>
    </ref>
    <ref id="btad579-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Elnaggar</surname><given-names>A</given-names></string-name>, <string-name><surname>Heinzinger</surname><given-names>M</given-names></string-name>, <string-name><surname>Dallago</surname><given-names>C</given-names></string-name></person-group><etal>et al</etal><article-title>ProtTrans: towards cracking the language of lifes code through self-supervised deep learning and high performance computing</article-title>. <source>IEEE Trans Pattern Anal Mach Intell</source><year>2022</year>;<volume>44</volume>:<fpage>7112</fpage>–<lpage>27</lpage>.<pub-id pub-id-type="pmid">34232869</pub-id></mixed-citation>
    </ref>
    <ref id="btad579-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gao</surname><given-names>M</given-names></string-name>, <string-name><surname>Skolnick</surname><given-names>J.</given-names></string-name></person-group><article-title>A novel sequence alignment algorithm based on deep learning of the protein folding code</article-title>. <source>Bioinformatics</source><year>2021</year>;<volume>37</volume>:<fpage>490</fpage>–<lpage>6</lpage>.<pub-id pub-id-type="pmid">32960943</pub-id></mixed-citation>
    </ref>
    <ref id="btad579-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gough</surname><given-names>J</given-names></string-name>, <string-name><surname>Chothia</surname><given-names>C.</given-names></string-name></person-group><article-title>The linked conservation of structure and function in a family of high diversity</article-title>. <source>Structure</source><year>2004</year>;<volume>12</volume>:<fpage>917</fpage>–<lpage>25</lpage>.<pub-id pub-id-type="pmid">15274913</pub-id></mixed-citation>
    </ref>
    <ref id="btad579-B14">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Hamamsy</surname><given-names>T</given-names></string-name>, <string-name><surname>Morton</surname><given-names>JT</given-names></string-name>, <string-name><surname>Berenberg</surname><given-names>D</given-names></string-name></person-group><etal>et al</etal> TM-Vec: template modeling vectors for fast homology detection and alignment. bioRxiv, <pub-id pub-id-type="doi">10.1101/2022.07.25.501437</pub-id>, January <year>2022</year>, preprint: not peer reviewed.</mixed-citation>
    </ref>
    <ref id="btad579-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Henikoff</surname><given-names>S</given-names></string-name>, <string-name><surname>Henikoff</surname><given-names>JG.</given-names></string-name></person-group><article-title>Amino acid substitution matrices from protein blocks</article-title>. <source>Proc Natl Acad Sci U S A</source><year>1992</year>;<volume>89</volume>:<fpage>10915</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">1438297</pub-id></mixed-citation>
    </ref>
    <ref id="btad579-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Jumper</surname><given-names>J</given-names></string-name>, <string-name><surname>Evans</surname><given-names>R</given-names></string-name>, <string-name><surname>Pritzel</surname><given-names>A</given-names></string-name></person-group><etal>et al</etal><article-title>Highly accurate protein structure prediction with AlphaFold</article-title>. <source>Nature</source><year>2021</year>;<volume>596</volume>:<fpage>583</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">34265844</pub-id></mixed-citation>
    </ref>
    <ref id="btad579-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kolodny</surname><given-names>R.</given-names></string-name></person-group><article-title>Searching protein space for ancient Sub-domain segments</article-title>. <source>Curr Opin Struct Biol</source><year>2021</year>;<volume>68</volume>:<fpage>105</fpage>–<lpage>12</lpage>.<pub-id pub-id-type="pmid">33476896</pub-id></mixed-citation>
    </ref>
    <ref id="btad579-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kolodny</surname><given-names>R</given-names></string-name>, <string-name><surname>Nepomnyachiy</surname><given-names>S</given-names></string-name>, <string-name><surname>Tawfik</surname><given-names>DS</given-names></string-name></person-group><etal>et al</etal><article-title>Bridging themes: short protein segments found in different architectures</article-title>. <source>Mol Biol Evol</source><year>2021</year>;<volume>38</volume>:<fpage>2191</fpage>–<lpage>208</lpage>.<pub-id pub-id-type="pmid">33502503</pub-id></mixed-citation>
    </ref>
    <ref id="btad579-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Li</surname><given-names>S</given-names></string-name>, <string-name><surname>Chen</surname><given-names>J</given-names></string-name>, <string-name><surname>Liu</surname><given-names>B.</given-names></string-name></person-group><article-title>Protein remote homology detection based on bidirectional long short-term memory</article-title>. <source>BMC Bioinform</source><year>2017</year>;<volume>18</volume>:<fpage>443</fpage>.</mixed-citation>
    </ref>
    <ref id="btad579-B20">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Li</surname><given-names>Z</given-names></string-name>, <string-name><surname>Liu</surname><given-names>X</given-names></string-name>, <string-name><surname>Chen</surname><given-names>W</given-names></string-name></person-group><etal>et al</etal> Uni-Fold: an open-source platform for developing protein folding models beyond AlphaFold. bioRxiv, <pub-id pub-id-type="doi">10.1101/2022.08.04.502811</pub-id>, January <year>2022</year>, preprint: not peer reviewed.</mixed-citation>
    </ref>
    <ref id="btad579-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lin</surname><given-names>Z</given-names></string-name>, <string-name><surname>Akin</surname><given-names>H</given-names></string-name>, <string-name><surname>Rao</surname><given-names>R</given-names></string-name></person-group><etal>et al</etal><article-title>Evolutionary-scale prediction of atomic-level protein structure with a language model</article-title>. <source>Science</source><year>2023</year>;<volume>379</volume>:<fpage>1123</fpage>–<lpage>30</lpage>.<pub-id pub-id-type="pmid">36927031</pub-id></mixed-citation>
    </ref>
    <ref id="btad579-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Llinares-López</surname><given-names>F</given-names></string-name>, <string-name><surname>Berthet</surname><given-names>Q</given-names></string-name>, <string-name><surname>Blondel</surname><given-names>M</given-names></string-name></person-group><etal>et al</etal><article-title>Deep embedding and alignment of protein sequences</article-title>. <source>Nat Methods</source><year>2023</year>;<volume>20</volume>:<fpage>104</fpage>–<lpage>11</lpage>.<pub-id pub-id-type="pmid">36522501</pub-id></mixed-citation>
    </ref>
    <ref id="btad579-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Longo</surname><given-names>LM</given-names></string-name>, <string-name><surname>Jabłońska</surname><given-names>J</given-names></string-name>, <string-name><surname>Vyas</surname><given-names>P</given-names></string-name></person-group><etal>et al</etal><article-title>On the emergence of P-Loop NTPase and Rossmann enzymes from a Beta-Alpha-Beta ancestral fragment</article-title>. <source>Elife</source><year>2020</year>;<volume>9</volume>:e64415.</mixed-citation>
    </ref>
    <ref id="btad579-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ludwiczak</surname><given-names>J</given-names></string-name>, <string-name><surname>Winski</surname><given-names>A</given-names></string-name>, <string-name><surname>Dunin-Horkawicz</surname><given-names>S.</given-names></string-name></person-group><article-title>Localpdb—a python package to manage protein structures and their annotations</article-title>. <source>Bioinformatics (Oxford, England)</source><year>2022</year>;<volume>38</volume>:<fpage>2633</fpage>–<lpage>5</lpage>.<pub-id pub-id-type="pmid">35199148</pub-id></mixed-citation>
    </ref>
    <ref id="btad579-B25">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Morton</surname><given-names>JT</given-names></string-name>, <string-name><surname>Strauss</surname><given-names>CEM</given-names></string-name>, <string-name><surname>Blackwell</surname><given-names>R</given-names></string-name></person-group><etal>et al</etal> Protein structural alignments from sequence. bioRxiv, <pub-id pub-id-type="doi">10.1101/2020.11.03.365932,</pub-id> January <year>2023</year>, preprint: not peer reviewed.</mixed-citation>
    </ref>
    <ref id="btad579-B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Needleman</surname><given-names>SB</given-names></string-name>, <string-name><surname>Wunsch</surname><given-names>CD.</given-names></string-name></person-group><article-title>A general method applicable to the search for similarities in the amino acid sequence of two proteins</article-title>. <source>J Mol Biol</source><year>1970</year>;<volume>48</volume>:<fpage>443</fpage>–<lpage>53</lpage>.<pub-id pub-id-type="pmid">5420325</pub-id></mixed-citation>
    </ref>
    <ref id="btad579-B27">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Pantolini</surname><given-names>L</given-names></string-name>, <string-name><surname>Studer</surname><given-names>G</given-names></string-name>, <string-name><surname>Pereira</surname><given-names>J</given-names></string-name></person-group><etal>et al</etal> Embedding-based alignment: combining protein language models and alignment approaches to detect structural similarities in the twilight-zone. bioRxiv, <pub-id pub-id-type="doi">10.1101/2022.12.13.520313</pub-id>, January <year>2022</year>, preprint: not peer reviewed.</mixed-citation>
    </ref>
    <ref id="btad579-B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Remmert</surname><given-names>M</given-names></string-name>, <string-name><surname>Biegert</surname><given-names>A</given-names></string-name>, <string-name><surname>Hauser</surname><given-names>A</given-names></string-name></person-group><etal>et al</etal><article-title>HHblits: lightning-fast iterative protein sequence searching by HMM-HMM alignment</article-title>. <source>Nat Methods</source><year>2011</year>;<volume>9</volume>:<fpage>173</fpage>–<lpage>5</lpage>.<pub-id pub-id-type="pmid">22198341</pub-id></mixed-citation>
    </ref>
    <ref id="btad579-B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Schütze</surname><given-names>K</given-names></string-name>, <string-name><surname>Heinzinger</surname><given-names>M</given-names></string-name>, <string-name><surname>Steinegger</surname><given-names>M</given-names></string-name></person-group><etal>et al</etal><article-title>Nearest neighbor search on embeddings rapidly identifies distant protein relations</article-title>. <source>Front Bioinform</source><year>2022</year>;<volume>2</volume>:<fpage>1033775</fpage>.<pub-id pub-id-type="pmid">36466147</pub-id></mixed-citation>
    </ref>
    <ref id="btad579-B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Steinegger</surname><given-names>M</given-names></string-name>, <string-name><surname>Söding</surname><given-names>J.</given-names></string-name></person-group><article-title>MMseqs2 enables sensitive protein sequence searching for the analysis of massive data sets</article-title>. <source>Nat Biotechnol</source><year>2017</year>;<volume>35</volume>:<fpage>1026</fpage>–<lpage>8</lpage>.<pub-id pub-id-type="pmid">29035372</pub-id></mixed-citation>
    </ref>
    <ref id="btad579-B31">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Steinegger</surname><given-names>M</given-names></string-name>, <string-name><surname>Meier</surname><given-names>M</given-names></string-name>, <string-name><surname>Mirdita</surname><given-names>M</given-names></string-name></person-group><etal>et al</etal><article-title>HH-suite3 for fast remote homology detection and deep protein annotation</article-title>. <source>BMC Bioinform</source><year>2019</year>;<volume>20</volume>:<fpage>473</fpage>–<lpage>1471</lpage>.</mixed-citation>
    </ref>
    <ref id="btad579-B32">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Stevens</surname><given-names>FJ.</given-names></string-name></person-group><article-title>Homology versus analogy: possible evolutionary relationship of immunoglobulins, cupredoxins, and Cu,Zn-superoxide dismutase</article-title>. <source>J Mol Recognit</source><year>2008</year>;<volume>21</volume>:<fpage>20</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">18080994</pub-id></mixed-citation>
    </ref>
    <ref id="btad579-B33">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Teufel</surname><given-names>F</given-names></string-name>, <string-name><surname>Almagro Armenteros</surname><given-names>JJ</given-names></string-name>, <string-name><surname>Johansen</surname><given-names>AR</given-names></string-name></person-group><etal>et al</etal><article-title>SignalP 6.0 predicts all five types of signal peptides using protein language models</article-title>. <source>Nat Biotechnol</source><year>2022</year>;<volume>40</volume>:<fpage>1023</fpage>–<lpage>5</lpage>.<pub-id pub-id-type="pmid">34980915</pub-id></mixed-citation>
    </ref>
    <ref id="btad579-B34">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhang</surname><given-names>C</given-names></string-name>, <string-name><surname>Shine</surname><given-names>M</given-names></string-name>, <string-name><surname>Pyle</surname><given-names>AM</given-names></string-name></person-group><etal>et al</etal><article-title>US-align: universal structure alignments of proteins, nucleic acids, and macromolecular complexes</article-title>. <source>Nat Methods</source><year>2022</year>;<volume>19</volume>:<fpage>1109</fpage>–<lpage>15</lpage>.<pub-id pub-id-type="pmid">36038728</pub-id></mixed-citation>
    </ref>
    <ref id="btad579-B35">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zheng</surname><given-names>W</given-names></string-name>, <string-name><surname>Wuyun</surname><given-names>Q</given-names></string-name>, <string-name><surname>Li</surname><given-names>Y</given-names></string-name></person-group><etal>et al</etal><article-title>Detecting distant-homology protein structures by aligning deep neural-network based contact maps</article-title>. <source>PLoS Comput Biol</source><year>2019</year>;<volume>15</volume>:<fpage>e1007411</fpage>.<pub-id pub-id-type="pmid">31622328</pub-id></mixed-citation>
    </ref>
    <ref id="btad579-B36">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zimmermann</surname><given-names>L</given-names></string-name>, <string-name><surname>Stephens</surname><given-names>A</given-names></string-name>, <string-name><surname>Nam</surname><given-names>S-Z</given-names></string-name></person-group><etal>et al</etal><article-title>A completely reimplemented MPI bioinformatics toolkit with a new HHpred server at its core</article-title>. <source>J Mol Biol</source><year>2018</year>;<volume>430</volume>:<fpage>2237</fpage>–<lpage>43</lpage>.<pub-id pub-id-type="pmid">29258817</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
