<?DTDIdentifier.IdentifierValue article.dtd?>
<?DTDIdentifier.IdentifierType system?>
<?SourceDTD.DTDName article.dtd?>
<?SourceDTD.Version 1.0?>
<?ConverterInfo.XSLTName bmc2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Plant Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Plant Biol</journal-id>
    <journal-title-group>
      <journal-title>BMC Plant Biology</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2229</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">3848748</article-id>
    <article-id pub-id-type="publisher-id">1471-2229-13-122</article-id>
    <article-id pub-id-type="pmid">23987653</article-id>
    <article-id pub-id-type="doi">10.1186/1471-2229-13-122</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>P-TRAP: a Panicle Trait Phenotyping tool</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" id="A1">
        <name>
          <surname>AL-Tam</surname>
          <given-names>Faroq</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <email>faroq.al.tam@gmail.com</email>
      </contrib>
      <contrib contrib-type="author" corresp="yes" id="A2">
        <name>
          <surname>Adam</surname>
          <given-names>Helene</given-names>
        </name>
        <xref ref-type="aff" rid="I2">2</xref>
        <email>helene.adam@ird.fr</email>
      </contrib>
      <contrib contrib-type="author" id="A3">
        <name>
          <surname>Anjos</surname>
          <given-names>António dos</given-names>
        </name>
        <xref ref-type="aff" rid="I4">4</xref>
        <xref ref-type="aff" rid="I5">5</xref>
        <email>antoniodosanjos@gmail.com</email>
      </contrib>
      <contrib contrib-type="author" id="A4">
        <name>
          <surname>Lorieux</surname>
          <given-names>Mathias</given-names>
        </name>
        <xref ref-type="aff" rid="I2">2</xref>
        <xref ref-type="aff" rid="I3">3</xref>
        <email>mathias.lorieux@ird.fr</email>
      </contrib>
      <contrib contrib-type="author" id="A5">
        <name>
          <surname>Larmande</surname>
          <given-names>Pierre</given-names>
        </name>
        <xref ref-type="aff" rid="I2">2</xref>
        <email>pierre.larmande@ird.fr</email>
      </contrib>
      <contrib contrib-type="author" id="A6">
        <name>
          <surname>Ghesquière</surname>
          <given-names>Alain</given-names>
        </name>
        <xref ref-type="aff" rid="I2">2</xref>
        <email>alain.ghesquiere@ird.fr</email>
      </contrib>
      <contrib contrib-type="author" id="A7">
        <name>
          <surname>Jouannic</surname>
          <given-names>Stefan</given-names>
        </name>
        <xref ref-type="aff" rid="I2">2</xref>
        <email>stephane.jouannic@ird.fr</email>
      </contrib>
      <contrib contrib-type="author" corresp="yes" id="A8">
        <name>
          <surname>Shahbazkia</surname>
          <given-names>Hamid Reza</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <email>shahbazkia@gmail.com</email>
      </contrib>
    </contrib-group>
    <aff id="I1"><label>1</label>DEEI-FCT Universidade do Algarve, 8005-139 Faro, Portugal</aff>
    <aff id="I2"><label>2</label>IRD, UMR DIADE, Genome and Development of Rice group, 911 Avenue Agropolis, 34394 Montpellier, France</aff>
    <aff id="I3"><label>3</label>CIAT, Agrobiodiversity and Biotechnology Project, Cali, Colombia</aff>
    <aff id="I4"><label>4</label>DCT, ISMAT - Instituto Superior Manuel Teixeira Gomes, 8500-508 Portimão, Portugal</aff>
    <aff id="I5"><label>5</label>CCMAR-CIMAR Laboratório Associado Universidade do Algarve, 8005-139 Faro, Portugal</aff>
    <pub-date pub-type="collection">
      <year>2013</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>29</day>
      <month>8</month>
      <year>2013</year>
    </pub-date>
    <volume>13</volume>
    <fpage>122</fpage>
    <lpage>122</lpage>
    <history>
      <date date-type="received">
        <day>19</day>
        <month>2</month>
        <year>2013</year>
      </date>
      <date date-type="accepted">
        <day>24</day>
        <month>8</month>
        <year>2013</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Copyright © 2013 AL-Tam et al.; licensee BioMed Central Ltd.</copyright-statement>
      <copyright-year>2013</copyright-year>
      <copyright-holder>AL-Tam et al.; licensee BioMed Central Ltd.</copyright-holder>
      <license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/2.0">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (
<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/2.0">http://creativecommons.org/licenses/by/2.0</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="http://www.biomedcentral.com/1471-2229/13/122"/>
    <abstract>
      <sec>
        <title>Background</title>
        <p>In crops, inflorescence complexity and the shape and size of the seed are among the most important characters that influence yield. For example, rice panicles vary considerably in the number and order of branches, elongation of the axis, and the shape and size of the seed. Manual low-throughput phenotyping methods are time consuming, and the results are unreliable. However, high-throughput image analysis of the qualitative and quantitative traits of rice panicles is essential for understanding the diversity of the panicle as well as for breeding programs.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p>This paper presents P-TRAP software (Panicle TRAit Phenotyping), a free open source application for high-throughput measurements of panicle architecture and seed-related traits. The software is written in Java and can be used with different platforms (the user-friendly Graphical User Interface (GUI) uses Netbeans Platform 7.3). The application offers three main tools: a tool for the analysis of panicle structure, a spikelet/grain counting tool, and a tool for the analysis of seed shape. The three tools can be used independently or simultaneously for analysis of the same image. Results are then reported in the Extensible Markup Language (XML) and Comma Separated Values (CSV) file formats. Images of rice panicles were used to evaluate the efficiency and robustness of the software. Compared to data obtained by manual processing, P-TRAP produced reliable results in a much shorter time. In addition, manual processing is not repeatable because dry panicles are vulnerable to damage. The software is very useful, practical and collects much more data than human operators.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p>P-TRAP is a new open source software that automatically recognizes the structure of a panicle and the seeds on the panicle in numeric images. The software processes and quantifies several traits related to panicle structure, detects and counts the grains, and measures their shape parameters. In short, P-TRAP offers both efficient results and a user-friendly environment for experiments. The experimental results showed very good accuracy compared to field operator, expert verification and well-known academic methods.</p>
      </sec>
    </abstract>
    <kwd-group>
      <kwd>Phenotyping</kwd>
      <kwd>2D images</kwd>
      <kwd>Panicle</kwd>
      <kwd>Seed</kwd>
      <kwd>Structure</kwd>
      <kwd>Rice</kwd>
    </kwd-group>
  </article-meta>
</front>
<body>
  <sec>
    <title>Background</title>
    <p>The architecture of the rice inflorescence (or panicle) is of major importance for rice breeding as it directly affects in the number of grains per panicle and hence final rice yield. The rice panicle is a complex branched structure consisting of a main axis (rachis) bearing lateral branches named primary branches (Pb) that bear so-called secondary branches (Sb), from which higher order branches may be observed (Figure
<xref ref-type="fig" rid="F1">1</xref>). Primary, secondary and higher order branches bear spikelets consisting of glumes (bract-like organs) and florets. In rice, a spikelet contains a single fertile floret and a pair of sterile lemmas (also called ‘empty glumes’), subtended by a pair of highly reduced glumes called rudimentary glumes
[<xref ref-type="bibr" rid="B1">1</xref>]. The number of spikelets (and consequently the number of grains) per panicle is therefore related to the branching complexity (number and order of branches). Panicle branching is a highly complex process that is influenced by genetic, hormonal and environmental factors (see
[<xref ref-type="bibr" rid="B2">2</xref>] for a review of the genetic and molecular bases of rice yield). Several genes related to meristem formation or fate, hormone biosynthesis or response, that contribute to panicle branching complexity, have been identified in the cultivated Asian rice species <italic>Oryza sativa</italic> from quantitative trait loci (QTL) mapping populations and mutant analysis
[<xref ref-type="bibr" rid="B2">2</xref>,<xref ref-type="bibr" rid="B3">3</xref>]. However, QTL mapping of panicle branching complexity indicates that this trait is under the control of many genes, that remain to be identified
[<xref ref-type="bibr" rid="B2">2</xref>]. Moreover, rice species display a wide range of morphological traits (including panicle complexity) as well as their ecological habitat and their tolerance to abiotic and biotic stresses. The genus <italic>Oryza</italic> consists of about 23 species including only two cultivated species,<italic>O. sativa</italic> and <italic>O. glaberrima</italic>, which originate from Asia and Africa, respectively
[<xref ref-type="bibr" rid="B4">4</xref>].</p>
    <fig id="F1" position="float">
      <label>Figure 1</label>
      <caption>
        <p><bold>Structure of a rice panicle.</bold> Schematic representation of a rice panicle comprising a main central axis (blue line) named rachis, to which primary branches (Pb) are attached (black lines); the primary branches bear secondary branches (Sb, green lines), which in turn bear tertiary branches (Tb, orange lines). Spikelets (Sp) are attached to the branches by a peduncle. Nodes are represented by red dots (ARM, Aborted Rachis Meristem). In the P-TRAP output results, the following terms are used instead of botanical terminology: Primary Axis (PA) for the blue line, the secondary axes (SA) for the black lines; the tertiary axes (TA) for the green lines and the quaternary axes (QA) for the orange lines.</p>
      </caption>
      <graphic xlink:href="1471-2229-13-122-1"/>
    </fig>
    <p>There is a wide range of rice panicle architecture among varieties concerning the number and order of branches, and axis elongation. Natural inter-specific and intra-specific variations in morphological traits represent a largely untapped highly valuable resource for genetic improvement by breeding. For efficient selection of beneficial alleles for breeding, natural variation needs to be well characterized at the phenotypic and molecular genetic level. In addition, the study of natural variation is also important to understand the evolution of morphological traits and the molecular genetic mechanisms underlying them. To exploit the diversity of rice panicle resources, panicle morphological traits need to be identified and quantified. Plant phenotyping involves screening large collections of accessions to facilitate the discovery of new interesting traits, and analyzing known phenotypic data to identify the genes involved in their diversity, to be able to use these genes in plant breeding. To collect these data, the usual procedure consists in laborious manual measurements on predefined traits such as panicle length, the number of branches, the order of branches, the number of grains, and grain size. Depending on the degree of complexity of the panicle, manual phenotypic analysis is time consuming and it is impossible to evaluate and quantify all traits (such as branch and spikelet positions in the panicle) to obtain an accurate overview of panicle architecture. Moreover, manual phenotyping is often destructive for the plant making it impossible to use the same panicle to measure other traits. Given the importance of gene discovery and crop improvement, there is thus an urgent need to automate such tedious and time- consuming tasks. The development of an easy high-throughput panicle phenotyping method should aim to standardize the measurement and extraction of panicle traits. In recent years, plant phenotyping research has led to the development of software for plant screening facilities. Recent image processing solutions, such as TraitMill and HTPheno, offer general analysis for the measurement of plant height, volume and colorimetry
[<xref ref-type="bibr" rid="B5">5</xref>,<xref ref-type="bibr" rid="B6">6</xref>].</p>
    <p>Other software provides 2-D image-based semi-automated processing for leaf phenotyping (Phenopsis or LAMINA) and root data monitoring (GROWSCREEN)
[<xref ref-type="bibr" rid="B7">7</xref>-<xref ref-type="bibr" rid="B9">9</xref>]. Specific rice image-based solutions have been developed for phenotyping and involve the measurement of parameters such as grain size (length, width, and thickness), panicle length, and the number of tillers
[<xref ref-type="bibr" rid="B10">10</xref>,<xref ref-type="bibr" rid="B11">11</xref>]. However, these methods could not be adapted to rice panicle structure phenotyping and require expensive equipment. Ikeda <italic>et al</italic>[<xref ref-type="bibr" rid="B12">12</xref>] developed a software named PASTAR (Panicle Structure Analyzer for Rice) and PASTA Viewer, to automatically extract values for length, number of branches, and number of grains from scanned panicle images. However, this software is under license, thus limiting access by the scientific community. Recently, a program named Smartgrain was developed to quantify seed shape and size. However, this software does not process the grain attached to panicles but only individual grains
[<xref ref-type="bibr" rid="B13">13</xref>]. In this context, it was important to develop an easy-to-use freely available open-source software based on 2-D image processing for the analysis of rice panicle structure.</p>
    <p>Here, we propose a Java-based stand-alone application named P-TRAP (for Panicle TRAit Phenotyping) to easily quantify 2-D panicle traits. The labor-intensive processing is automated but post-processing options allow users to improve the quality of the analysis using their expert knowledge. The proposed pipeline has different tools: a tool to analyze panicle structure, and a spikelet/grain counting and shape analysis tool. The software allows automatic detection of the structure of the panicle from a spread panicle image consisting of different morphological traits that are not easily accessible through manual phenotyping. The spikelet/grain counting option detects the grains on the panicle, counts them and quantifies different shape parameters. The novelty of P-TRAP is the simultaneous analysis of panicle structure and grain counting/shape on the same image. These shape parameters can also be measured from images of spread seeds. The interface allows the two analyses to be performed at the same time (or separately) and extracts the different traits in different output formats (CSV and XML) to facilitate data analysis and access to OpenAlea platform facilities
[<xref ref-type="bibr" rid="B14">14</xref>]. In this study, we used this program to analyze the panicle structure of various accessions of <italic>O. sativa</italic>,<italic>O. glaberrima</italic> and <italic>O. barthii</italic> and to compare the results with manual measurements to check the robustness of the software.</p>
  </sec>
  <sec>
    <title>Implementation</title>
    <p>P-TRAP is written in Java with a user-friendly GUI. The GUI is built on top of the Netbeans Platform (version 7.3), which provides a modular underlay for the system’s architecture. The software provides different features for users to conduct their experiments and edit and collect the final results. It offers an editor for the input image, the panicle structure and the grains. The user interaction is mostly performed by using the mouse or keyboard shortcuts. In addition, developers can easily add new features to the application, as it is very modular.</p>
    <sec>
      <title>Panicle trait calculation pipeline</title>
      <sec>
        <title>Source images</title>
        <p>The input is an RGB image of a spread panicle, fixed at the center of a white background. Metal pins are used to fix the panicle onto the shooting scene (Figure
<xref ref-type="fig" rid="F2">2</xref>a).</p>
        <fig id="F2" position="float">
          <label>Figure 2</label>
          <caption>
            <p><bold>Panicle and seed image preparation.</bold> <bold>(a)</bold> The panicle is spread out on a white background and held in place by metal pins, the two black marks are the positions of the start and end of the panicle rachis. This type of image is used for panicle structure, spikelet/grain counting and seed trait analyses. <bold>(b)</bold> Seeds spread out for the analysis of seed traits.</p>
          </caption>
          <graphic xlink:href="1471-2229-13-122-2"/>
        </fig>
        <p>In P-TRAP, the user first has to create a project. The source images can be then imported for processing using the GUI. The project can contain one or several images. They can be processed individually or as a batch to support different workflow scales. Basic pre-processing steps can be applied on the images. Cropping and scaling processes are available and can be performed interactively using the GUI.</p>
      </sec>
      <sec>
        <title>Panicle structure detection</title>
        <p>The quantification of the panicle traits is based on the detection of the structure of the panicle followed by a conversion of the skeleton into a mathematical graph (Additional file
<xref ref-type="supplementary-material" rid="S1">1</xref>). The pipeline for converting the image of the panicle to a graph can be described as follows: input image <italic>I</italic> is converted to grayscale and then a Gaussian blur filter with a kernel of size <italic>kernelSize</italic> is used to smooth the image. The smoothed image is locally thresholded by using the mean-c local thresholding approach
[<xref ref-type="bibr" rid="B15">15</xref>], resulting in a binary image. The blurring filter is used to obtain a smooth binary image, and leads to a skeletal image containing fewer undesirable small spikes
[<xref ref-type="bibr" rid="B16">16</xref>]. Due to variation in the brightness of the image, small holes may remain in the binary image. Unless these holes are filled, corresponding cycles may appear in the skeleton, which may cause several problems during the skeleton analysis task (Additional file
<xref ref-type="supplementary-material" rid="S1">1</xref>). To solve this problem, small holes with an area ≤ <italic>minParticle</italic> are filled in to yield a “solid" binary image, <italic>I</italic><sub>solid</sub>.</p>
        <p>The <italic>I</italic><sub>solid</sub> image is skeletonized by the Zhang-Suen’s (ZS) thinning method
[<xref ref-type="bibr" rid="B17">17</xref>]. A major drawback of this method is that the final skeleton may produce staircases, in which case the Holt’s staircase removal method
[<xref ref-type="bibr" rid="B18">18</xref>] is applied. A fast lookup-based implementation of ZS method can be found in
[<xref ref-type="bibr" rid="B19">19</xref>]. To locate the panicle skeleton in the image, all the components in the skeletal image are searched. The biggest is returned as the panicle skeleton. The skeleton is returned as a list of points (<italic>skeletonList</italic>) that indicate the positions of the pixels of the skeletons in the image. The <italic>xy-origin</italic> of the image is at the top left of the image. This list is then converted to a graph <italic>G</italic> which is then cleaned and refined (<italic>G</italic><sub>refined</sub>). Cleaning is based on removing terminal edges whose length is less than a threshold <italic>minSpike</italic> (default value = 40 pixels, modifiable by the user). An edge is terminal if one of the vertices it connects has one and only one neighbor.</p>
      </sec>
      <sec>
        <title>Panicle structure quantification</title>
        <p>The calculation of the panicle structure traits is based on the mathematical graph produced from the panicle detection task. Quantification includes two main steps: vertices classification and graph quantification.</p>
        <sec>
          <title>Vertex classification</title>
          <p>Different classes are used to distinguish the type of graph vertices, Figure
<xref ref-type="fig" rid="F3">3</xref>. The classification of vertices is explained in Figure
<xref ref-type="fig" rid="F4">4</xref>. The user identifies the start and end generating vertices (yellow circles in Figure
<xref ref-type="fig" rid="F3">3</xref>) of the panicle structure by using the application’s GUI, and then, each vertex of the graph is assigned to a class. The software classifies all other vertices either as terminal (red circles) or unclassified. The unclassified vertices are classified by using a breadth-first decomposition approach. Vertex classification is based on the weight of the graph. We define the weight of the graph as the product of the number of vertices and the lengths of their edges (links). The length is calculated using the Euclidean distance metric.</p>
          <fig id="F3" position="float">
            <label>Figure 3</label>
            <caption>
              <p><bold>A panicle graph superimposed on a panicle image.</bold> The circles represent the junctions and the termination of the branches. The use of colors makes it easy for users to distinguish between different types of branches (see the inset for definitions of the colors of the circles).</p>
            </caption>
            <graphic xlink:href="1471-2229-13-122-3"/>
          </fig>
          <fig id="F4" position="float">
            <label>Figure 4</label>
            <caption>
              <p><bold>Graph decomposition and vertex classification.</bold> <bold>(a)</bold> original graph, <bold>(b)</bold> decomposing the graph at the start generating vertex (root), <bold>(c)</bold> classifying the neighbors of the start generating vertex, <bold>(d)</bold> decomposing the maximum weighed sub-graph at its root vertex, <bold>(e)</bold> classifying the vertices of the neighboring sub-graph root, <bold>(f)</bold> unclassified vertex in a small sub-graph, <bold>(g)</bold> decomposing and classifying the unclassified vertex in (f), and <bold>(h)</bold> in a fully classified graph.</p>
            </caption>
            <graphic xlink:href="1471-2229-13-122-4"/>
          </fig>
          <p>In the beginning, the primary vertices (white circles) are identified by decomposing the graph at the start-generating vertex (main root of the graph) into a set of subgraphs. Therefore, each neighbor of the main root is a root of a subgraph. Among the roots of the subgraphs, the one that belongs to the “heaviest” sub-graph is chosen as the“winner” vertex and then classified as primary (Figures
<xref ref-type="fig" rid="F4">4</xref>b, c). The other roots are classified as secondary (<italic>i.e.</italic> one level lower). Similarly, the heaviest sub-graph is decomposed at its root into sub-graphs, and the new winner is classified as primary, and so on, until the end generating point is reached (Figures
<xref ref-type="fig" rid="F4">4</xref>d-f).</p>
          <p>The remaining unclassified vertices are classified in the same way as the primary ones. At each secondary vertex (that has an unclassified neighbor), its parent sub-graph is decomposed and the winner vertex is classified as secondary. The other losing vertices are classified as tertiary and so on (Figure
<xref ref-type="fig" rid="F4">4</xref>g). The classification finishes when all the vertices in the graph are classified (Figure
<xref ref-type="fig" rid="F4">4</xref>h). The graph terminology is defined as follows: Primary Axis (PA) is the main axis of the panicle (<italic>i.e.</italic> the panicle rachis), Secondary Axis (SA) is a branch attached directly to the PA (<italic>i.e.</italic> corresponds to a primary branch of the panicle), Tertiary Axis (TA) is an axis attached to a secondary axis (<italic>i.e.</italic> corresponds to a secondary branch of the panicle); Quaternary Axis (QA) is an axis that is attached to a tertiary axis (<italic>i.e.</italic> corresponds to a tertiary branch of the panicle).</p>
        </sec>
        <sec>
          <title>Graph quantification</title>
          <p>Once each vertex of the graph is classified, the panicle’s traits can be quantified. The quantification task is described in Figure
<xref ref-type="fig" rid="F5">5</xref>. This task is based on the same breadth-first graph decomposition approach described earlier. A set of smaller sub-graphs is generated by the decomposition of the classified graph at its root. Each sub-graph has a copy of the root vertex where the parent graph is decomposed, a set of edges, and a set of vertices with level classes lower than that of the root. In this context, if we decompose the main graph at each primary vertex into a set of sub-graphs, each will have a primary class vertex and a secondary axis. The length of this axis is the sum of the lengths of the edges passing through the primary vertex, the secondary vertices, and the terminal vertex that is the neighbor of the last secondary vertex and has the longest edge among the other terminal neighbors (Figure
<xref ref-type="fig" rid="F5">5</xref>c). Similarly, we can find the lengths of the tertiary axes in a sub-graph by decomposing it at each secondary vertex into a set of smaller sub-graphs and calculating the length of the main path in each sub-graph. This approach is used to quantify the structural traits of the panicle from the generated graph. These traits are listed in Table
<xref ref-type="table" rid="T1">1</xref>.</p>
          <fig id="F5" position="float">
            <label>Figure 5</label>
            <caption>
              <p><bold>Quantification of classified graphs.</bold> <bold>(a)</bold> a classified graph, <bold>(b)</bold> decomposing the classified graph and adding a copy of the parent root to the sub-graphs, <bold>(c)</bold> calculating the length of an axis, and <bold>(d)</bold> yellow line: the rachis length (<italic>PA_length</italic>), blue lines: the lengths of the SA in the graph.</p>
            </caption>
            <graphic xlink:href="1471-2229-13-122-5"/>
          </fig>
          <table-wrap position="float" id="T1">
            <label>Table 1</label>
            <caption>
              <p>Structural and grain related traits of a rice panicle</p>
            </caption>
            <table frame="hsides" rules="groups" border="1">
              <colgroup>
                <col align="left"/>
                <col align="center"/>
                <col align="center"/>
                <col align="center"/>
              </colgroup>
              <thead valign="top">
                <tr>
                  <th colspan="2" align="center" valign="bottom">
                    <bold>Panicle structure traits</bold>
                    <hr/>
                  </th>
                  <th colspan="2" align="center" valign="bottom">
                    <bold>Spikelet (Grain) traits</bold>
                    <hr/>
                  </th>
                </tr>
                <tr>
                  <th align="left">
                    <bold>Trait</bold>
                  </th>
                  <th align="left">
                    <bold>Short name</bold>
                  </th>
                  <th align="left">
                    <bold>Trait</bold>
                  </th>
                  <th align="left">
                    <bold>Short name</bold>
                  </th>
                </tr>
              </thead>
              <tbody valign="top">
                <tr>
                  <td align="left" valign="bottom">Primary Axis - length<hr/></td>
                  <td align="left" valign="bottom">
                    <italic>PA_length</italic>
                    <hr/>
                  </td>
                  <td align="left" valign="bottom">Spikelets - number<hr/></td>
                  <td align="left" valign="bottom">
                    <italic>Sp_nb</italic>
                    <hr/>
                  </td>
                </tr>
                <tr>
                  <td align="left" valign="bottom">Primary Axis - diameter<hr/></td>
                  <td align="left" valign="bottom">
                    <italic>PA_diameter</italic>
                    <hr/>
                  </td>
                  <td align="left" valign="bottom">Spikelets - length<hr/></td>
                  <td align="left" valign="bottom">
                    <italic>Sp_length</italic>
                    <hr/>
                  </td>
                </tr>
                <tr>
                  <td align="left" valign="bottom">Secondary Axis - position<hr/></td>
                  <td align="left" valign="bottom">
                    <italic>SA_po</italic>
                    <hr/>
                  </td>
                  <td align="left" valign="bottom">Spikelets - width<hr/></td>
                  <td align="left" valign="bottom">
                    <italic>Sp_width</italic>
                    <hr/>
                  </td>
                </tr>
                <tr>
                  <td align="left" valign="bottom">Secondary Axes - number<hr/></td>
                  <td align="left" valign="bottom">
                    <italic>SA_nb</italic>
                    <hr/>
                  </td>
                  <td align="left" valign="bottom">Spikelets - area<hr/></td>
                  <td align="left" valign="bottom">
                    <italic>Sp_area</italic>
                    <hr/>
                  </td>
                </tr>
                <tr>
                  <td align="left" valign="bottom">Secondary Axis - length<hr/></td>
                  <td align="left" valign="bottom">
                    <italic>SA_length</italic>
                    <hr/>
                  </td>
                  <td align="left" valign="bottom">Spikelets - perimeter<hr/></td>
                  <td align="left" valign="bottom">
                    <italic>Sp_perimeter</italic>
                    <hr/>
                  </td>
                </tr>
                <tr>
                  <td align="left" valign="bottom">Number of Nodes<hr/></td>
                  <td align="left" valign="bottom">
                    <italic>Node_nb</italic>
                    <hr/>
                  </td>
                  <td align="left" valign="bottom">Spikelets - circularity<hr/></td>
                  <td align="left" valign="bottom">
                    <italic>Sp_circularity</italic>
                    <hr/>
                  </td>
                </tr>
                <tr>
                  <td align="left" valign="bottom">Secondary Axes Intervals Length<hr/></td>
                  <td align="left" valign="bottom">
                    <italic>SA_int</italic>
                    <hr/>
                  </td>
                  <td align="left" valign="bottom">Spikelets - compactness<hr/></td>
                  <td align="left" valign="bottom">
                    <italic>Sp_compactness</italic>
                    <hr/>
                  </td>
                </tr>
                <tr>
                  <td align="left" valign="bottom">Tertiary Axes - number<hr/></td>
                  <td align="left" valign="bottom">
                    <italic>TA_nb</italic>
                    <hr/>
                  </td>
                  <td align="left" valign="bottom">Spikelets - ellipticity<hr/></td>
                  <td align="left" valign="bottom">
                    <italic>Sp_ellipticity</italic>
                    <hr/>
                  </td>
                </tr>
                <tr>
                  <td align="left" valign="bottom">Tertiary Axes - length<hr/></td>
                  <td align="left" valign="bottom">
                    <italic>TA_length</italic>
                    <hr/>
                  </td>
                  <td align="left" valign="bottom">Aspect - ratio<hr/></td>
                  <td align="left" valign="bottom">
                    <italic>Sp_AR</italic>
                    <hr/>
                  </td>
                </tr>
                <tr>
                  <td align="left" valign="bottom">Tertiary Axis - position<hr/></td>
                  <td align="left" valign="bottom">
                    <italic>TA_po</italic>
                    <hr/>
                  </td>
                  <td align="left" valign="bottom"> <hr/></td>
                  <td align="left" valign="bottom"> <hr/></td>
                </tr>
                <tr>
                  <td align="left" valign="bottom">Tertiary Axes Intervals Length<hr/></td>
                  <td align="left" valign="bottom">
                    <italic>TA_int</italic>
                    <hr/>
                  </td>
                  <td align="left" valign="bottom"> <hr/></td>
                  <td align="left" valign="bottom"> <hr/></td>
                </tr>
                <tr>
                  <td align="left" valign="bottom">Quaternary Axes - number<hr/></td>
                  <td align="left" valign="bottom">
                    <italic>QA_nb</italic>
                    <hr/>
                  </td>
                  <td align="left" valign="bottom"> <hr/></td>
                  <td align="left" valign="bottom"> <hr/></td>
                </tr>
                <tr>
                  <td align="left" valign="bottom">Quaternary Axes - length<hr/></td>
                  <td align="left" valign="bottom">
                    <italic>QA_length</italic>
                    <hr/>
                  </td>
                  <td align="left" valign="bottom"> <hr/></td>
                  <td align="left" valign="bottom"> <hr/></td>
                </tr>
                <tr>
                  <td align="left" valign="bottom">Quaternary Axes - position<hr/></td>
                  <td align="left" valign="bottom">
                    <italic>QA_po</italic>
                    <hr/>
                  </td>
                  <td align="left" valign="bottom"> <hr/></td>
                  <td align="left" valign="bottom"> <hr/></td>
                </tr>
                <tr>
                  <td align="left">Quaternary Axes Intervals Length</td>
                  <td align="left">
                    <italic>QA_int</italic>
                  </td>
                  <td align="left"> </td>
                  <td align="left"> </td>
                </tr>
              </tbody>
            </table>
            <table-wrap-foot>
              <p>Two different types of traits regarding to the panicle components. These are structural and grain related traits.</p>
            </table-wrap-foot>
          </table-wrap>
          <p>Finally, the panicle diameter or primary axis diameter (<italic>PA_diameter</italic>) is found by calculating the Euclidean distance map (EDM) of the <italic>I</italic><sub>solid</sub> binary image using an efficient algorithm described in
[<xref ref-type="bibr" rid="B20">20</xref>]. In EDM images, each pixel has a value that defines the radius of the maximum ball (the maximum distance from this pixel to the image background). A circle with a small radius centered at the start generating point is defined as a search area. The <italic>PA_diameter</italic> value is then estimated as twice the square root of the maximum pixel’s value in this predefined search area.</p>
        </sec>
      </sec>
      <sec>
        <title>Detection and quantification of grains</title>
        <p>In the rice panicle, grains are clustered in branches, may vary in size and may overlap. These characteristics can prevent detection of the seeds on the images. For this reason, we used a granulometric approach
[<xref ref-type="bibr" rid="B21">21</xref>]<italic>-</italic>[<xref ref-type="bibr" rid="B23">23</xref>] to find the “perfect” grain size and the other particles are then compared to this model. The same approach is used to detect seeds on the spread out panicle as well as spread out seeds. RGB images are converted to binary images in the same way as described in the section on panicle structure detection. Granulometry determines the perfect size of the mathematical morphology opening disk by estimating the range to which the correct disk size belongs and by iteratively increasing the size of the opening disk by a predefined step parameter and calculating the differences between the original and the opened images. In this work, two levels of morphological opening are performed. Formally, let <italic>I</italic><sub>binary</sub> be the binary image of the panicle obtained by low-passing the grayscale version of the grains’ image and applying the mean-c local thresholding method. Furthermore, let <italic>d</italic><sub>min</sub> ≤ <italic>d</italic><sub><italic>m</italic></sub> ≤ <italic>d</italic><sub>max</sub> be the disk size of a user-defined range. The morphologically opened version of <italic>I</italic><sub>binary</sub> by the structure element <italic>d</italic><sub><italic>m</italic></sub> can be defined in terms of particles as:</p>
        <p>
          <disp-formula id="bmcM1">
            <label>(1)</label>
            <mml:math id="M1" name="1471-2229-13-122-i1" overflow="scroll">
              <mml:msub>
                <mml:mrow>
                  <mml:mi>I</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mtext>binary</mml:mtext>
                </mml:mrow>
              </mml:msub>
              <mml:mo>∘</mml:mo>
              <mml:msub>
                <mml:mrow>
                  <mml:mi>d</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>m</mml:mi>
                </mml:mrow>
              </mml:msub>
              <mml:mo>=</mml:mo>
              <mml:mi>P</mml:mi>
              <mml:mo>=</mml:mo>
              <mml:msubsup>
                <mml:mrow>
                  <mml:mo stretchy="false">{</mml:mo>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>p</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>i</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo stretchy="false">}</mml:mo>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>i</mml:mi>
                  <mml:mo>=</mml:mo>
                  <mml:mn>1</mml:mn>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>i</mml:mi>
                  <mml:mo>=</mml:mo>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>n</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>p</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                </mml:mrow>
              </mml:msubsup>
            </mml:math>
          </disp-formula>
        </p>
        <p>where <italic>P</italic> is the set of particles obtained by opening <italic>I</italic><sub>binary</sub> by <italic>d</italic><sub><italic>m</italic></sub>, and <italic>n</italic><sub><italic>P</italic></sub> is their number. To get the optimal disk size, and hence the grain size, an objective function is defined as:</p>
        <p>
          <disp-formula id="bmcM2">
            <label>(2)</label>
            <mml:math id="M2" name="1471-2229-13-122-i2" overflow="scroll">
              <mml:mi mathvariant="normal">Θ</mml:mi>
              <mml:mo stretchy="false">(</mml:mo>
              <mml:msub>
                <mml:mrow>
                  <mml:mi>I</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mtext>binary</mml:mtext>
                </mml:mrow>
              </mml:msub>
              <mml:mo>∘</mml:mo>
              <mml:msub>
                <mml:mrow>
                  <mml:mi>d</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>m</mml:mi>
                </mml:mrow>
              </mml:msub>
              <mml:mo stretchy="false">)</mml:mo>
              <mml:mo>=</mml:mo>
              <mml:mfrac>
                <mml:mrow>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>n</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>P</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>σ</mml:mi>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>I</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mtext>binary</mml:mtext>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>∘</mml:mo>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>d</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>m</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo stretchy="false">)</mml:mo>
                </mml:mrow>
              </mml:mfrac>
              <mml:mspace width=".3em"/>
              <mml:mo>∀</mml:mo>
              <mml:msub>
                <mml:mrow>
                  <mml:mi>d</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>m</mml:mi>
                </mml:mrow>
              </mml:msub>
              <mml:mo>∈</mml:mo>
              <mml:mspace width="0.3em"/>
              <mml:mo stretchy="false">[</mml:mo>
              <mml:msub>
                <mml:mrow>
                  <mml:mi>d</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mtext>min</mml:mtext>
                </mml:mrow>
              </mml:msub>
              <mml:mo>,</mml:mo>
              <mml:msub>
                <mml:mrow>
                  <mml:mi>d</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mtext>max</mml:mtext>
                </mml:mrow>
              </mml:msub>
              <mml:mo stretchy="false">]</mml:mo>
            </mml:math>
          </disp-formula>
        </p>
        <p>where <italic>σ</italic>(<italic>I</italic><sub>binary</sub> ∘ <italic>d</italic><sub><italic>m</italic></sub>) is the standard deviation (STD) of the particle area.</p>
        <p>By applying a brute-force algorithm for all disks in the range [<italic>d</italic><sub>min</sub>,<italic>d</italic><sub>max</sub>] with step parameter of 1, the optimal disk is the one with maximum Θ in this range. In (2) if <italic>n</italic><sub><italic>P</italic></sub> &lt; <italic>n</italic><sub>min</sub>, where <italic>n</italic><sub>min</sub> is a small integer, Θ is not considered. Θ is maximized, when <italic>n</italic><sub><italic>P</italic></sub> is big and <italic>σ</italic> is small, which implies an adequate disk size and consequently an appropriate grain size. Once the adequate disk size is determined, the perfect grain size is just the median of the particles in the binary image opened at this disk size. The median is chosen because it has a good gross-error toleration ratio and 50% breakdown point
[<xref ref-type="bibr" rid="B24">24</xref>]. At this point, the first mathematical opening level is finished, with the perfect grain size
<inline-formula><mml:math id="M3" name="1471-2229-13-122-i3" overflow="scroll"><mml:mover accent="true"><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math></inline-formula> and the optimal disk size
<inline-formula><mml:math id="M4" name="1471-2229-13-122-i4" overflow="scroll"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> identified.</p>
        <p>At the second level, the size of the disk is smaller than in the first level
<inline-formula><mml:math id="M5" name="1471-2229-13-122-i5" overflow="scroll"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula>. This ensures that the opening process removes only the thin parts of the panicle and leaves the grain particles in the branches intact. At this level, larger particles are detected in each branch by applying a morphological opening with a disk of size
<inline-formula><mml:math id="M6" name="1471-2229-13-122-i6" overflow="scroll"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mi>C</mml:mi></mml:math></inline-formula>, where <italic>C</italic> is a small constant (<italic>C</italic> = 3 in this work). Additionally, the concave points of each particle are calculated by examining the concavity of the particle contours as described in
[<xref ref-type="bibr" rid="B25">25</xref>]. In this method, a circle of radius <italic>r</italic> with perimeter <italic>l</italic> is centered at each point of the contour of the particle. Let Ω(<italic>p</italic><sub><italic>i</italic></sub>) be the set of contour points of the particle <italic>p</italic><sub><italic>i</italic></sub>. The concavity of a contour point <italic>ω</italic><sub><italic>j</italic></sub> ∈ Ω(<italic>p</italic><sub><italic>i</italic></sub>), with <italic>j</italic> ≤ |Ω(<italic>p</italic><sub><italic>i</italic></sub>)|, is measured as:</p>
        <p>
          <disp-formula id="bmcM3">
            <label>(3)</label>
            <mml:math id="M7" name="1471-2229-13-122-i7" overflow="scroll">
              <mml:mtext>concavity</mml:mtext>
              <mml:mo stretchy="false">(</mml:mo>
              <mml:msub>
                <mml:mrow>
                  <mml:mi>ω</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>j</mml:mi>
                </mml:mrow>
              </mml:msub>
              <mml:mo stretchy="false">)</mml:mo>
              <mml:mo>=</mml:mo>
              <mml:mfrac>
                <mml:mrow>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mtext>arc</mml:mtext>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mtext>in</mml:mtext>
                      <mml:mo stretchy="false">(</mml:mo>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>p</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>i</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mo stretchy="false">)</mml:mo>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>ω</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>j</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo stretchy="false">)</mml:mo>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>l</mml:mi>
                </mml:mrow>
              </mml:mfrac>
            </mml:math>
          </disp-formula>
        </p>
        <p>where <italic>p</italic><sub><italic>i</italic></sub> is the particle and
<inline-formula><mml:math id="M8" name="1471-2229-13-122-i8" overflow="scroll"><mml:msub><mml:mrow><mml:mtext>arc</mml:mtext></mml:mrow><mml:mrow><mml:mtext>in</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub></mml:math></inline-formula> is the length of the arc inside <italic>p</italic><sub><italic>i</italic></sub>. In this work, a contour point is termed concave if its concavity ≥ 0.6.</p>
      </sec>
      <sec>
        <title>Grain quantification</title>
        <p>Table
<xref ref-type="table" rid="T1">1</xref> lists different grain traits. This section explains how they are calculated. Given the perfect grain’s area (
<inline-formula><mml:math id="M9" name="1471-2229-13-122-i9" overflow="scroll"><mml:mtext>area</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula>), and the area (area(<italic>p</italic><sub><italic>i</italic></sub>)) and the number of concave points |concave(<italic>p</italic><sub><italic>i</italic></sub>)| of each particle <italic>p</italic><sub><italic>i</italic></sub>, the final number of grains in each particle is calculated as:</p>
        <p>
          <disp-formula id="bmcM4">
            <label>(4)</label>
            <mml:math id="M10" name="1471-2229-13-122-i10" overflow="scroll">
              <mml:mtext>grains</mml:mtext>
              <mml:mo stretchy="false">(</mml:mo>
              <mml:msub>
                <mml:mrow>
                  <mml:mi>p</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>i</mml:mi>
                </mml:mrow>
              </mml:msub>
              <mml:mo stretchy="false">)</mml:mo>
              <mml:mo>=</mml:mo>
              <mml:mi>α</mml:mi>
              <mml:mo stretchy="false">(</mml:mo>
              <mml:mfrac>
                <mml:mrow>
                  <mml:mtext>area</mml:mtext>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>p</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>i</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo stretchy="false">)</mml:mo>
                </mml:mrow>
                <mml:mrow>
                  <mml:mtext>area</mml:mtext>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mover accent="true">
                    <mml:mrow>
                      <mml:mi>p</mml:mi>
                    </mml:mrow>
                    <mml:mo>^</mml:mo>
                  </mml:mover>
                  <mml:mo stretchy="false">)</mml:mo>
                </mml:mrow>
              </mml:mfrac>
              <mml:mo stretchy="false">)</mml:mo>
              <mml:mo>+</mml:mo>
              <mml:mo stretchy="false">(</mml:mo>
              <mml:mn>1</mml:mn>
              <mml:mo>−</mml:mo>
              <mml:mi>α</mml:mi>
              <mml:mo stretchy="false">)</mml:mo>
              <mml:mo stretchy="false">(</mml:mo>
              <mml:mfrac>
                <mml:mrow>
                  <mml:mo stretchy="false">|</mml:mo>
                  <mml:mtext>concave</mml:mtext>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>p</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>i</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo stretchy="false">)</mml:mo>
                  <mml:mo stretchy="false">|</mml:mo>
                </mml:mrow>
                <mml:mrow>
                  <mml:mn>2</mml:mn>
                </mml:mrow>
              </mml:mfrac>
              <mml:mo>+</mml:mo>
              <mml:mn>1</mml:mn>
              <mml:mo stretchy="false">)</mml:mo>
            </mml:math>
          </disp-formula>
        </p>
        <p>where <italic>α</italic> ∈ [0,1] is a user defined parameter. In practice, the particle area is more accurate than the number of concave points to estimate the number of grains in the particle. For this reason, <italic>α</italic> is set to <italic>α</italic> = 0.7. The grains counting method, based on a start-to-end grain detection pipeline, is illustrated in Figure
<xref ref-type="fig" rid="F6">6</xref>.</p>
        <fig id="F6" position="float">
          <label>Figure 6</label>
          <caption>
            <p><bold>Grain counting pipeline.</bold> <bold>(a)</bold> a binary image, <bold>(b)</bold> the image after applying the 1<sup>st</sup> mathematical opening with disk size
<inline-formula><mml:math id="M11" name="1471-2229-13-122-i11" overflow="scroll"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula>, <bold>(c)</bold> the image after the 2<sup>nd</sup> mathematical opening with disk size
<inline-formula><mml:math id="M12" name="1471-2229-13-122-i12" overflow="scroll"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula>, and <bold>(d)</bold> results: small white circles represent the concave points.</p>
          </caption>
          <graphic xlink:href="1471-2229-13-122-6"/>
        </fig>
        <sec>
          <title>Calculations of grain traits</title>
          <p>The previously described method of grain detection is designed to detect both spread out and clustered grains. However, spread out grains without the panicle can be detected without all the computation involved in the proposed method. In this context, we used a simpler pipeline (similar to the one used in
[<xref ref-type="bibr" rid="B13">13</xref>]) just for the detection of spread out grains. Basically, given a binary image <italic>I</italic><sub>binary</sub>, a mathematical opening with a small-predefined disk kernel can be used to remove the juts from the seeds and to smooth the contour of the grain. The grain traits listed in Table
<xref ref-type="table" rid="T1">1</xref> are found as the following: </p>
          <p>• <italic>Length</italic>: the length of the longest line between any two points in the contour.</p>
          <p>
            <disp-formula id="bmcM5">
              <label>(5)</label>
              <mml:math id="M13" name="1471-2229-13-122-i13" overflow="scroll">
                <mml:mtext mathvariant="italic">length</mml:mtext>
                <mml:mo stretchy="false">(</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>p</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>i</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo stretchy="false">)</mml:mo>
                <mml:mo>=</mml:mo>
                <mml:mtext>max</mml:mtext>
                <mml:mspace width=".3em"/>
                <mml:mi mathvariant="normal">Δ</mml:mi>
                <mml:mo stretchy="false">(</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>ω</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>j</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>,</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>ω</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>k</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo stretchy="false">)</mml:mo>
                <mml:mo>,</mml:mo>
                <mml:mspace width=".3em"/>
                <mml:mo>∀</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>ω</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>j</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>,</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>ω</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>k</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>∈</mml:mo>
                <mml:mi mathvariant="normal">Ω</mml:mi>
                <mml:mo stretchy="false">(</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>p</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>i</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo stretchy="false">)</mml:mo>
                <mml:mspace width=".3em"/>
                <mml:mtext>and</mml:mtext>
                <mml:mspace width=".3em"/>
                <mml:mi>j</mml:mi>
                <mml:mo>≠</mml:mo>
                <mml:mi>k</mml:mi>
              </mml:math>
            </disp-formula>
          </p>
          <p>  Where Δ(.,.) is the Euclidean distance metric.</p>
          <p>• <italic>Width</italic>: For any two points in the contour, the width is the length of the longest line perpendicular to the length’s line.</p>
          <p>• <italic>Area</italic>: The number of pixels of the grain in the binary image:</p>
          <p>
            <disp-formula id="bmcM6">
              <label>(6)</label>
              <mml:math id="M14" name="1471-2229-13-122-i14" overflow="scroll">
                <mml:mtext mathvariant="italic">area</mml:mtext>
                <mml:mo stretchy="false">(</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>p</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>i</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo stretchy="false">)</mml:mo>
                <mml:mo>=</mml:mo>
                <mml:mo stretchy="false">|</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>p</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>i</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo stretchy="false">|</mml:mo>
              </mml:math>
            </disp-formula>
          </p>
          <p>• <italic>Compactness</italic>: The relation between the area of the grain and its contour (perimeter)
[<xref ref-type="bibr" rid="B26">26</xref>]<italic>,</italic>[<xref ref-type="bibr" rid="B27">27</xref>]. A normalized accurate compactness measure can be defined as
[<xref ref-type="bibr" rid="B28">28</xref>]:</p>
          <p>
            <disp-formula id="bmcM7">
              <label>(7)</label>
              <mml:math id="M15" name="1471-2229-13-122-i15" overflow="scroll">
                <mml:mtext mathvariant="italic">compactness</mml:mtext>
                <mml:mo stretchy="false">(</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>p</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>i</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo stretchy="false">)</mml:mo>
                <mml:mo>=</mml:mo>
                <mml:mfrac>
                  <mml:mrow>
                    <mml:mn>1</mml:mn>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mn>2</mml:mn>
                    <mml:mi>π</mml:mi>
                  </mml:mrow>
                </mml:mfrac>
                <mml:mo>×</mml:mo>
                <mml:mfrac>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>μ</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mn>0</mml:mn>
                        <mml:mo>,</mml:mo>
                        <mml:mn>0</mml:mn>
                      </mml:mrow>
                    </mml:msub>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>μ</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mn>2</mml:mn>
                        <mml:mo>,</mml:mo>
                        <mml:mn>0</mml:mn>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo>+</mml:mo>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>μ</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mn>0</mml:mn>
                        <mml:mo>,</mml:mo>
                        <mml:mn>2</mml:mn>
                      </mml:mrow>
                    </mml:msub>
                  </mml:mrow>
                </mml:mfrac>
              </mml:math>
            </disp-formula>
          </p>
          <p> where <italic>μ</italic><sub>.,.</sub> is the central moment of the specified order.</p>
          <p>• <italic>Ellipticity</italic>: Measures the ellipticity of the grains
[<xref ref-type="bibr" rid="B27">27</xref>].</p>
          <p>
            <disp-formula id="bmcM8">
              <label>(8)</label>
              <mml:math id="M16" name="1471-2229-13-122-i16" overflow="scroll">
                <mml:mtext mathvariant="italic">ellipticity</mml:mtext>
                <mml:mo stretchy="false">(</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>p</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>i</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo stretchy="false">)</mml:mo>
                <mml:mo>=</mml:mo>
                <mml:mfenced open="{">
                  <mml:mrow>
                    <mml:mtable columnalign="right center left">
                      <mml:mtr>
                        <mml:mtd class="align-1">
                          <mml:mn>16</mml:mn>
                          <mml:msup>
                            <mml:mrow>
                              <mml:mi>π</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mn>2</mml:mn>
                            </mml:mrow>
                          </mml:msup>
                          <mml:mfrac>
                            <mml:mrow>
                              <mml:msub>
                                <mml:mrow>
                                  <mml:mi>μ</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mn>2</mml:mn>
                                  <mml:mo>,</mml:mo>
                                  <mml:mn>0</mml:mn>
                                </mml:mrow>
                              </mml:msub>
                              <mml:msub>
                                <mml:mrow>
                                  <mml:mi>μ</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mn>0</mml:mn>
                                  <mml:mo>,</mml:mo>
                                  <mml:mn>2</mml:mn>
                                </mml:mrow>
                              </mml:msub>
                              <mml:mo>−</mml:mo>
                              <mml:msubsup>
                                <mml:mrow>
                                  <mml:mi>μ</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mn>1</mml:mn>
                                  <mml:mo>,</mml:mo>
                                  <mml:mn>1</mml:mn>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mn>2</mml:mn>
                                </mml:mrow>
                              </mml:msubsup>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:msubsup>
                                <mml:mrow>
                                  <mml:mi>μ</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mn>0</mml:mn>
                                  <mml:mo>,</mml:mo>
                                  <mml:mn>0</mml:mn>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mn>4</mml:mn>
                                </mml:mrow>
                              </mml:msubsup>
                            </mml:mrow>
                          </mml:mfrac>
                        </mml:mtd>
                        <mml:mtd class="align-2">
                          <mml:mtext>if</mml:mtext>
                          <mml:mfrac>
                            <mml:mrow>
                              <mml:msub>
                                <mml:mrow>
                                  <mml:mi>μ</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mn>2</mml:mn>
                                  <mml:mo>,</mml:mo>
                                  <mml:mn>0</mml:mn>
                                </mml:mrow>
                              </mml:msub>
                              <mml:msub>
                                <mml:mrow>
                                  <mml:mi>μ</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mn>0</mml:mn>
                                  <mml:mo>,</mml:mo>
                                  <mml:mn>2</mml:mn>
                                </mml:mrow>
                              </mml:msub>
                              <mml:mo>−</mml:mo>
                              <mml:msubsup>
                                <mml:mrow>
                                  <mml:mi>μ</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mn>1</mml:mn>
                                  <mml:mo>,</mml:mo>
                                  <mml:mn>1</mml:mn>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mn>2</mml:mn>
                                </mml:mrow>
                              </mml:msubsup>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:msubsup>
                                <mml:mrow>
                                  <mml:mi>μ</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mn>0</mml:mn>
                                  <mml:mo>,</mml:mo>
                                  <mml:mn>0</mml:mn>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mn>4</mml:mn>
                                </mml:mrow>
                              </mml:msubsup>
                            </mml:mrow>
                          </mml:mfrac>
                        </mml:mtd>
                        <mml:mtd class="align-3">
                          <mml:mo>≤</mml:mo>
                          <mml:mfrac>
                            <mml:mrow>
                              <mml:mn>1</mml:mn>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mn>16</mml:mn>
                              <mml:msup>
                                <mml:mrow>
                                  <mml:mi>π</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mn>2</mml:mn>
                                </mml:mrow>
                              </mml:msup>
                            </mml:mrow>
                          </mml:mfrac>
                        </mml:mtd>
                      </mml:mtr>
                      <mml:mtr>
                        <mml:mtd class="align-1">
                          <mml:mfrac>
                            <mml:mrow>
                              <mml:mn>1</mml:mn>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mn>16</mml:mn>
                              <mml:msup>
                                <mml:mrow>
                                  <mml:mi>π</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mn>2</mml:mn>
                                </mml:mrow>
                              </mml:msup>
                              <mml:mfrac>
                                <mml:mrow>
                                  <mml:msub>
                                    <mml:mrow>
                                      <mml:mi>μ</mml:mi>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mn>2</mml:mn>
                                      <mml:mo>,</mml:mo>
                                      <mml:mn>0</mml:mn>
                                    </mml:mrow>
                                  </mml:msub>
                                  <mml:msub>
                                    <mml:mrow>
                                      <mml:mi>μ</mml:mi>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mn>0</mml:mn>
                                      <mml:mo>,</mml:mo>
                                      <mml:mn>2</mml:mn>
                                    </mml:mrow>
                                  </mml:msub>
                                  <mml:mo>−</mml:mo>
                                  <mml:msubsup>
                                    <mml:mrow>
                                      <mml:mi>μ</mml:mi>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mn>1</mml:mn>
                                      <mml:mo>,</mml:mo>
                                      <mml:mn>1</mml:mn>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mn>2</mml:mn>
                                    </mml:mrow>
                                  </mml:msubsup>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:msubsup>
                                    <mml:mrow>
                                      <mml:mi>μ</mml:mi>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mn>0</mml:mn>
                                      <mml:mo>,</mml:mo>
                                      <mml:mn>0</mml:mn>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mn>4</mml:mn>
                                    </mml:mrow>
                                  </mml:msubsup>
                                </mml:mrow>
                              </mml:mfrac>
                            </mml:mrow>
                          </mml:mfrac>
                        </mml:mtd>
                        <mml:mtd class="align-2">
                          <mml:mtext>otherwise</mml:mtext>
                        </mml:mtd>
                        <mml:mtd class="align-3"/>
                      </mml:mtr>
                    </mml:mtable>
                  </mml:mrow>
                </mml:mfenced>
              </mml:math>
            </disp-formula>
          </p>
          <p>• <italic>AR</italic>: The aspect ratio is the relation between the major (length) and minor (width) axes of the grain.</p>
          <p>
            <disp-formula id="bmcM9">
              <label>(9)</label>
              <mml:math id="M17" name="1471-2229-13-122-i17" overflow="scroll">
                <mml:mtext mathvariant="italic">AR</mml:mtext>
                <mml:mo stretchy="false">(</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>p</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>i</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo stretchy="false">)</mml:mo>
                <mml:mo>=</mml:mo>
                <mml:mfrac>
                  <mml:mrow>
                    <mml:mtext mathvariant="italic">length</mml:mtext>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>p</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>i</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mtext mathvariant="italic">width</mml:mtext>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>p</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>i</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                </mml:mfrac>
              </mml:math>
            </disp-formula>
          </p>
        </sec>
      </sec>
    </sec>
    <sec>
      <title>P-TRAP architecture and GUI</title>
      <p>The system is composed of the 11 main modules listed in Table
<xref ref-type="table" rid="T2">2</xref>. Figure
<xref ref-type="fig" rid="F7">7</xref> illustrates the processing pipeline interaction between the different modules and the user interface. The main GUI window has a set of areas: <italic>Project Manager</italic>, <italic>Commands</italic>, and <italic>WorkSpace</italic> (Figure
<xref ref-type="fig" rid="F8">8</xref>). In the <italic>Project Manager</italic>, the user can find the project folders, which include the source and processed images and the results sub-folders. The <italic>Commands</italic> area is composed of a menu and toolbar, which increases accessibility and makes it easy to find a specific command. In the <italic>WorkSpace</italic>, many different floating windows can be displayed at the same time. In this area, the user can review and edit the structure results in the <italic>Structure Editor</italic>. The same buttons are used to perform the same tasks in all windows. For instance, the user can view and edit the results of the grains in the grain editor and use the save button (Floppy icon) to save the changes (Additional file
<xref ref-type="supplementary-material" rid="S2">2</xref>). The same button can be used to save the corrected result of the structure in the structure editor or the cropped image in the image editor. In addition, each editor is supplied with a context menu, keyboard-driven and mouse-driven commands. The user can correct a vertex in the structure editor by moving, deleting or connecting it. Furthermore, the class of a vertex can be changed and the application will try to adapt to the change or display an error hint if detected, Additional file
<xref ref-type="supplementary-material" rid="S2">2</xref>.</p>
      <table-wrap position="float" id="T2">
        <label>Table 2</label>
        <caption>
          <p>System main modules</p>
        </caption>
        <table frame="hsides" rules="groups" border="1">
          <colgroup>
            <col align="left"/>
            <col align="center"/>
            <col align="center"/>
          </colgroup>
          <thead valign="top">
            <tr>
              <th align="left">
                <bold>Module</bold>
              </th>
              <th align="left">
                <bold>Description</bold>
              </th>
              <th align="left">
                <bold>Type</bold>
              </th>
            </tr>
          </thead>
          <tbody valign="top">
            <tr>
              <td align="left" valign="bottom">ImageProcessor<hr/></td>
              <td align="left" valign="bottom">Core image processing tasks<hr/></td>
              <td align="left" valign="bottom">Core<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom">MathProcessor<hr/></td>
              <td align="left" valign="bottom">Basic mathematical tasks required by other modules<hr/></td>
              <td align="left" valign="bottom">Core<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom">SkeletonProcessor<hr/></td>
              <td align="left" valign="bottom">Skeleton-related tasks<hr/></td>
              <td align="left" valign="bottom">Core<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom">GraphProcessor<hr/></td>
              <td align="left" valign="bottom">Performs the graph tasks<hr/></td>
              <td align="left" valign="bottom">Core<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom">ParitcelProcessor<hr/></td>
              <td align="left" valign="bottom">Particles processing and quantification<hr/></td>
              <td align="left" valign="bottom">Core<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom">RiceProjectType<hr/></td>
              <td align="left" valign="bottom">Manages the rice project folders and files<hr/></td>
              <td align="left" valign="bottom">GUI<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom">RiceOptions<hr/></td>
              <td align="left" valign="bottom">Manages the application options and the algorithm parameters<hr/></td>
              <td align="left" valign="bottom">GUI<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom">WidgetFactory<hr/></td>
              <td align="left" valign="bottom">Responsible for creating user friendly widgets for elegant user interactions<hr/></td>
              <td align="left" valign="bottom">GUI<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom">WorkSpace<hr/></td>
              <td align="left" valign="bottom">The main module for connecting the user commands and the core modules<hr/></td>
              <td align="left" valign="bottom">Link<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom">ReportProcessor<hr/></td>
              <td align="left" valign="bottom">Generates the reports<hr/></td>
              <td align="left" valign="bottom">Core<hr/></td>
            </tr>
            <tr>
              <td align="left">FileProcessor</td>
              <td align="left">Manages the file system</td>
              <td align="left">Core</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <p>The main P-TRAP system modules differ depending on the task performed and on user visibility. The three main modules are <italic>core</italic>: performs an internal task, <italic>GUI</italic>: manages and produces visual components, and <italic>link</italic>: links two or more modules or the user’s commands and the core system modules.</p>
        </table-wrap-foot>
      </table-wrap>
      <fig id="F7" position="float">
        <label>Figure 7</label>
        <caption>
          <p><bold>P-TRAP architecture and the processing pipeline.</bold> The input images and the software options are provided by the user. These images are then binarized and passed to the graph and particle processing modules to identify the structure and the grains on the panicle. The resulting graphs and particles are stored in separate XML files for visualization and additional editing. These editors are part of the <italic>Workspace</italic> module, which translates the XML files into editable widgets supported by the <italic>WidgetFactory</italic> GUI helper module. The user can easily edit these visual widgets and send the changes back to the XML files for storage. All interactions between the user and the system are performed using the <italic>Workspace</italic> module. The final reports are based on the contents of the XML files. The contents of these reports are stored in CSV files with different levels of detail.</p>
        </caption>
        <graphic xlink:href="1471-2229-13-122-7"/>
      </fig>
      <fig id="F8" position="float">
        <label>Figure 8</label>
        <caption>
          <p><bold>Main GUI window areas.</bold> <italic>Project Manager</italic>: the user can manipulate the project folders and their files; <italic>Commands</italic>: the user can run a specific process on the selected project; <italic>Workspace</italic>: the user can visualize and edit the selected widgets.</p>
        </caption>
        <graphic xlink:href="1471-2229-13-122-8"/>
      </fig>
    </sec>
    <sec>
      <title>P-TRAP output files</title>
      <p>The data collected from the processed images are exported in two different formats: XML and CSV. The XML format is used to store the panicle structure and the grains particles, and can be exported for other applications such as OpenAlea after conversion to the MTG (Multiscale Tree Graph) format
[<xref ref-type="bibr" rid="B14">14</xref>]. Each analysis run produces two files: <italic>.ricepr</italic> and <italic>.ricegr</italic> for the structure and the grains, respectively. More information on the structure of the output files is available in Additional file
<xref ref-type="supplementary-material" rid="S2">2</xref>. A CSV file is also generated to allow direct visualization of the results and easy transfer to spreadsheet software (<italic>e.g.</italic> Microsoft Excel). The results of the quantification of the panicle and grains are stored in files with two different levels of details. These CSV files are: </p>
      <p>• <italic>MainTraits.csv</italic>: contains the main general data about the panicle.</p>
      <p>• <italic>GrainsTraits.csv</italic>: contains the average values of all the data on the grain’s traits.</p>
      <p>• <italic>AllTraits.csv</italic>: contains detailed data on the traits of each branch.</p>
      <p>In addition to <italic>GrainsTraits.csv</italic>, each image has a result file that describes each grain trait individually in the <italic>Particles folder</italic>.</p>
    </sec>
  </sec>
  <sec>
    <title>Results and discussion</title>
    <p>To evaluate the accuracy of P-TRAP, 26 different images of panicles from <italic>O. sativa</italic>, <italic>O. glaberrima</italic> and <italic>O. barthii</italic> were tested in both structure and grain counting tasks. Images were captured using a digital camera (Sony DSC-W55) and saved in the JPEG format (Joint Photographic Experts Group). Image size was 2592 × 1944 with 72 dpi (see Additional file
<xref ref-type="supplementary-material" rid="S3">3</xref> for the 26 images tested in this work).</p>
    <p>For grain detection and quantification, either RGB images of spread out panicles or images of spread out seeds without panicles can be used (Figure
<xref ref-type="fig" rid="F2">2</xref>). Specific images of spread ou seeds have been captured using a digital camera (Canon PowerShot G12) with a size of 3648 × 2048 at 180 dpi in the JPEG format (see Additional file
<xref ref-type="supplementary-material" rid="S4">4</xref> for the images that were tested in this work).</p>
    <p>The structure finding used by P-TRAP was evaluated and tuned by an expert using the obtained graph, and the options from the GUI, and was compared with results obtained by a field-operator created results (FO). The grain counting method was compared to two academic methods, a Lab Counting (LC) and the FO. The parameter values (in pixels) used for the tests were <italic>minSpike</italic> = 40, <italic>kernelSize</italic> = 3 × 3 and <italic>minParticle</italic> = 1000 for image to graph conversion. For grains counting, <italic>d</italic><sub>min</sub> and <italic>d</italic><sub>max</sub> were set to 5 and 14 pixels, respectively.</p>
    <sec>
      <title>Panicle structure</title>
      <p>For evaluation the panicle structure, only the main manually measurable traits (length of the primary axes, number of nodes, secondary axes, and the number and length of the tertiary axes) were used for the comparison with the values obtained by P-TRAP. Table
<xref ref-type="table" rid="T3">3</xref> summarizes first the differences between the results obtained by P-TRAP and manual measurements by comparing data before and after expert evaluation and, second, the differences between corrected P-TRAP results (<italic>i.e.</italic> P-TRAP data after expert evaluation) and the results obtained by the FO (Field Operator).</p>
      <table-wrap position="float" id="T3">
        <label>Table 3</label>
        <caption>
          <p>Results of panicle structure quantification</p>
        </caption>
        <table frame="hsides" rules="groups" border="1">
          <colgroup>
            <col align="left"/>
            <col align="center"/>
            <col align="center"/>
            <col align="center"/>
            <col align="center"/>
            <col align="center"/>
            <col align="center"/>
          </colgroup>
          <thead valign="top">
            <tr>
              <th align="left" valign="bottom"> <hr/></th>
              <th colspan="3" align="center" valign="bottom">
                <bold>P-TRAP</bold>
                <bold>
                  <italic>v</italic>
                </bold>
                <bold> Corrected P-TRAP (%)</bold>
                <hr/>
              </th>
              <th colspan="3" align="center" valign="bottom">
                <bold>Corrected P-TRAP <italic>v</italic></bold>
                <bold> FO (%)</bold>
                <hr/>
              </th>
            </tr>
            <tr>
              <th align="left">
                <bold>Trait</bold>
              </th>
              <th align="left">
                <bold>Mean</bold>
              </th>
              <th align="left">
                <bold>STD</bold>
              </th>
              <th align="center">
                <bold>Sign</bold>
              </th>
              <th align="left">
                <bold>Mean</bold>
              </th>
              <th align="left">
                <bold>STD</bold>
              </th>
              <th align="center">
                <bold>Sign</bold>
              </th>
            </tr>
          </thead>
          <tbody valign="top">
            <tr>
              <td align="left" valign="bottom">
                <italic>PA_length</italic>
                <hr/>
              </td>
              <td align="left" valign="bottom">0.37%<hr/></td>
              <td align="left" valign="bottom">0.87%<hr/></td>
              <td align="center" valign="bottom">-<hr/></td>
              <td align="left" valign="bottom">3.68%<hr/></td>
              <td align="left" valign="bottom">3.68%<hr/></td>
              <td align="center" valign="bottom">+<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom">
                <italic>Nodes_nb</italic>
                <hr/>
              </td>
              <td align="left" valign="bottom">0.25%<hr/></td>
              <td align="left" valign="bottom">1.32%<hr/></td>
              <td align="center" valign="bottom">-<hr/></td>
              <td align="left" valign="bottom">12.14%<hr/></td>
              <td align="left" valign="bottom">12.95%<hr/></td>
              <td align="center" valign="bottom">-<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom">
                <italic>SA_nb</italic>
                <hr/>
              </td>
              <td align="left" valign="bottom">2.91%<hr/></td>
              <td align="left" valign="bottom">1.47%<hr/></td>
              <td align="center" valign="bottom">-<hr/></td>
              <td align="left" valign="bottom">2.06%<hr/></td>
              <td align="left" valign="bottom">7.56%<hr/></td>
              <td align="center" valign="bottom">+<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom">
                <italic>SA_length</italic>
                <hr/>
              </td>
              <td align="left" valign="bottom">1.05%<hr/></td>
              <td align="left" valign="bottom">0.44%<hr/></td>
              <td align="center" valign="bottom">+<hr/></td>
              <td align="left" valign="bottom">5.46%<hr/></td>
              <td align="left" valign="bottom">4.43%<hr/></td>
              <td align="center" valign="bottom">+<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom">
                <italic>TA_nb</italic>
                <hr/>
              </td>
              <td align="left" valign="bottom">6.09%<hr/></td>
              <td align="left" valign="bottom">3.20%<hr/></td>
              <td align="center" valign="bottom">+<hr/></td>
              <td align="left" valign="bottom">10.60%<hr/></td>
              <td align="left" valign="bottom">14.01%<hr/></td>
              <td align="center" valign="bottom">+<hr/></td>
            </tr>
            <tr>
              <td align="left">
                <italic>Sp_nb</italic>
              </td>
              <td align="left">5.41%</td>
              <td align="left">3.81%</td>
              <td align="center">-</td>
              <td align="left">3.69%</td>
              <td align="left">4.60%</td>
              <td align="center">-</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <p>The percentage deviation in the processing of 26 images between 1) the P-TRAP automatic results (P-TRAP raw data) and the corrected data after expert evaluation and 2) between the corrected P-TRAP data and field operator results (FO). The factors assessed (Traits) were Rachis length (<italic>PA_length</italic>), Number of nodes (<italic>Nodes_nb</italic>), Number of secondary Axes (<italic>SA_nb</italic>), Average length of Secondary Axes (<italic>SA_length</italic>), Number of tertiary axes (<italic>TA_nb</italic>) and the Number of grains (<italic>Sp_nb</italic>). The results were calculated for the mean of differences, standard deviation (STD), and the deviation sign (Sign).</p>
        </table-wrap-foot>
      </table-wrap>
      <p>Considering all the measured traits, the average deviation between the P-TRAP automatic results and the corrected ones after expert evaluation was 2.68%, with deviations ranging from 0.25% to 6.09%(Table
<xref ref-type="table" rid="T3">3</xref>). Overall, these values indicate that P-TRAP provides robust detection and quantification of panicle structure traits with only a little post-processing required by the user. The average deviation between the corrected P-TRAP results and the FO was 6.27% (deviations ranged from 2.06% to 12.14%). The higher deviations were caused by the nodes and the number of tertiary axes (Nodes nb and TA nb respectively in Table
<xref ref-type="table" rid="T3">3</xref>). The high deviation observed in the values of <italic>TA_nb</italic> after expert evaluation compared to FO might be due to the fact that panicles are sometimes not properly spread out and branches overlapped (as illustrated in Additional file
<xref ref-type="supplementary-material" rid="S5">5</xref>). This problem can easily be corrected by spreading the panicle out better. Furthermore, the panicle images are fixed to the background by metal pins. In some cases, the pins falsify the elongation of the branches. The difference in the number of nodes observed between corrected P-TRAP values and FO might be related to a difference in the evaluation of this feature between the software and the field operator. In the software, each secondary axis is born by an individual node. However, in some accessions, secondary axes are born by the same node and the field operator considered these as a single node.</p>
      <p>Compared to the FO, raw P-TRAP results are more than 90% correct, which is acceptable for this difficult problem. These comparisons indicated that P-TRAP provides reliable quantification of the panicle traits as long as the panicle is properly spread out against the background.</p>
    </sec>
    <sec>
      <title>Number of grains and grain traits</title>
      <p>For the grain counting evaluation, results of the P-TRAP, FO, LC and academic methods are listed in Table
<xref ref-type="table" rid="T4">4</xref>. These academic approaches are the watershed transform (WS)
[<xref ref-type="bibr" rid="B29">29</xref>] and the Center Supported Segmentation (CSS)
[<xref ref-type="bibr" rid="B30">30</xref>] methods (Table
<xref ref-type="table" rid="T4">4</xref>). As it is not appropriate to apply these methods directly to the original binary images (Figure
<xref ref-type="fig" rid="F6">6</xref>a), they were applied to the images obtained from the second level mathematical opening, where the thin parts of the panicle are removed and only the grain clusters remain (Figure
<xref ref-type="fig" rid="F6">6</xref>c).</p>
      <table-wrap position="float" id="T4">
        <label>Table 4</label>
        <caption>
          <p>Grain counting results</p>
        </caption>
        <table frame="hsides" rules="groups" border="1">
          <colgroup>
            <col align="left"/>
            <col align="center"/>
            <col align="center"/>
            <col align="center"/>
            <col align="center"/>
            <col align="center"/>
            <col align="center"/>
          </colgroup>
          <thead valign="top">
            <tr>
              <th align="center">
                <bold>Dev.</bold>
              </th>
              <th align="center"><bold>P-TRAP</bold> <bold><italic>v</italic></bold><bold> FO</bold></th>
              <th align="center"><bold>P-TRAP</bold> <bold><italic>v</italic></bold><bold> LC</bold></th>
              <th align="center"><bold>WS</bold> <bold><italic>v</italic></bold><bold> FO</bold></th>
              <th align="center"><bold>WS</bold> <bold><italic>v</italic></bold><bold> LC</bold></th>
              <th align="center"><bold>CSS</bold> <bold><italic>v</italic></bold><bold> FO</bold></th>
              <th align="center"><bold>CSS</bold> <bold><italic>v</italic></bold><bold> LC</bold></th>
            </tr>
          </thead>
          <tbody valign="top">
            <tr>
              <td align="center" valign="bottom">
                <italic>Mean</italic>
                <hr/>
              </td>
              <td align="center" valign="bottom">7.44%<hr/></td>
              <td align="center" valign="bottom">6.84%<hr/></td>
              <td align="center" valign="bottom">11.11%<hr/></td>
              <td align="center" valign="bottom">10.84%<hr/></td>
              <td align="center" valign="bottom">10.76%<hr/></td>
              <td align="center" valign="bottom">10.32%<hr/></td>
            </tr>
            <tr>
              <td align="center" valign="bottom">
                <italic>STD</italic>
                <hr/>
              </td>
              <td align="center" valign="bottom">6.21%<hr/></td>
              <td align="center" valign="bottom">4.37%<hr/></td>
              <td align="center" valign="bottom">8.87%<hr/></td>
              <td align="center" valign="bottom">7.60%<hr/></td>
              <td align="center" valign="bottom">9.13%<hr/></td>
              <td align="center" valign="bottom">7.71%<hr/></td>
            </tr>
            <tr>
              <td align="center">
                <italic>Sign</italic>
              </td>
              <td align="center">+</td>
              <td align="center">+</td>
              <td align="center">+</td>
              <td align="center">+</td>
              <td align="center">-</td>
              <td align="center">-</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <p>The percentage of deviation from 26 images processing has been compared between the P-TRAP automatic results (P-TRAP raw data), the field operator (FO), Lab Counting (LC), and two well-known academic segmentation approaches: Watershed (WS) and Center Supported Segmentation (CSS). The results were calculated for the mean of differences, standard deviation (STD), and the deviation sign (Sign).</p>
        </table-wrap-foot>
      </table-wrap>
      <p>An average deviation of 7.44% (deviations ranged from 0.86% to 30.88% depending on the image with a standard deviation of 6.21% and a positive deviation sign) was observed between raw P-TRAP results and FO. The results also had a deviation of 6.84% from LC (deviations ranged from 1.80% to 26.1% with a standard deviation of 4.37% and a positive deviation sign). In contrast, the WS approach had an average deviation of 11.11% (deviations ranged from 1.85% to 39.29% with a standard deviation of 8.87% and a positive deviation). Regarding LC, WS had an average deviation of 10.84% (deviations ranged from 1.53% to 36.84% with a standard deviation of 7.60% and a negative deviation sign). The CSS method had an average deviation of 10.76% (deviations ranged from 0% to 32.35% with a standard deviation of 9.13%, and a negative deviation sign). The comparison of CSS and LC had an average deviation of 10.32% (deviations ranged from 0.48% to 26.09% with a standard deviation of 7.71%, and a positive deviation sign). P-TRAP outweighs all other methods and produces the lowest deviation and standard deviation. Which ensures the stability and accuracy for when tested to different panicles with different type of grains. The WS method is widely known to be efficient in segmenting overlapped circular shapes
[<xref ref-type="bibr" rid="B30">30</xref>], but under-segments elliptical shapes when the overlap ratio is high
[<xref ref-type="bibr" rid="B31">31</xref>]. Furthermore, the watershed over-segmentation problem can be clearly observed when the contour is noisy (Additional file
<xref ref-type="supplementary-material" rid="S6">6</xref>). Although the CSS method is slightly better than the WS approach, in this context, it was difficult to set up an overlapping threshold for the grains that copes with the variation in the grains. The parameters used for this method were <italic>samplingFactor</italic> = 3, <italic>saddleHeight</italic> = 2, <italic>overlappingFactor</italic> = 0.7.</p>
      <p>In overall, the P-TRAP method gave a good estimation of the number of grains on the images tested. It was efficient in finding the “optimal” disk size for mathematical opening. The difference between P-TRAP and FO may be a consequence of the overlapping of the grains which makes it difficult to estimate the exact number of grains (Additional file
<xref ref-type="supplementary-material" rid="S5">5</xref>). Nevertheless, in contrast to other methods or applications, the used method has the advantage of detecting and counting grains directly on the panicle images. In addition, P-TRAP has different options that can be adapted to work with color and grayscale images (Additional file
<xref ref-type="supplementary-material" rid="S2">2</xref>).</p>
      <p>Finally, grain traits (Table
<xref ref-type="table" rid="T1">1</xref>) were measured using the same set of images of spread out panicles in addition to 21 images of spread out seeds (see Additional file
<xref ref-type="supplementary-material" rid="S4">4</xref>). Additional file
<xref ref-type="supplementary-material" rid="S6">6</xref> presents two different examples of the detection of grain traits performed by P-TRAP from the two types of images. Averaged values of seed traits in output files result from individual seeds (<italic>i.e.</italic> seed clusters from spread out panicles or spread out seeds were not considered for analysis). The ability of P-TRAP to detect and quantify seeds directly on spread out panicles makes it possible to analyze seed shape traits in relation to their position in the panicle. In this context, and in comparison to the only available closed-source application (Smartgrain), both P-TRAP and Smartgrain have pros and cons. Smartgrain has two methods of segmentation, color and grayscale. The color segmentation method needs the user to define the grain and background colors. The grayscale segmentation method has a problem. It is so sensitive to variations in lightness (Additional file
<xref ref-type="supplementary-material" rid="S6">6</xref>). These shortcomings can be obstacles if the source images are grayscale and have a small illumnation variation. In contrast, detection of grain traits is one of the three main tasks P-TRAP offers. Concerning segmentation, P-TRAP uses a local adaptive thresholding method (mean-c) for grayscale images. For colorful images, P-TRAP also provides an option which, like Smartgrain, asks the user to select the grain and background colors. However, as mentioned above, the main advantage of P-TRAP is that it can detect grain traits on the branches while Smartgrain does not have this feature.</p>
    </sec>
    <sec>
      <title>P-TRAP robustness and extensibility</title>
      <p>Some of the requirements for P-TRAP were user-friendliness, multiple platform support, extensibility, and compatibility with other plant inflorescences with similar structure. P-TRAP also uses some general methods used for image processing. The challenge in detecting structure was to convert the panicle to a graph, and to quantify it. It has been shown that the thinning step is very important in obtaining the structure of the objects in binary images. Many applications depend on the skeletonization process to minimize the amount of data to be processed, <italic>e.g.</italic> Quench function
[<xref ref-type="bibr" rid="B21">21</xref>], to extract accurate features for image matching
[<xref ref-type="bibr" rid="B32">32</xref>], to perform image warping
[<xref ref-type="bibr" rid="B33">33</xref>], or to analyze plant root structure
[<xref ref-type="bibr" rid="B34">34</xref>].</p>
      <p>The skeleton was efficient in revealing the structure of the panicle, but not enough to accurately quantify the panicle. Therefore, the panicle skeleton was converted to a mathematical graph, which was more flexible. Graphs and contours are very efficient to deal with skeletons
[<xref ref-type="bibr" rid="B35">35</xref>]<italic>-</italic>[<xref ref-type="bibr" rid="B37">37</xref>]. In many cases, the skeleton contains small insignificant branches and cleaning has to be applied to clean the skeleton and preserve its structure at the same time. Different spike pruning approaches are available, such as the distance transform
[<xref ref-type="bibr" rid="B38">38</xref>], the number and distribution of the maximal disk
[<xref ref-type="bibr" rid="B39">39</xref>], branch length
[<xref ref-type="bibr" rid="B40">40</xref>] and so on. In this work, the skeleton was initially converted to a graph and the graph was then cleaned by removing all spikes that were shorter than a threshold <italic>minSpike</italic> (an editable parameter in the P-TRAP options). In addition, the single-grained branches in the panicle were not significant and had to be removed. Skeleton processing, graph processing, and the quantification methods are implemented in independent modules so any improvement or extension to any of these processes can be made very easily. In addition, these modules can be reused in other projects. Concerning the detection and quantification of the grains, the challenge was to directly detect the grains on a panicle with overlapping grains and variations in size. The detection approach, particle analysis, and the central moments are implemented as modularly as possible to allow for future extensions and re-usability.</p>
    </sec>
  </sec>
  <sec sec-type="conclusions">
    <title>Conclusions</title>
    <p>P-TRAP, a freely available application for processing plant panicles is described here. This tool will be very useful for exploiting the rice diversity resources and for categorizing rice in different groups, based on inflorescence phenotyping. The tool can be used for analysis of architecture (relationship between different morphological traits), for analysis of genetics (both forward and reverse approaches) and for breeding programs. Moreover the ability of P-TRAP to detect and quantify seeds directly on spread out panicles makes it possible to analyze seed shape traits in relation to their position on the panicle (<italic>i.e.</italic> the apico-basal axis, primary branches <italic>vs.</italic> other branches).</p>
    <p>The rice inflorescence varies widely among accessions and species in terms of branching structure and seed shape. The development of software able to automatically extract quantitative values of panicle structure and seed traits will facilitate the phenotyping of these morphological traits. A complete framework for analyzing rice panicle images is proposed in this paper. The application provides several editors for the input image, the detected structure, and the grains. The structure quantification method was compared to a manually created ground truth and the results showed an accuracy of about 90%. Grain detection and the counting method were compared to two academic methods as well as to ground truth and P-TRAP outperformed the other methods. However, the application, especially the method for detecting the skeleton of the panicle and converting it to a graph has one main shortcoming. It may not correctly detect overlapped branches, and in some cases, this may require some manual post processing to correct the structure. However, this problem can be minimized by carefully spreading out the panicle on the background. On the other hand, P-TRAP can efficiently deal with different rice panicles regardless of their size or complexity. Finally, the P-TRAP processing pipeline is implemented in a highly modular environment and developers can easily improve the application. A further important feature of P-TRAP is that the data are stored in XML files, which can be used in other applications such as OpenAlea, a platform dedicated to plant architecture.</p>
    <p>In addition to P-TRAP’s fully featured GUI, some other features are: </p>
    <p>• Free open source application</p>
    <p>• Platform-independent</p>
    <p>• Written on top of a well-known modular platform (Netbeans Platform)</p>
    <p>• User-friendly interface</p>
    <p>• Allows the users to save the processed image.</p>
    <p>The application comes with different installers that are available at the application’s website. The source code and a sample project can be found in Additional files
<xref ref-type="supplementary-material" rid="S7">7</xref> and
<xref ref-type="supplementary-material" rid="S8">8</xref>, respectively. For details of the GUI features, the reader should refer to the user manual in Additional file
<xref ref-type="supplementary-material" rid="S2">2</xref>.</p>
  </sec>
  <sec>
    <title>Availability and requirements</title>
    <p><bold>Project name:</bold> P-TRAP</p>
    <p><bold>Project home page:</bold><ext-link ext-link-type="uri" xlink:href="http://bioinfo.mpl.ird.fr/index.php?option=com_content&amp;view=article&amp;id=102&amp;Itemid=2">http://bioinfo.mpl.ird.fr/index.php?option=com_content&amp;view=article&amp;id=102&amp;Itemid=2</ext-link>.Several video tutorials can be found at this URL.</p>
    <p><bold>Operating system(s):</bold> Platform independent</p>
    <p><bold>Programming language:</bold> Java</p>
    <p><bold>Other requirements:</bold> JRE ≥1.6 to run the application. To compile the source code, the Netbeans Platform ≥ V.7.3 IDE, Java Matrix Package (JAMA) ≥ V.1.0.2 and Java Advanced Imaging (JAI) ≥ V.1.3 libraries are needed.</p>
    <p><bold>License:</bold> GPL V3</p>
    <p><bold>Any restrictions to use by non-academics:</bold> As specified by GPL V3 license.</p>
  </sec>
  <sec>
    <title>Abbreviations</title>
    <p>CSV: Comma separated values; XML: EXtensible markup language; MTG: Multiscale tree graph; CSS: Center supported segmentation; FO: Field operator result; P-TRAP: Panicle tRAits phenotyping; PASTAR: Panicle structure analyzer for rice; PA: Primary axe; Pb: Primary branch; SA: Secondary axe; Sb: Secondary branch; Sp: Spikelet; TA: Tertiary axe; Tb: Tertiary branch; QA: Quaternary branch; JAMA: Java matrix package; JAI: Java advanced imaging.</p>
  </sec>
  <sec>
    <title>Competing interests</title>
    <p>The authors declare that they have no competing interests.</p>
  </sec>
  <sec>
    <title>Authors’ contributions</title>
    <p>All authors contributed to the development of P-TRAP HA, HRS, and SJ managed and organized the project. HA, SJ, AG, and ML provided the biological background, the testing samples and tested the results during development. FA, and HA, designed and implemented the algorithms and tested the software. PL contributed to local installation, maintenance and evaluation of P-TRAP software. All the authors read and approved the final manuscript.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="S1">
      <caption>
        <title>Additional file 1</title>
        <p><bold>Skeleton conversion to mathematical graph.</bold> The technical description of the algorithm for converting the skeleton into a graph.</p>
      </caption>
      <media xlink:href="1471-2229-13-122-S1.zip">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="S2">
      <caption>
        <title>Additional file 2</title>
        <p><bold>User manual of P-TRAP.</bold> The description of the software and a set of examples of how the user can install and use the application.</p>
      </caption>
      <media xlink:href="1471-2229-13-122-S2.pdf">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="S3">
      <caption>
        <title>Additional file 3</title>
        <p><bold>26 images of spread out panicles.</bold> A set of images of spread out panicles used to test the application for the detection of the structure, counting the grains or spikelets and for the detection of grain traits.</p>
      </caption>
      <media xlink:href="1471-2229-13-122-S3.zip">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="S4">
      <caption>
        <title>Additional file 4</title>
        <p><bold>21 images of spread out seeds.</bold> A set of images of spread out grains used to test the application for the detection of grain traits.</p>
      </caption>
      <media xlink:href="1471-2229-13-122-S4.zip">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="S5">
      <caption>
        <title>Additional file 5</title>
        <p><bold>Example of overlapping grains.</bold> Samples with extremely overlapped grains.</p>
      </caption>
      <media xlink:href="1471-2229-13-122-S5.pdf">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="S6">
      <caption>
        <title>Additional file 6</title>
        <p><bold>Sample images processed by P-TRAP and by other approaches.</bold> Several different images processed by P-TRAP and by other approaches.</p>
      </caption>
      <media xlink:href="1471-2229-13-122-S6.pdf">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="S7">
      <caption>
        <title>Additional file 7</title>
        <p><bold>P-TRAP source code.</bold> The Netbeans project that contains the source code of the application.</p>
      </caption>
      <media xlink:href="1471-2229-13-122-S7.zip">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="S8">
      <caption>
        <title>Additional file 8</title>
        <p><bold>Test data for the P-TRAP software.</bold> A complete P-TRAP project, can be used in the application for tests.</p>
      </caption>
      <media xlink:href="1471-2229-13-122-S8.zip">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <sec>
    <title>Acknowledgements</title>
    <p>HR Shahbazkia would like to thank D Fontenille (head of UMR MIVEGEC, in IRD, Montpellier France) for the reception facilities. The authors would like to thank Joe Tohme (CIAT, Cali, Colombia) for the field phenotyping facilities and for the production of spread out panicle images. Harold Chrestin is thanked for the spread out seed images. This work was supported by IRD institutional funding, GRiSP funding (MENERGEP project), Agropolis fonudation and Cariplo foundation co-funding (FIRST/EVOREPRICE 2011).</p>
  </sec>
  <ref-list>
    <ref id="B1">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Yoshida</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>Nagato</surname>
          <given-names>Y</given-names>
        </name>
        <article-title>Flower development in rice</article-title>
        <source>J Exper Botany</source>
        <year>2011</year>
        <volume>62</volume>
        <issue>14</issue>
        <fpage>4719</fpage>
        <lpage>4730</lpage>
        <pub-id pub-id-type="doi">10.1093/jxb/err272</pub-id>
        <pub-id pub-id-type="pmid">21914655</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B2">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Xing</surname>
          <given-names>Q</given-names>
        </name>
        <collab>Y &amp; Zhang</collab>
        <article-title>Genetic and molecular bases of rice yield</article-title>
        <source>Ann Rev Plant Biol</source>
        <year>2010</year>
        <volume>61</volume>
        <fpage>421</fpage>
        <lpage>442</lpage>
        <pub-id pub-id-type="doi">10.1146/annurev-arplant-042809-112209</pub-id>
        <pub-id pub-id-type="pmid">20192739</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B3">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Wang</surname>
          <given-names>Y</given-names>
        </name>
        <name>
          <surname>Li</surname>
          <given-names>J</given-names>
        </name>
        <article-title>Branching in rice</article-title>
        <source>Curr Opin Plant Biol</source>
        <year>2011</year>
        <volume>14</volume>
        <fpage>94</fpage>
        <lpage>99</lpage>
        <pub-id pub-id-type="doi">10.1016/j.pbi.2010.11.002</pub-id>
        <?supplied-pmid 21144796?>
        <pub-id pub-id-type="pmid">21144796</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B4">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Vaughan</surname>
          <given-names>DA</given-names>
        </name>
        <name>
          <surname>Morishima</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>Kadowaki</surname>
          <given-names>K</given-names>
        </name>
        <article-title>Diversity in the Oryza genus</article-title>
        <source>Curr Opin Plant Biol</source>
        <year>2003</year>
        <volume>6</volume>
        <issue>2</issue>
        <fpage>139</fpage>
        <lpage>146</lpage>
        <pub-id pub-id-type="doi">10.1016/S1369-5266(03)00009-8</pub-id>
        <?supplied-pmid 12667870?>
        <pub-id pub-id-type="pmid">12667870</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B5">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Reuzeau</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Pen</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Frankard</surname>
          <given-names>V</given-names>
        </name>
        <name>
          <surname>de Wolf</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Peerbolte</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Broekaert</surname>
          <given-names>W</given-names>
        </name>
        <name>
          <surname>van Camp</surname>
          <given-names>W</given-names>
        </name>
        <article-title>TraitMill: a discovery engine for identifying yield-enhancement genes in cereals</article-title>
        <source>Mol Plant Breed</source>
        <year>2005</year>
        <volume>3</volume>
        <issue>5</issue>
        <fpage>753</fpage>
        <lpage>759</lpage>
      </mixed-citation>
    </ref>
    <ref id="B6">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Hartmann</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Czauderna</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Hoffmann</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Stein</surname>
          <given-names>N</given-names>
        </name>
        <name>
          <surname>Schreiber</surname>
          <given-names>F</given-names>
        </name>
        <article-title>HTPheno: An image analysis pipeline for high-throughput plant phenotyping</article-title>
        <source>BMC Bioinformatics</source>
        <year>2011</year>
        <volume>12</volume>
        <fpage>148</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-12-148</pub-id>
        <?supplied-pmid 21569390?>
        <pub-id pub-id-type="pmid">21569390</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B7">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Granier</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Aguirrezabal</surname>
          <given-names>L</given-names>
        </name>
        <name>
          <surname>Chenu</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Cookson</surname>
          <given-names>SJ</given-names>
        </name>
        <name>
          <surname>Dauzat</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Hamard</surname>
          <given-names>P</given-names>
        </name>
        <name>
          <surname>Thioux</surname>
          <given-names>JJ</given-names>
        </name>
        <name>
          <surname>Rolland</surname>
          <given-names>G</given-names>
        </name>
        <name>
          <surname>Bouchier-Combaud</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Lebaudy</surname>
          <given-names>A</given-names>
        </name>
        <etal/>
        <article-title>PHENOPSIS, an automated platform for reproducible phenotyping of plant responses to soil water deficit in Arabidopsis thaliana permitted the identification of an accession with low sensitivity to soil water deficit</article-title>
        <source>New Phytol</source>
        <year>2006</year>
        <volume>169</volume>
        <issue>3</issue>
        <fpage>623</fpage>
        <lpage>635</lpage>
        <pub-id pub-id-type="doi">10.1111/j.1469-8137.2005.01609.x</pub-id>
        <?supplied-pmid 16411964?>
        <pub-id pub-id-type="pmid">16411964</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B8">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Walter</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Scharr</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>Gilmer</surname>
          <given-names>F</given-names>
        </name>
        <name>
          <surname>Zierer</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Nagel</surname>
          <given-names>KA</given-names>
        </name>
        <name>
          <surname>Ernst</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Wiese</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Virnich</surname>
          <given-names>O</given-names>
        </name>
        <name>
          <surname>Christ</surname>
          <given-names>MM</given-names>
        </name>
        <name>
          <surname>Uhlig</surname>
          <given-names>B</given-names>
        </name>
        <name>
          <surname>Jünger</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Schurr</surname>
          <given-names>U</given-names>
        </name>
        <article-title>Dynamics of seedling growth acclimation towards altered light conditions can be quantified via, GROWSCREEN: a setup and procedure designed for rapid optical phenotyping of different plant species</article-title>
        <source>New Phytol</source>
        <year>2007</year>
        <volume>174</volume>
        <issue>2</issue>
        <fpage>447</fpage>
        <lpage>455</lpage>
        <pub-id pub-id-type="doi">10.1111/j.1469-8137.2007.02002.x</pub-id>
        <?supplied-pmid 17388907?>
        <pub-id pub-id-type="pmid">17388907</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B9">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Bylesjo</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Segura</surname>
          <given-names>V</given-names>
        </name>
        <name>
          <surname>Soolanayakanahally</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Rae</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Trygg</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Gustafsson</surname>
          <given-names>P</given-names>
        </name>
        <name>
          <surname>Jansson</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Street</surname>
          <given-names>N</given-names>
        </name>
        <article-title>LAMINA: a tool for rapid quantification of leaf size and shape parameters</article-title>
        <source>BMC Plant Biol</source>
        <year>2008</year>
        <volume>8</volume>
        <fpage>82</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2229-8-82</pub-id>
        <?supplied-pmid 18647399?>
        <pub-id pub-id-type="pmid">18647399</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B10">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Duan</surname>
          <given-names>L</given-names>
        </name>
        <name>
          <surname>Yang</surname>
          <given-names>W</given-names>
        </name>
        <name>
          <surname>Huang</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Liu</surname>
          <given-names>Q</given-names>
        </name>
        <article-title>A novel machine-vision-based facility for the automatic evaluation of yield-related traits in rice</article-title>
        <source>Plant Methods</source>
        <year>2011</year>
        <volume>7</volume>
        <fpage>44</fpage>
        <pub-id pub-id-type="doi">10.1186/1746-4811-7-44</pub-id>
        <?supplied-pmid 22152096?>
        <pub-id pub-id-type="pmid">22152096</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B11">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Yang</surname>
          <given-names>W</given-names>
        </name>
        <name>
          <surname>Xu</surname>
          <given-names>X</given-names>
        </name>
        <name>
          <surname>Duan</surname>
          <given-names>L</given-names>
        </name>
        <name>
          <surname>Luo</surname>
          <given-names>Q</given-names>
        </name>
        <name>
          <surname>Chen</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Zeng</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Liu</surname>
          <given-names>Q</given-names>
        </name>
        <article-title>High-throughput measurement of rice tillers using a conveyor equipped with x-ray computed tomography</article-title>
        <source>Rev Sci Instrum</source>
        <year>2011</year>
        <volume>82</volume>
        <issue>2</issue>
        <fpage>025102</fpage>
        <pub-id pub-id-type="doi">10.1063/1.3531980</pub-id>
        <?supplied-pmid 21361628?>
        <pub-id pub-id-type="pmid">21361628</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B12">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Ikeda</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Hirose</surname>
          <given-names>Y</given-names>
        </name>
        <name>
          <surname>Takashi</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Shibata</surname>
          <given-names>Y</given-names>
        </name>
        <name>
          <surname>Yamamura</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Komura</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Doi</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Ashikari</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Matsuoka</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Kitano</surname>
          <given-names>H</given-names>
        </name>
        <article-title>Analysis of rice panicle traits and detection of QTLs using an image analyzing method</article-title>
        <source>Breed Sci</source>
        <year>2010</year>
        <volume>60</volume>
        <fpage>55</fpage>
        <lpage>64</lpage>
        <pub-id pub-id-type="doi">10.1270/jsbbs.60.55</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B13">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Tanabata</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Shibaya</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Hori</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Ebana</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Yano</surname>
          <given-names>M</given-names>
        </name>
        <article-title>SmartGrain: high-throughput phenotyping software for measuring seed shape through image analysis</article-title>
        <source>Plant Physiol</source>
        <year>2012</year>
        <volume>160</volume>
        <issue>4</issue>
        <fpage>1871</fpage>
        <lpage>1880</lpage>
        <pub-id pub-id-type="doi">10.1104/pp.112.205120</pub-id>
        <?supplied-pmid 23054566?>
        <pub-id pub-id-type="pmid">23054566</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B14">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Pradal</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Dufour-Kowalski</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Boudon</surname>
          <given-names>F</given-names>
        </name>
        <name>
          <surname>Fournier</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Godin</surname>
          <given-names>C</given-names>
        </name>
        <article-title>OpenAlea: a visual programming and component-based software platform for plant modeling</article-title>
        <source>Funct Plant Biol</source>
        <year>2008</year>
        <volume>35</volume>
        <issue>9 &amp; 10</issue>
        <fpage>751</fpage>
        <lpage>760</lpage>
      </mixed-citation>
    </ref>
    <ref id="B15">
      <mixed-citation publication-type="book">
        <name>
          <surname>Fisher</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>WAWE Perkins</surname>
          <given-names>S</given-names>
        </name>
        <source>Hypermedia Image Processing Reference</source>
        <year>1996</year>
        <publisher-name>Chichester UK: J Wiley &amp; Sons Publishing</publisher-name>
      </mixed-citation>
    </ref>
    <ref id="B16">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Pizer</surname>
          <given-names>SM</given-names>
        </name>
        <name>
          <surname>Oliver</surname>
          <given-names>WR</given-names>
        </name>
        <name>
          <surname>Bloomberg</surname>
          <given-names>SH</given-names>
        </name>
        <article-title>Hierarchical shape description via the multiresolution symmetric axis transform</article-title>
        <source>Patt Anal Mach Intell, IEEE Trans on</source>
        <year>1987</year>
        <volume>PAMI-9</volume>
        <issue>4</issue>
        <fpage>505</fpage>
        <lpage>511</lpage>
      </mixed-citation>
    </ref>
    <ref id="B17">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Zhang</surname>
          <given-names>TY</given-names>
        </name>
        <name>
          <surname>Suen</surname>
          <given-names>CY</given-names>
        </name>
        <article-title>A fast parallel algorithm for thinning digital patterns</article-title>
        <source>Commun ACM</source>
        <year>1984</year>
        <volume>27</volume>
        <issue>3</issue>
        <fpage>236</fpage>
        <lpage>239</lpage>
        <pub-id pub-id-type="doi">10.1145/357994.358023</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B18">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Holt</surname>
          <given-names>CM</given-names>
        </name>
        <name>
          <surname>Stewart</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Clint</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Perrott</surname>
          <given-names>RH</given-names>
        </name>
        <article-title>An improved parallel thinning algorithm</article-title>
        <source>Commun ACM</source>
        <year>1987</year>
        <volume>30</volume>
        <issue>2</issue>
        <fpage>156</fpage>
        <lpage>160</lpage>
        <pub-id pub-id-type="doi">10.1145/12527.12531</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B19">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Schneider</surname>
          <given-names>CA</given-names>
        </name>
        <name>
          <surname>Rasband</surname>
          <given-names>WS</given-names>
        </name>
        <name>
          <surname>Eliceiri</surname>
          <given-names>KW</given-names>
        </name>
        <article-title>NIH Image to ImageJ: 25 years of image analysis</article-title>
        <source>Nature Methods</source>
        <year>2012</year>
        <volume>9</volume>
        <issue>7</issue>
        <fpage>671</fpage>
        <lpage>675</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.2089</pub-id>
        <?supplied-pmid 22930834?>
        <pub-id pub-id-type="pmid">22930834</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B20">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Meijster</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Roerdink</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Hesselink</surname>
          <given-names>W</given-names>
        </name>
        <article-title>A general algorithm for computing distance transforms in linear time</article-title>
        <source>Math Morphol Appl Image and Signal Process</source>
        <year>2002</year>
        <volume>18</volume>
        <fpage>331</fpage>
        <lpage>340</lpage>
        <pub-id pub-id-type="doi">10.1007/0-306-47025-X_36</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B21">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Vincent</surname>
          <given-names>L</given-names>
        </name>
        <article-title>Granulometries and opening trees</article-title>
        <source>Fundam Inf</source>
        <year>2000</year>
        <volume>41</volume>
        <issue>1-2</issue>
        <fpage>57</fpage>
        <lpage>90</lpage>
      </mixed-citation>
    </ref>
    <ref id="B22">
      <mixed-citation publication-type="book">
        <name>
          <surname>Di Rubeto</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Dempster</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Khan</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Jarra</surname>
          <given-names>B</given-names>
        </name>
        <article-title>Segmentation of blood images using morphological operators</article-title>
        <source>Pattern Recognition, 2000. Proceedings 15th International Conference on, Volume 3</source>
        <year>2000</year>
        <publisher-name>Los Alamitos, CA, USA: IEEE Computer Society</publisher-name>
        <fpage>397</fpage>
        <lpage>400</lpage>
        <comment>
          <ext-link ext-link-type="uri" xlink:href="http://doi.ieeecomputersociety.org/10.1109/ICPR.2000.903568">http://doi.ieeecomputersociety.org/10.1109/ICPR.2000.903568</ext-link>
        </comment>
      </mixed-citation>
    </ref>
    <ref id="B23">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Ruberto</surname>
          <given-names>CD</given-names>
        </name>
        <name>
          <surname>Dempster</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Khan</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Jarra</surname>
          <given-names>B</given-names>
        </name>
        <article-title>Analysis of infected blood cell images using morphological operators</article-title>
        <source>Image and Vision Comput</source>
        <year>2002</year>
        <volume>20</volume>
        <issue>2</issue>
        <fpage>133</fpage>
        <lpage>146</lpage>
        <pub-id pub-id-type="doi">10.1016/S0262-8856(01)00092-0</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B24">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Rousseeuw</surname>
          <given-names>PJ</given-names>
        </name>
        <article-title>Least median of squares regression</article-title>
        <source>J Am Stat Assoc</source>
        <year>1984</year>
        <volume>79</volume>
        <issue>388</issue>
        <fpage>871</fpage>
        <lpage>880</lpage>
        <pub-id pub-id-type="doi">10.1080/01621459.1984.10477105</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B25">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Zhong</surname>
          <given-names>Q</given-names>
        </name>
        <name>
          <surname>Zhou</surname>
          <given-names>P</given-names>
        </name>
        <name>
          <surname>Yao</surname>
          <given-names>Q</given-names>
        </name>
        <name>
          <surname>Mao</surname>
          <given-names>K</given-names>
        </name>
        <article-title>A novel segmentation algorithm for clustered slender-particles</article-title>
        <source>Comput Electron Agric</source>
        <year>2009</year>
        <volume>69</volume>
        <issue>2</issue>
        <fpage>118</fpage>
        <lpage>127</lpage>
        <pub-id pub-id-type="doi">10.1016/j.compag.2009.06.015</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B26">
      <mixed-citation publication-type="book">
        <name>
          <surname>Burger</surname>
          <given-names>W</given-names>
        </name>
        <name>
          <surname>Burge</surname>
          <given-names>JM</given-names>
        </name>
        <source>Digital image processing: an algorithmic introduction using Java</source>
        <year>2008</year>
        <publisher-name>Texts in computer science, New York: Springer</publisher-name>
      </mixed-citation>
    </ref>
    <ref id="B27">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Rosin</surname>
          <given-names>PL</given-names>
        </name>
        <article-title>Measuring shape: ellipticity, rectangularity, and triangularity</article-title>
        <source>Mach Vis Appl</source>
        <year>2003</year>
        <volume>14</volume>
        <fpage>172</fpage>
        <lpage>184</lpage>
      </mixed-citation>
    </ref>
    <ref id="B28">
      <mixed-citation publication-type="book">
        <name>
          <surname>Csetverikov</surname>
          <given-names>D</given-names>
        </name>
        <etal/>
        <source>Basic algorithms for digital image analysis: a course (Lecture 13)</source>
        <year>1998</year>
        <publisher-name>Budapest, Hungary: Eötvös Loröand University</publisher-name>
      </mixed-citation>
    </ref>
    <ref id="B29">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Vincent</surname>
          <given-names>L</given-names>
        </name>
        <name>
          <surname>Soille</surname>
          <given-names>P</given-names>
        </name>
        <article-title>Watersheds in digital spaces: an efficient algorithm based on immersion simulations</article-title>
        <source>IEEE Trans Pattern Anal Mach Intell</source>
        <year>1991</year>
        <volume>13</volume>
        <issue>6</issue>
        <fpage>583</fpage>
        <lpage>598</lpage>
        <pub-id pub-id-type="doi">10.1109/34.87344</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B30">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Charles</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Kuncheva</surname>
          <given-names>L</given-names>
        </name>
        <name>
          <surname>Wells</surname>
          <given-names>B</given-names>
        </name>
        <name>
          <surname>Lim</surname>
          <given-names>I</given-names>
        </name>
        <article-title>Object segmentation within microscope images of palynofacies</article-title>
        <source>Comput &amp; Geosci</source>
        <year>2008</year>
        <volume>34</volume>
        <issue>6</issue>
        <fpage>688</fpage>
        <lpage>698</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cageo.2007.09.014</pub-id>
        <?supplied-pmid 24032016?>
        <pub-id pub-id-type="pmid">24032016</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B31">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Faessel</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Courtois</surname>
          <given-names>F</given-names>
        </name>
        <article-title>Touching grain kernels separation by gap-filling</article-title>
        <source>Image Anal &amp; Stereol</source>
        <year>2011</year>
        <volume>28</volume>
        <issue>3</issue>
        <fpage>195</fpage>
        <lpage>203</lpage>
        <?supplied-pmid 24030866?>
        <pub-id pub-id-type="pmid">24030866</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B32">
      <mixed-citation publication-type="book">
        <name>
          <surname>Sundar</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>Silver</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Gagvani</surname>
          <given-names>N</given-names>
        </name>
        <name>
          <surname>Dickinson</surname>
          <given-names>S</given-names>
        </name>
        <article-title>Skeleton based shape matching and retrieval</article-title>
        <source>Shape Modeling International, volume 0</source>
        <year>2003</year>
        <publisher-name>Los Alamitos, CA, USA: IEEE Computer Society</publisher-name>
        <fpage>130</fpage>
        <lpage>139</lpage>
        <comment>
          <ext-link ext-link-type="uri" xlink:href="http://doi.ieeecomputersociety.org/10.1109/SMI.2003.1199609">http://doi.ieeecomputersociety.org/10.1109/SMI.2003.1199609</ext-link>
        </comment>
      </mixed-citation>
    </ref>
    <ref id="B33">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Wolberg</surname>
          <given-names>G</given-names>
        </name>
        <article-title>Skeleton-based image warping</article-title>
        <source>Vis Comput</source>
        <year>1989</year>
        <volume>5</volume>
        <fpage>95</fpage>
        <lpage>108</lpage>
        <pub-id pub-id-type="doi">10.1007/BF01901485</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B34">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Galkovskyi</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Mileyko</surname>
          <given-names>Y</given-names>
        </name>
        <name>
          <surname>Bucksch</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Moore</surname>
          <given-names>B</given-names>
        </name>
        <name>
          <surname>Symonova</surname>
          <given-names>O</given-names>
        </name>
        <name>
          <surname>Price</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Topp</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Iyer-Pascuzzi</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Zurek</surname>
          <given-names>P</given-names>
        </name>
        <name>
          <surname>Fang</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Harer</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Benfey</surname>
          <given-names>P</given-names>
        </name>
        <name>
          <surname>Weitz</surname>
          <given-names>J</given-names>
        </name>
        <article-title>GiA Roots: software for the high throughput analysis of plant root system architecture</article-title>
        <source>BMC Plant Biol</source>
        <year>2012</year>
        <volume>12</volume>
        <fpage>116</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2229-12-116</pub-id>
        <?supplied-pmid 22834569?>
        <pub-id pub-id-type="pmid">22834569</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B35">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Bai</surname>
          <given-names>X</given-names>
        </name>
        <name>
          <surname>Latecki</surname>
          <given-names>L</given-names>
        </name>
        <name>
          <surname>Liu</surname>
          <given-names>WY</given-names>
        </name>
        <article-title>Skeleton pruning by contour partitioning with discrete curve evolution</article-title>
        <source>Patt Anal Mach Intell, IEEE Trans on</source>
        <year>2007</year>
        <volume>29</volume>
        <issue>3</issue>
        <fpage>449</fpage>
        <lpage>462</lpage>
      </mixed-citation>
    </ref>
    <ref id="B36">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Ogniewicz</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Kübler</surname>
          <given-names>O</given-names>
        </name>
        <article-title>Hierarchic Voronoi skeletons</article-title>
        <source>Patt Recognit</source>
        <year>1995</year>
        <volume>28</volume>
        <issue>3</issue>
        <fpage>343</fpage>
        <lpage>359</lpage>
        <pub-id pub-id-type="doi">10.1016/0031-3203(94)00105-U</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B37">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Montanari</surname>
          <given-names>U</given-names>
        </name>
        <article-title>Continuous skeletons from digitized images</article-title>
        <source>J ACM</source>
        <year>1969</year>
        <volume>16</volume>
        <issue>4</issue>
        <fpage>534</fpage>
        <lpage>549</lpage>
        <pub-id pub-id-type="doi">10.1145/321541.321543</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B38">
      <mixed-citation publication-type="book">
        <name>
          <surname>Attali</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>di Baja</surname>
          <given-names>G</given-names>
        </name>
        <name>
          <surname>Thiel</surname>
          <given-names>E</given-names>
        </name>
        <person-group person-group-type="editor">Braccini C, DeFloriani L, Vernazza G</person-group>
        <article-title>Pruning discrete and semicontinuous skeletons</article-title>
        <source>Image Analysis and Processing, Volume 974 of Lecture Notes in Computer Science</source>
        <year>1995</year>
        <publisher-name>Berlin - Heidelberg: Springer</publisher-name>
        <fpage>488</fpage>
        <lpage>493</lpage>
      </mixed-citation>
    </ref>
    <ref id="B39">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Attali</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>di Baja</surname>
          <given-names>SG</given-names>
        </name>
        <name>
          <surname>Thiel</surname>
          <given-names>E</given-names>
        </name>
        <article-title>Skeleton simplification through non significant branch removal</article-title>
        <source>Image Process Commun</source>
        <year>1997</year>
        <volume>3</volume>
        <issue>3-4</issue>
        <fpage>63</fpage>
        <lpage>72</lpage>
      </mixed-citation>
    </ref>
    <ref id="B40">
      <mixed-citation publication-type="book">
        <name>
          <surname>Wahlby</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Riklin-Raviv</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Ljosa</surname>
          <given-names>V</given-names>
        </name>
        <name>
          <surname>Conery</surname>
          <given-names>AL</given-names>
        </name>
        <name>
          <surname>Golland</surname>
          <given-names>P</given-names>
        </name>
        <name>
          <surname>Ausubel</surname>
          <given-names>FM</given-names>
        </name>
        <name>
          <surname>Carpenter</surname>
          <given-names>AE</given-names>
        </name>
        <article-title>Resolving clustered worms via probabilistic shape models</article-title>
        <source>Biomedical Imaging: From Nano to Macro, 2010 IEEE International Symposium on</source>
        <year>2010</year>
        <publisher-name>Rotterdam The Netherlands</publisher-name>
        <fpage>552</fpage>
        <lpage>555</lpage>
      </mixed-citation>
    </ref>
  </ref-list>
</back>
