<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20070202//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing.dtd?>
<?SourceDTD.Version 2.3?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Nucleic Acids Res</journal-id>
    <journal-id journal-id-type="publisher-id">nar</journal-id>
    <journal-id journal-id-type="hwp">nar</journal-id>
    <journal-title-group>
      <journal-title>Nucleic Acids Research</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">0305-1048</issn>
    <issn pub-type="epub">1362-4962</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">3105381</article-id>
    <article-id pub-id-type="pmid">21335609</article-id>
    <article-id pub-id-type="doi">10.1093/nar/gkr087</article-id>
    <article-id pub-id-type="publisher-id">gkr087</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Methods Online</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>TreeKO: a duplication-aware algorithm for the comparison of phylogenetic trees</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Marcet-Houben</surname>
          <given-names>Marina</given-names>
        </name>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Gabaldón</surname>
          <given-names>Toni</given-names>
        </name>
        <xref ref-type="corresp" rid="COR1">*</xref>
      </contrib>
    </contrib-group>
    <aff>Bioinformatics and Genomics Programme, Centre for Genomic Regulation (CRG), UPF, Doctor Aiguader, 88, 08003 Barcelona, Spain</aff>
    <author-notes>
      <corresp id="COR1">*To whom correspondence should be addressed. Tel: <phone>+34 933160281</phone>; Fax: <fax>+34 93 3969983</fax>; Email: <email>tgabaldon@crg.es</email></corresp>
    </author-notes>
    <!--For NAR both ppub and collection dates generated for PMC processing 1/27/05 beck-->
    <pub-date pub-type="collection">
      <month>5</month>
      <year>2011</year>
    </pub-date>
    <pub-date pub-type="ppub">
      <month>5</month>
      <year>2011</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>19</day>
      <month>2</month>
      <year>2011</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>19</day>
      <month>2</month>
      <year>2011</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the
							<pub-date pub-type="epub"/>. -->
    <volume>39</volume>
    <issue>10</issue>
    <fpage>e66</fpage>
    <lpage>e66</lpage>
    <history>
      <date date-type="received">
        <day>14</day>
        <month>6</month>
        <year>2010</year>
      </date>
      <date date-type="rev-recd">
        <day>2</day>
        <month>2</month>
        <year>2011</year>
      </date>
      <date date-type="accepted">
        <day>3</day>
        <month>2</month>
        <year>2011</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2011. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2011</copyright-year>
      <license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by-nc/2.5">
        <license-p><!--CREATIVE COMMONS-->This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/2.5">http://creativecommons.org/licenses/by-nc/2.5</ext-link>), which permits unrestricted non-commercial use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <abstract>
      <p>Comparisons of tree topologies provide relevant information in evolutionary studies. Most existing methods share the drawback of requiring a complete and exact mapping of terminal nodes between the compared trees. This severely limits the scope of genome-wide analyses, since trees containing duplications are pruned arbitrarily or discarded. To overcome this, we have developed treeKO, an algorithm that enables the comparison of tree topologies, even in the presence of duplication and loss events. To do so treeKO recursively splits gene trees into pruned trees containing only orthologs to subsequently compute a distance based on the combined analyses of all pruned tree comparisons. In addition treeKO, implements the possibility of computing phylome support values, and reconciliation-based measures such as the number of inferred duplication and loss events.</p>
    </abstract>
    <counts>
      <page-count count="9"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec sec-type="intro">
    <title>INTRODUCTION</title>
    <p>Phylogenetic trees represent evolutionary relationships among groups of species or biological sequences. The growing availability of sequence data from whole genomes, as well as the development of faster computers and more efficient phylogenetic programs, has facilitated the reconstruction of large collections of phylogenetic trees. In parallel, this has brought about the necessity of scaling up the analysis of phylogenetic trees to genomic scales (<xref ref-type="bibr" rid="B1">1</xref>). A recurrent analysis in phylogenetic studies is the comparison of the topologies of two or more phylogenetic trees. This is routinely used, for instance, to measure the support of tree partitions in a bootstrapping analysis or to compare alternative phylogenetic hypotheses (<xref ref-type="bibr" rid="B2">2</xref>). Additional applications include, but are not limited to, the reconstruction of a single species tree from a number of individual gene trees (<xref ref-type="bibr" rid="B3">3</xref>), the evaluation of orthology inference (<xref ref-type="bibr" rid="B4">4</xref>), the detection of horizontal gene transfer events (<xref ref-type="bibr" rid="B5">5</xref>) or the detection of host-pathogen co-evolution (<xref ref-type="bibr" rid="B6">6</xref>).</p>
    <p>Two main types of algorithms are available that compute topological distances between phylogenetic trees. A first class of algorithms uses the information directly from the topological arrangement of terminal nodes (i.e. leaves) in the trees. For instance, the popular Robinson-Foulds (RF) distance counts how many leaf splits are implied by only one of the compared trees (<xref ref-type="bibr" rid="B7">7</xref>). Similarly, the quartet distance is defined as the number of subsets of four leaves that are implied by only one of the compared trees (<xref ref-type="bibr" rid="B8">8</xref>). Finally, the so-called maximum agreement subtree is a similarity measure based on the largest subtree present in the two compared trees (<xref ref-type="bibr" rid="B6">6</xref>). A second group of algorithms measures the minimal number of topological re-arrangements necessary to transform one topology into the other one. This is the rationale behind the transposition distance (<xref ref-type="bibr" rid="B9">9</xref>,<xref ref-type="bibr" rid="B10">10</xref>), the prune and regraft distance (<xref ref-type="bibr" rid="B11">11</xref>,<xref ref-type="bibr" rid="B12">12</xref>) and the tree edit distance (<xref ref-type="bibr" rid="B13">13</xref>). Despite their extensively proven usefulness, all these algorithms share one limitation, namely the requirement that the mapping of leaves between the trees is complete and univocal (i.e. every leaf in one tree corresponds to only one leaf in the other tree). Thus, when applied to the comparison of gene family trees, these algorithms are unable to deal with trees that contain duplications (i.e. there is more than one gene per species) or losses (i.e. not all species are represented in both trees). As a result, only a reduced fraction of gene trees in a given phylogenomic study may be subject to analysis. For instance, Rasmussen and Kellis (<xref ref-type="bibr" rid="B14">14</xref>) found that for 9 fungal and 12 drosophila species, only 739 and 5154 protein families, respectively, contained no duplications. Thus gene trees suitable for comparison with the above mentioned methods will account for only 11 and 37% of their respective genomes. The fraction of tractable gene trees will decrease as the number of species in the set and their evolutionary distance increase (see comparative analysis below).</p>
    <p>Some algorithms have been designed to tackle this problem. For instance, PhyloPattern (<xref ref-type="bibr" rid="B15">15</xref>) can search for trees containing a specific topological pattern, which may present duplications. However this only serves to search for identical subtrees and does not provide a distance measure. Another alternative consists of reconciling the gene trees to a particular species tree and then measure their distances in terms of the number of inferred deep coalescence or duplication and loss events to the reference tree. This is indeed used by a number of species tree reconstruction algorithms that search for the topology that implies the least number of such events in a set of gene trees (<xref ref-type="bibr" rid="B16 B17 B18">16–18</xref>). These methods have recently been effectively applied at genome-wide scales (<xref ref-type="bibr" rid="B19">19</xref>,<xref ref-type="bibr" rid="B20">20</xref>). Current implementations of these methods, focused on the reconstruction of super-trees, do not allow for computing such distances between any given pair of trees. To enable their use for comparison of any set or type of trees, we have implemented these distances in treeKO. However, although the use of reconciliation-based approaches may be preferred in some applications, there is still a need to extend the use of topological distances such as the popular Robinson and Foulds to trees that include duplications. A clear advantage of such a measure is that it does not need any prior assumption of a species tree topology or on the expected level of duplications and losses.</p>
    <p>A solution to extend RF-type measures to gene trees including duplications, was implemented by Puigbò <italic>et al.</italic> in the TOPD/FMTS program (<xref ref-type="bibr" rid="B21">21</xref>), which is able to compare any pair of trees regardless of the number of duplications contained. While TOPD/FMTS does indeed provide an estimate of the distance, it has several drawbacks. First, whenever a species is represented by multiple sequences, TOPD/FMTS randomly prunes all but one to produce a single pruned gene tree without duplicated sequences. While this should ideally be done for each possible combination of duplicated genes, this becomes unfeasible for relatively small number of duplications. In such cases, TOPD/FMTS produces only a set of randomly chosen trees, which would provide an approximate, non-reproducible, distance measure. Besides this, the main limitation of TOPD/FMTS is that the inter-species orthology and paralogy relationships are not considered during the pruning process, resulting in pruned trees that contain a mixture of orthologous and paralogous sequences. These drawbacks hamper the interpretation of the distances provided by TOPD/FMTS. For instance, the comparison of identical trees containing some duplications will often provide distances &gt;0 (see comparative analysis below).</p>
    <p>In order to address this important issue so that genome-wide collections of gene trees can be effectively compared using a topological approach, we have developed treeKO. TreeKO is a novel, duplication-aware algorithm that is able to compare two tree topologies regardless of the number of duplications and, at the same time, provide a RF-based distance measure that is evolutionarily meaningful and that does not require any prior evolutionary assumption. In addition treeKO, implements the possibility of computing so-called phylome support values (<xref ref-type="bibr" rid="B22">22</xref>), and reconciliation-based measures such as the number of inferred duplications and losses events.</p>
  </sec>
  <sec sec-type="methods">
    <title>METHODS</title>
    <sec sec-type="intro">
      <title>Overview</title>
      <p>The treeKO algorithm has three main components: (i) tree decomposition into a set of pruned trees, (ii) pruned trees pairing and (iii) distance calculation. The three components are described in more detail below and in the on-line documentation (<ext-link ext-link-type="uri" xlink:href="http://treeko.cgenomics.org">http://treeko.cgenomics.org</ext-link>). In brief, given two input rooted trees in which duplication and speciation nodes are labelled, the decomposition phase is applied to both trees to generate a set of pruned trees. Pruning is performed at each duplication node so that the resulting pruned trees contain no duplication and thus all sequences contained in a pruned tree are orthologous to each other. Subsequently, a pruned tree pairing step finds optimal matches between sets of pruned trees from the two input trees. Different pairing procedures are applied depending on the desired distance measure (see below). Finally, a distance based on RF is computed by weighting the distances between all paired pruned trees.</p>
    </sec>
    <sec>
      <title>Tree decomposition</title>
      <p>The tree decomposition algorithm implemented in treeKO, proceeds as follows (<xref ref-type="fig" rid="F1">Figure 1</xref>): given an input rooted tree with n labelled duplication nodes, the tree is traversed from the root to the most external nodes. At each duplication node, two daughter trees are produced by alternatively pruning each of the two post-duplication branches. Note that these trees are partially overlapping, since all pre-duplication nodes are retained in both pruned trees. This algorithm is applied recursively on each produced pruned tree that still contains duplications, until no duplication nodes are contained in the resulting set of pruned trees.
<fig id="F1" position="float"><label>Figure 1.</label><caption><p>Example of how treeKO derives pruned trees from a tree containing duplications. The initial tree (tree on the left) contains two duplication nodes (in black) marked as node 1 and node 2. treeKO splits the tree by node 1 and generate two different trees, each one of them containing one of the daughter partitions of node 1. This results in pruned tree 1 and an intermediate pruned tree that still contains duplication (node 2). treeKO will then scan these pruned trees for more duplications. In this case one of the pruned trees has a second duplication and the subtree will be once again split and reconstructed, resulting in pruned trees 2 and 3. treeKO will repeat this process until no resulting subtree contains further duplication nodes.</p></caption><graphic xlink:href="gkr087f1"/></fig></p>
    </sec>
    <sec>
      <title>Tree pairing</title>
      <p>Once both initial trees have been decomposed into their corresponding sets of pruned trees, all possible pairings of pruned trees between the two sets are compared and a distance measure is assigned to each pair (see below). The specific distance measures and weighting of the different pairs of pruned trees varies for the different distance metrics as explained below.</p>
    </sec>
    <sec>
      <title>Strict distance</title>
      <p>In order to assess the similarity between pruned trees obtained by the decomposition algorithm, both trees are pruned so that they contain the same species and then the RF distance is calculated for a pair of pruned trees (<italic>d</italic>), as indicated by the formula [1]:
<disp-formula id="M1"><label>(1)</label><graphic xlink:href="gkr087m1"/></disp-formula>
where <italic>RF</italic> and <italic>RF<sub>max</sub></italic> represent the RF distance between the two trees and the maximum possible RF distance, respectively; <italic>r</italic> is the number of remaining leaves in the two pruned trees after the pruning phase and <italic>p</italic> the total number of leaves that were pruned. When comparing the two sets of pruned trees from the original trees A and B, each pruned tree from tree A will be matched to the most similar pruned tree from tree B (i.e. minimal strict distance). Each pruned tree can only be matched once. If two pairs have the same distance, then other factors such as lower RF/RFmax ratio or a larger pruned tree size, in this order, are used to decide between pairs. If all these factors are equal, then one of the pairs is chosen randomly, as the choice will not influence the final result. Rejected pruned trees have to be matched to a worse option or remain unpaired. Note that theoretically, this greedy pairing algorithm does not guarantee to find always the optimal solution, and may render near-optimal solutions under some circumstances. Finally, the combined weighted distance between trees A and B (D<sub>a,b</sub>) is composed by two terms, one representing each initial tree (<italic>a</italic> and <italic>b</italic>), and is computed as explained in formula [2].
<disp-formula id="M2"><label>(2)</label><graphic xlink:href="gkr087m2"/></disp-formula>
where n and m, represent the total number of pruned trees for tree A and B, respectively, resulting from the decomposition algorithm. <italic>d<sub>i</sub></italic> represents the distance between the <italic>i</italic><sup>th</sup> pruned tree of A to its best match in the set of pruned trees of B and <italic>l<sub>i</sub></italic> the number of leaves in the <italic>i<sup>th</sup></italic> pruned tree of A. <italic>d<sub>j</sub></italic> and <italic>l<sub>j</sub></italic> are defined identically as <italic>d<sub>i</sub></italic> and <italic>l<sub>i</sub></italic> but with respect to tree B. The unpaired pruned trees are added to their corresponding term by assuming that <italic>d</italic> = 1. A minimal distance of 0 will only be obtained when the two trees are identical in terms of topology, including the inferred duplication and loss events.</p>
    </sec>
    <sec>
      <title>Speciation distance</title>
      <p>In this case all pruned trees from both tree A and B are matched to their best pruned trees from the other tree, regardless of whether the best matched pruned tree has been previously matched. The pruned tree distance is calculated as explained above, but the normalized RF distance is not corrected by the number of pruned leaves (term <italic>p</italic> above), resulting in a simple normalized RF distance [3]
<disp-formula id="M3"><label>(3)</label><graphic xlink:href="gkr087m3"/></disp-formula>
The weighted final distance between the two trees (D<sub>a,b</sub>) is computed as explained above.</p>
    </sec>
    <sec>
      <title>Reconciliation-based distances</title>
      <p>In addition of the above mentioned RF-distances, treeKO implements two other distances based on the number of inferred duplication (duplication distance) or duplication and loss events (reconciliation cost distance) after reconciling with a species tree, as earlier described. In this case one of the two compared trees should be a species tree to which the gene tree will be reconciled using a strict reconciliation algorithm (<xref ref-type="bibr" rid="B16">16</xref>) as implemented in ETE (<xref ref-type="bibr" rid="B23">23</xref>).</p>
    </sec>
    <sec>
      <title>treeKO implementation</title>
      <p>treeKO has been implemented using the python programming language and the ETE programming toolkit (<xref ref-type="bibr" rid="B23">23</xref>). The input of treeKO are two bifurcated phylogenetic trees in which the species source for the different sequences is indicated (by default a three letters pre-fix is expected). The entry trees should be rooted or a rooting strategy indicated (midpoint rooting is used by default if an un-rooted tree is provided; an option to minimize the total number of inferred duplication is also implemented). Moreover, the duplication nodes should be marked in the tree or a duplication-detection strategy indicated. By default treeKO will use the species-overlap algorithm implemented in ETE. In brief, this algorithm traverses the tree from every leaf in direction to the root. For every node, the species content of the two daughter branches are compared, nodes are considered speciation events if no species is shared or duplication events otherwise. A strict reconciliation algorithm, as implemented in ETE can be used if indicated by the user. Alternatively the user can specify duplications (inferred by any method) directly in the extended newick format (see details in <ext-link ext-link-type="uri" xlink:href="http://treeko.cgenomics.org">http://treeko.cgenomics.org</ext-link>). An additional configuration file can be included in the treeKO command line in order to adapt some parameters to the users’ trees. For more details see <ext-link ext-link-type="uri" xlink:href="http://treeko.cgenomics.org">http://treeko.cgenomics.org</ext-link>.</p>
    </sec>
    <sec>
      <title>Fungal species trees</title>
      <p>The T12a and T60 fungal species trees described in (<xref ref-type="bibr" rid="B22">22</xref>) contain 12 and 60 species, respectively, and were used as the reference tree topologies in the comparative analyses we present below. ETE was used to generate additional species tree topologies by swapping consecutive pairs of branches of the post-WGD (post-Whole Genome Duplication) species included in the tree (<italic>Saccharomyces cerevisiae, Saccharomyces paradoxus, Saccharomyces mikatae, S. kudriavzevii, S. bayanus, Candida glabrata, Saccharomyces castellii and Kluyveromyces polysporus</italic>). A total of six alternative topologies were considered in each case (see <ext-link ext-link-type="uri" xlink:href="http://nar.oxfordjournals.org/cgi/content/full/gkr087/DC1">Supplementary Figure S1</ext-link>).</p>
    </sec>
    <sec>
      <title>Phylome to species trees comparison</title>
      <p>A phylome is defined as the complete collection of phylogenetic trees for each gene encoded in a given genome (<xref ref-type="bibr" rid="B24">24</xref>). The speciation distance implemented in treeKO was used to compare each tree in the P12a and P60 phylomes [see (<xref ref-type="bibr" rid="B22">22</xref>)] to each different species tree. The resulting distance distributions were compared with a <italic>t</italic>-test as implemented in the R package (<ext-link ext-link-type="uri" xlink:href="http://www.r-project.org">http://www.r-project.org</ext-link>).</p>
    </sec>
    <sec>
      <title>Comparison with alternative methods</title>
      <p>The phylomes described above, plus P12b and P21, based on different sets of species (<xref ref-type="bibr" rid="B22">22</xref>) were also used to evaluate the number of trees that could be used by each tree comparison program. For the comparison between TOPD/FMTS and treeKO three sets of 100 trees were selected. Each tree was compared to itself. TOPD/FMTS was run on default mode, calculating the split distance (equivalent to the RF distance) and generating a maximum of 100 pruned trees, no random analysis was included.</p>
    </sec>
  </sec>
  <sec sec-type="discussion">
    <title>RESULTS AND DISCUSSION</title>
    <sec>
      <title>Decomposing a tree into all possible pruned trees by recursively splitting duplication nodes</title>
      <p>The main rationale behind treeKO is the decomposition of gene-family trees to be compared into a set of pruned trees so that every pruned tree is formed by the maximum number of sequences that are orthologous to each other, without including any paralogous sequence. This can be achieved by recursively splitting the gene family tree at each duplication node. Subsequently all pruned trees produced by the two trees can be compared so that a weighted distance measure is produced (see below). We have implemented this algorithm in treeKO, which is freely available here: <ext-link ext-link-type="uri" xlink:href="http://treeko.cgenomics.org">http://treeko.cgenomics.org</ext-link>. The algorithm of tree decomposition is briefly described below (<xref ref-type="fig" rid="F1">Figure 1</xref>), additional details can be found in the ‘Methods’ section and the on-line documentation of treeKO.</p>
      <p>The input of the treeKO tree decomposition algorithm is a rooted tree in which duplications nodes are indicated (if necessary, treeKO can automatically root and annotate duplications, see ‘Methods’ section). treeKO splits the original tree into single gene pruned trees that contain only one of the paralogous partitions resulting from each duplication. To do so, treeKO traverses the tree and, for each duplication node, two pruned trees are produced, each of which contains only one of the paralogous partitions that derive from the duplication. TreeKO will continue recursively on each resulting tree until all possible pruned trees are generated from the combination of the different single gene partitions. Finally, the sets of pruned trees produced by each input tree are compared to obtain a final topological distance. The set of pruned trees produced by the treeKO decomposition algorithm has some special properties that make it useful to derive evolutionarily sound distance measures. First, the pruned trees will contain only speciation nodes and thus all sequences in a given tree will be orthologous to each other. Moreover, considering that pre-duplication nodes are included in the two resulting pruned trees, each speciation node will be represented in the total set of pruned trees proportionally to the number of descendant sequences (i.e. sequences whose path to the root will traverse that node in the original tree). Finally, the total number of pruned trees produced by the decomposition process depends on the specific topological arrangement of the duplication nodes, but it is always equal or smaller than those implied by alternative decomposition algorithms such as the one implemented in TOPD (see <ext-link ext-link-type="uri" xlink:href="http://nar.oxfordjournals.org/cgi/content/full/gkr087/DC1">Supplementary Figure S2</ext-link>). More specifically, if all duplications are nested, that is all of them occur in the same path from the root to a terminal node, the total number of pruned trees produced for an original gene tree containing n duplication is n+1. Instead, If all duplications are parallel to each other and occur in specific lineages, i.e. they are not nested, then the total number of pruned trees produced is 2<sup>n</sup>. If a combination of nested and parallel duplications occurs, then the final number of total trees is in the range of (n+1) to 2<sup>n</sup> trees. For the case of the yeast phylome (P12a), used in this study, the effective number of pruned trees is close to n+1 although it deviates significantly in some families (see <ext-link ext-link-type="uri" xlink:href="http://nar.oxfordjournals.org/cgi/content/full/gkr087/DC1">Supplementary Figure S3</ext-link>).</p>
    </sec>
    <sec>
      <title>Evolutionarily-sound topological distances</title>
      <p>Distances calculated by treeKO are based on the RF distance or on reconciliation-based distances. The latter have been implemented as defined elsewhere (<xref ref-type="bibr" rid="B25">25</xref>,<xref ref-type="bibr" rid="B26">26</xref>), and basically compute the number of gene duplication and/or loss events that need to be implied when reconciling the gene tree to a given species tree.</p>
      <p>The two RF-based distance measures, ‘strict distance’ and ‘speciation distance’, are new and we define them here (see ‘Methods’ section). The ‘strict distance’ is basically a weighted RF that, in addition, penalizes differences in evolutionarily relevant events such as gene duplications and gene losses. In contrast, the ‘speciation distance’ does not compute differences that can be attributed to duplication and loss events, so that two trees with a speciation distance of 0 are not necessarily identical, but the inferred history of speciation events of the shared species will be the same (i.e. they are fully congruent in terms of the inferred species tree).</p>
      <p>These two RF-based distances have been implemented keeping in mind the different applications of tree comparison. The strict distance, which penalizes differential gene loss and duplication patterns, would be more appropriate when searching for protein families with a similar history of duplication, loss and speciation events. Such searches are common in studies of co-evolution and inference of protein function. For instance, correlated gene loss has been used to predict functional interactions between mitochondrial proteins (<xref ref-type="bibr" rid="B27">27</xref>). In contrast, the speciation distance would fit better in studies where the main focus is the underlying species phylogeny (<xref ref-type="bibr" rid="B28">28</xref>). There are many possible applications in which the availability to compare gene trees using an RF-based approach in the presence of duplications will present an advantage, although, certainly, other more specific methods may be better suited for some particular applications. In the present study we put the focus on the issue of evaluating alternative species tree topologies and present one such case in which the genome-wide support to alternative species phylogenies is explored by measuring the distance of each alternative species topology to the complete collection of phylogenies for all genes encoded in a given genome.</p>
    </sec>
    <sec>
      <title>A practical use of treeKO: assessing the genome-wide support of two alternative species tree topologies</title>
      <p>The evolution of twelve completely sequenced yeast species, encompassing the Saccharomyces and the Kluyveromyces clades, is mostly well resolved (<xref ref-type="bibr" rid="B22">22</xref>). Only the relative order of divergence of <italic>Candida glabrata</italic> and <italic>Saccharomyces castellii</italic> species remains unresolved. Most phylogenomic studies support an earlier splitting of <italic>C. glabrata</italic> (<xref ref-type="bibr" rid="B22">22</xref>,<xref ref-type="bibr" rid="B29">29</xref>,<xref ref-type="bibr" rid="B30">30</xref>). In contrast, analysis of chromosomal gene order has shown that the number of inversions that occurred during the evolution of these species is minimized in a scenario in which <italic>S. castellii</italic> diverges before <italic>C. glabrata</italic> (<xref ref-type="bibr" rid="B31">31</xref>).</p>
      <p>Most species trees reconstructed from phylogenomic methods are evaluated with bootstrapping techniques that assess how stable a given topology is to random re-samplings of the input alignment. Since the input alignment generally comprises a small fraction of the genes present in a genome, gene sampling effects may result in highly supported topologies which are not representative of the evolution of a given genome. An alternative strategy to study the evolution of a genome is to analyze the complete collection of phylogenetic trees of all its genes (i.e. the phylome). Evaluating a given species topology over such genome-wide set of gene-trees would provide a more accurate measure on whether it is fairly representative at a genome-wide scale.</p>
      <p>Although phylomes have successfully been used to determine which nodes in the fungal species tree are most congruent at genomic-scales (<xref ref-type="bibr" rid="B22">22</xref>), there is as yet no RF-based measure of the levels of similarity between a given species tree and a complete phylome. Here, we address the question of whether the distributions of speciation distances to a given phylome can be used to decide among alternative evolutionary scenarios. For this we used treeKO to compute the speciation distances of the yeast phylome [P12a dataset described in (<xref ref-type="bibr" rid="B22">22</xref>) and available at PhylomeDB (<xref ref-type="bibr" rid="B32">32</xref>)] against different alternative species trees. Gene trees were rooted with midpoint so that no assumptions on the species tree topology were made a priori. Alternative topologies were derived from a reference species tree by swapping pairs of neighboring branches (i.e. interchanging the positions of <italic>Saccharomyces paradoxus</italic> and <italic>Saccharomyces mikatae</italic> or the positions of <italic>C. glabrata</italic> and <italic>S. castellii</italic> as shown in <xref ref-type="fig" rid="F2">Figure 2</xref> and <ext-link ext-link-type="uri" xlink:href="http://nar.oxfordjournals.org/cgi/content/full/gkr087/DC1">Supplementary Figure S1</ext-link>). Resulting distance distributions were compared with a <italic>t</italic>-test.
<fig id="F2" position="float"><label>Figure 2.</label><caption><p>Distribution of distances between trees in P12a phylome and three alternative species trees. The upper left part of the figure shows the three topologies used. The first one is the T12a tree while the other two represent changes in this topology. Alternative topology 1 represents a change in a poorly supported node while Alternative topology 2 represents a well supported node. The two upper right graphs plot each distribution of distances of the alternative topologies against the reference T12a topology. The lower panel represents the frequency graph for the three distance distributions.</p></caption><graphic xlink:href="gkr087f2"/></fig></p>
      <p>As seen in <xref ref-type="fig" rid="F2">Figure 2</xref>, the swapping of the well-supported <italic>S. paradoxus</italic> and <italic>S. mikatae</italic> branches (alternative topology 2) resulted in significantly larger distances (<italic>P</italic>-value &lt; 2 × 10<sup>−16</sup>), whereas inter-changing the controversial positions of <italic>C. glabrata</italic> and <italic>S. castellii</italic> (alternative topology 1) presented distances that were not significantly different (<italic>P</italic>-value = 0.0955). We extended the analysis to all the topologies created by swapping consecutive pairs of post-whole genome duplication (post-WGD) species. In all cases, the distances obtained were significantly larger to those found in comparisons to the reference species tree. Similar results were obtained when the phylome and the species trees considered were based on a broader taxonomic range of 60 fungal species (see ‘Methods’ section). Similar results were obtained when we repeated the analysis by using alternative rooting methods or by collapsing poorly-supported branches in the tree (see <ext-link ext-link-type="uri" xlink:href="http://nar.oxfordjournals.org/cgi/content/full/gkr087/DC1">Supplementary Table S1</ext-link>).</p>
      <p>Thus, this test would discard all alternative topologies examined with the exception of a swap of <italic>C. glabrata</italic> and <italic>S. castellii</italic> positions. These results are congruent with earlier findings, in which <italic>C. glabrata/S. castellii</italic> was reported to be the only post-WGD node displaying a low phylome support (<xref ref-type="bibr" rid="B22">22</xref>). There are many possible causes for the observed high topological variability among gene trees, including incomplete lineage sorting, genetic introgression or systematic phylogenetic artifacts [see (<xref ref-type="bibr" rid="B33">33</xref>) and (<xref ref-type="bibr" rid="B22">22</xref>) for a discussion]. Considering this, it is presumable that results from previous phylogenomic studies might have been affected by sampling effects, and it would be therefore useful to consider alternative information such as gene order conservation to resolve that node (<xref ref-type="bibr" rid="B31">31</xref>). In contrast to the speciation distance, reconciliation-based distances, such as total number of gene duplication or loss events implied, were unable to distinguish among many of the alternative topologies. This suggest that RF-based distances such as the speciation distance proposed here is more sensitive to topological variations and thus more appropriate to evaluate alternative hypotheses (see <ext-link ext-link-type="uri" xlink:href="http://nar.oxfordjournals.org/cgi/content/full/gkr087/DC1">Supplementary Table S1</ext-link>).</p>
      <p>To test the performance of treeKO under controlled conditions, we performed a series of sequence evolution simulations with varying levels of sequence divergence and duplication and loss rates. In all circumstances tested, all types of distance metrics effectively identified the true species tree, although tests based on speciation distances tended to be more statistically significant (see <ext-link ext-link-type="uri" xlink:href="http://nar.oxfordjournals.org/cgi/content/full/gkr087/DC1">Supplementary Data</ext-link> and <xref ref-type="table" rid="T1">Table 1</xref>). We believe that this type of comparisons provides an alternative way to evaluate, in a statistically sound manner, the genome-wide support for alternative phylogenetic hypotheses.
<table-wrap id="T1" position="float"><label>Table 1.</label><caption><p>Percentage of tractable trees by comparison algorithm</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th rowspan="1" colspan="1">Phylome</th><th rowspan="1" colspan="1">TreeKO (%)</th><th rowspan="1" colspan="1">TOPD/ FMTS (%)</th><th rowspan="1" colspan="1">RF (%)</th><th rowspan="1" colspan="1">RF + pruning (%)</th></tr></thead><tbody align="left"><tr><td rowspan="1" colspan="1">P60</td><td rowspan="1" colspan="1">100</td><td rowspan="1" colspan="1">100</td><td rowspan="1" colspan="1">0</td><td rowspan="1" colspan="1">22</td></tr><tr><td rowspan="1" colspan="1">P21</td><td rowspan="1" colspan="1">100</td><td rowspan="1" colspan="1">100</td><td rowspan="1" colspan="1">0</td><td rowspan="1" colspan="1">36</td></tr><tr><td rowspan="1" colspan="1">P12a</td><td rowspan="1" colspan="1">100</td><td rowspan="1" colspan="1">100</td><td rowspan="1" colspan="1">14</td><td rowspan="1" colspan="1">38</td></tr><tr><td rowspan="1" colspan="1">P12b</td><td rowspan="1" colspan="1">100</td><td rowspan="1" colspan="1">100</td><td rowspan="1" colspan="1">2</td><td rowspan="1" colspan="1">27</td></tr></tbody></table><table-wrap-foot><fn id="TF1"><p>Percentage of gene trees in a given phylome that is suitable for comparison by any given method. Columns represent the four compared programs: treeKO, TOPD/FMTS, RF and RF with an initial pruning step. Rows represent each of the fours yeast phylomes with different taxonomic coverage that can be found in phylomeDB (<xref ref-type="bibr" rid="B32">32</xref>).</p></fn></table-wrap-foot></table-wrap></p>
    </sec>
    <sec>
      <title>Comparative analysis</title>
      <p>To show that these type of analyses, ensuring a genome-wide coverage, are difficult with existing methods, we compared the performance of treeKO to that of (i) a standard RF measure, (ii) a RF measure after a pruning phase to remove species not present in the two trees and (iii) a distance measure provided by TOPD/FMTS. In all cases we evaluated the number of trees suitable to analysis in several yeast phylomes of varying taxonomic scopes (<xref ref-type="table" rid="T1">Table 1</xref>), and, whenever possible, we also evaluated the distance obtained when comparing two identical trees, and the average computing time (<xref ref-type="table" rid="T2">Table 2</xref>). An ideal method to perform genome-wide analyses would be fast, able to compare all gene trees and would produce a distance measure that is easy to interpret (e.g. identical trees would provide a distance of 0).
<table-wrap id="T2" position="float"><label>Table 2.</label><caption><p>Comparative performance of tree-comparison algorithms</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th rowspan="2" colspan="1"/><th colspan="3" align="center" rowspan="1">TreeKO<hr/></th><th colspan="3" align="center" rowspan="1">TOPD/FMTS<hr/></th><th colspan="3" align="center" rowspan="1">RF<hr/></th></tr><tr><th rowspan="1" colspan="1">Set1</th><th rowspan="1" colspan="1">Set2</th><th rowspan="1" colspan="1">Set3</th><th rowspan="1" colspan="1">Set1</th><th rowspan="1" colspan="1">Set2</th><th rowspan="1" colspan="1">Set3</th><th rowspan="1" colspan="1">Set1</th><th rowspan="1" colspan="1">Set2</th><th rowspan="1" colspan="1">Set3</th></tr></thead><tbody align="left"><tr><td rowspan="1" colspan="1">Percentage of trees compared (%)</td><td rowspan="1" colspan="1">100</td><td rowspan="1" colspan="1">100</td><td rowspan="1" colspan="1">100</td><td rowspan="1" colspan="1">100</td><td rowspan="1" colspan="1">100</td><td rowspan="1" colspan="1">100</td><td rowspan="1" colspan="1">34</td><td rowspan="1" colspan="1">43</td><td rowspan="1" colspan="1">41</td></tr><tr><td rowspan="1" colspan="1">Average time consumption per tree (s)</td><td rowspan="1" colspan="1">1.31</td><td rowspan="1" colspan="1">1.65</td><td rowspan="1" colspan="1">1.95</td><td rowspan="1" colspan="1">10.38</td><td rowspan="1" colspan="1">8.84</td><td rowspan="1" colspan="1">9.57</td><td rowspan="1" colspan="1">–</td><td rowspan="1" colspan="1">–</td><td rowspan="1" colspan="1">–</td></tr><tr><td rowspan="1" colspan="1">Average time consumption per single-gene tree (s)</td><td rowspan="1" colspan="1">1.09</td><td rowspan="1" colspan="1">1.09</td><td rowspan="1" colspan="1">1.15</td><td rowspan="1" colspan="1">2.12</td><td rowspan="1" colspan="1">2.26</td><td rowspan="1" colspan="1">2.07</td><td rowspan="1" colspan="1">0.06</td><td rowspan="1" colspan="1">0.07</td><td rowspan="1" colspan="1">0.05</td></tr><tr><td rowspan="1" colspan="1">Average time consumption per multi-gene tree (s)</td><td rowspan="1" colspan="1">2.62</td><td rowspan="1" colspan="1">3.22</td><td rowspan="1" colspan="1">3.42</td><td rowspan="1" colspan="1">22.00</td><td rowspan="1" colspan="1">21.05</td><td rowspan="1" colspan="1">22.11</td><td rowspan="1" colspan="1">–</td><td rowspan="1" colspan="1">–</td><td rowspan="1" colspan="1">–</td></tr><tr><td rowspan="1" colspan="1">Average distance</td><td rowspan="1" colspan="1">0</td><td rowspan="1" colspan="1">0</td><td rowspan="1" colspan="1">0</td><td rowspan="1" colspan="1">0.45</td><td rowspan="1" colspan="1">0.36</td><td rowspan="1" colspan="1">0.43</td><td rowspan="1" colspan="1">–</td><td rowspan="1" colspan="1">–</td><td rowspan="1" colspan="1">–</td></tr><tr><td rowspan="1" colspan="1">Average distance single gene trees</td><td rowspan="1" colspan="1">0</td><td rowspan="1" colspan="1">0</td><td rowspan="1" colspan="1">0</td><td rowspan="1" colspan="1">0</td><td rowspan="1" colspan="1">0</td><td rowspan="1" colspan="1">0</td><td rowspan="1" colspan="1">0</td><td rowspan="1" colspan="1">0</td><td rowspan="1" colspan="1">0</td></tr><tr><td rowspan="1" colspan="1">Average distance multiple gene trees</td><td rowspan="1" colspan="1">0</td><td rowspan="1" colspan="1">0</td><td rowspan="1" colspan="1">0</td><td rowspan="1" colspan="1">0.70</td><td rowspan="1" colspan="1">0.61</td><td rowspan="1" colspan="1">0.69</td><td rowspan="1" colspan="1">–</td><td rowspan="1" colspan="1">–</td><td rowspan="1" colspan="1">–</td></tr></tbody></table><table-wrap-foot><fn id="TF2"><p>Comparison between three tree comparison programs (treeKO, TOPD/FMTS and RF). Three sets containing 100 randomly chosen trees of the P12a phylome were used for comparison. Columns represent one of the sets of trees and a program. Rows contain data regarding the percentage of trees that were compared, the time consumption (expressed in seconds) and the average distance between pairs of identical trees. Data on separated by single-gene and multi-gene trees is also provided.</p></fn></table-wrap-foot></table-wrap></p>
      <p>The main disadvantage of RF distances as implemented in standard programs such as Ktreedist (<xref ref-type="bibr" rid="B34">34</xref>) or PHYLIP (<xref ref-type="bibr" rid="B35">35</xref>), is that only a minor fraction (0–14%) of gene trees are suitable for comparisons. This is ameliorated by the inclusion of a pruning step (22–38%). As expected, treeKO and TOPD/FMTS yield 100% coverage. To compare the performance of treeKO, TOPD/FMTS and RF, as implemented in Ktreedist, we randomly selected three sets of 100 trees from the phylome. The programs were compared in terms of time consumption and average distance between two identical trees. While distances calculated by treeKO and RF are null for identical trees, TOPD/FMTS reports an average split distance of 0,41. These non-zero distances result from the sub-set of multi-gene tree comparisons (average distance of 0,67). Finally, as seen in <xref ref-type="table" rid="T2">Table 2</xref>, RF is by far the fastest method. treeKO and TOPD/FMTS have similar computing times for trees without duplications, but for multi-gene trees treeKO is approximately seven times faster. This could be attributed to the fact that the number of pruned trees generated by treeKO is much lower than in TOPD/FMTS (see <ext-link ext-link-type="uri" xlink:href="http://nar.oxfordjournals.org/cgi/content/full/gkr087/DC1">Supplementary Figure S2</ext-link>), even when this program only takes 100 random pruned trees into account. This is the result of considering duplication nodes as the splitting point for the pruned trees generation instead of considering each species independently.</p>
    </sec>
  </sec>
  <sec sec-type="conclusions">
    <title>CONCLUSION</title>
    <p>We have developed treeKO, a tree comparison tool that is able to compare trees in the presence of duplication and loss events. By addressing the main limitations of previous approaches, treeKO enables the comparison of genome-wide phylogenetic datasets. Besides implementing earlier reconciliation-based metrics (<xref ref-type="bibr" rid="B25">25</xref>,<xref ref-type="bibr" rid="B26">26</xref>), treeKO provides two new alternative RF-based distance metrics that are biologically sound and specifically adapted to applications such as the search for co-evolving protein families or the assessment of topological congruence in the inferred order of speciation events. Additionally, we have implemented in treeKO the possibility of comparing only specific nodes in the tree, which can be used to compute measures of congruence of specific topologies with large collections of phylogenetic trees, such as the phylome support value described earlier (<xref ref-type="bibr" rid="B22">22</xref>). It is important to note that the existence of horizontal gene transfer (HGT) events in the considered trees may result in the presence of apparent duplication and speciation events. This will affect any distance measure, by treeKO or any other method that does not account for HGT. To properly deal with the presence of HGT, we have implemented a protocol that treats nodes resulting only from a transference event as special case, thus allowing the computation of distances only based on true speciation and duplication nodes (see treeKO manual for details). In the future we plan to include additional distance measures. The use of treeKO opens the door to novel phylogenomic analyses such as the one presented here that evaluates whether differences in genome-wide support to two alternative topologies are statistically significant. Another potential use of the decomposition algorithm implemented in treeKO is that, combined with the use of reconstruction programs such as CLANN (<xref ref-type="bibr" rid="B36">36</xref>), it enables truly genome-wide coverage in popular super-tree approaches that minimize the topological distance of a species tree to a collection of gene trees.</p>
  </sec>
  <sec>
    <title>SUPPLEMENTARY DATA</title>
    <p><ext-link ext-link-type="uri" xlink:href="http://nar.oxfordjournals.org/cgi/content/full/gkr087/DC1">Supplementary Data</ext-link> are available at NAR Online.</p>
  </sec>
  <sec>
    <title>FUNDING</title>
    <p>Funding for open access charge: <funding-source>Spanish Ministry of Science and Innovation</funding-source> (<award-id>GEN2006-27784E</award-id>, <award-id>BFU2009-09168</award-id>).</p>
    <p><italic>Conflict of interest statement</italic>. None declared.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="PMC_1" content-type="local-data">
      <caption>
        <title>Supplementary Data</title>
      </caption>
      <media mimetype="text" mime-subtype="html" xlink:href="supp_39_10_e66__index.html"/>
      <media xlink:role="associated-file" mimetype="application" mime-subtype="pdf" xlink:href="supp_gkr087_Supplementary_material_treeKO.pdf"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <title>ACKNOWLEDGEMENTS</title>
    <p>We thank Jaime Huerta-Cepas, Salvador Capella-Gutierrez, and three anonymous referees for their valuable comments, and Mercé Llabrés for critically reading the article.</p>
  </ack>
  <ref-list>
    <title>REFERENCES</title>
    <ref id="B1">
      <label>1</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Gabaldón</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Marcet-Houben</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Huerta-Cepas</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <person-group person-group-type="editor">
          <name>
            <surname>Russe</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Reconstruction and analysis of large-scale phylogenetic data, challenges and opportunities</article-title>
        <source>Computational Biology: New Research</source>
        <year>2008</year>
        <publisher-loc>New York</publisher-loc>
        <publisher-name>Nova Science Publishers</publisher-name>
        <fpage>129</fpage>
        <lpage>146</lpage>
      </element-citation>
    </ref>
    <ref id="B2">
      <label>2</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Felsenstein</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Inferring phylogenies from protein sequences by parsimony, distance, and likelihood methods</article-title>
        <source>Methods Enzymol.</source>
        <year>1996</year>
        <volume>266</volume>
        <fpage>418</fpage>
        <lpage>427</lpage>
        <pub-id pub-id-type="pmid">8743697</pub-id>
      </element-citation>
    </ref>
    <ref id="B3">
      <label>3</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bininda-Emonds</surname>
            <given-names>OR</given-names>
          </name>
        </person-group>
        <article-title>Supertree construction in the genomic age</article-title>
        <source>Methods Enzymol.</source>
        <year>2005</year>
        <volume>395</volume>
        <fpage>745</fpage>
        <lpage>757</lpage>
        <pub-id pub-id-type="pmid">15865993</pub-id>
      </element-citation>
    </ref>
    <ref id="B4">
      <label>4</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Altenhoff</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Dessimoz</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Phylogenetic and functional assessment of orthologs inference projects and methods</article-title>
        <source>PLoS Comput. Biol.</source>
        <year>2009</year>
        <volume>5</volume>
        <fpage>e1000262</fpage>
        <pub-id pub-id-type="pmid">19148271</pub-id>
      </element-citation>
    </ref>
    <ref id="B5">
      <label>5</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Beiko</surname>
            <given-names>RG</given-names>
          </name>
          <name>
            <surname>Hamilton</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>Phylogenetic identification of lateral genetic transfer events</article-title>
        <source>BMC Evol. Biol.</source>
        <year>2006</year>
        <volume>6</volume>
        <fpage>15</fpage>
        <pub-id pub-id-type="pmid">16472400</pub-id>
      </element-citation>
    </ref>
    <ref id="B6">
      <label>6</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>de Vienne</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>Giraud</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Martin</surname>
            <given-names>OC</given-names>
          </name>
        </person-group>
        <article-title>A congruence index for testing topological similarity between trees</article-title>
        <source>Bioinformatics</source>
        <year>2007</year>
        <volume>23</volume>
        <fpage>3119</fpage>
        <lpage>3124</lpage>
        <pub-id pub-id-type="pmid">17933852</pub-id>
      </element-citation>
    </ref>
    <ref id="B7">
      <label>7</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Robinson</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Foulds</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>Comparison of phylogenetic trees</article-title>
        <source>Math. Biosci.</source>
        <year>1981</year>
        <volume>55</volume>
        <fpage>131</fpage>
        <lpage>147</lpage>
      </element-citation>
    </ref>
    <ref id="B8">
      <label>8</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Estabrook</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>McMorris</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Meacham</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Comparison of undirected phylogenetic trees based on subtrees of four evolutionary units</article-title>
        <source>Syst. Zool.</source>
        <year>1985</year>
        <volume>34</volume>
        <fpage>193</fpage>
        <lpage>200</lpage>
      </element-citation>
    </ref>
    <ref id="B9">
      <label>9</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Alberich</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Cardona</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Rosselló</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Valiente</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>An algebraic metric for phylogenetic trees</article-title>
        <source>Appl. Math. Lett.</source>
        <year>2008</year>
        <volume>22</volume>
        <fpage>1320</fpage>
        <lpage>1324</lpage>
      </element-citation>
    </ref>
    <ref id="B10">
      <label>10</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Valiente</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <source>String Processing and Information Retrieval</source>
        <year>2005</year>
        <volume>Vol. 3772</volume>
        <publisher-loc>Berlin/Heidelberg</publisher-loc>
        <publisher-name>Springer</publisher-name>
        <fpage>370</fpage>
        <lpage>375</lpage>
      </element-citation>
    </ref>
    <ref id="B11">
      <label>11</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wu</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>A practical method for exact computation of subtree prune and regraft distance</article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>25</volume>
        <fpage>190</fpage>
        <lpage>196</lpage>
        <pub-id pub-id-type="pmid">19019848</pub-id>
      </element-citation>
    </ref>
    <ref id="B12">
      <label>12</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bordewich</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Semple</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>On the computational complexity of the rooted subtree prune and regraft distance</article-title>
        <source>Ann. Comb.</source>
        <year>2004</year>
        <volume>8</volume>
        <fpage>409</fpage>
        <lpage>423</lpage>
      </element-citation>
    </ref>
    <ref id="B13">
      <label>13</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bille</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>A survey on tree edit distance and related problems</article-title>
        <source>Theor. Comput. Sci.</source>
        <year>2005</year>
        <volume>337</volume>
        <fpage>217</fpage>
        <lpage>239</lpage>
      </element-citation>
    </ref>
    <ref id="B14">
      <label>14</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rasmussen</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>Kellis</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Accurate gene-tree reconstruction by learning gene- and species-specific substitution rates across multiple complete genomes</article-title>
        <source>Genome Res.</source>
        <year>2007</year>
        <volume>17</volume>
        <fpage>1932</fpage>
        <lpage>1942</lpage>
        <pub-id pub-id-type="pmid">17989260</pub-id>
      </element-citation>
    </ref>
    <ref id="B15">
      <label>15</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gouret</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Thompson</surname>
            <given-names>JD</given-names>
          </name>
          <name>
            <surname>Pontarotti</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>PhyloPattern: regular expressions to identify complex patterns in phylogenetic trees</article-title>
        <source>BMC Bioinformatics</source>
        <year>2009</year>
        <volume>10</volume>
        <fpage>298</fpage>
        <pub-id pub-id-type="pmid">19765311</pub-id>
      </element-citation>
    </ref>
    <ref id="B16">
      <label>16</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Page</surname>
            <given-names>RD</given-names>
          </name>
        </person-group>
        <article-title>GeneTree: comparing gene and species phylogenies using reconciled trees</article-title>
        <source>Bioinformatics</source>
        <year>1998</year>
        <volume>14</volume>
        <fpage>819</fpage>
        <lpage>820</lpage>
        <pub-id pub-id-type="pmid">9918954</pub-id>
      </element-citation>
    </ref>
    <ref id="B17">
      <label>17</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Carstens</surname>
            <given-names>BC</given-names>
          </name>
          <name>
            <surname>Knowles</surname>
            <given-names>LL</given-names>
          </name>
        </person-group>
        <article-title>Estimating species phylogeny from gene-tree probabilities despite incomplete lineage sorting: an example from Melanoplus grasshoppers</article-title>
        <source>Syst. Biol.</source>
        <year>2007</year>
        <volume>56</volume>
        <fpage>400</fpage>
        <lpage>411</lpage>
        <pub-id pub-id-type="pmid">17520504</pub-id>
      </element-citation>
    </ref>
    <ref id="B18">
      <label>18</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wehe</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Bansal</surname>
            <given-names>MS</given-names>
          </name>
          <name>
            <surname>Burleigh</surname>
            <given-names>JG</given-names>
          </name>
          <name>
            <surname>Eulenstein</surname>
            <given-names>O</given-names>
          </name>
        </person-group>
        <article-title>DupTree: a program for large-scale phylogenetic analyses using gene tree parsimony</article-title>
        <source>Bioinformatics</source>
        <year>2008</year>
        <volume>24</volume>
        <fpage>1540</fpage>
        <lpage>1541</lpage>
        <pub-id pub-id-type="pmid">18474508</pub-id>
      </element-citation>
    </ref>
    <ref id="B19">
      <label>19</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Burleigh</surname>
            <given-names>JG</given-names>
          </name>
          <name>
            <surname>Bansal</surname>
            <given-names>MS</given-names>
          </name>
          <name>
            <surname>Eulenstein</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Hartmann</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Wehe</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Vision</surname>
            <given-names>TJ</given-names>
          </name>
        </person-group>
        <article-title>Genome-scale phylogenetics: inferring the plant tree of life from 18,896 gene trees</article-title>
        <source>Syst. Biol.</source>
        <year>2011</year>
        <comment>in press</comment>
      </element-citation>
    </ref>
    <ref id="B20">
      <label>20</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bansal</surname>
            <given-names>MS</given-names>
          </name>
          <name>
            <surname>Burleigh</surname>
            <given-names>JG</given-names>
          </name>
          <name>
            <surname>Eulenstein</surname>
            <given-names>O</given-names>
          </name>
        </person-group>
        <article-title>Efficient genome-scale phylogenetic analysis under the duplication-loss and deep coalescence cost models</article-title>
        <source>BMC Bioinformatics</source>
        <year>2010</year>
        <volume>11</volume>
        <issue>Suppl 1</issue>
        <fpage>S42</fpage>
        <pub-id pub-id-type="pmid">20122216</pub-id>
      </element-citation>
    </ref>
    <ref id="B21">
      <label>21</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Puigbo</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Garcia-Vallve</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>McInerney</surname>
            <given-names>JO</given-names>
          </name>
        </person-group>
        <article-title>TOPD/FMTS: a new software to compare phylogenetic trees</article-title>
        <source>Bioinformatics</source>
        <year>2007</year>
        <volume>23</volume>
        <fpage>1556</fpage>
        <lpage>1558</lpage>
        <pub-id pub-id-type="pmid">17459965</pub-id>
      </element-citation>
    </ref>
    <ref id="B22">
      <label>22</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Marcet-Houben</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Gabaldón</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>The tree versus the forest: the fungal tree of life and the topological diversity within the yeast phylome</article-title>
        <source>PLoS One</source>
        <year>2009</year>
        <volume>4</volume>
        <fpage>e4357</fpage>
        <pub-id pub-id-type="pmid">19190756</pub-id>
      </element-citation>
    </ref>
    <ref id="B23">
      <label>23</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huerta-Cepas</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Dopazo</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Gabaldón</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>ETE: a python Environment for Tree Exploration</article-title>
        <source>BMC Bioinformatics</source>
        <year>2010</year>
        <volume>11</volume>
        <fpage>24</fpage>
        <pub-id pub-id-type="pmid">20070885</pub-id>
      </element-citation>
    </ref>
    <ref id="B24">
      <label>24</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sicheritz-Ponten</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Andersson</surname>
            <given-names>SG</given-names>
          </name>
        </person-group>
        <article-title>A phylogenomic approach to microbial evolution</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2001</year>
        <volume>29</volume>
        <fpage>545</fpage>
        <lpage>552</lpage>
        <pub-id pub-id-type="pmid">11139625</pub-id>
      </element-citation>
    </ref>
    <ref id="B25">
      <label>25</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ma</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>From gene trees to species trees</article-title>
        <source>SIAM J. Comput.</source>
        <year>2000</year>
        <volume>30</volume>
        <fpage>729</fpage>
        <lpage>752</lpage>
      </element-citation>
    </ref>
    <ref id="B26">
      <label>26</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Goodman</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Czelusniak</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Moore</surname>
            <given-names>GM</given-names>
          </name>
          <name>
            <surname>Romero-Herrera</surname>
            <given-names>AE</given-names>
          </name>
          <name>
            <surname>Matsuda</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Fitting the gene lineage into its species lineage, a parsimony strategy illustrated by cladograms constructed from globin sequences</article-title>
        <source>Syst. Zool.</source>
        <year>1979</year>
        <fpage>132</fpage>
        <lpage>163</lpage>
      </element-citation>
    </ref>
    <ref id="B27">
      <label>27</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gabaldón</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Huynen</surname>
            <given-names>MA</given-names>
          </name>
        </person-group>
        <article-title>Lineage-specific gene loss following mitochondrial endosymbiosis and its potential for function prediction in eukaryotes</article-title>
        <source>Bioinformatics</source>
        <year>2005</year>
        <volume>21</volume>
        <issue>Suppl 2</issue>
        <fpage>ii144</fpage>
        <lpage>ii150</lpage>
        <pub-id pub-id-type="pmid">16204094</pub-id>
      </element-citation>
    </ref>
    <ref id="B28">
      <label>28</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Degnan</surname>
            <given-names>JH</given-names>
          </name>
          <name>
            <surname>Rosenberg</surname>
            <given-names>NA</given-names>
          </name>
        </person-group>
        <article-title>Gene tree discordance, phylogenetic inference and the multispecies coalescent</article-title>
        <source>Trends Ecol. Evol.</source>
        <year>2009</year>
        <volume>24</volume>
        <fpage>332</fpage>
        <lpage>340</lpage>
        <pub-id pub-id-type="pmid">19307040</pub-id>
      </element-citation>
    </ref>
    <ref id="B29">
      <label>29</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Gao</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Hao</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>A fungal phylogeny based on 82 complete genomes using the composition vector method</article-title>
        <source>BMC Evol. Biol.</source>
        <year>2009</year>
        <volume>9</volume>
        <fpage>195</fpage>
        <pub-id pub-id-type="pmid">19664262</pub-id>
      </element-citation>
    </ref>
    <ref id="B30">
      <label>30</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fitzpatrick</surname>
            <given-names>DA</given-names>
          </name>
          <name>
            <surname>Logue</surname>
            <given-names>ME</given-names>
          </name>
          <name>
            <surname>Stajich</surname>
            <given-names>JE</given-names>
          </name>
          <name>
            <surname>Butler</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>A fungal phylogeny based on 42 complete genomes derived from supertree and combined gene analysis</article-title>
        <source>BMC Evol. Biol.</source>
        <year>2006</year>
        <volume>6</volume>
        <fpage>99</fpage>
        <pub-id pub-id-type="pmid">17121679</pub-id>
      </element-citation>
    </ref>
    <ref id="B31">
      <label>31</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gordon</surname>
            <given-names>JL</given-names>
          </name>
          <name>
            <surname>Byrne</surname>
            <given-names>KP</given-names>
          </name>
          <name>
            <surname>Wolfe</surname>
            <given-names>KH</given-names>
          </name>
        </person-group>
        <article-title>Additions, losses, and rearrangements on the evolutionary route from a reconstructed ancestor to the modern Saccharomyces cerevisiae genome</article-title>
        <source>PLoS Genet.</source>
        <year>2009</year>
        <volume>5</volume>
        <fpage>e1000485</fpage>
        <pub-id pub-id-type="pmid">19436716</pub-id>
      </element-citation>
    </ref>
    <ref id="B32">
      <label>32</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huerta-Cepas</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Capella-Gutierrez</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Pryszcz</surname>
            <given-names>LP</given-names>
          </name>
          <name>
            <surname>Denisov</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Kormes</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Marcet-Houben</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Gabaldon</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>PhylomeDB v3.0: an expanding repository of genome-wide collections of trees, alignments and phylogeny-based orthology and paralogy predictions</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2011</year>
        <volume>39</volume>
        <fpage>D556</fpage>
        <lpage>D560</lpage>
        <pub-id pub-id-type="pmid">21075798</pub-id>
      </element-citation>
    </ref>
    <ref id="B33">
      <label>33</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Castresana</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Topological variation in single-gene phylogenetic trees</article-title>
        <source>Genome Biol.</source>
        <year>2007</year>
        <volume>8</volume>
        <fpage>216</fpage>
        <pub-id pub-id-type="pmid">17567929</pub-id>
      </element-citation>
    </ref>
    <ref id="B34">
      <label>34</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Soria-Carrasco</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Talavera</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Igea</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Castresana</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>The K tree score: quantification of differences in the relative branch length and topology of phylogenetic trees</article-title>
        <source>Bioinformatics</source>
        <year>2007</year>
        <volume>23</volume>
        <fpage>2954</fpage>
        <lpage>2956</lpage>
        <pub-id pub-id-type="pmid">17890735</pub-id>
      </element-citation>
    </ref>
    <ref id="B35">
      <label>35</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Retief</surname>
            <given-names>JD</given-names>
          </name>
        </person-group>
        <article-title>Phylogenetic analysis using PHYLIP</article-title>
        <source>Methods Mol. Biol.</source>
        <year>2000</year>
        <volume>132</volume>
        <fpage>243</fpage>
        <lpage>258</lpage>
        <pub-id pub-id-type="pmid">10547839</pub-id>
      </element-citation>
    </ref>
    <ref id="B36">
      <label>36</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Creevey</surname>
            <given-names>CJ</given-names>
          </name>
          <name>
            <surname>McInerney</surname>
            <given-names>JO</given-names>
          </name>
        </person-group>
        <article-title>Trees from trees: construction of phylogenetic supertrees using clann</article-title>
        <source>Methods Mol. Biol.</source>
        <year>2009</year>
        <volume>537</volume>
        <fpage>139</fpage>
        <lpage>161</lpage>
        <pub-id pub-id-type="pmid">19378143</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
