<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-title>BMC Bioinformatics</journal-title>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">2612014</article-id>
    <article-id pub-id-type="publisher-id">1471-2105-9-507</article-id>
    <article-id pub-id-type="pmid">19040747</article-id>
    <article-id pub-id-type="doi">10.1186/1471-2105-9-507</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>MetaboMiner – semi-automated identification of metabolites from 2D NMR spectra of complex biofluids</article-title>
    </title-group>
    <contrib-group>
      <contrib id="A1" contrib-type="author">
        <name>
          <surname>Xia</surname>
          <given-names>Jianguo</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <email>jianguox@ualberta.ca</email>
      </contrib>
      <contrib id="A2" contrib-type="author">
        <name>
          <surname>Bjorndahl</surname>
          <given-names>Trent C</given-names>
        </name>
        <xref ref-type="aff" rid="I3">3</xref>
        <email>trentb@ualberta.ca</email>
      </contrib>
      <contrib id="A3" contrib-type="author">
        <name>
          <surname>Tang</surname>
          <given-names>Peter</given-names>
        </name>
        <xref ref-type="aff" rid="I2">2</xref>
        <email>peter.tang.lai@gmail.com</email>
      </contrib>
      <contrib id="A4" corresp="yes" contrib-type="author">
        <name>
          <surname>Wishart</surname>
          <given-names>David S</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <xref ref-type="aff" rid="I2">2</xref>
        <xref ref-type="aff" rid="I3">3</xref>
        <email>david.wishart@ualberta.ca</email>
      </contrib>
    </contrib-group>
    <aff id="I1"><label>1</label>Department of Biological Sciences, University of Alberta, Edmonton, AB, T6G 2E9, Canada </aff>
    <aff id="I2"><label>2</label>Department of Computing Science, University of Alberta, Edmonton, AB, T6G 2E8, Canada </aff>
    <aff id="I3"><label>3</label>National Institute for Nanotechnology, 11421 Saskatchewan Drive, Edmonton, AB, T6G 2M9, Canada</aff>
    <pub-date pub-type="collection">
      <year>2008</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>28</day>
      <month>11</month>
      <year>2008</year>
    </pub-date>
    <volume>9</volume>
    <fpage>507</fpage>
    <lpage>507</lpage>
    <ext-link ext-link-type="uri" xlink:href="http://www.biomedcentral.com/1471-2105/9/507"/>
    <history>
      <date date-type="received">
        <day>14</day>
        <month>3</month>
        <year>2008</year>
      </date>
      <date date-type="accepted">
        <day>28</day>
        <month>11</month>
        <year>2008</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Copyright © 2008 Xia et al; licensee BioMed Central Ltd.</copyright-statement>
      <copyright-year>2008</copyright-year>
      <copyright-holder>Xia et al; licensee BioMed Central Ltd.</copyright-holder>
      <license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/2.0">
        <p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/2.0"/>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</p>
        <!--<rdf xmlns="http://web.resource.org/cc/" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:dc="http://purl.org/dc/elements/1.1" xmlns:dcterms="http://purl.org/dc/terms"><Work xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:dcterms="http://purl.org/dc/terms/" rdf:about=""><license rdf:resource="http://creativecommons.org/licenses/by/2.0"/><dc:type rdf:resource="http://purl.org/dc/dcmitype/Text"/><dc:author>
               Xia
               Jianguo
               
               jianguox@ualberta.ca
            </dc:author><dc:title>
            MetaboMiner &#x02013; semi-automated identification of metabolites from 2D NMR spectra of complex biofluids
         </dc:title><dc:date>2008</dc:date><dcterms:bibliographicCitation>BMC Bioinformatics 9(1): 507-. (2008)</dcterms:bibliographicCitation><dc:identifier type="sici">1471-2105(2008)9:1&#x0003c;507&#x0003e;</dc:identifier><dcterms:isPartOf>urn:ISSN:1471-2105</dcterms:isPartOf><License rdf:about="http://creativecommons.org/licenses/by/2.0"><permits rdf:resource="http://web.resource.org/cc/Reproduction" xmlns=""/><permits rdf:resource="http://web.resource.org/cc/Distribution" xmlns=""/><requires rdf:resource="http://web.resource.org/cc/Notice" xmlns=""/><requires rdf:resource="http://web.resource.org/cc/Attribution" xmlns=""/><permits rdf:resource="http://web.resource.org/cc/DerivativeWorks" xmlns=""/></License></Work></rdf>-->
      </license>
    </permissions>
    <abstract>
      <sec>
        <title>Background</title>
        <p>One-dimensional (1D) <sup>1</sup>H nuclear magnetic resonance (NMR) spectroscopy is widely used in metabolomic studies involving biofluids and tissue extracts. There are several software packages that support compound identification and quantification via 1D <sup>1</sup>H NMR by spectral fitting techniques. Because 1D <sup>1</sup>H NMR spectra are characterized by extensive peak overlap or spectral congestion, two-dimensional (2D) NMR, with its increased spectral resolution, could potentially improve and even automate compound identification or quantification. However, the lack of dedicated software for this purpose significantly restricts the application of 2D NMR methods to most metabolomic studies.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p>We describe a standalone graphics software tool, called MetaboMiner, which can be used to automatically or semi-automatically identify metabolites in complex biofluids from 2D NMR spectra. MetaboMiner is able to handle both <sup>1</sup>H-<sup>1</sup>H total correlation spectroscopy (TOCSY) and <sup>1</sup>H-<sup>13</sup>C heteronuclear single quantum correlation (HSQC) data. It identifies compounds by comparing 2D spectral patterns in the NMR spectrum of the biofluid mixture with specially constructed libraries containing reference spectra of ~500 pure compounds. Tests using a variety of synthetic and real spectra of compound mixtures showed that MetaboMiner is able to identify &gt;80% of detectable metabolites from good quality NMR spectra.</p>
      </sec>
      <sec>
        <title>Conclusion</title>
        <p>MetaboMiner is a freely available, easy-to-use, NMR-based metabolomics tool that facilitates automatic peak processing, rapid compound identification, and facile spectrum annotation from either 2D TOCSY or HSQC spectra. Using comprehensive reference libraries coupled with robust algorithms for peak matching and compound identification, the program greatly simplifies the process of metabolite identification in complex 2D NMR spectra.</p>
      </sec>
    </abstract>
  </article-meta>
</front>
<body>
  <sec>
    <title>Background</title>
    <p>Metabolomics is a rapidly-growing field of "-omics" research concerned with the high-throughput comparison, identification and quantification of large numbers of metabolites in biological systems [<xref ref-type="bibr" rid="B1">1</xref>]. Metabolomics only became possible as a result of recent technology breakthroughs in small molecule separation, identification and quantification. These include advances in ultra-sensitive, ultra-precise mass spectrometry (MS), robotic, multi-dimensional NMR spectroscopy, and greatly improved HPLC and UPLC separation technologies [<xref ref-type="bibr" rid="B2">2</xref>]. While other techniques may be more sensitive or less expensive, NMR has emerged as an ideal platform for studying metabolites in biofluids. It is a rapid, highly precise, non-destructive, and quantitative technique that allows one to compare, identify and quantify a wide range of compounds without the need for prior compound separation or derivatization [<xref ref-type="bibr" rid="B3">3</xref>-<xref ref-type="bibr" rid="B6">6</xref>]. NMR is particularly amenable to compounds that are less tractable to GC-MS or LC-MS analysis, such as sugars, amines, volatile ketones and relatively non-reactive compounds. A key disadvantage of NMR is that it is a relatively insensitive technique, with a lower limit of detection of 1~5 μM and a requirement of relatively large sample sizes (~500 μL).</p>
    <p>Currently, most NMR-based metabolomic studies involve the analysis of 1D <sup>1</sup>H NMR spectra, although 1D <sup>13</sup>C and <sup>31</sup>P NMR spectra may also be analyzed [<xref ref-type="bibr" rid="B7">7</xref>-<xref ref-type="bibr" rid="B10">10</xref>]. There are generally two routes to analyzing NMR spectra for metabolomic studies. In one method (called the chemometric approach), the compounds are not initially identified – only their spectral patterns and intensities are recorded and statistically compared in order to identify the relevant spectral features that distinguish sample classes. Once these features have been located, a variety of approaches may then be used to identify the corresponding metabolites [<xref ref-type="bibr" rid="B11">11</xref>]. In the other approach (often called quantitative metabolomics or targeted profiling), compounds are first identified and quantified by comparing the NMR spectrum of the biofluid of interest to a spectral reference library obtained from pure compounds [<xref ref-type="bibr" rid="B12">12</xref>]. Once these compounds are identified and quantified, the data can be analyzed in many different ways to identify the most relevant biomarkers or informative pathways.</p>
    <p>A variety of protocols and software tools have been recently developed for conducting quantitative metabolomics via 1D <sup>1</sup>H NMR [<xref ref-type="bibr" rid="B5">5</xref>,<xref ref-type="bibr" rid="B6">6</xref>,<xref ref-type="bibr" rid="B12">12</xref>,<xref ref-type="bibr" rid="B13">13</xref>]. In most cases, a manual peak-fitting process is required in order to perform compound identification and quantification. However, this manual fitting process can become particularly difficult and prone to frequent errors, especially for very complex biofluid mixtures (such as urine or tissue extracts) due to severe spectral overlap. In contrast to 1D NMR, 2D NMR offers a robust approach to resolving excessively overlapped spectra. Indeed 2D (and 3D) NMR has long been used to resolve and identify individual resonances from large macromolecules such as DNA, RNA and proteins. 2D NMR experiments such as TOCSY, HSQC and J-resolved spectroscopy are also increasingly being used in metabolomic studies in order to resolve spectral ambiguities to aid in the identification of specific compounds in complex biofluid mixtures [<xref ref-type="bibr" rid="B14">14</xref>-<xref ref-type="bibr" rid="B22">22</xref>].</p>
    <p>A number of small-molecule NMR databases have been developed in recent years to support metabolomics research, including the Human Metabolome Database (HMDB) [<xref ref-type="bibr" rid="B23">23</xref>], the BioMagResBank Database (BMRB) [<xref ref-type="bibr" rid="B24">24</xref>], the Madison Metabolomics Consortium Database (MMCD) [<xref ref-type="bibr" rid="B25">25</xref>], the Magnetic Resonance Metabolomics Database (MRMD) [<xref ref-type="bibr" rid="B26">26</xref>], and the Platform for RIKEN Metabolomics (PRIMe). These resources, which contain significant numbers of reference NMR spectra of metabolites, also support metabolite identification through web-based submission of 1D and 2D NMR peak lists. However, these on-line tools don't generally provide graphical support for peak filtering, processing, comparative display or annotation. Furthermore, they don't exploit additional constraints such as knowledge about biofluid composition or metabolite concentration ranges to make compound identification even more robust, more accurate, and more efficient. We propose that by using a comprehensive 2D spectral reference library along with a more detailed knowledge of metabolite compositions of different biofluids, it is possible to greatly improve compound identification from 2D NMR spectra. Here we report our efforts in developing an easy-to-use, graphically-based, stand-alone software tool, called MetaboMiner, to perform semi-automated metabolite identification from 2D TOCSY and HSQC-spectra of complex biofluid mixtures.</p>
  </sec>
  <sec sec-type="methods">
    <title>Methods</title>
    <sec>
      <title>Data Collection and Curation</title>
      <p>Key to the development of this software package was the creation of an extensive 2D spectral library containing TOCSY and HSQC spectra of pure metabolites. We used several publicly available sources in constructing this library. The majority of the raw <sup>1</sup>H-<sup>1</sup>H TOCSY spectra were collected from the standard compound spectral library available at the BMRB database [<xref ref-type="bibr" rid="B24">24</xref>]. A few additional compound spectra were obtained from the MRMD [<xref ref-type="bibr" rid="B26">26</xref>]. The <sup>1</sup>H-<sup>13</sup>C HSQC spectral library was downloaded from the HMDB [<xref ref-type="bibr" rid="B23">23</xref>]. These raw spectra contained a number of spectral artefacts (noise, water bands, asymmetries, peaks from TSP or DSS, contaminants, <italic>etc</italic>.). Consequently it was necessary to convert these raw spectra into "synthetic" or "simplified" spectra corresponding to the peaks specific to the pure compounds of interest. This conversion was done manually, with each of these simplified, noise-free spectra being examined for inconsistencies by comparing them to the original raw spectra and the compound's known resonance assignments. In total, the MetaboMiner TOCSY reference library includes spectra from 223 common metabolites and the MetaboMiner HSQC library contains spectra from 502 metabolites. The compounds in both libraries were further catalogued into three sub-libraries corresponding to the three common human biofluids – cerebrospinal fluid (CSF), plasma and urine. The classification was based on their respective metabolic compositions listed in the HMDB [<xref ref-type="bibr" rid="B23">23</xref>]. Since the presence of these biofluid-specific metabolites was determined by a variety of technologies not limited to NMR, we further investigated the appearance of these metabolites in a large number of 1D <sup>1</sup>H spectra collected from CSF, plasma and urine. The combined collection of compounds (and spectra) were used to create corresponding "common biofluid" 2D NMR spectral libraries that effectively represent a generic biofluid or cell extract. The "CSF", "plasma", "urine", "biofluid" and "total" spectral libraries are stored as XML files and are editable via MetaboMiner's graphical user interface (GUI).</p>
      <p>After the spectral libraries were constructed, each peak for each compound in each library was assigned a series of uniqueness values that are specific for that reference library. A unique peak in MetaboMiner is defined as a relatively isolated peak around which no peak from any other compound is observed based on the spectral library of the given biofluid. For any given peak, its uniqueness value is calculated as the total number of surrounding peaks from other compounds within a given chemical shift "distance". Five distance levels were used to measure peak uniqueness. For <sup>1</sup>H chemical shifts, the distance thresholds are 0.01, 0.02, 0.03, 0.04, and 0.05 ppm. For <sup>13</sup>C chemical shifts, the distance thresholds are set at 0.05, 0.10, 0.15, 0.20, and 0.25 ppm. For instance, an HSQC peak with a series of assigned uniqueness values of 0-0-0-1-2 indicates that no peak from any other compound in the reference library is observed within 0.03 ppm (<sup>1</sup>H dimension) and 0.15 ppm (<sup>13</sup>C dimension) of that peak. It also indicates that one peak from another compound in the spectra library was observed within 0.03~0.04 ppm (<sup>1</sup>H dimension) and 0.15~0.20 ppm (<sup>13</sup>C dimension) and another peak from another compound was observed within 0.04~0.05 ppm (<sup>1</sup>H dimension) and 0.20~0.25 ppm (<sup>13</sup>C dimension). See Figure <xref ref-type="fig" rid="F1">1</xref> for a more complete description of the uniqueness value concept. These uniqueness values are automatically updated after any spectral library change using MetaboMiner's graphical user interface.</p>
      <fig position="float" id="F1">
        <label>Figure 1</label>
        <caption>
          <p><bold>An illustration of the calculation of uniqueness values</bold>. The red peak represents the peak of interest and three peaks are in its immediate vicinity. The calculations are only performed at five chemical shifts distance levels – 0.01, 0.02, 0.03, 0.04, 0.05 ppm along the <sup>1</sup>H dimension, and 0.05, 0.10, 0.15, 0.20, 0.25 ppm along the <sup>13</sup>C dimension. No peak is observed in the first three distance levels. So the maximum unique scope for this peak is (0.03, 0.15) ppm. Peak A is found within 0.03~0.04 ppm (<sup>1</sup>H dimension) and 0.15~0.20 ppm (<sup>13</sup>C dimension) of the red peak; Peak B is found within 0.04~0.05 ppm (<sup>1</sup>H dimension) and 0.20~0.25 ppm (<sup>13</sup>C dimension) of the red peak; Peak C is not considered since the chemical shift distance is more than 0.05 ppm along the <sup>1</sup>H dimension. Therefore, the assigned uniqueness values are 0-0-0-1-2. Note that the distance is not drawn to scale.</p>
        </caption>
        <graphic xlink:href="1471-2105-9-507-1"/>
      </fig>
    </sec>
    <sec>
      <title>Peak Processing, Peak Matching and Compound Identification</title>
      <p>As part of its input, MetaboMiner requires peak lists corresponding to the peaks that were identified in either the TOCSY or HSQC spectra collected from the biofluid(s) of interest. While it is possible for users to provide manually picked peak lists, MetaboMiner also supports processing of multidimensional NMR peak lists obtained from automatic peak peaking programs. Multidimensional NMR spectra typically contain substantial numbers of spectral artefacts such as baseline distortions, intense solvent lines, ridges, sinc wiggles, <italic>etc</italic>. Automatic peak-picking programs tend to mistake these noise signals for real resonances. Therefore, any raw 2D spectra collected from biofluids must be processed appropriately before attempting to match them to MetaboMiner's reference spectral library. Two automated procedures were found to be very effective in cleaning up raw 2D spectra: 1) streak removal and 2) symmetrical editing. Note that the latter processing technique is only applicable for TOCSY spectra. Spectral streaks are usually caused by residual solvent signals (i.e. water) or the presence of other compounds at extremely high concentrations. Streaks can be recognized by their specific locations and prominent shapes in the NMR spectra. Streak removal was implemented by searching for groups of peaks at these common locations and eliminating them from the peak list. Symmetrical editing exploits the fact that real TOCSY peak signals form a symmetrical square pattern along the diagonal line. Off-diagonal peaks without any corresponding symmetrical peaks can be considered to be artefacts. Both peak positions and intensities (if provided by the user) of the corresponding peaks are examined for symmetry. Since TOCSY cross peaks are frequently not of equal intensity we require that the intensity ratio between the upper and lower-diagonal peaks should be within a range of 0.8~2.5 of each other to be considered symmetrical.</p>
      <p>In order to accommodate small chemical shift differences between the observed NMR spectra and the reference NMR spectra, an adaptive threshold method was implemented based on the uniqueness values (described above) of each reference peak. During the peak searching/matching process, the search threshold varies automatically based on the maximum uniqueness value of the current peak. For instance, when searching for potential matches for a TOCSY peak with uniqueness values of 0-0-0-0-1, MetaboMiner will automatically set its threshold to 0.04 ppm. The peak matching and adaptive thresholding employ two processes: a reverse search strategy and a forward search strategy. In the reverse search strategy, the library peaks are searched and matched against the query peaks. Typically most query peaks find their potential matches during this reverse search step. However there are usually some peaks left without any matches. In order to assign these unmatched peaks a forward search is performed in which the unmatched query peaks are searched against the reference library with expanded thresholds – 0.08 ppm for TOCSY and 0.12 ppm (<sup>1</sup>H) and 0.4 ppm (<sup>13</sup>C) for HSQC spectra. A match is identified if only a single reference peak is identified within this range.</p>
      <p>In MetaboMiner a compound is considered to be present only if its matched pattern satisfies the requirements of what we call "minimal signatures". A minimal signature is defined as the minimum peak set that can uniquely identify a compound from all others in a given spectral library. Based on the complete peak set of the reference spectral library, many minimal signatures can be derived through different combinations of unique peaks. A single peak match may be considered a minimal signature if it is completely unique. More peaks are required to define a minimal signature for less unique ones. For instance, in our current implementation, the presence of a single peak with uniqueness values 0-0-0-0-x (x &gt;= 0) will determine the presence of the corresponding compound (subject to authenticity checks as discussed later); while at least two peaks with uniqueness values 0-0-0-x-x are required to reach the decision.</p>
      <p>Since query spectra (i.e. real spectra from biofluids) usually contain substantial levels of spectral noise, even after pre-processing, we found that we could reduce MetaboMiner's false positive rate even further by implementing several authenticity checks. These include: 1) having a minimum number of matched peaks (3 for TOCSY spectra and 1 for HSQC spectra), 2) having a minimum matched fraction of peaks (1/2 for TOCSY spectra and 1/6 for HSQC spectra), 3) ensuring the presence of certain peaks for certain compounds (determined by manual testing and validation for each compound), and 4) ensuring that the identified compounds were known to be in a given biofluid.</p>
    </sec>
    <sec>
      <title>User Interface Description</title>
      <p>MetaboMiner's graphical user interface was implemented using Java Swing technology. The spectral visualization and manipulation tools were built using the JGraph library (Java open source graph visualization library, <ext-link ext-link-type="uri" xlink:href="http://www.jgraph.com"/>). Figure <xref ref-type="fig" rid="F2">2</xref> illustrates a flowchart describing the MetaboMiner GUI. There are four main functional views, 1) a Processing View, 2) a Search View, 3) an Annotation View, and 4) a Library View. All these views share the same component arrangement, with panels on the right side being used for visualizing and manipulating peaks, and the panels on the left being used for displaying parameters, compound lists, structure images, <italic>etc</italic>. Navigation to each view is readily accessible by clicking an appropriate menu item.</p>
      <fig position="float" id="F2">
        <label>Figure 2</label>
        <caption>
          <p><bold>MetaboMiner flowchart</bold>. The query peaks obtained from an automatic peak-picking program are first processed to remove streaks and other artefacts. The cleaned peak list is then scanned for the presence of peak patterns of compounds in a spectral reference library corresponding to the biofluid that has been identified by the user. Spectral images can be used to further refine the search result.</p>
        </caption>
        <graphic xlink:href="1471-2105-9-507-2"/>
      </fig>
      <p>When the program launches, the default view is the "Processing View" where users can copy and paste the automatically picked peak list. The input format must be either a two or three-column list, with numbers separated by a space or a semicolon. The first two columns must be the x and y chemical shift coordinates of each peak in the 2D spectrum and the optional third column must be the peak height or peak intensity. After processing the raw peaks, both the original and the processed spectra will be displayed on MetaboMiner's spectral viewing panel (located on the right). With this viewing panel, users can directly edit peaks on the spectrum if necessary. For manually picked peaks, this step can be skipped by turning the processing options off. By clicking the "Search" button, MetaboMiner's "Search View" will be displayed with its initial, automated compound identification results. Users can adjust the search threshold or switch the reference library to further refine the result. A compound is marked as identified if the matched pattern passes the authenticity checks and satisfies the minimum signature requirement. The raw matched scores are also displayed. MetaboMiner's interface allows users to visually inspect the matched peaks of any metabolite against the corresponding reference spectrum. By right clicking any peak displayed on the spectrum, users can search the library for this particular peak. The identified compound list can be saved in three different formats by clicking the "Export" button. A screenshot of MetaboMiner's "Search View" is shown in Figure <xref ref-type="fig" rid="F3">3</xref>.</p>
      <fig position="float" id="F3">
        <label>Figure 3</label>
        <caption>
          <p><bold>Screenshot of MetaboMiner's "Search View"</bold>. The left panel shows the library compounds that have matches in the query peaks. The selected checkbox indicates the corresponding compound is considered to be present by MetaboMiner. 'R' or 'F' indicates whether the compound is identified during the reverse search or forward search, respectively. On the right panel, the reference peaks (in red) of the current selected compound is displayed with query peaks as background. The color variations represent the peak intensities with the dark green corresponding to the strongest peak intensities. When the mouse is placed over any synthetic peak, all its information (name, position, uniqueness values, <italic>etc</italic>.) will be displayed on the view panel. Right clicking on any peak will allow users to search the spectral library for this particular peak.</p>
        </caption>
        <graphic xlink:href="1471-2105-9-507-3"/>
      </fig>
      <p>Users can further refine the automated search results by manually annotating the raw 2D spectrum. By clicking the "Refine" button in the "Search View", the "Annotation View" will be launched with the identified compounds being transferred as the starting point. Users can also directly enter the "Annotation View" mode by clicking the "Annotate" button from the "Console" menu. In order to perform manual annotation, users first need to load a high resolution spectral image in PNG format and set up the spectral axes properly. Peak searching is performed by right clicking the peak position on the spectrum to search the reference library as shown in Figure <xref ref-type="fig" rid="F4">4</xref>. All compounds that generate peaks within the search threshold will be checked. The compound with the closest peak match will be highlighted with its database reference spectrum displayed on the uploaded "raw" spectrum. Users can perform peak annotation for any currently displayed compound. Double clicking any database peak will open a small text editor where users can enter the peak assignment or a comment. The peak pattern of the identified compounds can also be edited to match the experimental spectrum. For example, users can insert, delete, or drag a database peak to match the observed peak in the raw spectrum. These changes will be valid only for the current session. To make permanent changes, MetaboMiner's "Library View" must be used.</p>
      <fig position="float" id="F4">
        <label>Figure 4</label>
        <caption>
          <p><bold>Screenshot of MetaboMiner's "Annotation View"</bold>. The contents of the reference spectral library and the automatically identified compound list are shown on the left panel. The spectral image is displayed on the right panel. The red peaks correspond to the reference spectra of the current compound being annotated (Valine). Peak searching is carried out by right clicking on a corresponding Valine peak. The user can also directly edit the current compound by inserting, removing, or dragging its peaks to match the exact pattern of the reference spectrum.</p>
        </caption>
        <graphic xlink:href="1471-2105-9-507-4"/>
      </fig>
      <p>The "Library View" is intended for browsing and managing MetaboMiner's spectral libraries. To view all the available reference spectra in MetaboMiner's libraries, users must click the "Browse" button in the "Library" menu. Double clicking any compound in the compound list will open a popup window for peak editing. Any changes will be reflected on the spectrum at real time. New compounds can be introduced by clicking the "New" button at the bottom of the compound list. A new compound can be either exported from another library or be created from scratch through the wizard dialog. Both peak editing or adding new compounds will trigger updating of the uniqueness values of the affected peaks. For researchers who study other types of biological samples (e.g. plant or microbial extracts), they may either use MetaboMiner's generic spectral reference library or create a new library customized for that particular type of biofluid. Library creation or deletion can be easily accomplished by clicking the appropriate menu items in the "Library" menu. The compounds in the default reference library are linked to PubChem, HMDB [<xref ref-type="bibr" rid="B18">18</xref>], and the BMRB [<xref ref-type="bibr" rid="B19">19</xref>] via the hyperlink under their structure icon. The "Graphics" menu enables users to change the size, shape, or color of the synthetic peaks to suit their preferences.</p>
      <p>It is important to note that MetaboMiner does not support spectral processing such as phasing, baseline correction or chemical shift referencing. There are many other high-quality NMR-processing software available for this task, including NMRPipe [<xref ref-type="bibr" rid="B27">27</xref>], Felix (Molecular Simulations, Inc., San Diego, CA), VNMR (Varian, Inc., Palo Alto, CA), and XWinNMR (Bruker Analytik GmbH, Karlsruhe, Germany), to name a few. These tools should be used prior to loading spectral images into MetaboMiner. In other words, MetaboMiner is not a spectral processing tool, but a NMR-based metabolomics tool that facilitates automatic peak processing, rapid compound identification, and facile spectrum annotation capabilities through an intuitive graphical interface. MetaboMiner is available at: <ext-link ext-link-type="uri" xlink:href="http://wishart.biology.ualberta.ca/metabominer/"/></p>
    </sec>
    <sec>
      <title>Evaluation protocol</title>
      <p>MetaboMiner was assessed in a variety of ways using both synthetic and experimental NMR spectra. The synthetic spectra were generated from the 162 compounds that have both TOCSY and HSQC spectra in the reference library. The experimental spectra were collected from three defined compound mixtures (totalling 72 compounds) and a biofluid sample of known composition (plasma). These evaluations allowed a complete and comprehensive assessment of MetaboMiner's performance as well as its potential strengths and limitations.</p>
    </sec>
    <sec>
      <title>The effects of different types of spectral noise on compound identification</title>
      <p>The performance of the minimal signature method and the adaptive threshold method were evaluated under two common types of spectral noise – missing peaks and "drifting" peaks (i.e. peaks that have drifted from their canonical positions due to temperature, pH or solvent effects). The missing peaks were simulated by deleting peaks of each compound at random with 0%, 10%, 20%, 30%, 40%, 50% probabilities. The chemical shift drift effects were simulated by adding random values of ± 0.01, ± 0.02, ± 0.03, ± 0.04, ± 0.05 ppm for each <sup>1</sup>H chemical shift, and ± 0.05, ± 0.10, ± 0.15, ± 0.20, ± 0.25 ppm for each <sup>13</sup>C chemical shift. The spectra of each synthetic query mixture were generated by first pooling the peaks from 50 compounds that were randomly selected from the MetaboMiner reference spectral library (162 compounds). After introducing this artificial spectral noise, the query mixtures were searched against the reference spectral library with and without using the adaptive threshold method. Two compound identification strategies were compared – the minimal signature method (MS) and the percentage match method (PM) with 75% as the cut-off value. The F-measure was used for performance evaluation, where <italic>F = 2 × (precision × recall)/(precision + recall) </italic>where recall is the proportion of true positives in the returned result (<italic>recall = TP/(TP+FN)</italic>) and precision is a measure of the percentage of positive or correct results (<italic>precision = TP/(TP+FP)</italic>). The values were obtained as the averages of TOCSY and HSQC search results over 50 iterations. Figure <xref ref-type="fig" rid="F5">5A</xref> summarizes MetaboMiner's performance using data with different fractions of missing peaks. Figure <xref ref-type="fig" rid="F5">5B</xref> shows the results using data with increasing chemical shift drift effects.</p>
      <fig position="float" id="F5">
        <label>Figure 5</label>
        <caption>
          <p><bold>Comparative performance of different search strategies</bold>. Synthetic mixture query spectra were generated by pooling the peaks of 50 randomly selected compounds from MetaboMiner's reference spectral library. Different levels of spectral noise were added to these peaks and then compounds were identified with (*) and without using the adaptive threshold method. The Figure 5A, the query peaks were deleted at random with 0%, 10%, 20%, 30%, 40% and 50% probabilities; Figure 5B, the query peaks were subject to five levels of random chemical shift variations (± 0.01, ± 0.02, ± 0.03, ± 0.04, ± 0.05 ppm for each <sup>1</sup>H chemical shift, and ± 0.05, ± 0.10, ± 0.15, ± 0.20, ± 0.25 ppm for each <sup>13</sup>C chemical shift). The F scores were averaged over 50 iterations. (Abbreviations: PM, percentage match method; MS, minimal signature method).</p>
        </caption>
        <graphic xlink:href="1471-2105-9-507-5"/>
      </fig>
    </sec>
    <sec>
      <title>The effects of different spectral data types on compound identification</title>
      <p>We further investigated the usefulness of different NMR data types for compound identification based on our concept of a minimal spectral signature. Four NMR data types were compared – 1D <sup>1</sup>H, 1D <sup>13</sup>C, <sup>1</sup>H TOCSY, and <sup>1</sup>H-<sup>13</sup>C HSQC spectra. For this particular evaluation, reference 1D <sup>1</sup>H and 1D <sup>13</sup>C spectra were obtained from the corresponding <sup>1</sup>H and <sup>13</sup>C chemical shifts of MetaboMiner's HSQC spectral library. For a small number of compounds, these artificial 1D spectra lacked some of the expected <sup>1</sup>H or <sup>13</sup>C signals that might be seen in a real 1D NMR spectrum, but their absence also helped to simulate the fact that some peaks in 1D NMR spectra are broadened or washed out due to signal overlap or solvent suppression.</p>
      <p>Synthetic 2D NMR spectra (query spectra) representing different biofluids of increasing molecular complexity were generated by pooling peaks of 20, 30, 40, 50, 60, 70, and 80 compounds randomly selected from MetaboMiner's reference spectral library. To further simulate noise or pH/salt effects, 10% of the peaks from the query spectra were deleted at random, followed by the introduction of random chemical shift changes (± 0.01 ppm for <sup>1</sup>H and ± 0.05 ppm for <sup>13</sup>C) to the remaining peaks. The resulting peaks were subsequently searched against MetaboMiner's reference spectral library using the adaptive threshold method. The F measures were averaged over 50 iterations. The result is summarized in Figure <xref ref-type="fig" rid="F6">6</xref>.</p>
      <fig position="float" id="F6">
        <label>Figure 6</label>
        <caption>
          <p><bold>Evaluation of MetaboMiner using simulated datasets</bold>. Synthetic mixture query spectra were generated by pooling peaks from 20, 30, 40, 50, 60, 70, and 80 compounds randomly selected from MetaboMiner's spectral library. Spectral noise was introduced via random (10%) peak deletion and random chemical shift changes within ± 0.01 ppm for each <sup>1</sup>H chemical shift, and within ± 0.05 ppm for each <sup>13</sup>C chemical shift. Compound identification was based on minimal signatures using the adaptive threshold method. The F-measures were averaged over 50 iterations.</p>
        </caption>
        <graphic xlink:href="1471-2105-9-507-6"/>
      </fig>
    </sec>
    <sec>
      <title>Compound identification using experimental spectra</title>
      <p>Twelve 2D NMR experiments (six TOCSY and six HSQC) were collected under different pH conditions using three synthetic mixtures and a plasma sample. The three synthetic mixtures were composed of 27, 21, and 24 common metabolites, respectively, with concentrations ranging from 40 to 60 mM. The plasma sample contained 35 identifiable metabolites (ranging in concentration from 0.1 to 10 mM) as determined by independent profiling of its 1D <sup>1</sup>H NMR spectra by several experienced individuals using Chenomx's NMR Suite software [<xref ref-type="bibr" rid="B12">12</xref>]. These results were further confirmed by spiking/doping authentic standards into the plasma sample and by GC-MS analysis. The plasma sample was prepared by filtering the sample through a 3 kDa filter (to remove proteins), then lyophilizing and finally dissolving the remaining solids in distilled water to its 1/5 original volume. Deuterium oxide (D<sub>2</sub>O) was added to make a final concentration of 90% H<sub>2</sub>O and 10% D<sub>2</sub>O. All spectra were acquired at 25°C. Six spectra were collected on a Varian INOVA 800 MHz spectrometer equipped with a 5 mm triple axis gradient cryoprobe. The other six spectra were collected on a Varian INOVA 500 MHz spectrometer with a 5 mm triple-resonance z-gradient probe. The TOCSY experiments were performed using the wgtocsy pulse sequence, and the HSQC experiments were performed using the gChsqc pulse sequence, both provided by Varian's BioPack. For the TOCSY experiments, the spectral width was set to 11990 Hz and a mixing time of 50 milliseconds. Sixteen transients were collected for each of 128 t<sub>1 </sub>intervals using an acquisition time of 0.085 seconds and a relaxation delay of 2.0 seconds. The total acqisition time for the TOCSY spectra was 2.5 hours For the <sup>13</sup>C-HSQC experiments, the spectral widths of the proton and carbon dimensions were 11990 Hz and 28160 Hz respectively. Sixty four transients were acquired for each t<sub>1 </sub>interval using an acquisition time of 0.085 seconds and a relaxation delay of 1.0 seconds. The spectra were collected with 2048*256 complex points for the <sup>1</sup>H and <sup>13</sup>C dimensions respectively. The total spectral acquisition time for the HSQC spectra was 5 hours. Sample TOCSY and HSQC spectra are available [see Additional File <xref ref-type="supplementary-material" rid="S1">1</xref>].</p>
      <p>The raw NMR spectra were first processed using NMRPipe [<xref ref-type="bibr" rid="B27">27</xref>] and the peaks were subsequently picked using Sparky's [<xref ref-type="bibr" rid="B28">28</xref>] automatic peak picking program. The resulting "raw" peak lists were copied and pasted to the processing view of MetaboMiner. Both peak processing and compound identification were performed using MetaboMiner's default parameter sets. The reference library used for the synthetic mixtures was the biofluid (common) library. For plasma data, the plasma (common) library was used. To assess the degradation in performance assuming no prior knowledge of the sample source (urine, plasma, cell extract or generic biofluid) the complete spectral reference library (223 compounds for TOCSY, 502 compounds for HSQC) was also used to identify compounds. To assess the performance of the web-servers that support 2D NMR mixture analysis – the HMDB [<xref ref-type="bibr" rid="B23">23</xref>], the MMCD [<xref ref-type="bibr" rid="B25">25</xref>], the BMRB [<xref ref-type="bibr" rid="B24">24</xref>], and the SpinAssign [<xref ref-type="bibr" rid="B29">29</xref>] of PRIMe <ext-link ext-link-type="uri" xlink:href="http://prime.psc.riken.jp/"/> – the same set of peak lists were submitted. For PRIMe, the default search parameters were used. For other web services, the search threshold for <sup>1</sup>H was set to 0.03 ppm and 0.10 ppm for <sup>13</sup>C. The results are summarized in Tables <xref ref-type="table" rid="T1">1</xref> and <xref ref-type="table" rid="T2">2</xref>.</p>
      <table-wrap position="float" id="T1">
        <label>Table 1</label>
        <caption>
          <p>Performance evaluation using HSQC data collected at pH ~7.2.</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <td align="left">
                <bold>Method</bold>
              </td>
              <td align="center">
                <bold>Sample</bold>
              </td>
              <td align="center">
                <bold># Cmpds</bold>
              </td>
              <td align="center">
                <bold>#Correctly Identified (TP)</bold>
              </td>
              <td align="center">
                <bold>FN</bold>
              </td>
              <td align="center">
                <bold>FP</bold>
              </td>
              <td align="center">
                <bold>Precision (%)</bold>
              </td>
              <td align="center">
                <bold>Recall (%)</bold>
              </td>
              <td align="center">
                <bold>F score</bold>
              </td>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left">MetaboMiner-sp</td>
              <td align="center">A</td>
              <td align="center">27</td>
              <td align="center">21</td>
              <td align="center">6</td>
              <td align="center">6</td>
              <td align="center">77.8</td>
              <td align="center">77.8</td>
              <td align="center">77.8</td>
            </tr>
            <tr>
              <td align="left">MetaboMiner-all</td>
              <td align="center">A</td>
              <td align="center">27</td>
              <td align="center">15</td>
              <td align="center">12</td>
              <td align="center">8</td>
              <td align="center">65.2</td>
              <td align="center">55.6</td>
              <td align="center">60.0</td>
            </tr>
            <tr>
              <td align="left">HMDB</td>
              <td align="center">A</td>
              <td align="center">27</td>
              <td align="center">8</td>
              <td align="center">19</td>
              <td align="center">19</td>
              <td align="center">29.7</td>
              <td align="center">29.7</td>
              <td align="center">29.7</td>
            </tr>
            <tr>
              <td align="left">MMCD</td>
              <td align="center">A</td>
              <td align="center">27</td>
              <td align="center">8</td>
              <td align="center">19</td>
              <td align="center">6</td>
              <td align="center">57.1</td>
              <td align="center">29.7</td>
              <td align="center">39.1</td>
            </tr>
            <tr>
              <td align="left">BMRB</td>
              <td align="center">A</td>
              <td align="center">27</td>
              <td align="center">6</td>
              <td align="center">21</td>
              <td align="center">21</td>
              <td align="center">22.2</td>
              <td align="center">22.2</td>
              <td align="center">22.2</td>
            </tr>
            <tr>
              <td align="left">PRIMe</td>
              <td align="center">A</td>
              <td align="center">27</td>
              <td align="center">14</td>
              <td align="center">13</td>
              <td align="center">6</td>
              <td align="center">70.0</td>
              <td align="center">51.9</td>
              <td align="center">59.6</td>
            </tr>
            <tr>
              <td align="left">MetaboMiner-sp</td>
              <td align="center">B</td>
              <td align="center">21</td>
              <td align="center">16</td>
              <td align="center">5</td>
              <td align="center">5</td>
              <td align="center">76.2</td>
              <td align="center">76.2</td>
              <td align="center">76.2</td>
            </tr>
            <tr>
              <td align="left">MetaboMiner-all</td>
              <td align="center">B</td>
              <td align="center">21</td>
              <td align="center">9</td>
              <td align="center">12</td>
              <td align="center">0</td>
              <td align="center">100</td>
              <td align="center">42.9</td>
              <td align="center">60.0</td>
            </tr>
            <tr>
              <td align="left">HMDB</td>
              <td align="center">B</td>
              <td align="center">21</td>
              <td align="center">1</td>
              <td align="center">20</td>
              <td align="center">20</td>
              <td align="center">4.8</td>
              <td align="center">4.8</td>
              <td align="center">4.8</td>
            </tr>
            <tr>
              <td align="left">MMCD</td>
              <td align="center">B</td>
              <td align="center">21</td>
              <td align="center">0</td>
              <td align="center">21</td>
              <td align="center">0</td>
              <td align="center">0</td>
              <td align="center">0</td>
              <td align="center">0</td>
            </tr>
            <tr>
              <td align="left">BMRB</td>
              <td align="center">B</td>
              <td align="center">21</td>
              <td align="center">1</td>
              <td align="center">20</td>
              <td align="center">20</td>
              <td align="center">4.8</td>
              <td align="center">4.8</td>
              <td align="center">4.8</td>
            </tr>
            <tr>
              <td align="left">PRIMe</td>
              <td align="center">B</td>
              <td align="center">21</td>
              <td align="center">6</td>
              <td align="center">15</td>
              <td align="center">4</td>
              <td align="center">60.0</td>
              <td align="center">28.6</td>
              <td align="center">38.7</td>
            </tr>
            <tr>
              <td align="left">MetaboMiner-sp</td>
              <td align="center">C</td>
              <td align="center">24</td>
              <td align="center">22</td>
              <td align="center">2</td>
              <td align="center">2</td>
              <td align="center">91.7</td>
              <td align="center">91.7</td>
              <td align="center">91.7</td>
            </tr>
            <tr>
              <td align="left">MetaboMiner-all</td>
              <td align="center">C</td>
              <td align="center">24</td>
              <td align="center">16</td>
              <td align="center">8</td>
              <td align="center">3</td>
              <td align="center">84.2</td>
              <td align="center">66.7</td>
              <td align="center">74.4</td>
            </tr>
            <tr>
              <td align="left">HMDB</td>
              <td align="center">C</td>
              <td align="center">24</td>
              <td align="center">9</td>
              <td align="center">15</td>
              <td align="center">15</td>
              <td align="center">37.5</td>
              <td align="center">37.5</td>
              <td align="center">37.5</td>
            </tr>
            <tr>
              <td align="left">MMCD</td>
              <td align="center">C</td>
              <td align="center">24</td>
              <td align="center">2</td>
              <td align="center">22</td>
              <td align="center">0</td>
              <td align="center">100</td>
              <td align="center">7.4</td>
              <td align="center">13.8</td>
            </tr>
            <tr>
              <td align="left">BMRB</td>
              <td align="center">C</td>
              <td align="center">24</td>
              <td align="center">3</td>
              <td align="center">21</td>
              <td align="center">21</td>
              <td align="center">12.5</td>
              <td align="center">12.5</td>
              <td align="center">12.5</td>
            </tr>
            <tr>
              <td align="left">PRIMe</td>
              <td align="center">C</td>
              <td align="center">24</td>
              <td align="center">8</td>
              <td align="center">16</td>
              <td align="center">5</td>
              <td align="center">61.5</td>
              <td align="center">33.3</td>
              <td align="center">43.2</td>
            </tr>
            <tr>
              <td align="left">MetaboMiner-sp</td>
              <td align="center">D</td>
              <td align="center">35</td>
              <td align="center">29</td>
              <td align="center">6</td>
              <td align="center">6</td>
              <td align="center">82.9</td>
              <td align="center">82.9</td>
              <td align="center">82.9</td>
            </tr>
            <tr>
              <td align="left">MetaboMiner-all</td>
              <td align="center">D</td>
              <td align="center">35</td>
              <td align="center">16</td>
              <td align="center">19</td>
              <td align="center">7</td>
              <td align="center">69.6</td>
              <td align="center">45.7</td>
              <td align="center">55.2</td>
            </tr>
            <tr>
              <td align="left">HMDB</td>
              <td align="center">D</td>
              <td align="center">35</td>
              <td align="center">9</td>
              <td align="center">26</td>
              <td align="center">26</td>
              <td align="center">25.7</td>
              <td align="center">25.7</td>
              <td align="center">25.7</td>
            </tr>
            <tr>
              <td align="left">MMCD</td>
              <td align="center">D</td>
              <td align="center">35</td>
              <td align="center">4</td>
              <td align="center">31</td>
              <td align="center">3</td>
              <td align="center">57.1</td>
              <td align="center">11.4</td>
              <td align="center">19.0</td>
            </tr>
            <tr>
              <td align="left">BMRB</td>
              <td align="center">D</td>
              <td align="center">35</td>
              <td align="center">7</td>
              <td align="center">28</td>
              <td align="center">28</td>
              <td align="center">20.0</td>
              <td align="center">20.0</td>
              <td align="center">20.0</td>
            </tr>
            <tr>
              <td align="left">PRIMe</td>
              <td align="center">D</td>
              <td align="center">35</td>
              <td align="center">14</td>
              <td align="center">21</td>
              <td align="center">5</td>
              <td align="center">73.7</td>
              <td align="center">40.0</td>
              <td align="center">51.8</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <p>Samples A, B, and C are synthetic cocktail mixtures and sample D is a plasma sample.</p>
          <p>(Annotation: MetaboMiner-sp = searched using the biofluid-specific library; MetaboMiner-all = searched using the entire spectral library; TP = true positives; FN = false negatives; FP = false positives).</p>
        </table-wrap-foot>
      </table-wrap>
      <table-wrap position="float" id="T2">
        <label>Table 2</label>
        <caption>
          <p>Performance evaluation using TOCSY data collected at pH ~7.2. </p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <td align="left">
                <bold>Method</bold>
              </td>
              <td align="center">
                <bold>Sample</bold>
              </td>
              <td align="center">
                <bold># Cmpds</bold>
              </td>
              <td align="center">
                <bold># Correctly Identified (TP)</bold>
              </td>
              <td align="center">
                <bold>FN</bold>
              </td>
              <td align="center">
                <bold>FP</bold>
              </td>
              <td align="center">
                <bold>Precision (%)</bold>
              </td>
              <td align="center">
                <bold>Recall (%)</bold>
              </td>
              <td align="center">
                <bold>F score</bold>
              </td>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left">MetaboMiner-sp</td>
              <td align="center">A</td>
              <td align="center">27</td>
              <td align="center">23</td>
              <td align="center">4</td>
              <td align="center">4</td>
              <td align="center">85.2</td>
              <td align="center">85.2</td>
              <td align="center">85.2</td>
            </tr>
            <tr>
              <td align="left">MetaboMiner-all</td>
              <td align="center">A</td>
              <td align="center">27</td>
              <td align="center">21</td>
              <td align="center">6</td>
              <td align="center">6</td>
              <td align="center">77.8</td>
              <td align="center">77.8</td>
              <td align="center">77.8</td>
            </tr>
            <tr>
              <td align="left">HMDB</td>
              <td align="center">A</td>
              <td align="center">27</td>
              <td align="center">2</td>
              <td align="center">25</td>
              <td align="center">25</td>
              <td align="center">7.4</td>
              <td align="center">7.4</td>
              <td align="center">7.4</td>
            </tr>
            <tr>
              <td align="left">MMCD</td>
              <td align="center">A</td>
              <td align="center">27</td>
              <td align="center">1</td>
              <td align="center">26</td>
              <td align="center">26</td>
              <td align="center">3.7</td>
              <td align="center">3.7</td>
              <td align="center">3.7</td>
            </tr>
            <tr>
              <td align="left">MetaboMiner-sp</td>
              <td align="center">B</td>
              <td align="center">21</td>
              <td align="center">16</td>
              <td align="center">5</td>
              <td align="center">5</td>
              <td align="center">76.2</td>
              <td align="center">76.2</td>
              <td align="center">76.2</td>
            </tr>
            <tr>
              <td align="left">MetaboMiner-all</td>
              <td align="center">B</td>
              <td align="center">21</td>
              <td align="center">12</td>
              <td align="center">9</td>
              <td align="center">2</td>
              <td align="center">85.7</td>
              <td align="center">57.1</td>
              <td align="center">68.5</td>
            </tr>
            <tr>
              <td align="left">HMDB</td>
              <td align="center">B</td>
              <td align="center">21</td>
              <td align="center">2</td>
              <td align="center">19</td>
              <td align="center">19</td>
              <td align="center">9.5</td>
              <td align="center">9.5</td>
              <td align="center">9.5</td>
            </tr>
            <tr>
              <td align="left">MMCD</td>
              <td align="center">B</td>
              <td align="center">21</td>
              <td align="center">2</td>
              <td align="center">19</td>
              <td align="center">19</td>
              <td align="center">9.5</td>
              <td align="center">9.5</td>
              <td align="center">9.5</td>
            </tr>
            <tr>
              <td align="left">MetaboMiner-sp</td>
              <td align="center">C</td>
              <td align="center">24</td>
              <td align="center">17</td>
              <td align="center">7</td>
              <td align="center">7</td>
              <td align="center">70.8</td>
              <td align="center">70.8</td>
              <td align="center">70.8</td>
            </tr>
            <tr>
              <td align="left">MetaboMiner-all</td>
              <td align="center">C</td>
              <td align="center">24</td>
              <td align="center">15</td>
              <td align="center">9</td>
              <td align="center">8</td>
              <td align="center">65.2</td>
              <td align="center">62.5</td>
              <td align="center">63.8</td>
            </tr>
            <tr>
              <td align="left">HMDB</td>
              <td align="center">C</td>
              <td align="center">24</td>
              <td align="center">4</td>
              <td align="center">20</td>
              <td align="center">20</td>
              <td align="center">16.7</td>
              <td align="center">16.7</td>
              <td align="center">16.7</td>
            </tr>
            <tr>
              <td align="left">MMCD</td>
              <td align="center">C</td>
              <td align="center">24</td>
              <td align="center">2</td>
              <td align="center">22</td>
              <td align="center">22</td>
              <td align="center">8.3</td>
              <td align="center">8.3</td>
              <td align="center">8.3</td>
            </tr>
            <tr>
              <td align="left">MetaboMiner-sp</td>
              <td align="center">D</td>
              <td align="center">35</td>
              <td align="center">30</td>
              <td align="center">5</td>
              <td align="center">5</td>
              <td align="center">85.7</td>
              <td align="center">85.7</td>
              <td align="center">85.7</td>
            </tr>
            <tr>
              <td align="left">MetaboMiner-all</td>
              <td align="center">D</td>
              <td align="center">35</td>
              <td align="center">23</td>
              <td align="center">12</td>
              <td align="center">12</td>
              <td align="center">65.7</td>
              <td align="center">65.7</td>
              <td align="center">65.7</td>
            </tr>
            <tr>
              <td align="left">HMDB</td>
              <td align="center">D</td>
              <td align="center">35</td>
              <td align="center">3</td>
              <td align="center">32</td>
              <td align="center">32</td>
              <td align="center">8.6</td>
              <td align="center">8.6</td>
              <td align="center">8.6</td>
            </tr>
            <tr>
              <td align="left">MMCD</td>
              <td align="center">D</td>
              <td align="center">35</td>
              <td align="center">2</td>
              <td align="center">33</td>
              <td align="center">33</td>
              <td align="center">5.7</td>
              <td align="center">5.7</td>
              <td align="center">5.7</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <p>Samples A, B, and C are synthetic cocktail mixtures and sample D is a plasma sample.</p>
          <p>(Annotation: MetaboMiner-sp = searched using the biofluid-specific library; MetaboMiner-all = searched using the entire spectral library; TP = true positives; FN = false negatives; FP = false positives).</p>
        </table-wrap-foot>
      </table-wrap>
    </sec>
  </sec>
  <sec>
    <title>Results</title>
    <p>Using synthetic query spectra constructed as described previously, the performance characteristics of MetaboMiner were first assessed under different levels of spectral noise. Secondly, the utility of different NMR data types were also investigated for our approach of compound identification. Finally, we evaluated MetaboMiner's performance using a total of 12 real NMR spectra collected from defined compound mixtures and a plasma sample of known composition.</p>
    <p>After creating the spectral reference libraries and calculating the uniqueness values for each peak, we first investigated the performance of the minimal signature (MS) method versus the adaptive threshold method under different types of spectral noise. As an additional comparison, the percentage match (PM) method was also included. As shown in Figure <xref ref-type="fig" rid="F5">5</xref>, the MS method performed consistently better than the PM method when missing peak and chemical shift variations are present. The adaptive threshold method appears to be most effective for data exhibiting large chemical shift variations. When chemical shift variation is negligible, as in the test with missing peak data, this method performs exactly the same as the fixed threshold method.</p>
    <p>The utility of different NMR data types was also investigated using synthetic spectra of increasing complexity. As illustrated in Figure <xref ref-type="fig" rid="F6">6</xref>, HSQC, TOCSY and <sup>13</sup>C-based methods worked very well over the full range of compound mixtures. The number of compounds in the query mixture has very little effect on their overall performance. The slight increases in F scores with increasing spectral complexity are not statistically significant. In general, MetaboMiner's performance for compound identification was best using the HSQC dataset. It is also apparent that the minimal signature method favours compound identification with HSQC spectra as these spectra tend to have more unique peaks than other types of NMR spectra. Also evident from Figure <xref ref-type="fig" rid="F6">6</xref> is the fact that MetaboMiner's performance using 1D <sup>1</sup>H data, alone, is the poorest. In contrast to the <sup>1</sup>H spectra (both 1D and 2D), it is quite clear that <sup>13</sup>C chemical shifts (even in 1D spectra) can provide sufficient information for robust compound identification. This is mainly due to the much wider chemical shift dispersion (0~200 ppm) seen in <sup>13</sup>C spectra compared to <sup>1</sup>H spectra. Most <sup>13</sup>C chemical shifts remain unique even in mixtures of 162 compounds.</p>
    <p>While <sup>13</sup>C spectra (1D and 2D) provide excellent data sets for compound identification we found that by focusing on off-diagonal peaks originating from the coupling between pairs of protons, the utility of TOCSY spectra could be greatly improved. As indicated in Figure <xref ref-type="fig" rid="F6">6</xref>, MetaboMiner's metabolite identification performance based on TOCSY spectra was better than that based on 1D <sup>13</sup>C spectra and was only slightly outperformed by <sup>13</sup>C HSQC data. These results underscore the utility of using 2D spectra in NMR-based compound identification of complex (&gt;20 compounds) mixtures.</p>
    <p>We also assessed MetaboMiner's performance on its own and against several other web services using eight experimental NMR spectra collected from four different mixtures of known composition. As indicated in Tables <xref ref-type="table" rid="T1">1</xref> and <xref ref-type="table" rid="T2">2</xref>, the best performance for MetaboMiner was obtained when a biofluid-specific reference library was used to analyze TOCSY or HSQC data. On average, MetaboMiner was able to correctly identify (recall, precision and F-measure) an average of 81% of the compounds from both TOCSY and HSQC data. When the entire spectral library (223 TOCSY, 502 HSQC) was used, the performance (F-measure) decreased by an average of 15%. Among the four web services evaluated using the same data (Table <xref ref-type="table" rid="T1">1</xref>), the SpinAssign program performs the best (F-measure = 49%) but this is still about 30% worse than MetaboMiner when it uses a biofluid-specific library and 15% worse than MetaboMiner when it uses its entire spectral library. Overall, the other web servers did not perform particularly well with average F-measures of 15–25% for HSQC data and 6–12% for TOCSY data. Both the HMDB and MMCD servers performed better when analyzing HSQC data than TOCSY data. The performance for all web servers was essentially the same regardless of whether "clean" peak lists (no noise peaks) or "raw" peak lists were used as input. Note that TOCSY mixture analysis is not currently supported by either PRIMe or BMRB.</p>
    <p>In an effort to understand the influence of pH on the efficacy of compound identification by 2D NMR, we also collected TOCSY and HSQC data at pH 4.2 and pH 8.8. This is approximately 3 pH units below (and 1.5 pH units above) the pH at which the spectral library standards were collected. As seen in Table <xref ref-type="table" rid="T3">3</xref>, a significant pH change in the sample (relative to the pH of the spectral libraries) can negatively impact the performance of compound identification. For instance, at pH 4.2, the F-measure drops by more than 20% for the HSQC spectra.</p>
    <table-wrap position="float" id="T3">
      <label>Table 3</label>
      <caption>
        <p>Performance evaluation of MetaboMiner under different pH conditions.</p>
      </caption>
      <table frame="hsides" rules="groups">
        <thead>
          <tr>
            <td align="center">
              <bold>Sample</bold>
            </td>
            <td align="center">
              <bold># Cmpds</bold>
            </td>
            <td align="center">
              <bold>NMR Exp.</bold>
            </td>
            <td align="center">
              <bold>pH</bold>
            </td>
            <td align="center">
              <bold># Correctly Identified (TP)</bold>
            </td>
            <td align="center">
              <bold>FN</bold>
            </td>
            <td align="center">
              <bold>FP</bold>
            </td>
            <td align="center">
              <bold>Precision (%)</bold>
            </td>
            <td align="center">
              <bold>Recall (%)</bold>
            </td>
            <td align="center">
              <bold>F score</bold>
            </td>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td align="center">A</td>
            <td align="center">27</td>
            <td align="center">HSQC</td>
            <td align="center">4.2</td>
            <td align="center">15</td>
            <td align="center">12</td>
            <td align="center">12</td>
            <td align="center">55.6</td>
            <td align="center">55.6</td>
            <td align="center">55.6</td>
          </tr>
          <tr>
            <td align="center">A</td>
            <td align="center">27</td>
            <td align="center">HSQC</td>
            <td align="center">7.2</td>
            <td align="center">21</td>
            <td align="center">6</td>
            <td align="center">6</td>
            <td align="center">77.8</td>
            <td align="center">77.8</td>
            <td align="center">77.8</td>
          </tr>
          <tr>
            <td align="center">A</td>
            <td align="center">27</td>
            <td align="center">TOCSY</td>
            <td align="center">4.2</td>
            <td align="center">21</td>
            <td align="center">6</td>
            <td align="center">6</td>
            <td align="center">77.8</td>
            <td align="center">77.8</td>
            <td align="center">77.8</td>
          </tr>
          <tr>
            <td align="center">A</td>
            <td align="center">27</td>
            <td align="center">TOCSY</td>
            <td align="center">7.2</td>
            <td align="center">23</td>
            <td align="center">4</td>
            <td align="center">4</td>
            <td align="center">85.2</td>
            <td align="center">85.2</td>
            <td align="center">85.2</td>
          </tr>
          <tr>
            <td align="center">D</td>
            <td align="center">35</td>
            <td align="center">HSQC</td>
            <td align="center">7.3</td>
            <td align="center">29</td>
            <td align="center">6</td>
            <td align="center">6</td>
            <td align="center">82.9</td>
            <td align="center">82.9</td>
            <td align="center">82.9</td>
          </tr>
          <tr>
            <td align="center">D</td>
            <td align="center">35</td>
            <td align="center">HSQC</td>
            <td align="center">8.8</td>
            <td align="center">24</td>
            <td align="center">11</td>
            <td align="center">4</td>
            <td align="center">85.7</td>
            <td align="center">68.6</td>
            <td align="center">76.2</td>
          </tr>
          <tr>
            <td align="center">D</td>
            <td align="center">35</td>
            <td align="center">TOCSY</td>
            <td align="center">7.3</td>
            <td align="center">30</td>
            <td align="center">5</td>
            <td align="center">5</td>
            <td align="center">85.7</td>
            <td align="center">85.7</td>
            <td align="center">85.7</td>
          </tr>
          <tr>
            <td align="center">D</td>
            <td align="center">35</td>
            <td align="center">TOCSY</td>
            <td align="center">8.8</td>
            <td align="center">25</td>
            <td align="center">10</td>
            <td align="center">6</td>
            <td align="center">80.6</td>
            <td align="center">71.4</td>
            <td align="center">75.7</td>
          </tr>
        </tbody>
      </table>
      <table-wrap-foot>
        <p>Tests were performed using biofluid-specific library.</p>
      </table-wrap-foot>
    </table-wrap>
  </sec>
  <sec>
    <title>Discussion</title>
    <p>In this paper, we described the development and assessment of a software tool (MetaboMiner) to facilitate compound identification from 2D NMR spectra of biofluids or small molecule mixtures. We first created a series of "clean" spectral reference libraries based on publicly available spectral databases. Secondly we developed and tested several algorithms to facilitate robust and automatic peak processing, peak matching and compound identification. Finally, we integrated these resources into an easy-to-use application and evaluated its performance using a variety of synthetic and real spectra.</p>
    <p>MetaboMiner's spectral reference library covers most NMR-detectable metabolites present in human biofluids [<xref ref-type="bibr" rid="B23">23</xref>]. To improve the reliability of the compound identification, the larger spectral library was further partitioned into three smaller libraries based on the composition of different biofluids (CSF, plasma and urine). In addition, we also created "common" libraries for each type of biofluid that contain the most common or abundant metabolites found in these biofluids (as ascertained from previous experience and from data contained in the HMDB). We found that the creation of biofluid-specific libraries significantly improved compound identification by reducing the spectral search space. As indicated in Tables <xref ref-type="table" rid="T1">1</xref> and <xref ref-type="table" rid="T2">2</xref>, a 15% reduction in MetaboMiner's performance occurred if the entire compound library was used instead of the biofluid-specific "common" library. For researchers who wish to study other types of biofluids, MetaboMiner provides intuitive interfaces that allow users to easily expand and customize their spectral reference libraries.</p>
    <sec>
      <title>Performance Assessment</title>
      <p>The performance of MetaboMiner was evaluated using a variety of synthetic and experimental datasets. In all cases, our strategies for peak matching and compound identification showed robust performance under various noise (real and synthetic) conditions. Using synthetic data, the best compound identification performance was ~90% (F-measure) under moderate noise levels as indicated by Figure <xref ref-type="fig" rid="F6">6</xref>. Further inspection of the compound identification lists showed that the most common problem was the identification of false positives. In particular, for certain compounds it is inherently difficult to uniquely identify them by NMR based on their matched peaks. For example, the TOCSY peaks of citrate and serine cluster very tightly around the diagonal. They also overlap with peaks of other more abundant compound species. As a result, they are often misidentified. Another source of false positives comes from the existence of structurally similar compounds such as asparagine/aspartate, inosine/adenosine, or creatine/creatinine, which have nearly identical NMR spectral features.</p>
      <p>When we assessed the performance of MetaboMiner using experimentally collected data, the performance was reduced by ~10% for both TOCSY and HSQC data. Close examination of the lists of identified compounds as well as the spectra used in the evaluation indicated two sources of problems (see Additional File <xref ref-type="supplementary-material" rid="S2">2</xref>). The first relates to the fact that several compounds known to be in the mixtures failed to be identified (false negatives). Manual inspection of the actual spectra (TOCSY or HSQC) indicated that in every case, no peaks or very weak peaks were visible for these compounds. These compounds were obviously below the detection threshold of the instrument. The second problem was the existence of several false positives. Again, manual inspection of the spectra showed that the false positives were mainly caused by spectral artefacts. Real spectra [see Additional File <xref ref-type="supplementary-material" rid="S3">3</xref>] can contain a significant amount of spectral noise. In the case of TOCSY spectra, most of the automatically picked peaks (&gt;60%) are from these artefacts. Obviously if cleaner spectra could be collected or if more manual intervention was used to eliminate some of the spectral artefacts prior to submitting the data to MetaboMiner, a better performance could be achieved. In addition, we also observed that some compounds are exquisitely sensitive to small pH variations such as lactate, uracil and histidine.</p>
    </sec>
    <sec>
      <title>Peak uniqueness and the challenges in automated compound identification</title>
      <p>There are three major challenges facing automatic compound identification for NMR-based metabolomics. The most common and perhaps the most vexing is the so-called spectral overlap problem. The spectral complexity inherent in many biofluids can lead to a large number of peaks confined to a relatively narrow chemical shift range (~10 ppm for <sup>1</sup>H spectra). With the increased availability of high-field NMR spectrometers, the problem of spectral overlap is diminished somewhat for simple biofluids such as CSF. However, for complex mixtures like plasma, urine, or tissue extracts, the problem is still quite severe. The second challenge in automated compound identification is the handling of chemical shift changes induced by the variation of pH, temperature, ionic strength, <italic>etc</italic>. This effect combined with the first issue makes it difficult to perform automated compound identification based solely on chemical shifts. The third challenge in automated compound identification is the low signal-to-noise (S/N) ratio for the NMR resonances of low abundance compound species. Consequently, the wide range of metabolite concentrations found in many biofluids poses a serious problem for most automatic peak-picking programs. In particular, many low intensities peaks are likely to be missed by most peak picking programs.</p>
      <p>To address these challenges we introduced the notion of "uniqueness" in the reference library in order to deal with the problem of missing peaks and chemical shift variations. The uniqueness values were calculated for every peak based on their relative distances to each other in a given reference library. Although a finer scale may perform better for more complex mixtures, we found that the use of five levels of uniqueness works well for most situations. In MetaboMiner, both peak matching and compound identification rely heavily on these uniqueness values. During peak matching, an adaptive threshold method was used to adjust the current search threshold to its maximum uniqueness scope. This approach significantly improves MetaboMiner's performance when chemical shift variations are nontrivial. By using an adaptive threshold method we found the effect of chemical shift changes or chemical shift drift could be tolerated to a greater extent. These uniqueness values also allow us to derive minimal signatures based on a relatively small portion of unique peaks. This approach turned out to be both robust and flexible since it did not require "stable" spectral patterns. In contrast, the common percentage match (PM) method weights each peak equally and uses a fixed threshold for compound identification. This approach suffers greatly if a nontrivial proportion of peaks are not matched. Note that the minimal signature method in MetaboMiner is complemented by authenticity checks with due consideration of the total matched patterns.</p>
      <p>It should be noted that the performance of MetaboMiner strongly depends on the quality of the upstream spectral collection and processing work. As a general rule, for optimal performance, the NMR experiments on biofluid mixtures should be carried out under the same (or at least similar) conditions as the conditions used to collect the spectra for the reference library (i.e. neutral pH). The automatic peak-picking process should be closely monitored and an iterative approach is recommended in order to pick up most signals while avoiding obvious spectral noise. In our testing process, a typical TOCSY spectrum usually generated 2,000~3,000 peaks with a high proportion of noise peaks. We found that these noisy signals were handled quite efficiently by MetaboMiner. As a general rule, we would suggest that users employ a low threshold during the peak picking stage for TOCSY spectra. For HSQC spectra, because of the difficulty associated with detecting and removing noisy signals, we would suggest more manual intervention during the peak picking process.</p>
    </sec>
    <sec>
      <title>Comparison to other spectral analysis software tools</title>
      <p>There are several commercial software tools available for analysing complex metabolite mixtures using NMR. Chenomx <italic>Inc</italic>. has developed a commercial bioprofiling software package called the Chenomx NMR Suite that allows semi-automated identification of compounds from 1D <sup>1</sup>H NMR spectra. The Chenomx software package provides an excellent interface for compound identification and quantification via a manual peak-fitting process using a spectra reference library containing 260 compounds [<xref ref-type="bibr" rid="B12">12</xref>]. However, the requirement for manual fitting and analysis leaves the process open to inconsistent interpretation or inconsistent assignment by different individuals. Furthermore, the analysis can take upwards of one hour per sample and the software is relatively expensive. Bruker's AMIX (Bruker BioSpin) software is another powerful tool that offers support for compound identification and quantification for 1D and 2D NMR as well as LC-MS spectra. It used a method called AutoDROP to facilitate compound identification and structure verification [<xref ref-type="bibr" rid="B30">30</xref>]. The key idea is the systematic decomposition of reference spectra into spectral patterns of molecular fragments. Compound identification is based on recognition of such patterns in the target spectra. However, similar limitations pertaining to cost, the reliance on manual analysis, processing time and inconsistent interpretation appear to apply to AMIX as well.</p>
      <p>In addition to these commercial packages there is at least one other non-commercial system that has been described. Xi <italic>et. al </italic>[<xref ref-type="bibr" rid="B24">24</xref>] developed a statistical and chemical model for automatically identifying compounds in mixtures using 2D COSY spectra. Like MetaboMiner, the Chenomx NMR Suite and AMIX, Xi <italic>et al</italic>'s method uses a library of pre-collected NMR spectra to assist with compound identification. These authors reported experimental results using spectra collected from abalone muscle and digestive gland extracts. Their method was able to identify 12 out of 15 amino acids and 6 out of 9 amino acids as determined with Chenomx's NMR Suite. However, it appears that this system has a spectral library of only 19 COSY spectra, so it is very limited in terms of practical applications.</p>
      <p>In addition to these stand-alone, graphically based software packages, several metabolomics database websites, including the HMDB [<xref ref-type="bibr" rid="B23">23</xref>], MMCD [<xref ref-type="bibr" rid="B25">25</xref>], BMRB [<xref ref-type="bibr" rid="B24">24</xref>], and PRIMe now allow direct querying of their databases using peak lists obtained from compound mixtures. However, as web servers they are somewhat limited in their graphic capabilities and user-interface interactions. In particular, most of these sites typically return long lists of potentially matched compounds without a graphic display of the matched spectra to help users make their decisions. Further, most of the servers appear to be designed to handle single compound or simple mixture queries and are not optimized for compound identification from complex biofluid mixtures. This is particularly evident from the results shown in Tables <xref ref-type="table" rid="T1">1</xref> and <xref ref-type="table" rid="T2">2</xref>. The modest performance for the MMCD and BMRB servers with regard to their handling of HSQC spectra may be partially due to the pH and solvent differences between the query spectra and their internal reference spectra (pH 7.0–7.2 in H<sub>2</sub>O vs. pH 7.4 in D<sub>2</sub>O), however these pH differences are relatively small and should not have affected the identification of most compounds. Furthermore, the fact that the same level of performance was seen with TOCSY queries where MetaboMiner, BMRB and MMCD used the same set of reference spectra and had the same pH mistmatch suggests that the performance differences are likely related to algorithmic robustness. Likewise the relatively good performance of the PRIMe server is likely due to the fact that it only contains spectra for 80 common compounds. This significantly reduces the number of false positives and somewhat inflates its overall performance.</p>
      <p>Overall, MetaboMiner combines many of the useful interactive graphic features and high levels of performance of the stand-alone commercial packages such as Bruker's AMIX and Chenomx's NMR Suite with the relatively simple automation or semi-automation seen with NMR-based metabolomics web servers. Key to MetaboMiner's success are its large and carefully constructed spectral libraries, its robust spectral filtering and peak matching routines, and its use of biofluid-specific spectral libraries to rationally limit the spectral search space. Given the extensive testing and the availability of many built-in tools for spectral manipulation, viewing and annotation we believe MetaboMiner is well designed and ready for practical metabolomics applications.</p>
    </sec>
  </sec>
  <sec>
    <title>Limitations</title>
    <p>MetaboMiner is not without its limitations. In particular, MetaboMiner does not support compound quantification. Efforts are underway to add this functionality to the program but it appears that quantification via 2D NMR spectra is intrinsically more difficult and less reliable than with 1D NMR spectra. Lewis et al. [<xref ref-type="bibr" rid="B31">31</xref>] recently described a quantification method for HSQC spectra using standard curves calibrated to unique or selected peaks of a given compound. Quantification by TOCSY still remains difficult because the magnetization transfer functions for complex spin systems can differ greatly between metabolites. This can lead to widely different peak intensities. Another limitation to MetaboMiner (which is also shared by other NMR analysis programs such as Chenomx's NMR Suite and Bruker's AMIX) is the fact that MetaboMiner's performance is highly dependent on the spectral quality and spectral pre-processing of the query (i.e. experimental) spectra. High signal-to-noise, good phasing, minimal baseline distortion and the elimination of spectral artefacts will always improve the performance. However, some biofluid samples may be refractory to good spectral processing or some users may lack sufficient experience/skill to properly process their spectra. Under these circumstances, MetaboMiner's results may prove to be unreliable or non-reproducible. Overall, the performance for MetaboMiner (and even for human experts) degrades as the signal-to-noise ratio for the peaks of any given compound drops below 3:1. The lower limit of detection on our 500 MHz instrument for TOCSY data was about 50 mM and about 100 mM for HSQC data. A third limitation to MetaboMiner is its limited sensitivity. In particular, MetaboMiner's exclusive reliance on 2D NMR spectra generally reduces its sensitivity limit by a factor of ~10 over what might be detected via 1D spectrum. Obviously the use of more concentrated samples, longer collection times or isotopic labelled samples can overcome these problems, but the trade-off between time, cost and convenience may not always be in MetaboMiner's favour. It is worth noting that Methods such as ASAP HMQC [<xref ref-type="bibr" rid="B32">32</xref>] now allow very rapid acquisition of 2D NMR data. This may make the issues of sensitivity and time much less important, particularly for 2D heteronuclear experiments. A fourth limitation is that fact that MetaboMiner's spectral libraries (esp. the TOCSY library) are still missing a number of important compounds. Efforts are underway to expand the TOCSY library over the coming months and the MetaboMiner website will provide periodic reference spectral updates. Alternately, users are invited (and encouraged) to add their own spectra to MetaboMiner's reference libraries. Finally, unlike Chenomx's NMR Suite and Bruker's AMIX, MetaboMiner's spectral libraries do not cover a broad range of pH values. As a result, MetaboMiner is largely restricted to analyzing spectra from biofluids or metabolite mixtures that are titrated to pH 7.0 +/- 0.5.</p>
  </sec>
  <sec>
    <title>Conclusion</title>
    <p>In this paper we have demonstrated that by utilizing the extra information found in 2D NMR spectra as well as prior knowledge about the composition of the biofluid itself, it is possible to semi-automatically identify a significant number of compounds in complex aqueous mixtures (both defined mixtures and biofluids) with excellent (&gt;80%) accuracy. In particular, the quality and degree of metabolite identification achieved by MetaboMiner certainly matches that of what a skilled NMR spectroscopist could do – but in significantly less time. Overall, we have shown that by using a comprehensive reference library coupled with robust algorithms for peak processing, peak matching and compound identification, the process of metabolite identification from 2D NMR spectra can be greatly simplified.</p>
  </sec>
  <sec>
    <title>Availability and requirements</title>
    <p>Project name: MetaboMiner</p>
    <p>Project home page: <ext-link ext-link-type="uri" xlink:href="http://wishart.biology.ualberta.ca/metabominer"/></p>
    <p>Operating system: Platform independent</p>
    <p>Programming language: Java</p>
    <p>Other requirements: Java 1.5 or higher</p>
    <p>License: GPL</p>
  </sec>
  <sec>
    <title>Abbreviations</title>
    <p>CSF: cerebrospinal fluid; DSS: 2, 2-Dimethyl-2-silapentane-5-sulfonic acid; GUI: graphic user interface; HPLC: high performance liquid chromatography; HSQC: heteronuclear single quantum correlation spectroscopy; MS: mass spectrometry; NMR: nuclear magnetic resonance; PNG: portable network graphics; ppm: parts per million; TOCSY: total correlation spectroscopy; TSP: trimethylsilyl-2, 2, 3, 3-tetradeuteropropionic acid; UPLC: ultra-high performance liquid chromatography; GC-MS: gas chromatography mass spectrometry; LC-MS: liquid chromatography mass spectrometry.</p>
  </sec>
  <sec>
    <title>Authors' contributions</title>
    <p>JX carried out the software design, implementation, and drafted the manuscript. TB participated in generating 2D experimental data. PT participated in the implementation of the user interfaces and evaluated the software. DSW conceived of the study, participated in the creation of spectral library and implementation of search algorithm, edited the manuscript and reviewed the software. All authors read and approved the manuscript.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="S1">
      <caption>
        <title>Additional file 1</title>
        <p>
          <bold>Supplemental figure 1</bold>
        </p>
      </caption>
      <media xlink:href="1471-2105-9-507-S1.png" mimetype="image" mime-subtype="png">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="S2">
      <caption>
        <title>Additional file 2</title>
        <p>
          <bold>Synthetic mixture information</bold>
        </p>
      </caption>
      <media xlink:href="1471-2105-9-507-S2.xls" mimetype="application" mime-subtype="vnd.ms-excel">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="S3">
      <caption>
        <title>Additional file 3</title>
        <p>
          <bold>Supplemental figure 2</bold>
        </p>
      </caption>
      <media xlink:href="1471-2105-9-507-S3.png" mimetype="image" mime-subtype="png">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <sec>
      <title>Acknowledgements</title>
      <p>We would like to thank the Canadian National High Field NMR Centre (NANUC) for their assistance and use of the facilities. We also wish to thank the reviewers for their helpful comments on improving this paper. The project is supported by the Alberta Ingenuity Fund, Alberta Advanced Education and Technology and by Genome Alberta.</p>
    </sec>
  </ack>
  <ref-list>
    <ref id="B1">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fiehn</surname>
            <given-names>O</given-names>
          </name>
        </person-group>
        <article-title>Metabolomics – the link between genotypes and phenotypes</article-title>
        <source>Plant Mol Biol</source>
        <year>2002</year>
        <volume>48</volume>
        <fpage>155</fpage>
        <lpage>171</lpage>
        <pub-id pub-id-type="pmid">11860207</pub-id>
        <pub-id pub-id-type="doi">10.1023/A:1013713905833</pub-id>
      </citation>
    </ref>
    <ref id="B2">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nicholson</surname>
            <given-names>JK</given-names>
          </name>
          <name>
            <surname>Connelly</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Lindon</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Holmes</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>Metabonomics: a platform for studying drug toxicity and gene function</article-title>
        <source>Nat Rev Drug Discov</source>
        <year>2002</year>
        <volume>1</volume>
        <fpage>153</fpage>
        <lpage>161</lpage>
        <pub-id pub-id-type="pmid">12120097</pub-id>
        <pub-id pub-id-type="doi">10.1038/nrd728</pub-id>
      </citation>
    </ref>
    <ref id="B3">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Goodacre</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Vaidyanathan</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Dunn</surname>
            <given-names>WB</given-names>
          </name>
          <name>
            <surname>Harrigan</surname>
            <given-names>GG</given-names>
          </name>
          <name>
            <surname>Kell</surname>
            <given-names>DB</given-names>
          </name>
        </person-group>
        <article-title>Metabolomics by numbers: acquiring and understanding global metabolite data</article-title>
        <source>Trends Biotechnol</source>
        <year>2004</year>
        <volume>22</volume>
        <fpage>245</fpage>
        <lpage>252</lpage>
        <pub-id pub-id-type="pmid">15109811</pub-id>
        <pub-id pub-id-type="doi">10.1016/j.tibtech.2004.03.007</pub-id>
      </citation>
    </ref>
    <ref id="B4">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nicholson</surname>
            <given-names>JK</given-names>
          </name>
          <name>
            <surname>Lindon</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Holmes</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>'Metabonomics': understanding the metabolic responses of living systems to pathophysiological stimuli via multivariate statistical analysis of biological NMR spectroscopic data</article-title>
        <source>Xenobiotica</source>
        <year>1999</year>
        <volume>29</volume>
        <fpage>1181</fpage>
        <lpage>1189</lpage>
        <pub-id pub-id-type="pmid">10598751</pub-id>
        <pub-id pub-id-type="doi">10.1080/004982599238047</pub-id>
      </citation>
    </ref>
    <ref id="B5">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Crockford</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>Keun</surname>
            <given-names>HC</given-names>
          </name>
          <name>
            <surname>Smith</surname>
            <given-names>LM</given-names>
          </name>
          <name>
            <surname>Holmes</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Nicholson</surname>
            <given-names>JK</given-names>
          </name>
        </person-group>
        <article-title>Curve-fitting method for direct quantitation of compounds in complex biological mixtures using 1H NMR: application in metabonomic toxicology studies</article-title>
        <source>Anal Chem</source>
        <year>2005</year>
        <volume>77</volume>
        <fpage>4556</fpage>
        <lpage>4562</lpage>
        <pub-id pub-id-type="pmid">16013873</pub-id>
        <pub-id pub-id-type="doi">10.1021/ac0503456</pub-id>
      </citation>
    </ref>
    <ref id="B6">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Viant</surname>
            <given-names>MR</given-names>
          </name>
          <name>
            <surname>Rosenblum</surname>
            <given-names>ES</given-names>
          </name>
          <name>
            <surname>Tieerdema</surname>
            <given-names>RS</given-names>
          </name>
        </person-group>
        <article-title>NMR-based metabolomics: a powerful approach for characterizing the effects of environmental stressors on organism health</article-title>
        <source>Environ Sci Technol</source>
        <year>2003</year>
        <volume>37</volume>
        <fpage>4982</fpage>
        <lpage>4989</lpage>
        <pub-id pub-id-type="pmid">14620827</pub-id>
        <pub-id pub-id-type="doi">10.1021/es034281x</pub-id>
      </citation>
    </ref>
    <ref id="B7">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cerdan</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Kunnecke</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Seelig</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Cerebral metabolism of [1,2-13C2]acetate as detected by in vivo and in vitro 13C NMR</article-title>
        <source>J Biol Chem</source>
        <year>1990</year>
        <volume>265</volume>
        <fpage>12916</fpage>
        <lpage>12926</lpage>
        <pub-id pub-id-type="pmid">1973931</pub-id>
      </citation>
    </ref>
    <ref id="B8">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Artemov</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Bhujwalla</surname>
            <given-names>ZM</given-names>
          </name>
          <name>
            <surname>Pilatus</surname>
            <given-names>U</given-names>
          </name>
          <name>
            <surname>Glickson</surname>
            <given-names>JD</given-names>
          </name>
        </person-group>
        <article-title>Two-compartment model for determination of glycolytic rates of solid tumors by in vivo 13C NMR spectroscopy</article-title>
        <source>NMR Biomed</source>
        <year>1998</year>
        <volume>11</volume>
        <fpage>395</fpage>
        <lpage>404</lpage>
        <pub-id pub-id-type="pmid">10221582</pub-id>
        <pub-id pub-id-type="doi">10.1002/(SICI)1099-1492(199812)11:8&lt;395::AID-NBM536&gt;3.0.CO;2-R</pub-id>
      </citation>
    </ref>
    <ref id="B9">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Miccheli</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Tomassini</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Puccetti</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Valerio</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Peluso</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Tuccillo</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Calvani</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Manetti</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Conti</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>Metabolic profiling by 13C-NMR spectroscopy: [1,2-13C2]glucose reveals a heterogeneous metabolism in human leukemia T cells</article-title>
        <source>Biochimie</source>
        <year>2006</year>
        <volume>88</volume>
        <fpage>437</fpage>
        <lpage>448</lpage>
        <pub-id pub-id-type="pmid">16359766</pub-id>
        <pub-id pub-id-type="doi">10.1016/j.biochi.2005.10.004</pub-id>
      </citation>
    </ref>
    <ref id="B10">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Viant</surname>
            <given-names>MR</given-names>
          </name>
          <name>
            <surname>Pincetich</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Hinton</surname>
            <given-names>DE</given-names>
          </name>
          <name>
            <surname>Tjeerdema</surname>
            <given-names>RS</given-names>
          </name>
        </person-group>
        <article-title>Toxic actions of dinoseb in medaka (Oryzias latipes) embryos as determined by in vivo 31P NMR, HPLC-UV and 1H NMR metabolomics</article-title>
        <source>Aquat Toxicol</source>
        <year>2006</year>
        <volume>76</volume>
        <fpage>329</fpage>
        <lpage>342</lpage>
        <pub-id pub-id-type="pmid">16290222</pub-id>
        <pub-id pub-id-type="doi">10.1016/j.aquatox.2005.10.007</pub-id>
      </citation>
    </ref>
    <ref id="B11">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Griffin</surname>
            <given-names>JL</given-names>
          </name>
        </person-group>
        <article-title>Metabonomics: NMR spectroscopy and pattern recognition analysis of body fluids and tissues for characterisation of xenobiotic toxicity and disease diagnosis</article-title>
        <source>Curr Opin Chem Biol</source>
        <year>2003</year>
        <volume>7</volume>
        <fpage>648</fpage>
        <lpage>654</lpage>
        <pub-id pub-id-type="pmid">14580571</pub-id>
        <pub-id pub-id-type="doi">10.1016/j.cbpa.2003.08.008</pub-id>
      </citation>
    </ref>
    <ref id="B12">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Weljie</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Newton</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Mercier</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Carlson</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Slupsky</surname>
            <given-names>CM</given-names>
          </name>
        </person-group>
        <article-title>Targeted profiling: quantitative analysis of 1H NMR metabolomics data</article-title>
        <source>Anal Chem</source>
        <year>2006</year>
        <volume>78</volume>
        <fpage>4430</fpage>
        <lpage>4442</lpage>
        <pub-id pub-id-type="pmid">16808451</pub-id>
        <pub-id pub-id-type="doi">10.1021/ac060209g</pub-id>
      </citation>
    </ref>
    <ref id="B13">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Holmes</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Antti</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Chemometric contributions to the evolution of metabonomics: mathematical solutions to characterising and interpreting complex biological NMR spectra</article-title>
        <source>Analyst</source>
        <year>2002</year>
        <volume>127</volume>
        <fpage>1549</fpage>
        <lpage>1557</lpage>
        <pub-id pub-id-type="pmid">12537357</pub-id>
        <pub-id pub-id-type="doi">10.1039/b208254n</pub-id>
      </citation>
    </ref>
    <ref id="B14">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schroeder</surname>
            <given-names>FC</given-names>
          </name>
          <name>
            <surname>Gibson</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>Churchill</surname>
            <given-names>AC</given-names>
          </name>
          <name>
            <surname>Sojikul</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Wursthorn</surname>
            <given-names>EJ</given-names>
          </name>
          <name>
            <surname>Krasnoff</surname>
            <given-names>SB</given-names>
          </name>
          <name>
            <surname>Clardy</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Differential analysis of 2D NMR spectra: new natural products from a pilot-scale fungal extract library</article-title>
        <source>Angew Chem Int Ed Engl</source>
        <year>2007</year>
        <volume>46</volume>
        <fpage>901</fpage>
        <lpage>904</lpage>
        <pub-id pub-id-type="pmid">17183517</pub-id>
        <pub-id pub-id-type="doi">10.1002/anie.200603821</pub-id>
      </citation>
    </ref>
    <ref id="B15">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Barrere</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Peres</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Gillet</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Mergui</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Beloeil</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Seylaz</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>2D COSY 1H NMR: a new tool for studying in situ brain metabolism in the living animal</article-title>
        <source>FEBS Lett</source>
        <year>1990</year>
        <volume>264</volume>
        <fpage>198</fpage>
        <lpage>202</lpage>
        <pub-id pub-id-type="pmid">2358067</pub-id>
        <pub-id pub-id-type="doi">10.1016/0014-5793(90)80247-G</pub-id>
      </citation>
    </ref>
    <ref id="B16">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sandusky</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Raftery</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Use of selective TOCSY NMR experiments for quantifying minor components in complex mixtures: application to the metabonomics of amino acids in honey</article-title>
        <source>Anal Chem</source>
        <year>2005</year>
        <volume>77</volume>
        <fpage>2455</fpage>
        <lpage>2463</lpage>
        <pub-id pub-id-type="pmid">15828781</pub-id>
        <pub-id pub-id-type="doi">10.1021/ac0484979</pub-id>
      </citation>
    </ref>
    <ref id="B17">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Massou</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Nicolas</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Letisse</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Portais</surname>
            <given-names>JC</given-names>
          </name>
        </person-group>
        <article-title>Application of 2D-TOCSY NMR to the measurement of specific(13C-enrichments in complex mixtures of 13C-labeled metabolites</article-title>
        <source>Metab Eng</source>
        <year>2007</year>
        <volume>9</volume>
        <fpage>252</fpage>
        <lpage>257</lpage>
        <pub-id pub-id-type="pmid">17482860</pub-id>
        <pub-id pub-id-type="doi">10.1016/j.ymben.2007.03.001</pub-id>
      </citation>
    </ref>
    <ref id="B18">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kikuchi</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Shinozaki</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Hirayama</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Stable isotope labeling of Arabidopsis thaliana for an NMR-based metabolomics approach</article-title>
        <source>Plant Cell Physiol</source>
        <year>2004</year>
        <volume>45</volume>
        <fpage>1099</fpage>
        <lpage>1104</lpage>
        <pub-id pub-id-type="pmid">15356336</pub-id>
        <pub-id pub-id-type="doi">10.1093/pcp/pch117</pub-id>
      </citation>
    </ref>
    <ref id="B19">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Xi</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>de Ropp</surname>
            <given-names>JS</given-names>
          </name>
          <name>
            <surname>Viant</surname>
            <given-names>MR</given-names>
          </name>
          <name>
            <surname>Woodruff</surname>
            <given-names>DL</given-names>
          </name>
          <name>
            <surname>Yu</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Improved identification of metabolites in complex mixtures using HSQC NMR spectroscopy</article-title>
        <source>Anal Chim Acta</source>
        <year>2008</year>
        <volume>614</volume>
        <fpage>127</fpage>
        <lpage>133</lpage>
        <pub-id pub-id-type="pmid">18420042</pub-id>
        <pub-id pub-id-type="doi">10.1016/j.aca.2008.03.024</pub-id>
      </citation>
    </ref>
    <ref id="B20">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ward</surname>
            <given-names>JL</given-names>
          </name>
          <name>
            <surname>Baker</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Beale</surname>
            <given-names>MH</given-names>
          </name>
        </person-group>
        <article-title>Recent applications of NMR spectroscopy in plant metabolomics</article-title>
        <source>Febs J</source>
        <year>2007</year>
        <volume>274</volume>
        <fpage>1126</fpage>
        <lpage>1131</lpage>
        <pub-id pub-id-type="pmid">17298436</pub-id>
        <pub-id pub-id-type="doi">10.1111/j.1742-4658.2007.05675.x</pub-id>
      </citation>
    </ref>
    <ref id="B21">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Bollard</surname>
            <given-names>ME</given-names>
          </name>
          <name>
            <surname>Keun</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Antti</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Beckonert</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Ebbels</surname>
            <given-names>TM</given-names>
          </name>
          <name>
            <surname>Lindon</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Holmes</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Tang</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Nicholson</surname>
            <given-names>JK</given-names>
          </name>
        </person-group>
        <article-title>Spectral editing and pattern recognition methods applied to high-resolution magic-angle spinning 1H nuclear magnetic resonance spectroscopy of liver tissues</article-title>
        <source>Anal Biochem</source>
        <year>2003</year>
        <volume>323</volume>
        <fpage>26</fpage>
        <lpage>32</lpage>
        <pub-id pub-id-type="pmid">14622955</pub-id>
        <pub-id pub-id-type="doi">10.1016/j.ab.2003.07.026</pub-id>
      </citation>
    </ref>
    <ref id="B22">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Viant</surname>
            <given-names>MR</given-names>
          </name>
        </person-group>
        <article-title>Improved methods for the acquisition and interpretation of NMR metabolomic data</article-title>
        <source>Biochem Biophys Res Commun</source>
        <year>2003</year>
        <volume>310</volume>
        <fpage>943</fpage>
        <lpage>948</lpage>
        <pub-id pub-id-type="pmid">14550295</pub-id>
        <pub-id pub-id-type="doi">10.1016/j.bbrc.2003.09.092</pub-id>
      </citation>
    </ref>
    <ref id="B23">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wishart</surname>
            <given-names>DS</given-names>
          </name>
          <name>
            <surname>Tzur</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Knox</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Eisner</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Guo</surname>
            <given-names>AC</given-names>
          </name>
          <name>
            <surname>Young</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Cheng</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Jewell</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Arndt</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Sawhney</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>HMDB: the Human Metabolome Database</article-title>
        <source>Nucleic Acids Res</source>
        <year>2007</year>
        <fpage>D521</fpage>
        <lpage>526</lpage>
        <pub-id pub-id-type="pmid">17202168</pub-id>
        <pub-id pub-id-type="doi">10.1093/nar/gkl923</pub-id>
      </citation>
    </ref>
    <ref id="B24">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Seavey</surname>
            <given-names>BR</given-names>
          </name>
          <name>
            <surname>Farr</surname>
            <given-names>EA</given-names>
          </name>
          <name>
            <surname>Westler</surname>
            <given-names>WM</given-names>
          </name>
          <name>
            <surname>Markley</surname>
            <given-names>JL</given-names>
          </name>
        </person-group>
        <article-title>A relational database for sequence-specific protein NMR data</article-title>
        <source>J Biomol NMR</source>
        <year>1991</year>
        <volume>1</volume>
        <fpage>217</fpage>
        <lpage>236</lpage>
        <pub-id pub-id-type="pmid">1841696</pub-id>
        <pub-id pub-id-type="doi">10.1007/BF01875516</pub-id>
      </citation>
    </ref>
    <ref id="B25">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cui</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Lewis</surname>
            <given-names>IA</given-names>
          </name>
          <name>
            <surname>Hegeman</surname>
            <given-names>AD</given-names>
          </name>
          <name>
            <surname>Anderson</surname>
            <given-names>ME</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Schulte</surname>
            <given-names>CF</given-names>
          </name>
          <name>
            <surname>Westler</surname>
            <given-names>WM</given-names>
          </name>
          <name>
            <surname>Eghbalnia</surname>
            <given-names>HR</given-names>
          </name>
          <name>
            <surname>Sussman</surname>
            <given-names>MR</given-names>
          </name>
          <name>
            <surname>Markley</surname>
            <given-names>JL</given-names>
          </name>
        </person-group>
        <article-title>Metabolite identification via the Madison Metabolomics Consortium Database</article-title>
        <source>Nat Biotechnol</source>
        <year>2008</year>
        <volume>26</volume>
        <fpage>162</fpage>
        <lpage>164</lpage>
        <pub-id pub-id-type="pmid">18259166</pub-id>
        <pub-id pub-id-type="doi">10.1038/nbt0208-162</pub-id>
      </citation>
    </ref>
    <ref id="B26">
      <citation citation-type="other">
        <person-group person-group-type="author">
          <name>
            <surname>Lundberg</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Vogel</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Malusek</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>P-O</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Cohen</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Dahlqvist</surname>
            <given-names>O</given-names>
          </name>
        </person-group>
        <article-title>MDL – The Magnetic Resonance Metabolomics Database (mdl.imv.liu.se)</article-title>
        <source>ESMRMB, Basel, Switzerland</source>
        <year>2005</year>
      </citation>
    </ref>
    <ref id="B27">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Delaglio</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Grzesiek</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Vuister</surname>
            <given-names>GW</given-names>
          </name>
          <name>
            <surname>Zhu</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Pfeifer</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Bax</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>NMRPipe: a multidimensional spectral processing system based on UNIX pipes</article-title>
        <source>J Biomol NMR</source>
        <year>1995</year>
        <volume>6</volume>
        <fpage>277</fpage>
        <lpage>293</lpage>
        <pub-id pub-id-type="pmid">8520220</pub-id>
        <pub-id pub-id-type="doi">10.1007/BF00197809</pub-id>
      </citation>
    </ref>
    <ref id="B28">
      <citation citation-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Goddard</surname>
            <given-names>TD</given-names>
          </name>
          <name>
            <surname>Kneller</surname>
            <given-names>DG</given-names>
          </name>
        </person-group>
        <source>SPARKY 3</source>
        <year>2006</year>
        <publisher-name>University of California, San Francisco</publisher-name>
      </citation>
    </ref>
    <ref id="B29">
      <citation citation-type="other">
        <person-group person-group-type="author">
          <name>
            <surname>Chikayama</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Sekiyama</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Hirayama</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Saito</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Shinozaki</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Kikuchi</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>SpinAssign: an Integrated Spectrum Analysis System for a Hetero-nuclear NMR-based Metabomics</article-title>
        <source>47th ENC Conference, Pacific Grove</source>
        <year>2006</year>
      </citation>
    </ref>
    <ref id="B30">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rosse</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Neidig</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Schroder</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Automated structure verification of small molecules libraries using 1D and 2D NMR techniques</article-title>
        <source>Methods Mol Biol</source>
        <year>2002</year>
        <volume>201</volume>
        <fpage>123</fpage>
        <lpage>139</lpage>
        <pub-id pub-id-type="pmid">12357922</pub-id>
      </citation>
    </ref>
    <ref id="B31">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lewis</surname>
            <given-names>IA</given-names>
          </name>
          <name>
            <surname>Schommer</surname>
            <given-names>SC</given-names>
          </name>
          <name>
            <surname>Hodis</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Robb</surname>
            <given-names>KA</given-names>
          </name>
          <name>
            <surname>Tonelli</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Westler</surname>
            <given-names>WM</given-names>
          </name>
          <name>
            <surname>Sussman</surname>
            <given-names>MR</given-names>
          </name>
          <name>
            <surname>Markley</surname>
            <given-names>JL</given-names>
          </name>
        </person-group>
        <article-title>Method for determining molar concentrations of metabolites in complex solutions from two-dimensional 1H-13C NMR spectra</article-title>
        <source>Anal Chem</source>
        <year>2007</year>
        <volume>79</volume>
        <fpage>9385</fpage>
        <lpage>9390</lpage>
        <pub-id pub-id-type="pmid">17985927</pub-id>
        <pub-id pub-id-type="doi">10.1021/ac071583z</pub-id>
      </citation>
    </ref>
    <ref id="B32">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kupce</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Freeman</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Fast multidimensional NMR by polarization sharing</article-title>
        <source>Magn Reson Chem</source>
        <year>2007</year>
        <volume>45</volume>
        <fpage>2</fpage>
        <lpage>4</lpage>
        <pub-id pub-id-type="pmid">17125135</pub-id>
        <pub-id pub-id-type="doi">10.1002/mrc.1931</pub-id>
      </citation>
    </ref>
  </ref-list>
</back>
