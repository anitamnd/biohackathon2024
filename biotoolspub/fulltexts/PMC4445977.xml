<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">4445977</article-id>
    <article-id pub-id-type="pmid">26017358</article-id>
    <article-id pub-id-type="publisher-id">598</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-015-0598-9</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>MANTIS: an R package that simulates multilocus models of pathogen evolution</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Lourenço</surname>
          <given-names>José</given-names>
        </name>
        <address>
          <email>jose.lourenco@zoo.ox.ac.uk</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wikramaratna</surname>
          <given-names>Paul S</given-names>
        </name>
        <address>
          <email>paul.wikramaratna@ed.ac.uk</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Gupta</surname>
          <given-names>Sunetra</given-names>
        </name>
        <address>
          <email>sunetra.gupta@zoo.ox.ac.uk</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <aff id="Aff1"><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 1936 8948</institution-id><institution-id institution-id-type="GRID">grid.4991.5</institution-id><institution>Department of Zoology, </institution><institution>University of Oxford, </institution></institution-wrap>South Parks Road, Oxford, UK </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>28</day>
      <month>5</month>
      <year>2015</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2015</year>
    </pub-date>
    <volume>16</volume>
    <elocation-id>176</elocation-id>
    <history>
      <date date-type="received">
        <day>3</day>
        <month>2</month>
        <year>2015</year>
      </date>
      <date date-type="accepted">
        <day>27</day>
        <month>4</month>
        <year>2015</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© Lourenço et al.; licensee BioMed Central. 2015</copyright-statement>
      <license license-type="open-access">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0">http://creativecommons.org/licenses/by/4.0</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly credited. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p>In host-pathogen systems the development of immunity by the host places pressure on pathogens, by setting up competition between genetic variants due to the establishment of cross-protective responses. These pressures can lead to pathogen-specific, ubiquitous dynamic behaviours. Understanding the evolutionary forces that shape these patterns is one of the key goals of computationally simulated epidemiological models. Despite the contribution of such research methods in recent years to our current understanding of pathogen evolution, the availability of free software tools for the general public remains scarce.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p>We developed the <bold>M</bold>ultilocus <bold>ANTI</bold>genic <bold>S</bold>imulator (MANTIS) software package for the R statistical environment. MANTIS can simulate and analyse epidemiological time-series generated under the biological assumptions of the strain theory of host-pathogen systems by Gupta et al.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p>MANTIS wraps a C/C++ ordinary-differential equations system and Runge-Kutta solver into a set of user-friendly R functions. These include routines to numerically simulate the system and others to analyse, visualize and export results. For this, the package offers its own set of time-series plotting and exportation functions. MANTIS’s main goal is to serve as a free, ready-to-use academic software tool. Its open source nature further provides an opportunity for users with advanced programming skills to expand its capabilities. Here, we describe the background theory, implementation, basic functionality and usage of this package. MANTIS is freely available from http://www.eeid.ox.ac.uk/mantisunder the GPL license.</p>
      </sec>
      <sec>
        <title>Electronic supplementary material</title>
        <p>The online version of this article (doi:10.1186/s12859-015-0598-9) contains supplementary material, which is available to authorized users.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Multilocus</kwd>
      <kwd>Pathogen</kwd>
      <kwd>Evolution</kwd>
      <kwd>Model</kwd>
      <kwd>R package</kwd>
    </kwd-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2015</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p>Epidemics of an infectious agent can be triggered by its introduction into a naive host-population, or by the evolution of novel antigenic types (strains) that evade herd-immunity created by circulating predecessors. The influenza A virus provides a much studied example: its surface proteins (antigens) are under strong selection by host immune responses and their molecular evolutionary shifts trigger recurrent epidemics and occasional pandemics [<xref ref-type="bibr" rid="CR1">1</xref>,<xref ref-type="bibr" rid="CR2">2</xref>]. In this context, a strain may be defined simply by the genetic loci that encode the antigens against which immune responses act, rather than by its entire genome. These potentially highly polymorphic sites may also be ranked by the degree to which the associated immune response influences the reproductive success of other strains [<xref ref-type="bibr" rid="CR3">3</xref>,<xref ref-type="bibr" rid="CR4">4</xref>].</p>
    <p>The effects of immunity on pathogen evolution are best understood in the context of the ecology of host-pathogen systems: the development of immune responses to a pathogen alters the availability of the host as a resource for other pathogens which are targeted by similar responses. The outcome of this process of immune selection depends on the relative efficacy of immune responses against conserved and variable antigens, which in combination may prevent transmission by immune interference, resulting in the survival of a limited number of strains that may vary in time and space. For instance, many common childhood infectious diseases, such measles, mumps and whooping cough (pertussis), elicit strong immunity to conserved antigens, often leading to lifelong protection from future challenges. By contrast, protective immunity to conserved targets is either ineffective or is slow to develop against a number of other human pathogens such as the <italic>Plasmodium falciparum</italic> parasite (a causative agent of malaria) [<xref ref-type="bibr" rid="CR5">5</xref>,<xref ref-type="bibr" rid="CR6">6</xref>], the human immunodeficiency virus (HIV) [<xref ref-type="bibr" rid="CR7">7</xref>] and several bacterial species such as <italic>Neisseria meningitidis</italic> and <italic>Streptococcus pneumonaie</italic>. This fundamental difference between pathogen types is evident in the area of vaccine development: we have mostly been successful in finding solutions against infections in which natural immunity to conserved targets is strong [<xref ref-type="bibr" rid="CR8">8</xref>-<xref ref-type="bibr" rid="CR10">10</xref>].</p>
    <p>One way in which the evolution and dynamic behaviour of pathogens can be explored is through a multilocus mathematical framework, where each considered locus corresponds to an antigenic epitope, at which a fixed number of immunologically distinct variants can be expressed [<xref ref-type="bibr" rid="CR11">11</xref>]. In practice, host-individuals who have been exposed to a particular antigen combination (strain) are assumed to acquire lifelong complete immunity to it, but also partial immunity to those strains expressing any shared antigens. By sheer existence of natural diversity, such antigen-sharing relationships can create a complex network of selective pressures, which may limit the emergence and circulation of some antigenic types and eventually structure the pathogen population into often observed patterns of diversity [<xref ref-type="bibr" rid="CR11">11</xref>,<xref ref-type="bibr" rid="CR12">12</xref>].</p>
    <p>According to previous research based on this multilocus framework, the resulting pattern of diversity at equilibrium (strain structure) within a host-pathogen system is primarily determined by the strength of immune interference amongst antigenically related strains [<xref ref-type="bibr" rid="CR11">11</xref>]. In the presence of low selection pressure, for instance, a lack of strain structure (NSS) is expected, in which antigenic variants can coexist at very similar prevalence levels. At intermediate levels of selection, however, cyclical/chaotic strain structure (CSS) emerges, where strains that dominate at a given point in time are constantly replaced by competing variants and measures of single-strain dominance (SSD) are found to be high. For even stronger immune selection, the cyclical behaviour is suppressed, giving rise to a discrete strain structure (DSS) in which strains self-organise into groups with non-overlapping (discordant) antigen repertoires that minimize competition and ease co-existence.</p>
    <p>Other host-pathogen frameworks have alternatively shown that strain dynamics and associated structures can be represented by <italic>continuous strain spaces</italic> (e.g. one-dimensional arrays) in which strains are assumed to be antigenically related to a restricted subset of variants in the neighbouring antigenic space [<xref ref-type="bibr" rid="CR13">13</xref>-<xref ref-type="bibr" rid="CR15">15</xref>]. In these frameworks, similarly to the multilocus approach, competition for hosts can cause the pathogen population to become polarized within such continuous spaces in a manner analogous to <italic>character displacement</italic> across an ecological resource (e.g. specialisation on seed/beak size among coexisting species of birds). These models are therefore in agreement that strong immune selection favours the evolution of antigenically distinct types minimizing immunological interference that tend to present DSS-like population dynamics.</p>
    <p>The existence of distinctly measurable strain structures in host-pathogen systems is of interest to epidemiologists as the implications for the control of infectious disease are considerable. For instance, the natural propensity to exhibit CSS-like dynamics, as is the case for influenza A viruses, can complicate and restrict our ability to interpret and predict the outcome of interventions such as vaccination [<xref ref-type="bibr" rid="CR1">1</xref>,<xref ref-type="bibr" rid="CR2">2</xref>,<xref ref-type="bibr" rid="CR16">16</xref>]. At the same time, the observation of DSS implies that genomic regions under strong immune selection should be detectable, for instance through linkage disequilibrium, which is of paramount importance for research and discovery of potential targets for vaccines and antipathogen drugs [<xref ref-type="bibr" rid="CR17">17</xref>-<xref ref-type="bibr" rid="CR19">19</xref>].</p>
    <p>Despite the contribution of Gupta et al. multilocus strain theory [<xref ref-type="bibr" rid="CR1">1</xref>,<xref ref-type="bibr" rid="CR12">12</xref>,<xref ref-type="bibr" rid="CR17">17</xref>-<xref ref-type="bibr" rid="CR21">21</xref>] and other <italic>strain theories</italic>[<xref ref-type="bibr" rid="CR2">2</xref>,<xref ref-type="bibr" rid="CR13">13</xref>-<xref ref-type="bibr" rid="CR15">15</xref>] in recent years to our current understanding of the population dynamics and evolution of multi-strain pathogens, their biological simplicity is often overshadowed by inherent mathematical and computational complexities. Moreover, the availability of free software to explore the proposed framework alternatives has not grown at the same rate as this diversity in knowledge. This is a particularly important point in light of an increasing use of computation in biological and ecological studies, to which simple and openly available tools may contribute immensely. Here, we present and describe a new R package aiming to reduce the existing gap between mathematical approaches and population biology education and research.</p>
  </sec>
  <sec id="Sec2">
    <title>Implementation</title>
    <p>The <bold>M</bold>ultilocus <bold>ANTI</bold>genic <bold>S</bold>imulator (MANTIS) package was designed for the R statistical environment by the Evolutionary Ecology of Infectious Disease (EEID) research group of the Department of Zoology at the University of Oxford. MANTIS is a tool to simulate and analyse epidemiological time-series, generated under the biological assumptions of the strain theory of host-pathogen systems by Gupta et al. [<xref ref-type="bibr" rid="CR11">11</xref>].</p>
    <sec id="Sec3">
      <title>Environment</title>
      <p>R is a language and environment for statistical computing and graphics, freely available for download and general use [<xref ref-type="bibr" rid="CR22">22</xref>]. This platform was chosen for its open-source nature, general acceptance within the computational and bioinformatics communities, connection to educational programmes and ease for data manipulation and graphical rendering. The core of MANTIS is essentially a dynamic system of ordinary-differential equations (see below) and a fixed-step Runge-Kutta solver [<xref ref-type="bibr" rid="CR23">23</xref>]. For computational performance reasons, these were implemented using C/C++ code. MANTIS therefore requires Rcpp - a free R package aiming at providing seamless integration of R and C/C++ [<xref ref-type="bibr" rid="CR24">24</xref>]. All code was designed and implemented in Ubuntu 14.04 LTS (Trusty Tahr), using R version 3.0.2, as well as <italic>g++</italic> version 4.8.2 and Rcpp version 0.11.2. We refer the reader to the section Availability and Requirements at the end of this article for a summary of the software involved in this version of MANTIS.</p>
    </sec>
    <sec id="Sec4">
      <title>Multilocus framework</title>
      <p>The system of ordinary-differential equations (ODEs) below summarizes the basic model structure implemented within the package MANTIS (for more general mathematical formulations see for example [<xref ref-type="bibr" rid="CR11">11</xref>,<xref ref-type="bibr" rid="CR12">12</xref>,<xref ref-type="bibr" rid="CR25">25</xref>]). For simplicity, a host-pathogen system with two relevant loci and two possible alleles is here described - it is considered that alleles {<italic>A</italic>,<italic>B</italic>} can occur at the first locus and {<italic>X</italic>,<italic>Y</italic>} at the second. Similarly to what has been done in previous publications, a system of overlapping compartments can be used to represent the proportions of hosts belonging to each relevant, epidemiological class (Figure <xref rid="Fig1" ref-type="fig">1</xref>). <disp-formula id="Equ1"><label>(1)</label><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$$\begin{array}{*{20}l} &amp;\frac{{dZ}_{AX}}{dt} =\beta Y_{AX} (1-Z_{AX}) - \mu Z_{AX} \end{array} $$
\end{document}</tex-math><mml:math id="M2"><mml:mtable class="align" columnalign="left"><mml:mtr><mml:mtd class="align-1"/><mml:mtd class="align-2"><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mtext mathvariant="italic">dZ</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">AX</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">dt</mml:mtext></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mi>β</mml:mi><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">AX</mml:mtext></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">AX</mml:mtext></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>−</mml:mo><mml:mi>μ</mml:mi><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">AX</mml:mtext></mml:mrow></mml:msub><mml:mspace width="2em"/></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="12859_2015_598_Equ1.gif" position="anchor"/></alternatives></disp-formula>
</p>
      <p>
        <disp-formula id="Equ2">
          <label>(2)</label>
          <alternatives>
            <tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$$\begin{array}{*{20}l} &amp;\frac{{dW}_{AX}}{dt} = \sum_{ij-AX}^{} \beta Y_{ij} (1-W_{AX}) - \mu W_{AX} \end{array} $$
\end{document}</tex-math>
            <mml:math id="M4">
              <mml:mtable class="align" columnalign="left">
                <mml:mtr>
                  <mml:mtd class="align-1"/>
                  <mml:mtd class="align-2">
                    <mml:mfrac>
                      <mml:mrow>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mtext mathvariant="italic">dW</mml:mtext>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mtext mathvariant="italic">AX</mml:mtext>
                          </mml:mrow>
                        </mml:msub>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mtext mathvariant="italic">dt</mml:mtext>
                      </mml:mrow>
                    </mml:mfrac>
                    <mml:mo>=</mml:mo>
                    <mml:munderover accent="false" accentunder="false">
                      <mml:mrow>
                        <mml:mo mathsize="big">∑</mml:mo>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mtext mathvariant="italic">ij</mml:mtext>
                        <mml:mo>−</mml:mo>
                        <mml:mtext mathvariant="italic">AX</mml:mtext>
                      </mml:mrow>
                      <mml:mrow/>
                    </mml:munderover>
                    <mml:mi>β</mml:mi>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>Y</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mtext mathvariant="italic">ij</mml:mtext>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo>(</mml:mo>
                    <mml:mn>1</mml:mn>
                    <mml:mo>−</mml:mo>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>W</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mtext mathvariant="italic">AX</mml:mtext>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo>)</mml:mo>
                    <mml:mo>−</mml:mo>
                    <mml:mi>μ</mml:mi>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>W</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mtext mathvariant="italic">AX</mml:mtext>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mspace width="2em"/>
                  </mml:mtd>
                </mml:mtr>
              </mml:mtable>
            </mml:math>
            <graphic xlink:href="12859_2015_598_Equ2.gif" position="anchor"/>
          </alternatives>
        </disp-formula>
      </p>
      <p>
        <disp-formula id="Equ3">
          <label>(3)</label>
          <alternatives>
            <tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$$\begin{array}{*{20}l} &amp; \frac{{dY}_{AX}}{dt} \,=\, \beta Y_{AX} ((1\!-W_{AX}) \,+\, (1\,-\,\gamma)(W_{AX}\,-\,Z_{AX})) -\sigma Y_{AX} \end{array} $$
\end{document}</tex-math>
            <mml:math id="M6">
              <mml:mtable class="align" columnalign="left">
                <mml:mtr>
                  <mml:mtd class="align-1"/>
                  <mml:mtd class="align-2">
                    <mml:mspace width="-16.0pt"/>
                    <mml:mfrac>
                      <mml:mrow>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mtext mathvariant="italic">dY</mml:mtext>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mtext mathvariant="italic">AX</mml:mtext>
                          </mml:mrow>
                        </mml:msub>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mtext mathvariant="italic">dt</mml:mtext>
                      </mml:mrow>
                    </mml:mfrac>
                    <mml:mspace width="0.3em"/>
                    <mml:mo>=</mml:mo>
                    <mml:mspace width="0.3em"/>
                    <mml:mi>β</mml:mi>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>Y</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mtext mathvariant="italic">AX</mml:mtext>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo>(</mml:mo>
                    <mml:mo>(</mml:mo>
                    <mml:mn>1</mml:mn>
                    <mml:mspace width="0.3em"/>
                    <mml:mo>−</mml:mo>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>W</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mtext mathvariant="italic">AX</mml:mtext>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo>)</mml:mo>
                    <mml:mspace width="0.3em"/>
                    <mml:mo>+</mml:mo>
                    <mml:mspace width="0.3em"/>
                    <mml:mo>(</mml:mo>
                    <mml:mn>1</mml:mn>
                    <mml:mspace width="0.3em"/>
                    <mml:mo>−</mml:mo>
                    <mml:mspace width="0.3em"/>
                    <mml:mi>γ</mml:mi>
                    <mml:mo>)</mml:mo>
                    <mml:mo>(</mml:mo>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>W</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mtext mathvariant="italic">AX</mml:mtext>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mspace width="0.3em"/>
                    <mml:mo>−</mml:mo>
                    <mml:mspace width="0.3em"/>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>Z</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mtext mathvariant="italic">AX</mml:mtext>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo>)</mml:mo>
                    <mml:mo>)</mml:mo>
                    <mml:mo>−</mml:mo>
                    <mml:mi>σ</mml:mi>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>Y</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mtext mathvariant="italic">AX</mml:mtext>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mspace width="2em"/>
                  </mml:mtd>
                </mml:mtr>
              </mml:mtable>
            </mml:math>
            <graphic xlink:href="12859_2015_598_Equ3.gif" position="anchor"/>
          </alternatives>
        </disp-formula>
        <fig id="Fig1">
          <label>Figure 1</label>
          <caption>
            <p>Schematic example of a host-pathogen system within the multilocus framework. A schematic of overlapping compartments is used to indicate the proportions immune to each strain (<italic>Z</italic>) and to antigenically related variants (<italic>W</italic>), from which the proportion of infectious (<italic>Y</italic>) can be deduced (for simplicity, a {2,2} antigenic system is presented, see main text for model equations). The background grey Venn diagrams present all the possible overlaps between the <italic>Z</italic> and <italic>W</italic> subclasses. Colours are used to highlight the sections of the diagrams related to each strain: <italic>AX</italic> in green, <italic>AY</italic> in red, <italic>BX</italic> in blue and <italic>BY</italic> in purple. On the top row, <italic>Z</italic> classes are presented. On the bottom row <italic>W</italic> classes are presented, which include the intersection of multiple <italic>Z</italic> classes according to the allele-sharing relationships between strains.</p>
          </caption>
          <graphic xlink:href="12859_2015_598_Fig1_HTML" id="MO1"/>
        </fig>
      </p>
      <p>According to this strain theory, it is assumed that host-individuals who have been exposed to a particular pathogen strain (<italic>Z</italic>
<sub><italic>AX</italic></sub>, exemplifying for strain <italic>AX</italic>) are immune for life to further challenge by the same strain, while those who have been exposed to strains that share alleles with it (<italic>W</italic>
<sub><italic>AX</italic></sub>) have reduced probability (<italic>γ</italic>) of transmitting the strain once infected (<italic>Y</italic>
<sub><italic>AX</italic></sub>). The parameter <italic>γ</italic> therefore reflects the strength of antigen-specific responses in transmission prevention. The parameters <italic>β</italic> and 1/<italic>σ</italic>, respectively, define the transmission coefficient and infectious period of the pathogen, while 1/<italic>μ</italic> corresponds to the life expectancy of the host population. Here, the notation <italic>i</italic>
<italic>j</italic>−<italic>A</italic>
<italic>X</italic> indicates all strains sharing alleles with strain <italic>AX</italic>.</p>
      <p>Using MANTIS, the antigenic structure here exemplified can be easily generalized to multiple loci with any level of diversity. We propose and will henceforward use the notation {3,4,10}, for example, to indicate a system with three loci {<italic>i</italic>,<italic>k</italic>,<italic>j</italic>} and <italic>N</italic>
<sub><italic>i</italic></sub>=3, <italic>N</italic>
<sub><italic>k</italic></sub>=4 and <italic>N</italic>
<sub><italic>j</italic></sub>=10 alleles, respectively. Finally, it is important to note that for any given structure, the total number of possible strains is <italic>N</italic>
<sub><italic>i</italic></sub>×<italic>N</italic>
<sub><italic>k</italic></sub>×… <italic>N</italic>
<sub><italic>n</italic></sub>.</p>
    </sec>
    <sec id="Sec5">
      <title>Key features and functionalities</title>
      <p>MANTIS wraps a significant amount of C/C++ and R programming into a set of user-friendly R functions. These include the routine (<italic>runMANTIS</italic>) to simulate the complex systems described above but also others to analyse, visualize and export results. For this, the package offers its own set of plotting functions (<italic>plotY, plotYDiversity, etc.</italic>) that support users unfamiliar with the R environment from the need to explicitly program time-series extraction, transformation, formatting and displaying. The same is done for exportation of time-series, for which functions (<italic>exportY, exportYDiversity, etc.</italic>) are offered to write data into text-files containing comma-separated values (CSV), generally usable in spreadsheet-office applications. With the goal of facilitating similar analyses to what has already been published in research articles based on this strain theory, MANTIS also offers routines to obtain quantifications of interest on the simulated time-series. These range from calculations of diversity (<italic>calcDiversity</italic>) using standard ecological methods such as the Shannon Index [<xref ref-type="bibr" rid="CR25">25</xref>], to epidemiological measures of single-strain dominance (<italic>calcSingleStrainDominance</italic>) [<xref ref-type="bibr" rid="CR1">1</xref>]. The detailed description of each available method and associated routines within MANTIS escapes the scope of this article and new versions of the package are expected to become available in the near future. Hence, for updated references and detailed explanations that may include the mathematical formulations of built-in methods, we refer the reader to the package’s Manual, available for download at the EEID’s website [<xref ref-type="bibr" rid="CR26">26</xref>].</p>
    </sec>
  </sec>
  <sec id="Sec6">
    <title>Results and discussion</title>
    <p>The package MANTIS introduces no restrictions to the complexity of the system to be simulated. However, due to the steep increase in the number of ODEs required for more complex antigenic structures, computational limitations may be present for the user. Figure <xref rid="Fig2" ref-type="fig">2</xref> presents some examples of the versatility of Gupta’s et al. framework, for systems with 4, 6, 10 and 12 possible strains. From this simple illustration it is possible to note how different antigenic structures will manifest as a multitude of relationships between strains and dissimilar networks of cross-immunity. For instance, the systems {3,2} and {3,2,2} have very different numbers of total strains (6 and 12), but each existing strain is only discordant with two others (exemplified in blue). Likewise, the systems {5,2} and {3,2,2} have similar number of strains (10 and 12) but the full level of discordance is verydifferent.<fig id="Fig2"><label>Figure 2</label><caption><p>Examples of strain allele-sharing relationships within the multilocus framework. A set of matrix-diagrams highlight the relationships between all possible strains within systems defined with different antigenic structures. Relationships are highlighted in dark grey squares, representing pairs of strains (row, column) that share at least one allele (and therefore antigen). In contrast, light grey squares mark pairs with non-overlapping allele repertoires (discordant) that share no antigens. Examples of discordant strains are shown in blue for the systems {3,2} (<italic>AY</italic> with <italic>BX</italic> and <italic>CX</italic>) and {3,2,2} (<italic>ASY</italic> with <italic>BRX</italic> and <italic>CRX</italic>). Letters were arbitrarily chosen to build figurative strain sequences (locus 1: A, B, C, D, E; locus 2: R, S; and locus 3: X and Y).</p></caption><graphic xlink:href="12859_2015_598_Fig2_HTML" id="MO2"/></fig>
</p>
    <p>To exemplify the simulation potential of MANTIS, we further explore the population dynamics of example {3,2}. We choose this system for simplicity and visualization purposes, given its small strain size (2 loci) and number (6 strains). While we focus this example on the dynamics of the infected portion (<italic>Y</italic>) of the host population, it should be noted that with MANTIS it would also be possible to analyse the cross-protected (<italic>W</italic>) and immune (<italic>Z</italic>) portions. In Figure <xref rid="Fig3" ref-type="fig">3</xref> it is shown how the strength of immune selection (<italic>γ</italic>) dictates the transient dynamics and strain structure that is reached at equilibrium. When cross-immunity between strains sharing alleles is low (Figure <xref rid="Fig3" ref-type="fig">3</xref>, left), NSS is observed as strains co-exist and share similar prevalence levels. In contrast, as immune pressure is increased, the dynamic state at equilibrium changes and strain structures emerge. For example, at a reasonably high <italic>γ</italic>=0.75, CSS is presented (Figure <xref rid="Fig3" ref-type="fig">3</xref>, centre), in which strains frequently replace each other in time through incomplete exclusion arising from temporary competition for susceptible hosts. This dynamic behaviour provides a basis for understanding the population dynamics of pathogens such as influenza A [<xref ref-type="bibr" rid="CR1">1</xref>,<xref ref-type="bibr" rid="CR12">12</xref>], as well as the within-host dynamics of HIV and <italic>Plasmodium falciparum</italic> [<xref ref-type="bibr" rid="CR21">21</xref>], which are all characterised by the sequential appearance of novel antigenic types in time. At even higher levels of selection, however, the cyclical behaviour is suppressed and DSS emerges, in which subsets of strains appear present at different prevalence levels (Figure <xref rid="Fig3" ref-type="fig">3</xref>, right). In this case, given that strains have no explicit epidemiological asymmetries in the framework, initial conditions dictate which subset becomes dominant. Nevertheless, it is the strong immune selection that forces variants to segregate, given their allele-sharing profiles. In this example, strain <italic>AY</italic> dominates the population, followed by <italic>BX</italic> and <italic>CX</italic>, while strains <italic>AX</italic>, <italic>BY</italic> and <italic>CY</italic> are virtually extinct. It is straightforward to note that under this regime of strong immune pressure, the persistent subsets are discordant (<italic>AY</italic> shares no alleles with { <italic>B</italic>
<italic>X</italic>,<italic>C</italic>
<italic>X</italic>}), which arises from the natural aptitude of the strains to organize into subsets that minimize competition. Concurrently, all strains that are driven to extinction necessarily share alleles with the highly prevalent ones. The best known examples of this form of strain structure have been found among the hypervariable regions of subcapsular antigens of the bacterial species <italic>Neisseria meningitidis</italic>: non-overlapping associations between the VR1 and VR2 regions and variants of the iron-regulated outer membrane protein FetA are evident in the global isolate collection represented in the PubMLST database [<xref ref-type="bibr" rid="CR27">27</xref>]. Similar patterns have also been observed among the Opacity-associated outer membrane proteins of the <italic>meningococcus</italic>, which play a role in adhesion to the human host tissue during colonisation and invasion [<xref ref-type="bibr" rid="CR17">17</xref>,<xref ref-type="bibr" rid="CR28">28</xref>].<fig id="Fig3"><label>Figure 3</label><caption><p>Examples of dynamic solutions with different strain structures at equilibrium. Dynamic solutions obtained from MANTIS, using three levels of cross-immunity <italic>γ</italic>=0.10<italic>(left)</italic>, <italic>γ</italic>=0.75<italic>(centre)</italic> and <italic>γ</italic>=0.95<italic>(right)</italic>, within an antigenic system with structure {3,2} and 6 strains. The level of immune selection is here seen to structure the pathogen population into NSS, CSS, and DSS. Examples are initialized with the same initial conditions and parameters are <italic>β</italic>=292, <italic>σ</italic>=(1/5)∗365 and <italic>μ</italic>=1/50, resulting in a basic reproduction number (<italic>R</italic>0) of ≈4. Grey shaded areas highlight the dynamics at equilibrium. The beginning of the dynamic series is discarded for visualization purposes. Letters were arbitrarily chosen to build figurative strain sequences (locus 1: A, B; locus 2: X and Y). The minimal R code required to replicate these dynamics can be found in the Additional file <xref rid="MOESM1" ref-type="media">1</xref>.</p></caption><graphic xlink:href="12859_2015_598_Fig3_HTML" id="MO3"/></fig>
</p>
    <p>The manner in which strains are found to be organized in host-pathogen systems further dictates the patterns and levels of strain diversity that can be found in time [<xref ref-type="bibr" rid="CR1">1</xref>,<xref ref-type="bibr" rid="CR12">12</xref>]. To complete the examples presented in Figure <xref rid="Fig3" ref-type="fig">3</xref> we further demonstrate how diversity measures can be obtained from the inbuilt functionality of MANTIS (Figure <xref rid="Fig4" ref-type="fig">4</xref>). As expected, when selection is virtually absent (<italic>γ</italic>=0.1) and strains self-organize to co-circulate at similar prevalence levels (NSS), diversity is maximized. In contrast, in regimes in which cross-immunity plays a role (CSS and DSS) and strains suffer competition, diversity is often lower (Figure <xref rid="Fig4" ref-type="fig">4</xref>, right). In the case of DSS this arises from the competitive exclusion of some strains, while in CSS it is a consequence of recurrent replacement and temporary dominance of subsets of strains (Figure <xref rid="Fig3" ref-type="fig">3</xref>, centre, right). Importantly, the actual patterns of diversity in time are dependent on the inherent dynamic behaviour of the strains. This can be seen in the left subplot of Figure <xref rid="Fig4" ref-type="fig">4</xref>, in which the regime defined by <italic>γ</italic>=0.75 and characterized by CSS (Figure <xref rid="Fig3" ref-type="fig">3</xref>, centre) also presents oscillating diversity patterns. Another consequence of such fluctuating behaviour in strain prevalence can be seen in measures of single-strain dominance, which tend to be maximized in the presence of CSS regimes (Figure <xref rid="Fig4" ref-type="fig">4</xref>, centre).<fig id="Fig4"><label>Figure 4</label><caption><p>Examples of strain diversity solutions for different strain structures. Dynamic solutions generated by MANTIS for an antigenic system with structure {3,2} and 6 strains. <italic>(left)</italic> Strain diversity (Shannon Index), for three levels of cross-immunity <italic>γ</italic>=0.10 (black), <italic>γ</italic>=0.75 (red) and <italic>γ</italic>=0.95 (blue). Examples correspond to series presented in Figure <xref rid="Fig3" ref-type="fig">3</xref> for the same <italic>γ</italic> values. Grey shaded area highlights the dynamics at equilibrium used for the remaining plots. <italic>(centre, right)</italic> Single-strain dominance (SSD) and strain diversity (Shannon Index) for different values of <italic>γ</italic>. Grey lines and areas are the mean and standard deviation, respectively. Variation is obtained by running 100 simulations with random initial conditions for each <italic>γ</italic> value. Vertical lines mark the <italic>γ</italic> regimes used in Figure <xref rid="Fig3" ref-type="fig">3</xref> and this figure, left. The minimal R code required to replicate these dynamics can be found in the Additional file <xref rid="MOESM1" ref-type="media">1</xref>.</p></caption><graphic xlink:href="12859_2015_598_Fig4_HTML" id="MO4"/></fig>
</p>
  </sec>
  <sec id="Sec7" sec-type="conclusion">
    <title>Conclusions</title>
    <p>The development of immunity amongst hosts places pressure on pathogens by setting up competition between genetic variants, since a previously infected host may no longer be available for infection due to the establishment of responses that are (partially) effective against a variety of other strains. This sort of competition is particularly acute when the principal targets of immunity are conserved antigens shared by all strains: in these cases, each host can only sustain a single infection by a particular pathogen species, as is the case with many common childhood infections such as measles, mumps and pertussis. In contrast, when the principal targets of immunity are variable, the same principles of competitive exclusion can lead to cyclical/chaotic fluctuations in the frequencies of different strains, or in the coexistence of strains which differ as widely as possible in the immune responses they provoke in order to relax competition and associated selective pressures. The observation and study of distinct strain structures in a specific host-pathogen system are of paramount importance to epidemiologists as the implications for control areconsiderable.</p>
    <p>Understanding the evolutionary forces that shape the observed structures of pathogen populations is one of the key goals of computationally simulated epidemiological models. The strain theory herein described states that a pathogen’s infection history and its future potential are shaped by natural selection arising from host immune pressures [<xref ref-type="bibr" rid="CR11">11</xref>]. The application of such concept was herein exemplified in a basic study case. This consisted in the definition of a relevant antigenic structure and simulation of population dynamics and expected levels of strain diversity. The main goal of this example was to highlight the fundamental functionalities of the MANTIS package, with no specific pathogen in mind. Nonetheless, this same mathematical approach has been previously used to research specific viral and bacterial agents, such as the malaria parasite <italic>Plasmodium falciparum</italic> [<xref ref-type="bibr" rid="CR21">21</xref>], the influenza A virus [<xref ref-type="bibr" rid="CR1">1</xref>,<xref ref-type="bibr" rid="CR12">12</xref>,<xref ref-type="bibr" rid="CR20">20</xref>] and <italic>Neisseria meningitidis</italic> [<xref ref-type="bibr" rid="CR17">17</xref>,<xref ref-type="bibr" rid="CR18">18</xref>,<xref ref-type="bibr" rid="CR28">28</xref>].</p>
    <p>MANTIS’s main function is to serve as a free academic software tool. We argue for this software’s place and usefulness in educational programmes such as epidemiology and ecology courses, by supporting students in their exploration of host-pathogen systems in which host immunity may play a significant role. With this in mind, the package was developed to be user-friendly, not only wrapping the use of complex ODE systems into single-function calls, but also including a variety of functions for easy time-series visualization and exportation. The open source nature of MANTIS further provides a valuable opportunity for researchers with advanced programming skills to expand and tweak its capabilities for their own research goals. In fact, as the number of research articles based on this strain theory grows, we predict that many new functionalities will have a place on the base content of this package. A future intended direction is therefore to update and republish this software regularly on the Evolutionary Ecology of Infectious Disease group’s website [<xref ref-type="bibr" rid="CR26">26</xref>].</p>
  </sec>
  <sec id="Sec8">
    <title>Availability and requirements</title>
    <p>MANTIS has a dedicated manual that follows the well-established format for R packages. It presents a general description of the package’s functionality, as well as examples, a short introduction and key literature references for the strain theory herein described. As new versions of the package are expected in the near future, the reader should refer to this manual for updated references and mathematical formulations of MANTIS’s inbuilt methods. The package can be installed using a platform-independent, source-based file (note: compiling source packages may require the pre-installation of Rtools [<xref ref-type="bibr" rid="CR29">29</xref>] on Windows machines). Both the manual and source file can be found at the EEID’s website for download [<xref ref-type="bibr" rid="CR26">26</xref>]. Newer versions and related materials will be deposited on this website and we refer the reader to it for further information and future changes. Finally, the following list summarizes key information about the version of MANTIS explored and described in this article: <list list-type="bullet"><list-item><p><bold>Project name:</bold> Multilocus ANTIgenic Simulator (MANTIS).</p></list-item><list-item><p><bold>Creators:</bold> EEID group at University of Oxford.</p></list-item><list-item><p><bold>Current Version:</bold> 1.0 (cryptonym: <italic>green egg</italic>).</p></list-item><list-item><p><bold>Project home page:</bold>
http://www.eeid.ox.ac.uk/mantis
</p></list-item><list-item><p><bold>Manual, examples and help:</bold> Available at the project’s website.</p></list-item><list-item><p><bold>Operating system:</bold> Platform independent.</p></list-item><list-item><p><bold>License:</bold> GNU GPL.</p></list-item><list-item><p><bold>Programming languages:</bold> R, C, C++.</p></list-item><list-item><p><bold>Other requirements:</bold> R 3.0 or higher, Rcpp 0.11.2 or higher, GNU GCC 4.8.2 or higher, Rtools.</p></list-item></list>
</p>
  </sec>
</body>
<back>
  <app-group>
    <app id="App1">
      <sec id="Sec9">
        <title>Additional file</title>
        <p>
          <media position="anchor" xlink:href="12859_2015_598_MOESM1_ESM.pdf" id="MOESM1">
            <label>Additional file 1</label>
            <caption>
              <p><bold>Minimal code for examples in the main text.</bold> The minimal R code necessary to replicate the dynamics of Figures <xref rid="Fig3" ref-type="fig">3</xref> and <xref rid="Fig4" ref-type="fig">4</xref>, using MANTIS, can be found in this PDF file.</p>
            </caption>
          </media>
        </p>
      </sec>
    </app>
  </app-group>
  <fn-group>
    <fn>
      <p>
        <bold>Competing interests</bold>
      </p>
      <p>The authors declare that they have no competing interests.</p>
    </fn>
    <fn>
      <p>
        <bold>Authors’ contributions</bold>
      </p>
      <p>SG and PW developed the theory. All authors conceived the project. PW and JL wrote the software, which all authors tested and debugged. JL wrote the first draft of the manuscript, which all authors revised and approved.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>The authors thank all members of the Evolutionary Ecology of Infectious Disease group, at the University of Oxford, for support and ideas during development. This work was financially supported by the European Research Council <italic>(ERC 268904 - DIVERSITY)</italic>.</p>
  </ack>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1</label>
      <mixed-citation publication-type="other">Wikramaratna PS, Sandeman M, Recker M, Gupta S. The antigenic evolution of influenza: drift or thrift?Philos Trans R Soc Lond B Biol Sci. 2013; 368(1614):20120200. doi:10.1098/rstb.2012.0200.</mixed-citation>
    </ref>
    <ref id="CR2">
      <label>2</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ferguson</surname>
            <given-names>NM</given-names>
          </name>
          <name>
            <surname>Galvani</surname>
            <given-names>AP</given-names>
          </name>
          <name>
            <surname>Bush</surname>
            <given-names>RM</given-names>
          </name>
        </person-group>
        <article-title>Ecological and immunological determinants of influenza evolution</article-title>
        <source>Nature</source>
        <year>2003</year>
        <volume>422</volume>
        <issue>6930</issue>
        <fpage>428</fpage>
        <lpage>33</lpage>
        <pub-id pub-id-type="doi">10.1038/nature01509</pub-id>
        <pub-id pub-id-type="pmid">12660783</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hassantoufighi</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Sandbulte</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Gao</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Manischewitz</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>King</surname>
            <given-names>L</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A practical influenza neutralization assay to simultaneously quantify hemagglutinin and neuraminidase-inhibiting antibody responses</article-title>
        <source>Vaccine</source>
        <year>2010</year>
        <volume>28</volume>
        <fpage>790</fpage>
        <lpage>7</lpage>
        <pub-id pub-id-type="doi">10.1016/j.vaccine.2009.10.066</pub-id>
        <pub-id pub-id-type="pmid">19887135</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hirst</surname>
            <given-names>GK</given-names>
          </name>
        </person-group>
        <article-title>the agglutination of red cells By allantoic fluid of chick embryos Infected With Influenza Virus</article-title>
        <source>Science (New York, N.Y.)</source>
        <year>1941</year>
        <volume>94</volume>
        <fpage>22</fpage>
        <lpage>3</lpage>
        <pub-id pub-id-type="doi">10.1126/science.94.2427.22</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Polley</surname>
            <given-names>SD</given-names>
          </name>
          <name>
            <surname>Tetteh</surname>
            <given-names>KK</given-names>
          </name>
          <name>
            <surname>Lloyd</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Akpogheneta</surname>
            <given-names>OJ</given-names>
          </name>
          <name>
            <surname>Greenwood</surname>
            <given-names>BM</given-names>
          </name>
          <name>
            <surname>Bojang</surname>
            <given-names>KA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Plasmodium falciparum merozoite surface protein 3 is a target of allele-specific immunity and alleles are maintained by natural selection</article-title>
        <source>J Infect Dis</source>
        <year>2007</year>
        <volume>195</volume>
        <issue>2</issue>
        <fpage>279</fpage>
        <lpage>87</lpage>
        <pub-id pub-id-type="doi">10.1086/509806</pub-id>
        <pub-id pub-id-type="pmid">17191173</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6</label>
      <mixed-citation publication-type="other">Recker M, Buckee CO, Serazin A, Kyes S, Pinches R, Christodoulou Z, et al. Antigenic variation in Plasmodium falciparum malaria involves a highly structured switching pattern. PLoS Pathogens. 2011;7(3). doi:10.1371/journal.ppat.1001306.</mixed-citation>
    </ref>
    <ref id="CR7">
      <label>7</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Frost</surname>
            <given-names>SDW</given-names>
          </name>
          <name>
            <surname>Wrin</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Smith</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>Kosakovsky Pond</surname>
            <given-names>SL</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Paxinos</surname>
            <given-names>E</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Neutralizing antibody responses drive the evolution of human immunodeficiency virus type 1 envelope during recent HIV infection</article-title>
        <source>Proc Natl Acad Sci U S A</source>
        <year>2005</year>
        <volume>102</volume>
        <issue>51</issue>
        <fpage>18514</fpage>
        <lpage>9</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.0504658102</pub-id>
        <pub-id pub-id-type="pmid">16339909</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Long</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Hoffman</surname>
            <given-names>SL</given-names>
          </name>
        </person-group>
        <article-title>Parasitology. Malaria–from infants to genomics to vaccines</article-title>
        <source>Science (New York, N.Y.)</source>
        <year>2002</year>
        <volume>297</volume>
        <issue>5580</issue>
        <fpage>345</fpage>
        <lpage>347</lpage>
        <pub-id pub-id-type="doi">10.1126/science.1074484</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9</label>
      <mixed-citation publication-type="other">Orenstein WA, Seib K, Graham-rowe D, Berkley S. Contemporary Vaccine Challenges : Improving Global Health One Shot at a Time. 2014; 6(253):1–5. doi:10.1126/scitranslmed.3009848.</mixed-citation>
    </ref>
    <ref id="CR10">
      <label>10</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nabel</surname>
            <given-names>GJ</given-names>
          </name>
        </person-group>
        <article-title>Mapping the future of HIV vaccines</article-title>
        <source>Nat Rev Microbiol</source>
        <year>2007</year>
        <volume>5</volume>
        <fpage>482</fpage>
        <lpage>4</lpage>
        <pub-id pub-id-type="doi">10.1038/nrmicro1713</pub-id>
        <pub-id pub-id-type="pmid">17571457</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gupta</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Ferguson</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Anderson</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Chaos, persistence, and evolution of strain structure in antigenically diverse infectious agents</article-title>
        <source>Science (New York, NY)</source>
        <year>1998</year>
        <volume>280</volume>
        <issue>5365</issue>
        <fpage>912</fpage>
        <lpage>5</lpage>
        <pub-id pub-id-type="doi">10.1126/science.280.5365.912</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Recker</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Pybus</surname>
            <given-names>OG</given-names>
          </name>
          <name>
            <surname>Nee</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Gupta</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>The generation of influenza outbreaks by a network of host immune responses against a limited set of antigenic types</article-title>
        <source>Proc Natl Acad Sci U S A</source>
        <year>2007</year>
        <volume>104</volume>
        <issue>18</issue>
        <fpage>7711</fpage>
        <lpage>716</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.0702154104</pub-id>
        <pub-id pub-id-type="pmid">17460037</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gog</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Grenfell</surname>
            <given-names>BT</given-names>
          </name>
        </person-group>
        <article-title>Dynamics and selection of many-strain pathogens</article-title>
        <source>Proc Natl Acad Sci U S A</source>
        <year>2002</year>
        <volume>99</volume>
        <issue>26</issue>
        <fpage>17209</fpage>
        <lpage>14</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.252512799</pub-id>
        <pub-id pub-id-type="pmid">12481034</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gomes</surname>
            <given-names>MGM</given-names>
          </name>
          <name>
            <surname>Medley</surname>
            <given-names>GF</given-names>
          </name>
          <name>
            <surname>Nokes</surname>
            <given-names>DJ</given-names>
          </name>
        </person-group>
        <article-title>On the determinants of population structure in antigenically diverse pathogens</article-title>
        <source>Proc Biol Sci/R Soc</source>
        <year>2002</year>
        <volume>269</volume>
        <issue>1488</issue>
        <fpage>227</fpage>
        <lpage>33</lpage>
        <pub-id pub-id-type="doi">10.1098/rspb.2001.1869</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kryazhimskiy</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Dieckmann</surname>
            <given-names>U</given-names>
          </name>
          <name>
            <surname>Levin</surname>
            <given-names>SA</given-names>
          </name>
          <name>
            <surname>Dushoff</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>On state-space reduction in multi-strain pathogen models, with an application to antigenic drift in influenza A</article-title>
        <source>PLoS Comput Biol</source>
        <year>2007</year>
        <volume>3</volume>
        <issue>8</issue>
        <fpage>1513</fpage>
        <lpage>25</lpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.0030159</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bush</surname>
            <given-names>RM</given-names>
          </name>
          <name>
            <surname>Bender</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Subbarao</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Cox</surname>
            <given-names>NJ</given-names>
          </name>
          <name>
            <surname>Fitch</surname>
            <given-names>WM</given-names>
          </name>
        </person-group>
        <article-title>Predicting the evolution of human influenza A</article-title>
        <source>Science (New York, NY)</source>
        <year>1999</year>
        <volume>286</volume>
        <issue>December</issue>
        <fpage>1921</fpage>
        <lpage>5</lpage>
        <pub-id pub-id-type="doi">10.1126/science.286.5446.1921</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Guerra</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>de Lara</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Malizia</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Díaz</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Supporting user-oriented analysis for multi-view domain-specific visual languages</article-title>
        <source>Inf Softw Technol</source>
        <year>2009</year>
        <volume>51</volume>
        <fpage>769</fpage>
        <lpage>84</lpage>
        <pub-id pub-id-type="doi">10.1016/j.infsof.2008.09.005</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Buckee</surname>
            <given-names>CO</given-names>
          </name>
          <name>
            <surname>Gupta</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Kriz</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Maiden</surname>
            <given-names>MCJ</given-names>
          </name>
          <name>
            <surname>Jolley</surname>
            <given-names>KA</given-names>
          </name>
        </person-group>
        <article-title>Long-term evolution of antigen repertoires among carried meningococci</article-title>
        <source>Proc Biol Sci/R Soc</source>
        <year>2010</year>
        <volume>277</volume>
        <issue>1688</issue>
        <fpage>1635</fpage>
        <lpage>41</lpage>
        <pub-id pub-id-type="doi">10.1098/rspb.2009.2033</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Penman</surname>
            <given-names>BS</given-names>
          </name>
          <name>
            <surname>Ashby</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Buckee</surname>
            <given-names>CO</given-names>
          </name>
          <name>
            <surname>Gupta</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Pathogen selection drives nonoverlapping associations between HLA loci</article-title>
        <source>Proc Natl Acad Sci U S A</source>
        <year>2013</year>
        <volume>110</volume>
        <issue>48</issue>
        <fpage>19645</fpage>
        <lpage>50</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.1304218110</pub-id>
        <pub-id pub-id-type="pmid">24225852</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wikramaratna</surname>
            <given-names>PS</given-names>
          </name>
          <name>
            <surname>Pybus</surname>
            <given-names>OG</given-names>
          </name>
          <name>
            <surname>Gupta</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Contact between bird species of different lifespans can promote the emergence of highly pathogenic avian influenza strains</article-title>
        <source>Proc Natl Acad Sci U S A</source>
        <year>2014</year>
        <volume>111</volume>
        <issue>29</issue>
        <fpage>10767</fpage>
        <lpage>10772</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.1401849111</pub-id>
        <pub-id pub-id-type="pmid">24958867</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Recker</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Nee</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Bull</surname>
            <given-names>PC</given-names>
          </name>
          <name>
            <surname>Kinyanjui</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Marsh</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Newbold</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Transient cross-reactive immune responses can orchestrate antigenic variation in malaria</article-title>
        <source>Nature</source>
        <year>2004</year>
        <volume>429</volume>
        <issue>6991</issue>
        <fpage>555</fpage>
        <lpage>8</lpage>
        <pub-id pub-id-type="doi">10.1038/nature02486</pub-id>
        <pub-id pub-id-type="pmid">15175751</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22</label>
      <mixed-citation publication-type="other">GNU R. http://www.r-project.org/.</mixed-citation>
    </ref>
    <ref id="CR23">
      <label>23</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wambecq</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Rational Runge-Kutta methods for solving systems of ordinary differential equations</article-title>
        <source>Computing</source>
        <year>1978</year>
        <volume>20</volume>
        <fpage>333</fpage>
        <lpage>42</lpage>
        <pub-id pub-id-type="doi">10.1007/BF02252381</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Eddelbuettel</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Fran</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Rcpp: Seamless R and C ++ Integration</article-title>
        <source>J Stat Softw</source>
        <year>2011</year>
        <volume>40</volume>
        <issue>8</issue>
        <fpage>1</fpage>
        <lpage>18</lpage>
        <pub-id pub-id-type="doi">10.18637/jss.v040.i08</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Buckee</surname>
            <given-names>CO</given-names>
          </name>
          <name>
            <surname>Recker</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Watkins</surname>
            <given-names>ER</given-names>
          </name>
          <name>
            <surname>Gupta</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Role of stochastic processes in maintaining discrete strain structure in antigenically diverse pathogen populations</article-title>
        <source>Proc Natl Acad Sci U S A</source>
        <year>2011</year>
        <volume>108</volume>
        <issue>37</issue>
        <fpage>15504</fpage>
        <lpage>9</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.1102445108</pub-id>
        <pub-id pub-id-type="pmid">21876129</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26</label>
      <mixed-citation publication-type="other">EEID. MANTIS at the Evolutionary Ecology of Infectious Disease Group webpage. 2014. http://www.eeid.ox.ac.uk/mantis.</mixed-citation>
    </ref>
    <ref id="CR27">
      <label>27</label>
      <mixed-citation publication-type="other">Watkins ER, Maiden MCJ. Persistence of hyperinvasive Meningococcal strain types during Global spread as recorded in the PubMLST database. PLoS ONE. 2012;7(9).doi:10.1371/journal.pone.0045349.</mixed-citation>
    </ref>
    <ref id="CR28">
      <label>28</label>
      <mixed-citation publication-type="other">Callaghan MJ, Buckee CO, Jolley KA, Kriz P, Maiden MCJ, Gupta S. The effect of immune selection on the structure of the meningococcal opa protein repertoire. PLoS Pathogens. 2008; 4(3):1000020. doi:10.1371/journal.ppat.1000020.</mixed-citation>
    </ref>
    <ref id="CR29">
      <label>29</label>
      <mixed-citation publication-type="other">Rtools. <ext-link ext-link-type="uri" xlink:href="http://cran.r-project.org/bin/windows/Rtools/">http://cran.r-project.org/bin/windows/Rtools/</ext-link>.</mixed-citation>
    </ref>
  </ref-list>
</back>
