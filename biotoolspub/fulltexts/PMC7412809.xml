<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Genome Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">Genome Biol</journal-id>
    <journal-title-group>
      <journal-title>Genome Biology</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1474-7596</issn>
    <issn pub-type="epub">1474-760X</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7412809</article-id>
    <article-id pub-id-type="publisher-id">2116</article-id>
    <article-id pub-id-type="doi">10.1186/s13059-020-02116-x</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Integrative analyses of single-cell transcriptome and regulome using MAESTRO</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Wang</surname>
          <given-names>Chenfei</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Sun</surname>
          <given-names>Dongqing</given-names>
        </name>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Huang</surname>
          <given-names>Xin</given-names>
        </name>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wan</surname>
          <given-names>Changxin</given-names>
        </name>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Li</surname>
          <given-names>Ziyi</given-names>
        </name>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Han</surname>
          <given-names>Ya</given-names>
        </name>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Qin</surname>
          <given-names>Qian</given-names>
        </name>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Fan</surname>
          <given-names>Jingyu</given-names>
        </name>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Qiu</surname>
          <given-names>Xintao</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff5">5</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Xie</surname>
          <given-names>Yingtian</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff5">5</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Meyer</surname>
          <given-names>Clifford A.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Brown</surname>
          <given-names>Myles</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff5">5</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Tang</surname>
          <given-names>Ming</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Long</surname>
          <given-names>Henry</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff5">5</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Liu</surname>
          <given-names>Tao</given-names>
        </name>
        <address>
          <email>tao.liu@roswellpark.org</email>
        </address>
        <xref ref-type="aff" rid="Aff6">6</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-4736-7339</contrib-id>
        <name>
          <surname>Liu</surname>
          <given-names>X. Shirley</given-names>
        </name>
        <address>
          <email>xsliu@ds.dfci.harvard.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.38142.3c</institution-id><institution-id institution-id-type="ISNI">000000041936754X</institution-id><institution>Department of Data Science, Dana-Farber Cancer Institute, </institution><institution>Harvard T.H. Chan School of Public Health, </institution></institution-wrap>Boston, MA 02215 USA </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.65499.37</institution-id><institution-id institution-id-type="ISNI">0000 0001 2106 9910</institution-id><institution>Center for Functional Cancer Epigenetics, </institution><institution>Dana-Farber Cancer Institute, </institution></institution-wrap>Boston, MA 02215 USA </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="GRID">grid.24516.34</institution-id><institution-id institution-id-type="ISNI">0000000123704535</institution-id><institution>Clinical Translational Research Center, Shanghai Pulmonary Hospital, School of Life Science and Technology, </institution><institution>Tongji University, </institution></institution-wrap>Shanghai, 200433 China </aff>
      <aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="GRID">grid.410740.6</institution-id><institution-id institution-id-type="ISNI">0000 0004 1803 4911</institution-id><institution>Beijing Institute of Radiation Medicine, </institution></institution-wrap>Beijing, 100850 China </aff>
      <aff id="Aff5"><label>5</label><institution-wrap><institution-id institution-id-type="GRID">grid.38142.3c</institution-id><institution-id institution-id-type="ISNI">000000041936754X</institution-id><institution>Department of Medical Oncology, Dana-Farber Cancer Institute, </institution><institution>Harvard Medical School, </institution></institution-wrap>Boston, MA 02215 USA </aff>
      <aff id="Aff6"><label>6</label>Department of Biostatistics and Bioinformatics, Roswell Park Comprehensive Cancer Center, Buffalo, NY 14263 USA </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>7</day>
      <month>8</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>7</day>
      <month>8</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2020</year>
    </pub-date>
    <volume>21</volume>
    <elocation-id>198</elocation-id>
    <history>
      <date date-type="received">
        <day>6</day>
        <month>12</month>
        <year>2019</year>
      </date>
      <date date-type="accepted">
        <day>23</day>
        <month>7</month>
        <year>2020</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Â© The Author(s) 2020</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold>This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1">We present Model-based AnalysEs of Transcriptome and RegulOme (MAESTRO), a comprehensive open-source computational workflow (<ext-link ext-link-type="uri" xlink:href="http://github.com/liulab-dfci/MAESTRO">http://github.com/liulab-dfci/MAESTRO</ext-link>) for the integrative analyses of single-cell RNA-seq (scRNA-seq) and ATAC-seq (scATAC-seq) data from multiple platforms. MAESTRO provides functions for pre-processing, alignment, quality control, expression and chromatin accessibility quantification, clustering, differential analysis, and annotation. By modeling gene regulatory potential from chromatin accessibilities at the single-cell level, MAESTRO outperforms the existing methods for integrating the cell clusters between scRNA-seq and scATAC-seq. Furthermore, MAESTRO supports automatic cell-type annotation using predefined cell type marker genes and identifies driver regulators from differential scRNA-seq genes and scATAC-seq peaks.</p>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Single-cell RNA-seq</kwd>
      <kwd>Single-cell ATAC-seq</kwd>
      <kwd>Computational workflow</kwd>
      <kwd>Integrate scRNA-seq and scATAC-seq</kwd>
      <kwd>Cell-type annotation</kwd>
      <kwd>Predict transcriptional regulators</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000009</institution-id>
            <institution>Foundation for the National Institutes of Health</institution>
          </institution-wrap>
        </funding-source>
        <award-id>P30CA016056</award-id>
        <award-id>CA232979</award-id>
        <principal-award-recipient>
          <name>
            <surname>Liu</surname>
            <given-names>Tao</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100008560</institution-id>
            <institution>Breast Cancer Relief Foundation</institution>
          </institution-wrap>
        </funding-source>
        <award-id>BCRF-19-100</award-id>
        <principal-award-recipient>
          <name>
            <surname>Liu</surname>
            <given-names>X. Shirley</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>Â© The Author(s) 2020</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par2">Cells in a multicellular organism may display tremendous transcriptomic and epigenetic heterogeneities. Cellular identity and function are mainly determined by the genes that are regulated and expressed in the cell [<xref ref-type="bibr" rid="CR1">1</xref>, <xref ref-type="bibr" rid="CR2">2</xref>]. Traditional profiling techniques for gene expression and <italic>cis</italic>-regulatory elements through bulk RNA-seq and ATAC-seq, respectively, are limited in deciphering the heterogeneous gene expression and regulation in complex biological systems [<xref ref-type="bibr" rid="CR3">3</xref>, <xref ref-type="bibr" rid="CR4">4</xref>]. Recent advances in single-cell technologies enabled the measurements of gene expression and chromatin accessibility at a single-cell resolution using scRNA-seq and scATAC-seq [<xref ref-type="bibr" rid="CR5">5</xref>â<xref ref-type="bibr" rid="CR8">8</xref>]. They provided unprecedented opportunities to investigate the complex gene regulation mechanisms underlying immune response [<xref ref-type="bibr" rid="CR9">9</xref>, <xref ref-type="bibr" rid="CR10">10</xref>], brain function [<xref ref-type="bibr" rid="CR11">11</xref>], tumor heterogeneity [<xref ref-type="bibr" rid="CR12">12</xref>], and developmental plasticity [<xref ref-type="bibr" rid="CR13">13</xref>, <xref ref-type="bibr" rid="CR14">14</xref>]. However, these technologies also generate large volumes of data, which pose significant computational challenges.</p>
    <p id="Par3">Although many methods have been developed to analyze single-cell data, several computational challenges remain to be resolved [<xref ref-type="bibr" rid="CR15">15</xref>]. First, pre-processing of scRNA-seq and scATAC-seq datasets can be a complicated task due to the diverse single-cell indexing strategies. Current workflows that support pre-processing single-cell datasets from sequencing files are often designed for specific technologies or platforms, such as Cellranger suites [<xref ref-type="bibr" rid="CR16">16</xref>] for the 10X Genomics dataset, snapATAC [<xref ref-type="bibr" rid="CR17">17</xref>] for 10X Genomics scATAC-seq analysis, and Dr.seq2 [<xref ref-type="bibr" rid="CR18">18</xref>] for droplet-based technologies. Second, most of the tools for single-cell analysis focus on specific analytical problems instead of providing an end-to-end workflow from alignment to post-clustering annotations. For example, SC3 [<xref ref-type="bibr" rid="CR19">19</xref>] and SNNCliq [<xref ref-type="bibr" rid="CR20">20</xref>] are developed for scRNA-seq clustering, scde [<xref ref-type="bibr" rid="CR21">21</xref>] and MAST [<xref ref-type="bibr" rid="CR22">22</xref>] for differential expression, scABC [<xref ref-type="bibr" rid="CR23">23</xref>] and cisTopic [<xref ref-type="bibr" rid="CR24">24</xref>] for scATAC-seq clustering, and chromVAR [<xref ref-type="bibr" rid="CR25">25</xref>] and Cicero [<xref ref-type="bibr" rid="CR26">26</xref>] for quantifying the chromatin accessibility at transcription regulator and gene level, respectively. Even pipelines with multiple functions, such as Monocle [<xref ref-type="bibr" rid="CR27">27</xref>], Seurat [<xref ref-type="bibr" rid="CR28">28</xref>], and Scanpy [<xref ref-type="bibr" rid="CR29">29</xref>], lack the function to identify transcription regulators, which is crucial to understand the gene regulatory networks that regulate cell state transition and lineage determination [<xref ref-type="bibr" rid="CR25">25</xref>, <xref ref-type="bibr" rid="CR30">30</xref>]. Lastly, current multimodal single-cell technologies, such as scRNA-seq and scATAC-seq, enable analyses of cellular states and interactions from a holistic view [<xref ref-type="bibr" rid="CR31">31</xref>]. However, most of the existing methods only concentrate on one modality. Therefore, workflows supporting multiple modalities and their integration are in great need.</p>
    <p id="Par4">In this study, we present the Model-based Analyses of Transcriptome and RegulOme (MAESTRO) workflow to overcome the computational challenges in analyzing scRNA-seq and scATAC-seq datasets. First, MAESTRO provides comprehensive functions for pre-processing, alignment, quality control, and expression- and accessibility quantification for scRNA-seq and scATAC-seq data from multiple platforms. Second, MAESTRO employs the best practices for cell clustering and differential analysis and allows automatic cell-type annotation and transcriptional regulator inference for both scRNA-seq and scATAC-seq dataset. Finally, by modeling the chromatin accessibility at the gene level, MAESTRO outperforms the existing methods in the integrative analysis of scRNA-seq and scATAC-seq data. To demonstrate the utility of MAESTRO, we applied it to scRNA-seq and scATAC-seq profiles of bone marrow-derived mononuclear cells (BMMCs) from a chronic lymphocytic leukemia (CLL) patient and a healthy donor. We identified distinct cell-type compositions and transcriptional regulators in the bone marrow microenvironment between the CLL patient and healthy donor and demonstrated robust transcriptional regulator predictions supported by both scRNA-seq and scATAC-seq data. MAESTRO provides user-friendly and scalable features to analyze and integrate scRNA-seq and scATAC-seq data, and its continued maintenance and update promise to be of great utility to the gene regulation community.</p>
  </sec>
  <sec id="Sec2">
    <title>Results</title>
    <sec id="Sec3">
      <title>Comprehensive features of the MAESTRO workflow</title>
      <p id="Par5">MAESTRO workflow includes three main modules, for analyzing scRNA-seq, scATAC-seq, and integrating the two (Fig.Â <xref rid="Fig1" ref-type="fig">1</xref>). Most other single-cell analysis tools start from the processed datasets, while MAESTRO supports input from fastq files for a wide variety of single-cell sequencing-based platforms including Smart-seq for scRNA-seq [<xref ref-type="bibr" rid="CR32">32</xref>], microfluidic-based scATAC-seq [<xref ref-type="bibr" rid="CR7">7</xref>], and barcode-based systems such as 10X Genomics [<xref ref-type="bibr" rid="CR16">16</xref>], drop-seq [<xref ref-type="bibr" rid="CR5">5</xref>, <xref ref-type="bibr" rid="CR6">6</xref>], sci-ATAC-seq [<xref ref-type="bibr" rid="CR33">33</xref>], and d-sci-ATAC-seq. MAESTRO also enables the most comprehensive post-alignment analysis functions compared to the existing workflows and provides a full solution for scRNA-seq and scATAC-seq analyses (TableÂ <xref rid="Tab1" ref-type="table">1</xref> and AdditionalÂ fileÂ <xref rid="MOESM1" ref-type="media">1</xref>: Table S1). In addition, we optimized MAESTRO to achieve high computational efficiency and scalability in scATAC-seq data analysis. We benchmarked the running time and memory usage using publicly available scATAC-seq datasets on peripheral blood mononuclear cells (PBMC, 10k cells) and basal cell carcinoma (BCC, 38k cells). MAESTRO shows superior performance in terms of CPU time and memory efficiency. It can handle large datasets of 40k cells while several other tools crashed due to memory overflow on our computer server with 380Â GB total memory (AdditionalÂ fileÂ <xref rid="MOESM2" ref-type="media">2</xref>: Table S2).
<fig id="Fig1"><label>Fig. 1</label><caption><p>An overview of the MAESTRO workflow. Starting from fastq files, MAESTRO performs pre-processing, alignment, quality control, expression index for scRNA-seq, peak calling for scATAC-seq, clustering, differential analysis, cell-type annotation, and transcription factor identification analysis. If scRNA-seq and scATAC-seq from the same experiment are given, MAESTRO can perform the integration analysis and annotate the integrated clusters</p></caption><graphic xlink:href="13059_2020_2116_Fig1_HTML" id="MO1"/></fig><table-wrap id="Tab1"><label>Table 1</label><caption><p>Comprehensive features of MAESTRO compared to other single-cell tools</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Methods</th><th>Multiple technologies (e.g., scRNA-seq, scATAC-seq)</th><th>Multiple platforms (e.g., 10X Genomics, sci-ATAC-seq)</th><th>Alignment</th><th>Bulk level QC</th><th>Single-cell QC</th><th>Expression index and peak calling</th><th>Normalization</th><th>Clustering</th><th>Differential analysis</th><th>Cell-type annotation</th><th>Regulator annotation</th><th>Integrated analysis between multiple technologies</th></tr></thead><tbody><tr><td>SC3 [<xref ref-type="bibr" rid="CR19">19</xref>]</td><td/><td>â</td><td/><td/><td/><td/><td>â</td><td>â</td><td/><td/><td/><td/></tr><tr><td>SNN-cliq [<xref ref-type="bibr" rid="CR20">20</xref>]</td><td/><td>â</td><td/><td/><td/><td/><td>â</td><td>â</td><td/><td/><td/><td/></tr><tr><td>MAST [<xref ref-type="bibr" rid="CR22">22</xref>]</td><td/><td>â</td><td/><td/><td/><td/><td/><td/><td>â</td><td/><td/><td/></tr><tr><td>scde [<xref ref-type="bibr" rid="CR21">21</xref>]</td><td/><td>â</td><td/><td/><td/><td/><td/><td/><td>â</td><td/><td/><td/></tr><tr><td>Monocle [<xref ref-type="bibr" rid="CR27">27</xref>]</td><td/><td>â</td><td/><td/><td>â</td><td/><td>â</td><td>â</td><td>â</td><td/><td/><td/></tr><tr><td>Pagoda [<xref ref-type="bibr" rid="CR34">34</xref>]</td><td/><td>â</td><td/><td/><td>â</td><td/><td>â</td><td>â</td><td>â</td><td/><td/><td/></tr><tr><td>Scanpy [<xref ref-type="bibr" rid="CR29">29</xref>]</td><td/><td>â</td><td/><td/><td>â</td><td/><td>â</td><td>â</td><td>â</td><td/><td/><td/></tr><tr><td>Seurat [<xref ref-type="bibr" rid="CR28">28</xref>]</td><td>â</td><td>â</td><td/><td/><td>â</td><td/><td>â</td><td>â</td><td>â</td><td/><td/><td>â</td></tr><tr><td>scABC [<xref ref-type="bibr" rid="CR23">23</xref>]</td><td/><td>â</td><td/><td/><td/><td/><td>â</td><td>â</td><td/><td/><td/><td/></tr><tr><td>CisTopic [<xref ref-type="bibr" rid="CR24">24</xref>]</td><td/><td>â</td><td/><td/><td/><td/><td>â</td><td>â</td><td/><td/><td>â</td><td/></tr><tr><td>chromVAR [<xref ref-type="bibr" rid="CR25">25</xref>]</td><td/><td>â</td><td/><td/><td/><td/><td>â</td><td>â</td><td/><td/><td>â</td><td/></tr><tr><td>Cicero [<xref ref-type="bibr" rid="CR26">26</xref>]</td><td/><td>â</td><td/><td/><td/><td/><td>â</td><td>â</td><td>â</td><td/><td/><td/></tr><tr><td>Cellranger [<xref ref-type="bibr" rid="CR16">16</xref>]</td><td>â</td><td/><td>â</td><td>â</td><td>â</td><td>â</td><td>â</td><td>â</td><td>â</td><td/><td/><td/></tr><tr><td>Dr.seq2 [<xref ref-type="bibr" rid="CR18">18</xref>]</td><td>â</td><td/><td>â</td><td>â</td><td>â</td><td>â</td><td>â</td><td>â</td><td>â</td><td/><td/><td/></tr><tr><td>snapATAC [<xref ref-type="bibr" rid="CR17">17</xref>]</td><td/><td>â</td><td>â</td><td>â</td><td>â</td><td>â</td><td>â</td><td>â</td><td>â</td><td/><td>â</td><td/></tr><tr><td>MAESTRO</td><td>â</td><td>â</td><td>â</td><td>â</td><td>â</td><td>â</td><td>â</td><td>â</td><td>â</td><td>â</td><td>â</td><td>â</td></tr></tbody></table></table-wrap></p>
      <p id="Par6">We implemented the MAESTRO using the Snakemake workflow management system [<xref ref-type="bibr" rid="CR35">35</xref>], which brings three advantages. First, MAESTRO utilizes Snakemake to deploy and parallelize jobs on most computing platforms from high-performance servers, clusters, to the cloud. Second, MAESTRO retrieves job descriptions and parameters through the Snakemake configuration files, so the pipeline can be easily customized for data from different technologies. Last, the Snakemake workflow keeps track of the parameters and log files in each step, so it is easy to reproduce the result or fine-tune the MAESTRO pipeline. Additionally, we provide all the MAESTRO components under the Conda environment [<xref ref-type="bibr" rid="CR36">36</xref>] allowing streamlined MAESTRO installation with a single command.</p>
    </sec>
    <sec id="Sec4">
      <title>Multiple levels of quality control</title>
      <p id="Par7">MAESTRO performs quality control (QC) at two levels. The bulk-level QC evaluates the sample quality by considering all the cells together, while the single cell-level QC evaluates individual cells and filters low-quality ones from downstream analysis.</p>
      <p id="Par8">We demonstrated the bulk QC metrics on 10X Genomics human PBMC scRNA-seq (12k cells) and scATAC-seq (10k cells) datasets in Fig.Â <xref rid="Fig2" ref-type="fig">2</xref>. For scRNA-seq, MAESTRO checks read mappability, distribution of reads in coding regions (CDS) and intronic regions, and coverage of reads over a gene body (Fig.Â <xref rid="Fig2" ref-type="fig">2</xref>a and AdditionalÂ fileÂ <xref rid="MOESM3" ref-type="media">3</xref>: Fig. S1a-d, see the â<xref rid="Sec12" ref-type="sec">Methods</xref>â section for details). For scATAC-seq, MAESTRO evaluates read mappability, duplicated reads percentage, fraction of reads mapped to mitochondria genes and peak regions, and fragment size distribution (Fig.Â <xref rid="Fig2" ref-type="fig">2</xref>b and AdditionalÂ fileÂ <xref rid="MOESM3" ref-type="media">3</xref>: Fig. S1e). MAESTRO also provides the normal ranges of bulk-level QC metrics in HTML output for users to better evaluate their sample quality.
<fig id="Fig2"><label>Fig. 2</label><caption><p>Pre-processing and quality control using MAESTRO. <bold>a</bold> Mapping summary of human PBMC scRNA-seq (12k cells) dataset. <bold>b</bold> Mapping summary of human PBMC scATAC-seq (10k cells) dataset. <bold>c</bold> Cell filtering plot of PBMC scRNA-seq. The <italic>x</italic>-axis represents the number of unique reads/UMIs present in each cell, and the <italic>y</italic>-axis represents the number of genes covered in each cell. <bold>d</bold> Cell filtering plot of PBMC scATAC-seq. The <italic>x</italic>-axis represents the number of unique reads present in each cell, and the <italic>y</italic>-axis represents the fraction of reads in promoter regions (defined as 2âkb up/downstream of TSS)</p></caption><graphic xlink:href="13059_2020_2116_Fig2_HTML" id="MO2"/></fig></p>
      <p id="Par9">The single-cell level QC in MAESTRO aims to remove the low-quality cells in single-cell experiments, which might arise from incompletely captured or dead cells and empty or overloaded droplets [<xref ref-type="bibr" rid="CR5">5</xref>, <xref ref-type="bibr" rid="CR6">6</xref>]. When processing scRNA-seq data, MAESTRO filters cells with few uniquely sequenced reads or UMIs or with few expressed genes (Fig.Â <xref rid="Fig2" ref-type="fig">2</xref>c) to only keep high-quality cells with enough sequencing depth and gene detection rates for downstream analyses. For scATAC-seq, MAESTRO evaluates each cell by the number of unique reads detected in the cell, as well as the fraction of reads in promoter regions as a proxy of signal-to-noise ratio (Fig.Â <xref rid="Fig2" ref-type="fig">2</xref>d). The high-quality and low-quality cells have distinct distributions when plotted using these metrics, thus can be clearly separated efficiently (Fig.Â <xref rid="Fig2" ref-type="fig">2</xref>c, d).</p>
    </sec>
    <sec id="Sec5">
      <title>Clustering and gene activity modeling</title>
      <p id="Par10">One powerful application of single-cell technology is to de novo discover and annotate cell types, which relies on the accurate clustering of the cells [<xref ref-type="bibr" rid="CR37">37</xref>]. MAESTRO integrates Seurat [<xref ref-type="bibr" rid="CR28">28</xref>] to perform clustering and Presto [<xref ref-type="bibr" rid="CR38">38</xref>] to perform differential analysis for scRNA-seq, which was reported to have superior clustering accuracy and running speed [<xref ref-type="bibr" rid="CR23">23</xref>] (Fig.Â <xref rid="Fig3" ref-type="fig">3</xref>a). Clustering for scATAC-seq is more challenging, because the large number of peaks (<italic>cis</italic>-elements) and the predominantly binary read count at each peak in each cell from diploid genomes result in bigger yet sparser data matrices. We performed a systematic benchmark analysis using both simulated and published datasets on published scATAC-seq clustering methods, including scABC [<xref ref-type="bibr" rid="CR23">23</xref>] and latent semantic indexing [<xref ref-type="bibr" rid="CR39">39</xref>] followed by graph-based clustering (termed LSI here), cisTopic [<xref ref-type="bibr" rid="CR24">24</xref>] followed by density-based clustering (termed cisTopic here), and snapATAC [<xref ref-type="bibr" rid="CR17">17</xref>]. Our comparisons, together with a recent study assessing the performance of 10 scATAC-seq methods [<xref ref-type="bibr" rid="CR40">40</xref>], suggested that LSI-based method is robust to sequencing depth and has the overall higher clustering accuracy (AdditionalÂ fileÂ <xref rid="MOESM4" ref-type="media">4</xref>: Section A). Besides, LSI shows the best computing efficiency among all the tools tested (AdditionalÂ fileÂ <xref rid="MOESM2" ref-type="media">2</xref>: Table S2). Therefore, we implemented LSI as the default scATAC-seq clustering method in MAESTRO but also incorporated cisTopic as an alternative option (Fig.Â <xref rid="Fig3" ref-type="fig">3</xref>b).
<fig id="Fig3"><label>Fig. 3</label><caption><p>Clustering, cell-type, and transcriptional regulator annotation using MAESTRO. <bold>a</bold> UMAP visualization of human PBMC scRNA-seq (12k cells) clusters. Colors represent the different clusters with the cluster ID labeled. <bold>b</bold> UMAP visualization of human PBMC scATAC-seq (10k cells) clusters. Colors represent the different clusters with cluster ID labeled. <bold>c</bold> UMAP visualization of human PBMC scRNA-seq (12k cells) clusters. Colors represent the different cell types. The cell-type information for each cluster is annotated using the expression level of marker genes. <bold>d</bold> UMAP visualization of human PBMC scATAC-seq (10k cells) clusters. Colors represent the different cell types. The cell-type information for each cluster is annotated using the regulatory potential of marker genes. <bold>e</bold> The rank of driver transcription regulators in the CD14 monocyte cells of PBMC scRNA-seq (12k cells). The regulators are ranked by the TF enrichment score from LISA results in cluster-specific genes, and the color of the circles represents the averaged expression level of corresponding regulators in CD14 monocyte cells. The names of the top 10 TFs are labeled on the graph. <bold>f</bold> The rank of driver transcription regulators in the CD14 monocyte cells of PBMC scATAC-seq (10k cells). The regulators are ranked by the TF enrichment score from GIGGLE results in cluster-specific peaks, and the color of the circles represents the averaged regulatory potential of corresponding regulators in CD14 monocyte cells. The names of the top 10 TFs are labeled on the graph</p></caption><graphic xlink:href="13059_2020_2116_Fig3_HTML" id="MO3"/></fig></p>
      <p id="Par11">Modeling gene activities from scATAC-seq is the key step for understanding the cell-type identity of each cluster. MAESTRO uses the single-cell regulatory potential to model gene activities [<xref ref-type="bibr" rid="CR41">41</xref>]. The presence of scATAC-seq peaks surrounding each gene reflects the potential transcriptional regulator (TR) bindings and their impact on the gene expression. Our regulatory potential (RP) model assumes that the effect of a scATAC-seq peak on the expression of a given gene is independent and additive, which follows an exponential decay with the distance from the peak to the transcription start site (TSS) (AdditionalÂ fileÂ <xref rid="MOESM3" ref-type="media">3</xref>: Fig. S2, see the â<xref rid="Sec12" ref-type="sec">Methods</xref>â section). Regulatory potential is calculated independently for each gene <italic>i</italic> in each cell <italic>j</italic> to reflect the accumulated regulation of the surrounding scATAC-seq peaks on the gene <italic>i</italic> and predict gene <italic>i</italic> expression in cell <italic>j</italic>. Besides increased promoter and enhancer accessibilities, active genes also have increased accessibility at the exon regions, which might reflect the binding of the RNA Pol II complex on chromatin during active transcription. In addition, we noticed that RP calculations could deviate from gene activity by the promoter and exon accessibilities of highly expressed genes nearby. Based on these observations, we implemented RP models with different combinations and tested their performances in integrating scATAC-seq with scRNA-seq (AdditionalÂ fileÂ <xref rid="MOESM4" ref-type="media">4</xref>: Section B). We set the âenhanced RP modelâ with the best association with the gene expression from scRNA-seq as the default to calculate the gene activity score in MAESTRO, but allow users to pick other models. This RP model still weighs peaks by exponential decay from TSS, but sums all peaks on the given gene exons as if they are on TSS, normalizes the sum by total exon length, and excludes the peaks from promoters and exons of nearby genes (AdditionalÂ fileÂ <xref rid="MOESM3" ref-type="media">3</xref>: Fig. S2).</p>
    </sec>
    <sec id="Sec6">
      <title>Automatic cell-type annotation</title>
      <p id="Par12">Annotating cell clusters from scRNA-seq is usually through marker genes from pre-existing knowledge. However, manual examination of the marker gene expression in each cluster is time-consuming and can create incompatible annotations between different datasets. MAESTRO could automatically annotate the cell type of clusters based on input signature files with lists of marker genes for each cell type. By default, MAESTRO includes signature files for immune cell types from CIBERSORT [<xref ref-type="bibr" rid="CR42">42</xref>] and brain cell types [<xref ref-type="bibr" rid="CR43">43</xref>] and optionally allows users to add custom cell-type signatures (AdditionalÂ fileÂ <xref rid="MOESM5" ref-type="media">5</xref>: Table S3). For each cell cluster, MAESTRO calculates the average expression log fold change of marker genes in this cluster as compared to all the other cells, and the cell type with the highest expression log fold changes of marker genes is assigned to the cluster (AdditionalÂ fileÂ <xref rid="MOESM3" ref-type="media">3</xref>: Fig. S3a). Clusters with average log fold change below zero for all the cell-type signatures are left unannotated, as they might represent rare populations of previously unknown cell types (see the â<xref rid="Sec12" ref-type="sec">Methods</xref>â section). To annotate the cell identity for scATAC-seq clusters, MAESTRO first uses regulatory potential to infer gene expression at the single-cell level. Then, the genes with differential regulatory potentials in a specific cluster compared to all other clusters can be used as markers to annotate the cluster cell type as if in scRNA-seq.</p>
      <p id="Par13">We conducted automatic cell-type annotation on clusters from human PBMC scRNA-seq and scATAC-seq dataset using MAESTRO (Fig.Â <xref rid="Fig3" ref-type="fig">3</xref>a, b) and were able to annotate the cell types for both technologies (Fig.Â <xref rid="Fig3" ref-type="fig">3</xref>c, d). Clusters from scRNA-seq display distinct expression of marker genes, enabling the annotation at both lineage and sub-lineage levels (AdditionalÂ fileÂ <xref rid="MOESM3" ref-type="media">3</xref>: Fig. S3b). In contrast, clusters from scATAC-seq could only be roughly annotated at the lineage level, suggesting that epigenetic profiles might reflect more lineage plasticity than transcriptome profiles (AdditionalÂ fileÂ <xref rid="MOESM3" ref-type="media">3</xref>: Fig. S3c). We further compared the performance of MAESTRO cell-type annotation with several existing software [<xref ref-type="bibr" rid="CR44">44</xref>, <xref ref-type="bibr" rid="CR45">45</xref>]. Using the LM22 immune signature [<xref ref-type="bibr" rid="CR42">42</xref>], MAESTRO could successfully annotate the majority of the cell types in a sorted PBMC scRNA-seq dataset [<xref ref-type="bibr" rid="CR16">16</xref>] (AdditionalÂ fileÂ <xref rid="MOESM3" ref-type="media">3</xref>: Fig. S3d) and with the highest accuracy by median F1-score (AdditionalÂ fileÂ <xref rid="MOESM3" ref-type="media">3</xref>: Fig. S3e). In addition, compared with other annotation tools that need cross-validation to train a classifier, MAESTRO shows good computational efficiency (AdditionalÂ fileÂ <xref rid="MOESM2" ref-type="media">2</xref>: Table S2). Taken together, these results suggest that MAESTRO could annotate cell types from both scRNA-seq and scATAC-seq accurately and efficiently.</p>
    </sec>
    <sec id="Sec7">
      <title>Inference of transcriptional regulators</title>
      <p id="Par14">In single-cell RNA-seq analyses, identifying the transcriptional regulators which drive differential expression is crucial to understanding the underlying gene regulatory networks [<xref ref-type="bibr" rid="CR46">46</xref>]. Our lab developed CistromeDB [<xref ref-type="bibr" rid="CR47">47</xref>], which collected and processed ~â24,000 ChIP-seq profiles for ~â1300 human and mouse transcriptional regulators. With this comprehensive dataset, MAESTRO incorporates LISA [<xref ref-type="bibr" rid="CR41">41</xref>] to predict the transcriptional regulators that shape the expression patterns in different scRNA-seq clusters. LISA builds an epigenetic model based on a list of cluster-specific genes and finds factors whose binding sites are most likely to regulate these genes. Since transcriptional regulators from the same family often have similar binding motifs and sometimes similar binding profiles, we grouped the transcription regulators with similar motifs (Pearsonâs correlation coefficient of motif profiles &gt;â0.7) [<xref ref-type="bibr" rid="CR48">48</xref>]. After LISA identifies the candidate transcription regulators, MAESTRO reports all the regulators in the same motif group that are expressed (AdditionalÂ fileÂ <xref rid="MOESM3" ref-type="media">3</xref>: Fig. S4a, b, AdditionalÂ fileÂ <xref rid="MOESM6" ref-type="media">6</xref>: Table S4, see the â<xref rid="Sec12" ref-type="sec">Methods</xref>â section). For example, LISA identifies STAT5B as the regulator in CD8 T cells; however, since the expression of STAT5B is not detected in CD8 T cells, MAESTRO reports STAT3, STAT4, and STAT1 instead, since they are expressed in CD8 T cells within the same regulator family (AdditionalÂ fileÂ <xref rid="MOESM3" ref-type="media">3</xref>: Fig. S4c, d).</p>
      <p id="Par15">To predict the driver regulators from scATAC-seq clusters, MAESTRO employs the GIGGLE [<xref ref-type="bibr" rid="CR49">49</xref>] method to identify the transcription regulators whose publicly available ChIP-seq profiles are highly enriched in the cluster-specific ATAC-seq peaks. Then, MAESTRO reports all the regulators that are predicted to be expressed, based on the regulatory potential, in the same motif family. For example, MAESTRO identified SPI1 (PU.1), CEBPA, CEBPB, and FLI1 as the top enriched regulators in the PBMC CD14 monocyte scATAC-seq cluster, which have been reported to be the lineage determinant factors for monocytes [<xref ref-type="bibr" rid="CR50">50</xref>]. Reassuringly, the regulators identifiedÂ from scRNA-seq and scATAC-seq of the same cell type are highly concordant, which increases the confidence of the MAESTRO-predicted driver regulators (Fig.Â <xref rid="Fig3" ref-type="fig">3</xref>e, f).</p>
    </sec>
    <sec id="Sec8">
      <title>Integrative analysis of scRNA-seq and scATAC-seq</title>
      <p id="Par16">Previous studies suggested that scRNA-seq has better power in defining cell types with distinct marker genes, while scATAC-seq is superior for the identification of lineage determinant regulators [<xref ref-type="bibr" rid="CR10">10</xref>, <xref ref-type="bibr" rid="CR39">39</xref>]. Integrative analysis of scRNA-seq and scATAC-seq combines the advantages of both data types to provide a deeper understanding of the gene regulation in the experimental system. To integrate the cells from scRNA-seq and scATAC-seq, MAESTRO first calculates the regulatory potential for each gene in each cell, which measures the scATAC-seq reads near the gene weighted by an exponential decay of the read distance to the gene TSS. Then, MAESTRO performs a canonical correlation analysis (CCA) [<xref ref-type="bibr" rid="CR28">28</xref>] between gene expression from scRNA-seq and regulatory potential from scATAC-seq. CCA captures the common variance between the two datasets and projects them into the same low-dimensional space, which essentially treats the two data platforms as two batches of data from the same platform (Fig.Â <xref rid="Fig4" ref-type="fig">4</xref>a). A pair of cells, one from scRNA-seq and the other from scATAC-seq, can be anchored using mutual nearest neighbors after dimension reduction [<xref ref-type="bibr" rid="CR51">51</xref>]. Then, MAESTRO transfers the cell-type labels from scRNA-seq to scATAC-seq using the anchored cell pairs (Fig.Â <xref rid="Fig4" ref-type="fig">4</xref>b). This approach can roughly preserve the original clustering structures after integration, which allows cell-type labels to be matched between scRNA-seq and scATAC-seq clusters.
<fig id="Fig4"><label>Fig. 4</label><caption><p>Integrated analysis of PBMC scRNA-seq and scATAC-seq data using MAESTRO. <bold>a</bold> UMAP visualization for joint clustering of human PBMC scRNA-seq (12k cells) and PBMC scATAC-seq (10k cells). Colors represent the cells from different technologies. The cells are joined by CCA on gene expression level and regulatory potential from MAESTRO. <bold>b</bold> UMAP visualization for joint clustering of human PBMC scRNA-seq and scATAC-seq. The cells are joined by CCA on the gene expression level and regulatory potential from MAESTRO. Colors represent the cell types, for which are generated using the scRNA-seq dataset and transferred to the scATAC-seq dataset. <bold>c</bold> The rank of driver regulators in CD14 monocyte cells of the PBMC dataset. The <italic>x</italic>-axis represents the TF enrichment score from LISA results in cluster-specific genes using scRNA-seq; the <italic>y</italic>-axis represents the TF enrichment score from GIGGLE results in cluster-specific peaks using scATAC-seq. The color of the circles represents the averaged expression level of corresponding regulators in CD14 monocyte scRNA-seq cells, and the size represents the TF enrichment score using GIGGLE in CD14 monocyte scATAC-seq cells. The names of the top 10 TFs from LISA and GIGGLE are labeled on the graph. <bold>d</bold> Comparison of transcriptional regulators predicted using scRNA-seq and scATAC-seq in each cell type for PBMC dataset. The <italic>y</italic>-axis represents the Spearmanâs correlation coefficient between LISA-predicted TF enrichment score and GIGGLE-predicted TF enrichment score for all the tested regulators. <bold>e</bold> Genome browser view of MS4A1 (B cells), CD8A (T cells), and HLA-DQA1 (monocytes and DCs) locus. The <italic>pseudo</italic>-bulk ATAC-seq profiles are generated by pooling together cells within each cell type. The <italic>y</italic>-axis represents the sequence depth-normalized ATAC-seq signals (reads per million mapped reads (RPM))</p></caption><graphic xlink:href="13059_2020_2116_Fig4_HTML" id="MO4"/></fig></p>
      <p id="Par17">The integration between scRNA-seq and scATAC-seq can improve regulator inference. After integrating scRNA-seq and scATAC-seq cells, MAESTRO combines the transcriptional regulators predicted from scRNA-seq (LISA) and scATAC-seq (GIGGLE) cluster and uses the rank product to combine the two. The final candidate regulators are further filtered based on the regulator expression from scRNA-seq (Fig.Â <xref rid="Fig4" ref-type="fig">4</xref>c, see the â<xref rid="Sec12" ref-type="sec">Methods</xref>â section). While the regulators in PBMC clusters that are predicted from scRNA-seq and scATAC-seq are mostly concordant (Fig.Â <xref rid="Fig4" ref-type="fig">4</xref>d), there are also interesting differences between the two approaches. For example, RXRA was only predicted to be a regulator from scATAC-seq in CD14 monocytes (Fig.Â <xref rid="Fig4" ref-type="fig">4</xref>c), and HDAC3 was only predicted to be a regulator from scATAC-seq in CD8 naive T cells (AdditionalÂ fileÂ <xref rid="MOESM3" ref-type="media">3</xref>: Fig. S5a). RXRA is known to control the innate inflammatory response through the upregulation of chemokine expression in monocytes [<xref ref-type="bibr" rid="CR52">52</xref>], while HDAC3 has been reported to restrain the CD8 lineage gene expression and maintain a bi-potential state for CD4+CD8+ cells [<xref ref-type="bibr" rid="CR53">53</xref>]. Those examples demonstrate that the transcription regulators predicted from scATAC-seq are sufficiently meaningful and can complement the predictions from scRNA-seq.</p>
      <p id="Par18">Integration can also make the prediction of the <italic>cis</italic>-elements in rare cell types possible. After transferring labels from scRNA-seq, we re-clustered the cells in the scATAC-seq data and formed pseudo-bulk samples for each cell type in the human PBMC dataset, with sub-lineage clusters and rare cell types recovered from scRNA-seq (Fig.Â <xref rid="Fig4" ref-type="fig">4</xref>e). To identify potentially rare <italic>cis</italic>-elements that were missed from the aggregated peak calls in the earlier step of the scATAC-seq analysis, we called peaks on each cell cluster separately (AdditionalÂ fileÂ <xref rid="MOESM3" ref-type="media">3</xref>: Fig. S5b). Although most of the peaks are already presented in the aggregated peak calls, in some rare populations such as plasmacytoid dendritic cells (pDCs), nearly 14% of the peaks are missing in the single-cell aggregated peak calls (AdditionalÂ fileÂ <xref rid="MOESM3" ref-type="media">3</xref>: Fig. S5c). Many of these cluster-specific new peaks, e.g., a <italic>cis</italic>-element in the intronic region of TSPAN13 which is specifically accessible in plasmacytoid dendritic cells (pDCs) (AdditionalÂ fileÂ <xref rid="MOESM3" ref-type="media">3</xref>: Fig. S5d,e), might be functional and regulate nearby genes in a cluster-specific manner.</p>
    </sec>
    <sec id="Sec9">
      <title>Analysis of bone marrow microenvironment in healthy donors and CLL patients</title>
      <p id="Par19">To demonstrate the performance of MAESTRO on complex sample types, we applied it to the scRNA-seq (5k cells) and scATAC-seq (9k cells) dataset of human bone marrow-derived mononuclear cells (BMMCs) from a healthy donor and a CLL patient. We first performed the alignment, quality control, clustering, and annotation on scRNA-seq and scATAC-seq dataset separately, then integrated the two (Fig.Â <xref rid="Fig5" ref-type="fig">5</xref>a, b). We combined the LM22 signatures as well as signatures from early-stage B cell development [<xref ref-type="bibr" rid="CR42">42</xref>, <xref ref-type="bibr" rid="CR54">54</xref>] to annotate the clusters, and identified four different B cell populations from scRNA-seq (pre-pro B, naive B, CLL 1 and CLL 2) (Fig.Â <xref rid="Fig5" ref-type="fig">5</xref>b and AdditionalÂ fileÂ <xref rid="MOESM3" ref-type="media">3</xref>: Fig. S6a). The cell-type labels were transferred to scATAC-seq clusters after integration (Fig.Â <xref rid="Fig5" ref-type="fig">5</xref>b and AdditionalÂ fileÂ <xref rid="MOESM3" ref-type="media">3</xref>: Fig. S6b).
<fig id="Fig5"><label>Fig. 5</label><caption><p>The dramatic change of bone marrow microenvironment in a CLL patient versus a healthy donor. <bold>a</bold> UMAP visualization for joint clustering of human BMMC scRNA-seq (5k cells) and scATAC-seq (9k cells) from the CLL patient and the healthy donor. Colors represent the cells from different technologies. The cells are joined by CCA on gene expression level and regulatory potential from MAESTRO. <bold>b</bold> UMAP visualization for joint clustering of human BMMC scRNA-seq (5k cells) and scATAC-seq (9k cells) from the CLL patient and the healthy donor. The cells are joined by CCA on gene expression level and regulatory potential from MAESTRO. Colors represent the cell types, which are generated using the scRNA-seq dataset and transferred to the scATAC-seq dataset. <bold>c</bold> Cell-type proportions of the CLL patient and the healthy donor. The total number of cells in each sample (CLL patients or healthy donors) should add up to 1. The scRNA-seq and scATAC-seq are quantified separately. Statistic significance is evaluated using two proportion <italic>z</italic> test, ***<italic>p</italic>â&lt;â2.2eâ16, *<italic>p</italic>ââ¤â0.05, <sup>N.S.</sup><italic>p</italic>â&gt;â0.05. <bold>d</bold> The rank of driver regulators in CLL1 (left) and CLL2 (right) cluster of the BMMC dataset. The <italic>x</italic>-axis represents the TF enrichment score from LISA result on differentially expressed genes between CLL1 and CLL2 clusters in scRNA-seq; the <italic>y</italic>-axis represents the TF enrichment score from GIGGLE result on differential peaks between CLL1 and CLL2 clusters in scATAC-seq. The color of the circles represents the averaged expression level of regulators in corresponding clusters of scRNA-seq, and the size represents the TF enrichment score using GIGGLE in corresponding clusters of scATAC-seq. The names of the top 10 TFs from LISA and GIGGLE are labeled on the graph</p></caption><graphic xlink:href="13059_2020_2116_Fig5_HTML" id="MO5"/></fig></p>
      <p id="Par20">We next investigated cell population changes in the CLL patient compared to the healthy donor. As expected, the two CLL clusters (CLL1 and CLL2) are mainly in the CLL patient, while the pre-pro B cell and naive B cell population are almost exclusively in the healthy donor (Fig.Â <xref rid="Fig5" ref-type="fig">5</xref>c). This observation suggests the dominance of malignant cells in the bone marrow of the CLL patient. Interestingly, immune cell diversity is much higher in the healthy donor compared to the CLL patient, with higher fractions of CD4 T, CD8 naive T, NK, monocyte, and mast cell populations. The only expanded population in CLL patients is CD8 activated T cells, supporting the major role of cytotoxic CD8 T cells in anti-tumor activity in CLL patients (Fig.Â <xref rid="Fig5" ref-type="fig">5</xref>c). Cell-type composition estimates are consistent between scRNA-seq and scATAC-seq, demonstrating MAESTROâs ability to robustly integrate scRNA-seq and scATAC-seq data from tissue samples with complex composition.</p>
      <p id="Par21">Our analysis suggests that the majority of B cells from the CLL patient are clustered into two distinct populations. The CLL1 cluster still preserves the ability to express IGHM, a gene highly expressed in pre-pro B cell and naive B cells (AdditionalÂ fileÂ <xref rid="MOESM3" ref-type="media">3</xref>: Fig. S6c). The CLL2 cluster highly expresses RGS1 (AdditionalÂ fileÂ <xref rid="MOESM3" ref-type="media">3</xref>: Fig. S6d), which was reported to be associated with poor prognosis in B cell malignancies [<xref ref-type="bibr" rid="CR55">55</xref>]. Hypothesizing that distinct regulators might drive gene expression in these two CLL populations, we applied MAESTRO to identify the cluster-specific regulators using the differentially expressed genes from scRNA-seq and differentially accessible peaks from scATAC-seq data between CLL1 and CLL2 clusters. Consistent with the gene expression pattern, the top predicted regulators in the CLL1 cluster are similar to the regulators in naive B cells, such as SPI1 and CREBBP (Fig.Â <xref rid="Fig5" ref-type="fig">5</xref>d and AdditionalÂ fileÂ <xref rid="MOESM3" ref-type="media">3</xref>: Fig. S6e, f). In contrast, the top MAESTRO-predicted regulators in the CLL2 cluster include TP53 and FOXP1, indicating that CLL2 might represent a distinct malignant cell population. TP53 is a well-known tumor suppressor and is frequently mutated or deleted in CLL patients [<xref ref-type="bibr" rid="CR56">56</xref>], while FOXP1 was reported to have an oncogenic role in B cell lymphoma and associated with poor clinical outcome [<xref ref-type="bibr" rid="CR57">57</xref>, <xref ref-type="bibr" rid="CR58">58</xref>]. In summary, these results demonstrated MAESTROâs utility in identifying transcriptional regulators from both scRNA-seq and scATAC-seq datasets in complex samples.</p>
    </sec>
    <sec id="Sec10">
      <title>MAESTRO outperforms other methods in integrating scATAC-seq with scRNA-seq</title>
      <p id="Par22">Finally, we sought to benchmark different computational methods, including SnapATAC, cicero, Seurat, and MAESTRO, on the performance of integrating scATAC-seq regulatory activities with scRNA-seq data. We evaluated the performance using three independent datasets: dataset #1, from the human PBMC from different donors (12k cells scRNA-seq and 10k cells scATAC-seq); dataset #2, from the human PBMC from the same donor (2k cells scRNA-seq and 10k cells scATAC-seq); and dataset #3, from the human BMMC from the same donor (5k cells scRNA-seq and 9k cells scATAC-seq, Fig.Â <xref rid="Fig6" ref-type="fig">6</xref> and AdditionalÂ fileÂ <xref rid="MOESM3" ref-type="media">3</xref>: Fig. S7). After label transfer using CCA, we generated the label prediction score distribution for all three datasets. Compared to the other three methods, the integration using MAESTRO regulatory potential model has overall higher prediction scores and a larger number of cells with high-quality predictions, defined as prediction score &gt;â0.5 (Fig.Â <xref rid="Fig6" ref-type="fig">6</xref>a, AdditionalÂ fileÂ <xref rid="MOESM3" ref-type="media">3</xref>: Fig. S8a, AdditionalÂ fileÂ <xref rid="MOESM7" ref-type="media">7</xref>: Table S5). For dataset #1, cicero failed to align memory B cells, CD 16 monocytes, and DC cells, and snapATAC failed to align pDC cells (AdditionalÂ fileÂ <xref rid="MOESM3" ref-type="media">3</xref>: Fig. S7 and AdditionalÂ fileÂ <xref rid="MOESM7" ref-type="media">7</xref>: Table S5). All of the tested methods failed to align CD4T naive, macrophage, and mast cells. The failure in integration might be due to the under-representation of macrophage and mast in the scATAC-seq dataset, as the scRNA-seq samples and scATAC-seq samples were collected from different donors. We indeed did not observe the macrophage and mast marker gene activity from the scATAC-seq dataset (AdditionalÂ fileÂ <xref rid="MOESM3" ref-type="media">3</xref>: Fig. S8b, c). In addition to these cell types in PBMC dataset from the different donors, MAESTRO has a 100% transfer rate for three datasets at the cluster level (AdditionalÂ fileÂ <xref rid="MOESM7" ref-type="media">7</xref>: Table S5).
<fig id="Fig6"><label>Fig. 6</label><caption><p>MAESTRO outperforms the existing software in integrating scRNA-seq and scATAC-seq dataset. <bold>a</bold> Comparison of the cell-type label prediction score distribution after integration of the scRNA-seq and scATAC-seq using gene activity scores from MAESTRO, Seurat, snapATAC, and cicero. The comparisons were made on three independent datasets: PBMC from different donors, PBMC from the same donor, and BMMC from the same donor. Statistical significance was evaluated using Wilcoxon rank-sum test. <bold>b</bold> Comparison of the consistency between gene expression and gene activity scores from MAESTRO, Seurat, snapATAC, and cicero. The comparisons were made on three independent datasets. The <italic>x</italic>-axis represents the different cell types, and the <italic>y</italic>-axis represents the Spearmanâs correlation coefficient between the expression level from scRNA-seq and gene activity score from scATAC-seq within each cluster. Only the top 2000 highly variable genes were used in the analysis</p></caption><graphic xlink:href="13059_2020_2116_Fig6_HTML" id="MO6"/></fig></p>
      <p id="Par23">We further evaluated the consistency between gene regulatory activities from scATAC-seq after label transfer and gene expression levels from scRNA-seq in the same cell type. Again, MAESTRO showed the best consistency in almost all the cell types, whether the correlation was calculated using all the genes or only the top 2000 variable genes (Fig.Â <xref rid="Fig6" ref-type="fig">6</xref>b and AdditionalÂ fileÂ <xref rid="MOESM3" ref-type="media">3</xref>: Fig. S8 d,e). Collectively, these analyses suggest that MAESTRO has the best performance not only in aligning the cells between scATAC-seq and scRNA-seq, but also in predicting the gene expression level from scATAC-seq.</p>
      <p id="Par24">To test the scalability of MAESTRO in handling large and complex single-cell dataset, we performed the integration analysis on a public basal cell carcinoma (BCC) scRNA-seq (53k cells) and scATAC-seq (38k cells and 0.5M peaks). MAESTRO could successfully cluster, annotate, and integrate scRNA-seq and scATAC-seq dataset (AdditionalÂ fileÂ <xref rid="MOESM3" ref-type="media">3</xref>: Fig. S9). This demonstrates MAESTROâs scalability and potential to be used in consortium projects for scRNA-seq and scATAC-seq such as <italic>Tabula Muris</italic> [<xref ref-type="bibr" rid="CR59">59</xref>] and Human Cell Atlas [<xref ref-type="bibr" rid="CR60">60</xref>].</p>
    </sec>
  </sec>
  <sec id="Sec11">
    <title>Discussion and conclusions</title>
    <p id="Par25">The recent development of single-cell technologies has brought paradigm shifts to investigating cellular diversity from a multi-omic perspective. While these technologies have wide applications in understanding complex biological systems such as tumor, brain, and immune and developmental systems, they also create numerous computational challenges. MAESTRO is a comprehensive analysis workflow that provides full analysis solutions for integrating scRNA-seq and scATAC-seq on multiple single-cell platforms. Compared with existing tools, the regulatory potential model adopted by MAESTRO is superior in integrating scATAC-seq data with scRNA-seq. In addition, the automatic cell-type annotation from MAESTRO is very useful, especially since the increasing number of single-cell datasets makes manual annotation more impractical. Although several methods have been developed for identifying regulators from scRNA-seq or scATAC-seq, most of them rely heavily on motif information and ignore cell type-specific TF binding [<xref ref-type="bibr" rid="CR17">17</xref>, <xref ref-type="bibr" rid="CR24">24</xref>, <xref ref-type="bibr" rid="CR25">25</xref>]. Using the comprehensive collection of ChIP-seq profiles on more than 1300 transcriptional regulators from CistromeDB, MAESTRO can robustly identify relevant regulators from both scRNA-seq and scATAC-seq datasets, and allow users to visualize the integrated predictions. We implemented MAESTRO using the Snakemake workflow [<xref ref-type="bibr" rid="CR35">35</xref>] and deposited the package under the Conda environment, which allowed MAESTRO to be installed and executed with simple commands. These features make MAESTRO an effective workflow for comprehensive and integrative analysis of scRNA-seq and scATAC-seq data.</p>
    <p id="Par26">MAESTRO models gene expression activity from scATAC-seq using a combination of two models: one related to the effects of <italic>cis</italic>-regulatory elements, the other related to the effects of transcription. The first is a regulatory potential model that has shown great efficacy in modeling the effect of TFs on regulating gene expression [<xref ref-type="bibr" rid="CR41">41</xref>, <xref ref-type="bibr" rid="CR61">61</xref>]. The second considers the peaks on exon regions, which includes possible alternative promoters, and removes interfering signals from adjacent promoters and exons. The combined model showed the best performance in gene expression prediction using scATAC-seq data. Recently, another model proposed in ArchR (Granja et al.) also uses the regulatory potential model [<xref ref-type="bibr" rid="CR41">41</xref>, <xref ref-type="bibr" rid="CR61">61</xref>] in combination with a gene body component to model the gene activity from scATAC-seq [<xref ref-type="bibr" rid="CR62">62</xref>]. ArchR uses a gene boundary model to exclude interference from other genes, although in cases such as near-neighbor divergently transcribed gene pairs, this is likely to eliminate many real long-range <italic>cis</italic>-regulatory effects [<xref ref-type="bibr" rid="CR63">63</xref>, <xref ref-type="bibr" rid="CR64">64</xref>]. In terms of gene body accessibility, ArchR considers the whole gene body while MAESTRO uses only the exon regions. Despite these differences, both MAESTRO and ArchR can model gene expression activity from scATAC-seq well, with comparable performance in integrating scATAC-seq with scRNA-seq.</p>
    <p id="Par27">Despite the aforementioned merits, MAESTRO still has some limitations which deserve future development. For example, in transcriptional regulator inference, information on the TF motifs bound by collaborating TFs might provide additional insights to distinguish the different family members to complement the clues from gene expression. Future machine learning approaches to infer TF binding sites from chromatin accessibility profiles could help improve this function. Currently, MAESTRO is able to handle large single-cell datasets of one million cells by processing all the gene expression and peak quantification matrices in the compressed sparse matrix format and stored using HDF5. However, MAESTRO analysis functions were built in R, so they have limited memory and processing efficiency. Future migration of the framework functions from R to Python and Cython, and deployment of the workflow on the Cloud will improve MAESTROâs capability in handling even bigger single-cell datasets.</p>
    <p id="Par28">The current integrated functions of MAESTRO, which support the analysis of scRNA-seq and scATAC-seq, can be adapted to other single-cell gene regulation techniques such as single-cell ChIP-seq [<xref ref-type="bibr" rid="CR65">65</xref>], cut &amp; tag [<xref ref-type="bibr" rid="CR66">66</xref>], or spatial transcriptomics [<xref ref-type="bibr" rid="CR67">67</xref>]. As single-cell datasets accumulate over time, MAESTRO not only provides a scalable and uniform workflow to process these data, but also benefits from these data in enhancing MAESTRO functions. For example, with more cell-type gene signatures generated from scRNA-seq datasets, the automatic cell-type annotation in MAESTRO will be more precise and could be further improved using supervised classification methods such as scmap [<xref ref-type="bibr" rid="CR45">45</xref>, <xref ref-type="bibr" rid="CR68">68</xref>] and cellAssign [<xref ref-type="bibr" rid="CR69">69</xref>]. If more scATAC-seq datasets become available, MAESTRO could generate a comprehensive atlas of cell type-specific regulatory landscapes. This atlas can in turn facilitate cell clustering, annotation, and regulatory modeling. We foresee MAESTRO becoming an important tool to help biologists with scRNA-seq and scATAC-seq data to derive a deeper understanding of cellular heterogeneity and regulatory dynamics.</p>
  </sec>
  <sec id="Sec12">
    <title>Methods</title>
    <sec id="Sec13">
      <title>MAESTRO pipeline</title>
      <sec id="Sec14">
        <title>Data formatting and barcode demultiplexing</title>
        <p id="Par29">MAESTRO supports multiple scRNA-seq and scATAC-seq platforms. ScRNA-seq from Smartseq2 protocols and scATAC-seq from microfluidics protocols do not need barcode demultiplexing. ScRNA-seq with variable barcodes like Drop-seq, inDrop, and 10X Genomics are demultiplexed using STARsolo according to the given barcode whitelist. ScATAC-seq data from sci-ATAC-seq, dsci-ATAC-seq, or 10X Genomics are demultiplexed using custom python codes.</p>
      </sec>
      <sec id="Sec15">
        <title>Alignment, sorting, and duplicates removal</title>
        <p id="Par30">After demultiplexing, reads are aligned to the hg38 or mm10 genome. MAESTRO uses STAR solo mode [<xref ref-type="bibr" rid="CR70">70</xref>] to align the scRNA-seq reads and minimap2 short-read mapping mode to align the scATAC-seq reads. All alignments are then sorted by genome coordination using samtools [<xref ref-type="bibr" rid="CR71">71</xref>]. PCR duplicates from the same barcodes are removed using the MarkDuplicates function from Picard tools.</p>
      </sec>
      <sec id="Sec16">
        <title>ScRNA-seq quality control and barcode selection</title>
        <p id="Par31">MAESTRO performs quality control for scRNA-seq in two aspects: the bulk and the single-cell levels. At the bulk level, MAESTRO summarizes the mapping statistics, reads quality, GC content, nucleotide composition bias, reads distribution, and gene body coverage using RseQC [<xref ref-type="bibr" rid="CR72">72</xref>]. The percentage of mapped reads indicates sample quality, as sample contamination or improper processing could decrease mappability. The CDS read distribution checks proper RNA processing and library preparation, which ensures accurate expression quantification. And the gene body coverage evaluates sample read bias over 3â² or 5â² of the transcripts. At the single-cell level, MAESTRO applies the following criteria to select high-quality barcodes: (1) the barcode should be found in more than 1000 unique reads or UMIs, (2) The barcode should be found in at least 500 genes, (3) no more than 5% of the reads containing this barcode could be aligned to the mitochondria genome, and (4) if spike-in is available, no more than 5% of the reads containing this barcode are spike-in reads. Only barcodes passing the single-cell QC are labeled as high-quality cells and used for downstream expression quantification and clustering analysis. All the QC parameters are configurable and can be tuned accordingly.</p>
      </sec>
      <sec id="Sec17">
        <title>ScATAC-seq quality control and barcode selection</title>
        <p id="Par32">MAESTRO performs quality control for scATAC-seq in two aspects as for scRNA-seq. At the bulk level, MAESTRO summarizes the mapping statistics and the fraction of mitochondria reads and reads in promoter regions and peak regions, and generates the fragment size distribution using custom codes. The percentage of duplicated reads shows whether the library is over-amplified due to limited starting material. The percentage of reads in mitochondria genes and peak regions is a widely used metric to evaluate the signal-to-noise ratio of ATAC-seq data quality [<xref ref-type="bibr" rid="CR1">1</xref>]. The last feature for bulk-level QC is fragment periodicity, which examines the insert size distribution of the sequenced fragments. It should show a periodicity of approximately 200âbp due to nucleosome protection of the chromatin to transposase cutting [<xref ref-type="bibr" rid="CR3">3</xref>]. At the single-cell level, MAESTRO applies the following criteria to select high-quality barcodes. (1) The barcode should be found in more than 1000 unique reads. (2) At least 10% of the reads containing the barcode should present in gene promoter regions. We observed that the peak calls from the single-cell aggregated data sometimes are dominated by the major populations, and barcodes filtering using the fraction of reads in peak regions (FRiP score) might eliminate the rare populations from the sample. Therefore, we used the fraction of reads in promoter regions instead of the FRiP score to filter the barcodes. (3) No more than 10% of the reads containing this barcode could be aligned to the mitochondria genome. Only barcodes passing the single-cell QC are labeled as high-quality cells and used in the downstream analysis. All the QC parameters are configurable and can be tuned accordingly.</p>
      </sec>
      <sec id="Sec18">
        <title>ScRNA-seq expression quantification</title>
        <p id="Par33">MAESTRO applies different algorithms to calculate the reads/UMI count from different scRNA-seq platforms. Data from Smartseq2 protocol are processed using RSEM to generate the read count for each transcript [<xref ref-type="bibr" rid="CR73">73</xref>]; data from Drop-seq or 10X Genomics platform are quantified using STARsolo. By default, MAESTRO stores all the data in memory in a sparse matrix and save the data to disk with HDF5 format, in order to achieve memory efficient and improve the scalability of MAESTRO.</p>
      </sec>
      <sec id="Sec19">
        <title>ScATAC-seq peak calling and binarization</title>
        <p id="Par34">For scATAC-seq data using microfluidics protocols, only cells passing QC are merged and called for peaks. For scATAC-seq data using sci-ATAC-seq, 10X Genomics, or other barcoded protocols, aligned bam files are directly used for peak calling. MAESTRO performs peak calling using MACS2 on the single-cell aggregated data [<xref ref-type="bibr" rid="CR74">74</xref>], with the options set as â-B -q 0.05 ânomodel âextsize=50 --SPMR.â Peaks overlapping with ENCODE blacklist [<xref ref-type="bibr" rid="CR75">75</xref>] are removed, and only peaks from autosome and chromosomes X and Y are used in the downstream analysis. MAESTRO also provides the option to add custom-defined <italic>cis</italic>-elements for downstream analysis. In the scATAC-seq dataset, the accessible elements in every single cell should be either on or off (1/0) due to the nature of the diploid genome. After peak calling, MAESTRO calculates the peak count for each barcode that passes QC and then converts the peak count matrix to binary matrix using custom python codes.</p>
      </sec>
      <sec id="Sec20">
        <title>Normalization</title>
        <p id="Par35">MAESTRO adopts Seurat for scRNA-seq normalization. By default, MAESTRO employs the global scaling normalization method in Seurat to scale the expression in each cell to 10,000, then log-transformed the result. For scATAC-seq data, no additional normalization methods are used if LSI or cisTopic is used for the clustering analysis [<xref ref-type="bibr" rid="CR24">24</xref>, <xref ref-type="bibr" rid="CR39">39</xref>]. If scABC is used for clustering analysis, the peak matrix will be weighted by the total number of peaks present in each cell [<xref ref-type="bibr" rid="CR23">23</xref>].</p>
      </sec>
      <sec id="Sec21">
        <title>Feature selection</title>
        <p id="Par36">For scRNA-seq data, MAESTRO employs the FindVariableFeatures function in Seurat to identify genes that exhibit high cell-to-cell variation [<xref ref-type="bibr" rid="CR28">28</xref>]. By default, MAESTRO uses the variance-stabilizing transformation (vst) to adjust the variance and returns the top 2000 genes with the highest standardized variance. No feature selection is performed for the scATAC-seq dataset, and all input peaks were used in the downstream dimension reduction analysis.</p>
      </sec>
      <sec id="Sec22">
        <title>Dimension reduction and determine significant components</title>
        <p id="Par37">For the scRNA-seq dataset, before dimension reduction, MAESTRO scales the expression matrix to make sure that the mean expression of each gene across cells is 0, and the variance across cells is 1. The users can also remove unwanted variations like mitochondrial contamination, different stages of cell cycle at this step, by providing unwanted variations as features to regress out. After scaling, MAESTRO performs principal component analysis (PCA) on top variable features to reduce the dimension of the dataset. An elbow plot is used to visualize the variance of each PC and identify the âelbowâ point to determine the significant PCs. If not set, the top 15 PCs are selected by default for downstream analysis. For the scATAC-seq dataset, both PCA and LSI are provided for dimension reduction. For LSI analysis, MAESTRO first computes the term frequency-inverse document frequency (TF-IDF) on the scATAC-seq peak count matrix, followed by singular value decomposition (SVD) to reduce the dimensionality to 50. Among our benchmark, TF-IDF transformation followed by SVD, Louvain algorithm for distance calculation, and <italic>K</italic>-nearest neighbor (KNN) analysis for cluster identification had the best performance in terms of clustering accuracy and structure; we thus set LSI as the default dimension reduction method for scATAC-seq data analysis. MAESTRO also adopts cisTopic to conduct topic modeling and reduce the dimension of the dataset; if cisTopic is selected, by default, 30 topics are used in the cisTopic analysis.</p>
      </sec>
      <sec id="Sec23">
        <title>Clustering</title>
        <p id="Par38">MAESTRO employs the graph-based clustering method in Seurat for scRNA-seq clustering analysis. Briefly, MAESTRO first builds a <italic>K</italic>-nearest neighbor (KNN) graph using the reduced dimensions from the previous step and then refines the edge weights between two cells based on the Jaccard similarity of their neighborhoods, this function is adopted from the FindNeighbors function in Seurat. To cluster the cells, MAESTRO uses the FindClusters function, which applies the Louvain algorithm to cluster cells together iteratively. The default clustering resolution for scRNA-seq is set to 0.6, and users can also tune the parameters for different conditions. For scATAC-seq clustering, if LSI is used, MAESTRO will perform similar graph building and cluster identifications like scRNA-seq analysis, and the default clustering resolution is set to 0.6. If cisTopic is used, MAESTRO performs Uniform Manifold Approximation and Projection (UMAP) [<xref ref-type="bibr" rid="CR76">76</xref>] analysis on the cell-topic distributions to further reduce the dataset to two dimensions and then applies a density-based clustering method DBSCAN [<xref ref-type="bibr" rid="CR77">77</xref>] to identify potential clusters; the default reachability distance is set to 0.75, and reachability minimum number of points is set to 10. If scABC is used, by default, MAESTRO sets <italic>K</italic> to 10 for the <italic>K</italic>-medoid clustering analysis.</p>
      </sec>
      <sec id="Sec24">
        <title>Visualization of single-cell clusters</title>
        <p id="Par39">The clustering results from both the scRNA-seq and scATAC-seq are visualized using UMAP. The UMAP function is already included in Seurat and cisTopic. To visualize the clustering result of scABC, MAESTRO adopts the uwot package and performs the UMAP analysis using the Spearmanâs correlation between different cells as the distance [<xref ref-type="bibr" rid="CR23">23</xref>].</p>
      </sec>
      <sec id="Sec25">
        <title>Differential expression and peak calling</title>
        <p id="Par40">For the scRNA-seq analysis in MAESTRO, we optimized the FindAllMarkers function in Seurat to perform differential expression and identify the positive markers for each cluster. The default differential expression method is achieved using âpresto,â a fast version of the Wilcox rank-sum test implemented in R, and other methods that had been already incorporated in Seurat like ROC, <italic>t</italic> test, MAST, and DESeq2 are also supported [<xref ref-type="bibr" rid="CR22">22</xref>, <xref ref-type="bibr" rid="CR38">38</xref>, <xref ref-type="bibr" rid="CR78">78</xref>]. Genes with a log fold change greater than 0.25, minimum presence fraction in cells of 0.25, and <italic>p</italic> value less than 1Eâ5 are identified as marker genes for each cluster. For the scATAC-seq analysis, MAESTRO first normalizes the binary peak count matrix by the number of peaks presented in each cell, then performs the differential peak analysis using âprestoâ on the normalized peak count matrix. Peaks with logFC greater than 0.1, minimum presence fraction in cells of 0.01, and <italic>p</italic> value less than 1Eâ5 are identified as cluster-specific peaks for each cluster. All these threshold parameters are tunable in the MAESTRO package.</p>
      </sec>
      <sec id="Sec26">
        <title>Regulatory potential score to quantify gene activity at the single-cell resolution for scATAC-seq</title>
        <p id="Par41">To model the gene activity from scATAC-seq, MAESTRO calculates the gene regulatory potential score for each gene in each cell using matrix multiplication based on the formula below.
<disp-formula id="Equa"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ R={W}^TB $$\end{document}</tex-math><mml:math id="M2" display="block"><mml:mi>R</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mi>W</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mi>B</mml:mi></mml:math><graphic xlink:href="13059_2020_2116_Article_Equa.gif" position="anchor"/></alternatives></disp-formula></p>
        <p id="Par42">Matrix <italic>B</italic> is a binary matrix output from the single-cell ATAC-seq peak calling and binarization, and <italic>B</italic><sub><italic>ij</italic></sub> represents the occurrence peak<sub><italic>i</italic></sub> in cell<sub><italic>j</italic></sub>. Matrix <italic>W</italic> represents the regulatory potential matrix, and <italic>W</italic><sub><italic>ij</italic></sub> represents the weight of regulatory potential of each peak<sub><italic>i</italic></sub> to each gene<sub><italic>j</italic></sub> calculated from an exponential function on the distance between the center of peak<sub><italic>i</italic></sub> and the transcription start site of gene<sub><italic>j</italic></sub> (<italic>d</italic><sub><italic>ij</italic></sub>) with a half-decay of <italic>d</italic><sub>0</sub>:
<disp-formula id="Equb"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {W}_{ij}={2}^{-\frac{d_{ij}}{d_0}} $$\end{document}</tex-math><mml:math id="M4" display="block"><mml:msub><mml:mi>W</mml:mi><mml:mi mathvariant="italic">ij</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mn>2</mml:mn><mml:mrow><mml:mo>â</mml:mo><mml:mfrac><mml:msub><mml:mi>d</mml:mi><mml:mi mathvariant="italic">ij</mml:mi></mml:msub><mml:msub><mml:mi>d</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mfrac></mml:mrow></mml:msup></mml:math><graphic xlink:href="13059_2020_2116_Article_Equb.gif" position="anchor"/></alternatives></disp-formula></p>
        <p id="Par43">The <italic>d</italic><sub>0</sub> can be customized by users, and our recommendation is that 1âkb shall be used for promoter-driven regulation and 10âkb shall be used for enhancer-driven regulation, and the default <italic>d</italic><sub>0</sub> for scATAC-seq is set to 10âkb. For a given gene<sub><italic>j</italic></sub>, if <italic>d</italic><sub><italic>ij</italic></sub> of peak<sub><italic>i</italic></sub> is over 150âkb, the weight <italic>W</italic><sub><italic>ij</italic></sub> will be less than 0.0005 if <italic>d</italic><sub>0</sub> is 10âkb. To save the computation time, we set the <italic>W</italic><sub><italic>ij</italic></sub> as 0 if the peak to TSS distance is over 150âkb. In an âenhanced RP model,â we did further adjustments to the weights. If the peak<sub><italic>i</italic></sub> is located at the exons region of the gene<sub><italic>j</italic></sub>, the weight <italic>W</italic><sub><italic>ij</italic></sub> is set to 1 first (as if <italic>d</italic><sub><italic>ij</italic></sub>â=â0), then further normalized by total exon length of the gene<sub><italic>j</italic></sub> (i.e., <italic>W</italic><sub><italic>ij</italic></sub>â=â1/total_exon_length); and if the peak<sub><italic>i</italic></sub> is located in the promoter or exon regions of any nearby genes, then <italic>W</italic><sub><italic>ij</italic></sub> is set to 0 (i.e., the peak is excluded). After the matrix multiplication, the matrix <italic>R</italic> stores the final scores of regulatory potential, in which <italic>R</italic><sub><italic>ij</italic></sub> represents gene<sub><italic>i</italic></sub>âs regulatory potential score in cell<sub><italic>j</italic></sub>.</p>
      </sec>
      <sec id="Sec27">
        <title>Cell-type annotation based on differentially expressed or regulated genes</title>
        <p id="Par44">MAESTRO performs automatic cell-type annotation in a supervised manner, which requires the pre-existing knowledge of marker genes for each cell type. Given the gene signatures of each cell type, for each cluster, MAESTRO calculates the summed logFC (cells in one cluster versus all other cells, which could be both positive or negative) of marker genes divided by log2 total number of marker genes as the cell-type scores of the input gene signature; the cell type of gene signature with the highest score is annotated as the cell-type identity of that cluster. The minimum gene signature score is set to 0, and if the score of all input signatures is less than 0, the cluster will be annotated as âothers.â By default, the immune LM22 gene signature from CIBERSORT [<xref ref-type="bibr" rid="CR42">42</xref>] is used to annotate the cell types (AdditionalÂ fileÂ <xref rid="MOESM2" ref-type="media">2</xref>: Table S2); we have also included signatures from adult mouse brain and <italic>Tabula Muris</italic> in the MAESTRO package [<xref ref-type="bibr" rid="CR43">43</xref>], and other user-defined signatures are also supported. For the scATAC-seq dataset, MAESTRO performs the cell-type annotation using the gene regulatory potential to represent the gene expression, and the logFC of gene regulatory potential between one cluster and all the other cells is used to calculate the gene signature scores.</p>
      </sec>
      <sec id="Sec28">
        <title>Cell-type annotation of scATAC-seq clusters based on bulk chromatin accessibility data</title>
        <p id="Par45">MAESTRO supports automatic cell-type annotation for scATAC-seq dataset using the publicly available bulk chromatin accessibility data. To generate a high-quality annotation index for scATAC-seq clusters, we first clustered the chromatin accessibility datasets (DNase-seq and ATAC-seq) in the Cistrome database into 80 clusters [<xref ref-type="bibr" rid="CR47">47</xref>]. Each Cistrome cluster identity was determined by the majority of cell type or tissue type information of datasets within that cluster. Then, the identity was assigned to all the datasets within that cluster. MAESTRO utilizes GIGGLE to evaluate the enrichment of bulk chromatin accessibility peaks on cluster-specific peaks from scATAC-seq data. It then transfers the Cistrome cluster annotation from the most enriched bulk chromatin accessibility data to the scATAC-seq cluster as its cell-type annotation.</p>
      </sec>
      <sec id="Sec29">
        <title>Prediction of driver regulators for scRNA-seq and scATAC-seq</title>
        <p id="Par46">Based on the marker genes or the cluster-specific peaks from each cluster, MAESTRO could predict the potential driver transcription regulators in each cell type. For the scRNA-seq dataset, MAESTRO incorporates LISA [<xref ref-type="bibr" rid="CR41">41</xref>], which utilizes the transcriptional regulator binding profiles from CistromeDB [<xref ref-type="bibr" rid="CR47">47</xref>] to identify the potential regulators shaping the expression pattern of each cluster. LISA first models the epigenetic landscape based on the input marker genes as well as public epigenomic profiles (DNase-seq, H3K27ac ChIP-seq) in CistromeDB, then performs in silico detection of TF binding sites on the epigenetic landscape to evaluate the essentiality of the transcriptional regulators. All the candidate regulators are ranked by their expression within that cluster to identify potential significant ones. For scATAC-seq, MAESTRO utilizes GIGGLE [<xref ref-type="bibr" rid="CR49">49</xref>] to evaluate the enrichment of transcriptional regulator ChIP-seq peaks on cluster-specific peaks from scATAC-seq data. The GIGGLE score is a composite of -log10 <italic>p</italic> value and log2 odds ratio after querying regulator peaks in the cluster-specific peaks. For the ChIP-seq dataset of the same factor, only the dataset with the highest GIGGLE score is kept. All the candidate regulators are further ranked by its RP within that cluster to identify potential significant ones. Currently, 1314 regulators, including both transcription factors and chromatin regulators, are supported in MAESTRO regulator analysis.</p>
      </sec>
      <sec id="Sec30">
        <title>Transcription factor clustering based on motif similarities</title>
        <p id="Par47">To improve the transcription factor prediction and correct the enrichment scores, MAESTRO clusters transcription factor based on motif similarities. We downloaded 769 and 529 positional weight matrices (PWM), which represent 680 human and 453 mouse transcription factors from the HOCOMOCO v11 database, respectively [<xref ref-type="bibr" rid="CR48">48</xref>]. Within each species, the similarity between TF motif models is calculated using the CCAT PWMclus tool [<xref ref-type="bibr" rid="CR79">79</xref>], which uses the Pearson correlation coefficient (PCC) weighted by information content as the similarities. We clustered the PWMs by hierarchical clustering and identified the motif clusters with the threshold of similarity greater than 0.7. For humans, 257 PWM clusters were identified and 109 of them contains two or more PWMs (AdditionalÂ fileÂ <xref rid="MOESM5" ref-type="media">5</xref>: Table S3). The highest enrichment score of TFs within the same motif clusters is assigned to all the TFs belong to that cluster, and the TFs are further ranked by the averaged expression level for scRNA-seq and regulatory potential level for scATAC-seq in that cluster. TFs with mean expression level equal to 0 or RP level less than 0.5 are filtered from the output. The driver TF candidates of the cluster should have both significant enrichment scores and expression levels.</p>
      </sec>
      <sec id="Sec31">
        <title>Visualization of marker genes or enriched regulators</title>
        <p id="Par48">MAESTRO provides two functions, âVisualizeVlnplotâ and âVisualizeUMAP,â for the visualization of the expression level or regulatory potential of marker genes or regulators in scRNA-seq and scATAC-seq datasets. Besides, MAESTRO provides a genome browser function âATACViewTracksâ for visualizing the scATAC-seq signals across the chromosome in different clusters. For better visualizing the predicted regulators, MAESTRO provides the function named VisualizeTFenrichment to generate the TF rank plot (as Fig.Â <xref rid="Fig3" ref-type="fig">3</xref>e, f and Fig.Â <xref rid="Fig4" ref-type="fig">4</xref>c) and only output the top 100 regulators in each cluster. The size of the point reflects the enrichment score of TFs from LISA for scRNA-seq and GIGGLE for scATAC-seq, and the color indicates the expression level from scRNA-seq or regulatory potential scores from scATAC-seq. If regulators are predicted from both scRNA-seq and scATAC-seq, MAESTRO will combine the ranks using the rank product and use the combined ranks to determine the top regulators. The candidates with gene expression levels equal to 0 are further removed from the output.</p>
      </sec>
      <sec id="Sec32">
        <title>Integrative analysis of scRNA-seq and scATAC-seq clusters</title>
        <p id="Par49">MAESTRO integrates the scRNA-seq and scATAC-seq clusters with canonical correlation analysis (CCA) and provides joint visualization of the cells together. The scRNA-seq clusters with cell-type annotations are generated in previous steps. The scATAC-seq clusters are generated based on the peak count matrix as described before. MAESTRO then attaches the gene regulatory potential matrix to the scATAC-seq clusters, scales and log-transforms the RP matrix, identifies variable features, and then combines the scRNA-seq clusters with scATAC-seq clusters using the FindTransferAnchors function incorporated in Seurat. After identifying the transfer anchors, the cell-type annotation from scRNA-seq clusters can be transferred to scATAC-seq clusters using the TransferData function. To visualize all the cells in the same low dimensional space, MAESTRO uses the same anchors during the label transferring analysis and imputed the scRNA-seq gene expression using scATAC-seq regulatory potential score on highly variable genes from scRNA-seq, for which default is set to the top 2000 variable genes. The measured scRNA-seq and imputed scRNA-seq data are then merged together and scaled to normalize the variance and mean. Finally, MAESTRO performs PCA for dimension reduction and uses UMAP to visualize all the cells together.</p>
      </sec>
      <sec id="Sec33">
        <title>Summary result and HTML output</title>
        <p id="Par50">For users to better understand the results from the MAESTRO workflow, we provide output files in HTML format to summarize the mapping statistics, quality control analysis from RseQC, single-cell QC plot, clustering result, cell-type annotation result, and transcription regulator predictions from LISA or GIGGLE. The HTML output contains three different sections, the scRNA-seq page, the scATAC-seq page, and the integration page (AdditionalÂ filesÂ <xref rid="MOESM8" ref-type="media">8</xref>, <xref rid="MOESM9" ref-type="media">9</xref>, and <xref rid="MOESM10" ref-type="media">10</xref>). The description of each result and the normal range of QC metrics are also included in the HTML output.</p>
      </sec>
    </sec>
    <sec id="Sec34">
      <title>Clustering evaluation based on the simulated scATAC-seq dataset</title>
      <p id="Par51">To benchmark the clustering performance of different methods on scATAC-seq datasets, we generated the simulated scATAC-seq dataset from bulk ATAC-seq experiments. The BAM files of ATAC-seq from 10 different cell types were downloaded from CistromeDB, using the accession numbers GSM1817207, GSM1876022, GSM2083780, GSM2243034, GSM2243040, GSM2386582, GSM2439074, GSM2476338, GSM2692563, and GSM2898847. We randomly sampled the reads from each BAM file and simulated 200 single-cell ATAC-seq datasets at 4 different sequence depths, which are 1000, 2500, 5000, and 10,000 total reads. For each sequencing depth, 2000 cells were generated in total for the 10 cell types. Then, we merged the simulated bam files and called peaks, generated the peak by cell binary count matrix, and performed clustering analysis using scABC, cisTopic, and LSI. For scABC, we set <italic>k</italic>â=â10 for the <italic>k</italic>-means-based clustering. For cisTopic, the topic number used was 30. For LSI, the top 50 dimensions are used after TF-IDF conversion, and the clustering resolution was set to 0.6. For snapATAC, we created a cell-by-bin matrix with 5âkb bin size for each sequencing depth and performed clustering using the default parameters in snapATAC. The clustering accuracy was evaluated using the normalized mutual information (NMI), with 0 representing no mutual information and 1 representing perfect match between two different labels, and was calculated using the âaricodeâ [<xref ref-type="bibr" rid="CR80">80</xref>] package in R.</p>
    </sec>
    <sec id="Sec35">
      <title>Clustering evaluation based on the published scATAC-seq dataset</title>
      <p id="Par52">We evaluated the clustering performance on public scATAC-seq datasets from 7 mixed cell lines (GSE65360 from GEO), cells from HSC lineages (GSE74310 and GSE96772 from GEO), and scATAC-seq from 10k PBMC cells [<xref ref-type="bibr" rid="CR81">81</xref>]. All the datasets were processed using the MAESTRO workflow from the fastq files. Cells with less than 1000 unique fragments or less than 10% of promoter enriched reads were removed from the analysis. For scABC, we set <italic>k</italic>â=â10 for the <italic>k</italic>-means-based clustering. For cisTopic, the topic number used was 30. For LSI, the top 50 dimensions are used after TF-IDF conversion, and the clustering resolution was set to 0.6. For snapATAC, we created a cell-by-bin matrix with 5âkb bin size for each dataset and performed clustering using the default parameters in snapATAC. For 7 cell line mixed dataset and HSC differentiation dataset, the original cell-type labels were used to calculate the NMI. For the PBMC dataset, we adopted the Residual Average Gini Index (RAGI) score from a recent publication to evaluate the clustering performance [<xref ref-type="bibr" rid="CR82">82</xref>]. We then calculated the averaged GINI index of marker genes from scRNA-seq between different clusters and compared them to the averaged GINI index calculated using housekeeping genes (<ext-link ext-link-type="uri" xlink:href="https://m.tau.ac.il/~elieis/HKG/HK_genes.txt">https://m.tau.ac.il/~elieis/HKG/HK_genes.txt</ext-link>). The difference of the averaged GINI index between marker genes and housekeeping genes was defined as RAGI scores.</p>
    </sec>
    <sec id="Sec36">
      <title>Analysis of 10X Genomics PBMC scRNA-seq and scATAC-seq dataset</title>
      <p id="Par53">The PBMC 12K scRNA-seq dataset and 10K scATAC-seq dataset from different donors (Dataset #1) were downloaded from the 10X Genomics website (<ext-link ext-link-type="uri" xlink:href="https://support.10xgenomics.com/single-cell-gene-expression/datasets/2.1.0/pbmc8k">https://support.10xgenomics.com/single-cell-gene-expression/datasets/2.1.0/pbmc8k</ext-link>, <ext-link ext-link-type="uri" xlink:href="https://support.10xgenomics.com/single-cell-gene-expression/datasets/2.1.0/pbmc4k">https://support.10xgenomics.com/single-cell-gene-expression/datasets/2.1.0/pbmc4k</ext-link>, <ext-link ext-link-type="uri" xlink:href="https://support.10xgenomics.com/single-cell-atac/datasets/1.1.0/atac_v1_pbmc_10k">https://support.10xgenomics.com/single-cell-atac/datasets/1.1.0/atac_v1_pbmc_10k</ext-link>). We merged the two scRNA-seq datasets together and confirmed that there is no significant batch effect between these two datasets. The PBMC 2K scRNA-seq and 10K scATAC-seq dataset from the same donor (dataset #2) were generated and shared by 10X Genomics. We processed all the PBMC datasets from fastq files using MAESTRO, with all parameters set to default. After clustering, we first annotated the cell type automatically using the LM22 gene signature from CIBERSORT, then manually corrected the annotation result and added annotations for some of the rare populations like pDC.</p>
    </sec>
    <sec id="Sec37">
      <title>Analysis of 10X Genomics BMMC scRNA-seq and scATAC-seq dataset</title>
      <p id="Par54">The 5K scRNA-seq and 9K scATAC-seq of BMMCs from a healthy donor and a CLL patient were generated and shared by 10X Genomics (dataset #3). We converted the bam files to fastq files using the bamtofastq function from CellRanger and processed the dataset using MAESTRO with all default parameters. To get a comprehensive understanding of the immune microenvironment change between the healthy donor and the CLL patient, we merged the scRNA-seq from the BMMC healthy donor and the CLL patient, and also merged the corresponding scATAC-seq datasets, and the ran MAESTRO on the merged dataset using RNA module and ATAC module, respectively. Then, we integrated the clusterings from RNA and ATAC analyses. The scRNA-seq clusters were first annotated using LM22 gene signatures; however, as the BMMC microenvironment contains plenty of premature B cells, we further manually checked the expression of SELL, MME, CD19, MS4A1, CD79A, IGHM, and IGHD and modified the misannotated cell types manually. By default, MAESTRO identifies driver regulators for each scRNA-seq and scATAC-seq clusters. To identify the differential regulators from CLL1 and CLL2 clusters, we also used MAESTRO to identify the regulators based on differential expressed genes and differential peaks between CLL1 and CLL2 clusters.</p>
    </sec>
    <sec id="Sec38">
      <title>Analysis of 10X Genomics basal cell carcinoma scRNA-seq and scATAC-seq dataset</title>
      <p id="Par55">We downloaded the processed expression matrix of 53K scRNA-seq from BCC microenvironment from the GEO database (GSE123814). Then, we performed the clustering analysis using MAESTRO with default parameters. The cell types for the scRNA-seq clusters were annotated using the meta-information provided in the original study. The BCC 38K scATAC-seq fragments and peak files were downloaded from the GEO database (GSE129785). We then lifted over the fragments and peaks from hg19 to hg38 and calculated the binarized peak count matrix based on the fragments and peak files. The gene activity scores were calculated using TSS 10K âenhanced RP modelâ in MAESTRO. Before clustering, we first filtered out the peaks only present in less than 50 cells and cells with less than 500 peaks. After clustering, we performed differential analysis and annotated the cell types using the annotations from the original study [<xref ref-type="bibr" rid="CR83">83</xref>]; we integrated the scATAC-seq with scRNA-seq using MAESTRO and transferred the cell-type labels from scRNA-seq to scATAC-seq.</p>
    </sec>
    <sec id="Sec39">
      <title>Evaluation of cell-type annotation performance using MAESTRO, Garnett, and SCINA</title>
      <p id="Par56">We used the published sorted PBMC dataset from Zheng et al. to evaluate the annotation performance of cell-type annotation [<xref ref-type="bibr" rid="CR16">16</xref>]. The dataset was downloaded and downsampled from a recent evaluation study [<xref ref-type="bibr" rid="CR84">84</xref>], which guaranteed each cell type has exactly 2000 cells. For SCINA, we first performed quantile normalization on the log-transformed expression matrix and annotated the dataset with the LM22 gene signature. For Garnett, we performed 5-fold cross-validation to train the classifier with both the LM22 gene signature and a simple immune cell-type signature from the Garnett package. For MAESTRO, we clustered all the cells with default parameters and annotated them using the LM22 gene signature. We adopted the median F1-score from Abdelaal et al., which measures the test accuracy by 2âÃâprecisionâÃârecall/(precisionâ+ârecall). All cell types, including both NK, T cell, B cell, monocyte, and granulocyte, were used to calculate the median F1-score.</p>
    </sec>
    <sec id="Sec40">
      <title>Evaluation of integration results from MAESTRO, Seurat, SnapATAC, and cicero</title>
      <p id="Par57">We integrated scRNA-seq and scATAC-seq using gene body accessibility score from snapATAC, co-accessibility gene score from cicero, promoter and gene body accessibility score from Seurat, and gene regulatory potential (TSS 10K âenhanced RP modelâ) from MAESTRO. All the integration analyses were performed using the CCA-based method and default parameters. We evaluate the integration performance from two aspects. The first aspect is to evaluate the performance of cell alignment between scRNA-seq and scATAC-seq. After label transferring using Seurat v3 [<xref ref-type="bibr" rid="CR28">28</xref>], we compared the distribution of the maximal label prediction scores for the integration using four different methods. Cells with a maximal prediction score higher than 0.5 are defined as having a high-quality prediction. Cells with low prediction scores were removed from the downstream analysis. We then compared the number of cells with high-quality prediction in each cluster using four different methods, to evaluate how confidently each method can align scATAC-seq with scRNA-seq (AdditionalÂ fileÂ <xref rid="MOESM7" ref-type="media">7</xref>: TableÂ 5). Another aspect is the consistency between gene expression level from scRNA-seq and gene activities from scATAC-seq. We grouped the scRNA-seq and scATAC-seq cells based on the cell-type annotation from scRNA-seq and calculated the averaged gene expression in scRNA-seq and averaged scATAC-seq gene accessibility scores for scATAC-seq for each gene. We then calculated the genome-wide Spearmanâs correlation coefficients between gene expression levels and gene accessibility levels, and the correlation reflected whether the gene activity score from scATAC-seq is a confident predictor of gene expression. In addition, we also calculated the averaged gene expression and gene accessibility score only on the top 2000 variable genes which were used in the integration analysis. We evaluated the consistency using Spearmanâs correlation coefficient. The <italic>p</italic> value of the correlation was determined by the cor.test in R.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary information</title>
    <sec id="Sec41">
      <supplementary-material content-type="local-data" id="MOESM1">
        <media xlink:href="13059_2020_2116_MOESM1_ESM.xlsx">
          <caption>
            <p><bold>Additional file 1: Table S1.</bold> Components of MAESTRO that achieved using the existing software and custom code.</p>
          </caption>
        </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM2">
        <media xlink:href="13059_2020_2116_MOESM2_ESM.xlsx">
          <caption>
            <p><bold>Additional file 2: Table S2.</bold> Running time and memory comparison between MAESTRO and other tools for scATAC-seq analysis.</p>
          </caption>
        </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM3">
        <media xlink:href="13059_2020_2116_MOESM3_ESM.docx">
          <caption>
            <p><bold>Additional file 3.</bold> Supplementary figures.</p>
          </caption>
        </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM4">
        <media xlink:href="13059_2020_2116_MOESM4_ESM.docx">
          <caption>
            <p><bold>Additional file 4.</bold> Supplementary materials.</p>
          </caption>
        </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM5">
        <media xlink:href="13059_2020_2116_MOESM5_ESM.xlsx">
          <caption>
            <p><bold>Additional file 5: Table S3.</bold> Immune and stromal gene signatures used in the analysis</p>
          </caption>
        </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM6">
        <media xlink:href="13059_2020_2116_MOESM6_ESM.xlsx">
          <caption>
            <p><bold>Additional file 6: Table S4.</bold> Transcription factor motif clusters used in MAESTRO workflow</p>
          </caption>
        </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM7">
        <media xlink:href="13059_2020_2116_MOESM7_ESM.xlsx">
          <caption>
            <p><bold>Additional file 7: Table S5.</bold> Number of cells in scATAC-seq that received transferred labels from scRNA-seq.</p>
          </caption>
        </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM8">
        <media xlink:href="13059_2020_2116_MOESM8_ESM.html">
          <caption>
            <p><bold>Additional file 8.</bold> HTML output for the scRNA-seq analysis on the human PBMC sample (12k cells) from different donors using MAESTRO.</p>
          </caption>
        </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM9">
        <media xlink:href="13059_2020_2116_MOESM9_ESM.html">
          <caption>
            <p><bold>Additional file 9.</bold> HTML output for the scATAC-seq analysis on the human PBMC sample (10k cells) from different donors using MAESTRO.</p>
          </caption>
        </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM10">
        <media xlink:href="13059_2020_2116_MOESM10_ESM.html">
          <caption>
            <p><bold>Additional file 10.</bold> HTML output for the integrated analysis of scRNA-seq (12k cells) and scATAC-seq (10k cells) datasets of human PBMC from different donors using MAESTRO.</p>
          </caption>
        </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM11">
        <media xlink:href="13059_2020_2116_MOESM11_ESM.docx">
          <caption>
            <p><bold>Additional file 11.</bold> Review history.</p>
          </caption>
        </media>
      </supplementary-material>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p>
        <bold>Publisherâs Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
    <fn>
      <p>Chenfei Wang and Dongqing Sun contributed equally to this work.</p>
    </fn>
  </fn-group>
  <sec>
    <title>Supplementary information</title>
    <p><bold>Supplementary information</bold> accompanies this paper at 10.1186/s13059-020-02116-x.</p>
  </sec>
  <ack>
    <title>Acknowledgements</title>
    <p>The authors acknowledge 10X Genomics for sharing the matched scRNA-seq and scATAC-seq dataset of human PBMCs from one healthy donor and human BMMCs from one CLL patient and one healthy donor. The authors would like to thank Li Song and Collin Tokheim for the helpful discussions.</p>
    <sec id="FPar1">
      <title>Peer review information</title>
      <p id="Par58">Yixin Yao was the primary editor of this article and managed its editorial process and peer review in collaboration with the rest of the editorial team.</p>
    </sec>
    <sec id="FPar2">
      <title>Review history</title>
      <p id="Par59">The review history is available as AdditionalÂ fileÂ <xref rid="MOESM11" ref-type="media">11</xref>.</p>
    </sec>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authorsâ contributions</title>
    <p>CFW and XSL conceived the project. CFW developed the algorithm, CFW, DS, CXW, and MT wrote the workflow. CFW, DS, XH, YH, and TL performed data analysis. QQ, JF, and CM developed LISA. CXW and CM helped with the design of the MAESTRO RP model and Cistrome DB integration. CFW, XSL, and TL wrote the manuscript with help from all other authors. XSL supervised the whole project. All authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>This work was supported by the Breast Cancer Foundation [BCRF-19-100 to XSL]Â andÂ the National Natural Science Foundation of China [81872290 to XSL], andÂ theÂ Chan ZuckerbergÂ Initiative [2020-219413 to TL].</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>The MAESTRO package is freely available under the GPL-3.0 license. The source code of MAESTRO can be found at the GitHub repository (<ext-link ext-link-type="uri" xlink:href="https://github.com/liulab-dfci/MAESTRO">https://github.com/liulab-dfci/MAESTRO</ext-link>) [<xref ref-type="bibr" rid="CR85">85</xref>] and Zenodo with the access code DOI: 10.5281/zenodo.3862812 [<xref ref-type="bibr" rid="CR86">86</xref>]. We also provide a docker version of the package at <ext-link ext-link-type="uri" xlink:href="https://hub.docker.com/r/winterdongqing/maestro">https://hub.docker.com/r/winterdongqing/maestro</ext-link>.</p>
    <p>The accession numbers for the public dataset used in this study include GSE65360, GSE74310, GSE96772, GSE123814, and GSE129785. Other public datasets are downloaded from 10X Genomics website (<ext-link ext-link-type="uri" xlink:href="https://support.10xgenomics.com/single-cell-gene-expression/datasets/2.1.0/pbmc8k">https://support.10xgenomics.com/single-cell-gene-expression/datasets/2.1.0/pbmc8k</ext-link>, <ext-link ext-link-type="uri" xlink:href="https://support.10xgenomics.com/single-cell-gene-expression/datasets/2.1.0/pbmc4k">https://support.10xgenomics.com/single-cell-gene-expression/datasets/2.1.0/pbmc4k</ext-link>, <ext-link ext-link-type="uri" xlink:href="https://support.10xgenomics.com/single-cell-atac/datasets/1.1.0/atac_v1_pbmc_10k">https://support.10xgenomics.com/single-cell-atac/datasets/1.1.0/atac_v1_pbmc_10k</ext-link>). Additional benchmark code used in this paper is deposited at the GitHub repository (<ext-link ext-link-type="uri" xlink:href="https://github.com/chenfeiwang/MAESTRO_benchmark">https://github.com/chenfeiwang/MAESTRO_benchmark</ext-link>) [<xref ref-type="bibr" rid="CR87">87</xref>] and Zenodo with the access code DOI: 10.5281/zenodo.3953145 [<xref ref-type="bibr" rid="CR88">88</xref>].</p>
  </notes>
  <notes id="FPar3">
    <title>Ethics approval and consent to participate</title>
    <p id="Par60">Not applicable.</p>
  </notes>
  <notes id="FPar4">
    <title>Consent for publication</title>
    <p id="Par61">Not applicable.</p>
  </notes>
  <notes id="FPar5" notes-type="COI-statement">
    <title>Competing interests</title>
    <p id="Par62">X.S.L.Â is a co-founder, board member, and Scientific Advisor of GV20 Oncotherapy, Scientific Advisory Board of 3DMed Care. The remaining authors declare that they have no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Consortium</surname>
            <given-names>EP</given-names>
          </name>
        </person-group>
        <article-title>An integrated encyclopedia of DNA elements in the human genome</article-title>
        <source>Nature</source>
        <year>2012</year>
        <volume>489</volume>
        <fpage>57</fpage>
        <lpage>74</lpage>
        <pub-id pub-id-type="pmid">22955616</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Brawand</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Soumillon</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Necsulea</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Julien</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Csardi</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Harrigan</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Weier</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Liechti</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Aximu-Petri</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Kircher</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The evolution of gene expression levels in mammalian organs</article-title>
        <source>Nature</source>
        <year>2011</year>
        <volume>478</volume>
        <fpage>343</fpage>
        <lpage>348</lpage>
        <?supplied-pmid 22012392?>
        <pub-id pub-id-type="pmid">22012392</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Buenrostro</surname>
            <given-names>JD</given-names>
          </name>
          <name>
            <surname>Giresi</surname>
            <given-names>PG</given-names>
          </name>
          <name>
            <surname>Zaba</surname>
            <given-names>LC</given-names>
          </name>
          <name>
            <surname>Chang</surname>
            <given-names>HY</given-names>
          </name>
          <name>
            <surname>Greenleaf</surname>
            <given-names>WJ</given-names>
          </name>
        </person-group>
        <article-title>Transposition of native chromatin for fast and sensitive epigenomic profiling of open chromatin, DNA-binding proteins and nucleosome position</article-title>
        <source>Nat Methods</source>
        <year>2013</year>
        <volume>10</volume>
        <fpage>1213</fpage>
        <lpage>1218</lpage>
        <?supplied-pmid 24097267?>
        <pub-id pub-id-type="pmid">24097267</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stubbington</surname>
            <given-names>MJT</given-names>
          </name>
          <name>
            <surname>Rozenblatt-Rosen</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Regev</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Teichmann</surname>
            <given-names>SA</given-names>
          </name>
        </person-group>
        <article-title>Single-cell transcriptomics to explore the immune system in health and disease</article-title>
        <source>Science</source>
        <year>2017</year>
        <volume>358</volume>
        <fpage>58</fpage>
        <lpage>63</lpage>
        <?supplied-pmid 28983043?>
        <pub-id pub-id-type="pmid">28983043</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Klein</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Mazutis</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Akartuna</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Tallapragada</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Veres</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Peshkin</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Weitz</surname>
            <given-names>DA</given-names>
          </name>
          <name>
            <surname>Kirschner</surname>
            <given-names>MW</given-names>
          </name>
        </person-group>
        <article-title>Droplet barcoding for single-cell transcriptomics applied to embryonic stem cells</article-title>
        <source>Cell</source>
        <year>2015</year>
        <volume>161</volume>
        <fpage>1187</fpage>
        <lpage>1201</lpage>
        <?supplied-pmid 26000487?>
        <pub-id pub-id-type="pmid">26000487</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Macosko</surname>
            <given-names>EZ</given-names>
          </name>
          <name>
            <surname>Basu</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Satija</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Nemesh</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Shekhar</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Goldman</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Tirosh</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Bialas</surname>
            <given-names>AR</given-names>
          </name>
          <name>
            <surname>Kamitaki</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Martersteck</surname>
            <given-names>EM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Highly parallel genome-wide expression profiling of individual cells using nanoliter droplets</article-title>
        <source>Cell</source>
        <year>2015</year>
        <volume>161</volume>
        <fpage>1202</fpage>
        <lpage>1214</lpage>
        <?supplied-pmid 26000488?>
        <pub-id pub-id-type="pmid">26000488</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Buenrostro</surname>
            <given-names>JD</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Litzenburger</surname>
            <given-names>UM</given-names>
          </name>
          <name>
            <surname>Ruff</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Gonzales</surname>
            <given-names>ML</given-names>
          </name>
          <name>
            <surname>Snyder</surname>
            <given-names>MP</given-names>
          </name>
          <name>
            <surname>Chang</surname>
            <given-names>HY</given-names>
          </name>
          <name>
            <surname>Greenleaf</surname>
            <given-names>WJ</given-names>
          </name>
        </person-group>
        <article-title>Single-cell chromatin accessibility reveals principles of regulatory variation</article-title>
        <source>Nature</source>
        <year>2015</year>
        <volume>523</volume>
        <fpage>486</fpage>
        <lpage>490</lpage>
        <?supplied-pmid 26083756?>
        <pub-id pub-id-type="pmid">26083756</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cusanovich</surname>
            <given-names>DA</given-names>
          </name>
          <name>
            <surname>Daza</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Adey</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Pliner</surname>
            <given-names>HA</given-names>
          </name>
          <name>
            <surname>Christiansen</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Gunderson</surname>
            <given-names>KL</given-names>
          </name>
          <name>
            <surname>Steemers</surname>
            <given-names>FJ</given-names>
          </name>
          <name>
            <surname>Trapnell</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Shendure</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Multiplex single cell profiling of chromatin accessibility by combinatorial cellular indexing</article-title>
        <source>Science</source>
        <year>2015</year>
        <volume>348</volume>
        <fpage>910</fpage>
        <lpage>914</lpage>
        <?supplied-pmid 25953818?>
        <pub-id pub-id-type="pmid">25953818</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shalek</surname>
            <given-names>AK</given-names>
          </name>
          <name>
            <surname>Satija</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Shuga</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Trombetta</surname>
            <given-names>JJ</given-names>
          </name>
          <name>
            <surname>Gennert</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Lu</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Gertner</surname>
            <given-names>RS</given-names>
          </name>
          <name>
            <surname>Gaublomme</surname>
            <given-names>JT</given-names>
          </name>
          <name>
            <surname>Yosef</surname>
            <given-names>N</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell RNA-seq reveals dynamic paracrine control of cellular variation</article-title>
        <source>Nature</source>
        <year>2014</year>
        <volume>510</volume>
        <fpage>363</fpage>
        <lpage>369</lpage>
        <?supplied-pmid 24919153?>
        <pub-id pub-id-type="pmid">24919153</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Satpathy</surname>
            <given-names>AT</given-names>
          </name>
          <name>
            <surname>Granja</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Yost</surname>
            <given-names>KE</given-names>
          </name>
          <name>
            <surname>Qi</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Meschi</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>McDermott</surname>
            <given-names>GP</given-names>
          </name>
          <name>
            <surname>Olsen</surname>
            <given-names>BN</given-names>
          </name>
          <name>
            <surname>Mumbach</surname>
            <given-names>MR</given-names>
          </name>
          <name>
            <surname>Pierce</surname>
            <given-names>SE</given-names>
          </name>
          <name>
            <surname>Corces</surname>
            <given-names>MR</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Massively parallel single-cell chromatin landscapes of human immune cell development and intratumoral T cell exhaustion</article-title>
        <source>Nat Biotechnol</source>
        <year>2019</year>
        <volume>37</volume>
        <fpage>925</fpage>
        <lpage>936</lpage>
        <?supplied-pmid 31375813?>
        <pub-id pub-id-type="pmid">31375813</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lake</surname>
            <given-names>BB</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Sos</surname>
            <given-names>BC</given-names>
          </name>
          <name>
            <surname>Fan</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Kaeser</surname>
            <given-names>GE</given-names>
          </name>
          <name>
            <surname>Yung</surname>
            <given-names>YC</given-names>
          </name>
          <name>
            <surname>Duong</surname>
            <given-names>TE</given-names>
          </name>
          <name>
            <surname>Gao</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Chun</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Kharchenko</surname>
            <given-names>PV</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>Integrative single-cell analysis of transcriptional and epigenetic states in the human adult brain</article-title>
        <source>Nat Biotechnol</source>
        <year>2018</year>
        <volume>36</volume>
        <fpage>70</fpage>
        <lpage>80</lpage>
        <?supplied-pmid 29227469?>
        <pub-id pub-id-type="pmid">29227469</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Puram</surname>
            <given-names>SV</given-names>
          </name>
          <name>
            <surname>Tirosh</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Parikh</surname>
            <given-names>AS</given-names>
          </name>
          <name>
            <surname>Patel</surname>
            <given-names>AP</given-names>
          </name>
          <name>
            <surname>Yizhak</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Gillespie</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Rodman</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Luo</surname>
            <given-names>CL</given-names>
          </name>
          <name>
            <surname>Mroz</surname>
            <given-names>EA</given-names>
          </name>
          <name>
            <surname>Emerick</surname>
            <given-names>KS</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell transcriptomic analysis of primary and metastatic tumor ecosystems in head and neck cancer</article-title>
        <source>Cell</source>
        <year>2017</year>
        <volume>171</volume>
        <fpage>1611</fpage>
        <lpage>1624</lpage>
        <?supplied-pmid 29198524?>
        <pub-id pub-id-type="pmid">29198524</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cao</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Spielmann</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Qiu</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Huang</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Ibrahim</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>Hill</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Mundlos</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Christiansen</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Steemers</surname>
            <given-names>FJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The single-cell transcriptional landscape of mammalian organogenesis</article-title>
        <source>Nature</source>
        <year>2019</year>
        <volume>566</volume>
        <fpage>496</fpage>
        <lpage>502</lpage>
        <?supplied-pmid 30787437?>
        <pub-id pub-id-type="pmid">30787437</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Han</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Zhou</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Fei</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Sun</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Lai</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Saadatpour</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Zhou</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Ye</surname>
            <given-names>F</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Mapping the mouse cell atlas by Microwell-Seq</article-title>
        <source>Cell</source>
        <year>2018</year>
        <volume>173</volume>
        <fpage>1307</fpage>
        <?supplied-pmid 29775597?>
        <pub-id pub-id-type="pmid">29775597</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stegle</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Teichmann</surname>
            <given-names>SA</given-names>
          </name>
          <name>
            <surname>Marioni</surname>
            <given-names>JC</given-names>
          </name>
        </person-group>
        <article-title>Computational and analytical challenges in single-cell transcriptomics</article-title>
        <source>Nat Rev Genet</source>
        <year>2015</year>
        <volume>16</volume>
        <fpage>133</fpage>
        <lpage>145</lpage>
        <?supplied-pmid 25628217?>
        <pub-id pub-id-type="pmid">25628217</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zheng</surname>
            <given-names>GX</given-names>
          </name>
          <name>
            <surname>Terry</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Belgrader</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Ryvkin</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Bent</surname>
            <given-names>ZW</given-names>
          </name>
          <name>
            <surname>Wilson</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Ziraldo</surname>
            <given-names>SB</given-names>
          </name>
          <name>
            <surname>Wheeler</surname>
            <given-names>TD</given-names>
          </name>
          <name>
            <surname>McDermott</surname>
            <given-names>GP</given-names>
          </name>
          <name>
            <surname>Zhu</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Massively parallel digital transcriptional profiling of single cells</article-title>
        <source>Nat Commun</source>
        <year>2017</year>
        <volume>8</volume>
        <fpage>14049</fpage>
        <?supplied-pmid 28091601?>
        <pub-id pub-id-type="pmid">28091601</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <mixed-citation publication-type="other">Fang R, Preissl S, Hou X, Lucero J, Wang X, Motamedi A, Shiau AK, Mukamel EA, Zhang Y, Behrens MM, et al: Fast and accurate clustering of single cell epigenomes reveals cis-regulatory elements in rare cell types. bioRxiv 2019:615179.</mixed-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhao</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Hu</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Huo</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>Dr.seq2: a quality control and analysis pipeline for parallel single cell transcriptome and epigenome data</article-title>
        <source>PLoS One</source>
        <year>2017</year>
        <volume>12</volume>
        <fpage>e0180583</fpage>
        <?supplied-pmid 28671995?>
        <pub-id pub-id-type="pmid">28671995</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kiselev</surname>
            <given-names>VY</given-names>
          </name>
          <name>
            <surname>Kirschner</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Schaub</surname>
            <given-names>MT</given-names>
          </name>
          <name>
            <surname>Andrews</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Yiu</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Chandra</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Natarajan</surname>
            <given-names>KN</given-names>
          </name>
          <name>
            <surname>Reik</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Barahona</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Green</surname>
            <given-names>AR</given-names>
          </name>
          <name>
            <surname>Hemberg</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>SC3: consensus clustering of single-cell RNA-seq data</article-title>
        <source>Nat Methods</source>
        <year>2017</year>
        <volume>14</volume>
        <fpage>483</fpage>
        <lpage>486</lpage>
        <?supplied-pmid 28346451?>
        <pub-id pub-id-type="pmid">28346451</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Xu</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Su</surname>
            <given-names>Z</given-names>
          </name>
        </person-group>
        <article-title>Identification of cell types from single-cell transcriptomes using a novel clustering method</article-title>
        <source>Bioinformatics</source>
        <year>2015</year>
        <volume>31</volume>
        <fpage>1974</fpage>
        <lpage>1980</lpage>
        <?supplied-pmid 25805722?>
        <pub-id pub-id-type="pmid">25805722</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kharchenko</surname>
            <given-names>PV</given-names>
          </name>
          <name>
            <surname>Silberstein</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Scadden</surname>
            <given-names>DT</given-names>
          </name>
        </person-group>
        <article-title>Bayesian approach to single-cell differential expression analysis</article-title>
        <source>Nat Methods</source>
        <year>2014</year>
        <volume>11</volume>
        <fpage>740</fpage>
        <lpage>742</lpage>
        <?supplied-pmid 24836921?>
        <pub-id pub-id-type="pmid">24836921</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Finak</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>McDavid</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Yajima</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Deng</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Gersuk</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Shalek</surname>
            <given-names>AK</given-names>
          </name>
          <name>
            <surname>Slichter</surname>
            <given-names>CK</given-names>
          </name>
          <name>
            <surname>Miller</surname>
            <given-names>HW</given-names>
          </name>
          <name>
            <surname>McElrath</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Prlic</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>MAST: a flexible statistical framework for assessing transcriptional changes and characterizing heterogeneity in single-cell RNA sequencing data</article-title>
        <source>Genome Biol</source>
        <year>2015</year>
        <volume>16</volume>
        <fpage>278</fpage>
        <?supplied-pmid 26653891?>
        <pub-id pub-id-type="pmid">26653891</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zamanighomi</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Daley</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Duren</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Schep</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Greenleaf</surname>
            <given-names>WJ</given-names>
          </name>
          <name>
            <surname>Wong</surname>
            <given-names>WH</given-names>
          </name>
        </person-group>
        <article-title>Unsupervised clustering and epigenetic classification of single cells</article-title>
        <source>Nat Commun</source>
        <year>2018</year>
        <volume>9</volume>
        <fpage>2410</fpage>
        <?supplied-pmid 29925875?>
        <pub-id pub-id-type="pmid">29925875</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <mixed-citation publication-type="other">Bravo Gonzalez-Blas C, Minnoye L, Papasokrati D, Aibar S, Hulselmans G, Christiaens V, Davie K, Wouters J, Aerts S: cisTopic: cis-regulatory topic modeling on single-cell ATAC-seq data. Nat Methods 2019, 16:397â400.</mixed-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schep</surname>
            <given-names>AN</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Buenrostro</surname>
            <given-names>JD</given-names>
          </name>
          <name>
            <surname>Greenleaf</surname>
            <given-names>WJ</given-names>
          </name>
        </person-group>
        <article-title>chromVAR: inferring transcription-factor-associated accessibility from single-cell epigenomic data</article-title>
        <source>Nat Methods</source>
        <year>2017</year>
        <volume>14</volume>
        <fpage>975</fpage>
        <lpage>978</lpage>
        <?supplied-pmid 28825706?>
        <pub-id pub-id-type="pmid">28825706</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pliner</surname>
            <given-names>HA</given-names>
          </name>
          <name>
            <surname>Packer</surname>
            <given-names>JS</given-names>
          </name>
          <name>
            <surname>McFaline-Figueroa</surname>
            <given-names>JL</given-names>
          </name>
          <name>
            <surname>Cusanovich</surname>
            <given-names>DA</given-names>
          </name>
          <name>
            <surname>Daza</surname>
            <given-names>RM</given-names>
          </name>
          <name>
            <surname>Aghamirzaie</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Srivatsan</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Qiu</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Jackson</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Minkina</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Cicero predicts cis-regulatory DNA interactions from single-cell chromatin accessibility data</article-title>
        <source>Mol Cell</source>
        <year>2018</year>
        <volume>71</volume>
        <fpage>858</fpage>
        <lpage>871</lpage>
        <?supplied-pmid 30078726?>
        <pub-id pub-id-type="pmid">30078726</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Trapnell</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Cacchiarelli</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Grimsby</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Pokharel</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Morse</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Lennon</surname>
            <given-names>NJ</given-names>
          </name>
          <name>
            <surname>Livak</surname>
            <given-names>KJ</given-names>
          </name>
          <name>
            <surname>Mikkelsen</surname>
            <given-names>TS</given-names>
          </name>
          <name>
            <surname>Rinn</surname>
            <given-names>JL</given-names>
          </name>
        </person-group>
        <article-title>The dynamics and regulators of cell fate decisions are revealed by pseudotemporal ordering of single cells</article-title>
        <source>Nat Biotechnol</source>
        <year>2014</year>
        <volume>32</volume>
        <fpage>381</fpage>
        <lpage>386</lpage>
        <?supplied-pmid 24658644?>
        <pub-id pub-id-type="pmid">24658644</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stuart</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Butler</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Hoffman</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Hafemeister</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Papalexi</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Mauck</surname>
            <given-names>WM</given-names>
            <suffix>3rd</suffix>
          </name>
          <name>
            <surname>Hao</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Stoeckius</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Smibert</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Satija</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Comprehensive integration of single-cell data</article-title>
        <source>Cell</source>
        <year>2019</year>
        <volume>177</volume>
        <fpage>1888</fpage>
        <lpage>1902</lpage>
        <?supplied-pmid 31178118?>
        <pub-id pub-id-type="pmid">31178118</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wolf</surname>
            <given-names>FA</given-names>
          </name>
          <name>
            <surname>Angerer</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Theis</surname>
            <given-names>FJ</given-names>
          </name>
        </person-group>
        <article-title>SCANPY: large-scale single-cell gene expression data analysis</article-title>
        <source>Genome Biol</source>
        <year>2018</year>
        <volume>19</volume>
        <fpage>15</fpage>
        <?supplied-pmid 29409532?>
        <pub-id pub-id-type="pmid">29409532</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Aibar</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Gonzalez-Blas</surname>
            <given-names>CB</given-names>
          </name>
          <name>
            <surname>Moerman</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Huynh-Thu</surname>
            <given-names>VA</given-names>
          </name>
          <name>
            <surname>Imrichova</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Hulselmans</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Rambow</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Marine</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Geurts</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Aerts</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>SCENIC: single-cell regulatory network inference and clustering</article-title>
        <source>Nat Methods</source>
        <year>2017</year>
        <volume>14</volume>
        <fpage>1083</fpage>
        <lpage>1086</lpage>
        <?supplied-pmid 28991892?>
        <pub-id pub-id-type="pmid">28991892</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stuart</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Satija</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Integrative single-cell analysis</article-title>
        <source>Nat Rev Genet</source>
        <year>2019</year>
        <volume>20</volume>
        <fpage>257</fpage>
        <lpage>272</lpage>
        <?supplied-pmid 30696980?>
        <pub-id pub-id-type="pmid">30696980</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Picelli</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Bjorklund</surname>
            <given-names>AK</given-names>
          </name>
          <name>
            <surname>Faridani</surname>
            <given-names>OR</given-names>
          </name>
          <name>
            <surname>Sagasser</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Winberg</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Sandberg</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Smart-seq2 for sensitive full-length transcriptome profiling in single cells</article-title>
        <source>Nat Methods</source>
        <year>2013</year>
        <volume>10</volume>
        <fpage>1096</fpage>
        <lpage>1098</lpage>
        <?supplied-pmid 24056875?>
        <pub-id pub-id-type="pmid">24056875</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lareau</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Duarte</surname>
            <given-names>FM</given-names>
          </name>
          <name>
            <surname>Chew</surname>
            <given-names>JG</given-names>
          </name>
          <name>
            <surname>Kartha</surname>
            <given-names>VK</given-names>
          </name>
          <name>
            <surname>Burkett</surname>
            <given-names>ZD</given-names>
          </name>
          <name>
            <surname>Kohlway</surname>
            <given-names>AS</given-names>
          </name>
          <name>
            <surname>Pokholok</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Aryee</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Steemers</surname>
            <given-names>FJ</given-names>
          </name>
          <name>
            <surname>Lebofsky</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Buenrostro</surname>
            <given-names>JD</given-names>
          </name>
        </person-group>
        <article-title>Droplet-based combinatorial indexing for massive-scale single-cell chromatin accessibility</article-title>
        <source>Nat Biotechnol</source>
        <year>2019</year>
        <volume>37</volume>
        <fpage>916</fpage>
        <lpage>924</lpage>
        <?supplied-pmid 31235917?>
        <pub-id pub-id-type="pmid">31235917</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fan</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Salathia</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Kaeser</surname>
            <given-names>GE</given-names>
          </name>
          <name>
            <surname>Yung</surname>
            <given-names>YC</given-names>
          </name>
          <name>
            <surname>Herman</surname>
            <given-names>JL</given-names>
          </name>
          <name>
            <surname>Kaper</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Fan</surname>
            <given-names>JB</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Chun</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Kharchenko</surname>
            <given-names>PV</given-names>
          </name>
        </person-group>
        <article-title>Characterizing transcriptional heterogeneity through pathway and gene set overdispersion analysis</article-title>
        <source>Nat Methods</source>
        <year>2016</year>
        <volume>13</volume>
        <fpage>241</fpage>
        <lpage>244</lpage>
        <?supplied-pmid 26780092?>
        <pub-id pub-id-type="pmid">26780092</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Koster</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Rahmann</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Snakemake-a scalable bioinformatics workflow engine</article-title>
        <source>Bioinformatics</source>
        <year>2018</year>
        <volume>34</volume>
        <fpage>3600</fpage>
        <?supplied-pmid 29788404?>
        <pub-id pub-id-type="pmid">29788404</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <mixed-citation publication-type="other">The Conda project [<ext-link ext-link-type="uri" xlink:href="https://anaconda.org">https://anaconda.org</ext-link>]. Accessed 10 Oct 2019.</mixed-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kiselev</surname>
            <given-names>VY</given-names>
          </name>
          <name>
            <surname>Andrews</surname>
            <given-names>TS</given-names>
          </name>
          <name>
            <surname>Hemberg</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Challenges in unsupervised clustering of single-cell RNA-seq data</article-title>
        <source>Nat Rev Genet</source>
        <year>2019</year>
        <volume>20</volume>
        <fpage>273</fpage>
        <lpage>282</lpage>
        <?supplied-pmid 30617341?>
        <pub-id pub-id-type="pmid">30617341</pub-id>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <mixed-citation publication-type="other">Korsunsky I, Nathan A, Millard N, Raychaudhuri S: Presto scales Wilcoxon and auROC analyses to millions of observations. bioRxiv 2019:653253.</mixed-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cusanovich</surname>
            <given-names>DA</given-names>
          </name>
          <name>
            <surname>Hill</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Aghamirzaie</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Daza</surname>
            <given-names>RM</given-names>
          </name>
          <name>
            <surname>Pliner</surname>
            <given-names>HA</given-names>
          </name>
          <name>
            <surname>Berletch</surname>
            <given-names>JB</given-names>
          </name>
          <name>
            <surname>Filippova</surname>
            <given-names>GN</given-names>
          </name>
          <name>
            <surname>Huang</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Christiansen</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>DeWitt</surname>
            <given-names>WS</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A single-cell atlas of in vivo mammalian chromatin accessibility</article-title>
        <source>Cell</source>
        <year>2018</year>
        <volume>174</volume>
        <fpage>1309</fpage>
        <lpage>1324</lpage>
        <?supplied-pmid 30078704?>
        <pub-id pub-id-type="pmid">30078704</pub-id>
      </element-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Lareau</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Andreani</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Vinyard</surname>
            <given-names>ME</given-names>
          </name>
          <name>
            <surname>Garcia</surname>
            <given-names>SP</given-names>
          </name>
          <name>
            <surname>Clement</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Andrade-Navarro</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Buenrostro</surname>
            <given-names>JD</given-names>
          </name>
          <name>
            <surname>Pinello</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>Assessment of computational methods for the analysis of single-cell ATAC-seq data</article-title>
        <source>Genome Biol</source>
        <year>2019</year>
        <volume>20</volume>
        <fpage>241</fpage>
        <?supplied-pmid 31739806?>
        <pub-id pub-id-type="pmid">31739806</pub-id>
      </element-citation>
    </ref>
    <ref id="CR41">
      <label>41.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Qin</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Fan</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Zheng</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Wan</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Mei</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Sun</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Brown</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Meyer</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>XS</given-names>
          </name>
        </person-group>
        <article-title>Lisa: inferring transcriptional regulators through integrative modeling of public chromatin accessibility and ChIP-seq data</article-title>
        <source>Genome Biol</source>
        <year>2020</year>
        <volume>21</volume>
        <fpage>32</fpage>
        <?supplied-pmid 32033573?>
        <pub-id pub-id-type="pmid">32033573</pub-id>
      </element-citation>
    </ref>
    <ref id="CR42">
      <label>42.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Newman</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>CL</given-names>
          </name>
          <name>
            <surname>Green</surname>
            <given-names>MR</given-names>
          </name>
          <name>
            <surname>Gentles</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Feng</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Hoang</surname>
            <given-names>CD</given-names>
          </name>
          <name>
            <surname>Diehn</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Alizadeh</surname>
            <given-names>AA</given-names>
          </name>
        </person-group>
        <article-title>Robust enumeration of cell subsets from tissue expression profiles</article-title>
        <source>Nat Methods</source>
        <year>2015</year>
        <volume>12</volume>
        <fpage>453</fpage>
        <lpage>457</lpage>
        <?supplied-pmid 25822800?>
        <pub-id pub-id-type="pmid">25822800</pub-id>
      </element-citation>
    </ref>
    <ref id="CR43">
      <label>43.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tasic</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Menon</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Nguyen</surname>
            <given-names>TN</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>TK</given-names>
          </name>
          <name>
            <surname>Jarsky</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Yao</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Levi</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Gray</surname>
            <given-names>LT</given-names>
          </name>
          <name>
            <surname>Sorensen</surname>
            <given-names>SA</given-names>
          </name>
          <name>
            <surname>Dolbeare</surname>
            <given-names>T</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Adult mouse cortical cell taxonomy revealed by single cell transcriptomics</article-title>
        <source>Nat Neurosci</source>
        <year>2016</year>
        <volume>19</volume>
        <fpage>335</fpage>
        <lpage>346</lpage>
        <?supplied-pmid 26727548?>
        <pub-id pub-id-type="pmid">26727548</pub-id>
      </element-citation>
    </ref>
    <ref id="CR44">
      <label>44.</label>
      <mixed-citation publication-type="other">Zhang Z, Luo D, Zhong X, Choi JH, Ma Y, Wang S, Mahrt E, Guo W, Stawiski EW, Modrusan Z, et al. SCINA: a semi-supervised subtyping algorithm of single cells and bulk samples. Genes (Basel). 2019;10.</mixed-citation>
    </ref>
    <ref id="CR45">
      <label>45.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pliner</surname>
            <given-names>HA</given-names>
          </name>
          <name>
            <surname>Shendure</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Trapnell</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Supervised classification enables rapid annotation of cell atlases</article-title>
        <source>Nat Methods</source>
        <year>2019</year>
        <volume>16</volume>
        <fpage>983</fpage>
        <lpage>986</lpage>
        <?supplied-pmid 31501545?>
        <pub-id pub-id-type="pmid">31501545</pub-id>
      </element-citation>
    </ref>
    <ref id="CR46">
      <label>46.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wagner</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Regev</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Yosef</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>Revealing the vectors of cellular identity with single-cell genomics</article-title>
        <source>Nat Biotechnol</source>
        <year>2016</year>
        <volume>34</volume>
        <fpage>1145</fpage>
        <lpage>1160</lpage>
        <?supplied-pmid 27824854?>
        <pub-id pub-id-type="pmid">27824854</pub-id>
      </element-citation>
    </ref>
    <ref id="CR47">
      <label>47.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zheng</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Wan</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Mei</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Qin</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Sun</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>CH</given-names>
          </name>
          <name>
            <surname>Brown</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Meyer</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>XS</given-names>
          </name>
        </person-group>
        <article-title>Cistrome Data Browser: expanded datasets and new tools for gene regulatory analysis</article-title>
        <source>Nucleic Acids Res</source>
        <year>2019</year>
        <volume>47</volume>
        <fpage>D729</fpage>
        <lpage>D735</lpage>
        <?supplied-pmid 30462313?>
        <pub-id pub-id-type="pmid">30462313</pub-id>
      </element-citation>
    </ref>
    <ref id="CR48">
      <label>48.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kulakovskiy</surname>
            <given-names>IV</given-names>
          </name>
          <name>
            <surname>Vorontsov</surname>
            <given-names>IE</given-names>
          </name>
          <name>
            <surname>Yevshin</surname>
            <given-names>IS</given-names>
          </name>
          <name>
            <surname>Sharipov</surname>
            <given-names>RN</given-names>
          </name>
          <name>
            <surname>Fedorova</surname>
            <given-names>AD</given-names>
          </name>
          <name>
            <surname>Rumynskiy</surname>
            <given-names>EI</given-names>
          </name>
          <name>
            <surname>Medvedeva</surname>
            <given-names>YA</given-names>
          </name>
          <name>
            <surname>Magana-Mora</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Bajic</surname>
            <given-names>VB</given-names>
          </name>
          <name>
            <surname>Papatsenko</surname>
            <given-names>DA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>HOCOMOCO: towards a complete collection of transcription factor binding models for human and mouse via large-scale ChIP-Seq analysis</article-title>
        <source>Nucleic Acids Res</source>
        <year>2018</year>
        <volume>46</volume>
        <fpage>D252</fpage>
        <lpage>D259</lpage>
        <?supplied-pmid 29140464?>
        <pub-id pub-id-type="pmid">29140464</pub-id>
      </element-citation>
    </ref>
    <ref id="CR49">
      <label>49.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Layer</surname>
            <given-names>RM</given-names>
          </name>
          <name>
            <surname>Pedersen</surname>
            <given-names>BS</given-names>
          </name>
          <name>
            <surname>DiSera</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Marth</surname>
            <given-names>GT</given-names>
          </name>
          <name>
            <surname>Gertz</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Quinlan</surname>
            <given-names>AR</given-names>
          </name>
        </person-group>
        <article-title>GIGGLE: a search engine for large-scale integrated genome analysis</article-title>
        <source>Nat Methods</source>
        <year>2018</year>
        <volume>15</volume>
        <fpage>123</fpage>
        <lpage>126</lpage>
        <?supplied-pmid 29309061?>
        <pub-id pub-id-type="pmid">29309061</pub-id>
      </element-citation>
    </ref>
    <ref id="CR50">
      <label>50.</label>
      <mixed-citation publication-type="other">Zhu YP, Thomas GD, Hedrick CC: 2014 Jeffrey M. Hoeg Award Lecture: transcriptional control of monocyte development. Arterioscler Thromb Vasc Biol 2016, 36:1722â1733.</mixed-citation>
    </ref>
    <ref id="CR51">
      <label>51.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Haghverdi</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Lun</surname>
            <given-names>ATL</given-names>
          </name>
          <name>
            <surname>Morgan</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>Marioni</surname>
            <given-names>JC</given-names>
          </name>
        </person-group>
        <article-title>Batch effects in single-cell RNA-sequencing data are corrected by matching mutual nearest neighbors</article-title>
        <source>Nat Biotechnol</source>
        <year>2018</year>
        <volume>36</volume>
        <fpage>421</fpage>
        <lpage>427</lpage>
        <?supplied-pmid 29608177?>
        <pub-id pub-id-type="pmid">29608177</pub-id>
      </element-citation>
    </ref>
    <ref id="CR52">
      <label>52.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nunez</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Alameda</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Rico</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Mota</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Gonzalo</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Cedenilla</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Fischer</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Bosca</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Glass</surname>
            <given-names>CK</given-names>
          </name>
          <name>
            <surname>Arroyo</surname>
            <given-names>AG</given-names>
          </name>
          <name>
            <surname>Ricote</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Retinoid X receptor alpha controls innate inflammatory responses through the up-regulation of chemokine expression</article-title>
        <source>Proc Natl Acad Sci U S A</source>
        <year>2010</year>
        <volume>107</volume>
        <fpage>10626</fpage>
        <lpage>10631</lpage>
        <?supplied-pmid 20498053?>
        <pub-id pub-id-type="pmid">20498053</pub-id>
      </element-citation>
    </ref>
    <ref id="CR53">
      <label>53.</label>
      <mixed-citation publication-type="other">Philips RL, Lee JH, Gaonkar K, Chanana P, Chung JY, Romero Arocha SR, Schwab A, Ordog T, Shapiro VS. HDAC3 restrains CD8-lineage genes to maintain a bi-potential state in CD4<sup>+</sup>CD8<sup>+</sup> thymocytes for CD4-lineage commitment. Elife. 2019;8.</mixed-citation>
    </ref>
    <ref id="CR54">
      <label>54.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hystad</surname>
            <given-names>ME</given-names>
          </name>
          <name>
            <surname>Myklebust</surname>
            <given-names>JH</given-names>
          </name>
          <name>
            <surname>Bo</surname>
            <given-names>TH</given-names>
          </name>
          <name>
            <surname>Sivertsen</surname>
            <given-names>EA</given-names>
          </name>
          <name>
            <surname>Rian</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Forfang</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Munthe</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Rosenwald</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Chiorazzi</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Jonassen</surname>
            <given-names>I</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Characterization of early stages of human B cell development by gene expression profiling</article-title>
        <source>J Immunol</source>
        <year>2007</year>
        <volume>179</volume>
        <fpage>3662</fpage>
        <lpage>3671</lpage>
        <?supplied-pmid 17785802?>
        <pub-id pub-id-type="pmid">17785802</pub-id>
      </element-citation>
    </ref>
    <ref id="CR55">
      <label>55.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Roh</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Shin</surname>
            <given-names>SJ</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>AN</given-names>
          </name>
          <name>
            <surname>Yoon</surname>
            <given-names>DH</given-names>
          </name>
          <name>
            <surname>Suh</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Park</surname>
            <given-names>CJ</given-names>
          </name>
          <name>
            <surname>Huh</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Park</surname>
            <given-names>CS</given-names>
          </name>
        </person-group>
        <article-title>RGS1 expression is associated with poor prognosis in multiple myeloma</article-title>
        <source>J Clin Pathol</source>
        <year>2017</year>
        <volume>70</volume>
        <fpage>202</fpage>
        <lpage>207</lpage>
        <?supplied-pmid 27445341?>
        <pub-id pub-id-type="pmid">27445341</pub-id>
      </element-citation>
    </ref>
    <ref id="CR56">
      <label>56.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Campo</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Cymbalista</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Ghia</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Jager</surname>
            <given-names>U</given-names>
          </name>
          <name>
            <surname>Pospisilova</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Rosenquist</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Schuh</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Stilgenbauer</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>TP53 aberrations in chronic lymphocytic leukemia: an overview of the clinical implications of improved diagnostics</article-title>
        <source>Haematologica</source>
        <year>2018</year>
        <volume>103</volume>
        <fpage>1956</fpage>
        <lpage>1968</lpage>
        <?supplied-pmid 30442727?>
        <pub-id pub-id-type="pmid">30442727</pub-id>
      </element-citation>
    </ref>
    <ref id="CR57">
      <label>57.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Barrans</surname>
            <given-names>SL</given-names>
          </name>
          <name>
            <surname>Fenton</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Banham</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Owen</surname>
            <given-names>RG</given-names>
          </name>
          <name>
            <surname>Jack</surname>
            <given-names>AS</given-names>
          </name>
        </person-group>
        <article-title>Strong expression of FOXP1 identifies a distinct subset of diffuse large B-cell lymphoma (DLBCL) patients with poor outcome</article-title>
        <source>Blood</source>
        <year>2004</year>
        <volume>104</volume>
        <fpage>2933</fpage>
        <lpage>2935</lpage>
        <?supplied-pmid 15238418?>
        <pub-id pub-id-type="pmid">15238418</pub-id>
      </element-citation>
    </ref>
    <ref id="CR58">
      <label>58.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lenz</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Wright</surname>
            <given-names>GW</given-names>
          </name>
          <name>
            <surname>Emre</surname>
            <given-names>NC</given-names>
          </name>
          <name>
            <surname>Kohlhammer</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Dave</surname>
            <given-names>SS</given-names>
          </name>
          <name>
            <surname>Davis</surname>
            <given-names>RE</given-names>
          </name>
          <name>
            <surname>Carty</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Lam</surname>
            <given-names>LT</given-names>
          </name>
          <name>
            <surname>Shaffer</surname>
            <given-names>AL</given-names>
          </name>
          <name>
            <surname>Xiao</surname>
            <given-names>W</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Molecular subtypes of diffuse large B-cell lymphoma arise by distinct genetic pathways</article-title>
        <source>Proc Natl Acad Sci U S A</source>
        <year>2008</year>
        <volume>105</volume>
        <fpage>13520</fpage>
        <lpage>13525</lpage>
        <?supplied-pmid 18765795?>
        <pub-id pub-id-type="pmid">18765795</pub-id>
      </element-citation>
    </ref>
    <ref id="CR59">
      <label>59.</label>
      <mixed-citation publication-type="other">Tabula Muris C, Overall c, logistical c, organ c, processing, library p, sequencing, computational data a, cell type a, writing g, et al: single-cell transcriptomics of 20 mouse organs creates a Tabula Muris. Nature 2018, 562:367â372.</mixed-citation>
    </ref>
    <ref id="CR60">
      <label>60.</label>
      <mixed-citation publication-type="other">Regev A, Teichmann SA, Lander ES, Amit I, Benoist C, Birney E, Bodenmiller B, Campbell P, Carninci P, Clatworthy M, et al. The Human Cell Atlas. Elife. 2017;6.</mixed-citation>
    </ref>
    <ref id="CR61">
      <label>61.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Wan</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Zheng</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Fan</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Dong</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Meyer</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>XS</given-names>
          </name>
        </person-group>
        <article-title>Cistrome-GO: a web server for functional enrichment analysis of transcription factor ChIP-seq peaks</article-title>
        <source>Nucleic Acids Res</source>
        <year>2019</year>
        <volume>47</volume>
        <fpage>W206</fpage>
        <lpage>W211</lpage>
        <?supplied-pmid 31053864?>
        <pub-id pub-id-type="pmid">31053864</pub-id>
      </element-citation>
    </ref>
    <ref id="CR62">
      <label>62.</label>
      <mixed-citation publication-type="other">Granja JM, Corces MR, Pierce SE, Bagdatli ST, Choudhry H, Chang HY, Greenleaf WJ: ArchR: an integrative and scalable software package for single-cell chromatin accessibility analysis. bioRxiv 2020:2020.2004.2028.066498.</mixed-citation>
    </ref>
    <ref id="CR63">
      <label>63.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lieberman-Aiden</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>van Berkum</surname>
            <given-names>NL</given-names>
          </name>
          <name>
            <surname>Williams</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Imakaev</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Ragoczy</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Telling</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Amit</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Lajoie</surname>
            <given-names>BR</given-names>
          </name>
          <name>
            <surname>Sabo</surname>
            <given-names>PJ</given-names>
          </name>
          <name>
            <surname>Dorschner</surname>
            <given-names>MO</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Comprehensive mapping of long-range interactions reveals folding principles of the human genome</article-title>
        <source>Science</source>
        <year>2009</year>
        <volume>326</volume>
        <fpage>289</fpage>
        <lpage>293</lpage>
        <?supplied-pmid 2858594?>
        <pub-id pub-id-type="pmid">19815776</pub-id>
      </element-citation>
    </ref>
    <ref id="CR64">
      <label>64.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>CH</given-names>
          </name>
          <name>
            <surname>Zheng</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Tokheim</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Dong</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Fan</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Wan</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Tang</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Brown</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>JS</given-names>
          </name>
          <name>
            <surname>Meyer</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>XS</given-names>
          </name>
        </person-group>
        <article-title>Determinants of transcription factor regulatory range</article-title>
        <source>Nat Commun</source>
        <year>2020</year>
        <volume>11</volume>
        <fpage>2472</fpage>
        <?supplied-pmid 32424124?>
        <pub-id pub-id-type="pmid">32424124</pub-id>
      </element-citation>
    </ref>
    <ref id="CR65">
      <label>65.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Grosselin</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Durand</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Marsolier</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Poitou</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Marangoni</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Nemati</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Dahmani</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Lameiras</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Reyal</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Frenoy</surname>
            <given-names>O</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>High-throughput single-cell ChIP-seq identifies heterogeneity of chromatin states in breast cancer</article-title>
        <source>Nat Genet</source>
        <year>2019</year>
        <volume>51</volume>
        <fpage>1060</fpage>
        <lpage>1066</lpage>
        <?supplied-pmid 31152164?>
        <pub-id pub-id-type="pmid">31152164</pub-id>
      </element-citation>
    </ref>
    <ref id="CR66">
      <label>66.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kaya-Okur</surname>
            <given-names>HS</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>SJ</given-names>
          </name>
          <name>
            <surname>Codomo</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Pledger</surname>
            <given-names>ES</given-names>
          </name>
          <name>
            <surname>Bryson</surname>
            <given-names>TD</given-names>
          </name>
          <name>
            <surname>Henikoff</surname>
            <given-names>JG</given-names>
          </name>
          <name>
            <surname>Ahmad</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Henikoff</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>CUT&amp;Tag for efficient epigenomic profiling of small samples and single cells</article-title>
        <source>Nat Commun</source>
        <year>2019</year>
        <volume>10</volume>
        <fpage>1930</fpage>
        <?supplied-pmid 31036827?>
        <pub-id pub-id-type="pmid">31036827</pub-id>
      </element-citation>
    </ref>
    <ref id="CR67">
      <label>67.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stahl</surname>
            <given-names>PL</given-names>
          </name>
          <name>
            <surname>Salmen</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Vickovic</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Lundmark</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Navarro</surname>
            <given-names>JF</given-names>
          </name>
          <name>
            <surname>Magnusson</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Giacomello</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Asp</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Westholm</surname>
            <given-names>JO</given-names>
          </name>
          <name>
            <surname>Huss</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Visualization and analysis of gene expression in tissue sections by spatial transcriptomics</article-title>
        <source>Science</source>
        <year>2016</year>
        <volume>353</volume>
        <fpage>78</fpage>
        <lpage>82</lpage>
        <?supplied-pmid 27365449?>
        <pub-id pub-id-type="pmid">27365449</pub-id>
      </element-citation>
    </ref>
    <ref id="CR68">
      <label>68.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kiselev</surname>
            <given-names>VY</given-names>
          </name>
          <name>
            <surname>Yiu</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Hemberg</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>scmap: projection of single-cell RNA-seq data across data sets</article-title>
        <source>Nat Methods</source>
        <year>2018</year>
        <volume>15</volume>
        <fpage>359</fpage>
        <lpage>362</lpage>
        <?supplied-pmid 29608555?>
        <pub-id pub-id-type="pmid">29608555</pub-id>
      </element-citation>
    </ref>
    <ref id="CR69">
      <label>69.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>AW</given-names>
          </name>
          <name>
            <surname>OâFlanagan</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Chavez</surname>
            <given-names>EA</given-names>
          </name>
          <name>
            <surname>Lim</surname>
            <given-names>JLP</given-names>
          </name>
          <name>
            <surname>Ceglia</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>McPherson</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Wiens</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Walters</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Chan</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Hewitson</surname>
            <given-names>B</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Probabilistic cell-type assignment of single-cell RNA-seq for tumor microenvironment profiling</article-title>
        <source>Nat Methods</source>
        <year>2019</year>
        <volume>16</volume>
        <fpage>1007</fpage>
        <lpage>1015</lpage>
        <?supplied-pmid 31501550?>
        <pub-id pub-id-type="pmid">31501550</pub-id>
      </element-citation>
    </ref>
    <ref id="CR70">
      <label>70.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dobin</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Davis</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Schlesinger</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Drenkow</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Zaleski</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Jha</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Batut</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Chaisson</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Gingeras</surname>
            <given-names>TR</given-names>
          </name>
        </person-group>
        <article-title>STAR: ultrafast universal RNA-seq aligner</article-title>
        <source>Bioinformatics</source>
        <year>2013</year>
        <volume>29</volume>
        <fpage>15</fpage>
        <lpage>21</lpage>
        <pub-id pub-id-type="pmid">23104886</pub-id>
      </element-citation>
    </ref>
    <ref id="CR71">
      <label>71.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Handsaker</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Wysoker</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Fennell</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Ruan</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Homer</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Marth</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Abecasis</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Durbin</surname>
            <given-names>R</given-names>
          </name>
          <collab>Genome Project Data Processing S</collab>
        </person-group>
        <article-title>The sequence alignment/map format and SAMtools</article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>25</volume>
        <fpage>2078</fpage>
        <lpage>2079</lpage>
        <?supplied-pmid 19505943?>
        <pub-id pub-id-type="pmid">19505943</pub-id>
      </element-citation>
    </ref>
    <ref id="CR72">
      <label>72.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>RSeQC: quality control of RNA-seq experiments</article-title>
        <source>Bioinformatics</source>
        <year>2012</year>
        <volume>28</volume>
        <fpage>2184</fpage>
        <lpage>2185</lpage>
        <?supplied-pmid 22743226?>
        <pub-id pub-id-type="pmid">22743226</pub-id>
      </element-citation>
    </ref>
    <ref id="CR73">
      <label>73.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Dewey</surname>
            <given-names>CN</given-names>
          </name>
        </person-group>
        <article-title>RSEM: accurate transcript quantification from RNA-Seq data with or without a reference genome</article-title>
        <source>BMC Bioinformatics</source>
        <year>2011</year>
        <volume>12</volume>
        <fpage>323</fpage>
        <?supplied-pmid 3163565?>
        <pub-id pub-id-type="pmid">21816040</pub-id>
      </element-citation>
    </ref>
    <ref id="CR74">
      <label>74.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Meyer</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Eeckhoute</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Johnson</surname>
            <given-names>DS</given-names>
          </name>
          <name>
            <surname>Bernstein</surname>
            <given-names>BE</given-names>
          </name>
          <name>
            <surname>Nusbaum</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Myers</surname>
            <given-names>RM</given-names>
          </name>
          <name>
            <surname>Brown</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>XS</given-names>
          </name>
        </person-group>
        <article-title>Model-based analysis of ChIP-Seq (MACS)</article-title>
        <source>Genome Biol</source>
        <year>2008</year>
        <volume>9</volume>
        <fpage>R137</fpage>
        <?supplied-pmid 18798982?>
        <pub-id pub-id-type="pmid">18798982</pub-id>
      </element-citation>
    </ref>
    <ref id="CR75">
      <label>75.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Amemiya</surname>
            <given-names>HM</given-names>
          </name>
          <name>
            <surname>Kundaje</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Boyle</surname>
            <given-names>AP</given-names>
          </name>
        </person-group>
        <article-title>The ENCODE blacklist: identification of problematic regions of the genome</article-title>
        <source>Sci Rep</source>
        <year>2019</year>
        <volume>9</volume>
        <fpage>9354</fpage>
        <?supplied-pmid 31249361?>
        <pub-id pub-id-type="pmid">31249361</pub-id>
      </element-citation>
    </ref>
    <ref id="CR76">
      <label>76.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>McInnes</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Healy</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Melville</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <source>UMAP: uniform manifold approximation and projection for dimension reduction</source>
        <year>2018</year>
      </element-citation>
    </ref>
    <ref id="CR77">
      <label>77.</label>
      <mixed-citation publication-type="other">Ester M, Kriegel H-P, #246, Sander R, Xu X: A density-based algorithm for discovering clusters a density-based algorithm for discovering clusters in large spatial databases with noise. In Proceedings of the Second International Conference on Knowledge Discovery and Data Mining. pp. 226â231. Portland, Oregon: AAAI Press; 1996:226â231.</mixed-citation>
    </ref>
    <ref id="CR78">
      <label>78.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Love</surname>
            <given-names>MI</given-names>
          </name>
          <name>
            <surname>Huber</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Anders</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Moderated estimation of fold change and dispersion for RNA-seq data with DESeq2</article-title>
        <source>Genome Biol</source>
        <year>2014</year>
        <volume>15</volume>
        <fpage>550</fpage>
        <?supplied-pmid 25516281?>
        <pub-id pub-id-type="pmid">25516281</pub-id>
      </element-citation>
    </ref>
    <ref id="CR79">
      <label>79.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jiang</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Singh</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>CCAT: Combinatorial Code Analysis Tool for transcriptional regulation</article-title>
        <source>Nucleic Acids Res</source>
        <year>2014</year>
        <volume>42</volume>
        <fpage>2833</fpage>
        <lpage>2847</lpage>
        <?supplied-pmid 24366875?>
        <pub-id pub-id-type="pmid">24366875</pub-id>
      </element-citation>
    </ref>
    <ref id="CR80">
      <label>80.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Vinh</surname>
            <given-names>NX</given-names>
          </name>
          <name>
            <surname>Epps</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Bailey</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Information theoretic measures for clusterings comparison: is a correction for chance necessary?</article-title>
        <source>Proceedings of the 26th Annual International Conference on Machine Learning</source>
        <year>2009</year>
        <publisher-loc>Montreal</publisher-loc>
        <publisher-name>ACM</publisher-name>
        <fpage>1073</fpage>
        <lpage>1080</lpage>
      </element-citation>
    </ref>
    <ref id="CR81">
      <label>81.</label>
      <mixed-citation publication-type="other">10X Genomics Datasets [<ext-link ext-link-type="uri" xlink:href="https://support.10xgenomics.com/single-cell-atac/datasets">https://support.10xgenomics.com/single-cell-atac/datasets</ext-link>]. Accessed 16 March 2019.</mixed-citation>
    </ref>
    <ref id="CR82">
      <label>82.</label>
      <mixed-citation publication-type="other">Chen H, Lareau C, Andreani T, Vinyard ME, Garcia SP, Clement K, Andrade-Navarro MA, Buenrostro JD, Pinello L: Assessment of computational methods for the analysis of single-cell ATAC-seq data. bioRxiv 2019:739011.</mixed-citation>
    </ref>
    <ref id="CR83">
      <label>83.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yost</surname>
            <given-names>KE</given-names>
          </name>
          <name>
            <surname>Satpathy</surname>
            <given-names>AT</given-names>
          </name>
          <name>
            <surname>Wells</surname>
            <given-names>DK</given-names>
          </name>
          <name>
            <surname>Qi</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Kageyama</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>McNamara</surname>
            <given-names>KL</given-names>
          </name>
          <name>
            <surname>Granja</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Sarin</surname>
            <given-names>KY</given-names>
          </name>
          <name>
            <surname>Brown</surname>
            <given-names>RA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Clonal replacement of tumor-specific T cells following PD-1 blockade</article-title>
        <source>Nat Med</source>
        <year>2019</year>
        <volume>25</volume>
        <fpage>1251</fpage>
        <lpage>1259</lpage>
        <?supplied-pmid 31359002?>
        <pub-id pub-id-type="pmid">31359002</pub-id>
      </element-citation>
    </ref>
    <ref id="CR84">
      <label>84.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Abdelaal</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Michielsen</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Cats</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Hoogduin</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Mei</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Reinders</surname>
            <given-names>MJT</given-names>
          </name>
          <name>
            <surname>Mahfouz</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>A comparison of automatic cell identification methods for single-cell RNA sequencing data</article-title>
        <source>Genome Biol</source>
        <year>2019</year>
        <volume>20</volume>
        <fpage>194</fpage>
        <?supplied-pmid 31500660?>
        <pub-id pub-id-type="pmid">31500660</pub-id>
      </element-citation>
    </ref>
    <ref id="CR85">
      <label>85.</label>
      <mixed-citation publication-type="other">Wang C, Sun D, Huang X, Wan C, Li Z, Han Y, Qin Q, Fan J, Qiu X, Xie Y, et al: Integrative analyses of single-cell transcriptome and regulome using MAESTRO. Source Code on Github 2020, <ext-link ext-link-type="uri" xlink:href="https://github.com/liulab-dfci/MAESTRO">https://github.com/liulab-dfci/MAESTRO</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR86">
      <label>86.</label>
      <mixed-citation publication-type="other">Wang C, Sun D, Huang X, Wan C, Li Z, Han Y, Qin Q, Fan J, Qiu X, Xie Y, et al: Integrative analyses of single-cell transcriptome and regulome using MAESTRO. Source Code on Zenodo 2020, 10.5281/zenodo.3862812.</mixed-citation>
    </ref>
    <ref id="CR87">
      <label>87.</label>
      <mixed-citation publication-type="other">Wang C, Sun D, Huang X, Wan C, Li Z, Han Y, Qin Q, Fan J, Qiu X, Xie Y, et al: Integrative analyses of single-cell transcriptome and regulome using MAESTRO. Analysis Code on Github 2020, <ext-link ext-link-type="uri" xlink:href="https://github.com/chenfeiwang/MAESTRO_benchmark">https://github.com/chenfeiwang/MAESTRO_benchmark</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR88">
      <label>88.</label>
      <mixed-citation publication-type="other">Wang C, Sun D, Huang X, Wan C, Li Z, Han Y, Qin Q, Fan J, Qiu X, Xie Y, et al: Integrative analyses of single-cell transcriptome and regulome using MAESTRO. Analysis Code on Zenodo 2020, 10.5281/zenodo.3953145.</mixed-citation>
    </ref>
  </ref-list>
</back>
