<?DTDIdentifier.IdentifierValue -//ES//DTD journal article DTD version 5.6.0//EN//XML?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName art560.dtd?>
<?SourceDTD.Version 5.6.0?>
<?ConverterInfo.XSLTName elsevier2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<?origin publisher?>
<?FILEmeta_COMM104991 xml ?>
<?FILEmain xml ?>
<?FILEgr1 jpg ?>
<?FILEgr2 jpg ?>
<?FILEgr3 jpg ?>
<?FILEgr4 jpg ?>
<?FILEgr5 jpg ?>
<?FILEgr6 jpg ?>
<?FILEgr7 jpg ?>
<?FILEmmc1 xml ?>
<?FILEsi1 svg ?>
<?FILEsi2 svg ?>
<?FILEsi3 svg ?>
<?FILEsi4 svg ?>
<?FILEsi5 svg ?>
<?FILEsi6 svg ?>
<?FILEsi7 svg ?>
<?FILEsi8 svg ?>
<?FILEsi9 svg ?>
<?FILEsi10 svg ?>
<?FILEsi11 svg ?>
<?FILEsi12 svg ?>
<?FILEsi13 svg ?>
<?FILEsi14 svg ?>
<?FILEsi15 svg ?>
<?properties open_access?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Comput Methods Programs Biomed</journal-id>
    <journal-id journal-id-type="iso-abbrev">Comput Methods Programs Biomed</journal-id>
    <journal-title-group>
      <journal-title>Computer Methods and Programs in Biomedicine</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">0169-2607</issn>
    <issn pub-type="epub">1872-7565</issn>
    <publisher>
      <publisher-name>Elsevier Scientific Publishers</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6718774</article-id>
    <article-id pub-id-type="publisher-id">S0169-2607(18)31370-1</article-id>
    <article-id pub-id-type="doi">10.1016/j.cmpb.2019.104991</article-id>
    <article-id pub-id-type="publisher-id">104991</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>CALIMA: The semi-automated open-source calcium imaging analyzer</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Radstake</surname>
          <given-names>F.D.W.</given-names>
        </name>
        <xref rid="aff0001" ref-type="aff">a</xref>
        <xref rid="fn1" ref-type="fn">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Raaijmakers</surname>
          <given-names>E.A.L.</given-names>
        </name>
        <email>e.a.l.raaijmakers@tue.nl</email>
        <xref rid="aff0002" ref-type="aff">b</xref>
        <xref rid="fn1" ref-type="fn">1</xref>
        <xref rid="cor0001" ref-type="corresp">⁎</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Luttge</surname>
          <given-names>R.</given-names>
        </name>
        <xref rid="aff0003" ref-type="aff">c</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Zinger</surname>
          <given-names>S.</given-names>
        </name>
        <xref rid="aff0001" ref-type="aff">a</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Frimat</surname>
          <given-names>J.P.</given-names>
        </name>
        <xref rid="aff0003" ref-type="aff">c</xref>
      </contrib>
    </contrib-group>
    <aff id="aff0001"><label>a</label>Department of Electrical Engineering, Signal Processing Systems Group, Eindhoven University of Technology, Eindhoven, the Netherlands</aff>
    <aff id="aff0002"><label>b</label>Department of Electrical Engineering, Electromagnetics Group, Eindhoven University of Technology, Eindhoven, the Netherlands</aff>
    <aff id="aff0003"><label>c</label>Department of Mechanical Engineering, Neuro-Nanoscale Engineering Group, Microsystems Section &amp; ICMS Institute for Complex Molecular Systems, Eindhoven University of Technology, the Netherlands</aff>
    <author-notes>
      <corresp id="cor0001"><label>⁎</label>Corresponding author. <email>e.a.l.raaijmakers@tue.nl</email></corresp>
      <fn id="fn1">
        <label>1</label>
        <p id="notep0001">Both authors contributed equally to this work.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="pmc-release">
      <day>1</day>
      <month>10</month>
      <year>2019</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on <pub-date
						pub-type="ppub">.-->
    <pub-date pub-type="ppub">
      <month>10</month>
      <year>2019</year>
    </pub-date>
    <volume>179</volume>
    <elocation-id>104991</elocation-id>
    <history>
      <date date-type="received">
        <day>20</day>
        <month>9</month>
        <year>2018</year>
      </date>
      <date date-type="rev-recd">
        <day>9</day>
        <month>7</month>
        <year>2019</year>
      </date>
      <date date-type="accepted">
        <day>19</day>
        <month>7</month>
        <year>2019</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2019 The Authors</copyright-statement>
      <copyright-year>2019</copyright-year>
      <license license-type="CC BY" xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article under the CC BY license (http://creativecommons.org/licenses/by/4.0/).</license-p>
      </license>
    </permissions>
    <abstract abstract-type="author-highlights" id="abs0001">
      <title>Highlights</title>
      <p>
        <list list-type="simple" id="celist0001">
          <list-item id="celistitem0001">
            <label>•</label>
            <p id="para0002">Although calcium imaging is widely used in biological research, there are relatively few tools available for its analysis. These tools often enable only part of the analysis or require expensive software packages to run. Here we proposed the semi-automated standalone open-source software tool CALIMA, and we show that it is a valuable addition to the field of calcium imaging. As demonstrated with three highly different real-life datasets, CALIMA can detect cells and their activity with high sensitivity. CALIMA furthermore enables the user to reconstruct a network, and allows the user to limit the length of neuronal connections in said network. As some cell types grow neurites of limited length, the latter option can help to study the communication in groups of such cells.</p>
          </list-item>
        </list>
      </p>
    </abstract>
    <abstract id="abs0002">
      <sec>
        <title>Background and objective</title>
        <p>Ever since its discovery, calcium imaging has proven its worth in discovering new insights into the mechanisms of cellular communication. Yet, the analysis of the data generated by calcium imaging experiments demands a large amount of time from researchers. Tools enabling automated and semi-automated analysis are available, but often they allow automating only a part of the data analysis process. Therefore, we developed CALIMA (<ext-link ext-link-type="uri" xlink:href="https://aethelraed.nl/calima" id="interref0001">https://aethelraed.nl/calima</ext-link>), a free and open-source standalone software tool that provides an opportunity to quickly detect cells, to obtain the calcium spikes, and to determine the underlying network structure of neuronal cell cultures.</p>
      </sec>
      <sec>
        <title>Methods</title>
        <p>Owing to the difference of Gaussians algorithm applied for the cell detection, CALIMA is able to detect regions of interest (ROIs) quickly. The z-scoring algorithm provides a means to set the requirements for spike detection, and the neuronal connections can be reconstructed by analyzing the cross-correlation between the cellular activity. We evaluated CALIMA's reliability, speed, and functionality with a special focus on neuronal cell detection and network reconstruction. The evaluation was performed by using real-life data such as a known example dataset (cultured primary rat cortical neurons, University of Pennsylvania) and by analyzing video graphic footage of in vitro brain cell samples (SH-SY5Y neuroblastoma cultures, one sample with synchronous neuron firing). The obtained results were compared to the corresponding outcomes observed on same datasets for other similar software solutions. Moreover, we compared the results of segmentation and peak detection analysis, the ones obtained using CALIMA and those acquired manually.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p>CALIMA was able to detect the cells in the cultures within seconds. The average sensitivity was 82% across the datasets checked, comparing favorably with the alternative software solutions. Using the correct parameters, CALIMA's Ca-spikes detection sensitivity reached 96%. Lastly, neuronal networks were reconstructed by combining the data on the ROI's activity and the cell's positions, finding the most likely inter-cell connections.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p>We found that CALIMA proved to be a robust and fast tool to analyze the data of experiments for the digital reconstruction of the neuronal cellular network while being able to process the analysis steps with minimal user input required and in a time efficient manner.</p>
      </sec>
    </abstract>
    <kwd-group id="keys0001">
      <title>Keywords</title>
      <kwd>Calcium imaging</kwd>
      <kwd>Segmentation</kwd>
      <kwd>Ca-spike detection</kwd>
      <kwd>Neuronal network reconstruction</kwd>
    </kwd-group>
  </article-meta>
</front>
<body>
  <sec id="sec0001">
    <label>1</label>
    <title>Introduction</title>
    <p id="para0007">Communication between adjacent neurons can be investigated through calcium (Ca) imaging. When this technique is applied, the cells are treated with a Ca-sensitive fluorescent dye. Consequently, events related to the release of calcium such as inter-neuronal communication can be tracked by fluorescence microscopy. This technique has proven its worth because with its help researchers have managed to explain the communication mechanism between muscle cells, heart cells, and neurons <xref rid="bib0001" ref-type="bibr">[1]</xref>.</p>
    <p id="para0008">Besides providing insights into various biological processes, this method can help in the understanding of diseases such as cancer, diabetes, or autoimmune diseases <xref rid="bib0002" ref-type="bibr">[2]</xref>.</p>
    <p id="para0009">The behavior of neuronal circuits depends not only on the properties of its cells, but also on the network topology <xref rid="bib0003" ref-type="bibr">[3]</xref>. Hence, the knowledge of the connections within a neuronal network and its spatiotemporal properties can provide an insight into gene activation patterns, physiological responses, and pivotal cellular decisions <xref rid="bib0004" ref-type="bibr">[4]</xref>.</p>
    <p id="para0010">While the technique can be applied on a wide range of cells for a variety of purposes, the required quantitative analysis is challenging. Namely, the cell bodies, so-called regions of interest (ROI), need to be determined, the calcium spikes detected, and a network of interacting cells constructed. While this can be done manually, it is a resource- and time-consuming task, especially given the large amount of data that is generally involved in computations. Hence, automation of the analysis is deemed helpful.</p>
    <p id="para0011">Although there are software solutions that allow automating the data analysis from an image stack, these solutions are often based on expensive software packages such as MATLAB <xref rid="bib0005" ref-type="bibr">[5]</xref>, <xref rid="bib0006" ref-type="bibr">[6]</xref>, <xref rid="bib0007" ref-type="bibr">[7]</xref>, <xref rid="bib0008" ref-type="bibr">[8]</xref> or automate only the cell segmentation and/or the identification of calcium spikes, and they lack the functionality to detect any networks of interacting cells <xref rid="bib0009" ref-type="bibr">[9]</xref>, <xref rid="bib0010" ref-type="bibr">[10]</xref>, <xref rid="bib0011" ref-type="bibr">[11]</xref>, although the identification of such networks is of paramount importance when working with neurons <xref rid="bib0012" ref-type="bibr">[12]</xref>. Some data types need to be pre-processed before they can be analyzed <xref rid="bib0007" ref-type="bibr">[7]</xref>, <xref rid="bib0013" ref-type="bibr">[13]</xref>, and some tools are handled through scripting <xref rid="bib0010" ref-type="bibr">[10]</xref>, which can cause difficulties for a novice programmer. Furthermore, to finalize the analysis, it often requires a decent amount of time and a detailed knowledge of a system in question <xref rid="bib0005" ref-type="bibr">[5]</xref>.</p>
    <p id="para0012">To aid in the analysis of the data required for calcium imaging, we developed a free and open-source standalone software tool: CALcium IMaging Analyzer (CALIMA, <ext-link ext-link-type="uri" xlink:href="https://aethelraed.nl/calima" id="interref0002">https://aethelraed.nl/calima</ext-link>), with the interface GUI shown in <xref rid="fig0001" ref-type="fig">Fig. 1</xref>. To evaluate the reliability, speed, and functionality of CALIMA, we used the experimental data obtained from primary rat cortical neurons <xref rid="bib0014" ref-type="bibr">[14]</xref> and in-house SH-SY5Y neuroblastoma cultures <xref rid="bib0015" ref-type="bibr">[15]</xref>. The ROIs and Ca-spike detection outcomes were validated against the results generated by a trained biologist, and several falsely detected or undetected cells and spikes were observed. Moreover, the output of the proposed data analysis method was compared to the output obtained by using alternative segmentation strategies available within various software solutions, viz. Active Contours (FluoroSNNAP) <xref rid="bib0013" ref-type="bibr">[13]</xref>, Otsu thresholding and intensity-based declumping (CellProfiler) <xref rid="bib0011" ref-type="bibr">[11]</xref>, Thresholding and Watershedding (ImageJ) <xref rid="bib0016" ref-type="bibr">[16]</xref>, and spatiotemporal independent component analysis (SIMA) <xref rid="bib0010" ref-type="bibr">[10]</xref>. The Ca-spikes detection results were compared to the results of an algorithm, which implies comparing spike shapes with a database values to determine the ROI activity (FluoroSNNAP) <xref rid="bib0013" ref-type="bibr">[13]</xref>.<fig id="fig0001"><label>Fig. 1</label><caption><p>Screenshot of CALIMA GUI showing the activity and rate of change for selected ROIs and cross-correlation between selected ROIs (left), a bar graph of the cross-correlation between selected cells (middle), a spatiotemporal map of the neuronal spikes (top right, circle size is proportional to the amount of activity of a ROI, while color indicates the average). The reconstructed neuronal network is overlaid on the footage (bottom right). Red arrows represent detected neuronal connections and their direction of communication.</p></caption><alt-text id="alt0001">Fig 1</alt-text><graphic xlink:href="gr1"/></fig></p>
  </sec>
  <sec id="sec0002">
    <label>2</label>
    <title>Theory</title>
    <p id="para0013">Several distinct stages are defined to process an image set using CALIMA as shown in <xref rid="fig0002" ref-type="fig">Fig. 2</xref>. As a starting step, the ROIs are detected based on the area covered by cells. Next, the calcium-based activity spikes are identified per each ROI. Lastly, the generated data are analyzed to reconstruct physically possible inter-cell connections. The sections below describe these steps in more detail. The process starts by loading a file or files of calcium imaging experiments. Images can be loaded in such formats as .png, .jpg, .bmp, .gif, or .tiff (no tiff-stacks). Loading video files is enabled using FFmpeg <xref rid="bib0017" ref-type="bibr">[17]</xref>, and the tool supports many formats including .avi, .wmv, and .mp4. The ROIs and analysis results can be exported as images or, in the case when the measured cell brightness and the detected communication network are also available, as .csv files.<fig id="fig0002"><label>Fig. 2</label><caption><p>Flowchart of the CALIMA algorithm.</p></caption><alt-text id="alt0002">Fig 2</alt-text><graphic xlink:href="gr2"/></fig></p>
    <sec id="sec0003">
      <label>2.1</label>
      <title>Cell detection</title>
      <p id="para0014">First, the user selects a representative frame of a video or an image set, which is used as a reference to detect the cells. To make the brighter cells distinguished against the dark background, the contrast is stretched first according to <xref rid="eqn0001" ref-type="disp-formula">Eq. (1)</xref>:<disp-formula id="eqn0001"><label>(1)</label><mml:math id="M1" altimg="si1.svg"><mml:mrow><mml:msub><mml:mi mathvariant="bold">I</mml:mi><mml:mrow><mml:mi mathvariant="normal">x</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">y</mml:mi></mml:mrow></mml:msub><mml:mo linebreak="goodbreak">=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi mathvariant="bold">O</mml:mi><mml:mrow><mml:mi mathvariant="normal">x</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">y</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mtext>min</mml:mtext><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mi mathvariant="bold">O</mml:mi><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>max</mml:mi><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mi mathvariant="bold">O</mml:mi><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mtext>min</mml:mtext><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mi mathvariant="bold">O</mml:mi><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p>
      <p id="para0015">Here the brightness of a certain pixel of the resulting image <bold>I</bold> at location (<italic>x,y</italic>) is determined as a function of the brightness of the same pixel on the original image <bold>O</bold> and the maximum and minimum brightness values that occur in the image. To filter out the weak inter-neuronal connections and noise, a Gaussian blurring filter is convolved with the frame image as described in <xref rid="eqn0002" ref-type="disp-formula">Eq. (2)</xref> to obtain the blurred version <bold>B</bold> of the image as described in <xref rid="eqn0003" ref-type="disp-formula">Eq. (3)</xref>:<disp-formula id="eqn0002"><label>(2)</label><mml:math id="M2" altimg="si2.svg"><mml:mrow><mml:msub><mml:mi mathvariant="bold">G</mml:mi><mml:mrow><mml:mi mathvariant="normal">x</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">y</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mi>σ</mml:mi><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo linebreak="goodbreak">=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac><mml:mtext>exp</mml:mtext><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mi>y</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula><disp-formula id="eqn0003"><label>(3)</label><mml:math id="M3" altimg="si3.svg"><mml:mrow><mml:mi mathvariant="bold">B</mml:mi><mml:mo linebreak="goodbreak">=</mml:mo><mml:mi mathvariant="bold">I</mml:mi><mml:mo linebreak="goodbreak">*</mml:mo><mml:mi mathvariant="bold">G</mml:mi><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mi mathvariant="normal">n</mml:mi></mml:msub><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula></p>
      <p id="para0016">The user-defined standard deviation σ<sub>n</sub> is used as the 2D standard deviation of the blurring filter. Subsequently, a difference of Gaussians (DOG) filter, the subtraction of the same image modified by two different Gaussian filters, is applied to the resulting image <bold>I</bold> as described in <xref rid="eqn0004" ref-type="disp-formula">Eq. (4)</xref> to separate the fluorescing cells from the darker background <xref rid="bib0018" ref-type="bibr">[18]</xref>:<disp-formula id="eqn0004"><label>(4)</label><mml:math id="M4" altimg="si4.svg"><mml:mrow><mml:mi mathvariant="bold">D</mml:mi><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mi mathvariant="normal">a</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mi>b</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo linebreak="goodbreak">=</mml:mo><mml:mi mathvariant="bold">B</mml:mi><mml:mo linebreak="goodbreak">*</mml:mo><mml:mi mathvariant="bold">G</mml:mi><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mi mathvariant="normal">a</mml:mi></mml:msub><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo linebreak="goodbreak">−</mml:mo><mml:mi mathvariant="bold">B</mml:mi><mml:mo linebreak="goodbreak">*</mml:mo><mml:mi mathvariant="bold">G</mml:mi><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mi>b</mml:mi></mml:msub><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula>where the resulting image <bold>D</bold> is defined as a function of the user-defined standard deviations σ<sub>a</sub> and σ<sub>b</sub>. In the resulting image, ROIs tend to be of a lighter shade than the background. Therefore, the image is compared to a user-defined brightness threshold <italic>th</italic> to determine, which pixels belong to the ROI in question. On the resulting binary image, a recursive function is used to identify clusters of adjacent pixels belonging to ROIs. To account for possible variations in the input data, of which the most important are zoom level, resolution, brightness and focus, all four parameters of the above-mentioned functions can be adjusted by the user, namely, the standard deviations of the three Gaussian filters and the threshold. For cases where the automatic detection does not suffice, it is also possible to add or remove ROIs manually. To speed up the ROI detection process, the aforementioned filters are separated and a separable convolution algorithm is implemented <xref rid="bib0019" ref-type="bibr">[19]</xref>. The processing speed of the convolution is further improved by using a multithreaded implementation where computation is distributed across several processor cores.</p>
    </sec>
    <sec id="sec0004">
      <label>2.2</label>
      <title>Spike detection</title>
      <p id="para0017">The brightness value of a ROI is related to the cell activity, but the base brightness varies greatly per each cell; for example, if two cells are both inactive, one may appear much brighter than another. To account for this effect, the rate of change in brightness per ROI is used for calcium spike detection instead of the brightness itself, as this is not affected by different mean brightness values <xref rid="bib0009" ref-type="bibr">[9]</xref>. This indicator is then used to detect calcium spikes via the z-scoring algorithm <xref rid="bib0020" ref-type="bibr">[20]</xref>.</p>
      <p id="para0018">For each ROI and for each frame <italic>n</italic>, the rate of change in brightness <bold>r</bold>[n] = <bold>b</bold>[n] - <bold>b</bold>[n-1] is calculated. The mean brightness <italic>µ<sub>l</sub></italic> and standard deviation <italic>σ<sub>l</sub></italic> are calculated within a temporal window of a user-defined length <italic>l</italic>, according to <xref rid="eqn0005" ref-type="disp-formula">Eqs. (5)</xref> and <xref rid="eqn0006" ref-type="disp-formula">(6)</xref>. Another user-defined parameter <italic>i</italic> limits the influence of spikes on the calculation of µ<sub>l</sub> and <italic>σ<sub>l</sub></italic> according to <xref rid="eqn0007" ref-type="disp-formula">Eqs. (7)</xref> and <xref rid="eqn0008" ref-type="disp-formula">(8)</xref> to increase the robustness of the algorithm <xref rid="bib0021" ref-type="bibr">[21]</xref>.</p>
      <p id="para0019">The z-score is then defined according to <xref rid="eqn0009" ref-type="disp-formula">Eq. (9)</xref>. Such frames, for which <bold><italic>z</italic></bold> is greater than the user-defined threshold <italic>th<sub>z</sub></italic>, and <bold>r</bold> is greater than the user-defined threshold <italic>th<sub>r</sub></italic>, are detected as calcium spikes in the resulting vector <bold><italic>s</italic></bold>, as described in <xref rid="eqn0010" ref-type="disp-formula">Eq. (10)</xref>. The user can compensate for spontaneous activity by setting the required minimum number of spikes detected for a ROI to be included in the analysis.<disp-formula id="eqn0005"><label>(5)</label><mml:math id="M5" altimg="si5.svg"><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="true">[</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="true">]</mml:mo></mml:mrow><mml:mo linebreak="goodbreak">=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>l</mml:mi></mml:mfrac><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mi>l</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:mi mathvariant="bold">r</mml:mi><mml:mrow><mml:mo stretchy="true">[</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="true">]</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula><disp-formula id="eqn0006"><label>(6)</label><mml:math id="M6" altimg="si6.svg"><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="true">[</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="true">]</mml:mo></mml:mrow><mml:mo linebreak="goodbreak">=</mml:mo><mml:msqrt><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mi>l</mml:mi></mml:mfrac><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mi>l</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mi mathvariant="bold">r</mml:mi><mml:mrow><mml:mo stretchy="true">[</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="true">]</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="true">[</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="true">]</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msqrt></mml:mrow></mml:math></disp-formula><disp-formula id="eqn0007"><label>(7)</label><mml:math id="M7" altimg="si7.svg"><mml:mrow><mml:msub><mml:mi mathvariant="bold">r</mml:mi><mml:mi mathvariant="normal">f</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="true">[</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="true">]</mml:mo></mml:mrow><mml:mo linebreak="goodbreak">=</mml:mo><mml:mrow><mml:mo stretchy="true">{</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi mathvariant="bold">r</mml:mi><mml:mi mathvariant="normal">i</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="true">[</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="true">]</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mspace width="0.33em"/><mml:mi>i</mml:mi><mml:mi>f</mml:mi><mml:mspace width="0.33em"/><mml:mi>s</mml:mi><mml:mrow><mml:mo stretchy="true">[</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="true">]</mml:mo></mml:mrow><mml:mo linebreak="badbreak">=</mml:mo><mml:mn>1</mml:mn><mml:mspace width="0.33em"/><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mspace width="0.33em"/><mml:mi>i</mml:mi><mml:mi>f</mml:mi><mml:mspace width="0.33em"/><mml:mfrac><mml:mrow><mml:mo>−</mml:mo><mml:mi mathvariant="bold">r</mml:mi><mml:mrow><mml:mo stretchy="true">[</mml:mo><mml:mi mathvariant="normal">n</mml:mi><mml:mo stretchy="true">]</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mi>μ</mml:mi><mml:mi mathvariant="normal">l</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="true">[</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="true">]</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="true">[</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="true">]</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo linebreak="badbreak">&gt;</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mi>r</mml:mi><mml:mrow><mml:mo stretchy="true">[</mml:mo><mml:mi mathvariant="normal">n</mml:mi><mml:mo stretchy="true">]</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mspace width="0.33em"/><mml:mi>o</mml:mi><mml:mi>t</mml:mi><mml:mi>h</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>w</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mi>e</mml:mi><mml:mspace width="0.33em"/></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:math></disp-formula><disp-formula id="eqn0008"><label>(8)</label><mml:math id="M8" altimg="si8.svg"><mml:mrow><mml:mtext>Where</mml:mtext><mml:mspace width="0.28em"/><mml:msub><mml:mi mathvariant="bold">r</mml:mi><mml:mi mathvariant="normal">i</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="true">[</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="true">]</mml:mo></mml:mrow><mml:mo linebreak="goodbreak">=</mml:mo><mml:mi>i</mml:mi><mml:mo>·</mml:mo><mml:mi mathvariant="bold">r</mml:mi><mml:mrow><mml:mo stretchy="true">[</mml:mo><mml:mi mathvariant="normal">n</mml:mi><mml:mo stretchy="true">]</mml:mo></mml:mrow><mml:mo linebreak="goodbreak">+</mml:mo><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo linebreak="badbreak">−</mml:mo><mml:mi mathvariant="normal">i</mml:mi></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo>·</mml:mo><mml:msub><mml:mi mathvariant="bold">r</mml:mi><mml:mi mathvariant="normal">f</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="true">[</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo linebreak="badbreak">−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="true">]</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula><disp-formula id="eqn0009"><label>(9)</label><mml:math id="M9" altimg="si9.svg"><mml:mrow><mml:mi mathvariant="bold-italic">z</mml:mi><mml:mrow><mml:mo stretchy="true">[</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="true">]</mml:mo></mml:mrow><mml:mo linebreak="goodbreak">=</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="bold-italic">r</mml:mi><mml:mrow><mml:mo stretchy="true">[</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="true">]</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="true">[</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="true">]</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="true">[</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="true">]</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula><disp-formula id="eqn0010"><label>(10)</label><mml:math id="M10" altimg="si10.svg"><mml:mrow><mml:mi mathvariant="bold-italic">s</mml:mi><mml:mrow><mml:mo stretchy="true">[</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="true">]</mml:mo></mml:mrow><mml:mo linebreak="goodbreak">=</mml:mo><mml:mrow><mml:mo stretchy="true">{</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mspace width="0.33em"/><mml:mi>i</mml:mi><mml:mi>f</mml:mi><mml:mspace width="0.33em"/><mml:mi>r</mml:mi><mml:mrow><mml:mo stretchy="true">[</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="true">]</mml:mo></mml:mrow><mml:mo linebreak="badbreak">&gt;</mml:mo><mml:mi>t</mml:mi><mml:msub><mml:mi>h</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>z</mml:mi><mml:mrow><mml:mo stretchy="true">[</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="true">]</mml:mo></mml:mrow><mml:mo linebreak="badbreak">&gt;</mml:mo><mml:mi>t</mml:mi><mml:msub><mml:mi>h</mml:mi><mml:mi>z</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mspace width="0.33em"/><mml:mi>o</mml:mi><mml:mi>t</mml:mi><mml:mi>h</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>w</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mi>e</mml:mi><mml:mspace width="0.33em"/></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mrow><mml:mspace width="0.33em"/></mml:mrow></mml:mrow></mml:math></disp-formula></p>
    </sec>
    <sec id="sec0005">
      <label>2.3</label>
      <title>Correlation maps</title>
      <p id="para0020">After identification of the ROI activity and peaks, the Pearson cross-correlation x<sub>τ</sub> for a lag τ between the ROIs is determined according to <xref rid="eqn0011" ref-type="disp-formula">Eq. (11)</xref>, where µ<sub>f</sub> and µ<sub>g</sub> denote the mean values of <bold><italic>f</italic></bold> and <bold><italic>g</italic></bold> according to <xref rid="eqn0012" ref-type="disp-formula">Eq. (12)</xref>. The variables <bold>f</bold> and <bold>g</bold> can be either the brightness <bold>b</bold>, the brightness rate of change <bold>r</bold>, or the spike vector <bold>s</bold> of ROIs as described in <xref rid="sec0004" ref-type="sec">Section 2.2</xref>.<disp-formula id="eqn0011"><label>(11)</label><mml:math id="M11" altimg="si11.svg"><mml:mrow><mml:msub><mml:mi mathvariant="normal">x</mml:mi><mml:mi>τ</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="true">[</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="true">]</mml:mo></mml:mrow><mml:mo linebreak="goodbreak">=</mml:mo><mml:mo>∑</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="bold">f</mml:mi><mml:mrow><mml:mo stretchy="true">[</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mi>τ</mml:mi></mml:mrow><mml:mo stretchy="true">]</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi mathvariant="normal">f</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mo stretchy="true">|</mml:mo><mml:mrow><mml:mo stretchy="true">|</mml:mo><mml:mrow><mml:mi mathvariant="bold">f</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi mathvariant="normal">f</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="true">|</mml:mo></mml:mrow><mml:mo stretchy="true">|</mml:mo></mml:mrow></mml:mfrac><mml:mo>·</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="bold">g</mml:mi><mml:mrow><mml:mo stretchy="true">[</mml:mo><mml:mi mathvariant="normal">n</mml:mi><mml:mo stretchy="true">]</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi mathvariant="normal">g</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mo stretchy="true">|</mml:mo><mml:mrow><mml:mo stretchy="true">|</mml:mo><mml:mrow><mml:mi mathvariant="bold">g</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi mathvariant="normal">g</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="true">|</mml:mo></mml:mrow><mml:mo stretchy="true">|</mml:mo></mml:mrow></mml:mfrac><mml:mo>;</mml:mo></mml:mrow></mml:math></disp-formula><disp-formula id="eqn0012"><label>(12)</label><mml:math id="M12" altimg="si12.svg"><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mi mathvariant="normal">y</mml:mi></mml:msub><mml:mo linebreak="goodbreak">=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mo stretchy="true">|</mml:mo><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mo stretchy="true">|</mml:mo></mml:mrow></mml:mfrac><mml:mspace width="0.33em"/><mml:mo>∑</mml:mo><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mrow><mml:mo stretchy="true">[</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="true">]</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mspace width="0.33em"/><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="bold-italic">f</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">g</mml:mi></mml:mrow></mml:math></disp-formula></p>
      <p id="para0021">The detected peaks, the rate of change, and the activity are shown directly in a graph for separate ROIs (<xref rid="fig0001" ref-type="fig">Fig. 1</xref>, left), whereas <italic>x<sub>τ</sub></italic> between all combinations of selected cells can be presented in a form of bar graph for −5≤ τ ≤ 5, a correlation matrix or a correlation map (<xref rid="fig0001" ref-type="fig">Fig. 1</xref>, center). The correlation matrix displays <italic>x<sub>τ</sub></italic> so that the cross-correlation between the first and second selected cells is at the position (1, 2), between the first and third at (1, 3), etc., with the color of each pixel selected from a provided colormap based on the value of <italic>x<sub>τ</sub></italic> (leftmost color for <italic>x<sub>τ</sub></italic> = −1 up to the rightmost color for <italic>x<sub>τ</sub></italic> = 1). This provides the user with information regarding the overall correlation between all selected ROIs.</p>
      <p id="para0022">The correlation map shows a spatial map of all detected ROIs colored depending on <italic>x<sub>τ</sub></italic>. The single-cell correlation map displays through colors which areas show activity similar to a selected cell, providing a clear view of which ROIs have the calcium fluorescence behavior similar to the one of the selected cell. Furthermore, a heat map can be created to see which ROIs and/or areas of the cell culture are the most active. This can be seen in a spatial map of all detected ROIs colored depending on the value of <bold>b, r</bold> or <bold>s</bold> (the leftmost colormap value for 0, the rightmost color for the maximum value of <bold>b, r</bold> or <bold>s</bold>).</p>
      <p id="para0023">Another map is drawn to provide information regarding the spatiotemporal characteristics of the ROIs (<xref rid="fig0001" ref-type="fig">Fig. 1</xref>, top right). It displays a spatial map of all ROIs, for which calcium spikes were detected, drawn as circles. The diameter of these circles is linearly dependent on the number of detected spikes for that ROI, whereas the color depends on the average spike frame <italic>n<sub>avg</sub></italic> = ∑<italic>s</italic>[<italic>n</italic>] · <italic>n</italic>, ranging from red for the first frame to blue for the last one.</p>
    </sec>
    <sec id="sec0006">
      <label>2.4</label>
      <title>Network analysis</title>
      <p id="para0024">As a final step, the inter-neuronal connections are reconstructed. The cross-correlation between ROIs is used as a measure of the likeliness of the connection presence. A minimum correlation factor, ranging from 0.0 to 1.0, is given by the user so that only those areas that produce similar spiking patterns are considered as being functionally connected. Furthermore, a maximum connection length of the neurites can be given as input for anatomical connections (along with the image width). In that case, only connections shorter than the upper limit are considered. This feature allows the user to either include or exclude anatomical (physical) connections of the network in the analysis and provides a means to separate between functional and anatomical connections. Functional network is obtained by setting connection length to max value so that the network is based using only the correlation of activity time series. A stricter anatomical network can also be obtained by restricting the connection length value between two ROI preventing the program from reconstructing networks with connections of such length that they are not physically possible. The same accounts for the maximum delay between an incoming spike and the cellular response, which can be tuned after setting the footage frames per second (FPS). The connections are presented on a map of the cell culture (<xref rid="fig0001" ref-type="fig">Fig. 1</xref>, bottom right), showing which ROIs are likely to be connected in physiological response. Lastly, the produced graphs and representations of the connections between the cells can be exported as a csv file for further external analysis.</p>
    </sec>
  </sec>
  <sec id="sec0007">
    <label>3</label>
    <title>Methods</title>
    <p id="para0025">The performance of CALIMA was measured on three different datasets, two of which were produced in-house, as described in <xref rid="sec0008" ref-type="sec">Section 3.1</xref>. Both cell detection (<xref rid="sec0009" ref-type="sec">Section 3.2</xref>) and combined spike detection were tested and benchmarked against several alternative cell segmentation and spike detection strategies as described in <xref rid="sec0010" ref-type="sec">Section 3.3</xref>.</p>
    <sec id="sec0008">
      <label>3.1</label>
      <title>Cell culture and PDMS preparation</title>
      <p id="para0026">The neuroblastoma cell line SH-SY5Y <xref rid="bib0022" ref-type="bibr">[22]</xref> was used to characterize the performance of CALIMA software on polydimethylsiloxane (PDMS) substrates. PDMS and a cross linking agent were mixed in a cup in a ratio of 10:1 and degassed for approximately 20 min. After degassing, the liquid PDMS was poured onto a glass slide directly from the cup. Thereafter, the PDMS was cured on a hotplate at 95 °C for 10 min and coated with 50 µg/ml fibronectin solution in phosphate-buffered saline (PBS) for 45 min prior to cell seeding. SH-SY5Y neuroblastomas were cultured in DMEM/F-12 media (1:1) supplemented with 10% fetal bovine serum (FBS) and 1% pen/strep, and they were grown in an incubator at 37 °C, 5% CO<sub>2</sub>. When cell confluency was reached, trypsin (x1) was used to harvest the cells and thereafter, was centrifuged at 900 rpm for 5 min. A concentration of 200,000 cells/ml was used throughout the seeding experiments. Once the cells were seeded, they were left to adhere for 24 h following exposure to retinoic acid, thereafter, for 3 days at 10 µM in DMEM/F-12 media to differentiate the cells into neurons according to the manufacturer protocol <xref rid="bib0023" ref-type="bibr">[23]</xref>. Following 3 days of differentiation, a standard culture medium using DMEM/F-12 medium was added. For calcium staining experiments, the Fluo-4 Calcium Imaging kit (molecular probes, life technologies) was used according to the manufacturer's protocol and as described by <xref rid="bib0024" ref-type="bibr">[24]</xref>. Video footage of the samples were recorded using EVOS FL microscope (ThermoFisher, Waltam, MA, USA) at 1 frame per 10 s, and for 10 min with frames of 1280 by 960 pixels. When neurons maturate they become electrically active and start to blink in synchrony (coherent neuronal activity patterns) <xref rid="bib0025" ref-type="bibr">[25]</xref>, a phenomenon that can be recorded by calcium imaging experiments <xref rid="bib0026" ref-type="bibr">[26]</xref>. One dataset (Dataset 1) was taken from an early differentiated neuron culture (10 days in culture), and it did not exhibit this phenomenon. Another dataset (Dataset 2) was taken from a late differentiated neuron culture (28 days in culture); for this one the effect of synchronous neuron firing was observed.</p>
      <p id="para0027">In addition to the data obtained as described, we analyzed a validated example, Dataset 3, which was provided by the FluoroSNNAP software (spontaneous activity of cultured primary rat cortical neurons transduced with AAV2-GCaMP6, 696 by 520 pixels, 10 Hz measurements for 2 min, downloaded from <xref rid="bib0014" ref-type="bibr">[14]</xref>).</p>
      <p id="para0028">As a result of the experimental procedures, it was observed that Dataset 1 consisted of zoomed-out densely packed barely active cells of various types and some cellular debris and Dataset 2 of zoomed-in densely packed active cells, likely connected in a network. Dataset 3 showed zoomed-in cells communicating in a network <xref rid="bib0013" ref-type="bibr">[13]</xref> located at a distance from each other. Examples of single frames from each dataset are shown in <xref rid="fig0005" ref-type="fig">Fig. A.1</xref>.</p>
    </sec>
    <sec id="sec0009">
      <label>3.2</label>
      <title>Cell detection</title>
      <p id="para0029">The aforementioned neuronal cultures were with CALIMA for estimation purposes. The parameters used for cell detection varied between the datasets, the detailed description is provided in <xref rid="tbl0002" ref-type="table">Table B.1</xref> for reference.</p>
      <p id="para0030">The cells as detected by the softwares were validated against a manual segmentation done by a trained biologist. It was checked how many of the total number of areas that were found manually (P) were detected successfully. An overlap between a detected ROIs and a manually detected cell were designated True Positives (TP). ROIs that overlapped with multiple cells were not included in the TPs and were counted separately. Likewise, if ROIs did not match a manually detected cell or if multiple ROIs were assigned to one cell, the redundant ROIs were designated False Positives (FP). Cells not detected manually were included in the False Negatives (FN).</p>
      <p id="para0031">Using this classification, the correctness of the detection algorithm was assessed using three different measures: the true positive rate (TPR) or sensitivity by <xref rid="eqn0013" ref-type="disp-formula">Eq. (13)</xref>, the positive predictive value (PPV) using <xref rid="eqn0014" ref-type="disp-formula">Eq. (14)</xref>, and the recall defined as per <xref rid="eqn0015" ref-type="disp-formula">Eq. (15)</xref>.<disp-formula id="eqn0013"><label>(13)</label><mml:math id="M13" altimg="si13.svg"><mml:mrow><mml:mtext>TPR</mml:mtext><mml:mo linebreak="goodbreak">=</mml:mo><mml:mtext>Sensitivity</mml:mtext><mml:mo linebreak="goodbreak">=</mml:mo><mml:mfrac><mml:mtext>TP</mml:mtext><mml:mi mathvariant="normal">P</mml:mi></mml:mfrac></mml:mrow></mml:math></disp-formula><disp-formula id="eqn0014"><label>(14)</label><mml:math id="M14" altimg="si14.svg"><mml:mrow><mml:mtext>PPV</mml:mtext><mml:mo linebreak="goodbreak">=</mml:mo><mml:mfrac><mml:mtext>TP</mml:mtext><mml:mrow><mml:mtext>TP</mml:mtext><mml:mo>+</mml:mo><mml:mtext>FP</mml:mtext></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula><disp-formula id="eqn0015"><label>(15)</label><mml:math id="M15" altimg="si15.svg"><mml:mrow><mml:mtext>recall</mml:mtext><mml:mo linebreak="goodbreak">=</mml:mo><mml:mfrac><mml:mtext>TP</mml:mtext><mml:mrow><mml:mtext>TP</mml:mtext><mml:mo>+</mml:mo><mml:mtext>FN</mml:mtext></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula></p>
    </sec>
    <sec id="sec0010">
      <label>3.3</label>
      <title>Benchmark ROI detection</title>
      <p id="para0032">The performance of the cell detection on the same datasets was benchmarked against the alternative segmentation strategies. The active contours algorithm (FluoroSNNAP <xref rid="bib0013" ref-type="bibr">[13]</xref>) was studied for its ability to capture the crude shapes. The initial estimate made with the use of this algorithm did not require any user input.</p>
      <p id="para0033">Otsu thresholding (CellPRofiler <xref rid="bib0011" ref-type="bibr">[11]</xref>) was validated because of its ability to separate foreground and background pixels. A global threshold was chosen accepting ROIs diameter from 3 to 150 pixel units (pu) (Dataset 1), 25–250 pu (Dataset 2), and 10–45 pu (Dataset 3). A three-classes threshold was chosen, middle intensity pixels were assigned to the background and the threshold correction values were set to 1.3, 0.6, and 1.0 respectively for three datasets in question. In Dataset 1, a 50-pixel window adaptive threshold was chosen, the other datasets were processed with a global threshold. Merged cells were detected and separated based on pixel intensity.</p>
      <p id="para0034">We tested a combination of a thresholding and water shedding (ImageJ version 1.51k <xref rid="bib0016" ref-type="bibr">[16]</xref>) because of its speed. The image was converted to 8 bit to enable water shedding later on, the threshold was set to 15, 30, and 25 respectively (Datasets 1, 2, and 3). After water shedding was applied to separate the ROIs, only ROIs in the range of 50–500 pixels (Datasets 1), more than 80 pixels <xref rid="eqn0002" ref-type="disp-formula">(2)</xref>, and more than 10 pixels <xref rid="eqn0003" ref-type="disp-formula">(3)</xref> were considered by using the Analyze Particles option.</p>
      <p id="para0035">Lastly, we performed the spatiotemporal independent component analysis (SIMA <xref rid="bib0010" ref-type="bibr">[10]</xref>, <xref rid="bib0027" ref-type="bibr">[27]</xref> because this algorithm combines both spatial and temporal information to determine the cell's locations. The number of principal components used was chosen to be 500 for Dataset 1, 160 for Dataset 2, and 100 for Dataset 3, which is slightly higher than the estimated number of active cells <xref rid="bib0006" ref-type="bibr">[6]</xref>. The relative weight between the spatial and temporal independent component analysis was set to 0.85 (dominant spatial information) regarding the not-so-active Dataset 1 and the sparsely populated Dataset 3. In Dataset 2, this weight was set to 0.15. Cells overlapping more than 50% were merged and the ROIs were smoothed and filtered using the standard implementation of a method SparseROIsFromMasks proposed in SIMA <xref rid="bib0010" ref-type="bibr">[10]</xref>.</p>
      <p id="para0036">All data were processed using an HP EliteBook 850 G2 with 16 GB physical memory running a 64-bit Windows 10 operating system to compare the results obtained using each method. The time required for estimating the segmentation was recorded for each segmentation strategy. Setting the parameters required about the same amount of time for each method; thus, it was ignored.</p>
    </sec>
    <sec id="sec0011">
      <label>3.4</label>
      <title>Benchmark spike detection and network analysis</title>
      <p id="para0037">The spikes detected by CALIMA were validated against the ones obtained through manual detection and compared to a waveform-based detection algorithm (FluoroSNNAP <xref rid="bib0013" ref-type="bibr">[13]</xref>). Dataset 3 was used to validate both the spike detection and the network reconstruction, as the optimal settings for spike detection were known and it had already been validated to contain neurons communicating in a network <xref rid="bib0013" ref-type="bibr">[13]</xref>. To avoid considering changes in the segmentations, the segmentation mask defined manually was used in both software tools before validating the spikes and network. The first 15 ROIs (indexes assigned by FluoroSNNAP) were used to check the spike detection.</p>
      <p id="para0038">The spikes were manually checked regarding height and shape, and sets of the cells matching the criteria were stored. In CALIMA, the spike detection was based on the mean values per ROI and the parameters were set to 10, 5, 0.50, and 0.100 for <italic>l, z<sub>th</sub>, m</italic>, and roc<sub>min</sub> respectively. The relatively high value of <italic>z<sub>th</sub></italic> is a direct result of the low amount of noise in Dataset 3. In FluoroSNNAP, the settings recommended by the authors were used: choosing a 10 s window and using the lower 50% of samples to determine the ∆ F/ F<sub>0</sub>, using their standard library to match and detect the Calcium events.</p>
      <p id="para0039">To reconstruct a network, CALIMA used the Pearson coefficients in combination with the inter-cellular distance. ROIs with a cross-correlation coefficient above 0.25, a distance lower than 208 µm (a full image width estimated at 1040 µm), and a response time of 500 ms or less to each other were considered in this case. FluoroSNNAP used a partial-correlation method with an alpha level of 0.001, as this method represents the inter-cell connections, which are the closest ones among all methods offered by the software <xref rid="bib0013" ref-type="bibr">[13]</xref>.</p>
    </sec>
  </sec>
  <sec id="sec0012">
    <label>4</label>
    <title>Results</title>
    <p id="para0040">Using the methods as described in the previous section, the datasets described in <xref rid="sec0008" ref-type="sec">Section 3.1</xref> were processed using CALIMA and other alternative software tools. The results are shown in <xref rid="tbl0001" ref-type="table">Table 1</xref> and described in the following sections.<table-wrap position="float" id="tbl0001"><label>Table 1</label><caption><p>Comparison of the assets and performance of different software tools on the given datasets.</p></caption><alt-text id="alt0008">Table 1</alt-text><table frame="hsides" rules="groups"><thead><tr><th valign="top">Tool name</th><th valign="top">CALIMA</th><th valign="top">FluoroSNNAP</th><th valign="top">CellProfiler</th><th valign="top">ImageJ</th><th valign="top">SIMA</th></tr></thead><tbody><tr><td valign="top">Segmentation strategy</td><td valign="top">Difference of Gaussians</td><td valign="top">Active contours</td><td valign="top">Otsu-thresholding</td><td valign="top">Thresholding &amp; watershedding</td><td valign="top">Spatiotemporal ICA</td></tr><tr><td valign="top">Spike detection</td><td valign="top">Yes</td><td valign="top">Yes</td><td valign="top">Yes</td><td valign="top">No</td><td valign="top">No</td></tr><tr><td valign="top">Network analysis</td><td valign="top">Yes</td><td valign="top">Yes</td><td valign="top">No</td><td valign="top">No</td><td valign="top">No</td></tr><tr><td valign="top">Sensitivity range [%]</td><td valign="top">80–86</td><td valign="top">21–65</td><td valign="top">51–85</td><td valign="top">39–77</td><td valign="top">5–28</td></tr><tr><td valign="top">Positive prediction value range [%]</td><td valign="top">60–80</td><td valign="top">15–93</td><td valign="top">27–84</td><td valign="top">4–87</td><td valign="top">3.8–49</td></tr><tr><td valign="top">Recall [%]</td><td valign="top">88–98</td><td valign="top">39–69</td><td valign="top">79–99</td><td valign="top">41–94</td><td valign="top">41–100</td></tr><tr><td valign="top">Merged cells (Dataset 1,2,3)</td><td valign="top">45,14,14</td><td valign="top">13,71,4</td><td valign="top">0,72,6</td><td valign="top">6,87,4</td><td valign="top">159,143,10</td></tr><tr><td valign="top">Mean raw calculation time for segmentation [s]</td><td valign="top">5</td><td valign="top">11</td><td valign="top">5</td><td valign="top">40</td><td valign="top">1139</td></tr></tbody></table></table-wrap></p>
    <sec id="sec0013">
      <label>4.1</label>
      <title>Cell detection</title>
      <p id="para0041">The results of the cell detection accuracy across the three datasets are given in <xref rid="tbl0001" ref-type="table">Table 1</xref> (a more detailed analysis per dataset can be found in <xref rid="tbl0003" ref-type="table">Table C.1</xref>.), and the ROIs found in dataset 3 are represented in <xref rid="fig0003" ref-type="fig">Fig. 3</xref> (ROIs found for datasets 1 and 2 can be found in <xref rid="fig0006" ref-type="fig">Figs. A.2</xref> and <xref rid="fig0007" ref-type="fig">A.3</xref>). CALIMA demonstrates high scores for all three datasets with a sensitivity of 80–86% and a PPV of 60–80%. Though CALIMA performs well on the densely packed Dataset 2, the detection method comes at a cost. CALIMA detects only a part of the ROIs rather than the entire shape. Nevertheless, the raw calculation time is small, which helps a user to test different settings and find the optimum quickly.<fig id="fig0003"><label>Fig. 3</label><caption><p>Detected ROIs for Dataset 3 using various segmentation strategies. ROIs, manual (a), ROIs, CALIMA (b), ROIs, Active Contours (FSNNAP) (c), ROIs, Otsu Thresholding + brightness-based declumping (CellProfiler) (d), ROIs, Thresholding + Watershedding (ImageJ) (e), ROIs, spatiotemporal Independent component analysis (SIMA) (f). The ROIs found manually are depicted in blue, the true positives in green, and the false positives in orange. The ROIs containing multiple cells are shown in purple and the false negatives in red. Note that an exception is made for the stICA method, as it allows regions to overlap. To avoid confusion, the segmentation outlines found by this method are shown as well.</p></caption><alt-text id="alt0003">Fig 3</alt-text><graphic xlink:href="gr3"/></fig></p>
      <p id="para0042">The active contours algorithm appears to perform better in detecting the full extent of the ROIs but can detect only a smaller number of them. The Otsu-thresholding performs well in terms of sensitivity, speed, and determining the ROIs' actual shape to the cost of obtaining some redundant ROIs at the borders. Furthermore, when the cells are packed too densely (Dataset 2), the automated declumping has problems. The Thresholding and Watershedding strategy has difficulties with densely packed cells as well; however, it is quite sensitive in other cases. The separation of the cells appears to work only for small clusters of cells, as indicated by a large number of merged cells in Dataset 2. The stICA method appears to scatter its ROIs, resulting in obtaining many isolated small and overlapping regions. However, stICA shows the best performance among all considered algorithms in terms of finding the ROI outlines, and it is able to detect shapes as small as neurites. An option to automatically detect cells of different shapes will be considered as well for CALIMA in the future <xref rid="bib0028" ref-type="bibr">[28]</xref>.</p>
    </sec>
    <sec id="sec0014">
      <label>4.2</label>
      <title>Spike detection and network analysis</title>
      <p id="para0043">Both the z-score algorithm and the database comparison demonstrated appropriate scores in terms of sensitivity; FluoroSNNAP was able to identify 96.5% of the peaks on average (ranging between 90 – 100% per cell) and CALIMA identified 98.5% (84–100%). The database comparison for FluoroSNNAP had 32 false positives spread over 9 cells, while CALIMA discovered 14 in 6 cells. Most false positives of the database comparison (16) were found in a single cell indicating the inhibition of a brightness drift and a large number of non-AP spikes. The Z-score's false positives were spread more evenly across the cells. The number of false negatives of FluoroSNNAP was 18 across 9 cells and for CALIMA 19 across 9 cells. The Z-score algorithm missed most of peaks (6) in a single cell; this observation indicates fast spiking activity.</p>
      <p id="para0044">As can be seen from <xref rid="fig0002" ref-type="fig">Fig. 2</xref>a and b, the networks reconstructed using the 2 different methods differ significantly from each other (<xref rid="fig0004" ref-type="fig">Fig. 4</xref>c and d). In addition, the binary adjacency matrices also differ, with much less ROIs being linked with one another. The most typical difference is that the connections in CALIMA are shorter, while FluoroSNNAP allows observing connections over larger distances. Since a typical neurite length is in the order of 100′s µm <xref rid="bib0029" ref-type="bibr">[29]</xref>, the user-defined maximum length of neuronal connections allows CALIMA to filter out these longer connections, resulting in a physiologically more sensible communication network including both functional and anatomical parameters.<fig id="fig0004"><label>Fig. 4</label><caption><p>The reconstructed networks and binary adjacency matrices for dataset 3. Reconstructed network, ROI Pearson cross-correlation + distance filter (CALIMA) (a). Reconstructed network, ROI partial correlation (FSNNAP) (b).The ROIs are shown as dots and the connections as lines. Binary adjacency matrix of CALIMA (c) and FSNNAP (d). The matrices represent the ROIs, those that are connected (in white) and those that are not.</p></caption><alt-text id="alt0004">Fig 4</alt-text><graphic xlink:href="gr4"/></fig></p>
    </sec>
  </sec>
  <sec id="sec0015">
    <label>5</label>
    <title>Discussion</title>
    <p id="para0045">CALIMA was tested on three real-life datasets; consequently, it demonstrated a high sensitivity for the ROIs and allowed performing quick and highly confident cell detection on a large variety of data. When compared with other segmentation strategies, CALIMA performed better in most cases (see <xref rid="tbl0001" ref-type="table">Tables 1</xref> and <xref rid="tbl0003" ref-type="table">C1</xref>).</p>
    <p id="para0046">The automatic mode of the active contours algorithm (FluoroSNNAP) allows detecting only a small number of ROIs. This algorithm performs better if the user provides growth regions. Otsu's method (CellProfiler) enables multiple-class thresholds that can be combined with an adaptive window. Though the algorithm detects most cells correctly as well as identifies the ROI shape in detail, it does not perform well when cells are densely packed. As a result, the algorithm might merge a number of cells. The ‘declumping’ algorithm would have to be fine tuned by the user to correct this. The thresholding strategy (ImageJ) works well to detect large clusters of cells, but it is inaccurate when it makes segmentation of these clusters into separate cells as a next step. The cell irregular shapes are the likely cause of this. The algorithm has a problem with detecting cells near the cellular debris, which is because these cells are merged in a layer of moderate brightness, which cannot easily be handled by using a single threshold. Lastly, the stICA method (used in SIMA) does not show good results in terms of the sensitivity of its performance, or the redundant areas it discovers. Dataset 1 does not show sufficient activity for the algorithm to find the separate cells, and in Dataset 2 the cells are packed too densely. Therefore, it was concluded that stICA, while being able to detect the cellular shape up to the detail level of the neurites, is not suitable to analyze such cultures as ones presented in Datasets 1 and 2 and requires a low culture cell density to successfully analyze the footage, which is not the case for CALIMA.</p>
    <p id="para0047">Using the correct parameters, CALIMA's Z-score algorithm is able to detect a large number of calcium-spikes correctly. A sample set of 15 cells demonstrated a sensitivity range of 86–100%. These values are comparable to the results observed for the active contours algorithm (FluoroSNNAP). However, it was concluded that the FluoroSNNAP algorithm exhibits difficulties when separating between action potentials and spike-mimicking noise. Meanwhile, the z-score algorithm of CALIMA has problems with identifying all spikes in cells showing near-constant activity. Although these are rare events, the excess of spikes disrupts the estimation of the standard deviation that is required by CALIMA to detect these spikes correctly.</p>
    <p id="para0048">The networks reconstructed by both CALIMA and FluoroSNNAP differ at various points; the lengths of the connections as well as the actual connections differ. This is probably a result of the different reconstruction strategies implemented. CALIMA focuses on the physical limitations of the cells when identifying the network structure and tries to establish the actual connections. FluoroSNNAP rather focuses on the transfer of information within the network and links all blinking cells together. As a result, CALIMA reconstructed network is a physiologically more sensible communication network including both functional (similar synchronous blinking pattern) and anatomical parameters (physical distance between neuron).</p>
  </sec>
  <sec id="sec0016">
    <label>6</label>
    <title>Conclusion</title>
    <p id="para0049">Although calcium imaging is widely used in biological research, there are relatively few free and automated tools available for performing such analysis. These tools often enable only part of the analysis. Here we proposed the standalone free and open-source software tool CALIMA, and we demonstrated that it could serve as a valuable addition to the field of calcium imaging. Starting from crude calcium imaging data, CALIMA can detect cells, determine their activity, and reconstruct a communication network within minutes.</p>
    <p id="para0050">As it was proved that CALIMA is able to detect ROIs, find Ca-peaks, and establish a communication network, we consider CALIMA to be a valuable addition to the existing set of Ca-analysis tools. Because the DOG algorithm detects only a small part of most ROIs, future versions of CALIMA will contain a region-growing step to complete identification process for those areas for which only a part has been found. An option to automatically detect cells of different shapes will be considered as well. Furthermore, the algorithm detecting the physical network will be combined with information transfer theories to study the communication between cells in detail.</p>
  </sec>
  <sec id="sec0017">
    <title>Conflict of interest</title>
    <p id="para0051">The authors declare that the research was conducted in the absence of any commercial or financial relationships that could be construed as a potential conflict of interest. This statement has also been added at the end of the manuscript.</p>
  </sec>
</body>
<back>
  <ref-list id="cebibl1">
    <title>References</title>
    <ref id="bib0001">
      <label>1</label>
      <element-citation publication-type="journal" id="sbref0001">
        <person-group person-group-type="author">
          <name>
            <surname>Knot</surname>
            <given-names>H.J.</given-names>
          </name>
          <name>
            <surname>Laher</surname>
            <given-names>I.</given-names>
          </name>
          <name>
            <surname>Sobie</surname>
            <given-names>E.A.</given-names>
          </name>
          <name>
            <surname>Guatimosim</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Gomez-Viquez</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Hartmann</surname>
            <given-names>H.</given-names>
          </name>
          <name>
            <surname>Song</surname>
            <given-names>L.S.</given-names>
          </name>
          <name>
            <surname>Lederer</surname>
            <given-names>W.J.</given-names>
          </name>
          <name>
            <surname>Graier</surname>
            <given-names>W.F.</given-names>
          </name>
          <name>
            <surname>Malli</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Frieden</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Petersen</surname>
            <given-names>O.H.</given-names>
          </name>
        </person-group>
        <article-title>Twenty years of calcium imaging: cell physiology to dye for</article-title>
        <source>Mol. Interv.</source>
        <volume>5</volume>
        <issue>2</issue>
        <year>2005</year>
        <fpage>112</fpage>
        <lpage>127</lpage>
        <pub-id pub-id-type="pmid">15821159</pub-id>
      </element-citation>
    </ref>
    <ref id="bib0002">
      <label>2</label>
      <element-citation publication-type="journal" id="sbref0002">
        <person-group person-group-type="author">
          <name>
            <surname>Vlahopoulos</surname>
            <given-names>S.A.</given-names>
          </name>
          <name>
            <surname>Cen</surname>
            <given-names>O.</given-names>
          </name>
          <name>
            <surname>Hengen</surname>
            <given-names>N.</given-names>
          </name>
          <name>
            <surname>Agan</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Moschovi</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Critselis</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Adamaki</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Bacopoulou</surname>
            <given-names>F.</given-names>
          </name>
          <name>
            <surname>Copland</surname>
            <given-names>J.A.</given-names>
          </name>
          <name>
            <surname>Boldogh</surname>
            <given-names>I.</given-names>
          </name>
          <name>
            <surname>Karin</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Chrousos</surname>
            <given-names>G.P.</given-names>
          </name>
        </person-group>
        <article-title>Dynamic aberrant NF-kB spurs tumorigenesis: a new model encompassing the microenvironment</article-title>
        <source>Cytokine Growth Factor Rev.</source>
        <volume>4</volume>
        <issue>4</issue>
        <year>2015</year>
        <fpage>389</fpage>
        <lpage>403</lpage>
      </element-citation>
    </ref>
    <ref id="bib0003">
      <label>3</label>
      <element-citation publication-type="journal" id="sbref0003">
        <person-group person-group-type="author">
          <name>
            <surname>Zeldenrust</surname>
            <given-names>F.</given-names>
          </name>
          <name>
            <surname>Wadman</surname>
            <given-names>W.J.</given-names>
          </name>
        </person-group>
        <article-title>Two forms of feedback inhibition determine the dynamical state of a small hippocampal network</article-title>
        <source>Neural Netw.</source>
        <volume>22</volume>
        <issue>8</issue>
        <year>2009</year>
        <fpage>1139</fpage>
        <lpage>1158</lpage>
        <pub-id pub-id-type="pmid">19679445</pub-id>
      </element-citation>
    </ref>
    <ref id="bib0004">
      <label>4</label>
      <element-citation publication-type="journal" id="sbref0004">
        <person-group person-group-type="author">
          <name>
            <surname>Kholodenko</surname>
            <given-names>B.N.</given-names>
          </name>
        </person-group>
        <article-title>Cell signalling dynamics in time and space</article-title>
        <source>Nat. Rev. Mol. Cell Biol.</source>
        <volume>3</volume>
        <year>2006</year>
        <fpage>165</fpage>
        <lpage>176</lpage>
      </element-citation>
    </ref>
    <ref id="bib0005">
      <label>5</label>
      <element-citation publication-type="journal" id="sbref0005">
        <person-group person-group-type="author">
          <name>
            <surname>Romano</surname>
            <given-names>A.</given-names>
          </name>
        </person-group>
        <article-title>An integrated calcium imaging processing toolbox for the analysis of neuronal population dynamics</article-title>
        <source>PLoS Comput. Biol.</source>
        <volume>13</volume>
        <issue>6</issue>
        <year>2017</year>
        <object-id pub-id-type="publisher-id">e1005526</object-id>
      </element-citation>
    </ref>
    <ref id="bib0006">
      <label>6</label>
      <element-citation publication-type="journal" id="sbref0006">
        <person-group person-group-type="author">
          <name>
            <surname>Mukamel</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Nimmerjahn</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Schnitzer</surname>
            <given-names>M.</given-names>
          </name>
        </person-group>
        <article-title>Automated analysis of cellular signals from large-scale calcium imaging data</article-title>
        <source>Neuron</source>
        <volume>63</volume>
        <issue>6</issue>
        <year>2009</year>
        <fpage>747</fpage>
        <lpage>760</lpage>
        <pub-id pub-id-type="pmid">19778505</pub-id>
      </element-citation>
    </ref>
    <ref id="bib0007">
      <label>7</label>
      <element-citation publication-type="journal" id="sbref0007">
        <person-group person-group-type="author">
          <name>
            <surname>Jang</surname>
            <given-names>M.J.</given-names>
          </name>
          <name>
            <surname>Nam</surname>
            <given-names>Y.</given-names>
          </name>
        </person-group>
        <article-title>NeuroCa: integrated framework for systematic analysis of spatiotemporal neuronal activity patterns from large-scale optical recording data</article-title>
        <source>Neurophotonics</source>
        <volume>2</volume>
        <issue>3</issue>
        <year>2015</year>
        <fpage>35003</fpage>
      </element-citation>
    </ref>
    <ref id="bib0008">
      <label>8</label>
      <element-citation publication-type="journal" id="sbref0008">
        <person-group person-group-type="author">
          <name>
            <surname>Artimovich</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Jackson</surname>
            <given-names>R.K.</given-names>
          </name>
          <name>
            <surname>Kilander</surname>
            <given-names>M.B.C.</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>Y.C.</given-names>
          </name>
          <name>
            <surname>Nestor</surname>
            <given-names>M.W.</given-names>
          </name>
        </person-group>
        <article-title>PeakCaller: an automated graphical interface for the quantification of intracellular calcium obtained by high-content screening</article-title>
        <source>BMC Neurosci.</source>
        <volume>18</volume>
        <issue>1</issue>
        <year>2017</year>
        <fpage>1</fpage>
        <lpage>12</lpage>
        <pub-id pub-id-type="pmid">28049513</pub-id>
      </element-citation>
    </ref>
    <ref id="bib0009">
      <label>9</label>
      <element-citation publication-type="journal" id="sbref0009">
        <person-group person-group-type="author">
          <name>
            <surname>Picht</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Zima</surname>
            <given-names>A.V.</given-names>
          </name>
          <name>
            <surname>Blatter</surname>
            <given-names>L.A.</given-names>
          </name>
          <name>
            <surname>Bers</surname>
            <given-names>D.M.</given-names>
          </name>
        </person-group>
        <article-title>SparkMaster: automated calcium spark analysis with image</article-title>
        <source>Am. J. Physiol. Cell Physiol.</source>
        <volume>293</volume>
        <issue>3</issue>
        <year>2007</year>
        <fpage>C1073</fpage>
        <lpage>C1081</lpage>
        <pub-id pub-id-type="pmid">17376815</pub-id>
      </element-citation>
    </ref>
    <ref id="bib0010">
      <label>10</label>
      <element-citation publication-type="journal" id="sbref0010">
        <person-group person-group-type="author">
          <name>
            <surname>Kaifosh</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Zaremba</surname>
            <given-names>J.D.</given-names>
          </name>
          <name>
            <surname>Danielson</surname>
            <given-names>N.B.</given-names>
          </name>
          <name>
            <surname>Losonczy</surname>
            <given-names>A.</given-names>
          </name>
        </person-group>
        <article-title>SIMA: python software for analysis of dynamic fluorescence imaging data</article-title>
        <source>Front. Neuroinform.</source>
        <volume>8</volume>
        <year>2014</year>
        <fpage>1</fpage>
        <lpage>10</lpage>
        <pub-id pub-id-type="pmid">24501593</pub-id>
      </element-citation>
    </ref>
    <ref id="bib0011">
      <label>11</label>
      <element-citation publication-type="journal" id="sbref0011">
        <person-group person-group-type="author">
          <name>
            <surname>Lamprecht</surname>
            <given-names>M.R.</given-names>
          </name>
          <name>
            <surname>Sabatini</surname>
            <given-names>D.M.</given-names>
          </name>
          <name>
            <surname>Carpenter</surname>
            <given-names>A.E.</given-names>
          </name>
        </person-group>
        <article-title>CellProfiler: free, versatile software for automated biological image analysis</article-title>
        <source>BioTechniques</source>
        <volume>1</volume>
        <issue>1</issue>
        <year>2007</year>
        <fpage>71</fpage>
        <lpage>75</lpage>
      </element-citation>
    </ref>
    <ref id="bib0012">
      <label>12</label>
      <element-citation publication-type="journal" id="sbref0012">
        <person-group person-group-type="author">
          <name>
            <surname>Lopes da Silva</surname>
            <given-names>F.H.</given-names>
          </name>
          <name>
            <surname>Blanes</surname>
            <given-names>W.</given-names>
          </name>
          <name>
            <surname>Kalitzin</surname>
            <given-names>S.N.</given-names>
          </name>
          <name>
            <surname>Parra</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Suffczynski</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Velis</surname>
            <given-names>D.N.</given-names>
          </name>
        </person-group>
        <article-title>Dynamical diseases of brain systems: different routes to epileptic seizures</article-title>
        <source>IEEE Trans. Biomed. Eng.</source>
        <volume>50</volume>
        <issue>5</issue>
        <year>2003</year>
        <fpage>540</fpage>
        <lpage>548</lpage>
        <pub-id pub-id-type="pmid">12769430</pub-id>
      </element-citation>
    </ref>
    <ref id="bib0013">
      <label>13</label>
      <element-citation publication-type="journal" id="sbref0013">
        <person-group person-group-type="author">
          <name>
            <surname>Patel</surname>
            <given-names>T.P.</given-names>
          </name>
          <name>
            <surname>Man</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Firestein</surname>
            <given-names>B.L.</given-names>
          </name>
          <name>
            <surname>Meaney</surname>
            <given-names>D.F.</given-names>
          </name>
        </person-group>
        <article-title>Automated quantification of neuronal networks and single-cell calcium dynamics using calcium imaging</article-title>
        <source>J. Neurosci. Methods</source>
        <volume>243</volume>
        <year>2015</year>
        <fpage>26</fpage>
        <lpage>38</lpage>
        <pub-id pub-id-type="pmid">25629800</pub-id>
      </element-citation>
    </ref>
    <ref id="bib0014">
      <label>14</label>
      <element-citation publication-type="book" id="sbref0014">
        <person-group person-group-type="author">
          <name>
            <surname>Patel</surname>
            <given-names>T.P.</given-names>
          </name>
        </person-group>
        <chapter-title>Fluorescence Single Neuron and Network Analysis Package</chapter-title>
        <year>2013</year>
      </element-citation>
    </ref>
    <ref id="bib0015">
      <label>15</label>
      <mixed-citation publication-type="other" id="othref0001"><italic>Swiss Institute of Bioinformatics</italic>, Cellosaurus SH-SY5Y (RRID:CVCL-0019), female Homo Sapiens neuroblastoma (NCIt: C3270). <ext-link ext-link-type="uri" xlink:href="https://web.expasy.org/cellosaurus/CVCL_0019" id="interref0004">https://web.expasy.org/cellosaurus/CVCL_0019</ext-link> Visited at 27-11-2017.</mixed-citation>
    </ref>
    <ref id="bib0016">
      <label>16</label>
      <element-citation publication-type="journal" id="sbref0015a">
        <person-group person-group-type="author">
          <name>
            <surname>Schneider</surname>
            <given-names>C.A</given-names>
          </name>
          <name>
            <surname>Rasband</surname>
            <given-names>W.S.</given-names>
          </name>
          <name>
            <surname>Eliceiri</surname>
            <given-names>K.W.</given-names>
          </name>
        </person-group>
        <article-title>NIH image to image J: 25 years of image analysis</article-title>
        <source>Nature Methods</source>
        <volume>9</volume>
        <year>2012</year>
        <fpage>671</fpage>
        <lpage>675</lpage>
        <pub-id pub-id-type="pmid">22930834</pub-id>
      </element-citation>
    </ref>
    <ref id="bib0017">
      <label>17</label>
      <element-citation publication-type="journal" id="sbref0015">
        <person-group person-group-type="author">
          <name>
            <surname>Tomar</surname>
            <given-names>S.</given-names>
          </name>
        </person-group>
        <article-title>Converting video formats with FFmpeg</article-title>
        <source>Linux J.</source>
        <volume>2006</volume>
        <year>2006</year>
        <fpage>10</fpage>
      </element-citation>
    </ref>
    <ref id="bib0018">
      <label>18</label>
      <element-citation publication-type="journal" id="sbref0016">
        <person-group person-group-type="author">
          <name>
            <surname>Akram</surname>
            <given-names>F.</given-names>
          </name>
          <name>
            <surname>Garcia</surname>
            <given-names>M.A.</given-names>
          </name>
          <name>
            <surname>Puig</surname>
            <given-names>D.</given-names>
          </name>
        </person-group>
        <article-title>Active contours driven by difference of Gaussians</article-title>
        <source>Sci. Rep.</source>
        <volume>7</volume>
        <issue>1</issue>
        <year>2017</year>
        <fpage>1</fpage>
        <lpage>15</lpage>
        <pub-id pub-id-type="pmid">28127051</pub-id>
      </element-citation>
    </ref>
    <ref id="bib0019">
      <label>19</label>
      <element-citation publication-type="journal" id="sbref0017">
        <person-group person-group-type="author">
          <name>
            <surname>Sironi</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Tekin</surname>
            <given-names>B.</given-names>
          </name>
          <name>
            <surname>Rigamonti</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Lepetit</surname>
            <given-names>V.</given-names>
          </name>
          <name>
            <surname>Fua</surname>
            <given-names>P.</given-names>
          </name>
        </person-group>
        <article-title>Learning separable filters</article-title>
        <source>IEEE Trans. Pattern Anal. Mach. Intell.</source>
        <volume>37</volume>
        <issue>1</issue>
        <year>2015</year>
        <fpage>94</fpage>
        <lpage>106</lpage>
        <pub-id pub-id-type="pmid">26353211</pub-id>
      </element-citation>
    </ref>
    <ref id="bib0020">
      <label>20</label>
      <element-citation publication-type="book" id="sbref0018">
        <person-group person-group-type="author">
          <name>
            <surname>Sprinthall</surname>
            <given-names>R.C.</given-names>
          </name>
        </person-group>
        <chapter-title>Basic Statistical Analysis</chapter-title>
        <edition>9 ed.</edition>
        <year>2011</year>
        <publisher-name>Pearson Education</publisher-name>
      </element-citation>
    </ref>
    <ref id="bib0021">
      <label>21</label>
      <element-citation publication-type="book" id="sbref0019">
        <person-group person-group-type="author">
          <name>
            <surname>Perkins</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Heber</surname>
            <given-names>S.</given-names>
          </name>
        </person-group>
        <chapter-title>Identification of ribosome pause sites using a Z-Score based peak detection algorithm</chapter-title>
        <source>2018 IEEE 8th International Conference on Computational Advances in Bio and Medical Sciences (ICCABS)</source>
        <year>2018</year>
      </element-citation>
    </ref>
    <ref id="bib0022">
      <label>22</label>
      <element-citation publication-type="journal" id="sbref0020">
        <person-group person-group-type="author">
          <name>
            <surname>Biedler</surname>
            <given-names>J.L.</given-names>
          </name>
          <name>
            <surname>Roffler-Tarlov</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Schachner</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Freedman</surname>
            <given-names>L.S.</given-names>
          </name>
        </person-group>
        <article-title>Multiple neurotransmitter synthesis by human neuroblastoma cell lines and clones</article-title>
        <source>Cancer Res.</source>
        <volume>38</volume>
        <year>1978</year>
        <fpage>3751</fpage>
        <lpage>3757</lpage>
        <pub-id pub-id-type="pmid">29704</pub-id>
      </element-citation>
    </ref>
    <ref id="bib0023">
      <label>23</label>
      <mixed-citation publication-type="other" id="othref0003">Sigma-Aldrich, SH-SY5Y Cell Line human.</mixed-citation>
    </ref>
    <ref id="bib0024">
      <label>24</label>
      <element-citation publication-type="book" id="sbref0021">
        <person-group person-group-type="author">
          <name>
            <surname>Xie</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Gardeniers</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Luttge</surname>
            <given-names>R.</given-names>
          </name>
        </person-group>
        <source>20th International Conference on Miniaturized Systems for Chemistry and Life Sciences</source>
        <year>2016</year>
        <publisher-name>MicroTAS</publisher-name>
      </element-citation>
    </ref>
    <ref id="bib0025">
      <label>25</label>
      <element-citation publication-type="journal" id="sbref0015b">
        <person-group person-group-type="author">
          <name>
            <surname>Egorov</surname>
            <given-names>A.V.</given-names>
          </name>
          <name>
            <surname>Draguhn</surname>
            <given-names>A.</given-names>
          </name>
        </person-group>
        <article-title>Development of coherent neuronal activity patterns in mammalian cortical networks: Common principles and local hetereogeneity</article-title>
        <source>Mec. Dev.</source>
        <volume>130</volume>
        <year>2013</year>
        <fpage>412</fpage>
        <lpage>423</lpage>
      </element-citation>
    </ref>
    <ref id="bib0026">
      <label>26</label>
      <element-citation publication-type="journal" id="sbref0015ac">
        <person-group person-group-type="author">
          <name>
            <surname>Grienberger</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Konnerth</surname>
            <given-names>A.</given-names>
          </name>
        </person-group>
        <article-title>Imaging Calcium in Neurons</article-title>
        <source>Neuron</source>
        <volume>73</volume>
        <issue>5</issue>
        <year>2012</year>
        <fpage>862</fpage>
        <lpage>885</lpage>
        <pub-id pub-id-type="pmid">22405199</pub-id>
      </element-citation>
    </ref>
    <ref id="bib0027">
      <label>27</label>
      <element-citation publication-type="journal" id="sbref0022">
        <person-group person-group-type="author">
          <name>
            <surname>Stone</surname>
            <given-names>J.V.</given-names>
          </name>
          <name>
            <surname>Porrill</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Porter</surname>
            <given-names>N.R.</given-names>
          </name>
          <name>
            <surname>Wilkinson</surname>
            <given-names>I.D.</given-names>
          </name>
        </person-group>
        <article-title>Spatiotemporal independent component analysis of event-related fMRI data using skewed probability density functions</article-title>
        <source>Neuroimage</source>
        <volume>15</volume>
        <issue>2</issue>
        <year>2002</year>
        <fpage>407</fpage>
        <lpage>421</lpage>
        <pub-id pub-id-type="pmid">11798275</pub-id>
      </element-citation>
    </ref>
    <ref id="bib0028">
      <label>28</label>
      <element-citation publication-type="journal" id="sbref0023">
        <person-group person-group-type="author">
          <collab>Lowe</collab>
        </person-group>
        <article-title>Distinctive image features from scale-invariant keypoints</article-title>
        <source>Int. J. Comput. Vis.</source>
        <volume>60</volume>
        <issue>2</issue>
        <year>2004</year>
        <fpage>91</fpage>
        <lpage>110</lpage>
      </element-citation>
    </ref>
    <ref id="bib0029">
      <label>29</label>
      <element-citation publication-type="journal" id="sbref0024">
        <person-group person-group-type="author">
          <name>
            <surname>Harrill</surname>
            <given-names>J.A.</given-names>
          </name>
          <name>
            <surname>Freudenrich</surname>
            <given-names>T.M.</given-names>
          </name>
          <name>
            <surname>Machacek</surname>
            <given-names>D.W.</given-names>
          </name>
          <name>
            <surname>Stice</surname>
            <given-names>S.L.</given-names>
          </name>
          <name>
            <surname>Mundy</surname>
            <given-names>W.R.</given-names>
          </name>
        </person-group>
        <article-title>Quantitative assessment of neurite outgrowth in human embryonic stem cell-derived hN2TM cells using automated high-content image analysis</article-title>
        <source>Neurotoxicology</source>
        <volume>31</volume>
        <issue>3</issue>
        <year>2010</year>
        <fpage>277</fpage>
        <lpage>290</lpage>
        <pub-id pub-id-type="pmid">20188755</pub-id>
      </element-citation>
    </ref>
  </ref-list>
  <sec id="sec0020">
    <title>Appendix A. The datasets</title>
    <p id="para0054"><xref rid="fig0005" ref-type="fig">Figs. A.1</xref>–<xref rid="fig0007" ref-type="fig">A.3</xref><fig id="fig0005"><label>Fig. A.1</label><caption><p>The averaged frame of each dataset. Dataset 1: A slightly active culture containing a mix of various cell types, different cell sizes and aggregates. The bar represents 400 µm (a). Dataset 2: An active culture consisting of densely-packed cells. The bar represents 200 µm (b). Dataset 3: An active culture consisting of separated cells. The bar represents 250 µm(estimated) (c).</p></caption><alt-text id="alt0005">Fig A1</alt-text><graphic xlink:href="gr5"/></fig><fig id="fig0006"><label>Fig. A.2</label><caption><p>Detected ROIs for Dataset 1 using various segmentation strategies. The bar represents a width of 400 µm. ROIs, manual (a), ROIs, CALIMA (b), ROIs, Active Contours (FSNNAP) (c), ROIs, Otsu Thresholding + brightness-based declumping (CellProfiler) (d), ROIs, Thresholding + Watershedding (ImageJ) (e), ROIs, spatiotemporal Independent component analysis (SIMA) (f). The ROIs found manually are depicted in blue, the true positives in green, and the false positives in orange. The ROIs containing multiple cells are shown in purple and the false negatives in red. Note that an exception is made for the stICA method, as it allows regions to overlap. To avoid confusion, the segmentation outlines found by this method are shown as well.</p></caption><alt-text id="alt0006">Fig A2</alt-text><graphic xlink:href="gr6"/></fig><fig id="fig0007"><label>Fig. A.3</label><caption><p>Detected ROIs for Dataset 2 using various segmentation strategies. ROIs, manual (a), ROIs, CALIMA (b), ROIs, Active Contours (FSNNAP) (c), ROIs, Otsu Thresholding + brightness-based declumping (CellProfiler) (d), ROIs, Thresholding + Watershedding (ImageJ) (e), ROIs, spatiotemporal Independent component analysis (SIMA) (f). The ROIs found manually are depicted in blue, the true positives in green, and the false positives in orange. The ROIs containing multiple cells are shown in purple and the false negatives in red. Note that an exception is made for the stICA method, as it allows regions to overlap. To avoid confusion, the segmentation outlines found by this method are shown as well. The reconstructed networks and binary adjacency matrices for dataset 2 are also shown. Reconstructed network, ROI Pearson cross-correlation + distance filter (CALIMA) (g). Reconstructed network, ROI partial correlation (FSNNAP) (h).</p></caption><alt-text id="alt0007">Fig A3</alt-text><graphic xlink:href="gr7"/></fig></p>
  </sec>
  <sec id="sec0021">
    <title>Appendix B. Parameters used for the cell detection algorithm</title>
    <p id="para0055"><xref rid="tbl0002" ref-type="table">Table B.1</xref>.<table-wrap position="anchor" id="tbl0002"><label>Table B.1</label><caption><p>The variables used for cell detection for the various datasets.</p></caption><alt-text id="alt0009">Table B1</alt-text><table frame="hsides" rules="groups"><thead><tr><th valign="top">σn</th><th valign="top">σa</th><th valign="top">σb</th><th valign="top">th</th><th valign="top"/></tr></thead><tbody><tr><td valign="top">Dataset 1</td><td valign="top">4</td><td valign="top">1</td><td valign="top">4</td><td valign="top">0.001</td></tr><tr><td valign="top">Dataset 2</td><td valign="top">6.2</td><td valign="top">1</td><td valign="top">3</td><td valign="top">0.0001</td></tr><tr><td valign="top">Dataset 3</td><td valign="top">6.5</td><td valign="top">1</td><td valign="top">2.7</td><td valign="top">0.0002</td></tr></tbody></table></table-wrap></p>
  </sec>
  <sec id="sec0022">
    <title>Appendix C. Results of the cell detection accuracy for different software tools</title>
    <p id="para0056"><xref rid="tbl0003" ref-type="table">Table C.1</xref>.<table-wrap position="anchor" id="tbl0003"><label>Table C.1</label><caption><p>The total number of cells found in the dataset, the number of true positives, false negatives, merged ROIs, and the number false positive ROIs per segmentation strategy. The detection sensitivity, positive predictive value and recall are shown in the last three columns. The best score per dataset is marked bold.</p></caption><alt-text id="alt0010">Table C1</alt-text><table frame="hsides" rules="groups"><thead><tr><th valign="top">Dataset1</th><th valign="top">Total</th><th valign="top">TP</th><th valign="top">FN</th><th valign="top">Merged</th><th valign="top">FP</th><th valign="top">Detec Rate</th><th valign="top">PPV</th><th valign="top">Recall</th></tr></thead><tbody><tr><td valign="top">Difference of Gaussians (CALIMA)</td><td valign="top">488</td><td valign="top">417</td><td valign="top">26</td><td valign="top">45</td><td valign="top">277</td><td valign="top">0.85</td><td valign="top">0.6</td><td valign="top">0.94</td></tr><tr><td valign="top">Active contours (Fluorosnnap)</td><td valign="top">488</td><td valign="top">184</td><td valign="top">291</td><td valign="top">13</td><td valign="top">46</td><td valign="top">0.38</td><td valign="top">0.8</td><td valign="top">0.39</td></tr><tr><td valign="top">Otsu-thresholding + declumping (CellProfiler)</td><td valign="top">488</td><td valign="top">387</td><td valign="top">101</td><td valign="top">0</td><td valign="top">1053</td><td valign="top">0.79</td><td valign="top">0.27</td><td valign="top">0.79</td></tr><tr><td valign="top">Thresholding + watershedding (ImageJ)</td><td valign="top">488</td><td valign="top">285</td><td valign="top">197</td><td valign="top">6</td><td valign="top">187</td><td valign="top">0.6</td><td valign="top">0.39</td><td valign="top">0.59</td></tr><tr><td valign="top">SpatioTemporal ICA (SIMA)</td><td valign="top">488</td><td valign="top">134</td><td valign="top">195</td><td valign="top">159</td><td valign="top">290</td><td valign="top">0.27</td><td valign="top">0.32</td><td valign="top">0.41</td></tr></tbody></table><table frame="hsides" rules="groups"><thead><tr><th valign="top">Dataset2</th><th valign="top">Total</th><th valign="top">TP</th><th valign="top">FN</th><th valign="top">Merged</th><th valign="top">FP</th><th valign="top">Detec Rate</th><th valign="top">PPV</th><th valign="top">Recall</th></tr></thead><tbody><tr><td valign="top">Difference of Gaussians (CALIMA)</td><td valign="top">150</td><td valign="top">120</td><td valign="top">16</td><td valign="top">14</td><td valign="top">16</td><td valign="top">0.8</td><td valign="top">0.88</td><td valign="top">0.88</td></tr><tr><td valign="top">Active contours (Fluorosnnap)</td><td valign="top">150</td><td valign="top">31</td><td valign="top">48</td><td valign="top">71</td><td valign="top">175</td><td valign="top">0.21</td><td valign="top">0.15</td><td valign="top">0.39</td></tr><tr><td valign="top">Otsu-thresholding + declumping (CellProfiler)</td><td valign="top">150</td><td valign="top">72</td><td valign="top">1</td><td valign="top">77</td><td valign="top">15</td><td valign="top">0.5</td><td valign="top">0.83</td><td valign="top">0.99</td></tr><tr><td valign="top">Thresholding + watershedding (ImageJ)</td><td valign="top">150</td><td valign="top">59</td><td valign="top">4</td><td valign="top">87</td><td valign="top">16</td><td valign="top">0.39</td><td valign="top">0.79</td><td valign="top">0.94</td></tr><tr><td valign="top">SpatioTemporal ICA (SIMA)</td><td valign="top">150</td><td valign="top">7</td><td valign="top">0</td><td valign="top">143</td><td valign="top">175</td><td valign="top">0.05</td><td valign="top">0.04</td><td valign="top">1</td></tr></tbody></table><table frame="hsides" rules="groups"><thead><tr><th valign="top">Dataset3</th><th valign="top">Total</th><th valign="top">TP</th><th valign="top">FN</th><th valign="top">Merged</th><th valign="top">FP</th><th valign="top">Detec Rate</th><th valign="top">PPV</th><th valign="top">Recall</th></tr></thead><tbody><tr><td valign="top">Difference of Gaussians (CALIMA)</td><td valign="top">75</td><td valign="top">60</td><td valign="top">1</td><td valign="top">14</td><td valign="top">12</td><td valign="top">0.8</td><td valign="top">0.83</td><td valign="top">0.98</td></tr><tr><td valign="top">Active contours (Fluorosnnap)</td><td valign="top">75</td><td valign="top">49</td><td valign="top">22</td><td valign="top">4</td><td valign="top">4</td><td valign="top">0.65</td><td valign="top">0.92</td><td valign="top">0.69</td></tr><tr><td valign="top">Otsu-thresholding + declumping (CellProfiler)</td><td valign="top">75</td><td valign="top">64</td><td valign="top">5</td><td valign="top">6</td><td valign="top">43</td><td valign="top">0.85</td><td valign="top">0.6</td><td valign="top">0.93</td></tr><tr><td valign="top">Thresholding + watershedding (ImageJ)</td><td valign="top">75</td><td valign="top">58</td><td valign="top">13</td><td valign="top">4</td><td valign="top">9</td><td valign="top">0.77</td><td valign="top">0.87</td><td valign="top">0.82</td></tr><tr><td valign="top">SpatioTemporal ICA (SIMA)</td><td valign="top">75</td><td valign="top">49</td><td valign="top">1</td><td valign="top">25</td><td valign="top">51</td><td valign="top">0.65</td><td valign="top">0.49</td><td valign="top">0.98</td></tr></tbody></table></table-wrap></p>
  </sec>
  <sec id="sec0019" sec-type="supplementary-material">
    <label>Appendix D</label>
    <title>Supplementary materials</title>
    <p id="para0052a">
      <supplementary-material content-type="local-data" id="ecom0001">
        <media xlink:href="mmc1.xml">
          <alt-text>Image, application 1</alt-text>
        </media>
      </supplementary-material>
    </p>
  </sec>
  <ack id="ack0001">
    <title>Acknowledgments</title>
    <p>This work was financially supported by the <funding-source id="gs0001">European Research Council</funding-source> (ERC), <funding-source id="gs0002">MESOTAS</funding-source> grant no. 280281, <funding-source id="gs0003">MESOTAS-SIEVE</funding-source>, grant no. 713732 and <funding-source id="gs0004">ZONMW</funding-source> Off road grant no. 40-08125-98-160. The authors declare that the research was conducted in the absence of any commercial or financial relationships that could be construed as a potential conflict of interest.</p>
  </ack>
  <fn-group>
    <fn id="sec0018" fn-type="supplementary-material">
      <p id="para0007a">Supplementary material associated with this article can be found, in the online version, at doi:<ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.cmpb.2019.104991" id="interref0003">10.1016/j.cmpb.2019.104991</ext-link>.</p>
    </fn>
  </fn-group>
</back>
