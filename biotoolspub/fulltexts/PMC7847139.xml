<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7847139</article-id>
    <article-id pub-id-type="publisher-id">3978</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-021-03978-z</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>P*R*O*P: a web application to perform phylogenetic analysis considering the effect of gaps</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Nishimaki</surname>
          <given-names>Takuma</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Sato</surname>
          <given-names>Keiko</given-names>
        </name>
        <address>
          <email>keiko@is.noda.tus.ac.jp</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <aff id="Aff1"><institution-wrap><institution-id institution-id-type="GRID">grid.143643.7</institution-id><institution-id institution-id-type="ISNI">0000 0001 0660 6861</institution-id><institution>Department of Information Sciences, </institution><institution>Tokyo University of Science, </institution></institution-wrap>Noda City, Chiba 278-8510 Japan </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>30</day>
      <month>1</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>30</day>
      <month>1</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2021</year>
    </pub-date>
    <volume>22</volume>
    <elocation-id>36</elocation-id>
    <history>
      <date date-type="received">
        <day>17</day>
        <month>11</month>
        <year>2020</year>
      </date>
      <date date-type="accepted">
        <day>21</day>
        <month>1</month>
        <year>2021</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2021</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold>This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">Phylogenetic analysis strongly depends on evolutionary models. Most evolutionary models for estimating genetic differences and phylogenetic relationships do not treat gap sites in the alignment of sequences. Appropriately incorporating evolutionary information of sites containing insertions and deletions into genetic difference measures will be improve the accuracy of phylogenetic estimates.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">We introduced a new measure for estimating genetic differences, and presented P*R*O*P, a web application for performing phylogenetic analysis based on genetic difference considering the effect of gaps. As an example of phylogenetic analysis using P*R*O*P, we used complete p53 amino acid sequences of 31 organisms and illustrated that the genetic differences with and without information on sites containing gaps result in trees with different topologies.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p id="Par3">P*R*O*P is available at <ext-link ext-link-type="uri" xlink:href="https://www.rs.tus.ac.jp/bioinformatics/prop">https://www.rs.tus.ac.jp/bioinformatics/prop</ext-link> and the user can perform phylogenetic analysis by uploading sequence data on the website. The most distinctive feature of P*R*O*P is its genetic difference that is estimated without eliminating gap sites for alignment sequences, which helps users detect meaningful difference in an evolutionary process. The source code is available in GitHub: <ext-link ext-link-type="uri" xlink:href="https://github.com/TUS-Satolab/PROP">https://github.com/TUS-Satolab/PROP</ext-link>.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Gap information</kwd>
      <kwd>Genetic difference</kwd>
      <kwd>Phylogenetic analysis</kwd>
      <kwd>Web application</kwd>
    </kwd-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2021</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par8">Phylogenetic inference based on genetic difference relies on evolutionary models. Most methods for phylogenetic analysis in use today do not treat gap sites in the alignment of sequences. The major reason is probably that evolutionary models with insertions and deletions are more complicated and more challenging than models with only substitutions. However, nucleotide or amino acid changes that have occurred during evolution include substitutions, insertions, and deletions. Therefore, ignoring evolutionary information by insertions and deletions is not appropriate for phylogenetic inference. In a previous paper [<xref ref-type="bibr" rid="CR1">1</xref>], we have proposed an extension to the Kimura two parameter (K2P) model [<xref ref-type="bibr" rid="CR2">2</xref>], called K2P + Gap, to incorporate the evolutionary information of sites containing insertions and deletions into the measure for estimating genetic difference between two nucleotide sequences.</p>
    <p id="Par9">Here, we incorporate this idea into the Jukes–Cantor (JC) method [<xref ref-type="bibr" rid="CR3">3</xref>] for amino acid sequences, and present P*R*O*P (Phylogenetic Relationships based On Proper genetic differences), a web application for performing phylogenetic analysis based on genetic difference considering the effect of gaps in both nucleotide sequences and amino acid sequences. Unlike the software packages for phylogenetic analysis such as MEGA [<xref ref-type="bibr" rid="CR4">4</xref>] and PAUP* [<xref ref-type="bibr" rid="CR5">5</xref>], P*R*O*P is a web application, so the user can perform phylogenetic analysis only by preparing sequence data in FASTA format without downloading or installing it.</p>
  </sec>
  <sec id="Sec2">
    <title>Implementation</title>
    <sec id="Sec3">
      <title>Application</title>
      <p id="Par10">The application consists of three steps: execution of sequence alignment, estimation of genetic differences, and generation of phylogenetic tree, which can collectively perform all the steps. On the main interface of P*R*O*P, the user uploads an input sequence file in FASTA format, and, if necessary, specifies the type of sequence, alignment tool, genetic difference measure, treatment of gaps, and phylogenetic tree method. After the processing of the request, pressing the View button allows the user to visualize the generated phylogenetic tree within a frame of its web page. Upon pressing the Download button, the alignment file in FASTA format (alignment.txt), the difference matrix file in PHYLIP format (matrix.txt), and the tree files in Newick format (tree.txt) and Potable Network Graphic format (figtree.png) will be downloaded. The results of phylogenetic analysis are stored in the Asia Pacific (Tokyo) region of Amazon Web Services for seven days.</p>
      <p id="Par11">The length and number of sequences that can be handled in phylogenetic analysis are 3000 or less. The sequences can be aligned with ClustalW2 (Version 2.1) [<xref ref-type="bibr" rid="CR6">6</xref>] or MAFFT (Version 7.429) [<xref ref-type="bibr" rid="CR7">7</xref>]. The maximum number of sequences is 1000 when using ClustalW2. For nucleotide sequences, the genetic differences can be calculated using either the P-distance or the K2P measure. For amino acid sequences, the genetic differences can be calculated using either the P-distance or the JC measure. In any case, the user can specify the treatment of gaps (+ Gap/Pairwise Deletion/Complete Deletion). When estimating genetic differences incorporated gap information in P*R*O*P, it is desirable to use the complete gene or protein sequences. Note that otherwise gaps at 5′ or 3′ ends in an alignment may not actually be due to insertions or deletions. The phylogenetic tree can be constructed by either the neighbor-joining (NJ) method [<xref ref-type="bibr" rid="CR8">8</xref>] or the unweighted pair-group method with arithmetic mean (UPGMA) [<xref ref-type="bibr" rid="CR9">9</xref>]. The constructed phylogenetic tree is drawn with figtree.js (<ext-link ext-link-type="uri" xlink:href="https://github.com/rambaut/figtree.js">https://github.com/rambaut/figtree.js</ext-link>). The JavaScript library figtree.js, incorporated into P*R*O*P, provides interactive visualization of phylogenetic trees. Having said that, because its function is limited, tree file in Newick format generated through P*R*O*P can also be visualized and edited with existing software tools.</p>
    </sec>
    <sec id="Sec4">
      <title>An extension of the JC model</title>
      <p id="Par12">The JC measure for estimating genetic difference between two nucleotide sequences, in terms of the number of nucleotide substitutions per site, is estimated by<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$K_{{{\text{JC}}}} = - a \,{\text{log}}\left( {1 - \frac{P}{a}} \right),$$\end{document}</tex-math><mml:math id="M2" display="block"><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mtext>JC</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:mi>a</mml:mi><mml:mspace width="0.166667em"/><mml:mtext>log</mml:mtext><mml:mfenced close=")" open="("><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mfrac><mml:mi>P</mml:mi><mml:mi>a</mml:mi></mml:mfrac></mml:mrow></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:math><graphic xlink:href="12859_2021_3978_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq1"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P$$\end{document}</tex-math><mml:math id="M4"><mml:mi>P</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_3978_Article_IEq1.gif"/></alternatives></inline-formula> is the probability of homologous sites that are different between the two sequences and <inline-formula id="IEq2"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$a = 3/4$$\end{document}</tex-math><mml:math id="M6"><mml:mrow><mml:mi>a</mml:mi><mml:mo>=</mml:mo><mml:mn>3</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3978_Article_IEq2.gif"/></alternatives></inline-formula>. In the case of <inline-formula id="IEq3"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$a = 19/20$$\end{document}</tex-math><mml:math id="M8"><mml:mrow><mml:mi>a</mml:mi><mml:mo>=</mml:mo><mml:mn>19</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>20</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3978_Article_IEq3.gif"/></alternatives></inline-formula>, Eq. (<xref rid="Equ1" ref-type="">1</xref>) can be used for amino acid sequences [<xref ref-type="bibr" rid="CR10">10</xref>].</p>
      <p id="Par13">We extend the JC model to estimate genetic differences considering gap information for aligned amino acid sequences. The idea is the same as that for the K2P + Gap difference measure introduced in a previous paper [<xref ref-type="bibr" rid="CR1">1</xref>]. All amino acid substitutions occur at the same rate <inline-formula id="IEq4"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha$$\end{document}</tex-math><mml:math id="M10"><mml:mi>α</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_3978_Article_IEq4.gif"/></alternatives></inline-formula> per site per unit time (year). In addition, when each of the twenty amino acids has an equal rate of changing to a gap, the rate of deletions per site per unit time is <inline-formula id="IEq5"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varepsilon$$\end{document}</tex-math><mml:math id="M12"><mml:mi>ε</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_3978_Article_IEq5.gif"/></alternatives></inline-formula>. On the other hand, assuming that a gap changes to one of the twenty amino acids with an equal rate and its rate per site per unit time is <inline-formula id="IEq6"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varepsilon /20$$\end{document}</tex-math><mml:math id="M14"><mml:mrow><mml:mi>ε</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:mn>20</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3978_Article_IEq6.gif"/></alternatives></inline-formula>, the rate of insertions (i.e., change of a gap to any of the twenty amino acids) per site per unit time is <inline-formula id="IEq7"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varepsilon$$\end{document}</tex-math><mml:math id="M16"><mml:mi>ε</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_3978_Article_IEq7.gif"/></alternatives></inline-formula>. Therefore, the total rate of amino acid changes per site per unit time <inline-formula id="IEq8"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k$$\end{document}</tex-math><mml:math id="M18"><mml:mi>k</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_3978_Article_IEq8.gif"/></alternatives></inline-formula> is given by the following mixture:<disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k = w\left( {19\alpha + \varepsilon } \right) + \left( {1 - w} \right)\varepsilon { },$$\end{document}</tex-math><mml:math id="M20" display="block"><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mi>w</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mn>19</mml:mn><mml:mi>α</mml:mi><mml:mo>+</mml:mo><mml:mi>ε</mml:mi></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:mfenced><mml:mi>ε</mml:mi><mml:mrow/><mml:mo>,</mml:mo></mml:mrow></mml:math><graphic xlink:href="12859_2021_3978_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par14">where <inline-formula id="IEq9"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$w$$\end{document}</tex-math><mml:math id="M22"><mml:mi>w</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_3978_Article_IEq9.gif"/></alternatives></inline-formula> is the mixture weight, which means the probability of amino acid occurrence between two aligned homologous sequences. In such a case, our measure (JC + Gap) for estimating genetic difference between two amino acid sequences, in terms of the number of amino acid changes per site that occurred during <inline-formula id="IEq10"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t$$\end{document}</tex-math><mml:math id="M24"><mml:mi>t</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_3978_Article_IEq10.gif"/></alternatives></inline-formula> years, is given by<disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$K_{{{\text{JC}} + {\text{Gap}}}} = 2tk = - \frac{19}{{20}}w\log \left( {\frac{S - P/19}{w}} \right).$$\end{document}</tex-math><mml:math id="M26" display="block"><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mrow><mml:mtext>JC</mml:mtext><mml:mo>+</mml:mo><mml:mtext>Gap</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mi>t</mml:mi><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:mfrac><mml:mn>19</mml:mn><mml:mn>20</mml:mn></mml:mfrac><mml:mi>w</mml:mi><mml:mo>log</mml:mo><mml:mfenced close=")" open="("><mml:mfrac><mml:mrow><mml:mi>S</mml:mi><mml:mo>-</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:mn>19</mml:mn></mml:mrow><mml:mi>w</mml:mi></mml:mfrac></mml:mfenced><mml:mo>.</mml:mo></mml:mrow></mml:math><graphic xlink:href="12859_2021_3978_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par15">As described above, in this equation, <inline-formula id="IEq11"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$w$$\end{document}</tex-math><mml:math id="M28"><mml:mi>w</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_3978_Article_IEq11.gif"/></alternatives></inline-formula> is the occurrence probability of amino acids in two sequences compared. <inline-formula id="IEq12"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P$$\end{document}</tex-math><mml:math id="M30"><mml:mi>P</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_3978_Article_IEq12.gif"/></alternatives></inline-formula> and <inline-formula id="IEq13"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S$$\end{document}</tex-math><mml:math id="M32"><mml:mi>S</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_3978_Article_IEq13.gif"/></alternatives></inline-formula> are the probabilities of homologous sites showing different amino acids and showing identical amino acids, respectively. Obviously, if gaps do not exist in two sequences compared (namely <inline-formula id="IEq14"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$w = 1:P + S = 1$$\end{document}</tex-math><mml:math id="M34"><mml:mrow><mml:mi>w</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>:</mml:mo><mml:mi>P</mml:mi><mml:mo>+</mml:mo><mml:mi>S</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_3978_Article_IEq14.gif"/></alternatives></inline-formula>), then Eq. (<xref rid="Equ3" ref-type="">3</xref>) becomes equal to Eq. (<xref rid="Equ1" ref-type="">1</xref>).</p>
    </sec>
    <sec id="Sec5">
      <title>Simulation analysis</title>
      <p id="Par16">In order to evaluate the performance of the difference measure in our model (JC + Gap), we investigated the accuracy of phylogenetic reconstruction for both the JC + Gap difference measure and the JC difference measure by using computer simulation. We had 60 model conditions (five numbers of taxa, four sequence lengths, and three change rates) in a similar way to a previous paper [<xref ref-type="bibr" rid="CR1">1</xref>]. The probability of amino acid substitutions was fixed at 0.01 per site per branch, and the probabilities of insertion and deletion changes were changed to 0.001, 0.002 and 0.005 per site per branch. 100 replications were performed for each model condition. The sequence data corresponding to the leaf nodes on each perfect binary tree were given as input to the phylogenetic reconstruction. For each data set, the JC genetic differences with complete deletion of gaps, the JC genetic differences with pairwise deletion of gaps, and the JC + Gap genetic differences were estimated to reconstruct phylogenetic trees using the NJ method (see [<xref ref-type="bibr" rid="CR1">1</xref>] for more details).</p>
    </sec>
  </sec>
  <sec id="Sec6">
    <title>Results</title>
    <sec id="Sec7">
      <title>Accuracy of phylogenetic reconstruction</title>
      <p id="Par17">The average percentage of correctly reconstructed topologies in data sets for all 60 model conditions was 46.1% when calculated with the JC difference measure (complete deletion), 64.2% when calculated with the JC difference measure (pairwise deletion) and 73.3% when calculated with the JC + Gap difference measure (Fig. <xref rid="Fig1" ref-type="fig">1</xref>). In case the probabilities of insertion and deletion changes were 0.001, the average accuracy for the JC difference measure (complete deletion), the JC difference measure (pairwise deletion) and the JC + Gap difference measure was 56.6%, 65.9% and 69.9%, respectively. In case of 0.002, the corresponding average accuracy was 46.0%, 64.4% and 72.8%, respectively. In case of 0.005, the corresponding average accuracy was 35.6%, 62.4% and 77.2%, respectively. Moreover, the average percentage of correctly reconstructed topologies in data sets for all 45 model conditions except for sequences of 250 amino acids in length, was 57.6% when calculated with the JC difference measure (complete deletion), 81.1% when calculated with the JC difference measure (pairwise deletion) and 90.4% when calculated with the JC + Gap difference measure. The JC + Gap difference measure shows the highest accuracy of the three measures.<fig id="Fig1"><label>Fig. 1</label><caption><p>Comparison of accuracy of phylogenetic reconstruction. For model trees of 16, 32, 64, 128, and 256 taxa, ancestral sequences of 250, 500, 750, and 1000 amino acids in length were randomly generated under the following conditions: the probability of amino acid substitutions was fixed at 0.01 per site per branch, and the probabilities of insertion and deletion changes were changed to <bold>a</bold> 0.001, <bold>b</bold> 0.002 and <bold>c</bold> 0.005 per site per branch. The accuracy of phylogenetic reconstruction was evaluated as the percentage of replications in which the correct topology was obtained when compared to the model tree</p></caption><graphic xlink:href="12859_2021_3978_Fig1_HTML" id="MO1"/></fig></p>
    </sec>
    <sec id="Sec8">
      <title>Phylogenetic analysis</title>
      <p id="Par18">We introduced a new measure for estimating genetic differences, and presented P*R*O*P, a web application for performing phylogenetic analysis based on genetic difference considering the effect of gaps. Here, we use the amino acid sequences of cellular tumor antigen p53 as an example to illustrate the effect of different treatment of gaps in phylogenetic analysis using P*R*O*P. Complete p53 amino acid sequences of 31 organisms were retrieved from UniProt KB/Swiss-Prot database (<ext-link ext-link-type="uri" xlink:href="https://www.uniprot.org/uniprot/">https://www.uniprot.org/uniprot/</ext-link>). These 31 sequences with amino acid length ranging from 352 to 396 were aligned with MAFFT and the genetic differences were respectively calculated using the JC measure in each case of the treatment of gaps (+Gap/Pairwise Deletion/Complete Deletion). For each of the three cases, the phylogenetic tree was generated with the NJ method and the resulting Newick tree file was furthermore plotted and edited in FigTree (Version 1.4.4) developed by Andrew Rambaut. The p53 sequences were grouped according to their class (Actinopterygii, Amphibia, Aves, and Mammalia) in all three trees; however, as for the class Mammalia, the tree based on the JC + Gap difference measure had a different topology compared to the other two trees (Fig. <xref rid="Fig2" ref-type="fig">2</xref>). Two subtrees in its tree based on the JC + Gap difference measure that are rooted at the sibling nodes of the same internal node correspond to the two clades (Euarchontoglires and Laurasiatheria), respectively. Many studies support that the superorder Euarchontoglires and the superorder Laurasiatheria are sister taxa [<xref ref-type="bibr" rid="CR11">11</xref>–<xref ref-type="bibr" rid="CR15">15</xref>]. The result with the JC + Gap difference measure in our analysis is consistent with these studies.<fig id="Fig2"><label>Fig. 2</label><caption><p>Phylogenetic trees of the p53 amino acid sequences based on the treatment of gaps “+Gap”, “Pairwise Deletion” and “Complete Deletion”. Each tree was generated using P*R*O*P and was midpoint rooted using FigTree. Organism species are colored as follows: Actinopterygii (9 species), black; Amphibia (1 species), purple; Aves (1 species), green; Mammalia Euarchontoglires (13 species), red; Mammalia Laurasiatheria (7 species), blue</p></caption><graphic xlink:href="12859_2021_3978_Fig2_HTML" id="MO2"/></fig></p>
    </sec>
  </sec>
  <sec id="Sec9">
    <title>Conclusions</title>
    <p id="Par19">P*R*O*P is a web application for performing phylogenetic analysis based on genetic difference considering the effect of gaps. The user can perform phylogenetic analysis by uploading sequence data in FASTA format. The most distinctive feature of P*R*O*P is its genetic difference that is estimated without eliminating gap sites for alignment sequences, which helps users detect meaningful difference in an evolutionary process and obtain a more accurate classification. The front-end is implemented in JavaScript using the Angular framework. The back-end is implemented in Python and is deployed on the Amazon Elastic Compute Cloud (Amazon EC2). P*R*O*P is available at <ext-link ext-link-type="uri" xlink:href="https://www.rs.tus.ac.jp/bioinformatics/prop">https://www.rs.tus.ac.jp/bioinformatics/prop</ext-link>. We will continue to update P*R*O*P by adding additional information, improving the implementation, and incorporating new measures for estimating genetic differences. The user can always access the latest version of P*R*O*P.</p>
  </sec>
  <sec id="Sec10">
    <title>Availability and requirements</title>
    <p id="Par20">
      <list list-type="bullet">
        <list-item>
          <p id="Par21">Project name: P*R*O*P.</p>
        </list-item>
        <list-item>
          <p id="Par22">Project home page: <ext-link ext-link-type="uri" xlink:href="https://www.rs.tus.ac.jp/bioinformatics/prop">https://www.rs.tus.ac.jp/bioinformatics/prop</ext-link>.</p>
        </list-item>
        <list-item>
          <p id="Par23">Operating system(s): Platform independent (web-based).</p>
        </list-item>
        <list-item>
          <p id="Par24">Programming language: JavaScript and Python.</p>
        </list-item>
        <list-item>
          <p id="Par25">Other requirements: Not specified.</p>
        </list-item>
        <list-item>
          <p id="Par26">License: MIT license.</p>
        </list-item>
        <list-item>
          <p id="Par27">Any restrictions to use by non-academics: None.</p>
        </list-item>
      </list>
    </p>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>K2P</term>
        <def>
          <p id="Par4">Kimura two parameter</p>
        </def>
      </def-item>
      <def-item>
        <term>JC</term>
        <def>
          <p id="Par5">Jukes–Cantor</p>
        </def>
      </def-item>
      <def-item>
        <term>NJ</term>
        <def>
          <p id="Par6">Neighbor-joining</p>
        </def>
      </def-item>
      <def-item>
        <term>UPGMA</term>
        <def>
          <p id="Par7">Unweighted pair-group method with arithmetic mean</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher's Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>We thank Toshihide Hara for his help and support in developing the P*R*O*P.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author’s contributions</title>
    <p>All authors contributed to the conception and design of the study, theoretical framework, data analyses, and the interpretation and discussion of the findings. TN wrote and tested the code of P*R*O*P, and contributed to revising of the manuscript. KS supported the development of P*R*O*P, and contributed to drafting and critical revision of the manuscript. Both authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>This research received no specific grant from any funding agency in the public, commercial, or not-for-profit sectors.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>The P*R*O*P web interface is freely available at <ext-link ext-link-type="uri" xlink:href="https://www.rs.tus.ac.jp/bioinformatics/prop">https://www.rs.tus.ac.jp/bioinformatics/prop</ext-link>. The source code can be found at <ext-link ext-link-type="uri" xlink:href="https://github.com/TUS-Satolab/PROP">https://github.com/TUS-Satolab/PROP</ext-link>.</p>
  </notes>
  <notes id="FPar1">
    <title>Ethics approval and consent to participate</title>
    <p id="Par28">Not applicable.</p>
  </notes>
  <notes id="FPar2">
    <title>Consent for publication</title>
    <p id="Par29">Not applicable.</p>
  </notes>
  <notes id="FPar3" notes-type="COI-statement">
    <title>Competing interests</title>
    <p id="Par30">The authors declare that they have no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nishimaki</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Sato</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>An extension of the Kimura two-parameter model to the natural evolutionary process</article-title>
        <source>J Mol Evol</source>
        <year>2019</year>
        <volume>87</volume>
        <issue>1</issue>
        <fpage>60</fpage>
        <lpage>67</lpage>
        <pub-id pub-id-type="doi">10.1007/s00239-018-9885-1</pub-id>
        <pub-id pub-id-type="pmid">30631891</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kimura</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>A simple method for estimating evolutionary rates of base substitutions through comparative studies of nucleotide sequences</article-title>
        <source>J Mol Evol</source>
        <year>1980</year>
        <volume>16</volume>
        <issue>2</issue>
        <fpage>111</fpage>
        <lpage>120</lpage>
        <pub-id pub-id-type="doi">10.1007/BF01731581</pub-id>
        <pub-id pub-id-type="pmid">7463489</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jukes</surname>
            <given-names>TH</given-names>
          </name>
          <name>
            <surname>Cantor</surname>
            <given-names>CR</given-names>
          </name>
        </person-group>
        <article-title>Evolution of protein molecules</article-title>
        <source>Mamm Protein Metab</source>
        <year>1969</year>
        <volume>3</volume>
        <fpage>21</fpage>
        <lpage>132</lpage>
        <pub-id pub-id-type="doi">10.1016/B978-1-4832-3211-9.50009-7</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kumar</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Stecher</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Knyaz</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Tamura</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>MEGA X: molecular evolutionary genetics analysis across computing platforms</article-title>
        <source>Mol Biol Evol</source>
        <year>2018</year>
        <volume>35</volume>
        <issue>6</issue>
        <fpage>1547</fpage>
        <lpage>1549</lpage>
        <pub-id pub-id-type="doi">10.1093/molbev/msy096</pub-id>
        <pub-id pub-id-type="pmid">29722887</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <mixed-citation publication-type="other">Swofford DL. PAUP*: phylogenetic analysis using parsimony (and other methods) 4.0.b5. 2001.</mixed-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Larkin</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Blackshields</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Brown</surname>
            <given-names>NP</given-names>
          </name>
          <name>
            <surname>Chenna</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>McGettigan</surname>
            <given-names>PA</given-names>
          </name>
          <name>
            <surname>McWilliam</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Clustal W and Clustal X version 2.0</article-title>
        <source>Bioinformatics</source>
        <year>2007</year>
        <volume>23</volume>
        <issue>21</issue>
        <fpage>2947</fpage>
        <lpage>2948</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btm404</pub-id>
        <pub-id pub-id-type="pmid">17846036</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Katoh</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Standley</surname>
            <given-names>DM</given-names>
          </name>
        </person-group>
        <article-title>MAFFT multiple sequence alignment software Version 7: improvements in performance and usability</article-title>
        <source>Mol Biol Evol</source>
        <year>2013</year>
        <volume>30</volume>
        <issue>4</issue>
        <fpage>772</fpage>
        <lpage>780</lpage>
        <pub-id pub-id-type="doi">10.1093/molbev/mst010</pub-id>
        <pub-id pub-id-type="pmid">23329690</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Saitou</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Nei</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>The neighbor-joining method: a new method for reconstructing phylogenetic trees</article-title>
        <source>Mol Biol Evol</source>
        <year>1987</year>
        <volume>4</volume>
        <issue>4</issue>
        <fpage>406</fpage>
        <lpage>425</lpage>
        <pub-id pub-id-type="pmid">3447015</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sokal</surname>
            <given-names>RR</given-names>
          </name>
        </person-group>
        <article-title>A statistical method for evaluating systematic relationships</article-title>
        <source>Univ Kansas Sci Bull</source>
        <year>1958</year>
        <volume>38</volume>
        <fpage>1409</fpage>
        <lpage>1438</lpage>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Takezaki</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Rzhetsky</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Nei</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Phylogenetic test of the molecular clock and linearized trees</article-title>
        <source>Mol Biol Evol</source>
        <year>1995</year>
        <volume>12</volume>
        <issue>5</issue>
        <fpage>823</fpage>
        <lpage>833</lpage>
        <?supplied-pmid 7476128?>
        <pub-id pub-id-type="pmid">7476128</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Springer</surname>
            <given-names>MS</given-names>
          </name>
          <name>
            <surname>Murphy</surname>
            <given-names>WJ</given-names>
          </name>
          <name>
            <surname>Eizirik</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>O'Brien</surname>
            <given-names>SJ</given-names>
          </name>
        </person-group>
        <article-title>Placental mammal diversification and the Cretaceous-Tertiary boundary</article-title>
        <source>Proc Natl Acad Sci</source>
        <year>2003</year>
        <volume>100</volume>
        <issue>3</issue>
        <fpage>1056</fpage>
        <lpage>1061</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.0334222100</pub-id>
        <pub-id pub-id-type="pmid">12552136</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Asher</surname>
            <given-names>RJ</given-names>
          </name>
          <name>
            <surname>Bennett</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Lehmann</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>The new framework for understanding placental mammal evolution</article-title>
        <source>BioEssays</source>
        <year>2009</year>
        <volume>31</volume>
        <issue>8</issue>
        <fpage>853</fpage>
        <lpage>864</lpage>
        <pub-id pub-id-type="doi">10.1002/bies.200900053</pub-id>
        <pub-id pub-id-type="pmid">19582725</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Meredith</surname>
            <given-names>RW</given-names>
          </name>
          <name>
            <surname>Janečka</surname>
            <given-names>JE</given-names>
          </name>
          <name>
            <surname>Gatesy</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Ryder</surname>
            <given-names>OA</given-names>
          </name>
          <name>
            <surname>Fisher</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Teeling</surname>
            <given-names>EC</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Impacts of the cretaceous terrestrial revolution and KPg extinction on mammal diversification</article-title>
        <source>Science</source>
        <year>2001</year>
        <volume>334</volume>
        <issue>6055</issue>
        <fpage>521</fpage>
        <lpage>524</lpage>
        <pub-id pub-id-type="doi">10.1126/science.1211028</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>O'Leary</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Bloch</surname>
            <given-names>JI</given-names>
          </name>
          <name>
            <surname>Flynn</surname>
            <given-names>JJ</given-names>
          </name>
          <name>
            <surname>Gaudin</surname>
            <given-names>TJ</given-names>
          </name>
          <name>
            <surname>Giallombardo</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Giannini</surname>
            <given-names>NP</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The placental mammal ancestor and the post–K-Pg radiation of placentals</article-title>
        <source>Science</source>
        <year>2013</year>
        <volume>339</volume>
        <issue>6120</issue>
        <fpage>662</fpage>
        <lpage>667</lpage>
        <pub-id pub-id-type="doi">10.1126/science.1229237</pub-id>
        <pub-id pub-id-type="pmid">23393258</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Beck</surname>
            <given-names>RM</given-names>
          </name>
          <name>
            <surname>Baillie</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Improvements in the fossil record may largely resolve current conflicts between morphological and molecular estimates of mammal phylogeny</article-title>
        <source>Proc R Soc B</source>
        <year>2018</year>
        <volume>285</volume>
        <issue>1893</issue>
        <fpage>20181632</fpage>
        <pub-id pub-id-type="doi">10.1098/rspb.2018.1632</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
