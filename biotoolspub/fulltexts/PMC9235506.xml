<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">9235506</article-id>
    <article-id pub-id-type="pmid">35758806</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btac239</article-id>
    <article-id pub-id-type="publisher-id">btac239</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>ISCB/Ismb 2022</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Bioinformatics of Microbes and Microbiomes</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Phage–bacterial contig association prediction with a convolutional neural network</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Tang</surname>
          <given-names>Tianqi</given-names>
        </name>
        <aff><institution>Department of Quantitative and Computational Biology, University of Southern California</institution>, Los Angeles, CA 90089, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Hou</surname>
          <given-names>Shengwei</given-names>
        </name>
        <aff><institution>Department of Ocean Science and Engineering, Southern University of Science and Technology</institution>, Shenzhen 518055, <country country="CN">China</country></aff>
        <aff><institution>Marine and Environmental Biology, Department of Biological Sciences, University of Southern California</institution>, Los Angeles, CA 90089, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Fuhrman</surname>
          <given-names>Jed A</given-names>
        </name>
        <aff><institution>Marine and Environmental Biology, Department of Biological Sciences, University of Southern California</institution>, Los Angeles, CA 90089, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Sun</surname>
          <given-names>Fengzhu</given-names>
        </name>
        <aff><institution>Department of Quantitative and Computational Biology, University of Southern California</institution>, Los Angeles, CA 90089, <country country="US">USA</country></aff>
        <xref rid="btac239-cor1" ref-type="corresp"/>
        <!--fsun@usc.edu-->
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btac239-cor1">To whom correspondence should be addressed. E-mail: <email>fsun@usc.edu</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>7</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2022-06-27">
      <day>27</day>
      <month>6</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>27</day>
      <month>6</month>
      <year>2022</year>
    </pub-date>
    <volume>38</volume>
    <issue>Suppl 1</issue>
    <issue-title>ISCB ISMB 2022 Proceedings</issue-title>
    <fpage>i45</fpage>
    <lpage>i52</lpage>
    <permissions>
      <copyright-statement>© The Author(s) 2022. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2022</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btac239.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>Phage–host associations play important roles in microbial communities. But in natural communities, as opposed to culture-based lab studies where phages are discovered and characterized metagenomically, their hosts are generally not known. Several programs have been developed for predicting which phage infects which host based on various sequence similarity measures or machine learning approaches. These are often based on whole viral and host genomes, but in metagenomics-based studies, we rarely have whole genomes but rather must rely on contigs that are sometimes as short as hundreds of bp long. Therefore, we need programs that predict hosts of phage contigs on the basis of these short contigs. Although most existing programs can be applied to metagenomic datasets for these predictions, their accuracies are generally low. Here, we develop ContigNet, a convolutional neural network-based model capable of predicting phage–host matches based on relatively short contigs, and compare it to previously published VirHostMatcher (VHM) and WIsH.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>On the validation set, ContigNet achieves 72–85% area under the receiver operating characteristic curve (AUROC) scores, compared to the maximum of 68% by VHM or WIsH for contigs of lengths between 200 bps to 50 kbps. We also apply the model to the Metagenomic Gut Virus (MGV) catalogue, a dataset containing a wide range of draft genomes from metagenomic samples and achieve 60–70% AUROC scores compared to that of VHM and WIsH of 52%. Surprisingly, ContigNet can also be used to predict plasmid-host contig associations with high accuracy, indicating a similar genetic exchange between mobile genetic elements and their hosts.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>The source code of ContigNet and related datasets can be downloaded from <ext-link xlink:href="https://github.com/tianqitang1/ContigNet" ext-link-type="uri">https://github.com/tianqitang1/ContigNet</ext-link>.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>National Institutes of Health</institution>
            <institution-id institution-id-type="DOI">10.13039/100000002</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>R01GM120624</award-id>
        <award-id>1R01GM131407</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>National Science Foundation</institution>
            <institution-id institution-id-type="DOI">10.13039/100000001</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>EF-2125142</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Simons Collaboration on Computational Biogeochemical Modeling of Marine Ecosystems</institution>
          </institution-wrap>
        </funding-source>
        <award-id>549943</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Gordon and Betty Moore Foundation</institution>
            <institution-id institution-id-type="DOI">10.13039/100000936</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>3779</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="8"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Mobile genetic elements (MGEs) are abundant in natural environments. They move around in the biosphere and transfer from one host to another to replicate. Among various classes of MGEs, viruses that infect bacteria referred as bacteriophages or phages in short have played essential rules in natural environments. The vital activities and replication of phages require the infection of phages to their hosts. Therefore, it is important to understand the association relationship between phages and their hosts. Several computational methods have been developed to assign viruses to their putative hosts (<xref rid="btac239-B1" ref-type="bibr">Ahlgren <italic toggle="yes">et al.</italic>, 2017</xref>; <xref rid="btac239-B3" ref-type="bibr">Amgarten <italic toggle="yes">et al.</italic>, 2020</xref>; <xref rid="btac239-B5" ref-type="bibr">Coutinho <italic toggle="yes">et al.</italic>, 2021</xref>; <xref rid="btac239-B8" ref-type="bibr">Galiez <italic toggle="yes">et al.</italic>, 2017</xref>; <xref rid="btac239-B10" ref-type="bibr">Lu <italic toggle="yes">et al.</italic>, 2021</xref>; <xref rid="btac239-B16" ref-type="bibr">Pons <italic toggle="yes">et al.</italic>, 2021</xref>; <xref rid="btac239-B18" ref-type="bibr">Shang and Sun, 2021</xref>; <xref rid="btac239-B21" ref-type="bibr">Tan <italic toggle="yes">et al.</italic>, 2022</xref>; <xref rid="btac239-B24" ref-type="bibr">Wang <italic toggle="yes">et al.</italic>, 2020</xref>), most of which assign phages to their hosts of known bacterial genomes or at certain taxonomic levels (<xref rid="btac239-B3" ref-type="bibr">Amgarten <italic toggle="yes">et al.</italic>, 2020</xref>; <xref rid="btac239-B5" ref-type="bibr">Coutinho <italic toggle="yes">et al.</italic>, 2021</xref>; <xref rid="btac239-B16" ref-type="bibr">Pons <italic toggle="yes">et al.</italic>, 2021</xref>; <xref rid="btac239-B18" ref-type="bibr">Shang and Sun, 2021</xref>; <xref rid="btac239-B21" ref-type="bibr">Tan <italic toggle="yes">et al.</italic>, 2022</xref>; <xref rid="btac239-B24" ref-type="bibr">Wang <italic toggle="yes">et al.</italic>, 2020</xref>) except VirHostMatcher (VHM) (<xref rid="btac239-B1" ref-type="bibr">Ahlgren <italic toggle="yes">et al.</italic>, 2017</xref>) and WIsH (<xref rid="btac239-B8" ref-type="bibr">Galiez <italic toggle="yes">et al.</italic>, 2017</xref>).</p>
    <p>On the other hand, genomes of novel uncultured microbes are usually incomplete due to limitations of shot-gun sequencing. Contigs of novel genomes recovered from metagenomes, and novel genomic islands of known microbes, are absent or incomplete in current reference databases, preventing host predictions using alignment-based methods. Similarly, most viral genomes recovered from viromes are fragmented, making the whole viral genome-based host prediction impractical.</p>
    <p>The most widely used methods for phage–host association prediction are based on oligonucleotide frequency, alignment-based scores, matching of CRISPR spacers or Markov models. For example, VirHostMatcher (<xref rid="btac239-B1" ref-type="bibr">Ahlgren <italic toggle="yes">et al.</italic>, 2017</xref>) uses the dissimilarity between oligonucleotide frequencies of the phage and bacterial sequences to predict their associations. The authors investigated the prediction accuracy based on Euclidean distance, Manhattan distance, and <inline-formula id="IE1"><mml:math id="IM1" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mn>2</mml:mn><mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula> dissimilarity (<xref rid="btac239-B17" ref-type="bibr">Reinert <italic toggle="yes">et al.</italic>, 2009</xref>; <xref rid="btac239-B19" ref-type="bibr">Song <italic toggle="yes">et al.</italic>, 2013</xref>; <xref rid="btac239-B23" ref-type="bibr">Wan <italic toggle="yes">et al.</italic>, 2010</xref>) and showed that <inline-formula id="IE2"><mml:math id="IM2" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mn>2</mml:mn><mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula> yielded the highest prediction accuracy (<xref rid="btac239-B1" ref-type="bibr">Ahlgren <italic toggle="yes">et al.</italic>, 2017</xref>). WIsH (<xref rid="btac239-B8" ref-type="bibr">Galiez <italic toggle="yes">et al.</italic>, 2017</xref>) is another tool that trained a Markov model for each candidate bacterial genome and calculated the likelihood of a phage sequence under the trained Markov model. This method was also reported to have better performance than <inline-formula id="IE3"><mml:math id="IM3" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mn>2</mml:mn><mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula> when fragments were used in the prediction (<xref rid="btac239-B8" ref-type="bibr">Galiez <italic toggle="yes">et al.</italic>, 2017</xref>). VirHostMatcher-Net (<xref rid="btac239-B24" ref-type="bibr">Wang <italic toggle="yes">et al.</italic>, 2020</xref>) uses logistic regression to take advantage of multiple dissimilarity measures, including the aforementioned <inline-formula id="IE4"><mml:math id="IM4" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mn>2</mml:mn><mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula> and WIsH scores, alignment-based scores, CRISPR spacer matching and virus similarity to predict phage–host associations. RaFAH (<xref rid="btac239-B5" ref-type="bibr">Coutinho <italic toggle="yes">et al.</italic>, 2021</xref>) is another recently developed method for phage–host association prediction by constructing hidden Markov models (HMMs) according to the protein clusters identified from the pVOG (<xref rid="btac239-B9" ref-type="bibr">Grazziotin <italic toggle="yes">et al.</italic>, 2017</xref>) database and a random forests model was used to predict phage–host associations.</p>
    <p>Deep learning-based methods were also developed in recent years for predicting phage–host associations. vHULK (<xref rid="btac239-B3" ref-type="bibr">Amgarten <italic toggle="yes">et al.</italic>, 2020</xref>) applied deep neural networks to the phage–host prediction problem using features extracted from phage sequences as input. The latest proposed method HostG (<xref rid="btac239-B18" ref-type="bibr">Shang and Sun, 2021</xref>) used a graph convolutional networks to take both phage–host and phage–phage relationships into consideration, and the alignment scores were used to aid the construction of the relationships. However, these predefined features extracted from sequences alone are not suitable to train complicated models to predict contig–contig relationship.</p>
    <p>In this article, we propose ContigNet, a convolutional neural network (CNN)-based model that can predict the association status between phage and bacterial contigs, the first method investigating the relationship between two contigs. Our results showed that ContigNet was able to significantly improve the phage–host contig association prediction performance compared to currently available methods. Based on the structure of ContigNet, we also tested it on a totally different plasmid-host dataset, and the result revealed its capability as a promising approach for predicting general MGEs associated with their hosts.</p>
  </sec>
  <sec>
    <title>2 Materials and methods</title>
    <sec>
      <title>2.1 Dataset preparation</title>
      <p>The first dataset, we used was retrieved from Virus-Host DB (<xref rid="btac239-B13" ref-type="bibr">Mihara <italic toggle="yes">et al.</italic>, 2016</xref>). Virus-Host DB gathered virus and host information from multiple sources, including RefSeq, GenBank, UniProt, ViralZone and manual curation. The association between virus and host was represented as a pair of virus genome sequence and host taxonomic ID in the database. The Virus-Host DB version used in this article was released in March 2021, and this release contained 16 048 virus-host pairs with both prokaryotic and eukaryotic hosts. We filtered out non-bacterial host entries from the database. The hosts reported in the database varied in taxonomic ranks, and only phage–host pairs with host taxonomy ID at species rank were used. We then removed phage–host pairs with host taxonomy ID not presented in GenBank (<xref rid="btac239-B4" ref-type="bibr">Benson <italic toggle="yes">et al.</italic>, 2012</xref>). Finally, we got a dataset with 2589 phage–host pairs, including 2548 phages and 301 host species. The species level composition of the hosts of the phages is shown in <xref rid="btac239-F1" ref-type="fig">Figure 1</xref> that shows the top 10 most abundant species and the others. From the pie chart, we can see the hosts of the phages are not overly biased toward particular species.</p>
      <fig position="float" id="btac239-F1">
        <label>Fig. 1.</label>
        <caption>
          <p>Pie chart showing the number of phages having association with a host species in Virus-Host DB. Top 10 species are shown in the pie chart and the remaining species are combined as ‘Others’</p>
        </caption>
        <graphic xlink:href="btac239f1" position="float"/>
      </fig>
      <p>The dataset was separated into training and validation sets. To prevent extremely similar phage genomes appearing in both the training and validation sets, we used CD-Hit v4.8.1 (<xref rid="btac239-B6" ref-type="bibr">Fu <italic toggle="yes">et al.</italic>, 2012</xref>) to cluster phage genomes, which required &gt;95% sequence identity and &gt;50% alignment coverage for the shorter sequence. Finally, we obtained 2325 phage clusters and in each cluster, we randomly selected a phage chromosome to represent the sequence of other phages in the same cluster. After redundant phage genomes were removed, the dataset was randomly separated into 80% training set and 20% validation set. Any phage–host pair in the training set with the phage also appearing in the validation set was moved to the validation set. A similar approach was also applied to hosts. Given a particular taxonomy level, phage–host pairs with overlapping hosts between the training and validation sets were moved to the validation set.</p>
      <p>Virus-Host DB included genome sequences for all viruses in the database, and their host genome sequences were retrieved from GenBank according to their species taxonomy IDs. Some host species, such as <italic toggle="yes">Escherichia coli</italic>, have over 20 000 assemblies in GenBank, and it is not feasible to use all of them for training and testing. Thus, for hosts with more than 10 assemblies, we randomly downloaded 10 assemblies as representatives of that species. For host species with fewer than 10 assemblies, we downloaded all available assemblies. All collected genome sequences were used in the subsequent training procedures.</p>
      <p>To assess the generalization ability of our developed model, we also included two different datasets as test sets in our study. The first one is the Metagenomic Gut Virus (MGV) (<xref rid="btac239-B14" ref-type="bibr">Nayfach <italic toggle="yes">et al.</italic>, 2021</xref>), and the other is the PLSDB (<xref rid="btac239-B7" ref-type="bibr">Galata <italic toggle="yes">et al.</italic>, 2019</xref>) database. Both datasets were preprocessed so that they did not overlap with the training set. The details of the datasets, steps of preprocessing and rationale of choosing these two datasets as test sets will be discussed in Section 3.6.</p>
    </sec>
    <sec>
      <title>2.2 Feature representation</title>
      <p>For a phage contig with length <italic toggle="yes">L<sub>p</sub></italic>, we used a one-hot matrix to represent the contig. Particularly, A, C, G and T were represented by <inline-formula id="IE5"><mml:math id="IM5" display="inline" overflow="scroll"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">]</mml:mo><mml:mo>,</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">]</mml:mo><mml:mo>,</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">]</mml:mo><mml:mo> </mml:mo><mml:mtext>and</mml:mtext><mml:mo> </mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula>, respectively. We used <inline-formula id="IE6"><mml:math id="IM6" display="inline" overflow="scroll"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula> to represent bases other than A, C, G or T that might appear in the sequence. The constructed matrix was denoted as <italic toggle="yes">M<sub>pb</sub></italic>, with size <inline-formula id="IE7"><mml:math id="IM7" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mi>p</mml:mi></mml:msub><mml:mo>×</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:math></inline-formula>, where the subscript <italic toggle="yes">p</italic> represents the phage and <italic toggle="yes">b</italic> represents nucleotide base. Similarly, for the host, we constructed the one-hot matrix <italic toggle="yes">M<sub>hb</sub></italic> with size <inline-formula id="IE8"><mml:math id="IM8" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mi>h</mml:mi></mml:msub><mml:mo>×</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:math></inline-formula>, where <italic toggle="yes">L<sub>h</sub></italic> represents the host contig length.</p>
      <p>We also encoded the contigs based on codons using a 64 dimensional one-hot matrix, given that there are 64 possible codons, and a vector with all components being 0 was used in case the number of remaining nucleotides were not enough to form a codon or a non-regular character occurs in the sequence. Contigs were translated into peptides using 3-frame encoding, using the forward strand. Considering a fragment ATGCGTCAT, the possible reading frames can be ATG/CGT/CAT, TGC/GTC/AT-, or GCG/TCA/T-. We first constructed a one-hot matrix for each reading frame and got three individual matrices. The three matrices were concatenated together and used as the input of ContigNet. We used <italic toggle="yes">M<sub>pc</sub></italic> and <italic toggle="yes">M<sub>hc</sub></italic> to denote the resulting matrices for phage and host, respectively, where the subscript <italic toggle="yes">c</italic> indicates codon information for the phage or the host.</p>
    </sec>
    <sec>
      <title>2.3 Deep learning model structure and training</title>
      <p>The ContigNet is a four-path CNN for the phage–host prediction task. The overview of the model is depicted in <xref rid="btac239-F2" ref-type="fig">Figure 2</xref>. It takes matrices <italic toggle="yes">M<sub>pb</sub></italic> and <italic toggle="yes">M<sub>hb</sub></italic> as input and outputs a single numeric value indicating the probability if the query phage and host are associated with each other. Each of the two input matrices is branched into two paths, a base-path to encode base information and a codon-path to encode the codon information contained in the contig. In the codon-path, the codon one-hot matrices <italic toggle="yes">M<sub>pc</sub></italic> and <italic toggle="yes">M<sub>hc</sub></italic> can be converted from base matrices with a series of convolutional operations, which is named as codon transformer in the figure.</p>
      <fig position="float" id="btac239-F2">
        <label>Fig. 2.</label>
        <caption>
          <p>The overview of the deep learning model</p>
        </caption>
        <graphic xlink:href="btac239f2" position="float"/>
      </fig>
      <p>The codon transformer first constructs a filter <italic toggle="yes">F</italic> with size <inline-formula id="IE9"><mml:math id="IM9" display="inline" overflow="scroll"><mml:mrow><mml:mn>64</mml:mn><mml:mo>×</mml:mo><mml:mn>3</mml:mn><mml:mo>×</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:math></inline-formula>, i.e. the filter consists of 64 kernels, where each kernel is a 3 × 4 matrix. Here we set each kernel to be a base one-hot matrix of a possible codon. Consider a base one-hot matrix <italic toggle="yes">M</italic> with size 3 × 4, representing a 3-mer. The following function
<disp-formula id="E1"><mml:math id="M1" display="block" overflow="scroll"><mml:mrow><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi mathvariant="italic">ReLU</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>F</mml:mi><mml:mo>*</mml:mo><mml:mi>M</mml:mi><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:mo>×</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></disp-formula>where the output of <inline-formula id="IE10"><mml:math id="IM10" display="inline" overflow="scroll"><mml:mo>*</mml:mo></mml:math></inline-formula> is defined as <inline-formula id="IE11"><mml:math id="IM11" display="inline" overflow="scroll"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mi>i</mml:mi></mml:munder><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mi>j</mml:mi></mml:munder><mml:mrow><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mo>×</mml:mo><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mi>i</mml:mi></mml:munder><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mi>j</mml:mi></mml:munder><mml:mrow><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mn>64</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mo>×</mml:mo><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">]</mml:mo><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> denotes the vector with all dimensions as 1 and the <italic toggle="yes">ReLU</italic> denotes the Rectified Linear Unit. The output of <italic toggle="yes">f</italic> is a one-hot vector, where the dimension corresponding to the codon is 1 and all other dimensions are 0. By applying the convolutional filter to the base one-hot matrix, we can obtain the corresponding codon one-hot matrix.</p>
      <p>The structure of the base and codon channels consists of convolutional and max pooling layers with ReLU activation function. Usually, CNNs require a fixed size input. However, in metagenomics studies, the contig length can range from only a few hundred bps to over thousands of bps. To solve the incompatibility between variable contig length and fixed CNN input size, in ContigNet, we took advantage of the characteristic of the pooling layer to enable its ability to accept a theoretically unlimited length of contigs. The last layer of each convolution channel in ContigNet is a global pooling layer, which produces a fixed length output that can be fed into the downstream fully connected layers, regardless of the length of input. We forced the base paths and codon paths between the phage and host to have the same weight, the rationale will be discussed in Section 3.1.</p>
      <p>The outputs of four separated paths are collected, concatenated, and fed into the fully connected layer with sigmoid function as the final output of the model, which has a range of (0, 1), indicating the probability of the two input contigs of being associated with each other.</p>
      <p>The model was optimized by minimizing the binary cross-entropy loss between the output and the target. The hyper-parameters for the model training were chosen from grid search using ten-fold cross-validation on the training set. The learning rate was chosen from 0.01, 0.001, 0.0001 and 0.00001, and the batch size was chosen from 16, 32, 64 and 128. Eventually, the model was trained for 5000 epochs with early stopping criteria 0.00001 for 50 epochs. The learning rate was finally set to 0.001 and the batch size was set to 32.</p>
      <p>At each epoch, for a positive phage–host pair, we need to construct a negative phage–host pair. In this study, we randomly selected the host that was not reported interacting with the phage in Virus-Host DB to construct the negative phage–host pairs. This way of selecting the negative pairs can possibly include some phage–host pairs that have associations but not reported by previous studies. However, such potential positive phage–host pairs not reported in the database are expected to be extremely rare given that the number of truly associated phage–host pairs is much smaller than that of negatively associated pairs. Thus, we expect that such incorrectly chosen pairs will have minimal impacts on our model. For each positive phage–host pair, we constructed one negative phage–host pair resulting in the positive/negative ratio of 1:1.</p>
    </sec>
    <sec>
      <title>2.4 Investigation of the effects of contig lengths, sequencing errors and chimeric contigs on the performance of ContigNet</title>
      <p>To investigate the effects of contig lengths on prediction accuracy, for each input batch during training, validation, and testing, the phage contig length <italic toggle="yes">L<sub>p</sub></italic> was selected from 200 bps, 500 bps, 1 kbps, 5 kbps, 10 kbps and 50 kbps, and the host contig length <italic toggle="yes">L<sub>h</sub></italic> was selected randomly from 200 bps, 500 bps, 1 kbps, 5 kbps, 10 kbps, 50 kbps and 100 kbps. Contigs were then sampled from the corresponding phage and host genomes. The contig lengths and contig sequences were all re-sampled at the start of each training epoch to increase the diversity of the training dataset. Firstly, we evaluated the performance of the trained model on phage–host contig pairs directly sampled as error-free substrings of phage and host genomes. The related results were reported in Sections 3.2 and 3.3.</p>
      <p>In metagenomic samples, however, it is possible that the contigs have multiple sources of errors including sequencing and assembly errors. Therefore, we also assessed the performance of ContigNet with different types of errors. For sequencing, possible errors include insertions, deletions and substitutions. The error profiles can vary depending on sequencing (NGS) technologies, and most common sequencing technologies have error rate &lt;0.1% (<xref rid="btac239-B11" ref-type="bibr">Ma <italic toggle="yes">et al.</italic>, 2019</xref>). To simulate the general scenario, we set two parameters, <italic toggle="yes">μ</italic> as substitution rate and <italic toggle="yes">δ</italic> as insertion/deletion rate. For each nucleotide, given an error occurred, a substitution error occurred with probability <inline-formula id="IE12"><mml:math id="IM12" display="inline" overflow="scroll"><mml:mrow><mml:mfrac><mml:mo>μ</mml:mo><mml:mrow><mml:mo>μ</mml:mo><mml:mo>+</mml:mo><mml:mo>δ</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula> and the nucleotide was changed to the other nucleotides with equal probability <inline-formula id="IE13"><mml:math id="IM13" display="inline" overflow="scroll"><mml:mrow><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula>. A deletion error occurred with probability <inline-formula id="IE14"><mml:math id="IM14" display="inline" overflow="scroll"><mml:mrow><mml:mfrac><mml:mo>δ</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:mo>μ</mml:mo><mml:mo>+</mml:mo><mml:mo>δ</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula>. An insertion error occurred with probability <inline-formula id="IE15"><mml:math id="IM15" display="inline" overflow="scroll"><mml:mrow><mml:mfrac><mml:mo>δ</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:mo>μ</mml:mo><mml:mo>+</mml:mo><mml:mo>δ</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula> and one of A, C, G or T was inserted with equal probability <inline-formula id="IE16"><mml:math id="IM16" display="inline" overflow="scroll"><mml:mrow><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula>. We used this simple model to show the impact of substitution and insertion/deletion errors on the performance of ContigNet. Other sequencing error mechanisms can easily be simulated. In this experiment, we first trained ContigNet with error-free training set, and the trained model was evaluated on the validation set with artificially simulated errors with different combinations of <italic toggle="yes">δ</italic> and <italic toggle="yes">μ</italic>. The parameter <italic toggle="yes">δ</italic> was chosen from 0, 0.05 and 0.1, and <italic toggle="yes">μ</italic> was chosen from 0 to 0.1 by step of 0.02. The parameters for the simulations could be over 100 times larger than typical error rates, and therefore the results showed the lower bound of the performance of ContigNet on real metagenomic datasets. The contig lengths for both phage and host were fixed at 5 kbps, and the area under the receiver operating characteristic curve (AUROC) of ContigNet on the test sets was reported as the average of 10 repeated experiments.</p>
      <p>There are potential assembly errors of the contigs in metagenomic studies. Reads from different genomes could be assembled into the same contigs referred as chimeric contigs. We assessed the effect of the presence of chimeric contigs in the test set on the performance of error-free trained ContigNet. To simulate the occurrence of chimeric contigs, for each phage/host contig, we exchanged 0–20% of its sequence with a random contig in the validation set. We only swapped the subsequences between phages and between hosts, because previous studies showed that it is very rare to mix viral and host fragments in assembly (<xref rid="btac239-B12" ref-type="bibr">Magasin and Gerloff, 2015</xref>; <xref rid="btac239-B15" ref-type="bibr">Pignatelli and Moya, 2011</xref>). The AUROC scores of ContigNet on the validation set with sequencing errors and chimeric contigs were reported in Section 3.5.</p>
    </sec>
    <sec>
      <title>2.5 Performance evaluation</title>
      <p>The performance of our deep learning method in the phage–host association prediction was assessed using the AUROC score. The receiver operating characteristic (ROC) curve visualizes the predictive performance of a binary classifier by plotting the true positive rate against the false positive rate at various thresholds. The AUROC can be used to quantify the performance of this binary classifier.</p>
    </sec>
  </sec>
  <sec>
    <title>3 Results</title>
    <sec>
      <title>3.1 Sharing weights among base and codon paths improves model generalization</title>
      <p>The convolutional part of ContigNet is essentially a feature extractor, where each path extracts 256 features from the base and codon paths of the input sequence. Comparing with traditional alignment-free-based methods, we can consider the output of the convolution layer as the <italic toggle="yes">k</italic>-mer frequencies, and the fully-connected layers as the distance measure. When we calculate <italic toggle="yes">k</italic>-mer frequencies, we treat phage and host sequences the same and identical features are extracted from them. Hence, it is also reasonable to let the convolutional paths between both sequence types to have the same weights.</p>
      <p>To legitimize the use of shared weights, we need to compare two models, one having shared weight between phage and host paths and the other having independent weights between phage and host paths. For a fair comparison, for both models, we conducted a grid search using 10-fold cross-validation on the training set, with the learning rate chosen from 0.01, 0.001, 0.0001 and 0.00001, and the batch size chosen from 16, 32, 64 and 128. The final selected hyperparameters were the same for both models, with the learning rate being 0.0001 and batch size being 32.</p>
      <p>The trained models were then tested on the validation set. The AUROC scores of each model on contigs with different lengths, ranging from 200 bps to 5 kbps, are shown in <xref rid="btac239-F3" ref-type="fig">Figure 3</xref>. The figure shows that ContigNet with shared weights for phages and hosts outperforms the model with independent weights. The Wilcoxon signed-rank test also supports this conclusion with <italic toggle="yes">p</italic>-value <inline-formula id="IE17"><mml:math id="IM17" display="inline" overflow="scroll"><mml:mrow><mml:mn>1.33</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>25</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>. Therefore, in the rest of the article, we use the model with shared weights between the phages and the hosts.</p>
      <fig position="float" id="btac239-F3">
        <label>Fig. 3.</label>
        <caption>
          <p>ContigNet with shared weights outperforms ContigNet with distinct weights. Boxplots comparing AUROC scores of ContigNet models with and without shared weights between phage and host paths</p>
        </caption>
        <graphic xlink:href="btac239f3" position="float"/>
      </fig>
    </sec>
    <sec>
      <title>3.2 Contignet increased the prediction performance compared to existing methods</title>
      <p>K-mer-based alignment-free sequence comparison methods have been widely used for predicting phage–host associations. Among various methods of the same class, the currently known best performing alignment-free method is <inline-formula id="IE18"><mml:math id="IM18" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mn>2</mml:mn><mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula> dissimilarity (<xref rid="btac239-B1" ref-type="bibr">Ahlgren <italic toggle="yes">et al.</italic>, 2017</xref>). WIsH (<xref rid="btac239-B8" ref-type="bibr">Galiez <italic toggle="yes">et al.</italic>, 2017</xref>) is another popular method for the association status prediction between sequences. It first trains an HMM using reference sequences, then a score will be assigned to each new sequence according to the trained HMM. Since the construction of HMM is not dependent on contig lengths, we can use it on any pair of contigs. So we first compared the performance difference among <inline-formula id="IE19"><mml:math id="IM19" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mn>2</mml:mn><mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula>, WIsH and ContigNet.</p>
      <p>We used Afann (<xref rid="btac239-B22" ref-type="bibr">Tang <italic toggle="yes">et al.</italic>, 2019</xref>) to calculate the <inline-formula id="IE20"><mml:math id="IM20" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mn>2</mml:mn><mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula> dissimilarity between phage and host pairs. The selection of negative phage–host pairs was the same as the one we used to train our model. To assess the performance of <inline-formula id="IE21"><mml:math id="IM21" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mn>2</mml:mn><mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula> on contigs, we used 200 bps, 1 kbps, 5 kbps and 50 kbps as the contig lengths for both phage and host to sample from genomes. For experiments with contigs, for a given contig length <italic toggle="yes">l</italic>, we randomly sampled a contig from phage and host genomes from the validation set, respectively, and the sampling was repeated <italic toggle="yes">k </italic>=<italic toggle="yes"> </italic>10 times. With the sampled contig pairs, we then evaluated the performance of <inline-formula id="IE22"><mml:math id="IM22" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mn>2</mml:mn><mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula> using AUROC. The same approach was applied to WIsH and the AUROC score for each contig length was recorded. Similarly, we evaluated the performance of our trained model on contigs with different lengths using the same approach. To test our model, the contig pairs were sampled from the phage–host pairs in the validation set. The ROC curves for the three different methods with different contig lengths are shown in <xref rid="btac239-F4" ref-type="fig">Figure 4</xref>.</p>
      <fig position="float" id="btac239-F4">
        <label>Fig. 4.</label>
        <caption>
          <p>Performance comparison among <inline-formula id="IE23"><mml:math id="IM23" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mn>2</mml:mn><mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula>, WIsH and ContigNet. (<bold>a</bold>) The ROC curves of <inline-formula id="IE24"><mml:math id="IM24" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mn>2</mml:mn><mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula> method on the validation set with contigs of different lengths. (<bold>b</bold>) The ROC curves of WIsH on the validation set with contigs of different lengths and (<bold>c</bold>) the ROC curves of ContigNet on validation set with contigs with different lengths</p>
        </caption>
        <graphic xlink:href="btac239f4" position="float"/>
      </fig>
      <p><xref rid="btac239-F4" ref-type="fig">Figure 4a</xref> shows that for <inline-formula id="IE25"><mml:math id="IM25" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mn>2</mml:mn><mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula> the AUROC is markedly lower than that of ContigNet for virus-host contig association predictions. The AUROC score for <inline-formula id="IE26"><mml:math id="IM26" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mn>2</mml:mn><mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula> is only 0.684 for contig pairs of 50 kbps and further drops to 0.589 for contig pairs of 1 kbps. <xref rid="btac239-F4" ref-type="fig">Figure 4b</xref> depicts the performance of WIsH under different conditions, and we can see similar characteristic of the change of performance, for shorter contigs the performance drastically degraded. In comparison, as shown in <xref rid="btac239-F4" ref-type="fig">Figure 4c</xref>, ContigNet achieves a much higher AUROC of over 0.808 for contig pairs of length above 1 kbps. Even for contig pairs of length 200 bps, the AUROC can be as high as 0.717.</p>
      <p>There are several other tools for phage–host association prediction; however, they are not suitable for the question described in this study, as discussed in more detail in Section 4.</p>
    </sec>
    <sec>
      <title>3.3 The performance of ContigNet increases with both viral and host contig lengths</title>
      <p><xref rid="btac239-F4" ref-type="fig">Figure 4</xref> shows that the performance of ContigNet increases with the contig length when the viral and host contigs are of the same length. ContigNet can be applied to predict phage–host associations even if the contigs are of different lengths and we next investigate how the performance of ContigNet changes with the viral or host contig lengths.</p>
      <p>To assess the effect of different lengths of phage and host contigs on the performance of our trained model, we extended the contig length and evaluated the AUROC score of our model with contig length selected from 200 bps, 500 bps, 1 kbps, 5 kbps, 10 kbps and 50 kbps for phages and 200 bps, 500 bps, 1 kbps, 5 kbps, 10 kbps, 50 kbps and 100 kbps for hosts. The results are presented in <xref rid="btac239-F5" ref-type="fig">Figure 5</xref>. The <italic toggle="yes">x</italic>-axis represents the host contig length, and <italic toggle="yes">y</italic>-axis marks the phage contig length. <xref rid="btac239-F5" ref-type="fig">Figure 5</xref> shows an apparent increasing trend of AUROC with respect to both phage and host contig lengths. When the phage contig length is about 1 kbps, the AUROC is stablized at around 0.82 when the host contig length is above 5 kbps. When the phage contig length is above 5 kbps, the AUROC is stablized at around 0.83 when the host contig length is above 10 kbps.</p>
      <fig position="float" id="btac239-F5">
        <label>Fig. 5.</label>
        <caption>
          <p>Heatmap of AUROCs for different phage and host contig lengths. The <italic toggle="yes">x</italic>-axis represents host contig lengths and the <italic toggle="yes">y</italic>-axis represents phage contig lengths</p>
        </caption>
        <graphic xlink:href="btac239f5" position="float"/>
      </fig>
      <p>This observation can be intuitively explained by the fact that longer contigs contain more information that can be extracted by our network, resulting in a higher AUROC score.</p>
    </sec>
    <sec>
      <title>3.4 Assessing the effects of different channels</title>
      <p>For a DNA sequence, the information it contains can be classified into two granularities, base level and codon level. To incorporate these two granularities, a di-path model was utilized, i.e. two separate convolutional paths for each contig, one path for parsing base information and the other for codon information.</p>
      <p>Here we explore if the di-path model can improve the prediction results and the contributions of each path to the final result. To assess the contributions, we retrained our model by keeping only the base or codon path, assessed the performance of the single-path models, and compared their performance to our original di-path model. <xref rid="btac239-F6" ref-type="fig">Figure 6</xref> is the heatmap showing the difference of AUROC on corresponding contig lengths combinations between the di-path model and each single-path model. In the heatmap, deeper green means the di-path model performs better than the single path model, whilst red cell means the di-path model underperforms.</p>
      <fig position="float" id="btac239-F6">
        <label>Fig. 6.</label>
        <caption>
          <p>The AUROC value difference between ContigNet with di-path model and (<bold>a</bold>) base-path only model and (<bold>b</bold>) codon-path only model</p>
        </caption>
        <graphic xlink:href="btac239f6" position="float"/>
      </fig>
      <p><xref rid="btac239-F6" ref-type="fig">Figure 6</xref> shows that the base-path model does not perform as well as the di-path and codon-path models, while the di-path model and the codon-path model perform similarly. We utilized the Wilcoxon signed-rank test to quantify the difference between models. For the base-path model and the di-path model, we got <inline-formula id="IE27"><mml:math id="IM27" display="inline" overflow="scroll"><mml:mrow><mml:mi>p</mml:mi><mml:mo>=</mml:mo><mml:mn>2.41</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>8</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> with the alternative hypothesis that the AUROC of base-path model was smaller than that of the di-path model. This indicates that the di-path model performs significantly better than the base-path model. However, when comparing the codon-path model and di-path model, we got <italic toggle="yes">p </italic>=<italic toggle="yes"> </italic>0.472 with two-sided alternative hypothesis, and thus we cannot reject the null hypothesis that the two models perform the same.</p>
      <p>From the observation, we can conclude that the di-path model was not able to provide any significant advantage over using codon-path alone. Despite the aforementioned result, there was no apparent drawback of keeping both paths in the model compared to using only the codon path, and with multiple potential benefits of overparameterization in model convergence and generalization (<xref rid="btac239-B2" ref-type="bibr">Allen-Zhu <italic toggle="yes">et al.</italic>, 2019</xref>), we kept the di-path structure in our model.</p>
    </sec>
    <sec>
      <title>3.5 Sequencing errors and chimeric contigs decrease the performance of ContigNet</title>
      <p><xref rid="btac239-F7" ref-type="fig">Figures 7</xref> and <xref rid="btac239-F8" ref-type="fig">8</xref> show the performance of ContigNet trained with error-free training set and tested with validation set with artificially introduced errors. <xref rid="btac239-F7" ref-type="fig">Figure 7</xref> shows the change of performance with different levels of simulated sequencing error rates. The performance of ContigNet decreases with both substitution and insertion/deletion rates as expected. However, even with very high values of insertion/deletion rate <inline-formula id="IE28"><mml:math id="IM28" display="inline" overflow="scroll"><mml:mrow><mml:mo>δ</mml:mo><mml:mo>=</mml:mo><mml:mn>0.1</mml:mn></mml:mrow></mml:math></inline-formula> and substitution rate <inline-formula id="IE29"><mml:math id="IM29" display="inline" overflow="scroll"><mml:mrow><mml:mo>μ</mml:mo><mml:mo>=</mml:mo><mml:mn>0.1</mml:mn></mml:mrow></mml:math></inline-formula>, ContigNet still maintains a high AUROC score of above 0.805, a slight decrease from 0.840 when no errors are introduced to the validation set.</p>
      <fig position="float" id="btac239-F7">
        <label>Fig. 7.</label>
        <caption>
          <p>ContigNet performance with different levels of artificially introduced sequencing errors to the test set. The dash line stands for the baseline when no errors were introduced</p>
        </caption>
        <graphic xlink:href="btac239f7" position="float"/>
      </fig>
      <fig position="float" id="btac239-F8">
        <label>Fig. 8.</label>
        <caption>
          <p>The performance of ContigNet with different levels of artificially introduced chimera for phage contigs only, host contigs only and both phage and host contig pairs. The dash line represents the baseline AUROC of ContigNet with no chimeras</p>
        </caption>
        <graphic xlink:href="btac239f8" position="float"/>
      </fig>
      <p><xref rid="btac239-F8" ref-type="fig">Figure 8</xref> shows the AUROC scores of ContigNet with different levels of artificial chimeras for phage contigs only, host contigs only and both phage and host contig pairs. The dash line shows the AUROC score of ContigNet for no chimeras as the baseline. Both the phage and host contig lengths were set at 5 kbps. The figure shows that ContigNet is robust to phage chimeras, with AUROC staying around that for ContigNet with no chimeras. The impact of host chimeras on ContigNet is higher than that for phage contigs. ContigNet still maintains AUROC above 0.805 when the fraction of sequence from others is below 0.20. For the different impacts between host chimeras and phage chimeras on ContigNet, it can possibly be attributed to the inherent diversity differences between phages and hosts. The phages are more diverse and are more likely to exchange genetic materials compared to hosts.</p>
    </sec>
    <sec>
      <title>3.6 Performance of ContigNet on new datasets</title>
      <p>To further validate that ContigNet works well for novel data, we tested ContigNet on two separate databases. The first database is the MGV catalogue (<xref rid="btac239-B14" ref-type="bibr">Nayfach <italic toggle="yes">et al.</italic>, 2021</xref>). The investigators used multiple viral-informative features, including the presence/absence of viral protein families, the presence of viral nucleotide signatures and multiple adjacent genes on the same strand (<xref rid="btac239-B14" ref-type="bibr">Nayfach <italic toggle="yes">et al.</italic>, 2021</xref>) to identify viral contigs based on 11 810 distinct human gut metagenomic samples. The viral genomes with completeness &gt;50% were then selected from all identified viral genomes, and their hosts were identified using CRISPR-spacer matches and whole-genome alignment. Both methods require near exact matches and the predicted hosts for the viral genomes have a high specificity. We collected the phage–host pairs from the MGV database with hosts of the phages predicted at the genus level. A total of 77 348 phage–host pairs were identified. To remove phages with high similarity to phages in Virus-Host DB, we clustered the phage genomes from Virus-Host DB and MGV. The total number of phages were around 80 000. CD-Hit was not able to give a result in a reasonable time, due to not fully utilizing multi-threading. We applied MMseqs2 (<xref rid="btac239-B20" ref-type="bibr">Steinegger and Söding, 2017</xref>) with parameters local sequence identity with sequence identity threshold 95% and 50% alignment coverage for the shorter sequence, which were the same as we used when clustering the Virus-Host DB alone. Phage–host pairs from MGV with phage appeared in the same clusters as phages from Virus-Host DB were removed. Phage–host pairs with hosts under the same genus as hosts from VirHost DB were also removed. The resulting test set contains 39 916 phage–host pairs with 39 916 phages and 134 genera.</p>
      <p>The ContigNet model was trained on the entire Virus-Host DB, and tested on the MGV dataset. The AUROC results for different combinations of phage and host contig lengths are shown in <xref rid="btac239-F9" ref-type="fig">Figure 9</xref>. As a baseline, we tested <inline-formula id="IE30"><mml:math id="IM30" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mn>2</mml:mn><mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula> and WIsH on the MGV dataset with 50 kbps contigs. The selection of positive and negative pairs was the same as the aforementioned method. The AUROC score was 0.516 and 0.518, respectively. Shorter contigs were not tested because the AUROC score for longer contigs was already low. In comparison, the AUROC for ContigNet with 200 bps contigs pairs is 0.601. Compared to the result of <inline-formula id="IE31"><mml:math id="IM31" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mn>2</mml:mn><mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula> and WIsH it is a significant improvement. With contig pairs of 50 kbps, the AUROC score is 0.698, a further improvement. The score converges as we further increase the phage and host contig lengths, with 0.698 for phage contig of 50 kbps and host contig of 100 kbps. The heatmap for different contig length combinations is shown in <xref rid="btac239-F9" ref-type="fig">Figure 9</xref>. The AUROC scores are generally lower than that in <xref rid="btac239-F5" ref-type="fig">Figure 5</xref>, probably due to sequencing errors and chimeric contigs.</p>
      <fig position="float" id="btac239-F9">
        <label>Fig. 9.</label>
        <caption>
          <p>Heatmap of AUROC for different contig lengths on MGV dataset for model trained with Virus-Host DB. The <italic toggle="yes">x</italic>-axis represents host contig lengths and the <italic toggle="yes">y</italic>-axis represents phage contig lengths</p>
        </caption>
        <graphic xlink:href="btac239f9" position="float"/>
      </fig>
      <p>The second database we used was the PLSDB dataset (<xref rid="btac239-B7" ref-type="bibr">Galata <italic toggle="yes">et al.</italic>, 2019</xref>). We wondered whether the ContigNet model we developed can be used to predict plasmid-host associations. For each plasmid entry in the PLSDB dataset, a corresponding host species was provided. To evaluate the performance of our model on PLSDB, we first trained our model on the entire Virus-Host DB. For each positive plasmid-host pair in PLSDB, a different host species were randomly selected to construct the negative plasmid-host pair. The AUROC was then calculated for different plasmid and host contig lengths ranging from 200 bps to 5 kbps, and the AUROC was reported for different contig length combinations. Because plasmid and phage are two different classes of MGEs, there were no overlaps between Virus-Host DB as training set and the PLSDB as testing set. Therefore, no redundancy removal steps were required. The results are shown in <xref rid="btac239-F10" ref-type="fig">Figure 10a</xref>. The figure shows that the resulting AUROCs range from 0.734 to 0.85. For comparison, we calculated the AUROC scores when we used <inline-formula id="IE32"><mml:math id="IM32" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mn>2</mml:mn><mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula> and WIsH to predict the association status when the contig lengths were 200 bps, 1 kbps 5 kbps and 50 kbps, respectively. The results are shown in <xref rid="btac239-F10" ref-type="fig">Figure 10b and c</xref>, where the AUROC ranged from 0.489 to 0.771. By comparing the results, we can see that ContigNet has provided significant improvement even if the model was trained on a totally different dataset.</p>
      <fig position="float" id="btac239-F10">
        <label>Fig. 10.</label>
        <caption>
          <p>ContigNet can be used to predict plasmid-host associations with high accuracy. (<bold>a</bold>) Heatmap of AUROC for different contig lengths on plasmid dataset (PLSDB) for model trained with virus dataset (Virus-Host DB). The <italic toggle="yes">x</italic>-axis represents host contig lengths and the <italic toggle="yes">y</italic>-axis represents plasmid contig lengths. (<bold>b</bold>) The ROC curves of <inline-formula id="IE33"><mml:math id="IM33" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mn>2</mml:mn><mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula> method on PLSDB for contigs with different lengths. (<bold>c</bold>) The ROC curves of WIsH on PLSDB for contigs with different lengths</p>
        </caption>
        <graphic xlink:href="btac239f10" position="float"/>
      </fig>
      <p>The performance of ContigNet on PLSDB seemed unexpected, considering the distinct lifestyle between plasmids and phages. However, from evolutional perspective, both MGEs depend on organelles of hosts to replicate and have to adapt to the internal environment of a particular host, including the bias of nucleotides, codons, di-codons etc. The experiment above proves that our model is able to capture this relationship between phages and hosts, and apply it to make plasmid-host association prediction.</p>
    </sec>
    <sec>
      <title>3.7 Computational cost</title>
      <p>The training of the model pre-loads the whole Virus-Host DB and corresponding hosts into the memory to reduce I/O overhead, so a machine with over 128GB memory is recommended. We used a workstation with AMD EPYC 7742 CPU, NVIDIA RTX 2080Ti GPU and it took &lt;5 h for training, &lt;1 h for testing.</p>
    </sec>
  </sec>
  <sec>
    <title>4 Discussion</title>
    <p>In this article, we present ContigNet, a deep learning-based method for predicting phage–host contig interactions, the first deep learning method for this task. We showed that ContigNet outperforms other <italic toggle="yes">k</italic>-mer-based method such as <inline-formula id="IE34"><mml:math id="IM34" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mn>2</mml:mn><mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula> or Markov chain-based method, WIsH, for predicting phage–host contig associations.</p>
    <p>Several state-of-the-art tools are available for phage–host association prediction, including PHP (<xref rid="btac239-B10" ref-type="bibr">Lu <italic toggle="yes">et al.</italic>, 2021</xref>), HoPhage (consisting of HoPhage-G and HoPhage-S) (<xref rid="btac239-B21" ref-type="bibr">Tan <italic toggle="yes">et al.</italic>, 2022</xref>), VPF-Class (<xref rid="btac239-B16" ref-type="bibr">Pons <italic toggle="yes">et al.</italic>, 2021</xref>), VHM-Net (<xref rid="btac239-B24" ref-type="bibr">Wang <italic toggle="yes">et al.</italic>, 2020</xref>), vHULK (<xref rid="btac239-B3" ref-type="bibr">Amgarten <italic toggle="yes">et al.</italic>, 2020</xref>), RaFAH (<xref rid="btac239-B5" ref-type="bibr">Coutinho <italic toggle="yes">et al.</italic>, 2021</xref>) and HostG (<xref rid="btac239-B18" ref-type="bibr">Shang and Sun, 2021</xref>). Each of these tools has its own limitations making it unsuitable for the question of predicting phage–host contig associations in natural metagenomic settings. For instance, HoPhage-G, VPF-Class, VHM-Net, vHULK and RaFAH are multiclass classifiers with fixed candidate host set and thus cannot be used for phage–host contig association predictions. PHP is another k-mer-based method and was shown to underperform WIsH when the viral contigs were shorter than 10 kbps (<xref rid="btac239-B10" ref-type="bibr">Lu <italic toggle="yes">et al.</italic>, 2021</xref>). HoPhage-S uses coding sequences to build HMM but short contigs may not contain coding sequences. HostG uses BLASTN matches to construct phage–host connections when building the graph and integrate new hosts into the graph. However, such matches can be scarce between contigs. Therefore, all aforementioned softwares are not suitable to predict the reference-independent contig-level phage–host associations.</p>
    <p>On the other hand, ContigNet can also take the whole phage and host genomes as input because it supports contigs with any length. We compared its performance with other methods on the whole genomes according to the experimental steps described in <xref rid="btac239-B18" ref-type="bibr">Shang and Sun (2021)</xref> by testing the methods on the whole dataset and the dataset with only phage–host pairs without alignment results. And the results are shown in <xref rid="btac239-F11" ref-type="fig">Figures 11</xref> and <xref rid="btac239-F12" ref-type="fig">12</xref>. From the figures, we can observe that ContigNet still outperforms WIsH. However, ContigNet underperforms other state-of-the-art approaches for phage–host genome associations that were optimized for such a purpose. Therefore, users are advised to use existing methods specialized for whole-genome association if the host whole genome is available.</p>
    <fig position="float" id="btac239-F11">
      <label>Fig. 11.</label>
      <caption>
        <p>Host prediction accuracy for whole genomes from genus to phylum</p>
      </caption>
      <graphic xlink:href="btac239f11" position="float"/>
    </fig>
    <fig position="float" id="btac239-F12">
      <label>Fig. 12.</label>
      <caption>
        <p>Host prediction accuracy for whole genomes without alignment results from genus to phylum</p>
      </caption>
      <graphic xlink:href="btac239f12" position="float"/>
    </fig>
    <p>With the incorporation of shared weights of convolutional paths between phage and host, we observed increased performance and generalizability. If we consider ContigNet as consisting of two components, the convolutional layers and the linear layers, the convolutional layers can be considered as a feature extractor and the linear layers can be considered as a classifier accepting the 512 features extracted from phage contig and host contigs, respectively. The applications of the extracted features are not restricted to the phage–host association status prediction itself, and the derived model can also be used for plasmid-host contig association predictions, a completely different problem. Our results show the great potential that our model can be adapted for much broader applications, either directly use the model for sequence feature extraction, or use our model as a foundation and use transfer learning to fine-tune the parameters for new problems. Therefore, in our software, we provide a feature extraction mode as well as the trained model so that other investigators can use features to train new models for different questions.</p>
    <p>However, there are still more valuable topics to explore for this method in the future. Poor explainability has long been a shortcoming for deep learning-related methods in different applications, and this applies to our model too. In traditional methods, the features extracted from a sequence have clear meanings, for example, <italic toggle="yes">k</italic>-mer frequencies are the frequencies of oligonucleotides in the given sequence. Among the 512 features extracted from a sequence, 256 of them are from base information and 256 of them are from codon information, but there is no clear biological meaning for each individual feature. Therefore, an explainable feature extractor is a topic for future studies.</p>
    <p>In conclusion, ContigNet showed a competitive performance on identifying the relationship between phage and host contigs. It can be a useful tool for biological researchers when studying novel metagenomic samples from diverse natural environments, particularly those ones poorly represented in genomic databases.</p>
  </sec>
  <sec>
    <title>Data availablity statement</title>
    <p>The data underlying this article are available at <ext-link xlink:href="https://github.com/tianqitang1/ContigNet" ext-link-type="uri">https://github.com/tianqitang1/ContigNet</ext-link></p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>This work was supported by the National Institutes of Health [R01GM120624, 1R01GM131407], the National Science Foundation [EF-2125142], the Simons Collaboration on Computational Biogeochemical Modeling of Marine Ecosystems/CBIOMES grant (ID: 549943) and the Gordon and Betty Moore Foundation (Grant Number: 3779).</p>
    <p><italic toggle="yes">Conflict of Interest</italic>: none declared.  </p>
  </sec>
</body>
<back>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btac239-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ahlgren</surname><given-names>N.A.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2017</year>) <article-title>Alignment-free oligonucleotide frequency dissimilarity measure improves prediction of hosts from metagenomically-derived viral sequences</article-title>. <source>Nucleic Acids Res.</source>  <volume>45</volume>, <fpage>39</fpage>–<lpage>53</lpage>.<pub-id pub-id-type="pmid">27899557</pub-id></mixed-citation>
    </ref>
    <ref id="btac239-B2">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Allen-Zhu</surname><given-names>Z.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019</year>). Learning and generalization in overparameterized neural networks, going beyond two layers. <italic toggle="yes">NIPS'19: Proceedings of the 33rd International Conference on Neural Information Processing Systems</italic>, pp. 6158–6169.</mixed-citation>
    </ref>
    <ref id="btac239-B3">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Amgarten</surname><given-names>D.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2020</year>). vHULK, a new tool for bacteriophage host prediction based on annotated genomic features and deep neural networks. <italic toggle="yes">bioRxiv</italic>.</mixed-citation>
    </ref>
    <ref id="btac239-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Benson</surname><given-names>D.A.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2012</year>) <article-title>Genbank</article-title>. <source>Nucleic Acids Res.</source>  <volume>41</volume>, <fpage>D36</fpage>–<lpage>D42</lpage>.<pub-id pub-id-type="pmid">23193287</pub-id></mixed-citation>
    </ref>
    <ref id="btac239-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Coutinho</surname><given-names>F.H.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2021</year>) <article-title>RaFAH: host prediction for viruses of bacteria and archaea based on protein content</article-title>. <source>Patterns</source>  <volume>2</volume>, <fpage>100274</fpage>.<pub-id pub-id-type="pmid">34286299</pub-id></mixed-citation>
    </ref>
    <ref id="btac239-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Fu</surname><given-names>L.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2012</year>) <article-title>CD-HIT: accelerated for clustering the next-generation sequencing data</article-title>. <source>Bioinformatics</source>  <volume>28</volume>, <fpage>3150</fpage>–<lpage>3152</lpage>.<pub-id pub-id-type="pmid">23060610</pub-id></mixed-citation>
    </ref>
    <ref id="btac239-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Galata</surname><given-names>V.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019</year>) <article-title>PLSDB: a resource of complete bacterial plasmids</article-title>. <source>Nucleic Acids Res.</source>  <volume>47</volume>, <fpage>D195</fpage>–<lpage>D202</lpage>.<pub-id pub-id-type="pmid">30380090</pub-id></mixed-citation>
    </ref>
    <ref id="btac239-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Galiez</surname><given-names>C.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2017</year>) <article-title>Wish: who is the host? Predicting prokaryotic hosts from metagenomic phage contigs</article-title>. <source>Bioinformatics</source>  <volume>33</volume>, <fpage>3113</fpage>–<lpage>3114</lpage>.<pub-id pub-id-type="pmid">28957499</pub-id></mixed-citation>
    </ref>
    <ref id="btac239-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Grazziotin</surname><given-names>A.L.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2017</year>) <article-title>Prokaryotic virus orthologous groups (pVOGs): a resource for comparative genomics and protein family annotation</article-title>. <source>Nucleic Acids Res.</source>  <volume>45</volume>, <fpage>D491</fpage>–<lpage>D498</lpage>.<pub-id pub-id-type="pmid">27789703</pub-id></mixed-citation>
    </ref>
    <ref id="btac239-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lu</surname><given-names>C.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2021</year>) <article-title>Prokaryotic virus host predictor: a Gaussian model for host prediction of prokaryotic viruses in metagenomics</article-title>. <source>BMC Biol.</source>  <volume>19</volume>, <fpage>5</fpage>.<pub-id pub-id-type="pmid">33441133</pub-id></mixed-citation>
    </ref>
    <ref id="btac239-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ma</surname><given-names>X.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019</year>) <article-title>Analysis of error profiles in deep next-generation sequencing data</article-title>. <source>Genome Biol.</source>  <volume>20</volume>, <fpage>50</fpage>.<pub-id pub-id-type="pmid">30867008</pub-id></mixed-citation>
    </ref>
    <ref id="btac239-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Magasin</surname><given-names>J.D.</given-names>,</string-name>, <string-name><surname>Gerloff</surname><given-names>D.L.</given-names></string-name></person-group> (<year>2015</year>) <article-title>Pooled assembly of marine metagenomic datasets: enriching annotation through chimerism</article-title>. <source>Bioinformatics</source>  <volume>31</volume>, <fpage>311</fpage>–<lpage>317</lpage>.<pub-id pub-id-type="pmid">25306399</pub-id></mixed-citation>
    </ref>
    <ref id="btac239-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mihara</surname><given-names>T.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2016</year>) <article-title>Linking virus genomes with host taxonomy</article-title>. <source>Viruses</source>  <volume>8</volume>, <fpage>66</fpage>.<pub-id pub-id-type="pmid">26938550</pub-id></mixed-citation>
    </ref>
    <ref id="btac239-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Nayfach</surname><given-names>S.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2021</year>) <article-title>Metagenomic compendium of 189,680 DNA viruses from the human gut microbiome</article-title>. <source>Nat. Microbiol.</source>  <volume>6</volume>, <fpage>960</fpage>–<lpage>970</lpage>.<pub-id pub-id-type="pmid">34168315</pub-id></mixed-citation>
    </ref>
    <ref id="btac239-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pignatelli</surname><given-names>M.</given-names></string-name>, <string-name><surname>Moya</surname><given-names>A.</given-names></string-name></person-group> (<year>2011</year>) <article-title>Evaluating the fidelity of <italic toggle="yes">de novo</italic> short read metagenomic assembly using simulated data</article-title>. <source>PLoS One.</source>  <volume>6</volume>, <fpage>e19984</fpage>.<pub-id pub-id-type="pmid">21625384</pub-id></mixed-citation>
    </ref>
    <ref id="btac239-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pons</surname><given-names>J.C.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2021</year>) <article-title>VPF-Class: taxonomic assignment and host prediction of uncultivated viruses based on viral protein families</article-title>. <source>Bioinformatics</source>  <volume>37</volume>, <fpage>1805</fpage>–<lpage>1813</lpage>.<pub-id pub-id-type="pmid">33471063</pub-id></mixed-citation>
    </ref>
    <ref id="btac239-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Reinert</surname><given-names>G.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2009</year>) <article-title>Alignment-free sequence comparison (I): statistics and power</article-title>. <source>J. Comput. Biol.</source>  <volume>16</volume>, <fpage>1615</fpage>–<lpage>1634</lpage>.<pub-id pub-id-type="pmid">20001252</pub-id></mixed-citation>
    </ref>
    <ref id="btac239-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Shang</surname><given-names>J.</given-names></string-name>, <string-name><surname>Sun</surname><given-names>Y.</given-names></string-name></person-group> (<year>2021</year>) <article-title>Predicting the hosts of prokaryotic viruses using GCN-based semi-supervised learning</article-title>. <source>BMC Biol.</source>  <volume>19</volume>, <fpage>250</fpage>.<pub-id pub-id-type="pmid">34819064</pub-id></mixed-citation>
    </ref>
    <ref id="btac239-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Song</surname><given-names>K.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2013</year>) <article-title>Alignment-free sequence comparison based on next-generation sequencing reads</article-title>. <source>J. Comput. Biol.</source>  <volume>20</volume>, <fpage>64</fpage>–<lpage>79</lpage>.<pub-id pub-id-type="pmid">23383994</pub-id></mixed-citation>
    </ref>
    <ref id="btac239-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Steinegger</surname><given-names>M.</given-names></string-name>, <string-name><surname>Söding</surname><given-names>J.</given-names></string-name></person-group> (<year>2017</year>) <article-title>MMseqs2 enables sensitive protein sequence searching for the analysis of massive data sets</article-title>. <source>Nat. Biotechnol.</source>  <volume>35</volume>, <fpage>1026</fpage>–<lpage>1028</lpage>.<pub-id pub-id-type="pmid">29035372</pub-id></mixed-citation>
    </ref>
    <ref id="btac239-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tan</surname><given-names>J.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2022</year>) <article-title>HoPhage: an <italic toggle="yes">ab initio</italic> tool for identifying hosts of phage fragments from metaviromes</article-title>. <source>Bioinformatics</source>  <volume>38</volume>, <fpage>543</fpage>–<lpage>545</lpage>.<pub-id pub-id-type="pmid">34383025</pub-id></mixed-citation>
    </ref>
    <ref id="btac239-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tang</surname><given-names>K.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019</year>) <article-title>Afann: bias adjustment for alignment-free sequence comparison based on sequencing data using neural network regression</article-title>. <source>Genome Biol.</source>  <volume>20</volume>, <fpage>266</fpage>.<pub-id pub-id-type="pmid">31801606</pub-id></mixed-citation>
    </ref>
    <ref id="btac239-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wan</surname><given-names>L.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2010</year>) <article-title>Alignment-free sequence comparison (II): theoretical power of comparison statistics</article-title>. <source>J. Comput. Biol.</source>  <volume>17</volume>, <fpage>1467</fpage>–<lpage>1490</lpage>.<pub-id pub-id-type="pmid">20973742</pub-id></mixed-citation>
    </ref>
    <ref id="btac239-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wang</surname><given-names>W.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2020</year>) <article-title>A network-based integrated framework for predicting virus–prokaryote interactions</article-title>. <source>NAR Genom. Bioinform.</source>  <volume>2</volume>, <fpage>lqaa044</fpage>.<pub-id pub-id-type="pmid">32626849</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
