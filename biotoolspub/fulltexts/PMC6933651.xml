<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6933651</article-id>
    <article-id pub-id-type="publisher-id">3294</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-019-3294-3</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Model-based cell clustering and population tracking for time-series flow cytometry data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Minoura</surname>
          <given-names>Kodai</given-names>
        </name>
        <address>
          <email>minoura.kodai@e.mbox.nagoya-u.ac.jp</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Abe</surname>
          <given-names>Ko</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Maeda</surname>
          <given-names>Yuka</given-names>
        </name>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Nishikawa</surname>
          <given-names>Hiroyoshi</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Shimamura</surname>
          <given-names>Teppei</given-names>
        </name>
        <address>
          <email>shimamura@med.nagoya-u.ac.jp</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 0943 978X</institution-id><institution-id institution-id-type="GRID">grid.27476.30</institution-id><institution>Division of Systems Biology, Graduate School of Medicine, Nagoya University, </institution></institution-wrap>65 Trumumai-cho, Showa-ku, Nagoya, 4668550 Japan </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 0943 978X</institution-id><institution-id institution-id-type="GRID">grid.27476.30</institution-id><institution>Division of Immunology, Graduate School of Medicine, Nagoya University, </institution></institution-wrap>65 Trumumai-cho, Showa-ku, Nagoya, 4668550 Japan </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2168 5385</institution-id><institution-id institution-id-type="GRID">grid.272242.3</institution-id><institution>Division of Cancer Immunology, Research Institute/EPOC, National Cancer Center, </institution></institution-wrap>Tokyo/Chiba, 1040045/2778577 Japan </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>27</day>
      <month>12</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>27</day>
      <month>12</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2019</year>
    </pub-date>
    <volume>20</volume>
    <issue>Suppl 23</issue>
    <issue-sponsor>Publication of this supplement has not been supported by sponsorship. Information about the source of funding for publication charges can be found in the individual articles. The articles have undergone the journal's standard peer review process for supplements. Supplement Editors were not responsible for the review of papers they had authored. No other competing interests were declared.</issue-sponsor>
    <elocation-id>633</elocation-id>
    <permissions>
      <copyright-statement>© The Author(s) 2019</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold> This article is distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">Modern flow cytometry technology has enabled the simultaneous analysis of multiple cell markers at the single-cell level, and it is widely used in a broad field of research. The detection of cell populations in flow cytometry data has long been dependent on “manual gating” by visual inspection. Recently, numerous software have been developed for automatic, computationally guided detection of cell populations; however, they are not designed for time-series flow cytometry data. Time-series flow cytometry data are indispensable for investigating the dynamics of cell populations that could not be elucidated by static time-point analysis. Therefore, there is a great need for tools to systematically analyze time-series flow cytometry data.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">We propose a simple and efficient statistical framework, named CYBERTRACK (CYtometry-Based Estimation and Reasoning for TRACKing cell populations), to perform clustering and cell population tracking for time-series flow cytometry data. CYBERTRACK assumes that flow cytometry data are generated from a multivariate Gaussian mixture distribution with its mixture proportion at the current time dependent on that at a previous timepoint. Using simulation data, we evaluate the performance of CYBERTRACK when estimating parameters for a multivariate Gaussian mixture distribution, tracking time-dependent transitions of mixture proportions, and detecting change-points in the overall mixture proportion. The CYBERTRACK performance is validated using two real flow cytometry datasets, which demonstrate that the population dynamics detected by CYBERTRACK are consistent with our prior knowledge of lymphocyte behavior.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p id="Par3">Our results indicate that CYBERTRACK offers better understandings of time-dependent cell population dynamics to cytometry users by systematically analyzing time-series flow cytometry data.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Flow cytometry</kwd>
      <kwd>Time-series</kwd>
      <kwd>Topic model</kwd>
      <kwd>Baysian inference</kwd>
    </kwd-group>
    <conference xlink:href="https://www.abacbs.org/conference2019/about">
      <conf-name>Joint 30th International Conference on Genome Informatics (GIW) &amp; Australian Bioinformatics and Computational Biology Society (ABACBS) Annual Conference</conf-name>
      <conf-loc>Sydney, Australia</conf-loc>
      <conf-date>9-11 December 2019</conf-date>
    </conference>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2019</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p>Flow cytometry is a widely used technology for identifying and quantifying cellular properties and cell populations by measuring expression levels of surface and intracellular proteins at the single-cell level. Modern flow cytometers allow the simultaneous detection of nearly 20 protein markers per cell with a throughput of thousands of cells per second. The flow cytometry technique has greatly contributed to understanding the cellular biological processes and supporting clinical diagnoses in fields including immunology, cancer biology, and regenerative medicine [<xref ref-type="bibr" rid="CR1">1</xref>–<xref ref-type="bibr" rid="CR3">3</xref>].</p>
    <p>An important challenge in the analysis of flow cytometry data is the classification of individual cells into canonical cell types, that is, subset populations such as T and B cells. The traditional approach of “manual gating” is performed by visually inspecting a two-dimensional scatter plot, but it suffers from several major limitations, including subjectivity, operator bias, difficulties in detecting unknown cell populations, and difficulties in reproducibility [<xref ref-type="bibr" rid="CR4">4</xref>–<xref ref-type="bibr" rid="CR6">6</xref>].</p>
    <p>To overcome these limitations, several methods have been proposed for the computationally guided or automated detection of unknown cell populations by unsupervised clustering, including FlowSOM, X-shift, PhenoGraph, Rclusterpp, and flowMeans [<xref ref-type="bibr" rid="CR7">7</xref>]. Although these methods have been successfully applied to identify both major and rare cell populations, they are not designed for modeling and analyzing time-series data and thus cannot capture the time-dependent properties and dynamics of cell populations. For example, in clinical applications such as cancer immunotherapies, we are interested in investigating drug effects on cell populations by monitoring their dynamics throughout the treatment period [<xref ref-type="bibr" rid="CR8">8</xref>]. Time-series flow cytometry data offer information on longitudinal cell population dynamics that could not be elucidated by conventional static time-point data. However, such research is currently limited by a lack of a systematic mathematical framework to adequately model and analyze time-series flow cytometry data.</p>
    <p>To address this problem, we propose a new statistical framework, named CYBERTRACK (CYtometry-Based Estimation and Reasoning for TRACKing cell populations), for the automatic clustering and tracking of a mixture proportion of cell populations in time-series flow cytometry data. Our contributions are summarized as follows:
<list list-type="bullet"><list-item><p>Our framework is based on the Topic Tracking Model proposed by Iwata <italic>et al.,</italic> 2009, which is designed for tracking topic distribution that changes over time. We extend their model to handle time-series flow cytometry data, which is assumed to follow a multivariate Gaussian mixture distribution.</p></list-item><list-item><p>By assuming that the mixture proportion at the current time is dependent on that at a previous time, CYBERTRACK is capable of estimating the longitudinal transition of multiple cell populations and detecting the “change-point” in the overall mixture proportion.</p></list-item><list-item><p>We provide a simple and efficient learning procedure for the proposed model by using a stochastic EM algorithm, which is an alternate iteration of Gibbs sampling and maximum a posteriori (MAP) estimation of parameters. CYBERTRACK is implemented in an R environment, and the implementation is available from <ext-link ext-link-type="uri" xlink:href="https://github.com/kodaim1115/CYBERTRACK">https://github.com/kodaim1115/CYBERTRACK</ext-link>.</p></list-item></list></p>
    <p>A conceptual view of an analysis by CYBERTRACK is shown in Fig. <xref rid="Fig1" ref-type="fig">1</xref>.
<fig id="Fig1"><label>Fig. 1</label><caption><p>Conceptual view of the analysis by CYBERTRACK. The aim of CYBERTRACK is to model and analyze time-series flowcytometry data to understand dynamic cell population behavior that spans certain period of time. In time-series flow cytometry analysis, cells are acquired sequentially and their expression levels of marker proteins are analyzed, giving data matrices of cells and markers for each timepoint. CYBERTRACK takes these data matrices as an input and performs <italic>i</italic>) clustering, <italic>ii</italic>) tracking cell population dynamics, and <italic>iii</italic>) detecting change-points in cell population constitution</p></caption><graphic xlink:href="12859_2019_3294_Fig1_HTML" id="MO1"/></fig></p>
    <p>Our model and algorithm are described in the “<xref rid="Sec2" ref-type="sec">Methods</xref>” section. To validate its performance and practicability, we applied CYBERTRACK to both simulation and real time-series flow cytometry datasets for two immunological experiments.</p>
  </sec>
  <sec id="Sec2">
    <title>Methods</title>
    <sec id="Sec3">
      <title>Model</title>
      <p>Suppose that we observe time series flow cytometry data <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$y_{t,d,n} \in \mathbb {R}^{K}$\end{document}</tex-math><mml:math id="M2"><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi>ℝ</mml:mi></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="12859_2019_3294_Article_IEq1.gif"/></alternatives></inline-formula>, where <italic>t</italic>∈{1,...,<italic>T</italic>} is a time index, <italic>d</italic>∈{1,...,<italic>D</italic>} is a case index, <italic>n</italic>∈{1,...,<italic>N</italic><sub><italic>t</italic>,<italic>d</italic></sub>} is a cell index, and <italic>K</italic> is the number of markers. In the context of flow cytometry experiment, case corresponds to a study subjects (e.g. cultured cell, mouse, or patient) from which cells are collected and analyzed. <italic>N</italic><sub><italic>t</italic>,<italic>d</italic></sub> represents the number of cells observed at time <italic>t</italic> for case <italic>d</italic>. The objective of this study is to perform clustering of cells and track the time-dependent transition of cluster mixture proportion <italic>π</italic><sub><italic>t</italic>,<italic>d</italic>,<italic>l</italic></sub> for each case, where <italic>l</italic>∈{1,...,<italic>L</italic>} is a cluster index. Our model is inspired by the Topic Tracking Model, and is an extension of the multivariate Gaussian mixture model. Topic Model is a Bayesian model which was originally designed to extract latent semantics, or “topics”, from text data. Topic Tracking Model is an extension of Topic Model specialized in tracking time-varying topic distribution [<xref ref-type="bibr" rid="CR9">9</xref>]. Although the original Topic Tracking Model assumed each word was generated from a multinomial distribution, this assumption does not apply to flow cytometry data, where each cell possess continuous values for the number of markers. Therefore, we assumed that flow cytometry data follow a multivariate Gaussian mixture distribution. Since the original Topic Tracking Model is not designed to estimate parameters for the multivariate Gaussian mixture distribution, we constructed the stochastic EM algorithm to solve this problem. Here, topics correspond to cell populations such as T cells or B cells. Figure <xref rid="Fig2" ref-type="fig">2</xref> illustrates a plate diagram of our proposed model, where, <bold><italic>z</italic></bold><sub><italic>t</italic>,<italic>d</italic>,<italic>n</italic></sub> is a latent cluster vector of length <italic>L</italic> that holds 1 for the <italic>l</italic>-th element when a cell is generated from cluster <italic>l</italic> and holds 0 otherwise. We assume that each cell is generated from a multivariate Gaussian mixture distribution with the parameter vector <bold><italic>μ</italic></bold><sub><italic>l</italic></sub> and <bold><italic>Σ</italic></bold><sub><italic>l</italic></sub>, which represents the mean and the covariance matrix for cluster <italic>l</italic>, respectively. More specifically, the generative process of CYBERTRACK is defined by
<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{@{}rcl@{}} &amp;&amp;\boldsymbol{y}_{t,d,n} \mid \boldsymbol{z}_{t,d,n}\sim \text{Gaussian}(\boldsymbol{\mu}_{z},\boldsymbol{\Sigma}_{z}) \end{array} $$ \end{document}</tex-math><mml:math id="M4"><mml:mtable class="eqnarray" columnalign="left center right"><mml:mtr><mml:mtd class="eqnarray-1"/><mml:mtd class="eqnarray-2"/><mml:mtd class="eqnarray-3"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>∣</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">z</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mtext>Gaussian</mml:mtext><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">μ</mml:mi></mml:mrow><mml:mrow><mml:mi>z</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">Σ</mml:mi></mml:mrow><mml:mrow><mml:mi>z</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="12859_2019_3294_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula>
<fig id="Fig2"><label>Fig. 2</label><caption><p>Graphical model of CYBERTRACK</p></caption><graphic xlink:href="12859_2019_3294_Fig2_HTML" id="MO2"/></fig></p>
      <p>
        <disp-formula id="Equ2">
          <label>2</label>
          <alternatives>
            <tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{@{}rcl@{}} &amp;&amp;\boldsymbol{z}_{t,d,n}\mid\boldsymbol{\pi}_{t,d}\sim\text{Categorical}(\boldsymbol{\pi}_{t,d}) \end{array} $$ \end{document}</tex-math>
            <mml:math id="M6">
              <mml:mtable class="eqnarray" columnalign="left center right">
                <mml:mtr>
                  <mml:mtd class="eqnarray-1"/>
                  <mml:mtd class="eqnarray-2"/>
                  <mml:mtd class="eqnarray-3">
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi mathvariant="bold-italic">z</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>t</mml:mi>
                        <mml:mo>,</mml:mo>
                        <mml:mi>d</mml:mi>
                        <mml:mo>,</mml:mo>
                        <mml:mi>n</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo>∣</mml:mo>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi mathvariant="bold-italic">π</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>t</mml:mi>
                        <mml:mo>,</mml:mo>
                        <mml:mi>d</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo>∼</mml:mo>
                    <mml:mtext>Categorical</mml:mtext>
                    <mml:mo>(</mml:mo>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi mathvariant="bold-italic">π</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>t</mml:mi>
                        <mml:mo>,</mml:mo>
                        <mml:mi>d</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo>)</mml:mo>
                  </mml:mtd>
                </mml:mtr>
              </mml:mtable>
            </mml:math>
            <graphic xlink:href="12859_2019_3294_Article_Equ2.gif" position="anchor"/>
          </alternatives>
        </disp-formula>
      </p>
      <p>
        <disp-formula id="Equ3">
          <label>3</label>
          <alternatives>
            <tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{@{}rcl@{}} &amp;&amp;\boldsymbol{\pi}_{t,d}\mid\alpha_{t,d},\boldsymbol{\pi}_{t-1,d}\sim\text{Dirichlet}(\alpha_{t,d}\boldsymbol{\pi}_{t-1,d}) \end{array} $$ \end{document}</tex-math>
            <mml:math id="M8">
              <mml:mtable class="eqnarray" columnalign="left center right">
                <mml:mtr>
                  <mml:mtd class="eqnarray-1"/>
                  <mml:mtd class="eqnarray-2"/>
                  <mml:mtd class="eqnarray-3">
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi mathvariant="bold-italic">π</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>t</mml:mi>
                        <mml:mo>,</mml:mo>
                        <mml:mi>d</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo>∣</mml:mo>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>α</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>t</mml:mi>
                        <mml:mo>,</mml:mo>
                        <mml:mi>d</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo>,</mml:mo>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi mathvariant="bold-italic">π</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>t</mml:mi>
                        <mml:mo>−</mml:mo>
                        <mml:mn>1</mml:mn>
                        <mml:mo>,</mml:mo>
                        <mml:mi>d</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo>∼</mml:mo>
                    <mml:mtext>Dirichlet</mml:mtext>
                    <mml:mo>(</mml:mo>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>α</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>t</mml:mi>
                        <mml:mo>,</mml:mo>
                        <mml:mi>d</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi mathvariant="bold-italic">π</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>t</mml:mi>
                        <mml:mo>−</mml:mo>
                        <mml:mn>1</mml:mn>
                        <mml:mo>,</mml:mo>
                        <mml:mi>d</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo>)</mml:mo>
                  </mml:mtd>
                </mml:mtr>
              </mml:mtable>
            </mml:math>
            <graphic xlink:href="12859_2019_3294_Article_Equ3.gif" position="anchor"/>
          </alternatives>
        </disp-formula>
      </p>
      <p>
        <disp-formula id="Equ4">
          <label>4</label>
          <alternatives>
            <tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{@{}rcl@{}} &amp;&amp;\boldsymbol{\mu}_{l} \mid \tau, \mathbf{\Sigma}_{l} \sim \text{Gaussian}\left(0,\tau^{-1}\mathbf{\Sigma}_{l}\right) \end{array} $$ \end{document}</tex-math>
            <mml:math id="M10">
              <mml:mtable class="eqnarray" columnalign="left center right">
                <mml:mtr>
                  <mml:mtd class="eqnarray-1"/>
                  <mml:mtd class="eqnarray-2"/>
                  <mml:mtd class="eqnarray-3">
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi mathvariant="bold-italic">μ</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>l</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo>∣</mml:mo>
                    <mml:mi>τ</mml:mi>
                    <mml:mo>,</mml:mo>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi mathvariant="bold">Σ</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>l</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo>∼</mml:mo>
                    <mml:mtext>Gaussian</mml:mtext>
                    <mml:mfenced close=")" open="(" separators="">
                      <mml:mrow>
                        <mml:mn>0</mml:mn>
                        <mml:mo>,</mml:mo>
                        <mml:msup>
                          <mml:mrow>
                            <mml:mi>τ</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mo>−</mml:mo>
                            <mml:mn>1</mml:mn>
                          </mml:mrow>
                        </mml:msup>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi mathvariant="bold">Σ</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>l</mml:mi>
                          </mml:mrow>
                        </mml:msub>
                      </mml:mrow>
                    </mml:mfenced>
                  </mml:mtd>
                </mml:mtr>
              </mml:mtable>
            </mml:math>
            <graphic xlink:href="12859_2019_3294_Article_Equ4.gif" position="anchor"/>
          </alternatives>
        </disp-formula>
      </p>
      <p>
        <disp-formula id="Equ5">
          <label>5</label>
          <alternatives>
            <tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{@{}rcl@{}} &amp;&amp;\mathbf{\Sigma}_{l}^{-1} \mid \nu, \mathbf{\Lambda} \sim \text{Wishart}\left(\nu, \mathbf{\Lambda}^{-1}\right) \end{array} $$ \end{document}</tex-math>
            <mml:math id="M12">
              <mml:mtable class="eqnarray" columnalign="left center right">
                <mml:mtr>
                  <mml:mtd class="eqnarray-1"/>
                  <mml:mtd class="eqnarray-2"/>
                  <mml:mtd class="eqnarray-3">
                    <mml:msubsup>
                      <mml:mrow>
                        <mml:mi mathvariant="bold">Σ</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>l</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mo>−</mml:mo>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                    </mml:msubsup>
                    <mml:mo>∣</mml:mo>
                    <mml:mi>ν</mml:mi>
                    <mml:mo>,</mml:mo>
                    <mml:mi mathvariant="bold">Λ</mml:mi>
                    <mml:mo>∼</mml:mo>
                    <mml:mtext>Wishart</mml:mtext>
                    <mml:mfenced close=")" open="(" separators="">
                      <mml:mrow>
                        <mml:mi>ν</mml:mi>
                        <mml:mo>,</mml:mo>
                        <mml:msup>
                          <mml:mrow>
                            <mml:mi mathvariant="bold">Λ</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mo>−</mml:mo>
                            <mml:mn>1</mml:mn>
                          </mml:mrow>
                        </mml:msup>
                      </mml:mrow>
                    </mml:mfenced>
                  </mml:mtd>
                </mml:mtr>
              </mml:mtable>
            </mml:math>
            <graphic xlink:href="12859_2019_3294_Article_Equ5.gif" position="anchor"/>
          </alternatives>
        </disp-formula>
      </p>
      <p>where <italic>z</italic> is a latent cluster of the <italic>n</italic>-th cell at time <italic>t</italic> for case <italic>d</italic> indicated by <bold><italic>z</italic></bold><sub><italic>t</italic>,<italic>d</italic>,<italic>n</italic></sub>, <bold><italic>μ</italic></bold><sub><italic>z</italic></sub> and <bold>Σ</bold><sub><italic>z</italic></sub> are the mean vector and covariance matrix of the latent cluster, respectively, <inline-formula id="IEq2"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\boldsymbol {\pi }_{t,d} = \{\pi _{t,d,l}\}_{l=1}^{L}$\end{document}</tex-math><mml:math id="M14"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">π</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2019_3294_Article_IEq2.gif"/></alternatives></inline-formula> is the mixture proportion vector, and <italic>α</italic><sub><italic>t</italic>,<italic>d</italic></sub> represents the persistency parameter, which indicates how consistent the mixture proportion at time <italic>t</italic> is compared with that at the previous time <italic>t</italic>−1. A smaller <italic>α</italic><sub><italic>t</italic>,<italic>d</italic></sub> value indicates a larger discrepancy between the mixture proportion at time <italic>t</italic> and <italic>t</italic>−1. Thus, timepoints with relatively small persistency parameters could be considered as “change-points” in the mixture proportion. <inline-formula id="IEq3"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\boldsymbol {\mu } = \{\boldsymbol {\mu }_{l}\}_{l=1}^{L}$\end{document}</tex-math><mml:math id="M16"><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">μ</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2019_3294_Article_IEq3.gif"/></alternatives></inline-formula> is the mean vectors of clusters, and <inline-formula id="IEq4"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathbf {\Sigma } = \{\boldsymbol {\Sigma }_{l}\}_{l=1}^{L}$\end{document}</tex-math><mml:math id="M18"><mml:mi mathvariant="bold">Σ</mml:mi><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">Σ</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2019_3294_Article_IEq4.gif"/></alternatives></inline-formula> is the covariance matrices of clusters. <italic>τ</italic> is the hyperparameter of the <bold><italic>μ</italic></bold> prior distribution, and <bold>Λ</bold> and <italic>ν</italic> are the hyperparameters of the <bold>Σ</bold> prior distribution.</p>
    </sec>
    <sec id="Sec4">
      <title>Parameter estimation</title>
      <p>Parameter estimation in CYBERTRACK is based on the stochastic EM algorithm, which is an alternate iteration of Gibbs sampling and maximum a posteriori estimation of parameters. Suppose <italic>t</italic> is the current time, and suppose we have flow cytometry data matrix <inline-formula id="IEq5"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathbf {Y}_{t}=\{\mathbf {Y}_{t,d}\}_{d=1}^{D}$\end{document}</tex-math><mml:math id="M20"><mml:msub><mml:mrow><mml:mi mathvariant="bold">Y</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">Y</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>D</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2019_3294_Article_IEq5.gif"/></alternatives></inline-formula> and a mixture proportion matrix <inline-formula id="IEq6"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathbf {\Pi }_{t} = \{\boldsymbol {\pi }_{t,d}\}_{d=1}^{D}$\end{document}</tex-math><mml:math id="M22"><mml:msub><mml:mrow><mml:mi mathvariant="bold">Π</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">π</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>D</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2019_3294_Article_IEq6.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq7"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathbf {Y}_{t,d}=\{\boldsymbol {y}_{t,d,n}\}_{n=1}^{N_{t,d}}$\end{document}</tex-math><mml:math id="M24"><mml:msub><mml:mrow><mml:mi mathvariant="bold">Y</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2019_3294_Article_IEq7.gif"/></alternatives></inline-formula>. We perform the inference of latent clusters based on Gibbs sampling. Let <inline-formula id="IEq8"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathbf {Z}_{t} = \{\boldsymbol {z}_{t,d}\}_{d=1}^{D}$\end{document}</tex-math><mml:math id="M26"><mml:msub><mml:mrow><mml:mi mathvariant="bold">Z</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">z</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>D</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2019_3294_Article_IEq8.gif"/></alternatives></inline-formula> be the set of latent clusters of all cases at time <italic>t</italic>, where <inline-formula id="IEq9"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\boldsymbol {z}_{t,d} = \{\boldsymbol {z}_{t,d,n}\}_{n=1}^{N_{t,d}}$\end{document}</tex-math><mml:math id="M28"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">z</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">z</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2019_3294_Article_IEq9.gif"/></alternatives></inline-formula>. The posterior distribution of <bold>Z</bold><sub><italic>t</italic></sub> given <bold>Y</bold><sub><italic>t</italic></sub>, <bold>Π</bold><sub><italic>t</italic></sub>, <bold><italic>μ</italic></bold>, and <bold>Σ</bold> can be written as follows:
<disp-formula id="Equ6"><label>6</label><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ \begin{aligned} p(\mathbf{Z}_{t} &amp;\mid \mathbf{Y}_{t}, \mathbf{\Pi}_{t}, \boldsymbol{\mu}, \mathbf{\Sigma})\\ &amp;\propto p(\mathbf{Y}_{t}, \mathbf{Z}_{t}, \mathbf{\Pi}_{t}, \boldsymbol{\mu}, \mathbf{\Sigma})\\ &amp;\propto p(\mathbf{Y}_{t} \mid \mathbf{Z}_{t}, \boldsymbol{\mu}, \mathbf{\Sigma}) p(\mathbf{Z}_{t} \mid \mathbf{\Pi}_{t})\\ &amp;= \prod_{d} \prod_{n} p(\boldsymbol{y}_{t,d,n} \mid \boldsymbol{z}_{t,d,n}, \boldsymbol{\mu}, \mathbf{\Sigma})p(\boldsymbol{z}_{t,d,n} \mid \boldsymbol{\pi}_{t,d}). \end{aligned}  $$ \end{document}</tex-math><mml:math id="M30"><mml:mtable><mml:mtr><mml:mtd><mml:mi>p</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">Z</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:mo>∣</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">Y</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">Π</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">Σ</mml:mi><mml:mo>)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>∝</mml:mo><mml:mi>p</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">Y</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">Z</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">Π</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">Σ</mml:mi><mml:mo>)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>∝</mml:mo><mml:mi>p</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">Y</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>∣</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">Z</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">Σ</mml:mi><mml:mo>)</mml:mo><mml:mi>p</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">Z</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>∣</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">Π</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mo>∏</mml:mo></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:munder><mml:munder><mml:mrow><mml:mo>∏</mml:mo></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munder><mml:mi>p</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>∣</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">z</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">Σ</mml:mi><mml:mo>)</mml:mo><mml:mi>p</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">z</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>∣</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">π</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mi>.</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="12859_2019_3294_Article_Equ6.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>The logarithm of above will be:
<disp-formula id="Equ7"><label>7</label><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{@{}rcl@{}} \begin{aligned} \log\{p(&amp;\boldsymbol{y}_{t,d,n} \mid \boldsymbol{z}_{t,d,n}, \boldsymbol{\mu}, \mathbf{\Sigma})p(\boldsymbol{z}_{t,d,n} \mid \boldsymbol{\pi}_{t,d})\}\\ &amp;= \sum_{l} z_{t,d,n,l}\{-\frac{1}{2}(\boldsymbol{y}_{t,d,n} - \boldsymbol{\mu}_{l})^{\top} \mathbf{\Sigma}_{l}^{-1}(\boldsymbol{y}_{t,d,n}- \boldsymbol{\mu}_{l})\\ &amp;\quad+ \frac{1}{2} \log{\mid \mathbf{\Sigma}_{l}^{-1} \mid} + \log{\pi_{t,d,l}}\} + \text{const}. \end{aligned} \end{array} $$ \end{document}</tex-math><mml:math id="M32"><mml:mtable class="eqnarray" columnalign="left center right"><mml:mtr><mml:mtd class="eqnarray-1"><mml:mtable><mml:mtr><mml:mtd><mml:mo>log</mml:mo><mml:mo>{</mml:mo><mml:mi>p</mml:mi><mml:mo>(</mml:mo></mml:mtd><mml:mtd><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>∣</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">z</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">Σ</mml:mi><mml:mo>)</mml:mo><mml:mi>p</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">z</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>∣</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">π</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>}</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>{</mml:mo><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">μ</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>⊤</mml:mo></mml:mrow></mml:msup><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">μ</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mspace width="1em"/><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:mo>log</mml:mo><mml:mo>∣</mml:mo><mml:munderover><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:mo>∣</mml:mo><mml:mo>+</mml:mo><mml:mo>log</mml:mo><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo><mml:mo>+</mml:mo><mml:mtext>const</mml:mtext><mml:mi>.</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="12859_2019_3294_Article_Equ7.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>Therefore, <bold><italic>z</italic></bold><sub><italic>t</italic>,<italic>d</italic>,<italic>n</italic></sub> is sampled from the following categorical distribution:
<disp-formula id="Equ8"><label>8</label><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ \boldsymbol{\tilde{z}}_{t,d,n} \sim \text{Categorical}(\boldsymbol{\eta}_{t,d,n})  $$ \end{document}</tex-math><mml:math id="M34"><mml:msub><mml:mrow><mml:mstyle mathvariant="bold-italic"><mml:mover accent="true"><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mstyle></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mtext>Categorical</mml:mtext><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">η</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math><graphic xlink:href="12859_2019_3294_Article_Equ8.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>
        <disp-formula id="Equ9">
          <label>9</label>
          <alternatives>
            <tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{@{}rcl@{}} \begin{aligned} \eta_{t,d,n,l} &amp;\propto \exp\left\{-\frac{1}{2}(\boldsymbol{y}_{t,d,n} - \boldsymbol{\mu}_{l})^{\top} \mathbf{\Sigma}_{l}^{-1}(\boldsymbol{y}_{t,d,n}- \boldsymbol{\mu}_{l})\right.\\ &amp;\left.+ \frac{1}{2} \log{\mid \mathbf{\Sigma}_{l}^{-1} \mid} + \log\pi_{t,d,l}\right\}\\ &amp;\text{s.t.} \sum_{l} \eta_{t,d,n,l} = 1, \end{aligned} \end{array} $$ \end{document}</tex-math>
            <mml:math id="M36">
              <mml:mtable class="eqnarray" columnalign="left center right">
                <mml:mtr>
                  <mml:mtd class="eqnarray-1">
                    <mml:mtable>
                      <mml:mtr>
                        <mml:mtd>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>η</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>t</mml:mi>
                              <mml:mo>,</mml:mo>
                              <mml:mi>d</mml:mi>
                              <mml:mo>,</mml:mo>
                              <mml:mi>n</mml:mi>
                              <mml:mo>,</mml:mo>
                              <mml:mi>l</mml:mi>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mtd>
                        <mml:mtd>
                          <mml:mo>∝</mml:mo>
                          <mml:mo>exp</mml:mo>
                          <mml:mfenced close="" open="{" separators="">
                            <mml:mrow>
                              <mml:mo>−</mml:mo>
                              <mml:mfrac>
                                <mml:mrow>
                                  <mml:mn>1</mml:mn>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mn>2</mml:mn>
                                </mml:mrow>
                              </mml:mfrac>
                              <mml:msup>
                                <mml:mrow>
                                  <mml:mo>(</mml:mo>
                                  <mml:msub>
                                    <mml:mrow>
                                      <mml:mi mathvariant="bold-italic">y</mml:mi>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mi>t</mml:mi>
                                      <mml:mo>,</mml:mo>
                                      <mml:mi>d</mml:mi>
                                      <mml:mo>,</mml:mo>
                                      <mml:mi>n</mml:mi>
                                    </mml:mrow>
                                  </mml:msub>
                                  <mml:mo>−</mml:mo>
                                  <mml:msub>
                                    <mml:mrow>
                                      <mml:mi mathvariant="bold-italic">μ</mml:mi>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mi>l</mml:mi>
                                    </mml:mrow>
                                  </mml:msub>
                                  <mml:mo>)</mml:mo>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mo>⊤</mml:mo>
                                </mml:mrow>
                              </mml:msup>
                              <mml:msubsup>
                                <mml:mrow>
                                  <mml:mi mathvariant="bold">Σ</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mi>l</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mo>−</mml:mo>
                                  <mml:mn>1</mml:mn>
                                </mml:mrow>
                              </mml:msubsup>
                              <mml:mo>(</mml:mo>
                              <mml:msub>
                                <mml:mrow>
                                  <mml:mi mathvariant="bold-italic">y</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mi>t</mml:mi>
                                  <mml:mo>,</mml:mo>
                                  <mml:mi>d</mml:mi>
                                  <mml:mo>,</mml:mo>
                                  <mml:mi>n</mml:mi>
                                </mml:mrow>
                              </mml:msub>
                              <mml:mo>−</mml:mo>
                              <mml:msub>
                                <mml:mrow>
                                  <mml:mi mathvariant="bold-italic">μ</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mi>l</mml:mi>
                                </mml:mrow>
                              </mml:msub>
                              <mml:mo>)</mml:mo>
                            </mml:mrow>
                          </mml:mfenced>
                        </mml:mtd>
                      </mml:mtr>
                      <mml:mtr>
                        <mml:mtd>
                          <mml:mfenced close="}" open="" separators="">
                            <mml:mrow>
                              <mml:mo>+</mml:mo>
                              <mml:mfrac>
                                <mml:mrow>
                                  <mml:mn>1</mml:mn>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mn>2</mml:mn>
                                </mml:mrow>
                              </mml:mfrac>
                              <mml:mo>log</mml:mo>
                              <mml:mo>∣</mml:mo>
                              <mml:munderover>
                                <mml:mrow>
                                  <mml:mi mathvariant="bold">Σ</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mi>l</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mo>−</mml:mo>
                                  <mml:mn>1</mml:mn>
                                </mml:mrow>
                              </mml:munderover>
                              <mml:mo>∣</mml:mo>
                              <mml:mo>+</mml:mo>
                              <mml:mo>log</mml:mo>
                              <mml:msub>
                                <mml:mrow>
                                  <mml:mi>π</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mi>t</mml:mi>
                                  <mml:mo>,</mml:mo>
                                  <mml:mi>d</mml:mi>
                                  <mml:mo>,</mml:mo>
                                  <mml:mi>l</mml:mi>
                                </mml:mrow>
                              </mml:msub>
                            </mml:mrow>
                          </mml:mfenced>
                        </mml:mtd>
                      </mml:mtr>
                      <mml:mtr>
                        <mml:mtd>
                          <mml:mtext>s.t.</mml:mtext>
                          <mml:munder>
                            <mml:mrow>
                              <mml:mo>∑</mml:mo>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>l</mml:mi>
                            </mml:mrow>
                          </mml:munder>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>η</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>t</mml:mi>
                              <mml:mo>,</mml:mo>
                              <mml:mi>d</mml:mi>
                              <mml:mo>,</mml:mo>
                              <mml:mi>n</mml:mi>
                              <mml:mo>,</mml:mo>
                              <mml:mi>l</mml:mi>
                            </mml:mrow>
                          </mml:msub>
                          <mml:mo>=</mml:mo>
                          <mml:mn>1</mml:mn>
                          <mml:mo>,</mml:mo>
                        </mml:mtd>
                      </mml:mtr>
                    </mml:mtable>
                  </mml:mtd>
                </mml:mtr>
              </mml:mtable>
            </mml:math>
            <graphic xlink:href="12859_2019_3294_Article_Equ9.gif" position="anchor"/>
          </alternatives>
        </disp-formula>
      </p>
      <p>where <inline-formula id="IEq10"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\boldsymbol {\eta }_{t,d,n}=\{\eta _{t,d,n,l}\}_{l=1}^{L}$\end{document}</tex-math><mml:math id="M38"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">η</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mi>η</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2019_3294_Article_IEq10.gif"/></alternatives></inline-formula>. Suppose we have the mean of the previous mixture proportion <inline-formula id="IEq11"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat {\boldsymbol {\pi }}_{t-1,d}$\end{document}</tex-math><mml:math id="M40"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">π</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>d</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2019_3294_Article_IEq11.gif"/></alternatives></inline-formula>. The persistency parameter <italic>α</italic><sub><italic>t</italic>,<italic>d</italic></sub> is estimated by fixed point iteration.
<disp-formula id="Equ10"><label>10</label><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ \hat{\alpha}_{t,d} \leftarrow \hat{\alpha}_{t,d} \frac{\sum_{l} \hat{\pi}_{t-1,d,l} A_{t,d,l}}{\psi(N_{t,d} + \hat{\alpha}_{t,d}) - \psi(\hat{\alpha}_{t,d})},  $$ \end{document}</tex-math><mml:math id="M42"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mo>←</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mfrac><mml:mrow><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>d</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>ψ</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>−</mml:mo><mml:mi>ψ</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:math><graphic xlink:href="12859_2019_3294_Article_Equ10.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>where <inline-formula id="IEq12"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$A_{t,d,l} = \psi (N_{t,d,l} + \hat {\alpha }_{t,d} \hat {\pi }_{t-1,d,l}) - \psi (\hat {\alpha }_{t,d} \hat {\pi }_{t-1,d,l})$\end{document}</tex-math><mml:math id="M44"><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>ψ</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>d</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>−</mml:mo><mml:mi>ψ</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>d</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2019_3294_Article_IEq12.gif"/></alternatives></inline-formula>, <italic>ψ</italic>(·) is the digamma function <inline-formula id="IEq13"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\psi (x) = \frac {\partial \log {\Gamma (x)}}{\partial x}$\end{document}</tex-math><mml:math id="M46"><mml:mi>ψ</mml:mi><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mo>log</mml:mo><mml:mi>Γ</mml:mi><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>∂x</mml:mi></mml:mrow></mml:mfrac></mml:math><inline-graphic xlink:href="12859_2019_3294_Article_IEq13.gif"/></alternatives></inline-formula>, where <italic>Γ</italic>(·) is the gamma function, and <italic>N</italic><sub><italic>t</italic>,<italic>d</italic>,<italic>l</italic></sub> is the number of cells assigned to cluster <italic>l</italic> at time <italic>t</italic> for case <italic>d</italic>. The mean of <italic>π</italic><sub><italic>t</italic>,<italic>d</italic>,<italic>l</italic></sub> is then calculated as follows:
<disp-formula id="Equ11"><label>11</label><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ \hat{\pi}_{t,d,l} = \frac{N_{t,d,l} + \hat{\alpha}_{t,d}\hat{\pi}_{t-1,d,l}}{N_{t,d} + \hat{\alpha}_{t,d}}.  $$ \end{document}</tex-math><mml:math id="M48"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>d</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mi>.</mml:mi></mml:math><graphic xlink:href="12859_2019_3294_Article_Equ11.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>We substitute the E-step of the EM algorithm by Gibbs sampling, then <bold><italic>μ</italic></bold> and <bold>Σ</bold> are updated in the M-step as follows:
<disp-formula id="Equ12"><label>12</label><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ \hat{\boldsymbol{\mu}}_{l} = \frac{\sum_{n} \boldsymbol{y}_{n,l}}{N_{l} + \tau}  $$ \end{document}</tex-math><mml:math id="M50"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">μ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>τ</mml:mi></mml:mrow></mml:mfrac></mml:math><graphic xlink:href="12859_2019_3294_Article_Equ12.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>
        <disp-formula id="Equ13">
          <label>13</label>
          <alternatives>
            <tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ \begin{aligned} &amp;\hat{\mathbf{\Sigma}}_{l} = \frac{\mathbf{\Lambda} + \sum_{n} (\boldsymbol{y}_{n,l}-\hat{\boldsymbol{\mu}}_{l})^{\top}(\boldsymbol{y}_{n,l}-\hat{\boldsymbol{\mu}}_{l}) + \tau\hat{\boldsymbol{\mu}}_{l}^{\top}\hat{\boldsymbol{\mu}}_{l}}{N_{l} + \nu - K - 1}, \end{aligned}  $$ \end{document}</tex-math>
            <mml:math id="M52">
              <mml:mtable>
                <mml:mtr>
                  <mml:mtd>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mover accent="true">
                          <mml:mrow>
                            <mml:mi mathvariant="bold">Σ</mml:mi>
                          </mml:mrow>
                          <mml:mo>^</mml:mo>
                        </mml:mover>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>l</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo>=</mml:mo>
                    <mml:mfrac>
                      <mml:mrow>
                        <mml:mi mathvariant="bold">Λ</mml:mi>
                        <mml:mo>+</mml:mo>
                        <mml:munder>
                          <mml:mrow>
                            <mml:mo>∑</mml:mo>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>n</mml:mi>
                          </mml:mrow>
                        </mml:munder>
                        <mml:msup>
                          <mml:mrow>
                            <mml:mo>(</mml:mo>
                            <mml:msub>
                              <mml:mrow>
                                <mml:mi mathvariant="bold-italic">y</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mi>n</mml:mi>
                                <mml:mo>,</mml:mo>
                                <mml:mi>l</mml:mi>
                              </mml:mrow>
                            </mml:msub>
                            <mml:mo>−</mml:mo>
                            <mml:msub>
                              <mml:mrow>
                                <mml:mover accent="true">
                                  <mml:mrow>
                                    <mml:mi mathvariant="bold-italic">μ</mml:mi>
                                  </mml:mrow>
                                  <mml:mo>^</mml:mo>
                                </mml:mover>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mi>l</mml:mi>
                              </mml:mrow>
                            </mml:msub>
                            <mml:mo>)</mml:mo>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mo>⊤</mml:mo>
                          </mml:mrow>
                        </mml:msup>
                        <mml:mo>(</mml:mo>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi mathvariant="bold-italic">y</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>n</mml:mi>
                            <mml:mo>,</mml:mo>
                            <mml:mi>l</mml:mi>
                          </mml:mrow>
                        </mml:msub>
                        <mml:mo>−</mml:mo>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mover accent="true">
                              <mml:mrow>
                                <mml:mi mathvariant="bold-italic">μ</mml:mi>
                              </mml:mrow>
                              <mml:mo>^</mml:mo>
                            </mml:mover>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>l</mml:mi>
                          </mml:mrow>
                        </mml:msub>
                        <mml:mo>)</mml:mo>
                        <mml:mo>+</mml:mo>
                        <mml:mi>τ</mml:mi>
                        <mml:msubsup>
                          <mml:mrow>
                            <mml:mover accent="true">
                              <mml:mrow>
                                <mml:mi mathvariant="bold-italic">μ</mml:mi>
                              </mml:mrow>
                              <mml:mo>^</mml:mo>
                            </mml:mover>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>l</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mo>⊤</mml:mo>
                          </mml:mrow>
                        </mml:msubsup>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mover accent="true">
                              <mml:mrow>
                                <mml:mi mathvariant="bold-italic">μ</mml:mi>
                              </mml:mrow>
                              <mml:mo>^</mml:mo>
                            </mml:mover>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>l</mml:mi>
                          </mml:mrow>
                        </mml:msub>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>N</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>l</mml:mi>
                          </mml:mrow>
                        </mml:msub>
                        <mml:mo>+</mml:mo>
                        <mml:mi>ν</mml:mi>
                        <mml:mo>−</mml:mo>
                        <mml:mi>K</mml:mi>
                        <mml:mo>−</mml:mo>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                    </mml:mfrac>
                    <mml:mo>,</mml:mo>
                  </mml:mtd>
                </mml:mtr>
              </mml:mtable>
            </mml:math>
            <graphic xlink:href="12859_2019_3294_Article_Equ13.gif" position="anchor"/>
          </alternatives>
        </disp-formula>
      </p>
      <p>where <bold><italic>y</italic></bold><sub><italic>n</italic>,<italic>l</italic></sub> is the <italic>n</italic>-th cell assigned to cluster <italic>l</italic>, and <italic>N</italic><sub><italic>l</italic></sub> is the number of cells assigned to cluster <italic>l</italic>.</p>
    </sec>
  </sec>
  <sec id="Sec5">
    <title>Result</title>
    <sec id="Sec6">
      <title>Simulation study</title>
      <p>We conducted a simulation experiment to examine the performance of CYBERTRACK. We set <italic>K</italic>=10, <italic>T</italic>=5, and <italic>D</italic>=2. The <bold><italic>μ</italic></bold> and <bold>Σ</bold> was randomly generated. <bold><italic>π</italic></bold> were set manually so that change-points for mixture proportions exist at <italic>t</italic>=3,5 for case 1 and <italic>t</italic>=2,4 for case 2. For the hyperparameters, we set <italic>τ</italic>=10<sup>−5</sup> and <italic>ν</italic>=<italic>K</italic>+2, and <bold>Λ</bold> was set to an identity matrix, which is equivalent to giving weakly informative priors. With this parameter setting, we randomly generated 1000 synthetic data for each timepoint in each case (10,000 samples in total). The simulation was repeated 200 times, and different data was synthesized each time. Synthetic data was analyzed by CYBERTRACK along with ordinal Gaussian mixture model (GMM) using R package “mclust” as a baseline method.</p>
      <p>Likelihood based criterion such as AIC or BIC tend to favor the number of clusters much larger than known distinct cell populations, making it difficult to interpret the result for flow cytometry users [<xref ref-type="bibr" rid="CR10">10</xref>, <xref ref-type="bibr" rid="CR11">11</xref>]. Also, since cell populations are known to form near-continuous phenotypes, fully automated determination of the number of cluster is often not very meaningful because users’ cluster of interest may not be captured at that number. Instead, it is more important for users to explore some candidate cluster numbers that suits their purpose of the analysis. Therefore, we used the elbow method as partially automated, user-interactive determination method of the number of clusters. This method involves plotting the sum of squared error (SSE) within each cluster against the number of clusters. At the number of clusters with good partitioning, drop in SSE saturates, showing an elbow-like look (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S1). It is usual to find several ”elbows” in real world data, and we recommend users to try some candidate number of clusters and see whether cell populations of interest are detected.</p>
      <p>The mean and standard deviation (sd) for the estimated <inline-formula id="IEq14"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat {\boldsymbol {\mu }}$\end{document}</tex-math><mml:math id="M54"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">μ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="12859_2019_3294_Article_IEq14.gif"/></alternatives></inline-formula> and <inline-formula id="IEq15"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat {\mathbf {\Sigma }}$\end{document}</tex-math><mml:math id="M56"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="12859_2019_3294_Article_IEq15.gif"/></alternatives></inline-formula> are shown in Fig. <xref rid="Fig3" ref-type="fig">3</xref>. <inline-formula id="IEq16"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat {\boldsymbol {\pi }}$\end{document}</tex-math><mml:math id="M58"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">π</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="12859_2019_3294_Article_IEq16.gif"/></alternatives></inline-formula> estimated by CYBERTRACK and GMM are shown in Fig. <xref rid="Fig4" ref-type="fig">4</xref>. These results show that the parameters for time-series multivariate Gaussian mixture distribution were reasonably estimated by the stochastic EM algorithm, and that CYBERTRACK successfully tracked the time-dependent transition of the mixture proportion in multiple cases with better precision compared to ordinal GMM (Fig. <xref rid="Fig4" ref-type="fig">4</xref>b). An important difference from the existing method is that CYBERTRACK can detect change-point by estimating <inline-formula id="IEq17"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat {\alpha }$\end{document}</tex-math><mml:math id="M60"><mml:mover accent="true"><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="12859_2019_3294_Article_IEq17.gif"/></alternatives></inline-formula>. As shown in Fig. <xref rid="Fig5" ref-type="fig">5</xref>, <inline-formula id="IEq18"><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat {\alpha }$\end{document}</tex-math><mml:math id="M62"><mml:mover accent="true"><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="12859_2019_3294_Article_IEq18.gif"/></alternatives></inline-formula> holds small values at <italic>t</italic>=3,5 for case 1 and <italic>t</italic>=2,4 for case 2, correctly indicating the dramatic transition of the mixture proportion at that timepoint.
<fig id="Fig3"><label>Fig. 3</label><caption><p>Simulation result for <inline-formula id="IEq19"><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat {\boldsymbol {\mu }}$\end{document}</tex-math><mml:math id="M64"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">μ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="12859_2019_3294_Article_IEq19.gif"/></alternatives></inline-formula> and <inline-formula id="IEq20"><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat {\boldsymbol {\Sigma }}$\end{document}</tex-math><mml:math id="M66"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">Σ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="12859_2019_3294_Article_IEq20.gif"/></alternatives></inline-formula> estimation. <bold>a</bold>, Estimated <inline-formula id="IEq21"><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat {\boldsymbol {\mu }}$\end{document}</tex-math><mml:math id="M68"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">μ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="12859_2019_3294_Article_IEq21.gif"/></alternatives></inline-formula> were plotted against true <bold><italic>μ</italic></bold>. Each dot represents elements of <inline-formula id="IEq22"><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat {\boldsymbol {\mu }}$\end{document}</tex-math><mml:math id="M70"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">μ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="12859_2019_3294_Article_IEq22.gif"/></alternatives></inline-formula> and was color-coded by cluster. <bold>b</bold>, Estimated <inline-formula id="IEq23"><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat {\boldsymbol {\Sigma }}$\end{document}</tex-math><mml:math id="M72"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">Σ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="12859_2019_3294_Article_IEq23.gif"/></alternatives></inline-formula> values were plotted against true <bold><italic>Σ</italic></bold>. Each dot represents a element of <inline-formula id="IEq24"><alternatives><tex-math id="M73">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat {\boldsymbol {\Sigma }}$\end{document}</tex-math><mml:math id="M74"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">Σ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="12859_2019_3294_Article_IEq24.gif"/></alternatives></inline-formula> and was color-coded by cluster; green, orange, and blue represents cluster 1, 2, and 3, respectively. Error bars represent standard deviation</p></caption><graphic xlink:href="12859_2019_3294_Fig3_HTML" id="MO3"/></fig>
<fig id="Fig4"><label>Fig. 4</label><caption><p>Simulation result for <inline-formula id="IEq25"><alternatives><tex-math id="M75">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat {\boldsymbol {\pi }}$\end{document}</tex-math><mml:math id="M76"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">π</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="12859_2019_3294_Article_IEq25.gif"/></alternatives></inline-formula> estimation. <bold>a</bold>, Estimated <inline-formula id="IEq26"><alternatives><tex-math id="M77">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat {\boldsymbol {\pi }}$\end{document}</tex-math><mml:math id="M78"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">π</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="12859_2019_3294_Article_IEq26.gif"/></alternatives></inline-formula> for simulation data. Black and red lines represent the proportion mixture for case 1 and 2, respectively. Solid lines indicate the true mixture proportion and dashed lines indicate estimated proportion by CYBERTRACK and GMM. Error bars with flat bars and arrows represents CYBERTRACK and GMM, respectively. Error bars represent standard deviation. <bold>b</bold>, SSE was calculated for each repeat of simulation. SSE is smaller in CYBERTRACK, which indicates that it gave more precise estimation result on time-series mixture proportions compared to GMM. p = 0.0387, two-sided Student’s t-test</p></caption><graphic xlink:href="12859_2019_3294_Fig4_HTML" id="MO4"/></fig>
<fig id="Fig5"><label>Fig. 5</label><caption><p>Simulation result for <inline-formula id="IEq27"><alternatives><tex-math id="M79">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat {\boldsymbol {\alpha }}$\end{document}</tex-math><mml:math id="M80"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">α</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="12859_2019_3294_Article_IEq27.gif"/></alternatives></inline-formula> estimation. Black and red lines represent proportion mixtures for cases 1 and 2, respectively. Timepoints where the alpha values decrease substantially indicate change-points in the overall mixture proportion. Error bars represent standard deviation</p></caption><graphic xlink:href="12859_2019_3294_Fig5_HTML" id="MO5"/></fig></p>
    </sec>
    <sec id="Sec7">
      <title>Results for real data</title>
      <p>To validate the CYBERTRACK performance for cell clustering and tracking mixture proportions of cell populations, we applied CYBERTRACK to real world flow cytometry data uploaded to Cytobank (<ext-link ext-link-type="uri" xlink:href="https://www.cytobank.org/">https://www.cytobank.org/</ext-link>). In Landrigan’s study (<ext-link ext-link-type="uri" xlink:href="https://community.cytobank.org/cytobank/experiments/35226">https://community.cytobank.org/cytobank/experiments/35226</ext-link>), naive CD4+ T cells were purified and stimulated using anti-CD3 and anti-CD28 antibodies. Five cases were tested: unstimulated, stimulated by only anti-CD3 antibody, and stimulated by both anti-CD3 and anti-CD28 antibodies, with two dosages tested for the anti-CD3 antibody (0.3 <italic>μ</italic>g/mL and 0.8 <italic>μ</italic>g/mL). It is known that the stimulation of CD3 triggers the activation of naive CD4+ T cells, which accompanies the phosphorylation of SLP76/S6 and CD247 (pSLP76/pS6, pCD246) [<xref ref-type="bibr" rid="CR12">12</xref>]. CD28 is the co-stimulatory factor that enhances and prolongs T cell activation [<xref ref-type="bibr" rid="CR13">13</xref>]. Soon after activation, the levels of pSLP/pS6 and pCD247 decrease owing to negative feedback. Consequently, the cells become CD45RO+ memory T cells.</p>
      <p>For Landrigan’s study, the number of clusters was determined as 16 by using the elbow method (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S2a). Histgrams of marker intensities for clusters identified by CYBERTRACK show that multivariate Gaussian distribution well approximates flowcytometry data (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S3). Fig. <xref rid="Fig6" ref-type="fig">6</xref>a shows the heatmap generated from the estimated <inline-formula id="IEq28"><alternatives><tex-math id="M81">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat {\boldsymbol {\mu }}$\end{document}</tex-math><mml:math id="M82"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">μ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="12859_2019_3294_Article_IEq28.gif"/></alternatives></inline-formula>; clusters 1, 7, 8, 9, 12, and 16 are the pSLP76/pS6+ pCD247+ activated naive T cells, and clusters 2, 4, 6, and 13 are pSLP76/pS6- pCD247- CD45RO+ memory T cells. The time-dependent transition of the mixture proportion is shown in Fig. <xref rid="Fig6" ref-type="fig">6</xref>b. While the mixture proportion remains stable over time in unstimulated cases, other cases show dynamic fluctuation, as expected. In stimulated cases, a high proportion of activated naive T cells (specifically, cluster 16 and 7 for dosages 0.3 and 0.8 <italic>μ</italic>g/mL, respectively) was observed at <italic>t</italic>=3 min. Their proportions decreased through <italic>t</italic>=6,10 min by the T cell’s negative feedback mechanism. Figure <xref rid="Fig6" ref-type="fig">6</xref>b shows that as the number of activated T cells decreases, the memory T cell populations increase, indicating the transformation of naive T cells into memory T cells. This behavior was well represented by <inline-formula id="IEq29"><alternatives><tex-math id="M83">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat {\alpha }$\end{document}</tex-math><mml:math id="M84"><mml:mover accent="true"><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="12859_2019_3294_Article_IEq29.gif"/></alternatives></inline-formula> estimates, shown in Fig. <xref rid="Fig6" ref-type="fig">6</xref>c; the <inline-formula id="IEq30"><alternatives><tex-math id="M85">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat {\alpha }$\end{document}</tex-math><mml:math id="M86"><mml:mover accent="true"><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="12859_2019_3294_Article_IEq30.gif"/></alternatives></inline-formula> for stimulated cases shows small values at <italic>t</italic>=6 and <italic>t</italic>=10 min compared with that of unstimulated cases, indicating dynamic changes in cell population constitution at those timepoints. Interestingly, in cases stimulated with both anti-CD3 and anti-CD28 antibodies, a prominent increase of clusters with moderate levels of pSLP76/pS6 and pCD247 (cluster 14 and 1 for dosages 0.3 <italic>μ</italic>g/mL and 0.8 <italic>μ</italic>g/mL, respectively) was observed at <italic>t</italic>=6. These clusters can be interpreted as cell populations that are transitioning from a highly activated state to an inactivated memory state. This is consistent with the well-known prolonged T cell activation by stimulation of CD28, thus further indicating that CYBERTRACK is capable of illustrating dynamic biological processes from time-series flow cytometry data [<xref ref-type="bibr" rid="CR13">13</xref>].
<fig id="Fig6"><label>Fig. 6</label><caption><p>Result for CYBERTRACK analysis on Landrigan’s study. <bold>a</bold>, Heatmap for Landrigan’s study. Cluster number is shown on the <italic>x</italic> axis and markers are shown on the <italic>y</italic> axis. <bold>b</bold>, Mixture proportions for five cases were drawn in different graphs. Each colored line represents the mixture proportion for a different cluster. <italic>t</italic> is on the <italic>x</italic> axis and the mixture proportion is on the <italic>y</italic> axis. <bold>c</bold>, Estimated <inline-formula id="IEq31"><alternatives><tex-math id="M87">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat {\alpha }$\end{document}</tex-math><mml:math id="M88"><mml:mover accent="true"><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="12859_2019_3294_Article_IEq31.gif"/></alternatives></inline-formula> for Landrigan’s study</p></caption><graphic xlink:href="12859_2019_3294_Fig6_HTML" id="MO6"/></fig></p>
      <p>We also applied CYBERTRACK to the data in Huang’s study (<ext-link ext-link-type="uri" xlink:href="https://community.cytobank.org/cytobank/experiments/5002">https://community.cytobank.org/cytobank/experiments/5002</ext-link>), where cells were collected from mice whose lymph nodes were stimulated with either interleukin 7 (IL7) or interferon alpha (IFN <italic>α</italic>). It is known that IL7 and IFN <italic>α</italic> interact with their receptors on the lyphocytes’ surface and activate lymphocytes through the phosphorylation of STAT family proteins (e.g., pSTAT1 and pSTAT5), which promotes the transcription of immune-related genes [<xref ref-type="bibr" rid="CR14">14</xref>, <xref ref-type="bibr" rid="CR15">15</xref>].</p>
      <p>The number of clusters was determined as 26 by using the elbow method (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S2b), and the heatmap is shown in Fig. <xref rid="Fig7" ref-type="fig">7</xref>a. In Huang’s study, T cells were identified by CD4 and/or TCR <italic>β</italic>, and B cells were identified by B220. As shown in the heatmap, CYBERTRACK clustered cells into canonical cell types, which include CD4+ TCR <italic>β</italic>+ T cells (clusters 4, 6, 9, 10, 17, and 26), CD4- TCR <italic>β</italic>+ T cells (clusters 2, 3, 15, 24), and B220+ B cells (clusters 1, 3, 5, and 21). Clusters with extremely high levels of both B220 and TCR <italic>β</italic> are thought to be debris; therefore, they were excluded from further interpretation. Figure <xref rid="Fig7" ref-type="fig">7</xref>b shows the time-dependent transition of the mixture proportion for each cell population. CYBERTRACK detected cell populations that increased over time in both cases. These cell populations include pSTAT1+ pSTAT5+ T cell (cluster 3) and pSTAT1+ B cell (cluster 5), which are typical cell populations that are known to emerge upon IL7 and IFN <italic>α</italic> stimulation. Furthermore, CYBERTRACK also illustrated cell population dynamics that differed in two cases; pSTAT5+ T cells (clusters 9 and 24) increased only when stimulated by IL7, whereas pSTAT1+ T cells (clusters 6 and 15) increased only in the IFN <italic>α</italic>-stimulated case. Although IL7 and IFN <italic>α</italic> are known to induce the phosphorylation of a variety of STAT family proteins, the result shown here may reflect the preferential upregulation of STAT5 and STAT1 by IL7 and IFN <italic>α</italic>, respectively [<xref ref-type="bibr" rid="CR16">16</xref>, <xref ref-type="bibr" rid="CR17">17</xref>]. The estimated <inline-formula id="IEq32"><alternatives><tex-math id="M89">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat {\alpha }$\end{document}</tex-math><mml:math id="M90"><mml:mover accent="true"><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="12859_2019_3294_Article_IEq32.gif"/></alternatives></inline-formula> shows that the change-points are located at <italic>t</italic>=2,4 min for IL7 stimulation and <italic>t</italic>=2 min for IFN <italic>α</italic> stimulation (Fig. <xref rid="Fig7" ref-type="fig">7</xref>c). Furthermore, analysis by CYBERTRACK revealed that stimulation by IL7 induces more dramatic changes in cell population constitution at an early stage (until <italic>t</italic>=4 min), as indicated by the small <inline-formula id="IEq33"><alternatives><tex-math id="M91">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat {\alpha }$\end{document}</tex-math><mml:math id="M92"><mml:mover accent="true"><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="12859_2019_3294_Article_IEq33.gif"/></alternatives></inline-formula> values.
<fig id="Fig7"><label>Fig. 7</label><caption><p>Result for CYBERTRACK analysis on Huang’s study. <bold>a</bold>, Heatmap for Landrigan’s study. Cluster number is shown on the <italic>x</italic> axis and markers are shown on the <italic>y</italic> axis. <bold>b</bold>, Mixture proportions for 26 clusters were drawn in different graphs. Black and red lines represent IL7 stimulation and IFN <italic>α</italic> stimulation, respectively. <italic>t</italic> is on the <italic>x</italic> axis and the mixture proportion is on the <italic>y</italic> axis. <bold>c</bold>, Estimated <inline-formula id="IEq34"><alternatives><tex-math id="M93">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat {\alpha }$\end{document}</tex-math><mml:math id="M94"><mml:mover accent="true"><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="12859_2019_3294_Article_IEq34.gif"/></alternatives></inline-formula> for Huang’s study. Black and red lines represent IL7 stimulation and IFN <italic>α</italic> stimulation, respectively</p></caption><graphic xlink:href="12859_2019_3294_Fig7_HTML" id="MO7"/></fig></p>
    </sec>
  </sec>
  <sec id="Sec8" sec-type="discussion">
    <title>Discussion</title>
    <p>The application of CYBERTRACK to simulation and real flow cytometry data has validated its performance for cell clustering and tracking mixture proportions in multiple cases. The results of CYBERTRACK analysis using two immunological experiments were consistent with our prior knowledge, which validates CYBERTRACK’s ability to analyze time-series flow cytometry data. We believe that CYBERTRACK will be a powerful tool in various fields involving the investigation of cell population dynamics. For instance, in the field of cancer immunotherapy, the longitudinal immune monitoring of patients has become increasingly important as it provides information on the impact of therapeutic treatment on certain cell populations, or in finding cell populations that can be used as prognostic markers. Furthermore, CYBERTRACK will also be useful in basic research as it can give insights into flow cytometry time-series data in an unbiased manner. Because CYBERTRACK is capable of clustering cells from different cases, it is easy for researchers to compare population dynamics in experiments with a control and several cases.</p>
    <p>Recently, a tool called mass cytometry was introduced to the field of biomedical research. Mass spectrometry-based detection of marker genes by mass cytometry has enabled the investigation of more than 40 markers simultaneously, providing much more informative data with higher-dimensions compared with fluorescence-based conventional flow cytometry. Recent research trends in single-cell biology highly depend on mass cytometry, and it has contributed to many important discoveries [<xref ref-type="bibr" rid="CR18">18</xref>]. One limitation of CYBERTRACK is that it is inapplicable to mass cytometry data, because the data generated by mass cytometry do not follow a multivariate Gaussian distribution. Our future aim is to extend CYBERTRACK for application to time-series mass cytometry data.</p>
  </sec>
  <sec id="Sec9" sec-type="conclusion">
    <title>Conclusion</title>
    <p>Here, we propose a model-based cell clustering and population-tracking algorithm called CYBERTRACK. The aim of CYBERTRACK is to discover the underlying dynamics of cell populations in time-series flow cytometry data. Our model is inspired by the Topic Tracking Model [<xref ref-type="bibr" rid="CR9">9</xref>], and we modified it for the parameter estimation of a multivariate Gaussian mixture distribution. CYBERTRACK is capable of (<italic>i</italic>) cell clustering, (<italic>i</italic><italic>i</italic>) tracking the mixture proportion of each cell population, and (<italic>i</italic><italic>i</italic><italic>i</italic>) detecting the change-point in the overall mixture proportion.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary information</title>
    <sec id="Sec10">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="12859_2019_3294_MOESM1_ESM.docx">
            <caption>
              <p><bold>Additional file 1</bold> Supplementary Figures.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>AIC</term>
        <def>
          <p>Akaike’s information criterion</p>
        </def>
      </def-item>
      <def-item>
        <term>BIC</term>
        <def>
          <p>Bayesian information criterion</p>
        </def>
      </def-item>
      <def-item>
        <term>EM</term>
        <def>
          <p>Expectation-maximization</p>
        </def>
      </def-item>
      <def-item>
        <term>GMM</term>
        <def>
          <p>Gaussian mixture model</p>
        </def>
      </def-item>
      <def-item>
        <term>MAP</term>
        <def>
          <p>Maximum a posteriori</p>
        </def>
      </def-item>
      <def-item>
        <term>SSE</term>
        <def>
          <p>Sum of squared error</p>
        </def>
      </def-item>
      <def-item>
        <term>sd</term>
        <def>
          <p>Standard deviation</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher’s Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
    <fn>
      <p>Kodai Minoura and Ko Abe contributed equally to this work.</p>
    </fn>
  </fn-group>
  <sec>
    <title>Supplementary information</title>
    <p><bold>Supplementary information</bold> accompanies this paper at 10.1186/s12859-019-3294-3.</p>
  </sec>
  <ack>
    <title>Acknowledgements</title>
    <p>Not applicable.</p>
    <sec id="d29e3773">
      <title>About this supplement</title>
      <p>This article has been published as part of <italic>BMC Bioinformatics Volume 20 Supplement 23, 2019: Proceedings of the Joint International GIW &amp; ABACBS-2019 Conference: bioinformatics</italic>. The full contents of the supplement are available online at <ext-link ext-link-type="uri" xlink:href="https://bmcbioinformatics.biomedcentral.com/articles/supplements/volume-20-supplement-23">https://bmcbioinformatics.biomedcentral.com/articles/supplements/volume-20-supplement-23</ext-link>.</p>
    </sec>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>KM, KA, TS designed the proposed algorithm. All authors reviewed and approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>This research was supported by JSPS Grant-in-Aid for Scientific Research on Innovative Areas Grant Numbers 15H05912, 18H04798, and 19H05210. It was also supported by the Japan Agency for Medical Research and Development (AMED) under the Strategic Research Program for Brain Sciences [No. JP18dm0107087], and the Japan Agency for Medical Research and Development (AMED) under Practical Research Project for Rare / Intractable Diseases [No. JP17ek0109281]. The super-computing resources were provided by Human Genome Center, University of Tokyo. Publication costs are funded by all of the funding.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>Our software is available from GitHub (<ext-link ext-link-type="uri" xlink:href="https://github.com/kodaim1115/CYBERTRACK">https://github.com/kodaim1115/CYBERTRACK</ext-link>). Data for the immunological experiments used in this paper are available from Cytobank (<ext-link ext-link-type="uri" xlink:href="https://cytobank.org/">https://cytobank.org/</ext-link>).</p>
  </notes>
  <notes>
    <title>Consent for publication</title>
    <p>Not applicable.</p>
  </notes>
  <notes notes-type="COI-statement">
    <title>Competing interests</title>
    <p>The authors declare that they have no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Maeda</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Nishikawa</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Sugiyama</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Ha</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Hamaguchi</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Saito</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Sakaguchi</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Detection of self-reactive CD8+ T cells with an anergic phenotype in healthy individuals</article-title>
        <source>Science</source>
        <year>2014</year>
        <volume>346</volume>
        <issue>6216</issue>
        <fpage>1536</fpage>
        <lpage>40</lpage>
        <pub-id pub-id-type="doi">10.1126/science.aaa1292</pub-id>
        <pub-id pub-id-type="pmid">25525252</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Saito</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Nishikawa</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Wada</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Nagano</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Sugiyama</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Atarashi</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Nagase</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Two FOXP3+ CD4+ T cell subpopulations distinctly control the prognosis of colorectal cancers</article-title>
        <source>Nat Med</source>
        <year>2016</year>
        <volume>22</volume>
        <issue>6</issue>
        <fpage>679</fpage>
        <pub-id pub-id-type="doi">10.1038/nm.4086</pub-id>
        <pub-id pub-id-type="pmid">27111280</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tober</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Maijenburg</surname>
            <given-names>MM</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Gao</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Hadland</surname>
            <given-names>BK</given-names>
          </name>
          <name>
            <surname>Gao</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Speck</surname>
            <given-names>NA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Maturation of hematopoietic stem cells from prehematopoietic stem cells is accompanied by up-regulation of PD-L1</article-title>
        <source>J Exp Med</source>
        <year>2018</year>
        <volume>215</volume>
        <issue>2</issue>
        <fpage>645</fpage>
        <lpage>59</lpage>
        <pub-id pub-id-type="doi">10.1084/jem.20161594</pub-id>
        <pub-id pub-id-type="pmid">29282253</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Finak</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Frelinger</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Jiang</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Newell</surname>
            <given-names>EW</given-names>
          </name>
          <name>
            <surname>Ramey</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Davis</surname>
            <given-names>MM</given-names>
          </name>
          <name>
            <surname>Gottardo</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>OpenCyto: an open source infrastructure for scalable, robust, reproducible, and automated, end-to-end flow cytometry data analysis</article-title>
        <source>PLoS Comput Biol</source>
        <year>2014</year>
        <volume>10</volume>
        <issue>8</issue>
        <fpage>e1003806</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1003806</pub-id>
        <pub-id pub-id-type="pmid">25167361</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Finak</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Langweiler</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Jaimes</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Malek</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Taghiyar</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Korin</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Pontikos</surname>
            <given-names>N</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Standardizing flow cytometry immunophenotyping analysis from the Human ImmunoPhenotyping Consortium</article-title>
        <source>Sci Rep</source>
        <year>2016</year>
        <volume>6</volume>
        <fpage>20686</fpage>
        <pub-id pub-id-type="doi">10.1038/srep20686</pub-id>
        <pub-id pub-id-type="pmid">26861911</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Saeys</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Van Gassen</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Lambrecht</surname>
            <given-names>BN</given-names>
          </name>
        </person-group>
        <article-title>Computational flow cytometry: helping to make sense of high-dimensional immunology data</article-title>
        <source>Nat Rev Immunol</source>
        <year>2016</year>
        <volume>16</volume>
        <issue>7</issue>
        <fpage>449</fpage>
        <pub-id pub-id-type="doi">10.1038/nri.2016.56</pub-id>
        <pub-id pub-id-type="pmid">27320317</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Weber</surname>
            <given-names>LM</given-names>
          </name>
          <name>
            <surname>Robinson</surname>
            <given-names>MD</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Comparison of clustering methods for high-dimensional single-cell flow and mass cytometry data</article-title>
        <source>Cytom Part A</source>
        <year>2016</year>
        <volume>89</volume>
        <issue>12</issue>
        <fpage>1084</fpage>
        <lpage>96</lpage>
        <pub-id pub-id-type="doi">10.1002/cyto.a.23030</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kurose</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Ohue</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Wada</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Iida</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Ishida</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Kojima</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Kakimi</surname>
            <given-names>K</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Phase Ia study of FoxP3+ CD4 Treg depletion by infusion of a humanized anti-CCR4 antibody, KW-0761, in cancer patients</article-title>
        <source>Clin Cancer Res</source>
        <year>2015</year>
        <volume>21</volume>
        <issue>19</issue>
        <fpage>4327</fpage>
        <lpage>36</lpage>
        <pub-id pub-id-type="doi">10.1158/1078-0432.CCR-15-0357</pub-id>
        <pub-id pub-id-type="pmid">26429981</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9</label>
      <mixed-citation publication-type="other">Iwata T, Watanabe S, Yamada T, Ueda N. Topic tracking model for analyzing consumer purchase behavior. In: Proceedings of International Joint Conference on Artificial Intelligence, IJCAI: 2009. p. 1427–32.</mixed-citation>
    </ref>
    <ref id="CR10">
      <label>10</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Finak</surname>
            <given-names>Greg</given-names>
          </name>
          <name>
            <surname>Bashashati</surname>
            <given-names>Ali</given-names>
          </name>
          <name>
            <surname>Brinkman</surname>
            <given-names>Ryan</given-names>
          </name>
          <name>
            <surname>Gottardo</surname>
            <given-names>Raphaël</given-names>
          </name>
        </person-group>
        <article-title>Merging Mixture Components for Cell Population Identification in Flow Cytometry</article-title>
        <source>Advances in Bioinformatics</source>
        <year>2009</year>
        <volume>2009</volume>
        <fpage>1</fpage>
        <lpage>12</lpage>
        <pub-id pub-id-type="doi">10.1155/2009/247646</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Biernacki</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Celeux</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Govaert</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Assessing a mixture model for clustering with the integrated completed likelihood</article-title>
        <source>IEEE Trans Pattern Anal Mach Intell</source>
        <year>2000</year>
        <volume>22</volume>
        <issue>7</issue>
        <fpage>719</fpage>
        <lpage>25</lpage>
        <pub-id pub-id-type="doi">10.1109/34.865189</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gaud</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Lesourne</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Love</surname>
            <given-names>PE</given-names>
          </name>
        </person-group>
        <article-title>Regulatory mechanisms in T cell receptor signalling</article-title>
        <source>Nat Rev Immunol</source>
        <year>2018</year>
        <volume>18</volume>
        <issue>8</issue>
        <fpage>485</fpage>
        <lpage>97</lpage>
        <pub-id pub-id-type="doi">10.1038/s41577-018-0020-8</pub-id>
        <pub-id pub-id-type="pmid">29789755</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Alegre</surname>
            <given-names>ML</given-names>
          </name>
          <name>
            <surname>Frauwirth</surname>
            <given-names>KA</given-names>
          </name>
          <name>
            <surname>Thompson</surname>
            <given-names>CB</given-names>
          </name>
        </person-group>
        <article-title>T-cell regulation by CD28 and CTLA-4</article-title>
        <source>Nat Rev Immunol</source>
        <year>2001</year>
        <volume>1</volume>
        <issue>3</issue>
        <fpage>220</fpage>
        <pub-id pub-id-type="doi">10.1038/35105024</pub-id>
        <pub-id pub-id-type="pmid">11905831</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mackall</surname>
            <given-names>CL</given-names>
          </name>
          <name>
            <surname>Fry</surname>
            <given-names>TJ</given-names>
          </name>
          <name>
            <surname>Gress</surname>
            <given-names>RE</given-names>
          </name>
        </person-group>
        <article-title>Harnessing the biology of IL-7 for therapeutic application</article-title>
        <source>Nat Rev Immunol</source>
        <year>2011</year>
        <volume>11</volume>
        <issue>5</issue>
        <fpage>330</fpage>
        <pub-id pub-id-type="doi">10.1038/nri2970</pub-id>
        <pub-id pub-id-type="pmid">21508983</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15</label>
      <mixed-citation publication-type="other">O’Brien TR. Interferon-alfa, interferon-lambda and hepatitis C. Nat Genet. 1048; 41(10).</mixed-citation>
    </ref>
    <ref id="CR16">
      <label>16</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Khodarev</surname>
            <given-names>NN</given-names>
          </name>
          <name>
            <surname>Roizman</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Weichselbaum</surname>
            <given-names>RR</given-names>
          </name>
        </person-group>
        <article-title>Molecular pathways: interferon/stat1 pathway: role in the tumor resistance to genotoxic stress and aggressive growth</article-title>
        <source>Clin Cancer Res</source>
        <year>2012</year>
        <volume>18</volume>
        <issue>11</issue>
        <fpage>3015</fpage>
        <lpage>21</lpage>
        <pub-id pub-id-type="doi">10.1158/1078-0432.CCR-11-3225</pub-id>
        <pub-id pub-id-type="pmid">22615451</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Foxwell</surname>
            <given-names>BM</given-names>
          </name>
          <name>
            <surname>Beadling</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Guschin</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Kerr</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Cantrell</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Interleukin-7 can induce the activation of Jak 1, Jak 3 and STAT 5 proteins in murine T cells</article-title>
        <source>Eur J Immunol</source>
        <year>1995</year>
        <volume>25</volume>
        <issue>11</issue>
        <fpage>3041</fpage>
        <lpage>6</lpage>
        <pub-id pub-id-type="doi">10.1002/eji.1830251109</pub-id>
        <pub-id pub-id-type="pmid">7489741</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yao</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Shin</surname>
            <given-names>MS</given-names>
          </name>
          <name>
            <surname>Trentalange</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Allore</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Nassar</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Montgomery</surname>
            <given-names>RR</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>CyTOF supports efficient detection of immune cell subsets from small samples</article-title>
        <source>J Immunol Methods</source>
        <year>2014</year>
        <volume>415</volume>
        <fpage>1</fpage>
        <lpage>5</lpage>
        <pub-id pub-id-type="doi">10.1016/j.jim.2014.10.010</pub-id>
        <pub-id pub-id-type="pmid">25450003</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
