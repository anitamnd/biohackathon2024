<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7026976</article-id>
    <article-id pub-id-type="publisher-id">3407</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-020-3407-z</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Methodology Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>SPECS: a non-parametric method to identify tissue-specific molecular features for unbalanced sample groups</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-7772-4259</contrib-id>
        <name>
          <surname>Everaert</surname>
          <given-names>Celine</given-names>
        </name>
        <address>
          <email>celine.everaert@ugent.be</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Volders</surname>
          <given-names>Pieter-Jan</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Morlion</surname>
          <given-names>Annelien</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Thas</surname>
          <given-names>Olivier</given-names>
        </name>
        <xref ref-type="aff" rid="Aff4">4</xref>
        <xref ref-type="aff" rid="Aff5">5</xref>
        <xref ref-type="aff" rid="Aff6">6</xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Mestdagh</surname>
          <given-names>Pieter</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2069 7798</institution-id><institution-id institution-id-type="GRID">grid.5342.0</institution-id><institution>Center for Medical Genetics, Department of Biomolecular Medicine, </institution><institution>Ghent University, </institution></institution-wrap>Ghent, Belgium </aff>
      <aff id="Aff2"><label>2</label>Cancer Research Institute Ghent, Ghent, Belgium </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="ISNI">0000000104788040</institution-id><institution-id institution-id-type="GRID">grid.11486.3a</institution-id><institution>Flemish Institute for Biotechnology, </institution></institution-wrap>Ghent, Belgium </aff>
      <aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 0604 5662</institution-id><institution-id institution-id-type="GRID">grid.12155.32</institution-id><institution>I-Biostat, Data Science Institute, Hasselt University, </institution></institution-wrap>Hasselt, Belgium </aff>
      <aff id="Aff5"><label>5</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 0486 528X</institution-id><institution-id institution-id-type="GRID">grid.1007.6</institution-id><institution>National Institute for Applied Statistics Australia (NIASRA), University of Wollongong, </institution></institution-wrap>Wollongong, Australia </aff>
      <aff id="Aff6"><label>6</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2069 7798</institution-id><institution-id institution-id-type="GRID">grid.5342.0</institution-id><institution>Department of Data Analysis and Mathematical Modelling, Faculty of Bioscience Engineering, </institution><institution>Ghent University, </institution></institution-wrap>Ghent, Belgium </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>17</day>
      <month>2</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>17</day>
      <month>2</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2020</year>
    </pub-date>
    <volume>21</volume>
    <elocation-id>58</elocation-id>
    <history>
      <date date-type="received">
        <day>18</day>
        <month>7</month>
        <year>2019</year>
      </date>
      <date date-type="accepted">
        <day>11</day>
        <month>2</month>
        <year>2020</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s). 2020</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold>This article is distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">To understand biology and differences among various tissues or cell types, one typically searches for molecular features that display characteristic abundance patterns. Several specificity metrics have been introduced to identify tissue-specific molecular features, but these either require an equal number of replicates per tissue or they can’t handle replicates at all.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">We describe a non-parametric specificity score that is compatible with unequal sample group sizes. To demonstrate its usefulness, the specificity score was calculated on all GTEx samples, detecting known and novel tissue-specific genes. A webtool was developed to browse these results for genes or tissues of interest. An example python implementation of SPECS is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/celineeveraert/SPECS">https://github.com/celineeveraert/SPECS</ext-link>. The precalculated SPECS results on the GTEx data are available through a user-friendly browser at <ext-link ext-link-type="uri" xlink:href="http://specs.cmgg.be">specs.cmgg.be</ext-link>.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p id="Par3">SPECS is a non-parametric method that identifies known and novel specific-expressed genes. In addition, SPECS could be adopted for other features and applications.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Specificity scoring</kwd>
      <kwd>RNA-sequencing</kwd>
      <kwd>GTEx</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>Fonds Wetenschappelijk Onderzoek (BE)</institution>
        </funding-source>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>Vocatio</institution>
        </funding-source>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>Kom op tegen Kanker (BE)</institution>
        </funding-source>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>Stichting Tegen Kanker (BE)</institution>
        </funding-source>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2020</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par11">To understand biology and differences among various tissues or cell types, one typically searches for molecular features (i.e. RNA, protein, metabolites) that display characteristic abundance patterns. In the most extreme case, these features display tissue- or cell-type restricted abundance profiles. Such specific features can provide insights in functional, development or disease mechanisms [<xref ref-type="bibr" rid="CR1">1</xref>] or serve as biomarkers [<xref ref-type="bibr" rid="CR2">2</xref>, <xref ref-type="bibr" rid="CR3">3</xref>]. Various consortium-based efforts have generated vast amounts of molecular data that can be exploited for this purpose. The Genotype-Tissue Expression (GTEx) project (<ext-link ext-link-type="uri" xlink:href="https://gtexportal.org">https://gtexportal.org</ext-link>) and The Cancer Genome Atlas (TCGA) (<ext-link ext-link-type="uri" xlink:href="https://www.cancer.gov/tcga">https://www.cancer.gov/tcga</ext-link>) are examples of such rich resources containing RNA-sequencing based molecular features for thousands of samples derived from various individuals and tissue types [<xref ref-type="bibr" rid="CR4">4</xref>]. To identify tissue-specific molecular features, several specificity metrics have been introduced, but these can suffer from data loss introduced by the requirement to collapse data from biological replicates. By introducing summary statistics, replicate data points are typically reduced to a single value (mean) or two values (mean and standard deviation). Examples of such metrics are Tau [<xref ref-type="bibr" rid="CR5">5</xref>], the z-score [<xref ref-type="bibr" rid="CR6">6</xref>], the Gini coefficient [<xref ref-type="bibr" rid="CR7">7</xref>] and the tissue specificity index (TSI) [<xref ref-type="bibr" rid="CR8">8</xref>]. Metrics that can handle biological replicates (e.g. JSD [<xref ref-type="bibr" rid="CR9">9</xref>]) require equal sample sizes. Specificity metrics also differ in the output that is generated. Some (Tau, Gini, TSI) generate a single score often representing fold-changes between the mean values while others (z-score, JSD) generate a score per tissue. A thorough benchmark was performed for these scores, identifying Tau as the best overall method [<xref ref-type="bibr" rid="CR10">10</xref>]. This benchmark focused on robustness of the scores by subsampling the tissues. Biological signal was evaluated by calculating the conservation of tissue specificity between mouse and human orthologs, and by assessing several tissue specific GO terms.</p>
    <p id="Par12">In this application note, we describe a novel non-parametric specificity score that is compatible with unequal sample group sizes, uses all individual datapoints and enables the detection of features that are specifically present or absent in one or more tissue types. We benchmarked our SPECS score with others by artificially introducing expression specificity in a large and heterogeneous RNA-sequencing data set.</p>
  </sec>
  <sec id="Sec2">
    <title>Results</title>
    <p id="Par13">The evaluation of individual features for predicting a binary biological status can be based on an estimate of the area under the ROC curve (AUC). The AUC can be either interpreted as an integrated performance metric of sensitivities and specificities over all possible thresholds, or as a measure for the overlap between the distributions of the feature in the two biological status groups. When more than two groups are present, and the aim is to evaluate a feature, in our case gene expression, for distinguishing one group from the others, we propose a new AUC-type of statistic (SPECS). This method still has the interpretation of a measurement for the overlap between two distributions (one group as compared to the pooled group of the others). Perfect non-overlapping abundance distributions where the distribution of the specific group is shifted to higher abundance values have a SPECS score of one. On the other hand, when the feature is absent in one group, the distribution of this group shifts to zero or lower abundance values and this results in a score of zero. On top, the method can be adjusted to account for the prevalence of the biological statuses in the target population (and hence correct for the group sample sizes in the available dataset).</p>
    <p id="Par14">Although features can be selected based on their ranking in terms of their estimated AUCs, this procedure is at risk for selection bias, i.e. a large estimated AUC may result from a feature with only a moderate AUC but with a large estimation variance. Efron et al. discussed this issue in detail [<xref ref-type="bibr" rid="CR11">11</xref>], but did not apply this to the AUC. He proposed to correct the estimates by means of an empirical Bayes procedure, which can be seen as a Bayesian procedure for which no prior distribution need to be specified. As an advantage, Bayesian methods are known to be insensitive to selection bias. His formula is also known as Tweedie’s formula, described into more detail in Supplemental Methods <xref rid="MOESM1" ref-type="media">1</xref>.</p>
    <p id="Par15">To evaluate our SPECS method, we made use of RNA-sequencing data from the GTEx (version 7) project [<xref ref-type="bibr" rid="CR4">4</xref>] consisting of 12,766 samples belonging to 31 different tissues (7 to 1854 samples per tissue). We calculated the SPECS specificity score on normalized counts for all Ensembl (GRCh38.v85) genes (<italic>n</italic> = 56,202) using all samples. For 30 of the 31 tissues, 2 (esophagus) to 7948 (testis) specifically expressed genes were identified. Most of these genes are protein coding (<italic>n</italic> = 10,959), followed by lincRNAs (<italic>n</italic> = 3080), antisense genes (<italic>n</italic> = 2022) and pseudogenes (<italic>n</italic> = 1976) (Fig. <xref rid="Fig1" ref-type="fig">1</xref>a, Supplemental Figure <xref rid="MOESM2" ref-type="media">1</xref> and Supplemental Table <xref rid="MOESM3" ref-type="media">1</xref>). In addition, the method has the ability to identify genes that are highly specific for two (or more) tissues, with specificity scores that are slightly lower. As expected, the tissues with the highest number of common specific genes are biologically related such as spleen and blood, or brain and pituitary or muscle and hart.
<fig id="Fig1"><label>Fig. 1</label><caption><p>Known and novel genes are detected as specific for various biotypes. <bold>a</bold> The number of specific genes for each GTEx tissue and biotype shows that most specific genes are protein-coding. <bold>b</bold> Cumulative distribution of the mean expression of specific genes, shows that specific protein-coding genes are higher expressed compared to the other biotypes. <bold>c</bold> Cumulative distribution of the fold changes of specific genes and the 2nd tissue shows larger differences for lincRNA genes compared to other biotypes. <bold>d</bold> Examples of well-known specific genes; UPK2 for bladder, KLK3 for prostate, MUC7 for adrenal gland and AMY2A for pancreas</p></caption><graphic xlink:href="12859_2020_3407_Fig1_HTML" id="MO1"/></fig></p>
    <p id="Par16">Besides genes that are specifically abundant in a tissue, our method also enables the identification of genes that are specifically repressed in a given tissue. These so-called disallowance genes [<xref ref-type="bibr" rid="CR12">12</xref>] were found for 17 tissues ranging from 2 (salivary gland) to 1989 (blood) genes. Most of these are protein coding genes (Supplemental Figure <xref rid="MOESM2" ref-type="media">2</xref>). Distributions of the SPECS score are highly similar for all tissue types, except for testis (which is known to be enriched for tissue-specific genes). Most genes have a SPECS score around 0.5 (Supplemental Figure <xref rid="MOESM2" ref-type="media">3</xref>). For all specifically abundant genes we calculated fold changes between the specific tissue(s) and all other tissues. The fold changes for lincRNAs were typically higher than for other biotypes, in line with previous studies in which lincRNAs were shown to be more specific compared to protein coding genes [<xref ref-type="bibr" rid="CR9">9</xref>] (Fig. <xref rid="Fig1" ref-type="fig">1</xref>b and c). The SPECS score is not impacted by abundance, however, measuring counts with RNA-seq is. Low abundant genes suffer from sampling bias and thus have a higher variance. In addition, zero counts can indicate real absence of gene expression or can occur when abundance falls below the detection threshold of the gene expression profiling method.</p>
    <p id="Par17">From our analyses, known specific genes are readily confirmed, such as kallikrein related peptidase 2 (KLK2) and 3 (KLK3, also known as PSA) for prostate, uroplakin 2 (UPK2) for bladder, mucin 7 (MUC7) for the salivary gland and amylase alpha 2A (AMY2A) for pancreas (Fig. <xref rid="Fig1" ref-type="fig">1</xref>d). For each tissue in GTEx, rank percentiles for the specific genes are pre-calculated and distilled into a web tool (<ext-link ext-link-type="uri" xlink:href="http://specs.cmgg.be">specs.cmgg.be</ext-link>) where a user can select either their gene of interest to evaluate its specificity or a tissue of interest to identify the most specific genes.</p>
    <p id="Par18">To compare the SPECS score to other existing scores, we artificially introduced specificity in the GTEx expression dataset by multiplying true gene counts with a constant factor or by adding constant values to gene counts in one tissue type. To this purpose, a set of 1000 genes with small overall variabilities and a mean expression below 10 counts was selected (further referred to as the backgound set). For each experiment, counts for fifty randomly selected genes from the background set were manipulated as described above (see <xref rid="Sec5" ref-type="sec">Methods</xref> for details) to introduce tissue-specificity. This process was performed independently for 5 random tissues. Since the different specificity scores each have their own scale and cut-off value, we used the ranks of the scores across all 1000 genes to compare methods. We expect our specificity-induced genes to rank high, and thus have low ranks. For each round of simulations, we then sum up these ranks for the specificity induced genes and compare these summed ranked values across all (five) simulations.</p>
    <p id="Par19">No differences between the methods in the summed ranked values were observed for multiplication factors of 1, 2, 10 and 20 (respectively <italic>p</italic> = 0.914, <italic>p</italic> = 0.454, <italic>p</italic> = 106, <italic>p</italic> = 0.439). For multiplications with a factor of 3, 4, 5, 6 and 8, significant differences (<italic>p</italic> &lt; 0.05) amongst specificity metrics were observed. When looking into this data (for a 5-fold multiplication), SPECS assigned lower scores, resulting in lower ranks, to some of the specificity induced genes (Fig. <xref rid="Fig2" ref-type="fig">2</xref>a) compared to the other methods. The expression profiles of these genes in the tissue with induced specificity were increased but showed clear overlap with the expression profiles in the other tissues (Fig. <xref rid="Fig2" ref-type="fig">2</xref>b), explaining the lower SPECS scores. Most other methods did not generate lower scores for these genes. To assess the impact of overlapping expression distributions on the specificity score, we first calculated a metric that reflects overlap. To this end, all samples were ranked based on expression of the gene, and the ranks of the samples belonging to the specificity induced tissue were summed. If the expression in the tissue with induced specificity is consistently higher, the rank sum in that tissue will be low (Fig. <xref rid="Fig2" ref-type="fig">2</xref>c). In contrast, if the expression of the specific tissue is overlapping the other tissue, the individual ranks will be higher, resulting in a higher rank sum (Fig. <xref rid="Fig2" ref-type="fig">2</xref>b). Plotting expression rank sums for all specificity induced genes versus the matching ranked scores of the metrics clearly shows that only SPECS has a reduced score when there is more expression overlap with other tissues (Fig. <xref rid="Fig2" ref-type="fig">2</xref>d), while this relationship is lacking for the other metrics.
<fig id="Fig2"><label>Fig. 2</label><caption><p>Benchmarking SPECS compared to the other scores by multiplication of the background signal in one tissue. <bold>a</bold> Ranked specificity score values for different metrics. Ranks are higher for SPECS compared to the other metrics. <bold>b</bold> A gene with induced specificity that is ranked higher SPECS compared to the other metrics shows a large expression overlap with the other tissues. <bold>c</bold> A gene with induced specificity, that is ranked lower all metrics shows less expression overlap with the other tissues. <bold>d</bold> Correlation between the summed rank of the gene expression with the rank of the score for each metric. SPECS shows the strongest correlation</p></caption><graphic xlink:href="12859_2020_3407_Fig2_HTML" id="MO2"/></fig></p>
    <p id="Par20">To assess the impact of the variance, a constant count value was added to the gene count and multiple variance factors were introduced (see <xref rid="Sec5" ref-type="sec">Methods</xref> for details). Compared to multiplying counts, adding a constant value excludes zero counts and maintains the variance. When adding 10, 15, 25, 50, 75, 100 and 1000 counts, clear differences between the performance of the methods are observed up to adding 50 counts (<italic>p</italic> &lt; 0.0001). SPECS clearly outperforms the other methods for lower count values and is thus more sensitive to detect low abundant tissue-specific genes (Fig. <xref rid="Fig3" ref-type="fig">3</xref>a). To analyze the impact of the variance, we added 100 counts to the gene count and evaluated the specificity scores while increasing the variance (from original variance to 50 times higher variance). Specificity scores were insensitive to increasing variance for all metrics but SPECS (shown for 50 specificity induced genes in Supplemental Figure <xref rid="MOESM2" ref-type="media">4</xref>). This observation can be explained by the fact that SPECS is taking into account the variation. As expected, genes who’s SPECS scores decrease with increasing variance showed systematically more expression overlap with the other tissues (measured by the rank sum as explained higher) (Fig. <xref rid="Fig3" ref-type="fig">3</xref>b). For the genes that have a stable SPECS score the overlap is stable as well.
<fig id="Fig3"><label>Fig. 3</label><caption><p>Benchmarking SPECS compared to the other scores by summation of a constant value to the background signal in one tissue. <bold>a</bold> Ranked score values of multiple metrics show higher ranks for SPECS compared to the other scores when adding 10 counts. <bold>b</bold> The impact of increasing variance on the SPECS score. Increasing variance results in increasing overlap of expression distributions, indicated by summed expression ranks. Each gene is represented by an individual line in the plot, colors indicate the same gene in each plot</p></caption><graphic xlink:href="12859_2020_3407_Fig3_HTML" id="MO3"/></fig></p>
    <p id="Par21">Additionally, we wanted to evaluate how SPECS deals with changing group sizes. Specificity was induced by randomly adding 100 counts to 50 genes from the background set and this for one tissue. From the specificity induced tissue samples, a random fraction of samples was subsampled (ranging between 20 and 100%) after which the SPECS score was calculated on this subsampled set. This was repeated five times for different randomly chosen tissues. No difference (<italic>p</italic> = 0.874) was observed for the SPECS score between the different group sizes. Finally, robustness was tested to show that SPECS is stable when using random fractions of the data. We therefore repeatedly (<italic>n</italic> = 5) subsampled equally sized sample groups (20% of the original data) from the original data. No changes in the SPECS score values for the specificity induced genes were observed (<italic>p</italic>-values between 0.158 and 0.411).</p>
  </sec>
  <sec id="Sec3">
    <title>Discussion</title>
    <p id="Par22">Current statistics to calculate specificity are collapsing datapoints within each label into a single value, whether or not with an additional variance metric, resulting in loss of information. Our non-parametric specificity score SPECS uses all data points to calculate a specificity metric. We calculated the score on the GTEx data and recovered known biology. We benchmarked SPECS with various established specificity scores and found that SPECS outperforms the other scores. SPECS is more sensitive to detect specific genes that are low abundant. Additionally, SPECS takes into account the variance, and therefore disfavors genes with overlapping expression distributions between tissues. In addition, SPECS is stable with changing sample sizes and robust. This specificity metric can be applied to any type of quantitative molecular data including protein expression or chip-sequencing. Not only tissues could be used as features but also cancer types or ethnic populations. Besides biological applications, we also see application potential in other fields such as economy and social sciences.</p>
  </sec>
  <sec id="Sec4">
    <title>Conclusion</title>
    <p id="Par23">SPECS is a non-parametric specificity score applicable on big data sets without data loss or reduction. In our example SPECS is shown to be useful to calculate tissue specific expression of genes, however, other applications are possible in molecular biology or beyond.</p>
  </sec>
  <sec id="Sec5">
    <title>Methods</title>
    <p id="Par24">Let the index <italic>d</italic> = 1,...,m<sub>d</sub> refer to a particular sample state. Depending on the application and whether the user wants to give weight to a certain state, π<sub>d</sub> is the prevalence of state <italic>d</italic> in the target population or π<sub>d</sub> is equilibrated. Suppose there are m<sub>g</sub> candidate features, i.e. g = 1,...,m<sub>g</sub>. Let Y<sub>gd</sub> denote the outcome of feature <italic>g</italic> in state <italic>d</italic> with n<sub>gd</sub> observations, so that the individual outcomes are denoted by Y<sub>gdi</sub>, i = 1, …,n<sub>gd</sub>. The Y<sub>g-d</sub> notation denotes the outcome of feature <italic>f</italic> in all groups but the state <italic>d</italic>. The index <italic>g</italic> will be dropped in further notations. A feature is a characteristic for a given state if its outcome distribution for the given state shows no overlap with the outcome distributions of the other states. This means a larger AUC, given by:
<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {p}_d=P\left\{{Y}_{-d}&lt;{Y}_d\right\}=\sum \limits_{k\ne d}P\left\{{Y}_k&lt;{Y}_d\right\}{\pi}_k $$\end{document}</tex-math><mml:math id="M2" display="block"><mml:msub><mml:mi>p</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>P</mml:mi><mml:mfenced close="}" open="{"><mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>Y</mml:mi><mml:mi>d</mml:mi></mml:msub></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>≠</mml:mo><mml:mi>d</mml:mi></mml:mrow></mml:munder><mml:mi>P</mml:mi><mml:mfenced close="}" open="{"><mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>Y</mml:mi><mml:mi>d</mml:mi></mml:msub></mml:mrow></mml:mfenced><mml:msub><mml:mi>π</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:math><graphic xlink:href="12859_2020_3407_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula></p>
    <p id="Par25">If p<sub>d</sub> is close to zero or one, the distributions are well separated. The probabilities P{Y<sub>k</sub> &lt; Y<sub>d</sub>} are computationally fast to calculate. The probability P<sub>kd</sub> = P{Y<sub>k</sub> &lt; Y<sub>d</sub>} is then estimated as:
<disp-formula id="Equa"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\hat{P}}_{kd}=\frac{1}{n_k{n}_d}\sum \limits_{i=1}^{n_k}\sum \limits_{j=1}^{n_d}{I}_{ki;\mathrm{d}j} $$\end{document}</tex-math><mml:math id="M4" display="block"><mml:msub><mml:mover accent="true"><mml:mi>P</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mi mathvariant="italic">kd</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:msub><mml:mi>n</mml:mi><mml:mi>d</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:munderover><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>d</mml:mi></mml:msub></mml:munderover><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi mathvariant="italic">ki</mml:mi><mml:mo>;</mml:mo><mml:mi mathvariant="normal">d</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math><graphic xlink:href="12859_2020_3407_Article_Equa.gif" position="anchor"/></alternatives></disp-formula>with <italic>I</italic><sub><italic>ki</italic>; <italic>dj</italic></sub> a 0/1 indicator for the event <italic>Y</italic><sub><italic>ki</italic></sub> &lt; <italic>Y</italic><sub><italic>dj</italic></sub>.</p>
    <p id="Par26">Hence, an estimator of p<sub>d</sub> is given by:
<disp-formula id="Equb"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\hat{p}}_d=\sum \limits_{k\ne d}{\hat{P}}_{kd}{\pi}_k $$\end{document}</tex-math><mml:math id="M6" display="block"><mml:msub><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mi>d</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>≠</mml:mo><mml:mi>d</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mover accent="true"><mml:mi>P</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mi mathvariant="italic">kd</mml:mi></mml:msub><mml:msub><mml:mi>π</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:math><graphic xlink:href="12859_2020_3407_Article_Equb.gif" position="anchor"/></alternatives></disp-formula></p>
    <p id="Par27">Further selection of features can be performed based on the distributions of <inline-formula id="IEq1"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\hat{p}}_d $$\end{document}</tex-math><mml:math id="M8" display="inline"><mml:msub><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mi>d</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2020_3407_Article_IEq1.gif"/></alternatives></inline-formula> as explained in Supplemental Methods <xref rid="MOESM1" ref-type="media">1</xref>. As this is a computationally intensive step for large data matrices, one can opt to select features based on a threshold. In our use case, we defined state-specific features as those where the score (<inline-formula id="IEq2"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\hat{p}}_d $$\end{document}</tex-math><mml:math id="M10" display="inline"><mml:msub><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mi>d</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2020_3407_Article_IEq2.gif"/></alternatives></inline-formula>) for one state was above 0.95 and features that were specifically absent in one state as those with a score (<inline-formula id="IEq3"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\hat{p}}_d $$\end{document}</tex-math><mml:math id="M12" display="inline"><mml:msub><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mi>d</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2020_3407_Article_IEq3.gif"/></alternatives></inline-formula>) lower than 0.05. If the score of 0.95 or 0.05 was reached in multiple states, the feature was defined as specific (present or absent) for all these states. The python implementation of the method is available at <ext-link ext-link-type="uri" xlink:href="https://github.com">https://github.com</ext-link> /celineeveraert/SPECS.</p>
    <p id="Par28">To calculate SPECS, the count data was retrieved from the GTEXportal (<ext-link ext-link-type="uri" xlink:href="http://www.gtexportal.org">www.gtexportal.org</ext-link>) and normalized by DESeq2 [<xref ref-type="bibr" rid="CR13">13</xref>]. For the benchmarking, we selected 1000 low abundant (mean normalized counts between 0.1 and 10) and stable (lowest standard deviation between the tissue types) expressed genes to create a background set. We included samples from 10 tissue types with a variable sample number (11 to 490 samples per type). In this data set, we artificially introduced specificity and calculate various specificity metrics.</p>
    <sec id="Sec6">
      <title>Zscore [<xref ref-type="bibr" rid="CR6">6</xref>]</title>
      <p id="Par29">
        <disp-formula id="Equc">
          <alternatives>
            <tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ z=\frac{x_i-\mu }{\sigma } $$\end{document}</tex-math>
            <mml:math id="M14" display="block">
              <mml:mi>z</mml:mi>
              <mml:mo>=</mml:mo>
              <mml:mfrac>
                <mml:mrow>
                  <mml:msub>
                    <mml:mi>x</mml:mi>
                    <mml:mi>i</mml:mi>
                  </mml:msub>
                  <mml:mo>−</mml:mo>
                  <mml:mi>μ</mml:mi>
                </mml:mrow>
                <mml:mi>σ</mml:mi>
              </mml:mfrac>
            </mml:math>
            <graphic xlink:href="12859_2020_3407_Article_Equc.gif" position="anchor"/>
          </alternatives>
        </disp-formula>
      </p>
      <p id="Par30">μ is the mean of gene expression; σ is the standard deviation</p>
    </sec>
    <sec id="Sec7">
      <title>Gini coefficient [<xref ref-type="bibr" rid="CR7">7</xref>]</title>
      <p id="Par31"><disp-formula id="Equd"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ Gini=\frac{n+1}{n}-\frac{2{\sum}_{i=1}^n\left(n+1-i\right){x}_i}{n{\sum}_{i=1}^n{x}_i} $$\end{document}</tex-math><mml:math id="M16" display="block"><mml:mtext mathvariant="italic">Gini</mml:mtext><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:mfrac><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:mfenced close=")" open="("><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:mfenced><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:math><graphic xlink:href="12859_2020_3407_Article_Equd.gif" position="anchor"/></alternatives></disp-formula>x<sub>i</sub> has to be ordered starting at the smallest value</p>
    </sec>
    <sec id="Sec8">
      <title>Tau [<xref ref-type="bibr" rid="CR5">5</xref>]</title>
      <p id="Par32">
        <disp-formula id="Eque">
          <alternatives>
            <tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \tau =\frac{\sum_{i=1}^n\left(1-{\hat{x}}_i\right)}{n-1};{\hat{x}}_i=\frac{x_i}{\underset{1\le i\le n}{\max}\left({x}_i\right)} $$\end{document}</tex-math>
            <mml:math id="M18" display="block">
              <mml:mi>τ</mml:mi>
              <mml:mo>=</mml:mo>
              <mml:mfrac>
                <mml:mrow>
                  <mml:msubsup>
                    <mml:mo>∑</mml:mo>
                    <mml:mrow>
                      <mml:mi>i</mml:mi>
                      <mml:mo>=</mml:mo>
                      <mml:mn>1</mml:mn>
                    </mml:mrow>
                    <mml:mi>n</mml:mi>
                  </mml:msubsup>
                  <mml:mfenced close=")" open="(">
                    <mml:mrow>
                      <mml:mn>1</mml:mn>
                      <mml:mo>−</mml:mo>
                      <mml:msub>
                        <mml:mover accent="true">
                          <mml:mi>x</mml:mi>
                          <mml:mo stretchy="true">^</mml:mo>
                        </mml:mover>
                        <mml:mi>i</mml:mi>
                      </mml:msub>
                    </mml:mrow>
                  </mml:mfenced>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>n</mml:mi>
                  <mml:mo>−</mml:mo>
                  <mml:mn>1</mml:mn>
                </mml:mrow>
              </mml:mfrac>
              <mml:mo>;</mml:mo>
              <mml:msub>
                <mml:mover accent="true">
                  <mml:mi>x</mml:mi>
                  <mml:mo stretchy="true">^</mml:mo>
                </mml:mover>
                <mml:mi>i</mml:mi>
              </mml:msub>
              <mml:mo>=</mml:mo>
              <mml:mfrac>
                <mml:msub>
                  <mml:mi>x</mml:mi>
                  <mml:mi>i</mml:mi>
                </mml:msub>
                <mml:mrow>
                  <mml:munder>
                    <mml:mo>max</mml:mo>
                    <mml:mrow>
                      <mml:mn>1</mml:mn>
                      <mml:mo>≤</mml:mo>
                      <mml:mi>i</mml:mi>
                      <mml:mo>≤</mml:mo>
                      <mml:mi>n</mml:mi>
                    </mml:mrow>
                  </mml:munder>
                  <mml:mfenced close=")" open="(">
                    <mml:msub>
                      <mml:mi>x</mml:mi>
                      <mml:mi>i</mml:mi>
                    </mml:msub>
                  </mml:mfenced>
                </mml:mrow>
              </mml:mfrac>
            </mml:math>
            <graphic xlink:href="12859_2020_3407_Article_Eque.gif" position="anchor"/>
          </alternatives>
        </disp-formula>
      </p>
    </sec>
    <sec id="Sec9">
      <title>TSI [<xref ref-type="bibr" rid="CR8">8</xref>]</title>
      <p id="Par33">
        <disp-formula id="Equf">
          <alternatives>
            <tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ TSI=\frac{\underset{1\le i\le n}{\max}\left({x}_i\right)}{\sum_{i=1}^n{x}_i} $$\end{document}</tex-math>
            <mml:math id="M20" display="block">
              <mml:mi mathvariant="italic">TSI</mml:mi>
              <mml:mo>=</mml:mo>
              <mml:mfrac>
                <mml:mrow>
                  <mml:munder>
                    <mml:mo>max</mml:mo>
                    <mml:mrow>
                      <mml:mn>1</mml:mn>
                      <mml:mo>≤</mml:mo>
                      <mml:mi>i</mml:mi>
                      <mml:mo>≤</mml:mo>
                      <mml:mi>n</mml:mi>
                    </mml:mrow>
                  </mml:munder>
                  <mml:mfenced close=")" open="(">
                    <mml:msub>
                      <mml:mi>x</mml:mi>
                      <mml:mi>i</mml:mi>
                    </mml:msub>
                  </mml:mfenced>
                </mml:mrow>
                <mml:mrow>
                  <mml:msubsup>
                    <mml:mo>∑</mml:mo>
                    <mml:mrow>
                      <mml:mi>i</mml:mi>
                      <mml:mo>=</mml:mo>
                      <mml:mn>1</mml:mn>
                    </mml:mrow>
                    <mml:mi>n</mml:mi>
                  </mml:msubsup>
                  <mml:msub>
                    <mml:mi>x</mml:mi>
                    <mml:mi>i</mml:mi>
                  </mml:msub>
                </mml:mrow>
              </mml:mfrac>
            </mml:math>
            <graphic xlink:href="12859_2020_3407_Article_Equf.gif" position="anchor"/>
          </alternatives>
        </disp-formula>
      </p>
    </sec>
    <sec id="Sec10">
      <title>JSD Score [<xref ref-type="bibr" rid="CR9">9</xref>]</title>
      <p id="Par34"><disp-formula id="Equg"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ JS\left({p}^1,{p}^2\right)=H\left(\frac{p^1+{p}^2}{2}\right)-\frac{H\left({p}^1\right)+H\left({p}^2\right)}{2} $$\end{document}</tex-math><mml:math id="M22" display="block"><mml:mi mathvariant="italic">JS</mml:mi><mml:mfenced close=")" open="(" separators=","><mml:msup><mml:mi>p</mml:mi><mml:mn>1</mml:mn></mml:msup><mml:msup><mml:mi>p</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mfenced><mml:mo>=</mml:mo><mml:mi>H</mml:mi><mml:mfenced close=")" open="("><mml:mfrac><mml:mrow><mml:msup><mml:mi>p</mml:mi><mml:mn>1</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mi>p</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mn>2</mml:mn></mml:mfrac></mml:mfenced><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mi>H</mml:mi><mml:mfenced close=")" open="("><mml:msup><mml:mi>p</mml:mi><mml:mn>1</mml:mn></mml:msup></mml:mfenced><mml:mo>+</mml:mo><mml:mi>H</mml:mi><mml:mfenced close=")" open="("><mml:msup><mml:mi>p</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mfenced></mml:mrow><mml:mn>2</mml:mn></mml:mfrac></mml:math><graphic xlink:href="12859_2020_3407_Article_Equg.gif" position="anchor"/></alternatives></disp-formula>where H is the entropy of a discrete probability distribution:
<disp-formula id="Equh"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\displaystyle \begin{array}{c}p=\left({p}^1,{p}^2..,{p}^n\right),0\le {p}_i\le 1\  and\ \sum \limits_{i=1}^n{p}_i=1\\ {}H(p)=-{\sum}_{i=1}^n{p}_i\ \log \left({p}_i\right)\end{array}} $$\end{document}</tex-math><mml:math id="M24" display="block"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd><mml:mi>p</mml:mi><mml:mo>=</mml:mo><mml:mfenced close=")" open="(" separators=",,"><mml:msup><mml:mi>p</mml:mi><mml:mn>1</mml:mn></mml:msup><mml:mrow><mml:msup><mml:mi>p</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>.</mml:mo><mml:mo>.</mml:mo></mml:mrow><mml:msup><mml:mi>p</mml:mi><mml:mi>n</mml:mi></mml:msup></mml:mfenced><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>≤</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>≤</mml:mo><mml:mn>1</mml:mn><mml:mspace width="0.25em"/><mml:mtext mathvariant="italic">and</mml:mtext><mml:mspace width="0.25em"/><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:msub><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>H</mml:mi><mml:mfenced close=")" open="("><mml:mi>p</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:msub><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mspace width="0.25em"/><mml:mo>log</mml:mo><mml:mfenced close=")" open="("><mml:msub><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfenced></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="12859_2020_3407_Article_Equh.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par35">The distance between two expression patterns (e) is defined as:
<disp-formula id="Equi"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ JSD\left({e}_1,{e}_2\right)=\sqrt{JS\Big(}{e}_1,{e}_2\Big) $$\end{document}</tex-math><mml:math id="M26" display="block"><mml:mi mathvariant="italic">JSD</mml:mi><mml:mfenced close=")" open="(" separators=","><mml:msub><mml:mi>e</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>e</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mfenced><mml:mo>=</mml:mo><mml:msqrt><mml:mrow><mml:mi mathvariant="italic">JS</mml:mi><mml:mo stretchy="true">(</mml:mo></mml:mrow></mml:msqrt><mml:msub><mml:mi>e</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="true">)</mml:mo></mml:math><graphic xlink:href="12859_2020_3407_Article_Equi.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par36">The tissue specificity for tissue t can then be defined as:
<disp-formula id="Equj"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \mathrm{JSD}\ \mathrm{Score}\ \left(\mathrm{e}|\mathrm{t}\right)=1-\mathrm{JSD}\left(e,{e}^t\right) $$\end{document}</tex-math><mml:math id="M28" display="block"><mml:mi>JSD</mml:mi><mml:mspace width="0.25em"/><mml:mtext>Score</mml:mtext><mml:mspace width="0.25em"/><mml:mfenced close=")" open="(" separators="|"><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">t</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>JSD</mml:mi><mml:mfenced close=")" open="(" separators=","><mml:mi>e</mml:mi><mml:msup><mml:mi>e</mml:mi><mml:mi>t</mml:mi></mml:msup></mml:mfenced></mml:math><graphic xlink:href="12859_2020_3407_Article_Equj.gif" position="anchor"/></alternatives></disp-formula>where <italic>e</italic><sup><italic>t</italic></sup> is a predefined expression pattern in which there is only expression in one tissue.</p>
      <p id="Par37">The tissue specificity score is than defined as the maximal score across all tissues.</p>
      <p id="Par38">To be able to compare these scores expressed on different scales, score ranks were used instead of the absolute score values. These score ranks are calculated over all genes (including the background set). As such, the need to define cut-off values was also avoided.</p>
      <p id="Par39">We define a specific gene as a gene that is systematically higher expressed compared to the background. We introduced higher expression by either multiplication of the counts or adding a constant number. If we multiply, zero counts remain zero and low counts can still appear in the background. To quantify the overlap, we calculated for each gene the expression-based rank of the sample over all samples, were 1 is the sample with the highest abundance. By summing these ranks, we have a proxy for systematically higher expression. A high rank sum indicates that some samples overlap with the non-specificity induced tissues which resulted in a higher rank across all samples and thus a higher rank sum.</p>
      <p id="Par40">To compare the metrics, ANOVA testing was used on five cycles of random specificity induction of 50 genes out of 1000 genes from the background set.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary information</title>
    <sec id="Sec11">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="12859_2020_3407_MOESM1_ESM.pdf">
            <caption>
              <p><bold>Additional file 1.</bold> Supplementary methods.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="12859_2020_3407_MOESM2_ESM.pdf">
            <caption>
              <p><bold>Additional file 2.</bold> Supplemental Figure 1. Heatmap of the median expression of the specific genes for each tissue, shows the degree of specificity. Supplemental Figure 2. Number of disallowance genes for each tissue and biotype is variable. Supplemental Figure 3. SPECS score distribuitions for all GTEx tissue types. Supplemental Figure 4. Most scores remain stable with a larger induced variance, while SPECS has a declining score.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM3">
          <media xlink:href="12859_2020_3407_MOESM3_ESM.txt">
            <caption>
              <p><bold>Additional file 3.</bold> Supplementary Table SPECS results for all genes on GTEX.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>AMY2A</term>
        <def>
          <p id="Par4">Amylase alpha 2A</p>
        </def>
      </def-item>
      <def-item>
        <term>GTEx</term>
        <def>
          <p id="Par5">Genotype-Tissue Expression</p>
        </def>
      </def-item>
      <def-item>
        <term>KLK2</term>
        <def>
          <p id="Par6">Kallikrein related peptidase 2</p>
        </def>
      </def-item>
      <def-item>
        <term>KLK3</term>
        <def>
          <p id="Par7">Kallikrein related peptidase 3</p>
        </def>
      </def-item>
      <def-item>
        <term>MUC7</term>
        <def>
          <p id="Par8">Mucin 7</p>
        </def>
      </def-item>
      <def-item>
        <term>TCGA</term>
        <def>
          <p id="Par9">The Cancer Genome Atlas</p>
        </def>
      </def-item>
      <def-item>
        <term>UPK2</term>
        <def>
          <p id="Par10">Uroplakin 2</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher’s Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
    <fn>
      <p>Olivier Thas and Pieter Mestdagh contributed equally to this work.</p>
    </fn>
  </fn-group>
  <sec>
    <title>Supplementary information</title>
    <p><bold>Supplementary information</bold> accompanies this paper at 10.1186/s12859-020-3407-z.</p>
  </sec>
  <ack>
    <title>Acknowledgements</title>
    <p>The computational resources (Stevin Supercomputer Infrastructure) and services used in this work were provided by the VSC (Flemish Supercomputer Center), funded by Ghent University, FWO and the Flemish Government – department EWI.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>Conceptualization: C.E., O.T &amp; P.M; Data curation: C.E.; Formal analysis: C.E. &amp; A.M; Funding acquisition: C.E. &amp; P.M; Investigation: C.E. &amp; A.M; Methodology: C.E., PM &amp; O.T; Project administration: C.E.; Software: C.E. &amp; P.V; Supervision: O.T. &amp; P.M; Visualization: C.E.; Writing – original draft: C.E.; Writing – review &amp; editing: P.V, O.T. &amp; P.M. The authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>This work has been supported by the Fund for Scientific Research Flanders (FWO), Stichting Tegen Kanker, Kom Op Tegen Kanker and Vocatio. A.M is supported by Kom op Tegen Kanker and P.V. is supported by Fund for Scientific Research Flanders (FWO).</p>
    <p>The funding body did not play any role in the design of the study and collection, analysis, and interpretation of data and in writing the manuscript.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>Code: <ext-link ext-link-type="uri" xlink:href="https://github.com/celineeveraert/SPECS">https://github.com/celineeveraert/SPECS</ext-link></p>
    <p>Precalculated GTEx data: <ext-link ext-link-type="uri" xlink:href="https://specs.cmgg.be">https://specs.cmgg.be</ext-link></p>
  </notes>
  <notes>
    <title>Ethics approval and consent to participate</title>
    <p id="Par41">Not applicable.</p>
  </notes>
  <notes>
    <title>Consent for publication</title>
    <p id="Par42">Not applicable.</p>
  </notes>
  <notes notes-type="COI-statement">
    <title>Competing interests</title>
    <p id="Par43">The authors declare that they have no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Leucci</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Vendramin</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Spinazzi</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Laurette</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Fiers</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Wouters</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Melanoma addiction to the long non-coding RNA SAMMSON</article-title>
        <source>Nature</source>
        <year>2016</year>
        <volume>531</volume>
        <fpage>518</fpage>
        <lpage>522</lpage>
        <pub-id pub-id-type="doi">10.1038/nature17161</pub-id>
        <?supplied-pmid 27008969?>
        <pub-id pub-id-type="pmid">27008969</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stutterheim</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Gerritsen</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Zappeij-Kannegieter</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Kleijn</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Dee</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Hooft</surname>
            <given-names>L</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>PHOX2B is a novel and specific marker for minimal residual disease testing in neuroblastoma</article-title>
        <source>J Clin Oncol</source>
        <year>2008</year>
        <volume>26</volume>
        <fpage>5443</fpage>
        <lpage>5449</lpage>
        <pub-id pub-id-type="doi">10.1200/JCO.2007.13.6531</pub-id>
        <?supplied-pmid 18838715?>
        <pub-id pub-id-type="pmid">18838715</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Prensner</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Iyer</surname>
            <given-names>MK</given-names>
          </name>
          <name>
            <surname>Sahu</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Asangani</surname>
            <given-names>IA</given-names>
          </name>
          <name>
            <surname>Cao</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Patel</surname>
            <given-names>L</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The long noncoding RNA SChLAP1 promotes aggressive prostate cancer and antagonizes the SWI/SNF complex</article-title>
        <source>Nat Genet</source>
        <year>2013</year>
        <volume>45</volume>
        <fpage>1392</fpage>
        <lpage>1398</lpage>
        <pub-id pub-id-type="doi">10.1038/ng.2771</pub-id>
        <?supplied-pmid 24076601?>
        <pub-id pub-id-type="pmid">24076601</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lonsdale</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Thomas</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Salvatore</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Phillips</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Lo</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Shad</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The genotype-tissue expression (GTEx) project</article-title>
        <source>Nat Genet</source>
        <year>2013</year>
        <volume>45</volume>
        <fpage>580</fpage>
        <lpage>585</lpage>
        <pub-id pub-id-type="doi">10.1038/ng.2653</pub-id>
        <pub-id pub-id-type="pmid">23715323</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yanai</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Benjamin</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Shmoish</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Chalifa-Caspi</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Shklar</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Ophir</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Genome-wide midrange transcription profiles reveal expression level relationships in human tissue specification</article-title>
        <source>Bioinformatics</source>
        <year>2005</year>
        <volume>21</volume>
        <fpage>650</fpage>
        <lpage>659</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bti042</pub-id>
        <?supplied-pmid 15388519?>
        <pub-id pub-id-type="pmid">15388519</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Vandenbon</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Nakai</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>Modeling tissue-specific structural patterns in human and mouse promoters</article-title>
        <source>Nucleic Acids Res</source>
        <year>2009</year>
        <volume>38</volume>
        <fpage>17</fpage>
        <lpage>25</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkp866</pub-id>
        <pub-id pub-id-type="pmid">19850720</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ceriani</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Verme</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>The origins of the Gini index: extracts from Variabilità e Mutabilità (1912) by Corrado Gini</article-title>
        <source>J Econ Inequal</source>
        <year>2012</year>
        <volume>10</volume>
        <fpage>421</fpage>
        <lpage>443</lpage>
        <pub-id pub-id-type="doi">10.1007/s10888-011-9188-x</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Julien</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Brawand</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Soumillon</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Necsulea</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Liechti</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Schütz</surname>
            <given-names>F</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Mechanisms and evolutionary patterns of mammalian and avian dosage compensation</article-title>
        <source>PLoS Biol</source>
        <year>2012</year>
        <volume>10</volume>
        <fpage>e1001328</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pbio.1001328</pub-id>
        <?supplied-pmid 22615540?>
        <pub-id pub-id-type="pmid">22615540</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cabili</surname>
            <given-names>MN</given-names>
          </name>
          <name>
            <surname>Trapnell</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Goff</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Koziol</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Tazon-Vega</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Regev</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Integrative annotation of human large intergenic noncoding RNAs reveals global properties and specific subclasses</article-title>
        <source>Genes Dev</source>
        <year>2011</year>
        <volume>25</volume>
        <fpage>1915</fpage>
        <lpage>1927</lpage>
        <pub-id pub-id-type="doi">10.1101/gad.17446611</pub-id>
        <pub-id pub-id-type="pmid">21890647</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kryuchkova-Mostacci</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Robinson-Rechavi</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>A benchmark of gene expression tissue-specificity metrics</article-title>
        <source>Brief Bioinform</source>
        <year>2016</year>
        <volume>18</volume>
        <fpage>bbw008</fpage>
        <pub-id pub-id-type="doi">10.1093/bib/bbw008</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Efron</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Tweedie’s formula and selection bias</article-title>
        <source>J Am Stat Assoc</source>
        <year>2011</year>
        <volume>106</volume>
        <fpage>1602</fpage>
        <lpage>1614</lpage>
        <pub-id pub-id-type="doi">10.1198/jasa.2011.tm11181</pub-id>
        <?supplied-pmid 22505788?>
        <pub-id pub-id-type="pmid">22505788</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Thorrez</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Bonner-Weir</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Van Mechelen</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Van Lommel</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Laudadio</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Aguayo-Mazzucato</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Tissue-specific disallowance of housekeeping genes: the other face of cell differentiation</article-title>
        <source>Genome Res</source>
        <year>2010</year>
        <volume>21</volume>
        <fpage>95</fpage>
        <lpage>105</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.109173.110</pub-id>
        <pub-id pub-id-type="pmid">21088282</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Love</surname>
            <given-names>MI</given-names>
          </name>
          <name>
            <surname>Huber</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Anders</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Moderated estimation of fold change and dispersion for RNA-seq data with DESeq2</article-title>
        <source>Genome Biol</source>
        <year>2014</year>
        <volume>15</volume>
        <fpage>550</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-014-0550-8</pub-id>
        <?supplied-pmid 4302049?>
        <pub-id pub-id-type="pmid">25516281</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
