<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Int J Epidemiol</journal-id>
    <journal-id journal-id-type="iso-abbrev">Int J Epidemiol</journal-id>
    <journal-id journal-id-type="publisher-id">ije</journal-id>
    <journal-title-group>
      <journal-title>International Journal of Epidemiology</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">0300-5771</issn>
    <issn pub-type="epub">1464-3685</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8580266</article-id>
    <article-id pub-id-type="doi">10.1093/ije/dyab177</article-id>
    <article-id pub-id-type="publisher-id">dyab177</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software Application Profile</subject>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/MED00860</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>BIMAM—a tool for imputing variables missing across datasets using a Bayesian imputation and analysis model</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Elfadaly</surname>
          <given-names>Fadlalla G</given-names>
        </name>
        <xref rid="dyab177-aff1" ref-type="aff">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Adamson</surname>
          <given-names>Alex</given-names>
        </name>
        <xref rid="dyab177-aff2" ref-type="aff">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Patel</surname>
          <given-names>Jaymini</given-names>
        </name>
        <xref rid="dyab177-aff2" ref-type="aff">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Potts</surname>
          <given-names>Laura</given-names>
        </name>
        <xref rid="dyab177-aff3" ref-type="aff">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Potts</surname>
          <given-names>James</given-names>
        </name>
        <xref rid="dyab177-aff2" ref-type="aff">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-1621-704X</contrib-id>
        <name>
          <surname>Blangiardo</surname>
          <given-names>Marta</given-names>
        </name>
        <xref rid="dyab177-aff4" ref-type="aff">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Thompson</surname>
          <given-names>John</given-names>
        </name>
        <xref rid="dyab177-aff5" ref-type="aff">5</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-9166-3958</contrib-id>
        <name>
          <surname>Minelli</surname>
          <given-names>Cosetta</given-names>
        </name>
        <xref rid="dyab177-cor1" ref-type="corresp"/>
        <xref rid="dyab177-aff2" ref-type="aff">2</xref>
        <!--cosetta.minelli1@imperial.ac.uk-->
      </contrib>
    </contrib-group>
    <aff id="dyab177-aff1">
      <label>1</label>
      <institution>School of Mathematics and Statistics, The Open University, Milton Keynes, </institution>
      <country country="GB">UK</country>
    </aff>
    <aff id="dyab177-aff2"><label>2</label><institution> National Heart and Lung Institute, Imperial College London</institution>, London, <country country="GB">UK</country></aff>
    <aff id="dyab177-aff3"><label>3</label><institution>Department of Biostatistics &amp; Health Informatics, Institute of Psychiatry, Psychology &amp; Neuroscience, King’s College London</institution>, London, <country country="GB">UK</country></aff>
    <aff id="dyab177-aff4"><label>4</label><institution>MRC Centre for Environment and Health, School of Public Health, Imperial College London</institution>, London, <country country="GB">UK</country></aff>
    <aff id="dyab177-aff5"><label>5</label><institution>Department of Health Sciences, University of Leicester</institution>, Leicester, <country country="GB">UK</country></aff>
    <author-notes>
      <corresp id="dyab177-cor1">Corresponding author. NHLI, Imperial College London, Emmanuel Kaye Building, 1B Manresa Road, London SW3 6LR, UK. E-mail: <email>cosetta.minelli1@imperial.ac.uk</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>10</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2021-09-06">
      <day>06</day>
      <month>9</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>06</day>
      <month>9</month>
      <year>2021</year>
    </pub-date>
    <volume>50</volume>
    <issue>5</issue>
    <fpage>1419</fpage>
    <lpage>1425</lpage>
    <history>
      <date date-type="editorial-decision">
        <day>01</day>
        <month>7</month>
        <year>2021</year>
      </date>
      <date date-type="accepted">
        <day>03</day>
        <month>8</month>
        <year>2021</year>
      </date>
      <date date-type="corrected-typeset">
        <day>02</day>
        <month>11</month>
        <year>2021</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2021. Published by Oxford University Press on behalf of the International Epidemiological Association.</copyright-statement>
      <copyright-year>2021</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="dyab177.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>Combination of multiple datasets is routine in modern epidemiology. However, studies may have measured different sets of variables; this is often inefficiently dealt with by excluding studies or dropping variables. Multilevel multiple imputation methods to impute these ‘systematically’ missing data (as opposed to ‘sporadically’ missing data within a study) are available, but problems may arise when many random effects are needed to allow for heterogeneity across studies. We show that the Bayesian IMputation and Analysis Model (BIMAM) implemented in our tool works well in this situation.</p>
      </sec>
      <sec id="s2">
        <title>General features</title>
        <p>BIMAM performs imputation and analysis simultaneously. It imputes both binary and continuous systematically and sporadically missing data, and analyses binary and continuous outcomes. BIMAM is a user-friendly, freely available tool that does not require knowledge of Bayesian methods. BIMAM is an R Shiny application. It is downloadable to a local machine and it automatically installs the required freely available packages (R packages, including R2MultiBUGS and MultiBUGS).</p>
      </sec>
      <sec id="s3">
        <title>Availability</title>
        <p>BIMAM is available at [<ext-link xlink:href="http://www.alecstudy.org/bimam" ext-link-type="uri">www.alecstudy.org/bimam</ext-link>].</p>
      </sec>
    </abstract>
    <kwd-group>
      <kwd>Multiple imputation methods</kwd>
      <kwd>systematically missing data</kwd>
      <kwd>Bayesian methods</kwd>
      <kwd>Bayesian hierarchical models</kwd>
      <kwd>R Shiny application</kwd>
    </kwd-group>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>European Union’s Horizon 2020 research and innovation programme</institution>
          </institution-wrap>
        </funding-source>
        <award-id>633212</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="7"/>
    </counts>
  </article-meta>
</front>
<body>
  <p>
    <boxed-text id="dyab177-BOX1" position="float">
      <sec>
        <title>Key Features</title>
        <list list-type="bullet">
          <list-item>
            <p>When information is combined across datasets, multilevel multiple imputation of variables missing in some datasets should always be considered if a missing at random assumption is reasonable.</p>
          </list-item>
          <list-item>
            <p>Available approaches may not work well if there is heterogeneity and, to allow for that, too many random effects are required relative to the number of datasets.</p>
          </list-item>
          <list-item>
            <p>In this case, the performance of available imputation methods substantially improves when followed by a Bayesian analysis model.</p>
          </list-item>
          <list-item>
            <p>BIMAM implements a Bayesian joint imputation and analysis approach that works very well also in the presence of heterogeneity, which it fully allows for.</p>
          </list-item>
          <list-item>
            <p>BIMAM is a stand-alone online tool that is user-friendly and can be used by researchers not familiar with Bayesian methods.</p>
          </list-item>
        </list>
      </sec>
    </boxed-text>
  </p>
  <sec sec-type="intro">
    <title>Introduction</title>
    <p>In collaborative epidemiological projects that combine information across multiple datasets to estimate the associations of risk factors with a disease trait or find its best set of predictors, a major issue is how to deal with studies that have measured different sets of variables. This problem is referred to as systematically missing data, as opposed to sporadically missing data where values are missing for individuals within a dataset.</p>
    <p>Following an approach similar to the widely used Multiple Imputation by Chained Equations (MICE) for sporadically missing data,<xref rid="dyab177-B1" ref-type="bibr"><sup>1</sup></xref> methods to impute missing variables in a dataset based on information from the other datasets have recently been developed. Under a missing at random assumption, MICE imputes sporadically missing data through random draws from the posterior distribution of the missing values given the observed data, using a sequence of conditional regressions (linear models for continuous missing data, logistic for binary data, etc.). Multiple imputed datasets, created to reflect uncertainty in the imputation, are analysed separately and their results combined using Rubin's rules.<xref rid="dyab177-B2" ref-type="bibr"><sup>2</sup></xref> Multilevel extensions of MICE to account for the non-independence of observations when combining datasets (clusters) have been developed using classical and Bayesian methods, some of which allow simultaneous imputation of both systematically and sporadically missing data.<xref rid="dyab177-B3" ref-type="bibr"><sup>3–6</sup></xref> Whereas these methods are based on fully conditional specification (FCS) of the imputation model, where a conditional distribution is defined for each missing variable, others have been developed based on joint modelling (JM), where a multivariate joint distribution is specified for all variables in the imputation model.<xref rid="dyab177-B7" ref-type="bibr"><sup>7</sup></xref> All these methods have been recently compared, modified and implemented in a single R package, <italic toggle="yes">micemd</italic>, by Audigier <italic toggle="yes">et al.</italic><xref rid="dyab177-B8" ref-type="bibr"><sup>8</sup></xref> They all generate multiple imputed datasets with results combined using Rubin’s rule, and the analysis of interest is typically performed within a classical framework.<xref rid="dyab177-B8" ref-type="bibr"><sup>8</sup></xref></p>
    <p>When pooling data from different populations, or from studies with different methods, there is often heterogeneity across datasets in the size of the association of both the risk factors with the outcome (analysis model), and the predictors with the missing variable (imputation model). This is what we observe in the project that has motivated our work, the Ageing Lungs in European Cohorts (ALEC) international study, which combines multiple datasets to identify risk factors for poor lung function and chronic obstructive pulmonary disease [<ext-link xlink:href="http://www.alecstudy.org" ext-link-type="uri">www.alecstudy.org</ext-link>]. All imputation methods compared by Audigier <italic toggle="yes">et al</italic>.<xref rid="dyab177-B8" ref-type="bibr"><sup>8</sup></xref> can accommodate heterogeneity, through specification of a random effect or a hierarchical distribution if using a Bayesian approach. In practice, however, they may not be able to provide accurate results if there are not enough data to estimate such heterogeneity, for example when there are too many random effects relative to the number of datasets.<xref rid="dyab177-B4" ref-type="bibr"><sup>4</sup></xref><sup>,</sup><xref rid="dyab177-B6" ref-type="bibr"><sup>6</sup></xref> Bayesian methods tend to perform better than classical methods in this situation, but such advantage may be limited if the Bayesian framework is only used for the imputation and not for the analysis model, such as in the Bayesian imputation approaches reviewed by Audigier <italic toggle="yes">et al.</italic><xref rid="dyab177-B8" ref-type="bibr"><sup>8</sup></xref></p>
    <p>In 2009, Jackson <italic toggle="yes">et al</italic>.<xref rid="dyab177-B9" ref-type="bibr"><sup>9</sup></xref> proposed an integrated Bayesian approach where the imputation of systematically and sporadically missing data is performed jointly with the analysis of interest, and uncertainty in the imputation is fully accounted for without the need to create multiple imputed datasets. This method has been rarely used in practice, likely due to the required knowledge of Bayesian methods and the lack of a package implementing it. Here we present a user-friendly freely available tool, BIMAM—Bayesian IMputation and Analysis Model—that makes this approach accessible to researchers unfamiliar with Bayesian statistics.</p>
    <p>We illustrate BIMAM using data from the European Community Respiratory Health Survey (ECRHS),<xref rid="dyab177-B10" ref-type="bibr"><sup>10</sup></xref> a multicentre study part of the ALEC project. We empirically demonstrate BIMAM performance by artificially dropping variables in some centres and comparing the results after imputation with the results of the analysis of the original complete data (‘gold-standard’). We also compare BIMAM with two other imputation approaches, selected following the recommendations in Audigier <italic toggle="yes">et al</italic>.<xref rid="dyab177-B8" ref-type="bibr"><sup>8</sup></xref> based on number and size of the clusters: the classical FCS-2stage method by Resche-Rigon and White<xref rid="dyab177-B5" ref-type="bibr"><sup>5</sup></xref> for the imputation of both continuous and binary variables, and a combination of the FCS-2stage method and the Bayesian imputation method by Quartagno <italic toggle="yes">et al</italic>.<xref rid="dyab177-B7" ref-type="bibr"><sup>7</sup></xref> for the imputation of continuous and binary variables, respectively.</p>
  </sec>
  <sec>
    <title>Implementation</title>
    <sec>
      <title>BIMAM model</title>
      <p>The Bayesian approach by Jackson <italic toggle="yes">et al</italic>.,<xref rid="dyab177-B9" ref-type="bibr"><sup>9</sup></xref> with imputation and analysis of interest fitted jointly, was originally described in a scenario of a binary outcome analysed using two datasets, with two categorical risk factors missing in one of them. We generalized it to: analyse both continuous and binary outcomes; impute any number of binary or continuous variables missing across any number of datasets; account for heterogeneity for all variables in both imputation and analysis models. The multilevel structure of the data is reflected in a hierarchical formulation of the imputation and analysis models, and sporadically and systematically missing data are imputed simultaneously.</p>
      <p>The parameters of interest are estimated by an iterative Markov Chain Monte Carlo (MCMC) process based on Gibbs sampling, using the MultiBUGS package.<xref rid="dyab177-B11" ref-type="bibr"><sup>11</sup></xref> Binary variables are imputed as latent normal variables using a probit link, and all variables (binary and continuous) are imputed jointly using a multivariate normal distribution. Non-informative prior distributions are used for all parameters. Details on the approach are reported in the <xref rid="sup1" ref-type="supplementary-material">Supplementary material</xref>, available as <xref rid="sup1" ref-type="supplementary-material">Supplementary data at <italic toggle="yes">IJE</italic> online.</xref></p>
      <p>Estimates for the parameters of interest in the analysis model correspond to the mean (or median) of the posterior distribution of the parameter, and 95% credibility intervals (95% CrI), the Bayesian analogous to the classical 95% confidence intervals (95% CI), correspond to the 2.5th and 97.5th percentiles of such distribution.</p>
    </sec>
    <sec>
      <title>BIMAM tool</title>
      <p>BIMAM is a stand-alone user-friendly tool with instructions provided at each step, and is freely available at [<ext-link xlink:href="https://www.alecstudy.org/bimam" ext-link-type="uri">www.alecstudy.org/bimam</ext-link>]. Screenshots of the tool are shown on page 13 of the <xref rid="sup1" ref-type="supplementary-material">Supplementary material</xref>. After uploading the dataset, a summary is provided which identifies variables with missing data. Using a drop-down list, the user is asked to specify: (i) the clustering variable (e.g. centre, study); (ii) outcome and covariates for both imputation and analysis models; (iii) for each covariate in both models, whether it is modelled as fixed or random effect. To run the MCMC analysis, the user also needs to specify: (a) length of ‘burn-in’ (initial iterations that are discarded to avoid any influence of the initial values on the results); (b) number of ‘updates’ (iterations used in the analysis—the larger the updates, the more accurate the results); (c) number of chains (number of separate MCMCs, used to assess model convergence). Initial values for all parameters are assigned by the tool (see page 3 of the <xref rid="sup1" ref-type="supplementary-material">Supplementary material</xref>). To speed convergence, BIMAM standardizes all variables (binary and continuous covariates and outcome) in both imputation and analysis models, with the exception of binary missing variables that are imputed as zeros and ones; all the regression coefficients of standardized covariates are then automatically ‘unstandardized’ back (details reported on page 4 of the <xref rid="sup1" ref-type="supplementary-material">Supplementary material</xref>). Together with the results, the tool shows the model running time as well as warning messages with recommendations: if the accuracy of the results is too low, → suggestion to increase number of updates if MCMC error (simulation error) &gt;5% of the standard error of any parameter of interest; if convergence is not reached, → suggestion to increase burn-in period if Gelman-Rubin statistic (R-hat) &gt;1.1.<xref rid="dyab177-B12" ref-type="bibr"><sup>12</sup></xref> For users not familiar with Bayesian methods, meaning and implications of MCMC settings, MCMC error and R-hat are very briefly explained in pop-up windows next to the related field and in more detail in the online BIMAM manual. The results output presents the beta coefficients of all variables in the analysis model in a downloadable table, with posterior estimate, standard error and 95% CrI as well as MCMC error and R-hat. Advanced users can view and save the diagnostic plots (trace and density plots), and save the CODA files.</p>
    </sec>
  </sec>
  <sec>
    <title>Use</title>
    <sec>
      <title>BIMAM implementation and comparison with other approaches using ECRHS data</title>
      <p>Using ECRHS data, we consider a linear regression model estimating the association of smoking (ever vs never), weight (kg), sex (female vs male), height (cm) and age (years) with a spirometric measure of airway obstruction, the ratio of forced expiratory volume in 1 s over forced vital capacity (FEV<sub>1</sub>/FVC, expressed as %). Starting with complete data from a sample of 6613 subjects from 10 ECRHS centres of size between 521 and 1047 (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table</xref>, available as <xref rid="sup1" ref-type="supplementary-material">Supplementary data at <italic toggle="yes">IJE</italic> online</xref>), we artificially dropped weight (continuous) from one centre, smoking status (binary) from another, and both variables from three centres. Each missing variable was then imputed using a model that included all other covariates except for the other missing variable, as well as the outcome. Since peculiarities in the centres with missing variables may influence the results, to exclude the play of chance we considered 20 different scenarios, created from the complete data by randomly changing the five centres with dropped variables. Overall estimates for the beta coefficient of all risk factors in the analysis model were then obtained by averaging over the 20 different scenarios using the Rubin’s rule.</p>
      <p>On the 20 scenarios, we also applied:
</p>
      <list list-type="bullet">
        <list-item>
          <p>same Bayesian hierarchical model as BIMAM analysis model on the complete data (gold standard), using MultiBUGS;</p>
        </list-item>
        <list-item>
          <p>same as above, but after dropping centres with missing variables (naïve analysis);</p>
        </list-item>
        <list-item>
          <p>classical FCS-2stage method for imputation of both continuous (weight) and binary (smoking) variables. This method, based on the two-stage estimator described for IPD meta-analysis,<xref rid="dyab177-B13" ref-type="bibr"><sup>13</sup></xref> was proposed by Resche-Rigon and White<xref rid="dyab177-B5" ref-type="bibr"><sup>5</sup></xref> and modified in Audigier <italic toggle="yes">et al</italic>.<xref rid="dyab177-B8" ref-type="bibr"><sup>8</sup></xref>; we implemented it using the 2l.stage commands of the <italic toggle="yes">micemd</italic> R package [<ext-link xlink:href="https://cran.r-project.org/web/packages/micemd/micemd.pdf" ext-link-type="uri">https://cran.r-project.org/web/packages/micemd/micemd.pdf</ext-link>];</p>
        </list-item>
        <list-item>
          <p>FCS-2stage method for imputation of weight (continuous) and the Bayesian JM imputation method based on conjugate prior distributions by Quartagno <italic toggle="yes">et al</italic>.<xref rid="dyab177-B7" ref-type="bibr"><sup>7</sup></xref> for imputation of smoking (binary), again using the <italic toggle="yes">micemd</italic> R package.</p>
        </list-item>
      </list>
      <p>For both the FCS-2stage and the FCS-2stage/jomo approaches, we generated 20 imputed datasets, the results of which were combined using Rubin’s rules and compared with those of the gold standard, naïve analysis and BIMAM. For both approaches, a classical multilevel model (<italic toggle="yes">lmer</italic> R package) was used for the analysis model.</p>
      <p>For all methods, we allowed for between-centre heterogeneity in all variables of the imputation and analysis models, since heterogeneity is expected in the international ECRHS study.</p>
      <p>All analyses were performed in R version 3.3.2, including the Bayesian analyses for jomo (using the <italic toggle="yes">micemd</italic> package) and for BIMAM (using <italic toggle="yes">R2MultiBUGS</italic> to run MultiBUGS). For the Bayesian analyses, the length of burn-in was increased as needed to achieve convergence, assessed using R-hat (&lt;1.1) as well as visual inspection of trace, autocorrelation and density plots; the number of updates was decided based on MCMC error (&lt;5%). Further details and BUGS code for BIMAM are reported in the <xref rid="sup1" ref-type="supplementary-material">Supplement, available at <italic toggle="yes">IJE</italic> online</xref>.</p>
      <p>Results for the association of the risk factors with FEV<sub>1</sub>/FVC, averaged over the 20 scenarios, are graphically compared across methods in <xref rid="dyab177-F1" ref-type="fig">Figure 1</xref>. Compared with the gold standard, point estimates showed little evidence of bias for any of the methods, but the methods differed in terms of precision. BIMAM performed better than the naïve analysis, with substantially narrower 95% CrI for all variables except smoking. FCS-2stage and FCS-2stage/jomo performed similarly to BIMAM, except for the effect estimate of height, where the two methods gave much wider confidence intervals. To a much lesser extent, this was also found for sex and age. Visual inspection of the results across the 20 scenarios for height showed that this was due to very unstable estimates in a couple of scenarios, in contrast with the stability of the results for BIMAM. This is shown for height in <xref rid="dyab177-F2" ref-type="fig">Figure 2</xref> and for the other variables in the <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure</xref>, available as <xref rid="sup1" ref-type="supplementary-material">Supplementary data at <italic toggle="yes">IJE</italic> online</xref>. Interestingly, by applying the FCS-2stage and FCS-2stage/jomo imputation approaches followed by the same Bayesian analysis model used in BIMAM, as opposed to the classical multilevel analysis used in the <italic toggle="yes">micemd</italic> package, we found that the advantage of BIMAM was largely explained by the Bayesian hierarchical framework used for the analysis model (<xref rid="dyab177-F1" ref-type="fig">Figure 1</xref>); this was confirmed by the higher stability of results across scenarios (<xref rid="dyab177-F2" ref-type="fig">Figure 2</xref>; <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure</xref>, available as <xref rid="sup1" ref-type="supplementary-material">Supplementary data at <italic toggle="yes">IJE</italic> online</xref>).</p>
      <fig position="float" id="dyab177-F1">
        <label>Figure 1</label>
        <caption>
          <p>Beta coefficient and 95% CI or 95% CrI for the association of all risk factors with FEV1/FVC averaged over the 20 scenarios, for all methods. Coefficients for weight, height and age were multiplied by 10 (referring to increase of 10 kg, 10 cm and 10 years, respectively). CI: confidence interval; CrI: credibility interval; FEV1/FVC: ratio of forced expiratory volume in 1 s over forced vital capacity (expressed as %); FCS: fully conditional specification; BIMAM: Bayesian IMputation and Analysis Model</p>
        </caption>
        <graphic xlink:href="dyab177f1" position="float"/>
      </fig>
      <fig position="float" id="dyab177-F2">
        <label>Figure 2</label>
        <caption>
          <p>Beta coefficient and 95% CI or 95% CrI for the association of height with FEV1/FVC across the 20 scenarios, for all methods. The coefficient for height was multiplied by 10 (referring to increase of 10 cm). CI: confidence interval; CrI: credibility interval; FEV1/FVC: ratio of forced expiratory volume in 1 s over forced vital capacity (expressed as %); FCS: fully conditional specification; BIMAM: Bayesian IMputation and Analysis Model</p>
        </caption>
        <graphic xlink:href="dyab177f2" position="float"/>
      </fig>
      <p>The computational time for BIMAM, which was much reduced by using MultiBUGS as opposed to OpenBUGS and by standardizing all variables, was in line with the other methods: 11 min against 3 min for FCS-2stage and 20 min for the FCS-2stage/jomo.</p>
    </sec>
  </sec>
  <sec>
    <title>Conclusions</title>
    <p>With the aim of increasing statistical power, modern epidemiology is moving from the analysis of single datasets by individual research groups to collaborative work with combined analysis of multiple datasets. The missingness of variables of interest in some of the datasets is commonly dealt with by either excluding such variables, thus impairing the performance of the final model, or excluding studies that have not measured them, thus reducing sample size and power. If a missing at random assumption is reasonable, imputation of missing variables across datasets should always be considered, and packages to implement multilevel methods to do this are available. However, problems may arise when fully allowing for heterogeneity in both imputation and analysis models if the number of datasets is small relative to the number of random effects required. This is the case in our example, where we show some instability of the results from the two imputation methods recommended based on number and size of clusters,<xref rid="dyab177-B8" ref-type="bibr"><sup>8</sup></xref> the classical FCS-2stage and a combination of the FCS-2stage with the Bayesian jomo (for imputation of continuous and binary variables, respectively), which might result in wide confidence intervals for the coefficients of the analysis model. The Bayesian approach implemented in BIMAM, where imputation and analysis models are performed jointly, outperformed them and showed higher stability of the results. The problem of instability in the results from FCS-2stage and FCS-2stage/jomo approaches seemed to be largely solved by using a Bayesian hierarchical model instead of a classical multilevel model for the analysis of interest. This, however, is not implemented in the R packages available for these two approaches and requires experience with Bayesian methods. On the contrary, BIMAM is a user-friendly tool that does not require familiarity with Bayesian statistics and works very well when fully allowing for heterogeneity across a relatively small number of datasets.</p>
  </sec>
  <sec>
    <title>Supplementary Data</title>
    <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">IJE</italic> online</p>
  </sec>
  <sec>
    <title>Ethics approval</title>
    <p>The ECRHS study, which is the source of the example dataset used in this paper, was performed with the approval of the corresponding local/regional committees for all participating centres, and with written informed consent obtained from all participants.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>This project has received funding from the European Union’s Horizon 2020 research and innovation programme under grant agreement No 633212.</p>
  </sec>
  <sec sec-type="data-availability">
    <title>Data availability</title>
    <p>The ECRHS dataset used to illustrate the application of BIMAM in this paper, and used as an example in the online manual, is available in the BIMAM tool at [<ext-link xlink:href="http://www.alecstudy.org/bimam" ext-link-type="uri">www.alecstudy.org/bimam</ext-link>].</p>
  </sec>
  <sec>
    <title>Author Contributions</title>
    <p>F.E. contributed to the design of the study, analysis and interpretation of data, development of the online tool and drafting of the paper; A.A. and J.Pa. contributed to the analysis and interpretation of data and testing of the online tool; L.P. contributed to the analysis and interpretation of data; J.Po. contributed to the acquisition of data and testing of the online tool; M.B. contributed to the design of the study and interpretation of data; J.T. contributed to the concept and design of the study and interpretation of data; C.M. contributed to the concept and design of the study, interpretation of data and drafting of the paper. All the authors critically revised the paper and approved the final version.</p>
  </sec>
  <sec>
    <title>Conflict of Interest</title>
    <p>None declared.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>dyab177_Supplementary_Data</label>
      <media xlink:href="dyab177_supplementary_data.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="dyab177-B1">
      <label>1</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Harel</surname><given-names>O</given-names></string-name>, <string-name><surname>Mitchell</surname><given-names>EM</given-names></string-name>, <string-name><surname>Perkins</surname><given-names>NJ</given-names></string-name></person-group><etal>et al</etal><article-title>Multiple imputation for incomplete data in epidemiologic studies</article-title>. <source>Am J Epidemiol</source><year>2018</year>;<volume>187</volume>:<fpage>576</fpage>–<lpage>84</lpage>.<pub-id pub-id-type="pmid">29165547</pub-id></mixed-citation>
    </ref>
    <ref id="dyab177-B2">
      <label>2</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>White</surname><given-names>IR</given-names></string-name>, <string-name><surname>Royston</surname><given-names>P</given-names></string-name>, <string-name><surname>Wood</surname><given-names>AM.</given-names></string-name></person-group><article-title>Multiple imputation using chained equations: issues and guidance for practice</article-title>. <source>Stat Med</source><year>2011</year>;<volume>30</volume>:<fpage>377</fpage>–<lpage>99</lpage>.<pub-id pub-id-type="pmid">21225900</pub-id></mixed-citation>
    </ref>
    <ref id="dyab177-B3">
      <label>3</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Jolani</surname><given-names>S.</given-names></string-name></person-group><article-title>Hierarchical imputation of systematically and sporadically missing data: an approximate Bayesian approach using chained equations</article-title>. <source>Biom J</source><year>2018</year>;<volume>60</volume>:<fpage>333</fpage>–<lpage>51</lpage>.<pub-id pub-id-type="pmid">28990686</pub-id></mixed-citation>
    </ref>
    <ref id="dyab177-B4">
      <label>4</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Jolani</surname><given-names>S</given-names></string-name>, <string-name><surname>Debray</surname><given-names>TP</given-names></string-name>, <string-name><surname>Koffijberg</surname><given-names>H</given-names></string-name>, <string-name><surname>van Buuren</surname><given-names>S</given-names></string-name>, <string-name><surname>Moons</surname><given-names>KG.</given-names></string-name></person-group><article-title>Imputation of systematically missing predictors in an individual participant data meta-analysis: a generalized approach using MICE</article-title>. <source>Stat Med</source><year>2015</year>;<volume>34</volume>:<fpage>1841</fpage>–<lpage>63</lpage>.<pub-id pub-id-type="pmid">25663182</pub-id></mixed-citation>
    </ref>
    <ref id="dyab177-B5">
      <label>5</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Resche-Rigon</surname><given-names>M</given-names></string-name>, <string-name><surname>White</surname><given-names>IR.</given-names></string-name></person-group><article-title>Multiple imputation by chained equations for systematically and sporadically missing multilevel data</article-title>. <source>Stat Methods Med Res</source><year>2018</year>;<volume>27</volume>:<fpage>1634</fpage>–<lpage>49</lpage>.<pub-id pub-id-type="pmid">27647809</pub-id></mixed-citation>
    </ref>
    <ref id="dyab177-B6">
      <label>6</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Resche-Rigon</surname><given-names>M</given-names></string-name>, <string-name><surname>White</surname><given-names>IR</given-names></string-name>, <string-name><surname>Bartlett</surname><given-names>JW</given-names></string-name>, <string-name><surname>Peters</surname><given-names>SA</given-names></string-name>, <string-name><surname>Thompson</surname><given-names>SG</given-names></string-name></person-group>; PROG-IMT Study Group. <article-title>Multiple imputation for handling systematically missing confounders in meta-analysis of individual participant data</article-title>. <source>Stat Med</source><year>2013</year>;<volume>32</volume>:<fpage>4890</fpage>–<lpage>905</lpage>.<pub-id pub-id-type="pmid">23857554</pub-id></mixed-citation>
    </ref>
    <ref id="dyab177-B7">
      <label>7</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Quartagno</surname><given-names>M</given-names></string-name>, <string-name><surname>Carpenter</surname><given-names>JR.</given-names></string-name></person-group><article-title>Multiple imputation for IPD meta-analysis: allowing for heterogeneity and studies with missing covariates</article-title>. <source>Stat Med</source><year>2016</year>;<volume>35</volume>:<fpage>2938</fpage>–<lpage>54</lpage>.<pub-id pub-id-type="pmid">26681666</pub-id></mixed-citation>
    </ref>
    <ref id="dyab177-B8">
      <label>8</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Audigier</surname><given-names>V</given-names></string-name>, <string-name><surname>White</surname><given-names>I</given-names></string-name>, <string-name><surname>Jolani</surname><given-names>S</given-names></string-name></person-group><etal>et al</etal><article-title>Multiple imputation for multilevel data with continuous and binary variables</article-title>. <source>Stat Sci</source><year>2018</year>;<volume>33</volume>:<fpage>160</fpage>–<lpage>83</lpage>.</mixed-citation>
    </ref>
    <ref id="dyab177-B9">
      <label>9</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Jackson</surname><given-names>CH</given-names></string-name>, <string-name><surname>Best</surname><given-names>NG</given-names></string-name>, <string-name><surname>Richardson</surname><given-names>S.</given-names></string-name></person-group><article-title>Bayesian graphical models for regression on multiple data sets with different variables</article-title>. <source>Biostatistics</source><year>2009</year>;<volume>10</volume>:<fpage>335</fpage>–<lpage>51</lpage>.<pub-id pub-id-type="pmid">19039032</pub-id></mixed-citation>
    </ref>
    <ref id="dyab177-B10">
      <label>10</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Burney</surname><given-names>PG</given-names></string-name>, <string-name><surname>Luczynska</surname><given-names>C</given-names></string-name>, <string-name><surname>Chinn</surname><given-names>S</given-names></string-name>, <string-name><surname>Jarvis</surname><given-names>D.</given-names></string-name></person-group><article-title>The European Community Respiratory Health Survey</article-title>. <source>Eur Respir J</source><year>1994</year>;<volume>7</volume>:<fpage>954</fpage>–<lpage>60</lpage>.<pub-id pub-id-type="pmid">8050554</pub-id></mixed-citation>
    </ref>
    <ref id="dyab177-B11">
      <label>11</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Goudie</surname><given-names>RJB</given-names></string-name>, <string-name><surname>Turner</surname><given-names>RM</given-names></string-name>, <string-name><surname>De Angelis</surname><given-names>D</given-names></string-name>, <string-name><surname>Thomas</surname><given-names>A.</given-names></string-name></person-group><article-title>MultiBUGS: a parallel implementation of the BUGS modelling framework for faster Bayesian inference</article-title>. <source>J Stat Softw</source><year>2020</year>;<volume>95</volume>: <fpage>7</fpage>.<pub-id pub-id-type="pmid">33071678</pub-id></mixed-citation>
    </ref>
    <ref id="dyab177-B12">
      <label>12</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Brooks</surname><given-names>S</given-names></string-name>, <string-name><surname>Gelman</surname><given-names>A.</given-names></string-name></person-group><article-title>General methods for monitoring convergence of iterative simulations</article-title>. <source>J Comput Graph Stat</source><year>1998</year>;<volume>7</volume>:<fpage>434</fpage>–<lpage>55</lpage>.</mixed-citation>
    </ref>
    <ref id="dyab177-B13">
      <label>13</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Riley</surname><given-names>RD</given-names></string-name>, <string-name><surname>Lambert</surname><given-names>PC</given-names></string-name>, <string-name><surname>Staessen</surname><given-names>JA</given-names></string-name></person-group><etal>et al</etal><article-title>Meta-analysis of continuous outcomes combining individual patient data and aggregate data</article-title>. <source>Stat Med</source><year>2008</year>;<volume>27</volume>:<fpage>1870</fpage>–<lpage>93</lpage>.<pub-id pub-id-type="pmid">18069721</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
