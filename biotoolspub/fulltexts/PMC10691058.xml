<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10691058</article-id>
    <article-id pub-id-type="pmid">38036969</article-id>
    <article-id pub-id-type="publisher-id">5566</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-023-05566-9</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>PMFFRC: a large-scale genomic short reads compression optimizer via memory modeling and redundant clustering</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Sun</surname>
          <given-names>Hui</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Zheng</surname>
          <given-names>Yingfeng</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Xie</surname>
          <given-names>Haonan</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ma</surname>
          <given-names>Huidong</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Liu</surname>
          <given-names>Xiaoguang</given-names>
        </name>
        <address>
          <email>liuxg@nbjl.nankai.edu.cn</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Wang</surname>
          <given-names>Gang</given-names>
        </name>
        <address>
          <email>adairmillersh@gmail.com</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/01y1kjr75</institution-id><institution-id institution-id-type="GRID">grid.216938.7</institution-id><institution-id institution-id-type="ISNI">0000 0000 9878 7032</institution-id><institution>Nankai-Baidu Joint Laboratory, College of Computer Science, </institution><institution>Nankai University, </institution></institution-wrap>Tianjin, China </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/02c9qn167</institution-id><institution-id institution-id-type="GRID">grid.256609.e</institution-id><institution-id institution-id-type="ISNI">0000 0001 2254 5798</institution-id><institution>Institute of Artificial Intelligence, School of Electrical Engineering, </institution><institution>Guangxi University, </institution></institution-wrap>Nanning, China </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>30</day>
      <month>11</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>30</day>
      <month>11</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2023</year>
    </pub-date>
    <volume>24</volume>
    <elocation-id>454</elocation-id>
    <history>
      <date date-type="received">
        <day>12</day>
        <month>9</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>13</day>
        <month>11</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">Genomic sequencing reads compressors are essential for balancing high-throughput sequencing short reads generation speed, large-scale genomic data sharing, and infrastructure storage expenditure. However, most existing short reads compressors rarely utilize big-memory systems and duplicative information between diverse sequencing files to achieve a higher compression ratio for conserving reads data storage space.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">We employ compression ratio as the optimization objective and propose a large-scale genomic sequencing short reads data compression optimizer, named PMFFRC, through novelty memory modeling and redundant reads clustering technologies. By cascading PMFFRC, in 982 GB fastq format sequencing data, with 274 GB and 3.3 billion short reads, the state-of-the-art and reference-free compressors HARC, SPRING, Mstcom, and FastqCLS achieve 77.89%, 77.56%, 73.51%, and 29.36% average maximum compression ratio gains, respectively. PMFFRC saves 39.41%, 41.62%, 40.99%, and 20.19% of storage space sizes compared with the four unoptimized compressors.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p id="Par3">PMFFRC rational usage big-memory of compression server, effectively saving the sequencing reads data storage space sizes, which relieves the basic storage facilities costs and community sharing transmitting overhead. Our work furnishes a novel solution for improving sequencing reads compression and saving storage space. The proposed PMFFRC algorithm is packaged in a same-name Linux toolkit, available un-limited at <ext-link ext-link-type="uri" xlink:href="https://github.com/fahaihi/PMFFRC">https://github.com/fahaihi/PMFFRC</ext-link>.</p>
      </sec>
      <sec>
        <title>Supplementary Information</title>
        <p>The online version contains supplementary material available at 10.1186/s12859-023-05566-9.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Short reads data</kwd>
      <kwd>Data compression</kwd>
      <kwd>Fastq</kwd>
      <kwd>Parallel algorithm</kwd>
    </kwd-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© BioMed Central Ltd., part of Springer Nature 2023</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par7">With the prosperity of next-generation sequencing (NGS) technologies, genomic sequencing data holds the characteristics of large data volumes, multiple files, and prosperous species sources [<xref ref-type="bibr" rid="CR1">1</xref>]. For example, until September 2023, through 829,822 sequencing times of 845,109 bio-samples, the bio-sequencing data compressed by the gzip (<ext-link ext-link-type="uri" xlink:href="http://www.gzip.org">http://www.gzip.org</ext-link>) in the CNGB Sequence Archive (<ext-link ext-link-type="uri" xlink:href="https://db.cngb.org/cnsa">https://db.cngb.org/cnsa</ext-link>) was up to 11,920 terabytes (TB), if stored in Amazon cloud at $0.125 each gigabyte (GB), will cost $1,525,760 per year. Therefore, compressing large-scale genomic sequencing data is essential in reducing the storage infrastructure construction expenditure and data transmission consumption, especially for sequencing reads, which account for 42% of the whole genomic sequencing data [<xref ref-type="bibr" rid="CR2">2</xref>, <xref ref-type="bibr" rid="CR3">3</xref>].</p>
    <p id="Par8">Different from ordinary textual data (such as big social data), genomic reads data has the following bioinformatic attributes. (i) The formatting of reads characters is uncomplicated, which consists of the alphabet Σ = {A, C, G, T, N} simply. (ii) The redundancy reads data is high, mainly relying on sequencing coverage of diverse platforms. (iii) Homologous species reads data retains heightened similitude. Recently, reference-based and reference-free dedicated genomic sequencing reads compressors have been proposed by taking full advantage of reads' bioinformatic attributes [<xref ref-type="bibr" rid="CR4">4</xref>, <xref ref-type="bibr" rid="CR5">5</xref>].</p>
    <p id="Par9">The first category, of reference-based compressors, acquires the position details of reads in the reference genome via sequence alignment technology to achieve redundant substrings replacement, such as RENANO [<xref ref-type="bibr" rid="CR6">6</xref>], HRCM [<xref ref-type="bibr" rid="CR7">7</xref>], and NRGC [<xref ref-type="bibr" rid="CR8">8</xref>]. Reference-based methods are more helpful in compressing reference-matched reads, but their high compression ratio relies on reference genome selection. In contrast to reference-free compressors, the weaknesses of reference-based approaches can be summarized as follows. (i) Selecting an appropriate reference genome for a target dataset to be compressed can be challenging, and using a mismatched reference genome may result in inferior compression performance. (ii) Reference-based methods incorporate additional knowledge for encoding and decoding. This flexibility-limited technology hinders compressed data sharing and the widespread adoption of compressors. (iii) Aligning short reads data to a selected reference genome is a CPU-intensive and memory-unfriendly computational process, which demands higher time and memory consumption. However, in contrast, reference-free compressors utilize reads' redundant details and character formatting attributes for compression optimization, which have heightened application prospects in multi-species reads compression, such as Quip(-a) [<xref ref-type="bibr" rid="CR9">9</xref>], BEETL [<xref ref-type="bibr" rid="CR10">10</xref>], DSR2C [<xref ref-type="bibr" rid="CR11">11</xref>], FQSqueezer [<xref ref-type="bibr" rid="CR12">12</xref>], and NanoSpring [<xref ref-type="bibr" rid="CR13">13</xref>]. Here, we will introduce some state-of-the-art and reference-free short reads compressors relevant to our work. See references [<xref ref-type="bibr" rid="CR4">4</xref>] and [<xref ref-type="bibr" rid="CR5">5</xref>] for more detailed reviews of fastq format genomic sequencing reads data compressors.</p>
    <p id="Par10">HARC [<xref ref-type="bibr" rid="CR14">14</xref>] reorders short reads via their genome position details and then removes the redundancy sub-strings between consecutive reads, which achieves 1.4–2 × compression ratio improvement over Orcom [<xref ref-type="bibr" rid="CR15">15</xref>] and Leon [<xref ref-type="bibr" rid="CR16">16</xref>] in 3 billion Illumina short reads data. From the same research team, SPRING [<xref ref-type="bibr" rid="CR17">17</xref>] enhances HARC by supporting variable-length reads and handles all fastq streams. In their experiment, SPRING compresses 195 GB of 25 × whole genome human data from Illumina’s NovaSeq platform to 7 GB, around 1.6 × smaller than Fastore [<xref ref-type="bibr" rid="CR18">18</xref>].</p>
    <p id="Par11">PgRC [<xref ref-type="bibr" rid="CR19">19</xref>] assembles pseudo-genomes through approximate common superstring reads and then encodes them by reads' mapping sites on the pseudo-genome, which bests in compression ratio over Minicom [<xref ref-type="bibr" rid="CR20">20</xref>] and SPRING by up to 20% and 15% on average, respectively. CURC [<xref ref-type="bibr" rid="CR21">21</xref>] improves PgRC by CPU and GPU collaborative computing, which achieves 2.76–3.14× and 4.15–6.54× speedup in compression and 1.26–1.65× and 1.6–2.52× decompression speedup compared with SPRING and PgRC on 18 single-end and 13 paired-end sequencing datasets.</p>
    <p id="Par12">Mstcom [<xref ref-type="bibr" rid="CR22">22</xref>] introduces the concept of Hamming-shifting graphs to encode similar redundant reads and employ compressors BSC (<ext-link ext-link-type="uri" xlink:href="http://libbsc.com">http://libbsc.com</ext-link>) and LZMA (<ext-link ext-link-type="uri" xlink:href="http://www.7zip.org">http://www.7zip.org</ext-link>) for compressing the encoded file streams. Like Coil [<xref ref-type="bibr" rid="CR23">23</xref>] and ReCoil [<xref ref-type="bibr" rid="CR24">24</xref>], Mstcom reduces redundant information by cross-referencing similar reads. Because the similarity comparison between different string reads is time-consuming, such methods consume more time and memory space. The compression performance of Mstcom can be 10–30% better than SPRING, Minicom, and PgRC on 14 single-end and 7 paired-end datasets.</p>
    <p id="Par13">FastqCLS [<xref ref-type="bibr" rid="CR25">25</xref>] is the latest compressor, handy for compressing long and short genomic sequencing reads. It first extracts the features of reads via a novel scoring model and reorders them according to the numeral eigenvalues. Once the similarity reads are aggregated, the reads are compressed by the general-purpose compressor ZPAQ (<ext-link ext-link-type="uri" xlink:href="http://mattmahoney.net/dc/zpaq.html">http://mattmahoney.net/dc/zpaq.html</ext-link>) to improve the overall compression ratio. The experimental results on the MPEG [<xref ref-type="bibr" rid="CR2">2</xref>] and LFastqC [<xref ref-type="bibr" rid="CR26">26</xref>] benchmark datasets demonstrate that FastqCLS achieves compression ratios of 2.28–3.37 for long reads datasets, and 4.01–17.17 for short reads datasets. Compared with the pure ZPAQ compressor, FastqCLS achieves an average compression ratio boost of 4% (up to 18%) via the reads scoring model.</p>
    <p id="Par14">According to our investigation, existing reference-free short reads compressors rarely use redundancy information between different fastq files and large equipment memory in actual compression scenes to improve compression ratio. For example, in medium and long-term genomic data backup systems, the memory of the compression server often reaches hundreds or thousands of gigabytes (GB). Suppose the peak memory of the compressor holds only hundreds of megabytes (MB). In that case, it has advantages in memory usage but is ineffective for large memory to improve the compression ratio in multi-fastq files. To this end, we take the genomic sequencing reads compression ratio as the optimization objective and propose a large-scale reads compression optimization method named PMFFRC (Parallel Multi-Fastq-File Reads Clustering). The experimental results of actual 982 GB fastq format sequencing data, with the size of 274 GB and 3.3 billion reads, show that the average maximum compression ratio gains of compressors HARC, SPRING, Mstcom, and FastqCLS optimized by PMFFRC are 77.89%, 77.56%, 73.51%, and 29.36%, respectively. The maximum percent storage savings of the four cascaded compressors are 39.41%, 41.62%, 40.99%, and 20.19%, respectively. In the current version, the PMFFRC optimizer only compresses short reads, which accepts a folder containing multiple fastq files and outputs a compressed file *.pmffrc.</p>
  </sec>
  <sec id="Sec2">
    <title>Implementation</title>
    <p id="Par15">Let <italic>F</italic> = {<italic>F</italic><sub>0</sub>, <italic>F</italic><sub>1</sub>, …, <italic>F</italic><sub><italic>v</italic>-1</sub>} denotes a group of fastq files, <italic>R</italic><sub><italic>i</italic></sub> = {<inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${R}_{0}^{i}, {R}_{1}^{i}, {R}_{2}^{i}, \dots ,$$\end{document}</tex-math><mml:math id="M2"><mml:mrow><mml:msubsup><mml:mi>R</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mi>i</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>R</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mi>i</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>R</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mi>i</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5566_Article_IEq1.gif"/></alternatives></inline-formula>
<inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${R}_{\left(\left|{F}_{i}\right|/4\right)-1}^{i}$$\end{document}</tex-math><mml:math id="M4"><mml:msubsup><mml:mi>R</mml:mi><mml:mrow><mml:mfenced close=")" open="("><mml:mfenced close="|" open="|"><mml:msub><mml:mi>F</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfenced><mml:mo stretchy="false">/</mml:mo><mml:mn>4</mml:mn></mml:mfenced><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>i</mml:mi></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2023_5566_Article_IEq2.gif"/></alternatives></inline-formula>} denotes a collection of string short reads in the <italic>i</italic>-th fastq sequencing file, |<italic>F</italic><sub><italic>i</italic></sub>| denotes the number of lines in <italic>F</italic><sub><italic>i</italic></sub>, <italic>n</italic> denotes the average length of sequencing reads, <italic>Y</italic> represents the cascaded optimization compressor, <italic>U</italic><sub><italic>ram</italic></sub> represents the user-preset safe memory threshold (less than system memory), and <italic>K</italic> represents the number of clusters, where <italic>i</italic> = 0, 1, 2, …, <italic>v</italic>-1. The proposed optimization method PMFFRC includes two parts: sequencing file clustering (Section “<xref rid="Sec4" ref-type="sec">Sequencing files clustering</xref>”), joint compression and decompression (Section “<xref rid="Sec9" ref-type="sec">Joint compression and decompression</xref>”). PMFFRC benefits from the redundant short reads information entropy of similar fastq format sequencing files. Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Section S1 gives more details for theoretical entropy analysis.</p>
    <sec id="Sec3">
      <title>Sequencing files clustering</title>
      <p id="Par16">The PMFFRC optimizer achieves high compression ratios by clustering redundant reads together in different fastq files and increases cascaded compressor robustness by memory modeling. In the PMFFRC workflow, sequencing files clustering includes four stages. (i) Pre-compression: estimates the peak memory consumption on the overall fastq files by using random sampling technology. (ii) Feature extraction: converts short reads strings into numerical features, simplifying calculations and improving the optimization efficiency of PMFFRC. (iii) Similarity calculation: evaluates the similarity of each group file through the collection similarity assessment method. (iv) Fastq files clustering: ensures the algorithm robustness of the optimized compressor via a two-level clustering parameter selection strategy.</p>
      <sec id="Sec4">
        <title>Pre-compression</title>
        <p id="Par17">The purpose of pre-compression is to evaluate the maximum memory consumption of the compressed short reads data in dataset <italic>F</italic>. Let <italic>Y</italic><sub><italic>res</italic></sub> denotes the resident memory of compressor <italic>Y</italic> (such as dictionaries and hash tables), and <italic>Y</italic><sub><italic>reads</italic></sub> denotes the extra memory space opened for genomic sequencing reads. To evaluate compression peak memory <italic>Y</italic><sub><italic>cpm</italic></sub> = <italic>Y</italic><sub><italic>res</italic></sub> + <italic>Y</italic><sub><italic>reads</italic></sub> of <italic>Y</italic> on dataset <italic>F</italic>, PMFFRC performs the following steps:</p>
        <p id="Par18"><bold>Step 1</bold>: Randomly select <italic>x</italic><sub>1</sub> and <italic>x</italic><sub>2</sub> sets of sequencing data from <italic>F</italic><sub><italic>i</italic></sub> to construct pre-compression fastq files <italic>X</italic><sub>1</sub> = {<inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${x}_{0}^{1}$$\end{document}</tex-math><mml:math id="M6"><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mn>1</mml:mn></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2023_5566_Article_IEq3.gif"/></alternatives></inline-formula>, <inline-formula id="IEq4"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${x}_{1}^{1}$$\end{document}</tex-math><mml:math id="M8"><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mn>1</mml:mn></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2023_5566_Article_IEq4.gif"/></alternatives></inline-formula>, <inline-formula id="IEq5"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${x}_{2}^{1}$$\end{document}</tex-math><mml:math id="M10"><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mn>1</mml:mn></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2023_5566_Article_IEq5.gif"/></alternatives></inline-formula>, …, <inline-formula id="IEq6"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${x}_{{v\times x}_{1}-1}^{1}$$\end{document}</tex-math><mml:math id="M12"><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:msub><mml:mrow><mml:mi>v</mml:mi><mml:mo>×</mml:mo><mml:mi>x</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>1</mml:mn></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2023_5566_Article_IEq6.gif"/></alternatives></inline-formula>} and<italic> X</italic><sub>2</sub> = {<inline-formula id="IEq7"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${x}_{0}^{2}$$\end{document}</tex-math><mml:math id="M14"><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2023_5566_Article_IEq7.gif"/></alternatives></inline-formula>, <inline-formula id="IEq8"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${x}_{1}^{2}$$\end{document}</tex-math><mml:math id="M16"><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2023_5566_Article_IEq8.gif"/></alternatives></inline-formula>, <inline-formula id="IEq9"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${x}_{2}^{2}$$\end{document}</tex-math><mml:math id="M18"><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2023_5566_Article_IEq9.gif"/></alternatives></inline-formula>, …, <inline-formula id="IEq10"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${x}_{{v\times x}_{2}-1}^{2}$$\end{document}</tex-math><mml:math id="M20"><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:msub><mml:mrow><mml:mi>v</mml:mi><mml:mo>×</mml:mo><mml:mi>x</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2023_5566_Article_IEq10.gif"/></alternatives></inline-formula>}, each group <inline-formula id="IEq11"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${x}_{j}^{e}$$\end{document}</tex-math><mml:math id="M22"><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mi>e</mml:mi></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2023_5566_Article_IEq11.gif"/></alternatives></inline-formula> contains description information, sequencing reads, and quality scores, where <italic>j</italic> = 0, 1, 2, …, <italic>v</italic> × <italic>x</italic><sub><italic>e</italic></sub>-1, <italic>i</italic> = 0, 1, 2, …, <italic>v</italic>-1, <italic>x</italic><sub>2</sub> &gt;  &gt; <italic>x</italic><sub>1</sub> and <italic>e</italic> = 1, 2.</p>
        <p id="Par19"><bold>Step 2</bold>: Run compressor <italic>Y</italic> for pre-compressing datasets<italic> X</italic><sub>1</sub> and <italic>X</italic><sub>2</sub>, getting <italic>Y</italic>'s peak memory <inline-formula id="IEq12"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Y}_{peak}^{1}$$\end{document}</tex-math><mml:math id="M24"><mml:msubsup><mml:mi>Y</mml:mi><mml:mrow><mml:mi mathvariant="italic">peak</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2023_5566_Article_IEq12.gif"/></alternatives></inline-formula> and <inline-formula id="IEq13"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Y}_{peak}^{2}$$\end{document}</tex-math><mml:math id="M26"><mml:msubsup><mml:mi>Y</mml:mi><mml:mrow><mml:mi mathvariant="italic">peak</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2023_5566_Article_IEq13.gif"/></alternatives></inline-formula> on datasets <italic>X</italic><sub>1</sub> and <italic>X</italic><sub>2</sub>.</p>
        <p id="Par20"><bold>Step 3</bold>: Estimate the compression peak memory <italic>Y</italic><sub><italic>cpm</italic></sub> of algorithm <italic>Y</italic> on datasets <italic>F</italic> = {<italic>F</italic><sub>0</sub>, <italic>F</italic><sub>1</sub>, …, <italic>F</italic><sub><italic>v</italic>-1</sub>} according to the formula (<xref rid="Equ1" ref-type="disp-formula">1</xref>):<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Y_{cpm} = Y_{res} + Y_{reads} = Y_{peak}^{1} + \frac{{\left| {Y_{peak}^{2} - Y_{peak}^{1} } \right|}}{{v \times \left( {x_{2} - x_{1} } \right)}} \times \mathop \sum \limits_{i = 0}^{v} \frac{{\left| {F_{i} } \right|}}{4}$$\end{document}</tex-math><mml:math id="M28" display="block"><mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi mathvariant="italic">cpm</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi mathvariant="italic">res</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi mathvariant="italic">reads</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mi>Y</mml:mi><mml:mrow><mml:mi mathvariant="italic">peak</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:mfrac><mml:mfenced close="|" open="|"><mml:mrow><mml:msubsup><mml:mi>Y</mml:mi><mml:mrow><mml:mi mathvariant="italic">peak</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>-</mml:mo><mml:msubsup><mml:mi>Y</mml:mi><mml:mrow><mml:mi mathvariant="italic">peak</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msubsup></mml:mrow></mml:mfenced><mml:mrow><mml:mi>v</mml:mi><mml:mo>×</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mfrac><mml:mo>×</mml:mo><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mi>v</mml:mi></mml:munderover><mml:mfrac><mml:mfenced close="|" open="|"><mml:msub><mml:mi>F</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfenced><mml:mn>4</mml:mn></mml:mfrac></mml:mrow></mml:math><graphic xlink:href="12859_2023_5566_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula></p>
        <p id="Par21">In formula (<xref rid="Equ1" ref-type="disp-formula">1</xref>), |<italic>F</italic><sub><italic>i</italic></sub>|/4 denotes the total number of reads in <italic>F</italic><sub><italic>i</italic></sub>, where <italic>i</italic> = 0, 1, 2, …, <italic>v</italic>-1.</p>
      </sec>
      <sec id="Sec5">
        <title>Feature extraction</title>
        <p id="Par22">In pre-compression stage, PMFFRC estimated the maximum memory consumption <italic>Y</italic><sub><italic>cpm</italic></sub> of compressor <italic>Y</italic> on <italic>F</italic>. However, the calculated <italic>Y</italic><sub><italic>cpm</italic></sub> might exceed the system memory. Thus, PMFFRC compresses similar fastq files in batches via redundant reads clustering method, using reads' feature vectors and user-preset safe memory threshold. However, converting string reads to digitized feature vectors is time-consuming. Therefore, PMFFRC utilizes CPU multi-cores to accelerate this stage in parallel.</p>
        <p id="Par23">Let <italic>Pr</italic> denotes the number of utilized CPU cores, <inline-formula id="IEq14"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\overline{R} }_{i}$$\end{document}</tex-math><mml:math id="M30"><mml:msub><mml:mover><mml:mi>R</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5566_Article_IEq14.gif"/></alternatives></inline-formula>= [<inline-formula id="IEq15"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\dot{R}}_{0}^{i},{\dot{R}}_{1}^{i},{\dot{R}}_{2}^{i},\dots ,{\dot{R}}_{\left(\left|{F}_{i}\right|/4\right)-1}^{i}$$\end{document}</tex-math><mml:math id="M32"><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>R</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mi>i</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi>R</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mi>i</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi>R</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mi>i</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi>R</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mrow><mml:mfenced close=")" open="("><mml:mfenced close="|" open="|"><mml:msub><mml:mi>F</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfenced><mml:mo stretchy="false">/</mml:mo><mml:mn>4</mml:mn></mml:mfenced><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>i</mml:mi></mml:msubsup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5566_Article_IEq15.gif"/></alternatives></inline-formula>] denotes a numeral feature vector of <italic>R</italic><sub><italic>i</italic></sub>, and <inline-formula id="IEq16"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\dot{R}}_{j}^{i}$$\end{document}</tex-math><mml:math id="M34"><mml:msubsup><mml:mover accent="true"><mml:mi>R</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2023_5566_Article_IEq16.gif"/></alternatives></inline-formula> is the feature value of read <inline-formula id="IEq17"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${R}_{j}^{i}$$\end{document}</tex-math><mml:math id="M36"><mml:msubsup><mml:mi>R</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2023_5566_Article_IEq17.gif"/></alternatives></inline-formula>. Referring to the design idea of the reads scoring model in FastqCLS [<xref ref-type="bibr" rid="CR25">25</xref>], PMFFRC employs <italic>Pr</italic> CPU cores to extract sequencing reads feature values in parallel through the data cycle division strategy [<xref ref-type="bibr" rid="CR27">27</xref>], as shown in the formula (<xref rid="Equ2" ref-type="disp-formula">2</xref>):<disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\dot{R}_{j}^{i,p} = \mathop \prod \limits_{e = 0}^{3} \left( {\mathop \sum \limits_{r = 0}^{{\left| {R_{j}^{i,p} } \right|}} I\left( {R_{j}^{i,p} \left[ r \right] = E\left[ e \right]} \right) + 1} \right)/n$$\end{document}</tex-math><mml:math id="M38" display="block"><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>R</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:munderover><mml:mo movablelimits="false">∏</mml:mo><mml:mrow><mml:mi>e</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mn>3</mml:mn></mml:munderover><mml:mfenced close=")" open="("><mml:mrow><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mfenced close="|" open="|"><mml:msubsup><mml:mi>R</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:msubsup></mml:mfenced></mml:munderover><mml:mi>I</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msubsup><mml:mi>R</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:msubsup><mml:mfenced close="]" open="["><mml:mi>r</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:mi>E</mml:mi><mml:mfenced close="]" open="["><mml:mi>e</mml:mi></mml:mfenced></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced><mml:mo stretchy="false">/</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math><graphic xlink:href="12859_2023_5566_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula></p>
        <p id="Par24">In formula (<xref rid="Equ2" ref-type="disp-formula">2</xref>), <italic>E</italic> = {A, C, G, T}, <inline-formula id="IEq18"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I\left({R}_{j}^{i,p}\left[r\right]=E\left[e\right]\right)$$\end{document}</tex-math><mml:math id="M40"><mml:mrow><mml:mi>I</mml:mi><mml:mfenced close=")" open="("><mml:msubsup><mml:mi>R</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:msubsup><mml:mfenced close="]" open="["><mml:mi>r</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:mi>E</mml:mi><mml:mfenced close="]" open="["><mml:mi>e</mml:mi></mml:mfenced></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5566_Article_IEq18.gif"/></alternatives></inline-formula> is an indicator function, <italic>p</italic> denotes the <italic>p</italic>-th CPU core, and <italic>p</italic> = <italic>i</italic> % <italic>Pr</italic>, where <italic>j</italic> = 0, 1, 2, …,<inline-formula id="IEq19"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left(\left|{F}_{i}\right|/4\right)$$\end{document}</tex-math><mml:math id="M42"><mml:mfenced close=")" open="("><mml:mfenced close="|" open="|"><mml:msub><mml:mi>F</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfenced><mml:mo stretchy="false">/</mml:mo><mml:mn>4</mml:mn></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2023_5566_Article_IEq19.gif"/></alternatives></inline-formula>-1, <italic>i</italic> = 0, 1, 2, …, <italic>v</italic>-1.</p>
      </sec>
      <sec id="Sec6">
        <title>Similarity calculation</title>
        <p id="Par25">After obtaining the feature vector <inline-formula id="IEq20"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\overline{R} }_{i}$$\end{document}</tex-math><mml:math id="M44"><mml:msub><mml:mover><mml:mi>R</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5566_Article_IEq20.gif"/></alternatives></inline-formula>= [<inline-formula id="IEq21"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\dot{R}}_{0}^{i},{\dot{ R}}_{1}^{i},{ \dot{R}}_{2}^{i}, \dots ,{\dot{ R}}_{\left(\left|{F}_{i}\right|/4\right)-1}^{i}$$\end{document}</tex-math><mml:math id="M46"><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>R</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mi>i</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi>R</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mi>i</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi>R</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mi>i</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi>R</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mrow><mml:mfenced close=")" open="("><mml:mfenced close="|" open="|"><mml:msub><mml:mi>F</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfenced><mml:mo stretchy="false">/</mml:mo><mml:mn>4</mml:mn></mml:mfenced><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>i</mml:mi></mml:msubsup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5566_Article_IEq21.gif"/></alternatives></inline-formula>] of <italic>R</italic><sub><italic>i</italic></sub> in <italic>F</italic><sub><italic>i</italic></sub>, PMFFRC evaluates the redundant reads similarity between different fastq files. Let <italic>S</italic> denotes a similarity collection of feature vectors <inline-formula id="IEq22"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\overline{R} }_{a}$$\end{document}</tex-math><mml:math id="M48"><mml:msub><mml:mover><mml:mi>R</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mi>a</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5566_Article_IEq22.gif"/></alternatives></inline-formula> and <inline-formula id="IEq23"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\overline{R} }_{b}$$\end{document}</tex-math><mml:math id="M50"><mml:msub><mml:mover><mml:mi>R</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mi>b</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5566_Article_IEq23.gif"/></alternatives></inline-formula>. In practical scenarios, the data scale between <italic>F</italic><sub><italic>a</italic></sub> and <italic>F</italic><sub><italic>b</italic></sub> is unbalanced, usually. To offset the impact of fastq file size differences on similarity calculation between <italic>F</italic><sub><italic>a</italic></sub> and <italic>F</italic><sub><italic>b</italic></sub>, PMFFRC introduces correction parameters <italic>α</italic> and dice coefficient [<xref ref-type="bibr" rid="CR28">28</xref>], uses <italic>Pr</italic> CPU cores, and improves the parallel similarity calculation model as shown in formula (<xref rid="Equ3" ref-type="disp-formula">3</xref>):<disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$sim\left({\overline{R} }_{a}^{p},{\overline{R} }_{b}^{p}\right)=\alpha \times \frac{2\times \left|{\overline{R} }_{a}^{p}\cap {\overline{R} }_{b}^{p}\right|}{\left|{\overline{R} }_{a}^{p}\right|+\left|{\overline{R} }_{b}^{p}\right|}$$\end{document}</tex-math><mml:math id="M52" display="block"><mml:mrow><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>m</mml:mi><mml:mfenced close=")" open="("><mml:msubsup><mml:mover><mml:mi>R</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mi>p</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mover><mml:mi>R</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mi>p</mml:mi></mml:msubsup></mml:mfenced><mml:mo>=</mml:mo><mml:mi>α</mml:mi><mml:mo>×</mml:mo><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mo>×</mml:mo><mml:mfenced close="|" open="|"><mml:msubsup><mml:mover><mml:mi>R</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mi>p</mml:mi></mml:msubsup><mml:mo>∩</mml:mo><mml:msubsup><mml:mover><mml:mi>R</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mi>p</mml:mi></mml:msubsup></mml:mfenced></mml:mrow><mml:mrow><mml:mfenced close="|" open="|"><mml:msubsup><mml:mover><mml:mi>R</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mi>p</mml:mi></mml:msubsup></mml:mfenced><mml:mo>+</mml:mo><mml:mfenced close="|" open="|"><mml:msubsup><mml:mover><mml:mi>R</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mi>p</mml:mi></mml:msubsup></mml:mfenced></mml:mrow></mml:mfrac></mml:mrow></mml:math><graphic xlink:href="12859_2023_5566_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula></p>
        <p id="Par26">In formula (<xref rid="Equ3" ref-type="disp-formula">3</xref>), <inline-formula id="IEq24"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$sim({\overline{R} }_{a}, {\overline{R} }_{b})$$\end{document}</tex-math><mml:math id="M54"><mml:mrow><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>m</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mover><mml:mi>R</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mi>a</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mover><mml:mi>R</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mi>b</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5566_Article_IEq24.gif"/></alternatives></inline-formula> denotes the similarity value between the feature vectors <inline-formula id="IEq25"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\overline{R} }_{a}$$\end{document}</tex-math><mml:math id="M56"><mml:msub><mml:mover><mml:mi>R</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mi>a</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5566_Article_IEq25.gif"/></alternatives></inline-formula> and <inline-formula id="IEq26"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\overline{R} }_{b}$$\end{document}</tex-math><mml:math id="M58"><mml:msub><mml:mover><mml:mi>R</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mi>b</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5566_Article_IEq26.gif"/></alternatives></inline-formula>. Where <inline-formula id="IEq27"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha =1/(1-\frac{\left|\left|{\overline{R} }_{a}^{p}\right|-\left|{\overline{R} }_{b}^{p}\right|\right|}{\left|{\overline{R} }_{a}^{p}\right|+\left|{\overline{R} }_{b}^{p}\right|})$$\end{document}</tex-math><mml:math id="M60"><mml:mrow><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mfrac><mml:mfenced close="|" open="|"><mml:mfenced close="|" open="|"><mml:msubsup><mml:mover><mml:mi>R</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mi>p</mml:mi></mml:msubsup></mml:mfenced><mml:mo>-</mml:mo><mml:mfenced close="|" open="|"><mml:msubsup><mml:mover><mml:mi>R</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mi>p</mml:mi></mml:msubsup></mml:mfenced></mml:mfenced><mml:mrow><mml:mfenced close="|" open="|"><mml:msubsup><mml:mover><mml:mi>R</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mi>p</mml:mi></mml:msubsup></mml:mfenced><mml:mo>+</mml:mo><mml:mfenced close="|" open="|"><mml:msubsup><mml:mover><mml:mi>R</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mi>p</mml:mi></mml:msubsup></mml:mfenced></mml:mrow></mml:mfrac><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5566_Article_IEq27.gif"/></alternatives></inline-formula>, <italic>p</italic> = <italic>s</italic> % <italic>Pr</italic>, <italic>s</italic> = 0, 1, 2, …, |<italic>S</italic>|-1, |<italic>S</italic>|= <inline-formula id="IEq28"><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\frac{v\times (v-1)}{2}$$\end{document}</tex-math><mml:math id="M62"><mml:mfrac><mml:mrow><mml:mi>v</mml:mi><mml:mo>×</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>v</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:mfrac></mml:math><inline-graphic xlink:href="12859_2023_5566_Article_IEq28.gif"/></alternatives></inline-formula>, <italic>a</italic> = 1, 2, 3, …, <italic>v</italic>-1, <italic>b</italic> = 0, 1, 2, …, <italic>v</italic>-2, and<italic> a</italic> &gt; <italic>b</italic>.</p>
      </sec>
      <sec id="Sec7">
        <title>Fastq files clustering</title>
        <p id="Par27">For computing friendly, PMFFRC converts the string reads files into numerical vectors to calculate <italic>S</italic> via formula (<xref rid="Equ3" ref-type="disp-formula">3</xref>). After that, it sorts <italic>S</italic> in descending order using the quicksort algorithm [<xref ref-type="bibr" rid="CR29">29</xref>] and performs fastq files clustering. In order to select an appropriate parameter <italic>K</italic>, PMFFRC utilizes a two-level clustering parameter selection strategy. Specifically, PMFFRC first determines the files-level parameter <italic>K</italic><sub>1</sub> and then slightly adjusts it to get the reads-level parameter <italic>K</italic><sub>2</sub>.</p>
        <p id="Par28">In actual experimental observations, the peak memory <italic>Y</italic><sub>cpm</sub> of <italic>Y</italic> shows a nonlinear growth trend with the fastq data scale growth of <italic>F</italic> in some cases (such as FastqCLS). Considering algorithm robustness, by modeling <italic>U</italic><sub><italic>ram</italic></sub> and <italic>Y</italic><sub><italic>cpm</italic></sub>, PMFFRC introduces an empirical correction factor <italic>β</italic> to artificial-fixed the files-level clustering parameter <italic>K</italic><sub>1</sub>, the calculation model as shown in formula (<xref rid="Equ4" ref-type="disp-formula">4</xref>):<disp-formula id="Equ4"><label>4</label><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${K}_{1}=\lceil\beta \times \frac{{Y}_{reads}}{{U}_{ram}-{Y}_{res}}\rceil$$\end{document}</tex-math><mml:math id="M64" display="block"><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>⌈</mml:mo><mml:mi>β</mml:mi><mml:mo>×</mml:mo><mml:mfrac><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi mathvariant="italic">reads</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:msub><mml:mi>U</mml:mi><mml:mrow><mml:mi mathvariant="italic">ram</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi mathvariant="italic">res</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>⌉</mml:mo></mml:mrow></mml:mrow></mml:math><graphic xlink:href="12859_2023_5566_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula></p>
        <p id="Par29">In formula (<xref rid="Equ4" ref-type="disp-formula">4</xref>), the parameter <italic>K</italic><sub>1</sub> represents the number of files-level clusters determined by the memory modeling method. However, there is a significant variation in the number of reads across different sequencing files. When the number of short reads within a cluster becomes too large, it may exceed the predefined memory threshold <italic>U</italic><sub><italic>ram</italic></sub> for compression. Therefore, optimizer PMFFRC dynamically adjusts t <italic>K</italic><sub>1</sub> to get the number of clusters <italic>K</italic><sub>2</sub> at reads-level as the final clustering parameter <italic>K</italic>.</p>
        <p id="Par30">Figure <xref rid="Fig1" ref-type="fig">1</xref> illustrates the clustering of five sequencing fastq files using the proposed two-level (where <italic>v</italic> = 5 and <italic>K</italic><sub>1</sub> = 2) clustering parameter selection strategy.<fig id="Fig1"><label>Fig.1</label><caption><p>Example of clustering fastq files using a two-level parameter selection strategy</p></caption><graphic xlink:href="12859_2023_5566_Fig1_HTML" id="MO1"/></fig></p>
        <p id="Par31">In Fig. <xref rid="Fig1" ref-type="fig">1</xref>, <italic>K</italic><sub>1</sub> = 2, and <italic>M</italic> = 1060 denotes the overall reads number. According to <italic>K</italic><sub>1</sub> and <italic>M</italic>, PMFFRC gets the average number of reads in each cluster as <italic>ave</italic> =<inline-formula id="IEq29"><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lfloor {{M}/{K}_{1} } \rfloor$$\end{document}</tex-math><mml:math id="M66"><mml:mrow><mml:mo>⌊</mml:mo><mml:mrow><mml:mi>M</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo>⌋</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5566_Article_IEq29.gif"/></alternatives></inline-formula>  = 530. However, the value of <italic>ave</italic> is calculated under the <italic>K</italic><sub>1</sub> condition, and due to significant variations of the reads number in different fastq files, it is challenging for the optimizer PMFFRC to achieve the ideal reads number average state for each cluster. Therefore, PMFFRC fine-tunes at the reads level to ensure that the actual number of reads within each cluster is close to the <italic>ave</italic> value. Figure <xref rid="Fig1" ref-type="fig">1</xref>a shows the similarity matrix calculated from formula (<xref rid="Equ3" ref-type="disp-formula">3</xref>). In Fig. <xref rid="Fig1" ref-type="fig">1</xref>b, our optimizer PMFFRC initiates the analysis from the matrix element with the highest similarity score and employs a straightforward "first cluster first priority" principle when clustering fastq files. This straightforward implementation strategy guarantees an overall time advantage for the optimizer. PMFFR first detects that max(<italic>S</italic>) is <italic>sim</italic>(<inline-formula id="IEq30"><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\overline{R} }_{3}, {\overline{R} }_{0}$$\end{document}</tex-math><mml:math id="M68"><mml:mrow><mml:msub><mml:mover><mml:mi>R</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mn>3</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mover><mml:mi>R</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5566_Article_IEq30.gif"/></alternatives></inline-formula>) = 0.92, which indicates the redundant reads between fastq files <italic>F</italic><sub>3</sub> and <italic>F</italic><sub>0</sub> have the highest similarity, so it adds <italic>F</italic><sub>0</sub> and <italic>F</italic><sub>3</sub> to the cluster <italic>C</italic><sub>0</sub>. Then, PMFFRC calculates the total number of reads |<italic>C</italic><sub>0</sub>| is 340 in <italic>C</italic><sub>0</sub>, which is less than <italic>ave</italic>, so it tries to add the fastq file<italic> F</italic><sub>1</sub> in <italic>C</italic><sub>0</sub>. However, |<italic>C</italic><sub>0</sub>| is 650 at this time, which is greater than <italic>ave</italic>, so it discards <italic>F</italic><sub>1</sub> and obtains the first cluster <italic>C</italic><sub>0</sub> = {<italic>F</italic><sub>0</sub>, <italic>F</italic><sub>3</sub>}. After the above steps, the first cluster <italic>C</italic><sub>0</sub> has been received. Thus, PMFFRC removes the elements in collection <italic>C</italic><sub>0</sub> from the similarity matrix and selects the second cluster files. In Fig. <xref rid="Fig1" ref-type="fig">1</xref>c, d, after the first cluster has been built, the remaining components are <italic>sim</italic>(<inline-formula id="IEq31"><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\overline{R} }_{2}, {\overline{R} }_{1}$$\end{document}</tex-math><mml:math id="M70"><mml:mrow><mml:msub><mml:mover><mml:mi>R</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mover><mml:mi>R</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5566_Article_IEq31.gif"/></alternatives></inline-formula>), <italic>sim</italic>(<inline-formula id="IEq32"><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\overline{R} }_{4}, {\overline{R} }_{1}$$\end{document}</tex-math><mml:math id="M72"><mml:mrow><mml:msub><mml:mover><mml:mi>R</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mn>4</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mover><mml:mi>R</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5566_Article_IEq32.gif"/></alternatives></inline-formula>), <italic>sim</italic>(<inline-formula id="IEq33"><alternatives><tex-math id="M73">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\overline{R} }_{4}, {\overline{R} }_{2}$$\end{document}</tex-math><mml:math id="M74"><mml:mrow><mml:msub><mml:mover><mml:mi>R</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mn>4</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mover><mml:mi>R</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5566_Article_IEq33.gif"/></alternatives></inline-formula>), and <italic>sim</italic>(<inline-formula id="IEq34"><alternatives><tex-math id="M75">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\overline{R} }_{4}, {\overline{R} }_{3}$$\end{document}</tex-math><mml:math id="M76"><mml:mrow><mml:msub><mml:mover><mml:mi>R</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mn>4</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mover><mml:mi>R</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5566_Article_IEq34.gif"/></alternatives></inline-formula>), where <italic>sim</italic>(<inline-formula id="IEq35"><alternatives><tex-math id="M77">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\overline{R} }_{4}, {\overline{R} }_{1}$$\end{document}</tex-math><mml:math id="M78"><mml:mrow><mml:msub><mml:mover><mml:mi>R</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mn>4</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mover><mml:mi>R</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5566_Article_IEq35.gif"/></alternatives></inline-formula>) = 0.90 is the highest similarity score. Therefore, PMFFRC adds <italic>F</italic><sub>4</sub> and <italic>F</italic><sub>1</sub> to a new cluster <italic>C</italic><sub>1</sub>. Now, |<italic>C</italic><sub>1</sub>|= 460, which is less than <italic>ave</italic>. If PMFFRC adds <italic>F</italic><sub>2</sub> to cluster <italic>C</italic><sub>1</sub>, |<italic>C</italic><sub>1</sub>| will exceed <italic>ave</italic>. Consequently, PMFFRC ends the second clustering stage to obtain cluster <italic>C</italic><sub>1</sub> = {<italic>F</italic><sub>1</sub>, <italic>F</italic><sub>4</sub>} and adds fastq file <italic>F</italic><sub>2</sub> to another cluster <italic>C</italic><sub>2</sub> = {<italic>F</italic><sub>2</sub>}.</p>
        <p id="Par32">Via user-preset safe memory threshold and reads feature vectors, PMFFRC clusters similar fastq files together. Thus, the high-similarity files in the same cluster generate more highly similar redundant reads, which is more helpful for subsequent cascaded compressors. Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Algorithm S1 summarizes the proposed optimization method PMFFRC. Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Section S2 details the algorithm description and analysis.</p>
      </sec>
    </sec>
    <sec id="Sec8">
      <title>Joint compression and decompression</title>
      <p id="Par33">When obtaining the cluster record files, <italic>C</italic><sub><italic>k</italic></sub>.info, of the sequencing files collection <italic>F</italic> = {<italic>F</italic><sub>0</sub>, <italic>F</italic><sub>1</sub>, …, <italic>F</italic><sub><italic>v</italic>-1</sub>}, the fastq files in each cluster <italic>C</italic><sub><italic>k</italic></sub> are merged according to temp files <italic>C</italic><sub><italic>k</italic></sub>.info, where <italic>k</italic> = 0, 1, 2,…, <italic>K</italic>-1. After that, dedicated state-of-the-art short reads compressors can be used to compress these clustered files.</p>
      <p id="Par34">The PMFFRC optimizer further improves the compression ratio for the optimized algorithm on the cluster files at the joint compression and decompression phase. Due to its heightened scalability, PMFFRC can be applied to the latest short reads compressors. To better embody the optimization idea, Fig. <xref rid="Fig2" ref-type="fig">2</xref> shows the overall processing workflow of the PMFFRC optimizes algorithm <italic>Y</italic> to compress and decompress fastq format files collection<italic> F</italic> = {<italic>F</italic><sub>0</sub>, <italic>F</italic><sub>1</sub>, …, <italic>F</italic><sub><italic>v</italic>-1</sub>}.<fig id="Fig2"><label>Fig. 2</label><caption><p>The overall processing workflow of the optimized cascaded compressor <italic>Y</italic> via PMFFRC, on fastq format sequencing files collection <italic>F</italic></p></caption><graphic xlink:href="12859_2023_5566_Fig2_HTML" id="MO2"/></fig></p>
      <p id="Par35">In Fig. <xref rid="Fig2" ref-type="fig">2</xref>a, <italic>C</italic><sub><italic>k</italic></sub>.ycom is the compressed files by compressor <italic>Y</italic>, and the *.pmffrc file is the optimized compressed files, where <italic>k</italic> = 0, 1, 2, …, <italic>K</italic>-1. In Fig. <xref rid="Fig2" ref-type="fig">2</xref>b, <italic>F</italic><sub><italic>i</italic></sub>.reads denote the recovered files corresponding to <italic>F</italic><sub><italic>i</italic></sub>.fastq, where <italic>i</italic> = 0, 1, 2, …, <italic>v</italic>-1.</p>
    </sec>
  </sec>
  <sec id="Sec9">
    <title>Results</title>
    <sec id="Sec10">
      <title>Experimental configuration and datasets</title>
      <p id="Par36">Evaluation experiments were carried out on a Sugon-7000A supercomputer system of the National High-Performance Computing Center Nanning Branch (<ext-link ext-link-type="uri" xlink:href="https://hpc.gxu.edu.cn">https://hpc.gxu.edu.cn</ext-link>). Computing nodes are equipped with 2*Intel Xeon Gold 6230 CPU (2.1 Ghz, 40 cores), 512 GB DDR4 SDRAM, and 8*900 GB disk space. The experimental node runs the 64-bit version of centos 7.4. The PMFFRC was implemented by C +  + 11 and OpenMP. The overall workflow has been encapsulated into the PMFFRC toolkit. Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Section S3 gives the installation and configuration details of the PMFFRC optimizer. The PMFFRC toolkit follows the Apache-2.0 License, available freely at <ext-link ext-link-type="uri" xlink:href="https://github.com/fahaihi/PMFFRC">https://github.com/fahaihi/PMFFRC</ext-link>.</p>
      <p id="Par37">Three large-scale datasets from the NCBI (<ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/sra">https://www.ncbi.nlm.nih.gov/sra</ext-link>) database were used to assess optimization effects. For paired-end sequencing files, PMFFRC arranges them as two separate single-end files. Table <xref rid="Tab1" ref-type="table">1</xref> gives the details of the experimental datasets.<table-wrap id="Tab1"><label>Table 1</label><caption><p>Datasets used for optimizing large-scale genomic sequencing reads compression</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Dataset name (species)</th><th align="left">Sequencing platform (method)</th><th align="left">Number of reads (millions)</th><th align="left">Total size (GB)</th><th align="left">Reads size (GB)</th><th align="left">Length (bp)</th><th align="left">Number of files</th></tr></thead><tbody><tr><td align="left"><italic>Homo sapiens</italic></td><td align="left">NextSeq-550 (SE)</td><td char="." align="char">507.40</td><td char="." align="char">111.25</td><td char="." align="char">36.78</td><td align="left">75</td><td align="left">24</td></tr><tr><td align="left"><italic>Cicer arietinum</italic></td><td align="left">HiSeq-2000 (PE)</td><td char="." align="char">2060.96</td><td char="." align="char">680.60</td><td char="." align="char">178.54</td><td align="left">90</td><td align="left">60</td></tr><tr><td align="left"><italic>Salvelinus fontinalis</italic></td><td align="left">Ion-Torrent (SE)</td><td char="." align="char">757.46</td><td char="." align="char">189.66</td><td char="." align="char">58.14</td><td align="left">80</td><td align="left">360</td></tr><tr><td align="left">Total</td><td align="left">–</td><td char="." align="char">3325.82</td><td char="." align="char">981.52</td><td char="." align="char">273.46</td><td align="left">–</td><td align="left">444</td></tr></tbody></table><table-wrap-foot><p>Datasets download by employing sra-tools (<ext-link ext-link-type="uri" xlink:href="https://github.com/ncbi/sra-tools">https://github.com/ncbi/sra-tools</ext-link>). For complete NCBI registration numbers, see Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Section S4</p></table-wrap-foot></table-wrap></p>
      <p id="Par38">The proposed algorithm PMFFRC was tested on three large-scale datasets, and its compression size (<italic>cs</italic>), compression ratio (<italic>cr</italic>), compression peak memory (<italic>cpm</italic>), compression time (<italic>ct</italic>), decompression time (<italic>dt</italic>), and decompression peak memory (<italic>dpm</italic>) were compared to most state-of-the-art and reference-free reads compressors, more specifically, HARC [<xref ref-type="bibr" rid="CR14">14</xref>], SPRING [<xref ref-type="bibr" rid="CR17">17</xref>], Mstcom [<xref ref-type="bibr" rid="CR22">22</xref>] and FastqCLS [<xref ref-type="bibr" rid="CR25">25</xref>]. We also employed the compression ratio gains (<italic>crg</italic>) and percent storage savings (<italic>pss</italic>) to evaluate the optimization results. The <italic>crg</italic> and <italic>pss</italic> calculations are as follows:<disp-formula id="Equ5"><label>5</label><alternatives><tex-math id="M79">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$crg = \frac{cr\_with\_PMFFRC}{{cr\_without\_PMFFRC}} - 1$$\end{document}</tex-math><mml:math id="M80" display="block"><mml:mrow><mml:mi>c</mml:mi><mml:mi>r</mml:mi><mml:mi>g</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>c</mml:mi><mml:mi>r</mml:mi><mml:mi>_</mml:mi><mml:mi>w</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi><mml:mi>h</mml:mi><mml:mi>_</mml:mi><mml:mi>P</mml:mi><mml:mi>M</mml:mi><mml:mi>F</mml:mi><mml:mi>F</mml:mi><mml:mi>R</mml:mi><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mi>r</mml:mi><mml:mi>_</mml:mi><mml:mi>w</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi><mml:mi>h</mml:mi><mml:mi>o</mml:mi><mml:mi>u</mml:mi><mml:mi>t</mml:mi><mml:mi>_</mml:mi><mml:mi>P</mml:mi><mml:mi>M</mml:mi><mml:mi>F</mml:mi><mml:mi>F</mml:mi><mml:mi>R</mml:mi><mml:mi>C</mml:mi></mml:mrow></mml:mfrac><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><graphic xlink:href="12859_2023_5566_Article_Equ5.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ6"><label>6</label><alternatives><tex-math id="M81">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$pss = 1 - \frac{cs\_with\_PMFFRC}{{cs\_without\_PMFFRC}}$$\end{document}</tex-math><mml:math id="M82" display="block"><mml:mrow><mml:mi>p</mml:mi><mml:mi>s</mml:mi><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:mi>c</mml:mi><mml:mi>s</mml:mi><mml:mi>_</mml:mi><mml:mi>w</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi><mml:mi>h</mml:mi><mml:mi>_</mml:mi><mml:mi>P</mml:mi><mml:mi>M</mml:mi><mml:mi>F</mml:mi><mml:mi>F</mml:mi><mml:mi>R</mml:mi><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mi>s</mml:mi><mml:mi>_</mml:mi><mml:mi>w</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi><mml:mi>h</mml:mi><mml:mi>o</mml:mi><mml:mi>u</mml:mi><mml:mi>t</mml:mi><mml:mi>_</mml:mi><mml:mi>P</mml:mi><mml:mi>M</mml:mi><mml:mi>F</mml:mi><mml:mi>F</mml:mi><mml:mi>R</mml:mi><mml:mi>C</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:math><graphic xlink:href="12859_2023_5566_Article_Equ6.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par39">All experiments assume the compression server has a maximum memory of 300 GB and utilizes the default 8 CPU cores for joint compression and decompression.</p>
    </sec>
    <sec id="Sec11">
      <title>Performance on Homo sapiens dataset</title>
      <p id="Par40">Table <xref rid="Tab2" ref-type="table">2</xref> shows the results for HARC, SPRING, Mstcom, and FastqCLS using the proposed algorithm PMFFRC on the <italic>H. sapiens</italic> dataset.<table-wrap id="Tab2"><label>Table 2</label><caption><p>Performance of PMFFRC on <italic>H. sapiens</italic> dataset</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" rowspan="2">Algorithm</th><th align="left" rowspan="2">Parameter</th><th align="left" colspan="6">Compression</th><th align="left" colspan="2">Decompression</th></tr><tr><th align="left"><italic>cs</italic> (GB)</th><th align="left"><italic>pss</italic> (%)</th><th align="left"><italic>cr</italic> (bits/base)</th><th align="left"><italic>crg</italic> (%)</th><th align="left"><italic>cpm</italic> (GB)</th><th align="left"><italic>ct</italic> (h)</th><th align="left"><italic>dpm</italic> (GB)</th><th align="left"><italic>dt</italic> (h)</th></tr></thead><tbody><tr><td align="left" rowspan="3">HARC</td><td align="left"><italic>Without</italic></td><td char="." align="char">7.15</td><td align="left">–</td><td char="." align="char">1.61</td><td align="left">–</td><td char="." align="char">1.78</td><td align="left">1.37</td><td char="." align="char">1.57</td><td char="." align="char">1.51</td></tr><tr><td align="left">-<italic>u</italic>10, <italic>k</italic>3</td><td char="." align="char">4.68</td><td align="left"><bold>34.55</bold></td><td char="." align="char">1.06</td><td align="left"><bold>52.77</bold></td><td char="." align="char">9.49</td><td align="left"><bold>1.29</bold></td><td char="." align="char">5.22</td><td char="." align="char">1.65</td></tr><tr><td align="left">-<italic>u</italic>20, <italic>k</italic>1</td><td char="." align="char">3.27</td><td align="left"><bold>45.74</bold></td><td char="." align="char">0.74</td><td align="left"><bold>118.54</bold></td><td char="." align="char">19.61</td><td align="left"><bold>1.01</bold></td><td char="." align="char">5.89</td><td char="." align="char">1.74</td></tr><tr><td align="left" rowspan="4">SPRING</td><td align="left"><italic>Without</italic></td><td char="." align="char">7.16</td><td align="left">–</td><td char="." align="char">1.62</td><td align="left">–</td><td char="." align="char">3.64</td><td align="left">0.97</td><td char="." align="char">1.22</td><td char="." align="char">0.26</td></tr><tr><td align="left">-<italic>u</italic>10, <italic>k</italic>4</td><td char="." align="char">4.75</td><td align="left"><bold>33.66</bold></td><td char="." align="char">1.07</td><td align="left"><bold>50.68</bold></td><td char="." align="char">7.09</td><td align="left">1.39</td><td char="." align="char">2.85</td><td char="." align="char"><bold>0.19</bold></td></tr><tr><td align="left">-<italic>u</italic>20, <italic>k</italic>3</td><td char="." align="char">4.19</td><td align="left"><bold>41.48</bold></td><td char="." align="char">0.95</td><td align="left"><bold>70.91</bold></td><td char="." align="char">10.29</td><td align="left">1.26</td><td char="." align="char">4.63</td><td char="." align="char"><bold>0.22</bold></td></tr><tr><td align="left">-<italic>u</italic>40, <italic>k</italic>1</td><td char="." align="char">3.16</td><td align="left"><bold>55.87</bold></td><td char="." align="char">0.71</td><td align="left"><bold>126.95</bold></td><td char="." align="char">20.71</td><td align="left">1.20</td><td char="." align="char">4.95</td><td char="." align="char"><bold>0.23</bold></td></tr><tr><td align="left" rowspan="4">Mstcom</td><td align="left"><italic>Without</italic></td><td char="." align="char">6.13</td><td align="left">–</td><td char="." align="char">1.38</td><td align="left">–</td><td char="." align="char">13.60</td><td align="left">8.97</td><td char="." align="char">6.22</td><td char="." align="char">1.32</td></tr><tr><td align="left">-<italic>u</italic>40, <italic>k</italic>4</td><td char="." align="char">5.70</td><td align="left"><bold>7.01</bold></td><td char="." align="char">1.29</td><td align="left"><bold>7.50</bold></td><td char="." align="char">38.09</td><td align="left">12.25</td><td char="." align="char">33.71</td><td char="." align="char">1.51</td></tr><tr><td align="left">-<italic>u</italic>80, <italic>k</italic>3</td><td char="." align="char">3.72</td><td align="left"><bold>39.31</bold></td><td char="." align="char">0.84</td><td align="left"><bold>64.57</bold></td><td char="." align="char">53.71</td><td align="left">10.24</td><td char="." align="char">69.08</td><td char="." align="char"><bold>0.94</bold></td></tr><tr><td align="left">-<italic>u</italic>120, <italic>k</italic>1</td><td char="." align="char">2.94</td><td align="left"><bold>52.04</bold></td><td char="." align="char">0.66</td><td align="left"><bold>108.51</bold></td><td char="." align="char">107.39</td><td align="left">10:91</td><td char="." align="char">69.08</td><td char="." align="char"><bold>0.82</bold></td></tr><tr><td align="left" rowspan="4">FastqCLS</td><td align="left"><italic>Without</italic></td><td char="." align="char">7.99</td><td align="left">–</td><td char="." align="char">1.80</td><td align="left">–</td><td char="." align="char">23.08</td><td align="left">8.46</td><td char="." align="char">5.32</td><td char="." align="char">5.08</td></tr><tr><td align="left">-<italic>u</italic>40, <italic>k</italic>4</td><td char="." align="char">7.98</td><td align="left"><bold>0.13</bold></td><td char="." align="char">1.80</td><td align="left"><bold>0.22</bold></td><td char="." align="char">35.35</td><td align="left"><bold>6.88</bold></td><td char="." align="char">6.45</td><td char="." align="char">5.34</td></tr><tr><td align="left">-<italic>u</italic>80, <italic>k</italic>3</td><td char="." align="char">7.89</td><td align="left"><bold>1.25</bold></td><td char="." align="char">1.78</td><td align="left"><bold>1.24</bold></td><td char="." align="char">35.43</td><td align="left"><bold>6.76</bold></td><td char="." align="char">6.47</td><td char="." align="char">5.31</td></tr><tr><td align="left">-<italic>u</italic>120, <italic>k</italic>1</td><td char="." align="char">7.63</td><td align="left"><bold>4.51</bold></td><td char="." align="char">1.72</td><td align="left"><bold>4.76</bold></td><td char="." align="char">35.48</td><td align="left"><bold>7.12</bold></td><td char="." align="char">6.46</td><td char="." align="char">5.36</td></tr></tbody></table><table-wrap-foot><p>The parameter without indicates that the PMFFRC algorithm is not used for compression optimization. (-<italic>u</italic>10, <italic>k</italic>3) denotes the clustering parameter <italic>K</italic> = 3 of PMFFRC when <italic>U</italic><sub><italic>ram</italic></sub> = 10 GB. HARC, SPRING, Mstcom, and FastqCLS are used in with-order mode (lossless). Compression parameters: <italic>Pr</italic> = 20, <italic>T</italic> = 8 (threads for cascaded algorithm), <italic>β</italic><sub>HARC</sub> = 1.05, <italic>β</italic><sub>SPRING</sub> = 0.15, <italic>β</italic><sub>FastqCLS</sub> = 0.15, <italic>β</italic><sub>Mstcom</sub> = 0.30, <italic>x</italic><sub>1</sub> = 100, <italic>x</italic><sub>2</sub> = 100,100. The compression gains obtained by the cascaded PMFFRC algorithms is marked in boldface. “–” means the result of not being optimized by the PMFFRC algorithm. For the experimentally optimized algorithms, we ensure the data integrity of the lossless compression optimization by comparing data hash fingerprints</p></table-wrap-foot></table-wrap></p>
      <p id="Par41">As seen in Table <xref rid="Tab2" ref-type="table">2</xref>, using PMFFRC for compression optimizing, when <italic>K</italic> = 1, the <italic>crg</italic> of HARC, SPRING, Mstcom, and FastqCLS is increased up to 118.54%, 126.95%, 108.51%, and 4.76%, respectively. The four special compressors save 45.74%, 55.87%, 52.04%, and 4.51% storage spaces compared with the <italic>without</italic>-mode.</p>
      <p id="Par42">In Table <xref rid="Tab2" ref-type="table">2</xref>, we also observed that HARC, SPRING, and Mstcom held compression ratio gains of over 100% (when <italic>k</italic> = 1), while FastqCLS only achieved 4.76%. This phenomenon is attributed to the particular reads reorder model employed by FastqCLS. In reference [<xref ref-type="bibr" rid="CR25">25</xref>], FastqCLS introduces the concept of "constructed score" for reordering reads collection, which relies on calculating the probability distribution of each nucleotide base within the reads range. When the length of the reads collection is shorter, it becomes challenging for the sequence scoring model of FastqCLS to generate local clustering effects among similar short reads. As a result, this limitation hampers the optimization efficiency of PMFFRC. Moreover, for reference-free compressors based on reads reorder technologies, the index that records the relative positions of short reads is crucial for restoring the original data. For a collection of shorter reads, the abovementioned record file occupies a higher proportion in the compressed file, which is another potential reason for the low optimization efficiency of PMFFRC. Although PMFFRC did not achieve the expected optimization results for FastqCLS on the <italic>H. sapiens</italic> dataset, PMFFRC remains highly competitive in saving storage space. As shown in Table <xref rid="Tab2" ref-type="table">2</xref>, the proposed PMFFRC saved 4.51% of storage space for FastqCLS merely through joint compression.</p>
      <p id="Par43">PMFFRC requires extra time for fastq files clustering, merging, and splitting, so <italic>ct</italic> and <italic>dt</italic> are slightly higher than the <italic>without</italic>-mode. The parallel clustering speedup and relative memory consumption by employing multiple CPU cores on the <italic>H. sapiens</italic> dataset are also evaluated. See Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S1 for more details.</p>
    </sec>
    <sec id="Sec12">
      <title>Performance on Salvelinus fontinalis dataset</title>
      <p id="Par44">To evaluate the optimizing efficiency of PMFFRC on large-scale fastq files, Table <xref rid="Tab3" ref-type="table">3</xref> shows the compression performance of the four cascaded algorithms by running PMFFRC on the <italic>S. fontinalis</italic> dataset, which contains 360 sequencing files with a total size of 190 GB. Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S2 details the clustering speedup and memory consumption on the <italic>S. fontinalis</italic> dataset using the different numbers of CPU cores.<table-wrap id="Tab3"><label>Table 3</label><caption><p>Performance of PMFFRC on <italic>S. fontinalis</italic> dataset</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" rowspan="2">Algorithm</th><th align="left" rowspan="2">Parameter</th><th align="left" colspan="6">Compression</th><th align="left" colspan="2">Decompression</th></tr><tr><th align="left"><italic>cs</italic> (GB)</th><th align="left"><italic>pss</italic> (%)</th><th align="left"><italic>cr</italic> (bits/base)</th><th align="left"><italic>crg</italic> (%)</th><th align="left"><italic>cpm</italic> (GB)</th><th align="left"><italic>ct</italic> (h)</th><th align="left"><italic>dpm</italic> (GB)</th><th align="left"><italic>dt</italic> (h)</th></tr></thead><tbody><tr><td align="left" rowspan="3">HARC</td><td align="left"><italic>Without</italic></td><td char="." align="char">5.33</td><td align="left">–</td><td char="." align="char">0.76</td><td align="left">–</td><td char="." align="char">0.67</td><td char="." align="char">2.05</td><td char="." align="char">0.45</td><td char="." align="char">2.24</td></tr><tr><td align="left">-<italic>u</italic>20, <italic>k</italic>3</td><td char="." align="char">3.49</td><td align="left"><bold>34.52</bold></td><td char="." align="char">0.50</td><td align="left"><bold>52.48</bold></td><td char="." align="char">11.90</td><td char="." align="char"><bold>1.75</bold></td><td char="." align="char">5.22</td><td char="." align="char">3.05</td></tr><tr><td align="left">-<italic>u</italic>40, <italic>k</italic>1</td><td char="." align="char">3.41</td><td align="left"><bold>36.02</bold></td><td char="." align="char">0.48</td><td align="left"><bold>56.22</bold></td><td char="." align="char">23.69</td><td char="." align="char"><bold>2.04</bold></td><td char="." align="char">6.71</td><td char="." align="char">3.78</td></tr><tr><td align="left" rowspan="3">SPRING</td><td align="left"><italic>Without</italic></td><td char="." align="char">5.49</td><td align="left">–</td><td char="." align="char">0.78</td><td align="left">–</td><td char="." align="char">1.02</td><td char="." align="char">1.46</td><td char="." align="char">0.56</td><td char="." align="char">0.29</td></tr><tr><td align="left">-<italic>u</italic>20, <italic>k</italic>3</td><td char="." align="char">3.58</td><td align="left"><bold>34.79</bold></td><td char="." align="char">0.51</td><td align="left"><bold>50.38</bold></td><td char="." align="char">12.76</td><td char="." align="char">1.74</td><td char="." align="char">1.49</td><td char="." align="char">0.59</td></tr><tr><td align="left">-<italic>u</italic>40, <italic>k</italic>1</td><td char="." align="char">3.49</td><td align="left"><bold>36.43</bold></td><td char="." align="char">0.49</td><td align="left"><bold>57.45</bold></td><td char="." align="char">25.51</td><td char="." align="char">1.69</td><td char="." align="char">1.53</td><td char="." align="char">0.91</td></tr><tr><td align="left" rowspan="4">Mstcom</td><td align="left"><italic>Without</italic></td><td char="." align="char">3.87</td><td align="left">–</td><td char="." align="char">0.55</td><td align="left">–</td><td char="." align="char">5.91</td><td char="." align="char">7.19</td><td char="." align="char">2.29</td><td char="." align="char">1.06</td></tr><tr><td align="left">-<italic>u</italic>40, <italic>k</italic>6</td><td char="." align="char">2.40</td><td align="left"><bold>37.98</bold></td><td char="." align="char">0.34</td><td align="left"><bold>64.31</bold></td><td char="." align="char">33.24</td><td char="." align="char"><bold>5.09</bold></td><td char="." align="char">20.03</td><td char="." align="char"><bold>0.76</bold></td></tr><tr><td align="left">-<italic>u</italic>100, <italic>k</italic>3</td><td char="." align="char">2.31</td><td align="left"><bold>40.31</bold></td><td char="." align="char">0.33</td><td align="left"><bold>67.93</bold></td><td char="." align="char">78.97</td><td char="." align="char"><bold>5.47</bold></td><td char="." align="char">50.36</td><td char="." align="char">1.11</td></tr><tr><td align="left">-<italic>u</italic>180, <italic>k</italic>1</td><td char="." align="char">2.26</td><td align="left"><bold>41.60</bold></td><td char="." align="char">0.32</td><td align="left"><bold>71.12</bold></td><td char="." align="char">159.13</td><td char="." align="char"><bold>6.22</bold></td><td char="." align="char">100.72</td><td char="." align="char">1.60</td></tr><tr><td align="left" rowspan="4">FastqCLS</td><td align="left"><italic>Without</italic></td><td char="." align="char">4.37</td><td align="left">–</td><td char="." align="char">0.62</td><td align="left">–</td><td char="." align="char">16.66</td><td char="." align="char">21.51</td><td char="." align="char">6.35</td><td char="." align="char">16.25</td></tr><tr><td align="left">-<italic>u</italic>80, <italic>k</italic>4</td><td char="." align="char">2.82</td><td align="left"><bold>35.47</bold></td><td char="." align="char">0.40</td><td align="left"><bold>55.15</bold></td><td char="." align="char">60.36</td><td char="." align="char"><bold>11.66</bold></td><td char="." align="char">6.38</td><td char="." align="char"><bold>14.44</bold></td></tr><tr><td align="left">-<italic>u</italic>180, <italic>k</italic>3</td><td char="." align="char">2.77</td><td align="left"><bold>36.61</bold></td><td char="." align="char">0.39</td><td align="left"><bold>58.00</bold></td><td char="." align="char">59.09</td><td char="." align="char"><bold>12.98</bold></td><td char="." align="char">6.43</td><td char="." align="char"><bold>14.04</bold></td></tr><tr><td align="left">-<italic>u</italic>280, <italic>k</italic>1</td><td char="." align="char">2.69</td><td align="left"><bold>38.44</bold></td><td char="." align="char">0.38</td><td align="left"><bold>62.56</bold></td><td char="." align="char">63.60</td><td char="." align="char"><bold>14.03</bold></td><td char="." align="char">6.39</td><td char="." align="char"><bold>15.95</bold></td></tr></tbody></table><table-wrap-foot><p>Parameters: <italic>Pr</italic> = 20, <italic>T</italic> = 8, <italic>β</italic><sub>HARC</sub> = 1.05, <italic>β</italic><sub>SPRING</sub> = 0.95, <italic>β</italic><sub>FastqCLS</sub> = 0.28, <italic>β</italic><sub>Mstcom</sub> = 0.75, <italic>x</italic><sub>1</sub> = 100, <italic>x</italic><sub>2</sub> = 100,100. The compression gains obtained by the PMFFRC cascaded algorithms is marked in boldface. “–” means the result of not being optimized by the PMFFRC algorithm</p></table-wrap-foot></table-wrap></p>
      <p id="Par45">Table <xref rid="Tab3" ref-type="table">3</xref> shows that the compression ratio <italic>cr</italic> using the PMFFRC optimizer for the four cascaded compression algorithms reaches the peak at <italic>K</italic> = 1. The <italic>cr</italic> increases by 56.22%, 57.45%, 71.12%, and 62.56% compared with without-mode. By sacrificing system memory, the MPFFRC optimizer makes four special compressors save storage space of 36.02%, 36.43%, 41.60%, and 38.44%, respectively. The optimizer PMFFRC delivers remarkable results on the S. fontinalis dataset due to its maximal utilization of the redundancy information within the compressed datasets.</p>
    </sec>
    <sec id="Sec13">
      <title>Performance on Cicer arietinum dataset</title>
      <p id="Par46">Table <xref rid="Tab4" ref-type="table">4</xref> presents the optimization results of HARC, SPRING, Mstcom, and FastqCLS by running PMFFRC on <italic>C. arietinum</italic> dataset, which contains 60 fastq files, and the average data size of every single fastq file is 11 GB (the total size of the Cicer arietinum dataset is 681 GB). The speedup and time consumption by using different CPU cores on the <italic>C. arietinum</italic> dataset are shown in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S3.<table-wrap id="Tab4"><label>Table 4</label><caption><p>Performance of PMFFRC on <italic>C. arietinum</italic> dataset</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" rowspan="2">Algorithm</th><th align="left" rowspan="2">Parameter</th><th align="left" colspan="6">Compression</th><th align="left" colspan="2">Decompression</th></tr><tr><th align="left"><italic>cs</italic> (GB)</th><th align="left"><italic>pss</italic> (%)</th><th align="left"><italic>cr</italic> (bits/base)</th><th align="left"><italic>crg</italic> (%)</th><th align="left"><italic>cpm</italic> (GB)</th><th align="left"><italic>ct</italic> (h)</th><th align="left"><italic>dpm</italic> (GB)</th><th align="left"><italic>dt</italic> (h)</th></tr></thead><tbody><tr><td align="left" rowspan="4">HARC</td><td align="left"><italic>Without</italic></td><td char="." align="char">16.96</td><td align="left">–</td><td char="." align="char">0.79</td><td align="left">–</td><td char="." align="char">1.99</td><td char="." align="char">5.24</td><td char="." align="char">1.74</td><td char="." align="char">6.14</td></tr><tr><td align="left">-<italic>u</italic>20, <italic>k</italic>5</td><td char="." align="char">11.17</td><td align="left"><bold>34.14</bold></td><td char="." align="char">0.52</td><td align="left"><bold>51.85</bold></td><td char="." align="char">17.75</td><td char="." align="char"><bold>3.05</bold></td><td char="." align="char">6.30</td><td char="." align="char">6.60</td></tr><tr><td align="left">-<italic>u</italic>40, <italic>k</italic>3</td><td char="." align="char">10.95</td><td align="left"><bold>35.44</bold></td><td char="." align="char">0.51</td><td align="left"><bold>51.94</bold></td><td char="." align="char">34.73</td><td char="." align="char"><bold>3.16</bold></td><td char="." align="char">7.11</td><td char="." align="char">7.60</td></tr><tr><td align="left">-<italic>u</italic>80, <italic>k</italic>1</td><td char="." align="char">10.78</td><td align="left"><bold>36.44</bold></td><td char="." align="char">0.50</td><td align="left"><bold>58.90</bold></td><td char="." align="char">66.90</td><td char="." align="char"><bold>3.53</bold></td><td char="." align="char">6.97</td><td char="." align="char"><bold>5.05</bold></td></tr><tr><td align="left" rowspan="4">SPRING</td><td align="left"><italic>Without</italic></td><td char="." align="char">15.82</td><td align="left">–</td><td char="." align="char">0.73</td><td align="left">–</td><td char="." align="char">1.89</td><td char="." align="char">5.73</td><td char="." align="char">1.04</td><td char="." align="char">0.66</td></tr><tr><td align="left">-<italic>u</italic>20, <italic>k</italic>5</td><td char="." align="char">11.05</td><td align="left"><bold>30.15</bold></td><td char="." align="char">0.51</td><td align="left"><bold>43.15</bold></td><td char="." align="char">18.91</td><td char="." align="char"><bold>3.55</bold></td><td char="." align="char">2.93</td><td char="." align="char">0.95</td></tr><tr><td align="left">-<italic>u</italic>40, <italic>k</italic>3</td><td char="." align="char">10.87</td><td align="left"><bold>31.29</bold></td><td char="." align="char">0.50</td><td align="left"><bold>43.54</bold></td><td char="." align="char">36.78</td><td char="." align="char"><bold>3.60</bold></td><td char="." align="char">4.09</td><td char="." align="char">1.02</td></tr><tr><td align="left">-<italic>u</italic>100, <italic>k</italic>1</td><td char="." align="char">10.67</td><td align="left"><bold>32.55</bold></td><td char="." align="char">0.49</td><td align="left"><bold>48.29</bold></td><td char="." align="char">70.79</td><td char="." align="char"><bold>4.09</bold></td><td char="." align="char">4.13</td><td char="." align="char">1.19</td></tr><tr><td align="left" rowspan="4">Mstcom</td><td align="left"><italic>Without</italic></td><td char="." align="char">13.01</td><td align="left">–</td><td char="." align="char">0.60</td><td align="left">–</td><td char="." align="char">14.54</td><td char="." align="char">66.52</td><td char="." align="char">6.49</td><td char="." align="char">2.94</td></tr><tr><td align="left">-<italic>u</italic>100, <italic>k</italic>15</td><td char="." align="char">10.34</td><td align="left"><bold>20.52</bold></td><td char="." align="char">0.48</td><td align="left"><bold>25.88</bold></td><td char="." align="char">37.52</td><td char="." align="char"><bold>64.52</bold></td><td char="." align="char">22.45</td><td char="." align="char"><bold>2.31</bold></td></tr><tr><td align="left">-<italic>u</italic>200, <italic>k</italic>7</td><td char="." align="char">9.59</td><td align="left"><bold>26.29</bold></td><td char="." align="char">0.44</td><td align="left"><bold>35.71</bold></td><td char="." align="char">77.51</td><td char="." align="char"><bold>61.85</bold></td><td char="." align="char">50.98</td><td char="." align="char"><bold>2.29</bold></td></tr><tr><td align="left">-<italic>u</italic>300, <italic>k</italic>4</td><td char="." align="char">9.24</td><td align="left"><bold>28.98</bold></td><td char="." align="char">0.43</td><td align="left"><bold>40.91</bold></td><td char="." align="char">149.86</td><td char="." align="char"><bold>59.62</bold></td><td char="." align="char">102.78</td><td char="." align="char"><bold>2.15</bold></td></tr><tr><td align="left" rowspan="4">FastqCLS</td><td align="left"><italic>Without</italic></td><td char="." align="char">27.62</td><td align="left">–</td><td char="." align="char">1.28</td><td align="left">–</td><td char="." align="char">33.79</td><td char="." align="char">50.36</td><td char="." align="char">6.49</td><td char="." align="char">28.84</td></tr><tr><td align="left">-<italic>u</italic>100, <italic>k</italic>9</td><td char="." align="char">25.08</td><td align="left"><bold>9.20</bold></td><td char="." align="char">1.16</td><td align="left"><bold>10.15</bold></td><td char="." align="char">36.30</td><td char="." align="char"><bold>28.13</bold></td><td char="." align="char">6.56</td><td char="." align="char"><bold>23.88</bold></td></tr><tr><td align="left">-<italic>u</italic>200, <italic>k</italic>5</td><td char="." align="char">23.65</td><td align="left"><bold>14.37</bold></td><td char="." align="char">1.10</td><td align="left"><bold>16.81</bold></td><td char="." align="char">36.01</td><td char="." align="char"><bold>30.76</bold></td><td char="." align="char">6.53</td><td char="." align="char"><bold>22.16</bold></td></tr><tr><td align="left">-<italic>u</italic>300, <italic>k</italic>4</td><td char="." align="char">22.88</td><td align="left"><bold>17.16</bold></td><td char="." align="char">1.06</td><td align="left"><bold>20.76</bold></td><td char="." align="char">35.84</td><td char="." align="char"><bold>30.32</bold></td><td char="." align="char">6.55</td><td char="." align="char"><bold>22.42</bold></td></tr></tbody></table><table-wrap-foot><p>Parameters: <italic>Pr</italic> = 20, <italic>T</italic> = 8, <italic>β</italic><sub>HARC</sub> = 1.05, <italic>β</italic><sub>SPRING</sub> = 0.30, <italic>β</italic><sub>FastqCLS</sub> = 0.28, <italic>β</italic><sub>Mstcom</sub> = 0.75, <italic>x</italic><sub>1</sub> = 100, <italic>x</italic><sub>2</sub> = 100,100. The compression gains obtained by the PMFFRC cascaded algorithms is marked in boldface. “–” means the result of not being optimized by the PMFFRC algorithm</p></table-wrap-foot></table-wrap></p>
      <p id="Par47">As shown in Table <xref rid="Tab4" ref-type="table">4</xref>, for HARC and SPRING compressors, when the safe threshold <italic>U</italic><sub><italic>ram</italic></sub> takes 80–100 GB, the clustering parameter <italic>K</italic> = 1. Simultaneously, the compression ratio <italic>cr</italic> of HARC and SPRING increased by 58.90% and 48.29%. By leveraging system memory, the PMFFRC optimizer saved 36.44% and 32.55% storage space sizes for HARC and SPRING, respectively. For compressors Mstcom and FastqCLS, when the safe threshold <italic>U</italic><sub><italic>ram</italic></sub> takes 300 GB (maximum system memory), the clustering parameter <italic>K</italic> = 4, and the compression ratio <italic>cr</italic> is improved by 40.91% and 20.76%. In this case, PMFFRC preserved 28.98% and 17.16% of storage space sizes for Mstcom and FastqCLS, respectively.</p>
      <p id="Par48">In <italic>C. arietinum</italic> dataset, the compression time <italic>ct</italic> of four cascaded compressors was reduced by running PMFFRC compared with <italic>without</italic>-mode. This contribution can be attributed to the following reasons: (i) PMFFRC accelerates computation-intensive stages by multi-core CPU parallelism. Therefore, the time consumption of fastq files clustering and merging steps is far lower than the total time consumption. (ii) Similar sequencing reads are gathered by redundant clustering in different fastq files, which favors reference-free compressors in the joint compressing stage. For example, HARC [<xref ref-type="bibr" rid="CR14">14</xref>] utilizes a redundant substitute step for replacing reverses complimentary and direct repeat reads, which benefit from our clustering algorithm. (iii) The joint compression stage reduces the preprocessing time consumption, such as building hash tables and dictionaries. For example, in the <italic>without</italic>-mode, HARC needs to perform 60 hash table construction processes on the Cicer arietinum dataset. However, joint compression only needs to build hash table once when <italic>K</italic> = 1.</p>
    </sec>
  </sec>
  <sec id="Sec14">
    <title>Discussion</title>
    <p id="Par49">We presented PMFFRC, a CPU-parallel algorithm for optimizing large-scale genomic sequencing reads lossless compression. On real datasets, PMFFRC achieves a 20–80% maximum compression ratio gains and an additional 20–40% file size reduction compared with non-optimized reference-free compressors. Our work pointed out a feasible idea for large-scale genome sequencing reads compression, which is to use the redundant information of reads in different fastq files to improve the compression ratio. In some cases, the PMFFRC algorithm can also reduce the compression and decompression time. Compared with non-optimized reference-free compressors, the significant compression advantage for optimized algorithms is achieved through a "three-stage redundancy utilization strategy" (fastq files, reads string, and nucleotide character) provided by the optimizer and the optimized algorithm. A typical sample implementation is PMFFRC + FastqCLS. (i) The PMFFRC optimizer employs a two-level clustering method to group similar fastq format data, resulting in highly similar data within each group. This clustering strategy allows the FastqCLS algorithm to take advantage of redundant information at the files level in the compressed datasets. (ii) The FastqCLS algorithm uses a novel scoring model to reorder short reads by leveraging redundancy information at the short reads string level. This preprocessing phase takes advantage of the redundancy between short reads. (iii) The FastqCLS compressor incorporates the ZPAQ algorithm, which employs context modelling and arithmetic coding. This enables FastqCLS to detect patterns and character dependencies in the reads data, utilizing context models and exploiting redundancy at the nucleotide character level to improve compression ratios.</p>
    <p id="Par50">Our optimizer PMFFRC showed promising results on 444 sequencing files. However, it is undeniable that PMFFRC nonetheless has some limitations. On the one hand, the PMFFRC algorithm may not achieve the expected optimization results for small memory devices and small-scale genome sequencing data. Since PMFFRC utilizes system memory and files-level redundancy information, it is more suitable for compressing medium to large-scale sequencing datasets. On the other hand, the high compression ratio achieved by PMFFRC restricts its flexibility in decompression, making it more suitable for medium and long-term backup applications of sequencing short reads data. Based on current work, potential future work includes: (i) Improving computation of PMFFRC by using CPU and GPU (Graphics Processing Unit) collaborative computing for large-scale and long sequencing reads optimization compression. (ii) Achieving the accurate compression and decompression of clustering files to enhance application flexibility. (iii) Creating a block index for each joint compressed file and reducing the overall compression memory consumption through block compression, so that small memory devices can also benefit from the proposed PMFFRC algorithm. (iv) Another interesting direction is to explore machine learning and deep learning techniques for predicting the compression peak memory <italic>Y</italic><sub><italic>cpm</italic></sub> and clustering parameters <italic>K</italic> accurately, to maximize utilization the user-preset safe memory threshold <italic>U</italic><sub><italic>ram</italic></sub>.</p>
  </sec>
  <sec id="Sec15">
    <title>Availability and requirements</title>
    <p id="Par51">
      <list list-type="bullet">
        <list-item>
          <p id="Par52"><bold>Project name</bold>: PMFFRC</p>
        </list-item>
        <list-item>
          <p id="Par53"><bold>Project home page</bold>: <ext-link ext-link-type="uri" xlink:href="https://github.com/fahaihi/PMFFRC">https://github.com/fahaihi/PMFFRC</ext-link></p>
        </list-item>
        <list-item>
          <p id="Par54"><bold>Operating system(s)</bold>: Linux</p>
        </list-item>
        <list-item>
          <p id="Par55"><bold>Programming language</bold>: C +  + , OpenMP</p>
        </list-item>
        <list-item>
          <p id="Par56"><bold>Other requirements</bold>: FastqCLS, Mstcom, Harc, Spring, and gcc 5.4.0.</p>
        </list-item>
        <list-item>
          <p id="Par57"><bold>License</bold>: Apache-2.0 license</p>
        </list-item>
        <list-item>
          <p id="Par58"><bold>Any restrictions to use by non-academics</bold>: For commercial use, please contact the authors.</p>
        </list-item>
      </list>
    </p>
  </sec>
  <sec sec-type="supplementary-material">
    <sec id="Sec16">
      <title>Supplementary Information</title>
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="12859_2023_5566_MOESM1_ESM.docx">
            <caption>
              <p><bold>Additional file 1:</bold> PMFFRC_Supplementary_Material.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>MB</term>
        <def>
          <p id="Par4">Megabyte</p>
        </def>
      </def-item>
      <def-item>
        <term>GB</term>
        <def>
          <p id="Par5">Gigabyte</p>
        </def>
      </def-item>
      <def-item>
        <term>TB</term>
        <def>
          <p id="Par6">Terabyte</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher's Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>The experimental work is supported by the High-performance Computing Center of Guangxi University. The authors thank the editor and anonymous reviewers for their constructive comments and suggestions to improve our manuscript. The authors also thank Dr. Meng Yan for guiding the manuscript revision.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author contributions</title>
    <p>HS and YFZ implemented the code. HS and HNX wrote the manuscript. XGL and GW guided the project. HDM completed a part of the experiments and prepared the dataset. XGL and GW also helped to modify the manuscript. All authors read and approved the manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>This work is partly supported by NSF of China (62141412, 62272253, 62272252), Fundamental Research Funds for the Central Universities.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>The datasets generated and analyzed during the current study are available in the PMFFRC repository, <ext-link ext-link-type="uri" xlink:href="https://github.com/fahaihi/PMFFRC/tree/master/data">https://github.com/fahaihi/PMFFRC/tree/master/data</ext-link>.</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar1">
      <title>Ethics approval and consent to participate</title>
      <p id="Par59">The ethic approval is not required since we used publicly available datasets.</p>
    </notes>
    <notes id="FPar2">
      <title>Consent for publication</title>
      <p id="Par60">Not applicable.</p>
    </notes>
    <notes id="FPar3" notes-type="COI-statement">
      <title>Competing interests</title>
      <p id="Par61">The authors declare that they have no competing interests.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Voges</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Hernaez</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Mattavelli</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Ostermann</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>An introduction to MPEG-G: the first open ISO/IEC standard for the compression and exchange of genomic sequencing data</article-title>
        <source>Proc IEEE</source>
        <year>2021</year>
        <volume>109</volume>
        <issue>9</issue>
        <fpage>1607</fpage>
        <lpage>1622</lpage>
        <pub-id pub-id-type="doi">10.1109/JPROC.2021.3082027</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Numanagić</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Bonfield</surname>
            <given-names>JK</given-names>
          </name>
          <name>
            <surname>Hach</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Voges</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Ostermann</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Alberti</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Comparison of high-throughput sequencing data compression tools</article-title>
        <source>Nat Methods</source>
        <year>2016</year>
        <volume>13</volume>
        <issue>12</issue>
        <fpage>1005</fpage>
        <lpage>1008</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.4037</pub-id>
        <?supplied-pmid 27776113?>
        <pub-id pub-id-type="pmid">27776113</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kokot</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Gudyś</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Deorowicz</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>CoLoRd: compressing long reads</article-title>
        <source>Nat Methods</source>
        <year>2022</year>
        <volume>19</volume>
        <issue>4</issue>
        <fpage>441</fpage>
        <lpage>444</lpage>
        <pub-id pub-id-type="doi">10.1038/s41592-022-01432-3</pub-id>
        <?supplied-pmid 35347321?>
        <pub-id pub-id-type="pmid">35347321</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhu</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>JiZ</surname>
            <given-names>HS</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>X</given-names>
          </name>
        </person-group>
        <article-title>High-throughput DNA sequence data compression</article-title>
        <source>Brief Bioinform</source>
        <year>2015</year>
        <volume>16</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>15</lpage>
        <pub-id pub-id-type="doi">10.1093/bib/bbt087</pub-id>
        <?supplied-pmid 24300111?>
        <pub-id pub-id-type="pmid">24300111</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hernaez</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Pavlichin</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Weissman</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Ochoa</surname>
            <given-names>I</given-names>
          </name>
        </person-group>
        <article-title>Genomic data compression</article-title>
        <source>Annu Rev Biomed Data Sci</source>
        <year>2019</year>
        <volume>2</volume>
        <fpage>19</fpage>
        <lpage>37</lpage>
        <pub-id pub-id-type="doi">10.1146/annurev-biodatasci-072018-021229</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dufort y Álvarez</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Seroussi</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Smircich</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Sotelo-Silveira</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Ochoa</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Martín</surname>
            <given-names>Á</given-names>
          </name>
        </person-group>
        <article-title>RENANO: a REference-based compressor for NANOpore FASTQ files</article-title>
        <source>Bioinformatics</source>
        <year>2021</year>
        <volume>37</volume>
        <issue>24</issue>
        <fpage>4862</fpage>
        <lpage>4864</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btab437</pub-id>
        <?supplied-pmid 34128963?>
        <pub-id pub-id-type="pmid">34128963</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yao</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Ji</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>He</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>HRCM: an efficient hybrid referential compression method for genomic big data</article-title>
        <source>BioMed Res Int</source>
        <year>2019</year>
        <pub-id pub-id-type="doi">10.1155/2019/3108950</pub-id>
        <?supplied-pmid 31915690?>
        <pub-id pub-id-type="pmid">31915690</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Saha</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Rajasekaran</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>NRGC: a novel referential genome compression algorithm</article-title>
        <source>Bioinformatics</source>
        <year>2016</year>
        <volume>32</volume>
        <issue>22</issue>
        <fpage>3405</fpage>
        <lpage>3412</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btw505</pub-id>
        <?supplied-pmid 27485445?>
        <pub-id pub-id-type="pmid">27485445</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jones</surname>
            <given-names>DC</given-names>
          </name>
          <name>
            <surname>Ruzzo</surname>
            <given-names>WL</given-names>
          </name>
          <name>
            <surname>Peng</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Katze</surname>
            <given-names>MG</given-names>
          </name>
        </person-group>
        <article-title>Compression of next-generation sequencing reads aided by highly efficient de novo assembly</article-title>
        <source>Nucleic Acids Res</source>
        <year>2012</year>
        <volume>40</volume>
        <issue>22</issue>
        <fpage>e171</fpage>
        <pub-id pub-id-type="doi">10.1093/nar/gks754</pub-id>
        <?supplied-pmid 22904078?>
        <pub-id pub-id-type="pmid">22904078</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cox</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Bauer</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Jakobi</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Rosone</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Large-scale compression of genomic sequence databases with the Burrows-Wheeler transform</article-title>
        <source>Bioinformatics</source>
        <year>2012</year>
        <volume>28</volume>
        <fpage>1415</fpage>
        <lpage>1419</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bts173</pub-id>
        <?supplied-pmid 22556365?>
        <pub-id pub-id-type="pmid">22556365</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Roguski</surname>
            <given-names>Ł</given-names>
          </name>
          <name>
            <surname>Deorowicz</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>DSRC2 industry-oriented compression of FASTQ files</article-title>
        <source>Bioinformatics</source>
        <year>2014</year>
        <volume>30</volume>
        <fpage>2213</fpage>
        <lpage>2215</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btu208</pub-id>
        <?supplied-pmid 24747219?>
        <pub-id pub-id-type="pmid">24747219</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Deorowicz</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>FQSqueezer: k-mer-based compression of sequencing data</article-title>
        <source>Sci Rep</source>
        <year>2020</year>
        <volume>10</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>9</lpage>
        <pub-id pub-id-type="doi">10.1038/s41598-020-57452-6</pub-id>
        <pub-id pub-id-type="pmid">31913322</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Meng</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Chandak</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Zhu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Weissman</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Reference-free lossless compression of nanopore sequencing reads using an approximate assembly approach</article-title>
        <source>Sci Rep</source>
        <year>2023</year>
        <volume>13</volume>
        <issue>1</issue>
        <fpage>2082</fpage>
        <pub-id pub-id-type="doi">10.1038/s41598-023-29267-8</pub-id>
        <?supplied-pmid 36747011?>
        <pub-id pub-id-type="pmid">36747011</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chandak</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Tatwawadi</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Weissman</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Compression of genomic sequencing reads via hash-based reordering: algorithm and analysis</article-title>
        <source>Bioinformatics</source>
        <year>2018</year>
        <volume>34</volume>
        <issue>4</issue>
        <fpage>558</fpage>
        <lpage>567</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btx639</pub-id>
        <?supplied-pmid 29444237?>
        <pub-id pub-id-type="pmid">29444237</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Grabowski</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Deorowicz</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Roguski</surname>
            <given-names>Ł</given-names>
          </name>
        </person-group>
        <article-title>Disk-based compression of data from genome sequencing</article-title>
        <source>Bioinformatics</source>
        <year>2014</year>
        <volume>31</volume>
        <fpage>1389</fpage>
        <lpage>1395</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btu844</pub-id>
        <?supplied-pmid 25536966?>
        <pub-id pub-id-type="pmid">25536966</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Benoit</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Lemaitre</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Lavenier</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Drezen</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Dayris</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Uricaru</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Reference-free compression of high throughput sequencing data with a probabilistic de Bruijn graph</article-title>
        <source>BMC Bioinform</source>
        <year>2015</year>
        <volume>16</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>14</lpage>
        <pub-id pub-id-type="doi">10.1186/s12859-015-0709-7</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chandak</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Tatwawadi</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Ochoa</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Hernaez</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Weissman</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>SPRING: a next-generation compressor for FASTQ data</article-title>
        <source>Bioinformatics</source>
        <year>2019</year>
        <volume>35</volume>
        <issue>15</issue>
        <fpage>2674</fpage>
        <lpage>2676</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bty1015</pub-id>
        <?supplied-pmid 30535063?>
        <pub-id pub-id-type="pmid">30535063</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Roguski</surname>
            <given-names>Ł</given-names>
          </name>
          <name>
            <surname>Ochoa</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Hernaez</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Deorowicz</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>FaStore: a space-saving solution for raw sequencing data</article-title>
        <source>Bioinformatics</source>
        <year>2018</year>
        <volume>34</volume>
        <issue>16</issue>
        <fpage>2748</fpage>
        <lpage>2756</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bty205</pub-id>
        <?supplied-pmid 29617939?>
        <pub-id pub-id-type="pmid">29617939</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kowalski</surname>
            <given-names>TM</given-names>
          </name>
          <name>
            <surname>Grabowski</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>PgRC: pseudogenome-based read compressor</article-title>
        <source>Bioinformatics</source>
        <year>2020</year>
        <volume>36</volume>
        <issue>7</issue>
        <fpage>2082</fpage>
        <lpage>2089</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btz919</pub-id>
        <?supplied-pmid 31893286?>
        <pub-id pub-id-type="pmid">31893286</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Yu</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Dinger</surname>
            <given-names>ME</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Index suffix–prefix overlaps by (w, k)-minimizer to generate long contigs for reads compression</article-title>
        <source>Bioinformatics</source>
        <year>2018</year>
        <volume>35</volume>
        <issue>12</issue>
        <fpage>2066</fpage>
        <lpage>2074</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bty936</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Xie</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>He</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>He</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Zhu</surname>
            <given-names>Z</given-names>
          </name>
        </person-group>
        <article-title>CURC: a CUDA-based reference-free read compressor</article-title>
        <source>Bioinformatics</source>
        <year>2022</year>
        <volume>38</volume>
        <issue>12</issue>
        <fpage>3294</fpage>
        <lpage>3296</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btac333</pub-id>
        <?supplied-pmid 35579371?>
        <pub-id pub-id-type="pmid">35579371</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Hamming-shifting graph of genomic short reads: Efficient construction and its application for compression</article-title>
        <source>PLoS Comput Biol</source>
        <year>2021</year>
        <volume>17</volume>
        <issue>7</issue>
        <fpage>e1009229</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1009229</pub-id>
        <?supplied-pmid 34280186?>
        <pub-id pub-id-type="pmid">34280186</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>White</surname>
            <given-names>WTJ</given-names>
          </name>
          <name>
            <surname>Hendy</surname>
            <given-names>MD</given-names>
          </name>
        </person-group>
        <article-title>Compressing DNA sequence databases with coil</article-title>
        <source>BMC Bioinformatics</source>
        <year>2008</year>
        <volume>9</volume>
        <issue>1</issue>
        <fpage>242</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-9-242</pub-id>
        <?supplied-pmid 18489794?>
        <pub-id pub-id-type="pmid">18489794</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yanovsky</surname>
            <given-names>V</given-names>
          </name>
        </person-group>
        <article-title>ReCoil-an algorithm for compression of extremely large datasets of DNA data</article-title>
        <source>Algorithms Mol Biol</source>
        <year>2011</year>
        <volume>6</volume>
        <issue>1</issue>
        <fpage>23</fpage>
        <pub-id pub-id-type="doi">10.1186/1748-7188-6-23</pub-id>
        <?supplied-pmid 21988957?>
        <pub-id pub-id-type="pmid">21988957</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lee</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Song</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>FastqCLS: a FASTQ compressor for long-read sequencing via read reordering using a novel scoring model</article-title>
        <source>Bioinformatics</source>
        <year>2022</year>
        <volume>38</volume>
        <issue>2</issue>
        <fpage>351</fpage>
        <lpage>356</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btab696</pub-id>
        <?supplied-pmid 34623374?>
        <pub-id pub-id-type="pmid">34623374</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Al Yami</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Huang</surname>
            <given-names>CH</given-names>
          </name>
        </person-group>
        <article-title>LFastqC: A lossless non-reference-based FASTQ compressor</article-title>
        <source>PLoS ONE</source>
        <year>2019</year>
        <volume>14</volume>
        <issue>11</issue>
        <fpage>e0224806</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0224806</pub-id>
        <?supplied-pmid 31725736?>
        <pub-id pub-id-type="pmid">31725736</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Cheng</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Grossman</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>McKercher</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <source>Professional CUDA c programming</source>
        <year>2017</year>
        <publisher-loc>Beijing</publisher-loc>
        <publisher-name>China Machine Press</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cha</surname>
            <given-names>SH</given-names>
          </name>
        </person-group>
        <article-title>Comprehensive survey on distance/similarity measures between probability density functions</article-title>
        <source>Int J Math Models Methods Appl Sci</source>
        <year>2007</year>
        <volume>1</volume>
        <issue>2</issue>
        <fpage>300</fpage>
        <lpage>307</lpage>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hoare</surname>
            <given-names>CAR</given-names>
          </name>
        </person-group>
        <article-title>Quicksort</article-title>
        <source>Comput J</source>
        <year>1962</year>
        <volume>5</volume>
        <issue>1</issue>
        <fpage>10</fpage>
        <lpage>16</lpage>
        <pub-id pub-id-type="doi">10.1093/comjnl/5.1.10</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10691058</article-id>
    <article-id pub-id-type="pmid">38036969</article-id>
    <article-id pub-id-type="publisher-id">5566</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-023-05566-9</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>PMFFRC: a large-scale genomic short reads compression optimizer via memory modeling and redundant clustering</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Sun</surname>
          <given-names>Hui</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Zheng</surname>
          <given-names>Yingfeng</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Xie</surname>
          <given-names>Haonan</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ma</surname>
          <given-names>Huidong</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Liu</surname>
          <given-names>Xiaoguang</given-names>
        </name>
        <address>
          <email>liuxg@nbjl.nankai.edu.cn</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Wang</surname>
          <given-names>Gang</given-names>
        </name>
        <address>
          <email>adairmillersh@gmail.com</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/01y1kjr75</institution-id><institution-id institution-id-type="GRID">grid.216938.7</institution-id><institution-id institution-id-type="ISNI">0000 0000 9878 7032</institution-id><institution>Nankai-Baidu Joint Laboratory, College of Computer Science, </institution><institution>Nankai University, </institution></institution-wrap>Tianjin, China </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/02c9qn167</institution-id><institution-id institution-id-type="GRID">grid.256609.e</institution-id><institution-id institution-id-type="ISNI">0000 0001 2254 5798</institution-id><institution>Institute of Artificial Intelligence, School of Electrical Engineering, </institution><institution>Guangxi University, </institution></institution-wrap>Nanning, China </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>30</day>
      <month>11</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>30</day>
      <month>11</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2023</year>
    </pub-date>
    <volume>24</volume>
    <elocation-id>454</elocation-id>
    <history>
      <date date-type="received">
        <day>12</day>
        <month>9</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>13</day>
        <month>11</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">Genomic sequencing reads compressors are essential for balancing high-throughput sequencing short reads generation speed, large-scale genomic data sharing, and infrastructure storage expenditure. However, most existing short reads compressors rarely utilize big-memory systems and duplicative information between diverse sequencing files to achieve a higher compression ratio for conserving reads data storage space.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">We employ compression ratio as the optimization objective and propose a large-scale genomic sequencing short reads data compression optimizer, named PMFFRC, through novelty memory modeling and redundant reads clustering technologies. By cascading PMFFRC, in 982 GB fastq format sequencing data, with 274 GB and 3.3 billion short reads, the state-of-the-art and reference-free compressors HARC, SPRING, Mstcom, and FastqCLS achieve 77.89%, 77.56%, 73.51%, and 29.36% average maximum compression ratio gains, respectively. PMFFRC saves 39.41%, 41.62%, 40.99%, and 20.19% of storage space sizes compared with the four unoptimized compressors.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p id="Par3">PMFFRC rational usage big-memory of compression server, effectively saving the sequencing reads data storage space sizes, which relieves the basic storage facilities costs and community sharing transmitting overhead. Our work furnishes a novel solution for improving sequencing reads compression and saving storage space. The proposed PMFFRC algorithm is packaged in a same-name Linux toolkit, available un-limited at <ext-link ext-link-type="uri" xlink:href="https://github.com/fahaihi/PMFFRC">https://github.com/fahaihi/PMFFRC</ext-link>.</p>
      </sec>
      <sec>
        <title>Supplementary Information</title>
        <p>The online version contains supplementary material available at 10.1186/s12859-023-05566-9.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Short reads data</kwd>
      <kwd>Data compression</kwd>
      <kwd>Fastq</kwd>
      <kwd>Parallel algorithm</kwd>
    </kwd-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© BioMed Central Ltd., part of Springer Nature 2023</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par7">With the prosperity of next-generation sequencing (NGS) technologies, genomic sequencing data holds the characteristics of large data volumes, multiple files, and prosperous species sources [<xref ref-type="bibr" rid="CR1">1</xref>]. For example, until September 2023, through 829,822 sequencing times of 845,109 bio-samples, the bio-sequencing data compressed by the gzip (<ext-link ext-link-type="uri" xlink:href="http://www.gzip.org">http://www.gzip.org</ext-link>) in the CNGB Sequence Archive (<ext-link ext-link-type="uri" xlink:href="https://db.cngb.org/cnsa">https://db.cngb.org/cnsa</ext-link>) was up to 11,920 terabytes (TB), if stored in Amazon cloud at $0.125 each gigabyte (GB), will cost $1,525,760 per year. Therefore, compressing large-scale genomic sequencing data is essential in reducing the storage infrastructure construction expenditure and data transmission consumption, especially for sequencing reads, which account for 42% of the whole genomic sequencing data [<xref ref-type="bibr" rid="CR2">2</xref>, <xref ref-type="bibr" rid="CR3">3</xref>].</p>
    <p id="Par8">Different from ordinary textual data (such as big social data), genomic reads data has the following bioinformatic attributes. (i) The formatting of reads characters is uncomplicated, which consists of the alphabet Σ = {A, C, G, T, N} simply. (ii) The redundancy reads data is high, mainly relying on sequencing coverage of diverse platforms. (iii) Homologous species reads data retains heightened similitude. Recently, reference-based and reference-free dedicated genomic sequencing reads compressors have been proposed by taking full advantage of reads' bioinformatic attributes [<xref ref-type="bibr" rid="CR4">4</xref>, <xref ref-type="bibr" rid="CR5">5</xref>].</p>
    <p id="Par9">The first category, of reference-based compressors, acquires the position details of reads in the reference genome via sequence alignment technology to achieve redundant substrings replacement, such as RENANO [<xref ref-type="bibr" rid="CR6">6</xref>], HRCM [<xref ref-type="bibr" rid="CR7">7</xref>], and NRGC [<xref ref-type="bibr" rid="CR8">8</xref>]. Reference-based methods are more helpful in compressing reference-matched reads, but their high compression ratio relies on reference genome selection. In contrast to reference-free compressors, the weaknesses of reference-based approaches can be summarized as follows. (i) Selecting an appropriate reference genome for a target dataset to be compressed can be challenging, and using a mismatched reference genome may result in inferior compression performance. (ii) Reference-based methods incorporate additional knowledge for encoding and decoding. This flexibility-limited technology hinders compressed data sharing and the widespread adoption of compressors. (iii) Aligning short reads data to a selected reference genome is a CPU-intensive and memory-unfriendly computational process, which demands higher time and memory consumption. However, in contrast, reference-free compressors utilize reads' redundant details and character formatting attributes for compression optimization, which have heightened application prospects in multi-species reads compression, such as Quip(-a) [<xref ref-type="bibr" rid="CR9">9</xref>], BEETL [<xref ref-type="bibr" rid="CR10">10</xref>], DSR2C [<xref ref-type="bibr" rid="CR11">11</xref>], FQSqueezer [<xref ref-type="bibr" rid="CR12">12</xref>], and NanoSpring [<xref ref-type="bibr" rid="CR13">13</xref>]. Here, we will introduce some state-of-the-art and reference-free short reads compressors relevant to our work. See references [<xref ref-type="bibr" rid="CR4">4</xref>] and [<xref ref-type="bibr" rid="CR5">5</xref>] for more detailed reviews of fastq format genomic sequencing reads data compressors.</p>
    <p id="Par10">HARC [<xref ref-type="bibr" rid="CR14">14</xref>] reorders short reads via their genome position details and then removes the redundancy sub-strings between consecutive reads, which achieves 1.4–2 × compression ratio improvement over Orcom [<xref ref-type="bibr" rid="CR15">15</xref>] and Leon [<xref ref-type="bibr" rid="CR16">16</xref>] in 3 billion Illumina short reads data. From the same research team, SPRING [<xref ref-type="bibr" rid="CR17">17</xref>] enhances HARC by supporting variable-length reads and handles all fastq streams. In their experiment, SPRING compresses 195 GB of 25 × whole genome human data from Illumina’s NovaSeq platform to 7 GB, around 1.6 × smaller than Fastore [<xref ref-type="bibr" rid="CR18">18</xref>].</p>
    <p id="Par11">PgRC [<xref ref-type="bibr" rid="CR19">19</xref>] assembles pseudo-genomes through approximate common superstring reads and then encodes them by reads' mapping sites on the pseudo-genome, which bests in compression ratio over Minicom [<xref ref-type="bibr" rid="CR20">20</xref>] and SPRING by up to 20% and 15% on average, respectively. CURC [<xref ref-type="bibr" rid="CR21">21</xref>] improves PgRC by CPU and GPU collaborative computing, which achieves 2.76–3.14× and 4.15–6.54× speedup in compression and 1.26–1.65× and 1.6–2.52× decompression speedup compared with SPRING and PgRC on 18 single-end and 13 paired-end sequencing datasets.</p>
    <p id="Par12">Mstcom [<xref ref-type="bibr" rid="CR22">22</xref>] introduces the concept of Hamming-shifting graphs to encode similar redundant reads and employ compressors BSC (<ext-link ext-link-type="uri" xlink:href="http://libbsc.com">http://libbsc.com</ext-link>) and LZMA (<ext-link ext-link-type="uri" xlink:href="http://www.7zip.org">http://www.7zip.org</ext-link>) for compressing the encoded file streams. Like Coil [<xref ref-type="bibr" rid="CR23">23</xref>] and ReCoil [<xref ref-type="bibr" rid="CR24">24</xref>], Mstcom reduces redundant information by cross-referencing similar reads. Because the similarity comparison between different string reads is time-consuming, such methods consume more time and memory space. The compression performance of Mstcom can be 10–30% better than SPRING, Minicom, and PgRC on 14 single-end and 7 paired-end datasets.</p>
    <p id="Par13">FastqCLS [<xref ref-type="bibr" rid="CR25">25</xref>] is the latest compressor, handy for compressing long and short genomic sequencing reads. It first extracts the features of reads via a novel scoring model and reorders them according to the numeral eigenvalues. Once the similarity reads are aggregated, the reads are compressed by the general-purpose compressor ZPAQ (<ext-link ext-link-type="uri" xlink:href="http://mattmahoney.net/dc/zpaq.html">http://mattmahoney.net/dc/zpaq.html</ext-link>) to improve the overall compression ratio. The experimental results on the MPEG [<xref ref-type="bibr" rid="CR2">2</xref>] and LFastqC [<xref ref-type="bibr" rid="CR26">26</xref>] benchmark datasets demonstrate that FastqCLS achieves compression ratios of 2.28–3.37 for long reads datasets, and 4.01–17.17 for short reads datasets. Compared with the pure ZPAQ compressor, FastqCLS achieves an average compression ratio boost of 4% (up to 18%) via the reads scoring model.</p>
    <p id="Par14">According to our investigation, existing reference-free short reads compressors rarely use redundancy information between different fastq files and large equipment memory in actual compression scenes to improve compression ratio. For example, in medium and long-term genomic data backup systems, the memory of the compression server often reaches hundreds or thousands of gigabytes (GB). Suppose the peak memory of the compressor holds only hundreds of megabytes (MB). In that case, it has advantages in memory usage but is ineffective for large memory to improve the compression ratio in multi-fastq files. To this end, we take the genomic sequencing reads compression ratio as the optimization objective and propose a large-scale reads compression optimization method named PMFFRC (Parallel Multi-Fastq-File Reads Clustering). The experimental results of actual 982 GB fastq format sequencing data, with the size of 274 GB and 3.3 billion reads, show that the average maximum compression ratio gains of compressors HARC, SPRING, Mstcom, and FastqCLS optimized by PMFFRC are 77.89%, 77.56%, 73.51%, and 29.36%, respectively. The maximum percent storage savings of the four cascaded compressors are 39.41%, 41.62%, 40.99%, and 20.19%, respectively. In the current version, the PMFFRC optimizer only compresses short reads, which accepts a folder containing multiple fastq files and outputs a compressed file *.pmffrc.</p>
  </sec>
  <sec id="Sec2">
    <title>Implementation</title>
    <p id="Par15">Let <italic>F</italic> = {<italic>F</italic><sub>0</sub>, <italic>F</italic><sub>1</sub>, …, <italic>F</italic><sub><italic>v</italic>-1</sub>} denotes a group of fastq files, <italic>R</italic><sub><italic>i</italic></sub> = {<inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${R}_{0}^{i}, {R}_{1}^{i}, {R}_{2}^{i}, \dots ,$$\end{document}</tex-math><mml:math id="M2"><mml:mrow><mml:msubsup><mml:mi>R</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mi>i</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>R</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mi>i</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>R</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mi>i</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5566_Article_IEq1.gif"/></alternatives></inline-formula>
<inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${R}_{\left(\left|{F}_{i}\right|/4\right)-1}^{i}$$\end{document}</tex-math><mml:math id="M4"><mml:msubsup><mml:mi>R</mml:mi><mml:mrow><mml:mfenced close=")" open="("><mml:mfenced close="|" open="|"><mml:msub><mml:mi>F</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfenced><mml:mo stretchy="false">/</mml:mo><mml:mn>4</mml:mn></mml:mfenced><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>i</mml:mi></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2023_5566_Article_IEq2.gif"/></alternatives></inline-formula>} denotes a collection of string short reads in the <italic>i</italic>-th fastq sequencing file, |<italic>F</italic><sub><italic>i</italic></sub>| denotes the number of lines in <italic>F</italic><sub><italic>i</italic></sub>, <italic>n</italic> denotes the average length of sequencing reads, <italic>Y</italic> represents the cascaded optimization compressor, <italic>U</italic><sub><italic>ram</italic></sub> represents the user-preset safe memory threshold (less than system memory), and <italic>K</italic> represents the number of clusters, where <italic>i</italic> = 0, 1, 2, …, <italic>v</italic>-1. The proposed optimization method PMFFRC includes two parts: sequencing file clustering (Section “<xref rid="Sec4" ref-type="sec">Sequencing files clustering</xref>”), joint compression and decompression (Section “<xref rid="Sec9" ref-type="sec">Joint compression and decompression</xref>”). PMFFRC benefits from the redundant short reads information entropy of similar fastq format sequencing files. Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Section S1 gives more details for theoretical entropy analysis.</p>
    <sec id="Sec3">
      <title>Sequencing files clustering</title>
      <p id="Par16">The PMFFRC optimizer achieves high compression ratios by clustering redundant reads together in different fastq files and increases cascaded compressor robustness by memory modeling. In the PMFFRC workflow, sequencing files clustering includes four stages. (i) Pre-compression: estimates the peak memory consumption on the overall fastq files by using random sampling technology. (ii) Feature extraction: converts short reads strings into numerical features, simplifying calculations and improving the optimization efficiency of PMFFRC. (iii) Similarity calculation: evaluates the similarity of each group file through the collection similarity assessment method. (iv) Fastq files clustering: ensures the algorithm robustness of the optimized compressor via a two-level clustering parameter selection strategy.</p>
      <sec id="Sec4">
        <title>Pre-compression</title>
        <p id="Par17">The purpose of pre-compression is to evaluate the maximum memory consumption of the compressed short reads data in dataset <italic>F</italic>. Let <italic>Y</italic><sub><italic>res</italic></sub> denotes the resident memory of compressor <italic>Y</italic> (such as dictionaries and hash tables), and <italic>Y</italic><sub><italic>reads</italic></sub> denotes the extra memory space opened for genomic sequencing reads. To evaluate compression peak memory <italic>Y</italic><sub><italic>cpm</italic></sub> = <italic>Y</italic><sub><italic>res</italic></sub> + <italic>Y</italic><sub><italic>reads</italic></sub> of <italic>Y</italic> on dataset <italic>F</italic>, PMFFRC performs the following steps:</p>
        <p id="Par18"><bold>Step 1</bold>: Randomly select <italic>x</italic><sub>1</sub> and <italic>x</italic><sub>2</sub> sets of sequencing data from <italic>F</italic><sub><italic>i</italic></sub> to construct pre-compression fastq files <italic>X</italic><sub>1</sub> = {<inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${x}_{0}^{1}$$\end{document}</tex-math><mml:math id="M6"><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mn>1</mml:mn></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2023_5566_Article_IEq3.gif"/></alternatives></inline-formula>, <inline-formula id="IEq4"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${x}_{1}^{1}$$\end{document}</tex-math><mml:math id="M8"><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mn>1</mml:mn></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2023_5566_Article_IEq4.gif"/></alternatives></inline-formula>, <inline-formula id="IEq5"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${x}_{2}^{1}$$\end{document}</tex-math><mml:math id="M10"><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mn>1</mml:mn></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2023_5566_Article_IEq5.gif"/></alternatives></inline-formula>, …, <inline-formula id="IEq6"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${x}_{{v\times x}_{1}-1}^{1}$$\end{document}</tex-math><mml:math id="M12"><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:msub><mml:mrow><mml:mi>v</mml:mi><mml:mo>×</mml:mo><mml:mi>x</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>1</mml:mn></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2023_5566_Article_IEq6.gif"/></alternatives></inline-formula>} and<italic> X</italic><sub>2</sub> = {<inline-formula id="IEq7"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${x}_{0}^{2}$$\end{document}</tex-math><mml:math id="M14"><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2023_5566_Article_IEq7.gif"/></alternatives></inline-formula>, <inline-formula id="IEq8"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${x}_{1}^{2}$$\end{document}</tex-math><mml:math id="M16"><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2023_5566_Article_IEq8.gif"/></alternatives></inline-formula>, <inline-formula id="IEq9"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${x}_{2}^{2}$$\end{document}</tex-math><mml:math id="M18"><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2023_5566_Article_IEq9.gif"/></alternatives></inline-formula>, …, <inline-formula id="IEq10"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${x}_{{v\times x}_{2}-1}^{2}$$\end{document}</tex-math><mml:math id="M20"><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:msub><mml:mrow><mml:mi>v</mml:mi><mml:mo>×</mml:mo><mml:mi>x</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2023_5566_Article_IEq10.gif"/></alternatives></inline-formula>}, each group <inline-formula id="IEq11"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${x}_{j}^{e}$$\end{document}</tex-math><mml:math id="M22"><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mi>e</mml:mi></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2023_5566_Article_IEq11.gif"/></alternatives></inline-formula> contains description information, sequencing reads, and quality scores, where <italic>j</italic> = 0, 1, 2, …, <italic>v</italic> × <italic>x</italic><sub><italic>e</italic></sub>-1, <italic>i</italic> = 0, 1, 2, …, <italic>v</italic>-1, <italic>x</italic><sub>2</sub> &gt;  &gt; <italic>x</italic><sub>1</sub> and <italic>e</italic> = 1, 2.</p>
        <p id="Par19"><bold>Step 2</bold>: Run compressor <italic>Y</italic> for pre-compressing datasets<italic> X</italic><sub>1</sub> and <italic>X</italic><sub>2</sub>, getting <italic>Y</italic>'s peak memory <inline-formula id="IEq12"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Y}_{peak}^{1}$$\end{document}</tex-math><mml:math id="M24"><mml:msubsup><mml:mi>Y</mml:mi><mml:mrow><mml:mi mathvariant="italic">peak</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2023_5566_Article_IEq12.gif"/></alternatives></inline-formula> and <inline-formula id="IEq13"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Y}_{peak}^{2}$$\end{document}</tex-math><mml:math id="M26"><mml:msubsup><mml:mi>Y</mml:mi><mml:mrow><mml:mi mathvariant="italic">peak</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2023_5566_Article_IEq13.gif"/></alternatives></inline-formula> on datasets <italic>X</italic><sub>1</sub> and <italic>X</italic><sub>2</sub>.</p>
        <p id="Par20"><bold>Step 3</bold>: Estimate the compression peak memory <italic>Y</italic><sub><italic>cpm</italic></sub> of algorithm <italic>Y</italic> on datasets <italic>F</italic> = {<italic>F</italic><sub>0</sub>, <italic>F</italic><sub>1</sub>, …, <italic>F</italic><sub><italic>v</italic>-1</sub>} according to the formula (<xref rid="Equ1" ref-type="disp-formula">1</xref>):<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Y_{cpm} = Y_{res} + Y_{reads} = Y_{peak}^{1} + \frac{{\left| {Y_{peak}^{2} - Y_{peak}^{1} } \right|}}{{v \times \left( {x_{2} - x_{1} } \right)}} \times \mathop \sum \limits_{i = 0}^{v} \frac{{\left| {F_{i} } \right|}}{4}$$\end{document}</tex-math><mml:math id="M28" display="block"><mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi mathvariant="italic">cpm</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi mathvariant="italic">res</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi mathvariant="italic">reads</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mi>Y</mml:mi><mml:mrow><mml:mi mathvariant="italic">peak</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:mfrac><mml:mfenced close="|" open="|"><mml:mrow><mml:msubsup><mml:mi>Y</mml:mi><mml:mrow><mml:mi mathvariant="italic">peak</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>-</mml:mo><mml:msubsup><mml:mi>Y</mml:mi><mml:mrow><mml:mi mathvariant="italic">peak</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msubsup></mml:mrow></mml:mfenced><mml:mrow><mml:mi>v</mml:mi><mml:mo>×</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mfrac><mml:mo>×</mml:mo><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mi>v</mml:mi></mml:munderover><mml:mfrac><mml:mfenced close="|" open="|"><mml:msub><mml:mi>F</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfenced><mml:mn>4</mml:mn></mml:mfrac></mml:mrow></mml:math><graphic xlink:href="12859_2023_5566_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula></p>
        <p id="Par21">In formula (<xref rid="Equ1" ref-type="disp-formula">1</xref>), |<italic>F</italic><sub><italic>i</italic></sub>|/4 denotes the total number of reads in <italic>F</italic><sub><italic>i</italic></sub>, where <italic>i</italic> = 0, 1, 2, …, <italic>v</italic>-1.</p>
      </sec>
      <sec id="Sec5">
        <title>Feature extraction</title>
        <p id="Par22">In pre-compression stage, PMFFRC estimated the maximum memory consumption <italic>Y</italic><sub><italic>cpm</italic></sub> of compressor <italic>Y</italic> on <italic>F</italic>. However, the calculated <italic>Y</italic><sub><italic>cpm</italic></sub> might exceed the system memory. Thus, PMFFRC compresses similar fastq files in batches via redundant reads clustering method, using reads' feature vectors and user-preset safe memory threshold. However, converting string reads to digitized feature vectors is time-consuming. Therefore, PMFFRC utilizes CPU multi-cores to accelerate this stage in parallel.</p>
        <p id="Par23">Let <italic>Pr</italic> denotes the number of utilized CPU cores, <inline-formula id="IEq14"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\overline{R} }_{i}$$\end{document}</tex-math><mml:math id="M30"><mml:msub><mml:mover><mml:mi>R</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5566_Article_IEq14.gif"/></alternatives></inline-formula>= [<inline-formula id="IEq15"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\dot{R}}_{0}^{i},{\dot{R}}_{1}^{i},{\dot{R}}_{2}^{i},\dots ,{\dot{R}}_{\left(\left|{F}_{i}\right|/4\right)-1}^{i}$$\end{document}</tex-math><mml:math id="M32"><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>R</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mi>i</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi>R</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mi>i</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi>R</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mi>i</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi>R</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mrow><mml:mfenced close=")" open="("><mml:mfenced close="|" open="|"><mml:msub><mml:mi>F</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfenced><mml:mo stretchy="false">/</mml:mo><mml:mn>4</mml:mn></mml:mfenced><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>i</mml:mi></mml:msubsup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5566_Article_IEq15.gif"/></alternatives></inline-formula>] denotes a numeral feature vector of <italic>R</italic><sub><italic>i</italic></sub>, and <inline-formula id="IEq16"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\dot{R}}_{j}^{i}$$\end{document}</tex-math><mml:math id="M34"><mml:msubsup><mml:mover accent="true"><mml:mi>R</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2023_5566_Article_IEq16.gif"/></alternatives></inline-formula> is the feature value of read <inline-formula id="IEq17"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${R}_{j}^{i}$$\end{document}</tex-math><mml:math id="M36"><mml:msubsup><mml:mi>R</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2023_5566_Article_IEq17.gif"/></alternatives></inline-formula>. Referring to the design idea of the reads scoring model in FastqCLS [<xref ref-type="bibr" rid="CR25">25</xref>], PMFFRC employs <italic>Pr</italic> CPU cores to extract sequencing reads feature values in parallel through the data cycle division strategy [<xref ref-type="bibr" rid="CR27">27</xref>], as shown in the formula (<xref rid="Equ2" ref-type="disp-formula">2</xref>):<disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\dot{R}_{j}^{i,p} = \mathop \prod \limits_{e = 0}^{3} \left( {\mathop \sum \limits_{r = 0}^{{\left| {R_{j}^{i,p} } \right|}} I\left( {R_{j}^{i,p} \left[ r \right] = E\left[ e \right]} \right) + 1} \right)/n$$\end{document}</tex-math><mml:math id="M38" display="block"><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>R</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:munderover><mml:mo movablelimits="false">∏</mml:mo><mml:mrow><mml:mi>e</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mn>3</mml:mn></mml:munderover><mml:mfenced close=")" open="("><mml:mrow><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mfenced close="|" open="|"><mml:msubsup><mml:mi>R</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:msubsup></mml:mfenced></mml:munderover><mml:mi>I</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msubsup><mml:mi>R</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:msubsup><mml:mfenced close="]" open="["><mml:mi>r</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:mi>E</mml:mi><mml:mfenced close="]" open="["><mml:mi>e</mml:mi></mml:mfenced></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced><mml:mo stretchy="false">/</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math><graphic xlink:href="12859_2023_5566_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula></p>
        <p id="Par24">In formula (<xref rid="Equ2" ref-type="disp-formula">2</xref>), <italic>E</italic> = {A, C, G, T}, <inline-formula id="IEq18"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I\left({R}_{j}^{i,p}\left[r\right]=E\left[e\right]\right)$$\end{document}</tex-math><mml:math id="M40"><mml:mrow><mml:mi>I</mml:mi><mml:mfenced close=")" open="("><mml:msubsup><mml:mi>R</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:msubsup><mml:mfenced close="]" open="["><mml:mi>r</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:mi>E</mml:mi><mml:mfenced close="]" open="["><mml:mi>e</mml:mi></mml:mfenced></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5566_Article_IEq18.gif"/></alternatives></inline-formula> is an indicator function, <italic>p</italic> denotes the <italic>p</italic>-th CPU core, and <italic>p</italic> = <italic>i</italic> % <italic>Pr</italic>, where <italic>j</italic> = 0, 1, 2, …,<inline-formula id="IEq19"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left(\left|{F}_{i}\right|/4\right)$$\end{document}</tex-math><mml:math id="M42"><mml:mfenced close=")" open="("><mml:mfenced close="|" open="|"><mml:msub><mml:mi>F</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfenced><mml:mo stretchy="false">/</mml:mo><mml:mn>4</mml:mn></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2023_5566_Article_IEq19.gif"/></alternatives></inline-formula>-1, <italic>i</italic> = 0, 1, 2, …, <italic>v</italic>-1.</p>
      </sec>
      <sec id="Sec6">
        <title>Similarity calculation</title>
        <p id="Par25">After obtaining the feature vector <inline-formula id="IEq20"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\overline{R} }_{i}$$\end{document}</tex-math><mml:math id="M44"><mml:msub><mml:mover><mml:mi>R</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5566_Article_IEq20.gif"/></alternatives></inline-formula>= [<inline-formula id="IEq21"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\dot{R}}_{0}^{i},{\dot{ R}}_{1}^{i},{ \dot{R}}_{2}^{i}, \dots ,{\dot{ R}}_{\left(\left|{F}_{i}\right|/4\right)-1}^{i}$$\end{document}</tex-math><mml:math id="M46"><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>R</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mi>i</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi>R</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mi>i</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi>R</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mi>i</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi>R</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mrow><mml:mfenced close=")" open="("><mml:mfenced close="|" open="|"><mml:msub><mml:mi>F</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfenced><mml:mo stretchy="false">/</mml:mo><mml:mn>4</mml:mn></mml:mfenced><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>i</mml:mi></mml:msubsup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5566_Article_IEq21.gif"/></alternatives></inline-formula>] of <italic>R</italic><sub><italic>i</italic></sub> in <italic>F</italic><sub><italic>i</italic></sub>, PMFFRC evaluates the redundant reads similarity between different fastq files. Let <italic>S</italic> denotes a similarity collection of feature vectors <inline-formula id="IEq22"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\overline{R} }_{a}$$\end{document}</tex-math><mml:math id="M48"><mml:msub><mml:mover><mml:mi>R</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mi>a</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5566_Article_IEq22.gif"/></alternatives></inline-formula> and <inline-formula id="IEq23"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\overline{R} }_{b}$$\end{document}</tex-math><mml:math id="M50"><mml:msub><mml:mover><mml:mi>R</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mi>b</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5566_Article_IEq23.gif"/></alternatives></inline-formula>. In practical scenarios, the data scale between <italic>F</italic><sub><italic>a</italic></sub> and <italic>F</italic><sub><italic>b</italic></sub> is unbalanced, usually. To offset the impact of fastq file size differences on similarity calculation between <italic>F</italic><sub><italic>a</italic></sub> and <italic>F</italic><sub><italic>b</italic></sub>, PMFFRC introduces correction parameters <italic>α</italic> and dice coefficient [<xref ref-type="bibr" rid="CR28">28</xref>], uses <italic>Pr</italic> CPU cores, and improves the parallel similarity calculation model as shown in formula (<xref rid="Equ3" ref-type="disp-formula">3</xref>):<disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$sim\left({\overline{R} }_{a}^{p},{\overline{R} }_{b}^{p}\right)=\alpha \times \frac{2\times \left|{\overline{R} }_{a}^{p}\cap {\overline{R} }_{b}^{p}\right|}{\left|{\overline{R} }_{a}^{p}\right|+\left|{\overline{R} }_{b}^{p}\right|}$$\end{document}</tex-math><mml:math id="M52" display="block"><mml:mrow><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>m</mml:mi><mml:mfenced close=")" open="("><mml:msubsup><mml:mover><mml:mi>R</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mi>p</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mover><mml:mi>R</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mi>p</mml:mi></mml:msubsup></mml:mfenced><mml:mo>=</mml:mo><mml:mi>α</mml:mi><mml:mo>×</mml:mo><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mo>×</mml:mo><mml:mfenced close="|" open="|"><mml:msubsup><mml:mover><mml:mi>R</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mi>p</mml:mi></mml:msubsup><mml:mo>∩</mml:mo><mml:msubsup><mml:mover><mml:mi>R</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mi>p</mml:mi></mml:msubsup></mml:mfenced></mml:mrow><mml:mrow><mml:mfenced close="|" open="|"><mml:msubsup><mml:mover><mml:mi>R</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mi>p</mml:mi></mml:msubsup></mml:mfenced><mml:mo>+</mml:mo><mml:mfenced close="|" open="|"><mml:msubsup><mml:mover><mml:mi>R</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mi>p</mml:mi></mml:msubsup></mml:mfenced></mml:mrow></mml:mfrac></mml:mrow></mml:math><graphic xlink:href="12859_2023_5566_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula></p>
        <p id="Par26">In formula (<xref rid="Equ3" ref-type="disp-formula">3</xref>), <inline-formula id="IEq24"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$sim({\overline{R} }_{a}, {\overline{R} }_{b})$$\end{document}</tex-math><mml:math id="M54"><mml:mrow><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>m</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mover><mml:mi>R</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mi>a</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mover><mml:mi>R</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mi>b</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5566_Article_IEq24.gif"/></alternatives></inline-formula> denotes the similarity value between the feature vectors <inline-formula id="IEq25"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\overline{R} }_{a}$$\end{document}</tex-math><mml:math id="M56"><mml:msub><mml:mover><mml:mi>R</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mi>a</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5566_Article_IEq25.gif"/></alternatives></inline-formula> and <inline-formula id="IEq26"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\overline{R} }_{b}$$\end{document}</tex-math><mml:math id="M58"><mml:msub><mml:mover><mml:mi>R</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mi>b</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5566_Article_IEq26.gif"/></alternatives></inline-formula>. Where <inline-formula id="IEq27"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha =1/(1-\frac{\left|\left|{\overline{R} }_{a}^{p}\right|-\left|{\overline{R} }_{b}^{p}\right|\right|}{\left|{\overline{R} }_{a}^{p}\right|+\left|{\overline{R} }_{b}^{p}\right|})$$\end{document}</tex-math><mml:math id="M60"><mml:mrow><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mfrac><mml:mfenced close="|" open="|"><mml:mfenced close="|" open="|"><mml:msubsup><mml:mover><mml:mi>R</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mi>p</mml:mi></mml:msubsup></mml:mfenced><mml:mo>-</mml:mo><mml:mfenced close="|" open="|"><mml:msubsup><mml:mover><mml:mi>R</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mi>p</mml:mi></mml:msubsup></mml:mfenced></mml:mfenced><mml:mrow><mml:mfenced close="|" open="|"><mml:msubsup><mml:mover><mml:mi>R</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mi>p</mml:mi></mml:msubsup></mml:mfenced><mml:mo>+</mml:mo><mml:mfenced close="|" open="|"><mml:msubsup><mml:mover><mml:mi>R</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mi>p</mml:mi></mml:msubsup></mml:mfenced></mml:mrow></mml:mfrac><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5566_Article_IEq27.gif"/></alternatives></inline-formula>, <italic>p</italic> = <italic>s</italic> % <italic>Pr</italic>, <italic>s</italic> = 0, 1, 2, …, |<italic>S</italic>|-1, |<italic>S</italic>|= <inline-formula id="IEq28"><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\frac{v\times (v-1)}{2}$$\end{document}</tex-math><mml:math id="M62"><mml:mfrac><mml:mrow><mml:mi>v</mml:mi><mml:mo>×</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>v</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:mfrac></mml:math><inline-graphic xlink:href="12859_2023_5566_Article_IEq28.gif"/></alternatives></inline-formula>, <italic>a</italic> = 1, 2, 3, …, <italic>v</italic>-1, <italic>b</italic> = 0, 1, 2, …, <italic>v</italic>-2, and<italic> a</italic> &gt; <italic>b</italic>.</p>
      </sec>
      <sec id="Sec7">
        <title>Fastq files clustering</title>
        <p id="Par27">For computing friendly, PMFFRC converts the string reads files into numerical vectors to calculate <italic>S</italic> via formula (<xref rid="Equ3" ref-type="disp-formula">3</xref>). After that, it sorts <italic>S</italic> in descending order using the quicksort algorithm [<xref ref-type="bibr" rid="CR29">29</xref>] and performs fastq files clustering. In order to select an appropriate parameter <italic>K</italic>, PMFFRC utilizes a two-level clustering parameter selection strategy. Specifically, PMFFRC first determines the files-level parameter <italic>K</italic><sub>1</sub> and then slightly adjusts it to get the reads-level parameter <italic>K</italic><sub>2</sub>.</p>
        <p id="Par28">In actual experimental observations, the peak memory <italic>Y</italic><sub>cpm</sub> of <italic>Y</italic> shows a nonlinear growth trend with the fastq data scale growth of <italic>F</italic> in some cases (such as FastqCLS). Considering algorithm robustness, by modeling <italic>U</italic><sub><italic>ram</italic></sub> and <italic>Y</italic><sub><italic>cpm</italic></sub>, PMFFRC introduces an empirical correction factor <italic>β</italic> to artificial-fixed the files-level clustering parameter <italic>K</italic><sub>1</sub>, the calculation model as shown in formula (<xref rid="Equ4" ref-type="disp-formula">4</xref>):<disp-formula id="Equ4"><label>4</label><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${K}_{1}=\lceil\beta \times \frac{{Y}_{reads}}{{U}_{ram}-{Y}_{res}}\rceil$$\end{document}</tex-math><mml:math id="M64" display="block"><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>⌈</mml:mo><mml:mi>β</mml:mi><mml:mo>×</mml:mo><mml:mfrac><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi mathvariant="italic">reads</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:msub><mml:mi>U</mml:mi><mml:mrow><mml:mi mathvariant="italic">ram</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi mathvariant="italic">res</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>⌉</mml:mo></mml:mrow></mml:mrow></mml:math><graphic xlink:href="12859_2023_5566_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula></p>
        <p id="Par29">In formula (<xref rid="Equ4" ref-type="disp-formula">4</xref>), the parameter <italic>K</italic><sub>1</sub> represents the number of files-level clusters determined by the memory modeling method. However, there is a significant variation in the number of reads across different sequencing files. When the number of short reads within a cluster becomes too large, it may exceed the predefined memory threshold <italic>U</italic><sub><italic>ram</italic></sub> for compression. Therefore, optimizer PMFFRC dynamically adjusts t <italic>K</italic><sub>1</sub> to get the number of clusters <italic>K</italic><sub>2</sub> at reads-level as the final clustering parameter <italic>K</italic>.</p>
        <p id="Par30">Figure <xref rid="Fig1" ref-type="fig">1</xref> illustrates the clustering of five sequencing fastq files using the proposed two-level (where <italic>v</italic> = 5 and <italic>K</italic><sub>1</sub> = 2) clustering parameter selection strategy.<fig id="Fig1"><label>Fig.1</label><caption><p>Example of clustering fastq files using a two-level parameter selection strategy</p></caption><graphic xlink:href="12859_2023_5566_Fig1_HTML" id="MO1"/></fig></p>
        <p id="Par31">In Fig. <xref rid="Fig1" ref-type="fig">1</xref>, <italic>K</italic><sub>1</sub> = 2, and <italic>M</italic> = 1060 denotes the overall reads number. According to <italic>K</italic><sub>1</sub> and <italic>M</italic>, PMFFRC gets the average number of reads in each cluster as <italic>ave</italic> =<inline-formula id="IEq29"><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lfloor {{M}/{K}_{1} } \rfloor$$\end{document}</tex-math><mml:math id="M66"><mml:mrow><mml:mo>⌊</mml:mo><mml:mrow><mml:mi>M</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo>⌋</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5566_Article_IEq29.gif"/></alternatives></inline-formula>  = 530. However, the value of <italic>ave</italic> is calculated under the <italic>K</italic><sub>1</sub> condition, and due to significant variations of the reads number in different fastq files, it is challenging for the optimizer PMFFRC to achieve the ideal reads number average state for each cluster. Therefore, PMFFRC fine-tunes at the reads level to ensure that the actual number of reads within each cluster is close to the <italic>ave</italic> value. Figure <xref rid="Fig1" ref-type="fig">1</xref>a shows the similarity matrix calculated from formula (<xref rid="Equ3" ref-type="disp-formula">3</xref>). In Fig. <xref rid="Fig1" ref-type="fig">1</xref>b, our optimizer PMFFRC initiates the analysis from the matrix element with the highest similarity score and employs a straightforward "first cluster first priority" principle when clustering fastq files. This straightforward implementation strategy guarantees an overall time advantage for the optimizer. PMFFR first detects that max(<italic>S</italic>) is <italic>sim</italic>(<inline-formula id="IEq30"><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\overline{R} }_{3}, {\overline{R} }_{0}$$\end{document}</tex-math><mml:math id="M68"><mml:mrow><mml:msub><mml:mover><mml:mi>R</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mn>3</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mover><mml:mi>R</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5566_Article_IEq30.gif"/></alternatives></inline-formula>) = 0.92, which indicates the redundant reads between fastq files <italic>F</italic><sub>3</sub> and <italic>F</italic><sub>0</sub> have the highest similarity, so it adds <italic>F</italic><sub>0</sub> and <italic>F</italic><sub>3</sub> to the cluster <italic>C</italic><sub>0</sub>. Then, PMFFRC calculates the total number of reads |<italic>C</italic><sub>0</sub>| is 340 in <italic>C</italic><sub>0</sub>, which is less than <italic>ave</italic>, so it tries to add the fastq file<italic> F</italic><sub>1</sub> in <italic>C</italic><sub>0</sub>. However, |<italic>C</italic><sub>0</sub>| is 650 at this time, which is greater than <italic>ave</italic>, so it discards <italic>F</italic><sub>1</sub> and obtains the first cluster <italic>C</italic><sub>0</sub> = {<italic>F</italic><sub>0</sub>, <italic>F</italic><sub>3</sub>}. After the above steps, the first cluster <italic>C</italic><sub>0</sub> has been received. Thus, PMFFRC removes the elements in collection <italic>C</italic><sub>0</sub> from the similarity matrix and selects the second cluster files. In Fig. <xref rid="Fig1" ref-type="fig">1</xref>c, d, after the first cluster has been built, the remaining components are <italic>sim</italic>(<inline-formula id="IEq31"><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\overline{R} }_{2}, {\overline{R} }_{1}$$\end{document}</tex-math><mml:math id="M70"><mml:mrow><mml:msub><mml:mover><mml:mi>R</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mover><mml:mi>R</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5566_Article_IEq31.gif"/></alternatives></inline-formula>), <italic>sim</italic>(<inline-formula id="IEq32"><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\overline{R} }_{4}, {\overline{R} }_{1}$$\end{document}</tex-math><mml:math id="M72"><mml:mrow><mml:msub><mml:mover><mml:mi>R</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mn>4</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mover><mml:mi>R</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5566_Article_IEq32.gif"/></alternatives></inline-formula>), <italic>sim</italic>(<inline-formula id="IEq33"><alternatives><tex-math id="M73">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\overline{R} }_{4}, {\overline{R} }_{2}$$\end{document}</tex-math><mml:math id="M74"><mml:mrow><mml:msub><mml:mover><mml:mi>R</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mn>4</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mover><mml:mi>R</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5566_Article_IEq33.gif"/></alternatives></inline-formula>), and <italic>sim</italic>(<inline-formula id="IEq34"><alternatives><tex-math id="M75">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\overline{R} }_{4}, {\overline{R} }_{3}$$\end{document}</tex-math><mml:math id="M76"><mml:mrow><mml:msub><mml:mover><mml:mi>R</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mn>4</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mover><mml:mi>R</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5566_Article_IEq34.gif"/></alternatives></inline-formula>), where <italic>sim</italic>(<inline-formula id="IEq35"><alternatives><tex-math id="M77">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\overline{R} }_{4}, {\overline{R} }_{1}$$\end{document}</tex-math><mml:math id="M78"><mml:mrow><mml:msub><mml:mover><mml:mi>R</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mn>4</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mover><mml:mi>R</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5566_Article_IEq35.gif"/></alternatives></inline-formula>) = 0.90 is the highest similarity score. Therefore, PMFFRC adds <italic>F</italic><sub>4</sub> and <italic>F</italic><sub>1</sub> to a new cluster <italic>C</italic><sub>1</sub>. Now, |<italic>C</italic><sub>1</sub>|= 460, which is less than <italic>ave</italic>. If PMFFRC adds <italic>F</italic><sub>2</sub> to cluster <italic>C</italic><sub>1</sub>, |<italic>C</italic><sub>1</sub>| will exceed <italic>ave</italic>. Consequently, PMFFRC ends the second clustering stage to obtain cluster <italic>C</italic><sub>1</sub> = {<italic>F</italic><sub>1</sub>, <italic>F</italic><sub>4</sub>} and adds fastq file <italic>F</italic><sub>2</sub> to another cluster <italic>C</italic><sub>2</sub> = {<italic>F</italic><sub>2</sub>}.</p>
        <p id="Par32">Via user-preset safe memory threshold and reads feature vectors, PMFFRC clusters similar fastq files together. Thus, the high-similarity files in the same cluster generate more highly similar redundant reads, which is more helpful for subsequent cascaded compressors. Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Algorithm S1 summarizes the proposed optimization method PMFFRC. Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Section S2 details the algorithm description and analysis.</p>
      </sec>
    </sec>
    <sec id="Sec8">
      <title>Joint compression and decompression</title>
      <p id="Par33">When obtaining the cluster record files, <italic>C</italic><sub><italic>k</italic></sub>.info, of the sequencing files collection <italic>F</italic> = {<italic>F</italic><sub>0</sub>, <italic>F</italic><sub>1</sub>, …, <italic>F</italic><sub><italic>v</italic>-1</sub>}, the fastq files in each cluster <italic>C</italic><sub><italic>k</italic></sub> are merged according to temp files <italic>C</italic><sub><italic>k</italic></sub>.info, where <italic>k</italic> = 0, 1, 2,…, <italic>K</italic>-1. After that, dedicated state-of-the-art short reads compressors can be used to compress these clustered files.</p>
      <p id="Par34">The PMFFRC optimizer further improves the compression ratio for the optimized algorithm on the cluster files at the joint compression and decompression phase. Due to its heightened scalability, PMFFRC can be applied to the latest short reads compressors. To better embody the optimization idea, Fig. <xref rid="Fig2" ref-type="fig">2</xref> shows the overall processing workflow of the PMFFRC optimizes algorithm <italic>Y</italic> to compress and decompress fastq format files collection<italic> F</italic> = {<italic>F</italic><sub>0</sub>, <italic>F</italic><sub>1</sub>, …, <italic>F</italic><sub><italic>v</italic>-1</sub>}.<fig id="Fig2"><label>Fig. 2</label><caption><p>The overall processing workflow of the optimized cascaded compressor <italic>Y</italic> via PMFFRC, on fastq format sequencing files collection <italic>F</italic></p></caption><graphic xlink:href="12859_2023_5566_Fig2_HTML" id="MO2"/></fig></p>
      <p id="Par35">In Fig. <xref rid="Fig2" ref-type="fig">2</xref>a, <italic>C</italic><sub><italic>k</italic></sub>.ycom is the compressed files by compressor <italic>Y</italic>, and the *.pmffrc file is the optimized compressed files, where <italic>k</italic> = 0, 1, 2, …, <italic>K</italic>-1. In Fig. <xref rid="Fig2" ref-type="fig">2</xref>b, <italic>F</italic><sub><italic>i</italic></sub>.reads denote the recovered files corresponding to <italic>F</italic><sub><italic>i</italic></sub>.fastq, where <italic>i</italic> = 0, 1, 2, …, <italic>v</italic>-1.</p>
    </sec>
  </sec>
  <sec id="Sec9">
    <title>Results</title>
    <sec id="Sec10">
      <title>Experimental configuration and datasets</title>
      <p id="Par36">Evaluation experiments were carried out on a Sugon-7000A supercomputer system of the National High-Performance Computing Center Nanning Branch (<ext-link ext-link-type="uri" xlink:href="https://hpc.gxu.edu.cn">https://hpc.gxu.edu.cn</ext-link>). Computing nodes are equipped with 2*Intel Xeon Gold 6230 CPU (2.1 Ghz, 40 cores), 512 GB DDR4 SDRAM, and 8*900 GB disk space. The experimental node runs the 64-bit version of centos 7.4. The PMFFRC was implemented by C +  + 11 and OpenMP. The overall workflow has been encapsulated into the PMFFRC toolkit. Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Section S3 gives the installation and configuration details of the PMFFRC optimizer. The PMFFRC toolkit follows the Apache-2.0 License, available freely at <ext-link ext-link-type="uri" xlink:href="https://github.com/fahaihi/PMFFRC">https://github.com/fahaihi/PMFFRC</ext-link>.</p>
      <p id="Par37">Three large-scale datasets from the NCBI (<ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/sra">https://www.ncbi.nlm.nih.gov/sra</ext-link>) database were used to assess optimization effects. For paired-end sequencing files, PMFFRC arranges them as two separate single-end files. Table <xref rid="Tab1" ref-type="table">1</xref> gives the details of the experimental datasets.<table-wrap id="Tab1"><label>Table 1</label><caption><p>Datasets used for optimizing large-scale genomic sequencing reads compression</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Dataset name (species)</th><th align="left">Sequencing platform (method)</th><th align="left">Number of reads (millions)</th><th align="left">Total size (GB)</th><th align="left">Reads size (GB)</th><th align="left">Length (bp)</th><th align="left">Number of files</th></tr></thead><tbody><tr><td align="left"><italic>Homo sapiens</italic></td><td align="left">NextSeq-550 (SE)</td><td char="." align="char">507.40</td><td char="." align="char">111.25</td><td char="." align="char">36.78</td><td align="left">75</td><td align="left">24</td></tr><tr><td align="left"><italic>Cicer arietinum</italic></td><td align="left">HiSeq-2000 (PE)</td><td char="." align="char">2060.96</td><td char="." align="char">680.60</td><td char="." align="char">178.54</td><td align="left">90</td><td align="left">60</td></tr><tr><td align="left"><italic>Salvelinus fontinalis</italic></td><td align="left">Ion-Torrent (SE)</td><td char="." align="char">757.46</td><td char="." align="char">189.66</td><td char="." align="char">58.14</td><td align="left">80</td><td align="left">360</td></tr><tr><td align="left">Total</td><td align="left">–</td><td char="." align="char">3325.82</td><td char="." align="char">981.52</td><td char="." align="char">273.46</td><td align="left">–</td><td align="left">444</td></tr></tbody></table><table-wrap-foot><p>Datasets download by employing sra-tools (<ext-link ext-link-type="uri" xlink:href="https://github.com/ncbi/sra-tools">https://github.com/ncbi/sra-tools</ext-link>). For complete NCBI registration numbers, see Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Section S4</p></table-wrap-foot></table-wrap></p>
      <p id="Par38">The proposed algorithm PMFFRC was tested on three large-scale datasets, and its compression size (<italic>cs</italic>), compression ratio (<italic>cr</italic>), compression peak memory (<italic>cpm</italic>), compression time (<italic>ct</italic>), decompression time (<italic>dt</italic>), and decompression peak memory (<italic>dpm</italic>) were compared to most state-of-the-art and reference-free reads compressors, more specifically, HARC [<xref ref-type="bibr" rid="CR14">14</xref>], SPRING [<xref ref-type="bibr" rid="CR17">17</xref>], Mstcom [<xref ref-type="bibr" rid="CR22">22</xref>] and FastqCLS [<xref ref-type="bibr" rid="CR25">25</xref>]. We also employed the compression ratio gains (<italic>crg</italic>) and percent storage savings (<italic>pss</italic>) to evaluate the optimization results. The <italic>crg</italic> and <italic>pss</italic> calculations are as follows:<disp-formula id="Equ5"><label>5</label><alternatives><tex-math id="M79">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$crg = \frac{cr\_with\_PMFFRC}{{cr\_without\_PMFFRC}} - 1$$\end{document}</tex-math><mml:math id="M80" display="block"><mml:mrow><mml:mi>c</mml:mi><mml:mi>r</mml:mi><mml:mi>g</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>c</mml:mi><mml:mi>r</mml:mi><mml:mi>_</mml:mi><mml:mi>w</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi><mml:mi>h</mml:mi><mml:mi>_</mml:mi><mml:mi>P</mml:mi><mml:mi>M</mml:mi><mml:mi>F</mml:mi><mml:mi>F</mml:mi><mml:mi>R</mml:mi><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mi>r</mml:mi><mml:mi>_</mml:mi><mml:mi>w</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi><mml:mi>h</mml:mi><mml:mi>o</mml:mi><mml:mi>u</mml:mi><mml:mi>t</mml:mi><mml:mi>_</mml:mi><mml:mi>P</mml:mi><mml:mi>M</mml:mi><mml:mi>F</mml:mi><mml:mi>F</mml:mi><mml:mi>R</mml:mi><mml:mi>C</mml:mi></mml:mrow></mml:mfrac><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><graphic xlink:href="12859_2023_5566_Article_Equ5.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ6"><label>6</label><alternatives><tex-math id="M81">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$pss = 1 - \frac{cs\_with\_PMFFRC}{{cs\_without\_PMFFRC}}$$\end{document}</tex-math><mml:math id="M82" display="block"><mml:mrow><mml:mi>p</mml:mi><mml:mi>s</mml:mi><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:mi>c</mml:mi><mml:mi>s</mml:mi><mml:mi>_</mml:mi><mml:mi>w</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi><mml:mi>h</mml:mi><mml:mi>_</mml:mi><mml:mi>P</mml:mi><mml:mi>M</mml:mi><mml:mi>F</mml:mi><mml:mi>F</mml:mi><mml:mi>R</mml:mi><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mi>s</mml:mi><mml:mi>_</mml:mi><mml:mi>w</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi><mml:mi>h</mml:mi><mml:mi>o</mml:mi><mml:mi>u</mml:mi><mml:mi>t</mml:mi><mml:mi>_</mml:mi><mml:mi>P</mml:mi><mml:mi>M</mml:mi><mml:mi>F</mml:mi><mml:mi>F</mml:mi><mml:mi>R</mml:mi><mml:mi>C</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:math><graphic xlink:href="12859_2023_5566_Article_Equ6.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par39">All experiments assume the compression server has a maximum memory of 300 GB and utilizes the default 8 CPU cores for joint compression and decompression.</p>
    </sec>
    <sec id="Sec11">
      <title>Performance on Homo sapiens dataset</title>
      <p id="Par40">Table <xref rid="Tab2" ref-type="table">2</xref> shows the results for HARC, SPRING, Mstcom, and FastqCLS using the proposed algorithm PMFFRC on the <italic>H. sapiens</italic> dataset.<table-wrap id="Tab2"><label>Table 2</label><caption><p>Performance of PMFFRC on <italic>H. sapiens</italic> dataset</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" rowspan="2">Algorithm</th><th align="left" rowspan="2">Parameter</th><th align="left" colspan="6">Compression</th><th align="left" colspan="2">Decompression</th></tr><tr><th align="left"><italic>cs</italic> (GB)</th><th align="left"><italic>pss</italic> (%)</th><th align="left"><italic>cr</italic> (bits/base)</th><th align="left"><italic>crg</italic> (%)</th><th align="left"><italic>cpm</italic> (GB)</th><th align="left"><italic>ct</italic> (h)</th><th align="left"><italic>dpm</italic> (GB)</th><th align="left"><italic>dt</italic> (h)</th></tr></thead><tbody><tr><td align="left" rowspan="3">HARC</td><td align="left"><italic>Without</italic></td><td char="." align="char">7.15</td><td align="left">–</td><td char="." align="char">1.61</td><td align="left">–</td><td char="." align="char">1.78</td><td align="left">1.37</td><td char="." align="char">1.57</td><td char="." align="char">1.51</td></tr><tr><td align="left">-<italic>u</italic>10, <italic>k</italic>3</td><td char="." align="char">4.68</td><td align="left"><bold>34.55</bold></td><td char="." align="char">1.06</td><td align="left"><bold>52.77</bold></td><td char="." align="char">9.49</td><td align="left"><bold>1.29</bold></td><td char="." align="char">5.22</td><td char="." align="char">1.65</td></tr><tr><td align="left">-<italic>u</italic>20, <italic>k</italic>1</td><td char="." align="char">3.27</td><td align="left"><bold>45.74</bold></td><td char="." align="char">0.74</td><td align="left"><bold>118.54</bold></td><td char="." align="char">19.61</td><td align="left"><bold>1.01</bold></td><td char="." align="char">5.89</td><td char="." align="char">1.74</td></tr><tr><td align="left" rowspan="4">SPRING</td><td align="left"><italic>Without</italic></td><td char="." align="char">7.16</td><td align="left">–</td><td char="." align="char">1.62</td><td align="left">–</td><td char="." align="char">3.64</td><td align="left">0.97</td><td char="." align="char">1.22</td><td char="." align="char">0.26</td></tr><tr><td align="left">-<italic>u</italic>10, <italic>k</italic>4</td><td char="." align="char">4.75</td><td align="left"><bold>33.66</bold></td><td char="." align="char">1.07</td><td align="left"><bold>50.68</bold></td><td char="." align="char">7.09</td><td align="left">1.39</td><td char="." align="char">2.85</td><td char="." align="char"><bold>0.19</bold></td></tr><tr><td align="left">-<italic>u</italic>20, <italic>k</italic>3</td><td char="." align="char">4.19</td><td align="left"><bold>41.48</bold></td><td char="." align="char">0.95</td><td align="left"><bold>70.91</bold></td><td char="." align="char">10.29</td><td align="left">1.26</td><td char="." align="char">4.63</td><td char="." align="char"><bold>0.22</bold></td></tr><tr><td align="left">-<italic>u</italic>40, <italic>k</italic>1</td><td char="." align="char">3.16</td><td align="left"><bold>55.87</bold></td><td char="." align="char">0.71</td><td align="left"><bold>126.95</bold></td><td char="." align="char">20.71</td><td align="left">1.20</td><td char="." align="char">4.95</td><td char="." align="char"><bold>0.23</bold></td></tr><tr><td align="left" rowspan="4">Mstcom</td><td align="left"><italic>Without</italic></td><td char="." align="char">6.13</td><td align="left">–</td><td char="." align="char">1.38</td><td align="left">–</td><td char="." align="char">13.60</td><td align="left">8.97</td><td char="." align="char">6.22</td><td char="." align="char">1.32</td></tr><tr><td align="left">-<italic>u</italic>40, <italic>k</italic>4</td><td char="." align="char">5.70</td><td align="left"><bold>7.01</bold></td><td char="." align="char">1.29</td><td align="left"><bold>7.50</bold></td><td char="." align="char">38.09</td><td align="left">12.25</td><td char="." align="char">33.71</td><td char="." align="char">1.51</td></tr><tr><td align="left">-<italic>u</italic>80, <italic>k</italic>3</td><td char="." align="char">3.72</td><td align="left"><bold>39.31</bold></td><td char="." align="char">0.84</td><td align="left"><bold>64.57</bold></td><td char="." align="char">53.71</td><td align="left">10.24</td><td char="." align="char">69.08</td><td char="." align="char"><bold>0.94</bold></td></tr><tr><td align="left">-<italic>u</italic>120, <italic>k</italic>1</td><td char="." align="char">2.94</td><td align="left"><bold>52.04</bold></td><td char="." align="char">0.66</td><td align="left"><bold>108.51</bold></td><td char="." align="char">107.39</td><td align="left">10:91</td><td char="." align="char">69.08</td><td char="." align="char"><bold>0.82</bold></td></tr><tr><td align="left" rowspan="4">FastqCLS</td><td align="left"><italic>Without</italic></td><td char="." align="char">7.99</td><td align="left">–</td><td char="." align="char">1.80</td><td align="left">–</td><td char="." align="char">23.08</td><td align="left">8.46</td><td char="." align="char">5.32</td><td char="." align="char">5.08</td></tr><tr><td align="left">-<italic>u</italic>40, <italic>k</italic>4</td><td char="." align="char">7.98</td><td align="left"><bold>0.13</bold></td><td char="." align="char">1.80</td><td align="left"><bold>0.22</bold></td><td char="." align="char">35.35</td><td align="left"><bold>6.88</bold></td><td char="." align="char">6.45</td><td char="." align="char">5.34</td></tr><tr><td align="left">-<italic>u</italic>80, <italic>k</italic>3</td><td char="." align="char">7.89</td><td align="left"><bold>1.25</bold></td><td char="." align="char">1.78</td><td align="left"><bold>1.24</bold></td><td char="." align="char">35.43</td><td align="left"><bold>6.76</bold></td><td char="." align="char">6.47</td><td char="." align="char">5.31</td></tr><tr><td align="left">-<italic>u</italic>120, <italic>k</italic>1</td><td char="." align="char">7.63</td><td align="left"><bold>4.51</bold></td><td char="." align="char">1.72</td><td align="left"><bold>4.76</bold></td><td char="." align="char">35.48</td><td align="left"><bold>7.12</bold></td><td char="." align="char">6.46</td><td char="." align="char">5.36</td></tr></tbody></table><table-wrap-foot><p>The parameter without indicates that the PMFFRC algorithm is not used for compression optimization. (-<italic>u</italic>10, <italic>k</italic>3) denotes the clustering parameter <italic>K</italic> = 3 of PMFFRC when <italic>U</italic><sub><italic>ram</italic></sub> = 10 GB. HARC, SPRING, Mstcom, and FastqCLS are used in with-order mode (lossless). Compression parameters: <italic>Pr</italic> = 20, <italic>T</italic> = 8 (threads for cascaded algorithm), <italic>β</italic><sub>HARC</sub> = 1.05, <italic>β</italic><sub>SPRING</sub> = 0.15, <italic>β</italic><sub>FastqCLS</sub> = 0.15, <italic>β</italic><sub>Mstcom</sub> = 0.30, <italic>x</italic><sub>1</sub> = 100, <italic>x</italic><sub>2</sub> = 100,100. The compression gains obtained by the cascaded PMFFRC algorithms is marked in boldface. “–” means the result of not being optimized by the PMFFRC algorithm. For the experimentally optimized algorithms, we ensure the data integrity of the lossless compression optimization by comparing data hash fingerprints</p></table-wrap-foot></table-wrap></p>
      <p id="Par41">As seen in Table <xref rid="Tab2" ref-type="table">2</xref>, using PMFFRC for compression optimizing, when <italic>K</italic> = 1, the <italic>crg</italic> of HARC, SPRING, Mstcom, and FastqCLS is increased up to 118.54%, 126.95%, 108.51%, and 4.76%, respectively. The four special compressors save 45.74%, 55.87%, 52.04%, and 4.51% storage spaces compared with the <italic>without</italic>-mode.</p>
      <p id="Par42">In Table <xref rid="Tab2" ref-type="table">2</xref>, we also observed that HARC, SPRING, and Mstcom held compression ratio gains of over 100% (when <italic>k</italic> = 1), while FastqCLS only achieved 4.76%. This phenomenon is attributed to the particular reads reorder model employed by FastqCLS. In reference [<xref ref-type="bibr" rid="CR25">25</xref>], FastqCLS introduces the concept of "constructed score" for reordering reads collection, which relies on calculating the probability distribution of each nucleotide base within the reads range. When the length of the reads collection is shorter, it becomes challenging for the sequence scoring model of FastqCLS to generate local clustering effects among similar short reads. As a result, this limitation hampers the optimization efficiency of PMFFRC. Moreover, for reference-free compressors based on reads reorder technologies, the index that records the relative positions of short reads is crucial for restoring the original data. For a collection of shorter reads, the abovementioned record file occupies a higher proportion in the compressed file, which is another potential reason for the low optimization efficiency of PMFFRC. Although PMFFRC did not achieve the expected optimization results for FastqCLS on the <italic>H. sapiens</italic> dataset, PMFFRC remains highly competitive in saving storage space. As shown in Table <xref rid="Tab2" ref-type="table">2</xref>, the proposed PMFFRC saved 4.51% of storage space for FastqCLS merely through joint compression.</p>
      <p id="Par43">PMFFRC requires extra time for fastq files clustering, merging, and splitting, so <italic>ct</italic> and <italic>dt</italic> are slightly higher than the <italic>without</italic>-mode. The parallel clustering speedup and relative memory consumption by employing multiple CPU cores on the <italic>H. sapiens</italic> dataset are also evaluated. See Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S1 for more details.</p>
    </sec>
    <sec id="Sec12">
      <title>Performance on Salvelinus fontinalis dataset</title>
      <p id="Par44">To evaluate the optimizing efficiency of PMFFRC on large-scale fastq files, Table <xref rid="Tab3" ref-type="table">3</xref> shows the compression performance of the four cascaded algorithms by running PMFFRC on the <italic>S. fontinalis</italic> dataset, which contains 360 sequencing files with a total size of 190 GB. Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S2 details the clustering speedup and memory consumption on the <italic>S. fontinalis</italic> dataset using the different numbers of CPU cores.<table-wrap id="Tab3"><label>Table 3</label><caption><p>Performance of PMFFRC on <italic>S. fontinalis</italic> dataset</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" rowspan="2">Algorithm</th><th align="left" rowspan="2">Parameter</th><th align="left" colspan="6">Compression</th><th align="left" colspan="2">Decompression</th></tr><tr><th align="left"><italic>cs</italic> (GB)</th><th align="left"><italic>pss</italic> (%)</th><th align="left"><italic>cr</italic> (bits/base)</th><th align="left"><italic>crg</italic> (%)</th><th align="left"><italic>cpm</italic> (GB)</th><th align="left"><italic>ct</italic> (h)</th><th align="left"><italic>dpm</italic> (GB)</th><th align="left"><italic>dt</italic> (h)</th></tr></thead><tbody><tr><td align="left" rowspan="3">HARC</td><td align="left"><italic>Without</italic></td><td char="." align="char">5.33</td><td align="left">–</td><td char="." align="char">0.76</td><td align="left">–</td><td char="." align="char">0.67</td><td char="." align="char">2.05</td><td char="." align="char">0.45</td><td char="." align="char">2.24</td></tr><tr><td align="left">-<italic>u</italic>20, <italic>k</italic>3</td><td char="." align="char">3.49</td><td align="left"><bold>34.52</bold></td><td char="." align="char">0.50</td><td align="left"><bold>52.48</bold></td><td char="." align="char">11.90</td><td char="." align="char"><bold>1.75</bold></td><td char="." align="char">5.22</td><td char="." align="char">3.05</td></tr><tr><td align="left">-<italic>u</italic>40, <italic>k</italic>1</td><td char="." align="char">3.41</td><td align="left"><bold>36.02</bold></td><td char="." align="char">0.48</td><td align="left"><bold>56.22</bold></td><td char="." align="char">23.69</td><td char="." align="char"><bold>2.04</bold></td><td char="." align="char">6.71</td><td char="." align="char">3.78</td></tr><tr><td align="left" rowspan="3">SPRING</td><td align="left"><italic>Without</italic></td><td char="." align="char">5.49</td><td align="left">–</td><td char="." align="char">0.78</td><td align="left">–</td><td char="." align="char">1.02</td><td char="." align="char">1.46</td><td char="." align="char">0.56</td><td char="." align="char">0.29</td></tr><tr><td align="left">-<italic>u</italic>20, <italic>k</italic>3</td><td char="." align="char">3.58</td><td align="left"><bold>34.79</bold></td><td char="." align="char">0.51</td><td align="left"><bold>50.38</bold></td><td char="." align="char">12.76</td><td char="." align="char">1.74</td><td char="." align="char">1.49</td><td char="." align="char">0.59</td></tr><tr><td align="left">-<italic>u</italic>40, <italic>k</italic>1</td><td char="." align="char">3.49</td><td align="left"><bold>36.43</bold></td><td char="." align="char">0.49</td><td align="left"><bold>57.45</bold></td><td char="." align="char">25.51</td><td char="." align="char">1.69</td><td char="." align="char">1.53</td><td char="." align="char">0.91</td></tr><tr><td align="left" rowspan="4">Mstcom</td><td align="left"><italic>Without</italic></td><td char="." align="char">3.87</td><td align="left">–</td><td char="." align="char">0.55</td><td align="left">–</td><td char="." align="char">5.91</td><td char="." align="char">7.19</td><td char="." align="char">2.29</td><td char="." align="char">1.06</td></tr><tr><td align="left">-<italic>u</italic>40, <italic>k</italic>6</td><td char="." align="char">2.40</td><td align="left"><bold>37.98</bold></td><td char="." align="char">0.34</td><td align="left"><bold>64.31</bold></td><td char="." align="char">33.24</td><td char="." align="char"><bold>5.09</bold></td><td char="." align="char">20.03</td><td char="." align="char"><bold>0.76</bold></td></tr><tr><td align="left">-<italic>u</italic>100, <italic>k</italic>3</td><td char="." align="char">2.31</td><td align="left"><bold>40.31</bold></td><td char="." align="char">0.33</td><td align="left"><bold>67.93</bold></td><td char="." align="char">78.97</td><td char="." align="char"><bold>5.47</bold></td><td char="." align="char">50.36</td><td char="." align="char">1.11</td></tr><tr><td align="left">-<italic>u</italic>180, <italic>k</italic>1</td><td char="." align="char">2.26</td><td align="left"><bold>41.60</bold></td><td char="." align="char">0.32</td><td align="left"><bold>71.12</bold></td><td char="." align="char">159.13</td><td char="." align="char"><bold>6.22</bold></td><td char="." align="char">100.72</td><td char="." align="char">1.60</td></tr><tr><td align="left" rowspan="4">FastqCLS</td><td align="left"><italic>Without</italic></td><td char="." align="char">4.37</td><td align="left">–</td><td char="." align="char">0.62</td><td align="left">–</td><td char="." align="char">16.66</td><td char="." align="char">21.51</td><td char="." align="char">6.35</td><td char="." align="char">16.25</td></tr><tr><td align="left">-<italic>u</italic>80, <italic>k</italic>4</td><td char="." align="char">2.82</td><td align="left"><bold>35.47</bold></td><td char="." align="char">0.40</td><td align="left"><bold>55.15</bold></td><td char="." align="char">60.36</td><td char="." align="char"><bold>11.66</bold></td><td char="." align="char">6.38</td><td char="." align="char"><bold>14.44</bold></td></tr><tr><td align="left">-<italic>u</italic>180, <italic>k</italic>3</td><td char="." align="char">2.77</td><td align="left"><bold>36.61</bold></td><td char="." align="char">0.39</td><td align="left"><bold>58.00</bold></td><td char="." align="char">59.09</td><td char="." align="char"><bold>12.98</bold></td><td char="." align="char">6.43</td><td char="." align="char"><bold>14.04</bold></td></tr><tr><td align="left">-<italic>u</italic>280, <italic>k</italic>1</td><td char="." align="char">2.69</td><td align="left"><bold>38.44</bold></td><td char="." align="char">0.38</td><td align="left"><bold>62.56</bold></td><td char="." align="char">63.60</td><td char="." align="char"><bold>14.03</bold></td><td char="." align="char">6.39</td><td char="." align="char"><bold>15.95</bold></td></tr></tbody></table><table-wrap-foot><p>Parameters: <italic>Pr</italic> = 20, <italic>T</italic> = 8, <italic>β</italic><sub>HARC</sub> = 1.05, <italic>β</italic><sub>SPRING</sub> = 0.95, <italic>β</italic><sub>FastqCLS</sub> = 0.28, <italic>β</italic><sub>Mstcom</sub> = 0.75, <italic>x</italic><sub>1</sub> = 100, <italic>x</italic><sub>2</sub> = 100,100. The compression gains obtained by the PMFFRC cascaded algorithms is marked in boldface. “–” means the result of not being optimized by the PMFFRC algorithm</p></table-wrap-foot></table-wrap></p>
      <p id="Par45">Table <xref rid="Tab3" ref-type="table">3</xref> shows that the compression ratio <italic>cr</italic> using the PMFFRC optimizer for the four cascaded compression algorithms reaches the peak at <italic>K</italic> = 1. The <italic>cr</italic> increases by 56.22%, 57.45%, 71.12%, and 62.56% compared with without-mode. By sacrificing system memory, the MPFFRC optimizer makes four special compressors save storage space of 36.02%, 36.43%, 41.60%, and 38.44%, respectively. The optimizer PMFFRC delivers remarkable results on the S. fontinalis dataset due to its maximal utilization of the redundancy information within the compressed datasets.</p>
    </sec>
    <sec id="Sec13">
      <title>Performance on Cicer arietinum dataset</title>
      <p id="Par46">Table <xref rid="Tab4" ref-type="table">4</xref> presents the optimization results of HARC, SPRING, Mstcom, and FastqCLS by running PMFFRC on <italic>C. arietinum</italic> dataset, which contains 60 fastq files, and the average data size of every single fastq file is 11 GB (the total size of the Cicer arietinum dataset is 681 GB). The speedup and time consumption by using different CPU cores on the <italic>C. arietinum</italic> dataset are shown in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S3.<table-wrap id="Tab4"><label>Table 4</label><caption><p>Performance of PMFFRC on <italic>C. arietinum</italic> dataset</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" rowspan="2">Algorithm</th><th align="left" rowspan="2">Parameter</th><th align="left" colspan="6">Compression</th><th align="left" colspan="2">Decompression</th></tr><tr><th align="left"><italic>cs</italic> (GB)</th><th align="left"><italic>pss</italic> (%)</th><th align="left"><italic>cr</italic> (bits/base)</th><th align="left"><italic>crg</italic> (%)</th><th align="left"><italic>cpm</italic> (GB)</th><th align="left"><italic>ct</italic> (h)</th><th align="left"><italic>dpm</italic> (GB)</th><th align="left"><italic>dt</italic> (h)</th></tr></thead><tbody><tr><td align="left" rowspan="4">HARC</td><td align="left"><italic>Without</italic></td><td char="." align="char">16.96</td><td align="left">–</td><td char="." align="char">0.79</td><td align="left">–</td><td char="." align="char">1.99</td><td char="." align="char">5.24</td><td char="." align="char">1.74</td><td char="." align="char">6.14</td></tr><tr><td align="left">-<italic>u</italic>20, <italic>k</italic>5</td><td char="." align="char">11.17</td><td align="left"><bold>34.14</bold></td><td char="." align="char">0.52</td><td align="left"><bold>51.85</bold></td><td char="." align="char">17.75</td><td char="." align="char"><bold>3.05</bold></td><td char="." align="char">6.30</td><td char="." align="char">6.60</td></tr><tr><td align="left">-<italic>u</italic>40, <italic>k</italic>3</td><td char="." align="char">10.95</td><td align="left"><bold>35.44</bold></td><td char="." align="char">0.51</td><td align="left"><bold>51.94</bold></td><td char="." align="char">34.73</td><td char="." align="char"><bold>3.16</bold></td><td char="." align="char">7.11</td><td char="." align="char">7.60</td></tr><tr><td align="left">-<italic>u</italic>80, <italic>k</italic>1</td><td char="." align="char">10.78</td><td align="left"><bold>36.44</bold></td><td char="." align="char">0.50</td><td align="left"><bold>58.90</bold></td><td char="." align="char">66.90</td><td char="." align="char"><bold>3.53</bold></td><td char="." align="char">6.97</td><td char="." align="char"><bold>5.05</bold></td></tr><tr><td align="left" rowspan="4">SPRING</td><td align="left"><italic>Without</italic></td><td char="." align="char">15.82</td><td align="left">–</td><td char="." align="char">0.73</td><td align="left">–</td><td char="." align="char">1.89</td><td char="." align="char">5.73</td><td char="." align="char">1.04</td><td char="." align="char">0.66</td></tr><tr><td align="left">-<italic>u</italic>20, <italic>k</italic>5</td><td char="." align="char">11.05</td><td align="left"><bold>30.15</bold></td><td char="." align="char">0.51</td><td align="left"><bold>43.15</bold></td><td char="." align="char">18.91</td><td char="." align="char"><bold>3.55</bold></td><td char="." align="char">2.93</td><td char="." align="char">0.95</td></tr><tr><td align="left">-<italic>u</italic>40, <italic>k</italic>3</td><td char="." align="char">10.87</td><td align="left"><bold>31.29</bold></td><td char="." align="char">0.50</td><td align="left"><bold>43.54</bold></td><td char="." align="char">36.78</td><td char="." align="char"><bold>3.60</bold></td><td char="." align="char">4.09</td><td char="." align="char">1.02</td></tr><tr><td align="left">-<italic>u</italic>100, <italic>k</italic>1</td><td char="." align="char">10.67</td><td align="left"><bold>32.55</bold></td><td char="." align="char">0.49</td><td align="left"><bold>48.29</bold></td><td char="." align="char">70.79</td><td char="." align="char"><bold>4.09</bold></td><td char="." align="char">4.13</td><td char="." align="char">1.19</td></tr><tr><td align="left" rowspan="4">Mstcom</td><td align="left"><italic>Without</italic></td><td char="." align="char">13.01</td><td align="left">–</td><td char="." align="char">0.60</td><td align="left">–</td><td char="." align="char">14.54</td><td char="." align="char">66.52</td><td char="." align="char">6.49</td><td char="." align="char">2.94</td></tr><tr><td align="left">-<italic>u</italic>100, <italic>k</italic>15</td><td char="." align="char">10.34</td><td align="left"><bold>20.52</bold></td><td char="." align="char">0.48</td><td align="left"><bold>25.88</bold></td><td char="." align="char">37.52</td><td char="." align="char"><bold>64.52</bold></td><td char="." align="char">22.45</td><td char="." align="char"><bold>2.31</bold></td></tr><tr><td align="left">-<italic>u</italic>200, <italic>k</italic>7</td><td char="." align="char">9.59</td><td align="left"><bold>26.29</bold></td><td char="." align="char">0.44</td><td align="left"><bold>35.71</bold></td><td char="." align="char">77.51</td><td char="." align="char"><bold>61.85</bold></td><td char="." align="char">50.98</td><td char="." align="char"><bold>2.29</bold></td></tr><tr><td align="left">-<italic>u</italic>300, <italic>k</italic>4</td><td char="." align="char">9.24</td><td align="left"><bold>28.98</bold></td><td char="." align="char">0.43</td><td align="left"><bold>40.91</bold></td><td char="." align="char">149.86</td><td char="." align="char"><bold>59.62</bold></td><td char="." align="char">102.78</td><td char="." align="char"><bold>2.15</bold></td></tr><tr><td align="left" rowspan="4">FastqCLS</td><td align="left"><italic>Without</italic></td><td char="." align="char">27.62</td><td align="left">–</td><td char="." align="char">1.28</td><td align="left">–</td><td char="." align="char">33.79</td><td char="." align="char">50.36</td><td char="." align="char">6.49</td><td char="." align="char">28.84</td></tr><tr><td align="left">-<italic>u</italic>100, <italic>k</italic>9</td><td char="." align="char">25.08</td><td align="left"><bold>9.20</bold></td><td char="." align="char">1.16</td><td align="left"><bold>10.15</bold></td><td char="." align="char">36.30</td><td char="." align="char"><bold>28.13</bold></td><td char="." align="char">6.56</td><td char="." align="char"><bold>23.88</bold></td></tr><tr><td align="left">-<italic>u</italic>200, <italic>k</italic>5</td><td char="." align="char">23.65</td><td align="left"><bold>14.37</bold></td><td char="." align="char">1.10</td><td align="left"><bold>16.81</bold></td><td char="." align="char">36.01</td><td char="." align="char"><bold>30.76</bold></td><td char="." align="char">6.53</td><td char="." align="char"><bold>22.16</bold></td></tr><tr><td align="left">-<italic>u</italic>300, <italic>k</italic>4</td><td char="." align="char">22.88</td><td align="left"><bold>17.16</bold></td><td char="." align="char">1.06</td><td align="left"><bold>20.76</bold></td><td char="." align="char">35.84</td><td char="." align="char"><bold>30.32</bold></td><td char="." align="char">6.55</td><td char="." align="char"><bold>22.42</bold></td></tr></tbody></table><table-wrap-foot><p>Parameters: <italic>Pr</italic> = 20, <italic>T</italic> = 8, <italic>β</italic><sub>HARC</sub> = 1.05, <italic>β</italic><sub>SPRING</sub> = 0.30, <italic>β</italic><sub>FastqCLS</sub> = 0.28, <italic>β</italic><sub>Mstcom</sub> = 0.75, <italic>x</italic><sub>1</sub> = 100, <italic>x</italic><sub>2</sub> = 100,100. The compression gains obtained by the PMFFRC cascaded algorithms is marked in boldface. “–” means the result of not being optimized by the PMFFRC algorithm</p></table-wrap-foot></table-wrap></p>
      <p id="Par47">As shown in Table <xref rid="Tab4" ref-type="table">4</xref>, for HARC and SPRING compressors, when the safe threshold <italic>U</italic><sub><italic>ram</italic></sub> takes 80–100 GB, the clustering parameter <italic>K</italic> = 1. Simultaneously, the compression ratio <italic>cr</italic> of HARC and SPRING increased by 58.90% and 48.29%. By leveraging system memory, the PMFFRC optimizer saved 36.44% and 32.55% storage space sizes for HARC and SPRING, respectively. For compressors Mstcom and FastqCLS, when the safe threshold <italic>U</italic><sub><italic>ram</italic></sub> takes 300 GB (maximum system memory), the clustering parameter <italic>K</italic> = 4, and the compression ratio <italic>cr</italic> is improved by 40.91% and 20.76%. In this case, PMFFRC preserved 28.98% and 17.16% of storage space sizes for Mstcom and FastqCLS, respectively.</p>
      <p id="Par48">In <italic>C. arietinum</italic> dataset, the compression time <italic>ct</italic> of four cascaded compressors was reduced by running PMFFRC compared with <italic>without</italic>-mode. This contribution can be attributed to the following reasons: (i) PMFFRC accelerates computation-intensive stages by multi-core CPU parallelism. Therefore, the time consumption of fastq files clustering and merging steps is far lower than the total time consumption. (ii) Similar sequencing reads are gathered by redundant clustering in different fastq files, which favors reference-free compressors in the joint compressing stage. For example, HARC [<xref ref-type="bibr" rid="CR14">14</xref>] utilizes a redundant substitute step for replacing reverses complimentary and direct repeat reads, which benefit from our clustering algorithm. (iii) The joint compression stage reduces the preprocessing time consumption, such as building hash tables and dictionaries. For example, in the <italic>without</italic>-mode, HARC needs to perform 60 hash table construction processes on the Cicer arietinum dataset. However, joint compression only needs to build hash table once when <italic>K</italic> = 1.</p>
    </sec>
  </sec>
  <sec id="Sec14">
    <title>Discussion</title>
    <p id="Par49">We presented PMFFRC, a CPU-parallel algorithm for optimizing large-scale genomic sequencing reads lossless compression. On real datasets, PMFFRC achieves a 20–80% maximum compression ratio gains and an additional 20–40% file size reduction compared with non-optimized reference-free compressors. Our work pointed out a feasible idea for large-scale genome sequencing reads compression, which is to use the redundant information of reads in different fastq files to improve the compression ratio. In some cases, the PMFFRC algorithm can also reduce the compression and decompression time. Compared with non-optimized reference-free compressors, the significant compression advantage for optimized algorithms is achieved through a "three-stage redundancy utilization strategy" (fastq files, reads string, and nucleotide character) provided by the optimizer and the optimized algorithm. A typical sample implementation is PMFFRC + FastqCLS. (i) The PMFFRC optimizer employs a two-level clustering method to group similar fastq format data, resulting in highly similar data within each group. This clustering strategy allows the FastqCLS algorithm to take advantage of redundant information at the files level in the compressed datasets. (ii) The FastqCLS algorithm uses a novel scoring model to reorder short reads by leveraging redundancy information at the short reads string level. This preprocessing phase takes advantage of the redundancy between short reads. (iii) The FastqCLS compressor incorporates the ZPAQ algorithm, which employs context modelling and arithmetic coding. This enables FastqCLS to detect patterns and character dependencies in the reads data, utilizing context models and exploiting redundancy at the nucleotide character level to improve compression ratios.</p>
    <p id="Par50">Our optimizer PMFFRC showed promising results on 444 sequencing files. However, it is undeniable that PMFFRC nonetheless has some limitations. On the one hand, the PMFFRC algorithm may not achieve the expected optimization results for small memory devices and small-scale genome sequencing data. Since PMFFRC utilizes system memory and files-level redundancy information, it is more suitable for compressing medium to large-scale sequencing datasets. On the other hand, the high compression ratio achieved by PMFFRC restricts its flexibility in decompression, making it more suitable for medium and long-term backup applications of sequencing short reads data. Based on current work, potential future work includes: (i) Improving computation of PMFFRC by using CPU and GPU (Graphics Processing Unit) collaborative computing for large-scale and long sequencing reads optimization compression. (ii) Achieving the accurate compression and decompression of clustering files to enhance application flexibility. (iii) Creating a block index for each joint compressed file and reducing the overall compression memory consumption through block compression, so that small memory devices can also benefit from the proposed PMFFRC algorithm. (iv) Another interesting direction is to explore machine learning and deep learning techniques for predicting the compression peak memory <italic>Y</italic><sub><italic>cpm</italic></sub> and clustering parameters <italic>K</italic> accurately, to maximize utilization the user-preset safe memory threshold <italic>U</italic><sub><italic>ram</italic></sub>.</p>
  </sec>
  <sec id="Sec15">
    <title>Availability and requirements</title>
    <p id="Par51">
      <list list-type="bullet">
        <list-item>
          <p id="Par52"><bold>Project name</bold>: PMFFRC</p>
        </list-item>
        <list-item>
          <p id="Par53"><bold>Project home page</bold>: <ext-link ext-link-type="uri" xlink:href="https://github.com/fahaihi/PMFFRC">https://github.com/fahaihi/PMFFRC</ext-link></p>
        </list-item>
        <list-item>
          <p id="Par54"><bold>Operating system(s)</bold>: Linux</p>
        </list-item>
        <list-item>
          <p id="Par55"><bold>Programming language</bold>: C +  + , OpenMP</p>
        </list-item>
        <list-item>
          <p id="Par56"><bold>Other requirements</bold>: FastqCLS, Mstcom, Harc, Spring, and gcc 5.4.0.</p>
        </list-item>
        <list-item>
          <p id="Par57"><bold>License</bold>: Apache-2.0 license</p>
        </list-item>
        <list-item>
          <p id="Par58"><bold>Any restrictions to use by non-academics</bold>: For commercial use, please contact the authors.</p>
        </list-item>
      </list>
    </p>
  </sec>
  <sec sec-type="supplementary-material">
    <sec id="Sec16">
      <title>Supplementary Information</title>
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="12859_2023_5566_MOESM1_ESM.docx">
            <caption>
              <p><bold>Additional file 1:</bold> PMFFRC_Supplementary_Material.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>MB</term>
        <def>
          <p id="Par4">Megabyte</p>
        </def>
      </def-item>
      <def-item>
        <term>GB</term>
        <def>
          <p id="Par5">Gigabyte</p>
        </def>
      </def-item>
      <def-item>
        <term>TB</term>
        <def>
          <p id="Par6">Terabyte</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher's Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>The experimental work is supported by the High-performance Computing Center of Guangxi University. The authors thank the editor and anonymous reviewers for their constructive comments and suggestions to improve our manuscript. The authors also thank Dr. Meng Yan for guiding the manuscript revision.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author contributions</title>
    <p>HS and YFZ implemented the code. HS and HNX wrote the manuscript. XGL and GW guided the project. HDM completed a part of the experiments and prepared the dataset. XGL and GW also helped to modify the manuscript. All authors read and approved the manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>This work is partly supported by NSF of China (62141412, 62272253, 62272252), Fundamental Research Funds for the Central Universities.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>The datasets generated and analyzed during the current study are available in the PMFFRC repository, <ext-link ext-link-type="uri" xlink:href="https://github.com/fahaihi/PMFFRC/tree/master/data">https://github.com/fahaihi/PMFFRC/tree/master/data</ext-link>.</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar1">
      <title>Ethics approval and consent to participate</title>
      <p id="Par59">The ethic approval is not required since we used publicly available datasets.</p>
    </notes>
    <notes id="FPar2">
      <title>Consent for publication</title>
      <p id="Par60">Not applicable.</p>
    </notes>
    <notes id="FPar3" notes-type="COI-statement">
      <title>Competing interests</title>
      <p id="Par61">The authors declare that they have no competing interests.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Voges</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Hernaez</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Mattavelli</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Ostermann</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>An introduction to MPEG-G: the first open ISO/IEC standard for the compression and exchange of genomic sequencing data</article-title>
        <source>Proc IEEE</source>
        <year>2021</year>
        <volume>109</volume>
        <issue>9</issue>
        <fpage>1607</fpage>
        <lpage>1622</lpage>
        <pub-id pub-id-type="doi">10.1109/JPROC.2021.3082027</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Numanagić</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Bonfield</surname>
            <given-names>JK</given-names>
          </name>
          <name>
            <surname>Hach</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Voges</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Ostermann</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Alberti</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Comparison of high-throughput sequencing data compression tools</article-title>
        <source>Nat Methods</source>
        <year>2016</year>
        <volume>13</volume>
        <issue>12</issue>
        <fpage>1005</fpage>
        <lpage>1008</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.4037</pub-id>
        <?supplied-pmid 27776113?>
        <pub-id pub-id-type="pmid">27776113</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kokot</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Gudyś</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Deorowicz</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>CoLoRd: compressing long reads</article-title>
        <source>Nat Methods</source>
        <year>2022</year>
        <volume>19</volume>
        <issue>4</issue>
        <fpage>441</fpage>
        <lpage>444</lpage>
        <pub-id pub-id-type="doi">10.1038/s41592-022-01432-3</pub-id>
        <?supplied-pmid 35347321?>
        <pub-id pub-id-type="pmid">35347321</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhu</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>JiZ</surname>
            <given-names>HS</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>X</given-names>
          </name>
        </person-group>
        <article-title>High-throughput DNA sequence data compression</article-title>
        <source>Brief Bioinform</source>
        <year>2015</year>
        <volume>16</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>15</lpage>
        <pub-id pub-id-type="doi">10.1093/bib/bbt087</pub-id>
        <?supplied-pmid 24300111?>
        <pub-id pub-id-type="pmid">24300111</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hernaez</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Pavlichin</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Weissman</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Ochoa</surname>
            <given-names>I</given-names>
          </name>
        </person-group>
        <article-title>Genomic data compression</article-title>
        <source>Annu Rev Biomed Data Sci</source>
        <year>2019</year>
        <volume>2</volume>
        <fpage>19</fpage>
        <lpage>37</lpage>
        <pub-id pub-id-type="doi">10.1146/annurev-biodatasci-072018-021229</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dufort y Álvarez</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Seroussi</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Smircich</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Sotelo-Silveira</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Ochoa</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Martín</surname>
            <given-names>Á</given-names>
          </name>
        </person-group>
        <article-title>RENANO: a REference-based compressor for NANOpore FASTQ files</article-title>
        <source>Bioinformatics</source>
        <year>2021</year>
        <volume>37</volume>
        <issue>24</issue>
        <fpage>4862</fpage>
        <lpage>4864</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btab437</pub-id>
        <?supplied-pmid 34128963?>
        <pub-id pub-id-type="pmid">34128963</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yao</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Ji</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>He</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>HRCM: an efficient hybrid referential compression method for genomic big data</article-title>
        <source>BioMed Res Int</source>
        <year>2019</year>
        <pub-id pub-id-type="doi">10.1155/2019/3108950</pub-id>
        <?supplied-pmid 31915690?>
        <pub-id pub-id-type="pmid">31915690</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Saha</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Rajasekaran</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>NRGC: a novel referential genome compression algorithm</article-title>
        <source>Bioinformatics</source>
        <year>2016</year>
        <volume>32</volume>
        <issue>22</issue>
        <fpage>3405</fpage>
        <lpage>3412</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btw505</pub-id>
        <?supplied-pmid 27485445?>
        <pub-id pub-id-type="pmid">27485445</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jones</surname>
            <given-names>DC</given-names>
          </name>
          <name>
            <surname>Ruzzo</surname>
            <given-names>WL</given-names>
          </name>
          <name>
            <surname>Peng</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Katze</surname>
            <given-names>MG</given-names>
          </name>
        </person-group>
        <article-title>Compression of next-generation sequencing reads aided by highly efficient de novo assembly</article-title>
        <source>Nucleic Acids Res</source>
        <year>2012</year>
        <volume>40</volume>
        <issue>22</issue>
        <fpage>e171</fpage>
        <pub-id pub-id-type="doi">10.1093/nar/gks754</pub-id>
        <?supplied-pmid 22904078?>
        <pub-id pub-id-type="pmid">22904078</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cox</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Bauer</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Jakobi</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Rosone</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Large-scale compression of genomic sequence databases with the Burrows-Wheeler transform</article-title>
        <source>Bioinformatics</source>
        <year>2012</year>
        <volume>28</volume>
        <fpage>1415</fpage>
        <lpage>1419</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bts173</pub-id>
        <?supplied-pmid 22556365?>
        <pub-id pub-id-type="pmid">22556365</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Roguski</surname>
            <given-names>Ł</given-names>
          </name>
          <name>
            <surname>Deorowicz</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>DSRC2 industry-oriented compression of FASTQ files</article-title>
        <source>Bioinformatics</source>
        <year>2014</year>
        <volume>30</volume>
        <fpage>2213</fpage>
        <lpage>2215</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btu208</pub-id>
        <?supplied-pmid 24747219?>
        <pub-id pub-id-type="pmid">24747219</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Deorowicz</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>FQSqueezer: k-mer-based compression of sequencing data</article-title>
        <source>Sci Rep</source>
        <year>2020</year>
        <volume>10</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>9</lpage>
        <pub-id pub-id-type="doi">10.1038/s41598-020-57452-6</pub-id>
        <pub-id pub-id-type="pmid">31913322</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Meng</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Chandak</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Zhu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Weissman</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Reference-free lossless compression of nanopore sequencing reads using an approximate assembly approach</article-title>
        <source>Sci Rep</source>
        <year>2023</year>
        <volume>13</volume>
        <issue>1</issue>
        <fpage>2082</fpage>
        <pub-id pub-id-type="doi">10.1038/s41598-023-29267-8</pub-id>
        <?supplied-pmid 36747011?>
        <pub-id pub-id-type="pmid">36747011</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chandak</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Tatwawadi</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Weissman</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Compression of genomic sequencing reads via hash-based reordering: algorithm and analysis</article-title>
        <source>Bioinformatics</source>
        <year>2018</year>
        <volume>34</volume>
        <issue>4</issue>
        <fpage>558</fpage>
        <lpage>567</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btx639</pub-id>
        <?supplied-pmid 29444237?>
        <pub-id pub-id-type="pmid">29444237</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Grabowski</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Deorowicz</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Roguski</surname>
            <given-names>Ł</given-names>
          </name>
        </person-group>
        <article-title>Disk-based compression of data from genome sequencing</article-title>
        <source>Bioinformatics</source>
        <year>2014</year>
        <volume>31</volume>
        <fpage>1389</fpage>
        <lpage>1395</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btu844</pub-id>
        <?supplied-pmid 25536966?>
        <pub-id pub-id-type="pmid">25536966</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Benoit</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Lemaitre</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Lavenier</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Drezen</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Dayris</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Uricaru</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Reference-free compression of high throughput sequencing data with a probabilistic de Bruijn graph</article-title>
        <source>BMC Bioinform</source>
        <year>2015</year>
        <volume>16</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>14</lpage>
        <pub-id pub-id-type="doi">10.1186/s12859-015-0709-7</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chandak</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Tatwawadi</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Ochoa</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Hernaez</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Weissman</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>SPRING: a next-generation compressor for FASTQ data</article-title>
        <source>Bioinformatics</source>
        <year>2019</year>
        <volume>35</volume>
        <issue>15</issue>
        <fpage>2674</fpage>
        <lpage>2676</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bty1015</pub-id>
        <?supplied-pmid 30535063?>
        <pub-id pub-id-type="pmid">30535063</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Roguski</surname>
            <given-names>Ł</given-names>
          </name>
          <name>
            <surname>Ochoa</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Hernaez</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Deorowicz</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>FaStore: a space-saving solution for raw sequencing data</article-title>
        <source>Bioinformatics</source>
        <year>2018</year>
        <volume>34</volume>
        <issue>16</issue>
        <fpage>2748</fpage>
        <lpage>2756</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bty205</pub-id>
        <?supplied-pmid 29617939?>
        <pub-id pub-id-type="pmid">29617939</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kowalski</surname>
            <given-names>TM</given-names>
          </name>
          <name>
            <surname>Grabowski</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>PgRC: pseudogenome-based read compressor</article-title>
        <source>Bioinformatics</source>
        <year>2020</year>
        <volume>36</volume>
        <issue>7</issue>
        <fpage>2082</fpage>
        <lpage>2089</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btz919</pub-id>
        <?supplied-pmid 31893286?>
        <pub-id pub-id-type="pmid">31893286</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Yu</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Dinger</surname>
            <given-names>ME</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Index suffix–prefix overlaps by (w, k)-minimizer to generate long contigs for reads compression</article-title>
        <source>Bioinformatics</source>
        <year>2018</year>
        <volume>35</volume>
        <issue>12</issue>
        <fpage>2066</fpage>
        <lpage>2074</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bty936</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Xie</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>He</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>He</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Zhu</surname>
            <given-names>Z</given-names>
          </name>
        </person-group>
        <article-title>CURC: a CUDA-based reference-free read compressor</article-title>
        <source>Bioinformatics</source>
        <year>2022</year>
        <volume>38</volume>
        <issue>12</issue>
        <fpage>3294</fpage>
        <lpage>3296</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btac333</pub-id>
        <?supplied-pmid 35579371?>
        <pub-id pub-id-type="pmid">35579371</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Hamming-shifting graph of genomic short reads: Efficient construction and its application for compression</article-title>
        <source>PLoS Comput Biol</source>
        <year>2021</year>
        <volume>17</volume>
        <issue>7</issue>
        <fpage>e1009229</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1009229</pub-id>
        <?supplied-pmid 34280186?>
        <pub-id pub-id-type="pmid">34280186</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>White</surname>
            <given-names>WTJ</given-names>
          </name>
          <name>
            <surname>Hendy</surname>
            <given-names>MD</given-names>
          </name>
        </person-group>
        <article-title>Compressing DNA sequence databases with coil</article-title>
        <source>BMC Bioinformatics</source>
        <year>2008</year>
        <volume>9</volume>
        <issue>1</issue>
        <fpage>242</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-9-242</pub-id>
        <?supplied-pmid 18489794?>
        <pub-id pub-id-type="pmid">18489794</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yanovsky</surname>
            <given-names>V</given-names>
          </name>
        </person-group>
        <article-title>ReCoil-an algorithm for compression of extremely large datasets of DNA data</article-title>
        <source>Algorithms Mol Biol</source>
        <year>2011</year>
        <volume>6</volume>
        <issue>1</issue>
        <fpage>23</fpage>
        <pub-id pub-id-type="doi">10.1186/1748-7188-6-23</pub-id>
        <?supplied-pmid 21988957?>
        <pub-id pub-id-type="pmid">21988957</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lee</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Song</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>FastqCLS: a FASTQ compressor for long-read sequencing via read reordering using a novel scoring model</article-title>
        <source>Bioinformatics</source>
        <year>2022</year>
        <volume>38</volume>
        <issue>2</issue>
        <fpage>351</fpage>
        <lpage>356</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btab696</pub-id>
        <?supplied-pmid 34623374?>
        <pub-id pub-id-type="pmid">34623374</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Al Yami</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Huang</surname>
            <given-names>CH</given-names>
          </name>
        </person-group>
        <article-title>LFastqC: A lossless non-reference-based FASTQ compressor</article-title>
        <source>PLoS ONE</source>
        <year>2019</year>
        <volume>14</volume>
        <issue>11</issue>
        <fpage>e0224806</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0224806</pub-id>
        <?supplied-pmid 31725736?>
        <pub-id pub-id-type="pmid">31725736</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Cheng</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Grossman</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>McKercher</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <source>Professional CUDA c programming</source>
        <year>2017</year>
        <publisher-loc>Beijing</publisher-loc>
        <publisher-name>China Machine Press</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cha</surname>
            <given-names>SH</given-names>
          </name>
        </person-group>
        <article-title>Comprehensive survey on distance/similarity measures between probability density functions</article-title>
        <source>Int J Math Models Methods Appl Sci</source>
        <year>2007</year>
        <volume>1</volume>
        <issue>2</issue>
        <fpage>300</fpage>
        <lpage>307</lpage>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hoare</surname>
            <given-names>CAR</given-names>
          </name>
        </person-group>
        <article-title>Quicksort</article-title>
        <source>Comput J</source>
        <year>1962</year>
        <volume>5</volume>
        <issue>1</issue>
        <fpage>10</fpage>
        <lpage>16</lpage>
        <pub-id pub-id-type="doi">10.1093/comjnl/5.1.10</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10691058</article-id>
    <article-id pub-id-type="pmid">38036969</article-id>
    <article-id pub-id-type="publisher-id">5566</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-023-05566-9</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>PMFFRC: a large-scale genomic short reads compression optimizer via memory modeling and redundant clustering</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Sun</surname>
          <given-names>Hui</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Zheng</surname>
          <given-names>Yingfeng</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Xie</surname>
          <given-names>Haonan</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ma</surname>
          <given-names>Huidong</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Liu</surname>
          <given-names>Xiaoguang</given-names>
        </name>
        <address>
          <email>liuxg@nbjl.nankai.edu.cn</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Wang</surname>
          <given-names>Gang</given-names>
        </name>
        <address>
          <email>adairmillersh@gmail.com</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/01y1kjr75</institution-id><institution-id institution-id-type="GRID">grid.216938.7</institution-id><institution-id institution-id-type="ISNI">0000 0000 9878 7032</institution-id><institution>Nankai-Baidu Joint Laboratory, College of Computer Science, </institution><institution>Nankai University, </institution></institution-wrap>Tianjin, China </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/02c9qn167</institution-id><institution-id institution-id-type="GRID">grid.256609.e</institution-id><institution-id institution-id-type="ISNI">0000 0001 2254 5798</institution-id><institution>Institute of Artificial Intelligence, School of Electrical Engineering, </institution><institution>Guangxi University, </institution></institution-wrap>Nanning, China </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>30</day>
      <month>11</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>30</day>
      <month>11</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2023</year>
    </pub-date>
    <volume>24</volume>
    <elocation-id>454</elocation-id>
    <history>
      <date date-type="received">
        <day>12</day>
        <month>9</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>13</day>
        <month>11</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">Genomic sequencing reads compressors are essential for balancing high-throughput sequencing short reads generation speed, large-scale genomic data sharing, and infrastructure storage expenditure. However, most existing short reads compressors rarely utilize big-memory systems and duplicative information between diverse sequencing files to achieve a higher compression ratio for conserving reads data storage space.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">We employ compression ratio as the optimization objective and propose a large-scale genomic sequencing short reads data compression optimizer, named PMFFRC, through novelty memory modeling and redundant reads clustering technologies. By cascading PMFFRC, in 982 GB fastq format sequencing data, with 274 GB and 3.3 billion short reads, the state-of-the-art and reference-free compressors HARC, SPRING, Mstcom, and FastqCLS achieve 77.89%, 77.56%, 73.51%, and 29.36% average maximum compression ratio gains, respectively. PMFFRC saves 39.41%, 41.62%, 40.99%, and 20.19% of storage space sizes compared with the four unoptimized compressors.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p id="Par3">PMFFRC rational usage big-memory of compression server, effectively saving the sequencing reads data storage space sizes, which relieves the basic storage facilities costs and community sharing transmitting overhead. Our work furnishes a novel solution for improving sequencing reads compression and saving storage space. The proposed PMFFRC algorithm is packaged in a same-name Linux toolkit, available un-limited at <ext-link ext-link-type="uri" xlink:href="https://github.com/fahaihi/PMFFRC">https://github.com/fahaihi/PMFFRC</ext-link>.</p>
      </sec>
      <sec>
        <title>Supplementary Information</title>
        <p>The online version contains supplementary material available at 10.1186/s12859-023-05566-9.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Short reads data</kwd>
      <kwd>Data compression</kwd>
      <kwd>Fastq</kwd>
      <kwd>Parallel algorithm</kwd>
    </kwd-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© BioMed Central Ltd., part of Springer Nature 2023</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par7">With the prosperity of next-generation sequencing (NGS) technologies, genomic sequencing data holds the characteristics of large data volumes, multiple files, and prosperous species sources [<xref ref-type="bibr" rid="CR1">1</xref>]. For example, until September 2023, through 829,822 sequencing times of 845,109 bio-samples, the bio-sequencing data compressed by the gzip (<ext-link ext-link-type="uri" xlink:href="http://www.gzip.org">http://www.gzip.org</ext-link>) in the CNGB Sequence Archive (<ext-link ext-link-type="uri" xlink:href="https://db.cngb.org/cnsa">https://db.cngb.org/cnsa</ext-link>) was up to 11,920 terabytes (TB), if stored in Amazon cloud at $0.125 each gigabyte (GB), will cost $1,525,760 per year. Therefore, compressing large-scale genomic sequencing data is essential in reducing the storage infrastructure construction expenditure and data transmission consumption, especially for sequencing reads, which account for 42% of the whole genomic sequencing data [<xref ref-type="bibr" rid="CR2">2</xref>, <xref ref-type="bibr" rid="CR3">3</xref>].</p>
    <p id="Par8">Different from ordinary textual data (such as big social data), genomic reads data has the following bioinformatic attributes. (i) The formatting of reads characters is uncomplicated, which consists of the alphabet Σ = {A, C, G, T, N} simply. (ii) The redundancy reads data is high, mainly relying on sequencing coverage of diverse platforms. (iii) Homologous species reads data retains heightened similitude. Recently, reference-based and reference-free dedicated genomic sequencing reads compressors have been proposed by taking full advantage of reads' bioinformatic attributes [<xref ref-type="bibr" rid="CR4">4</xref>, <xref ref-type="bibr" rid="CR5">5</xref>].</p>
    <p id="Par9">The first category, of reference-based compressors, acquires the position details of reads in the reference genome via sequence alignment technology to achieve redundant substrings replacement, such as RENANO [<xref ref-type="bibr" rid="CR6">6</xref>], HRCM [<xref ref-type="bibr" rid="CR7">7</xref>], and NRGC [<xref ref-type="bibr" rid="CR8">8</xref>]. Reference-based methods are more helpful in compressing reference-matched reads, but their high compression ratio relies on reference genome selection. In contrast to reference-free compressors, the weaknesses of reference-based approaches can be summarized as follows. (i) Selecting an appropriate reference genome for a target dataset to be compressed can be challenging, and using a mismatched reference genome may result in inferior compression performance. (ii) Reference-based methods incorporate additional knowledge for encoding and decoding. This flexibility-limited technology hinders compressed data sharing and the widespread adoption of compressors. (iii) Aligning short reads data to a selected reference genome is a CPU-intensive and memory-unfriendly computational process, which demands higher time and memory consumption. However, in contrast, reference-free compressors utilize reads' redundant details and character formatting attributes for compression optimization, which have heightened application prospects in multi-species reads compression, such as Quip(-a) [<xref ref-type="bibr" rid="CR9">9</xref>], BEETL [<xref ref-type="bibr" rid="CR10">10</xref>], DSR2C [<xref ref-type="bibr" rid="CR11">11</xref>], FQSqueezer [<xref ref-type="bibr" rid="CR12">12</xref>], and NanoSpring [<xref ref-type="bibr" rid="CR13">13</xref>]. Here, we will introduce some state-of-the-art and reference-free short reads compressors relevant to our work. See references [<xref ref-type="bibr" rid="CR4">4</xref>] and [<xref ref-type="bibr" rid="CR5">5</xref>] for more detailed reviews of fastq format genomic sequencing reads data compressors.</p>
    <p id="Par10">HARC [<xref ref-type="bibr" rid="CR14">14</xref>] reorders short reads via their genome position details and then removes the redundancy sub-strings between consecutive reads, which achieves 1.4–2 × compression ratio improvement over Orcom [<xref ref-type="bibr" rid="CR15">15</xref>] and Leon [<xref ref-type="bibr" rid="CR16">16</xref>] in 3 billion Illumina short reads data. From the same research team, SPRING [<xref ref-type="bibr" rid="CR17">17</xref>] enhances HARC by supporting variable-length reads and handles all fastq streams. In their experiment, SPRING compresses 195 GB of 25 × whole genome human data from Illumina’s NovaSeq platform to 7 GB, around 1.6 × smaller than Fastore [<xref ref-type="bibr" rid="CR18">18</xref>].</p>
    <p id="Par11">PgRC [<xref ref-type="bibr" rid="CR19">19</xref>] assembles pseudo-genomes through approximate common superstring reads and then encodes them by reads' mapping sites on the pseudo-genome, which bests in compression ratio over Minicom [<xref ref-type="bibr" rid="CR20">20</xref>] and SPRING by up to 20% and 15% on average, respectively. CURC [<xref ref-type="bibr" rid="CR21">21</xref>] improves PgRC by CPU and GPU collaborative computing, which achieves 2.76–3.14× and 4.15–6.54× speedup in compression and 1.26–1.65× and 1.6–2.52× decompression speedup compared with SPRING and PgRC on 18 single-end and 13 paired-end sequencing datasets.</p>
    <p id="Par12">Mstcom [<xref ref-type="bibr" rid="CR22">22</xref>] introduces the concept of Hamming-shifting graphs to encode similar redundant reads and employ compressors BSC (<ext-link ext-link-type="uri" xlink:href="http://libbsc.com">http://libbsc.com</ext-link>) and LZMA (<ext-link ext-link-type="uri" xlink:href="http://www.7zip.org">http://www.7zip.org</ext-link>) for compressing the encoded file streams. Like Coil [<xref ref-type="bibr" rid="CR23">23</xref>] and ReCoil [<xref ref-type="bibr" rid="CR24">24</xref>], Mstcom reduces redundant information by cross-referencing similar reads. Because the similarity comparison between different string reads is time-consuming, such methods consume more time and memory space. The compression performance of Mstcom can be 10–30% better than SPRING, Minicom, and PgRC on 14 single-end and 7 paired-end datasets.</p>
    <p id="Par13">FastqCLS [<xref ref-type="bibr" rid="CR25">25</xref>] is the latest compressor, handy for compressing long and short genomic sequencing reads. It first extracts the features of reads via a novel scoring model and reorders them according to the numeral eigenvalues. Once the similarity reads are aggregated, the reads are compressed by the general-purpose compressor ZPAQ (<ext-link ext-link-type="uri" xlink:href="http://mattmahoney.net/dc/zpaq.html">http://mattmahoney.net/dc/zpaq.html</ext-link>) to improve the overall compression ratio. The experimental results on the MPEG [<xref ref-type="bibr" rid="CR2">2</xref>] and LFastqC [<xref ref-type="bibr" rid="CR26">26</xref>] benchmark datasets demonstrate that FastqCLS achieves compression ratios of 2.28–3.37 for long reads datasets, and 4.01–17.17 for short reads datasets. Compared with the pure ZPAQ compressor, FastqCLS achieves an average compression ratio boost of 4% (up to 18%) via the reads scoring model.</p>
    <p id="Par14">According to our investigation, existing reference-free short reads compressors rarely use redundancy information between different fastq files and large equipment memory in actual compression scenes to improve compression ratio. For example, in medium and long-term genomic data backup systems, the memory of the compression server often reaches hundreds or thousands of gigabytes (GB). Suppose the peak memory of the compressor holds only hundreds of megabytes (MB). In that case, it has advantages in memory usage but is ineffective for large memory to improve the compression ratio in multi-fastq files. To this end, we take the genomic sequencing reads compression ratio as the optimization objective and propose a large-scale reads compression optimization method named PMFFRC (Parallel Multi-Fastq-File Reads Clustering). The experimental results of actual 982 GB fastq format sequencing data, with the size of 274 GB and 3.3 billion reads, show that the average maximum compression ratio gains of compressors HARC, SPRING, Mstcom, and FastqCLS optimized by PMFFRC are 77.89%, 77.56%, 73.51%, and 29.36%, respectively. The maximum percent storage savings of the four cascaded compressors are 39.41%, 41.62%, 40.99%, and 20.19%, respectively. In the current version, the PMFFRC optimizer only compresses short reads, which accepts a folder containing multiple fastq files and outputs a compressed file *.pmffrc.</p>
  </sec>
  <sec id="Sec2">
    <title>Implementation</title>
    <p id="Par15">Let <italic>F</italic> = {<italic>F</italic><sub>0</sub>, <italic>F</italic><sub>1</sub>, …, <italic>F</italic><sub><italic>v</italic>-1</sub>} denotes a group of fastq files, <italic>R</italic><sub><italic>i</italic></sub> = {<inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${R}_{0}^{i}, {R}_{1}^{i}, {R}_{2}^{i}, \dots ,$$\end{document}</tex-math><mml:math id="M2"><mml:mrow><mml:msubsup><mml:mi>R</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mi>i</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>R</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mi>i</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>R</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mi>i</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5566_Article_IEq1.gif"/></alternatives></inline-formula>
<inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${R}_{\left(\left|{F}_{i}\right|/4\right)-1}^{i}$$\end{document}</tex-math><mml:math id="M4"><mml:msubsup><mml:mi>R</mml:mi><mml:mrow><mml:mfenced close=")" open="("><mml:mfenced close="|" open="|"><mml:msub><mml:mi>F</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfenced><mml:mo stretchy="false">/</mml:mo><mml:mn>4</mml:mn></mml:mfenced><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>i</mml:mi></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2023_5566_Article_IEq2.gif"/></alternatives></inline-formula>} denotes a collection of string short reads in the <italic>i</italic>-th fastq sequencing file, |<italic>F</italic><sub><italic>i</italic></sub>| denotes the number of lines in <italic>F</italic><sub><italic>i</italic></sub>, <italic>n</italic> denotes the average length of sequencing reads, <italic>Y</italic> represents the cascaded optimization compressor, <italic>U</italic><sub><italic>ram</italic></sub> represents the user-preset safe memory threshold (less than system memory), and <italic>K</italic> represents the number of clusters, where <italic>i</italic> = 0, 1, 2, …, <italic>v</italic>-1. The proposed optimization method PMFFRC includes two parts: sequencing file clustering (Section “<xref rid="Sec4" ref-type="sec">Sequencing files clustering</xref>”), joint compression and decompression (Section “<xref rid="Sec9" ref-type="sec">Joint compression and decompression</xref>”). PMFFRC benefits from the redundant short reads information entropy of similar fastq format sequencing files. Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Section S1 gives more details for theoretical entropy analysis.</p>
    <sec id="Sec3">
      <title>Sequencing files clustering</title>
      <p id="Par16">The PMFFRC optimizer achieves high compression ratios by clustering redundant reads together in different fastq files and increases cascaded compressor robustness by memory modeling. In the PMFFRC workflow, sequencing files clustering includes four stages. (i) Pre-compression: estimates the peak memory consumption on the overall fastq files by using random sampling technology. (ii) Feature extraction: converts short reads strings into numerical features, simplifying calculations and improving the optimization efficiency of PMFFRC. (iii) Similarity calculation: evaluates the similarity of each group file through the collection similarity assessment method. (iv) Fastq files clustering: ensures the algorithm robustness of the optimized compressor via a two-level clustering parameter selection strategy.</p>
      <sec id="Sec4">
        <title>Pre-compression</title>
        <p id="Par17">The purpose of pre-compression is to evaluate the maximum memory consumption of the compressed short reads data in dataset <italic>F</italic>. Let <italic>Y</italic><sub><italic>res</italic></sub> denotes the resident memory of compressor <italic>Y</italic> (such as dictionaries and hash tables), and <italic>Y</italic><sub><italic>reads</italic></sub> denotes the extra memory space opened for genomic sequencing reads. To evaluate compression peak memory <italic>Y</italic><sub><italic>cpm</italic></sub> = <italic>Y</italic><sub><italic>res</italic></sub> + <italic>Y</italic><sub><italic>reads</italic></sub> of <italic>Y</italic> on dataset <italic>F</italic>, PMFFRC performs the following steps:</p>
        <p id="Par18"><bold>Step 1</bold>: Randomly select <italic>x</italic><sub>1</sub> and <italic>x</italic><sub>2</sub> sets of sequencing data from <italic>F</italic><sub><italic>i</italic></sub> to construct pre-compression fastq files <italic>X</italic><sub>1</sub> = {<inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${x}_{0}^{1}$$\end{document}</tex-math><mml:math id="M6"><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mn>1</mml:mn></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2023_5566_Article_IEq3.gif"/></alternatives></inline-formula>, <inline-formula id="IEq4"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${x}_{1}^{1}$$\end{document}</tex-math><mml:math id="M8"><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mn>1</mml:mn></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2023_5566_Article_IEq4.gif"/></alternatives></inline-formula>, <inline-formula id="IEq5"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${x}_{2}^{1}$$\end{document}</tex-math><mml:math id="M10"><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mn>1</mml:mn></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2023_5566_Article_IEq5.gif"/></alternatives></inline-formula>, …, <inline-formula id="IEq6"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${x}_{{v\times x}_{1}-1}^{1}$$\end{document}</tex-math><mml:math id="M12"><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:msub><mml:mrow><mml:mi>v</mml:mi><mml:mo>×</mml:mo><mml:mi>x</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>1</mml:mn></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2023_5566_Article_IEq6.gif"/></alternatives></inline-formula>} and<italic> X</italic><sub>2</sub> = {<inline-formula id="IEq7"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${x}_{0}^{2}$$\end{document}</tex-math><mml:math id="M14"><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2023_5566_Article_IEq7.gif"/></alternatives></inline-formula>, <inline-formula id="IEq8"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${x}_{1}^{2}$$\end{document}</tex-math><mml:math id="M16"><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2023_5566_Article_IEq8.gif"/></alternatives></inline-formula>, <inline-formula id="IEq9"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${x}_{2}^{2}$$\end{document}</tex-math><mml:math id="M18"><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2023_5566_Article_IEq9.gif"/></alternatives></inline-formula>, …, <inline-formula id="IEq10"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${x}_{{v\times x}_{2}-1}^{2}$$\end{document}</tex-math><mml:math id="M20"><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:msub><mml:mrow><mml:mi>v</mml:mi><mml:mo>×</mml:mo><mml:mi>x</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2023_5566_Article_IEq10.gif"/></alternatives></inline-formula>}, each group <inline-formula id="IEq11"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${x}_{j}^{e}$$\end{document}</tex-math><mml:math id="M22"><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mi>e</mml:mi></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2023_5566_Article_IEq11.gif"/></alternatives></inline-formula> contains description information, sequencing reads, and quality scores, where <italic>j</italic> = 0, 1, 2, …, <italic>v</italic> × <italic>x</italic><sub><italic>e</italic></sub>-1, <italic>i</italic> = 0, 1, 2, …, <italic>v</italic>-1, <italic>x</italic><sub>2</sub> &gt;  &gt; <italic>x</italic><sub>1</sub> and <italic>e</italic> = 1, 2.</p>
        <p id="Par19"><bold>Step 2</bold>: Run compressor <italic>Y</italic> for pre-compressing datasets<italic> X</italic><sub>1</sub> and <italic>X</italic><sub>2</sub>, getting <italic>Y</italic>'s peak memory <inline-formula id="IEq12"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Y}_{peak}^{1}$$\end{document}</tex-math><mml:math id="M24"><mml:msubsup><mml:mi>Y</mml:mi><mml:mrow><mml:mi mathvariant="italic">peak</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2023_5566_Article_IEq12.gif"/></alternatives></inline-formula> and <inline-formula id="IEq13"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Y}_{peak}^{2}$$\end{document}</tex-math><mml:math id="M26"><mml:msubsup><mml:mi>Y</mml:mi><mml:mrow><mml:mi mathvariant="italic">peak</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2023_5566_Article_IEq13.gif"/></alternatives></inline-formula> on datasets <italic>X</italic><sub>1</sub> and <italic>X</italic><sub>2</sub>.</p>
        <p id="Par20"><bold>Step 3</bold>: Estimate the compression peak memory <italic>Y</italic><sub><italic>cpm</italic></sub> of algorithm <italic>Y</italic> on datasets <italic>F</italic> = {<italic>F</italic><sub>0</sub>, <italic>F</italic><sub>1</sub>, …, <italic>F</italic><sub><italic>v</italic>-1</sub>} according to the formula (<xref rid="Equ1" ref-type="disp-formula">1</xref>):<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Y_{cpm} = Y_{res} + Y_{reads} = Y_{peak}^{1} + \frac{{\left| {Y_{peak}^{2} - Y_{peak}^{1} } \right|}}{{v \times \left( {x_{2} - x_{1} } \right)}} \times \mathop \sum \limits_{i = 0}^{v} \frac{{\left| {F_{i} } \right|}}{4}$$\end{document}</tex-math><mml:math id="M28" display="block"><mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi mathvariant="italic">cpm</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi mathvariant="italic">res</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi mathvariant="italic">reads</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mi>Y</mml:mi><mml:mrow><mml:mi mathvariant="italic">peak</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:mfrac><mml:mfenced close="|" open="|"><mml:mrow><mml:msubsup><mml:mi>Y</mml:mi><mml:mrow><mml:mi mathvariant="italic">peak</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>-</mml:mo><mml:msubsup><mml:mi>Y</mml:mi><mml:mrow><mml:mi mathvariant="italic">peak</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msubsup></mml:mrow></mml:mfenced><mml:mrow><mml:mi>v</mml:mi><mml:mo>×</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mfrac><mml:mo>×</mml:mo><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mi>v</mml:mi></mml:munderover><mml:mfrac><mml:mfenced close="|" open="|"><mml:msub><mml:mi>F</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfenced><mml:mn>4</mml:mn></mml:mfrac></mml:mrow></mml:math><graphic xlink:href="12859_2023_5566_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula></p>
        <p id="Par21">In formula (<xref rid="Equ1" ref-type="disp-formula">1</xref>), |<italic>F</italic><sub><italic>i</italic></sub>|/4 denotes the total number of reads in <italic>F</italic><sub><italic>i</italic></sub>, where <italic>i</italic> = 0, 1, 2, …, <italic>v</italic>-1.</p>
      </sec>
      <sec id="Sec5">
        <title>Feature extraction</title>
        <p id="Par22">In pre-compression stage, PMFFRC estimated the maximum memory consumption <italic>Y</italic><sub><italic>cpm</italic></sub> of compressor <italic>Y</italic> on <italic>F</italic>. However, the calculated <italic>Y</italic><sub><italic>cpm</italic></sub> might exceed the system memory. Thus, PMFFRC compresses similar fastq files in batches via redundant reads clustering method, using reads' feature vectors and user-preset safe memory threshold. However, converting string reads to digitized feature vectors is time-consuming. Therefore, PMFFRC utilizes CPU multi-cores to accelerate this stage in parallel.</p>
        <p id="Par23">Let <italic>Pr</italic> denotes the number of utilized CPU cores, <inline-formula id="IEq14"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\overline{R} }_{i}$$\end{document}</tex-math><mml:math id="M30"><mml:msub><mml:mover><mml:mi>R</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5566_Article_IEq14.gif"/></alternatives></inline-formula>= [<inline-formula id="IEq15"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\dot{R}}_{0}^{i},{\dot{R}}_{1}^{i},{\dot{R}}_{2}^{i},\dots ,{\dot{R}}_{\left(\left|{F}_{i}\right|/4\right)-1}^{i}$$\end{document}</tex-math><mml:math id="M32"><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>R</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mi>i</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi>R</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mi>i</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi>R</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mi>i</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi>R</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mrow><mml:mfenced close=")" open="("><mml:mfenced close="|" open="|"><mml:msub><mml:mi>F</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfenced><mml:mo stretchy="false">/</mml:mo><mml:mn>4</mml:mn></mml:mfenced><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>i</mml:mi></mml:msubsup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5566_Article_IEq15.gif"/></alternatives></inline-formula>] denotes a numeral feature vector of <italic>R</italic><sub><italic>i</italic></sub>, and <inline-formula id="IEq16"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\dot{R}}_{j}^{i}$$\end{document}</tex-math><mml:math id="M34"><mml:msubsup><mml:mover accent="true"><mml:mi>R</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2023_5566_Article_IEq16.gif"/></alternatives></inline-formula> is the feature value of read <inline-formula id="IEq17"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${R}_{j}^{i}$$\end{document}</tex-math><mml:math id="M36"><mml:msubsup><mml:mi>R</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2023_5566_Article_IEq17.gif"/></alternatives></inline-formula>. Referring to the design idea of the reads scoring model in FastqCLS [<xref ref-type="bibr" rid="CR25">25</xref>], PMFFRC employs <italic>Pr</italic> CPU cores to extract sequencing reads feature values in parallel through the data cycle division strategy [<xref ref-type="bibr" rid="CR27">27</xref>], as shown in the formula (<xref rid="Equ2" ref-type="disp-formula">2</xref>):<disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\dot{R}_{j}^{i,p} = \mathop \prod \limits_{e = 0}^{3} \left( {\mathop \sum \limits_{r = 0}^{{\left| {R_{j}^{i,p} } \right|}} I\left( {R_{j}^{i,p} \left[ r \right] = E\left[ e \right]} \right) + 1} \right)/n$$\end{document}</tex-math><mml:math id="M38" display="block"><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>R</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:munderover><mml:mo movablelimits="false">∏</mml:mo><mml:mrow><mml:mi>e</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mn>3</mml:mn></mml:munderover><mml:mfenced close=")" open="("><mml:mrow><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mfenced close="|" open="|"><mml:msubsup><mml:mi>R</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:msubsup></mml:mfenced></mml:munderover><mml:mi>I</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msubsup><mml:mi>R</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:msubsup><mml:mfenced close="]" open="["><mml:mi>r</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:mi>E</mml:mi><mml:mfenced close="]" open="["><mml:mi>e</mml:mi></mml:mfenced></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced><mml:mo stretchy="false">/</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math><graphic xlink:href="12859_2023_5566_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula></p>
        <p id="Par24">In formula (<xref rid="Equ2" ref-type="disp-formula">2</xref>), <italic>E</italic> = {A, C, G, T}, <inline-formula id="IEq18"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I\left({R}_{j}^{i,p}\left[r\right]=E\left[e\right]\right)$$\end{document}</tex-math><mml:math id="M40"><mml:mrow><mml:mi>I</mml:mi><mml:mfenced close=")" open="("><mml:msubsup><mml:mi>R</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:msubsup><mml:mfenced close="]" open="["><mml:mi>r</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:mi>E</mml:mi><mml:mfenced close="]" open="["><mml:mi>e</mml:mi></mml:mfenced></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5566_Article_IEq18.gif"/></alternatives></inline-formula> is an indicator function, <italic>p</italic> denotes the <italic>p</italic>-th CPU core, and <italic>p</italic> = <italic>i</italic> % <italic>Pr</italic>, where <italic>j</italic> = 0, 1, 2, …,<inline-formula id="IEq19"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left(\left|{F}_{i}\right|/4\right)$$\end{document}</tex-math><mml:math id="M42"><mml:mfenced close=")" open="("><mml:mfenced close="|" open="|"><mml:msub><mml:mi>F</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfenced><mml:mo stretchy="false">/</mml:mo><mml:mn>4</mml:mn></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2023_5566_Article_IEq19.gif"/></alternatives></inline-formula>-1, <italic>i</italic> = 0, 1, 2, …, <italic>v</italic>-1.</p>
      </sec>
      <sec id="Sec6">
        <title>Similarity calculation</title>
        <p id="Par25">After obtaining the feature vector <inline-formula id="IEq20"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\overline{R} }_{i}$$\end{document}</tex-math><mml:math id="M44"><mml:msub><mml:mover><mml:mi>R</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5566_Article_IEq20.gif"/></alternatives></inline-formula>= [<inline-formula id="IEq21"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\dot{R}}_{0}^{i},{\dot{ R}}_{1}^{i},{ \dot{R}}_{2}^{i}, \dots ,{\dot{ R}}_{\left(\left|{F}_{i}\right|/4\right)-1}^{i}$$\end{document}</tex-math><mml:math id="M46"><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>R</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mi>i</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi>R</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mi>i</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi>R</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mi>i</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi>R</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mrow><mml:mfenced close=")" open="("><mml:mfenced close="|" open="|"><mml:msub><mml:mi>F</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfenced><mml:mo stretchy="false">/</mml:mo><mml:mn>4</mml:mn></mml:mfenced><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>i</mml:mi></mml:msubsup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5566_Article_IEq21.gif"/></alternatives></inline-formula>] of <italic>R</italic><sub><italic>i</italic></sub> in <italic>F</italic><sub><italic>i</italic></sub>, PMFFRC evaluates the redundant reads similarity between different fastq files. Let <italic>S</italic> denotes a similarity collection of feature vectors <inline-formula id="IEq22"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\overline{R} }_{a}$$\end{document}</tex-math><mml:math id="M48"><mml:msub><mml:mover><mml:mi>R</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mi>a</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5566_Article_IEq22.gif"/></alternatives></inline-formula> and <inline-formula id="IEq23"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\overline{R} }_{b}$$\end{document}</tex-math><mml:math id="M50"><mml:msub><mml:mover><mml:mi>R</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mi>b</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5566_Article_IEq23.gif"/></alternatives></inline-formula>. In practical scenarios, the data scale between <italic>F</italic><sub><italic>a</italic></sub> and <italic>F</italic><sub><italic>b</italic></sub> is unbalanced, usually. To offset the impact of fastq file size differences on similarity calculation between <italic>F</italic><sub><italic>a</italic></sub> and <italic>F</italic><sub><italic>b</italic></sub>, PMFFRC introduces correction parameters <italic>α</italic> and dice coefficient [<xref ref-type="bibr" rid="CR28">28</xref>], uses <italic>Pr</italic> CPU cores, and improves the parallel similarity calculation model as shown in formula (<xref rid="Equ3" ref-type="disp-formula">3</xref>):<disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$sim\left({\overline{R} }_{a}^{p},{\overline{R} }_{b}^{p}\right)=\alpha \times \frac{2\times \left|{\overline{R} }_{a}^{p}\cap {\overline{R} }_{b}^{p}\right|}{\left|{\overline{R} }_{a}^{p}\right|+\left|{\overline{R} }_{b}^{p}\right|}$$\end{document}</tex-math><mml:math id="M52" display="block"><mml:mrow><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>m</mml:mi><mml:mfenced close=")" open="("><mml:msubsup><mml:mover><mml:mi>R</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mi>p</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mover><mml:mi>R</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mi>p</mml:mi></mml:msubsup></mml:mfenced><mml:mo>=</mml:mo><mml:mi>α</mml:mi><mml:mo>×</mml:mo><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mo>×</mml:mo><mml:mfenced close="|" open="|"><mml:msubsup><mml:mover><mml:mi>R</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mi>p</mml:mi></mml:msubsup><mml:mo>∩</mml:mo><mml:msubsup><mml:mover><mml:mi>R</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mi>p</mml:mi></mml:msubsup></mml:mfenced></mml:mrow><mml:mrow><mml:mfenced close="|" open="|"><mml:msubsup><mml:mover><mml:mi>R</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mi>p</mml:mi></mml:msubsup></mml:mfenced><mml:mo>+</mml:mo><mml:mfenced close="|" open="|"><mml:msubsup><mml:mover><mml:mi>R</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mi>p</mml:mi></mml:msubsup></mml:mfenced></mml:mrow></mml:mfrac></mml:mrow></mml:math><graphic xlink:href="12859_2023_5566_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula></p>
        <p id="Par26">In formula (<xref rid="Equ3" ref-type="disp-formula">3</xref>), <inline-formula id="IEq24"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$sim({\overline{R} }_{a}, {\overline{R} }_{b})$$\end{document}</tex-math><mml:math id="M54"><mml:mrow><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>m</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mover><mml:mi>R</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mi>a</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mover><mml:mi>R</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mi>b</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5566_Article_IEq24.gif"/></alternatives></inline-formula> denotes the similarity value between the feature vectors <inline-formula id="IEq25"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\overline{R} }_{a}$$\end{document}</tex-math><mml:math id="M56"><mml:msub><mml:mover><mml:mi>R</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mi>a</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5566_Article_IEq25.gif"/></alternatives></inline-formula> and <inline-formula id="IEq26"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\overline{R} }_{b}$$\end{document}</tex-math><mml:math id="M58"><mml:msub><mml:mover><mml:mi>R</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mi>b</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5566_Article_IEq26.gif"/></alternatives></inline-formula>. Where <inline-formula id="IEq27"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha =1/(1-\frac{\left|\left|{\overline{R} }_{a}^{p}\right|-\left|{\overline{R} }_{b}^{p}\right|\right|}{\left|{\overline{R} }_{a}^{p}\right|+\left|{\overline{R} }_{b}^{p}\right|})$$\end{document}</tex-math><mml:math id="M60"><mml:mrow><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mfrac><mml:mfenced close="|" open="|"><mml:mfenced close="|" open="|"><mml:msubsup><mml:mover><mml:mi>R</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mi>p</mml:mi></mml:msubsup></mml:mfenced><mml:mo>-</mml:mo><mml:mfenced close="|" open="|"><mml:msubsup><mml:mover><mml:mi>R</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mi>p</mml:mi></mml:msubsup></mml:mfenced></mml:mfenced><mml:mrow><mml:mfenced close="|" open="|"><mml:msubsup><mml:mover><mml:mi>R</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mi>p</mml:mi></mml:msubsup></mml:mfenced><mml:mo>+</mml:mo><mml:mfenced close="|" open="|"><mml:msubsup><mml:mover><mml:mi>R</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mi>p</mml:mi></mml:msubsup></mml:mfenced></mml:mrow></mml:mfrac><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5566_Article_IEq27.gif"/></alternatives></inline-formula>, <italic>p</italic> = <italic>s</italic> % <italic>Pr</italic>, <italic>s</italic> = 0, 1, 2, …, |<italic>S</italic>|-1, |<italic>S</italic>|= <inline-formula id="IEq28"><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\frac{v\times (v-1)}{2}$$\end{document}</tex-math><mml:math id="M62"><mml:mfrac><mml:mrow><mml:mi>v</mml:mi><mml:mo>×</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>v</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:mfrac></mml:math><inline-graphic xlink:href="12859_2023_5566_Article_IEq28.gif"/></alternatives></inline-formula>, <italic>a</italic> = 1, 2, 3, …, <italic>v</italic>-1, <italic>b</italic> = 0, 1, 2, …, <italic>v</italic>-2, and<italic> a</italic> &gt; <italic>b</italic>.</p>
      </sec>
      <sec id="Sec7">
        <title>Fastq files clustering</title>
        <p id="Par27">For computing friendly, PMFFRC converts the string reads files into numerical vectors to calculate <italic>S</italic> via formula (<xref rid="Equ3" ref-type="disp-formula">3</xref>). After that, it sorts <italic>S</italic> in descending order using the quicksort algorithm [<xref ref-type="bibr" rid="CR29">29</xref>] and performs fastq files clustering. In order to select an appropriate parameter <italic>K</italic>, PMFFRC utilizes a two-level clustering parameter selection strategy. Specifically, PMFFRC first determines the files-level parameter <italic>K</italic><sub>1</sub> and then slightly adjusts it to get the reads-level parameter <italic>K</italic><sub>2</sub>.</p>
        <p id="Par28">In actual experimental observations, the peak memory <italic>Y</italic><sub>cpm</sub> of <italic>Y</italic> shows a nonlinear growth trend with the fastq data scale growth of <italic>F</italic> in some cases (such as FastqCLS). Considering algorithm robustness, by modeling <italic>U</italic><sub><italic>ram</italic></sub> and <italic>Y</italic><sub><italic>cpm</italic></sub>, PMFFRC introduces an empirical correction factor <italic>β</italic> to artificial-fixed the files-level clustering parameter <italic>K</italic><sub>1</sub>, the calculation model as shown in formula (<xref rid="Equ4" ref-type="disp-formula">4</xref>):<disp-formula id="Equ4"><label>4</label><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${K}_{1}=\lceil\beta \times \frac{{Y}_{reads}}{{U}_{ram}-{Y}_{res}}\rceil$$\end{document}</tex-math><mml:math id="M64" display="block"><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>⌈</mml:mo><mml:mi>β</mml:mi><mml:mo>×</mml:mo><mml:mfrac><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi mathvariant="italic">reads</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:msub><mml:mi>U</mml:mi><mml:mrow><mml:mi mathvariant="italic">ram</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi mathvariant="italic">res</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>⌉</mml:mo></mml:mrow></mml:mrow></mml:math><graphic xlink:href="12859_2023_5566_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula></p>
        <p id="Par29">In formula (<xref rid="Equ4" ref-type="disp-formula">4</xref>), the parameter <italic>K</italic><sub>1</sub> represents the number of files-level clusters determined by the memory modeling method. However, there is a significant variation in the number of reads across different sequencing files. When the number of short reads within a cluster becomes too large, it may exceed the predefined memory threshold <italic>U</italic><sub><italic>ram</italic></sub> for compression. Therefore, optimizer PMFFRC dynamically adjusts t <italic>K</italic><sub>1</sub> to get the number of clusters <italic>K</italic><sub>2</sub> at reads-level as the final clustering parameter <italic>K</italic>.</p>
        <p id="Par30">Figure <xref rid="Fig1" ref-type="fig">1</xref> illustrates the clustering of five sequencing fastq files using the proposed two-level (where <italic>v</italic> = 5 and <italic>K</italic><sub>1</sub> = 2) clustering parameter selection strategy.<fig id="Fig1"><label>Fig.1</label><caption><p>Example of clustering fastq files using a two-level parameter selection strategy</p></caption><graphic xlink:href="12859_2023_5566_Fig1_HTML" id="MO1"/></fig></p>
        <p id="Par31">In Fig. <xref rid="Fig1" ref-type="fig">1</xref>, <italic>K</italic><sub>1</sub> = 2, and <italic>M</italic> = 1060 denotes the overall reads number. According to <italic>K</italic><sub>1</sub> and <italic>M</italic>, PMFFRC gets the average number of reads in each cluster as <italic>ave</italic> =<inline-formula id="IEq29"><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lfloor {{M}/{K}_{1} } \rfloor$$\end{document}</tex-math><mml:math id="M66"><mml:mrow><mml:mo>⌊</mml:mo><mml:mrow><mml:mi>M</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo>⌋</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5566_Article_IEq29.gif"/></alternatives></inline-formula>  = 530. However, the value of <italic>ave</italic> is calculated under the <italic>K</italic><sub>1</sub> condition, and due to significant variations of the reads number in different fastq files, it is challenging for the optimizer PMFFRC to achieve the ideal reads number average state for each cluster. Therefore, PMFFRC fine-tunes at the reads level to ensure that the actual number of reads within each cluster is close to the <italic>ave</italic> value. Figure <xref rid="Fig1" ref-type="fig">1</xref>a shows the similarity matrix calculated from formula (<xref rid="Equ3" ref-type="disp-formula">3</xref>). In Fig. <xref rid="Fig1" ref-type="fig">1</xref>b, our optimizer PMFFRC initiates the analysis from the matrix element with the highest similarity score and employs a straightforward "first cluster first priority" principle when clustering fastq files. This straightforward implementation strategy guarantees an overall time advantage for the optimizer. PMFFR first detects that max(<italic>S</italic>) is <italic>sim</italic>(<inline-formula id="IEq30"><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\overline{R} }_{3}, {\overline{R} }_{0}$$\end{document}</tex-math><mml:math id="M68"><mml:mrow><mml:msub><mml:mover><mml:mi>R</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mn>3</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mover><mml:mi>R</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5566_Article_IEq30.gif"/></alternatives></inline-formula>) = 0.92, which indicates the redundant reads between fastq files <italic>F</italic><sub>3</sub> and <italic>F</italic><sub>0</sub> have the highest similarity, so it adds <italic>F</italic><sub>0</sub> and <italic>F</italic><sub>3</sub> to the cluster <italic>C</italic><sub>0</sub>. Then, PMFFRC calculates the total number of reads |<italic>C</italic><sub>0</sub>| is 340 in <italic>C</italic><sub>0</sub>, which is less than <italic>ave</italic>, so it tries to add the fastq file<italic> F</italic><sub>1</sub> in <italic>C</italic><sub>0</sub>. However, |<italic>C</italic><sub>0</sub>| is 650 at this time, which is greater than <italic>ave</italic>, so it discards <italic>F</italic><sub>1</sub> and obtains the first cluster <italic>C</italic><sub>0</sub> = {<italic>F</italic><sub>0</sub>, <italic>F</italic><sub>3</sub>}. After the above steps, the first cluster <italic>C</italic><sub>0</sub> has been received. Thus, PMFFRC removes the elements in collection <italic>C</italic><sub>0</sub> from the similarity matrix and selects the second cluster files. In Fig. <xref rid="Fig1" ref-type="fig">1</xref>c, d, after the first cluster has been built, the remaining components are <italic>sim</italic>(<inline-formula id="IEq31"><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\overline{R} }_{2}, {\overline{R} }_{1}$$\end{document}</tex-math><mml:math id="M70"><mml:mrow><mml:msub><mml:mover><mml:mi>R</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mover><mml:mi>R</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5566_Article_IEq31.gif"/></alternatives></inline-formula>), <italic>sim</italic>(<inline-formula id="IEq32"><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\overline{R} }_{4}, {\overline{R} }_{1}$$\end{document}</tex-math><mml:math id="M72"><mml:mrow><mml:msub><mml:mover><mml:mi>R</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mn>4</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mover><mml:mi>R</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5566_Article_IEq32.gif"/></alternatives></inline-formula>), <italic>sim</italic>(<inline-formula id="IEq33"><alternatives><tex-math id="M73">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\overline{R} }_{4}, {\overline{R} }_{2}$$\end{document}</tex-math><mml:math id="M74"><mml:mrow><mml:msub><mml:mover><mml:mi>R</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mn>4</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mover><mml:mi>R</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5566_Article_IEq33.gif"/></alternatives></inline-formula>), and <italic>sim</italic>(<inline-formula id="IEq34"><alternatives><tex-math id="M75">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\overline{R} }_{4}, {\overline{R} }_{3}$$\end{document}</tex-math><mml:math id="M76"><mml:mrow><mml:msub><mml:mover><mml:mi>R</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mn>4</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mover><mml:mi>R</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5566_Article_IEq34.gif"/></alternatives></inline-formula>), where <italic>sim</italic>(<inline-formula id="IEq35"><alternatives><tex-math id="M77">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\overline{R} }_{4}, {\overline{R} }_{1}$$\end{document}</tex-math><mml:math id="M78"><mml:mrow><mml:msub><mml:mover><mml:mi>R</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mn>4</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mover><mml:mi>R</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5566_Article_IEq35.gif"/></alternatives></inline-formula>) = 0.90 is the highest similarity score. Therefore, PMFFRC adds <italic>F</italic><sub>4</sub> and <italic>F</italic><sub>1</sub> to a new cluster <italic>C</italic><sub>1</sub>. Now, |<italic>C</italic><sub>1</sub>|= 460, which is less than <italic>ave</italic>. If PMFFRC adds <italic>F</italic><sub>2</sub> to cluster <italic>C</italic><sub>1</sub>, |<italic>C</italic><sub>1</sub>| will exceed <italic>ave</italic>. Consequently, PMFFRC ends the second clustering stage to obtain cluster <italic>C</italic><sub>1</sub> = {<italic>F</italic><sub>1</sub>, <italic>F</italic><sub>4</sub>} and adds fastq file <italic>F</italic><sub>2</sub> to another cluster <italic>C</italic><sub>2</sub> = {<italic>F</italic><sub>2</sub>}.</p>
        <p id="Par32">Via user-preset safe memory threshold and reads feature vectors, PMFFRC clusters similar fastq files together. Thus, the high-similarity files in the same cluster generate more highly similar redundant reads, which is more helpful for subsequent cascaded compressors. Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Algorithm S1 summarizes the proposed optimization method PMFFRC. Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Section S2 details the algorithm description and analysis.</p>
      </sec>
    </sec>
    <sec id="Sec8">
      <title>Joint compression and decompression</title>
      <p id="Par33">When obtaining the cluster record files, <italic>C</italic><sub><italic>k</italic></sub>.info, of the sequencing files collection <italic>F</italic> = {<italic>F</italic><sub>0</sub>, <italic>F</italic><sub>1</sub>, …, <italic>F</italic><sub><italic>v</italic>-1</sub>}, the fastq files in each cluster <italic>C</italic><sub><italic>k</italic></sub> are merged according to temp files <italic>C</italic><sub><italic>k</italic></sub>.info, where <italic>k</italic> = 0, 1, 2,…, <italic>K</italic>-1. After that, dedicated state-of-the-art short reads compressors can be used to compress these clustered files.</p>
      <p id="Par34">The PMFFRC optimizer further improves the compression ratio for the optimized algorithm on the cluster files at the joint compression and decompression phase. Due to its heightened scalability, PMFFRC can be applied to the latest short reads compressors. To better embody the optimization idea, Fig. <xref rid="Fig2" ref-type="fig">2</xref> shows the overall processing workflow of the PMFFRC optimizes algorithm <italic>Y</italic> to compress and decompress fastq format files collection<italic> F</italic> = {<italic>F</italic><sub>0</sub>, <italic>F</italic><sub>1</sub>, …, <italic>F</italic><sub><italic>v</italic>-1</sub>}.<fig id="Fig2"><label>Fig. 2</label><caption><p>The overall processing workflow of the optimized cascaded compressor <italic>Y</italic> via PMFFRC, on fastq format sequencing files collection <italic>F</italic></p></caption><graphic xlink:href="12859_2023_5566_Fig2_HTML" id="MO2"/></fig></p>
      <p id="Par35">In Fig. <xref rid="Fig2" ref-type="fig">2</xref>a, <italic>C</italic><sub><italic>k</italic></sub>.ycom is the compressed files by compressor <italic>Y</italic>, and the *.pmffrc file is the optimized compressed files, where <italic>k</italic> = 0, 1, 2, …, <italic>K</italic>-1. In Fig. <xref rid="Fig2" ref-type="fig">2</xref>b, <italic>F</italic><sub><italic>i</italic></sub>.reads denote the recovered files corresponding to <italic>F</italic><sub><italic>i</italic></sub>.fastq, where <italic>i</italic> = 0, 1, 2, …, <italic>v</italic>-1.</p>
    </sec>
  </sec>
  <sec id="Sec9">
    <title>Results</title>
    <sec id="Sec10">
      <title>Experimental configuration and datasets</title>
      <p id="Par36">Evaluation experiments were carried out on a Sugon-7000A supercomputer system of the National High-Performance Computing Center Nanning Branch (<ext-link ext-link-type="uri" xlink:href="https://hpc.gxu.edu.cn">https://hpc.gxu.edu.cn</ext-link>). Computing nodes are equipped with 2*Intel Xeon Gold 6230 CPU (2.1 Ghz, 40 cores), 512 GB DDR4 SDRAM, and 8*900 GB disk space. The experimental node runs the 64-bit version of centos 7.4. The PMFFRC was implemented by C +  + 11 and OpenMP. The overall workflow has been encapsulated into the PMFFRC toolkit. Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Section S3 gives the installation and configuration details of the PMFFRC optimizer. The PMFFRC toolkit follows the Apache-2.0 License, available freely at <ext-link ext-link-type="uri" xlink:href="https://github.com/fahaihi/PMFFRC">https://github.com/fahaihi/PMFFRC</ext-link>.</p>
      <p id="Par37">Three large-scale datasets from the NCBI (<ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/sra">https://www.ncbi.nlm.nih.gov/sra</ext-link>) database were used to assess optimization effects. For paired-end sequencing files, PMFFRC arranges them as two separate single-end files. Table <xref rid="Tab1" ref-type="table">1</xref> gives the details of the experimental datasets.<table-wrap id="Tab1"><label>Table 1</label><caption><p>Datasets used for optimizing large-scale genomic sequencing reads compression</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Dataset name (species)</th><th align="left">Sequencing platform (method)</th><th align="left">Number of reads (millions)</th><th align="left">Total size (GB)</th><th align="left">Reads size (GB)</th><th align="left">Length (bp)</th><th align="left">Number of files</th></tr></thead><tbody><tr><td align="left"><italic>Homo sapiens</italic></td><td align="left">NextSeq-550 (SE)</td><td char="." align="char">507.40</td><td char="." align="char">111.25</td><td char="." align="char">36.78</td><td align="left">75</td><td align="left">24</td></tr><tr><td align="left"><italic>Cicer arietinum</italic></td><td align="left">HiSeq-2000 (PE)</td><td char="." align="char">2060.96</td><td char="." align="char">680.60</td><td char="." align="char">178.54</td><td align="left">90</td><td align="left">60</td></tr><tr><td align="left"><italic>Salvelinus fontinalis</italic></td><td align="left">Ion-Torrent (SE)</td><td char="." align="char">757.46</td><td char="." align="char">189.66</td><td char="." align="char">58.14</td><td align="left">80</td><td align="left">360</td></tr><tr><td align="left">Total</td><td align="left">–</td><td char="." align="char">3325.82</td><td char="." align="char">981.52</td><td char="." align="char">273.46</td><td align="left">–</td><td align="left">444</td></tr></tbody></table><table-wrap-foot><p>Datasets download by employing sra-tools (<ext-link ext-link-type="uri" xlink:href="https://github.com/ncbi/sra-tools">https://github.com/ncbi/sra-tools</ext-link>). For complete NCBI registration numbers, see Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Section S4</p></table-wrap-foot></table-wrap></p>
      <p id="Par38">The proposed algorithm PMFFRC was tested on three large-scale datasets, and its compression size (<italic>cs</italic>), compression ratio (<italic>cr</italic>), compression peak memory (<italic>cpm</italic>), compression time (<italic>ct</italic>), decompression time (<italic>dt</italic>), and decompression peak memory (<italic>dpm</italic>) were compared to most state-of-the-art and reference-free reads compressors, more specifically, HARC [<xref ref-type="bibr" rid="CR14">14</xref>], SPRING [<xref ref-type="bibr" rid="CR17">17</xref>], Mstcom [<xref ref-type="bibr" rid="CR22">22</xref>] and FastqCLS [<xref ref-type="bibr" rid="CR25">25</xref>]. We also employed the compression ratio gains (<italic>crg</italic>) and percent storage savings (<italic>pss</italic>) to evaluate the optimization results. The <italic>crg</italic> and <italic>pss</italic> calculations are as follows:<disp-formula id="Equ5"><label>5</label><alternatives><tex-math id="M79">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$crg = \frac{cr\_with\_PMFFRC}{{cr\_without\_PMFFRC}} - 1$$\end{document}</tex-math><mml:math id="M80" display="block"><mml:mrow><mml:mi>c</mml:mi><mml:mi>r</mml:mi><mml:mi>g</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>c</mml:mi><mml:mi>r</mml:mi><mml:mi>_</mml:mi><mml:mi>w</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi><mml:mi>h</mml:mi><mml:mi>_</mml:mi><mml:mi>P</mml:mi><mml:mi>M</mml:mi><mml:mi>F</mml:mi><mml:mi>F</mml:mi><mml:mi>R</mml:mi><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mi>r</mml:mi><mml:mi>_</mml:mi><mml:mi>w</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi><mml:mi>h</mml:mi><mml:mi>o</mml:mi><mml:mi>u</mml:mi><mml:mi>t</mml:mi><mml:mi>_</mml:mi><mml:mi>P</mml:mi><mml:mi>M</mml:mi><mml:mi>F</mml:mi><mml:mi>F</mml:mi><mml:mi>R</mml:mi><mml:mi>C</mml:mi></mml:mrow></mml:mfrac><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><graphic xlink:href="12859_2023_5566_Article_Equ5.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ6"><label>6</label><alternatives><tex-math id="M81">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$pss = 1 - \frac{cs\_with\_PMFFRC}{{cs\_without\_PMFFRC}}$$\end{document}</tex-math><mml:math id="M82" display="block"><mml:mrow><mml:mi>p</mml:mi><mml:mi>s</mml:mi><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:mi>c</mml:mi><mml:mi>s</mml:mi><mml:mi>_</mml:mi><mml:mi>w</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi><mml:mi>h</mml:mi><mml:mi>_</mml:mi><mml:mi>P</mml:mi><mml:mi>M</mml:mi><mml:mi>F</mml:mi><mml:mi>F</mml:mi><mml:mi>R</mml:mi><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mi>s</mml:mi><mml:mi>_</mml:mi><mml:mi>w</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi><mml:mi>h</mml:mi><mml:mi>o</mml:mi><mml:mi>u</mml:mi><mml:mi>t</mml:mi><mml:mi>_</mml:mi><mml:mi>P</mml:mi><mml:mi>M</mml:mi><mml:mi>F</mml:mi><mml:mi>F</mml:mi><mml:mi>R</mml:mi><mml:mi>C</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:math><graphic xlink:href="12859_2023_5566_Article_Equ6.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par39">All experiments assume the compression server has a maximum memory of 300 GB and utilizes the default 8 CPU cores for joint compression and decompression.</p>
    </sec>
    <sec id="Sec11">
      <title>Performance on Homo sapiens dataset</title>
      <p id="Par40">Table <xref rid="Tab2" ref-type="table">2</xref> shows the results for HARC, SPRING, Mstcom, and FastqCLS using the proposed algorithm PMFFRC on the <italic>H. sapiens</italic> dataset.<table-wrap id="Tab2"><label>Table 2</label><caption><p>Performance of PMFFRC on <italic>H. sapiens</italic> dataset</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" rowspan="2">Algorithm</th><th align="left" rowspan="2">Parameter</th><th align="left" colspan="6">Compression</th><th align="left" colspan="2">Decompression</th></tr><tr><th align="left"><italic>cs</italic> (GB)</th><th align="left"><italic>pss</italic> (%)</th><th align="left"><italic>cr</italic> (bits/base)</th><th align="left"><italic>crg</italic> (%)</th><th align="left"><italic>cpm</italic> (GB)</th><th align="left"><italic>ct</italic> (h)</th><th align="left"><italic>dpm</italic> (GB)</th><th align="left"><italic>dt</italic> (h)</th></tr></thead><tbody><tr><td align="left" rowspan="3">HARC</td><td align="left"><italic>Without</italic></td><td char="." align="char">7.15</td><td align="left">–</td><td char="." align="char">1.61</td><td align="left">–</td><td char="." align="char">1.78</td><td align="left">1.37</td><td char="." align="char">1.57</td><td char="." align="char">1.51</td></tr><tr><td align="left">-<italic>u</italic>10, <italic>k</italic>3</td><td char="." align="char">4.68</td><td align="left"><bold>34.55</bold></td><td char="." align="char">1.06</td><td align="left"><bold>52.77</bold></td><td char="." align="char">9.49</td><td align="left"><bold>1.29</bold></td><td char="." align="char">5.22</td><td char="." align="char">1.65</td></tr><tr><td align="left">-<italic>u</italic>20, <italic>k</italic>1</td><td char="." align="char">3.27</td><td align="left"><bold>45.74</bold></td><td char="." align="char">0.74</td><td align="left"><bold>118.54</bold></td><td char="." align="char">19.61</td><td align="left"><bold>1.01</bold></td><td char="." align="char">5.89</td><td char="." align="char">1.74</td></tr><tr><td align="left" rowspan="4">SPRING</td><td align="left"><italic>Without</italic></td><td char="." align="char">7.16</td><td align="left">–</td><td char="." align="char">1.62</td><td align="left">–</td><td char="." align="char">3.64</td><td align="left">0.97</td><td char="." align="char">1.22</td><td char="." align="char">0.26</td></tr><tr><td align="left">-<italic>u</italic>10, <italic>k</italic>4</td><td char="." align="char">4.75</td><td align="left"><bold>33.66</bold></td><td char="." align="char">1.07</td><td align="left"><bold>50.68</bold></td><td char="." align="char">7.09</td><td align="left">1.39</td><td char="." align="char">2.85</td><td char="." align="char"><bold>0.19</bold></td></tr><tr><td align="left">-<italic>u</italic>20, <italic>k</italic>3</td><td char="." align="char">4.19</td><td align="left"><bold>41.48</bold></td><td char="." align="char">0.95</td><td align="left"><bold>70.91</bold></td><td char="." align="char">10.29</td><td align="left">1.26</td><td char="." align="char">4.63</td><td char="." align="char"><bold>0.22</bold></td></tr><tr><td align="left">-<italic>u</italic>40, <italic>k</italic>1</td><td char="." align="char">3.16</td><td align="left"><bold>55.87</bold></td><td char="." align="char">0.71</td><td align="left"><bold>126.95</bold></td><td char="." align="char">20.71</td><td align="left">1.20</td><td char="." align="char">4.95</td><td char="." align="char"><bold>0.23</bold></td></tr><tr><td align="left" rowspan="4">Mstcom</td><td align="left"><italic>Without</italic></td><td char="." align="char">6.13</td><td align="left">–</td><td char="." align="char">1.38</td><td align="left">–</td><td char="." align="char">13.60</td><td align="left">8.97</td><td char="." align="char">6.22</td><td char="." align="char">1.32</td></tr><tr><td align="left">-<italic>u</italic>40, <italic>k</italic>4</td><td char="." align="char">5.70</td><td align="left"><bold>7.01</bold></td><td char="." align="char">1.29</td><td align="left"><bold>7.50</bold></td><td char="." align="char">38.09</td><td align="left">12.25</td><td char="." align="char">33.71</td><td char="." align="char">1.51</td></tr><tr><td align="left">-<italic>u</italic>80, <italic>k</italic>3</td><td char="." align="char">3.72</td><td align="left"><bold>39.31</bold></td><td char="." align="char">0.84</td><td align="left"><bold>64.57</bold></td><td char="." align="char">53.71</td><td align="left">10.24</td><td char="." align="char">69.08</td><td char="." align="char"><bold>0.94</bold></td></tr><tr><td align="left">-<italic>u</italic>120, <italic>k</italic>1</td><td char="." align="char">2.94</td><td align="left"><bold>52.04</bold></td><td char="." align="char">0.66</td><td align="left"><bold>108.51</bold></td><td char="." align="char">107.39</td><td align="left">10:91</td><td char="." align="char">69.08</td><td char="." align="char"><bold>0.82</bold></td></tr><tr><td align="left" rowspan="4">FastqCLS</td><td align="left"><italic>Without</italic></td><td char="." align="char">7.99</td><td align="left">–</td><td char="." align="char">1.80</td><td align="left">–</td><td char="." align="char">23.08</td><td align="left">8.46</td><td char="." align="char">5.32</td><td char="." align="char">5.08</td></tr><tr><td align="left">-<italic>u</italic>40, <italic>k</italic>4</td><td char="." align="char">7.98</td><td align="left"><bold>0.13</bold></td><td char="." align="char">1.80</td><td align="left"><bold>0.22</bold></td><td char="." align="char">35.35</td><td align="left"><bold>6.88</bold></td><td char="." align="char">6.45</td><td char="." align="char">5.34</td></tr><tr><td align="left">-<italic>u</italic>80, <italic>k</italic>3</td><td char="." align="char">7.89</td><td align="left"><bold>1.25</bold></td><td char="." align="char">1.78</td><td align="left"><bold>1.24</bold></td><td char="." align="char">35.43</td><td align="left"><bold>6.76</bold></td><td char="." align="char">6.47</td><td char="." align="char">5.31</td></tr><tr><td align="left">-<italic>u</italic>120, <italic>k</italic>1</td><td char="." align="char">7.63</td><td align="left"><bold>4.51</bold></td><td char="." align="char">1.72</td><td align="left"><bold>4.76</bold></td><td char="." align="char">35.48</td><td align="left"><bold>7.12</bold></td><td char="." align="char">6.46</td><td char="." align="char">5.36</td></tr></tbody></table><table-wrap-foot><p>The parameter without indicates that the PMFFRC algorithm is not used for compression optimization. (-<italic>u</italic>10, <italic>k</italic>3) denotes the clustering parameter <italic>K</italic> = 3 of PMFFRC when <italic>U</italic><sub><italic>ram</italic></sub> = 10 GB. HARC, SPRING, Mstcom, and FastqCLS are used in with-order mode (lossless). Compression parameters: <italic>Pr</italic> = 20, <italic>T</italic> = 8 (threads for cascaded algorithm), <italic>β</italic><sub>HARC</sub> = 1.05, <italic>β</italic><sub>SPRING</sub> = 0.15, <italic>β</italic><sub>FastqCLS</sub> = 0.15, <italic>β</italic><sub>Mstcom</sub> = 0.30, <italic>x</italic><sub>1</sub> = 100, <italic>x</italic><sub>2</sub> = 100,100. The compression gains obtained by the cascaded PMFFRC algorithms is marked in boldface. “–” means the result of not being optimized by the PMFFRC algorithm. For the experimentally optimized algorithms, we ensure the data integrity of the lossless compression optimization by comparing data hash fingerprints</p></table-wrap-foot></table-wrap></p>
      <p id="Par41">As seen in Table <xref rid="Tab2" ref-type="table">2</xref>, using PMFFRC for compression optimizing, when <italic>K</italic> = 1, the <italic>crg</italic> of HARC, SPRING, Mstcom, and FastqCLS is increased up to 118.54%, 126.95%, 108.51%, and 4.76%, respectively. The four special compressors save 45.74%, 55.87%, 52.04%, and 4.51% storage spaces compared with the <italic>without</italic>-mode.</p>
      <p id="Par42">In Table <xref rid="Tab2" ref-type="table">2</xref>, we also observed that HARC, SPRING, and Mstcom held compression ratio gains of over 100% (when <italic>k</italic> = 1), while FastqCLS only achieved 4.76%. This phenomenon is attributed to the particular reads reorder model employed by FastqCLS. In reference [<xref ref-type="bibr" rid="CR25">25</xref>], FastqCLS introduces the concept of "constructed score" for reordering reads collection, which relies on calculating the probability distribution of each nucleotide base within the reads range. When the length of the reads collection is shorter, it becomes challenging for the sequence scoring model of FastqCLS to generate local clustering effects among similar short reads. As a result, this limitation hampers the optimization efficiency of PMFFRC. Moreover, for reference-free compressors based on reads reorder technologies, the index that records the relative positions of short reads is crucial for restoring the original data. For a collection of shorter reads, the abovementioned record file occupies a higher proportion in the compressed file, which is another potential reason for the low optimization efficiency of PMFFRC. Although PMFFRC did not achieve the expected optimization results for FastqCLS on the <italic>H. sapiens</italic> dataset, PMFFRC remains highly competitive in saving storage space. As shown in Table <xref rid="Tab2" ref-type="table">2</xref>, the proposed PMFFRC saved 4.51% of storage space for FastqCLS merely through joint compression.</p>
      <p id="Par43">PMFFRC requires extra time for fastq files clustering, merging, and splitting, so <italic>ct</italic> and <italic>dt</italic> are slightly higher than the <italic>without</italic>-mode. The parallel clustering speedup and relative memory consumption by employing multiple CPU cores on the <italic>H. sapiens</italic> dataset are also evaluated. See Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S1 for more details.</p>
    </sec>
    <sec id="Sec12">
      <title>Performance on Salvelinus fontinalis dataset</title>
      <p id="Par44">To evaluate the optimizing efficiency of PMFFRC on large-scale fastq files, Table <xref rid="Tab3" ref-type="table">3</xref> shows the compression performance of the four cascaded algorithms by running PMFFRC on the <italic>S. fontinalis</italic> dataset, which contains 360 sequencing files with a total size of 190 GB. Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S2 details the clustering speedup and memory consumption on the <italic>S. fontinalis</italic> dataset using the different numbers of CPU cores.<table-wrap id="Tab3"><label>Table 3</label><caption><p>Performance of PMFFRC on <italic>S. fontinalis</italic> dataset</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" rowspan="2">Algorithm</th><th align="left" rowspan="2">Parameter</th><th align="left" colspan="6">Compression</th><th align="left" colspan="2">Decompression</th></tr><tr><th align="left"><italic>cs</italic> (GB)</th><th align="left"><italic>pss</italic> (%)</th><th align="left"><italic>cr</italic> (bits/base)</th><th align="left"><italic>crg</italic> (%)</th><th align="left"><italic>cpm</italic> (GB)</th><th align="left"><italic>ct</italic> (h)</th><th align="left"><italic>dpm</italic> (GB)</th><th align="left"><italic>dt</italic> (h)</th></tr></thead><tbody><tr><td align="left" rowspan="3">HARC</td><td align="left"><italic>Without</italic></td><td char="." align="char">5.33</td><td align="left">–</td><td char="." align="char">0.76</td><td align="left">–</td><td char="." align="char">0.67</td><td char="." align="char">2.05</td><td char="." align="char">0.45</td><td char="." align="char">2.24</td></tr><tr><td align="left">-<italic>u</italic>20, <italic>k</italic>3</td><td char="." align="char">3.49</td><td align="left"><bold>34.52</bold></td><td char="." align="char">0.50</td><td align="left"><bold>52.48</bold></td><td char="." align="char">11.90</td><td char="." align="char"><bold>1.75</bold></td><td char="." align="char">5.22</td><td char="." align="char">3.05</td></tr><tr><td align="left">-<italic>u</italic>40, <italic>k</italic>1</td><td char="." align="char">3.41</td><td align="left"><bold>36.02</bold></td><td char="." align="char">0.48</td><td align="left"><bold>56.22</bold></td><td char="." align="char">23.69</td><td char="." align="char"><bold>2.04</bold></td><td char="." align="char">6.71</td><td char="." align="char">3.78</td></tr><tr><td align="left" rowspan="3">SPRING</td><td align="left"><italic>Without</italic></td><td char="." align="char">5.49</td><td align="left">–</td><td char="." align="char">0.78</td><td align="left">–</td><td char="." align="char">1.02</td><td char="." align="char">1.46</td><td char="." align="char">0.56</td><td char="." align="char">0.29</td></tr><tr><td align="left">-<italic>u</italic>20, <italic>k</italic>3</td><td char="." align="char">3.58</td><td align="left"><bold>34.79</bold></td><td char="." align="char">0.51</td><td align="left"><bold>50.38</bold></td><td char="." align="char">12.76</td><td char="." align="char">1.74</td><td char="." align="char">1.49</td><td char="." align="char">0.59</td></tr><tr><td align="left">-<italic>u</italic>40, <italic>k</italic>1</td><td char="." align="char">3.49</td><td align="left"><bold>36.43</bold></td><td char="." align="char">0.49</td><td align="left"><bold>57.45</bold></td><td char="." align="char">25.51</td><td char="." align="char">1.69</td><td char="." align="char">1.53</td><td char="." align="char">0.91</td></tr><tr><td align="left" rowspan="4">Mstcom</td><td align="left"><italic>Without</italic></td><td char="." align="char">3.87</td><td align="left">–</td><td char="." align="char">0.55</td><td align="left">–</td><td char="." align="char">5.91</td><td char="." align="char">7.19</td><td char="." align="char">2.29</td><td char="." align="char">1.06</td></tr><tr><td align="left">-<italic>u</italic>40, <italic>k</italic>6</td><td char="." align="char">2.40</td><td align="left"><bold>37.98</bold></td><td char="." align="char">0.34</td><td align="left"><bold>64.31</bold></td><td char="." align="char">33.24</td><td char="." align="char"><bold>5.09</bold></td><td char="." align="char">20.03</td><td char="." align="char"><bold>0.76</bold></td></tr><tr><td align="left">-<italic>u</italic>100, <italic>k</italic>3</td><td char="." align="char">2.31</td><td align="left"><bold>40.31</bold></td><td char="." align="char">0.33</td><td align="left"><bold>67.93</bold></td><td char="." align="char">78.97</td><td char="." align="char"><bold>5.47</bold></td><td char="." align="char">50.36</td><td char="." align="char">1.11</td></tr><tr><td align="left">-<italic>u</italic>180, <italic>k</italic>1</td><td char="." align="char">2.26</td><td align="left"><bold>41.60</bold></td><td char="." align="char">0.32</td><td align="left"><bold>71.12</bold></td><td char="." align="char">159.13</td><td char="." align="char"><bold>6.22</bold></td><td char="." align="char">100.72</td><td char="." align="char">1.60</td></tr><tr><td align="left" rowspan="4">FastqCLS</td><td align="left"><italic>Without</italic></td><td char="." align="char">4.37</td><td align="left">–</td><td char="." align="char">0.62</td><td align="left">–</td><td char="." align="char">16.66</td><td char="." align="char">21.51</td><td char="." align="char">6.35</td><td char="." align="char">16.25</td></tr><tr><td align="left">-<italic>u</italic>80, <italic>k</italic>4</td><td char="." align="char">2.82</td><td align="left"><bold>35.47</bold></td><td char="." align="char">0.40</td><td align="left"><bold>55.15</bold></td><td char="." align="char">60.36</td><td char="." align="char"><bold>11.66</bold></td><td char="." align="char">6.38</td><td char="." align="char"><bold>14.44</bold></td></tr><tr><td align="left">-<italic>u</italic>180, <italic>k</italic>3</td><td char="." align="char">2.77</td><td align="left"><bold>36.61</bold></td><td char="." align="char">0.39</td><td align="left"><bold>58.00</bold></td><td char="." align="char">59.09</td><td char="." align="char"><bold>12.98</bold></td><td char="." align="char">6.43</td><td char="." align="char"><bold>14.04</bold></td></tr><tr><td align="left">-<italic>u</italic>280, <italic>k</italic>1</td><td char="." align="char">2.69</td><td align="left"><bold>38.44</bold></td><td char="." align="char">0.38</td><td align="left"><bold>62.56</bold></td><td char="." align="char">63.60</td><td char="." align="char"><bold>14.03</bold></td><td char="." align="char">6.39</td><td char="." align="char"><bold>15.95</bold></td></tr></tbody></table><table-wrap-foot><p>Parameters: <italic>Pr</italic> = 20, <italic>T</italic> = 8, <italic>β</italic><sub>HARC</sub> = 1.05, <italic>β</italic><sub>SPRING</sub> = 0.95, <italic>β</italic><sub>FastqCLS</sub> = 0.28, <italic>β</italic><sub>Mstcom</sub> = 0.75, <italic>x</italic><sub>1</sub> = 100, <italic>x</italic><sub>2</sub> = 100,100. The compression gains obtained by the PMFFRC cascaded algorithms is marked in boldface. “–” means the result of not being optimized by the PMFFRC algorithm</p></table-wrap-foot></table-wrap></p>
      <p id="Par45">Table <xref rid="Tab3" ref-type="table">3</xref> shows that the compression ratio <italic>cr</italic> using the PMFFRC optimizer for the four cascaded compression algorithms reaches the peak at <italic>K</italic> = 1. The <italic>cr</italic> increases by 56.22%, 57.45%, 71.12%, and 62.56% compared with without-mode. By sacrificing system memory, the MPFFRC optimizer makes four special compressors save storage space of 36.02%, 36.43%, 41.60%, and 38.44%, respectively. The optimizer PMFFRC delivers remarkable results on the S. fontinalis dataset due to its maximal utilization of the redundancy information within the compressed datasets.</p>
    </sec>
    <sec id="Sec13">
      <title>Performance on Cicer arietinum dataset</title>
      <p id="Par46">Table <xref rid="Tab4" ref-type="table">4</xref> presents the optimization results of HARC, SPRING, Mstcom, and FastqCLS by running PMFFRC on <italic>C. arietinum</italic> dataset, which contains 60 fastq files, and the average data size of every single fastq file is 11 GB (the total size of the Cicer arietinum dataset is 681 GB). The speedup and time consumption by using different CPU cores on the <italic>C. arietinum</italic> dataset are shown in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S3.<table-wrap id="Tab4"><label>Table 4</label><caption><p>Performance of PMFFRC on <italic>C. arietinum</italic> dataset</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" rowspan="2">Algorithm</th><th align="left" rowspan="2">Parameter</th><th align="left" colspan="6">Compression</th><th align="left" colspan="2">Decompression</th></tr><tr><th align="left"><italic>cs</italic> (GB)</th><th align="left"><italic>pss</italic> (%)</th><th align="left"><italic>cr</italic> (bits/base)</th><th align="left"><italic>crg</italic> (%)</th><th align="left"><italic>cpm</italic> (GB)</th><th align="left"><italic>ct</italic> (h)</th><th align="left"><italic>dpm</italic> (GB)</th><th align="left"><italic>dt</italic> (h)</th></tr></thead><tbody><tr><td align="left" rowspan="4">HARC</td><td align="left"><italic>Without</italic></td><td char="." align="char">16.96</td><td align="left">–</td><td char="." align="char">0.79</td><td align="left">–</td><td char="." align="char">1.99</td><td char="." align="char">5.24</td><td char="." align="char">1.74</td><td char="." align="char">6.14</td></tr><tr><td align="left">-<italic>u</italic>20, <italic>k</italic>5</td><td char="." align="char">11.17</td><td align="left"><bold>34.14</bold></td><td char="." align="char">0.52</td><td align="left"><bold>51.85</bold></td><td char="." align="char">17.75</td><td char="." align="char"><bold>3.05</bold></td><td char="." align="char">6.30</td><td char="." align="char">6.60</td></tr><tr><td align="left">-<italic>u</italic>40, <italic>k</italic>3</td><td char="." align="char">10.95</td><td align="left"><bold>35.44</bold></td><td char="." align="char">0.51</td><td align="left"><bold>51.94</bold></td><td char="." align="char">34.73</td><td char="." align="char"><bold>3.16</bold></td><td char="." align="char">7.11</td><td char="." align="char">7.60</td></tr><tr><td align="left">-<italic>u</italic>80, <italic>k</italic>1</td><td char="." align="char">10.78</td><td align="left"><bold>36.44</bold></td><td char="." align="char">0.50</td><td align="left"><bold>58.90</bold></td><td char="." align="char">66.90</td><td char="." align="char"><bold>3.53</bold></td><td char="." align="char">6.97</td><td char="." align="char"><bold>5.05</bold></td></tr><tr><td align="left" rowspan="4">SPRING</td><td align="left"><italic>Without</italic></td><td char="." align="char">15.82</td><td align="left">–</td><td char="." align="char">0.73</td><td align="left">–</td><td char="." align="char">1.89</td><td char="." align="char">5.73</td><td char="." align="char">1.04</td><td char="." align="char">0.66</td></tr><tr><td align="left">-<italic>u</italic>20, <italic>k</italic>5</td><td char="." align="char">11.05</td><td align="left"><bold>30.15</bold></td><td char="." align="char">0.51</td><td align="left"><bold>43.15</bold></td><td char="." align="char">18.91</td><td char="." align="char"><bold>3.55</bold></td><td char="." align="char">2.93</td><td char="." align="char">0.95</td></tr><tr><td align="left">-<italic>u</italic>40, <italic>k</italic>3</td><td char="." align="char">10.87</td><td align="left"><bold>31.29</bold></td><td char="." align="char">0.50</td><td align="left"><bold>43.54</bold></td><td char="." align="char">36.78</td><td char="." align="char"><bold>3.60</bold></td><td char="." align="char">4.09</td><td char="." align="char">1.02</td></tr><tr><td align="left">-<italic>u</italic>100, <italic>k</italic>1</td><td char="." align="char">10.67</td><td align="left"><bold>32.55</bold></td><td char="." align="char">0.49</td><td align="left"><bold>48.29</bold></td><td char="." align="char">70.79</td><td char="." align="char"><bold>4.09</bold></td><td char="." align="char">4.13</td><td char="." align="char">1.19</td></tr><tr><td align="left" rowspan="4">Mstcom</td><td align="left"><italic>Without</italic></td><td char="." align="char">13.01</td><td align="left">–</td><td char="." align="char">0.60</td><td align="left">–</td><td char="." align="char">14.54</td><td char="." align="char">66.52</td><td char="." align="char">6.49</td><td char="." align="char">2.94</td></tr><tr><td align="left">-<italic>u</italic>100, <italic>k</italic>15</td><td char="." align="char">10.34</td><td align="left"><bold>20.52</bold></td><td char="." align="char">0.48</td><td align="left"><bold>25.88</bold></td><td char="." align="char">37.52</td><td char="." align="char"><bold>64.52</bold></td><td char="." align="char">22.45</td><td char="." align="char"><bold>2.31</bold></td></tr><tr><td align="left">-<italic>u</italic>200, <italic>k</italic>7</td><td char="." align="char">9.59</td><td align="left"><bold>26.29</bold></td><td char="." align="char">0.44</td><td align="left"><bold>35.71</bold></td><td char="." align="char">77.51</td><td char="." align="char"><bold>61.85</bold></td><td char="." align="char">50.98</td><td char="." align="char"><bold>2.29</bold></td></tr><tr><td align="left">-<italic>u</italic>300, <italic>k</italic>4</td><td char="." align="char">9.24</td><td align="left"><bold>28.98</bold></td><td char="." align="char">0.43</td><td align="left"><bold>40.91</bold></td><td char="." align="char">149.86</td><td char="." align="char"><bold>59.62</bold></td><td char="." align="char">102.78</td><td char="." align="char"><bold>2.15</bold></td></tr><tr><td align="left" rowspan="4">FastqCLS</td><td align="left"><italic>Without</italic></td><td char="." align="char">27.62</td><td align="left">–</td><td char="." align="char">1.28</td><td align="left">–</td><td char="." align="char">33.79</td><td char="." align="char">50.36</td><td char="." align="char">6.49</td><td char="." align="char">28.84</td></tr><tr><td align="left">-<italic>u</italic>100, <italic>k</italic>9</td><td char="." align="char">25.08</td><td align="left"><bold>9.20</bold></td><td char="." align="char">1.16</td><td align="left"><bold>10.15</bold></td><td char="." align="char">36.30</td><td char="." align="char"><bold>28.13</bold></td><td char="." align="char">6.56</td><td char="." align="char"><bold>23.88</bold></td></tr><tr><td align="left">-<italic>u</italic>200, <italic>k</italic>5</td><td char="." align="char">23.65</td><td align="left"><bold>14.37</bold></td><td char="." align="char">1.10</td><td align="left"><bold>16.81</bold></td><td char="." align="char">36.01</td><td char="." align="char"><bold>30.76</bold></td><td char="." align="char">6.53</td><td char="." align="char"><bold>22.16</bold></td></tr><tr><td align="left">-<italic>u</italic>300, <italic>k</italic>4</td><td char="." align="char">22.88</td><td align="left"><bold>17.16</bold></td><td char="." align="char">1.06</td><td align="left"><bold>20.76</bold></td><td char="." align="char">35.84</td><td char="." align="char"><bold>30.32</bold></td><td char="." align="char">6.55</td><td char="." align="char"><bold>22.42</bold></td></tr></tbody></table><table-wrap-foot><p>Parameters: <italic>Pr</italic> = 20, <italic>T</italic> = 8, <italic>β</italic><sub>HARC</sub> = 1.05, <italic>β</italic><sub>SPRING</sub> = 0.30, <italic>β</italic><sub>FastqCLS</sub> = 0.28, <italic>β</italic><sub>Mstcom</sub> = 0.75, <italic>x</italic><sub>1</sub> = 100, <italic>x</italic><sub>2</sub> = 100,100. The compression gains obtained by the PMFFRC cascaded algorithms is marked in boldface. “–” means the result of not being optimized by the PMFFRC algorithm</p></table-wrap-foot></table-wrap></p>
      <p id="Par47">As shown in Table <xref rid="Tab4" ref-type="table">4</xref>, for HARC and SPRING compressors, when the safe threshold <italic>U</italic><sub><italic>ram</italic></sub> takes 80–100 GB, the clustering parameter <italic>K</italic> = 1. Simultaneously, the compression ratio <italic>cr</italic> of HARC and SPRING increased by 58.90% and 48.29%. By leveraging system memory, the PMFFRC optimizer saved 36.44% and 32.55% storage space sizes for HARC and SPRING, respectively. For compressors Mstcom and FastqCLS, when the safe threshold <italic>U</italic><sub><italic>ram</italic></sub> takes 300 GB (maximum system memory), the clustering parameter <italic>K</italic> = 4, and the compression ratio <italic>cr</italic> is improved by 40.91% and 20.76%. In this case, PMFFRC preserved 28.98% and 17.16% of storage space sizes for Mstcom and FastqCLS, respectively.</p>
      <p id="Par48">In <italic>C. arietinum</italic> dataset, the compression time <italic>ct</italic> of four cascaded compressors was reduced by running PMFFRC compared with <italic>without</italic>-mode. This contribution can be attributed to the following reasons: (i) PMFFRC accelerates computation-intensive stages by multi-core CPU parallelism. Therefore, the time consumption of fastq files clustering and merging steps is far lower than the total time consumption. (ii) Similar sequencing reads are gathered by redundant clustering in different fastq files, which favors reference-free compressors in the joint compressing stage. For example, HARC [<xref ref-type="bibr" rid="CR14">14</xref>] utilizes a redundant substitute step for replacing reverses complimentary and direct repeat reads, which benefit from our clustering algorithm. (iii) The joint compression stage reduces the preprocessing time consumption, such as building hash tables and dictionaries. For example, in the <italic>without</italic>-mode, HARC needs to perform 60 hash table construction processes on the Cicer arietinum dataset. However, joint compression only needs to build hash table once when <italic>K</italic> = 1.</p>
    </sec>
  </sec>
  <sec id="Sec14">
    <title>Discussion</title>
    <p id="Par49">We presented PMFFRC, a CPU-parallel algorithm for optimizing large-scale genomic sequencing reads lossless compression. On real datasets, PMFFRC achieves a 20–80% maximum compression ratio gains and an additional 20–40% file size reduction compared with non-optimized reference-free compressors. Our work pointed out a feasible idea for large-scale genome sequencing reads compression, which is to use the redundant information of reads in different fastq files to improve the compression ratio. In some cases, the PMFFRC algorithm can also reduce the compression and decompression time. Compared with non-optimized reference-free compressors, the significant compression advantage for optimized algorithms is achieved through a "three-stage redundancy utilization strategy" (fastq files, reads string, and nucleotide character) provided by the optimizer and the optimized algorithm. A typical sample implementation is PMFFRC + FastqCLS. (i) The PMFFRC optimizer employs a two-level clustering method to group similar fastq format data, resulting in highly similar data within each group. This clustering strategy allows the FastqCLS algorithm to take advantage of redundant information at the files level in the compressed datasets. (ii) The FastqCLS algorithm uses a novel scoring model to reorder short reads by leveraging redundancy information at the short reads string level. This preprocessing phase takes advantage of the redundancy between short reads. (iii) The FastqCLS compressor incorporates the ZPAQ algorithm, which employs context modelling and arithmetic coding. This enables FastqCLS to detect patterns and character dependencies in the reads data, utilizing context models and exploiting redundancy at the nucleotide character level to improve compression ratios.</p>
    <p id="Par50">Our optimizer PMFFRC showed promising results on 444 sequencing files. However, it is undeniable that PMFFRC nonetheless has some limitations. On the one hand, the PMFFRC algorithm may not achieve the expected optimization results for small memory devices and small-scale genome sequencing data. Since PMFFRC utilizes system memory and files-level redundancy information, it is more suitable for compressing medium to large-scale sequencing datasets. On the other hand, the high compression ratio achieved by PMFFRC restricts its flexibility in decompression, making it more suitable for medium and long-term backup applications of sequencing short reads data. Based on current work, potential future work includes: (i) Improving computation of PMFFRC by using CPU and GPU (Graphics Processing Unit) collaborative computing for large-scale and long sequencing reads optimization compression. (ii) Achieving the accurate compression and decompression of clustering files to enhance application flexibility. (iii) Creating a block index for each joint compressed file and reducing the overall compression memory consumption through block compression, so that small memory devices can also benefit from the proposed PMFFRC algorithm. (iv) Another interesting direction is to explore machine learning and deep learning techniques for predicting the compression peak memory <italic>Y</italic><sub><italic>cpm</italic></sub> and clustering parameters <italic>K</italic> accurately, to maximize utilization the user-preset safe memory threshold <italic>U</italic><sub><italic>ram</italic></sub>.</p>
  </sec>
  <sec id="Sec15">
    <title>Availability and requirements</title>
    <p id="Par51">
      <list list-type="bullet">
        <list-item>
          <p id="Par52"><bold>Project name</bold>: PMFFRC</p>
        </list-item>
        <list-item>
          <p id="Par53"><bold>Project home page</bold>: <ext-link ext-link-type="uri" xlink:href="https://github.com/fahaihi/PMFFRC">https://github.com/fahaihi/PMFFRC</ext-link></p>
        </list-item>
        <list-item>
          <p id="Par54"><bold>Operating system(s)</bold>: Linux</p>
        </list-item>
        <list-item>
          <p id="Par55"><bold>Programming language</bold>: C +  + , OpenMP</p>
        </list-item>
        <list-item>
          <p id="Par56"><bold>Other requirements</bold>: FastqCLS, Mstcom, Harc, Spring, and gcc 5.4.0.</p>
        </list-item>
        <list-item>
          <p id="Par57"><bold>License</bold>: Apache-2.0 license</p>
        </list-item>
        <list-item>
          <p id="Par58"><bold>Any restrictions to use by non-academics</bold>: For commercial use, please contact the authors.</p>
        </list-item>
      </list>
    </p>
  </sec>
  <sec sec-type="supplementary-material">
    <sec id="Sec16">
      <title>Supplementary Information</title>
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="12859_2023_5566_MOESM1_ESM.docx">
            <caption>
              <p><bold>Additional file 1:</bold> PMFFRC_Supplementary_Material.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>MB</term>
        <def>
          <p id="Par4">Megabyte</p>
        </def>
      </def-item>
      <def-item>
        <term>GB</term>
        <def>
          <p id="Par5">Gigabyte</p>
        </def>
      </def-item>
      <def-item>
        <term>TB</term>
        <def>
          <p id="Par6">Terabyte</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher's Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>The experimental work is supported by the High-performance Computing Center of Guangxi University. The authors thank the editor and anonymous reviewers for their constructive comments and suggestions to improve our manuscript. The authors also thank Dr. Meng Yan for guiding the manuscript revision.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author contributions</title>
    <p>HS and YFZ implemented the code. HS and HNX wrote the manuscript. XGL and GW guided the project. HDM completed a part of the experiments and prepared the dataset. XGL and GW also helped to modify the manuscript. All authors read and approved the manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>This work is partly supported by NSF of China (62141412, 62272253, 62272252), Fundamental Research Funds for the Central Universities.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>The datasets generated and analyzed during the current study are available in the PMFFRC repository, <ext-link ext-link-type="uri" xlink:href="https://github.com/fahaihi/PMFFRC/tree/master/data">https://github.com/fahaihi/PMFFRC/tree/master/data</ext-link>.</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar1">
      <title>Ethics approval and consent to participate</title>
      <p id="Par59">The ethic approval is not required since we used publicly available datasets.</p>
    </notes>
    <notes id="FPar2">
      <title>Consent for publication</title>
      <p id="Par60">Not applicable.</p>
    </notes>
    <notes id="FPar3" notes-type="COI-statement">
      <title>Competing interests</title>
      <p id="Par61">The authors declare that they have no competing interests.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Voges</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Hernaez</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Mattavelli</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Ostermann</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>An introduction to MPEG-G: the first open ISO/IEC standard for the compression and exchange of genomic sequencing data</article-title>
        <source>Proc IEEE</source>
        <year>2021</year>
        <volume>109</volume>
        <issue>9</issue>
        <fpage>1607</fpage>
        <lpage>1622</lpage>
        <pub-id pub-id-type="doi">10.1109/JPROC.2021.3082027</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Numanagić</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Bonfield</surname>
            <given-names>JK</given-names>
          </name>
          <name>
            <surname>Hach</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Voges</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Ostermann</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Alberti</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Comparison of high-throughput sequencing data compression tools</article-title>
        <source>Nat Methods</source>
        <year>2016</year>
        <volume>13</volume>
        <issue>12</issue>
        <fpage>1005</fpage>
        <lpage>1008</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.4037</pub-id>
        <?supplied-pmid 27776113?>
        <pub-id pub-id-type="pmid">27776113</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kokot</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Gudyś</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Deorowicz</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>CoLoRd: compressing long reads</article-title>
        <source>Nat Methods</source>
        <year>2022</year>
        <volume>19</volume>
        <issue>4</issue>
        <fpage>441</fpage>
        <lpage>444</lpage>
        <pub-id pub-id-type="doi">10.1038/s41592-022-01432-3</pub-id>
        <?supplied-pmid 35347321?>
        <pub-id pub-id-type="pmid">35347321</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhu</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>JiZ</surname>
            <given-names>HS</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>X</given-names>
          </name>
        </person-group>
        <article-title>High-throughput DNA sequence data compression</article-title>
        <source>Brief Bioinform</source>
        <year>2015</year>
        <volume>16</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>15</lpage>
        <pub-id pub-id-type="doi">10.1093/bib/bbt087</pub-id>
        <?supplied-pmid 24300111?>
        <pub-id pub-id-type="pmid">24300111</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hernaez</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Pavlichin</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Weissman</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Ochoa</surname>
            <given-names>I</given-names>
          </name>
        </person-group>
        <article-title>Genomic data compression</article-title>
        <source>Annu Rev Biomed Data Sci</source>
        <year>2019</year>
        <volume>2</volume>
        <fpage>19</fpage>
        <lpage>37</lpage>
        <pub-id pub-id-type="doi">10.1146/annurev-biodatasci-072018-021229</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dufort y Álvarez</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Seroussi</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Smircich</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Sotelo-Silveira</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Ochoa</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Martín</surname>
            <given-names>Á</given-names>
          </name>
        </person-group>
        <article-title>RENANO: a REference-based compressor for NANOpore FASTQ files</article-title>
        <source>Bioinformatics</source>
        <year>2021</year>
        <volume>37</volume>
        <issue>24</issue>
        <fpage>4862</fpage>
        <lpage>4864</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btab437</pub-id>
        <?supplied-pmid 34128963?>
        <pub-id pub-id-type="pmid">34128963</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yao</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Ji</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>He</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>HRCM: an efficient hybrid referential compression method for genomic big data</article-title>
        <source>BioMed Res Int</source>
        <year>2019</year>
        <pub-id pub-id-type="doi">10.1155/2019/3108950</pub-id>
        <?supplied-pmid 31915690?>
        <pub-id pub-id-type="pmid">31915690</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Saha</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Rajasekaran</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>NRGC: a novel referential genome compression algorithm</article-title>
        <source>Bioinformatics</source>
        <year>2016</year>
        <volume>32</volume>
        <issue>22</issue>
        <fpage>3405</fpage>
        <lpage>3412</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btw505</pub-id>
        <?supplied-pmid 27485445?>
        <pub-id pub-id-type="pmid">27485445</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jones</surname>
            <given-names>DC</given-names>
          </name>
          <name>
            <surname>Ruzzo</surname>
            <given-names>WL</given-names>
          </name>
          <name>
            <surname>Peng</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Katze</surname>
            <given-names>MG</given-names>
          </name>
        </person-group>
        <article-title>Compression of next-generation sequencing reads aided by highly efficient de novo assembly</article-title>
        <source>Nucleic Acids Res</source>
        <year>2012</year>
        <volume>40</volume>
        <issue>22</issue>
        <fpage>e171</fpage>
        <pub-id pub-id-type="doi">10.1093/nar/gks754</pub-id>
        <?supplied-pmid 22904078?>
        <pub-id pub-id-type="pmid">22904078</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cox</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Bauer</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Jakobi</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Rosone</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Large-scale compression of genomic sequence databases with the Burrows-Wheeler transform</article-title>
        <source>Bioinformatics</source>
        <year>2012</year>
        <volume>28</volume>
        <fpage>1415</fpage>
        <lpage>1419</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bts173</pub-id>
        <?supplied-pmid 22556365?>
        <pub-id pub-id-type="pmid">22556365</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Roguski</surname>
            <given-names>Ł</given-names>
          </name>
          <name>
            <surname>Deorowicz</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>DSRC2 industry-oriented compression of FASTQ files</article-title>
        <source>Bioinformatics</source>
        <year>2014</year>
        <volume>30</volume>
        <fpage>2213</fpage>
        <lpage>2215</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btu208</pub-id>
        <?supplied-pmid 24747219?>
        <pub-id pub-id-type="pmid">24747219</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Deorowicz</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>FQSqueezer: k-mer-based compression of sequencing data</article-title>
        <source>Sci Rep</source>
        <year>2020</year>
        <volume>10</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>9</lpage>
        <pub-id pub-id-type="doi">10.1038/s41598-020-57452-6</pub-id>
        <pub-id pub-id-type="pmid">31913322</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Meng</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Chandak</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Zhu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Weissman</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Reference-free lossless compression of nanopore sequencing reads using an approximate assembly approach</article-title>
        <source>Sci Rep</source>
        <year>2023</year>
        <volume>13</volume>
        <issue>1</issue>
        <fpage>2082</fpage>
        <pub-id pub-id-type="doi">10.1038/s41598-023-29267-8</pub-id>
        <?supplied-pmid 36747011?>
        <pub-id pub-id-type="pmid">36747011</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chandak</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Tatwawadi</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Weissman</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Compression of genomic sequencing reads via hash-based reordering: algorithm and analysis</article-title>
        <source>Bioinformatics</source>
        <year>2018</year>
        <volume>34</volume>
        <issue>4</issue>
        <fpage>558</fpage>
        <lpage>567</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btx639</pub-id>
        <?supplied-pmid 29444237?>
        <pub-id pub-id-type="pmid">29444237</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Grabowski</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Deorowicz</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Roguski</surname>
            <given-names>Ł</given-names>
          </name>
        </person-group>
        <article-title>Disk-based compression of data from genome sequencing</article-title>
        <source>Bioinformatics</source>
        <year>2014</year>
        <volume>31</volume>
        <fpage>1389</fpage>
        <lpage>1395</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btu844</pub-id>
        <?supplied-pmid 25536966?>
        <pub-id pub-id-type="pmid">25536966</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Benoit</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Lemaitre</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Lavenier</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Drezen</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Dayris</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Uricaru</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Reference-free compression of high throughput sequencing data with a probabilistic de Bruijn graph</article-title>
        <source>BMC Bioinform</source>
        <year>2015</year>
        <volume>16</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>14</lpage>
        <pub-id pub-id-type="doi">10.1186/s12859-015-0709-7</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chandak</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Tatwawadi</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Ochoa</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Hernaez</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Weissman</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>SPRING: a next-generation compressor for FASTQ data</article-title>
        <source>Bioinformatics</source>
        <year>2019</year>
        <volume>35</volume>
        <issue>15</issue>
        <fpage>2674</fpage>
        <lpage>2676</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bty1015</pub-id>
        <?supplied-pmid 30535063?>
        <pub-id pub-id-type="pmid">30535063</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Roguski</surname>
            <given-names>Ł</given-names>
          </name>
          <name>
            <surname>Ochoa</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Hernaez</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Deorowicz</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>FaStore: a space-saving solution for raw sequencing data</article-title>
        <source>Bioinformatics</source>
        <year>2018</year>
        <volume>34</volume>
        <issue>16</issue>
        <fpage>2748</fpage>
        <lpage>2756</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bty205</pub-id>
        <?supplied-pmid 29617939?>
        <pub-id pub-id-type="pmid">29617939</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kowalski</surname>
            <given-names>TM</given-names>
          </name>
          <name>
            <surname>Grabowski</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>PgRC: pseudogenome-based read compressor</article-title>
        <source>Bioinformatics</source>
        <year>2020</year>
        <volume>36</volume>
        <issue>7</issue>
        <fpage>2082</fpage>
        <lpage>2089</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btz919</pub-id>
        <?supplied-pmid 31893286?>
        <pub-id pub-id-type="pmid">31893286</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Yu</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Dinger</surname>
            <given-names>ME</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Index suffix–prefix overlaps by (w, k)-minimizer to generate long contigs for reads compression</article-title>
        <source>Bioinformatics</source>
        <year>2018</year>
        <volume>35</volume>
        <issue>12</issue>
        <fpage>2066</fpage>
        <lpage>2074</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bty936</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Xie</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>He</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>He</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Zhu</surname>
            <given-names>Z</given-names>
          </name>
        </person-group>
        <article-title>CURC: a CUDA-based reference-free read compressor</article-title>
        <source>Bioinformatics</source>
        <year>2022</year>
        <volume>38</volume>
        <issue>12</issue>
        <fpage>3294</fpage>
        <lpage>3296</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btac333</pub-id>
        <?supplied-pmid 35579371?>
        <pub-id pub-id-type="pmid">35579371</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Hamming-shifting graph of genomic short reads: Efficient construction and its application for compression</article-title>
        <source>PLoS Comput Biol</source>
        <year>2021</year>
        <volume>17</volume>
        <issue>7</issue>
        <fpage>e1009229</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1009229</pub-id>
        <?supplied-pmid 34280186?>
        <pub-id pub-id-type="pmid">34280186</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>White</surname>
            <given-names>WTJ</given-names>
          </name>
          <name>
            <surname>Hendy</surname>
            <given-names>MD</given-names>
          </name>
        </person-group>
        <article-title>Compressing DNA sequence databases with coil</article-title>
        <source>BMC Bioinformatics</source>
        <year>2008</year>
        <volume>9</volume>
        <issue>1</issue>
        <fpage>242</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-9-242</pub-id>
        <?supplied-pmid 18489794?>
        <pub-id pub-id-type="pmid">18489794</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yanovsky</surname>
            <given-names>V</given-names>
          </name>
        </person-group>
        <article-title>ReCoil-an algorithm for compression of extremely large datasets of DNA data</article-title>
        <source>Algorithms Mol Biol</source>
        <year>2011</year>
        <volume>6</volume>
        <issue>1</issue>
        <fpage>23</fpage>
        <pub-id pub-id-type="doi">10.1186/1748-7188-6-23</pub-id>
        <?supplied-pmid 21988957?>
        <pub-id pub-id-type="pmid">21988957</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lee</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Song</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>FastqCLS: a FASTQ compressor for long-read sequencing via read reordering using a novel scoring model</article-title>
        <source>Bioinformatics</source>
        <year>2022</year>
        <volume>38</volume>
        <issue>2</issue>
        <fpage>351</fpage>
        <lpage>356</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btab696</pub-id>
        <?supplied-pmid 34623374?>
        <pub-id pub-id-type="pmid">34623374</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Al Yami</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Huang</surname>
            <given-names>CH</given-names>
          </name>
        </person-group>
        <article-title>LFastqC: A lossless non-reference-based FASTQ compressor</article-title>
        <source>PLoS ONE</source>
        <year>2019</year>
        <volume>14</volume>
        <issue>11</issue>
        <fpage>e0224806</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0224806</pub-id>
        <?supplied-pmid 31725736?>
        <pub-id pub-id-type="pmid">31725736</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Cheng</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Grossman</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>McKercher</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <source>Professional CUDA c programming</source>
        <year>2017</year>
        <publisher-loc>Beijing</publisher-loc>
        <publisher-name>China Machine Press</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cha</surname>
            <given-names>SH</given-names>
          </name>
        </person-group>
        <article-title>Comprehensive survey on distance/similarity measures between probability density functions</article-title>
        <source>Int J Math Models Methods Appl Sci</source>
        <year>2007</year>
        <volume>1</volume>
        <issue>2</issue>
        <fpage>300</fpage>
        <lpage>307</lpage>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hoare</surname>
            <given-names>CAR</given-names>
          </name>
        </person-group>
        <article-title>Quicksort</article-title>
        <source>Comput J</source>
        <year>1962</year>
        <volume>5</volume>
        <issue>1</issue>
        <fpage>10</fpage>
        <lpage>16</lpage>
        <pub-id pub-id-type="doi">10.1093/comjnl/5.1.10</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
