<?properties open_access?>
<?subarticle report11745?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v3.0 20080202//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing3.dtd?>
<?SourceDTD.Version 3.0?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">F1000Res</journal-id>
    <journal-id journal-id-type="iso-abbrev">F1000Res</journal-id>
    <journal-id journal-id-type="pmc">F1000Research</journal-id>
    <journal-title-group>
      <journal-title>F1000Research</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2046-1402</issn>
    <publisher>
      <publisher-name>F1000Research</publisher-name>
      <publisher-loc>London, UK</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">4712774</article-id>
    <article-id pub-id-type="doi">10.12688/f1000research.7563.2</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Method Article</subject>
      </subj-group>
      <subj-group>
        <subject>Articles</subject>
        <subj-group>
          <subject>Bioinformatics</subject>
        </subj-group>
        <subj-group>
          <subject>Genomics</subject>
        </subj-group>
        <subj-group>
          <subject>Structure: Transcription &amp; Translation</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Differential analyses for RNA-seq: transcript-level estimates improve gene-level inferences</article-title>
      <fn-group content-type="pub-status">
        <fn>
          <p>[version 2; referees: 2 approved]</p>
        </fn>
      </fn-group>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Soneson</surname>
          <given-names>Charlotte</given-names>
        </name>
        <xref ref-type="corresp" rid="c1">a</xref>
        <xref ref-type="aff" rid="a1">1</xref>
        <xref ref-type="aff" rid="a2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Love</surname>
          <given-names>Michael I.</given-names>
        </name>
        <xref ref-type="corresp" rid="c2">b</xref>
        <xref ref-type="aff" rid="a3">3</xref>
        <xref ref-type="aff" rid="a4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Robinson</surname>
          <given-names>Mark D.</given-names>
        </name>
        <xref ref-type="corresp" rid="c3">c</xref>
        <xref ref-type="aff" rid="a1">1</xref>
        <xref ref-type="aff" rid="a2">2</xref>
      </contrib>
      <aff id="a1"><label>1</label>Institute for Molecular Life Sciences, University of Zurich, Zurich, 8057, Switzerland</aff>
      <aff id="a2"><label>2</label>SIB Swiss Institute of Bioinformatics, University of Zurich, Zurich, 8057, Switzerland</aff>
      <aff id="a3"><label>3</label>Department of Biostatistics and Computational Biology, Dana-Farber Cancer Institute, Boston, MA, 02210, USA</aff>
      <aff id="a4"><label>4</label>Department of Biostatistics, Harvard TH Chan School of Public Health, Boston, MA, 02115, USA</aff>
    </contrib-group>
    <author-notes>
      <corresp id="c1">
        <label>a</label>
        <email xlink:href="mailto:charlotte.soneson@uzh.ch">charlotte.soneson@uzh.ch</email>
      </corresp>
      <corresp id="c2">
        <label>b</label>
        <email xlink:href="mailto:michaelisaiahlove@gmail.com">michaelisaiahlove@gmail.com</email>
      </corresp>
      <corresp id="c3">
        <label>c</label>
        <email xlink:href="mailto:mark.robinson@imls.uzh.ch">mark.robinson@imls.uzh.ch</email>
      </corresp>
      <fn fn-type="con">
        <p>CS, MIL and MDR conceived the study and developed methodology. CS and MDR designed and carried out the computational experiments and drafted the manuscript. MIL implemented the
<italic>tximport</italic> R package and wrote parts of the manuscript. All authors read and approved the final manuscript and have agreed to the content.</p>
      </fn>
      <fn fn-type="COI-statement">
        <p><bold>Competing interests: </bold>No competing interests were disclosed.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="epub">
      <day>29</day>
      <month>2</month>
      <year>2016</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2015</year>
    </pub-date>
    <volume>4</volume>
    <elocation-id>1521</elocation-id>
    <history>
      <date date-type="accepted">
        <day>23</day>
        <month>2</month>
        <year>2016</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Copyright: © 2016 Soneson C et al.</copyright-statement>
      <copyright-year>2016</copyright-year>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the Creative Commons Attribution Licence, which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:type="simple" xlink:href="f1000research-4-8770.pdf"/>
    <abstract>
      <p>High-throughput sequencing of cDNA (RNA-seq) is used extensively to characterize the transcriptome of cells. Many transcriptomic studies aim at comparing either abundance levels or the transcriptome composition between given conditions, and as a first step, the sequencing reads must be used as the basis for abundance quantification of transcriptomic features of interest, such as genes or transcripts. Various quantification approaches have been proposed, ranging from simple counting of reads that overlap given genomic regions to more complex estimation of underlying transcript abundances. In this paper, we show that gene-level abundance estimates and statistical inference offer advantages over transcript-level analyses, in terms of performance and interpretability. We also illustrate that the presence of differential isoform usage can lead to inflated false discovery rates in differential gene expression analyses on simple count matrices but that this can be addressed by incorporating offsets derived from transcript-level abundance estimates. We also show that the problem is relatively minor in several real data sets. Finally, we provide an R package (
<italic>tximport</italic>) to help users integrate transcript-level abundance estimates from common quantification pipelines into count-based statistical inference engines.</p>
    </abstract>
    <kwd-group kwd-group-type="author">
      <kwd>RNA-seq</kwd>
      <kwd>quantification</kwd>
      <kwd>gene expression</kwd>
      <kwd>transcriptomics</kwd>
    </kwd-group>
    <funding-group>
      <award-group id="fund-1">
        <funding-source>National Center of Competence in Research</funding-source>
      </award-group>
      <award-group id="fund-2">
        <funding-source>SNSF</funding-source>
        <award-id>143883</award-id>
      </award-group>
      <award-group id="fund-3">
        <funding-source>7th Framework Collaborative Project RADIANT</funding-source>
        <award-id>305626</award-id>
      </award-group>
      <award-group id="fund-4">
        <funding-source>National Institutes of Health</funding-source>
        <award-id>5T32CA009337-35</award-id>
      </award-group>
      <funding-statement>MDR and CS acknowledge support from the “RNA &amp; Disease” National Center of Competence in Research, an SNSF project grant (143883) and from the European Commission through the 7th Framework Collaborative Project RADIANT (Grant Agreement Number: 305626). MIL was supported by NIH grant 5T32CA009337-35.</funding-statement>
      <funding-statement>
        <italic>The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</italic>
      </funding-statement>
    </funding-group>
  </article-meta>
  <notes notes-type="version-changes">
    <sec sec-type="version-changes">
      <label>Revised</label>
      <title>Amendments from Version 1</title>
      <p>In version 2 of the manuscript, we have reworded and improved the clarity of the text in several places, to better convey the differences between the contrasted approaches and clarify the questions that are addressed by each analysis. We have also expanded the supplementary material with additional analyses of accuracy of abundance estimates among paralogous genes, and added more detailed descriptions of aspects such as the calculation of each abundance measure and the generation of the incomplete annotation files, information that was previously only available in the respective Datasets. The Discussion section has been extended, mainly to include a discussion of differential expression analysis methods incorporating variance estimates.</p>
    </sec>
  </notes>
</front>
<body>
  <sec sec-type="intro">
    <title>Introduction</title>
    <p>Quantification and comparison of isoform- or gene-level expression based on high throughput sequencing reads from cDNA (RNA-seq) are arguably among the most common tasks in modern computational molecular biology. Currently, one of the most widely used approaches amounts to defining the genomic locations of a set of non-overlapping targets (typically, genes) and using the number of aligned reads overlapping a target as a measure of its abundance, or expression level. Several software packages have been developed for performing such “simple” counting (e.g.,
<italic>featureCounts</italic>
<sup><xref rid="ref-1" ref-type="bibr">1</xref></sup> and
<italic>HTSeq-count</italic>
<sup><xref rid="ref-2" ref-type="bibr">2</xref></sup>). More recently, the field has seen a surge in methods aimed at quantifying the abundances of individual
<italic>transcripts</italic> (e.g.,
<italic>Cufflinks</italic>
<sup><xref rid="ref-3" ref-type="bibr">3</xref></sup>,
<italic>RSEM</italic>
<sup><xref rid="ref-4" ref-type="bibr">4</xref></sup>,
<italic>BitSeq</italic>
<sup><xref rid="ref-5" ref-type="bibr">5</xref></sup>,
<italic>kallisto</italic>
<sup><xref rid="ref-6" ref-type="bibr">6</xref></sup> and
<italic>Salmon</italic>
<sup><xref rid="ref-7" ref-type="bibr">7</xref></sup>). These methods provide higher resolution than simple counting, and by circumventing the computationally costly read alignment step, some (notably,
<italic>kallisto</italic> and
<italic>Salmon</italic>) are also considerably faster. However, isoform quantification is more complex than the simple counting, due to the high degree of overlap among transcripts. Currently, there is no consensus regarding the optimal resolution or method for quantification and downstream analysis of transcriptomic output.</p>
    <p>Another point of debate is the unit in which abundances are given. The traditional R/FPKM
<sup><xref rid="ref-8" ref-type="bibr">8</xref>,
<xref rid="ref-9" ref-type="bibr">9</xref></sup> (reads/fragments per kilobase per million reads) have been largely superseded by the TPM
<sup><xref rid="ref-10" ref-type="bibr">10</xref></sup> (transcripts per million), since the latter is more consistent across libraries. Regardless, all these units attempt to “correct for” sequencing depth and feature length and thus do not reflect the influence of these on quantification uncertainty. In order to account for these aspects, most statistical tools for analysis of RNA-seq data operate instead on the
<italic>count</italic> scale. Most of these tools were designed to be applied to simple read counts, and the degree to which their performance is affected by using fractional estimated counts resulting from portioning reads aligning to multiple transcripts is still an open question. The fact that the most common sequencing protocols provide reads that are much shorter than the average transcript implies that the observed read counts depend on a transcript’s length as well as its abundance; thus, simple counts are arguably less accurate measures than TPMs of the true abundance of RNA molecules from given genes. The use of gene counts as input to statistical tools typically assumes that the length of the expressed part of a gene does not change across samples and thus its impact can be ignored for differential analysis.</p>
    <p>In the analysis of transcriptomic data, as for any other application, it is of utmost importance that the question of interest is precisely defined before a computational approach is selected. Often, the interest lies in comparing the transcriptional output between different conditions, and most RNA-seq studies can be classified as either: 1) differential gene expression (DGE) studies, where the overall transcriptional output of each gene is compared between conditions; 2) differential transcript/exon usage (DTU/DEU) studies, where the composition of a gene’s isoform abundance spectrum is compared between conditions, or 3) differential transcript expression (DTE) studies, where the interest lies in whether individual transcripts show differential expression between conditions. DTE analysis results can be represented on the individual transcript level, or aggregated to the gene level, e.g., by evaluating whether
<italic>at least one</italic> of the isoforms shows evidence of differential abundance.</p>
    <p>In this report, we make and give evidence for three claims: 1) gene-level estimation is considerably more accurate than transcript-level; 2) regardless of the level at which abundance estimation is done,
<italic>inferences</italic> at the gene level are appealing in terms of robustness, statistical performance and interpretation; 3) taking advantage of transcript-level abundance estimates when defining or analyzing gene-level abundances leads to improved DGE results compared to simple counting for genes exhibiting DTU. The magnitude of the effect in a given data set thus depends on the extent of DTU, and the global impact is relatively small in several real data sets analyzed in this study.</p>
    <p>To facilitate a broad range of analysis choices, depending on the biological question of interest, we provide an R/Bioconductor package,
<italic>tximport</italic>, to import transcript lengths and abundance estimates from several popular quantification packages and export (estimated) count matrices and, optionally, average transcript length correction terms (i.e., offsets) that can be used as inputs to common statistical engines, such as
<italic>DESeq2</italic>
<sup><xref rid="ref-11" ref-type="bibr">11</xref></sup>,
<italic>edgeR</italic>
<sup><xref rid="ref-12" ref-type="bibr">12</xref></sup> and
<italic>limma</italic>
<sup><xref rid="ref-13" ref-type="bibr">13</xref></sup>.</p>
  </sec>
  <sec>
    <title>Data and methods</title>
    <p>Throughout this manuscript, we utilize two simulated data sets and four experimental data sets (Bottomly
<sup><xref rid="ref-14" ref-type="bibr">14</xref></sup> [
<xref ref-type="other" rid="DS2">Data set 3</xref>], GSE64570
<sup><xref rid="ref-15" ref-type="bibr">15</xref></sup> [
<xref ref-type="other" rid="DS3">Data set 4</xref>], GSE69244
<sup><xref rid="ref-16" ref-type="bibr">16</xref></sup> [
<xref ref-type="other" rid="DS4">Data set 5</xref>], GSE72165
<sup><xref rid="ref-17" ref-type="bibr">17</xref></sup> [
<xref ref-type="other" rid="DS5">Data set 6</xref>], see
<xref ref-type="other" rid="SM1">Supplementary File 1</xref> for further details) for illustration. Details on the data generation and full records of the analyses are provided in the data sets and
<xref ref-type="other" rid="SM1">Supplementary File 1</xref>. The first simulated data set (sim1;
<xref ref-type="other" rid="DS0">Data set 1</xref>) is the synthetic human data set from Soneson
<italic>et al</italic>.
<sup><xref rid="ref-18" ref-type="bibr">18</xref></sup>, comprising 20,410 genes and 145,342 transcripts and is available from ArrayExpress (accession E-MTAB-3766). This data set consists of three biological replicates from each of two simulated conditions, and differential isoform usage was introduced for 1,000 genes by swapping the relative expression levels of the two most dominant isoforms between conditions. For each gene in this data set, the total transcriptional output is the same in the two conditions (i.e., no overall DGE); it is worth noting that this is an extreme situation, but provides a useful test set for contrasting DGE, DTU and DTE. The second simulated data set (sim2;
<xref ref-type="other" rid="DS1">Data set 2</xref>) is a synthetic data set comprising the 3,858 genes and 15,677 transcripts from the human chromosome 1. It is available from ArrayExpress with accession E-MTAB-4119. Also here, we simulated two conditions with three biological replicates each. For this data set, we simulated both overall DGE, where all transcripts of the affected gene showed the same fold change between the conditions (420 genes), differential transcript usage (DTU), where the total transcriptional output was kept constant but the relative contribution from the transcripts changed (420 genes) and differential transcript expression (DTE), where the expression of 10% of the transcripts of each affected gene was modified (422 genes, 528 transcripts). The three sets of modified genes were disjoint. Again, this synthetic data set represents an extreme situation compared to most real data sets, but provides a useful test case to identify underlying causes of differences between results from various analysis pipelines.</p>
    <p>In addition to
<xref ref-type="other" rid="DS0">Data set 1</xref>–
<xref ref-type="other" rid="DS5">Data set 6</xref>, which contain all code for reproducing our analyses, further method descriptions are given in
<xref ref-type="other" rid="SM1">Supplementary File 1</xref>.</p>
    <supplementary-material content-type="local-data" id="DS0">
      <label>Data set 1</label>
      <caption>
        <p>
          <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.5256/f1000research.7563.d114722">http://dx.doi.org/10.5256/f1000research.7563.d114722</ext-link>
        </p>
        <p>Dataset 1 (html) contains all the R code that was used to perform the analyses and generate the figures for the
<bold>sim1</bold> data set
<sup><xref rid="ref-30" ref-type="bibr">30</xref></sup>.</p>
      </caption>
      <media xlink:href="f1000research-4-8770-s0000.tgz">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
      <permissions>
        <copyright-statement>Copyright: © 2016 Soneson C et al.</copyright-statement>
        <copyright-year>2016</copyright-year>
        <license xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">
          <license-p>Data associated with the article are available under the terms of the Creative Commons Zero "No rights reserved" data waiver (CC0 1.0 Public domain dedication).</license-p>
        </license>
      </permissions>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="DS1">
      <label>Data set 2</label>
      <caption>
        <p>
          <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.5256/f1000research.7563.d114723">http://dx.doi.org/10.5256/f1000research.7563.d114723</ext-link>
        </p>
        <p>Data set 2 (html) contains all the R code that was used to perform the analyses and generate the figures for the
<bold>sim2</bold> data set
<sup><xref rid="ref-31" ref-type="bibr">31</xref></sup>.</p>
      </caption>
      <media xlink:href="f1000research-4-8770-s0001.tgz">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
      <permissions>
        <copyright-statement>Copyright: © 2016 Soneson C et al.</copyright-statement>
        <copyright-year>2016</copyright-year>
        <license xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">
          <license-p>Data associated with the article are available under the terms of the Creative Commons Zero "No rights reserved" data waiver (CC0 1.0 Public domain dedication).</license-p>
        </license>
      </permissions>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="DS2">
      <label>Data set 3</label>
      <caption>
        <p>
          <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.5256/f1000research.7563.d114724">http://dx.doi.org/10.5256/f1000research.7563.d114724</ext-link>
        </p>
        <p>Data set 3 (html) contains all the R code that was used to perform the analyses and generate the figures for the
<bold>Bottomly</bold> data set
<sup><xref rid="ref-32" ref-type="bibr">32</xref></sup>.</p>
      </caption>
      <media xlink:href="f1000research-4-8770-s0002.tgz">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
      <permissions>
        <copyright-statement>Copyright: © 2016 Soneson C et al.</copyright-statement>
        <copyright-year>2016</copyright-year>
        <license xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">
          <license-p>Data associated with the article are available under the terms of the Creative Commons Zero "No rights reserved" data waiver (CC0 1.0 Public domain dedication).</license-p>
        </license>
      </permissions>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="DS3">
      <label>Data set 4</label>
      <caption>
        <p>
          <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.5256/f1000research.7563.d114725">http://dx.doi.org/10.5256/f1000research.7563.d114725</ext-link>
        </p>
        <p>Data set 4 (html) contains all the R code that was used to perform the analyses and generate the figures for the
<bold>GSE64570</bold> data set
<sup><xref rid="ref-33" ref-type="bibr">33</xref></sup>.</p>
      </caption>
      <media xlink:href="f1000research-4-8770-s0003.tgz">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
      <permissions>
        <copyright-statement>Copyright: © 2016 Soneson C et al.</copyright-statement>
        <copyright-year>2016</copyright-year>
        <license xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">
          <license-p>Data associated with the article are available under the terms of the Creative Commons Zero "No rights reserved" data waiver (CC0 1.0 Public domain dedication).</license-p>
        </license>
      </permissions>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="DS4">
      <label>Data set 5</label>
      <caption>
        <p>
          <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.5256/f1000research.7563.d114726">http://dx.doi.org/10.5256/f1000research.7563.d114726</ext-link>
        </p>
        <p>Data set 5 (html) contains all the R code that was used to perform the analyses and generate the figures for the
<bold>GSE69244</bold> data set
<sup><xref rid="ref-34" ref-type="bibr">34</xref></sup>.</p>
      </caption>
      <media xlink:href="f1000research-4-8770-s0004.tgz">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
      <permissions>
        <copyright-statement>Copyright: © 2016 Soneson C et al.</copyright-statement>
        <copyright-year>2016</copyright-year>
        <license xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">
          <license-p>Data associated with the article are available under the terms of the Creative Commons Zero "No rights reserved" data waiver (CC0 1.0 Public domain dedication).</license-p>
        </license>
      </permissions>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="DS5">
      <label>Data set 6</label>
      <caption>
        <p>
          <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.5256/f1000research.7563.d114730">http://dx.doi.org/10.5256/f1000research.7563.d114730</ext-link>
        </p>
        <p>Data set 6 (html) contain all the R code that was used to perform the analyses and generate the figures for the
<bold>GSE72165</bold> data set
<sup><xref rid="ref-35" ref-type="bibr">35</xref></sup>.</p>
      </caption>
      <media xlink:href="f1000research-4-8770-s0005.tgz">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
      <permissions>
        <copyright-statement>Copyright: © 2016 Soneson C et al.</copyright-statement>
        <copyright-year>2016</copyright-year>
        <license xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">
          <license-p>Data associated with the article are available under the terms of the Creative Commons Zero "No rights reserved" data waiver (CC0 1.0 Public domain dedication).</license-p>
        </license>
      </permissions>
    </supplementary-material>
  </sec>
  <sec>
    <title>Gene abundance estimates are more accurate than transcript abundance estimates</title>
    <p>To evaluate the accuracy of abundance estimation with transcript and gene resolution, we used the quasi-mapping mode of
<italic>Salmon</italic>
<sup><xref rid="ref-7" ref-type="bibr">7</xref></sup> (v0.5.1) to estimate the TPM for each transcript in each of the data sets. Gene-level TPM estimates, representing the overall transcriptional output of each gene, were obtained by summing the corresponding transcript-level TPM estimates. For the two simulated data sets, the true underlying TPM of each feature was known and we could thus evaluate the accuracy of the estimates. Unsurprisingly, gene-level estimates were more accurate than transcript-level estimates (
<xref ref-type="fig" rid="f1">Figure 1A</xref>,
<xref ref-type="other" rid="SM1">Supplementary Figures 4,5</xref>). We also derived TPM estimates from simple gene-level counts obtained from traditional alignment of the reads to the genome using STAR followed by counting with
<italic>featureCounts</italic>, by dividing the read count for each gene with a reasonable measure of the length of the gene (the length of the union of its exons) and the total number of mapped reads, and scaling the estimates to sum to 1 million. The simple count estimates showed a lower correlation with the true TPMs than the
<italic>Salmon</italic> estimates, in line with previous observations
<sup><xref rid="ref-19" ref-type="bibr">19</xref></sup>. It is worth noting that we are comparing entire (typical) workflows, and that differences may also occur if the set of reads that STAR is able to align to the genome is not identical to the set of reads that are contributing to the abundance estimation of
<italic>Salmon</italic>. However, due to the large fraction of aligned reads and the high mapping rate with
<italic>Salmon</italic> (both exceeding 99.8%, more than 95% of the reads were subsequently unambiguously assigned to genes by
<italic>featureCounts</italic>), we do not expect this to have a major impact on the results shown in
<xref ref-type="fig" rid="f1">Figure 1A</xref>.</p>
    <fig fig-type="figure" id="f1" orientation="portrait" position="float">
      <label>Figure 1 (sim2). </label>
      <caption>
        <p><bold>A</bold>: Accuracy of gene- and transcript-level TPM estimates from
<italic>Salmon</italic> and scaled FPKM estimates derived from simple counts from
<italic>featureCounts</italic>, in one of the simulated samples (sampleA1). Spearman correlations are indicated in the respective panels. Top row: using the complete annotation. Bottom row: using an incomplete annotation, with 20% of the transcripts randomly removed. Gene-level estimates are more accurate than transcript-level estimates. Gene-level estimates from
<italic>Salmon</italic> are more accurate than those from
<italic>featureCounts</italic>.
<bold>B</bold>: Distribution of the coefficients of variation of gene- and transcript-level abundance estimates from
<italic>Salmon</italic>, calculated across 30 bootstrap samples of one of the simulated samples (sampleA1). Gene-level estimates are less variable than transcript-level estimates.
<bold>C</bold>: An example of unidentifiable transcript-level estimates, as uneven coverage does not cover the critical regions that would determine the amount that each transcript is expressed, while gene-level estimation is still possible.</p>
      </caption>
      <graphic xlink:href="f1000research-4-8770-g0000"/>
    </fig>
    <p>Gene-level estimates derived from both simple counts and
<italic>Salmon</italic> tended to show a high degree of robustness against incompleteness of the annotation catalog, as evidenced from estimation errors after first removing (at random) 20% of the transcripts (
<xref ref-type="fig" rid="f1">Figure 1A</xref>, see also
<xref ref-type="other" rid="SM1">Supplementary File 1</xref>); in contrast,
<italic>Salmon</italic>’s transcript estimate accuracies deteriorated. To further compare the merits of genome alignment-based vs alignment-free quantification, especially in their handling of multi-mapping reads, we investigated the accuracy of the abundance estimates within sets of paralogous genes (
<xref ref-type="other" rid="SM1">Supplementary Figures 1–3</xref>). Also here,
<italic>Salmon</italic> provided more consistently accurate estimates than STAR+
<italic>featureCounts</italic>. From the bootstrap estimates generated by
<italic>Salmon</italic>, we also estimated the coefficient of variation of the abundance estimates. The gene-level estimates showed considerably lower variability than the transcript-level estimates in both simulated and experimental data (
<xref ref-type="fig" rid="f1">Figure 1B</xref>,
<xref ref-type="other" rid="SM1">Supplementary Figures 6,7</xref>). Taken together, these observations suggest that the gene-level estimates are more accurate than transcript-level estimates and therefore potentially allow a more accurate and stable statistical analysis. A further argument in favor of gene-level analysis is the unidentifiability of transcript expression that can result from uneven coverage caused by underlying technical biases. While some extent of coverage variability might be alleviated by corrections for sequence- or position-specific biases
<sup><xref rid="ref-20" ref-type="bibr">20</xref></sup>, there remain cases where transcript expression cannot be inferred from data (
<xref ref-type="fig" rid="f1">Figure 1C</xref>). Intermediate approaches, grouping together “indistinguishable” features are also conceiveable
<sup><xref rid="ref-21" ref-type="bibr">21</xref></sup>, but not yet standard practice.</p>
  </sec>
  <sec>
    <title>DTE is more powerful and easier to interpret on gene level than for individual transcripts</title>
    <p>DTE is concerned with inference of changes in abundance at transcript resolution, and thus invokes a statistical test for each transcript. We argue that this can lead to several complications: the first is conceptual, since the rows (transcripts) in the result table will in many cases not be interpreted independently, since the researcher is often interested in comparing the results for transcripts from the same gene locus, and the second one is more technical, since the number of transcripts is considerably larger than the number of genes, which could lead to lower power due to the portioning of the total set of reads across a larger number of features and a potentially higher multiple testing penalty. We tested for DTE on the simulated data by applying
<italic>edgeR</italic>
<sup><xref rid="ref-12" ref-type="bibr">12</xref></sup> to the transcript counts obtained from
<italic>Salmon</italic> (the application of count models to
<italic>estimated</italic> counts is discussed in the next Section), and represented the results as transcript-level p-values or aggregated these to the gene level by using the
<italic>perGeneQValue</italic> function from the
<italic>DEXSeq</italic>
<sup><xref rid="ref-22" ref-type="bibr">22</xref></sup> R package. Note that the transcript-level DTE test assesses the null hypothesis that individual transcripts do not change their expression, whereas the gene-level DTE test assesses the null hypothesis that
<italic>all</italic> transcripts from a given gene exhibit no change in expression. Framing the DTE question at the gene level results in higher power, without sacrificing false discovery rate control (
<xref ref-type="fig" rid="f2">Figure 2A</xref>). This is not surprising given the different null hypotheses, and, in fact, for many of the genes detected as true positives with the gene-level test, only a subset of the truly changing transcripts were detected (
<xref ref-type="other" rid="SM1">Supplementary Figure 8</xref>). We note that this type of gene-level aggregation may favor genes in which one transcript shows strong changes, and that other approaches to increase power against specific alternatives are conceivable, e.g., capitalizing on the rich collection of methods for gene set analysis.</p>
    <fig fig-type="figure" id="f2" orientation="portrait" position="float">
      <label>Figure 2 (sim2). </label>
      <caption>
        <p><bold>A</bold>: DTE detection performance on transcript- and gene-level, using
<italic>edgeR</italic> applied to transcript-level estimated counts from
<italic>Salmon</italic>. The statistical analysis was performed on transcript level and aggregated for each gene using the
<italic>perGeneQValue</italic> function from the
<italic>DEXSeq</italic> R package; aggregated results show higher detection power. The curves trace out the observed FDR and TPR for each significance cutoff value. The three circles mark the performance at adjusted p-value cutoffs of 0.01, 0.05 and 0.1.
<bold>B</bold>: Schematic illustration of different ways in which differential transcript expression (DTE) can arise, in terms of absence or presence of differential gene expression (DGE) and differential transcript usage (DTU).</p>
      </caption>
      <graphic xlink:href="f1000research-4-8770-g0001"/>
    </fig>
    <p>While DTE analysis is more suitable than DGE analysis for detecting genes with changes in absolute or relative isoform expression but no or only minor change in overall output (
<xref ref-type="other" rid="SM1">Supplementary Figure 9</xref>), we argue that even gene-level DTE results may suffer from lack of interpretability. DTE can manifest in several different ways, as an overall differential expression of the gene or differential relative usage of its transcripts, or a combination of the two (
<xref ref-type="fig" rid="f2">Figure 2B</xref>). We argue that the biological question of interest is in many cases more readily interpretable as a combination of DGE and DTU, rather than DTE. It has been our experience that results reported at the transcript level are still often cast to the gene level (i.e., given a differentially expressed transcript, researchers want to know whether also other isoforms of the gene are changing), suggesting that asking two specific gene-level questions (Is the overall abundance changing? Are the isoform abundances changing proportionally?) trumps the interpretability of one broad question addressing the transcript abundances (Are there changes in any of the isoform expression levels?), despite the increased need for multiple testing correction associated with performing two tests for each gene rather than one. There are of course also situations when a transcript-centric approach provides superior interpretability, for example in targeted experiments where specific isoforms are expected to change due to an administered treatment.</p>
  </sec>
  <sec>
    <title>Incorporating transcript-level estimates leads to more accurate DGE results</title>
    <p>DGE (i.e., testing for changes in the overall transcriptional output of a gene) is typically performed by applying a count-based inference method from statistical packages such as
<italic>edgeR</italic>
<sup><xref rid="ref-12" ref-type="bibr">12</xref></sup> or
<italic>DESeq2</italic>
<sup><xref rid="ref-11" ref-type="bibr">11</xref></sup> to gene counts obtained by read counting software such as
<italic>featureCounts</italic>
<sup><xref rid="ref-1" ref-type="bibr">1</xref></sup>,
<italic>HTSeq-count</italic>
<sup><xref rid="ref-2" ref-type="bibr">2</xref></sup> or functions from the
<italic>GenomicAlignments</italic>
<sup><xref rid="ref-23" ref-type="bibr">23</xref></sup> R package. A lot has been written about how simple counting approaches are prone to give erroneous results for genes with changes in relative isoform usage, due to the direct dependence of the observed read count on the transcript length
<sup><xref rid="ref-24" ref-type="bibr">24</xref></sup>, and alternatives, such as
<italic>Cuffdiff</italic>
<sup><xref rid="ref-24" ref-type="bibr">24</xref></sup>, which utilizes estimated transcript abundances, have been proposed. However, the extent of the problem in real data has not been thoroughly investigated. Here, we show that taking advantage of transcript-resolution estimates (e.g., obtained by
<italic>Salmon</italic>) in count-based inference methods can lead to improved DGE results. We propose two alternative ways of integrating transcript abundance estimates into the DGE pipeline: to define an “artificial” count matrix, or to calculate offsets that can be used in the statistical modeling of the observed gene counts from, e.g.,
<italic>featureCounts</italic>. Both approaches are implemented in the accompanying
<italic>tximport</italic> R package (available from
<ext-link ext-link-type="uri" xlink:href="http://bioconductor.org/packages/tximport">http://bioconductor.org/packages/tximport</ext-link>).</p>
    <p>For the DGE analyses, we defined three different gene-level count matrices for each data set (see also
<xref ref-type="other" rid="SM1">Supplementary File 1</xref>): 1) using
<italic>featureCounts</italic> from the
<italic>Rsubread</italic>
<sup><xref rid="ref-1" ref-type="bibr">1</xref></sup> R package (denoted
<bold>featureCounts</bold> below), 2) summing the estimated transcript counts from
<italic>Salmon</italic> within genes (
<bold>simplesum</bold>), 3) summing the estimated transcript TPMs from
<italic>Salmon</italic> within genes, and multiplying with the total library size in millions (
<bold>scaledTPM</bold>). We note that the scaledTPM values are artificial values, transforming underlying abundance measures to the “count scale” to incorporate the information provided by the sequencing depth. We further used the effective transcript lengths and estimated TPMs from
<italic>Salmon</italic> to define average transcript lengths for each gene and each sample (normalization factors) as described in the
<xref ref-type="other" rid="SM1">Supplementary material</xref>, to be used as offsets for
<italic>edgeR</italic> and
<italic>DESeq2</italic> when analyzing the featureCounts and simplesum count matrices (
<bold>featureCounts_avetxl</bold> and
<bold>simplesum_avetxl</bold>).</p>
    <p>Overall, the counts obtained by all methods were highly correlated (
<xref ref-type="other" rid="SM1">Supplementary Figures 10–12</xref>), which is not surprising since any differences are likely to affect a relatively small subset of the genes. In general, the simplesum and featureCounts matrices led to similar conclusions in all considered data sets, even though there are differences between the two approaches in terms of how multi-mapping reads and reads partly overlapping intronic regions are handled
<sup><xref rid="ref-25" ref-type="bibr">25</xref></sup>. Previous studies have also shown that some loss of sensitivity for certain genes may be encountered from discarding multi-mapping fragments, which may be recovered through the use of transcript abundance estimators such as
<italic>Salmon</italic>
<sup><xref rid="ref-21" ref-type="bibr">21</xref></sup>. The concordance between simplesum and featureCounts results also suggests that statistical methods based on the Negative Binomial assumption are applicable also to summarized, gene-level
<italic>estimated</italic> counts, which is further supported by the similarity between the p-value histograms as well as the mean-variance relationships observed with the three types of count matrices (
<xref ref-type="other" rid="SM1">Supplementary Figures 13–18</xref>).</p>
    <p>Accounting for the potentially varying average transcript length across samples when performing DGE, either in the definition of the count matrix (scaledTPM) or by defining offsets (featureCounts_avetxl, simplesum_avetxl), led to considerably improved false discovery rate (FDR) control compared to using the observed
<italic>featureCounts</italic> or aggregated
<italic>Salmon</italic> counts directly (
<xref ref-type="fig" rid="f3">Figure 3A</xref>,
<xref ref-type="table" rid="T1">Table 1</xref>). It is important to note that this improvement is entirely attributable to an improved handling of genes with changes in isoform composition between the conditions (
<xref ref-type="fig" rid="f3">Figure 3B</xref>,
<xref ref-type="other" rid="SM1">Supplementary Figure 19</xref>), that we purposely introduced strong signals in the simulated data set in order to pinpoint these underlying causes, and that the overall effect in a real data set will depend on the extent to which considerable DTU is present. Experiments on various real data sets (
<xref ref-type="other" rid="SM1">Supplementary Figure 20</xref>) show only small differences in the collections of significant genes found with the simplesum and simplesum_avetxl approaches, suggesting that the extent of the problem in many real data sets is limited, and that most findings obtained with simple counting are not induced by counting artifacts. Further support for this conclusion is shown in
<xref ref-type="fig" rid="f4">Figure 4</xref> (see also
<xref ref-type="other" rid="SM1">Supplementary Figures 21–23</xref> and
<xref ref-type="other" rid="SM1">Supplementary Table 1</xref>), where log-fold change estimates from
<italic>edgeR</italic>, based on the simplesum and scaledTPM matrices, are contrasted. For the genes with induced DTU in the sim2 data set, log-fold changes based on the simplesum matrix are overestimated, as expected. However, this effect is almost absent in all the real data sets, again highlighting the extreme nature of our simulated data and suggesting that the effect of using different count matrices is considerably smaller for many real data sets.
<xref ref-type="table" rid="T1">Table 1</xref> further suggests that the lack of error control for simplesum and featureCounts matrices is more pronounced when there is a large difference in length between the differentially used isoforms. In the group with smallest length difference, where the longer differentially used isoform is less than 34% longer than the shorter one, all approaches controlled the type I error satisfactorily. It is worth noting that among all human transcript pairs in which both transcripts belong to the same gene, the median length ratio is 1.85, and for one third of such pairs the longer isoform is less than 38% longer than the shorter one (see
<xref ref-type="other" rid="DS0">Data set 1</xref>).</p>
    <fig fig-type="figure" id="f3" orientation="portrait" position="float">
      <label>Figure 3 (sim2). </label>
      <caption>
        <p><bold>A</bold>: DGE detection performance of
<italic>edgeR</italic> applied to three different count matrices (simplesum, scaledTPM, featureCounts), with or without including an offset representing the average transcript length (for simplesum and featureCounts, avetxl indicates that such offsets were used). Including the offset or using the scaledTPM count matrix leads to improved FDR control compared to using simplesum or featureCounts matrices without offset. The curves trace out the observed FDR and TPR for each significance cutoff value. The three circles mark the performance at adjusted p-value cutoffs of 0.01, 0.05 and 0.1.
<bold>B</bold>: stratification of the results in
<bold>A</bold> by the presence of differential isoform usage. The improvement in FDR control seen in
<bold>A</bold> results from an improved treatment of genes with differential isoform usage, while all methods perform similarly for genes without differential isoform usage.</p>
      </caption>
      <graphic xlink:href="f1000research-4-8770-g0002"/>
    </fig>
    <table-wrap id="T1" orientation="portrait" position="anchor">
      <label>Table 1 (sim1). </label>
      <caption>
        <title>Observed false positive rates from a differential gene expression analysis using
<italic>edgeR</italic> applied to various count matrices (with a nominal p-value cutoff at 0.05), limited to genes with true underlying differential isoform usage (recall that no genes are truly differentially expressed in this data set).</title>
        <p>The results are stratified by “effect size” (the difference in relative abundance between the two differentially used isoforms) and the length ratio between the longer and the shorter of the differentially used isoforms. FPRs below the nominal p-value threshold (0.05) are marked in bold. For more details, see
<xref ref-type="other" rid="DS1">Data set 1</xref>.</p>
      </caption>
      <table frame="hsides" rules="groups" content-type="article-table">
        <thead>
          <tr>
            <td rowspan="1" colspan="1"/>
            <th align="center" rowspan="1" colspan="1">simplesum</th>
            <th align="center" rowspan="1" colspan="1">featureCounts</th>
            <th align="center" rowspan="1" colspan="1">simplesum_avetxl</th>
            <th align="center" rowspan="1" colspan="1">featureCounts_avetxl</th>
            <th align="center" rowspan="1" colspan="1">scaledTPM</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td rowspan="1" colspan="1">[0,0.33), [1,1.34)</td>
            <td align="center" rowspan="1" colspan="1">
              <bold>0.019</bold>
            </td>
            <td align="center" rowspan="1" colspan="1">
              <bold>0.019</bold>
            </td>
            <td align="center" rowspan="1" colspan="1">
              <bold>0.023</bold>
            </td>
            <td align="center" rowspan="1" colspan="1">
              <bold>0.023</bold>
            </td>
            <td align="center" rowspan="1" colspan="1">
              <bold>0.023</bold>
            </td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">[0.33,0.67), [1,1.34)</td>
            <td align="center" rowspan="1" colspan="1">0.059</td>
            <td align="center" rowspan="1" colspan="1">0.059</td>
            <td align="center" rowspan="1" colspan="1">0.059</td>
            <td align="center" rowspan="1" colspan="1">0.059</td>
            <td align="center" rowspan="1" colspan="1">0.059</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">[0.67,1), [1,1.34)</td>
            <td align="center" rowspan="1" colspan="1">
              <bold>0.000</bold>
            </td>
            <td align="center" rowspan="1" colspan="1">0.053</td>
            <td align="center" rowspan="1" colspan="1">0.053</td>
            <td align="center" rowspan="1" colspan="1">0.053</td>
            <td align="center" rowspan="1" colspan="1">0.053</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">[0,0.33), [1.34,2.57)</td>
            <td align="center" rowspan="1" colspan="1">0.075</td>
            <td align="center" rowspan="1" colspan="1">0.070</td>
            <td align="center" rowspan="1" colspan="1">0.070</td>
            <td align="center" rowspan="1" colspan="1">0.065</td>
            <td align="center" rowspan="1" colspan="1">0.065</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">[0.33,0.67), [1.34,2.57)</td>
            <td align="center" rowspan="1" colspan="1">0.240</td>
            <td align="center" rowspan="1" colspan="1">0.220</td>
            <td align="center" rowspan="1" colspan="1">
              <bold>0.050</bold>
            </td>
            <td align="center" rowspan="1" colspan="1">
              <bold>0.033</bold>
            </td>
            <td align="center" rowspan="1" colspan="1">0.066</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">[0.67,1), [1.34,2.57)</td>
            <td align="center" rowspan="1" colspan="1">0.420</td>
            <td align="center" rowspan="1" colspan="1">0.540</td>
            <td align="center" rowspan="1" colspan="1">
              <bold>0.038</bold>
            </td>
            <td align="center" rowspan="1" colspan="1">0.077</td>
            <td align="center" rowspan="1" colspan="1">
              <bold>0.038</bold>
            </td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">[0,0.33), [2.57,35.4]</td>
            <td align="center" rowspan="1" colspan="1">0.150</td>
            <td align="center" rowspan="1" colspan="1">0.140</td>
            <td align="center" rowspan="1" colspan="1">
              <bold>0.037</bold>
            </td>
            <td align="center" rowspan="1" colspan="1">
              <bold>0.043</bold>
            </td>
            <td align="center" rowspan="1" colspan="1">
              <bold>0.037</bold>
            </td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">[0.33,0.67), [2.57,35.4]</td>
            <td align="center" rowspan="1" colspan="1">0.650</td>
            <td align="center" rowspan="1" colspan="1">0.650</td>
            <td align="center" rowspan="1" colspan="1">0.060</td>
            <td align="center" rowspan="1" colspan="1">0.060</td>
            <td align="center" rowspan="1" colspan="1">
              <bold>0.034</bold>
            </td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">[0.67,1), [2.57,35.4]</td>
            <td align="center" rowspan="1" colspan="1">0.970</td>
            <td align="center" rowspan="1" colspan="1">0.970</td>
            <td align="center" rowspan="1" colspan="1">
              <bold>0.034</bold>
            </td>
            <td align="center" rowspan="1" colspan="1">
              <bold>0.034</bold>
            </td>
            <td align="center" rowspan="1" colspan="1">
              <bold>0.034</bold>
            </td>
          </tr>
        </tbody>
      </table>
    </table-wrap>
    <fig fig-type="figure" id="f4" orientation="portrait" position="float">
      <label>Figure 4. </label>
      <caption>
        <title>Comparison of log-fold change estimates from
<italic>edgeR</italic>, based on
<bold>simplesum</bold> and
<bold>scaledTPM</bold> count matrices, in four different data sets.</title>
        <p>For the simulated data set (
<bold>sim2</bold>), where signals have been exaggerated to pinpoint underlying causes of various observations, genes with induced DTU (whose true overall log-fold change is 0) show a clear overestimation of log-fold changes when using
<bold>simplesum</bold> counts. However, none of the real data sets contain a similar population of genes, suggesting that for many real data sets, simple gene counting leads to overall similar conclusions as accounting for underlying changes in transcript usage.</p>
      </caption>
      <graphic xlink:href="f1000research-4-8770-g0003"/>
    </fig>
  </sec>
  <sec sec-type="discussion">
    <title>Discussion</title>
    <p>In this article, we have contrasted transcript- and gene-resolution analyses in terms of both abundance estimation and statistical inference, and illustrated that gene-level results are often more accurate, powerful and interpretable than transcript-level results. Not surprisingly, however, accurate transcript-level estimation and inference play an important role in deriving appropriate gene-level results, and it is therefore imperative to continue improving abundance estimation and inference methods applicable to individual transcripts, since misestimation can propagate to the gene level. We have shown that when testing for changes in overall gene expression (DGE), traditional gene counting approaches may lead to an inflated false discovery rate compared to methods aggregating transcript-level TPM values or incorporating correction factors derived from these, for genes where the relative isoform usage differs between the compared conditions. These correction factors can be calculated from the output of transcript abundance programs, using e.g., the provided R package (
<italic>tximport</italic>). It is important to note that the average transcript length offsets must account for the differences in transcript usage between the samples and thus using (sample-independent) exon-union gene lengths will not improve performance.</p>
    <p>On the six data sets studied here, simple counting with
<italic>featureCounts</italic> led to very similar conclusions as estimated gene counts from
<italic>Salmon</italic>, when combined with count-based statistical inference tools such as
<italic>edgeR</italic> and
<italic>DESeq2</italic>. Moreover, p-value distributions and mean-variance relationships were similar for actual and estimated counts. Taken together, this suggests that the negative binomial assumption made by the count-based tools is flexible enough to accommodate also estimated counts. All evaluated counting approaches, with and without the inclusion of average transcript length offsets, gave comparable DGE results for genes where DTU was not present. Thus, the extent of the FDR inflation in experimental data depends on the extent of DTU between the compared conditions; notably, our simulation introduced rather extreme levels of DTU, hence the inflated FDR, and the difference between the approaches was considerably smaller in real data sets. Recent studies have also shown that many genes express mainly one, dominant isoform
<sup><xref rid="ref-26" ref-type="bibr">26</xref></sup> and for such genes, we expect that simple gene counting will work well.</p>
    <p>All evaluations in this study were performed using well-established count-based differential analysis tools. These methods take as input a matrix of counts, which is assumed to correctly represent the origin of each read in a particular set of libraries. However, due to sequence similarities among transcripts or genes, there is often a hidden uncertainty in the feature abundance estimates, even when the set of input reads is fixed. With the development of fast, alignment-free abundance estimation methods, this uncertainty can now be estimated rapidly using bootstrap approaches (see e.g.
<xref ref-type="fig" rid="f1">Figure 1b</xref>). Method development is currently underway in the field to account for this uncertainty in the differential expression analysis (e.g., MetaDiff
<sup><xref rid="ref-27" ref-type="bibr">27</xref></sup>, sleuth
<sup><xref rid="ref-6" ref-type="bibr">6</xref></sup>), which has the potential to improve performance of both DTE and DGE analyses. If such methods are based on (potentially transformed) aggregated transcript counts as gene-level abundance measures, DGE analysis will still be affected by the presence of DTU, and thus could benefit from the inclusion of average transcript length offsets, or by instead using the sum of transcript TPMs as gene abundance measures.</p>
    <p>Our results highlight the importance of carefully specifying the question of interest before selecting a statistical approach. Summarization of abundance estimates at the gene level before performing the statistical testing should be the method of choice if the interest is in finding changes in the overall transcriptional output of a gene. However, it is suboptimal if the goal is to identify genes for which
<italic>at least one</italic> of the transcripts show differences in transcriptional output, since it may miss genes where two transcripts change in opposite directions, or where a lowly expressed transcript changes. For gene-level detection of DTE (that is, whether any transcript showed a change in expression between the conditions), statistical testing applied to aggregated gene counts led to reduced power and slightly inflated FDR compared to performing the statistical test on the transcript level and aggregating results within genes (
<xref ref-type="other" rid="SM1">Supplementary Figure 9</xref>). Statistical inference on aggregated transcript TPMs (scaledTPM) showed low power for detecting changes that did not affect the overall transcriptional output of the gene, as expected. An alternative to DTE analysis, for potential improved interpretability, is to perform a combination of DGE and DTU analyses, both resulting in gene-level inferences.
<xref ref-type="table" rid="T2">Table 2</xref> summarizes our results and give suggested workflows for the different types of analyses we have considered.</p>
    <table-wrap id="T2" orientation="portrait" position="anchor">
      <label>Table 2. </label>
      <caption>
        <title>Summary of suitable analysis approaches for the three types of comparative analyses discussed in the manuscript (DGE, DTE and DTU).</title>
      </caption>
      <table frame="hsides" rules="groups" content-type="article-table">
        <thead>
          <tr>
            <th align="left" rowspan="1" colspan="1">Task</th>
            <th align="left" rowspan="1" colspan="1">Input data</th>
            <th align="left" rowspan="1" colspan="1">Software (examples)</th>
            <th align="left" rowspan="1" colspan="1">Post-processing</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td rowspan="3" valign="top" colspan="1">DGE</td>
            <td rowspan="3" valign="top" colspan="1">Aggregated transcript counts +
<break/>average transcript length offsets, or
<break/>simple counts + average transcript
<break/>length offsets</td>
            <td rowspan="1" colspan="1">Salmon, kallisto, BitSeq, RSEM</td>
            <td rowspan="3" valign="top" colspan="1"/>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">tximport</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">DESeq2, edgeR, voom/limma</td>
          </tr>
          <tr>
            <td rowspan="3" valign="top" colspan="1">DTE</td>
            <td rowspan="3" valign="top" colspan="1">Transcript counts</td>
            <td rowspan="1" colspan="1">Salmon, kallisto, BitSeq, RSEM</td>
            <td rowspan="3" valign="top" colspan="1">Optional gene-level
<break/>aggregation</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">tximport</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">DESeq2, edgeR, sleuth, voom/limma</td>
          </tr>
          <tr>
            <td rowspan="2" valign="top" colspan="1">DTU/DEU</td>
            <td rowspan="2" valign="top" colspan="1">Transcript counts or bin counts,
<break/>depending on interpretation potential
<sup><xref rid="ref-18" ref-type="bibr">18</xref></sup>
</td>
            <td rowspan="1" colspan="1">Salmon, kallisto, BitSeq, RSEM</td>
            <td rowspan="2" valign="top" colspan="1">Optional gene-level
<break/>aggregation</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">DEXSeq</td>
          </tr>
        </tbody>
      </table>
    </table-wrap>
    <p>Finally, we note that abundance estimation at the gene level can reduce the impact of technical biases on expression levels, which have been shown to lead to estimation errors, such as expression being attributed to the wrong isoform
<sup><xref rid="ref-28" ref-type="bibr">28</xref></sup>. Non-uniform coverage from amplification bias or from position bias (3’ coverage bias from poly-(A) selection) can result in unidentifiable transcript-level estimation. While correction of technical artifacts in coverage can be attempted computationally, through estimation of sequence- and position-specific biases
<sup><xref rid="ref-20" ref-type="bibr">20</xref></sup>, we note that such errors and estimation problems are also minimized when summarizing expression to the gene level. This being said, there may of course be situations where a direct transcript-level analysis is appropriate. For example, in a cancer setting where a specific deleterious splice variant is of interest (e.g., AR-V7 in prostate cancer
<sup><xref rid="ref-29" ref-type="bibr">29</xref></sup>), inferences directly at the transcript level may be preferred. However, while this may be preferred for individual known transcripts, transcriptome-wide differential expression analyses may not be warranted, given the associated multiple testing cost.</p>
  </sec>
  <sec>
    <title>Data availability</title>
    <p>The data referenced by this article are under copyright with the following copyright statement: Copyright: © 2016 Soneson C et al.</p>
    <p>Data associated with the article are available under the terms of the Creative Commons Zero "No rights reserved" data waiver (CC0 1.0 Public domain dedication).
<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/"/>
</p>
    <p><italic>F1000Research</italic>: Dataset 1. Data set 1,
<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.5256/f1000research.7563.d114722">10.5256/f1000research.7563.d114722</ext-link></p>
    <p><italic>F1000Research</italic>: Dataset 2. Data set 2,
<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.5256/f1000research.7563.d114723">10.5256/f1000research.7563.d114723</ext-link></p>
    <p><italic>F1000Research</italic>: Dataset 3. Data set 3,
<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.5256/f1000research.7563.d114724">10.5256/f1000research.7563.d114724</ext-link></p>
    <p><italic>F1000Research</italic>: Dataset 4. Data set 4,
<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.5256/f1000research.7563.d114725">10.5256/f1000research.7563.d114725</ext-link></p>
    <p><italic>F1000Research</italic>: Dataset 5. Data set 5,
<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.5256/f1000research.7563.d114726">10.5256/f1000research.7563.d114726</ext-link></p>
    <p><italic>F1000Research</italic>: Dataset 6. Data set 6,
<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.5256/f1000research.7563.d114730">10.5256/f1000research.7563.d114730</ext-link></p>
  </sec>
  <sec>
    <title>Software availability</title>
    <sec>
      <title>Software access</title>
      <p>
        <ext-link ext-link-type="uri" xlink:href="http://bioconductor.org/packages/tximport">http://bioconductor.org/packages/tximport</ext-link>
      </p>
    </sec>
    <sec>
      <title>Source code as at the time of publication</title>
      <p>
        <ext-link ext-link-type="uri" xlink:href="https://github.com/F1000Research/tximport">https://github.com/F1000Research/tximport</ext-link>
      </p>
    </sec>
    <sec>
      <title>Archived source code as at the time of publication</title>
      <p>
        <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.5281/Zenodo.35123">http://dx.doi.org/10.5281/Zenodo.35123</ext-link>
      </p>
    </sec>
    <sec>
      <title>Software license</title>
      <p><italic>tximport</italic> is released under a GNU Public License (GPL).</p>
    </sec>
  </sec>
</body>
<back>
  <ack>
    <title>Acknowledgments</title>
    <p>The authors would like to thank Magnus Rattray, Alexander Kanitz, Hubert Rehrauer, Xiaobei Zhou and Rafael Irizarry for helpful comments on earlier versions of this manuscript. The authors would also like to thank the reviewers, Rob Patro and Stephen Floor, for their excellent suggestions that have helped to improve this manuscript.</p>
  </ack>
  <sec id="SM1" sec-type="supplementary-material">
    <title>Supplementary material</title>
    <p>
      <italic>Supplementary file 1.</italic>
    </p>
    <p>Supplementary File 1 (pdf) contains more detailed information about the data sets, supplementary methods and supplementary figures referred to in the text.</p>
    <p><supplementary-material content-type="local-data" id="S0"><media xlink:href="f1000research-4-8770-s0006.tgz"><caption><p>Click here for additional data file.</p></caption></media></supplementary-material>.</p>
  </sec>
  <ref-list>
    <ref id="ref-1">
      <label>1</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Liao</surname><given-names>Y</given-names></name><name><surname>Smyth</surname><given-names>GK</given-names></name><name><surname>Shi</surname><given-names>W</given-names></name></person-group>:
<article-title>featureCounts: an efficient general purpose program for assigning sequence reads to genomic features.</article-title><source><italic>Bioinformatics.</italic></source><year>2014</year>;<volume>30</volume>(<issue>7</issue>):<fpage>923</fpage>–<lpage>30</lpage>.
<pub-id pub-id-type="doi">10.1093/bioinformatics/btt656</pub-id><?supplied-pmid 24227677?><pub-id pub-id-type="pmid">24227677</pub-id></mixed-citation>
    </ref>
    <ref id="ref-2">
      <label>2</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Anders</surname><given-names>S</given-names></name><name><surname>Pyl</surname><given-names>PT</given-names></name><name><surname>Huber</surname><given-names>W</given-names></name></person-group>:
<article-title>HTSeq--a Python framework to work with high-throughput sequencing data.</article-title><source><italic>Bioinformatics.</italic></source><year>2015</year>;<volume>31</volume>(<issue>2</issue>):<fpage>166</fpage>–<lpage>169</lpage>.
<pub-id pub-id-type="doi">10.1093/bioinformatics/btu638</pub-id><!--<pub-id pub-id-type="pmcid">4287950</pub-id>--><?supplied-pmid 25260700?><pub-id pub-id-type="pmid">25260700</pub-id></mixed-citation>
    </ref>
    <ref id="ref-3">
      <label>3</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Trapnell</surname><given-names>C</given-names></name><name><surname>Roberts</surname><given-names>A</given-names></name><name><surname>Goff</surname><given-names>L</given-names></name><etal/></person-group>:
<article-title>Differential gene and transcript expression analysis of RNA-seq experiments with TopHat and Cufflinks.</article-title><source><italic>Nat Protoc.</italic></source><year>2012</year>;<volume>7</volume>(<issue>3</issue>):<fpage>562</fpage>–<lpage>78</lpage>.
<pub-id pub-id-type="doi">10.1038/nprot.2012.016</pub-id><!--<pub-id pub-id-type="pmcid">3334321</pub-id>--><?supplied-pmid 22383036?><pub-id pub-id-type="pmid">22383036</pub-id></mixed-citation>
    </ref>
    <ref id="ref-4">
      <label>4</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>B</given-names></name><name><surname>Dewey</surname><given-names>CN</given-names></name></person-group>:
<article-title>RSEM: accurate transcript quantification from RNA-Seq data with or without a reference genome.</article-title><source><italic>BMC Bioinformatics.</italic></source><year>2011</year>;<volume>12</volume>:<fpage>323</fpage>.
<pub-id pub-id-type="doi">10.1186/1471-2105-12-323</pub-id><!--<pub-id pub-id-type="pmcid">3163565</pub-id>--><?supplied-pmid 21816040?><pub-id pub-id-type="pmid">21816040</pub-id></mixed-citation>
    </ref>
    <ref id="ref-5">
      <label>5</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Glaus</surname><given-names>P</given-names></name><name><surname>Honkela</surname><given-names>A</given-names></name><name><surname>Rattray</surname><given-names>M</given-names></name></person-group>:
<article-title>Identifying differentially expressed transcripts from RNA-seq data with biological variation.</article-title><source><italic>Bioinformatics.</italic></source><year>2012</year>;<volume>28</volume>(<issue>13</issue>):<fpage>1721</fpage>–<lpage>1728</lpage>.
<pub-id pub-id-type="doi">10.1093/bioinformatics/bts260</pub-id><!--<pub-id pub-id-type="pmcid">3381971</pub-id>--><?supplied-pmid 22563066?><pub-id pub-id-type="pmid">22563066</pub-id></mixed-citation>
    </ref>
    <ref id="ref-6">
      <label>6</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bray</surname><given-names>N</given-names></name><name><surname>Pimentel</surname><given-names>H</given-names></name><name><surname>Melsted</surname><given-names>P</given-names></name><etal/></person-group>:
<article-title>Near-optimal RNA-Seq quantification.</article-title><source><italic>arXiv:1505.02710</italic>.
</source><year>2015</year><ext-link ext-link-type="uri" xlink:href="http://arxiv.org/ftp/arxiv/papers/1505/1505.02710.pdf">Reference Source</ext-link></mixed-citation>
    </ref>
    <ref id="ref-7">
      <label>7</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Patro</surname><given-names>R</given-names></name><name><surname>Duggal</surname><given-names>G</given-names></name><name><surname>Kingsford</surname><given-names>C</given-names></name></person-group>:
<article-title>Accurate, fast, and model-aware transcript expression quantification with Salmon.</article-title><source><italic>bioRxiv.</italic></source><year>2015</year><pub-id pub-id-type="doi">10.1101/021592</pub-id></mixed-citation>
    </ref>
    <ref id="ref-8">
      <label>8</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mortazavi</surname><given-names>A</given-names></name><name><surname>Williams</surname><given-names>BA</given-names></name><name><surname>McCue</surname><given-names>K</given-names></name><etal/></person-group>:
<article-title>Mapping and quantifying mammalian transcriptomes by RNA-Seq.</article-title><source><italic>Nat Methods.</italic></source><year>2008</year>;<volume>5</volume>(<issue>7</issue>):<fpage>621</fpage>–<lpage>628</lpage>.
<pub-id pub-id-type="doi">10.1038/nmeth.1226</pub-id><?supplied-pmid 18516045?><pub-id pub-id-type="pmid">18516045</pub-id></mixed-citation>
    </ref>
    <ref id="ref-9">
      <label>9</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Trapnell</surname><given-names>C</given-names></name><name><surname>Williams</surname><given-names>BA</given-names></name><name><surname>Pertea</surname><given-names>G</given-names></name><etal/></person-group>:
<article-title>Transcript assembly and quantification by RNA-Seq reveals unannotated transcripts and isoform switching during cell differentiation.</article-title><source><italic>Nat Biotechnol.</italic></source><year>2010</year>;<volume>28</volume>(<issue>5</issue>):<fpage>511</fpage>–<lpage>515</lpage>.
<pub-id pub-id-type="doi">10.1038/nbt.1621</pub-id><!--<pub-id pub-id-type="pmcid">3146043</pub-id>--><?supplied-pmid 20436464?><pub-id pub-id-type="pmid">20436464</pub-id></mixed-citation>
    </ref>
    <ref id="ref-10">
      <label>10</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wagner</surname><given-names>GP</given-names></name><name><surname>Kin</surname><given-names>K</given-names></name><name><surname>Lynch</surname><given-names>VJ</given-names></name></person-group>:
<article-title>Measurement of mRNA abundance using RNA-seq data: RPKM measure is inconsistent among samples.</article-title><source><italic>Theory Biosci.</italic></source><year>2012</year>;<volume>131</volume>(<issue>4</issue>):<fpage>281</fpage>–<lpage>285</lpage>.
<pub-id pub-id-type="doi">10.1007/s12064-012-0162-3</pub-id><?supplied-pmid 22872506?><pub-id pub-id-type="pmid">22872506</pub-id></mixed-citation>
    </ref>
    <ref id="ref-11">
      <label>11</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Love</surname><given-names>MI</given-names></name><name><surname>Huber</surname><given-names>W</given-names></name><name><surname>Anders</surname><given-names>S</given-names></name></person-group>:
<article-title>Moderated estimation of fold change and dispersion for RNA-seq data with DESeq2.</article-title><source><italic>Genome Biol.</italic></source><year>2014</year>;<volume>15</volume>(<issue>12</issue>):<fpage>550</fpage>.
<pub-id pub-id-type="doi">10.1186/s13059-014-0550-8</pub-id><!--<pub-id pub-id-type="pmcid">4302049</pub-id>--><?supplied-pmid 25516281?><pub-id pub-id-type="pmid">25516281</pub-id></mixed-citation>
    </ref>
    <ref id="ref-12">
      <label>12</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Robinson</surname><given-names>MD</given-names></name><name><surname>McCarthy</surname><given-names>DJ</given-names></name><name><surname>Smyth</surname><given-names>GK</given-names></name></person-group>:
<article-title>edgeR: a Bioconductor package for differential expression analysis of digital gene expression data.</article-title><source><italic>Bioinformatics.</italic></source><year>2010</year>;<volume>26</volume>(<issue>1</issue>):<fpage>139</fpage>–<lpage>40</lpage>.
<pub-id pub-id-type="doi">10.1093/bioinformatics/btp616</pub-id><!--<pub-id pub-id-type="pmcid">2796818</pub-id>--><?supplied-pmid 19910308?><pub-id pub-id-type="pmid">19910308</pub-id></mixed-citation>
    </ref>
    <ref id="ref-13">
      <label>13</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ritchie</surname><given-names>ME</given-names></name><name><surname>Phipson</surname><given-names>B</given-names></name><name><surname>Wu</surname><given-names>D</given-names></name><etal/></person-group>:
<article-title><italic>limma</italic> powers differential expression analyses for RNA-sequencing and microarray studies.</article-title><source><italic>Nucleic Acids Res.</italic></source><year>2015</year>;<volume>43</volume>(<issue>7</issue>):<fpage>e47</fpage>.
<pub-id pub-id-type="doi">10.1093/nar/gkv007</pub-id><!--<pub-id pub-id-type="pmcid">4402510</pub-id>--><?supplied-pmid 25605792?><pub-id pub-id-type="pmid">25605792</pub-id></mixed-citation>
    </ref>
    <ref id="ref-14">
      <label>14</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bottomly</surname><given-names>D</given-names></name><name><surname>Walter</surname><given-names>NA</given-names></name><name><surname>Hunter</surname><given-names>JE</given-names></name><etal/></person-group>:
<article-title>Evaluating gene expression in C57BL/6J and DBA/2J mouse striatum using RNA-Seq and microarrays.</article-title><source><italic>PLoS One.</italic></source><year>2011</year>;<volume>6</volume>(<issue>3</issue>):<fpage>e17820</fpage>.
<pub-id pub-id-type="doi">10.1371/journal.pone.0017820</pub-id><!--<pub-id pub-id-type="pmcid">3063777</pub-id>--><?supplied-pmid 21455293?><pub-id pub-id-type="pmid">21455293</pub-id></mixed-citation>
    </ref>
    <ref id="ref-15">
      <label>15</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yang</surname><given-names>S</given-names></name><name><surname>Marín-Juez</surname><given-names>R</given-names></name><name><surname>Meijer</surname><given-names>AH</given-names></name><etal/></person-group>:
<article-title>Common and specific downstream signaling targets controlled by Tlr2 and Tlr5 innate immune signaling in zebrafish.</article-title><source><italic>BMC Genomics.</italic></source><year>2015</year>;<volume>16</volume>(<issue>1</issue>):<fpage>547</fpage>.
<pub-id pub-id-type="doi">10.1186/s12864-015-1740-9</pub-id><!--<pub-id pub-id-type="pmcid">4514945</pub-id>--><?supplied-pmid 26208853?><pub-id pub-id-type="pmid">26208853</pub-id></mixed-citation>
    </ref>
    <ref id="ref-16">
      <label>16</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Currais</surname><given-names>A</given-names></name><name><surname>Goldberg</surname><given-names>J</given-names></name><name><surname>Farrokhi</surname><given-names>C</given-names></name><etal/></person-group>:
<article-title>A comprehensive multiomics approach toward understanding the relationship between aging and dementia.</article-title><source><italic>Aging (Albany NY).</italic></source><year>2015</year>;<volume>7</volume>(<issue>11</issue>):<fpage>937</fpage>–<lpage>955</lpage>.
<!--<pub-id pub-id-type="pmcid">4694064</pub-id>--><?supplied-pmid 26564964?><pub-id pub-id-type="pmid">26564964</pub-id></mixed-citation>
    </ref>
    <ref id="ref-17">
      <label>17</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chang</surname><given-names>AJ</given-names></name><name><surname>Ortega</surname><given-names>FE</given-names></name><name><surname>Riegler</surname><given-names>J</given-names></name><etal/></person-group>:
<article-title>Oxygen regulation of breathing through an olfactory receptor activated by lactate.</article-title><source><italic>Nature.</italic></source><year>2015</year>;<volume>527</volume>(<issue>7577</issue>):<fpage>240</fpage>–<lpage>244</lpage>.
<pub-id pub-id-type="doi">10.1038/nature15721</pub-id><?supplied-pmid 26560302?><pub-id pub-id-type="pmid">26560302</pub-id></mixed-citation>
    </ref>
    <ref id="ref-18">
      <label>18</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Soneson</surname><given-names>C</given-names></name><name><surname>Matthes</surname><given-names>KL</given-names></name><name><surname>Nowicka</surname><given-names>M</given-names></name><etal/></person-group>:
<article-title>Differential transcript usage from RNA-seq data: isoform pre-filtering improves performance of count-based methods.</article-title><source><italic>bioRxiv.</italic></source><year>2015</year><pub-id pub-id-type="doi">10.1101/025387</pub-id></mixed-citation>
    </ref>
    <ref id="ref-19">
      <label>19</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kanitz</surname><given-names>A</given-names></name><name><surname>Gypas</surname><given-names>F</given-names></name><name><surname>Gruber</surname><given-names>AJ</given-names></name><etal/></person-group>:
<article-title>Comparative assessment of methods for the computational inference of transcript isoform abundance from RNA-seq data.</article-title><source><italic>Genome Biol.</italic></source><year>2015</year>;<volume>16</volume>(<issue>1</issue>):<fpage>150</fpage>.
<pub-id pub-id-type="doi">10.1186/s13059-015-0702-5</pub-id><!--<pub-id pub-id-type="pmcid">4511015</pub-id>--><?supplied-pmid 26201343?><pub-id pub-id-type="pmid">26201343</pub-id></mixed-citation>
    </ref>
    <ref id="ref-20">
      <label>20</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Roberts</surname><given-names>A</given-names></name><name><surname>Trapnell</surname><given-names>C</given-names></name><name><surname>Donaghey</surname><given-names>J</given-names></name><etal/></person-group>:
<article-title>Improving RNA-Seq expression estimates by correcting for fragment bias.</article-title><source><italic>Genome Biol.</italic></source><year>2011</year>;<volume>12</volume>(<issue>3</issue>):<fpage>R22</fpage>.
<pub-id pub-id-type="doi">10.1186/gb-2011-12-3-r22</pub-id><!--<pub-id pub-id-type="pmcid">3129672</pub-id>--><?supplied-pmid 21410973?><pub-id pub-id-type="pmid">21410973</pub-id></mixed-citation>
    </ref>
    <ref id="ref-21">
      <label>21</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Robert</surname><given-names>C</given-names></name><name><surname>Watson</surname><given-names>M</given-names></name></person-group>:
<article-title>Errors in RNA-Seq quantification affect genes of relevance to human disease.</article-title><source><italic>Genome Biol.</italic></source><year>2015</year>;<volume>16</volume>(<issue>1</issue>):<fpage>177</fpage>.
<pub-id pub-id-type="doi">10.1186/s13059-015-0734-x</pub-id><!--<pub-id pub-id-type="pmcid">4558956</pub-id>--><?supplied-pmid 26335491?><pub-id pub-id-type="pmid">26335491</pub-id></mixed-citation>
    </ref>
    <ref id="ref-22">
      <label>22</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Anders</surname><given-names>S</given-names></name><name><surname>Reyes</surname><given-names>A</given-names></name><name><surname>Huber</surname><given-names>W</given-names></name></person-group>:
<article-title>Detecting differential usage of exons from RNA-seq data.</article-title><source><italic>Genome Res.</italic></source><year>2012</year>;<volume>22</volume>(<issue>10</issue>):<fpage>2008</fpage>–<lpage>17</lpage>.
<pub-id pub-id-type="doi">10.1101/gr.133744.111</pub-id><!--<pub-id pub-id-type="pmcid">3460195</pub-id>--><?supplied-pmid 22722343?><pub-id pub-id-type="pmid">22722343</pub-id></mixed-citation>
    </ref>
    <ref id="ref-23">
      <label>23</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lawrence</surname><given-names>M</given-names></name><name><surname>Huber</surname><given-names>W</given-names></name><name><surname>Pagès</surname><given-names>H</given-names></name><etal/></person-group>:
<article-title>Software for computing and annotating genomic ranges.</article-title><source><italic>PLoS Comput Biol.</italic></source><year>2013</year>;<volume>9</volume>(<issue>8</issue>):<fpage>e1003118</fpage>.
<pub-id pub-id-type="doi">10.1371/journal.pcbi.1003118</pub-id><!--<pub-id pub-id-type="pmcid">3738458</pub-id>--><?supplied-pmid 23950696?><pub-id pub-id-type="pmid">23950696</pub-id></mixed-citation>
    </ref>
    <ref id="ref-24">
      <label>24</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Trapnell</surname><given-names>C</given-names></name><name><surname>Hendrickson</surname><given-names>DG</given-names></name><name><surname>Sauvageau</surname><given-names>M</given-names></name><etal/></person-group>:
<article-title>Differential analysis of gene regulation at transcript resolution with RNA-seq.</article-title><source><italic>Nat Biotechnol.</italic></source><year>2013</year>;<volume>31</volume>(<issue>1</issue>):<fpage>46</fpage>–<lpage>53</lpage>.
<pub-id pub-id-type="doi">10.1038/nbt.2450</pub-id><!--<pub-id pub-id-type="pmcid">3869392</pub-id>--><?supplied-pmid 23222703?><pub-id pub-id-type="pmid">23222703</pub-id></mixed-citation>
    </ref>
    <ref id="ref-25">
      <label>25</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhao</surname><given-names>S</given-names></name><name><surname>Xi</surname><given-names>L</given-names></name><name><surname>Zhang</surname><given-names>B</given-names></name></person-group>:
<article-title>Union Exon Based Approach for RNA-Seq Gene Quantification: To Be or Not to Be?</article-title><source><italic>PLoS One.</italic></source><year>2015</year>;<volume>10</volume>(<issue>11</issue>):<fpage>e0141910</fpage>.
<pub-id pub-id-type="doi">10.1371/journal.pone.0141910</pub-id><!--<pub-id pub-id-type="pmcid">4641603</pub-id>--><?supplied-pmid 26559532?><pub-id pub-id-type="pmid">26559532</pub-id></mixed-citation>
    </ref>
    <ref id="ref-26">
      <label>26</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gonzàlez-Porta</surname><given-names>M</given-names></name><name><surname>Frankish</surname><given-names>A</given-names></name><name><surname>Rung</surname><given-names>J</given-names></name><etal/></person-group>:
<article-title>Transcriptome analysis of human tissues and cell lines reveals one dominant transcript per gene.</article-title><source><italic>Genome Biol.</italic></source><year>2013</year>;<volume>14</volume>(<issue>7</issue>):<fpage>R70</fpage>.
<pub-id pub-id-type="doi">10.1186/gb-2013-14-7-r70</pub-id><!--<pub-id pub-id-type="pmcid">4053754</pub-id>--><?supplied-pmid 23815980?><pub-id pub-id-type="pmid">23815980</pub-id></mixed-citation>
    </ref>
    <ref id="ref-27">
      <label>27</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jia</surname><given-names>C</given-names></name><name><surname>Guan</surname><given-names>W</given-names></name><name><surname>Yang</surname><given-names>A</given-names></name><etal/></person-group>:
<article-title>MetaDiff: differential isoform expression analysis using random-effects meta-regression.</article-title><source><italic>BMC Bioinformatics.</italic></source><year>2015</year>;<volume>16</volume>(<issue>1</issue>):<fpage>208</fpage>.
<pub-id pub-id-type="doi">10.1186/s12859-015-0623-z</pub-id><!--<pub-id pub-id-type="pmcid">4489045</pub-id>--><?supplied-pmid 26134005?><pub-id pub-id-type="pmid">26134005</pub-id></mixed-citation>
    </ref>
    <ref id="ref-28">
      <label>28</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Love</surname><given-names>MI</given-names></name><name><surname>Hogenesch</surname><given-names>JB</given-names></name><name><surname>Irizarry</surname><given-names>RA</given-names></name></person-group>:
<article-title>Modeling of RNA-seq fragment sequence bias reduces systematic errors in transcript abundance estimation.</article-title><source><italic>bioRxiv.</italic></source><year>2015</year><pub-id pub-id-type="doi">10.1101/025767</pub-id></mixed-citation>
    </ref>
    <ref id="ref-29">
      <label>29</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Antonarakis</surname><given-names>ES</given-names></name><name><surname>Lu</surname><given-names>C</given-names></name><name><surname>Wang</surname><given-names>H</given-names></name><etal/></person-group>:
<article-title>AR-V7 and resistance to enzalutamide and abiraterone in prostate cancer.</article-title><source><italic>N Engl J Med.</italic></source><year>2014</year>;<volume>371</volume>(<issue>11</issue>):<fpage>1028</fpage>–<lpage>38</lpage>.
<pub-id pub-id-type="doi">10.1056/NEJMoa1315815</pub-id><!--<pub-id pub-id-type="pmcid">4201502</pub-id>--><?supplied-pmid 25184630?><pub-id pub-id-type="pmid">25184630</pub-id></mixed-citation>
    </ref>
    <ref id="ref-30">
      <label>30</label>
      <mixed-citation publication-type="data"><person-group person-group-type="author"><name><surname>Soneson</surname><given-names>C</given-names></name><name><surname>Love</surname><given-names>MI</given-names></name><name><surname>Robinson</surname><given-names>MD</given-names></name></person-group>:
<article-title>Data set 1 in: Differential analyses for RNA-seq: transcript-level estimates improve gene-level inferences.</article-title><source><italic>F1000Research.</italic></source><year>2016</year><ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.5256/f1000research.7563.d114722">Data Source</ext-link></mixed-citation>
    </ref>
    <ref id="ref-31">
      <label>31</label>
      <mixed-citation publication-type="data"><person-group person-group-type="author"><name><surname>Soneson</surname><given-names>C</given-names></name><name><surname>Love</surname><given-names>MI</given-names></name><name><surname>Robinson</surname><given-names>MD</given-names></name></person-group>:
<article-title>Data set 2 in: Differential analyses for RNA-seq: transcript-level estimates improve gene-level inferences.</article-title><source><italic>F1000Research.</italic></source><year>2016</year><ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.5256/f1000research.7563.d114723">Data Source</ext-link></mixed-citation>
    </ref>
    <ref id="ref-32">
      <label>32</label>
      <mixed-citation publication-type="data"><person-group person-group-type="author"><name><surname>Soneson</surname><given-names>C</given-names></name><name><surname>Love</surname><given-names>MI</given-names></name><name><surname>Robinson</surname><given-names>MD</given-names></name></person-group>:
<article-title>Data set 3 in: Differential analyses for RNA-seq: transcript-level estimates improve gene-level inferences.</article-title><source><italic>F1000Research.</italic></source><year>2016</year><ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.5256/f1000research.7563.d114724">Data Source</ext-link></mixed-citation>
    </ref>
    <ref id="ref-33">
      <label>33</label>
      <mixed-citation publication-type="data"><person-group person-group-type="author"><name><surname>Soneson</surname><given-names>C</given-names></name><name><surname>Love</surname><given-names>MI</given-names></name><name><surname>Robinson</surname><given-names>MD</given-names></name></person-group>:
<article-title>Data set 4 in: Differential analyses for RNA-seq: transcript-level estimates improve gene-level inferences.</article-title><source><italic>F1000Research.</italic></source><year>2016</year><ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.5256/f1000research.7563.d114725">Data Source</ext-link></mixed-citation>
    </ref>
    <ref id="ref-34">
      <label>34</label>
      <mixed-citation publication-type="data"><person-group person-group-type="author"><name><surname>Soneson</surname><given-names>C</given-names></name><name><surname>Love</surname><given-names>MI</given-names></name><name><surname>Robinson</surname><given-names>MD</given-names></name></person-group>:
<article-title>Data set 5 in: Differential analyses for RNA-seq: transcript-level estimates improve gene-level inferences.</article-title><source><italic>F1000Research.</italic></source><year>2016</year><ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.5256/f1000research.7563.d114726">Data Source</ext-link></mixed-citation>
    </ref>
    <ref id="ref-35">
      <label>35</label>
      <mixed-citation publication-type="data"><person-group person-group-type="author"><name><surname>Soneson</surname><given-names>C</given-names></name><name><surname>Love</surname><given-names>MI</given-names></name><name><surname>Robinson</surname><given-names>MD</given-names></name></person-group>:
<article-title>Data set 6 in: Differential analyses for RNA-seq: transcript-level estimates improve gene-level inferences.</article-title><source><italic>F1000Research.</italic></source><year>2016</year><ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.5256/f1000research.7563.d114730">Data Source</ext-link></mixed-citation>
    </ref>
  </ref-list>
</back>
<sub-article id="report11745" article-type="peer-review">
  <front-stub>
    <article-id pub-id-type="doi">10.5256/f1000research.8143.r11745</article-id>
    <title-group>
      <article-title>Referee response for version 1</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Patro</surname>
          <given-names>Rob</given-names>
        </name>
        <xref ref-type="aff" rid="r11745a1">1</xref>
        <role>Referee</role>
      </contrib>
      <aff id="r11745a1"><label>1</label>Department of Computer Science, Stony Brook University, Stony Brook, NY, USA</aff>
    </contrib-group>
    <author-notes>
      <fn fn-type="COI-statement">
        <p><bold>Competing interests: </bold>No competing interests were disclosed.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="epub">
      <day>12</day>
      <month>1</month>
      <year>2016</year>
    </pub-date>
    <related-article id="d35e3109" related-article-type="peer-reviewed-article" ext-link-type="doi" xlink:href="10.12688/f1000research.7563.1">Version 1</related-article>
    <custom-meta-group>
      <custom-meta>
        <meta-name>recommendation</meta-name>
        <meta-value>approve</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>In this manuscript, the authors address a few questions of considerable (and perennial) interest in the analysis of RNA-seq data. Specifically, they provide evidence that, using available methods (e.g. DESeq2 / edgeR), assessing differential expression at the gene-level (DGE) is more robust than at the transcript level (DTE). Further, they convincingly argue that estimating abundance at the level of transcripts, and then aggregating these abundances to the gene level leads to improved estimation of differential gene expression. They demonstrate that one of the major factors in this improved estimation is the availability of a sample-specific feature length for each gene (derived from the abundance-weighted length of the expressed transcripts of this gene), which is not possible to obtain with any fixed gene model used by count-based methods. Finally, the authors argue that much of the analysis of interest at the transcript level does not actually require differential transcript expression testing, but rather can be inferred from a combination of DGE and differential transcript usage (DTU); this is an interesting proposition that merits further discussion and analysis. Overall, this is a well-written paper, with extensive and compelling supplementary and supporting data, that addresses a ubiquitous analysis task involving RNA-seq.  It should be of broad interest to the community and makes a valuable contribution. The accompanying software,
<italic>tximport</italic>, is user-friendly and makes it easy to apply the type of analysis recommended herein; it too should be widely useful.</p>
    <p>
      <bold>
        <underline>Major comments:</underline>
      </bold>
    </p>
    <p>It would be very useful to provide the equations used for calculating each of the abundance measured considered directly. Section 4 of the supplementary information is useful to this end, but the reader still has to search a bit to see exactly how each metric is computed (though the fantastic R-Markdown included with the figures means that these computations can be found explicitly).</p>
    <p>Similarly, it would be useful to the reader to provide a description, in prose, of how specific experiments were performed (again, the reproducible nature of most of these experiments makes tracking down this information possible, but sometimes time-consuming). For example, how, precisely, was removal of transcripts handled at the level of the genome annotation? If a transcript consists only of constitutive exons, were all of those exons retained in the genome annotation used for STAR + featureCounts, while the transcript was removed in the Salmon index?  </p>
    <p>The result that transcript-level abundance estimation is more sensitive to the removal of transcripts than gene-level abundance estimation — this seems intuitive. However, I agree with Dr. Floor’s suggestion that:</p>
    <p>
      <italic>"The assertion that “simple counts tended to show a high degree of robustness against incompleteness of the annotation catalog, as evidenced from estimation errors after first removing (at random) 20% of the transcripts” seems misleading since Salmon-derived gene-level abundances actually show a higher Spearman correlation than count-derived gene-level abundances when subjected to removing a random 20% of transcripts.”</italic>
    </p>
    <p>I would suggest rewording this sentence, as the main result seems to be that gene-level analysis is more robust to an incomplete annotation than transcript-level analysis. Transcript-level abundance estimation followed by gene-level analysis seems to perform just as well (actually, better) than gene-level counting in this scenario.</p>
    <p>The experiments in the section “Incorporating transcript-level estimates leads to more accurate DGE results” suggests the (reasonable) interpretation that the main benefit of incorporating transcript-level abundance estimates when assessing DGE is a more accurate measure of the “feature” length of the gene. The authors state “ It is important to note that this improvement is entirely attributable to an improved handling of genes with changes in isoform composition between the conditions.” This is supported by the fact that using the abundance-weighted average transcript length (i.e. offsets) with counting based approaches improves the results substantially.  However, one other place where transcript-level abundance estimates are useful in the context of DGE is when assessing the expression of paralogous genes. While most multi-mapping reads that derive from different isoforms of the same gene will be uniquely mappable at the level of the genome, and hence will be included in the counts for that gene, reads that map ambiguously among paralogs may not be. In such cases, count-based methods do not have a principled way of apportioning a read between the paralogs involved, and discarding multi-mapping reads may negatively affect estimation of the abundance of the paralogs, even at the gene level. While this case is likely much less common than mis-estimation of DGE as a result of DTU, it is certainly of biological interest. I would suggest adding an analysis, restricted to sets of paralogous genes, comparing how the different approaches perform in this case. This may help to highlight the importance of not only deriving appropriately weighted and sample-dependent lengths for genes, but also on resolving multi-mapping ambiguity that occurs between genomically distinct loci.</p>
    <p>The argument that most transcript-level analyses of interest may be addressed by looking at DGE in conjunction with DTU is an interesting one. It is certainly that case that not all tasks for which DTE is used actually require assessing differential expression at the transcript level. One issue with the DGE + DTU-based analysis which warrants further discussion in the manuscript is that I believe that this approach, too, would require correcting for multiple hypothesis testing. Specifically, one is testing both the DGE and the DTU hypotheses for each gene (or for a relevant subset of interest). The correction here is likely to be less harsh than in the case of assessing DTE, but is still worth discussing.</p>
    <p>Minor comments:</p>
    <p>As per Dr. Floor’s statement, Salmon (and Sailfish) also incorporate sequence-specific bias correction. Further, RSEM and Salmon (and a few other transcript-level abundance estimation tools) also incorporate the modeling of non-uniform fragment start position distributions. Of course, modeling a non-uniform start position distribution cannot overcome a complete lack of sampling in critical regions that might make determining transcript-level fragment assignment impossible, but it may help in properly apportioning an ambiguously-mapped fragment between transcripts depending on its relative position in each.</p>
    <p>One potential added source of variability here is that all Salmon estimates presented in the manuscript make use of Salmon’s quasi-mapping of reads, while the STAR + featureCount pipeline makes use of “traditional” alignments. This is the primary intended usage mode of Salmon, and absolutely does represent a “typical” pipeline for methods that avoid alignment (Salmon, Sailfish, kallisto). However, it would probably be best to mention this as a potential (though likely negligible) additional source of variability.</p>
    <p>In the discussion, the authors argue that “... it is therefore imperative to continue improving abundance estimation and inference methods applicable to individual transcripts, since misestimation can propagate to the gene level.” This is, of course, an important and valid suggestion. Another direction, on which it would be useful to get the authors’ thoughts and suggestions, is the development of differential expression tools (at either the transcript or gene level) that can make use of the variance estimates that some tools (like Salmon) can provide. To what extent might incorporating this information help control false positive rates and improve DTE or even DGE estimates?</p>
    <p>I have read this submission. I believe that I have an appropriate level of expertise to confirm that it is of an acceptable scientific standard.</p>
  </body>
  <sub-article id="comment1820" article-type="response">
    <front-stub>
      <contrib-group>
        <contrib contrib-type="author">
          <name>
            <surname>Robinson</surname>
            <given-names>Mark</given-names>
          </name>
          <aff>University of Zurich, Switzerland</aff>
        </contrib>
      </contrib-group>
      <author-notes>
        <fn fn-type="COI-statement">
          <p><bold>Competing interests: </bold>No competing interests were disclosed.</p>
        </fn>
      </author-notes>
      <pub-date pub-type="epub">
        <day>19</day>
        <month>2</month>
        <year>2016</year>
      </pub-date>
    </front-stub>
    <body>
      <p>Thank you for taking the time to read and review our paper. As per your suggestions, we have expanded the supplementary pdf document with equations defining each of the abundance measures that we used as well as a detailed description of the generation of the incomplete annotation files. We have also reworded the paragraph discussing the influence of an incomplete annotation catalog, and added further discussion points regarding multiple testing correction for DGE+DTU as well as regarding new methods incorporating variance estimates into the differential analysis. However, a deeper discussion of the latter point falls outside the scope of this article.</p>
      <p>We found your suggestion to restrict the abundance accuracy comparison to paralogous genes interesting, and the supplement has been expanded with several examples comparing the accuracy of gene-level abundance estimates from Salmon and from STAR+featureCounts, restricted to sets of paralogous genes. While we see a clear advantage of Salmon for many of the paralogous gene groups, the overall difference is only slightly larger for sets of paralogous genes compared to random sets of genes (as can be seen in the revised version of Dataset 1). In addition, we have added the following text to the relevant section in the results:</p>
      <p>“...suggesting that the extent of the problem in many real data sets is limited... though some loss of sensitivity for certain genes may be encountered from discarding multi-mapping fragments, which may be recovered through the use of transcript abundance estimators such as Salmon.”</p>
      <p>While we acknowledge that many of the popular transcript abundance estimation methods incorporate some type of bias estimation/correction (albeit not at the fragment level), and that it is definitely an important (and difficult) research area, a thorough discussion on the relative merits of different bias correction approaches is outside the scope of this paper. We have added citations to relevant literature on coverage bias, have simplified and clarified the last paragraph of the discussion, and have reworded the sentence about unidentifiable estimation due to coverage biases:</p>
      <p>“While some extent of coverage variability might be alleviated by corrections for sequence- or position-specific biases, there remain cases where transcript expression cannot be inferred from data ( Figure 1C)”</p>
    </body>
  </sub-article>
</sub-article>
<sub-article id="report11761" article-type="peer-review">
  <front-stub>
    <article-id pub-id-type="doi">10.5256/f1000research.8143.r11761</article-id>
    <title-group>
      <article-title>Referee response for version 1</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Floor</surname>
          <given-names>Stephen N.</given-names>
        </name>
        <xref ref-type="aff" rid="r11761a1">1</xref>
        <role>Referee</role>
      </contrib>
      <aff id="r11761a1"><label>1</label>Department of Molecular and Cell Biology, University of California, Berkeley, Berkeley, CA, USA</aff>
    </contrib-group>
    <author-notes>
      <fn fn-type="COI-statement">
        <p><bold>Competing interests: </bold>No competing interests were disclosed.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="epub">
      <day>4</day>
      <month>1</month>
      <year>2016</year>
    </pub-date>
    <related-article id="d35e3229" related-article-type="peer-reviewed-article" ext-link-type="doi" xlink:href="10.12688/f1000research.7563.1">Version 1</related-article>
    <custom-meta-group>
      <custom-meta>
        <meta-name>recommendation</meta-name>
        <meta-value>approve</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>Soneson, Love and Robinson tackle a crucial question for analysis of RNA deep sequencing data in this manuscript: what is the role of transcript diversity in the accuracy and statistical power associated with measurements of gene expression? The authors make and convincingly show three claims: gene-level estimation and inferences are more robust than those at the transcript-level, and incorporating transcript-level quantification into gene-level abundance leads to improved differential expression testing.  The claims are convincingly proven, the manuscript is well written, and the subject matter is of considerable interest. Furthermore, the described R package
<italic>tximport </italic>should be of broad interest to the RNA deep sequencing community.</p>
    <p>Overall comments:</p>
    <p>It may be useful to indicate explicitly in the text that the methods are contained within the (excellently written and formatted) supplementary material, as this was not apparent. It might be clearest to create a specific methods section that just references supplementary file 1.</p>
    <p>The clarity of scatter plots with more than ~hundreds of points (e.g. Figure 1A) could be improved by using partially transparent points to visualize density.</p>
    <p>Introduction:</p>
    <p>Paragraph 1: Cufflinks, RSEM and Bitseq are grouped with kallisto and Salmon and it is then stated that some of these methods bypass read alignment. It would be clearer if this were reworded to avoid the ambiguity as to which methods avoid read alignment.</p>
    <p>Paragraph 4: The third claim could be presented more clearly. While it is interesting that simple counting performs similarly to transcript-level quantification procedures, it seems more interesting to this reviewer that incorporating transcript-level information improves the accuracy of differential expression testing at the gene level. Perhaps these two concepts can be combined into one more concise point?</p>
    <p>Results:</p>
    <p>The assertion that “simple counts tended to show a high degree of robustness against incompleteness of the annotation catalog, as evidenced from estimation errors after first removing (at random) 20% of the transcripts” seems misleading since Salmon-derived gene-level abundances actually show a higher Spearman correlation than count-derived gene-level abundances when subjected to removing a random 20% of transcripts. Figure 1a bottom left shows that transcript-level abundances are strongly affected by removal of 20% of transcripts, but that gene-level abundances are not strongly changed whether estimated using counts or Salmon. This statement should be reworded.</p>
    <p>Two concerns are raised about DTE. It is certainly true that reads are spread across more features when performing DTE as opposed to DGE.However, it is not apparent why analysis of DTE involves grouping of transcripts together for interpretation. DTE implies analysis at the transcript level and therefore no grouping, while DGE could involve some level of grouping of transcripts or quantification at the gene level from the start. The clarity of this could be improved.</p>
    <p>It is a very interesting idea to separately frame questions regarding DGE and DTU, which should be adopted widely, as the two are separable questions.</p>
    <p>The authors state one possible workflow towards DGE analysis in the section “Incorporating transcript-level estimates leads to more accurate DGE results.” Alternative pipelines (e.g. cuffdiff) could be presented in brief.</p>
    <p>The observation that simplesum and featureCounts results are highly correlated and therefore that statistical methods based on the Negative Binomial distribution can be used on estimated counts seems of greater importance than is emphasized in the text. This should be elaborated upon in the discussion, since this means that estimated counts from kallisto, express, salmon, etc can be used directly by statistical packages assuming a NB distribution (edgeR, DESeq2, etc). This point is frequently debated in discussions of how to rigorously analyze sequencing data. The conclusion here that NB applies to estimated counts is thus quite important.</p>
    <p>Please explain the meaning of the name for each curve in the legend for Figure 3 (i.e. specify that “avetxl” means using the offset corresponding to average transcript length.</p>
    <p>Discussion:</p>
    <p>The assertion that “gene-level results are more accurate, powerful and interpretable than transcript-level results” seems an oversimplification given the result that incorporating transcript-level quantification leads to improved DGE detection performance (e.g. Fig 3).</p>
    <p>Please cite at minimum Roberts
<italic>et al.</italic>, (2011) regarding sequence bias correction as this has been implemented in cufflinks, express and kallisto. Other relevant papers should also be included here, as attempts have been made to address both positional and sequence-specific bias in RNA sequencing data.</p>
    <p>Supplement:</p>
    <p>The usability of the supplemental info could be improved by substituting rasterized for vectorized plots for those with ~hundreds of points.</p>
    <p>Please explain the meaning of the name for each curve in the legend for Supplemental Figure 5.</p>
    <p>I have read this submission. I believe that I have an appropriate level of expertise to confirm that it is of an acceptable scientific standard.</p>
  </body>
  <back>
    <ref-list>
      <title>References</title>
      <ref id="rep-ref-11761-1">
        <label>1</label>
        <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Roberts</surname><given-names>A</given-names></name><name><surname>Trapnell</surname><given-names>C</given-names></name><name><surname>Donaghey</surname><given-names>J</given-names></name><name><surname>Rinn</surname><given-names>JL</given-names></name><name><surname>Pachter</surname><given-names>L</given-names></name></person-group>:
<article-title>Improving RNA-Seq expression estimates by correcting for fragment bias.</article-title><source><italic>Genome Biol</italic></source>.<year>2011</year>;<volume>12</volume>(<issue>3</issue>) :
<elocation-id>10.1186/gb-2011-12-3-r22</elocation-id><fpage>R22</fpage><pub-id pub-id-type="doi">10.1186/gb-2011-12-3-r22</pub-id><?supplied-pmid 21410973?><pub-id pub-id-type="pmid">21410973</pub-id></mixed-citation>
      </ref>
    </ref-list>
  </back>
  <sub-article id="comment1821" article-type="response">
    <front-stub>
      <contrib-group>
        <contrib contrib-type="author">
          <name>
            <surname>Robinson</surname>
            <given-names>Mark</given-names>
          </name>
          <aff>University of Zurich, Switzerland</aff>
        </contrib>
      </contrib-group>
      <author-notes>
        <fn fn-type="COI-statement">
          <p><bold>Competing interests: </bold>No competing interests were disclosed.</p>
        </fn>
      </author-notes>
      <pub-date pub-type="epub">
        <day>19</day>
        <month>2</month>
        <year>2016</year>
      </pub-date>
    </front-stub>
    <body>
      <p>Thank you for taking the time to read and review our paper. In the revised version, we have improved the clarity and usability of the figures and the supplement by using partially transparent points and extending the figure captions. We have also modified the main text to refer more clearly to the method information provided in the supplementary material, and improved the clarity of the text in several places, according to your suggestions.</p>
      <p>For additional comments regarding references to bias correction studies, please see responses to Rob Patro.</p>
    </body>
  </sub-article>
</sub-article>
