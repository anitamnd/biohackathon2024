<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6923924</article-id>
    <article-id pub-id-type="publisher-id">3244</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-019-3244-0</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title><italic>DeepShape</italic>: estimating isoform-level ribosome abundance and distribution with Ribo-seq data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Cui</surname>
          <given-names>Hongfei</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Hu</surname>
          <given-names>Hailin</given-names>
        </name>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Zeng</surname>
          <given-names>Jianyang</given-names>
        </name>
        <address>
          <email>zengjy321@tsinghua.edu.cn</email>
        </address>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Chen</surname>
          <given-names>Ting</given-names>
        </name>
        <address>
          <email>tingchen@tsinghua.edu.cn</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 0662 3178</institution-id><institution-id institution-id-type="GRID">grid.12527.33</institution-id><institution>Institute for Artificial Intelligence and Department of Computer Science and Technology, </institution><institution>Tsinghua University, </institution></institution-wrap>Beijing, China </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 0369 0705</institution-id><institution-id institution-id-type="GRID">grid.69775.3a</institution-id><institution>DonLinks School of Economics and Management, </institution><institution>University of Science and Technology Beijing, </institution></institution-wrap>Beijing, China </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 0662 3178</institution-id><institution-id institution-id-type="GRID">grid.12527.33</institution-id><institution>School of Medicine, </institution><institution>Tsinghua University, </institution></institution-wrap>Beijing, China </aff>
      <aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 0662 3178</institution-id><institution-id institution-id-type="GRID">grid.12527.33</institution-id><institution>Institute for Interdisciplinary Information Sciences, </institution><institution>Tsinghua University, </institution></institution-wrap>Beijing, China </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>20</day>
      <month>12</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>20</day>
      <month>12</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2019</year>
    </pub-date>
    <volume>20</volume>
    <issue>Suppl 24</issue>
    <issue-sponsor>Publication of this supplement has not been supported by sponsorship. Information about the source of funding for publication charges can be found in the individual articles. The articles have undergone the journal's standard peer review process for supplements. Supplement editors were not involved in the review process of any of the manuscripts that they co-authored. The Supplement Editors declare that they have no other competing interests.</issue-sponsor>
    <elocation-id>678</elocation-id>
    <permissions>
      <copyright-statement>© The Author(s). 2019</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold>This article is distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">Ribosome profiling brings insight to the process of translation. A basic step in profile construction at transcript level is to map Ribo-seq data to transcripts, and then assign a huge number of multiple-mapped reads to similar isoforms. Existing methods either discard the multiple mapped-reads, or allocate them randomly, or assign them proportionally according to transcript abundance estimated from RNA-seq data.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">Here we present <bold><italic>DeepShape</italic></bold>, an RNA-seq free computational method to estimate ribosome abundance of isoforms, and simultaneously compute their ribosome profiles using a deep learning model. Our simulation results demonstrate that <bold><italic>DeepShape</italic></bold> can provide more accurate estimations on both ribosome abundance and profiles when compared to state-of-the-art methods. We applied <bold><italic>DeepShape</italic></bold> to a set of Ribo-seq data from PC3 human prostate cancer cells with and without PP242 treatment. In the four cell invasion/metastasis genes that are translationally regulated by PP242 treatment, different isoforms show very different characteristics of translational efficiency and regulation patterns. Transcript level ribosome distributions were analyzed by “Codon Residence Index (CRI)” proposed in this study to investigate the relative speed that a ribosome moves on a codon compared to its synonymous codons. We observe consistent CRI patterns in PC3 cells. We found that the translation of several codons could be regulated by PP242 treatment.</p>
      </sec>
      <sec>
        <title>Conclusion</title>
        <p id="Par3">In summary, we demonstrate that <bold><italic>DeepShape</italic></bold> can serve as a powerful tool for Ribo-seq data analysis.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Ribo-seq</kwd>
      <kwd>Translation</kwd>
      <kwd>Transcript-level</kwd>
      <kwd>Multiple alignment</kwd>
    </kwd-group>
    <conference xlink:href="http://icibm2019.org/">
      <conf-name>The International Conference on Intelligent Biology and Medicine (ICIBM) 2019</conf-name>
      <conf-acronym>ICIBM 2019</conf-acronym>
      <conf-loc>Columbia, OH, USA</conf-loc>
      <conf-date>09-11 June 2019</conf-date>
    </conference>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2019</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par13">Regulation of mRNA translation is critical to the coordinated and controlled expression of many important biological pathways, which have great impact on human health states [<xref ref-type="bibr" rid="CR1">1</xref>, <xref ref-type="bibr" rid="CR2">2</xref>]. The ribosome, a complex molecular machine, plays a central role in the translation process [<xref ref-type="bibr" rid="CR3">3</xref>]. A ribosome binding to a transcript implies the synthesis of a new peptide. Multiple factors can influence ribosome binding and also ribosome distribution at transcripts, including composition of nucleotides along its current, upstream, and downstream RNA sequences [<xref ref-type="bibr" rid="CR4">4</xref>, <xref ref-type="bibr" rid="CR5">5</xref>]; instantaneous environmental stress [<xref ref-type="bibr" rid="CR6">6</xref>, <xref ref-type="bibr" rid="CR7">7</xref>]; and state of the cell [<xref ref-type="bibr" rid="CR8">8</xref>]. Therefore, distributions of ribosome binding in a transcriptome reflect underlying translation process, and thus is strongly related to phenotype state.</p>
    <p id="Par14">Ribosome sequencing (Ribo-seq) is an important approach to obtain ribosome distributions by sequencing “ribosome-protected fragments” (RPFs) [<xref ref-type="bibr" rid="CR9">9</xref>]. Computational analysis involves mapping sequencing Ribo-seq reads into transcripts and counting number of reads at each position to obtain distributions of ribosomes along the whole transcriptome. The sites where Ribo-seq reads are piled up suggest ribosome stalling or translation slow-down, which could be caused by factors such as codon usage bias [<xref ref-type="bibr" rid="CR10">10</xref>], codon co-occurrence bias [<xref ref-type="bibr" rid="CR5">5</xref>] and proline codons [<xref ref-type="bibr" rid="CR11">11</xref>]. The stalling events can be related to translation regulation [<xref ref-type="bibr" rid="CR12">12</xref>, <xref ref-type="bibr" rid="CR13">13</xref>]. Besides ribosome stalling, ribosome profiles also reveal unexpected translation events on non-coding regions [<xref ref-type="bibr" rid="CR14">14</xref>]. Overall, ribosome profiling brings insight to the process and regulation of translation.</p>
    <p id="Par15">Computational tools, or pipelines, have been developed for the analysis of Ribo-seq data, including Ribomap [<xref ref-type="bibr" rid="CR15">15</xref>], RiboProfiling [<xref ref-type="bibr" rid="CR16">16</xref>], RiboSeqR [<xref ref-type="bibr" rid="CR17">17</xref>], Plastid [<xref ref-type="bibr" rid="CR18">18</xref>] and Ribogalaxy [<xref ref-type="bibr" rid="CR19">19</xref>]. However, most of these tools were targeted at gene-level ribosome analysis, instead of more informative transcript-level analysis. The challenge is that Ribo-seq reads (~ 30 bp) are too short to be mapped accurately to multiple alternatively spliced transcripts, resulting in a large proportion of multiple mapped reads [<xref ref-type="bibr" rid="CR15">15</xref>]. This has become the main barrier against obtaining precise ribosome profiling at transcript level. A simple strategy is to discard these multiple-mapped reads. However, as Wang et al. show in their study [<xref ref-type="bibr" rid="CR15">15</xref>], there may be less than 10% of all reads can be mapped to unique positions on transcript sequences. Discarding all multiple mapped reads would lose major information in this process. Another strategy is to allocate multiple-mapped reads randomly, as adopted by RiboSeqR [<xref ref-type="bibr" rid="CR17">17</xref>], or the “<italic>star prime</italic>” method evaluated in the work of Wang et al. [<xref ref-type="bibr" rid="CR15">15</xref>], but this may introduce bias to transcripts of low-abundance genes, and in addition, it has been shown that this strategy does not perform well on transcript level analysis [<xref ref-type="bibr" rid="CR15">15</xref>]. A more robust strategy, adopted by Ribomap [<xref ref-type="bibr" rid="CR15">15</xref>], is to take advantage of RNA-seq data generated simultaneously with Ribo-seq and allocate multiple-mapped reads to transcripts according to the transcript abundance estimated from the RNA-seq data. However, this would involve two assumptions: (1) translation activity is coherent to the abundance of mRNA molecules, and (2) that ribosome profiles at regions shared by two different isoforms of a gene are exactly the same. Strictly speaking, for the first assumption, mRNA abundance is not equal to the translating mRNA abundance because some of the mRNAs may be unoccupied by any ribosomes, which is linked to different levels of initiation efficiency [<xref ref-type="bibr" rid="CR9">9</xref>, <xref ref-type="bibr" rid="CR20">20</xref>], and neither is translating mRNA abundance equal to ribosome abundance on them because different translating mRNAs have different elongation velocities which lead to different ribosome densities on them [<xref ref-type="bibr" rid="CR20">20</xref>–<xref ref-type="bibr" rid="CR22">22</xref>]. For the second assumption, as many studies have shown, the upstream and downstream sequence compositions are important and can affect how fast ribosomes move along a transcript [<xref ref-type="bibr" rid="CR4">4</xref>, <xref ref-type="bibr" rid="CR5">5</xref>]. If a frame shift exists between two isoforms because of different upstream exons, their ribosome profiles are most likely to be different. Figure <xref rid="Fig1" ref-type="fig">1</xref> shows an example in which two isoforms, 1 and 2, share the same exon, C, which is connected to different upstream exons, A and B; therefore, we observe different ribosome profiles for these two isoforms, which is not considered by existing methods.
<fig id="Fig1"><label>Fig. 1</label><caption><p>An example of ribosome distribution calculation on two isoforms. There are two isoforms from a gene. With existing methods that allocate multiple-mapped reads proportionally to each transcript, the central part (where reads are completely within the exon, not on the junction) of an exon in two isoforms will have the same ribosome distributions, regardless of ribosome context (e.g., the shaded area in Exon C)</p></caption><graphic xlink:href="12859_2019_3244_Fig1_HTML" id="MO1"/></fig></p>
    <p id="Par16">Another way to analyze ribosome profiles is to predict ribosome distributions according to transcript sequence. Liu and Song developed an effective model, RiboShape, by transforming the ribosome profiles into a low-dimensional space using a wavelet transformation and then building a sparse model to predict the transformed footprint [<xref ref-type="bibr" rid="CR4">4</xref>]. Their predicted profiles are in a low-dimensional space from wavelet transformation, instead of at nucleotide-level resolution. This work inspired us to calculate ribosome distributions for transcripts by combination of allocating Ribo-seq reads to isoforms and predicting ribosome profile from isoform sequence.</p>
    <p id="Par17">Here, we present our model, called <italic>DeepShape</italic>, to analyze Ribo-seq data without the help of RNA-seq data. We introduced a deep learning ribosome distribution shape model to overcome heterogeneity of ribosome profiles by incorporating different upstream or downstream sequences as features to predict ribosome abundance. Multiple-mapped reads are allocated according to both pre-estimated ribosome abundances and distributions. Iteration mechanism was used for more accurate estimation of ribosome abundances and distributions for transcripts. Testing <italic>DeepShape</italic> on synthetic data shows that it can provide more accurate estimation on ribosome abundance and more precise ribosome distribution profiles than state-of-the-art methods. Using <italic>DeepShape</italic>, we analyzed a Ribo-seq dataset of the PC3 human prostate cancer cells [<xref ref-type="bibr" rid="CR23">23</xref>] in transcript level. Isoforms of the four cell invasion/metastasis genes, which were reported to be regulated in translation by PP242 treatment in the original paper, show distinct translational efficiencies and regulation patterns. We proposed “Codon Residence Index” (CRI), which reflects the relative speed when a ribosome going through a codon compared with its synonymous codons. The CRI values between synonymous codons are significant. Several codons show at least 20% slower (higher-CRI) or faster (lower-CRI) in ribosome speed compared with the average of their synonymous codons in all the four experiments. After PP242 treatment, twelve codons represent consistently and statistically significant speed up or slowing down in both replicates. The observations validate the necessity of analyzing Ribo-seq data to produce transcript-level profiles.</p>
  </sec>
  <sec id="Sec2">
    <title>Implementation</title>
    <sec id="Sec3">
      <title>Synthetic data and real data used in this study</title>
      <p id="Par18">In this study, we generated a pair of synthetic Ribo-seq/RNA-seq sequence data to test the performance of our <italic>DeepShape</italic> method and other state-of-the-art methods (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S1). To generate the synthetic Ribo-seq data, firstly we used published RNA-seq data from human HeLa cells (GSM546921) to calculate ground-truth transcript abundance. The transcript abundances are length-normalized, which is defined as
<disp-formula id="Equa"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {t}_i=\frac{c_{ti}/{l}_{ti}}{\sum_{k\in \mathbf{T}}\left({c}_{tk}/{l}_{tk}\right)}\times {10}^6, $$\end{document}</tex-math><mml:math id="M2" display="block"><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mi mathvariant="italic">ti</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mi>l</mml:mi><mml:mi mathvariant="italic">ti</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="bold">T</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mi mathvariant="italic">tk</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mi>l</mml:mi><mml:mi mathvariant="italic">tk</mml:mi></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mfrac><mml:mo>×</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>6</mml:mn></mml:msup><mml:mo>,</mml:mo></mml:math><graphic xlink:href="12859_2019_3244_Article_Equa.gif" position="anchor"/></alternatives></disp-formula>where <italic>c</italic><sub><italic>ti</italic></sub> is the number of RNA-seq reads on transcript <italic>i</italic>, <italic>l</italic><sub><italic>ti</italic></sub> is the length of the <italic>i</italic>-th transcript, and <bold>T</bold> is the set of all transcripts. This index also has a name of “Transcripts Per Million (TPM)”, which is widely used in RNA-seq analysis. Human tRNA and rRNA reads were filtered out before clean reads were mapped to human HG38 transcriptome reference by STAR [<xref ref-type="bibr" rid="CR24">24</xref>] and quantified by Salmon [<xref ref-type="bibr" rid="CR25">25</xref>]. Secondly, we randomly generated a set of synthetic transcript efficiency (TE) values, which is the ratio of relative ribosome abundance over transcript abundance. The ribosome abundance values are normalized by coding region (CDS) length, and is defined as
<disp-formula id="Equb"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {r}_i=\frac{c_{ri}/{l}_{ri}}{\sum_{k\in \mathbf{T}}\left({c}_{rk}/{l}_{rk}\right)}\times {10}^6, $$\end{document}</tex-math><mml:math id="M4" display="block"><mml:msub><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mi mathvariant="italic">ri</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mi>l</mml:mi><mml:mi mathvariant="italic">ri</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="bold">T</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mi mathvariant="italic">rk</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mi>l</mml:mi><mml:mi mathvariant="italic">rk</mml:mi></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mfrac><mml:mo>×</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>6</mml:mn></mml:msup><mml:mo>,</mml:mo></mml:math><graphic xlink:href="12859_2019_3244_Article_Equb.gif" position="anchor"/></alternatives></disp-formula>where <italic>r</italic><sub><italic>i</italic></sub> is the CDS-length normalized abundance, <italic>c</italic><sub><italic>ri</italic></sub> is the number of Ribo-seq reads on transcript <italic>i</italic> (ribosome count abundance), <italic>l</italic><sub><italic>ri</italic></sub> is the length of the coding region of the <italic>i</italic>-th transcript, and <bold>T</bold> is the set of all transcripts. And the TE values are <italic>r</italic><sub><italic>i</italic></sub>/<italic>t</italic><sub><italic>i</italic></sub>. TE values are generated following a log-normal distribution, thereby enabling calculation of Ribo-Seq reads counts. Thirdly, we calculated a synthetic ribosome distribution for every transcript using a ribosome flow model [<xref ref-type="bibr" rid="CR26">26</xref>]. Finally, we generated the synthetic Ribo-Seq reads according to their reads counts, ribosome distribution and reference transcriptome, using the “footprint_generator” program from Ribomap. To generate synthetic RNA-seq data, we applied the rlsim program [<xref ref-type="bibr" rid="CR27">27</xref>] on the TPM obtained above. The synthetic data generation pipeline is a simulation of the real translation and sequencing process.</p>
      <p id="Par19">To show the usefulness of our <italic>DeepShape</italic>, we also reanalyzed a published PC3 human prostate cancer cell dataset [<xref ref-type="bibr" rid="CR23">23</xref>]. The dataset consists of two replicates of PP242-treated samples and two replicates of control samples. Each of these four samples was sequenced to generate Ribo-seq and RNA-seq data. We analyzed the isoform-level translation efficiency and potential translational regulatory events using this dataset. This dataset is called “PC3 dataset” in this study.</p>
      <p id="Par20">The accuracy of the shape model in <italic>DeepShape</italic> was compared to RiboShape, using the same dataset [<xref ref-type="bibr" rid="CR4">4</xref>]. The original Ribo-seq data come from four published datasets of <italic>S. cerevisiae</italic> (yeast) treated with CHX [<xref ref-type="bibr" rid="CR9">9</xref>, <xref ref-type="bibr" rid="CR28">28</xref>, <xref ref-type="bibr" rid="CR29">29</xref>]. Liu et al. (2016) calculated gene-level ribosome distribution using RiboShape. Genes with more than 10 continuous zero-read covered bases were discarded, resulting in 80 genes filtered out and a total of 2458 genes passing quality control. We randomly split the gene set into 3 subsets: 90% genes (2212) for training, 5% genes (124) for validation, and 5% genes (122) for testing. This dataset is called “yeast dataset” in this study. Besides, we also downloaded ribosome distribution data of three other model organisms (<italic>E. coli</italic> [<xref ref-type="bibr" rid="CR30">30</xref>], mouse [<xref ref-type="bibr" rid="CR31">31</xref>] and human [<xref ref-type="bibr" rid="CR32">32</xref>]) from GWIPS (<ext-link ext-link-type="uri" xlink:href="https://gwips.ucc.ie/">https://gwips.ucc.ie/</ext-link>) to test the performance of our shape model. As <italic>E. coli</italic> and yeast do not have alternative splicing, their datasets reflect real ribosome distribution on genes/transcripts. For alternatively spliced transcripts in mouse and human datasets, we simply joined the ribosome values in different exons to generate the ribosome distribution of transcripts.</p>
    </sec>
    <sec id="Sec4">
      <title>Designing of DeepShape-prime and DeepShape</title>
      <p id="Par21">Our method contains two separate programs. The first one is named <italic>DeepShape-prime</italic>, which can be used for fast estimating of ribosome abundances on transcripts without considering the heterogeneity of ribosome profiles from the same exons shared by different isoforms. <italic>DeepShape-Prime</italic> takes CDS-length-normalized ribosome abundance (see Section 2.1) as guidance of allocating multiple-map reads and updates the abundance iteratively.</p>
      <p id="Par22">As shown in Fig. <xref rid="Fig2" ref-type="fig">2</xref>a, initially, CDS-length-normalized ribosome abundance are set uniformly. Then, at each iteration, multiple-mapped reads are allocated proportionally to transcripts according to the current normalized ribosome abundance, and then, new ribosome abundance values are updated using the newest distributions of reads on transcripts.
<fig id="Fig2"><label>Fig. 2</label><caption><p>Designing of <italic>DeepShape</italic> and the shape model. <bold>a</bold> pipeline of <italic>DeepShape-prime</italic>. After a uniform initiation of ribosome abundance normalized by CDS length, in each iteration, reads are mapped proportional to normalized ribosome abundance, and then a new ribosome abundance is updated. <bold>b</bold> pipeline of <italic>DeepShape</italic>. A shape model is introduced, and in each iteration, reads are mapped proportional to ribosome abundance and an instructive ribosome shape together. Then the shape model is fitted to generate a new instructive ribosome shape which can introduce heterogeneity because of different contexts. <bold>c</bold> structure of the shape model. The model contains an embedding layer which converts the codons to ‘one-hot’ vectors, three convolutional layers and a full connection layer</p></caption><graphic xlink:href="12859_2019_3244_Fig2_HTML" id="MO2"/></fig></p>
      <p id="Par23">The other program is called <italic>DeepShape</italic>, which differs from <italic>DeepShape-prime</italic> in that it aims to calculate more precise ribosome distributions along transcripts by allocating reads not only according to ribosome abundance, but also an instructive ribosome shape that were predicted from transcript sequences by a “shape model” that was trained from the Ribo-seq data being processed (Fig. <xref rid="Fig2" ref-type="fig">2</xref>b). At initiation, the normalized ribosome abundances are set uniformly, or given abundance values (say, from results of <italic>DeepShape-prime</italic>), and the instructive ribosome shapes are also set uniformly. In each iteration, <italic>DeepShape</italic> performs three tasks. At Step 1, it assigns reads according to current normalized ribosomal abundances and instructive ribosome shape values to obtain a temporary ribosome distribution. At Step 2, it trains the shape model using the temporary ribosome distributions and then applies the shape model to transcript sequences to update instructive ribosome shape values. At step 3, it updates a new set of ribosomal abundances according to the read abundance on the transcripts. This process iterates until the results are stabilized.</p>
    </sec>
    <sec id="Sec5">
      <title>Design and training of shape model</title>
      <p id="Par24">In <italic>DeepShape</italic>, the shape model is a context-dependent model which characterizes ribosome moving patterns or distributions. We use a convolution neural network (CNN) model to learn the association between the context nucleotides and shape of ribosome profiles (Fig. <xref rid="Fig2" ref-type="fig">2</xref>c). The model was built by a Python deep learning library Keras [<xref ref-type="bibr" rid="CR33">33</xref>].</p>
      <p id="Par25">We used the encoded codon sequence, instead of nucleotide sequence, to represent the surrounding context of the ribosome. The input to the CNN model is the codon sequences of length 121 surrounding the position of ribosome (60aa upstream and 60aa downstream). The model contains a layer encoding 64 different codons into 64-dimensional ‘one-hot’ vectors, three convolutional layers, a full connecting layer, and an output layer. The output is the predicted instructive ribosome shape value at this site. The normalized values of ribosome distribution along transcripts were used here to train the deep learning model, which can be calculated as
<disp-formula id="Equc"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {x}_{ij}=\frac{c_{ij}}{\sum \limits_{j\in \left[1,{l}_i\right]}{c}_{ij}}\times {l}_i, $$\end{document}</tex-math><mml:math id="M6" display="block"><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>×</mml:mo><mml:msub><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo></mml:math><graphic xlink:href="12859_2019_3244_Article_Equc.gif" position="anchor"/></alternatives></disp-formula>where <italic>x</italic><sub><italic>ij</italic></sub> denotes the normalized ribosome distribution of gene <italic>i</italic> at the position of its <italic>j</italic>-th codon, <italic>c</italic><sub><italic>ij</italic></sub> denotes the number of ribosome reads at position <italic>j</italic> on transcript <italic>i</italic>, and <italic>l</italic><sub><italic>i</italic></sub> denotes the length of the coding region of the transcript. Data with extremely high or low values (outside [<italic>μ</italic>-3<italic>σ</italic>, <italic>μ</italic> + 3<italic>σ</italic>] in log scale, <italic>μ</italic> and <italic>σ</italic> are the mean and standard deviation of all values in training data) or zeros are discarded from the training dataset. Besides, the original data follows a log-normal-like distribution. We did a data re-sampling to keep the data relatively balanced in each distance from center. The region between [<italic>μ</italic>-3<italic>σ</italic>, <italic>μ</italic> + 3<italic>σ</italic>] was divided into 10 bins, and in each bin, we re-sampled 50,000 data points.</p>
      <p id="Par26">We train the shape model by minimizing the following loss function:
<disp-formula id="Equd"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ L=\frac{\sum_{i=\left[1,N\right]}{\left[\log \left(\max \left({10}^{-8},{y}_{predict}\right)\right)-\log \left(\max \left({10}^{-8},{y}_{ground- truth}\right)\right)\right]}^2}{N}, $$\end{document}</tex-math><mml:math id="M8" display="block"><mml:mi>L</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mfenced close="]" open="[" separators=","><mml:mn>1</mml:mn><mml:mi>N</mml:mi></mml:mfenced></mml:mrow></mml:msub><mml:msup><mml:mfenced close="]" open="["><mml:mrow><mml:mo>log</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mo>max</mml:mo><mml:mfenced close=")" open="(" separators=","><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mn>8</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mi>y</mml:mi><mml:mtext mathvariant="italic">predict</mml:mtext></mml:msub></mml:mfenced></mml:mrow></mml:mfenced><mml:mo>−</mml:mo><mml:mo>log</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mo>max</mml:mo><mml:mfenced close=")" open="(" separators=","><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mn>8</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mtext mathvariant="italic">ground</mml:mtext><mml:mo>−</mml:mo><mml:mtext mathvariant="italic">truth</mml:mtext></mml:mrow></mml:msub></mml:mfenced></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mi>N</mml:mi></mml:mfrac><mml:mo>,</mml:mo></mml:math><graphic xlink:href="12859_2019_3244_Article_Equd.gif" position="anchor"/></alternatives></disp-formula>where <italic>N</italic> denotes the size of the training data. The training of the CNN model stops if the loss of the validation set in current epoch is higher than that of the last epoch.</p>
    </sec>
    <sec id="Sec6">
      <title>Comparison of the shape model and <italic>DeepShape</italic></title>
      <p id="Par27">We applied the shape model of <italic>DeepShape</italic> to datasets from four different organisms downloaded from GWIPS: the yeast dataset used in RiboShape [<xref ref-type="bibr" rid="CR4">4</xref>], an <italic>E. coli</italic> dataset [<xref ref-type="bibr" rid="CR30">30</xref>], a mouse dataset [<xref ref-type="bibr" rid="CR31">31</xref>] and a human dataset [<xref ref-type="bibr" rid="CR32">32</xref>]. We compared our performance with that of RiboShape.</p>
      <p id="Par28">We compared both <italic>DeepShape-prime</italic> and <italic>DeepShape</italic> with Ribomap for accuracy of the predicted ribosome distributions at the transcripts. Default parameters of Ribomap were used in this study. We also included a naive method which distributes the multiple-mapped reads uniformly to all target transcripts. As the mapping process was carried out by STAR [<xref ref-type="bibr" rid="CR24">24</xref>], we call the naïve method as “STAR-uniform” in this paper. In addition, we tested an RNA-seq quantification tool, Salmon, using the synthetic Ribo-seq data directly, in order to assess the performance of the representative RNA-seq profiling method.</p>
    </sec>
    <sec id="Sec7">
      <title>Calculation of codon residence index</title>
      <p id="Par29">To study potential translation mechanisms, we investigated the translation speed of codons. We defined Codon Residence Index (CRI), which shows the relative speed when a ribosome going through a codon compared with its synonymous codons. This index is defined in the following:
<disp-formula id="Eque"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\mathrm{CRI}}_{ij}=\frac{\frac{1}{n_{ij}}{\sum}_{k=1}^{n_{ij}}{x}_{ik}^j}{\frac{1}{\#{\mathbf{S}}_j}{\sum}_{j^{\prime}\in {\mathbf{S}}_j}\frac{1}{n_{i{j}^{\prime }}}{\sum}_{k=1}^{n_{i{j}^{\prime }}}{x}_{ik}^{j^{\prime }}}-1, $$\end{document}</tex-math><mml:math id="M10" display="block"><mml:msub><mml:mi>CRI</mml:mi><mml:mi mathvariant="italic">ij</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>n</mml:mi><mml:mi mathvariant="italic">ij</mml:mi></mml:msub></mml:mfrac><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi mathvariant="italic">ij</mml:mi></mml:msub></mml:msubsup><mml:msubsup><mml:mi>x</mml:mi><mml:mi mathvariant="italic">ik</mml:mi><mml:mi>j</mml:mi></mml:msubsup></mml:mrow><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mo>#</mml:mo><mml:msub><mml:mi mathvariant="bold">S</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:msup><mml:mi>j</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>∈</mml:mo><mml:msub><mml:mi mathvariant="bold">S</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:msup><mml:mi>j</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msub></mml:mfrac><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:msup><mml:mi>j</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msub></mml:msubsup><mml:msubsup><mml:mi>x</mml:mi><mml:mi mathvariant="italic">ik</mml:mi><mml:msup><mml:mi>j</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:msubsup></mml:mrow></mml:mfrac><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo></mml:math><graphic xlink:href="12859_2019_3244_Article_Eque.gif" position="anchor"/></alternatives></disp-formula>where CRI<sub><italic>ij</italic></sub> denotes the CRI value of codon <italic>j</italic> on a specific transcript <italic>i</italic>, <inline-formula id="IEq1"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {x}_{ik}^j $$\end{document}</tex-math><mml:math id="M12" display="inline"><mml:msubsup><mml:mi>x</mml:mi><mml:mi mathvariant="italic">ik</mml:mi><mml:mi>j</mml:mi></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2019_3244_Article_IEq1.gif"/></alternatives></inline-formula> denotes the normalized ribosome distribution value (see Section 2.3) at the position of the <italic>k</italic>-th codon <italic>j</italic> on the <italic>i</italic>-th transcript, <italic>n</italic><sub><italic>ij</italic></sub> denotes the number of codon <italic>j</italic> on transcript <italic>i</italic>, and <bold>S</bold><sub><italic>j</italic></sub> denotes the set of codon <italic>j</italic>’s synonymous codons on that transcript (including <italic>j</italic>). If a codon has a CRI value above zero, it means that a ribosome tends to pay more time on this codon compared with its synonymous codons. On the contrary, a CRI value below zero means that a ribosome tends to move faster on the codon compared with its synonymous codons.</p>
    </sec>
  </sec>
  <sec id="Sec8">
    <title>Results</title>
    <sec id="Sec9">
      <title>Performance of the shape model on benchmark datasets</title>
      <p id="Par30">To assess the accuracy of ribosome shape prediction, we applied the aforementioned computational models to the yeast dataset (see Methods). Table <xref rid="Tab1" ref-type="table">1</xref> shows the average Pearson correlation coefficients (PCC) between predicted ribosome profiles and ground-truth profiles for genes with different coding length. Our CNN model in <italic>DeepShape</italic> can produce an average PCC of 0.60 in the testing dataset (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S2). Genes from 251 aa to 500 aa in length tend to have the most accurate predictions. Liu et.al. showed that prediction on lower wavelet transformation space can give higher correlations using their method. Even so, our results show a better performance (0.57~0.63 PCC) without any smoothing procedure than that of RiboShape on smoothed V7 space (0.46~0.52 PCC), and even on very smoothed V4 space (0.49~0.62 PCC) (Table <xref rid="Tab1" ref-type="table">1</xref>). These results prove the advantage of our CNN model.
<table-wrap id="Tab1"><label>Table 1</label><caption><p>Performance of shape model on genes with different lengths</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Length (codons)</th><th>RiboShape V3<sup>a</sup></th><th>RiboShape V4<sup>a</sup></th><th>RiboShape V7<sup>a</sup></th><th>Shape model <italic>(DeepShape)</italic></th></tr></thead><tbody><tr><td>&lt;=250</td><td>0.61</td><td>0.53</td><td>0.45</td><td>0.61</td></tr><tr><td>251–500</td><td>0.67</td><td>0.62</td><td>0.52</td><td>0.63</td></tr><tr><td>501–750</td><td>0.61</td><td>0.58</td><td>0.50</td><td>0.59</td></tr><tr><td>751–1000</td><td>0.52</td><td>0.49</td><td>0.46</td><td>0.57</td></tr><tr><td>&gt; 1001</td><td>0.54</td><td>0.51</td><td>0.46</td><td>0.58</td></tr></tbody></table><table-wrap-foot><p><sup>a</sup>Reported in RiboShape study [<xref ref-type="bibr" rid="CR4">4</xref>]. The V3 and V4 spaces are highly smoothed subspaces of the original ribosome distribution profile after wavelet transformation. V3 is smoother than V4. The V7 space is also smoothed, but most similar to the original space. RiboShape performs better in a lower subspace</p></table-wrap-foot></table-wrap></p>
      <p id="Par31">We also tested our shape model and RiboShape on ribosome distribution datasets of <italic>E. coli</italic>, mouse and human (Methods and Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Supplementary Methods). In <italic>E. coli</italic> and human datasets, our shape model outperforms RiboShape (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S1). In the mouse dataset, the two methods gave similar results. However, the predicted ribosome shape that our shape model provides is at the codon level resolution, while RiboShape can only give smoothed prediction in subspace. Moreover, our shape model has great advantage in computational time. For example, on the <italic>E. coli</italic> dataset, our shape model took less than 2 hours running a 10-fold cross validation, while RiboShape took more than 3 days.</p>
    </sec>
    <sec id="Sec10">
      <title>Performance of ribosomal abundance estimation using synthetic datasets</title>
      <p id="Par32">We simulated a pair of synthetic Ribo-seq/RNA-seq dataset, both containing 20,000,000 reads with length 30 bps (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Supplementary Methods). The read length and mRNA abundance were set following a real dataset from human HeLa cells [<xref ref-type="bibr" rid="CR34">34</xref>] (see Section 2.1), which was also used in the study of Ribomap [<xref ref-type="bibr" rid="CR15">15</xref>]. We applied <italic>DeepShape</italic>, <italic>DeepShape-prime</italic> and Ribomap to this dataset to show their performances in predicting ribosome abundance. <italic>DeepShape</italic> and <italic>DeepShape-prime</italic> used Ribo-seq data only, while Ribomap used both Ribo-seq data and RNA-seq data. Both ribosome count abundance and CDS-length-normalized abundance (see Section 2.1) were evaluated and compared.</p>
      <p id="Par33">Figure <xref rid="Fig3" ref-type="fig">3</xref> plots the PCC curves of ribosome count abundance (measured in absolute counts of ribosome-protected fragments on CDS regions) estimated by <italic>DeepShape-prime</italic>, <italic>DeepShape</italic> and Ribomap, compared with the “ground-truth” of preset ribosome abundance in the synthetic dataset. <italic>DeepShape-prime</italic> was run for 1 to 1000 iterations (blue dots) and <italic>DeepShape</italic> was run for 1 to 200 iterations. For <italic>DeepShape</italic>, two kinds of initialing ribosome abundance (see Section 2.2 in Methods) were tested: uniform (red dots), or direct results from the 200-th iteration of <italic>DeepShape-prime</italic> (purple dots).
<fig id="Fig3"><label>Fig. 3</label><caption><p>PCC curves for prediction of ribosome abundance at each iteration of <italic>DeepShape</italic> and <italic>DeepShape-prime</italic>. For comparison, the PCC value of Ribomap is shown</p></caption><graphic xlink:href="12859_2019_3244_Fig3_HTML" id="MO3"/></fig></p>
      <p id="Par34">We observe that the PCC value of <italic>DeepShape-prime</italic> improves quickly at the first 30 iterations, becoming stabilized, and then finally converging to values higher than 0.99 after 100 iterations. The convergent speed of <italic>DeepShape</italic> is a bit shower than that of <italic>DeepShape-Prime</italic> at the beginning iterations because it has an additional module for shape prediction, which at the end leads to higher accuracy than <italic>DeepShape-prime</italic> (0.9960 vs. 0.9949, in the 200-th iteration). Both <italic>DeepShape</italic> and <italic>DeepShape-prime</italic> outperform Ribomap (PCC 0.9342, blue dots-dashed line) after about 10 iterations. Starting from ribosome abundance exported from <italic>DeepShape-prime</italic> can help <italic>DeepShape</italic> get better performance compared with uniform initialization (0.9982 vs 0.9960, both in the 200-th iteration). To test the accuracy of existing isoform-level RNA-seq quantification algorithms on Ribo-seq data, we applied Salmon, a widely used program, to the same dataset, and obtained a PCC value of only 0.8923, much worse than existing Ribo-seq programs. This shows that designing computational tools specifically for Ribo-seq data analysis is necessary. The performances of estimating length-normalized ribosome abundances by <italic>DeepShape-prime</italic>, <italic>DeepShape</italic> and Ribomap show similar results (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S3). In practice, as <italic>DeepShape-prime</italic> runs much faster because it does not need to calculate the shape, and since the distinction between <italic>DeepShape</italic> and <italic>DeepShape-prime</italic> is quite small, user can choose <italic>DeepShape-prime</italic> for efficient estimation for ribosome abundance information.</p>
      <p id="Par35">Additional tests were conducted to evaluate the robustness of <italic>DeepShape-prime</italic>. We tested <italic>DeepShape-prime</italic> with 200 iterations against Ribomap on three randomly generated synthetic datasets using several measures. Table <xref rid="Tab2" ref-type="table">2</xref> shows that <italic>DeepShape-prime</italic> outperforms Ribomap in all three datasets. The performance of <italic>DeepShape-prime</italic> stabilizes at values higher than 0.99 for ribosome abundance PCC, yet the performance of Ribomap floats from around 0.87 to 0.93. The ribosome loading MSE values of <italic>DeepShape-prime</italic> are about one magnitude smaller than those of Ribomap. Moreover, from the aspect of CDS-length-normalized ribosome abundance, we observe that the performance of Ribomap relies a lot on the extent of similarity between mRNA abundance and ribosome abundance (last three lines in Table <xref rid="Tab2" ref-type="table">2</xref>). The results show that <italic>DeepShape</italic> is more robust than Ribomap.
<table-wrap id="Tab2"><label>Table 2</label><caption><p>Ribosome abundance estimation performance in three replicate synthetic datasets</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Evaluation</th><th>Method</th><th>Dataset 1</th><th>Dataset 2</th><th>Dataset 3</th></tr></thead><tbody><tr><td rowspan="2">Ribosome count PCC</td><td><italic>DeepShape-prime</italic></td><td>0.9931</td><td>0.9947</td><td>0.9932</td></tr><tr><td>Ribomap</td><td>0.8952</td><td>0.9253</td><td>0.8680</td></tr><tr><td rowspan="2">Ribosome count MSE</td><td><italic>DeepShape-prime</italic></td><td>87,546</td><td>70,815</td><td>157,187</td></tr><tr><td>Ribomap</td><td>1,216,917</td><td>854,546</td><td>2,213,367</td></tr><tr><td rowspan="2">CDS-Length-normalized ribosome abundance PCC</td><td><italic>DeepShape-prime</italic></td><td>0.9990</td><td>0.9991</td><td>0.9981</td></tr><tr><td>Ribomap</td><td>0.9158</td><td>0.9381</td><td>0.9616</td></tr><tr><td colspan="2">Ground-truth mRNA vs ribosome abundance PCC (both normalized by length)</td><td>0. 6775</td><td>0.7162</td><td>0.8252</td></tr></tbody></table><table-wrap-foot><p><italic>PCC:</italic> Pearson correlation coefficient between prediction and ground-truth.</p><p><italic>MSE:</italic> Mean square error between prediction and ground-truth.</p></table-wrap-foot></table-wrap></p>
    </sec>
    <sec id="Sec11">
      <title>Performance of ribosomal shape prediction</title>
      <p id="Par36">To evaluate the performance of ribosome shape prediction, we compared the mean shape Pearson correlations of the following four models: <italic>DeepShape-prime</italic>, <italic>DeepShape</italic>, Ribomap, and a simple model, called STAR-uniform, which allocates multiple-mapped reads randomly to their mapped genes. The methods were applied and evaluated in our synthetic dataset (see Section 2.1).</p>
      <p id="Par37">Figure <xref rid="Fig4" ref-type="fig">4</xref>a shows the PCC curves of the ribosome shape predictions for both <italic>DeepShape-prime</italic> and <italic>DeepShape</italic> from iterations 1 to 400, as well as the PCC values by Ribomap and STAR-uniform. <italic>DeepShape</italic> has the best average shape PCC of 0.900, followed by <italic>DeepShape-prime</italic> with 0.891. The result of the STAR-uniform is 0.849, but better than that of Ribomap (0.814). This is because of the misleading information by using RNA-seq abundance, which may be very different from ribosome abundance because of variation of translation efficiency. It should be noted that <italic>DeepShape</italic> first obtained the ribosome abundance results of the 200th iteration of <italic>DeepShape-prime</italic> and then estimated the ribosome profiles, which improved the PCC value from 0.891 to 0.899 after about 10 iterations.
<fig id="Fig4"><label>Fig. 4</label><caption><p>Improvement after introducing shape model to <italic>DeepShape</italic>. <bold>a</bold> Changing of ribosome profile shape PCC along the iteration of <italic>DeepShape-prime</italic> and <italic>DeepShape</italic>. The best performances are provided as dash dot lines (red: <italic>DeepShape</italic>, green: <italic>DeepShape-prime</italic>, yellow: STAR-uniform, purple: Ribomap). <bold>b</bold> An example of ribosome profiling improvement by <italic>DeepShape</italic> (red line) compared to <italic>DeepShape-prime</italic> (blue line). Ground-truth is shown as light green bars. The RPLP1 gene has three isoforms, including four exons (red, blue, green and yellow lines below the profile). <italic>DeepShape</italic> tends to provide the same profile in the same exons. <bold>c</bold> Distributions of isoform PCCs between calculated ribosome distributions and ground-truth</p></caption><graphic xlink:href="12859_2019_3244_Fig4_HTML" id="MO4"/></fig></p>
      <p id="Par38">We observed a noticeable improvement of ribosome shape predictions for many genes. For example, from STAR-uniform to <italic>DeepShape</italic>, more than 3405 genes have a better profile with improved PCC value &gt; 0.1. The “small” improvement from <italic>DeepShape-prime</italic> (0.891) to <italic>DeepShape</italic> (0.900) means that 421 genes have a better profile with improved PCC value &gt; 0.1.</p>
      <p id="Par39">Figure <xref rid="Fig4" ref-type="fig">4</xref>b shows an example of reconstructed ribosome profiles by <italic>DeepShape</italic>, <italic>DeepShape-prime</italic>, Ribomap and STAR-uniform. The three transcripts come from gene RPLP1 (ribosomal protein, large, P1. Gene ID: ENSG00000137818). This gene contains four exons, and because the length of Exon 3 is not a multiple of three, a frame shift on Exon 4 occurs in transcript RPLP1–006 compared with transcripts RPLP1–001 and RPLP1–002; hence, the ribosome distribution at this exon varies by transcripts. After introducing the shape model, we observe that the ribosome distribution of RPLP1–001 and RPLP1–002 improves significantly compared to the “ground-truth” when generating the synthetic data (Fig. <xref rid="Fig4" ref-type="fig">4</xref>b, light green bars) from <italic>DeepShape-prime</italic> (Fig. <xref rid="Fig4" ref-type="fig">4</xref>b, blue line) to <italic>DeepShape</italic> (Fig. <xref rid="Fig4" ref-type="fig">4</xref>b, red line) by the increase of PCC value of RPLP1–001 from 0.828 to 0.966 and the increase of PCC value of RPLP1–002 from 0.795 to 0.961. The improvement solely results from better ribosome distribution prediction. <italic>DeepShape-prime</italic> allocates multiple-mapped reads proportionally according to ribosome abundance; therefore, in its results, the ribosome distribution shapes on exon 4 are similar among the three transcripts, as the proportions are dominated by the one with highest abundance (the third transcript here). In contrast, the <italic>DeepShape</italic> model catches the frame shift in computing the ribosome profile.</p>
      <p id="Par40">Figure <xref rid="Fig4" ref-type="fig">4</xref>c shows the distributions of Pearson correlations between predicted gene profiles and the ground-truth. Results show that <italic>DeepShape</italic> has significantly higher PCC values compared to those of both Ribomap and STAR-uniform. Ribosome profiles of more than 68.9% (13,823 out of 20,073) of isoforms can be reconstructed with Pearson correlation &gt; 0.9 by <italic>DeepShape-prime</italic>.</p>
    </sec>
    <sec id="Sec12">
      <title>Translation process revealed by DeepShape</title>
      <sec id="Sec13">
        <title>Discovery of ribosomal stalling using synthetic datasets</title>
        <p id="Par41">We demonstrate that <italic>DeepShape</italic> can be used to discover ribosomal stalling events, defined as the positions at which ribosome profiles are higher than μ + 2σ, where μ and σ are the mean and standard deviation of the normalized ribosome distribution. We first annotated stalling events in the ground-truth ribosome profiles of the synthetic dataset. We then applied <italic>DeepShape</italic>, <italic>DeepShape-prime</italic>, Ribomap and STAR-uniform to the synthetic data, respectively, obtaining the ribosome profiles, followed by annotation of stalling events on the reconstructed profiles. Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S4 shows the results. Out of the 134,137 stalling events annotated as the ground-truth, <italic>DeepShape</italic> could identify 87.7% (117,647), higher than Ribomap (65.5%), STAR-uniform (74.4%) and <italic>DeepShape-prime</italic> (87.1%), showing the high sensitivity of DeepShape. Moreover, <italic>DeepShape</italic> has the highest precision (84.1%), compared to Ribomap (64.3%), STAR-uniform (68.3%) and <italic>DeepShape-prime</italic> (83.6%). All these results validate that <italic>DeepShape</italic> can accurately identify more translation events.</p>
      </sec>
      <sec id="Sec14">
        <title>Calculating translation efficiency with Ribo-seq</title>
        <p id="Par42">We re-analyzed a Ribo-seq dataset of human prostate cancer cells (PC3 dataset) [<xref ref-type="bibr" rid="CR23">23</xref>]. In cancer development, mammalian target of rapamycin (mTOR) kinase is a very important factor [<xref ref-type="bibr" rid="CR35">35</xref>, <xref ref-type="bibr" rid="CR36">36</xref>], and an mTOR ATP site inhibitor, PP242, can inhibit the downstream pathway of mTOR. The effectiveness of PP242 (an mTOR ATP site inhibitor) on downregulating the translation of mTOR sensitive genes in PC3 cells was proved in gene level [<xref ref-type="bibr" rid="CR23">23</xref>]. Here using <italic>DeepShape</italic>, we analyzed the translational response to PP242 treatment in transcript level.</p>
        <p id="Par43">We first computed the mRNA and ribosome abundance correlations (evaluated in PCC) for samples at the same condition and between treatments (Fig. <xref rid="Fig5" ref-type="fig">5</xref>b and c). High consistency was observed between two replicates under the same condition (control or PP242 treatment). Interestingly, for mRNA abundance, the correlation between treatments are even higher than that in the same condition (Fig. <xref rid="Fig5" ref-type="fig">5</xref>a), indicating that the treatment did not significantly alter expression of transcripts. On the other hand, for ribosome abundance, the correlation between the two conditions is higher (Fig. <xref rid="Fig5" ref-type="fig">5</xref>b). After PP242 treatment, these observations show that the change of translating ribosome abundance is higher than the change of gene expression.
<fig id="Fig5"><label>Fig. 5</label><caption><p>Application of <italic>DeepShape</italic> to reveal translational regulation patterns. <bold>a</bold>/<bold>b</bold> mRNA/ribosome abundance PCCs between and inside conditions. <bold>c</bold> distribution of TE in log 2 scale. <bold>d</bold> relation between length-normalized mRNA and ribosome abundance. The overall PCC between mRNA and ribosome is 0.62. <bold>e</bold> Codon Residence Index (CRI) of different codons in control of Replicate 1 (row 1), treat of Replicate 1 (row 2), control of Replicate 2 (row 3) and treat of Replicate 2 (row 4). The values show average CRIs of all transcripts that with length-normalized mRNA and ribosome abundance higher than 10. Significances between control and treat were tested by paired samples Wilcoxon two-sided test</p></caption><graphic xlink:href="12859_2019_3244_Fig5_HTML" id="MO5"/></fig></p>
        <p id="Par44">We analyzed the translation efficiencies (TE) in each experiment. In previous works, TE was mainly calculated by ribosome reads/RNA-seq reads [<xref ref-type="bibr" rid="CR9">9</xref>, <xref ref-type="bibr" rid="CR23">23</xref>], or with some self-defined normalization method [<xref ref-type="bibr" rid="CR15">15</xref>]. Although these approaches can reveal the relative efficiency when comparing different isoforms, the results are easily affected by sequencing depth. Here we use the length-normalized ratio (of ribosome abundance/mRNA abundance) to define TE (see Section 2.1), which follows a log-normal distribution (Fig. <xref rid="Fig5" ref-type="fig">5</xref>c). About a quarter of transcripts (5311 out of 19,522) have a translation efficiency value higher than 4 or lower than 0.25. It is obvious that mRNA abundance is very different from ribosome abundance (Fig. <xref rid="Fig5" ref-type="fig">5</xref>d). This also confirms that allocating multiple-mapped reads by RNA-seq transcript abundance is not suitable.</p>
        <p id="Par45">In the original paper of the PC3 dataset, four cell invasion/metastasis genes were reported to be significantly regulated in translation by PP242 treatment: <italic>VIM</italic>, <italic>YB1</italic>, <italic>MTA1</italic>, and <italic>CD44</italic>. This gene level observation is confirmed in our study on transcript level (Table <xref rid="Tab3" ref-type="table">3</xref>). Meanwhile, we found that isoforms of the same gene may have very different TE or TE regulation patterns (Table <xref rid="Tab3" ref-type="table">3</xref>). For example, four isoforms were found in <italic>VIM</italic>: VIM-001, VIM-002, VIM-003 and VIM-201 (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S5). Among them, VIM-001 and VIM-201 have the same protein coding region, and we therefore combined them into one. VIM-002 and VIM-003 are alternatively spliced transcripts and annotated as nonsense-mediated decay (NMD), which is regarded as erroneous splicing and will be decayed under normal circumstances. In the two replicates of experiments, VIM-001 (VIM-201) shows similar TEs and TE regulation patterns after PP242 treatment, and the two NMD transcripts show very different TEs but similar TE regulation patterns (Table <xref rid="Tab3" ref-type="table">3</xref>). Both NMD transcripts of VIM genes show lower TEs in replicate 2, and the effect of down-regulation by PP242 is more obvious than that of replicate 1 (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S2). The <italic>MTA1</italic> gene also have similar phenomenon. The isoform switching also occurs in other cell types (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S3). Because of the lack of isoform-level translation studies in the past, in-depth study on the difference of TE among isoforms from the same gene is absent from the literature. In view of this, the analysis here may provide a new paradigm for the study of translation.
<table-wrap id="Tab3"><label>Table 3</label><caption><p>mRNA and ribosome abundance in the four cell invasion/metastasis genes</p></caption><table frame="hsides" rules="groups"><thead><tr><th rowspan="2">Gene</th><th rowspan="2">Transcript</th><th colspan="4">mRNA (TPM)</th><th colspan="4">Ribosome (CDS-length-normalized)</th></tr><tr><th>control1</th><th>control2</th><th>treat1</th><th>treat2</th><th>control1</th><th>control2</th><th>treat1</th><th>treat2</th></tr></thead><tbody><tr><td rowspan="3"><italic>VIM</italic></td><td>ENST00000544301.6 (VIM-001)</td><td>1268.151</td><td>1079.626</td><td>1864.131</td><td>1606.06</td><td>1530.699</td><td>1432.324</td><td>655.713</td><td>491.6958</td></tr><tr><td>ENST00000487938.5 (VIM-002)</td><td>1.19409</td><td>5.19589</td><td>4.60853</td><td>6.37172</td><td>3.314905</td><td>1.386528</td><td>2.49548</td><td>1.02E-20</td></tr><tr><td>ENST00000469543.5 (VIM-003)</td><td>8.6292</td><td>9.6432</td><td>5.48475</td><td>4.47247</td><td>189.396</td><td>13.71204</td><td>42.24884</td><td>0.044353</td></tr><tr><td><italic>YBX1</italic></td><td>ENST00000321358.11 (YBX1–201)</td><td>932.746</td><td>837.964</td><td>1007.04</td><td>921.105</td><td>641.5486</td><td>579.1333</td><td>228.5892</td><td>145.99</td></tr><tr><td rowspan="3"><italic>MTA1</italic></td><td>ENST00000331320.11 (MTA1–001)</td><td>7.72171</td><td>0</td><td>9.44299</td><td>7.80098</td><td>3.139666</td><td>0.0147</td><td>0.012351</td><td>1.39E-13</td></tr><tr><td>ENST00000405646.5 (MTA1–003)</td><td>49.2963</td><td>38.3313</td><td>43.2853</td><td>35.8685</td><td>16.53584</td><td>18.04329</td><td>18.76716</td><td>7.94493</td></tr><tr><td>ENST00000438610.5 (MTA1–004)</td><td>10.3167</td><td>7.68285</td><td>14.4819</td><td>14.1276</td><td>6.170347</td><td>5.191197</td><td>8.055225</td><td>6.377454</td></tr><tr><td rowspan="2"><italic>CD44</italic></td><td>ENST00000263398.10 (CD44–003)</td><td>68.0735</td><td>74.2861</td><td>77.4636</td><td>74.5578</td><td>241.7872</td><td>311.4829</td><td>187.2566</td><td>177.6087</td></tr><tr><td>ENST00000434472.6 (CD44–008)</td><td>3.81167</td><td>5.32514</td><td>8.42678</td><td>10.1775</td><td>9.713445</td><td>13.79658</td><td>7.088849</td><td>13.68229</td></tr></tbody></table></table-wrap></p>
      </sec>
      <sec id="Sec15">
        <title>Translation process analyzed by combining RNC-seq with Ribo-seq</title>
        <p id="Par46">Codon usage is one of the main factors related to the speed of ribosome movement along transcripts [<xref ref-type="bibr" rid="CR37">37</xref>]. The speed of translating a codon is supposed to be related to the current cellular concentration of its corresponding tRNA [<xref ref-type="bibr" rid="CR38">38</xref>, <xref ref-type="bibr" rid="CR39">39</xref>]. As outer environmental stress may affect tRNA concentration [<xref ref-type="bibr" rid="CR40">40</xref>], it may also affect codon-specific ribosome movement speed. Here we designed an index, named “Codon Residence Index” (CRI, see Section 2.5), which stands for the relative time usage when a ribosome passing by a codon comparing with its synonymous codons. Using CRIs calculated from the ribosome distribution reported by <italic>DeepShape</italic>, we analyzed the association of PP242 treatment and ribosomes’ movement in codon-resolution.</p>
        <p id="Par47">To avoid inaccurate ribosome distribution estimation per codon on isoforms with low abundance, we only considered isoforms with both length-normalized ribosome and mRNA abundance higher than 10. Figure <xref rid="Fig5" ref-type="fig">5</xref>e shows the 64 codons’ average CRI values among all filtered transcripts. The four PC3 experiments show very similar CRI patterns (Fig. <xref rid="Fig5" ref-type="fig">5</xref>e). It’s common that a codon shows obvious speed up (lower CRI) or pause (higher CRI) compared with its synonymous codons. For example, the ribosome’s resident times on GCC, GGC, CGC and AGC are at least 20% shorter than on their synonymous codons (CRI ≤  − 0.2), in all the four experiments. On the contrary, the ribosomes averagely stay at least 20% longer on GCA, TTA and CGA than on their synonymous codons (CRI ≥ 0.2).</p>
        <p id="Par48">CRI patterns of the same replicate are more similar compared with that of the same condition (treat/control), which imply that each cell has their relatively characterized CRI pattern. However, after PP242 treatment, the trend of CRI shifts of the two replicates shows some interesting phenomenon: five codons show significant ribosome speed up in both replicates, and on the contrary, seven codons show significant ribosome slowing down. For all the four codons with CRI lower than −0.2 (GCC, GGC, CGC and AGC), the ribosome resident time on three of them (GGC, CGC and AGC) were significantly increased (Fig. <xref rid="Fig5" ref-type="fig">5</xref>, red stars) in both replicates. The other codon, GCC, also has increased average CRI values in both replicates after PP242 treatment. This implies potential regulatory mechanism of outer environment stress on codon-specific translation.</p>
      </sec>
    </sec>
  </sec>
  <sec id="Sec16">
    <title>Discussion</title>
    <p id="Par49">In this paper, we developed a computational method, <italic>DeepShape</italic>, which not only accurately estimates ribosome abundance at isoform level, but also provides precise ribosome distribution profiles along transcripts. <italic>DeepShape</italic> uses Ribo-seq reads only, making full use of multiple-mapped reads.</p>
    <p id="Par50">Many excellent RNA-seq quantification tools for isoform-level abundance estimation are available, such as cufflinks [<xref ref-type="bibr" rid="CR41">41</xref>], RSEM [<xref ref-type="bibr" rid="CR42">42</xref>], Salmon [<xref ref-type="bibr" rid="CR25">25</xref>] and eXpress [<xref ref-type="bibr" rid="CR43">43</xref>]. However, Ribo-seq data have characteristics that are very different from those of RNA-seq data. For example, the location of Ribo-seq reads is actually in the upstream of real ribosome binding site, and most Ribo-seq reads are targeted to the CDS region. The main source of bias of Ribo-seq reads comes from the movement of ribosomes, not RNA-seq sequence bias. For all these reasons, existing RNA-seq tools cannot be directly applied to Ribo-seq data analysis.</p>
    <p id="Par51">The movement of ribosome is highly non-uniform, but at exon-level, the overall non-uniformity of coverage can be smoothed. Compared with allocating multiple mapped reads according to mRNA abundance, <italic>DeepShape</italic> is a more accurate approach to making use of all mapped reads. Results on synthetic data proved its superiority over the state-of-the-art methods, and the analytic results for a published human prostate cancer cell dataset show many novel observations of cancer-related, isoform-level translational regulation events, which may point to new biological discoveries.</p>
    <p id="Par52"><italic>DeepShape</italic> was developed for model organisms that have complete and accurate transcript annotations. For non-model organisms with incomplete or erroneous transcript annotations, the accuracy of our model will be affected. We hope to investigate this topic in the future.</p>
    <p id="Par53">Some parameters in <italic>DeepShape</italic> can be adjusted by users. For example, the input length of the shape model used in this study is 121 codons. However, users can manually set this number to other lengths. According to the sequence depth of Ribo-seq dataset, users can also adjust the bin number and data number in the re-sampling step when training the shape model. The number of iterations in running <italic>DeepShape-prime</italic> and <italic>DeepShape</italic> can also be defined by users. For faster computation, user can set a smaller number.</p>
    <p id="Par54">In this study, we also proposed a codon-resolution index, Codon Residence Index (CRI) to study the relative ribosome moving speed on each codon compared with its synonymous codons. Using the ribosome distribution given by <italic>DeepShape</italic>, we found some interesting CRI pattern in human PC3 cells, including potential regulation pattern that related with PP242 treatment. However, the mechanisms of CRI patterns need to be further investigated. For example, we’ve also calculated the CRI patterns of a human A549 cell and a human HBE cell [<xref ref-type="bibr" rid="CR20">20</xref>, <xref ref-type="bibr" rid="CR22">22</xref>]. Results show that the two cell-lines has very similar CRI pattern, yet distinct from the patterns of the PC3 cells in this study (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S6). This implies that the CRI pattern may not be cell-line-specific, but rather related to different experimental protocols. The suggestion also reminds us to think about the necessity of considering and eliminating the experiment-specific bias when reading the underlying translation regulation mechanisms from ribosome distribution data.</p>
  </sec>
  <sec id="Sec17">
    <title>Conclusion</title>
    <p id="Par55">We propose <italic>DeepShape</italic> to analyze Ribo-seq data, and estimate ribosome abundance and distribution at isoform level. <italic>DeepShape</italic> makes full use of multiple-mapped reads. Compared with another state-of-art method, Ribomap, <italic>DeepShape</italic> needs only Ribo-seq data, without any RNA-seq data. <italic>DeepShape</italic> can help researchers to understand translation mechanisms.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary information</title>
    <sec id="Sec18">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="12859_2019_3244_MOESM1_ESM.docx">
            <caption>
              <p><bold>Additional file 1: </bold>Supplementary Methods. <bold>Figure S1.</bold> Pipeline for generating synthetic data. <bold>Figure S2.</bold> Distribution of Pearson correlation coefficients (PCC) between predicted ribosome distributions by the shape model in <italic>DeepShape</italic> and the ground-truth in training, validation and testing datasets. <bold>Figure S3.</bold> PCC curves for prediction of length-normalized ribosome abundance at each iteration of <italic>DeepShape</italic> and <italic>DeepShape-prime</italic>. <bold>Figure S4.</bold> Application of <italic>DeepShape</italic> to annotating ribosome stalling events. <bold>Figure S5</bold>. Four isoforms of the <italic>VIM</italic> gene. <bold>Figure S6.</bold> Codon Residence Index (CRI) of different codons in A549 and HBE cell. The data are from the work of Lian et al. (Lian, et al., 2016). <bold>Figure S7.</bold> Diagrammatic explanation of finding P-sites. <bold>Table S1.</bold> Performance of shape model on genes with different lengths in <italic>E. coli</italic>. <bold>Table S2.</bold> TE and TE fold changes after PP242 treatment in the four cell invasion/metastasis genes. <bold>Table S3.</bold> mRNA abundance, ribosome abundance and TEs in the four cell invasion/metastasis genes of A549 and H1299 cells.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>CDS</term>
        <def>
          <p id="Par4">Coding sequence</p>
        </def>
      </def-item>
      <def-item>
        <term>CNN</term>
        <def>
          <p id="Par5">Convolution neural network</p>
        </def>
      </def-item>
      <def-item>
        <term>CRI</term>
        <def>
          <p id="Par6">Codon residence index</p>
        </def>
      </def-item>
      <def-item>
        <term>mTOR</term>
        <def>
          <p id="Par7">Mammalian target of rapamycin</p>
        </def>
      </def-item>
      <def-item>
        <term>PCC</term>
        <def>
          <p id="Par8">Pearson correlation coefficients</p>
        </def>
      </def-item>
      <def-item>
        <term>Ribo-seq</term>
        <def>
          <p id="Par9">Ribosome sequencing</p>
        </def>
      </def-item>
      <def-item>
        <term>RPFs</term>
        <def>
          <p id="Par10">Ribosome-protected fragments</p>
        </def>
      </def-item>
      <def-item>
        <term>TE</term>
        <def>
          <p id="Par11">Transcript efficiency</p>
        </def>
      </def-item>
      <def-item>
        <term>TPM</term>
        <def>
          <p id="Par12">Transcripts per million</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher’s Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <sec>
    <title>Supplementary information</title>
    <p><bold>Supplementary information</bold> accompanies this paper at 10.1186/s12859-019-3244-0.</p>
  </sec>
  <ack>
    <title>Acknowledgements</title>
    <p>We would like to thank Professor Xuegong Zhang, Dr. Sai Zhang, Dr. Zhixing Feng, Dr. Xi Wang, Mr. Xinyun Ma and Mr. Ruochi Zhang for useful discussions.</p>
    <sec id="FPar1">
      <title>About this supplement</title>
      <p id="Par56">This article has been published as part of <italic>BMC Bioinformatics Volume 20 Supplement 24, 2019: The International Conference on Intelligent Biology and Medicine (ICIBM) 2019.</italic> The full contents of the supplement are available online at <ext-link ext-link-type="uri" xlink:href="https://bmcbioinformatics.biomedcentral.com/articles/supplements/volume-20-supplement-24">https://bmcbioinformatics.biomedcentral.com/articles/supplements/volume-20-supplement-24</ext-link> .</p>
    </sec>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>TC and JZ initiated and designed the study. HC did all the experiments. HC, HH, JZ and TC analyzed the results. HC and TC wrote the manuscript. All authors have read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>This work and publication costs are funded by the National Natural Science Foundation of China (Nos: 61872218, 61673241, and 61721003), Beijing National Research Center for Information Science and Technology (BNRist), China’s Youth 1000-Talent Program, and Beijing Advanced Innovation Center for Structural Biology.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>Source codes: <ext-link ext-link-type="uri" xlink:href="https://github.com/cuihf06/DeepShape">https://github.com/cuihf06/DeepShape</ext-link>. (This is an open source software for all academic or non-academic users. Operating system: Linux; Programming language: Python.)</p>
    <p>Ribosome shape data of yeast, <italic>E. coli</italic>, mouse and human: <ext-link ext-link-type="uri" xlink:href="https://gwips.ucc.ie/">https://gwips.ucc.ie/</ext-link></p>
    <p>Human HeLa RNA-seq data for synthetic data generation (Gene Expression Omnibus): GSM546921.</p>
    <p>Human real PC3 data (Sequence Read Archive): SRR403882, SRR403883, SRR403886-SRR403889, SRR403892, SRR403893.</p>
  </notes>
  <notes>
    <title>Ethics approval and consent to participate</title>
    <p id="Par57">Not applicable.</p>
  </notes>
  <notes>
    <title>Consent for publication</title>
    <p id="Par58">Not Applicable.</p>
  </notes>
  <notes notes-type="COI-statement">
    <title>Competing interests</title>
    <p id="Par59">The authors declare that they have no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ingolia</surname>
            <given-names>NT</given-names>
          </name>
        </person-group>
        <article-title>Ribosome profiling: new views of translation, from single codons to genome scale</article-title>
        <source>Nat Rev Genet</source>
        <year>2014</year>
        <volume>15</volume>
        <issue>3</issue>
        <fpage>205</fpage>
        <lpage>213</lpage>
        <pub-id pub-id-type="doi">10.1038/nrg3645</pub-id>
        <?supplied-pmid 24468696?>
        <pub-id pub-id-type="pmid">24468696</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Brar</surname>
            <given-names>GA</given-names>
          </name>
          <name>
            <surname>Weissman</surname>
            <given-names>JS</given-names>
          </name>
        </person-group>
        <article-title>Ribosome profiling reveals the what, when, where and how of protein synthesis</article-title>
        <source>Nat Rev Mol Cell Biol</source>
        <year>2015</year>
        <volume>16</volume>
        <issue>11</issue>
        <fpage>651</fpage>
        <lpage>664</lpage>
        <pub-id pub-id-type="doi">10.1038/nrm4069</pub-id>
        <?supplied-pmid 26465719?>
        <pub-id pub-id-type="pmid">26465719</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ramakrishnan</surname>
            <given-names>V</given-names>
          </name>
        </person-group>
        <article-title>Ribosome structure and the mechanism of translation</article-title>
        <source>Cell</source>
        <year>2002</year>
        <volume>108</volume>
        <issue>4</issue>
        <fpage>557</fpage>
        <lpage>572</lpage>
        <pub-id pub-id-type="doi">10.1016/S0092-8674(02)00619-0</pub-id>
        <?supplied-pmid 11909526?>
        <pub-id pub-id-type="pmid">11909526</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>TY</given-names>
          </name>
          <name>
            <surname>Song</surname>
            <given-names>YS</given-names>
          </name>
        </person-group>
        <article-title>Prediction of ribosome footprint profile shapes from transcript sequences</article-title>
        <source>Bioinformatics</source>
        <year>2016</year>
        <volume>32</volume>
        <issue>12</issue>
        <fpage>i183</fpage>
        <lpage>i191</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btw253</pub-id>
        <?supplied-pmid 27307616?>
        <pub-id pub-id-type="pmid">27307616</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Hu</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Zhou</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>He</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Jiang</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Zeng</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Analysis of ribosome stalling and translation elongation dynamics by deep learning</article-title>
        <source>Cell Syst</source>
        <year>2017</year>
        <volume>5</volume>
        <issue>3</issue>
        <fpage>212</fpage>
        <lpage>220</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cels.2017.08.004</pub-id>
        <?supplied-pmid 28957655?>
        <pub-id pub-id-type="pmid">28957655</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gerashchenko</surname>
            <given-names>MV</given-names>
          </name>
          <name>
            <surname>Lobanov</surname>
            <given-names>AV</given-names>
          </name>
          <name>
            <surname>Gladyshev</surname>
            <given-names>VN</given-names>
          </name>
        </person-group>
        <article-title>Genome-wide ribosome profiling reveals complex translational regulation in response to oxidative stress</article-title>
        <source>Proc Natl Acad Sci U S A</source>
        <year>2012</year>
        <volume>109</volume>
        <issue>43</issue>
        <fpage>17394</fpage>
        <lpage>17399</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.1120799109</pub-id>
        <?supplied-pmid 23045643?>
        <pub-id pub-id-type="pmid">23045643</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Han</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Qian</surname>
            <given-names>SB</given-names>
          </name>
        </person-group>
        <article-title>Cotranslational response to proteotoxic stress by elongation pausing of ribosomes</article-title>
        <source>Mol Cell</source>
        <year>2013</year>
        <volume>49</volume>
        <issue>3</issue>
        <fpage>453</fpage>
        <lpage>463</lpage>
        <pub-id pub-id-type="doi">10.1016/j.molcel.2012.12.001</pub-id>
        <?supplied-pmid 3570626?>
        <pub-id pub-id-type="pmid">23290916</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sachs</surname>
            <given-names>AB</given-names>
          </name>
        </person-group>
        <article-title>Cell cycle-dependent translation initiation: IRES elements prevail</article-title>
        <source>Cell</source>
        <year>2000</year>
        <volume>101</volume>
        <issue>3</issue>
        <fpage>243</fpage>
        <lpage>245</lpage>
        <pub-id pub-id-type="doi">10.1016/S0092-8674(00)80834-X</pub-id>
        <?supplied-pmid 10847679?>
        <pub-id pub-id-type="pmid">10847679</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ingolia</surname>
            <given-names>NT</given-names>
          </name>
          <name>
            <surname>Ghaemmaghami</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Newman</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Weissman</surname>
            <given-names>JS</given-names>
          </name>
        </person-group>
        <article-title>Genome-wide analysis in vivo of translation with nucleotide resolution using ribosome profiling</article-title>
        <source>Science</source>
        <year>2009</year>
        <volume>324</volume>
        <issue>5924</issue>
        <fpage>218</fpage>
        <lpage>223</lpage>
        <pub-id pub-id-type="doi">10.1126/science.1168978</pub-id>
        <?supplied-pmid 19213877?>
        <pub-id pub-id-type="pmid">19213877</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chaney</surname>
            <given-names>JL</given-names>
          </name>
          <name>
            <surname>Clark</surname>
            <given-names>PL</given-names>
          </name>
        </person-group>
        <article-title>Roles for synonymous codon usage in protein biogenesis</article-title>
        <source>Annu Rev Biophys</source>
        <year>2015</year>
        <volume>44</volume>
        <fpage>143</fpage>
        <lpage>166</lpage>
        <pub-id pub-id-type="doi">10.1146/annurev-biophys-060414-034333</pub-id>
        <?supplied-pmid 25747594?>
        <pub-id pub-id-type="pmid">25747594</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Artieri</surname>
            <given-names>CG</given-names>
          </name>
          <name>
            <surname>Fraser</surname>
            <given-names>HB</given-names>
          </name>
        </person-group>
        <article-title>Accounting for biases in riboprofiling data indicates a major role for proline in stalling translation</article-title>
        <source>Genome Res</source>
        <year>2014</year>
        <volume>24</volume>
        <issue>12</issue>
        <fpage>2011</fpage>
        <lpage>2021</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.175893.114</pub-id>
        <?supplied-pmid 25294246?>
        <pub-id pub-id-type="pmid">25294246</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wilson</surname>
            <given-names>DN</given-names>
          </name>
          <name>
            <surname>Arenz</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Beckmann</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Translation regulation via nascent polypeptide-mediated ribosome stalling</article-title>
        <source>Curr Opin Struct Biol</source>
        <year>2016</year>
        <volume>37</volume>
        <fpage>123</fpage>
        <lpage>133</lpage>
        <pub-id pub-id-type="doi">10.1016/j.sbi.2016.01.008</pub-id>
        <?supplied-pmid 26859868?>
        <pub-id pub-id-type="pmid">26859868</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Sachs</surname>
            <given-names>MS</given-names>
          </name>
        </person-group>
        <article-title>Ribosome stalling is responsible for arginine-specific translational attenuation in Neurospora crassa</article-title>
        <source>Mol Cell Biol</source>
        <year>1997</year>
        <volume>17</volume>
        <issue>9</issue>
        <fpage>4904</fpage>
        <lpage>4913</lpage>
        <pub-id pub-id-type="doi">10.1128/MCB.17.9.4904</pub-id>
        <?supplied-pmid 9271370?>
        <pub-id pub-id-type="pmid">9271370</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ruiz-Orera</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Messeguer</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Subirana</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Alba</surname>
            <given-names>MM</given-names>
          </name>
        </person-group>
        <article-title>Long non-coding RNAs as a source of new peptides</article-title>
        <source>Elife</source>
        <year>2014</year>
        <volume>3</volume>
        <fpage>e03523</fpage>
        <pub-id pub-id-type="doi">10.7554/eLife.03523</pub-id>
        <?supplied-pmid 25233276?>
        <pub-id pub-id-type="pmid">25233276</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>McManus</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Kingsford</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Isoform-level ribosome occupancy estimation guided by transcript abundance with Ribomap</article-title>
        <source>Bioinformatics</source>
        <year>2016</year>
        <volume>32</volume>
        <issue>12</issue>
        <fpage>1880</fpage>
        <lpage>1882</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btw085</pub-id>
        <?supplied-pmid 27153676?>
        <pub-id pub-id-type="pmid">27153676</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Popa</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Lebrigand</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Paquet</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Nottet</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Robbe-Sermesant</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Waldmann</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Barbry</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>RiboProfiling: a Bioconductor package for standard Ribo-seq pipeline processing</article-title>
        <source>F1000Res</source>
        <year>2016</year>
        <volume>5</volume>
        <fpage>1309</fpage>
        <pub-id pub-id-type="doi">10.12688/f1000research.8964.1</pub-id>
        <?supplied-pmid 27347386?>
        <pub-id pub-id-type="pmid">27347386</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chung</surname>
            <given-names>BY</given-names>
          </name>
          <name>
            <surname>Hardcastle</surname>
            <given-names>TJ</given-names>
          </name>
          <name>
            <surname>Jones</surname>
            <given-names>JD</given-names>
          </name>
          <name>
            <surname>Irigoyen</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Firth</surname>
            <given-names>AE</given-names>
          </name>
          <name>
            <surname>Baulcombe</surname>
            <given-names>DC</given-names>
          </name>
          <name>
            <surname>Brierley</surname>
            <given-names>I</given-names>
          </name>
        </person-group>
        <article-title>The use of duplex-specific nuclease in ribosome profiling and a user-friendly software package for Ribo-seq data analysis</article-title>
        <source>Rna</source>
        <year>2015</year>
        <volume>21</volume>
        <issue>10</issue>
        <fpage>1731</fpage>
        <lpage>1745</lpage>
        <pub-id pub-id-type="doi">10.1261/rna.052548.115</pub-id>
        <?supplied-pmid 26286745?>
        <pub-id pub-id-type="pmid">26286745</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dunn</surname>
            <given-names>JG</given-names>
          </name>
          <name>
            <surname>Weissman</surname>
            <given-names>JS</given-names>
          </name>
        </person-group>
        <article-title>Plastid: nucleotide-resolution analysis of next-generation sequencing and genomics data</article-title>
        <source>BMC Genomics</source>
        <year>2016</year>
        <volume>17</volume>
        <issue>1</issue>
        <fpage>958</fpage>
        <pub-id pub-id-type="doi">10.1186/s12864-016-3278-x</pub-id>
        <?supplied-pmid 27875984?>
        <pub-id pub-id-type="pmid">27875984</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Michel</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Mullan</surname>
            <given-names>JP</given-names>
          </name>
          <name>
            <surname>Velayudhan</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>O'Connor</surname>
            <given-names>PB</given-names>
          </name>
          <name>
            <surname>Donohue</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Baranov</surname>
            <given-names>PV</given-names>
          </name>
        </person-group>
        <article-title>RiboGalaxy: a browser based platform for the alignment, analysis and visualization of ribosome profiling data</article-title>
        <source>RNA Biol</source>
        <year>2016</year>
        <volume>13</volume>
        <issue>3</issue>
        <fpage>316</fpage>
        <lpage>319</lpage>
        <pub-id pub-id-type="doi">10.1080/15476286.2016.1141862</pub-id>
        <?supplied-pmid 26821742?>
        <pub-id pub-id-type="pmid">26821742</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Cui</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Jin</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Guo</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Yin</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>He</surname>
            <given-names>QY</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Translating mRNAs strongly correlate to proteins in a multivariate manner and their translation ratios are phenotype specific</article-title>
        <source>Nucleic Acids Res</source>
        <year>2013</year>
        <volume>41</volume>
        <issue>9</issue>
        <fpage>4743</fpage>
        <lpage>4754</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkt178</pub-id>
        <?supplied-pmid 23519614?>
        <pub-id pub-id-type="pmid">23519614</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Xiang</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Zheng</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Jin</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>TranslatomeDB: a comprehensive database and cloud-based analysis platform for translatome sequencing data</article-title>
        <source>Nucleic Acids Res</source>
        <year>2018</year>
        <volume>46</volume>
        <issue>D1</issue>
        <fpage>D206</fpage>
        <lpage>D212</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkx1034</pub-id>
        <?supplied-pmid 29106630?>
        <pub-id pub-id-type="pmid">29106630</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lian</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Guo</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Gu</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Cui</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Zhong</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Jin</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>He</surname>
            <given-names>QY</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Genome-wide and experimental resolution of relative translation elongation speed at individual gene level in human cells</article-title>
        <source>PLoS Genet</source>
        <year>2016</year>
        <volume>12</volume>
        <issue>2</issue>
        <fpage>e1005901</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pgen.1005901</pub-id>
        <?supplied-pmid 26926465?>
        <pub-id pub-id-type="pmid">26926465</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hsieh</surname>
            <given-names>AC</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Edlind</surname>
            <given-names>MP</given-names>
          </name>
          <name>
            <surname>Ingolia</surname>
            <given-names>NT</given-names>
          </name>
          <name>
            <surname>Janes</surname>
            <given-names>MR</given-names>
          </name>
          <name>
            <surname>Sher</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Shi</surname>
            <given-names>EY</given-names>
          </name>
          <name>
            <surname>Stumpf</surname>
            <given-names>CR</given-names>
          </name>
          <name>
            <surname>Christensen</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Bonham</surname>
            <given-names>MJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The translational landscape of mTOR signalling steers cancer initiation and metastasis</article-title>
        <source>Nature</source>
        <year>2012</year>
        <volume>485</volume>
        <issue>7396</issue>
        <fpage>55</fpage>
        <lpage>61</lpage>
        <pub-id pub-id-type="doi">10.1038/nature10912</pub-id>
        <?supplied-pmid 22367541?>
        <pub-id pub-id-type="pmid">22367541</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dobin</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Davis</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Schlesinger</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Drenkow</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Zaleski</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Jha</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Batut</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Chaisson</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Gingeras</surname>
            <given-names>TR</given-names>
          </name>
        </person-group>
        <article-title>STAR: ultrafast universal RNA-seq aligner</article-title>
        <source>Bioinformatics</source>
        <year>2013</year>
        <volume>29</volume>
        <issue>1</issue>
        <fpage>15</fpage>
        <lpage>21</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bts635</pub-id>
        <?supplied-pmid 23104886?>
        <pub-id pub-id-type="pmid">23104886</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Patro</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Duggal</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Love</surname>
            <given-names>MI</given-names>
          </name>
          <name>
            <surname>Irizarry</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Kingsford</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Salmon provides fast and bias-aware quantification of transcript expression</article-title>
        <source>Nat Methods</source>
        <year>2017</year>
        <volume>14</volume>
        <issue>4</issue>
        <fpage>417</fpage>
        <lpage>419</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.4197</pub-id>
        <?supplied-pmid 5600148?>
        <pub-id pub-id-type="pmid">28263959</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Reuveni</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Meilijson</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Kupiec</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Ruppin</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Tuller</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Genome-scale analysis of translation elongation with a ribosome flow model</article-title>
        <source>PLoS Comput Biol</source>
        <year>2011</year>
        <volume>7</volume>
        <issue>9</issue>
        <fpage>e1002127</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1002127</pub-id>
        <?supplied-pmid 21909250?>
        <pub-id pub-id-type="pmid">21909250</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <mixed-citation publication-type="other">Sipos B, Slodkowicz G, Massingham T, Goldman N. Realistic simulations reveal extensive sample-specificity of RNA-seq biases. Quant Biol. 2013. <ext-link ext-link-type="uri" xlink:href="https://arxiv.org/abs/1308.3172">https://arxiv.org/abs/1308.3172</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Albert</surname>
            <given-names>FW</given-names>
          </name>
          <name>
            <surname>Muzzey</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Weissman</surname>
            <given-names>JS</given-names>
          </name>
          <name>
            <surname>Kruglyak</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>Genetic influences on translation in yeast</article-title>
        <source>PLoS Genet</source>
        <year>2014</year>
        <volume>10</volume>
        <issue>10</issue>
        <fpage>e1004692</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pgen.1004692</pub-id>
        <?supplied-pmid 25340754?>
        <pub-id pub-id-type="pmid">25340754</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>McManus</surname>
            <given-names>CJ</given-names>
          </name>
          <name>
            <surname>May</surname>
            <given-names>GE</given-names>
          </name>
          <name>
            <surname>Spealman</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Shteyman</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Ribosome profiling reveals post-transcriptional buffering of divergent gene expression in yeast</article-title>
        <source>Genome Res</source>
        <year>2014</year>
        <volume>24</volume>
        <issue>3</issue>
        <fpage>422</fpage>
        <lpage>430</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.164996.113</pub-id>
        <?supplied-pmid 24318730?>
        <pub-id pub-id-type="pmid">24318730</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mohammad</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Woolstenhulme</surname>
            <given-names>CJ</given-names>
          </name>
          <name>
            <surname>Green</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Buskirk</surname>
            <given-names>AR</given-names>
          </name>
        </person-group>
        <article-title>Clarifying the translational pausing landscape in Bacteria by ribosome profiling</article-title>
        <source>Cell Rep</source>
        <year>2016</year>
        <volume>14</volume>
        <issue>4</issue>
        <fpage>686</fpage>
        <lpage>694</lpage>
        <pub-id pub-id-type="doi">10.1016/j.celrep.2015.12.073</pub-id>
        <?supplied-pmid 26776510?>
        <pub-id pub-id-type="pmid">26776510</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Castelo-Szekely</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Arpat</surname>
            <given-names>AB</given-names>
          </name>
          <name>
            <surname>Janich</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Gatfield</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Translational contributions to tissue specificity in rhythmic and constitutive gene expression</article-title>
        <source>Genome Biol</source>
        <year>2017</year>
        <volume>18</volume>
        <issue>1</issue>
        <fpage>116</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-017-1222-2</pub-id>
        <?supplied-pmid 28622766?>
        <pub-id pub-id-type="pmid">28622766</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Iwasaki</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Iwasaki</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Takahashi</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Sakamoto</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Watanabe</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Shichino</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Floor</surname>
            <given-names>SN</given-names>
          </name>
          <name>
            <surname>Fujiwara</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Mito</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Dodo</surname>
            <given-names>K</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The translation inhibitor Rocaglamide targets a bimolecular cavity between eIF4A and Polypurine RNA</article-title>
        <source>Mol Cell</source>
        <year>2019</year>
        <volume>73</volume>
        <issue>4</issue>
        <fpage>738</fpage>
        <lpage>748</lpage>
        <pub-id pub-id-type="doi">10.1016/j.molcel.2018.11.026</pub-id>
        <?supplied-pmid 30595437?>
        <pub-id pub-id-type="pmid">30595437</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <mixed-citation publication-type="other">Chollet F, Others. Keras. 2015. Available from: <ext-link ext-link-type="uri" xlink:href="https://keras.io">https://keras.io</ext-link>. <ext-link ext-link-type="uri" xlink:href="https://keras.io/getting-started/faq/#how-should-i-cite-keras">https://keras.io/getting-started/faq/#how-should-i-cite-keras</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Guo</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Ingolia</surname>
            <given-names>NT</given-names>
          </name>
          <name>
            <surname>Weissman</surname>
            <given-names>JS</given-names>
          </name>
          <name>
            <surname>Bartel</surname>
            <given-names>DP</given-names>
          </name>
        </person-group>
        <article-title>Mammalian microRNAs predominantly act to decrease target mRNA levels</article-title>
        <source>Nature</source>
        <year>2010</year>
        <volume>466</volume>
        <issue>7308</issue>
        <fpage>835</fpage>
        <lpage>840</lpage>
        <pub-id pub-id-type="doi">10.1038/nature09267</pub-id>
        <?supplied-pmid 20703300?>
        <pub-id pub-id-type="pmid">20703300</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Taylor</surname>
            <given-names>BS</given-names>
          </name>
          <name>
            <surname>Schultz</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Hieronymus</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Gopalan</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Xiao</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Carver</surname>
            <given-names>BS</given-names>
          </name>
          <name>
            <surname>Arora</surname>
            <given-names>VK</given-names>
          </name>
          <name>
            <surname>Kaushik</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Cerami</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Reva</surname>
            <given-names>B</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Integrative genomic profiling of human prostate cancer</article-title>
        <source>Cancer Cell</source>
        <year>2010</year>
        <volume>18</volume>
        <issue>1</issue>
        <fpage>11</fpage>
        <lpage>22</lpage>
        <pub-id pub-id-type="doi">10.1016/j.ccr.2010.05.026</pub-id>
        <?supplied-pmid 20579941?>
        <pub-id pub-id-type="pmid">20579941</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Guertin</surname>
            <given-names>DA</given-names>
          </name>
          <name>
            <surname>Sabatini</surname>
            <given-names>DM</given-names>
          </name>
        </person-group>
        <article-title>Defining the role of mTOR in cancer</article-title>
        <source>Cancer Cell</source>
        <year>2007</year>
        <volume>12</volume>
        <issue>1</issue>
        <fpage>9</fpage>
        <lpage>22</lpage>
        <pub-id pub-id-type="doi">10.1016/j.ccr.2007.05.008</pub-id>
        <?supplied-pmid 17613433?>
        <pub-id pub-id-type="pmid">17613433</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Novoa</surname>
            <given-names>EM</given-names>
          </name>
          <name>
            <surname>Ribas de Pouplana</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>Speeding with control: codon usage, tRNAs, and ribosomes</article-title>
        <source>Trends Genet</source>
        <year>2012</year>
        <volume>28</volume>
        <issue>11</issue>
        <fpage>574</fpage>
        <lpage>581</lpage>
        <pub-id pub-id-type="doi">10.1016/j.tig.2012.07.006</pub-id>
        <?supplied-pmid 22921354?>
        <pub-id pub-id-type="pmid">22921354</pub-id>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Anderson</surname>
            <given-names>WF</given-names>
          </name>
        </person-group>
        <article-title>The effect of tRNA concentration on the rate of protein synthesis</article-title>
        <source>Proc Natl Acad Sci U S A</source>
        <year>1969</year>
        <volume>62</volume>
        <issue>2</issue>
        <fpage>566</fpage>
        <lpage>573</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.62.2.566</pub-id>
        <?supplied-pmid 4894331?>
        <pub-id pub-id-type="pmid">4894331</pub-id>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tuller</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Carmi</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Vestsigian</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Navon</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Dorfan</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Zaborske</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Pan</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Dahan</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Furman</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Pilpel</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>An evolutionarily conserved mechanism for controlling the efficiency of protein translation</article-title>
        <source>Cell</source>
        <year>2010</year>
        <volume>141</volume>
        <issue>2</issue>
        <fpage>344</fpage>
        <lpage>354</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2010.03.031</pub-id>
        <?supplied-pmid 20403328?>
        <pub-id pub-id-type="pmid">20403328</pub-id>
      </element-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dittmar</surname>
            <given-names>KA</given-names>
          </name>
          <name>
            <surname>Goodenbour</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Pan</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Tissue-specific differences in human transfer RNA expression</article-title>
        <source>PLoS Genet</source>
        <year>2006</year>
        <volume>2</volume>
        <issue>12</issue>
        <fpage>e221</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pgen.0020221</pub-id>
        <?supplied-pmid 17194224?>
        <pub-id pub-id-type="pmid">17194224</pub-id>
      </element-citation>
    </ref>
    <ref id="CR41">
      <label>41.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Trapnell</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Williams</surname>
            <given-names>BA</given-names>
          </name>
          <name>
            <surname>Pertea</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Mortazavi</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Kwan</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>van Baren</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Salzberg</surname>
            <given-names>SL</given-names>
          </name>
          <name>
            <surname>Wold</surname>
            <given-names>BJ</given-names>
          </name>
          <name>
            <surname>Pachter</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>Transcript assembly and quantification by RNA-Seq reveals unannotated transcripts and isoform switching during cell differentiation</article-title>
        <source>Nat Biotechnol</source>
        <year>2010</year>
        <volume>28</volume>
        <issue>5</issue>
        <fpage>511</fpage>
        <lpage>515</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.1621</pub-id>
        <?supplied-pmid 20436464?>
        <pub-id pub-id-type="pmid">20436464</pub-id>
      </element-citation>
    </ref>
    <ref id="CR42">
      <label>42.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Ruotti</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Stewart</surname>
            <given-names>RM</given-names>
          </name>
          <name>
            <surname>Thomson</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Dewey</surname>
            <given-names>CN</given-names>
          </name>
        </person-group>
        <article-title>RNA-Seq gene expression estimation with read mapping uncertainty</article-title>
        <source>Bioinformatics</source>
        <year>2010</year>
        <volume>26</volume>
        <issue>4</issue>
        <fpage>493</fpage>
        <lpage>500</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btp692</pub-id>
        <pub-id pub-id-type="pmid">20022975</pub-id>
      </element-citation>
    </ref>
    <ref id="CR43">
      <label>43.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Roberts</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Pachter</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>Streaming fragment assignment for real-time analysis of sequencing experiments</article-title>
        <source>Nat Methods</source>
        <year>2013</year>
        <volume>10</volume>
        <issue>1</issue>
        <fpage>71</fpage>
        <lpage>73</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.2251</pub-id>
        <?supplied-pmid 23160280?>
        <pub-id pub-id-type="pmid">23160280</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
