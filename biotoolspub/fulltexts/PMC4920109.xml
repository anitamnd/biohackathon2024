<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d1 20130915//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 39.96?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-id journal-id-type="hwp">bioinfo</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">4920109</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btw052</article-id>
    <article-id pub-id-type="publisher-id">btw052</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Papers</subject>
        <subj-group subj-group-type="heading">
          <subject>Genetics and Population Analysis</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>metaCCA: summary statistics-based multivariate meta-analysis of genome-wide association studies using canonical correlation analysis</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Cichonska</surname>
          <given-names>Anna</given-names>
        </name>
        <xref ref-type="aff" rid="btw052-aff1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="btw052-aff2">
          <sup>2</sup>
        </xref>
        <xref ref-type="corresp" rid="btw052-cor1">*</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Rousu</surname>
          <given-names>Juho</given-names>
        </name>
        <xref ref-type="aff" rid="btw052-aff2">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Marttinen</surname>
          <given-names>Pekka</given-names>
        </name>
        <xref ref-type="aff" rid="btw052-aff2">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Kangas</surname>
          <given-names>Antti J.</given-names>
        </name>
        <xref ref-type="aff" rid="btw052-aff3">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Soininen</surname>
          <given-names>Pasi</given-names>
        </name>
        <xref ref-type="aff" rid="btw052-aff3">
          <sup>3</sup>
        </xref>
        <xref ref-type="aff" rid="btw052-aff4">
          <sup>4</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Lehtimäki</surname>
          <given-names>Terho</given-names>
        </name>
        <xref ref-type="aff" rid="btw052-aff5">
          <sup>5</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Raitakari</surname>
          <given-names>Olli T.</given-names>
        </name>
        <xref ref-type="aff" rid="btw052-aff6">
          <sup>6</sup>
        </xref>
        <xref ref-type="aff" rid="btw052-aff7">
          <sup>7</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Järvelin</surname>
          <given-names>Marjo-Riitta</given-names>
        </name>
        <xref ref-type="aff" rid="btw052-aff8">
          <sup>8</sup>
        </xref>
        <xref ref-type="aff" rid="btw052-aff9">
          <sup>9</sup>
        </xref>
        <xref ref-type="aff" rid="btw052-aff10">
          <sup>10</sup>
        </xref>
        <xref ref-type="aff" rid="btw052-aff11">
          <sup>11</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Salomaa</surname>
          <given-names>Veikko</given-names>
        </name>
        <xref ref-type="aff" rid="btw052-aff12">
          <sup>12</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ala-Korpela</surname>
          <given-names>Mika</given-names>
        </name>
        <xref ref-type="aff" rid="btw052-aff3">
          <sup>3</sup>
        </xref>
        <xref ref-type="aff" rid="btw052-aff4">
          <sup>4</sup>
        </xref>
        <xref ref-type="aff" rid="btw052-aff13">
          <sup>13</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ripatti</surname>
          <given-names>Samuli</given-names>
        </name>
        <xref ref-type="aff" rid="btw052-aff1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="btw052-aff14">
          <sup>14</sup>
        </xref>
        <xref ref-type="aff" rid="btw052-aff15">
          <sup>15</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Pirinen</surname>
          <given-names>Matti</given-names>
        </name>
        <xref ref-type="aff" rid="btw052-aff1">
          <sup>1</sup>
        </xref>
        <xref ref-type="corresp" rid="btw052-cor1">*</xref>
      </contrib>
      <aff id="btw052-aff1"><sup>1</sup>Institute for Molecular Medicine Finland FIMM, University of Helsinki, Helsinki, Finland, </aff>
      <aff id="btw052-aff2"><sup>2</sup>Helsinki Institute for Information Technology HIIT, Department of Computer Science, Aalto University, Espoo, Finland, </aff>
      <aff id="btw052-aff3"><sup>3</sup>Computational Medicine, University of Oulu, Oulu University Hospital and Biocenter Oulu, Oulu, Finland, </aff>
      <aff id="btw052-aff4"><sup>4</sup>NMR Metabolomics Laboratory, School of Pharmacy, University of Eastern Finland, Kuopio, Finland, </aff>
      <aff id="btw052-aff5"><sup>5</sup>Department of Clinical Chemistry, Fimlab Laboratories, University of Tampere School of Medicine, Tampere, Finland, </aff>
      <aff id="btw052-aff6"><sup>6</sup>Department of Clinical Physiology and Nuclear Medicine, University of Turku and Turku University Hospital, Turku, Finland, </aff>
      <aff id="btw052-aff7"><sup>7</sup>Research Centre of Applied and Preventive Cardiovascular Medicine, University of Turku and Department of Clinical Physiology and Nuclear Medicine, Turku University Hospital, Turku, Finland, </aff>
      <aff id="btw052-aff8"><sup>8</sup>Department of Epidemiology and Biostatistics, MRC-PHE Centre for Environment &amp; Health, School of Public Health, Imperial College London, London, UK, </aff>
      <aff id="btw052-aff9"><sup>9</sup>Centre for Life Course Epidemiology, Faculty of Medicine, University of Oulu, Oulu, Finland, </aff>
      <aff id="btw052-aff10"><sup>10</sup>Biocenter Oulu, University of Oulu, Oulu, Finland, </aff>
      <aff id="btw052-aff11"><sup>11</sup>Unit of Primary Care, Oulu University Hospital, Oulu, Finland, </aff>
      <aff id="btw052-aff12"><sup>12</sup>National Institute for Health and Welfare, Helsinki, Finland, </aff>
      <aff id="btw052-aff13"><sup>13</sup>Computational Medicine, School of Social and Community Medicine and the Medical Research Council Integrative Epidemiology Unit, University of Bristol, Bristol, UK, </aff>
      <aff id="btw052-aff14"><sup>14</sup>Public Health, University of Helsinki, Helsinki, Finland and </aff>
      <aff id="btw052-aff15"><sup>15</sup>Wellcome Trust Sanger Institute, Wellcome Trust Genome Campus, Hinxton, UK</aff>
    </contrib-group>
    <author-notes>
      <corresp id="btw052-cor1">*To whom correspondence should be addressed.</corresp>
      <fn id="btw050-FN1">
        <p>Associate Editor: Janet Kelso</p>
      </fn>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>01</day>
      <month>7</month>
      <year>2016</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>19</day>
      <month>2</month>
      <year>2016</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>19</day>
      <month>2</month>
      <year>2016</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. -->
    <volume>32</volume>
    <issue>13</issue>
    <fpage>1981</fpage>
    <lpage>1989</lpage>
    <history>
      <date date-type="received">
        <day>16</day>
        <month>7</month>
        <year>2015</year>
      </date>
      <date date-type="rev-recd">
        <day>04</day>
        <month>12</month>
        <year>2015</year>
      </date>
      <date date-type="accepted">
        <day>19</day>
        <month>1</month>
        <year>2016</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author 2016. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2016</copyright-year>
      <license xlink:href="http://creativecommons.org/licenses/by-nc/4.0/" license-type="creative-commons">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/">http://creativecommons.org/licenses/by-nc/4.0/</ext-link>), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.com</license-p>
      </license>
    </permissions>
    <abstract>
      <p><bold>Motivation</bold>: A dominant approach to genetic association studies is to perform univariate tests between genotype-phenotype pairs. However, analyzing related traits together increases statistical power, and certain complex associations become detectable only when several variants are tested jointly. Currently, modest sample sizes of individual cohorts, and restricted availability of individual-level genotype-phenotype data across the cohorts limit conducting multivariate tests.</p>
      <p><bold>Results</bold>: We introduce <italic>metaCCA</italic>, a computational framework for summary statistics-based analysis of a single or multiple studies that allows multivariate representation of both genotype and phenotype. It extends the statistical technique of canonical correlation analysis to the setting where original individual-level records are not available, and employs a covariance shrinkage algorithm to achieve robustness.</p>
      <p>Multivariate meta-analysis of two Finnish studies of nuclear magnetic resonance metabolomics by <italic>metaCCA</italic>, using standard univariate output from the program SNPTEST, shows an excellent agreement with the pooled individual-level analysis of original data. Motivated by strong multivariate signals in the lipid genes tested, we envision that multivariate association testing using <italic>metaCCA</italic> has a great potential to provide novel insights from already published summary statistics from high-throughput phenotyping technologies.</p>
      <p><bold>Availability and implementation</bold>: Code is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/aalto-ics-kepaco">https://github.com/aalto-ics-kepaco</ext-link></p>
      <p><bold>Contacts:</bold><email>anna.cichonska@helsinki.fi</email> or <email>matti.pirinen@helsinki.fi</email></p>
      <p><bold>Supplementary information:</bold><ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btw052/-/DC1">Supplementary data</ext-link> are available at <italic>Bioinformatics</italic> online.</p>
    </abstract>
    <counts>
      <page-count count="9"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Most human diseases and traits have a strong genetic component. Genome-wide association studies (GWAS) have proven effective in identifying genetic variation contributing to common complex disorders, including type 2 diabetes (<xref rid="btw052-B16" ref-type="bibr">Mahajan <italic>et al.</italic>, 2014</xref>), cardiovascular disease (<xref rid="btw052-B3" ref-type="bibr">Deloukas <italic>et al.</italic>, 2013</xref>), schizophrenia (<xref rid="btw052-B22" ref-type="bibr">Schizophrenia Working Group of the Psychiatric Genomics Consortium, 2014</xref>), and quantitative traits, such as lipid levels (<xref rid="btw052-B8" ref-type="bibr">Global Lipids Genetics Consortium, 2013</xref>; <xref rid="btw052-B27" ref-type="bibr">Surakka <italic>et al.</italic>, 2015</xref>) and metabolomics (<xref rid="btw052-B13" ref-type="bibr">Kettunen <italic>et al.</italic>, 2012</xref>; <xref rid="btw052-B23" ref-type="bibr">Shin <italic>et al.</italic>, 2014</xref>).</p>
    <p>A dominant approach to GWAS is to test one single-nucleotide polymorphism (SNP) at a time against one quantitative phenotype measure or a binary disease indicator. This univariate approach is unlikely to be optimal when millions of SNPs and a growing number of phenotypes, including serum metabolomic profiles (<xref rid="btw052-B13" ref-type="bibr">Kettunen <italic>et al.</italic>, 2012</xref>; <xref rid="btw052-B23" ref-type="bibr">Shin <italic>et al.</italic>, 2014</xref>), three-dimensional images (<xref rid="btw052-B34" ref-type="bibr">Wang <italic>et al.</italic>, 2013</xref>), and gene expression data (<xref rid="btw052-B2" ref-type="bibr">Ardlie <italic>et al.</italic>, 2015</xref>) become available simultaneously. Indeed, a recent comparison demonstrated that utilizing multivariate phenotype representation increases statistical power, and leads to richer findings in the association tests compared to the univariate analysis (<xref rid="btw052-B12" ref-type="bibr">Inouye <italic>et al.</italic>, 2012</xref>). Moreover, some complex genotype-phenotype correlations can be detected only when testing several genetic variants simultaneously (<xref rid="btw052-B19" ref-type="bibr">Marttinen <italic>et al.</italic>, 2014</xref>), and multi-genotype tests are common practice in rare variant association studies, where statistical power to detect any single variant is very small (<xref rid="btw052-B6" ref-type="bibr">Feng <italic>et al.</italic>, 2014</xref>; <xref rid="btw052-B15" ref-type="bibr">Lee <italic>et al.</italic>, 2014</xref>).</p>
    <p>Unfortunately, restricted availability of complete multivariate individual-level records across the cohorts currently limits multivariate analyses. Often, only the univariate GWAS summary statistics, i.e. univariate regression coefficients with their standard errors, from individual cohorts are publicly available. Hence, a major question is how we can use these univariate association results to carry out a multivariate meta-analysis of GWAS (<xref rid="btw052-B5" ref-type="bibr">Evangelou and Ioannidis, 2013</xref>), which is crucial to increase the power to identify novel genetic associations.</p>
    <p>Recently, two kinds of multivariate testing approaches operating on univariate summary statistics have been introduced: (i) one SNP against multiple traits (<xref rid="btw052-B26" ref-type="bibr">Stephens, 2013</xref>; <xref rid="btw052-B30" ref-type="bibr">van der Sluis <italic>et al.</italic>, 2013</xref>; <xref rid="btw052-B32" ref-type="bibr">Vuckovic <italic>et al.</italic>, 2015</xref>; <xref rid="btw052-B36" ref-type="bibr">Zhu <italic>et al.</italic>, 2015</xref>) and (ii) multiple SNPs against one trait (<xref rid="btw052-B6" ref-type="bibr">Feng <italic>et al.</italic>, 2014</xref>; <xref rid="btw052-B35" ref-type="bibr">Yang <italic>et al.</italic>, 2012</xref>). We propose a new framework, <italic>metaCCA</italic>, that unifies both of the existing approaches by allowing canonical correlation analysis (CCA) of multiple SNPs against multiple traits based on univariate summary statistics and publicly available databases.</p>
    <p>CCA is a well-established statistical technique for identifying linear relationships between two sets of variables, and has been successfully applied to GWAS (<xref rid="btw052-B7" ref-type="bibr">Ferreira and Purcell, 2009</xref>; <xref rid="btw052-B12" ref-type="bibr">Inouye <italic>et al.</italic>, 2012</xref>; <xref rid="btw052-B18" ref-type="bibr">Marttinen <italic>et al.</italic>, 2013</xref>; <xref rid="btw052-B28" ref-type="bibr">Tang and Ferreira, 2012</xref>). Our <italic>metaCCA</italic> method extends CCA to the setting where original individual-level measurements are not available. Instead, <italic>metaCCA</italic> works with three pieces of the full data covariance matrix, and applies a covariance shrinkage algorithm to achieve robustness. We demonstrate the performance of <italic>metaCCA</italic> using SNP and metabolite data from three Finnish cohorts. In summary, this paper makes the following contributions.
<list list-type="bullet"><list-item><p>To our knowledge, we provide the first computational framework for association testing between multivariate genotype and multivariate phenotype, based on univariate summary statistics from single or multiple GWAS. Our implementation is freely available.</p></list-item><list-item><p>We demonstrate how to accurately estimate correlation structures of phenotypic and genotypic variables without an access to the individual-level data.</p></list-item><list-item><p>We avoid false positive associations by a covariance shrinkage algorithm based on stabilization of the leading canonical correlation.</p></list-item><list-item><p>Our approach, <italic>metaCCA</italic>, is a general framework to conduct CCA when full data are not available, and therefore it is widely applicable also outside GWAS.</p></list-item></list></p>
    <p>A detailed discussion on the relationship between <italic>metaCCA</italic> and previously published multivariate association methods can be found in <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btw052/-/DC1">Supplementary Data</ext-link>.</p>
  </sec>
  <sec>
    <title>2 Methods</title>
    <p>This section is organized as follows. First, Section 2.1 explains univariate GWAS, the results of which, in the form of cross-covariance matrix, constitute an input to <italic>metaCCA</italic> described in Section 2.2; Section 2.3 demonstrates how a meta-analysis of several studies is conducted in our framework; Section 2.4 outlines a procedure for choosing SNPs representative of a given locus; finally, Section 2.5 introduces the data we used to test <italic>metaCCA</italic> in the meta-analytic setting.</p>
    <sec>
      <title>2.1 Univariate GWAS</title>
      <p>Let <italic>X</italic> and <italic>Y</italic> denote genotype and phenotype matrices of dimensions <inline-formula id="IE1"><mml:math id="IEQ1"><mml:mrow><mml:mi>N</mml:mi><mml:mo>×</mml:mo><mml:mi>G</mml:mi></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE2"><mml:math id="IEQ2"><mml:mrow><mml:mi>N</mml:mi><mml:mo>×</mml:mo><mml:mi>P</mml:mi></mml:mrow></mml:math></inline-formula>, respectively, storing the individual-level data; <italic>N</italic> the number of samples; <italic>G</italic> and <italic>P</italic> the number of genotypic and phenotypic variables, respectively. The columns of <italic>X</italic> and <italic>Y</italic> are standardized to have mean 0 and standard deviation 1.</p>
      <p>Typically, univariate GWAS analysis of quantitative traits tests for an association between each pair of genotype <inline-formula id="IE3"><mml:math id="IEQ3"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mi mathvariant="double-struck">R</mml:mi><mml:mi>N</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula> and phenotype <inline-formula id="IE4"><mml:math id="IEQ4"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mi mathvariant="double-struck">R</mml:mi><mml:mi>N</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula> separately using a linear model:
<disp-formula id="E1"><label>(1)</label><mml:math id="EQ1"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi mathvariant="bold-italic">ϵ</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula>
</p>
      <p>Coefficient β<italic><sub>gp</sub></italic>, corresponding to the slope of the regression line, is the parameter of interest, since it depicts the size of the effect of the genetic variant <inline-formula id="IE"><mml:math id="IEQ"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mi>g</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> on the trait <inline-formula id="IE6"><mml:math id="IEQ6"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>. Parameter α<italic><sub>gp</sub></italic> is an intercept on the <italic>y</italic>-axis, and ϵ indicates a Gaussian error term or noise. The model is fit by the method of <italic>least squares</italic> that leads to a closed-form estimate for the unknown parameter <inline-formula id="IE7"><mml:math id="IEQ7"><mml:mrow><mml:msub><mml:mtext>β</mml:mtext><mml:mrow><mml:mi>g</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:msubsup><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mi>g</mml:mi><mml:mi>T</mml:mi></mml:msubsup><mml:msub><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mo stretchy="false">]</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msubsup><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mi>g</mml:mi><mml:mi>T</mml:mi></mml:msubsup><mml:msub><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mi>y</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">]</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mi>y</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, where <italic>s<sub>xy</sub></italic> is a sample covariance of <inline-formula id="IE8"><mml:math id="IEQ8"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mi>g</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE9"><mml:math id="IEQ9"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, and <italic>s<sub>xx</sub></italic> = 1 is a sample variance of <inline-formula id="IE10"><mml:math id="IEQ10"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mi>g</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>. Hence, the cross-covariance matrix Σ<italic><sub>XY</sub></italic>between all genotypic and phenotypic variables is made of univariate regression coefficients β<italic><sub>gp</sub></italic>:
<disp-formula id="E2"><label>(2)</label><mml:math id="EQ2"><mml:mrow><mml:msub><mml:mi>Σ</mml:mi><mml:mrow><mml:mi>X</mml:mi><mml:mi>Y</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mi>X</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mtext>β</mml:mtext><mml:mrow><mml:mn>11</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mtext>β</mml:mtext><mml:mrow><mml:mn>12</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mo>⋯</mml:mo></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mtext>β</mml:mtext><mml:mrow><mml:mn>1</mml:mn><mml:mi>P</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mtext>β</mml:mtext><mml:mrow><mml:mn>21</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mtext>β</mml:mtext><mml:mrow><mml:mn>22</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mo>⋯</mml:mo></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mi>P</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>⋮</mml:mo></mml:mtd><mml:mtd><mml:mo>⋮</mml:mo></mml:mtd><mml:mtd><mml:mo>⋱</mml:mo></mml:mtd><mml:mtd><mml:mo>⋮</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mtext>β</mml:mtext><mml:mrow><mml:mi>G</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mtext>β</mml:mtext><mml:mrow><mml:mi>G</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mo>⋯</mml:mo></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mtext>β</mml:mtext><mml:mrow><mml:mi>G</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula>
</p>
      <p>An important note is that if the individual-level datasets <italic>X</italic> and <italic>Y</italic> were not standardized before applying the linear regression, the standardization can be achieved afterwards by a transformation
<disp-formula id="E3"><label>(3)</label><mml:math id="EQ3"><mml:mrow><mml:msubsup><mml:mtext>β</mml:mtext><mml:mrow><mml:mi>g</mml:mi><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mtext>STANDR</mml:mtext></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msqrt><mml:mi>N</mml:mi></mml:msqrt><mml:mo> </mml:mo><mml:mi>S</mml:mi><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>×</mml:mo><mml:msub><mml:mtext>β</mml:mtext><mml:mrow><mml:mi>g</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
where <italic>SE<sub>gp</sub></italic> indicates the standard error of β<italic><sub>gp</sub></italic>, as given by GWAS software. (Typically, <inline-formula id="IE11"><mml:math id="IEQ11"><mml:mrow><mml:msub><mml:mrow><mml:mtext>SE</mml:mtext></mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>≈</mml:mo><mml:msub><mml:mtext>σ</mml:mtext><mml:mi>p</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msqrt><mml:mi>N</mml:mi></mml:msqrt><mml:msqrt><mml:mrow><mml:mn>2</mml:mn><mml:msub><mml:mi>f</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msqrt><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, where σ<italic><sub>p</sub></italic> is the standard deviation of the trait <italic>p</italic>, and <italic>f<sub>g</sub></italic> is the minor allele frequency of SNP <italic>g</italic>, but uncertainty in genotype imputation causes deviations from this expression.)</p>
    </sec>
    <sec>
      <title>2.2 metaCCA</title>
      <p>Conducting multivariate association tests requires estimates of the dependencies between genotypic and phenotypic variables, denoted Σ<italic><sub>XX</sub></italic> and Σ<italic><sub>YY,</sub></italic> respectively. Typically, they are calculated based on the individual-level measurements <italic>X</italic> and <italic>Y</italic>:
<disp-formula id="E4"><label>(4)</label><mml:math id="EQ4"><mml:mrow><mml:msub><mml:mi>Σ</mml:mi><mml:mrow><mml:mi>X</mml:mi><mml:mi>X</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mi>X</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
<disp-formula id="E5"><label>(5)</label><mml:math id="EQ5"><mml:mrow><mml:msub><mml:mi>Σ</mml:mi><mml:mrow><mml:mi>Y</mml:mi><mml:mi>Y</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mi>Y</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula>
<italic>metaCCA</italic> operates on the cross-covariance matrix Σ<italic><sub>XY</sub></italic>(<xref ref-type="disp-formula" rid="E2">Equation 2</xref>), and correlation structures <inline-formula id="IE12"><mml:math id="IEQ12"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>Σ</mml:mi><mml:mo>ˆ</mml:mo></mml:mover><mml:mrow><mml:mi>X</mml:mi><mml:mi>X</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:msub><mml:mover accent="true"><mml:mi>Σ</mml:mi><mml:mo>ˆ</mml:mo></mml:mover><mml:mrow><mml:mi>Y</mml:mi><mml:mi>Y</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, estimated without an access to the individual-level data <italic>X</italic> and <italic>Y</italic> (<xref ref-type="fig" rid="btw052-F1">Fig. 1A, B</xref>). To make the resulting full covariance matrix Σ a valid covariance matrix, <italic>metaCCA</italic> applies a shrinkage algorithm (<xref ref-type="fig" rid="btw052-F1">Fig. 1C</xref>).
<fig id="btw052-F1" orientation="portrait" position="float"><label>Fig. 1.</label><caption><p>Schematic picture showing an overview of <italic>metaCCA</italic> framework for summary statistics-based multivariate association testing using canonical correlation analysis. (<bold>A</bold>) <italic>metaCCA</italic> operates on three pieces of the full covariance matrix Σ: Σ<italic><sub>XY</sub></italic>of univariate genotype-phenotype association results, Σ<italic><sub>XX</sub></italic> of genotype-genotype correlations, and Σ<italic><sub>Y Y</sub></italic>of phenotype-phenotype correlations. (<bold>B</bold>) <inline-formula id="IE66"><mml:math id="IEQ66"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>Σ</mml:mi><mml:mo>ˆ</mml:mo></mml:mover><mml:mrow><mml:mi>X</mml:mi><mml:mi>X</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is estimated from a reference database matching the study population, e.g. the 1000 Genomes, and phenotypic correlation structure <inline-formula id="IE67"><mml:math id="IEQ67"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>Σ</mml:mi><mml:mo>ˆ</mml:mo></mml:mover><mml:mrow><mml:mi>Y</mml:mi><mml:mi>Y</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is estimated from Σ<italic><sub>XY.</sub></italic> (<bold>C</bold>) A covariance shrinkage algorithm is applied to add robustness to the method. Numbers in brackets refer to subsections in Methods. Meta-analysis of several studies is performed by pooling covariance matrices of the same type, before step (C), as described in Section 2.3. The data reduction achieved by <italic>metaCCA</italic> can be seen in <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btw052/-/DC1">Supplementary Figure S1</ext-link></p></caption><graphic xlink:href="btw052f1p"/></fig>
</p>
      <p>The rest of this section describes the details of <italic>metaCCA</italic> framework.</p>
      <sec>
        <title>2.2.1 Estimation of genotypic correlation structure</title>
        <p>Genetic variation is organized in haplotype blocks, whose structure is determined by mutation and recombination events, together with demographic effects, including population growth, admixture and bottlenecks (<xref rid="btw052-B33" ref-type="bibr">Wall and Pritchard, 2003</xref>). Hence, correlation structure of genetic variants differs between populations, such as, e.g. the Finns, Icelanders or Central Europeans. In <italic>metaCCA</italic>, <inline-formula id="IE13"><mml:math id="IEQ13"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>Σ</mml:mi><mml:mo>ˆ</mml:mo></mml:mover><mml:mrow><mml:mi>X</mml:mi><mml:mi>X</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is calculated using a reference database representing the study population, such as the 1000 Genomes database (<xref rid="btw052-B1" ref-type="bibr">1000 Genomes Project Consortium, 2012</xref>, <ext-link ext-link-type="uri" xlink:href="http://www.1000genomes.org">www.1000genomes.org</ext-link>), or other genotypic data available on the target population. In the Section 3, we demonstrate that estimating <inline-formula id="IE14"><mml:math id="IEQ14"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>Σ</mml:mi><mml:mo>ˆ</mml:mo></mml:mover><mml:mrow><mml:mi>X</mml:mi><mml:mi>X</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> from the target population (in our case, the Finns) leads to better results than utilizing the data comprising individuals across distinct populations (e.g. the Finns and other Europeans). However, since reference data on the target population may not always be at hand, we also present a robust but less powerful solution to multivariate association testing by simply using genotypes of all individuals from a certain broader geographical region (e.g. a continent) available under the 1000 Genomes Project.</p>
      </sec>
      <sec>
        <title>2.2.2 Estimation of phenotypic correlation structure</title>
        <p>In our framework, phenotypic correlation structure <inline-formula id="IE15"><mml:math id="IEQ15"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>Σ</mml:mi><mml:mo>ˆ</mml:mo></mml:mover><mml:mrow><mml:mi>Y</mml:mi><mml:mi>Y</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is computed based on Σ<italic><sub>XY.</sub></italic> Each entry of <inline-formula id="IE16"><mml:math id="IEQ16"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>Σ</mml:mi><mml:mo>ˆ</mml:mo></mml:mover><mml:mrow><mml:mi>Y</mml:mi><mml:mi>Y</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> corresponds to a Pearson correlation between two column vectors of Σ<italic><sub>XY</sub></italic>- univariate regression coefficients of two phenotypic variables <italic>s</italic> and <italic>t</italic> across <italic>G</italic> genetic variants:
<disp-formula id="E6"><label>(6)</label><mml:math id="EQ6"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>Σ</mml:mi><mml:mo>ˆ</mml:mo></mml:mover><mml:mrow><mml:mi>Y</mml:mi><mml:mi>Y</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>g</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>G</mml:mi></mml:munderover><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mtext>β</mml:mtext><mml:mrow><mml:mi>g</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mtext>μ</mml:mtext><mml:mi>s</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mtext>β</mml:mtext><mml:mrow><mml:mi>g</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mtext>μ</mml:mtext><mml:mi>t</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:mrow><mml:mrow><mml:msqrt><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>g</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>G</mml:mi></mml:munderover><mml:mrow><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mtext>β</mml:mtext><mml:mrow><mml:mi>g</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mtext>μ</mml:mtext><mml:mi>s</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mstyle></mml:mrow></mml:msqrt><mml:msqrt><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>g</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>G</mml:mi></mml:munderover><mml:mrow><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mtext>β</mml:mtext><mml:mrow><mml:mi>g</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mtext>μ</mml:mtext><mml:mi>t</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mstyle></mml:mrow></mml:msqrt></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
where μ<italic><sub>s</sub></italic> and μ<italic><sub>t</sub></italic> are the mean values <inline-formula id="IE17"><mml:math id="IEQ17"><mml:mrow><mml:msub><mml:mtext>μ</mml:mtext><mml:mi>s</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>G</mml:mi></mml:mfrac><mml:mstyle displaystyle="false"><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>g</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>G</mml:mi></mml:msubsup><mml:mrow><mml:msub><mml:mtext>β</mml:mtext><mml:mrow><mml:mi>g</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE18"><mml:math id="IEQ18"><mml:mrow><mml:msub><mml:mtext>μ</mml:mtext><mml:mi>t</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>G</mml:mi></mml:mfrac><mml:mstyle displaystyle="false"><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>g</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>G</mml:mi></mml:msubsup><mml:mrow><mml:msub><mml:mtext>β</mml:mtext><mml:mrow><mml:mi>g</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:mrow></mml:math></inline-formula>. (The detailed justification is provided in <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btw052/-/DC1">Supplementary Data</ext-link>.) In <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btw052/-/DC1">Supplementary Table S2</ext-link>, we demonstrate that the higher the number of genotypic variables <italic>G</italic>, the lower the error of the estimate. Thus, <inline-formula id="IE19"><mml:math id="IEQ19"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>Σ</mml:mi><mml:mo>ˆ</mml:mo></mml:mover><mml:mrow><mml:mi>Y</mml:mi><mml:mi>Y</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> should be calculated from summary statistics of all available genetic variants, even if only a subset of them is taken to the further analysis.</p>
      </sec>
      <sec>
        <title>2.2.3 Canonical correlation analysis</title>
        <p>CCA (<xref rid="btw052-B10" ref-type="bibr">Hotelling, 1936</xref>) is a multivariate technique for detecting linear relationships between two groups of variables <inline-formula id="IE20"><mml:math id="IEQ20"><mml:mrow><mml:mi>X</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mi mathvariant="double-struck">R</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>×</mml:mo><mml:mi>G</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE21"><mml:math id="IEQ21"><mml:mrow><mml:mi>Y</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mi mathvariant="double-struck">R</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>×</mml:mo><mml:mi>P</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, where <italic>X</italic> and <italic>Y</italic> constitute two different views of the same object. The objective is to find maximally correlated linear combinations of columns of each matrix. This corresponds to finding vectors <inline-formula id="IE22"><mml:math id="IEQ22"><mml:mrow><mml:mi mathvariant="bold-italic">a</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mi mathvariant="double-struck">R</mml:mi><mml:mi>G</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE23"><mml:math id="IEQ23"><mml:mrow><mml:mi mathvariant="bold-italic">b</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mi mathvariant="double-struck">R</mml:mi><mml:mi>P</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula> that maximize
<disp-formula id="E7"><label>(7)</label><mml:math id="EQ7"><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>X</mml:mi><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi mathvariant="bold-italic">a</mml:mi></mml:mstyle><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>Y</mml:mi><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi mathvariant="bold-italic">b</mml:mi></mml:mstyle><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo>‖</mml:mo><mml:mi>X</mml:mi><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi mathvariant="bold-italic">a</mml:mi></mml:mstyle><mml:mo>‖</mml:mo><mml:mtext> </mml:mtext><mml:mo>‖</mml:mo><mml:mi>Y</mml:mi><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi mathvariant="bold-italic">b</mml:mi></mml:mstyle><mml:mo>‖</mml:mo></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mi mathvariant="bold-italic">a</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:msub><mml:mi>Σ</mml:mi><mml:mrow><mml:mi>X</mml:mi><mml:mi>Y</mml:mi></mml:mrow></mml:msub><mml:mi mathvariant="bold-italic">b</mml:mi></mml:mrow><mml:mrow><mml:msqrt><mml:mrow><mml:msup><mml:mi mathvariant="bold-italic">a</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:msub><mml:mi>Σ</mml:mi><mml:mrow><mml:mi>X</mml:mi><mml:mi>X</mml:mi></mml:mrow></mml:msub><mml:mi mathvariant="bold-italic">a</mml:mi></mml:mrow></mml:msqrt><mml:msqrt><mml:mrow><mml:msup><mml:mi mathvariant="bold-italic">b</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:msub><mml:mi>Σ</mml:mi><mml:mrow><mml:mi>Y</mml:mi><mml:mi>Y</mml:mi></mml:mrow></mml:msub><mml:mi mathvariant="bold-italic">b</mml:mi></mml:mrow></mml:msqrt></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula>
</p>
        <p>The maximized correlation <italic>r</italic> is called <italic>canonical correlation</italic> between <italic>X</italic> and <italic>Y</italic>. We provide the technical details of the method, as well as its extension to subsequent canonical correlations and their significance testing in <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btw052/-/DC1">Supplementary Data</ext-link>.</p>
      </sec>
      <sec>
        <title>2.2.4 Shrinkage</title>
        <p>At this point, we have three covariance matrices, namely Σ<italic><sub>XY,</sub></italic>
<inline-formula id="IE24"><mml:math id="IEQ24"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>Σ</mml:mi><mml:mo>ˆ</mml:mo></mml:mover><mml:mrow><mml:mi>X</mml:mi><mml:mi>X</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, and <inline-formula id="IE25"><mml:math id="IEQ25"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>Σ</mml:mi><mml:mo>ˆ</mml:mo></mml:mover><mml:mrow><mml:mi>Y</mml:mi><mml:mi>Y</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>. However, in many cases, the resulting full covariance matrix
<disp-formula id="IE26"><mml:math id="IEQ26"><mml:mrow><mml:mi>Σ</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>Σ</mml:mi><mml:mo>ˆ</mml:mo></mml:mover><mml:mrow><mml:mi>X</mml:mi><mml:mi>X</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mi>Σ</mml:mi><mml:mrow><mml:mi>X</mml:mi><mml:mi>Y</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msubsup><mml:mi>Σ</mml:mi><mml:mrow><mml:mi>X</mml:mi><mml:mi>Y</mml:mi></mml:mrow><mml:mi>T</mml:mi></mml:msubsup></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>Σ</mml:mi><mml:mo>ˆ</mml:mo></mml:mover><mml:mrow><mml:mi>Y</mml:mi><mml:mi>Y</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula>
is not positive semidefinite (PSD), and therefore its building blocks cannot be just plugged into the CCA framework (<xref ref-type="disp-formula" rid="E7">Equation 7</xref>). To overcome this problem, in <italic>metaCCA</italic>, we apply shrinkage to find a nearest valid Σ (<xref rid="btw052-B14" ref-type="bibr">Ledoit and Wolf, 2003</xref>). We use an iterative procedure where the magnitudes of the off-diagonal entries are being shrunk towards zero until Σ becomes PSD (Algorithm 1).</p>
        <p>Assuring the PSD property of the full covariance matrix is necessary, although, as we demonstrate in the Section 3, not sufficient to obtain reliable results of the association analysis when the estimate <inline-formula id="IE27"><mml:math id="IEQ27"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>Σ</mml:mi><mml:mo>ˆ</mml:mo></mml:mover><mml:mrow><mml:mi>X</mml:mi><mml:mi>X</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> (and/or <inline-formula id="IE28"><mml:math id="IEQ28"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>Σ</mml:mi><mml:mo>ˆ</mml:mo></mml:mover><mml:mrow><mml:mi>Y</mml:mi><mml:mi>Y</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>) is noisy. In order to address this issue, we propose a variant of <italic>metaCCA</italic>, called <bold><italic>metaCCA+</italic></bold>, where the full covariance matrix Σ is shrunk beyond the level guaranteeing its PSD property. A challenge, however, is to find an optimal shrinkage intensity. Shrinkage applied without any stopping criterion would lead to gradual removal of all dependencies between genotypic and phenotypic variables. <xref rid="btw052-B14" ref-type="bibr">Ledoit and Wolf (2003)</xref> introduced an analytic approach for determining the optimal shrinkage level but it requires the individual-level datasets <italic>X</italic> and <italic>Y</italic>. In <italic>metaCCA+</italic>, we monitor the leading canonical correlation value <italic>r</italic>, and we continue the shrinkage of the full covariance matrix Σ until <italic>r</italic> stabilizes. Specifically, we track the percent change <italic>pc</italic> of <italic>r</italic> between subsequent shrinkage iterations, and we determine an appropriate amount of shrinkage using an elbow heuristic, similar to the criterion for finding the number of clusters, frequently used in the literature (<xref rid="btw052-B29" ref-type="bibr">Tibshirani <italic>et al.</italic>, 2001</xref>). The idea is that the slope of the graph should be steep to the left of the elbow, but stable to the right of it. We find the elbow, and thus the appropriate number of shrinkage iterations, by taking the point closest to the origin of the plot of <italic>pc</italic> versus iteration number, as schematically shown in <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btw052/-/DC1">Supplementary Figure S2</ext-link>.</p>
        <p>Building blocks <inline-formula id="IE29"><mml:math id="IEQ29"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>Σ</mml:mi><mml:mo>ˆ</mml:mo></mml:mover><mml:mrow><mml:mi>X</mml:mi><mml:mi>Y</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>Σ</mml:mi><mml:mo>ˆ</mml:mo></mml:mover><mml:mrow><mml:mi>X</mml:mi><mml:mi>X</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>Σ</mml:mi><mml:mo>ˆ</mml:mo></mml:mover><mml:mrow><mml:mi>Y</mml:mi><mml:mi>Y</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> of the resulting full covariance matrix Σ, shrunk until it became PSD or beyond, are then plugged into the CCA framework to get the final genotype-phenotype association result. In practice, in order to protect from false positive signals, the shrinkage mode of <italic>metaCCA+</italic> should be applied whenever <inline-formula id="IE30"><mml:math id="IEQ30"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>Σ</mml:mi><mml:mo>ˆ</mml:mo></mml:mover><mml:mrow><mml:mi>Y</mml:mi><mml:mi>Y</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is estimated from summary statistics of a small number of genetic variants, and/or <inline-formula id="IE31"><mml:math id="IEQ31"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>Σ</mml:mi><mml:mo>ˆ</mml:mo></mml:mover><mml:mrow><mml:mi>X</mml:mi><mml:mi>X</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is calculated using a generic reference population.</p>
        <p>
          <boxed-text id="btw052-BOX1" position="float" orientation="portrait">
            <label>Algorithm 1</label>
            <disp-formula id="E8">
              <mml:math id="EQ8">
                <mml:mrow>
                  <mml:mrow>
                    <mml:mo mathsize="32pt">|</mml:mo>
                    <mml:mo> </mml:mo>
                    <mml:mrow>
                      <mml:mtable>
                        <mml:mtr>
                          <mml:mtd>
                            <mml:mrow>
                              <mml:mstyle mathvariant="bold" mathsize="normal">
                                <mml:mi>w</mml:mi>
                                <mml:mi>h</mml:mi>
                                <mml:mi>i</mml:mi>
                                <mml:mi>l</mml:mi>
                                <mml:mi>e</mml:mi>
                              </mml:mstyle>
                              <mml:mo> </mml:mo>
                              <mml:mi>Σ</mml:mi>
                              <mml:mo> </mml:mo>
                              <mml:mtext>notPSD</mml:mtext>
                            </mml:mrow>
                          </mml:mtd>
                        </mml:mtr>
                        <mml:mtr>
                          <mml:mtd>
                            <mml:mrow>
                              <mml:mrow>
                                <mml:mo mathsize="27pt">|</mml:mo>
                                <mml:mo> </mml:mo>
                                <mml:mrow>
                                  <mml:mtable>
                                    <mml:mtr>
                                      <mml:mtd>
                                        <mml:mrow>
                                          <mml:mi>Σ</mml:mi>
                                          <mml:mo>=</mml:mo>
                                          <mml:mn>0.999</mml:mn>
                                          <mml:mo>×</mml:mo>
                                          <mml:mi>Σ</mml:mi>
                                          <mml:mo>;</mml:mo>
                                        </mml:mrow>
                                      </mml:mtd>
                                    </mml:mtr>
                                    <mml:mtr>
                                      <mml:mtd>
                                        <mml:mrow>
                                          <mml:mtext>diag</mml:mtext>
                                          <mml:mo stretchy="false">(</mml:mo>
                                          <mml:mi>Σ</mml:mi>
                                          <mml:mo stretchy="false">)</mml:mo>
                                          <mml:mo>=</mml:mo>
                                          <mml:mn>1</mml:mn>
                                          <mml:mo>;</mml:mo>
                                        </mml:mrow>
                                      </mml:mtd>
                                    </mml:mtr>
                                  </mml:mtable>
                                </mml:mrow>
                              </mml:mrow>
                            </mml:mrow>
                          </mml:mtd>
                        </mml:mtr>
                      </mml:mtable>
                    </mml:mrow>
                  </mml:mrow>
                </mml:mrow>
              </mml:math>
            </disp-formula>
          </boxed-text>
        </p>
      </sec>
      <sec>
        <title>2.2.5 Types of the multivariate association analysis</title>
        <p>We consider the following two types of the multivariate analysis.
<list list-type="order"><list-item><p><italic>Univariate genotype – multivariate phenotype</italic>One genetic variant tested for an association with a set of phenotypic variables (matrix <inline-formula id="IE32"><mml:math id="IEQ32"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>Σ</mml:mi><mml:mo>ˆ</mml:mo></mml:mover><mml:mrow><mml:mi>X</mml:mi><mml:mi>X</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> not needed).</p></list-item><list-item><p><italic>Multivariate genotype – multivariate phenotype</italic>A set of genetic variants tested for an association with a set of phenotypic variables.</p></list-item></list></p>
        <p>The first type corresponds to a standard multi-trait analysis. The second type takes into account the effects across genomic variants on multiple traits, which are ignored when analyzing only a single SNP or a single trait at a time.</p>
      </sec>
    </sec>
    <sec>
      <title>2.3 Meta-analysis</title>
      <p><italic>metaCCA</italic> allows to conduct summary statistics-based multivariate analysis of one or multiple GWAS. In the meta-analytic setting, covariance matrices <inline-formula id="IE33"><mml:math id="IEQ33"><mml:mrow><mml:msubsup><mml:mi>Σ</mml:mi><mml:mrow><mml:mi>X</mml:mi><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:msubsup><mml:mover accent="true"><mml:mi>Σ</mml:mi><mml:mo>ˆ</mml:mo></mml:mover><mml:mrow><mml:mi>X</mml:mi><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula>, and <inline-formula id="IE34"><mml:math id="IEQ34"><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>Σ</mml:mi><mml:mo>ˆ</mml:mo></mml:mover><mml:mrow><mml:mi>Y</mml:mi><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> corresponding to <italic>i </italic>=<italic> </italic>1,…,<italic>M</italic> independent studies on the same topic are pooled using a weighted average:
<disp-formula id="E9"><label>(8)</label><mml:math id="EQ9"><mml:mrow><mml:msub><mml:mi>Σ</mml:mi><mml:mrow><mml:mi>X</mml:mi><mml:mi>Y</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:msubsup><mml:mi>Σ</mml:mi><mml:mrow><mml:mi>X</mml:mi><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:mo>⋯</mml:mo><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>M</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:msubsup><mml:mi>Σ</mml:mi><mml:mrow><mml:mi>X</mml:mi><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mo>−</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
where <italic>N<sub>i</sub></italic> denotes the number of samples in the <inline-formula id="IE35"><mml:math id="IEQ35"><mml:mrow><mml:mi>i</mml:mi><mml:mtext>th</mml:mtext></mml:mrow></mml:math></inline-formula> cohort, and <inline-formula id="IE36"><mml:math id="IEQ36"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mo>⋯</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>M</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>. This step is performed before applying the shrinkage to the full covariance matrix. As is typical for a fixed-effects meta-analysis, the weighted average is used in order to account for the varying precision of the estimates. The formulas for <inline-formula id="IE37"><mml:math id="IEQ37"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>Σ</mml:mi><mml:mo>ˆ</mml:mo></mml:mover><mml:mrow><mml:mi>X</mml:mi><mml:mi>X</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE38"><mml:math id="IEQ38"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>Σ</mml:mi><mml:mo>ˆ</mml:mo></mml:mover><mml:mrow><mml:mi>Y</mml:mi><mml:mi>Y</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> are analogous to (8). However, if all cohorts included in the meta-analysis have the same underlying population, only one genotypic correlation estimate is needed.</p>
    </sec>
    <sec>
      <title>2.4 Choosing SNPs representing a locus</title>
      <p>When analyzing multiple genetic variants together, we use a procedure for selecting from a given locus a set of SNPs that jointly capture a maximal amount of genetic variation in the locus, as measured by a linkage disequilibrium (LD) score.</p>
      <p>In each iteration, a SNP <italic>g</italic> that maximizes LD-score, which we define as <inline-formula id="IE39"><mml:math id="IEQ39"><mml:mrow><mml:mstyle displaystyle="true"><mml:msub><mml:mo>∑</mml:mo><mml:mi>k</mml:mi></mml:msub><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>r</mml:mi><mml:mo>ˆ</mml:mo></mml:mover><mml:mrow><mml:mi>g</mml:mi><mml:mi>k</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:msubsup><mml:mtext>σ</mml:mtext><mml:mi>k</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mstyle></mml:mrow></mml:math></inline-formula>, is selected, where the sum is over all SNPs <italic>k</italic> that have not yet been chosen; <inline-formula id="IE40"><mml:math id="IEQ40"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>r</mml:mi><mml:mo>ˆ</mml:mo></mml:mover><mml:mrow><mml:mi>g</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> denotes a partial correlation between SNPs <italic>g</italic> and <italic>k</italic>; <inline-formula id="IE41"><mml:math id="IEQ41"><mml:mrow><mml:msubsup><mml:mtext>σ</mml:mtext><mml:mi>k</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></inline-formula> indicates empirical variance of the residuals for SNP <italic>k</italic> after the effects of the selected SNPs have been regressed out. The residual variance <inline-formula id="IE42"><mml:math id="IEQ42"><mml:mrow><mml:msubsup><mml:mtext>σ</mml:mtext><mml:mi>k</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></inline-formula> gets smaller, if the SNP has already been well explained by the previously chosen ones; hence, highly correlated SNPs will not be selected together. In the first iteration, <inline-formula id="IE43"><mml:math id="IEQ43"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>r</mml:mi><mml:mo>ˆ</mml:mo></mml:mover><mml:mrow><mml:mi>g</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is the Pearson correlation coefficient between SNPs <italic>g</italic> and <italic>k</italic>, and <inline-formula id="IE44"><mml:math id="IEQ44"><mml:mrow><mml:msubsup><mml:mtext>σ</mml:mtext><mml:mi>k</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, meaning that the starting SNP is the one capturing the highest amount of genetic variation in the region. For each locus, we select the smallest number of SNPs that explain, at median, over 95% of the variance of the remaining SNPs in the locus.</p>
    </sec>
    <sec>
      <title>2.5 Datasets</title>
      <p>In order to test our approach, we used genotypic and phenotypic data from three Finnish population cohorts: the Cardiovascular Risk in Young Finns Study (YFS, <italic>N</italic><sub>1 </sub>=<sub> </sub>2390; <xref rid="btw052-B20" ref-type="bibr">Raitakari <italic>et al.</italic>, 2008</xref>), the FINRISK study survey of 1997 (<italic>N</italic><sub>2 </sub>=<sub> </sub>3661; <xref rid="btw052-B31" ref-type="bibr">Vartiainen <italic>et al.</italic>, 2010</xref>), and the Northern Finland Birth Cohort 1966 (NFBC, <italic>N</italic><sub>3 </sub>=<sub> </sub>4702; <xref rid="btw052-B21" ref-type="bibr">Rantakallio, 1969</xref>). The detailed description of the cohorts can be found in <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btw052/-/DC1">Supplementary Data</ext-link>.</p>
      <p>Our phenotype data consist of 81 lipid measures (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btw052/-/DC1">Supplementary Table S1</ext-link>) from a high-throughput nuclear magnetic resonance (NMR) platform (<xref rid="btw052-B24" ref-type="bibr">Soininen <italic>et al.</italic>, 2009</xref>, <xref rid="btw052-B25" ref-type="bibr">2015</xref>). As a pre-processing step, within each cohort, each trait was quantile normalized, and the effects of age, sex and ten leading principal components of the genetic population structure were regressed out using a linear model. All cohorts were genotyped using Illumina arrays, and imputed by IMPUTE2 (<xref rid="btw052-B11" ref-type="bibr">Howie <italic>et al.</italic>, 2009</xref>) using the 1000 Genomes Project reference panel (<xref rid="btw052-B1" ref-type="bibr">1000 Genomes Project Consortium, 2012</xref>). In the analyses, we included 455 521 SNPs on chromosome 1 and, additionally, the SNPs in the following 5 genes:
<list list-type="bullet"><list-item><p><italic>APOE</italic> (apolipoprotein E), 259 SNPs on chr 19;</p></list-item><list-item><p><italic>CETP</italic> (cholesteryl ester transfer protein), 387 SNPs on chr 16;</p></list-item><list-item><p><italic>GCKR</italic> (glucokinase (hexokinase 4) regulator), 160 SNPs on chr 2;</p></list-item><list-item><p><italic>PCSK9</italic> (proprotein convertase subtilisin/kexin type 9), 265 SNPs on chr 1;</p></list-item><list-item><p><italic>NOD2</italic> (nucleotide-binding oligomerization domain containing 2), 145 SNPs on chr 16.</p></list-item></list></p>
      <p>We expected that this set of genes would provide a comprehensive spectrum of associations with our phenotypes, since <italic>APOE</italic>, <italic>CETP</italic>, <italic>GCKR</italic>, and <italic>PCSK9</italic> have well-known associations to lipid levels, whereas <italic>NOD2</italic> is not known to have such an association (NHGRI GWAS catalogue, <xref rid="btw052-B9" ref-type="bibr">Hindorff <italic>et al.</italic>, 2011</xref>, <ext-link ext-link-type="uri" xlink:href="http://www.genome.gov/gwastudies">www.genome.gov/gwastudies</ext-link>). All SNPs used were of good quality: IMPUTE2 info ≥0.8 (<xref rid="btw052-B17" ref-type="bibr">Marchini and Howie, 2010</xref>), and minor allele frequency ≥0.05.</p>
      <p>For multi-SNP models, we compared the results from Finnish genotype data with those obtained by estimating the genotypic correlation structure <inline-formula id="IE45"><mml:math id="IEQ45"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>Σ</mml:mi><mml:mo>ˆ</mml:mo></mml:mover><mml:mrow><mml:mi>X</mml:mi><mml:mi>X</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> from the 1000 Genomes Project data on 503 European individuals (release 20130502).</p>
      <p>For each cohort, genotypic and phenotypic correlation structures computed based on <inline-formula id="IE46"><mml:math id="IEQ46"><mml:mrow><mml:msup><mml:mi>X</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE47"><mml:math id="IEQ47"><mml:mrow><mml:msup><mml:mi>Y</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, as shown in the <xref ref-type="disp-formula" rid="E4">Equations (4)</xref> and <xref ref-type="disp-formula" rid="E5">(5)</xref>, can be found in <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btw052/-/DC1">Supplementary Figures S3 and S4</ext-link>.</p>
    </sec>
  </sec>
  <sec>
    <title>3 Results</title>
    <sec>
      <title>3.1 Performance assessment</title>
      <p>The purpose of this section is to validate that <italic>metaCCA</italic> applied to summary statistics produces similar results to the standard CCA (MATLAB function <italic>canoncorr</italic>) applied to the individual-level data.</p>
      <p>For <italic>metaCCA</italic>, we always use <inline-formula id="IE48"><mml:math id="IEQ48"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>Σ</mml:mi><mml:mo>ˆ</mml:mo></mml:mover><mml:mrow><mml:mi>Y</mml:mi><mml:mi>Y</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> estimated by the method described in Section 2.2.2 using summary statistics of the entire chromosome 1.</p>
      <p>We focus on the effects of (i) the amount of shrinkage applied to the full covariance matrix (<italic>metaCCA</italic>/<italic>metaCCA+</italic>) and (ii) estimating <inline-formula id="IE49"><mml:math id="IEQ49"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>Σ</mml:mi><mml:mo>ˆ</mml:mo></mml:mover><mml:mrow><mml:mi>X</mml:mi><mml:mi>X</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> from the population underlying the analysis (here, Finnish), or from a more heterogeneous panel (here, European individuals from the 1000 Genomes database).</p>
      <sec>
        <title>3.1.1 Univariate genotype – multivariate phenotype</title>
        <p>We conducted a meta-analysis of the three cohorts (YFS, FINRISK and NFBC) by testing associations between each SNP in the five genes (as listed in Section 2.5; 1 216 SNPs in total) with different numbers of traits, ranging from 2 to 50. Multi-trait analyses are most useful for correlated traits (<xref rid="btw052-B26" ref-type="bibr">Stephens, 2013</xref>). To reflect this, for each SNP, we started with a randomly selected trait, and at each step of the analysis, added the trait mostly correlated with the already chosen ones, excluding correlations with absolute values above 0.95. For each SNP, we repeated the procedure three times with different starting lipid measures.</p>
        <p>The scatter plot in <xref ref-type="fig" rid="btw052-F2">Figure 2a</xref> shows that <italic>metaCCA</italic> applied to the cohort-wise summary statistics provides an excellent agreement with the standard CCA of the pooled individual-level data. Thus, in this one-SNP–multi-trait analysis, due to the reliable <inline-formula id="IE50"><mml:math id="IEQ50"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>Σ</mml:mi><mml:mo>ˆ</mml:mo></mml:mover><mml:mrow><mml:mi>Y</mml:mi><mml:mi>Y</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> estimate used, we can base the inference on <italic>metaCCA</italic>, and put less weight on <italic>metaCCA+ </italic>(<xref ref-type="fig" rid="btw052-F2">Fig. 2b</xref>) that, as expected, produces conservative <italic>P</italic>-values.
<fig id="btw052-F2" orientation="portrait" position="float"><label>Fig. 2.</label><caption><p>Scatter plots of −log 10 <italic>P</italic>-values between the pooled individual-level analysis of original datasets (<italic>full data CCA</italic>) and <italic>metaCCA</italic> (first row), <italic>metaCCA+ </italic>(second row). (<bold>a</bold>, <bold>b</bold>) <italic>Univariate genotype – multivariate phenotype</italic>; meta-analysis of NFBC, FINRISK and YFS cohorts; (<bold>c</bold>–<bold>f</bold>) <italic>Multivariate genotype – multivariate phenotype</italic>; meta-analysis of NFBC and YFS cohorts; <italic>metaCCA</italic>/<italic>metaCCA+ </italic>was used with <inline-formula id="IE68"><mml:math id="IEQ68"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>Σ</mml:mi><mml:mo>ˆ</mml:mo></mml:mover><mml:mrow><mml:mi>X</mml:mi><mml:mi>X</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> computed from FINRISK (FIN; c, d), or from the 1000 Genomes database (1000G, 503 EUR individuals; e, f) In all the cases, lipid correlation structure <inline-formula id="IE69"><mml:math id="IEQ69"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>Σ</mml:mi><mml:mo>ˆ</mml:mo></mml:mover><mml:mrow><mml:mi>Y</mml:mi><mml:mi>Y</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> was calculated from univariate summary statistics of SNPs from the entire chromosome 1. Single point corresponds to the result of one out of (a–b) 178 752, (c–f) 4050 multivariate tests. Numbers at the top of each plot indicate percentages of at least 0.5 unit overestimated <italic>metaCCA</italic>’s/<italic>metaCCA+</italic>’s −log 10 <italic>P</italic>-values in the ranges [0, 10] (purple) or (10, max(−log 10 <italic>P</italic>-value)] (red). This threshold is represented by purple and red lines. <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btw052/-/DC1">Supplementary Figure S5</ext-link> shows these results restricted to the <italic>x</italic>-axis range of [0, 10], and <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btw052/-/DC1">Supplementary Figure S6</ext-link> illustrates the impact of the number of genotypic and phenotypic features included in the analysis on the accuracy of <italic>metaCCA/metaCCA+</italic></p></caption><graphic xlink:href="btw052f2p"/></fig>
</p>
        <p>The wide range of the observed −log 10 <italic>P</italic>-values (0–88) shows that multivariate association tests can be very powerful in realistic settings, and that our example assesses the performance of <italic>metaCCA</italic> throughout the range that is important in practical analyses. <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btw052/-/DC1">Supplementary Figure S5</ext-link> further refines the behaviour of <italic>metaCCA</italic> within the range most encountered in genome-wide association studies (0–10).</p>
      </sec>
      <sec>
        <title>3.1.2 Multivariate genotype – multivariate phenotype</title>
        <p>When both genotype and phenotype are multivariate, genotypic correlation structure <inline-formula id="IE51"><mml:math id="IEQ51"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>Σ</mml:mi><mml:mo>ˆ</mml:mo></mml:mover><mml:mrow><mml:mi>X</mml:mi><mml:mi>X</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> needs to be estimated in addition to <inline-formula id="IE52"><mml:math id="IEQ52"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>Σ</mml:mi><mml:mo>ˆ</mml:mo></mml:mover><mml:mrow><mml:mi>Y</mml:mi><mml:mi>Y</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>. We conducted the meta-analysis of two study cohorts (YFS and NFBC), and computed <inline-formula id="IE52a"><mml:math id="IEQ52a"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>Σ</mml:mi><mml:mo>ˆ</mml:mo></mml:mover><mml:mrow><mml:mi>X</mml:mi><mml:mi>X</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> either from FINRISK (FIN) or from a more generic population of the 1000 Genomes European individuals (1000G). (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btw052/-/DC1">Supplementary Table S3</ext-link> shows errors of <inline-formula id="IE53"><mml:math id="IEQ53"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>Σ</mml:mi><mml:mo>ˆ</mml:mo></mml:mover><mml:mrow><mml:mi>X</mml:mi><mml:mi>X</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> estimates.) We analyzed together between 2 and 10 highly correlated lipid measures, chosen sequentially as in the single-SNP tests in Section 3.1.1. For each of the five genes, we analyzed together between 2 and 10 SNPs that were chosen to be approximately uncorrelated to cover a large proportion of genetic variation within the gene. Each set of SNPs was tested for an association with each group of correlated lipid measures. We repeated the procedure ten times for each gene, with different starting phenotypes and SNPs.</p>
        <p>The results are summarized in <xref ref-type="fig" rid="btw052-F2">Figure 2c–f</xref>. <xref ref-type="fig" rid="btw052-F2">Figure 2c</xref> shows that when genotypic correlation <inline-formula id="IE54"><mml:math id="IEQ54"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>Σ</mml:mi><mml:mo>ˆ</mml:mo></mml:mover><mml:mrow><mml:mi>X</mml:mi><mml:mi>X</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is estimated from the target population, <italic>metaCCA</italic> produces highly consistent results with the standard CCA based on the individual-level data. When <inline-formula id="IE55"><mml:math id="IEQ55"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>Σ</mml:mi><mml:mo>ˆ</mml:mo></mml:mover><mml:mrow><mml:mi>X</mml:mi><mml:mi>X</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is estimated from a less well matching population (<xref ref-type="fig" rid="btw052-F2">Fig. 2e</xref>), the accuracy is reduced, and some −log 10 <italic>P</italic>-values become clearly overestimated. In both cases, further shrinkage by <italic>metaCCA+ </italic>removes, almost completely, any overestimation (<xref ref-type="fig" rid="btw052-F2">Fig. 2d, f</xref>). This property is expected to be important in genome-wide association studies, where <italic>metaCCA+ </italic>can protect from false positives when genotypic correlation structure cannot be accurately estimated. <italic>metaCCA+ </italic>has less statistical power than the individual-level CCA, but it is still able to detect strong true associations.</p>
      </sec>
    </sec>
    <sec>
      <title>3.2 Application to summary statistics from SNPTEST</title>
      <p>In the genetics community, established software packages like SNPTEST (<xref rid="btw052-B17" ref-type="bibr">Marchini and Howie, 2010</xref>) are used to perform univariate genome-wide tests. In this section, we conduct a meta-analysis of univariate results from standard SNPTEST runs on NFBC and YFS cohorts by <italic>metaCCA</italic>. These cohorts have been meta-analyzed previously using standard CCA applied to pooled individual-level genotypes and the same serum metabolomic profiles that we consider here (<xref rid="btw052-B12" ref-type="bibr">Inouye <italic>et al.</italic>, 2012</xref>). This single-SNP–multi-trait GWAS highlighted candidate genes for atherosclerosis, and demonstrated the power of incorporating multiple related traits into the analysis. Here, we show that by <italic>metaCCA</italic> we obtain those same results without the access to the individual-level data, and, in addition to that, we can also analyze multiple SNPs jointly by using only summary statistics from the original studies.</p>
      <p>We wanted to choose a set of correlated traits for the joint analysis, and therefore we proceeded as follows. By an agglomerative hierarchical clustering (average linkage) of Σ<italic><sub>YY</sub></italic>(81 traits), we identified groups of related lipid measures. From the largest of 6 distinct clusters, we selected a set of traits in such a way that no pair exhibited correlation above 0.95. We ended up with a group of 9 lipid measures related to 8 VLDL particles of different sizes and one HDL particle (highlighted in blue in <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btw052/-/DC1">Supplementary Table S1</ext-link>).</p>
      <p>We conducted two types of meta-analyses of NFBC and YFS:
<list list-type="order"><list-item><p><italic>Univariate genotype – multivariate phenotype</italic>Each SNP from chromosome 1 tested for an association with the set of 9 correlated lipid measures.</p></list-item><list-item><p><italic>Multivariate genotype – multivariate phenotype</italic>For each of the 5 genes (APOE, CETP, GCKR, PCSK9, NOD2), the smallest set of SNPs that explained, at median, over 95% of the variance of the remaining SNPs is chosen (see Section 2.4), and tested for an association with the set of 9 correlated lipid measures.</p></list-item></list></p>
      <p>The input summary statistics for <italic>metaCCA</italic> were obtained by performing univariate tests for each SNP-trait pair separately using SNPTEST applied to the individual-level data, and transforming the resulting regression coefficients using (3). The correlation structure of analyzed traits, <inline-formula id="IE56"><mml:math id="IEQ56"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>Σ</mml:mi><mml:mo>ˆ</mml:mo></mml:mover><mml:mrow><mml:mi>Y</mml:mi><mml:mi>Y</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, was estimated from summary statistics of SNPs across the entire genome. The genotypic correlation structure for multi-SNP analyses, <inline-formula id="IE57"><mml:math id="IEQ57"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>Σ</mml:mi><mml:mo>ˆ</mml:mo></mml:mover><mml:mrow><mml:mi>X</mml:mi><mml:mi>X</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, was calculated from the FINRISK cohort.</p>
      <p>We compared the results of <italic>metaCCA</italic> and <italic>metaCCA+ </italic>with the pooled individual-level CCA of original datasets. <xref ref-type="fig" rid="btw052-F3">Figure 3</xref> shows scatter plots of − log 10 <italic>P</italic>-values for 455 521 SNPs from chromosome 1. The results of <italic>metaCCA</italic> demonstrate an excellent agreement with the original <italic>P</italic>-values, validating that <italic>metaCCA</italic> can conduct reliable multivariate meta-analysis from standard univariate GWAS software output. As anticipated, <italic>metaCCA+ </italic>produces conservative <italic>P</italic>-values. Here, <italic>metaCCA</italic> is indeed the method of choice in practice, due to the high quality of covariance estimate used. Manhattan plots illustrating <italic>P</italic>-values along the chromosome are shown in <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btw052/-/DC1">Supplementary Figure S7</ext-link>. Genome-wide significant associations (at the threshold of <inline-formula id="IE58"><mml:math id="IEQ58"><mml:mrow><mml:mi>P</mml:mi><mml:mo>=</mml:mo><mml:mn>5</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>8</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> standard in the field) are located within two regions: <italic>USP1/DOCK7</italic> and <italic>FCGR2A/3A/2C/3B</italic>, which are known to be associated with lipid metabolism (NHGRI GWAS catalogue, <xref rid="btw052-B9" ref-type="bibr">Hindorff <italic>et al.</italic>, 2011</xref>). <italic>metaCCA</italic> identified both regions, and <italic>metaCCA+ </italic>found the stronger out of the two signals (<italic>DOCK7/USP1</italic>). For top-SNP in <italic>FCGR2A/3A/2C/3B</italic>, <italic>metaCCA+</italic>’s −log 10 <italic>P</italic>-value is 6.11, compared to 7.73 produced by CCA on the individual-level data.
<fig id="btw052-F3" orientation="portrait" position="float"><label>Fig. 3.</label><caption><p>Scatter plots of −log 10 <italic>P</italic>-values from the pooled individual-level CCA of NFBC and YFS and (<bold>a</bold>) <italic>metaCCA</italic>, (<bold>b</bold>) <italic>metaCCA+</italic>. Each point corresponds to one genetic variant from the chromosome 1, tested for an association with the group of 9 correlated lipid measures. In total, 455 521 SNPs were analyzed. Red lines indicate the significance level of <inline-formula id="IE70"><mml:math id="IEQ70"><mml:mrow><mml:mn>5</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>8</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> (7.301 on −log 10 scale)</p></caption><graphic xlink:href="btw052f3p"/></fig>
</p>
      <p><xref ref-type="fig" rid="btw052-F4">Figure 4</xref> summarizes the results of the multi-SNP–multi-trait meta-analysis, and shows the performance of <italic>metaCCA</italic> when different numbers of SNPs, from 2 up to 25, representing a gene, are tested jointly for an association with the group of 9 related lipid traits. Numbers of SNPs that are chosen by our approach (Section 2.4) are marked with <bold>x</bold>. <xref ref-type="fig" rid="btw052-F4">Figure 4</xref> validates that by using this protocol, a gene is described well, since when adding more SNPs no clear power gain is observed. Both <italic>metaCCA</italic> and <italic>metaCCA+ </italic>(<xref ref-type="fig" rid="btw052-F4">Fig. 4</xref>, <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btw052/-/DC1">Supplementary Table S4</ext-link>) produced very accurate <italic>P</italic>-values. For the largest signals (<italic>APOE</italic>, <italic>CETP</italic>), −log 10 <italic>P</italic>-values are less than one unit overestimated by <italic>metaCCA</italic>, and underestimated by <italic>metaCCA+</italic>. These differences would be unlikely to lead to false inferences when a reference significance level in a gene-based analysis was set to <inline-formula id="IE59"><mml:math id="IEQ59"><mml:mrow><mml:mn>0.05</mml:mn><mml:mo>/</mml:mo><mml:mn>20000</mml:mn><mml:mo>=</mml:mo><mml:mn>2.5</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, i.e. 5.61 on − log 10 scale, based on there being about 20 000 protein-coding genes in the human genome. At this level, both <italic>metaCCA</italic> and <italic>metaCCA+ </italic>found an association between <italic>APOE</italic>, <italic>CETP</italic>, <italic>GCKR</italic> and the network of VLDL and HDL particles studied. For <italic>APOE</italic> and <italic>CETP</italic>, gene-based signals are clearly higher than the univariate ones, even before accounting for different numbers of tests. Moreover, in case of <italic>APOE</italic>, the multi-SNP–multi-trait signal is nearly 4.5 units higher than the single-SNP–multi-trait one. Note that <italic>NOD2</italic> has no (known) association with metabolic traits, and therefore it serves as a negative control <xref ref-type="fig" rid="btw052-F4">Figure 4</xref> and <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btw052/-/DC1">Supplementary Table S4</ext-link>.
<fig id="btw052-F4" orientation="portrait" position="float"><label>Fig. 4.</label><caption><p><italic>Multi-SNP–multi-trait</italic> analysis: −log 10 <italic>P</italic>-values of CCA on pooled individual-level datasets (NFBC + YFS), and the meta-analyses conducted using <italic>metaCCA</italic>, as a function of the number of SNPs representing a gene. Sets of 2–25 SNPs were tested for an association with the group of 9 related lipid measures. In practice, the smallest number of SNPs that explain, at median, over 95% of the variance of the remaining SNPs would be chosen to represent a gene, and is marked with <bold>x</bold>. The evolution of the median variance explained versus the number of SNPs is shown in <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btw052/-/DC1">Supplementary Figure S8</ext-link>. For each gene, the largest −log 10 <italic>P</italic>-value from single-SNP–single-trait tests (<italic>top univariate</italic>) is represented by a dashed line. The largest single-SNP–multi-trait −log 10 <italic>P</italic>-values are 11.54 for <italic>APOE</italic>, 23.77 for <italic>CETP</italic>, 9.64 for <italic>GCKR</italic>, 6.58 for <italic>PCSK9</italic> and 0.97 for <italic>NOD2</italic>. The values are summarized with details in <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btw052/-/DC1">Supplementary Table S4</ext-link>. The number of tests in each gene is 1 for multi-SNP, <italic>G</italic> for single-SNP–multi-trait, and <inline-formula id="IE71"><mml:math id="IEQ71"><mml:mrow><mml:mn>9</mml:mn><mml:mo>×</mml:mo><mml:mi>G</mml:mi></mml:mrow></mml:math></inline-formula> for single-SNP–single-trait tests, where <italic>G</italic> is the number of SNPs in that gene</p></caption><graphic xlink:href="btw052f4p"/></fig>
</p>
    </sec>
  </sec>
  <sec>
    <title>4 Discussion</title>
    <p>The advantage of multivariate testing of genetic association is well reported in the literature (<xref rid="btw052-B12" ref-type="bibr">Inouye <italic>et al.</italic>, 2012</xref>; <xref rid="btw052-B26" ref-type="bibr">Stephens, 2013</xref>), and also demonstrated in our results (e.g. <italic>CETP</italic> in <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btw052/-/DC1">Supplementary Table S4</ext-link> that has multivariate <italic>P</italic>-value 13 orders of magnitude smaller than any of the univariate <italic>P</italic>-values). Optimal use of correlated traits is becoming increasingly important as high-throughput phenotyping technologies are being more widely applied to individual study cohorts and large biobanks (<xref rid="btw052-B25" ref-type="bibr">Soininen <italic>et al.</italic>, 2015</xref>).</p>
    <p>We introduced <italic>metaCCA</italic>, a computational approach for the multivariate meta-analysis of GWAS by using univariate summary statistics and a reference database of genetic data. Thus, our framework circumvents the need for complete multivariate individual-level records, and tackles the problem of low sample sizes in individual cohorts by a built-in meta-analysis approach. To our knowledge, <italic>metaCCA</italic> is the first summary statistics-based framework that allows multivariate representation of both genotypic and phenotypic variables.</p>
    <p>In large meta-analytic efforts, the ability to work with summary statistics is beneficial, even when there is an access to the individual-level data. For example, with a study design of the <xref rid="btw052-B8" ref-type="bibr">Global Lipids Genetics Consortium (2013)</xref>, we estimate that the reduction in the size of input data between <italic>metaCCA</italic> and standard CCA could be over 750-fold (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btw052/-/DC1">Supplementary Figure S1</ext-link>).</p>
    <p>We provided two variants of the algorithm: <italic>metaCCA</italic> and <italic>metaCCA+</italic>. Based on our results, <italic>metaCCA</italic> is the method of choice when the accuracy of estimated correlation matrices <inline-formula id="IE60"><mml:math id="IEQ60"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>Σ</mml:mi><mml:mo>ˆ</mml:mo></mml:mover><mml:mrow><mml:mi>X</mml:mi><mml:mi>X</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE61"><mml:math id="IEQ61"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>Σ</mml:mi><mml:mo>ˆ</mml:mo></mml:mover><mml:mrow><mml:mi>Y</mml:mi><mml:mi>Y</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is good, i.e. <inline-formula id="IE62"><mml:math id="IEQ62"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>Σ</mml:mi><mml:mo>ˆ</mml:mo></mml:mover><mml:mrow><mml:mi>X</mml:mi><mml:mi>X</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> estimated from genetic data on the target population, and <inline-formula id="IE63"><mml:math id="IEQ63"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>Σ</mml:mi><mml:mo>ˆ</mml:mo></mml:mover><mml:mrow><mml:mi>Y</mml:mi><mml:mi>Y</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> estimated from at least one chromosome. In such cases, <italic>P</italic>-values from <italic>metaCCA</italic> were very accurate, meaning that false positive and false negative rates are close to those of standard CCA applied to the individual-level data. We emphasize that <italic>metaCCA</italic> should not be used when the quality of <inline-formula id="IE64"><mml:math id="IEQ64"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>Σ</mml:mi><mml:mo>ˆ</mml:mo></mml:mover><mml:mrow><mml:mi>X</mml:mi><mml:mi>X</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and/or <inline-formula id="IE65"><mml:math id="IEQ65"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>Σ</mml:mi><mml:mo>ˆ</mml:mo></mml:mover><mml:mrow><mml:mi>Y</mml:mi><mml:mi>Y</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> estimates is reduced, i.e. when a generic reference population and/or summary statistics of only a small number of genotypes are available. In such cases, <italic>metaCCA+ </italic>proved useful to protect from an increase of false positive associations (<xref ref-type="fig" rid="btw052-F2">Fig. 2</xref> and <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btw052/-/DC1">Supplementary Figure S9</ext-link>). This is important in GWAS context, where false positives could lead to considerable waste of resources in subsequent experimental and functional studies. A topic for future work would be to further develop our current heuristic stopping criterion of <italic>metaCCA+ </italic>to decrease its false negative rate without sacrificing its good false positive rate.</p>
    <p>We derived the framework assuming that all traits within each cohort have been measured on the same number of individuals (<italic>N</italic>). We note that the distribution of the test statistic depends on <italic>N</italic> (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btw052/-/DC1">Supplementary Data</ext-link>), as do the effect size transformation (<xref ref-type="disp-formula" rid="E3">Equation 3</xref>) and meta-analysis approach (Section 2.3). While a small proportion of missing data for each trait could be handled by statistical imputation methods, further work is required to study how <italic>metaCCA</italic> should be used when the sample sizes between the traits vary considerably. However, with high-throughput phenotyping technologies, we believe that <italic>metaCCA</italic> can be applied to many existing and forthcoming studies.</p>
    <p>For multivariate phenotype data, several types of association tests are possible. Natural question is which one should we prefer in practice. It is evident that single-SNP–multi-trait tests can detect much stronger signals at some SNPs than any of the univariate tests separately (e.g. <italic>CETP</italic> in <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btw052/-/DC1">Supplementary Table S4</ext-link>), and identify associations not found by univariate approach (<xref rid="btw052-B12" ref-type="bibr">Inouye <italic>et al.</italic>, 2012</xref>). On the contrary, for some other SNPs, the highest univariate signal may be clearly higher than the multi-trait one, even after accounting for the increase in the number of tests. For example, in <italic>GCKR</italic> (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btw052/-/DC1">Supplementary Table S4</ext-link>), the top SNP’s (rs1260326) association was explained already by one of the traits individually (M.VLDL.FC). Given the difference in degrees of freedom of the tests, this led to a 4.6 units higher −log 10 <italic>P</italic>-value in the univariate test compared to the multivariate one. Thus, for single-SNP analysis, univariate and multivariate tests complement each other and neither should be excluded from consideration.</p>
    <p>When also genotypes are multivariate, even more possibilities for association testing emerge. To illustrate our multi-SNP approach, we proposed a procedure for selecting, for each gene, the smallest number of SNPs that explained, at median, over 95% of the variance of the remaining SNPs in the locus. We demonstrated that testing multiple SNPs jointly can be more powerful than single-SNP–single-trait (<italic>APOE</italic>, <italic>CETP</italic> in <xref ref-type="fig" rid="btw052-F4">Fig. 4</xref> and <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btw052/-/DC1">Supplementary Table S4</ext-link>) and single-SNP–multi-trait tests (<italic>APOE</italic> in <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btw052/-/DC1">Supplementary Table S4</ext-link>). Moreover, <italic>metaCCA</italic> could equally well incorporate any other way of choosing the SNPs, for example, motivated by functional annotations (<xref rid="btw052-B4" ref-type="bibr">ENCODE Project Consortium, 2012</xref>), known expression effects (<xref rid="btw052-B2" ref-type="bibr">Ardlie <italic>et al.</italic>, 2015</xref>) or previous GWAS results on other traits (<xref rid="btw052-B9" ref-type="bibr">Hindorff <italic>et al.</italic>, 2011</xref>). A topic for further research could be to extend the covariance matrix-based analyses from CCA to dynamic approaches that learned from the data the set of variants and traits to be considered together. This would circumvent the need to restrict the subset of variables before the analysis.</p>
    <p>We envision that multivariate association testing using <italic>metaCCA</italic> has a great potential to provide novel insights from already published summary statistics of large GWAS meta-analyses on multivariate high-throughput phenotypes, such as metabolomics and transcriptomics. Finally, we hope that our work helps extending the application area of CCA to summary statistics data also in other data-rich fields outside genetics.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="PMC_1" content-type="local-data">
      <caption>
        <title>Supplementary Data</title>
      </caption>
      <media mimetype="text" mime-subtype="html" xlink:href="supp_32_13_1981__index.html"/>
      <media xlink:role="associated-file" mimetype="application" mime-subtype="pdf" xlink:href="supp_btw052_Supplement_revised_FINAL.pdf"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <sec>
    <title>Funding</title>
    <p><italic>Funding:</italic> This work was financially supported by the Helsinki Doctoral Education Network in Information and Communications Technology (HICT) to A.C., the <funding-source>Academy of Finland</funding-source> [<award-id>257654</award-id> and <award-id>288509</award-id> to M.P.; <award-id>251170</award-id> to the <funding-source>Finnish Centre of Excellence in Computational Inference Research</funding-source> COIN; <award-id>259272</award-id> to P.M.; <award-id>251217</award-id> and 255847 to S.R.] and the Sigrid Juselius Foundation to S.R., A.J.K., P.S. and M.A.K. S.R. was supported by EU FP7 projects ENGAGE (<award-id>201413</award-id>), BioSHaRE (261433), the Finnish Foundation for Cardiovascular Research and Biocentrum Helsinki. A.J.K., P.S. and M.A.K. were supported by Strategic Research Funding from the University of Oulu and by Novo Nordisk Foundation.</p>
    <p><italic>Conflict of Interest:</italic> A.J.K., P.S. and M.A.K. are shareholders of Brainshake Ltd., a company offering NMR-based metabolite profiling. A.J.K. and P.S. report employment relation for Brainshake Ltd.</p>
  </sec>
  <ref-list>
    <title>References</title>
    <ref id="btw052-B1">
      <mixed-citation publication-type="journal"><collab>1000 Genomes Project Consortium</collab> (<year>2012</year>) <article-title>An integrated map of genetic variation from 1,092 human genomes</article-title>. <source>Nature</source>, <volume>491</volume>, <fpage>56</fpage>–<lpage>65</lpage>.<pub-id pub-id-type="pmid">23128226</pub-id></mixed-citation>
    </ref>
    <ref id="btw052-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ardlie</surname><given-names>K.G</given-names></name></person-group><etal/> (<year>2015</year>) <article-title>The Genotype-Tissue Expression (GTEx) pilot analysis: multitissue gene regulation in humans</article-title>. <source>Sci</source>., <volume>348</volume>, <fpage>648</fpage>–<lpage>660</lpage>.</mixed-citation>
    </ref>
    <ref id="btw052-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Deloukas</surname><given-names>P</given-names></name></person-group><etal/> (<year>2013</year>) <article-title>Large-scale association analysis identifies new risk loci for coronary artery disease</article-title>. <source>Nat. Genet</source>., <volume>45</volume>, <fpage>25</fpage>–<lpage>33</lpage>.<pub-id pub-id-type="pmid">23202125</pub-id></mixed-citation>
    </ref>
    <ref id="btw052-B4">
      <mixed-citation publication-type="journal"><collab>ENCODE Project Consortium</collab> (<year>2012</year>) <article-title>An integrated encyclopedia of DNA elements in the human genome</article-title>. <source>Nature</source>, <volume>489</volume>, <fpage>57</fpage>–<lpage>74</lpage>.<pub-id pub-id-type="pmid">22955616</pub-id></mixed-citation>
    </ref>
    <ref id="btw052-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Evangelou</surname><given-names>E.</given-names></name><name><surname>Ioannidis</surname><given-names>J.P.</given-names></name></person-group> (<year>2013</year>) <article-title>Meta-analysis methods for genome-wide association studies and beyond</article-title>. <source>Nat. Rev. Genet</source>., <volume>14</volume>, <fpage>379</fpage>–<lpage>389</lpage>.<pub-id pub-id-type="pmid">23657481</pub-id></mixed-citation>
    </ref>
    <ref id="btw052-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Feng</surname><given-names>S</given-names></name></person-group><etal/> (<year>2014</year>) <article-title>RAREMETAL: fast and powerful meta-analysis for rare variants</article-title>. <source>Bioinformatics</source>, <fpage>btu367</fpage>.</mixed-citation>
    </ref>
    <ref id="btw052-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ferreira</surname><given-names>M.A.</given-names></name><name><surname>Purcell</surname><given-names>S.M.</given-names></name></person-group> (<year>2009</year>) <article-title>A multivariate test of association</article-title>. <source>Bioinformatics</source>, <volume>25</volume>, <fpage>132</fpage>–<lpage>133</lpage>.<pub-id pub-id-type="pmid">19019849</pub-id></mixed-citation>
    </ref>
    <ref id="btw052-B8">
      <mixed-citation publication-type="journal"><collab>Global Lipids Genetics Consortium</collab> (<year>2013</year>) <article-title>Discovery and refinement of loci associated with lipid levels</article-title>. <source>Nat. Genet</source>., <volume>45</volume>, <fpage>1274</fpage>–<lpage>1283</lpage>.<pub-id pub-id-type="pmid">24097068</pub-id></mixed-citation>
    </ref>
    <ref id="btw052-B9">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><name><surname>Hindorff</surname><given-names>L.A</given-names></name></person-group><etal/> (<year>2011</year>) <article-title>A Catalog of Published Genome-Wide Association Studies</article-title>. <comment><ext-link ext-link-type="uri" xlink:href="http://www.genome.gov/gwastudies">www.genome.gov/gwastudies</ext-link>. (July 2015, date last accessed).</comment></mixed-citation>
    </ref>
    <ref id="btw052-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hotelling</surname><given-names>H.</given-names></name></person-group> (<year>1936</year>) <article-title>Relations between two sets of variates</article-title>. <source>Biometrika</source>, <volume>28</volume>, <fpage>321</fpage>–<lpage>377</lpage>.</mixed-citation>
    </ref>
    <ref id="btw052-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Howie</surname><given-names>B.N</given-names></name></person-group><etal/> (<year>2009</year>) <article-title>A flexible and accurate genotype imputation method for the next generation of genome-wide association studies</article-title>. <source>PLos Genet</source>., <volume>5</volume>, <fpage>e1000529</fpage>.<pub-id pub-id-type="pmid">19543373</pub-id></mixed-citation>
    </ref>
    <ref id="btw052-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Inouye</surname><given-names>M</given-names></name></person-group><etal/> (<year>2012</year>) <article-title>Novel Loci for metabolic networks and multi-tissue expression studies reveal genes for atherosclerosis</article-title>. <source>PLos Genet</source>., <volume>8</volume>, <fpage>e1002907</fpage>.<pub-id pub-id-type="pmid">22916037</pub-id></mixed-citation>
    </ref>
    <ref id="btw052-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kettunen</surname><given-names>J</given-names></name></person-group><etal/> (<year>2012</year>) <article-title>Genome-wide association study identifies multiple loci influencing human serum metabolite levels</article-title>. <source>Nat. Genet</source>., <volume>44</volume>, <fpage>269</fpage>–<lpage>276</lpage>.<pub-id pub-id-type="pmid">22286219</pub-id></mixed-citation>
    </ref>
    <ref id="btw052-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ledoit</surname><given-names>O.</given-names></name><name><surname>Wolf</surname><given-names>M.</given-names></name></person-group> (<year>2003</year>) <article-title>Improved estimation of the covariance matrix of stock returns with an application to portfolio selection</article-title>. <source>J. Empir. Finance</source>, <volume>10</volume>, <fpage>603</fpage>–<lpage>621</lpage>.</mixed-citation>
    </ref>
    <ref id="btw052-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lee</surname><given-names>S</given-names></name></person-group><etal/> (<year>2014</year>) <article-title>Rare-variant association analysis: study designs and statistical tests</article-title>. <source>Am. J. Hum. Genet</source>., <volume>95</volume>, <fpage>5</fpage>–<lpage>23</lpage>.<pub-id pub-id-type="pmid">24995866</pub-id></mixed-citation>
    </ref>
    <ref id="btw052-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mahajan</surname><given-names>A</given-names></name></person-group><etal/> (<year>2014</year>) <article-title>Genome-wide trans-ancestry meta-analysis provides insight into the genetic architecture of type 2 diabetes susceptibility</article-title>. <source>Nat. Genet</source>., <volume>46</volume>, <fpage>234</fpage>–<lpage>244</lpage>.<pub-id pub-id-type="pmid">24509480</pub-id></mixed-citation>
    </ref>
    <ref id="btw052-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Marchini</surname><given-names>J.</given-names></name><name><surname>Howie</surname><given-names>B.</given-names></name></person-group> (<year>2010</year>) <article-title>Genotype imputation for genome-wide association studies</article-title>. <source>Nat. Rev. Genet</source>., <volume>11</volume>, <fpage>499</fpage>–<lpage>511</lpage>.<pub-id pub-id-type="pmid">20517342</pub-id></mixed-citation>
    </ref>
    <ref id="btw052-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Marttinen</surname><given-names>P</given-names></name></person-group><etal/> (<year>2013</year>) <article-title>Genome-wide association studies with high-dimensional phenotypes</article-title>. <source>Stat. Appl. Genet. Mol. Biol</source>., <volume>12</volume>, <fpage>413</fpage>–<lpage>431</lpage>.<pub-id pub-id-type="pmid">23759510</pub-id></mixed-citation>
    </ref>
    <ref id="btw052-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Marttinen</surname><given-names>P</given-names></name></person-group><etal/> (<year>2014</year>) <article-title>Assessing multivariate gene-metabolome associations with rare variants using Bayesian reduced rank regression</article-title>. <source>Bioinformatics</source>, <volume>30</volume>, <fpage>2026</fpage>–<lpage>2034</lpage>.<pub-id pub-id-type="pmid">24665129</pub-id></mixed-citation>
    </ref>
    <ref id="btw052-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Raitakari</surname><given-names>O.T</given-names></name></person-group><etal/> (<year>2008</year>) <article-title>Cohort profile: the Cardiovascular Risk in Young Finns Study</article-title>. <source>Int. J. Epidemiol</source>., <volume>37</volume>, <fpage>1220</fpage>–<lpage>1226</lpage>.<pub-id pub-id-type="pmid">18263651</pub-id></mixed-citation>
    </ref>
    <ref id="btw052-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rantakallio</surname><given-names>P.</given-names></name></person-group> (<year>1969</year>) <article-title>Groups at risk in low birth weight infants and perinatal mortality</article-title>. <source>Acta Paediatrica Scand</source>., <volume>193</volume>, <fpage>193</fpage>.</mixed-citation>
    </ref>
    <ref id="btw052-B22">
      <mixed-citation publication-type="journal"><collab>Schizophrenia Working Group of the Psychiatric Genomics Consortium</collab> (<year>2014</year>) <article-title>Biological insights from 108 schizophrenia-associated genetic loci</article-title>. <source>Nature</source>, <volume>511</volume>, <fpage>421</fpage>–<lpage>427</lpage>.<pub-id pub-id-type="pmid">25056061</pub-id></mixed-citation>
    </ref>
    <ref id="btw052-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shin</surname><given-names>S.Y</given-names></name></person-group><etal/> (<year>2014</year>) <article-title>An atlas of genetic influences on human blood metabolites</article-title>. <source>Nat. Genet</source>., <volume>46</volume>, <fpage>543</fpage>–<lpage>550</lpage>.<pub-id pub-id-type="pmid">24816252</pub-id></mixed-citation>
    </ref>
    <ref id="btw052-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Soininen</surname><given-names>P</given-names></name></person-group><etal/> (<year>2009</year>) <article-title>High-throughput serum NMR metabonomics for cost-effective holistic studies on systemic metabolism</article-title>. <source>Analyst</source>, <volume>134</volume>, <fpage>1781</fpage>–<lpage>1785</lpage>.<pub-id pub-id-type="pmid">19684899</pub-id></mixed-citation>
    </ref>
    <ref id="btw052-B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Soininen</surname><given-names>P</given-names></name></person-group><etal/> (<year>2015</year>) <article-title>Quantitative serum nuclear magnetic resonance metabolomics in cardiovascular epidemiology and genetics</article-title>. <source>Circul.: Cardiovasc. Genet</source>., <volume>8</volume>, <fpage>192</fpage>–<lpage>206</lpage>.</mixed-citation>
    </ref>
    <ref id="btw052-B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stephens</surname><given-names>M.</given-names></name></person-group> (<year>2013</year>) <article-title>A unified framework for association analysis with multiple related phenotypes</article-title>. <source>PLoS One</source>, <volume>8</volume>, <fpage>e65245</fpage>.<pub-id pub-id-type="pmid">23861737</pub-id></mixed-citation>
    </ref>
    <ref id="btw052-B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Surakka</surname><given-names>I</given-names></name></person-group><etal/> (<year>2015</year>) <article-title>The impact of low-frequency and rare variants on lipid levels</article-title>. <source>Nat. Genet</source>., <volume>47</volume>, <fpage>589</fpage>–<lpage>597</lpage>.<pub-id pub-id-type="pmid">25961943</pub-id></mixed-citation>
    </ref>
    <ref id="btw052-B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tang</surname><given-names>C.S.</given-names></name><name><surname>Ferreira</surname><given-names>M.A.</given-names></name></person-group> (<year>2012</year>) <article-title>A gene-based test of association using canonical correlation analysis</article-title>. <source>Bioinformatics</source>, <volume>28</volume>, <fpage>845</fpage>–<lpage>850</lpage>.<pub-id pub-id-type="pmid">22296789</pub-id></mixed-citation>
    </ref>
    <ref id="btw052-B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tibshirani</surname><given-names>R</given-names></name></person-group><etal/> (<year>2001</year>) <article-title>Estimating the number of clusters in a data set via the gap statistic</article-title>. <source>J. R. Stat. Soc.: Ser. B (Stat. Methodol.)</source>, <volume>63</volume>, <fpage>411</fpage>–<lpage>423</lpage>.</mixed-citation>
    </ref>
    <ref id="btw052-B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>van der Sluis</surname><given-names>S</given-names></name></person-group><etal/> (<year>2013</year>) <article-title>TATES: efficient multivariate genotype-phenotype analysis for genome-wide association studies</article-title>. <source>PLos Genet</source>., <volume>9</volume>, <fpage>e1003235</fpage>.<pub-id pub-id-type="pmid">23359524</pub-id></mixed-citation>
    </ref>
    <ref id="btw052-B31">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vartiainen</surname><given-names>E</given-names></name></person-group><etal/> (<year>2010</year>) <article-title>Thirty-five-year trends in cardiovascular risk factors in Finland</article-title>. <source>Int. J. Epidemiol</source>., <volume>39</volume>, <fpage>504</fpage>–<lpage>518</lpage>.<pub-id pub-id-type="pmid">19959603</pub-id></mixed-citation>
    </ref>
    <ref id="btw052-B32">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vuckovic</surname><given-names>D</given-names></name></person-group><etal/> (<year>2015</year>) <article-title>MultiMeta: an R package for meta-analyzing multi-phenotype genome-wide association studies</article-title>. <source>Bioinformatics</source>, <fpage>btv222</fpage>.</mixed-citation>
    </ref>
    <ref id="btw052-B33">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wall</surname><given-names>J.D.</given-names></name><name><surname>Pritchard</surname><given-names>J.K.</given-names></name></person-group> (<year>2003</year>) <article-title>Haplotype blocks and linkage disequilibrium in the human genome</article-title>. <source>Nat. Rev. Genet</source>., <volume>4</volume>, <fpage>587</fpage>–<lpage>597</lpage>.<pub-id pub-id-type="pmid">12897771</pub-id></mixed-citation>
    </ref>
    <ref id="btw052-B34">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>Y</given-names></name></person-group><etal/> (<year>2013</year>) <article-title>Random forests on Hadoop for Genome-Wide Association Studies of multivariate neuroimaging phenotypes</article-title>. <source>BMC Bioinf</source>., <volume>14</volume>, <fpage>1</fpage>–<lpage>15</lpage>.</mixed-citation>
    </ref>
    <ref id="btw052-B35">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yang</surname><given-names>J</given-names></name></person-group><etal/> (<year>2012</year>) <article-title>Conditional and joint multiple-SNP analysis of GWAS summary statistics identifies additional variants influencing complex traits</article-title>. <source>Nat. Genet</source>., <volume>44</volume>, <fpage>369</fpage>–<lpage>375</lpage>.<pub-id pub-id-type="pmid">22426310</pub-id></mixed-citation>
    </ref>
    <ref id="btw052-B36">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhu</surname><given-names>X</given-names></name></person-group><etal/> (<year>2015</year>) <article-title>Meta-analysis of correlated traits via summary statistics from GWASs with an application in hypertension</article-title>. <source>Am. J. Hum. Genet</source>., <volume>96</volume>, <fpage>21</fpage>–<lpage>36</lpage>.<pub-id pub-id-type="pmid">25500260</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
