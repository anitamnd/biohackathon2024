<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Sci Rep</journal-id>
    <journal-id journal-id-type="iso-abbrev">Sci Rep</journal-id>
    <journal-title-group>
      <journal-title>Scientific Reports</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2045-2322</issn>
    <publisher>
      <publisher-name>Nature Publishing Group UK</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7665227</article-id>
    <article-id pub-id-type="publisher-id">76759</article-id>
    <article-id pub-id-type="doi">10.1038/s41598-020-76759-y</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>GMStool: GWAS-based marker selection tool for genomic prediction from genomic data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Jeong</surname>
          <given-names>Seongmun</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Kim</surname>
          <given-names>Jae-Yoon</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Kim</surname>
          <given-names>Namshin</given-names>
        </name>
        <address>
          <email>deepreds@kribb.re.kr</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.249967.7</institution-id><institution-id institution-id-type="ISNI">0000 0004 0636 3099</institution-id><institution>Genome Editing Research Center, </institution><institution>Korea Research Institute of Bioscience and Biotechnology (KRIBB), </institution></institution-wrap>Daejeon, 34141 Republic of Korea </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.412786.e</institution-id><institution-id institution-id-type="ISNI">0000 0004 1791 8264</institution-id><institution>Department of Bioinformatics, </institution><institution>KRIBB School of Bioscience, University of Science and Technology (UST), </institution></institution-wrap>Daejeon, 34141 Republic of Korea </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>12</day>
      <month>11</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>12</day>
      <month>11</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2020</year>
    </pub-date>
    <volume>10</volume>
    <elocation-id>19653</elocation-id>
    <history>
      <date date-type="received">
        <day>4</day>
        <month>5</month>
        <year>2020</year>
      </date>
      <date date-type="accepted">
        <day>2</day>
        <month>11</month>
        <year>2020</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2020</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1">The increased accessibility to genomic data in recent years has laid the foundation for studies to predict various phenotypes of organisms based on the genome. Genomic prediction collectively refers to these studies, and it estimates an individual’s phenotypes mainly using single nucleotide polymorphism markers. Typically, the accuracy of these genomic prediction studies is highly dependent on the markers used; however, in practice, choosing optimal markers with high accuracy for the phenotype to be used is a challenging task. Therefore, we present a new tool called GMStool for selecting optimal marker sets and predicting quantitative phenotypes. The GMStool is based on a genome-wide association study (GWAS) and heuristically searches for optimal markers using statistical and machine-learning methods. The GMStool performs the genomic prediction using statistical and machine/deep-learning models and presents the best prediction model with the optimal marker-set. For the evaluation, the GMStool was tested on real datasets with four phenotypes. The prediction results showed higher performance than using the entire markers or the GWAS-top markers, which have been used frequently in prediction studies. Although the GMStool has several limitations, it is expected to contribute to various studies for predicting quantitative phenotypes. The GMStool written in R is available at <ext-link ext-link-type="uri" xlink:href="http://www.github.com/JaeYoonKim72/GMStool">www.github.com/JaeYoonKim72/GMStool</ext-link>.</p>
    </abstract>
    <kwd-group kwd-group-type="npg-subject">
      <title>Subject terms</title>
      <kwd>Computational biology and bioinformatics</kwd>
      <kwd>Computational models</kwd>
      <kwd>Data mining</kwd>
      <kwd>Software</kwd>
      <kwd>Bioinformatics</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100003725</institution-id>
            <institution>National Research Foundation of Korea</institution>
          </institution-wrap>
        </funding-source>
        <award-id>NRF-2014M3C9A3064552</award-id>
        <principal-award-recipient>
          <name>
            <surname>Kim</surname>
            <given-names>Namshin</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>Next-Gen Bio-Green21</institution>
        </funding-source>
        <award-id>PJ01313201</award-id>
        <principal-award-recipient>
          <name>
            <surname>Kim</surname>
            <given-names>Namshin</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>the KRIBB initiative program</institution>
        </funding-source>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2020</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Introduction</title>
    <p id="Par2">Genomic prediction (GP) based on single nucleotide polymorphism (SNP) markers has become a powerful tool for various human healthcare as well as conventional plant and animal breeding programs<sup><xref ref-type="bibr" rid="CR1">1</xref>, <xref ref-type="bibr" rid="CR2">2</xref></sup>. With the recent dramatic decreases in sequencing and genotyping costs, GP is more readily accessible than ever and has enabled the efficient prediction of genetic disease risks, genomic breeding values, and complex quantitative phenotypes directly from genomic data. GP can be performed using either all SNPs or only subset SNPs from whole-genome sequencing (WGS) or SNP array data. Generally, since many SNPs are used, using all SNPs from WGS data is expected to result in higher GP accuracy than using SNPs from array data. However, in practice, this increase in accuracy is rarely observed in real data<sup><xref ref-type="bibr" rid="CR3">3</xref></sup>, and little differences, or even a decrease in accuracy, have been reported in previous studies<sup><xref ref-type="bibr" rid="CR4">4</xref>, <xref ref-type="bibr" rid="CR5">5</xref></sup>. This is because WGS data retains more SNPs relating to a phenotype of interest, but the number of relevant SNPs accounts for a relatively small proportion of the total number of SNPs used, and the considerable number of remaining SNPs are phenotypically neutral<sup><xref ref-type="bibr" rid="CR6">6</xref></sup>. To avoid these burdens due to the large number of uninformative SNPs, approaches using an adequate subset of SNPs have been proposed<sup><xref ref-type="bibr" rid="CR6">6</xref></sup>, and multiple studies have reported that SNP subsets improved GP accuracies compared to using all or numerous SNPs. For example, Ni et al<italic>.</italic> improved GP accuracy using only SNPs in or around genes from WGS data<sup><xref ref-type="bibr" rid="CR7">7</xref></sup>, and Brondum et al<italic>.</italic> increased GP accuracy using both SNPs associated with quantitative trait loci and SNPs significantly detected in a genome-wide association study (GWAS)<sup><xref ref-type="bibr" rid="CR8">8</xref></sup>.</p>
    <p id="Par3">A GWAS identifies SNP markers associated with a phenotype. Thus, it is utilized as a useful approach to construct a subset of SNP markers for GP. Usually, significant SNPs detected below the <italic>p</italic>-values of 1<bold> × </bold>10<sup>–6</sup> or 5<bold> × </bold>10<sup>–8</sup> are used as a subset, and simulation studies have reported that improved accuracy is attained when using GWAS-significant SNPs and their surrounding SNPs<sup><xref ref-type="bibr" rid="CR9">9</xref></sup>. However, these predictions using the GWAS-significant and/or surrounding SNPs have not always been successful<sup><xref ref-type="bibr" rid="CR10">10</xref></sup>. This is likely because the significant SNPs explain only a small percentage of the total genetic variation for a phenotype<sup><xref ref-type="bibr" rid="CR11">11</xref></sup>, and each SNP also accounts for a small portion of the phenotypic variance<sup><xref ref-type="bibr" rid="CR12">12</xref></sup>. Thus, identifying more robust methods to select the optimal subset of SNPs for GP has focused on multiple studies. Bermingham et al<italic>.</italic> and Filho et al<italic>.</italic> reported that using the top 100–10,000 GWAS SNP markers as subsets could increase GP accuracy compared to using only GWAS-significant SNPs<sup><xref ref-type="bibr" rid="CR13">13</xref>, <xref ref-type="bibr" rid="CR14">14</xref></sup>. Yilmaz presented an algorithm that selects subsets of markers considering SNP–SNP interactions from a GWAS result and confirmed that using these subsets improves accuracy compared to using only top GWAS SNPs<sup><xref ref-type="bibr" rid="CR15">15</xref></sup>. These studies have demonstrated that the selection of SNP subset has a considerable effect on GP accuracy; however, the GWAS top SNP-based approaches have difficulty selecting an appropriate number of top SNPs with high GP accuracy and require numerous attempts each time for each phenotype. The interaction-based GWAS approach requires information on the interactions between SNPs, in addition to the GWAS result. Furthermore, if the interaction information is incomplete, this approach can construct a biased subset that can hinder GP accuracy<sup><xref ref-type="bibr" rid="CR15">15</xref></sup>. Therefore, there is a need for a new approach that selects an optimal subset of SNPs to maximize GP accuracy while considering the single and interaction effects of markers.</p>
    <p id="Par4">In this study, we have developed an implemented GWAS-based marker selection tool named GMStool. GMStool searches for SNP markers in order of the lowest <italic>p</italic>-value in the GWAS result and constructs the optimal marker set by accumulating SNP markers that increase the phenotype's prediction accuracy. Subsequently, GMStool performs GP modeling and presents the best prediction model with the optimal marker set. Statistical, machine, and/or deep learning methods are used, and the interaction effects of the SNP markers are considered indirectly through modeling. The R package and execute scripts of GMStool are available at <ext-link ext-link-type="uri" xlink:href="http://www.github.com/JaeYoonKim72/GMStool">www.github.com/JaeYoonKim72/GMStool</ext-link> with detailed usage instructions.</p>
  </sec>
  <sec id="Sec2">
    <title>Methods</title>
    <sec id="Sec3">
      <title>GMStool scheme: preparation</title>
      <p id="Par5">GMStool consists of three phases: preparation, marker selection, and final modeling (Fig. <xref rid="Fig1" ref-type="fig">1</xref>A). In the preparation phase, GMStool requires four inputs: genotype, phenotype, GWAS result, and test sample list files. The genotype file consists of markers (rows) and samples (columns), and genotypes are coded as − 1, 0, 1, and 2 for missing, homozygous reference, heterozygous, and homozygous alternative genotypes, respectively. The phenotype file is similar to the genotype file, but its rows and columns consist of samples and phenotypes. The GWAS result file consists of four columns: marker name, chromosome number, physical position, and <italic>p</italic>-value columns. The test list file consists of a single column with the names of the test samples. As an option, a list of markers that must be included in the final modeling can be passed to GMStool. If this file named by 'preset marker’ is not defined, the top <italic>n</italic> markers based on GWAS <italic>p</italic>-values are selected and used for the initial analysis (default 1). Note that GWAS must be performed using only a training set (excluding the test set) to completely exclude information on the test set that may cause bias in the training result<sup><xref ref-type="bibr" rid="CR16">16</xref></sup>. Although the GWAS does not include the test set, both genotype and phenotype files must include all samples of the training and test set, since GMStool automatically converted the test set into input files for the final modeling phase.<fig id="Fig1"><label>Figure 1</label><caption><p>Scheme of GMStool. (<bold>A</bold>) Overall workflow. GMStool consists of three phases: preparation, marker selection, and final modeling. The dotted rectangles indicate the options that users can choose: whether to define pre-selected markers and which model to use for the marker selection and final modeling phases. (<bold>B</bold>) A brief algorithm for the marker selection phase. "preset marker” in the first conditional statement means the "pre-selected markers” in the overall workflow. Abbreviations ‘Set. corr.’ ‘Target corr.’, and ‘val. corr.’ mean ‘correlation rate of marker set’, ‘target correlation rate’, and ‘correlation rate of validation set’, respectively.</p></caption><graphic xlink:href="41598_2020_76759_Fig1_HTML" id="MO1"/></fig></p>
    </sec>
    <sec id="Sec4">
      <title>GMStool scheme: marker selection</title>
      <p id="Par6">The marker selection phase applies the forward selection method of regression analysis and sequentially selects SNP markers that increase the correlation rate between observed and predicted phenotypes on the validation set (Fig. <xref rid="Fig1" ref-type="fig">1</xref>B). The optimal marker set for the final modeling phase is gradually constructed by accumulating SNPs one by one. The metric is used as the Pearson's correlation rate instead of accuracy due to the continuous phenotypes. Depending on the forward selection method, SNPs that have not been selected once are not selected again in the selection process. The ridge regression best linear unbiased prediction (RRB) and bootstrap trees (BTS) methods are provided as learning models, and either one or both models can be used. If both methods are selected, BTS is calculated sequentially after RRB, and the union of the SNP markers derived from the two methods is presented as an optimal marker set. The overall workflow of the marker selection phase is as follows (Fig. <xref rid="Fig1" ref-type="fig">1</xref>A):<list list-type="order"><list-item><p id="Par7">Divide the input data into training and test sets, using the information of the test set defined by the user.</p></list-item><list-item><p id="Par8">Divide the training set into <italic>k</italic> groups for cross-validation (CV; default 5), and perform marker selection in each group. All <italic>k</italic> groups are executed simultaneously through multi-threading. The process of selecting markers in each group is as follows (Fig. <xref rid="Fig1" ref-type="fig">1</xref>B):<list list-type="simple"><list-item><label>A.</label><p id="Par9">Consider one sub-group as a validation set and the remaining sub-groups as a training set.</p></list-item><list-item><label>B.</label><p id="Par10">Build the prediction model using all the markers in the training set, according to the user's selection model. Then, calculate the correlation rates on the training and validation sets, respectively (optional).</p></list-item><list-item><label>C.</label><p id="Par11">Select the top <italic>n</italic> initial markers from GWAS results ordered by <italic>p</italic>-values (default 1), and consider them as an initial marker set. If ‘preset marker’ is defined, consider these preset markers as the initial marker set instead of selecting the top markers. Build the prediction model using the initial markers of train sets and predict the correlation rate on the validation set. Place the initial markers into the selected marker set (yellow parallelogram in Fig. <xref rid="Fig1" ref-type="fig">1</xref>B; ‘Marker set’) and the initial correlation rate into the correlation rate for the selected marker set (gray hexagon in Fig. <xref rid="Fig1" ref-type="fig">1</xref>B; ‘Set corr.’).</p></list-item><list-item><label>D.</label><p id="Par12">If the top <italic>n</italic> initial markers were selected, select the next marker (<italic>n</italic> + 1), and if preset markers were defined, select the top one from GWAS, ordered by <italic>p</italic>-values. Add this marker to the selected marker set formed in step C. Build the prediction model using the marker set, and calculate the current correlation rate on the validation set. If the difference of the correlation rate between ‘current’ and ‘previous (Set corr.)’ is greater than or equal to the increment value <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\updelta$$\end{document}</tex-math><mml:math id="M2"><mml:mi mathvariant="normal">δ</mml:mi></mml:math><inline-graphic xlink:href="41598_2020_76759_Article_IEq1.gif"/></alternatives></inline-formula> (default 0.00005), place the marker into the selected marker set (‘Marker set') and update the previous correlation rate to the current correlation rate ('Set corr'); otherwise, the marker is discarded from the selected marker set, and the current correlation rate is ignored.</p></list-item><list-item><label>E.</label><p id="Par13">Iterate step D, while adding markers one by one. If the correlation rate of the selected marker set on the validation set reaches the target correlation rate defined by the user (‘Target corr’; default 1.0), stop marker selection and return the final marker list. As a stop condition, if the validation set's correlation rates do not improve <italic>p</italic> times in a row, that is, if the markers are not selected <italic>p</italic> times in succession, stop the marker selection and return the results up to that point. Here, <italic>p</italic> is a number corresponding to <italic>x</italic>% of the total number of input markers and is automatically calculated according to the <italic>x</italic> defined by the user (default 20).</p></list-item></list></p></list-item><list-item><p id="Par14">Integrate the selected marker lists of <italic>k</italic> groups into one final marker list of all <italic>k</italic> CVs. Using both RRB and BTS methods, one final marker list is generated by combining all marker lists derived from these two methods. Subsequently, the input files for the final modeling phase are made based on the final marker list.</p></list-item></list></p>
    </sec>
    <sec id="Sec5">
      <title>GMStool scheme: final modeling</title>
      <p id="Par15">The final modeling phase performs prediction modeling using RRB, random forest (RF), deep neural network (DNN), and convolution neural network (CNN) models (Fig. <xref rid="Fig1" ref-type="fig">1</xref>A). All four models, or a subset of them, can be used. Prediction modeling for each model is conducted by repeating <italic>p</italic> times (default 50), and in each <italic>p</italic>, training and validation sets are randomly constructed at a ratio of 8:2 from the training set derived from the marker selection phase. Of all the <italic>p</italic> modeling iterations in each model, the model with the highest correlation rate on the validation set is considered the final prediction model. After modeling, a final prediction is performed on the test set, and its correlation rate between the observed and predicted phenotypes is presented with the saved model file and summary plots. If more than one model is selected, the model with the highest correlation rate on the validation set is presented as the best model.</p>
    </sec>
    <sec id="Sec6">
      <title>Models of GMStool: RRB</title>
      <p id="Par16">RRB, a statistical model, assumes that marker effects follow a normal distribution with constant variance and all effect sizes are small and similar. This model is implemented using the “rrBLUP” library<sup><xref ref-type="bibr" rid="CR17">17</xref></sup> in R<sup><xref ref-type="bibr" rid="CR18">18</xref></sup>, and is used in GMStool as follows: <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbf{y}={\varvec{\mu}}+\mathbf{X}{\varvec{\beta}}+\mathbf{e},$$\end{document}</tex-math><mml:math id="M4"><mml:mrow><mml:mi mathvariant="bold">y</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">μ</mml:mi></mml:mrow><mml:mo>+</mml:mo><mml:mi mathvariant="bold">X</mml:mi><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo>+</mml:mo><mml:mi mathvariant="bold">e</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41598_2020_76759_Article_IEq2.gif"/></alternatives></inline-formula> where <inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbf{y}$$\end{document}</tex-math><mml:math id="M6"><mml:mi mathvariant="bold">y</mml:mi></mml:math><inline-graphic xlink:href="41598_2020_76759_Article_IEq3.gif"/></alternatives></inline-formula> is an <inline-formula id="IEq4"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n\times 1$$\end{document}</tex-math><mml:math id="M8"><mml:mrow><mml:mi>n</mml:mi><mml:mo>×</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="41598_2020_76759_Article_IEq4.gif"/></alternatives></inline-formula> vector of phenotype values (<italic>n</italic>; samples), <inline-formula id="IEq5"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{\mu}}$$\end{document}</tex-math><mml:math id="M10"><mml:mrow><mml:mi mathvariant="bold-italic">μ</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="41598_2020_76759_Article_IEq5.gif"/></alternatives></inline-formula> is an <inline-formula id="IEq6"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n\times 1$$\end{document}</tex-math><mml:math id="M12"><mml:mrow><mml:mi>n</mml:mi><mml:mo>×</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="41598_2020_76759_Article_IEq6.gif"/></alternatives></inline-formula> mean vector of phenotype values, <inline-formula id="IEq7"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbf{X}$$\end{document}</tex-math><mml:math id="M14"><mml:mi mathvariant="bold">X</mml:mi></mml:math><inline-graphic xlink:href="41598_2020_76759_Article_IEq7.gif"/></alternatives></inline-formula> is an <inline-formula id="IEq8"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n\times p$$\end{document}</tex-math><mml:math id="M16"><mml:mrow><mml:mi>n</mml:mi><mml:mo>×</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="41598_2020_76759_Article_IEq8.gif"/></alternatives></inline-formula> matrix of genotype markers (<italic>p</italic>; markers), <inline-formula id="IEq9"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{\beta}}$$\end{document}</tex-math><mml:math id="M18"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="41598_2020_76759_Article_IEq9.gif"/></alternatives></inline-formula> is an <italic>n</italic>
<inline-formula id="IEq10"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\times 1$$\end{document}</tex-math><mml:math id="M20"><mml:mrow><mml:mo>×</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="41598_2020_76759_Article_IEq10.gif"/></alternatives></inline-formula> vector of marker effects, and <inline-formula id="IEq11"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbf{e}$$\end{document}</tex-math><mml:math id="M22"><mml:mi mathvariant="bold">e</mml:mi></mml:math><inline-graphic xlink:href="41598_2020_76759_Article_IEq11.gif"/></alternatives></inline-formula> is an <italic>n</italic>
<inline-formula id="IEq12"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\times 1$$\end{document}</tex-math><mml:math id="M24"><mml:mrow><mml:mo>×</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="41598_2020_76759_Article_IEq12.gif"/></alternatives></inline-formula> vector of error effects with <inline-formula id="IEq13"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbf{e}\sim \boldsymbol{\rm N}(0,\boldsymbol{ }\boldsymbol{\rm I}{{\varvec{\sigma}}}_{{\varvec{e}}}^{2}$$\end{document}</tex-math><mml:math id="M26"><mml:mrow><mml:mi mathvariant="bold">e</mml:mi><mml:mo>∼</mml:mo><mml:mrow><mml:mi mathvariant="bold">N</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mrow/><mml:mrow><mml:mi mathvariant="bold">I</mml:mi></mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">σ</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">e</mml:mi></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math><inline-graphic xlink:href="41598_2020_76759_Article_IEq13.gif"/></alternatives></inline-formula><bold>)</bold>. Here, the loss function is <inline-formula id="IEq14"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal{L}\left({\varvec{\beta}}\right)={\left({\varvec{y}}-{\varvec{X}}{\varvec{\beta}}\right)}^{T}\left({\varvec{y}}-{\varvec{X}}{\varvec{\beta}}\right)+\lambda {{\varvec{\beta}}}^{T}{\varvec{\beta}},$$\end{document}</tex-math><mml:math id="M28"><mml:mrow><mml:mi mathvariant="script">L</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow></mml:mfenced></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:mfenced close=")" open="("><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:mi>λ</mml:mi><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41598_2020_76759_Article_IEq14.gif"/></alternatives></inline-formula> and <inline-formula id="IEq15"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{\beta}}$$\end{document}</tex-math><mml:math id="M30"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="41598_2020_76759_Article_IEq15.gif"/></alternatives></inline-formula> is derived as <inline-formula id="IEq16"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\widehat{{\varvec{\beta}}}={\left({{\varvec{X}}}^{T}{\varvec{X}}+\lambda {\varvec{I}}\right)}^{-1}{{\varvec{X}}}^{T}{\varvec{y}}$$\end{document}</tex-math><mml:math id="M32"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mfenced close=")" open="("><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mo>+</mml:mo><mml:mi>λ</mml:mi><mml:mrow><mml:mi mathvariant="bold-italic">I</mml:mi></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="41598_2020_76759_Article_IEq16.gif"/></alternatives></inline-formula>. The penalty parameter <inline-formula id="IEq17"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda$$\end{document}</tex-math><mml:math id="M34"><mml:mi>λ</mml:mi></mml:math><inline-graphic xlink:href="41598_2020_76759_Article_IEq17.gif"/></alternatives></inline-formula> is estimated from the training data under the RRB model<sup><xref ref-type="bibr" rid="CR19">19</xref></sup>. The <inline-formula id="IEq18"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{\beta}}$$\end{document}</tex-math><mml:math id="M36"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="41598_2020_76759_Article_IEq18.gif"/></alternatives></inline-formula> values estimated from the training set are used to predict phenotype values for the validation and test datasets.</p>
    </sec>
    <sec id="Sec7">
      <title>Models of GMStool: RF and BTS</title>
      <p id="Par17">RF, a decision tree-based machine learning model, provides an explicit representation of markers' interactions without needing to pre-define the interactions. Thus, RF can reflect SNP-SNP interactions when modeling genotype data<sup><xref ref-type="bibr" rid="CR20">20</xref></sup>. The RF for regression trees in GMStool is implemented through the “randomForest”<sup><xref ref-type="bibr" rid="CR21">21</xref></sup> library in R<sup><xref ref-type="bibr" rid="CR18">18</xref></sup> and used in the final modeling phases as follows:<list list-type="order"><list-item><p id="Par18">Generate 1000 bootstrap datasets by sampling the training samples with a 0.632 ratio.</p></list-item><list-item><p id="Par19">Construct regression trees by sampling 1/3 of the total input markers for each dataset.</p></list-item><list-item><p id="Par20">Grow the regression trees by splitting markers, with the loss function of the root mean square error.</p></list-item><list-item><p id="Par21">Derive the predicted phenotypes of the validation and test sets by averaging the phenotype values predicted from the 1000 trees.</p></list-item></list></p>
      <p id="Par22">In the RF model, it is possible that none of the specific markers will be included in every tree due to marker sampling. Therefore, the marker selection phase uses the BTS model, an RF model that excludes the marker sampling function, and only the sample bootstrap function remains. The BTS model uses 100 trees sampled at a 0.632 ratio from the training samples and grows the trees without marker sampling. Then, in the same way as RF, the BTS model calculates the validation set's predicted phenotypes.</p>
    </sec>
    <sec id="Sec8">
      <title>Models of GMStool: DNN and CNN</title>
      <p id="Par23">DNN and CNN, two deep learning models, are implemented using the "tensorflow”<sup><xref ref-type="bibr" rid="CR22">22</xref></sup> and "keras”<sup><xref ref-type="bibr" rid="CR23">23</xref></sup> libraries in R<sup><xref ref-type="bibr" rid="CR18">18</xref></sup>. These two models can take SNP-SNP interactions into account during modeling and computed at high speed through a graphics processing unit (GPU)<sup><xref ref-type="bibr" rid="CR24">24</xref></sup>. The DNN model in GMStool has a 256-128-64-32-16-1 architecture: one input layer with the number of neurons equal to marker size, five fully connected layers with 256, 128, 64, 32, and 16 neurons, respectively, and one output layer with one neuron (Fig. <xref rid="Fig2" ref-type="fig">2</xref>A). The architecture of the CNN is constructed as a 32-16-8-64-32-16-1: one input layer with the number of neurons equal to marker size, three convolution layers with 32, 16, and 8 kernels, one sampling layer, three fully connected layers with 64, 32, and 16 neurons, respectively, and one output layer with one neuron (Fig. <xref rid="Fig2" ref-type="fig">2</xref>B). To prevent overfitting, dropout layers are applied to the DNN and CNN models. Parameters are optimized using the AdaMax algorithm<sup><xref ref-type="bibr" rid="CR25">25</xref></sup> with a learning rate of 0.001 on DNN and 0.003 on CNN, through a maximum of 1000 epochs. Batch sizes are set to one-twentieth of the input samples, and the loss function is the mean squared error. During optimization, an early stop of 30 epochs and a learning rate decay of 0.0003 are applied to reduce the computational time and avoid overfitting. In using the CNN, input markers are automatically sorted in ascending order according to chromosome and physical numbers to consider the interactions between adjacent markers effectively. The other models, including DNN, uses input markers sorted in the most selected order among all CVs. After modeling, phenotype predictions are performed on the validation and test sets.<fig id="Fig2"><label>Figure 2</label><caption><p>Architectures of the DNN and CNN regression models for the final modeling phase. (<bold>A</bold>) DNN model has five fully connected layers, and (<bold>B</bold>) CNN model has three convolution layers and three fully connected layers. The drop-out rates and kernel sizes are indicated in parentheses at the right of the figures. <italic>FC </italic>full connection and <italic>Conv</italic> convolution, respectively.</p></caption><graphic xlink:href="41598_2020_76759_Fig2_HTML" id="MO2"/></fig></p>
    </sec>
    <sec id="Sec9">
      <title>Evaluation data and GWAS</title>
      <p id="Par24">Rice (<italic>Oryza sativa</italic>) and soybean (<italic>Glycine max</italic>) data were used to evaluate the performance of GMStool (Table <xref rid="Tab1" ref-type="table">1</xref>). The rice data for both genotypes and phenotypes were obtained from <ext-link ext-link-type="uri" xlink:href="http://www.ricediversity.org">www.ricediversity.org</ext-link><sup><xref ref-type="bibr" rid="CR26">26</xref></sup>. The soybean data for genotypes were obtained from <ext-link ext-link-type="uri" xlink:href="http://www.soybase.org/data/public/Glycine_max/Wm82.gnm2.div.L78C">www.soybase.org/data/public/Glycine_max/Wm82.gnm2.div.L78C</ext-link><sup><xref ref-type="bibr" rid="CR27">27</xref></sup>, and its phenotype data was shared from our previous study<sup><xref ref-type="bibr" rid="CR28">28</xref></sup>. In the present study, the rice genotype data consisted of 413 samples with 44,100 SNPs, and the soybean genotype data consisted of 1928 samples with 170,223 SNPs. SNPs with a minor allele frequency (MAF) of &lt; 1% were filtered out, and 36,901 and 95,776 SNPs with missing rates of 0.043 and 0.005 were obtained from the rice and soybean datasets, respectively. Imputation was then conducted on both datasets using BEAGLE v5.1<sup><xref ref-type="bibr" rid="CR29">29</xref></sup>. For the phenotype data, the days to flowering time (DTF), protein content (PC), and plant height (PH) were used for rice, and DTF was used for soybean.<table-wrap id="Tab1"><label>Table 1</label><caption><p>Samples, markers, and phenotypes for the rice and soybean datasets.</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Data</th><th align="left">Samples</th><th align="left">Markers<sup>a</sup></th><th align="left">Phenotype</th><th align="left">Samples</th><th align="left">Median</th><th align="left">Mean</th><th align="left">Std</th></tr></thead><tbody><tr><td align="left" rowspan="3">Rice</td><td align="left" rowspan="3">413</td><td align="left" rowspan="3">36,901/44,100</td><td align="left">DTF</td><td align="left">305</td><td char="." align="char">74.00</td><td char="." align="char">71.77</td><td char="." align="char">8.51</td></tr><tr><td align="left">PC</td><td align="left">383</td><td char="." align="char">117.50</td><td char="." align="char">116.58</td><td char="." align="char">21.09</td></tr><tr><td align="left">PH</td><td align="left">393</td><td char="." align="char">8.45</td><td char="." align="char">8.59</td><td char="." align="char">0.94</td></tr><tr><td align="left">Soybean</td><td align="left">1928</td><td align="left">95,776/170,223</td><td align="left">DTF</td><td align="left">1,861</td><td char="." align="char">46.00</td><td char="." align="char">44.87</td><td char="." align="char">6.34</td></tr></tbody></table><table-wrap-foot><p><sup>a</sup>Number in front of “/” indicates the number of markers filtered with MAF &lt; 1%, and the number behind indicates the number of all markers.</p></table-wrap-foot></table-wrap></p>
      <p id="Par25">Prior to the GWAS, the test sets of each dataset were randomly selected at a rate of 20% (Table <xref rid="Tab2" ref-type="table">2</xref>). For the DTF, PC, and PH of rice, the test sample sizes were 61, 76, 78, and the training sample sizes were 244, 307, and 315, respectively. Soybean, the larger dataset, consisted of 1489 training and 372 test samples. The test set samples were representative of the genomic diversity of the total samples, as shown by their even distribution without a bias in the principal component analysis based on population structure (Supplementary Fig. <xref rid="MOESM1" ref-type="media">S1</xref>).<table-wrap id="Tab2"><label>Table 2</label><caption><p>Selected marker sets and correlation rates for all CVs.</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Data</th><th align="left">Phenotype</th><th align="left">Method</th><th align="left">Train/val./test<break/>samples</th><th align="left">Selected/all markers<sup>a</sup></th><th align="left">Train corr (mean ± std.)<sup>b</sup></th><th align="left">Val. Corr (mean ± std.)<sup>b</sup></th></tr></thead><tbody><tr><td align="left" rowspan="9">Rice</td><td align="left" rowspan="3">DTF</td><td align="left">RRB</td><td align="left">163/81/61</td><td align="left">746/36,901</td><td char="±" align="char">0.994 ± 0.007</td><td char="±" align="char">0.986 ± 0.011</td></tr><tr><td align="left">BTS</td><td align="left">163/81/61</td><td align="left">120/36,901</td><td char="±" align="char">0.946 ± 0.016</td><td char="±" align="char">0.839 ± 0.047</td></tr><tr><td align="left">RRB and BTS</td><td align="left">163/81/61</td><td align="left">817/36,901</td><td char="±" align="char">0.970 ± 0.028</td><td char="±" align="char">0.913 ± 0.086</td></tr><tr><td align="left" rowspan="3">PC</td><td align="left">RRB</td><td align="left">205/102/76</td><td align="left">805/36,901</td><td char="±" align="char">0.988 ± 0.016</td><td char="±" align="char">0.990 ± 0.005</td></tr><tr><td align="left">BTS</td><td align="left">205/102/76</td><td align="left">114/36,901</td><td char="±" align="char">0.951 ± 0.006</td><td char="±" align="char">0.841 ± 0.024</td></tr><tr><td align="left">RRB and BTS</td><td align="left">205/102/76</td><td align="left">873/36,901</td><td char="±" align="char">0.970 ± 0.023</td><td char="±" align="char">0.912 ± 0.105</td></tr><tr><td align="left" rowspan="3">PH</td><td align="left">RRB</td><td align="left">210/105/78</td><td align="left">620/36,901</td><td char="±" align="char">0.982 ± 0.013</td><td char="±" align="char">0.992 ± 0.007</td></tr><tr><td align="left">BTS</td><td align="left">210/105/78</td><td align="left">115/36,901</td><td char="±" align="char">0.970 ± 0.002</td><td char="±" align="char">0.883 ± 0.035</td></tr><tr><td align="left">RRB and BTS</td><td align="left">210/105/78</td><td align="left">675/36,901</td><td char="±" align="char">0.976 ± 0.010</td><td char="±" align="char">0.938 ± 0.063</td></tr><tr><td align="left" rowspan="3">SOY</td><td align="left" rowspan="3">DTF</td><td align="left">RRB</td><td align="left">1,191/298/372</td><td align="left">2,126/95,776</td><td char="±" align="char">0.953 ± 0.014</td><td char="±" align="char">0.993 ± 0.001</td></tr><tr><td align="left">BTS</td><td align="left">1,191/298/372</td><td align="left">224/95,776</td><td char="±" align="char">0.922 ± 0.020</td><td char="±" align="char">0.842 ± 0.040</td></tr><tr><td align="left">RRB and BTS</td><td align="left">1,191/298/372</td><td align="left">2,256/95,776</td><td char="±" align="char">0.938 ± 0.023</td><td char="±" align="char">0.917 ± 0.097</td></tr></tbody></table><table-wrap-foot><p><italic>val.</italic> mean validation and <italic>corr.</italic> correlation rate, respectively.</p><p><sup>a</sup>Selected markers were derived from the union of markers selected from all CVs.</p><p><sup>b</sup>Average and standard deviation of correlation rates for all CVs.</p></table-wrap-foot></table-wrap></p>
      <p id="Par26">GWASs were conducted for each training set using a mixed linear model of GAPIT v3, which adjusts the kinship and population structures<sup><xref ref-type="bibr" rid="CR30">30</xref></sup> (Fig. <xref rid="Fig3" ref-type="fig">3</xref> and Supplementary Table <xref rid="MOESM1" ref-type="media">S1</xref>). Considering the number of MAF-filtered markers, statistically significant <italic>p</italic>-values were set at 5 × 10<sup>–6</sup> and 5 × 10<sup>–8</sup> in the rice and soybean datasets. All heritabilities were measured as the proportion of the total phenotypic variance explained by the genotypic variance.<fig id="Fig3"><label>Figure 3</label><caption><p>GWAS results for the soybean and rice datasets. (<bold>A</bold>) Manhattan plot for soybean DTF. (<bold>B–D</bold>) Manhattan plots for rice DTF, PC, and PH. Statistical significant cut-offs for soybean and rice data are − log(5 × 10<sup>–8</sup>) and − log(5 × 10<sup>–6</sup>), respectively. The heritabilities of phenotypes are shown at the upper right of the figures.</p></caption><graphic xlink:href="41598_2020_76759_Fig3_HTML" id="MO3"/></fig></p>
    </sec>
  </sec>
  <sec id="Sec10">
    <title>Results</title>
    <sec id="Sec11">
      <title>GWAS</title>
      <p id="Par27">In the rice data, PH showed one GWAS-significant SNP with a high heritability of 0.763, while DTF and PC showed no significant markers with relatively low heritabilities of 0.317 and 0.523, respectively (Fig. <xref rid="Fig3" ref-type="fig">3</xref>). Unlike rice-DTF, soybean-DTF had a high heritability of 0.652 and showed 105 GWAS-significant SNPs. In terms of heritability, these GWAS results confirmed that soybean-DTF and rice-PH are greatly affected by genetic effects and have the potential for GP with relatively high accuracy. Rice DTF and PC were confirmed to have low genetic effects, but they were used to compare differences in GP with heritability.</p>
    </sec>
    <sec id="Sec12">
      <title>Marker selection</title>
      <p id="Par28">Marker selection for each phenotype was performed based on the genotype, phenotype, test sample list, and GWAS result files. Considering the training sample sizes, CV values of 3 and 5 were set for the rice and soybean datasets, respectively. The training and validation sizes in each CV were 163 and 81 in rice-DTF, 205 and 102 in PC, 210 and 105 in PH, and 1,191 and 298 in soybean-DTF, respectively (Table <xref rid="Tab2" ref-type="table">2</xref>). Other selection options were adopted as follows: 1.0 target correlation rate, 0.00005 increment, and one initial marker (− c, − d, and − is; 1.0, 0.00005, and 1). In addition, the stop option was applied, which terminates the selection if SNPs are not continuously selected as many as a number corresponding to 20% of the total input markers (− x; 20). All selection methods were adopted for the method option for comparisons (− m; RRB, BTS, and RRB_BTS). As a result, the number of selected markers for the three methods were 746-120-817, 805-114-873, and 620-115-675 in the rice DTF, PC, and PH phenotypes, respectively, and 2126-224-2256 in the soybean DTF phenotype (Table <xref rid="Tab2" ref-type="table">2</xref> and Supplementary Table <xref rid="MOESM1" ref-type="media">S2</xref>). When both RRB and BTS were used, the largest number of markers were selected, and in a separate method, more markers were selected when using RRB than BTS. In the case of rice, the higher the heritability, the fewer markers tended to be selected. The correlation rates between the observed and predicted phenotypes of the validation sets ranged from a minimum of 0.839 (rice-DTF and BTS) to a maximum of 0.992 (PH and RRB). Although some of the correlation rates were not relatively high, each selection method selected as many potential markers as possible under the target correlation rate of 1.0. During the rice phenotypes selection process, the BTS method read all 36,901 input markers for all CVs, and the RRB method read all markers for 1 or 2 CVs (out of 3 CVs). The rest of the CVs were stopped according to the stop condition since their markers were not selected 7380 times in succession. In soybean DTF, this stop condition was applied to all 5 CVs of both methods because their markers were also not selected 19,155 times consecutively in all CVs. As for the average calculation time per CV, RRB took from 4 h 52 m (rice-DTF) to 15 h 6 m (soybean-DTF), and BTS took from 4 h 25 m (rice-DTF) to 8 h 2 m (soybean-DTF), using the Intel Xeon E5-2680 central processing unit (CPU) (Supplementary Table <xref rid="MOESM1" ref-type="media">S3</xref>). Using both methods took a minimum of 9 h 24 m (rice-DTF) and a maximum of 23 h 32 m (soybean-DTF). The calculation time of RRB took longer than that of BTS, and they all tended to require more time with larger sample sizes.</p>
    </sec>
    <sec id="Sec13">
      <title>Final prediction</title>
      <p id="Par29">The modeling for GPs was conducted on all the marker sets selected by the three methods (Table <xref rid="Tab2" ref-type="table">2</xref>), using all four prediction models, RRB, RF, DNN, and CNN (Fig. <xref rid="Fig4" ref-type="fig">4</xref>, Table <xref rid="Tab3" ref-type="table">3</xref>). After the modeling, the test sets of the four phenotypes, which were not included during the marker selection phase, were used for phenotype prediction, and the correlation rates between these predicted phenotypes and their observed phenotypes were calculated as the metric of the accuracy for the selected marker sets. In rice, DTF had the highest correlation rate of 0.529, using the RRB selection method and the RF prediction model. PC and PH showed the highest correlation rates, 0.547 and 0.679, when selecting markers using RRB-BTS and predicting with CNN and DNN, respectively. Soybean-DTF had the highest correlation rate, 0.794, under the RRB-BTS selection method and CNN prediction model. Excluding rice-DTF, which had the lowest heritability, using the RRB-BTS selection method and the deep-learning model showed the best prediction performance. Generally, as heritability was higher, the correlation rate was also higher, and the predicted phenotypes exhibited stronger linearity with the observed phenotypes (Supplementary Fig. <xref rid="MOESM1" ref-type="media">S2</xref>). In this result, the BTS selection method derives marker sets with the smallest number of markers, but its prediction performances were not significantly different compared to other selection methods. Under the best prediction models, the number of selected markers was 746, 873, 675, and 2256 in rice-DTF, PC, PH, and soybean-DTF, respectively (Table <xref rid="Tab3" ref-type="table">3</xref>). These markers were distributed throughout the chromosomes, particularly in soybean DTF and PH, with high heritability. The number of markers for each chromosome was proportional to the GWAS-peak (Fig. <xref rid="Fig3" ref-type="fig">3</xref> and Supplementary Fig. <xref rid="MOESM1" ref-type="media">S3</xref>). Regarding computation time, RRB took the least time, followed by CNN, DNN, and RF (Supplementary Table <xref rid="MOESM1" ref-type="media">S3</xref>). RRB and RF were computed using the Intel Xeon E5-2680 CPU, and DNN and CNN were computed using the Quadro RTX 6000 GPU. The larger the marker set, the more time tended to be required for completion.<fig id="Fig4"><label>Figure 4</label><caption><p>Correlation rates of test sets for four phenotypes, along with selection methods and prediction models. (<bold>A</bold>) Correlation rate of soybean DTF. (<bold>B</bold>–<bold>D</bold>) Correlation rates of rice DTF, PC, and PH. The <italic>y</italic>-axis indicates the correlation rate, and above and below the <italic>x</italic>-axis represents the selection methods and prediction models, respectively. The highest correlation rates for each phenotype are shown in bold, and the highest correlation rates when using all markers are indicated by a horizontal red line with that prediction model.</p></caption><graphic xlink:href="41598_2020_76759_Fig4_HTML" id="MO4"/></fig><table-wrap id="Tab3"><label>Table 3</label><caption><p>Final correlation rates of the selected marker sets on the test sets.</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Data</th><th align="left">Phenotype</th><th align="left">Method</th><th align="left">Selected markers</th><th align="left">RRB (train/val./test)</th><th align="left">RF (train/val./test)</th><th align="left">DNN (train/val./test)</th><th align="left">CNN (train/val./test)</th></tr></thead><tbody><tr><td align="left" rowspan="9">Rice</td><td align="left" rowspan="3">DTF</td><td align="left">RRB</td><td align="left">746</td><td align="left">0.997/0.870/0.380</td><td align="left">0.976/0.845/<bold>0.529</bold></td><td align="left">0.932/0.912/0.334</td><td align="left">0.948/0.895/0.469</td></tr><tr><td align="left">BTS</td><td align="left">120</td><td align="left">0.849/0.710/0.398</td><td align="left">0.969/0.869/0.454</td><td align="left">0.920/0.759/0.407</td><td align="left">0.902/0.748/0.501</td></tr><tr><td align="left">RRB and BTS</td><td align="left">817</td><td align="left">0.996/0.854/0.394</td><td align="left">0.977/0.847/0.508</td><td align="left">0.977/0.895/0.388</td><td align="left">0.942/0.840/0.424</td></tr><tr><td align="left" rowspan="3">PC</td><td align="left">RRB</td><td align="left">805</td><td align="left">0.998/0.831/0.509</td><td align="left">0.974/0.742/0.520</td><td align="left">0.873/0.811/0.450</td><td align="left">0.917/0.833/0.480</td></tr><tr><td align="left">BTS</td><td align="left">114</td><td align="left">0.879/0.746/0.457</td><td align="left">0.971/0.767/0.528</td><td align="left">0.826/0.769/0.408</td><td align="left">0.868/0.801/0.506</td></tr><tr><td align="left">RRB and BTS</td><td align="left">873</td><td align="left">0.998/0.845/0.504</td><td align="left">0.975/0.745/0.535</td><td align="left">0.907/0.802/0.423</td><td align="left">0.937/0.854/<bold>0.547</bold></td></tr><tr><td align="left" rowspan="3">PH</td><td align="left">RRB</td><td align="left">620</td><td align="left">0.992/0.924/0.579</td><td align="left">0.981/0.915/0.654</td><td align="left">0.977/0.932/0.630</td><td align="left">0.956/0.909/0.615</td></tr><tr><td align="left">BTS</td><td align="left">115</td><td align="left">0.937/0.862/0.607</td><td align="left">0.979/0.918/0.668</td><td align="left">0.973/0.930/0.588</td><td align="left">0.958/0.925/0.524</td></tr><tr><td align="left">RRB and BTS</td><td align="left">675</td><td align="left">0.992/0.923/0.599</td><td align="left">0.981/0.918/0.653</td><td align="left">0.922/0.905/<bold>0.679</bold></td><td align="left">0.943/0.903/0.672</td></tr><tr><td align="left" rowspan="3">SOY</td><td align="left" rowspan="3">DTF</td><td align="left">RRB</td><td align="left">2126</td><td align="left">0.989/0.936/0.742</td><td align="left">0.914/0.897/0.772</td><td align="left">0.965/0.928/0.735</td><td align="left">0.980/0.838/0.792</td></tr><tr><td align="left">BTS</td><td align="left">224</td><td align="left">0.853/0.821/0.774</td><td align="left">0.816/0.820/0.775</td><td align="left">0.855/0.839/0.774</td><td align="left">0.973/0.823/0.772</td></tr><tr><td align="left">RRB and BTS</td><td align="left">2256</td><td align="left">0.989/0.935/0.743</td><td align="left">0.922/0.907/0.750</td><td align="left">0.967/0.923/0.741</td><td align="left">0.980/0.837/<bold>0.794</bold></td></tr></tbody></table><table-wrap-foot><p>Highest correlation rates in each phenotype are shown in bold.</p></table-wrap-foot></table-wrap></p>
    </sec>
    <sec id="Sec14">
      <title>Performance comparison</title>
      <p id="Par30">To evaluate the performance of GMStool, additional tests were conducted on the whole marker sets, and the marker sets corresponding to the top 0.5%, 1%, 2%, and 3% of the significant GWAS hits (Table <xref rid="Tab4" ref-type="table">4</xref>). These additional tests used the same test sets applied in the marker selection and final modeling. For the whole marker sets, the correlation rates of rice-DTF, PC, PH, and soybean-DTF were the highest at 0.529, 0.542, 0.631, and 0.763 in the RF, RF, RRB, and DNN prediction models, respectively. In rice-DTF with the lowest heritability of 0.317, the correlation rate of all markers was higher than those of GWAS-top markers and showed the same value as the correlation rate of the optimal marker set selected from GMStool (Fig. <xref rid="Fig4" ref-type="fig">4</xref>). For the other phenotypes with a heritability of &gt; 0.5, the correlation rates of all markers were lower than those of the GWAS-top 3% markers as well as lower than those of the optimal marker sets. As heritability increases, the combinations of the selection-prediction methods with higher correlation rates than the whole marker set tended to increase. Among the GWAS-top marker sets, the top 3% marker sets showed the highest correlation rates (except rice-DTF), but all of them were lower than the GMStool’s optimal marker sets (Table <xref rid="Tab4" ref-type="table">4</xref>). The optimal marker sets of PC and PH showed 1.003- and 1.015-times higher correlation rates with 21% and 39% fewer markers, respectively, and soybean-DTF showed 1.030 times higher correlation rate with 21% fewer markers than the GWAS-top 3% marker set. Overall, GMStool formed optimal marker sets with a relatively small number of markers and achieved better performance than the whole marker and GWAS-top 3% marker sets.<table-wrap id="Tab4"><label>Table 4</label><caption><p>Correlation rates of the GWAS-top 0.5%, 1%, 2%, and 3% marker-sets and whole marker-set.</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Data</th><th align="left">Phenotype</th><th align="left">Selected markers<sup>a</sup></th><th align="left">RRB (train/val./test)</th><th align="left">RF (train/val./test)</th><th align="left">DNN (train/val./test)</th><th align="left">CNN (train/val./test)</th></tr></thead><tbody><tr><td align="left" rowspan="15">Rice</td><td align="left" rowspan="5">DTF</td><td align="left">184</td><td align="left">0.838/0.777/0.343</td><td align="left">0.935/0.641/0.330</td><td align="left">0.914/0.727/0.328</td><td align="left">0.862/0.686/0.301</td></tr><tr><td align="left">369</td><td align="left">0.890/0.709/0.480</td><td align="left">0.963/0.570/0.464</td><td align="left">0.945/0.717/0.412</td><td align="left">0.905/0.656/0.410</td></tr><tr><td align="left">738</td><td align="left">0.919/0.715/0.478</td><td align="left">0.968/0.621/0.484</td><td align="left">0.962/0.726/0.406</td><td align="left">0.925/0.734/0.468</td></tr><tr><td align="left">1107</td><td align="left">0.940/0.715/0.448</td><td align="left">0.968/0.644/0.485</td><td align="left">0.966/0.713/0.486</td><td align="left">0.931/0.659/0.439</td></tr><tr><td align="left">All</td><td align="left">0.844/0.412/0.515</td><td align="left">0.964/0.398/<bold>0.529</bold></td><td align="left">0.899/0.366/0.512</td><td align="left">0.923/0.363/0.504</td></tr><tr><td align="left" rowspan="5">PC</td><td align="left">184</td><td align="left">0.816/0.744/0.366</td><td align="left">0.947/0.500/0.376</td><td align="left">0.851/0.664/0.304</td><td align="left">0.834/0.680/0.308</td></tr><tr><td align="left">369</td><td align="left">0.871/0.717/0.517</td><td align="left">0.960/0.524/0.471</td><td align="left">0.844/0.624/0.486</td><td align="left">0.872/0.555/0.387</td></tr><tr><td align="left">738</td><td align="left">0.917/0.761/0.508</td><td align="left">0.963/0.513/0.521</td><td align="left">0.874/0.619/0.532</td><td align="left">0.891/0.708/0.402</td></tr><tr><td align="left">1107</td><td align="left">0.944/0.760/<bold>0.545</bold></td><td align="left">0.968/0.495/0.537</td><td align="left">0.958/0.776/0.531</td><td align="left">0.912/0.732/0.422</td></tr><tr><td align="left">All</td><td align="left">0.874/0.449/0.473</td><td align="left">0.968/0.326/0.542</td><td align="left">0.902/0.554/0.521</td><td align="left">0.917/0.415/0.400</td></tr><tr><td align="left" rowspan="5">PH</td><td align="left">184</td><td align="left">0.914/0.834/0.494</td><td align="left">0.971/0.787/0.578</td><td align="left">0.931/0.795/0.492</td><td align="left">0.944/0.814/0.586</td></tr><tr><td align="left">369</td><td align="left">0.946/0.859/0.571</td><td align="left">0.976/0.808/0.617</td><td align="left">0.934/0.823/0.579</td><td align="left">0.950/0.772/0.643</td></tr><tr><td align="left">738</td><td align="left">0.970/0.869/0.566</td><td align="left">0.980/0.830/0.646</td><td align="left">0.956/0.875/0.527</td><td align="left">0.952/0.865/0.527</td></tr><tr><td align="left">1107</td><td align="left">0.982/0.897/0.636</td><td align="left">0.979/0.849/0.661</td><td align="left">0.964/0.890/0.603</td><td align="left">0.955/0.879/<bold>0.669</bold></td></tr><tr><td align="left">All</td><td align="left">0.985/0.733/0.631</td><td align="left">0.972/0.737/0.548</td><td align="left">0.912/0.765/0.624</td><td align="left">0.972/0.737/0.548</td></tr><tr><td align="left" rowspan="5">SOY</td><td align="left" rowspan="5">DTF</td><td align="left">478</td><td align="left">0.641/0.558/0.578</td><td align="left">0.744/0.644/0.627</td><td align="left">0.663/0.660/0.628</td><td align="left">0.566/0.578/0.584</td></tr><tr><td align="left">957</td><td align="left">0.832/0.795/0.705</td><td align="left">0.957/0.778/0.725</td><td align="left">0.825/0.763/0.705</td><td align="left">0.634/0.636/0.656</td></tr><tr><td align="left">1914</td><td align="left">0.905/0.840/0.757</td><td align="left">0.974/0.775/0.764</td><td align="left">0.897/0.825/0.747</td><td align="left">0.846/0.804/0.739</td></tr><tr><td align="left">2871</td><td align="left">0.944/0.872/0.767</td><td align="left">0.978/0.809/<bold>0.771</bold></td><td align="left">0.938/0.850/0.746</td><td align="left">0.810/0.804/0.753</td></tr><tr><td align="left">All</td><td align="left">0.973/0.743/0.753</td><td align="left">0.976/0.752/0.760</td><td align="left">0.921/0.751/0.763</td><td align="left">0.904/0.721/0.748</td></tr></tbody></table><table-wrap-foot><p>Highest correlation rates in each phenotype are shown in bold.</p><p><sup>a</sup>Rows of each phenotype represent the number of GWAS top 0.5%, 1%, 2%, and 3%, and all markers in order.</p></table-wrap-foot></table-wrap></p>
    </sec>
  </sec>
  <sec id="Sec15">
    <title>Discussion</title>
    <p id="Par31">Selecting optimal markers reduces the dimensionality of genomic data for prediction and provides a small number of model parameters for better generalization in prediction modeling<sup><xref ref-type="bibr" rid="CR13">13</xref></sup>. The prediction accuracy of an optimal marker set depends on how well it reflects the characteristics of the markers involved in a phenotype; thus, it is important to construct a marker-set with appropriate markers<sup><xref ref-type="bibr" rid="CR14">14</xref></sup>. In this respect, many studies have adopted approaches that either directly exclude uninformative markers or assign weights to markers according to their contributions in a large set of markers<sup><xref ref-type="bibr" rid="CR31">31</xref>–<xref ref-type="bibr" rid="CR33">33</xref></sup>. These approaches have contributed to improving the accuracy of the GP, but simultaneously, it is difficult to select the appropriate markers to be excluded or the weight values to be assigned. In particular, when these approaches are based on GWAS, obtaining robust weights is problematic due to marker effects or <italic>p</italic>-values being calculated differently according to the GWAS methods<sup><xref ref-type="bibr" rid="CR31">31</xref></sup>. Moreover, these approaches often require an amount of computation if they conduct modeling based on the large marker set. As a means of solving these problems, this study proposed a new approach tool, GMStool.</p>
    <p id="Par32">GMStool selects such optimal marker sets more effectively. Based on the prioritization of markers derived from a GWAS, GMStool sequentially searches for markers that increase the correlation rate between observed and predicted phenotypes and constructs an optimal marker set by accumulating these markers individually. As selection methods, the RRB model is provided to reflect the additive effects of markers on a phenotype, and the BTS model is provided to consider the interaction effects of markers, although indirect due to the use of GWAS. GMStool applies a <italic>k</italic>-fold CV approach with multi-threading and finally delivers an optimal marker set with minimal overfitting for a given dataset<sup><xref ref-type="bibr" rid="CR34">34</xref></sup>. Additionally, to enable the flexible selection of optimal marker sets from various phenotypes, GMStool offers various options, such as a pre-selected marker list, initial markers, target correlation, increment rate of correlation, selection methods, and CV <italic>k</italic>-value (the –pre, –is, –c, –d, –m, and –cv options, respectively).</p>
    <p id="Par33">Evaluation of the optimal marker sets is essential for presenting them as predictive marker sets. No single model best predicts all phenotypes<sup><xref ref-type="bibr" rid="CR35">35</xref></sup>; thus, to handle diverse phenotypes, GMStool provides four types of models in the prediction modeling: RRB, RF, DNN, and CNN. RRB assumes no interaction between markers but can predict phenotypes with high accuracy in practice<sup><xref ref-type="bibr" rid="CR36">36</xref></sup>. RF has the ability to predict phenotypes by considering interaction effects as well as the dominance effects of markers<sup><xref ref-type="bibr" rid="CR37">37</xref></sup>. DNN and CNN learn the global and local genotype patterns associated with a phenotype, thus can reflect the complicated relationship between genotype and phenotype without requiring predefined rules (e.g., normal distribution, non-zero equal variance)<sup><xref ref-type="bibr" rid="CR24">24</xref></sup>. The DNN and CNN models of GMStool were built only to predict the optimal marker sets (Fig. <xref rid="Fig2" ref-type="fig">2</xref>) and are not provided in the marker selection phase because of the model complexity with various techniques applied to reduce overfitting (Fig. <xref rid="Fig2" ref-type="fig">2</xref>). Among the models provided, the RF, DNN, and CNN models can reflect the interaction effects of markers, but the interaction effects in the optimal marker set are considered restrictive since GMStool’s markers are selected based on the GWAS.</p>
    <p id="Par34">GMStool showed high performance on real datasets. The optimal marker sets of the rice-DTF, PC, PH, and soybean-DTF phenotypes were constructed as 746, 873, 675, and 2256 markers through RRB, RRB-BTS, RRB-BTS, and RRB-BTS selection methods, respectively (Table <xref rid="Tab3" ref-type="table">3</xref>). The correlation rates of the test sets were 0.529, 0.547, 0.679, and 0.794, under RF, CNN, DNN, and CNN prediction models, respectively. In the selection methods, BTS selected the smallest number of markers, but their prediction performance was not far behind that of RRB (Table <xref rid="Tab3" ref-type="table">3</xref>). Except for the rice-DTF with the lowest heritability, using both the RRB and BTS methods (RRB-BTS) showed better prediction performance than using either selection method. In particular, the RRB-BTS selection method showed the best performance when DNN or CNN was used as a prediction model. Using a phenotype with a heritability of &gt; 0.5, it is recommended to use the combination of the RRB-BTS selection method and the deep-learning prediction model that can consider the complicated relationship between markers and phenotype. In PC, PH, and soybean-DTF with a heritability of &gt; 0.5, GMStool's optimal marker sets showed higher prediction performance than those using whole marker sets (Fig. <xref rid="Fig4" ref-type="fig">4</xref>). In rice-DTF with a lower heritability of 0.317, the prediction performance was the same for the optimal marker set and the whole marker. GMStool's optimal marker sets had a much smaller number of markers but showed at least the same performance as those using all markers. However, in the case of using a phenotype with very low heritability, using all markers for prediction is recommended. This is because a large number of markers have a very low genetic effect, so a subset of all the markers has a fundamental limitation in improving the prediction performance. In comparison with GWAS-top markers, GMStool’s optimal marker sets had an average of 27% fewer markers than the GWAS-top 3% marker sets and achieved a 1.004- to 1.088-times higher performance than these marker sets (Table <xref rid="Tab4" ref-type="table">4</xref>). Overall, the GMStool constructed the optimal marker set well and showed relatively high prediction performance in the real datasets evaluated. Although GMStool has a simple algorithm, it is expected to achieve high performance on other real datasets.</p>
    <p id="Par35">Nevertheless, GMStool has several limitations. First, marker selection is influenced by the GWAS results. GMStool uses the priority of the markers derived from the GWAS result and sequentially selects markers with the lowest <italic>p</italic>-value. This approach has less dependence on the GWAS result than other tools that directly use the marker effects or <italic>p</italic>-values, but it can also derive an inappropriate marker set with low prediction accuracy if the GWAS is incorrect. One thing to be aware of when using GWAS results is that GWAS must be performed without the test set. Otherwise, an overfitted marker set may result from the reflected information for the test set<sup><xref ref-type="bibr" rid="CR16">16</xref></sup>. In addition, since high levels of linkage disequilibrium (LD) between SNPs can affect prediction performance, it is recommended to perform SNP pruning for LD before GWAS or clumping after GWAS. Second, the interaction effects of markers on the phenotype considered are indirect. Since GWAS only considers the linear effect of a single marker, GMStool based on this result has limited consideration of markers' interaction effect in RF, BTS, CNN, and DNN models. Despite these constraints, the models indirectly considering the interaction effects had occasions that showed better performances than the models that considered only linear effects in the evaluated data set. Third, the results of GMStool are affected by the input options, such as initial markers, <italic>k</italic>-CV value, increment value, and target correlation rate. Since these options are provided so that the user can flexibly cope with various phenotypes, the user should preferentially find optimal options for the target phenotype through several pretests combining these options. As for the number of initial markers, the top one GWAS marker was used as the default option under the assumption that the GWAS result is reasonable. If the GWAS result is highly reliable, the user may designate the initial markers to the markers related to phenotype from the top GWAS markers; otherwise, it is recommended to directly designate the related markers as initial markers the ‘pre-selected marker’ option. The <italic>k-</italic>value of CV is suggested to be between 3 and 5 depending on the training sample size. The increment value for the correlation rate is recommended to be at least 0.00005 to avoid excessive selection of SNPs within the same LD block, and this setting is particularly recommended if pre-processing or post-processing for LD is not performed. The target correlation rate is suggested to be at least 0.99 so that all potential markers can be selected, although the heritability of the phenotype to be used is low. In the case of low heritability, even if all potential markers for the train and validation set are selected, the final prediction performance for the test set may not be superior to the prediction performance using all markers (Fig. <xref rid="Fig4" ref-type="fig">4</xref>B). Despite these limitations, GMStool is expected to contribute to many studies predicting various quantitative phenotypes with genotypes.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary information</title>
    <sec id="Sec16">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="41598_2020_76759_MOESM1_ESM.docx">
            <caption>
              <p>Supplementary Information 1.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="41598_2020_76759_MOESM2_ESM.xlsx">
            <caption>
              <p>Supplementary Information 2.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM3">
          <media xlink:href="41598_2020_76759_MOESM3_ESM.xlsx">
            <caption>
              <p>Supplementary Information 3.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher's note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
    <fn>
      <p>These authors contributed equally: Seongmun Jeong and Jae-Yoon Kim.</p>
    </fn>
  </fn-group>
  <sec>
    <title>Supplementary information</title>
    <p>is available for this paper at 10.1038/s41598-020-76759-y.</p>
  </sec>
  <ack>
    <title>Acknowledgements</title>
    <p>We express our deepest gratitude to our collaborators, Ph.D. Man Soo Choi, Ph.D. Jung-Kyung Moon, and Ph.D. Soo-Kwon Park of the Rural Development Administration (Jeonju, Korea), for sharing the 2014-year-days-to-flowering-time phenotype of the soybean genotype data for this study (full phenotype data not provided due to on-going projects).</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author contributions</title>
    <p>S.J. devised an overview of the program and wrote the marker-selection phase of the GMStool in R language. J.-Y.K. wrote the final modeling phase of the GMStool in R language and performed the analysis. J.-Y.K and S.J. wrote the entire manuscript. N.K. designed and supervised this project. All authors have reviewed the manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>This work was supported by grants from the National Research Foundation of Korea (NRF-2014M3C9A3064552 and NRF-2020R1I1A2055030), Next-Gen Bio-Green21 PJ01313201, and the KRIBB initiative program.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Data availability</title>
    <p>The program GMStool developed in this study is freely available at <ext-link ext-link-type="uri" xlink:href="http://www.github.com/JaeYoonKim72/GMStool">www.github.com/JaeYoonKim72/GMStool</ext-link>, with detailed usage instructions and example files.</p>
  </notes>
  <notes id="FPar1" notes-type="COI-statement">
    <title>Competing interests</title>
    <p id="Par36">The authors declare no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bian</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Holland</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Enhancing genomic prediction with genome-wide association studies in multiparental maize populations</article-title>
        <source>Heredity (Edinb)</source>
        <year>2017</year>
        <volume>118</volume>
        <issue>6</issue>
        <fpage>585</fpage>
        <lpage>593</lpage>
        <pub-id pub-id-type="doi">10.1038/hdy.2017.4</pub-id>
        <pub-id pub-id-type="pmid">28198815</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pérez-Enciso</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Zingaretti</surname>
            <given-names>LM</given-names>
          </name>
        </person-group>
        <article-title>A guide on deep learning for complex trait genomic prediction</article-title>
        <source>Genes (Basel)</source>
        <year>2019</year>
        <volume>10</volume>
        <issue>7</issue>
        <fpage>E553</fpage>
        <pub-id pub-id-type="doi">10.3390/genes10070553</pub-id>
        <pub-id pub-id-type="pmid">31330861</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Druet</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Macleod</surname>
            <given-names>IM</given-names>
          </name>
          <name>
            <surname>Hayes</surname>
            <given-names>BJ</given-names>
          </name>
        </person-group>
        <article-title>Toward genomic prediction from whole-genome sequence data: Impact of sequencing design on genotype imputation and accuracy of predictions</article-title>
        <source>Heredity (Edinb)</source>
        <year>2014</year>
        <volume>112</volume>
        <issue>1</issue>
        <fpage>39</fpage>
        <lpage>47</lpage>
        <pub-id pub-id-type="doi">10.1038/hdy.2013.13</pub-id>
        <pub-id pub-id-type="pmid">23549338</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ober</surname>
            <given-names>U</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Using whole-genome sequence data to predict quantitative trait phenotypes in <italic>Drosophila melanogaster</italic></article-title>
        <source>PLoS Genet.</source>
        <year>2012</year>
        <volume>8</volume>
        <issue>5</issue>
        <fpage>e1002685</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pgen.1002685</pub-id>
        <?supplied-pmid 22570636?>
        <pub-id pub-id-type="pmid">22570636</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Veerkamp</surname>
            <given-names>RF</given-names>
          </name>
          <name>
            <surname>Bouwman</surname>
            <given-names>AC</given-names>
          </name>
          <name>
            <surname>Schrooten</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Calus</surname>
            <given-names>MP</given-names>
          </name>
        </person-group>
        <article-title>Genomic prediction using preselected DNA variants from a GWAS with whole-genome sequence data in Holstein–Friesian cattle</article-title>
        <source>Genet. Sel. Evol.</source>
        <year>2016</year>
        <volume>48</volume>
        <issue>1</issue>
        <fpage>95</fpage>
        <pub-id pub-id-type="doi">10.1186/s12711-016-0274-1</pub-id>
        <?supplied-pmid 27905878?>
        <pub-id pub-id-type="pmid">27905878</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Al</surname>
            <given-names>K</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Using imputed whole-genome sequence data to improve the accuracy of genomic prediction for parasite resistance in Australian sheep</article-title>
        <source>Genet. Sel. Evol.</source>
        <year>2019</year>
        <volume>51</volume>
        <issue>1</issue>
        <fpage>32</fpage>
        <pub-id pub-id-type="doi">10.1186/s12711-019-0476-4</pub-id>
        <pub-id pub-id-type="pmid">31242855</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ni</surname>
            <given-names>G</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Whole-genome sequence-based genomic prediction in laying chickens with different genomic relationship matrices to account for genetic architecture</article-title>
        <source>Genet. Sel. Evol.</source>
        <year>2017</year>
        <volume>49</volume>
        <issue>1</issue>
        <fpage>8</fpage>
        <pub-id pub-id-type="doi">10.1186/s12711-016-0277-y</pub-id>
        <?supplied-pmid 28093063?>
        <pub-id pub-id-type="pmid">28093063</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Brøndum</surname>
            <given-names>RF</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Quantitative trait loci markers derived from whole genome sequence data increases the reliability of genomic prediction</article-title>
        <source>J. Dairy Sci.</source>
        <year>2015</year>
        <volume>98</volume>
        <issue>6</issue>
        <fpage>4107</fpage>
        <lpage>4116</lpage>
        <pub-id pub-id-type="doi">10.3168/jds.2014-9005</pub-id>
        <?supplied-pmid 25892697?>
        <pub-id pub-id-type="pmid">25892697</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>van den Berg</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Boichard</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Guldbrandtsen</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Lund</surname>
            <given-names>MS</given-names>
          </name>
        </person-group>
        <article-title>Using sequence variants in linkage disequilibrium with causative mutations to improve across-breed prediction in dairy cattle: A simulation study</article-title>
        <source>G3 (Bethesda)</source>
        <year>2016</year>
        <volume>6</volume>
        <issue>8</issue>
        <fpage>2553</fpage>
        <lpage>2561</lpage>
        <pub-id pub-id-type="doi">10.1534/g3.116.027730</pub-id>
        <pub-id pub-id-type="pmid">27317779</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mihaescu</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Meigs</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Sijbrands</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Janssens</surname>
            <given-names>AC</given-names>
          </name>
        </person-group>
        <article-title>Genetic risk profiling for prediction of type 2 diabetes</article-title>
        <source>PLoS Curr.</source>
        <year>2011</year>
        <pub-id pub-id-type="doi">10.1371/currents.RRN1208</pub-id>
        <?supplied-pmid 21278902?>
        <pub-id pub-id-type="pmid">21278902</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Manolio</surname>
            <given-names>TA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Finding the missing heritability of complex diseases</article-title>
        <source>Nature</source>
        <year>2009</year>
        <volume>461</volume>
        <issue>7265</issue>
        <fpage>747</fpage>
        <lpage>753</lpage>
        <pub-id pub-id-type="doi">10.1038/nature08494</pub-id>
        <?supplied-pmid 19812666?>
        <pub-id pub-id-type="pmid">19812666</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Balding</surname>
            <given-names>DJ</given-names>
          </name>
        </person-group>
        <article-title>A tutorial on statistical methods for population association studies</article-title>
        <source>Nat. Rev. Genet.</source>
        <year>2006</year>
        <volume>7</volume>
        <issue>10</issue>
        <fpage>781</fpage>
        <lpage>791</lpage>
        <pub-id pub-id-type="doi">10.1038/nrg1916</pub-id>
        <?supplied-pmid 16983374?>
        <pub-id pub-id-type="pmid">16983374</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bermingham</surname>
            <given-names>ML</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Application of high-dimensional feature selection: Evaluation for genomic prediction in man</article-title>
        <source>Sci. Rep.</source>
        <year>2015</year>
        <volume>5</volume>
        <fpage>10312</fpage>
        <pub-id pub-id-type="doi">10.1038/srep10312</pub-id>
        <?supplied-pmid 25988841?>
        <pub-id pub-id-type="pmid">25988841</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Filho</surname>
            <given-names>DF</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Tournaments between markers as a strategy to enhance genomic predictions</article-title>
        <source>PLoS ONE</source>
        <year>2019</year>
        <volume>14</volume>
        <issue>6</issue>
        <fpage>e0217283</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0217283</pub-id>
        <?supplied-pmid 31233512?>
        <pub-id pub-id-type="pmid">31233512</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yilmaz</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Tastan</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Cicek</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>Spadis: An algorithm for selecting predictive and diverse snps in gwas</article-title>
        <source>IEEE ACM Trans. Comput. Biol. Bioinform.</source>
        <year>2019</year>
        <pub-id pub-id-type="doi">10.1109/TCBB.2019.2935437</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wray</surname>
            <given-names>NR</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Pitfalls of predicting complex traits from SNPs</article-title>
        <source>Nat. Rev. Genet.</source>
        <year>2013</year>
        <volume>14</volume>
        <issue>7</issue>
        <fpage>507</fpage>
        <lpage>515</lpage>
        <pub-id pub-id-type="doi">10.1038/nrg3457</pub-id>
        <?supplied-pmid 23774735?>
        <pub-id pub-id-type="pmid">23774735</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Endelman</surname>
            <given-names>JB</given-names>
          </name>
        </person-group>
        <article-title>Ridge regression and other kernels for genomic selection with R package rrBLUP</article-title>
        <source>Plant Genome</source>
        <year>2011</year>
        <volume>4</volume>
        <issue>3</issue>
        <fpage>250</fpage>
        <lpage>255</lpage>
        <pub-id pub-id-type="doi">10.3835/plantgenome2011.08.0024</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <mixed-citation publication-type="other">R Core Team. R: A language and environment for statistical computing. <ext-link ext-link-type="uri" xlink:href="https://www.R-project.org">https://www.R-project.org</ext-link> (2018).</mixed-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Meuwissen</surname>
            <given-names>THE</given-names>
          </name>
          <name>
            <surname>Hayes</surname>
            <given-names>BJ</given-names>
          </name>
          <name>
            <surname>Goddard</surname>
            <given-names>ME</given-names>
          </name>
        </person-group>
        <article-title>Prediction of total genetic value using genome-wide dense marker maps</article-title>
        <source>Genetics</source>
        <year>2001</year>
        <volume>157</volume>
        <issue>4</issue>
        <fpage>1819</fpage>
        <lpage>1829</lpage>
        <?supplied-pmid 1461589?>
        <pub-id pub-id-type="pmid">11290733</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>McKinney</surname>
            <given-names>BA</given-names>
          </name>
          <name>
            <surname>Reif</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>Ritchie</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>Moore</surname>
            <given-names>JH</given-names>
          </name>
        </person-group>
        <article-title>Machine learning for detecting gene–gene interactions</article-title>
        <source>Appl. Bioinform.</source>
        <year>2006</year>
        <volume>5</volume>
        <issue>2</issue>
        <fpage>77</fpage>
        <lpage>88</lpage>
        <pub-id pub-id-type="doi">10.2165/00822942-200605020-00002</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <mixed-citation publication-type="other">Liaw, A. &amp; Wiener, M. Classification and regression by randomForest. <italic>R news</italic><bold>2</bold>(3), 18–22. <ext-link ext-link-type="uri" xlink:href="https://CRAN.R-project.org/doc/Rnews/Rnews_2002-3.pdf">https://CRAN.R-project.org/doc/Rnews/Rnews_2002-3.pdf</ext-link> (2002). Accessed 21 August 2020.</mixed-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <mixed-citation publication-type="other">Abadi, M. <italic>et al.</italic> Tensorflow: Large-scale machine learning on heterogeneous distributed systems. Preprint at <ext-link ext-link-type="uri" xlink:href="https://arxiv.org/abs/1603.04467">https://arxiv.org/abs/1603.04467</ext-link> (2016). Accesed 5 September 2020.</mixed-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <mixed-citation publication-type="other">Chollet, F. Keras: Deep Learning for humans. <ext-link ext-link-type="uri" xlink:href="https://github.com/fchollet/keras">https://github.com/fchollet/keras</ext-link> (2015). Accessed 5 September 2020.</mixed-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ma</surname>
            <given-names>W</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A deep convolutional neural network approach for predicting phenotypes from genotypes</article-title>
        <source>Planta</source>
        <year>2018</year>
        <volume>248</volume>
        <issue>5</issue>
        <fpage>1307</fpage>
        <lpage>1318</lpage>
        <pub-id pub-id-type="doi">10.1007/s00425-018-2976-9</pub-id>
        <?supplied-pmid 30101399?>
        <pub-id pub-id-type="pmid">30101399</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <mixed-citation publication-type="other">Kingma, D. P. &amp; Ba, J. Adam: A method for stochastic optimization. Preprint at <ext-link ext-link-type="uri" xlink:href="https://arxiv.org/abs/1412.6980">https://arxiv.org/abs/1412.6980</ext-link> (2014).</mixed-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhao</surname>
            <given-names>K</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Genome-wide association mapping reveals a rich genetic architecture of complex traits in <italic>Oryza sativa</italic></article-title>
        <source>Nat. Commun.</source>
        <year>2011</year>
        <volume>2</volume>
        <issue>1</issue>
        <fpage>467</fpage>
        <pub-id pub-id-type="doi">10.1038/ncomms1467</pub-id>
        <?supplied-pmid 21915109?>
        <pub-id pub-id-type="pmid">21915109</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jeong</surname>
            <given-names>S-C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Genetic diversity patterns and domestication origin of soybean</article-title>
        <source>Theor. Appl. Genet.</source>
        <year>2018</year>
        <volume>132</volume>
        <issue>4</issue>
        <fpage>1179</fpage>
        <lpage>1193</lpage>
        <pub-id pub-id-type="doi">10.1007/s00122-018-3271-7</pub-id>
        <?supplied-pmid 30588539?>
        <pub-id pub-id-type="pmid">30588539</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jeong</surname>
            <given-names>N</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Korean soybean core collection: Genotypic and phenotypic diversity population structure and genome-wide association study</article-title>
        <source>PLoS ONE</source>
        <year>2019</year>
        <volume>14</volume>
        <issue>10</issue>
        <fpage>e0224074</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0224074</pub-id>
        <?supplied-pmid 31639154?>
        <pub-id pub-id-type="pmid">31639154</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Browning</surname>
            <given-names>BL</given-names>
          </name>
          <name>
            <surname>Zhou</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Browning</surname>
            <given-names>SR</given-names>
          </name>
        </person-group>
        <article-title>A one-penny imputed genome from next-generation reference panels</article-title>
        <source>Am. J. Hum. Genet.</source>
        <year>2018</year>
        <volume>103</volume>
        <issue>3</issue>
        <fpage>338</fpage>
        <lpage>348</lpage>
        <pub-id pub-id-type="doi">10.1016/j.ajhg.2018.07.015</pub-id>
        <?supplied-pmid 30100085?>
        <pub-id pub-id-type="pmid">30100085</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <mixed-citation publication-type="other">Wang, J. &amp; Zhang, Z. GAPIT version 3: An interactive analytical tool for genomic association and prediction. Preprint at <ext-link ext-link-type="uri" xlink:href="https://github.com/jiabowang/GAPIT3">https://github.com/jiabowang/GAPIT3</ext-link> (2018). Accessed 11 July 2020.</mixed-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yin</surname>
            <given-names>L</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>KAML: Improving genomic prediction accuracy of complex traits using machine learning determined parameters</article-title>
        <source>Genome Biol.</source>
        <year>2020</year>
        <volume>21</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>22</lpage>
        <pub-id pub-id-type="doi">10.1186/s13059-020-02052-w</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Moser</surname>
            <given-names>G</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Simultaneous discovery, estimation and prediction analysis of complex traits using a Bayesian mixture model</article-title>
        <source>PLoS Genet.</source>
        <year>2015</year>
        <volume>11</volume>
        <issue>4</issue>
        <fpage>e1004969</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pgen.1004969</pub-id>
        <?supplied-pmid 25849665?>
        <pub-id pub-id-type="pmid">25849665</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lloyd-Jones</surname>
            <given-names>LR</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Improved polygenic prediction by Bayesian multiple regression on summary statistics</article-title>
        <source>Nat. Commun.</source>
        <year>2019</year>
        <volume>10</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>11</lpage>
        <pub-id pub-id-type="doi">10.1038/s41467-019-12653-0</pub-id>
        <pub-id pub-id-type="pmid">30602773</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <mixed-citation publication-type="other">Ghojogh, B. &amp; Crowley, M. The theory behind overfitting, cross validation, regularization, bagging, and boosting: tutorial. Preprint at <ext-link ext-link-type="uri" xlink:href="https://arxiv.org/abs/1905.12787">https://arxiv.org/abs/1905.12787</ext-link> (2019). Accessed 11 July 2020.</mixed-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Azodi</surname>
            <given-names>CB</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Benchmarking parametric and machine learning models for genomic prediction of complex traits</article-title>
        <source>G3 (Bethesda)</source>
        <year>2019</year>
        <volume>9</volume>
        <issue>11</issue>
        <fpage>3691</fpage>
        <lpage>3702</lpage>
        <pub-id pub-id-type="doi">10.1534/g3.119.400498</pub-id>
        <pub-id pub-id-type="pmid">31533955</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mouresan</surname>
            <given-names>EF</given-names>
          </name>
          <name>
            <surname>Selle</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Rönnegård</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>Genomic prediction including SNP-specific variance predictors</article-title>
        <source>G3 (Bethesda)</source>
        <year>2019</year>
        <volume>9</volume>
        <issue>10</issue>
        <fpage>3333</fpage>
        <lpage>3343</lpage>
        <pub-id pub-id-type="doi">10.1534/g3.119.400381</pub-id>
        <pub-id pub-id-type="pmid">31467030</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Waldmann</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Genome-wide prediction using Bayesian additive regression trees</article-title>
        <source>Genet. Sel. Evol.</source>
        <year>2016</year>
        <volume>48</volume>
        <issue>1</issue>
        <fpage>42</fpage>
        <pub-id pub-id-type="doi">10.1186/s12711-016-0219-8</pub-id>
        <?supplied-pmid 27286957?>
        <pub-id pub-id-type="pmid">27286957</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
