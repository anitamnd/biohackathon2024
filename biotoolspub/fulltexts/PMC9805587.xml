<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">9805587</article-id>
    <article-id pub-id-type="pmid">36413069</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btac749</article-id>
    <article-id pub-id-type="publisher-id">btac749</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Note</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Structural Bioinformatics</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>AlphaPulldown—a python package for protein–protein interaction screens using AlphaFold-Multimer</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Yu</surname>
          <given-names>Dingquan</given-names>
        </name>
        <aff><institution>European Molecular Biology Laboratory Hamburg</institution>, Hamburg 22607, <country country="DE">Germany</country></aff>
        <aff><institution>Centre for Structural Systems Biology (CSSB)</institution>, Hamburg 22607, <country country="DE">Germany</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Chojnowski</surname>
          <given-names>Grzegorz</given-names>
        </name>
        <aff><institution>European Molecular Biology Laboratory Hamburg</institution>, Hamburg 22607, <country country="DE">Germany</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-2986-936X</contrib-id>
        <name>
          <surname>Rosenthal</surname>
          <given-names>Maria</given-names>
        </name>
        <aff><institution>Bernhard Nocht Institute for Tropical Medicine</institution>, Hamburg 20359, <country country="DE">Germany</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-3641-0322</contrib-id>
        <name>
          <surname>Kosinski</surname>
          <given-names>Jan</given-names>
        </name>
        <aff><institution>European Molecular Biology Laboratory Hamburg</institution>, Hamburg 22607, <country country="DE">Germany</country></aff>
        <aff><institution>Centre for Structural Systems Biology (CSSB)</institution>, Hamburg 22607, <country country="DE">Germany</country></aff>
        <aff><institution>Structural and Computational Biology Unit, European Molecular Biology Laboratory</institution>, Heidelberg 69117, <country country="DE">Germany</country></aff>
        <xref rid="btac749-cor1" ref-type="corresp"/>
        <!--jan.kosinski@embl.de-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Cowen</surname>
          <given-names>Lenore</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btac749-cor1">To whom correspondence should be addressed. Email: <email>jan.kosinski@embl.de</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>1</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2022-11-22">
      <day>22</day>
      <month>11</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>22</day>
      <month>11</month>
      <year>2022</year>
    </pub-date>
    <volume>39</volume>
    <issue>1</issue>
    <elocation-id>btac749</elocation-id>
    <history>
      <date date-type="received">
        <day>05</day>
        <month>8</month>
        <year>2022</year>
      </date>
      <date date-type="rev-recd">
        <day>13</day>
        <month>10</month>
        <year>2022</year>
      </date>
      <date date-type="editorial-decision">
        <day>12</day>
        <month>11</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>21</day>
        <month>11</month>
        <year>2022</year>
      </date>
      <date date-type="corrected-typeset">
        <day>30</day>
        <month>11</month>
        <year>2022</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2022. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2022</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btac749.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Summary</title>
        <p>The artificial intelligence-based structure prediction program AlphaFold-Multimer enabled structural modelling of protein complexes with unprecedented accuracy. Increasingly, AlphaFold-Multimer is also used to discover new protein–protein interactions (PPIs). Here, we present AlphaPulldown, a Python package that streamlines PPI screens and high-throughput modelling of higher-order oligomers using AlphaFold-Multimer. It provides a convenient command-line interface, a variety of confidence scores and a graphical analysis tool.</p>
      </sec>
      <sec id="s2">
        <title>Availability and implementation</title>
        <p><italic toggle="yes">AlphaPulldown</italic> is freely available at <ext-link xlink:href="https://www.embl-hamburg.de/AlphaPulldown" ext-link-type="uri">https://www.embl-hamburg.de/AlphaPulldown</ext-link>.</p>
      </sec>
      <sec id="s4">
        <title>Supplementary information</title>
        <p><xref rid="sup1" ref-type="supplementary-material">Supplementary note</xref> is available at <italic toggle="yes">Bioinformatics</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>German Research Foundation</institution>
            <institution-id institution-id-type="DOI">10.13039/501100001659</institution-id>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>DFG</institution>
            <institution-id institution-id-type="DOI">10.13039/100004807</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>KO 5979/2-1</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="3"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>AlphaFold2 (<xref rid="btac749-B5" ref-type="bibr">Jumper <italic toggle="yes">et al.</italic>, 2021</xref>) and AlphaFold-Multimer (<xref rid="btac749-B3" ref-type="bibr">Evans <italic toggle="yes">et al.</italic>, 2022</xref>) have enabled structural modelling of monomeric proteins and protein complexes with accuracy comparable to experimental structures. Various modifications of AlphaFold2 have been developed to facilitate specific applications, such as ColabFold (<xref rid="btac749-B7" ref-type="bibr">Mirdita <italic toggle="yes">et al.</italic>, 2022</xref>), which accelerates the program and exposes useful parameters. AlphaFold-Multimer can also be applied to screen large datasets of proteins for new protein–protein interactions (PPIs) (<xref rid="btac749-B1" ref-type="bibr">Bryant <italic toggle="yes">et al.</italic>, 2022a</xref>; <xref rid="btac749-B4" ref-type="bibr">Humphreys <italic toggle="yes">et al.</italic>, 2021</xref>) and to model combinations of proteins and their fragments when modelling complexes (<xref rid="btac749-B8" ref-type="bibr">Mosalaganti <italic toggle="yes">et al.</italic>, 2022</xref>). To streamline such applications, we developed AlphaPulldown (<xref rid="btac749-F1" ref-type="fig">Fig. 1</xref>), a Python package that (i) provides a convenient command-line interface to run four typical scenarios in PPI screens and modelling of large complexes, (ii) reduces the computing time by separating CPU- and GPU-based calculations, (iii) allows selecting protein regions for modelling while retaining the original residue indexes and (iv) provides a unique analysis pipeline that assesses the predicted interfaces with multiple scores and generates a Jupyter notebook for interactive analysis.</p>
    <fig position="float" id="btac749-F1">
      <label>Fig. 1.</label>
      <caption>
        <p>The workflow of AlphaPulldown. The first stage of AlphaPulldown runs on CPUs and is handled by the create_individual_features.py script, which takes protein sequences as input, generates MSAs, and finds structural templates for each protein. MSAs and structural features are stored in Python ‘pickle’ files. The next stage takes these ‘pickle’ files as input and predicts protein complex structures on GPUs. The user can choose from the following modes: (1) pulldown, (2) homo-oligomer, (3) custom and (4) all versus all. Once all predictions are finished, AlphaPulldown generates a Jupyter notebook that provides a graphical summary and uses an analysis pipeline built in a Singularity image, alpha-analysis.sif, to produce a table with various model quality scores and interface properties</p>
      </caption>
      <graphic xlink:href="btac749f1" position="float"/>
    </fig>
  </sec>
  <sec>
    <title>2 Software description</title>
    <sec>
      <title>2.1 Separation of stages</title>
      <p>The original AlphaFold pipeline is composed of two main stages. The first uses CPUs to calculate multiple sequence alignments (MSAs) and to search for templates from PDB as input features for the second stage, which performs the actual structure prediction using GPUs. To speed up the pipeline, similar to other packages, AlphaPulldown separates these two stages, enabling the calculation of features for many sequences in parallel using multiple CPUs and prediction of structures using GPU.</p>
    </sec>
    <sec>
      <title>2.2 Calculation of features</title>
      <p>At this stage, AlphaPulldown searches each protein sequence against sequence databases to pre-calculate MSA and identify template structures, using either the original AlphaFold pipeline or more computationally efficient MMSeqs2 (<xref rid="btac749-B9" ref-type="bibr">Steinegger and Söding, 2017</xref>) from ColabFold (<xref rid="btac749-B7" ref-type="bibr">Mirdita <italic toggle="yes">et al.</italic>, 2022</xref>). It will also create features informing sequence by-organism pairing, which in the original AlphaFold-Multimer is performed only at the prediction state. AlphaPulldown stores these features in Python pickle files that can be reused for multiple PPI predictions.</p>
    </sec>
    <sec>
      <title>2.3 Prediction modes</title>
      <p>Once MSAs and structural template features are calculated, the user can choose from the following four modes of the main prediction.</p>
      <sec>
        <title>2.3.1 Pull-down mode</title>
        <p>Inspired by pulldown assays, this mode takes one or more proteins as ‘baits’ and a list of other proteins as ‘candidates’. AlphaPulldown will automatically run AlphaFold-Multimer prediction between each bait and candidate. To demonstrate this mode, we show two examples. First, we screened for interactions of human eIF4G2 with proteins of the human translation pathway (<xref rid="sup1" ref-type="supplementary-material">Supplementary Note S1</xref>). The results confirmed a known interaction, revealed new interactions, and, based on the additional interface quality scores provided by AlphaPulldown, identified potential false positive and negative AlphaFold predictions (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref> and <xref rid="sup1" ref-type="supplementary-material">Fig. S1</xref>). Second, we modelled the interaction between the L and Z proteins of the Lassa virus, which could not be predicted using full-length sequences but only when screening Z against a series of fragments of L (<xref rid="sup1" ref-type="supplementary-material">Supplementary Note S2</xref>, <xref rid="sup1" ref-type="supplementary-material">Table S2</xref> and <xref rid="sup1" ref-type="supplementary-material">Fig. S2</xref>). This example shows that fragmenting large proteins may help AlphaFold find correct interaction interfaces. AlphaPulldown provides a convenient interface to specify any combination of residue ranges without needing to recalculate MSAs or template features. Moreover, AlphaPulldown keeps the residue numbering of original full-length sequences in the models.</p>
      </sec>
      <sec>
        <title>2.3.2 All-versus-all mode</title>
        <p>Based on a single list of proteins, AlphaPulldown will automatically generate all pairwise combinations and predict their structures. This mode can be useful to predict interaction networks and provide input for modelling large complexes with tools such as MoLPC (<xref rid="btac749-B2" ref-type="bibr">Bryant <italic toggle="yes">et al.</italic>, 2022b</xref>).</p>
      </sec>
      <sec>
        <title>2.3.3 Homo-oligomer mode</title>
        <p>This mode simplifies the process of modelling homo-oligomers and testing alternative homo-oligomeric states. The user only needs to provide an input file with desired oligomeric states, and AlphaPulldown will automatically run modelling for each state.</p>
      </sec>
      <sec>
        <title>2.3.4 Custom mode</title>
        <p>This mode allows the user to provide any combination of any number of proteins and their fragments as an input, not limited to pairwise predictions. This mode can be used, for example, to screen a pre-defined list of interactions from other sources such as crosslinking studies or model entire complexes. As mentioned above, even if fragments are used, the MSA and template features do not need to be recalculated and the resulting models keep the residue numbering of the full-length sequences.</p>
      </sec>
    </sec>
  </sec>
  <sec>
    <title>3 Additional features</title>
    <p>For all models with an inter-chain predicted alignment error below the user-defined cut-off, a Jupyter notebook will be generated to provide the user with a clear visual overview of these models as well as their ipTM and pLDDT scores (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S3</xref>). The analysis pipeline will also return a CSV table containing the ipTM and ipTM+pTM scores reported by AlphaFold, a pDockQ score for dimers (<xref rid="btac749-B1" ref-type="bibr">Bryant <italic toggle="yes">et al.</italic>, 2022a</xref>), mpDockQ score for multimers (<xref rid="btac749-B2" ref-type="bibr">Bryant <italic toggle="yes">et al.</italic>, 2022b</xref>), protein interface-score (PI-score) (<xref rid="btac749-B6" ref-type="bibr">Malhotra <italic toggle="yes">et al.</italic>, 2021</xref>), and physical and geometrical properties calculated by the PI-score pipeline, such as the interface surface area or the number of hydrogen bonds (<xref rid="sup1" ref-type="supplementary-material">Supplementary Tables S1 and S2</xref>).</p>
  </sec>
  <sec>
    <title>4 Conclusion</title>
    <p>AlphaPulldown streamlines AlphaFold-multimer for PPI screens and modelling of large complexes fragment-by-fragment in a manner similar to that we applied to the human nuclear pore complex (<xref rid="btac749-B8" ref-type="bibr">Mosalaganti <italic toggle="yes">et al.</italic>, 2022</xref>). It both facilitates the prediction process and provides a toolbox for a more thorough analysis of model confidence. We anticipate it will help the structural biology community unlock the full potential of artificial intelligence-based structure prediction. Possible directions for further development of AlphaPulldown may include support for modelling algorithms other than AlphaFold, acceleration of the modelling step and new PPI scoring functions.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btac749_Supplementary_Data</label>
      <media xlink:href="btac749_supplementary_data.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgements</title>
    <p>We thank Agnieszka Obarska-Kosinska for testing the software and useful suggestions.</p>
    <sec>
      <title>Funding</title>
      <p>This work was supported by the German Research Foundation (DFG) [KO 5979/2-1].</p>
      <p><italic toggle="yes">Conflict of Interest</italic>: none declared.</p>
    </sec>
  </ack>
  <sec sec-type="data-availability">
    <title>Data availability</title>
    <p>All the code and example data are available at <ext-link xlink:href="https://www.embl-hamburg.de/AlphaPulldown" ext-link-type="uri">https://www.embl-hamburg.de/AlphaPulldown</ext-link> and <ext-link xlink:href="https://github.com/KosinskiLab/AlphaPulldown" ext-link-type="uri">https://github.com/KosinskiLab/AlphaPulldown</ext-link>.</p>
  </sec>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btac749-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bryant</surname><given-names>P.</given-names></string-name></person-group><etal>et al</etal> (<year>2022a</year>) <article-title>Improved prediction of protein-protein interactions using AlphaFold2</article-title>. <source>Nat. Commun</source>., <volume>13</volume>, <fpage>13, 1</fpage>–<lpage>11</lpage>.<pub-id pub-id-type="pmid">35013168</pub-id></mixed-citation>
    </ref>
    <ref id="btac749-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bryant</surname><given-names>P.</given-names></string-name></person-group><etal>et al</etal> (<year>2022b</year>) <article-title>Predicting the structure of large protein complexes using AlphaFold and Monte Carlo tree search</article-title>. <source>Nat. Commun</source>., <volume>13</volume>, <fpage>6028</fpage>.<pub-id pub-id-type="pmid">36224222</pub-id></mixed-citation>
    </ref>
    <ref id="btac749-B3">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Evans</surname><given-names>R.</given-names></string-name></person-group><etal>et al</etal> (<year>2022</year>) Protein complex prediction with AlphaFold-Multimer. <ext-link xlink:href="https://github.com/deepmind/alphafold" ext-link-type="uri">https://github.com/deepmind/alphafold</ext-link>.</mixed-citation>
    </ref>
    <ref id="btac749-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Humphreys</surname><given-names>I.</given-names></string-name></person-group><etal>et al</etal> (<year>2021</year>) <article-title>Computed structures of core eukaryotic protein complexes</article-title>. <source>Science (1979)</source>, <volume>374</volume>. <ext-link xlink:href="https://www.science.org/doi/10.1126/science.abm9506" ext-link-type="uri">https://www.science.org/doi/10.1126/science.abm9506</ext-link>.</mixed-citation>
    </ref>
    <ref id="btac749-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Jumper</surname><given-names>J.</given-names></string-name></person-group><etal>et al</etal> (<year>2021</year>) <article-title>Highly accurate protein structure prediction with AlphaFold</article-title>. <source>Nature</source><volume>596</volume>, <fpage>583</fpage>–<lpage>589</lpage>.<pub-id pub-id-type="pmid">34265844</pub-id></mixed-citation>
    </ref>
    <ref id="btac749-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Malhotra</surname><given-names>S.</given-names></string-name></person-group><etal>et al</etal> (<year>2021</year>) <article-title>Assessment of protein–protein interfaces in cryo-EM derived assemblies</article-title>. <source>Nat. Commun</source>., <volume>12</volume>, <fpage>1</fpage>–<lpage>12</lpage>.<pub-id pub-id-type="pmid">33397941</pub-id></mixed-citation>
    </ref>
    <ref id="btac749-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mirdita</surname><given-names>M.</given-names></string-name></person-group><etal>et al</etal> (<year>2022</year>) <article-title>ColabFold: making protein folding accessible to all</article-title>. <source>Nat. Methods</source>, <volume>19</volume>, <fpage>679</fpage>–<lpage>682</lpage>.<pub-id pub-id-type="pmid">35637307</pub-id></mixed-citation>
    </ref>
    <ref id="btac749-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mosalaganti</surname><given-names>S.</given-names></string-name></person-group><etal>et al</etal> (<year>2022</year>) <article-title>AI-based structure prediction empowers integrative structural analysis of human nuclear pores</article-title>. <source>Science (1979)</source>, <volume>376</volume>. <ext-link xlink:href="https://www.science.org/doi/10.1126/science.abm4805" ext-link-type="uri">https://www.science.org/doi/10.1126/science.abm4805</ext-link>.</mixed-citation>
    </ref>
    <ref id="btac749-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Steinegger</surname><given-names>M.</given-names></string-name>, <string-name><surname>Söding</surname><given-names>J.</given-names></string-name></person-group> (<year>2017</year>) <article-title>MMseqs2 enables sensitive protein sequence searching for the analysis of massive data sets</article-title>. <source>Nat. Biotechnol</source>., <volume>35</volume>, <fpage>1026</fpage>–<lpage>1028</lpage>.<pub-id pub-id-type="pmid">29035372</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
