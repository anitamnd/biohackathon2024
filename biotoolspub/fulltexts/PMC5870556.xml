<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">5870556</article-id>
    <article-id pub-id-type="pmid">28505247</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btx315</article-id>
    <article-id pub-id-type="publisher-id">btx315</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Notes</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Genome Analysis</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Single-cell regulome data analysis by SCRAT</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Ji</surname>
          <given-names>Zhicheng</given-names>
        </name>
        <xref ref-type="author-notes" rid="btx315-FM1"/>
        <xref ref-type="aff" rid="btx315-aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Zhou</surname>
          <given-names>Weiqiang</given-names>
        </name>
        <xref ref-type="author-notes" rid="btx315-FM1"/>
        <xref ref-type="aff" rid="btx315-aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ji</surname>
          <given-names>Hongkai</given-names>
        </name>
        <xref ref-type="corresp" rid="btx315-cor1"/>
        <!--<email>hji@jhu.edu</email>-->
        <xref ref-type="aff" rid="btx315-aff1"/>
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Birol</surname>
          <given-names>Inanc</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <aff id="btx315-aff1">Department of Biostatistics, Johns Hopkins University Bloomberg School of Public Health, Baltimore, MD, USA</aff>
    <author-notes>
      <corresp id="btx315-cor1">To whom correspondence should be addressed. Email: <email>hji@jhu.edu</email></corresp>
      <fn id="btx315-FM1">
        <p>The authors wish it to be known that, in their opinion, the first two authors should be regarded as Joint First Authors.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>15</day>
      <month>9</month>
      <year>2017</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2017-05-12">
      <day>12</day>
      <month>5</month>
      <year>2017</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>12</day>
      <month>5</month>
      <year>2017</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. -->
    <volume>33</volume>
    <issue>18</issue>
    <fpage>2930</fpage>
    <lpage>2932</lpage>
    <history>
      <date date-type="received">
        <day>13</day>
        <month>12</month>
        <year>2016</year>
      </date>
      <date date-type="rev-recd">
        <day>28</day>
        <month>3</month>
        <year>2017</year>
      </date>
      <date date-type="accepted">
        <day>10</day>
        <month>5</month>
        <year>2017</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Â© The Author 2017. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2017</copyright-year>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/" license-type="cc-by">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits 
unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btx315.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="SA1">
        <title>Summary</title>
        <p>Emerging single-cell technologies (e.g. single-cell ATAC-seq, DNase-seq or ChIP-seq) have made it possible to assay regulome of individual cells. Single-cell regulome data are highly sparse and discrete. Analyzing such data is challenging. User-friendly software tools are still lacking. We present SCRAT, a Single-Cell Regulome Analysis Toolbox with a graphical user interface, for studying cell heterogeneity using single-cell regulome data. SCRAT can be used to conveniently summarize regulatory activities according to different features (e.g. gene sets, transcription factor binding motif sites, etc.). Using these features, users can identify cell subpopulations in a heterogeneous biological sample, infer cell identities of each subpopulation, and discover distinguishing features such as gene sets and transcription factors that show different activities among subpopulations.</p>
      </sec>
      <sec id="SA2">
        <title>Availability and implementation</title>
        <p>SCRAT is freely available at <ext-link ext-link-type="uri" xlink:href="https://zhiji.shinyapps.io/scrat">https://zhiji.shinyapps.io/scrat</ext-link> as an online web service and at <ext-link ext-link-type="uri" xlink:href="https://github.com/zji90/SCRAT">https://github.com/zji90/SCRAT</ext-link> as an R package.</p>
      </sec>
      <sec id="SA3">
        <title>Supplementary information</title>
        <p><xref ref-type="supplementary-material" rid="sup6">Supplementary data</xref> are available at <italic>Bioinformatics</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">National Institutes of Health</named-content>
          <named-content content-type="funder-identifier">10.13039/100000002</named-content>
        </funding-source>
        <award-id>R01HG006841</award-id>
        <award-id>R01HG006282</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="3"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Single-cell regulome (scRegulome) mapping technologies such as single-cell sequencing assay of transposase-accessible chromatin (scATAC-seq) (<xref rid="btx315-B2" ref-type="bibr">Buenrostro <italic>et al.</italic>, 2015</xref>; <xref rid="btx315-B4" ref-type="bibr">Cusanovich <italic>et al.</italic>, 2015</xref>), single-cell chromatin immunoprecipitation followed by sequencing (scChIP-seq) (<xref rid="btx315-B9" ref-type="bibr">Rotem <italic>et al.</italic>, 2015</xref>) and single-cell DNase I hypersensitive site sequencing (scDNase-seq) (<xref rid="btx315-B6" ref-type="bibr">Jin <italic>et al.</italic>, 2015</xref>) have been emerging as a powerful new approach to studying gene regulation. Unlike the conventional ChIP-seq (<xref rid="btx315-B7" ref-type="bibr">Johnson <italic>et al.</italic>, 2007</xref>), DNase-seq (<xref rid="btx315-B3" ref-type="bibr">Crawford <italic>et al.</italic>, 2006</xref>) and ATAC-seq (<xref rid="btx315-B1" ref-type="bibr">Buenrostro <italic>et al.</italic>, 2013</xref>) technologies which measure average behavior of a cell population, single-cell technologies can measure regulatory element activities within each individual cell, thereby allowing one to examine the heterogeneity of a cell population. This is important for studying molecular mechanisms of tumors, immune responses, stem cell differentiation, and many other biological systems.</p>
    <p>Typically, a scRegulome dataset contains cells sampled from a heterogeneous cell population. Two common data analysis problems are to identify subpopulations of cells and distinguishing features that show differential regulatory signals among different subpopulations. Currently, easy-to-use software tools for these tasks are still lacking. Unlike data from the traditional bulk technologies which are relatively continuous, scRegulome data are highly sparse and discrete. For instance, chromatin accessibility measured by scATAC-seq is nearly a binary signal at each genomic locus (<xref ref-type="fig" rid="btx315-F1">Fig. 1a</xref>, <xref ref-type="supplementary-material" rid="sup6">Supplementary Fig. S1</xref>). Using these highly sparse and discrete data to discriminate signal from noise at each individual genomic locus is extremely difficult. For this reason, conventional tools developed for analyzing bulk data are not suitable for single-cell data. Aggregating signals across multiple genomic loci with shared biological functions can mitigate sparsity and discreteness and has been shown to be a useful way to analyze scRegulome data (<xref rid="btx315-B2" ref-type="bibr">Buenrostro <italic>et al.</italic>, 2015</xref>; <xref rid="btx315-B4" ref-type="bibr">Cusanovich <italic>et al.</italic>, 2015</xref>; <xref rid="btx315-B9" ref-type="bibr">Rotem <italic>et al.</italic>, 2015</xref>) (<xref ref-type="supplementary-material" rid="sup6">Supplementary Material</xref> and <xref ref-type="supplementary-material" rid="sup6">Supplementary Fig. S2</xref>). However, systematically aggregating signals according to different genomic features (e.g. transcription factor binding motifs, gene sets) and using the aggregated signals to analyze sample heterogeneity is a non-trivial task for many investigators due to lack of software support, as demonstrated in <xref ref-type="supplementary-material" rid="sup1">Supplementary Tables S1</xref> and <xref ref-type="supplementary-material" rid="sup2">S2</xref>. Here, we present SCRAT, a toolbox with a graphical user interface (GUI) for analyzing cell heterogeneity in single-cell regulome (i.e. scATAC-seq, scDNase-seq and scChIP-seq) data. It can be used to summarize data from each cell according to different genomic features, identify cell subpopulations based on these features, infer identities of cells in each subpopulation, and discover features that show differential regulatory signals among subpopulations (<xref ref-type="fig" rid="btx315-F1">Fig. 1</xref>).
</p>
    <fig id="btx315-F1" orientation="portrait" position="float">
      <label>Fig. 1</label>
      <caption>
        <p>SCRAT analysis pipeline. (<bold>a</bold>) Single-cell regulome data is very sparse. (<bold>b</bold>) Analyzing scATAC-seq data using conventional bulk peak calling followed by clustering cells based on peak-level signals failed to separate two different cell types (i.e. GM12878 and HEK293T). (<bold>c</bold>) SCRAT first aggregates the input data into features according to empirical knowledge learned from public databases. (<bold>d</bold>) It then dissects cell heterogeneity by clustering cells using the aggregated features. For the same data in (b), SCRAT successfully separated GM12878 and HEK293T cells into two groups. Green dots are a few reference bulk DNase-seq samples from a precompiled database to help infer identities of cell subpopulations. (<bold>e</bold>) SCRAT can also evaluate the similarity between each cell and existing cell types in the precompiled database. (<bold>f</bold>) Finally, SCRAT identifies differential features between subpopulations of cells</p>
      </caption>
      <graphic xlink:href="btx315f1"/>
    </fig>
  </sec>
  <sec>
    <title>2 SCRAT functions and examples</title>
    <p>The main functions of SCRAT are summarized below.</p>
    <sec>
      <title>2.1 Data pre-processing</title>
      <p>SCRAT takes aligned sequence reads (i.e. bam files) as input. Users have options to exclude artifact signals from the ENCODE blacklist regions (<xref rid="btx315-B5" ref-type="bibr">ENCODE Project Consortium, 2012</xref>) and filter out cells with low total read count.</p>
    </sec>
    <sec>
      <title>2.2 Feature summarization</title>
      <p>Next, users can aggregate reads from each cell according to different features, such as across all motif sites of each transcription factor binding motif (<italic>Motif</italic>), across co-regulated DNase I hypersensitive sites (DHSs) defined by ENCODE DNase-seq data (<italic>ENCODE Cluster</italic>), within a region of interest of each gene (<italic>Gene</italic>), and across all genes of each gene set in the MSigDB (<xref rid="btx315-B8" ref-type="bibr">Liberzon <italic>et al.</italic>, 2011</xref>) database (<italic>Gene Set</italic>). Here, motifs, DHS clusters, genes, and gene sets are called âfeaturesâ (<xref ref-type="fig" rid="btx315-F1">Fig. 1c</xref>). For human and mouse genomes, these features are pre-defined and stored in SCRAT. Users can also define their own features for aggregation by uploading one or more lists of genomic regions in BED file format (<italic>Custom Feature</italic>). After aggregation, the signals for each feature are normalized to adjust for library size.</p>
    </sec>
    <sec>
      <title>2.3 Cell heterogeneity analysis</title>
      <p>SCRAT uses the aggregated signals to cluster cells into subpopulations (<xref ref-type="fig" rid="btx315-F1">Fig. 1d</xref>). Multiple clustering methods are provided. Clustering can be based on one or multiple sets of features chosen by users. The cluster number may be determined automatically. One can use the original features or the transformed features after dimension reduction. Multiple dimension reduction methods are provided.</p>
    </sec>
    <sec>
      <title>2.4 Inferring cell identity</title>
      <p>Users can compare each cellâs regulome to a pre-compiled regulome database consisting of ENCODE DNase-seq profiles from a wide variety of cell types to infer the likely cell type of each cell. The similarity between each single cell and existing cell types in the database based on the aggregated signals can be visualized using a heatmap (<xref ref-type="fig" rid="btx315-F1">Fig. 1e</xref>). Users can also select existing cell types in the database and project them to the principal component space of single cells to help illuminate the nature of the heterogeneity (<xref ref-type="fig" rid="btx315-F1">Fig. 1d</xref>, green dots).</p>
    </sec>
    <sec>
      <title>2.5 Differential feature analysis</title>
      <p>Given cell subpopulations, users can identify features that are differential among subpopulations (i.e. heterogeneity-driving features). One can choose to run parametric (<italic>t</italic>-, ANOVA <italic>F</italic>-) or non-parametric (Wilcoxon rank-sum, Kruskal-Wallis or permutation) test on each feature to evaluate whether its aggregated signals are differential among the user-selected subpopulations. Differential features which pass certain false discovery rate cutoff will be reported (<xref ref-type="fig" rid="btx315-F1">Fig. 1f</xref>).</p>
    </sec>
    <sec>
      <title>2.6 GUI</title>
      <p>SCRAT has a GUI which makes the analysis user-friendly.</p>
      <p>Details of these functions are provided in <xref ref-type="supplementary-material" rid="sup6">Supplementary Material</xref>. <xref ref-type="supplementary-material" rid="sup1">Supplementary Table S1</xref> compares SCRAT with existing popular tools for regulome or differential feature analyses. To demonstrate SCRAT, we analyzed a scATAC-seq dataset consisting of GM12878 and HEK293T cells (<xref ref-type="supplementary-material" rid="sup6">Supplementary Material</xref>). Conventional bulk peak calling followed by clustering cells using peak-level signals failed to separate the two cell types (<xref ref-type="fig" rid="btx315-F1">Fig. 1b</xref>). In contrast, SCRAT successfully identified the two cell subpopulations (<xref ref-type="fig" rid="btx315-F1">Fig. 1d</xref>) and differential features that matched the cell identities (<xref ref-type="supplementary-material" rid="sup6">Supplementary Figs. S3âS11</xref>; <xref ref-type="supplementary-material" rid="sup3">Supplementary Table S3</xref>). We also applied SCRAT to scATAC-seq data from human and mouse embryonic stem cells (ESC) and found that a consistent feature driving cell heterogeneity in these ESCs was cell cycle genes (<xref ref-type="supplementary-material" rid="sup6">Supplementary Figs. S12 and S13</xref>, <xref ref-type="supplementary-material" rid="sup4">Supplementary Tables S4</xref> and <xref ref-type="supplementary-material" rid="sup5">S5</xref>).</p>
      <p>In summary, SCRAT provides a set of easy-to-use tools for cell heterogeneity analysis, and it addresses the pressing needs for software support for analyzing scRegulome data.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="sup1">
      <label>Supplementary Table 1</label>
      <media xlink:href="btx315_supplementary_table_1.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="sup2">
      <label>Supplementary Table 2</label>
      <media xlink:href="btx315_supplementary_table_2.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="sup3">
      <label>Supplementary Table 3</label>
      <media xlink:href="btx315_supplementary_table_3.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="sup4">
      <label>Supplementary Table 4</label>
      <media xlink:href="btx315_supplementary_table_4.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="sup5">
      <label>Supplementary Table 5</label>
      <media xlink:href="btx315_supplementary_table_5.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="sup6">
      <label>Supplementary Data</label>
      <media xlink:href="btx315_supplementary_material_r1.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <sec>
    <title>Funding</title>
    <p>This work was supported by the National Institutes of Health [Grant No. R01HG006841, R01HG006282].</p>
    <p><italic>Conflict of Interest</italic>: none declared.</p>
  </sec>
  <ref-list>
    <title>References</title>
    <ref id="btx315-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Buenrostro</surname><given-names>J.D.</given-names></name></person-group><etal>et al</etal> (<year>2013</year>) 
<article-title>Transposition of native chromatin for fast and sensitive epigenomic profiling of open chromatin, DNA-binding proteins and nucleosome position</article-title>. <source>Nat. Methods</source>, <volume>10</volume>, <fpage>1213</fpage>â<lpage>1218</lpage>.<pub-id pub-id-type="pmid">24097267</pub-id></mixed-citation>
    </ref>
    <ref id="btx315-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Buenrostro</surname><given-names>J.D.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>Single-cell chromatin accessibility reveals principles of regulatory variation</article-title>. <source>Nature</source>, <volume>523</volume>, <fpage>486</fpage>â<lpage>490</lpage>.<pub-id pub-id-type="pmid">26083756</pub-id></mixed-citation>
    </ref>
    <ref id="btx315-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Crawford</surname><given-names>G.E.</given-names></name></person-group><etal>et al</etal> (<year>2006</year>) 
<article-title>Genome-wide mapping of DNase hypersensitive sites using massively parallel signature sequencing (MPSS)</article-title>. <source>Genome Res</source>., <volume>16</volume>, <fpage>123</fpage>â<lpage>131</lpage>.<pub-id pub-id-type="pmid">16344561</pub-id></mixed-citation>
    </ref>
    <ref id="btx315-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Cusanovich</surname><given-names>D.A.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>Multiplex single-cell profiling of chromatin accessibility by combinatorial cellular indexing</article-title>. <source>Science</source>, <volume>348</volume>, <fpage>910</fpage>â<lpage>914</lpage>.<pub-id pub-id-type="pmid">25953818</pub-id></mixed-citation>
    </ref>
    <ref id="btx315-B5">
      <mixed-citation publication-type="journal"><collab>ENCODE Project Consortium</collab>. (<year>2012</year>) 
<article-title>An integrated encyclopedia of DNA elements in the human genome</article-title>. <source>Nature</source>, <volume>489</volume>, <fpage>57</fpage>â<lpage>74</lpage>.<pub-id pub-id-type="pmid">22955616</pub-id></mixed-citation>
    </ref>
    <ref id="btx315-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Jin</surname><given-names>W.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>Genome-wide detection of DNase I hypersensitive sites in single cells and FFPE tissue samples</article-title>. <source>Nature</source>, <volume>528</volume>, <fpage>142</fpage>â<lpage>146</lpage>.<pub-id pub-id-type="pmid">26605532</pub-id></mixed-citation>
    </ref>
    <ref id="btx315-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Johnson</surname><given-names>D.S.</given-names></name></person-group><etal>et al</etal> (<year>2007</year>) 
<article-title>Genome-wide mapping of in vivo protein-DNA interactions</article-title>. <source>Science</source>, <volume>316</volume>, <fpage>1497</fpage>â<lpage>1502</lpage>.<pub-id pub-id-type="pmid">17540862</pub-id></mixed-citation>
    </ref>
    <ref id="btx315-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Liberzon</surname><given-names>A.</given-names></name></person-group><etal>et al</etal> (<year>2011</year>) 
<article-title>Molecular signatures database (MSigDB) 3.0</article-title>. <source>Bioinformatics</source>, <volume>27</volume>, <fpage>1739</fpage>â<lpage>1740</lpage>.<pub-id pub-id-type="pmid">21546393</pub-id></mixed-citation>
    </ref>
    <ref id="btx315-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Rotem</surname><given-names>A.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>Single-cell ChIP-seq reveals cell subpopulations defined by chromatin state</article-title>. <source>Nat. Biotechnol</source>., <volume>33</volume>, <fpage>1165</fpage>â<lpage>1172</lpage>.<pub-id pub-id-type="pmid">26458175</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
