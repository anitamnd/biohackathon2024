<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">4548304</article-id>
    <article-id pub-id-type="pmid">26303676</article-id>
    <article-id pub-id-type="publisher-id">702</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-015-0702-1</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>OD-seq: outlier detection in multiple sequence alignments</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Jehl</surname>
          <given-names>Peter</given-names>
        </name>
        <address>
          <email>peter.jehl@ucdconnect.ie</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Sievers</surname>
          <given-names>Fabian</given-names>
        </name>
        <address>
          <email>fabian.sievers@ucd.ie</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Higgins</surname>
          <given-names>Desmond G.</given-names>
        </name>
        <address>
          <email>des.higgins@ucd.ie</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <aff id="Aff1"><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 0768 2743</institution-id><institution-id institution-id-type="GRID">grid.7886.1</institution-id><institution>UCD Conway Institute of Biomolecular and Biomedical Sciences, </institution><institution>University College Dublin, </institution></institution-wrap>Dublin, 4 Ireland </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>25</day>
      <month>8</month>
      <year>2015</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2015</year>
    </pub-date>
    <volume>16</volume>
    <elocation-id>269</elocation-id>
    <history>
      <date date-type="received">
        <day>15</day>
        <month>5</month>
        <year>2015</year>
      </date>
      <date date-type="accepted">
        <day>13</day>
        <month>8</month>
        <year>2015</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© Jehl et al. 2015</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold> This article is distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0">http://creativecommons.org/licenses/by/4.0</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p>Multiple sequence alignments (MSA) are widely used in sequence analysis for a variety of tasks. Outlier sequences can make downstream analyses unreliable or make the alignments less accurate while they are being constructed. This paper describes a simple method for automatically detecting outliers and accompanying software called OD-seq. It is based on finding sequences whose average distance to the rest of the sequences in a dataset, is anomalous.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p>The software can take a MSA, distance matrix or set of unaligned sequences as input. Outlier sequences are found by examining the average distance of each sequence to the rest. Anomalous average distances are then found using the interquartile range of the distribution of average distances or by bootstrapping them. The complexity of any analysis of a distance matrix is normally at least <italic>O</italic>(<italic>N</italic>
<sup>2</sup>) for <italic>N</italic> sequences. This is prohibitive for large <italic>N</italic> but is reduced here by using the mBed algorithm from Clustal Omega. This reduces the complexity to <italic>O</italic>(<italic>N</italic> log(<italic>N</italic>)) which makes even very large alignments easy to analyse on a single core. We tested the ability of OD-seq to detect outliers using artificial test cases of sequences from Pfam families, seeded with sequences from other Pfam families. Using a MSA as input, OD-seq is able to detect outliers with very high sensitivity and specificity.</p>
      </sec>
      <sec>
        <title>Conclusion</title>
        <p>OD-seq is a practical and simple method to detect outliers in MSAs. It can also detect outliers in sets of unaligned sequences, but with reduced accuracy. For medium sized alignments, of a few thousand sequences, it can detect outliers in a few seconds. Software available as <ext-link ext-link-type="uri" xlink:href="http://www.bioinf.ucd.ie/download/od-seq.tar.gz">http://www.bioinf.ucd.ie/download/od-seq.tar.gz</ext-link>.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Outlier</kwd>
      <kwd>Multiple sequence alignment</kwd>
    </kwd-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2015</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p>Multiple sequence alignments are essential for many sequence analysis tasks [<xref ref-type="bibr" rid="CR1">1</xref>–<xref ref-type="bibr" rid="CR4">4</xref>]. They are widely used for phylogenetic analysis, discovery of conserved regions, protein function studies and structure prediction. One problem that can arise in these analyses is the presence of outlier sequences. Outliers can disrupt an alignment at the construction stage and lead to highly sub-optimal alignments with a knock-on effect on downstream analyses. With small datasets, these can often be seen in the final alignment, if a viewer such as Jalview [<xref ref-type="bibr" rid="CR5">5</xref>] is used. With very large alignments of say 10 s of thousands of sequences, it can be hard to view the complete alignment and it can be difficult to see outliers.</p>
    <p>Outliers can come from a variety of sources. The simplest example is a sequence that is not homologous with the rest of the dataset and which has been included by accident. These are the easiest to detect as they will not have any of the conserved regions which the rest of the sequences might share. The pattern of gaps and conserved blocks will be completely different between the outlier and the rest. A second source of outliers will be sequences which have been partly mistranslated due to a sequencing error or incorrect automated translation from a genome sequence. These will have some conserved blocks followed by sections that are non-homologous with the rest. The longer the mistranslated region, the easier it will be to detect but very short outlier sections may be hard to find. The third kind of outlier will be where a sequence is homologous to the rest but where the similarity is extremely low and it is very hard to align. This case is a matter of choice and of degree. Some data sets need to include all possible homologues, for completeness. Others need to restrict dataset membership to sequences which are alignable over their full length. This case is different to the first two because very distant sequences may be hard to distinguish from real outliers which are simply not homologous.</p>
    <p>Outlier detection is a well studied field in computer science and has been applied to many different fields such as credit card, insurance and tax fraud detection, intrusion detection for cyber security, fault detection in safety critical systems, military surveillance for enemy activities and many other areas [<xref ref-type="bibr" rid="CR6">6</xref>]. Previous attempts at detecting sequence outliers have mainly concentrated on finding sections of sequence or alignment which are highly divergent. In Clustal X [<xref ref-type="bibr" rid="CR7">7</xref>] there are menu items to activate a variety of outlier detection schemes which are based on detecting runs of amino acids with suspiciously low similarity scores to the rest. These can then be highlighted in various ways for visual detection. The GBLOCKS package [<xref ref-type="bibr" rid="CR8">8</xref>] finds sections of alignment that are rich in gaps and which have low overall conservation. These blocks can be automatically removed for automated creation of phylogenies in pipelines. Penn et al. [<xref ref-type="bibr" rid="CR9">9</xref>] used robustness to guide tree changes as a measure of alignment confidence. The DivA package [<xref ref-type="bibr" rid="CR10">10</xref>] uses training sets seeded with manually inserted problem segments to recognise outlier positions or segments.</p>
    <p>In this paper, we introduce the OD-Seq package which attempts to identify outlier sequences in a multiple alignment. It uses a simple gap based metric which counts the number of positions between two aligned sequences which have a gap in one and not the other. These distances are used to make a distance matrix which is then analysed to find sequences with unusually high average distances from the rest of the sequences. We can also use OD-Seq to find outliers in sets of unaligned sequences using pairwise BLAST [<xref ref-type="bibr" rid="CR11">11</xref>] scores but this is less sensitive. We demonstrate the use of OD-Seq by taking sets of sequences from Pfam [<xref ref-type="bibr" rid="CR12">12</xref>] and seeding these with outlier sequences from other Pfam families. In principle our method should work for nucleic acid sequences as well, but hasn’t been tested.</p>
  </sec>
  <sec id="Sec2">
    <title>Methods</title>
    <sec id="Sec3">
      <title>Algorithm</title>
      <sec id="Sec4">
        <title>Overview</title>
        <p>The original motivation for designing OD-seq was to find outlier sequences in large multiple sequence alignments. This is the ideal usage for the program but it can also be used to detect outliers in sets of unaligned sequences. The suggested workflow would be to compute an alignment first, followed by using OD-seq to remove outliers and realigning the truncated set of sequences to obtain the final alignment. The basis of the algorithm is to analyse a matrix of gap-based distances between a set of sequences. Then outliers are found by looking for sequences with unusual average distances to the remainder of the sequences. This methodology will not work if excessively heavy gap penalties are imposed as only few gaps would be present in the MSA, considerably reducing the power of the present approach. In general, accurate gap placement is a difficult problem [<xref ref-type="bibr" rid="CR13">13</xref>]. The OD-seq algorithm is divided in two main parts. First we create or take as input the distance matrix. Then we analyse the vector of mean distances from each sequence to the rest to predict outliers (Fig. <xref rid="Fig1" ref-type="fig">1</xref>). Different pairwise distance metrics are used for aligned and unaligned sequences.
<fig id="Fig1"><label>Fig. 1</label><caption><p>Software flow chart. Infographic illustrating the workflow of OD-seq. At the input layer the user can provide a multiple sequence alignment, unaligned sequences or a pre-computed distance matrix. The sequence files are used to compute a distance matrix. This data are then normalised by bootstrap or interquartile range analysis. Outlier list, core sequences and outlier sequences are available for output</p></caption><graphic xlink:href="12859_2015_702_Fig1_HTML" id="MO1"/></fig>
</p>
        <p>For very large numbers of sequences the distance matrix becomes very time and memory consuming to create. mBed [<xref ref-type="bibr" rid="CR14">14</xref>] allows us to calculate approximate mean distances for the sequences, without calculating a full distance matrix. For analysing the vector of distances, we predict outliers in two ways: bootstrapping to estimate confidence intervals or by analysing interquartile ranges. Both of these methods are used to find sequences with unexpectedly large average distances.</p>
      </sec>
      <sec id="Sec5">
        <title>Alignment gap metric</title>
      </sec>
      <sec id="Sec6">
        <title>Aligned sequences</title>
        <p>OD-Seq can read distance matrices in Phylip [<xref ref-type="bibr" rid="CR15">15</xref>] format, unaligned sequences in Fasta format and alignment files in many different formats. If the sequences are in a multiple alignment, the alignment gap metric is used to measure how similar gap placement is between every pair of sequences and detects sequences with missing parts compared to the rest of the alignment. This happens with fragments, for example. It is used to produce a distance matrix by pairwise calculation of the distances in the alignment <italic>X</italic>
<sub><italic>N</italic>,<italic>L</italic></sub>, with <italic>N</italic> number of sequences and <italic>L</italic> is the length of the alignment. Three different metrics are available for selection: linear, affine and cumulative. Before the distance is computed the sequences are changed to a binary representation with 0 for an amino acid character and 1 for a gap. The linear metric is given by the formula
<disp-formula id="Equ1"><label>(1)</label><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ S_{i,j} = \sum_{l=0}^{L} \left\{ \begin{array}{l l} 0, \quad X_{i,l} = X_{j,l} \\ 1, \quad X_{i,l} \neq X_{j,l} \end{array} \right.  $$ \end{document}</tex-math><mml:math id="M2"><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:munderover><mml:mfenced close="" open="{" separators=""><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>≠</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="12859_2015_702_Equ1.gif" position="anchor"/></alternatives></disp-formula>
</p>
        <p>with distance matrix <italic>S</italic>, length of alignment <italic>L</italic> and the alignment as a matrix <italic>X</italic> in binary form. It does not distinguish between fewer, longer gaps or more, shorter gaps. The affine version uses the formula
<disp-formula id="Equ2"><label>(2)</label><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ S_{i,j} = \sum_{l=0}^{L} \left\{ \begin{array}{l l} 0, \quad X_{i,l} = X_{j,l}\\ 3, \quad X_{i,l} \neq X_{j,l} \: \&amp; \: X_{i,l-1} = X_{j,l-1}\\ 1, \quad X_{i,l} \neq X_{j,l} \: \&amp; \: X_{i,l-1} \neq X_{j,l-1} \end{array} \right.  $$ \end{document}</tex-math><mml:math id="M4"><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:munderover><mml:mfenced close="" open="{" separators=""><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>3</mml:mn><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>≠</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mspace width="2.22144pt"/><mml:mo>&amp;</mml:mo><mml:mspace width="2.22144pt"/><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>≠</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mspace width="2.22144pt"/><mml:mo>&amp;</mml:mo><mml:mspace width="2.22144pt"/><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>≠</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="12859_2015_702_Equ2.gif" position="anchor"/></alternatives></disp-formula>
</p>
        <p>which scores short gaps relatively high compared to long ones, as it has an initial gap opening penalty. If the cumulative metric is chosen gap opening produces a low score but as the gap gets longer the extension score increases, the formula for this is
<disp-formula id="Equ3"><label>(3)</label><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ S_{i,j} = \sum_{l=0}^{L} \left\{ \begin{array}{l l} 0, \: \quad \quad \quad \quad X_{i,l} = X_{j,l}\\ 1, \: \quad \quad \quad \quad X_{i,0} \neq X_{j,0}\\ 1 + C_{l-1}, \quad X_{i,l} \neq X_{j,l} \: | \: l &gt; 0 \end{array} \right.  $$ \end{document}</tex-math><mml:math id="M6"><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:munderover><mml:mfenced close="" open="{" separators=""><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mspace width="2.22144pt"/><mml:mspace width="1em"/><mml:mspace width="1em"/><mml:mspace width="1em"/><mml:mspace width="1em"/><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mspace width="2.22144pt"/><mml:mspace width="1em"/><mml:mspace width="1em"/><mml:mspace width="1em"/><mml:mspace width="1em"/><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>≠</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>≠</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mspace width="2.22144pt"/><mml:mo>|</mml:mo><mml:mspace width="2.22144pt"/><mml:mi>l</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="12859_2015_702_Equ3.gif" position="anchor"/></alternatives></disp-formula>
</p>
        <p>with <italic>C</italic>
<sub><italic>j</italic></sub> being a vector holding the distance value for each position of the comparison. The pairwise scores of each sequence M are then added up to an overall distance vector <italic>D</italic>
<sub><italic>i</italic></sub>.
<disp-formula id="Equ4"><label>(4)</label><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ D_{i} = \sum_{j=0}^{M} S_{i,j}  $$ \end{document}</tex-math><mml:math id="M8"><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math><graphic xlink:href="12859_2015_702_Equ4.gif" position="anchor"/></alternatives></disp-formula>
</p>
      </sec>
      <sec id="Sec7">
        <title>Unaligned sequences</title>
        <p>The similarity computation for unaligned sequences is performed by BLASTP with default parameters. Here the bit score for every pairwise computation is added up to an overall score for each sequence.</p>
      </sec>
      <sec id="Sec8">
        <title>mBed</title>
        <p>Computing a full distance matrix for <italic>N</italic> sequences has a time and memory complexity of <italic>O</italic>(<italic>N</italic>
<sup>2</sup>). This becomes prohibitive for alignments of many sequences. The mBed algorithm, also used in Clustal Omega, reduces computing times. Here the <italic>N</italic>×<italic>N</italic> distance matrix is reduced to <italic>N</italic> log(<italic>N</italic>) by randomly selecting <italic>M</italic>= log(<italic>N</italic>) seed sequences and calculating a reduced <italic>M</italic>×<italic>N</italic> distance matrix. When tested on multiple sequence alignment benchmarks, it was used to make alignments without a significant change in accuracy.</p>
      </sec>
      <sec id="Sec9">
        <title>Bootstrapping</title>
        <p>To generate robust estimates of the mean and standard deviation of the distribution of the average distances, bootstrapping can be used. Pseudo replicates are created by picking <italic>N</italic> sequences randomly (with replacement) and computing the mean and standard deviation of each pseudo replicate. The mean of these values over all the replicates generate the estimates for the calculation of the outlier score. A sequence <italic>i</italic> is considered an outlier if
<disp-formula id="Equ5"><label>(5)</label><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ T &lt; \frac{D_{i} - \overline{s}}{\sigma}  $$ \end{document}</tex-math><mml:math id="M10"><mml:mi>T</mml:mi><mml:mo>&lt;</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mover accent="false"><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mo accent="true">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>σ</mml:mi></mml:mrow></mml:mfrac></mml:math><graphic xlink:href="12859_2015_702_Equ5.gif" position="anchor"/></alternatives></disp-formula>
</p>
        <p>with <italic>σ</italic> being the estimated standard deviation, <inline-formula id="IEq1"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\overline {s}$\end{document}</tex-math><mml:math id="M12"><mml:mover accent="false"><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mo accent="true">¯</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="12859_2015_702_IEq1.gif"/></alternatives></inline-formula> the estimated mean score and <italic>D</italic>
<sub><italic>i</italic></sub> the score of sequence <italic>i</italic>.</p>
      </sec>
      <sec id="Sec10">
        <title>Interquartile range analysis</title>
        <p>For the interquartile range analysis, the distance vector for the sequences is sorted. The values for the 1st quartile (<italic>Q</italic>1) and 3rd quartiles (<italic>Q</italic>3) determine the interquartile range <italic>r</italic>=<italic>Q</italic>3−<italic>Q</italic>1. For sequences with a distance measure greater than <italic>Q</italic>1 and smaller than <italic>Q</italic>3 the outlier score is 0. A sequence <italic>i</italic> is considered an outlier if
<disp-formula id="Equ6"><label>(6)</label><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ D_{i} &lt; Q1 \quad \&amp; \quad T &gt; \frac {Q1 -D_{i}}{r}  $$ \end{document}</tex-math><mml:math id="M14"><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:mi>Q</mml:mi><mml:mn>1</mml:mn><mml:mspace width="1em"/><mml:mo>&amp;</mml:mo><mml:mspace width="1em"/><mml:mi>T</mml:mi><mml:mo>&gt;</mml:mo><mml:mfrac><mml:mrow><mml:mi>Q</mml:mi><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:mfrac></mml:math><graphic xlink:href="12859_2015_702_Equ6.gif" position="anchor"/></alternatives></disp-formula>
</p>
        <p>or
<disp-formula id="Equ7"><label>(7)</label><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ D_{i} &gt; Q3 \quad \&amp; \quad T &lt; \frac{D_{i} - Q3}{r}  $$ \end{document}</tex-math><mml:math id="M16"><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:mi>Q</mml:mi><mml:mn>3</mml:mn><mml:mspace width="1em"/><mml:mo>&amp;</mml:mo><mml:mspace width="1em"/><mml:mi>T</mml:mi><mml:mo>&lt;</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mi>Q</mml:mi><mml:mn>3</mml:mn></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:mfrac></mml:math><graphic xlink:href="12859_2015_702_Equ7.gif" position="anchor"/></alternatives></disp-formula>
</p>
        <p>Sequences are asigned a value of 0 and not considered an outlier if
<disp-formula id="Equ8"><label>(8)</label><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ D_{i} &gt; Q1 \quad \&amp; \quad D_{i} &lt; Q3  $$ \end{document}</tex-math><mml:math id="M18"><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:mi>Q</mml:mi><mml:mn>1</mml:mn><mml:mspace width="1em"/><mml:mo>&amp;</mml:mo><mml:mspace width="1em"/><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:mi>Q</mml:mi><mml:mn>3</mml:mn></mml:math><graphic xlink:href="12859_2015_702_Equ8.gif" position="anchor"/></alternatives></disp-formula>
</p>
        <p>For datasets with a lot of identical sequences the interquartile range might be 0 which can cause a division by 0. Small values for the interquartile range can lead to inflated scores for the outliers. For these cases bootstrap analysis should be chosen as the estimators are more robust.</p>
      </sec>
    </sec>
    <sec id="Sec11">
      <title>Datasets</title>
      <p>We used the Pfam database (version 27.0) of protein domains for all examples in this paper. The ParG family (PF09274) from Pfam is used as an example to illustrate the computation, it contains 92 sequences with an alignment length of 131. Otherwise, we take full alignments of Pfam domains and test our ability to detect outliers when sequences are added from other Pfam families. To introduce outliers, each dataset was realigned, including the outlier sequences, using Clustal Omega. Three different types of datasets were analysed. The first used all families with 5000 or more sequences. Here, 5000 sequences were randomly selected and 51 sequences added from a different family in the same Pfam clan. The second had 51 sequences added from randomly selected clans. The third is a control consisting of the original alignments, with no outliers, realigned with Clustal Omega. These contain 888, 1328 and 1328 alignments respectively (Table <xref rid="Tab1" ref-type="table">1</xref>). To avoid artifacts caused by unequal sequence lengths, the outliers had to be within ±10 <italic>%</italic> of the average alignment length.
<table-wrap id="Tab1"><label>Table 1</label><caption><p>Pfam verification datasets overview</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"/><th align="left">Different clan</th><th align="left">Same clan</th><th align="left">No outlier</th></tr></thead><tbody><tr><td align="left">Number of families</td><td align="left">1329</td><td align="left">889</td><td align="left">1329</td></tr><tr><td align="left">Number of sequences</td><td align="left">5051</td><td align="left">5051</td><td align="left">5000</td></tr><tr><td align="left">Average alignment length</td><td align="left">906.7</td><td align="left">817.4</td><td align="left">664.3</td></tr><tr><td align="left">% identity</td><td align="left">27.5</td><td align="left">25.1</td><td align="left">29.0</td></tr></tbody></table></table-wrap>
</p>
      <p>Computing times were determined using two variations of the ABC transporter family in Pfam (PF00005). For measuring the time with various alignment lengths, 5000 sequences were chosen and truncated to various lengths. The dependency on the number of sequences in the alignment was determined by keeping the length constant at 200 positions and varying the number of sequences.</p>
    </sec>
  </sec>
  <sec id="Sec12" sec-type="results">
    <title>Results</title>
    <sec id="Sec13">
      <title>Example analysis</title>
      <p>We show one example of detecting outliers in detail with the ParG family from Pfam. This family has 92 sequences and the distance matrix has been calculated in full distance matrix mode. The distribution of average between sequence distances in the Pfam alignment is shown in the top left hand panel of Fig. <xref rid="Fig2" ref-type="fig">2</xref>. The left hand side of the figure shows results for aligned sequences in a multiple alignment calculated with the linear gap metric. The right hand panel shows the equivalent scores using BLASTP to measure between sequence similarity in the same unaligned sequences. In the second row of Fig. <xref rid="Fig2" ref-type="fig">2</xref>, the distances (on the left) and BLASTP scores (on the right) are shown after 5 random outlier sequences from the same Pfam clan as ParG (Met_repress, CL0057) have been artificially added to the datasets. In the bottom row of the figure, the distances are shown after adding 5 random outliers from random clans. We can clearly see that the average distances (or BLASTP scores) of the outliers to the rest of the sequences, make them reasonably distinct, especially in the case of outliers chosen from different clans.
<fig id="Fig2"><label>Fig. 2</label><caption><p>Example analysis unnormalised. Histograms of distance or similarity score distributions, using the ParG family from Pfam. <bold>a</bold>, <bold>b</bold>: Distribution with no outliers. <bold>c</bold>, <bold>d</bold>: Distribution with 5 outliers included from the same Pfam clan. <bold>e</bold>, <bold>f</bold>: Distribution with 5 outliers included from a different Pfam clan. The outliers are shown in red</p></caption><graphic xlink:href="12859_2015_702_Fig2_HTML" id="MO2"/></fig>
</p>
      <p>The question is how to choose a cut-off that will allow us to try to automatically detect as many outliers with as few false positive sequences as possible, in other data sets. This is hard to do with the raw distances as these will depend on the particular set of sequences. The distances need to be normalised and this is done in two ways: distance standard deviations, estimated using the bootstrap or by taking interquartile ranges. The results, using these are shown in Fig. <xref rid="Fig3" ref-type="fig">3</xref>. Here, the left hand column shows bootstrapped standard deviations for the case with no outliers (top), outliers from the same clan (middle) or different clans (bottom). The middle column is the equivalent but here the horizontal axis shows interquartile ranges. The right hand column shows the BLASTP distances, normalised using bootstrap.
<fig id="Fig3"><label>Fig. 3</label><caption><p>Example analysis normalised. Histograms of normalised distance (bootstrap and interquartile range) or similarity score (unaligned) distributions, using the ParG family from Pfam. <bold>a</bold>, <bold>b</bold>, <bold>c</bold>: Distribution with no outliers. <bold>d</bold>, <bold>e</bold>, <bold>f</bold>: Distribution with 5 outliers included from the same Pfam clan. <bold>g</bold>, <bold>h</bold>, <bold>i</bold>: Distribution with 5 outliers included from a different Pfam clan. The outliers are shown in red</p></caption><graphic xlink:href="12859_2015_702_Fig3_HTML" id="MO3"/></fig>
</p>
    </sec>
    <sec id="Sec14">
      <title>Run times</title>
      <p>The run times for the algorithm are expected to show a minimum complexity of <italic>O</italic>(<italic>L</italic>) in sequence length. Times for different subsets of the ABC transporters of different lengths are plotted in (Fig. <xref rid="Fig4" ref-type="fig">4</xref>
<xref rid="Fig4" ref-type="fig">a</xref>) and all variations of the algorithm do show approximately linear behaviour. Time complexity wrt number of sequences is expected to be <italic>O</italic>(<italic>N</italic>
<sup>2</sup>) for full distance matrix mode or <italic>O</italic>(<italic>N</italic> log(<italic>N</italic>)) for mBed mode. Run times for different subsets of the ABC transporters are plotted in (Fig. <xref rid="Fig4" ref-type="fig">4</xref>
<xref rid="Fig4" ref-type="fig">b</xref>). Data shown is the execution time for the whole analysis including sequence read, distance computation, normalisation and output. The outlier detection for the whole ABC transporter family from Pfam with 363,409 sequences with an alignment length of 2177 takes 39 minutes on one CPU core.
<fig id="Fig4"><label>Fig. 4</label><caption><p>Computing times. Plot of compute times for varying length and number of sequences in mBed and full distance mode for the 3 different metrics. The execution times are measured in seconds and shown on the y-axis. In <bold>a</bold> the datasets contain 5000 sequences with length varying from 10 to 2000 amino acids (x-axis). The datasets used in <bold>b</bold> consist of 10 to 50,000 sequences (x-axis) of length 200</p></caption><graphic xlink:href="12859_2015_702_Fig4_HTML" id="MO4"/></fig>
</p>
    </sec>
    <sec id="Sec15">
      <title>Large scale outlier tests</title>
      <p>The overall performance of OD-seq when tested on over 1000 Pfam families, seeded with outliers from the same, or from a different clan, are summarised in Fig. <xref rid="Fig5" ref-type="fig">5</xref>. Here we use receiver operating characteristic (ROC) curves to show the trade-off between sensitivity and specificity for different cut-offs and different OD-seq options. When outliers from a different clan are used, the ability of OD-seq to detect them accurately, with low false positive rates, can be seen with area under the curve (AUC) values of well over 0.9. The bootstrap normalised distances (top left panel) do slightly better than the interquartile range ones (0.98 vs. 096) with the aligned sequences and the unaligned sequences do slightly worse with an AUC of 0.93. The lower 3 panels of Fig. <xref rid="Fig6" ref-type="fig">6</xref> show the ROC curves when outliers are seeded from the same clan. This is a much harder test but AUCs of 0.73–0.76 are still achieved.
<fig id="Fig5"><label>Fig. 5</label><caption><p>Receiver operating characteristic curves. ROC curves to verify the detectability of artificially introduced outliers in Pfam families (Table <xref rid="Tab1" ref-type="table">1</xref>). It shows true and false positive values for different cutoffs with AUC of 0.978, 0.96 and 0.936 for datasets where outliers from different clans have been introduced. When introduced outliers are from the same clan AUC’s of 0.759, 0.745 and 0.732 are shown. The diagonal line represents random classification</p></caption><graphic xlink:href="12859_2015_702_Fig5_HTML" id="MO5"/></fig>
<fig id="Fig6"><label>Fig. 6</label><caption><p>True and false positive rates against cutoff. The true and false positive rates are plotted against the cutoff to observe suitable cutoff values on the x-axis. True positive rates are shown in blue and false positive rates in red on the y-axis. The columns show the different datasets: outliers from an unrelated Pfam clan, outliers from the same clan and no outliers respectively. Rows vary the method of normalisation (bootstrap, interquartile range and unaligned bootstrap)</p></caption><graphic xlink:href="12859_2015_702_Fig6_HTML" id="MO6"/></fig>
</p>
      <p>A threshold range for outliers was identified by plotting the true positive (TPR) and false positive (FPR) rate against the threshold (Fig. <xref rid="Fig5" ref-type="fig">5</xref>). In these plots one can observe that if a cut-off of 2 is selected a FPR below 10 <italic>%</italic> can be expected while the TPR is still far higher and depending on the dataset true outliers can be identified confidently. The plots show that the FPR stays constant even if no outliers are present. According to these figures a threshold between 2 and 10 is recommended, depending on the stringency the user wants to choose. For the same clan datasets a steep decline in TPR is observed, this is due to the fact that many of the introduced outliers are so similar to the selected family that they might not even be considered outliers due to their similarity. For the unaligned method the area of good performance is narrower as high outlier scores are very rare.</p>
      <p>The ROC curves and TPR/FPR plots show that finding outliers is possible with OD-seq, but as the ratio between outliers and core sequences is 100:1 missing an outlier is punished strongly and misclassifying a lot of core sequences as outliers do not increase the FPR by much. To assess the differences between different modes and metrics of OD-seq these plots do not give a lot of information. Therefore precision recall curves, which scale the TPR and FPR by the number of outliers, were produced. This makes finding outliers and core sequences comparable (Fig. <xref rid="Fig7" ref-type="fig">7</xref>). Here one can clearly see that the use of a multiple sequence alignment enhances outlier detection. The linear metric with bootstrap analysis performs best as the prediction is more robust than with the interquartile range analysis.
<fig id="Fig7"><label>Fig. 7</label><caption><p>Precision recall curves. The precision recall curves plot precision on the y-axis against recall values on the x-axis. The first row shows the Pfam datasets with outliers from different clans, the second row shows datasets from Pfam with outliers from the same clan. The columns show the different methods of normalization: aligned bootstrap, interquartile range and unaligned bootstrap respectively</p></caption><graphic xlink:href="12859_2015_702_Fig7_HTML" id="MO7"/></fig>
</p>
    </sec>
    <sec id="Sec16">
      <title>Pfam outliers and example</title>
      <p>Table <xref rid="Tab2" ref-type="table">2</xref> shows the percentage of outliers predicted by OD-seq for full Pfam families of different sizes (number of sequences in the family) for 10 different cutoffs and 4 modes.
<table-wrap id="Tab2"><label>Table 2</label><caption><p>Detected outliers in Pfam families</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" colspan="3">Pfam families</th><th align="left" colspan="4">Percentage of outliers found by bootstrap cutoff</th><th align="left" colspan="4"/></tr><tr><th align="left">Sequences</th><th align="left">Median</th><th align="left">Type</th><th align="left">1</th><th align="left">2</th><th align="left">3</th><th align="left">4</th><th align="left">5</th><th align="left">6</th><th align="left">7</th><th align="left">8</th></tr></thead><tbody><tr><td align="left">≤150</td><td align="left">68</td><td align="left">Linear</td><td align="left">12.52</td><td align="left">5.51</td><td align="left">2.22</td><td align="left">0.92</td><td align="left">0.40</td><td align="left">0.19</td><td align="left">0.09</td><td align="left">0.05</td></tr><tr><td align="left">150−500</td><td align="left">278</td><td align="left"/><td align="left">12.70</td><td align="left">5.34</td><td align="left">2.11</td><td align="left">0.88</td><td align="left">0.39</td><td align="left">0.19</td><td align="left">0.09</td><td align="left">0.05</td></tr><tr><td align="left">≥500</td><td align="left">1652</td><td align="left"/><td align="left">11.74</td><td align="left">5.21</td><td align="left">2.25</td><td align="left">1.00</td><td align="left">0.46</td><td align="left">0.22</td><td align="left">0.11</td><td align="left">0.06</td></tr><tr><td align="left">≤150</td><td align="left">68</td><td align="left">Affine</td><td align="left">13.10</td><td align="left">5.39</td><td align="left">2.02</td><td align="left">0.76</td><td align="left">0.33</td><td align="left">0.15</td><td align="left">0.07</td><td align="left">0.03</td></tr><tr><td align="left">150−500</td><td align="left">278</td><td align="left"/><td align="left">13.25</td><td align="left">5.33</td><td align="left">2.00</td><td align="left">0.77</td><td align="left">0.32</td><td align="left">0.14</td><td align="left">0.07</td><td align="left">0.03</td></tr><tr><td align="left">≥500</td><td align="left">1652</td><td align="left"/><td align="left">11.98</td><td align="left">5.18</td><td align="left">2.21</td><td align="left">0.96</td><td align="left">0.43</td><td align="left">0.19</td><td align="left">0.09</td><td align="left">0.05</td></tr><tr><td align="left">≤150</td><td align="left">68</td><td align="left">Cumulative</td><td align="left">10.37</td><td align="left">5.10</td><td align="left">2.54</td><td align="left">1.30</td><td align="left">0.69</td><td align="left">0.40</td><td align="left">0.22</td><td align="left">0.12</td></tr><tr><td align="left">150−500</td><td align="left">278</td><td align="left"/><td align="left">9.01</td><td align="left">4.25</td><td align="left">2.15</td><td align="left">1.20</td><td align="left">0.72</td><td align="left">0.45</td><td align="left">0.29</td><td align="left">0.20</td></tr><tr><td align="left">≥500</td><td align="left">1652</td><td align="left"/><td align="left">7.50</td><td align="left">3.53</td><td align="left">1.87</td><td align="left">1.09</td><td align="left">0.68</td><td align="left">0.45</td><td align="left">0.31</td><td align="left">0.22</td></tr><tr><td align="left">≤150</td><td align="left">68</td><td align="left">Unaligned</td><td align="left">14.3</td><td align="left">8.19</td><td align="left">1.01</td><td align="left">0.055</td><td align="left">0.046</td><td align="left">0.045</td><td align="left">0.045</td><td align="left">0.045</td></tr><tr><td align="left">150−500</td><td align="left">278</td><td align="left"/><td align="left">16.35</td><td align="left">12.65</td><td align="left">0.093</td><td align="left">0.012</td><td align="left">0.0027</td><td align="left">0.0009</td><td align="left">0.0005</td><td align="left">0.0003</td></tr><tr><td align="left">≥500</td><td align="left">1652</td><td align="left"/><td align="left">15.8</td><td align="left">1.65</td><td align="left">0.16</td><td align="left">0.018</td><td align="left">0.0032</td><td align="left">0.0008</td><td align="left">0.0002</td><td align="left">0.0001</td></tr></tbody></table></table-wrap>
</p>
      <p>In this example we take the non-structural protein C (Paramyxo_NS_C) family from Pfam with 123 sequences and an alignment length of 230 amino acids and show it with Jalview. In this typical example alignment three outliers were identified (Fig. <xref rid="Fig8" ref-type="fig">8</xref>). One can see that the most obvious outlier (I0B1S0_9PARA/31-164) misaligned with almost all residues except a small core region (Outlier score of 10.4). the same happens for the other two sequences with a smaller but detectable misalignment (Outlier score 4.7 for B8XH61_0MONO/6-148 and 3.3 for Q6WGM3_9PARA/5-150).
<fig id="Fig8"><label>Fig. 8</label><caption><p>Outlier example. Alignment of sequences of the Pfam family Paramyxo_NS_C (non-structural protein C). 3 sequences with high outlier scores are highlighted (I0B1S0_9PARA/31-164, B8XH61_0MONO/6-148 and Q6WGM3_9PARA/5-150), the scores are 10.4, 4.7 and 3.3 respectively</p></caption><graphic xlink:href="12859_2015_702_Fig8_HTML" id="MO8"/></fig>
</p>
    </sec>
  </sec>
  <sec id="Sec17" sec-type="discussion">
    <title>Discussion</title>
    <p>Viewing very large alignments of many thousands of sequences is challenging, even if you use the best viewers available such as Jalview or Seaview [<xref ref-type="bibr" rid="CR16">16</xref>]. One serious issue is to detect and deal with highly aberrant sequences. OD-seq provides a simple yet robust method to rank the most aberrant sequences or to select all sequences above some cut-off that is tuned to optimise a desired false positive or false negative rate. When faced with clear outliers, such as the case with Pfam families that have been seeded with sequences from different Pfam clans, OD-seq finds the outliers with extremely high sensitivity and specificity. These outliers were selected to be similar in length to the family they were added to so as to reduce length effects. When sequences were added from the same Pfam clan, the performance reduces but here, the difference between an outlier and a homologous yet very dissimilar sequence, is not so clear-cut. OD-seq can also deal with unaligned sequences, but the performance is, again, not as good as the full multiple alignment case. The main aim when designing OD-seq was to catch outliers in the full alignment.</p>
    <p>OD-seq is fast enough to process alignments of moderate to large size in seconds. The run times to do any calculations on a full distance matrix will normally be proportional to the square of the number of sequences. For alignments of many tens of thousands of sequences this could take days to process. The <italic>O</italic>(<italic>N</italic> log(<italic>N</italic>)) mBed method for distance matrix calculation, reduces the time and memory to perfectly practical levels with alignments of over 300,000 sequences of length over 2000 positions being processed in under 40 minutes on a single core. The combination of speed and accuracy, then makes OD-seq a potentially useful tool for pipelines that require many large alignments to be made or for checking very large alignments for outliers. OD-seq will not be able to deal with outliers in very small data sets or with sequences that are homologous to the rest of a dataset over most of their length but which have a short region of mismatch. Such sequences or mismatched regions can be found satisfactorily by existing tools.</p>
  </sec>
  <sec id="Sec18" sec-type="conclusion">
    <title>Conclusion</title>
    <p>OD-seq is a practical and simple method to detect outliers in MSAs. It can also detect outliers in sets of unaligned sequences, but with reduced accuracy. For medium sized alignments, of a few thousand sequences, it can detect outliers in a few seconds.</p>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p>
        <bold>Competing interests</bold>
      </p>
      <p>The authors declare that they have no competing interests.</p>
    </fn>
    <fn>
      <p>
        <bold>Authors’ contributions</bold>
      </p>
      <p>DGH initiated the study, PJ and FS designed the study. PJ wrote the software and performed the benchmarking. All authors wrote and approve the manuscript.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>Thanks to Norma Coffey-Bargary for suggesting the interquartile range analysis. Funding was provided by Science Foundation Ireland to DGH through PI grant 11/PI/1034.</p>
  </ack>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sievers</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Wilm</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Dineen</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Gibson</surname>
            <given-names>TJ</given-names>
          </name>
          <name>
            <surname>Karplus</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>W</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Fast, scalable generation of high-quality protein multiple sequence alignments using Clustal Omega</article-title>
        <source>Mol Syst Biol</source>
        <year>2011</year>
        <volume>7</volume>
        <fpage>539</fpage>
        <pub-id pub-id-type="doi">10.1038/msb.2011.75</pub-id>
        <pub-id pub-id-type="pmid">21988835</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Notredame</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Higgins</surname>
            <given-names>DG</given-names>
          </name>
          <name>
            <surname>Heringa</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>T-Coffee: A novel method for multiple sequence alignments</article-title>
        <source>JMB</source>
        <year>2000</year>
        <volume>302</volume>
        <fpage>205</fpage>
        <lpage>217</lpage>
        <pub-id pub-id-type="doi">10.1006/jmbi.2000.4042</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Katoh</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Standley</surname>
            <given-names>DM</given-names>
          </name>
        </person-group>
        <article-title>MAFFT multiple sequence alignment software version 7: improvements in performance and usability</article-title>
        <source>Mol Bio Evol</source>
        <year>2003</year>
        <volume>30</volume>
        <fpage>772</fpage>
        <lpage>80</lpage>
        <pub-id pub-id-type="doi">10.1093/molbev/mst010</pub-id>
        <pub-id pub-id-type="pmid">23329690</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Edgar</surname>
            <given-names>RC</given-names>
          </name>
        </person-group>
        <article-title>MUSCLE: multiple sequence alignment with high accuracy and high throughput</article-title>
        <source>Nucleic Acids Res</source>
        <year>2004</year>
        <volume>32</volume>
        <issue>5</issue>
        <fpage>1792</fpage>
        <lpage>7</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkh340</pub-id>
        <pub-id pub-id-type="pmid">15034147</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Waterhouse</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Procter</surname>
            <given-names>JB</given-names>
          </name>
          <name>
            <surname>Martin</surname>
            <given-names>DMA</given-names>
          </name>
          <name>
            <surname>Clamp</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Barton</surname>
            <given-names>GJ</given-names>
          </name>
        </person-group>
        <article-title>Jalview Version 2 - a multiple sequence alignment editor and analysis workbench</article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>25</volume>
        <issue>9</issue>
        <fpage>1189</fpage>
        <lpage>91</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btp033</pub-id>
        <pub-id pub-id-type="pmid">19151095</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chandola</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Banerjee</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Kumar</surname>
            <given-names>V</given-names>
          </name>
        </person-group>
        <article-title>Anomaly detection: A survey</article-title>
        <source>ACM Comput Surv</source>
        <year>2009</year>
        <volume>41</volume>
        <issue>3</issue>
        <fpage>58</fpage>
        <pub-id pub-id-type="doi">10.1145/1541880.1541882</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Thompson</surname>
            <given-names>JD</given-names>
          </name>
          <name>
            <surname>Gibson</surname>
            <given-names>TJ</given-names>
          </name>
          <name>
            <surname>Plewniak</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Jeanmougin</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Higgins</surname>
            <given-names>DG</given-names>
          </name>
        </person-group>
        <article-title>The CLUSTAL_X windows interface: flexible strategies for multiple sequence alignment aided by quality analysis tools</article-title>
        <source>Nucleic Acids Res</source>
        <year>1997</year>
        <volume>25</volume>
        <fpage>4876</fpage>
        <lpage>82</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/25.24.4876</pub-id>
        <pub-id pub-id-type="pmid">9396791</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Castresana</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Selection of conserved blocks from multiple alignments for their use in phylogenetic analysis</article-title>
        <source>Mol Biol Evol</source>
        <year>2000</year>
        <volume>17</volume>
        <fpage>540</fpage>
        <lpage>52</lpage>
        <pub-id pub-id-type="doi">10.1093/oxfordjournals.molbev.a026334</pub-id>
        <pub-id pub-id-type="pmid">10742046</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Penn</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Privman</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Landan</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Graur</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Pupko</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>An alignment confidence score capturing robustness to guide tree uncertainty</article-title>
        <source>Mol Biol Evol</source>
        <year>2010</year>
        <volume>27</volume>
        <issue>8</issue>
        <fpage>1759</fpage>
        <lpage>67</lpage>
        <pub-id pub-id-type="doi">10.1093/molbev/msq066</pub-id>
        <pub-id pub-id-type="pmid">20207713</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zepeda Mendoza</surname>
            <given-names>ML</given-names>
          </name>
          <name>
            <surname>Nygaard</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>da Fonseca</surname>
            <given-names>RR</given-names>
          </name>
        </person-group>
        <article-title>DivA: detection of non-homologous and very divergent regions in protein sequence alignments</article-title>
        <source>BMC Res Notes</source>
        <year>2014</year>
        <volume>7</volume>
        <fpage>806</fpage>
        <pub-id pub-id-type="doi">10.1186/1756-0500-7-806</pub-id>
        <pub-id pub-id-type="pmid">25403086</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Altschul</surname>
            <given-names>SF</given-names>
          </name>
          <name>
            <surname>Gish</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Miller</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Myers</surname>
            <given-names>EW</given-names>
          </name>
          <name>
            <surname>Lipman</surname>
            <given-names>DJ</given-names>
          </name>
        </person-group>
        <article-title>Basic local alignment search tool</article-title>
        <source>J Mol Biol</source>
        <year>1990</year>
        <volume>215</volume>
        <fpage>403</fpage>
        <lpage>10</lpage>
        <pub-id pub-id-type="doi">10.1016/S0022-2836(05)80360-2</pub-id>
        <pub-id pub-id-type="pmid">2231712</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Finn</surname>
            <given-names>RD</given-names>
          </name>
          <name>
            <surname>Bateman</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Clements</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Coggill</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Eberhardt</surname>
            <given-names>RY</given-names>
          </name>
          <name>
            <surname>Eddy</surname>
            <given-names>SR</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The Pfam protein families database</article-title>
        <source>Nucleic Acids Res</source>
        <year>2014</year>
        <volume>42</volume>
        <fpage>D222</fpage>
        <lpage>30</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkt1223</pub-id>
        <pub-id pub-id-type="pmid">24288371</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Löytynoja</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Goldman</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>Phylogeny-aware gap placement prevents errors in sequence alignment and evolutionary analysis</article-title>
        <source>Science</source>
        <year>2008</year>
        <volume>320</volume>
        <issue>5883</issue>
        <fpage>1632</fpage>
        <lpage>5</lpage>
        <pub-id pub-id-type="doi">10.1126/science.1158395</pub-id>
        <pub-id pub-id-type="pmid">18566285</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Blackshields</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Sievers</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Shi</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Wilm</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Higgins</surname>
            <given-names>DG</given-names>
          </name>
        </person-group>
        <article-title>Sequence embedding for fast construction of guide trees for multiple sequence alignment</article-title>
        <source>Algorithms Mol Biol</source>
        <year>2010</year>
        <volume>5</volume>
        <fpage>21</fpage>
        <pub-id pub-id-type="doi">10.1186/1748-7188-5-21</pub-id>
        <pub-id pub-id-type="pmid">20470396</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Felsenstein</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Phylip - phylogeny inference package (version 3.2)</article-title>
        <source>Cladistics</source>
        <year>1989</year>
        <volume>5</volume>
        <fpage>164</fpage>
        <lpage>6</lpage>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gouy</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Guindon</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Gascuel</surname>
            <given-names>O</given-names>
          </name>
        </person-group>
        <article-title>SeaView Version 4: A multiplatform graphical user interface for sequence alignment and phylogenetic tree building</article-title>
        <source>Mol Biol Evol</source>
        <year>2010</year>
        <volume>27</volume>
        <issue>2</issue>
        <fpage>221</fpage>
        <lpage>4</lpage>
        <pub-id pub-id-type="doi">10.1093/molbev/msp259</pub-id>
        <pub-id pub-id-type="pmid">19854763</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
