<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinform Adv</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinform Adv</journal-id>
    <journal-id journal-id-type="publisher-id">bioadv</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics Advances</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2635-0041</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10049754</article-id>
    <article-id pub-id-type="doi">10.1093/bioadv/vbad029</article-id>
    <article-id pub-id-type="publisher-id">vbad029</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Paper</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Software</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>EasyCellType: marker-based cell-type annotation by automatically querying multiple databases</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Li</surname>
          <given-names>Ruoxing</given-names>
        </name>
        <aff><institution>Department of Biostatistics and Data Science, The University of Texas Health Science Center at Houston</institution>, Houston, TX 77030, <country country="US">USA</country></aff>
        <aff><institution>Department of Biostatistics, The University of Texas MD Anderson Cancer Center</institution>, Houston, TX 77030, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Zhang</surname>
          <given-names>Jianjun</given-names>
        </name>
        <aff><institution>Division of Cancer Medicine, Department of Thoracic-Health &amp; Neck Med Oncology, The University of Texas MD Anderson Cancer Center</institution>, Houston, TX 77030, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-8359-0533</contrib-id>
        <name>
          <surname>Li</surname>
          <given-names>Ziyi</given-names>
        </name>
        <aff><institution>Department of Biostatistics, The University of Texas MD Anderson Cancer Center</institution>, Houston, TX 77030, <country country="US">USA</country></aff>
        <xref rid="vbad029-cor1" ref-type="corresp"/>
        <!--zli16@mdanderson.org-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Zhang</surname>
          <given-names>Zhang</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="vbad029-cor1">To whom correspondence should be addressed. <email>zli16@mdanderson.org</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2023-03-24">
      <day>24</day>
      <month>3</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>24</day>
      <month>3</month>
      <year>2023</year>
    </pub-date>
    <volume>3</volume>
    <issue>1</issue>
    <elocation-id>vbad029</elocation-id>
    <history>
      <date date-type="received">
        <day>06</day>
        <month>9</month>
        <year>2022</year>
      </date>
      <date date-type="rev-recd">
        <day>20</day>
        <month>1</month>
        <year>2023</year>
      </date>
      <date date-type="editorial-decision">
        <day>24</day>
        <month>2</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>22</day>
        <month>3</month>
        <year>2023</year>
      </date>
      <date date-type="corrected-typeset">
        <day>28</day>
        <month>3</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2023</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="vbad029.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>Cell label annotation is a challenging step in the analysis of single-cell RNA sequencing (scRNA-seq) data, especially for tissue types that are less commonly studied. The accumulation of scRNA-seq studies and biological knowledge leads to several well-maintained cell marker databases. Manually examining the cell marker lists against these databases can be difficult due to the large amount of available information. Additionally, simply overlapping the two lists without considering gene ranking might lead to unreliable results. Thus, an automated method with careful statistical testing is needed to facilitate the usage of these databases.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>We develop a user-friendly computational tool, EasyCellType, which automatically checks an input marker list obtained by differential expression analysis against the databases and provides annotation recommendations in graphical outcomes. The package provides two statistical tests, gene set enrichment analysis and a modified version of Fisher’s exact test, as well as customized database and tissue type choices. We also provide an interactive shiny application to annotate cells in a user-friendly graphical user interface. The simulation study and real-data applications demonstrate favorable results by the proposed method.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p><ext-link xlink:href="https://biostatistics.mdanderson.org/shinyapps/EasyCellType/" ext-link-type="uri">https://biostatistics.mdanderson.org/shinyapps/EasyCellType/</ext-link>; <ext-link xlink:href="https://bioconductor.org/packages/devel/bioc/html/EasyCellType.html" ext-link-type="uri">https://bioconductor.org/packages/devel/bioc/html/EasyCellType.html</ext-link>.</p>
      </sec>
      <sec id="s5">
        <title>Supplementary information</title>
        <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics Advances</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>National Cancer Institute of the National Institute of Health</institution>
          </institution-wrap>
        </funding-source>
        <award-id>R01CA234629</award-id>
        <award-id>R03CA270725</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="8"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Single-cell RNA sequencing (scRNA-seq) technology was first published in 2009 (<xref rid="vbad029-B31" ref-type="bibr">Tang <italic toggle="yes">et al.</italic>, 2009</xref>) and soon became an effective tool for sequencing the transcriptomes of different organisms at a single-cell level (<xref rid="vbad029-B20" ref-type="bibr">Lee <italic toggle="yes">et al.</italic>, 2020</xref>; <xref rid="vbad029-B21" ref-type="bibr">Li <italic toggle="yes">et al.</italic>, 2020</xref>; <xref rid="vbad029-B27" ref-type="bibr">Potter, 2018</xref>). It has been widely used in studying the cellular heterogeneity of various tissue samples and identifying phenotype-associated cell groups (<xref rid="vbad029-B19" ref-type="bibr">Lawson <italic toggle="yes">et al.</italic>, 2015</xref>; <xref rid="vbad029-B22" ref-type="bibr">Lim <italic toggle="yes">et al.</italic>, 2020</xref>; <xref rid="vbad029-B25" ref-type="bibr">Mathys <italic toggle="yes">et al.</italic>, 2019</xref>). It also provides exciting opportunities to dissect complex cell behaviors, such as lineage tracing (<xref rid="vbad029-B12" ref-type="bibr">Frieda <italic toggle="yes">et al.</italic>, 2017</xref>) and cell–cell communication (<xref rid="vbad029-B1" ref-type="bibr">Almet <italic toggle="yes">et al.</italic>, 2021</xref>; <xref rid="vbad029-B18" ref-type="bibr">Kumar <italic toggle="yes">et al.</italic>, 2018</xref>).</p>
    <p>Analyzing an scRNA-seq dataset typically starts from quality control and alignment (<xref rid="vbad029-B15" ref-type="bibr">Kaminow <italic toggle="yes">et al.</italic>, 2021</xref>), batch effect correction (<xref rid="vbad029-B8" ref-type="bibr">Chazarra-Gil <italic toggle="yes">et al.</italic>, 2021</xref>), dimension reduction (<xref rid="vbad029-B43" ref-type="bibr">Zhou and Jin, 2020</xref>) and clustering (<xref rid="vbad029-B16" ref-type="bibr">Kiselev <italic toggle="yes">et al.</italic>, 2017</xref>; <xref rid="vbad029-B28" ref-type="bibr">Satija <italic toggle="yes">et al.</italic>, 2015</xref>), followed by a crucial step—cell annotation. In general, cells from scRNA-seq data are annotated mainly through two approaches: one is manual annotation based on the cluster-specific differentially expressed marker genes and the other is supervised cell annotation using existing datasets as the reference. The former approach can be labor intensive and time consuming. Moreover, it requires analyzers to have a good understanding of the potential cell types contained in collected scRNA-seq datasets as well as the corresponding cell-type-specific markers (<xref rid="vbad029-B32" ref-type="bibr">Tran, 2022</xref>). Recognizing these challenges, a number of supervised annotation methods have also been developed to fully utilize the published scRNA-seq data as the training set and to predict the cell labels in the new dataset (<xref rid="vbad029-B23" ref-type="bibr">Lin <italic toggle="yes">et al.</italic>, 2020</xref>; <xref rid="vbad029-B24" ref-type="bibr">Ma and Pellegrini, 2020</xref>). However, the supervised method can be limited if the annotated data from the matched tissue types are not available, or the published data are from a different condition, e.g. healthy versus diseased (<xref rid="vbad029-B30" ref-type="bibr">Sun <italic toggle="yes">et al.</italic>, 2022</xref>).</p>
    <p>With the accumulation of scRNA-seq research, great efforts have been made to summarize the tissue-specific marker information, and a few comprehensive databases become available, e.g. CellMarker (<xref rid="vbad029-B39" ref-type="bibr">Zhang <italic toggle="yes">et al.</italic>, 2019b</xref>), PanglaoDB (<xref rid="vbad029-B11" ref-type="bibr">Franzén <italic toggle="yes">et al.</italic>, 2019</xref>) and Clustermole (<xref rid="vbad029-B9" ref-type="bibr">Dolgalev, 2021</xref>), which provide useful information for cell-type identities. However, manually checking the cell-type-specific markers against these databases can be an impractical task due to the large amount of information. A few marker-based annotation methods have also been developed. CellAssign used a probabilistic model to annotate individual cells based on collected marker genes (<xref rid="vbad029-B38" ref-type="bibr">Zhang <italic toggle="yes">et al.</italic>, 2019a</xref>). The method can achieve an accuracy of higher than 90% when well-understood marker genes exist. However, users need to derive their own marker gene sets for annotation usage, which may not be easy for scientists without biological expertise. A semi-supervised method, SCINA, is applicable to classify cell type for scRNA-seq, CyTOF/FACS and bulk RNA-seq data (<xref rid="vbad029-B40" ref-type="bibr">Zhang <italic toggle="yes">et al.</italic>, 2019c</xref>), but a curated gene list is also required. SCSA by <xref rid="vbad029-B7" ref-type="bibr">Cao <italic toggle="yes">et al.</italic> (2020)</xref> integrates the marker information from existing databases to assign cell types. SCSA uses a score annotation model to rank the overlapped genes between the differential signals and the databases. For the genes that are not included in the cell marker database, SCSA will perform gene ontology (GO) enrichment analysis to interpret the biological processes. When SCSA was first published, it only supported the clustering output from CellRanger or Seurat as its input. Now, although the clustering output from Scanpy or Scran is also supported, the applications are still limited. More recently, scGate (<xref rid="vbad029-B3" ref-type="bibr">Andreatta <italic toggle="yes">et al.</italic>, 2022</xref>) and MACA (<xref rid="vbad029-B37" ref-type="bibr">Xu <italic toggle="yes">et al.</italic>, 2022</xref>) were also developed based on marker databases. MACA is an scRNA-seq annotation tool that uses normalized confusion matrices. scGate can annotate not only scRNA-seq data but also other single-cell modalities (e.g. ATAC-seq). scGate and MACA have similar challenges as CellAssign that the cell types in the query dataset need to be pre-defined. Thus, they may not be friendly to less-studied tissues or diseased conditions.</p>
    <p>To facilitate researchers to use different databases directly and conveniently, we develop a computational tool, EasyCellType, which can automatically examine the input marker lists obtained by differential expression analysis using existing methods, including but not limited to Seurat and SC3, and check against the available cell marker databases. We provide two quantification approaches to annotate cell types: gene set enrichment analysis (GSEA) and a modified Fisher’s exact test that takes statistical significance into consideration. We wrap our methods in a user-friendly R package. The package generates straightforward results including visualization of the test results across all clusters and the prediction rankings within each cluster, which help the researchers to understand the results and pick the optimal annotations. To enable users without much programming experience, we also developed an interactive shiny application with a graphical user interface (GUI) that can be launched at <ext-link xlink:href="https://biostatistics.mdanderson.org/shinyapps/EasyCellType/" ext-link-type="uri">https://biostatistics.mdanderson.org/shinyapps/EasyCellType/</ext-link>. Our tools allow annotating cells from two species (human and mouse) and around 300 organs, including common (e.g. blood and brain) and rare tissue types (e.g. umbilical vein and renal glomerulus).</p>
  </sec>
  <sec>
    <title>2 Methods</title>
    <p>A schematic pipeline of the proposal is presented in <xref rid="vbad029-F1" ref-type="fig">Figure 1</xref>. After preprocessing (e.g. normalized, filtered and dimension reduced) and clustering of the scRNA-seq data, we expect users to first extract cell-type-specific differentially expressed markers for each cluster and sort the gene lists by their differential score (e.g. log fold change). We then compare the input marker list against existing databases (details in Section 2.1 below) using a statistical test, either GSEA or a modified Fisher’s exact test (details in Section 2.2 below). We also provide two possible ways to present the results, hard clustering and soft clustering, for the best-predicted cell type (‘hard’) or a list of ranked possible cell types (‘soft’). This allows users to pick the most interpretable results when other auxiliary information is available.</p>
    <fig position="float" id="vbad029-F1">
      <label>Fig. 1.</label>
      <caption>
        <p>Schema of the package setup. scRNA-seq data are analyzed and generate set of markers with the differential expression score. Taking the clustered markers as input, user then can specify the database and tissue to run GSEA or Fisher’s exact test to annotate the group of cells. The annotation results will be presented in two ways: hard classification gives the most likely cell type for each cluster, and soft classification gives the several top possible cell types for each cluster</p>
      </caption>
      <graphic xlink:href="vbad029f1" position="float"/>
    </fig>
    <sec>
      <title>2.1 Database description</title>
      <p>We include three publicly available cell marker databases in our method: CellMarker, PanglaoDB and Clustermole. To keep consistency with the databases, we provide functions to convert gene symbols to Entrez IDs which will be used in the annotation analysis.</p>
      <p><xref rid="vbad029-B39" ref-type="bibr">Zhang <italic toggle="yes">et al.</italic> (2019b</xref>) manually reviewed 10 000 papers from PubMed related to single-cell analysis and cell marker experimental studies to build CellMarker database. The database includes 467 and 389 cell types for human and mouse, respectively. The database is freely available for download at <ext-link xlink:href="http://bio-bigdata.hrbmu.edu.cn/CellMarker/" ext-link-type="uri">http://bio-bigdata.hrbmu.edu.cn/CellMarker/</ext-link>.</p>
      <p>The PanglaoDB is a web server designed for scientists to explore published scRNA-seq experiments from mouse and human. During the integration of scRNA-seq studies, to ensure reliable biological insights, cell markers were manually collected by querying thousands of papers and search engines (<xref rid="vbad029-B11" ref-type="bibr">Franzén <italic toggle="yes">et al.</italic>, 2019</xref>). These markers consist of canonical markers and novel markers, the latter were used when canonical markers were ambiguous by examining expressed genes in the particular single-cell cluster. At the time of this publication, it includes 178 cell types both for human and mouse.</p>
      <p>Clustermole (<xref rid="vbad029-B9" ref-type="bibr">Dolgalev, 2021</xref>) is a pipeline that can process scRNA-seq data. It collects cell marker genes from seven sources: ARCHS4, CellMarker, MSigDB, PanglaoDB, SaVanT, TISSUES and xCell. We extract those genes with species information (human or mouse), resulting in 1694 cell types for human and 331 cell types for mouse.</p>
      <p><xref rid="sup1" ref-type="supplementary-material">Supplementary Figures S1 and S2</xref> present how cell types and tissues are intersected among the three databases. Database from Clustermole contains most human cell types. No big difference is found regarding the number of mouse cell types among the three databases. Compared to the other two databases, Clustermole contains some unique cell types such as Abomasum and Krt4/13+. Comparing the cell-type classification from the same tissue type, the CellMarker database generally has a more detailed classification, while PanglaoDB has a broader lineage classification.</p>
    </sec>
    <sec>
      <title>2.2 Algorithm</title>
      <p>We make use of the GSEA algorithm to facilitate the cell-type annotation task. Originally, GSEA (<xref rid="vbad029-B29" ref-type="bibr">Subramanian <italic toggle="yes">et al.</italic>, 2005</xref>) takes a set of genes sorted by their statistical importance and tests whether a priori-defined set of genes shows statistically significant associations with the phenotype. Details of the original algorithm are described in the <xref rid="sup1" ref-type="supplementary-material">Supplementary material</xref>. GSEA has been widely used in GO pathway analysis. Algorithms have been updated to facilitate other analysis procedures, such as FGSEA (<xref rid="vbad029-B17" ref-type="bibr">Korotkevich <italic toggle="yes">et al.</italic>, 2019</xref>). Besides the GSEA software, multiple packages, such as ‘fgsea’ and ‘clusterProfiler’ (<xref rid="vbad029-B36" ref-type="bibr">Wu <italic toggle="yes">et al.</italic>, 2021b</xref>) are available in R and ready for users to customize the analysis with different pathway choices. For our usage, given a list of marker genes obtained by differential expression analysis from any existing clustering software, we sort the marker genes by their expression scores (e.g. log 2 fold change). The priori-defined set of genes in GSEA methods will be replaced as the known cell-specific marker genes from the multiple marker databases. We will then compute the cell types that are significantly associated with the differentially expressed genes using the GSEA algorithm.</p>
      <p>Although we believe GSEA can be powerful in cell-type annotation, in reality, when a researcher wants to annotate clustered cells, a generally used approach is to simply check what cell types are defined by the most frequent marker genes. We see the logic of this procedure as similar to the logic of testing a contingency table: determining the group for a categorical variable based on the collected prevalence frequencies. Thus, we provide a modified version of Fisher’s exact test to reproduce the procedure described here. Fisher’s exact test is a straightforward way to assess the significance of contingency between two kinds of classifications. Extending this method, given a vector of clustered markers and a vector of labeled genes, in each cluster we examine the significance of the association between each marker and labeled genes. The estimated significance is then adjusted by Benjamini–Hochberg procedure to account for the multiple hypothesis testing. Since the vector of markers typically obtained by scRNA-seq data analysis comes with a statistical score, such as log fold change, showing expression significance, we add one more step by sorting the associations in each cluster based on the markers’ expression score, and select the tops as annotation results.</p>
      <p>We present the annotation results in two ways: hard classification and soft classification to suit different needs of the users. Hard classification gives the most significant cell type for each cluster. In contrast, soft classification gives the top five significant cell types received from the test. Hard classification may be suitable for annotating tissues that are well studied, such as blood and brain, for which comprehensive lists of cell markers are available. In these cases, the hard classification results can provide an accurate set of cell labels. Soft classification can be more feasible if the tissue of interest is from a different condition or less-commonly studied tissues, such as brain samples from autism patients. Users can choose the best interpretable cell labels from the provided lists to achieve more accurate results.</p>
    </sec>
    <sec>
      <title>2.3 Package and shiny app</title>
      <p>Our R package is freely available at Bioconductor (‘EasyCellType’) or from GitHub (<ext-link xlink:href="https://github.com/rx-li/EasyCellType" ext-link-type="uri">https://github.com/rx-li/EasyCellType</ext-link>). It is straightforward to conduct cell-type annotation using our package. The input is a data frame containing Entrez IDs of marker genes, cluster number as well as the corresponding expression score. If the input data use gene symbols, we provide a function to automatically convert the gene symbols to Entrez IDs. Users need to specify the database, species and tissue (organ) for the annotation. Among all the three databases, we set the CellMarker database for default usage based on the simulation results in Section 3.3, if the studied tissue type is available. After getting the annotation results, functions are available to create bar plots for each cluster showing candidate cell types, as well as a dot plot summarizing the top five significant annotations for each cluster.</p>
      <p>For users that are not familiar with R coding, our method has also been implemented in an interactive shiny web freely available at <ext-link xlink:href="https://biostatistics.mdanderson.org/shinyapps/EasyCellType/" ext-link-type="uri">https://biostatistics.mdanderson.org/shinyapps/EasyCellType/</ext-link>. <xref rid="vbad029-F2" ref-type="fig">Figure 2</xref> presents screenshots of the GUI from the shiny app. A brief introduction of EasyCellType can be found on the first page (<xref rid="vbad029-F2" ref-type="fig">Fig. 2A</xref>). On the second page, we provide a detailed tutorial describing how to upload files and run analysis using the application. User can find the uploading panel on the third page (<xref rid="vbad029-F2" ref-type="fig">Fig. 2B</xref>). User needs to upload a CSV file containing marker genes in gene symbols (will be converted to Entrez IDs) or Entrez IDs, cluster numbers and differential testing score (e.g. log fold change), then specify database and species, and choose tissue types for the analysis. Dot plots and bar plots will be created and presented on the right side of the screen after finishing the analysis and will be ready to be downloaded (<xref rid="vbad029-F2" ref-type="fig">Fig. 2C</xref>).</p>
      <fig position="float" id="vbad029-F2">
        <label>Fig. 2.</label>
        <caption>
          <p>Overview of the shiny application. This application was designed for users to straightforwardly launch and use the EasyCellType package. (<bold>A</bold>) The navigation bar of the application. Three pages are included in the web: introduction, tutorial and input panel. (<bold>B</bold>) Uploading page. Users would need to upload a CSV file containing marker gene, cluster information and expression score (e.g. log 2 fold change) to run the analysis. There is an ‘Example’ file that can be downloaded and referred to. Database and species can be specified according to the file. Users can choose tissue (organ) type and test used for the annotation. If the user chooses to use GSEA for the analysis, the <italic toggle="yes">P</italic>-value and score type can also be specified. (<bold>C</bold>) The output of the application. After finishing the analysis, dot plots and bar plots will be created, and ready to be downloaded</p>
        </caption>
        <graphic xlink:href="vbad029f2" position="float"/>
      </fig>
    </sec>
  </sec>
  <sec>
    <title>3 Simulation study</title>
    <p>To evaluate the annotation accuracy of the proposed methods, we design a series of simulation studies using the peripheral blood mononuclear cells (PBMC) data sequenced by the 10X platform (<xref rid="vbad029-B42" ref-type="bibr">Zheng <italic toggle="yes">et al.</italic>, 2017</xref>). This dataset contains 32 738 genes from eight cell types: B cells, CD14 monocytes, CD56 NK cells, CD4 T helper cells, memory T cells, naive cytotoxic T cells, naive T cells and regulatory T cells. We randomly draw cells from the original scRNA-seq dataset to obtain the simulation data consisting of all eight cell types. The total number of cells is fixed at 1600, 2400 or 4000.</p>
    <p>We convert gene symbols to Enterz IDs for the identified differential cluster-specific markers. We use CellMarker database as the default marker database, while more comparison results using different databases are discussed in Section 3.3. Tissue types containing keyword ‘blood’ are chosen as the organ in the database, including blood, peripheral blood, blood vessel, umbilical cord blood and venous blood. We then perform the GSEA and the modified version of Fisher’s exact test to annotate the cells. We check the annotation for each cell to calculate the accuracy. If a cell is same as the annotation for the cluster that it belongs to, we will say that the cell is annotated correctly. Specifically for soft classification, if any of the proposed labels are correct, we will say that the method annotates the cell correctly. The accuracy is defined as the number of cells with correct annotation divided by the number of total cells. For each combination of simulation settings, the presented results are summarized over 100 Monte Carlo simulation iterations.</p>
    <sec>
      <title>3.1 Comparison with existing annotation tools</title>
      <p>We compare our methods with unsupervised annotation tools, CellAssign, scCATCH, SCINA and SCSA through a series of simulations with a different number of cells. The results are presented in <xref rid="vbad029-F3" ref-type="fig">Figure 3</xref>. For the proposed method, we use Seurat for clustering and identifying differentially expressed genes. For scCATCH, we use its default marker genes database. Tissue types are chosen as ‘blood related’ which is suggested on its website (<ext-link xlink:href="https://github.com/ZJUFanLab/scCATCH/wiki/human_tissues" ext-link-type="uri">https://github.com/ZJUFanLab/scCATCH/wiki/human_tissues</ext-link>): blood, peripheral blood, plasma, serum, umbilical cord blood and venous blood. Both SCINA and CellAssign require an input of gene signatures to annotate the query dataset. Users need to know what cells are potentially included in the query dataset and have some biological background about the cell-expressed genes. The two methods provide several gene lists, and we combine them and search through existing studies about marker genes to make our gene lists for annotation. We check the annotation per cell to calculate the accuracy.</p>
      <fig position="float" id="vbad029-F3">
        <label>Fig. 3.</label>
        <caption>
          <p>Accuracy of cell-type annotation under different cell number settings using the proposed method, CellAssign, scCATCH, SCINA and SCSA. ‘hard_enrich’ means that we use GSEA approach and hard classification. The same patterns are followed by other notations on the X-axis. (<bold>A</bold>) Sample datasets contained 1600 PBMCs. (<bold>B</bold>) Sample datasets contained 2400 PBMCs. (<bold>C</bold>) Sample datasets contained 4000 PBMCs. (<bold>D</bold>) The annotation accuracy of soft classifications using GSEA and fisher approaches with two, three and five cell-type predictions</p>
        </caption>
        <graphic xlink:href="vbad029f3" position="float"/>
      </fig>
      <p>In <xref rid="vbad029-F3" ref-type="fig">Figure 3</xref>, ‘Hard_enrich’, ‘soft_enrich’, ‘hard_fisher’ and ‘soft_fisher’ correspond to the method using the GSEA approach with hard classification, GSEA approach with soft classification, Fisher’s exact test approach with hard classification and Fisher’s exact test approach with soft classification.</p>
      <p>Overall, the hard fisher classifier has similar performance as scCATCH, CellAssign, SCINA and SCSA. During our exploration, we find that SCSA focuses more on major lineage (e.g. T cell). Our dataset contains more sub-cell-type information (e.g. CD4 T helper cells, memory T cells, native cytotoxic T cells, naïve T cells and regulatory T cells) and SCSA cannot distinguish them well. As the cell number increases, the performance also becomes better. The accuracy of hard enrich is higher than that of CellAssign and SCINA. It is also higher than the results using SCSA and scCATCH when the query dataset contains 2400 and 1600 cells. When the cell number increases to 4000, the hard enrich classifier outperforms the other four annotation tools. Moreover, we compare the positive predictive values of the proposed hard classifiers and the four tools and present the results in <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S3</xref>. The precision values are not stable for different cell types. For example, most of the methods are good at identifying cytotoxic T cells and monocytes. Only scCATCH and hard enrich can identify regulatory T cells. CellAssign and hard-fisher demonstrate large variances of PPVs in identifying memory T cells, while other methods failed to identify this cell type.</p>
      <p>For CellAssign, scCATCH and SCINA, the annotation accuracy can also be influenced by the choices of gene signatures. We performed additional simulation studies by extracting marker gene information from the CellMarker database, and using it as signature genes when applying scCATCH, CellAssign and SCINA. The markers are from the human species and blood-related tissues. <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S4</xref> shows the application results over 20 Monte Carlo simulations. Our proposed methods demonstrate comparable or better results than existing methods. ScCATCH has the best performance among all the existing tools.</p>
      <p>To precisely evaluate the results from soft classification, we include a separate figure with the results by soft classifications in <xref rid="vbad029-F3" ref-type="fig">Figure 3D</xref>. We consider the top two, three and five cell-type predictions in this evaluation. Overall, the GSEA method outperforms the Fisher’s exact test methods. It should be noted that the false positives exist when using the soft classification, as it reports the top several cell types for each cluster.</p>
      <p>In addition, we also compare our methods with supervised annotation tools, Garnett (<xref rid="vbad029-B26" ref-type="bibr">Pliner <italic toggle="yes">et al.</italic>, 2019</xref>), scPred (<xref rid="vbad029-B2" ref-type="bibr">Alquicira-Hernandez <italic toggle="yes">et al.</italic>, 2019</xref>) and SingleR (<xref rid="vbad029-B4" ref-type="bibr">Aran <italic toggle="yes">et al.</italic>, 2019</xref>) through a series of simulations with a different number of cells. The results are presented in <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S5</xref>. For Garnett, we use a pre-trained classifier for PBMCs provided on its website. For scPred, we follow the tool instruction to train a classifier using 3500 cells sampled from our PBMCs dataset. For SingleR, we use the default reference ‘HumanPrimaryCellAtlasData’ provided by its package. We apply the three methods on datasets with a different number of cells. We check the annotation per cell to calculate the accuracy.</p>
      <p>Garnett outputs two different types of annotation: one is annotated for each cell (‘Garnett-cell type’), and the other is annotated for a cluster (‘Garnett–cluster type’). scPred also provides two different annotations for users: one is annotated cell type (‘ScPred-prediction’), and the other is the cell type that cannot be rejected (‘ScPred-no rejection’). We include all of those different annotations to make the comparison fair. The accuracy is steady on datasets with different numbers of cells, although the supervised methods can perform a litter better when the number of cells increases. The supervised methods, except for Garnett and SingleR, generally have better performances than our hard classifiers, but comparable to or worse than our soft classifiers. Overall, our methods can provide users with helpful cell-type information if the supervised methods cannot be applied.</p>
    </sec>
    <sec>
      <title>3.2 Impacts of different sample sizes</title>
      <p>We conduct additional simulations to investigate how the proposed method can be impacted by different settings. First of all, we investigate impacts from difference sample sizes and clustering softwares. We sample datasets with a different number of cells. We select two unsupervised algorithms to cluster the data, Seurat (<xref rid="vbad029-B28" ref-type="bibr">Satija <italic toggle="yes">et al.</italic>, 2015</xref>) and SC3 (<xref rid="vbad029-B16" ref-type="bibr">Kiselev <italic toggle="yes">et al.</italic>, 2017</xref>). Both methods have been widely used to cluster cells from scRNA-seq data in previous studies (<xref rid="vbad029-B6" ref-type="bibr">Butler <italic toggle="yes">et al.</italic>, 2018</xref>, <xref rid="vbad029-B41" ref-type="bibr">Zhao <italic toggle="yes">et al.</italic>, 2020</xref>). SC3 adapts a consensus-based clustering while Seurat uses community-based cluster detection. As a result, Seurat is more computationally efficient than SC3. However, Seurat does not allow the specification of the cluster number as SC3 does. For SC3, we specify the number of clusters to be 8, the same as that in the original data. For Seurat, we fix the clustering precision parameter as 1. After obtaining the clustering labels, we identify the differentially expressed markers for each cluster by setting different log fold change thresholds in Seurat and different area under the ROC curve (AUROC) thresholds in SC3.</p>
      <p>The accuracy of annotation with different numbers of cells used in the analysis is showed in <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S6A and B</xref>. <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S6A</xref> uses SC3 for clustering while <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S6B</xref> uses Seurat.</p>
      <p>First, we observe that soft classification has higher accuracy than hard classification in all the results. This is expected since soft classification generates more labels to compare with the true labels than hard classification. Second, although the soft classification using Fisher’s exact test has slightly higher accuracy compared with GSEA in <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S6A</xref>, overall we find the GSEA method achieves comparable or better performance for both soft and hard classification. Third, the increase of cell numbers improves the annotation accuracy for both panels A and B, but the improvement is quite small no matter which annotation approach we use or what the sample size is. This suggests that the proposal is reliable even with a small dataset of fewer than 2000 cells in total and eight cell types. Lastly, we do not observe significant improvement in the annotation accuracy when the correct number of clusters is specified using SC3. It is possible that the correct specification of cluster number does not solve the difficulty of annotating a few highly correlated cell types, and thus SC3 does not provide a significant advantage over Seurat in the current settings.</p>
    </sec>
    <sec>
      <title>3.3 Impact of different cutoffs</title>
      <p>Different cutoffs can be selected when identifying the cell-type-specific differential genes. Choosing a loose or stringent cutoff will result in a longer or shorter differential marker lists. We ask how these cutoffs can impact the annotation accuracy. In the experiments of this section, we fixed the number of cells as 2400 in all scenarios. <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S6C and D</xref> presents the accuracy of cell-type annotation under different cutoffs for AUROC and log fold change using marker genes found by SC3 and Seurat, respectively.</p>
      <p>We find that overall the modified Fisher’s exact test with soft classification has the most stable performance with different levels of cutoff. Improvements of the annotation accuracy are observed when decreasing the cutoffs for log fold change or AUROC, especially when GSEA is selected. In <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S6D</xref>, When the log2 fold change threshold is too conservative (0.5), fewer genes are detected and the accuracy of the annotations is low. When the log2 fold change decreases, the accuracy will increase but the increase will stop at a certain length. We believe the annotation result is sufficiently good when FDR is 0.15. If the length of the marker gene list is too short, we suggest that the users may consider including more samples or merging a few similar clusters to obtain longer marker lists. Further examinations are also needed to confirm the validity of the annotations. Overall, a looser criterion will result in better accuracy.</p>
      <p>The cell-type-specific markers are identified for each cell type by comparing it versus all the other cell types. We have tried several simulations using different tests when finding the DE genes with Seurat: DESeq2, Wilcoxon and <italic toggle="yes">t</italic>-test. The accuracy of annotation results is shown in <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S7</xref>. Overall, we suggest not to choose <italic toggle="yes">t</italic>-test when detecting DE genes. We also observe that the GSEA method works better with DESeq2. When the number of cells is less, Fisher’s exact test also favors DESeq2 a little.</p>
    </sec>
    <sec>
      <title>3.4 Impact of different databases</title>
      <p>The accuracy results using different databases are presented in <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S8</xref>. We draw 2400 PBMCs and annotate them using the three databases separately. When database from clustermole was chosen, we specified tissue types as blood, blood vessel and immune system. When PanglaoDB was chosen, we specified tissue types as immune system. After filtering, CellMarker had the most marker genes which is over 3000, while PanglaoDB had the fewest marker genes which are around 1000. We find that overall CellMarker database achieves the highest annotation accuracy, especially when GSEA is chosen. Probably due to the limited number of maker genes, using PanglaoDB results in the lowest accuracies for both GSEA and the modified Fisher’s exact test.</p>
      <p>Additionally, our simulation results demonstrate the importance of specifying tissue type, as specifying tissue type can greatly improve the outcome accuracy compared to the analysis without such specification (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S9</xref>). In summary, our method can provide accurate information for researchers to assign annotation for scRNA-seq data.</p>
    </sec>
  </sec>
  <sec>
    <title>4 Real-data analysis</title>
    <sec>
      <title>4.1 Application on autism spectrum disorder data</title>
      <p>Autism spectrum disorder (ASD) refers to a neurological and developmental disorder including a variety of disabilities in learning, communication and other social behaviors. Gene expression studies have revealed the changes in the neocortex of autism patients. We obtain an ASD dataset from a study that uses scRNA-seq to identify autism-associated transcriptomic changes in specific cell types (<xref rid="vbad029-B34" ref-type="bibr">Velmeshev <italic toggle="yes">et al.</italic>, 2019</xref>). According to the original publication, tissue samples were collected from 15 ASD patients and 16 controls that are matched on age, sex, RNA integrity number and postmortem interval. After preprocessing with the 10X Genomics CellRanger platform, unbiased clustering of nuclear profiles from ASD and control samples was performed using the expression data. The clusters were then annotated according to the expression of known cell-type markers by the authors. The dataset is publicly available on the UCSC Cell Browser at <ext-link xlink:href="https://cells.ucsc.edu/?ds=autism" ext-link-type="uri">https://cells.ucsc.edu/?ds=autism</ext-link>. It contains 104 559 cells from 11 neuronal and 6 glial cell types, including subtypes of excitatory neurons and interneurons, the main types of glial cells and brain endothelial cells. Since our purpose is to evaluate the marker-based annotation using the proposed method, we use the clustering assignment from the original data and generate the cluster-specific differential markers using Seurat. We set the cutoff of log fold change to be 0.25 when identifying expressed markers. Finally, around 460 marker genes are detected for each cluster.</p>
      <p>We use the CellMarker database for the annotation analysis. Tissues that are containing keyword ‘brain’ are selected, which are brain, embryonic brain, midbrain and fetal brain. We remove cells which belong to IN-VIP, IN-SV2C, IN-PV or IN-SST, because these four cell types are not included in the CellMarker database, and we have difficulty identifying similar terms. <xref rid="vbad029-F4" ref-type="fig">Figure 4</xref> presents the annotation results from applying the GSEA approach.</p>
      <fig position="float" id="vbad029-F4">
        <label>Fig. 4.</label>
        <caption>
          <p>Results of cell-type annotation using GSEA approach for the ASD scRNA-seq data. (<bold>A</bold>) TSNE plot showing the true cell type for each cluster. (<bold>B</bold>) TSNE plot showing the predicted cell type for each cluster. (<bold>C</bold>) Dot plot showing the possible cell types for each cluster. X-axis shows the clusters we have, and Y-axis shows the candidate cell types. In each cluster, the significance of candidate cell type is presented by the size of the corresponding dot: the most significant cell type has the largest dot. Correct annotations are noted in the rectangle. (<bold>D</bold>) An example bar plot showing the possible cell types for cluster ‘Oligodendrocyte’. The cell type identified by hard classification is colored in dark green. Cell types in light green are identified by soft classification. Cell types from most significant to least significant are presented by the length of the bar</p>
        </caption>
        <graphic xlink:href="vbad029f4" position="float"/>
      </fig>
      <p><xref rid="vbad029-F4" ref-type="fig">Figure 4A</xref> shows the true cluster labels for all the cells. <xref rid="vbad029-F4" ref-type="fig">Figure 4B</xref> demonstrates the most possible cell-type assignment using our package. Comparing the two figures, we see that clusters ‘ASR-FB’, ‘AST-PP’, ‘Endothelial’, ‘Microglia’, ‘Oligodendrocytes’ and ‘OPC’ in the original ASD dataset are correctly annotated. For the other clusters, the candidate cell types are among Excitatory neurons and Inhibitory neurons, which are the subtypes of neurons. These cell types are consistent with the true labels from the original study.</p>
      <p><xref rid="vbad029-F4" ref-type="fig">Figure 4C</xref> summarizes the annotation results using the proposed method. The X-axis shows the clusters we have, and the Y-axis shows the candidate cell types. We present the top five significant cell types in each cluster. The significance of candidate cell types is presented by the size of the corresponding dot. The most significant cell type has the largest dot. We highlight cell labels that are consistent with the true cluster label using red rectangles. Although in several clusters, such as L4 and L2/3, the most significant cell does not match the true label, consistent cell types are still identified with less significance. In addition to the dot plot, for each cluster, we also generate a bar plot with up to 10 candidate cell types, and an example is given in <xref rid="vbad029-F4" ref-type="fig">Figure 4D</xref>. This bar plot shows the candidate cell types for cluster Oligodendrocyte. The significance of candidate cell types is represented by the length of the bar. We see that within this cluster the most significant cell type identified is Oligodendrocyte, followed by Astrocyte, Oligodendrocyte precursor cell and Neuron. In summary, our method accurately identifies the cell types for most of the clusters and provides related cell types for the other clusters.</p>
    </sec>
    <sec>
      <title>4.2 Application on triple-negative breast cancer data</title>
      <p>Lastly, we demonstrate the usage of our method in annotating a triple-negative breast cancer (TNBC) scRNA-seq dataset (<xref rid="vbad029-B35" ref-type="bibr">Wu <italic toggle="yes">et al.</italic>, 2021a</xref>). According to the original study, the authors performed scRNA-seq (Chromium, 10X Genomics) on their samples, and clusters were annotated by canonical lineage markers. The authors then checked the annotation using published gene signatures to confirm its reliability. This dataset contains 10 836 tumor cells and 31 676 normal cells, including B cells, cancer-associated fibroblasts (CAFs), cancer epithelial, endothelial, myeloid, normal epithelial, plasmablasts, periventricular leukomalacia (PVL) and T cells.</p>
      <p>For cancer-associated scRNA-seq studies, researchers usually separate the cancer cells from non-malignant cells before further annotation with existing tools, such as CopyKAT and inferCNV (<xref rid="vbad029-B10" ref-type="bibr">Durante <italic toggle="yes">et al.</italic>, 2020</xref>, <xref rid="vbad029-B13" ref-type="bibr">Gao <italic toggle="yes">et al.</italic>, 2021</xref>). Thus, we remove tumor cells from our dataset and conduct annotation on the normal cells only.</p>
      <p>We applied three annotation tools on the dataset: The proposed method, SingleR and scCATCH. SingleR uses a rank-based correlation as a similarity metric. Our method also makes use of ranking information, and we would like to see if rank ordering of marker genes can help on the annotation when data are of a different phenotype compared to the reference. For the proposed method, we follow the analysis workflow as we did on ASD dataset in Section 4.1. We use Seurat for dimension reduction and the cluster assignment from the original paper as the cluster results. We identify the differentially expressed marker genes in each cluster. The cutoff for log fold change is still set to 0.25. Tissue types are specified as blood immune and breast related. Finally, around 700 marker genes are detected for each cluster. For SingleR, we use its built-in reference ‘HumanPrimaryCellAtlasData’. For scCATCH, tissue types are specified as blood and breast related.</p>
      <p>The annotation results for each cluster are presented in <xref rid="vbad029-F5" ref-type="fig">Figure 5</xref>, where correct annotations are highlighted in red circles. For PVL cells, according to NCBI, perivascular cells include mainly vascular smooth muscle cells (SMCs) and pericytes. CAFs, T cell, PVL, epithelial and endothelial cells are annotated correctly by our method. For myeloid, a previous study (<xref rid="vbad029-B5" ref-type="bibr">Bailey <italic toggle="yes">et al.</italic>, 2006</xref>) showed that endothelial cells are a component of differentiation of myeloid lineage. Our method might be limited when identifying the differentiation cells from a lineage. We observe that our method and SingleR performed slightly better compared to scCATCH, although SingleR generates cell types for each cell, resulting in impure annotations within the clusters.</p>
      <fig position="float" id="vbad029-F5">
        <label>Fig. 5.</label>
        <caption>
          <p>Results of cell-type annotation for the TNBC scRNA-seq data using different annotation tools. (<bold>A</bold>) True labels for each cluster. (<bold>B</bold>) Annotation results for each cluster using our proposed method. (<bold>C</bold>) Annotation results for each cluster using SingleR. (<bold>D</bold>) Annotation results for each cluster using scCATCH</p>
        </caption>
        <graphic xlink:href="vbad029f5" position="float"/>
      </fig>
    </sec>
  </sec>
  <sec>
    <title>5 Discussion</title>
    <p>In this work, we develop a computational method to automatically examine the existing cell marker databases and annotate the cell-type labels with the marker information in a statistically rigorous way. As a crucial step in scRNA-seq analysis, many methods have been developed for annotating cells using supervised and unsupervised approaches. A recent comprehensive review of these annotating tools showed that, if matched training data are available, supervised methods generally achieve the highest accuracy for cell label assignment (<xref rid="vbad029-B30" ref-type="bibr">Sun <italic toggle="yes">et al.</italic>, 2022</xref>). In this work, it is not our intention to outperform the supervised annotation methods but to provide a relatively accurate alternative for researchers to annotate cells when matched training data are not available and supervised methods cannot be directly applied. Additionally, when tissues from a novel condition (e.g. from diseased patients) are of interest, cluster-specific marker-based investigation is often conducted for a preliminary understanding of the tissue samples. This step can be challenging for researchers who are not biologically knowledgeable or lack domain expertise. Our method with three databases implemented will be a particularly helpful tool in these scenarios. Our implementations provide a graphical illustration of the annotated results including both dot plot summarization across all the clusters and the cluster-specific results with ranked bar plots. For users with R coding experiences, they can directly use our R/Bioconductor package, while for users with less coding experience, we recommend our shiny app with user-friendly graphical interface. We believe that the EasyCellType implementation can reduce the burden of annotating scRNA-seq data and provide useful guidance to achieve the most interpretable results.</p>
    <p>Our method may be limited under certain situations. When one or several clusters contain mixed cell types, the annotation becomes harder as the cluster-specific markers will be mixtures from multiple cell types. In our simulation study, we find that some clusters contain multiple cell types. As the accuracy is computed per cell, these mixture clusters tend to have lower accuracy compared to other clusters. We acknowledge that this is a challenge shared by most of the annotation methods. Additionally, for the situation where cells are obtained from continuous cell differentiation, we believe that the clustering analysis and our proposed method may not fit well. Trajectory-based analyses such as Monocle (<xref rid="vbad029-B33" ref-type="bibr">Trapnell <italic toggle="yes">et al.</italic>, 2014</xref>) and TSCAN (<xref rid="vbad029-B14" ref-type="bibr">Ji and Ji, 2016</xref>) are better choices.</p>
    <p>Lastly, we acknowledge that more databases are still under development and we plan to update our tool as they become available. As shown in our TNBC data application, the existing databases may not work well for specialized annotation in certain research areas such as cancer. Future work is needed to include more domain-specific knowledge to address these challenges.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>vbad029_Supplementary_Data</label>
      <media xlink:href="vbad029_supplementary_data.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgements</title>
    <p>We thank the three anonymous reviewers who provided constructive suggestions during the review process. We thank Ms Jessica Swann from MD Anderson Cancer Center for her language editing that improved the writing of the article.</p>
  </ack>
  <sec>
    <title>Funding</title>
    <p>This work was partially supported by the National Cancer Institute of the National Institute of Health [R01CA234629 to J.Z., R03CA270725 to Z.L. and J.Z.].</p>
    <p><italic toggle="yes">Conflict of Interest</italic>: none declared.</p>
  </sec>
  <sec sec-type="data-availability">
    <title>Data availability</title>
    <p>The ASD data used in this article is available through <ext-link xlink:href="https://cells.ucsc.edu/?ds=autism" ext-link-type="uri">https://cells.ucsc.edu/?ds=autism</ext-link>. The TNBC data used in the article is available through the GEO Series accession number GSE176078. The PBMC data used in the article can be downloaded in the 10X platform <ext-link xlink:href="https://www.10xgenomics.com/cn/resources/datasets?query=pbmc&amp;page=1&amp;configure%5Bfacets%5D%5B0%5D=chemistryVersionAndThroughput&amp;configure%5Bfacets%5D%5B1%5D=pipeline.version&amp;configure%5BhitsPerPage%5D=500&amp;configure%5BmaxValuesPerFacet%5D=1000" ext-link-type="uri">https://www.10xgenomics.com/cn/resources/datasets?query=pbmc&amp;page=1&amp;configure%5Bfacets%5D%5B0%5D=chemistryVersionAndThroughput&amp;configure%5Bfacets%5D%5B1%5D=pipeline.version&amp;configure%5BhitsPerPage%5D=500&amp;configure%5BmaxValuesPerFacet%5D=1000</ext-link>. We also include the necessary information in the paper.</p>
  </sec>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="vbad029-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Almet</surname><given-names>A.A.</given-names></string-name></person-group><etal>et al</etal> (<year>2021</year>) <article-title>The landscape of cell–cell communication through single-cell transcriptomics</article-title>. <source>Curr. Opin. Syst. Biol.</source><volume>26</volume>, <fpage>12</fpage>–<lpage>23</lpage>.<pub-id pub-id-type="pmid">33969247</pub-id></mixed-citation>
    </ref>
    <ref id="vbad029-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Alquicira-Hernandez</surname><given-names>J.</given-names></string-name></person-group><etal>et al</etal> (<year>2019</year>) <article-title>scPred: accurate supervised method for cell-type classification from single-cell RNA-seq data</article-title>. <source>Genome Biol.</source><volume>20</volume>, <fpage>1</fpage>–<lpage>17</lpage>.<pub-id pub-id-type="pmid">30606230</pub-id></mixed-citation>
    </ref>
    <ref id="vbad029-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Andreatta</surname><given-names>M.</given-names></string-name></person-group><etal>et al</etal> (<year>2022</year>) <article-title>scGate: marker-based purification of cell types from heterogeneous single-cell RNA-seq datasets</article-title>. <source>Bioinformatics</source><volume>38</volume>, <fpage>2642</fpage>–<lpage>2644</lpage>.<pub-id pub-id-type="pmid">35258562</pub-id></mixed-citation>
    </ref>
    <ref id="vbad029-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Aran</surname><given-names>D.</given-names></string-name></person-group><etal>et al</etal> (<year>2019</year>) <article-title>Reference-based analysis of lung single-cell sequencing reveals a transitional profibrotic macrophage</article-title>. <source>Nat. Immunol.</source><volume>20</volume>, <fpage>163</fpage>–<lpage>172</lpage>.<pub-id pub-id-type="pmid">30643263</pub-id></mixed-citation>
    </ref>
    <ref id="vbad029-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bailey</surname><given-names>A.S.</given-names></string-name></person-group><etal>et al</etal> (<year>2006</year>) <article-title>Myeloid lineage progenitors give rise to vascular endothelium</article-title>. <source>Proc. Natl. Acad. Sci. USA</source><volume>103</volume>, <fpage>13156</fpage>–<lpage>13161</lpage>.<pub-id pub-id-type="pmid">16920790</pub-id></mixed-citation>
    </ref>
    <ref id="vbad029-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Butler</surname><given-names>A.</given-names></string-name></person-group><etal>et al</etal> (<year>2018</year>) <article-title>Integrating single-cell transcriptomic data across different conditions, technologies, and species</article-title>. <source>Nat. Biotechnol.</source><volume>36</volume>, <fpage>411</fpage>–<lpage>420</lpage>.<pub-id pub-id-type="pmid">29608179</pub-id></mixed-citation>
    </ref>
    <ref id="vbad029-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Cao</surname><given-names>Y.</given-names></string-name></person-group><etal>et al</etal> (<year>2020</year>) <article-title>SCSA a cell type annotation tool for single-cell RNA-seq data</article-title>. <source>Front. Genet.</source><volume>11</volume>, <fpage>490</fpage>.<pub-id pub-id-type="pmid">32477414</pub-id></mixed-citation>
    </ref>
    <ref id="vbad029-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Chazarra-Gil</surname><given-names>R.</given-names></string-name></person-group><etal>et al</etal> (<year>2021</year>) <article-title>Flexible comparison of batch correction methods for single-cell RNA-seq using batchbench</article-title>. <source>Nucleic Acids Res.</source><volume>49</volume>, <fpage>e42</fpage>.<pub-id pub-id-type="pmid">33524142</pub-id></mixed-citation>
    </ref>
    <ref id="vbad029-B9">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Dolgalev</surname><given-names>I.</given-names></string-name></person-group> (<year>2021</year>) clustermole: unbiased single-cell transcriptomic data cell type identification.</mixed-citation>
    </ref>
    <ref id="vbad029-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Durante</surname><given-names>M.A.</given-names></string-name></person-group><etal>et al</etal> (<year>2020</year>) <article-title>Single-cell analysis reveals new evolutionary complexity in uveal melanoma</article-title>. <source>Nat. Commun.</source><volume>11</volume>, <fpage>1</fpage>–<lpage>10</lpage>.<pub-id pub-id-type="pmid">31911652</pub-id></mixed-citation>
    </ref>
    <ref id="vbad029-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Franzén</surname><given-names>O.</given-names></string-name></person-group><etal>et al</etal> (<year>2019</year>) <article-title>PanglaoDB: a web server for exploration of mouse and human single-cell RNA sequencing data</article-title>. <source>Database</source><volume>2019</volume>, <fpage>baz046</fpage>.<pub-id pub-id-type="pmid">30951143</pub-id></mixed-citation>
    </ref>
    <ref id="vbad029-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Frieda</surname><given-names>K.L.</given-names></string-name></person-group><etal>et al</etal> (<year>2017</year>) <article-title>Synthetic recording and in situ readout of lineage information in single cells</article-title>. <source>Nature</source><volume>541</volume>, <fpage>107</fpage>–<lpage>111</lpage>.<pub-id pub-id-type="pmid">27869821</pub-id></mixed-citation>
    </ref>
    <ref id="vbad029-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gao</surname><given-names>R.</given-names></string-name></person-group><etal>et al</etal> (<year>2021</year>) <article-title>Delineating copy number and clonal substructure in human tumors from single-cell transcriptomes</article-title>. <source>Nat. Biotechnol.</source><volume>39</volume>, <fpage>599</fpage>–<lpage>608</lpage>.<pub-id pub-id-type="pmid">33462507</pub-id></mixed-citation>
    </ref>
    <ref id="vbad029-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ji</surname><given-names>Z.</given-names></string-name>, <string-name><surname>Ji</surname><given-names>H.</given-names></string-name></person-group> (<year>2016</year>) <article-title>TSCAN: pseudo-time reconstruction and evaluation in single-cell RNA-seq analysis</article-title>. <source>Nucleic Acids Res.</source><volume>44</volume>, <fpage>e117</fpage>.<pub-id pub-id-type="pmid">27179027</pub-id></mixed-citation>
    </ref>
    <ref id="vbad029-B15">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Kaminow</surname><given-names>B.</given-names></string-name></person-group><etal>et al</etal> (<year>2021</year>) STARsolo: accurate, fast and versatile mapping/quantification of single-cell and single-nucleus RNA-seq data. biorxiv, <fpage>2021</fpage>–<lpage>05</lpage>.</mixed-citation>
    </ref>
    <ref id="vbad029-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kiselev</surname><given-names>V.Y.</given-names></string-name></person-group><etal>et al</etal> (<year>2017</year>) <article-title>SC3: consensus clustering of single-cell RNA-seq data</article-title>. <source>Nat. Methods</source><volume>14</volume>, <fpage>483</fpage>–<lpage>486</lpage>.<pub-id pub-id-type="pmid">28346451</pub-id></mixed-citation>
    </ref>
    <ref id="vbad029-B17">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Korotkevich</surname><given-names>G.</given-names></string-name></person-group><etal>et al</etal> (<year>2019</year>) Fast gene set enrichment analysis. biorXiv, 060012.</mixed-citation>
    </ref>
    <ref id="vbad029-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kumar</surname><given-names>M.P.</given-names></string-name></person-group><etal>et al</etal> (<year>2018</year>) <article-title>Analysis of single-cell RNA-seq identifies cell-cell communication associated with tumor characteristics</article-title>. <source>Cell Rep.</source><volume>25</volume>, <fpage>1458</fpage>–<lpage>1468.e4</lpage>.<pub-id pub-id-type="pmid">30404002</pub-id></mixed-citation>
    </ref>
    <ref id="vbad029-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lawson</surname><given-names>D.A.</given-names></string-name></person-group><etal>et al</etal> (<year>2015</year>) <article-title>Single-cell analysis reveals a stem-cell program in human metastatic breast cancer cells</article-title>. <source>Nature</source><volume>526</volume>, <fpage>131</fpage>–<lpage>135</lpage>.<pub-id pub-id-type="pmid">26416748</pub-id></mixed-citation>
    </ref>
    <ref id="vbad029-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lee</surname><given-names>C.-M.</given-names></string-name></person-group><etal>et al</etal> (<year>2020</year>) <article-title>Single-cell RNA-seq analysis revealed long-lasting adverse effects of tamoxifen on neurogenesis in prenatal and adult brains</article-title>. <source>Proc. Natl. Acad. Sci. USA</source><volume>117</volume>, <fpage>19578</fpage>–<lpage>19589</lpage>.<pub-id pub-id-type="pmid">32727894</pub-id></mixed-citation>
    </ref>
    <ref id="vbad029-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Li</surname><given-names>M.</given-names></string-name></person-group><etal>et al</etal> (<year>2020</year>) <article-title>The SARS-CoV-2 receptor ACE2 expression of maternal-fetal interface and fetal organs by single-cell transcriptome study</article-title>. <source>PLoS One</source><volume>15</volume>, <fpage>e0230295</fpage>.<pub-id pub-id-type="pmid">32298273</pub-id></mixed-citation>
    </ref>
    <ref id="vbad029-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lim</surname><given-names>B.</given-names></string-name></person-group><etal>et al</etal> (<year>2020</year>) <article-title>Advancing cancer research and medicine with single-cell genomics</article-title>. <source>Cancer Cell</source><volume>37</volume>, <fpage>456</fpage>–<lpage>470</lpage>.<pub-id pub-id-type="pmid">32289270</pub-id></mixed-citation>
    </ref>
    <ref id="vbad029-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lin</surname><given-names>Y.</given-names></string-name></person-group><etal>et al</etal> (<year>2020</year>) <article-title>scClassify: sample size estimation and multiscale classification of cells using single and multiple reference</article-title>. <source>Mol. Syst. Biol.</source><volume>16</volume>, <fpage>e9389</fpage>.<pub-id pub-id-type="pmid">32567229</pub-id></mixed-citation>
    </ref>
    <ref id="vbad029-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ma</surname><given-names>F.</given-names></string-name>, <string-name><surname>Pellegrini</surname><given-names>M.</given-names></string-name></person-group> (<year>2020</year>) <article-title>ACTINN: automated identification of cell types in single cell RNA sequencing</article-title>. <source>Bioinformatics</source><volume>36</volume>, <fpage>533</fpage>–<lpage>538</lpage>.<pub-id pub-id-type="pmid">31359028</pub-id></mixed-citation>
    </ref>
    <ref id="vbad029-B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mathys</surname><given-names>H.</given-names></string-name></person-group><etal>et al</etal> (<year>2019</year>) <article-title>Single-cell transcriptomic analysis of Alzheimer’s disease</article-title>. <source>Nature</source><volume>570</volume>, <fpage>332</fpage>–<lpage>337</lpage>.<pub-id pub-id-type="pmid">31042697</pub-id></mixed-citation>
    </ref>
    <ref id="vbad029-B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pliner</surname><given-names>H.A.</given-names></string-name></person-group><etal>et al</etal> (<year>2019</year>) <article-title>Supervised classification enables rapid annotation of cell atlases</article-title>. <source>Nat. Methods</source><volume>16</volume>, <fpage>983</fpage>–<lpage>986</lpage>.<pub-id pub-id-type="pmid">31501545</pub-id></mixed-citation>
    </ref>
    <ref id="vbad029-B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Potter</surname><given-names>S.S.</given-names></string-name></person-group> (<year>2018</year>) <article-title>Single-cell RNA sequencing for the study of development, physiology and disease</article-title>. <source>Nat. Rev. Nephrol.</source><volume>14</volume>, <fpage>479</fpage>–<lpage>492</lpage>.<pub-id pub-id-type="pmid">29789704</pub-id></mixed-citation>
    </ref>
    <ref id="vbad029-B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Satija</surname><given-names>R.</given-names></string-name></person-group><etal>et al</etal> (<year>2015</year>) <article-title>Spatial reconstruction of single-cell gene expression data</article-title>. <source>Nat. Biotechnol.</source><volume>33</volume>, <fpage>495</fpage>–<lpage>502</lpage>.<pub-id pub-id-type="pmid">25867923</pub-id></mixed-citation>
    </ref>
    <ref id="vbad029-B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Subramanian</surname><given-names>A.</given-names></string-name></person-group><etal>et al</etal> (<year>2005</year>) <article-title>Gene set enrichment analysis: a knowledge-based approach for interpreting genome-wide expression profiles</article-title>. <source>Proc. Natl. Acad. Sci. USA</source><volume>102</volume>, <fpage>15545</fpage>–<lpage>15550</lpage>.<pub-id pub-id-type="pmid">16199517</pub-id></mixed-citation>
    </ref>
    <ref id="vbad029-B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sun</surname><given-names>X.</given-names></string-name></person-group><etal>et al</etal> (<year>2022</year>) <article-title>A comprehensive comparison of supervised and unsupervised methods for cell type identification in single-cell RNA-seq</article-title>. <source>Brief. Bioinform.</source><volume>23</volume>, <fpage>bbab567</fpage>.<pub-id pub-id-type="pmid">35021202</pub-id></mixed-citation>
    </ref>
    <ref id="vbad029-B31">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tang</surname><given-names>F.</given-names></string-name></person-group><etal>et al</etal> (<year>2009</year>) <article-title>mRNA-seq whole-transcriptome analysis of a single cell</article-title>. <source>Nat. Methods</source><volume>6</volume>, <fpage>377</fpage>–<lpage>382</lpage>.<pub-id pub-id-type="pmid">19349980</pub-id></mixed-citation>
    </ref>
    <ref id="vbad029-B32">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Tran</surname><given-names>M.-H.</given-names></string-name></person-group> (<year>2022</year>) scRNA-seq cell type annotation: common approaches and tools.</mixed-citation>
    </ref>
    <ref id="vbad029-B33">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Trapnell</surname><given-names>C.</given-names></string-name></person-group><etal>et al</etal> (<year>2014</year>) <article-title>The dynamics and regulators of cell fate decisions are revealed by pseudotemporal ordering of single cells</article-title>. <source>Nat. Biotechnol.</source><volume>32</volume>, <fpage>381</fpage>–<lpage>386</lpage>.<pub-id pub-id-type="pmid">24658644</pub-id></mixed-citation>
    </ref>
    <ref id="vbad029-B34">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Velmeshev</surname><given-names>D.</given-names></string-name></person-group><etal>et al</etal> (<year>2019</year>) <article-title>Single-cell genomics identifies cell type-specific molecular changes in autism</article-title>. <source>Science</source><volume>364</volume>, <fpage>685</fpage>–<lpage>689</lpage>.<pub-id pub-id-type="pmid">31097668</pub-id></mixed-citation>
    </ref>
    <ref id="vbad029-B35">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wu</surname><given-names>S.Z.</given-names></string-name></person-group><etal>et al</etal> (<year>2021a</year>) <article-title>A single-cell and spatially resolved atlas of human breast cancers</article-title>. <source>Nat. Genet.</source><volume>53</volume>, <fpage>1334</fpage>–<lpage>1347</lpage>.<pub-id pub-id-type="pmid">34493872</pub-id></mixed-citation>
    </ref>
    <ref id="vbad029-B36">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wu</surname><given-names>T.</given-names></string-name></person-group><etal>et al</etal> (<year>2021b</year>) <article-title>clusterProfiler 4.0: a universal enrichment tool for interpreting omics data</article-title>. <source>Innovation (Camb.)</source><volume>2</volume>, <fpage>100141</fpage>.<pub-id pub-id-type="pmid">34557778</pub-id></mixed-citation>
    </ref>
    <ref id="vbad029-B37">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Xu</surname><given-names>Y.</given-names></string-name></person-group><etal>et al</etal> (<year>2022</year>) <article-title>MACA: marker-based automatic cell-type annotation for single-cell expression data</article-title>. <source>Bioinformatics</source><volume>38</volume>, <fpage>1756</fpage>–<lpage>1760</lpage>.<pub-id pub-id-type="pmid">34935911</pub-id></mixed-citation>
    </ref>
    <ref id="vbad029-B38">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhang</surname><given-names>A.W.</given-names></string-name></person-group><etal>et al</etal> (<year>2019a</year>) <article-title>Probabilistic cell-type assignment of single-cell RNA-seq for tumor microenvironment profiling</article-title>. <source>Nat. Methods</source><volume>16</volume>, <fpage>1007</fpage>–<lpage>1015</lpage>.<pub-id pub-id-type="pmid">31501550</pub-id></mixed-citation>
    </ref>
    <ref id="vbad029-B39">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhang</surname><given-names>X.</given-names></string-name></person-group><etal>et al</etal> (<year>2019b</year>) <article-title>CellMarker: a manually curated resource of cell markers in human and mouse</article-title>. <source>Nucleic Acids Res.</source><volume>47</volume>, <fpage>D721</fpage>–<lpage>D728</lpage>.<pub-id pub-id-type="pmid">30289549</pub-id></mixed-citation>
    </ref>
    <ref id="vbad029-B40">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhang</surname><given-names>Z.</given-names></string-name></person-group><etal>et al</etal> (<year>2019c</year>) <article-title>SCINA: a semi-supervised subtyping algorithm of single cells and bulk samples</article-title>. <source>Genes</source><volume>10</volume>, <fpage>531</fpage>.<pub-id pub-id-type="pmid">31336988</pub-id></mixed-citation>
    </ref>
    <ref id="vbad029-B41">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhao</surname><given-names>Y.</given-names></string-name></person-group><etal>et al</etal> (<year>2020</year>) <article-title>Single-cell RNA expression profiling of ACE2, the receptor of SARS-CoV-2</article-title>. <source>Am. J. Respir. Crit. Care Med.</source><volume>202</volume>, <fpage>756</fpage>–<lpage>759</lpage>.<pub-id pub-id-type="pmid">32663409</pub-id></mixed-citation>
    </ref>
    <ref id="vbad029-B42">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zheng</surname><given-names>G.X.</given-names></string-name></person-group><etal>et al</etal> (<year>2017</year>) <article-title>Massively parallel digital transcriptional profiling of single cells</article-title>. <source>Nat. Commun.</source><volume>8</volume>, <fpage>1</fpage>–<lpage>12</lpage>.<pub-id pub-id-type="pmid">28232747</pub-id></mixed-citation>
    </ref>
    <ref id="vbad029-B43">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhou</surname><given-names>B.</given-names></string-name>, <string-name><surname>Jin</surname><given-names>W.</given-names></string-name></person-group> (<year>2020</year>) <part-title>Visualization of single cell RNA-seq data using t-SNE in R</part-title>. <source>Methods Mol. Biol.</source><volume>2117</volume>, <fpage>159</fpage>–<lpage>167</lpage>.<pub-id pub-id-type="pmid">31960377</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
