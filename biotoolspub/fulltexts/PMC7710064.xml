<?properties open_access?>
<?subarticle pcbi.1008453.r001?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 39.96?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS Comput Biol</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-id journal-id-type="pmc">ploscomp</journal-id>
    <journal-title-group>
      <journal-title>PLoS Computational Biology</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1553-734X</issn>
    <issn pub-type="epub">1553-7358</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, CA USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7710064</article-id>
    <article-id pub-id-type="pmid">33206638</article-id>
    <article-id pub-id-type="publisher-id">PCOMPBIOL-D-20-01270</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1008453</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Phenotypes</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Computer and Information Sciences</subject>
        <subj-group>
          <subject>Neural Networks</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Neuroscience</subject>
          <subj-group>
            <subject>Neural Networks</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Mathematical and Statistical Techniques</subject>
          <subj-group>
            <subject>Statistical Methods</subject>
            <subj-group>
              <subject>Forecasting</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Physical Sciences</subject>
        <subj-group>
          <subject>Mathematics</subject>
          <subj-group>
            <subject>Statistics</subject>
            <subj-group>
              <subject>Statistical Methods</subject>
              <subj-group>
                <subject>Forecasting</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Computational Biology</subject>
          <subj-group>
            <subject>Genome Analysis</subject>
            <subj-group>
              <subject>Gene Prediction</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Genomics</subject>
            <subj-group>
              <subject>Genome Analysis</subject>
              <subj-group>
                <subject>Gene Prediction</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Computational Biology</subject>
          <subj-group>
            <subject>Genome Analysis</subject>
            <subj-group>
              <subject>Genome-Wide Association Studies</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Genomics</subject>
            <subj-group>
              <subject>Genome Analysis</subject>
              <subj-group>
                <subject>Genome-Wide Association Studies</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Human Genetics</subject>
            <subj-group>
              <subject>Genome-Wide Association Studies</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Gene Expression</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Computational Biology</subject>
          <subj-group>
            <subject>Genome Analysis</subject>
            <subj-group>
              <subject>Gene Ontologies</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Genomics</subject>
            <subj-group>
              <subject>Genome Analysis</subject>
              <subj-group>
                <subject>Gene Ontologies</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Biochemistry</subject>
          <subj-group>
            <subject>Proteins</subject>
            <subj-group>
              <subject>Protein Interactions</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>DeepPheno: Predicting single gene loss-of-function phenotypes using an ontology-aware hierarchical classifier</article-title>
      <alt-title alt-title-type="running-head">DeepPheno</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-1710-1820</contrib-id>
        <name>
          <surname>Kulmanov</surname>
          <given-names>Maxat</given-names>
        </name>
        <role content-type="https://casrai.org/credit/">Conceptualization</role>
        <role content-type="https://casrai.org/credit/">Formal analysis</role>
        <role content-type="https://casrai.org/credit/">Investigation</role>
        <role content-type="https://casrai.org/credit/">Methodology</role>
        <role content-type="https://casrai.org/credit/">Software</role>
        <role content-type="https://casrai.org/credit/">Validation</role>
        <role content-type="https://casrai.org/credit/">Writing – original draft</role>
        <role content-type="https://casrai.org/credit/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff001"/>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-8149-5890</contrib-id>
        <name>
          <surname>Hoehndorf</surname>
          <given-names>Robert</given-names>
        </name>
        <role content-type="https://casrai.org/credit/">Formal analysis</role>
        <role content-type="https://casrai.org/credit/">Funding acquisition</role>
        <role content-type="https://casrai.org/credit/">Investigation</role>
        <role content-type="https://casrai.org/credit/">Methodology</role>
        <role content-type="https://casrai.org/credit/">Project administration</role>
        <role content-type="https://casrai.org/credit/">Supervision</role>
        <role content-type="https://casrai.org/credit/">Validation</role>
        <role content-type="https://casrai.org/credit/">Writing – original draft</role>
        <role content-type="https://casrai.org/credit/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff001"/>
        <xref ref-type="corresp" rid="cor001">*</xref>
      </contrib>
    </contrib-group>
    <aff id="aff001">
      <addr-line>King Abdullah University of Science and Technology, Thuwal, Kingdom of Saudi Arabia</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Greene</surname>
          <given-names>Casey S.</given-names>
        </name>
        <role>Editor</role>
        <xref ref-type="aff" rid="edit1"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">
      <addr-line>University of Pennsylvania Perelman School of Medicine, UNITED STATES</addr-line>
    </aff>
    <author-notes>
      <fn fn-type="COI-statement" id="coi001">
        <p>The authors have declared that no competing interests exist.</p>
      </fn>
      <corresp id="cor001">* E-mail: <email>robert.hoehndorf@kaust.edu.sa</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>11</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>18</day>
      <month>11</month>
      <year>2020</year>
    </pub-date>
    <volume>16</volume>
    <issue>11</issue>
    <elocation-id>e1008453</elocation-id>
    <history>
      <date date-type="received">
        <day>16</day>
        <month>7</month>
        <year>2020</year>
      </date>
      <date date-type="accepted">
        <day>20</day>
        <month>10</month>
        <year>2020</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2020 Kulmanov, Hoehndorf</copyright-statement>
      <copyright-year>2020</copyright-year>
      <copyright-holder>Kulmanov, Hoehndorf</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:href="pcbi.1008453.pdf"/>
    <abstract>
      <p>Predicting the phenotypes resulting from molecular perturbations is one of the key challenges in genetics. Both forward and reverse genetic screen are employed to identify the molecular mechanisms underlying phenotypes and disease, and these resulted in a large number of genotype–phenotype association being available for humans and model organisms. Combined with recent advances in machine learning, it may now be possible to predict human phenotypes resulting from particular molecular aberrations. We developed DeepPheno, a neural network based hierarchical multi-class multi-label classification method for predicting the phenotypes resulting from loss-of-function in single genes. DeepPheno uses the functional annotations with gene products to predict the phenotypes resulting from a loss-of-function; additionally, we employ a two-step procedure in which we predict these functions first and then predict phenotypes. Prediction of phenotypes is ontology-based and we propose a novel ontology-based classifier suitable for very large hierarchical classification tasks. These methods allow us to predict phenotypes associated with any known protein-coding gene. We evaluate our approach using evaluation metrics established by the CAFA challenge and compare with top performing CAFA2 methods as well as several state of the art phenotype prediction approaches, demonstrating the improvement of DeepPheno over established methods. Furthermore, we show that predictions generated by DeepPheno are applicable to predicting gene–disease associations based on comparing phenotypes, and that a large number of new predictions made by DeepPheno have recently been added as phenotype databases.</p>
    </abstract>
    <abstract abstract-type="summary">
      <title>Author summary</title>
      <p>Gene–phenotype associations can help to understand the underlying mechanisms of many genetic diseases. However, experimental identification, often involving animal models, is time consuming and expensive. Computational methods that predict gene–phenotype associations can be used instead. We developed DeepPheno, a novel approach for predicting the phenotypes resulting from a loss of function of a single gene. We use gene functions and gene expression as information to prediction phenotypes. Our method uses a neural network classifier that is able to account for hierarchical dependencies between phenotypes. We extensively evaluate our method and compare it with related approaches, and we show that DeepPheno results in better performance in several evaluations. Furthermore, we found that many of the new predictions made by our method have been added to phenotype association databases released one year later. Overall, DeepPheno simulates some aspects of human physiology and how molecular and physiological alterations lead to abnormal phenotypes.</p>
    </abstract>
    <funding-group>
      <award-group id="award001">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100004052</institution-id>
            <institution>King Abdullah University of Science and Technology</institution>
          </institution-wrap>
        </funding-source>
        <award-id>URF/1/3454-01-01</award-id>
      </award-group>
      <award-group id="award002">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100004052</institution-id>
            <institution>King Abdullah University of Science and Technology</institution>
          </institution-wrap>
        </funding-source>
        <award-id>URF/1/3790-01-01</award-id>
      </award-group>
      <award-group id="award003">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100004052</institution-id>
            <institution>King Abdullah University of Science and Technology</institution>
          </institution-wrap>
        </funding-source>
        <award-id>FCC/1/1976-28-01</award-id>
      </award-group>
      <award-group id="award004">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100004052</institution-id>
            <institution>King Abdullah University of Science and Technology</institution>
          </institution-wrap>
        </funding-source>
        <award-id>FCC/1/1976-29-01</award-id>
      </award-group>
      <funding-statement>This work was supported by funding from King Abdullah University of Science and Technology (KAUST) Office of Sponsored Research (OSR) under Award No. URF/1/3454-01-01, URF/1/3790-01-01, FCC/1/1976-28-01, FCC/1/1976-29-01. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
    </funding-group>
    <counts>
      <fig-count count="3"/>
      <table-count count="4"/>
      <page-count count="22"/>
    </counts>
    <custom-meta-group>
      <custom-meta>
        <meta-name>PLOS Publication Stage</meta-name>
        <meta-value>vor-update-to-uncorrected-proof</meta-value>
      </custom-meta>
      <custom-meta>
        <meta-name>Publication Update</meta-name>
        <meta-value>2020-12-02</meta-value>
      </custom-meta>
      <custom-meta id="data-availability">
        <meta-name>Data Availability</meta-name>
        <meta-value>The authors confirm that all data underlying the findings are fully available without restriction. Source codes are available at <ext-link ext-link-type="uri" xlink:href="https://github.com/bio-ontology-research-group/deeppheno">https://github.com/bio-ontology-research-group/deeppheno</ext-link>. Required data files are available for download at <ext-link ext-link-type="uri" xlink:href="https://bio2vec.cbrc.kaust.edu.sa/data/deeppheno/">https://bio2vec.cbrc.kaust.edu.sa/data/deeppheno/</ext-link>.</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
  <notes>
    <title>Data Availability</title>
    <p>The authors confirm that all data underlying the findings are fully available without restriction. Source codes are available at <ext-link ext-link-type="uri" xlink:href="https://github.com/bio-ontology-research-group/deeppheno">https://github.com/bio-ontology-research-group/deeppheno</ext-link>. Required data files are available for download at <ext-link ext-link-type="uri" xlink:href="https://bio2vec.cbrc.kaust.edu.sa/data/deeppheno/">https://bio2vec.cbrc.kaust.edu.sa/data/deeppheno/</ext-link>.</p>
  </notes>
</front>
<body>
  <disp-quote>
    <p>This is a <italic>PLOS Computational Biology</italic> Methods paper.</p>
  </disp-quote>
  <sec sec-type="intro" id="sec001">
    <title>Introduction</title>
    <p>Many human diseases have a genetic basis and are caused by abnormalities in the genome. Due to their high heterogeneity, many disorders are still undiagnosed and despite significant research their genetic basis has not yet been established [<xref rid="pcbi.1008453.ref001" ref-type="bibr">1</xref>]. Understanding how disease phenotypes evolve from an organism’s genotype is a significant challenge.</p>
    <p>Reverse genetic screens can be used to investigate the causality of perturbing molecular mechanisms on a genetic level and observing the resulting phenotypes [<xref rid="pcbi.1008453.ref002" ref-type="bibr">2</xref>]. For example, the International Mouse Phenotyping Consortium (IMPC) [<xref rid="pcbi.1008453.ref003" ref-type="bibr">3</xref>] aims to associate phenotypes with loss of function mutations using gene knockout experiments, and similar knockout experiments have been performed in several model organisms [<xref rid="pcbi.1008453.ref004" ref-type="bibr">4</xref>]. Further genotype–phenotype associations for the laboratory mouse and other model organisms are also systematically extracted from literature and recorded in model organism databases [<xref rid="pcbi.1008453.ref005" ref-type="bibr">5</xref>–<xref rid="pcbi.1008453.ref008" ref-type="bibr">8</xref>].</p>
    <p>The similarity between observed phenotypes can be used to infer similarity between molecular mechanisms [<xref rid="pcbi.1008453.ref009" ref-type="bibr">9</xref>]. In humans, the Human Phenotype Ontology (HPO) provides a controlled vocabulary for characterizing phenotypes [<xref rid="pcbi.1008453.ref010" ref-type="bibr">10</xref>]. A wide range of genotype–phenotype associations have been created based on the HPO. Further information about genotype–phenotype associations is collected in databases such as Online Mendelian Inheritance in Man (OMIM) [<xref rid="pcbi.1008453.ref011" ref-type="bibr">11</xref>], Orphanet [<xref rid="pcbi.1008453.ref012" ref-type="bibr">12</xref>], ClinVar [<xref rid="pcbi.1008453.ref013" ref-type="bibr">13</xref>], and DECIPHER [<xref rid="pcbi.1008453.ref014" ref-type="bibr">14</xref>].</p>
    <p>With the number of genotype–phenotype associations available now, it may be possible to predict the phenotypic consequences resulting from some changes on the level of the genotype using machine learning. Several methods have been developed to automatically predict or generate genotype–phenotype associations. To predict phenotype associations, these methods use different sources such as literature [<xref rid="pcbi.1008453.ref015" ref-type="bibr">15</xref>–<xref rid="pcbi.1008453.ref017" ref-type="bibr">17</xref>], functional annotations [<xref rid="pcbi.1008453.ref015" ref-type="bibr">15</xref>, <xref rid="pcbi.1008453.ref018" ref-type="bibr">18</xref>, <xref rid="pcbi.1008453.ref019" ref-type="bibr">19</xref>], protein–protein interactions (PPIs) [<xref rid="pcbi.1008453.ref015" ref-type="bibr">15</xref>, <xref rid="pcbi.1008453.ref020" ref-type="bibr">20</xref>–<xref rid="pcbi.1008453.ref022" ref-type="bibr">22</xref>], expression profiles [<xref rid="pcbi.1008453.ref023" ref-type="bibr">23</xref>, <xref rid="pcbi.1008453.ref024" ref-type="bibr">24</xref>], genetic variations [<xref rid="pcbi.1008453.ref015" ref-type="bibr">15</xref>, <xref rid="pcbi.1008453.ref025" ref-type="bibr">25</xref>], or their combinations [<xref rid="pcbi.1008453.ref015" ref-type="bibr">15</xref>]. The general idea behind most of these methods is to find genetic similarities, or interactions, and transfer phenotypes between genes based on the assumption that similar or interacting genes are involved in similar or related phenotypes [<xref rid="pcbi.1008453.ref026" ref-type="bibr">26</xref>].</p>
    <p>Phenotypes arise from complex biological processes which include genetic interactions, protein–protein interactions, physiological interactions, and interactions of an organism with environmental factors as well as lifestyle and response to chemicals such as drugs. A large number of these interactions can be described using the Gene Ontology (GO) [<xref rid="pcbi.1008453.ref027" ref-type="bibr">27</xref>], and GO annotations are available for a large number of proteins from thousands of species [<xref rid="pcbi.1008453.ref028" ref-type="bibr">28</xref>]. Further, in recent years, significant progress has been made in predicting the functions of uncharacterized proteins [<xref rid="pcbi.1008453.ref029" ref-type="bibr">29</xref>, <xref rid="pcbi.1008453.ref030" ref-type="bibr">30</xref>].</p>
    <p>We developed a hierarchical classification approach of predicting gene–phenotype associations from function annotations of gene products. Similarly to the HPO2GO [<xref rid="pcbi.1008453.ref019" ref-type="bibr">19</xref>] method, we use the GO function annotations as our main feature and predict HPO classes. We propagate both functional and phenotype annotations using the hierarchical structure (taxonomy) of GO and HPO and train a deep neural network model which learns to map sets of GO annotations to sets of HPO annotations. One limitation of predicting phenotypes from functions is that not all genes have experimental functional annotations. We overcome this limitation by using the function prediction method DeepGOPlus [<xref rid="pcbi.1008453.ref031" ref-type="bibr">31</xref>] which has been trained on a large number of proteins and can generate accurate functional annotations using only protein sequence. As DeepGOPlus is trained on a large number of proteins, including close and distant homologs of many human proteins, we hypothesize that it can also provide information about the physiological processes to which proteins contribute.</p>
    <p>Phenotype prediction is a massively multi-class and multi-label problem, with an ontology as classification target. In DeepPheno, we implemented a novel hierarchical classification layer which encodes almost 4,000 HPO classes and their hierarchical dependencies in a single prediction model which we use during training and prediction. The novel classification layer is a more scalable and faster version of the hierarchical classification layer used in DeepGO [<xref rid="pcbi.1008453.ref032" ref-type="bibr">32</xref>], and allows us to encode a large number of taxonomic dependencies. Although it uses simple matrix multiplication and max-pooling operations to enforce hierarchical dependencies, to our knowledge, it is a first time that these kind of operations are being used to encode ontology structure while training and optimizing a neural network using backpropagation.</p>
    <p>We evaluate DeepPheno using the latest phenotype annotations available from the HPO database [<xref rid="pcbi.1008453.ref010" ref-type="bibr">10</xref>] and using the evaluation dataset from the Computational Assessment of Function Annotation (CAFA) challenge [<xref rid="pcbi.1008453.ref029" ref-type="bibr">29</xref>], and we compare our results with the top performing methods in CAFA 2 [<xref rid="pcbi.1008453.ref033" ref-type="bibr">33</xref>] and phenotype prediction method such as HPO2GO [<xref rid="pcbi.1008453.ref019" ref-type="bibr">19</xref>], HTD/TPR [<xref rid="pcbi.1008453.ref034" ref-type="bibr">34</xref>] and PHENOstruct [<xref rid="pcbi.1008453.ref015" ref-type="bibr">15</xref>]. We demonstrate a significant improvements over the state of the art in each evaluation.</p>
    <p>To further validate the usefulness of our phenotype predictions in computational biology, we test whether we can predict gene-disease associations from the predicted phenotype annotations. We compute semantic (phenotypic) similarity between gene–phenotype annotations and disease–phenotype annotations, and our results show that the phenotype annotations generated by DeepPheno are predictive of gene–disease associations; consequently, DeepPheno expand the scope of phenotype-based prediction methods, such as for gene–disease associations [<xref rid="pcbi.1008453.ref035" ref-type="bibr">35</xref>, <xref rid="pcbi.1008453.ref036" ref-type="bibr">36</xref>] or used in variant prioritization [<xref rid="pcbi.1008453.ref037" ref-type="bibr">37</xref>–<xref rid="pcbi.1008453.ref039" ref-type="bibr">39</xref>], to all genes for which functions are known or can be predicted. We further analyzed the predictions generated by our method and found that, in average, more than 60% of the predicted genes for a phenotype interact with genes that are already associated with the phenotype, suggesting that some of our false positive predictions might actually be truly associated within a phenotype module. Finally, we show that many of the predictions made by DeepPheno in the past have recently been added to phenotype databases based on experimental or clinical evidence.</p>
  </sec>
  <sec sec-type="results" id="sec002">
    <title>Results</title>
    <sec id="sec003">
      <title>DeepPheno predicts phenotypes associated with single gene loss of function</title>
      <p>We developed a set of neural network model that predict phenotypes associated with genes. The models are trained using functions associated with gene products as input and loss-of-function phenotypes as output and relate aberrations in function to abnormal phenotypes that arise from these aberrations.</p>
      <p>We evaluate our method on the phenotype annotations from the HPO database [<xref rid="pcbi.1008453.ref010" ref-type="bibr">10</xref>] released in June 2019. We randomly split the dataset into training, validation and testing sets; we split the data by genes so that if a gene is included in one of the three sets, the gene is present with all its annotations. We tune all parameters of our models using the validation set and report evaluation results on the unseen testing set. We train five neural network models using the same phenotype annotations and same training/testing split, but with different functional annotations as features. The first model is called DeepPhenoGO and it uses only experimental function annotations. The second model is called DeepPhenoIEA and is trained on all annotations from UniProtKB/SwissProt including predicted ones (i.e., including annotations with an evidence code indicated the annotation was electronically inferred). The predicted annotations are usually based on sequence or structural similarity and multiple sequence alignments. The third model is called DeepPhenoDG. We train DeepPhenoDG on functions predicted by the DeepGOPlus [<xref rid="pcbi.1008453.ref031" ref-type="bibr">31</xref>] method. The fourth model is called DeepPhenoAG which is trained on combined function annotations from UniProtKB/Swissprot and DeepGOPlus. Finally, the DeepPheno model was trained on all functional annotations and gene expression features (i.e., the anatomical locations at which genes are expressed). Phenotypes are structured based on the HPO, and we evaluate “flat” versions of each model that do not consider the ontology structure to determine the contribution of the hierarchical classification layers in DeepPheno. For flat predictions, we fix hierarchical dependencies by propagating all positive predictions using the <italic>true path rule</italic> [<xref rid="pcbi.1008453.ref027" ref-type="bibr">27</xref>] using the structure of the HPO ontology. In other words, we add all superclasses up to the root class to the predictions for each positively predicted class.</p>
      <p>We first compare our results with phenotype annotations generated by the “naive” method (see <xref ref-type="sec" rid="sec011">Materials and methods</xref> for details). The naive method predicts the most frequently annotated phenotype classes in the training set for all genes in the testing set. It achieves an <italic>F</italic><sub>max</sub> of 0.378 which is close to our results and higher than the state-of-the-art methods in the CAFA2 challenge. Despite such performance, naive annotations do not have any practical use as they are identical for every gene. Our neural network model achieves an <italic>F</italic><sub>max</sub> of 0.437 when we train it with only experimental GO annotations and, as expected, it improves to 0.451 when we add predicted annotations in UniProtKB. We expected results to improve because experimental GO annotations are not complete and the electronically inferred function annotations can add missing information. The model trained with all annotations including DeepGOPlus, achieves the same <italic>F</italic><sub>max</sub> of 0.451, but results in the best performance among all models in our <italic>S</italic><sub>min</sub> (which also considers the specificity of the predicted phenotype classes, see <xref ref-type="sec" rid="sec011">Materials and methods</xref>) and AUPR evaluation. DeepPhenoDG model which is trained with only DeepGOPlus annotations achieves <italic>F</italic><sub>max</sub> of 0.444 which is slightly lower than the best result, but is higher than the model trained with experimental GO annotations. Adding gene expression features to functional annotations improve the model’s performance further achieving highest <italic>F</italic><sub>max</sub> of 0.457. In each case, the hierarchical classifiers improves the performance achieved by the flat classifier and <italic>true path rule</italic> propagation. In addition, we trained a Random Forest regression model DeepPhenoRF with all features used in DeepPheno. It resulted in a similar performance as DeepPheno in terms of <italic>F</italic><sub>max</sub> and slightly better performance in recall and the <italic>S</italic><sub>min</sub> evaluation. In all other evaluations our neural network based model resulted in better performance. <xref rid="pcbi.1008453.t001" ref-type="table">Table 1</xref> summarizes our results.</p>
      <table-wrap id="pcbi.1008453.t001" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1008453.t001</object-id>
        <label>Table 1</label>
        <caption>
          <title>The comparison of 5-fold cross-validation evaluation performance on the June 2019 dataset and all HPO classes.</title>
        </caption>
        <alternatives>
          <graphic id="pcbi.1008453.t001g" xlink:href="pcbi.1008453.t001"/>
          <table frame="box" rules="all" border="0">
            <colgroup span="1">
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th align="left" rowspan="1" colspan="1">Method</th>
                <th align="left" rowspan="1" colspan="1">
                  <italic>F</italic>
                  <sub>max</sub>
                </th>
                <th align="left" rowspan="1" colspan="1">Precision</th>
                <th align="left" rowspan="1" colspan="1">Recall</th>
                <th align="left" rowspan="1" colspan="1">
                  <italic>S</italic>
                  <sub>min</sub>
                </th>
                <th align="left" rowspan="1" colspan="1">AUPR</th>
                <th align="left" rowspan="1" colspan="1">AUROC</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" rowspan="1" colspan="1">Naive</td>
                <td align="left" rowspan="1" colspan="1">0.378 ± 0.005</td>
                <td align="left" rowspan="1" colspan="1">0.355 ± 0.004</td>
                <td align="left" rowspan="1" colspan="1">0.406 ± 0.007</td>
                <td align="left" rowspan="1" colspan="1">123.546 ± 3.002</td>
                <td align="left" rowspan="1" colspan="1">0.306 ± 0.006</td>
                <td align="left" rowspan="1" colspan="1">0.500 ± 0.000</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">DeepPhenoGOFlat</td>
                <td align="left" rowspan="1" colspan="1">0.431 ± 0.004</td>
                <td align="left" rowspan="1" colspan="1">0.415 ± 0.007</td>
                <td align="left" rowspan="1" colspan="1">0.450 ± 0.010</td>
                <td align="left" rowspan="1" colspan="1">117.102 ± 2.627</td>
                <td align="left" rowspan="1" colspan="1">0.412 ± 0.008</td>
                <td align="left" rowspan="1" colspan="1">0.709 ± 0.017</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">DeepPhenoGO</td>
                <td align="left" rowspan="1" colspan="1">0.437 ± 0.005</td>
                <td align="left" rowspan="1" colspan="1">0.411 ± 0.007</td>
                <td align="left" rowspan="1" colspan="1">0.467 ± 0.014</td>
                <td align="left" rowspan="1" colspan="1">116.469 ± 2.440</td>
                <td align="left" rowspan="1" colspan="1">0.421 ± 0.006</td>
                <td align="left" rowspan="1" colspan="1">0.727 ± 0.010</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">DeepPhenoIEAFlat</td>
                <td align="left" rowspan="1" colspan="1">0.448 ± 0.004</td>
                <td align="left" rowspan="1" colspan="1">0.427 ± 0.006</td>
                <td align="left" rowspan="1" colspan="1">0.471 ± 0.006</td>
                <td align="left" rowspan="1" colspan="1">115.225 ± 2.773</td>
                <td align="left" rowspan="1" colspan="1">0.434 ± 0.006</td>
                <td align="left" rowspan="1" colspan="1">0.758 ± 0.004</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">DeepPhenoIEA</td>
                <td align="left" rowspan="1" colspan="1">0.451 ± 0.004</td>
                <td align="left" rowspan="1" colspan="1">0.434 ± 0.009</td>
                <td align="left" rowspan="1" colspan="1">0.469 ± 0.008</td>
                <td align="left" rowspan="1" colspan="1">115.294 ± 2.708</td>
                <td align="left" rowspan="1" colspan="1">0.436 ± 0.006</td>
                <td align="left" rowspan="1" colspan="1">0.761 ± 0.003</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">DeepPhenoDGFlat</td>
                <td align="left" rowspan="1" colspan="1">0.442 ± 0.005</td>
                <td align="left" rowspan="1" colspan="1">0.426 ± 0.006</td>
                <td align="left" rowspan="1" colspan="1">0.459 ± 0.012</td>
                <td align="left" rowspan="1" colspan="1">115.795 ± 2.395</td>
                <td align="left" rowspan="1" colspan="1">0.427 ± 0.005</td>
                <td align="left" rowspan="1" colspan="1">0.758 ± 0.004</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">DeepPhenoDG</td>
                <td align="left" rowspan="1" colspan="1">0.444 ± 0.007</td>
                <td align="left" rowspan="1" colspan="1">0.426 ± 0.013</td>
                <td align="left" rowspan="1" colspan="1">0.463 ± 0.007</td>
                <td align="left" rowspan="1" colspan="1">115.412 ± 2.296</td>
                <td align="left" rowspan="1" colspan="1">0.431 ± 0.010</td>
                <td align="left" rowspan="1" colspan="1">0.760 ± 0.005</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">DeepPhenoAGFlat</td>
                <td align="left" rowspan="1" colspan="1">0.444 ± 0.006</td>
                <td align="left" rowspan="1" colspan="1">0.422 ± 0.010</td>
                <td align="left" rowspan="1" colspan="1">0.468 ± 0.006</td>
                <td align="left" rowspan="1" colspan="1">115.802 ± 3.154</td>
                <td align="left" rowspan="1" colspan="1">0.429 ± 0.008</td>
                <td align="left" rowspan="1" colspan="1">0.752 ± 0.009</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">DeepPhenoAG</td>
                <td align="left" rowspan="1" colspan="1">0.451 ± 0.004</td>
                <td align="left" rowspan="1" colspan="1">0.428 ± 0.006</td>
                <td align="left" rowspan="1" colspan="1">
                  <bold>0.477 ± 0.009</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">114.894 ± 3.043</td>
                <td align="left" rowspan="1" colspan="1">0.438 ± 0.005</td>
                <td align="left" rowspan="1" colspan="1">0.764 ± 0.002</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">DeepPhenoFlat</td>
                <td align="left" rowspan="1" colspan="1">0.451 ± 0.006</td>
                <td align="left" rowspan="1" colspan="1">0.434 ± 0.015</td>
                <td align="left" rowspan="1" colspan="1">0.471 ± 0.006</td>
                <td align="left" rowspan="1" colspan="1">114.765 ± 2.558</td>
                <td align="left" rowspan="1" colspan="1">0.437 ± 0.008</td>
                <td align="left" rowspan="1" colspan="1">0.763 ± 0.010</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">DeepPheno</td>
                <td align="left" rowspan="1" colspan="1">
                  <bold>0.457 ± 0.007</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">
                  <bold>0.445 ± 0.010</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">0.470 ± 0.009</td>
                <td align="left" rowspan="1" colspan="1">114.045 ± 2.821</td>
                <td align="left" rowspan="1" colspan="1">
                  <bold>0.445 ± 0.009</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">
                  <bold>0.766 ± 0.010</bold>
                </td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">DeepPhenoRF</td>
                <td align="left" rowspan="1" colspan="1">0.456 ± 0.007</td>
                <td align="left" rowspan="1" colspan="1">0.437 ± 0.014</td>
                <td align="left" rowspan="1" colspan="1">
                  <bold>0.477 ± 0.015</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">
                  <bold>112.152 ± 2.114</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">0.431 ± 0.008</td>
                <td align="left" rowspan="1" colspan="1">0.733 ± 0.006</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
      </table-wrap>
      <p>The results show that the DeepPheno model achieves the best performance when using both experimental and electronically inferred GO annotations and gene expression values, and achieves comparative performance by using only DeepGOPlus annotations which can be predicted from protein amino acid sequence information alone. We also show that the Random Forest model can achieve similar performance using DeepGOPlus annotations and expression values.</p>
      <p>In addition, we report the 5-fold cross-validation evaluation performance for the 100 best-performing individual phenotype classes in <xref ref-type="supplementary-material" rid="pcbi.1008453.s001">S1 Table</xref>. We found that DeepPheno results in a good performance for several specific phenotypes. For example, the phenotype class <italic>Elevated levels of phytanic acid</italic> (<monospace>HP:0010571</monospace>) has <italic>F</italic><sub>max</sub> of 0.960 or the class <italic>Brushfield spots</italic> (<monospace>HP:0001088</monospace>) has <italic>F</italic><sub>max</sub> of 0.892. Both classes are specific classes and leaf nodes in the HPO. Furthermore, we computed the performance of HPO branches represented by a class and its subclasses that are predicted by DeepPheno. <xref ref-type="supplementary-material" rid="pcbi.1008453.s002">S2 Table</xref> shows the performance of the top 100 branches with at least 5 classes. Noticably, DeepPheno results in <italic>F</italic><sub>max</sub> of 0.77 for <italic>Mode of Inheritance</italic> (<monospace>HP:0000005</monospace>) branch of HPO. Moreover, we used the information content measure (see <xref ref-type="sec" rid="sec011">Materials and methods</xref>) as a class specificity based on annotations and plotted the performance of each phenotype by class specificity. <xref ref-type="supplementary-material" rid="pcbi.1008453.s003">S1 Fig</xref> shows that there is no significant correlation between class specificity and performance.</p>
      <p>To compare our method with other methods, we trained and tested our model using the CAFA2 challenge data, i.e., using the training and testing data as well as the ontologies provided in CAFA2 (see <xref ref-type="sec" rid="sec011">Materials and methods</xref>). We further evaluated annotations for CAFA2 targets provided by the HPO2GO method [<xref rid="pcbi.1008453.ref019" ref-type="bibr">19</xref>]. The top performing methods in CAFA2 achieve an <italic>F</italic><sub>max</sub> of around 0.36 [<xref rid="pcbi.1008453.ref033" ref-type="bibr">33</xref>]. Our DeepPhenoGO model trained using only experimental GO annotations achieve <italic>F</italic><sub>max</sub> of 0.379. Models which use predicted annotations improve <italic>F</italic><sub>max</sub> score and we achieve the best <italic>F</italic><sub>max</sub> of 0.398 with the DeepPhenoAG model trained with all GO annotations from UniProtKB/SwissProt and predicted by DeepGOPlus. To make a fair comparison we excluded gene expression features since they were not available at the CAFA2 challenge time. <xref ref-type="fig" rid="pcbi.1008453.g001">Fig 1</xref> shows the comparison with CAFA2 top performing methods and HPO2GO, and <xref rid="pcbi.1008453.t002" ref-type="table">Table 2</xref> shows the performance results of DeepPheno on the CAFA2 benchmark set.</p>
      <fig id="pcbi.1008453.g001" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1008453.g001</object-id>
        <label>Fig 1</label>
        <caption>
          <title>Comparison of DeepPheno with CAFA2 top 10 methods and HPO2GO.</title>
        </caption>
        <graphic xlink:href="pcbi.1008453.g001"/>
      </fig>
      <table-wrap id="pcbi.1008453.t002" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1008453.t002</object-id>
        <label>Table 2</label>
        <caption>
          <title>The comparison of performance on the CAFA2 challenge benchmark dataset.</title>
        </caption>
        <alternatives>
          <graphic id="pcbi.1008453.t002g" xlink:href="pcbi.1008453.t002"/>
          <table frame="box" rules="all" border="0">
            <colgroup span="1">
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th align="left" rowspan="1" colspan="1">Method</th>
                <th align="left" rowspan="1" colspan="1">
                  <italic>F</italic>
                  <sub>max</sub>
                </th>
                <th align="left" rowspan="1" colspan="1">Precision</th>
                <th align="left" rowspan="1" colspan="1">Recall</th>
                <th align="left" rowspan="1" colspan="1">
                  <italic>S</italic>
                  <sub>min</sub>
                </th>
                <th align="left" rowspan="1" colspan="1">AUPR</th>
                <th align="left" rowspan="1" colspan="1">AUROC</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" rowspan="1" colspan="1">Naive</td>
                <td align="char" char="." rowspan="1" colspan="1">0.358</td>
                <td align="char" char="." rowspan="1" colspan="1">0.335</td>
                <td align="char" char="." rowspan="1" colspan="1">0.384</td>
                <td align="char" char="." rowspan="1" colspan="1">81.040</td>
                <td align="char" char="." rowspan="1" colspan="1">0.267</td>
                <td align="char" char="." rowspan="1" colspan="1">0.500</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">DeepPhenoGO</td>
                <td align="char" char="." rowspan="1" colspan="1">0.379</td>
                <td align="char" char="." rowspan="1" colspan="1">0.329</td>
                <td align="char" char="." rowspan="1" colspan="1">0.446</td>
                <td align="char" char="." rowspan="1" colspan="1">82.139</td>
                <td align="char" char="." rowspan="1" colspan="1">0.318</td>
                <td align="char" char="." rowspan="1" colspan="1">0.597</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">DeepPhenoIEA</td>
                <td align="char" char="." rowspan="1" colspan="1">0.396</td>
                <td align="char" char="." rowspan="1" colspan="1">0.379</td>
                <td align="char" char="." rowspan="1" colspan="1">0.415</td>
                <td align="char" char="." rowspan="1" colspan="1">
                  <bold>79.461</bold>
                </td>
                <td align="char" char="." rowspan="1" colspan="1">0.348</td>
                <td align="char" char="." rowspan="1" colspan="1">0.645</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">DeepPhenoDG</td>
                <td align="char" char="." rowspan="1" colspan="1">0.392</td>
                <td align="char" char="." rowspan="1" colspan="1">
                  <bold>0.388</bold>
                </td>
                <td align="char" char="." rowspan="1" colspan="1">0.397</td>
                <td align="char" char="." rowspan="1" colspan="1">81.369</td>
                <td align="char" char="." rowspan="1" colspan="1">0.339</td>
                <td align="char" char="." rowspan="1" colspan="1">0.621</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">DeepPhenoRF</td>
                <td align="char" char="." rowspan="1" colspan="1">0.391</td>
                <td align="char" char="." rowspan="1" colspan="1">0.378</td>
                <td align="char" char="." rowspan="1" colspan="1">0.405</td>
                <td align="char" char="." rowspan="1" colspan="1">80.545</td>
                <td align="char" char="." rowspan="1" colspan="1">0.338</td>
                <td align="char" char="." rowspan="1" colspan="1">0.619</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">DeepPhenoAG</td>
                <td align="char" char="." rowspan="1" colspan="1">
                  <bold>0.398</bold>
                </td>
                <td align="char" char="." rowspan="1" colspan="1">0.340</td>
                <td align="char" char="." rowspan="1" colspan="1">
                  <bold>0.482</bold>
                </td>
                <td align="char" char="." rowspan="1" colspan="1">79.616</td>
                <td align="char" char="." rowspan="1" colspan="1">
                  <bold>0.350</bold>
                </td>
                <td align="char" char="." rowspan="1" colspan="1">
                  <bold>0.648</bold>
                </td>
              </tr>
            </tbody>
          </table>
        </alternatives>
      </table-wrap>
      <p>The PHENOstruct [<xref rid="pcbi.1008453.ref015" ref-type="bibr">15</xref>] and HTD/TPR [<xref rid="pcbi.1008453.ref034" ref-type="bibr">34</xref>] methods report the 5-fold cross-validation evaluation results on HPO annotations released on January 2014 (which is the CAFA2 challenge training data). We followed their experimental setup and evaluated our methods with 5-fold cross-validation. To tune and select the best prediction models, we used 10% of training data as validation set in each fold. <xref rid="pcbi.1008453.t003" ref-type="table">Table 3</xref> compares our results with the reported results [<xref rid="pcbi.1008453.ref034" ref-type="bibr">34</xref>] where authors separately evaluate predictions for three subontologies of HPO. On the <italic>Organ (Phenotypic) abnormality</italic> (<monospace>HP:0000118</monospace>) subontology, our method performs with <italic>F</italic><sub>max</sub> of 0.42 which is the same for PHENOstruct and the second best result after TPR with SVM. On the <italic>Mode of Inheritance</italic> (<monospace>HP:0000005</monospace>) subontology, our method achieves <italic>F</italic><sub>max</sub> of 0.72 which is slightly lower than PHENOstruct. Finally, our method outperforms all other methods in evaluation on the <italic>Onset (Clinical modifier) subontology</italic> (<monospace>HP:0000004</monospace>) with <italic>F</italic><sub>max</sub> of 0.53. It is important to note that other methods rely on multiple sources of information such as PPIs, GO functions and text mining features, while DeepPheno uses only GO functions as features.</p>
      <table-wrap id="pcbi.1008453.t003" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1008453.t003</object-id>
        <label>Table 3</label>
        <caption>
          <title>The comparison of 5-fold cross validation performance on the CAFA2 challenge training dataset.</title>
        </caption>
        <alternatives>
          <graphic id="pcbi.1008453.t003g" xlink:href="pcbi.1008453.t003"/>
          <table frame="box" rules="all" border="0">
            <colgroup span="1">
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th align="left" rowspan="1" colspan="1">Method</th>
                <th align="left" rowspan="1" colspan="1">AUROC</th>
                <th align="left" rowspan="1" colspan="1">
                  <italic>F</italic>
                  <sub>max</sub>
                </th>
                <th align="left" rowspan="1" colspan="1">Precision</th>
                <th align="left" rowspan="1" colspan="1">Recall</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="center" colspan="5" rowspan="1">
                  <bold>Organ sub-ontology</bold>
                </td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">TPR-W-RANKS</td>
                <td align="char" char="." rowspan="1" colspan="1">
                  <bold>0.89</bold>
                </td>
                <td align="char" char="." rowspan="1" colspan="1">0.40</td>
                <td align="char" char="." rowspan="1" colspan="1">0.34</td>
                <td align="char" char="." rowspan="1" colspan="1">0.48</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">TPR-W-SVM</td>
                <td align="char" char="." rowspan="1" colspan="1">0.77</td>
                <td align="char" char="." rowspan="1" colspan="1">
                  <bold>0.44</bold>
                </td>
                <td align="char" char="." rowspan="1" colspan="1">0.38</td>
                <td align="char" char="." rowspan="1" colspan="1">0.51</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">HTD-RANKS</td>
                <td align="char" char="." rowspan="1" colspan="1">0.88</td>
                <td align="char" char="." rowspan="1" colspan="1">0.37</td>
                <td align="char" char="." rowspan="1" colspan="1">0.30</td>
                <td align="char" char="." rowspan="1" colspan="1">0.49</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">HTD-SVM</td>
                <td align="char" char="." rowspan="1" colspan="1">0.75</td>
                <td align="char" char="." rowspan="1" colspan="1">0.43</td>
                <td align="char" char="." rowspan="1" colspan="1">0.37</td>
                <td align="char" char="." rowspan="1" colspan="1">0.49</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">PHENOstruct</td>
                <td align="char" char="." rowspan="1" colspan="1">0.73</td>
                <td align="char" char="." rowspan="1" colspan="1">0.42</td>
                <td align="char" char="." rowspan="1" colspan="1">0.35</td>
                <td align="char" char="." rowspan="1" colspan="1">
                  <bold>0.56</bold>
                </td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Clus-HMC-Ens</td>
                <td align="char" char="." rowspan="1" colspan="1">0.65</td>
                <td align="char" char="." rowspan="1" colspan="1">0.41</td>
                <td align="char" char="." rowspan="1" colspan="1">0.39</td>
                <td align="char" char="." rowspan="1" colspan="1">0.43</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">PhenoPPIOrth</td>
                <td align="char" char="." rowspan="1" colspan="1">0.52</td>
                <td align="char" char="." rowspan="1" colspan="1">0.20</td>
                <td align="char" char="." rowspan="1" colspan="1">0.27</td>
                <td align="char" char="." rowspan="1" colspan="1">0.15</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">SSVM→Dis→HPO</td>
                <td align="char" char="." rowspan="1" colspan="1">0.49</td>
                <td align="char" char="." rowspan="1" colspan="1">0.23</td>
                <td align="char" char="." rowspan="1" colspan="1">0.16</td>
                <td align="char" char="." rowspan="1" colspan="1">0.41</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">RANKS</td>
                <td align="char" char="." rowspan="1" colspan="1">0.87</td>
                <td align="char" char="." rowspan="1" colspan="1">0.30</td>
                <td align="char" char="." rowspan="1" colspan="1">0.23</td>
                <td align="char" char="." rowspan="1" colspan="1">0.43</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">SVM</td>
                <td align="char" char="." rowspan="1" colspan="1">0.74</td>
                <td align="char" char="." rowspan="1" colspan="1">0.42</td>
                <td align="char" char="." rowspan="1" colspan="1">0.36</td>
                <td align="char" char="." rowspan="1" colspan="1">0.50</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">DeepPhenoAGFlat</td>
                <td align="char" char="." rowspan="1" colspan="1">0.74</td>
                <td align="char" char="." rowspan="1" colspan="1">0.42</td>
                <td align="char" char="." rowspan="1" colspan="1">0.39</td>
                <td align="char" char="." rowspan="1" colspan="1">0.45</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">DeepPhenoAG</td>
                <td align="char" char="." rowspan="1" colspan="1">0.74</td>
                <td align="char" char="." rowspan="1" colspan="1">0.42</td>
                <td align="char" char="." rowspan="1" colspan="1">
                  <bold>0.40</bold>
                </td>
                <td align="char" char="." rowspan="1" colspan="1">0.45</td>
              </tr>
              <tr>
                <td align="center" colspan="5" rowspan="1">
                  <bold>Inheritance sub-ontology</bold>
                </td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">TPR-W-RANKS</td>
                <td align="char" char="." rowspan="1" colspan="1">
                  <bold>0.91</bold>
                </td>
                <td align="char" char="." rowspan="1" colspan="1">0.57</td>
                <td align="char" char="." rowspan="1" colspan="1">0.45</td>
                <td align="char" char="." rowspan="1" colspan="1">0.80</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">TPR-W-SVMs</td>
                <td align="char" char="." rowspan="1" colspan="1">0.82</td>
                <td align="char" char="." rowspan="1" colspan="1">0.69</td>
                <td align="char" char="." rowspan="1" colspan="1">0.59</td>
                <td align="char" char="." rowspan="1" colspan="1">0.82</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">HTD-RANKS</td>
                <td align="char" char="." rowspan="1" colspan="1">0.90</td>
                <td align="char" char="." rowspan="1" colspan="1">0.57</td>
                <td align="char" char="." rowspan="1" colspan="1">0.44</td>
                <td align="char" char="." rowspan="1" colspan="1">0.81</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">HTD-SVMs</td>
                <td align="char" char="." rowspan="1" colspan="1">0.81</td>
                <td align="char" char="." rowspan="1" colspan="1">0.69</td>
                <td align="char" char="." rowspan="1" colspan="1">0.59</td>
                <td align="char" char="." rowspan="1" colspan="1">0.82</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">PHENOstruct</td>
                <td align="char" char="." rowspan="1" colspan="1">0.74</td>
                <td align="char" char="." rowspan="1" colspan="1">
                  <bold>0.74</bold>
                </td>
                <td align="char" char="." rowspan="1" colspan="1">
                  <bold>0.68</bold>
                </td>
                <td align="char" char="." rowspan="1" colspan="1">0.81</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Clus-HMC-Ens</td>
                <td align="char" char="." rowspan="1" colspan="1">0.73</td>
                <td align="char" char="." rowspan="1" colspan="1">0.73</td>
                <td align="char" char="." rowspan="1" colspan="1">0.64</td>
                <td align="char" char="." rowspan="1" colspan="1">
                  <bold>0.84</bold>
                </td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">PhenoPPIOrth</td>
                <td align="char" char="." rowspan="1" colspan="1">0.55</td>
                <td align="char" char="." rowspan="1" colspan="1">0.12</td>
                <td align="char" char="." rowspan="1" colspan="1">0.16</td>
                <td align="char" char="." rowspan="1" colspan="1">0.10</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">SSVM→Dis→HPO</td>
                <td align="char" char="." rowspan="1" colspan="1">0.46</td>
                <td align="char" char="." rowspan="1" colspan="1">0.11</td>
                <td align="char" char="." rowspan="1" colspan="1">0.07</td>
                <td align="char" char="." rowspan="1" colspan="1">0.25</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">RANKS</td>
                <td align="char" char="." rowspan="1" colspan="1">0.90</td>
                <td align="char" char="." rowspan="1" colspan="1">0.56</td>
                <td align="char" char="." rowspan="1" colspan="1">0.43</td>
                <td align="char" char="." rowspan="1" colspan="1">0.81</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">SVMs</td>
                <td align="char" char="." rowspan="1" colspan="1">0.82</td>
                <td align="char" char="." rowspan="1" colspan="1">0.69</td>
                <td align="char" char="." rowspan="1" colspan="1">0.59</td>
                <td align="char" char="." rowspan="1" colspan="1">0.82</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">DeepPhenoAGFlat</td>
                <td align="char" char="." rowspan="1" colspan="1">0.67</td>
                <td align="char" char="." rowspan="1" colspan="1">0.72</td>
                <td align="char" char="." rowspan="1" colspan="1">0.65</td>
                <td align="char" char="." rowspan="1" colspan="1">0.80</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">DeepPhenoAG</td>
                <td align="char" char="." rowspan="1" colspan="1">0.68</td>
                <td align="char" char="." rowspan="1" colspan="1">0.72</td>
                <td align="char" char="." rowspan="1" colspan="1">0.64</td>
                <td align="char" char="." rowspan="1" colspan="1">0.81</td>
              </tr>
              <tr>
                <td align="center" colspan="5" rowspan="1">
                  <bold>Onset sub-ontology</bold>
                </td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">TPR-RANKS</td>
                <td align="char" char="." rowspan="1" colspan="1">
                  <bold>0.86</bold>
                </td>
                <td align="char" char="." rowspan="1" colspan="1">0.44</td>
                <td align="char" char="." rowspan="1" colspan="1">0.33</td>
                <td align="char" char="." rowspan="1" colspan="1">
                  <bold>0.70</bold>
                </td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">TPR-SVMs</td>
                <td align="char" char="." rowspan="1" colspan="1">0.75</td>
                <td align="char" char="." rowspan="1" colspan="1">0.48</td>
                <td align="char" char="." rowspan="1" colspan="1">0.38</td>
                <td align="char" char="." rowspan="1" colspan="1">0.66</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">HTD-RANKS</td>
                <td align="char" char="." rowspan="1" colspan="1">
                  <bold>0.86</bold>
                </td>
                <td align="char" char="." rowspan="1" colspan="1">0.42</td>
                <td align="char" char="." rowspan="1" colspan="1">0.30</td>
                <td align="char" char="." rowspan="1" colspan="1">0.69</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">HTD-SVMs</td>
                <td align="char" char="." rowspan="1" colspan="1">0.74</td>
                <td align="char" char="." rowspan="1" colspan="1">0.46</td>
                <td align="char" char="." rowspan="1" colspan="1">0.37</td>
                <td align="char" char="." rowspan="1" colspan="1">0.67</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">PHENOstruct</td>
                <td align="char" char="." rowspan="1" colspan="1">0.64</td>
                <td align="char" char="." rowspan="1" colspan="1">0.39</td>
                <td align="char" char="." rowspan="1" colspan="1">0.31</td>
                <td align="char" char="." rowspan="1" colspan="1">0.52</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Clus-HMC-Ens</td>
                <td align="char" char="." rowspan="1" colspan="1">0.58</td>
                <td align="char" char="." rowspan="1" colspan="1">0.35</td>
                <td align="char" char="." rowspan="1" colspan="1">0.27</td>
                <td align="char" char="." rowspan="1" colspan="1">0.48</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">PhenoPPIOrth</td>
                <td align="char" char="." rowspan="1" colspan="1">0.53</td>
                <td align="char" char="." rowspan="1" colspan="1">0.25</td>
                <td align="char" char="." rowspan="1" colspan="1">0.25</td>
                <td align="char" char="." rowspan="1" colspan="1">0.24</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">SSVM→Dis→HPO HPO</td>
                <td align="char" char="." rowspan="1" colspan="1">0.49</td>
                <td align="char" char="." rowspan="1" colspan="1">0.07</td>
                <td align="char" char="." rowspan="1" colspan="1">0.06</td>
                <td align="char" char="." rowspan="1" colspan="1">0.10</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">RANKS</td>
                <td align="char" char="." rowspan="1" colspan="1">0.83</td>
                <td align="char" char="." rowspan="1" colspan="1">0.41</td>
                <td align="char" char="." rowspan="1" colspan="1">0.30</td>
                <td align="char" char="." rowspan="1" colspan="1">0.67</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">SVMs</td>
                <td align="char" char="." rowspan="1" colspan="1">0.74</td>
                <td align="char" char="." rowspan="1" colspan="1">0.47</td>
                <td align="char" char="." rowspan="1" colspan="1">0.37</td>
                <td align="char" char="." rowspan="1" colspan="1">0.63</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">DeepPhenoAGFlat</td>
                <td align="char" char="." rowspan="1" colspan="1">0.64</td>
                <td align="char" char="." rowspan="1" colspan="1">0.52</td>
                <td align="char" char="." rowspan="1" colspan="1">0.46</td>
                <td align="char" char="." rowspan="1" colspan="1">0.62</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">DeepPhenoAG</td>
                <td align="char" char="." rowspan="1" colspan="1">0.66</td>
                <td align="char" char="." rowspan="1" colspan="1">
                  <bold>0.53</bold>
                </td>
                <td align="char" char="." rowspan="1" colspan="1">
                  <bold>0.47</bold>
                </td>
                <td align="char" char="." rowspan="1" colspan="1">0.60</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
      </table-wrap>
    </sec>
    <sec id="sec004">
      <title>Gene–disease associations using predicted phenotypes</title>
      <p>Phenotype annotations have many applications, including prediction of candidate genes that are causally involved in diseases [<xref rid="pcbi.1008453.ref036" ref-type="bibr">36</xref>, <xref rid="pcbi.1008453.ref040" ref-type="bibr">40</xref>–<xref rid="pcbi.1008453.ref042" ref-type="bibr">42</xref>]. For example, we can compare the similarity between gene–phenotype associations and disease phenotypes and prioritize candidate diseases for diagnosis [<xref rid="pcbi.1008453.ref041" ref-type="bibr">41</xref>], or prioritize genetic variants that are causative for a disease [<xref rid="pcbi.1008453.ref037" ref-type="bibr">37</xref>, <xref rid="pcbi.1008453.ref038" ref-type="bibr">38</xref>]. These methods can suggest candidate genes for rare diseases and improve identification of causative variants in a clinical setting [<xref rid="pcbi.1008453.ref041" ref-type="bibr">41</xref>]. Here, our aim is to test whether the predicted phenotype annotations generated by DeepPheno are applicable for gene–disease association predictions.</p>
      <p>One of the widely used methods for comparing ontology class annotations is semantic similarity [<xref rid="pcbi.1008453.ref043" ref-type="bibr">43</xref>]. We compute semantic similarity scores between gene–phenotype annotations and disease–phenotype annotations and use it to rank genes for each disease. Such an approach can be used to predict gene–disease associations based on phenotypes [<xref rid="pcbi.1008453.ref036" ref-type="bibr">36</xref>, <xref rid="pcbi.1008453.ref040" ref-type="bibr">40</xref>] and allows us to determine how our predicted annotations can contribute to such an application.</p>
      <p>As expected, phenotype annotations generated by the naive approach are not predictive of gene–disease associations and resulted in a performance with AUROC of 0.50. On the other hand, similarity scores from existing annotations from HPO performed nearly perfectly with a AUROC of 0.98. The reason for this nearly perfect prediction is that most of the OMIM diseases are associated with only one gene and share almost same phenotype annotations as their associated genes because of how the gene–phenotype associations have been generated [<xref rid="pcbi.1008453.ref010" ref-type="bibr">10</xref>]. Predicting gene–disease associations using the DeepPhenoDG models that rely on electronically inferred GO function annotations resulted in an AUROC of 0.72, which is slightly higher than predicting gene–disease associations using the model trained with experimental GO annotations which resulted in AUROC of 0.70. The best performance in AUROC of 0.75 among methods which use predicted phenotypes were achieved by our DeepPhenoAG and DeepPheno models. <xref rid="pcbi.1008453.t004" ref-type="table">Table 4</xref> summarizes the results. Overall, this evaluation shows that our model is predicting phenotype associations which provide a signal for predicting gene–disease associations and can be considered as features for this task.</p>
      <table-wrap id="pcbi.1008453.t004" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1008453.t004</object-id>
        <label>Table 4</label>
        <caption>
          <title>The comparison of 5-fold evaluation performance on gene–disease association prediction for the June 2019 dataset test genes.</title>
        </caption>
        <alternatives>
          <graphic id="pcbi.1008453.t004g" xlink:href="pcbi.1008453.t004"/>
          <table frame="box" rules="all" border="0">
            <colgroup span="1">
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th align="left" rowspan="1" colspan="1">Method</th>
                <th align="left" rowspan="1" colspan="1">Hits@10 (%)</th>
                <th align="left" rowspan="1" colspan="1">Hits@100 (%)</th>
                <th align="left" rowspan="1" colspan="1">Mean Rank</th>
                <th align="left" rowspan="1" colspan="1">AUROC</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" rowspan="1" colspan="1">Naive</td>
                <td align="left" rowspan="1" colspan="1">1</td>
                <td align="left" rowspan="1" colspan="1">9</td>
                <td align="char" char="." rowspan="1" colspan="1">522.72</td>
                <td align="char" char="." rowspan="1" colspan="1">0.50</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">DeepPhenoGO</td>
                <td align="left" rowspan="1" colspan="1">10</td>
                <td align="left" rowspan="1" colspan="1">35</td>
                <td align="char" char="." rowspan="1" colspan="1">307.36</td>
                <td align="char" char="." rowspan="1" colspan="1">0.70</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">DeepPhenoIEA</td>
                <td align="left" rowspan="1" colspan="1">13</td>
                <td align="left" rowspan="1" colspan="1">41</td>
                <td align="char" char="." rowspan="1" colspan="1">263.13</td>
                <td align="char" char="." rowspan="1" colspan="1">0.74</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">DeepPhenoDG</td>
                <td align="left" rowspan="1" colspan="1">11</td>
                <td align="left" rowspan="1" colspan="1">38</td>
                <td align="char" char="." rowspan="1" colspan="1">284.92</td>
                <td align="char" char="." rowspan="1" colspan="1">0.72</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">DeepPhenoAG</td>
                <td align="left" rowspan="1" colspan="1">12</td>
                <td align="left" rowspan="1" colspan="1">41</td>
                <td align="char" char="." rowspan="1" colspan="1">260.80</td>
                <td align="char" char="." rowspan="1" colspan="1">0.75</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">DeepPheno</td>
                <td align="left" rowspan="1" colspan="1">12</td>
                <td align="left" rowspan="1" colspan="1">41</td>
                <td align="char" char="." rowspan="1" colspan="1">260.05</td>
                <td align="char" char="." rowspan="1" colspan="1">0.75</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">RealHPO</td>
                <td align="left" rowspan="1" colspan="1">
                  <bold>90</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">
                  <bold>96</bold>
                </td>
                <td align="char" char="." rowspan="1" colspan="1">
                  <bold>22.03</bold>
                </td>
                <td align="char" char="." rowspan="1" colspan="1">
                  <bold>0.98</bold>
                </td>
              </tr>
            </tbody>
          </table>
        </alternatives>
      </table-wrap>
    </sec>
    <sec id="sec005">
      <title>Evaluation of false positives</title>
      <p>In our experiments, we consider the absence of knowledge about an association as a negative association. When we predict such an association, we consider this a false positive prediction. However, current gene–phenotype associations in databases are not complete and some of the false positive predictions generated by our method may actually be a correct association. To test this hypothesis, we evaluate our false positive predictions in three different ways. First, we check if our false positive annotations become true annotations in later releases of the HPO annotations database. Second, we evaluate if our predicted genes are interacting with a phenotype-associated gene using the underlying assumption that phenotypes are determined by network modules of interacting genes and gene products [<xref rid="pcbi.1008453.ref044" ref-type="bibr">44</xref>–<xref rid="pcbi.1008453.ref046" ref-type="bibr">46</xref>]. Finally, we investigate if some of our false positive predictions were reported in GWAS studies.</p>
      <p>To evaluate our false positives, we used the phenotype annotations released by the HPO database in August 2020 and tested our model which was trained and tested on the 80/20% random split on a dataset from June 2019. We found that the proteins in the test set obtained 3, 207 new annotations in August 2020 and 898 (28%) of DeepPheno predictions that were counted as false in the June 2019 dataset appear in the August 2020 dataset. For example, NADH dehydrogenase, alpha 1 (<italic>NDUFA1</italic>) from the testing set of June 2019 has 13 phenotype annotations. In the August 2020 dataset, this gene collected 35 new annotations and 27 of them were predicted by our model. For example, DeepPheno predicted <italic>Lactic acidosis</italic> (<monospace>HP:0003128</monospace>) as a new phenotype associated with <italic>NDUFA1</italic> as well as several related phenotypes such as <italic>Decreased liver function</italic> (<monospace>HP:0001410</monospace>) and <italic>Generalized hypotonia</italic> (<monospace>HP:0001290</monospace>), as well as phenotypes such as <italic>Microcephaly</italic> (<monospace>HP:0000252</monospace>) and <italic>Optic atrophy</italic> (<monospace>HP:0000648</monospace>); all these phenotypes were added as new annotations of <italic>NDUFA1</italic> by August 2020. The predictions of DeepPheno were based on the GO function annotations for <italic>NDUFA1</italic> as well as DeepGOPlus-predicted GO functions; the predicted functions include among others <italic>NADH dehydrogenase (ubiquinone) activity</italic> (<monospace>GO:0008137</monospace>) and <italic>NADH dehydrogenase complex assembly</italic> (<monospace>GO:0010257</monospace>) which are newly predicted by DeepGOPlus and not included in the experimental function annotations of <italic>NDUFA1</italic>. The NAD+/NADH ratio controls the activity of pyruvate dehydrogenase [<xref rid="pcbi.1008453.ref047" ref-type="bibr">47</xref>–<xref rid="pcbi.1008453.ref049" ref-type="bibr">49</xref>], and pyruvate dehydrogenase deficiency is one of the main causes of lactic acidosis [<xref rid="pcbi.1008453.ref050" ref-type="bibr">50</xref>, <xref rid="pcbi.1008453.ref051" ref-type="bibr">51</xref>] as well as microcephaly and blindness [<xref rid="pcbi.1008453.ref052" ref-type="bibr">52</xref>]. The predictions made by DeepPheno indicate that our model was able to relate a decrease in metabolic function of NADH dehydrogenase to the downstream effects of NADH on pyruvate dehydrogenase, and then predict the phenotypes associated with it. One further indication for this mechanism is the prediction of DeepPheno of <italic>Decreased activity of the pyruvate dehydrogenase complex</italic> (<monospace>HP:0002928</monospace>) which had not been added as an annotation of <italic>NDUFA1</italic> in August 2020 and is still a false positive prediction by DeepPheno; however, this prediction indicates a mechanism for the majority of the phenotypes that were added by August 2020.</p>
      <p>Similarly, the gene ceramide galactosyltransferase (<italic>GALC</italic>) had 27 phenotype annotations and obtained 125 new annotations in the HPO database of which 26 were predicted by DeepPheno. <italic>GALC</italic> is involved in Krabbe disease [<xref rid="pcbi.1008453.ref053" ref-type="bibr">53</xref>], a lysosomal storage disease with significant nervous system involvement [<xref rid="pcbi.1008453.ref054" ref-type="bibr">54</xref>] exhibiting a range of heterogeneous phenotypes, severity, and onset [<xref rid="pcbi.1008453.ref055" ref-type="bibr">55</xref>, <xref rid="pcbi.1008453.ref056" ref-type="bibr">56</xref>]. While several major phenotypes of Krabbe disease (e.g., seizures, muscle weakness, blindness and optic atrophy, and hydrocephalus) were present in the 2019 dataset, broader and more specific phenotypes reflecting the phenotypic heterogeneity of Krabbe disease were added in 2020. Phenotypes correctly predicted by DeepPheno include <italic>Ataxia</italic> (<monospace>HP:0001251</monospace>) or <italic>Dysarthria</italic> (<monospace>HP:0001260</monospace>), which are specific neurological phenotypes also associated with Krabbe disease. These phenotypes are predicted from the asserted and predicted GO functions of <italic>GALC</italic> which include <italic>galactosylceramide catabolic process</italic> (<monospace>GO:0006683</monospace>), <italic>myelination</italic> (<monospace>GO:0042552</monospace>), and the cellular component <italic>lysosome</italic> (<monospace>GO:0005764</monospace>). Similarly to predictions for the <italic>NDUGA1</italic> gene, DeepPheno was able to identify the downstream effects of reduced galactosylceramide activity and correctly predict the phenotypes arising from them.</p>
      <p>As further evaluation, we generated DeepPheno predictions for 18,860 genes with corresponding protein entries in Swissprot/UniProtKB. For every specific phenotype, we compared false positive genes and genes that are interacting with the phenotype-associated gene using the STRING database [<xref rid="pcbi.1008453.ref057" ref-type="bibr">57</xref>]. We then computed the percentage of overlap. We found that on average, 48% of our false positives interact with a phenotype-associated gene and may contribute to a phenotype-module within the interaction network. We tested whether this finding is significant by performing a random simulation experiment. For every phenotype, we generated the same number of random gene associations as our predictions and computed the average overlap of false positives and interacting genes. We repeated this procedure 1,000 times and tested the significance of having an average of 48% overlap. We found that random predictions give an average of 24% overlap and the probability of observing 48% overlap under a random assignment of genes to phenotypes is 0.02, demonstrating that the genes we predict for a phenotype are significantly more likely to directly interact with a known phenotype-associated gene.</p>
      <p>In addition, we investigated in some cases whether the false positive gene–phenotype associations were reported to be significant in GWAS studies. We used the GWAS Catalog [<xref rid="pcbi.1008453.ref058" ref-type="bibr">58</xref>] to determine if some of our false predictions were reported in GWAS studies, and tested the phenotypes Type II Diabetes mellitus (<monospace>HP:0005978</monospace>) and Hypothyroidism (<monospace>HP:0000821</monospace>) since they are specific phenotypes in HPO and are very well studied with many GWAS analyses. Type II Diabetes is associated with 136 genes in the HPO database and we predict 189 genes with DeepPheno. 69 genes from our predictions were already included in the HPO database and we consequently generated 120 false positives. We found that our false positive associations with genes WFS1, HNF4A, NPHP4, and TXNL4B were reported to be associated with Type II Diabetes in GWAS Catalog while the others were not. NPHP4 was also associated by a GWAS study using the UK Biobank dataset (<ext-link ext-link-type="uri" xlink:href="https://www.nealelab.is/uk-biobank">https://www.nealelab.is/uk-biobank</ext-link>). For the Hypothyroidism (<monospace>HP:0000821</monospace>) phenotype, we predict 61 genes which are not in our training set. A GWAS study using the UK Biobank dataset reported an association with LGR4 gene which is in our false positive set. As we predict genes that interact with phenotype-associated genes, and while the predicted genes do mostly not reach genome-wide significance in GWAS studies, a possible explanation may be that some of the predicted genes have only low effect sizes, preventing them from being detected in a GWAS study. In future research, it may be possible to explore this hypothesis further by directly evaluating interaction models and DeepPheno’s predictions on GWAS datasets.</p>
    </sec>
  </sec>
  <sec sec-type="conclusions" id="sec006">
    <title>Discussion</title>
    <p>DeepPheno can predict sets of gene–phenotype associations from gene functional annotations. Specifically, it is designed to predict phenotypes which arise from a loss of function (where functions are represented using the Gene Ontology) and we have illustrated how DeepPheno relates loss of functions to their downstream phenotypic effects. While DeepPheno was trained using phenotypes arising from the loss of function of a gene, its reliance on functions (instead of structural features) may allow it to also be applied to different alterations of gene function such as partial loss of function. Together with function prediction methods such as DeepGOPlus [<xref rid="pcbi.1008453.ref031" ref-type="bibr">31</xref>], DeepPheno can, in principle, predict phenotype associations for protein-coding genes using only the protein’s amino acid sequence. However, DeepGOPlus was trained on experimentally annotated sequences of many organisms, including several animal model organisms. It further combines global sequence similarity and a deep learning model which learns to recognize sequence motifs as well as some elements of protein structure. The combination of this information is implicitly used in DeepGOPlus and its predictions, and is therefore able to predict physiological functions that are closely related to the abnormal phenotypes predicted by DeepPheno.</p>
    <sec id="sec007">
      <title>Evaluation</title>
      <p>We evaluated DeepPheno on two datasets and compared its predictions with the top performing methods in the CAFA2 challenge. DeepPheno showed overall the best performance in the evaluation with time based split. However, when we compared the performance of DeepPheno on 5-fold cross-validation on CAFA2 challenge training set with other hierarchical classification methods such as PhenoStruct [<xref rid="pcbi.1008453.ref015" ref-type="bibr">15</xref>] and HTD/TPR [<xref rid="pcbi.1008453.ref034" ref-type="bibr">34</xref>], our method did not outperform HTD/TPR methods combined with support-vector machine classifiers and resulted in the same performance as PhenoStruct. We think that the main reason for this is that we only rely on function annotations and the other methods use additional features such as protein–protein interactions, literature and disease causing variants associated through gene-disease associations from HPO [<xref rid="pcbi.1008453.ref010" ref-type="bibr">10</xref>]. We did not use gene expression data because it was not available during CAFA2 challenge. However, in our experiment with recent data, we have shown that DeepPheno can easily combine features from multiple sources which resulted in improvement of its performance.</p>
    </sec>
    <sec id="sec008">
      <title>Hierarchical classifier</title>
      <p>We implemented a novel hierarchical classfication neural network in DeepPheno. It was inspired by our previous hierarchical classifer in DeepGO [<xref rid="pcbi.1008453.ref032" ref-type="bibr">32</xref>]. However, the version used in DeepPheno is significantly faster and scalable. The main difference here is that DeepPheno uses only one layer which stores ontology structure whereas DeepGO had a layer for each class in the ontology which required a connection to its children classes. Also, our new model achieves hierarchical consistency by a simple matrix multiplication operation followed by a MaxPooling layer and does not require complex operations. In DeepGO, the largest model can predict around 1, 000 classes while DeepPheno predicts around 4, 000.</p>
      <p>We specifically compare DeepPheno with other hierarchical classification methods such as PhenoStruct [<xref rid="pcbi.1008453.ref015" ref-type="bibr">15</xref>] and HTD/TPR [<xref rid="pcbi.1008453.ref034" ref-type="bibr">34</xref>]. Also, we use the true path rule [<xref rid="pcbi.1008453.ref027" ref-type="bibr">27</xref>] to fix hierarchical dependencies of DeepPhenoFlat classifiers and compare them with our hierarchical classifiers. In all cases, the DeepPheno models outperform flat classifiers that apply the true path rule after predictions.</p>
      <p>Hierarchical deep neural networks have also been used to simulate interactions between processes within a cell and predict (cellular) phenotypes, notably in the DCell model [<xref rid="pcbi.1008453.ref059" ref-type="bibr">59</xref>]. DCell established a correspondence between the components of a deep neural network and ontology classes, both to model the hierarchical organization of a cell and to provide a means to explain genotype–phenotype predictions by identifying which parts of the neural network (and therefore which cell components or functions) are active when a prediction is made. DeepPheno uses ontologies both as input and output and to ensure that predictions are consistent with the HPO, but does not directly enable the interpretability of models such as DCell. DeepPheno also solves a different problem compared to DCell; while DCell relates (yeast) genotypes to growth phenotypes, DeepPheno predicts the phenotypic consequences of a loss of function; while DCell can simulate the processes within a cell, DeepPheno aims to simulate some aspects of human physiology and the phenotypes resulting from altering physiological functions.</p>
    </sec>
    <sec id="sec009">
      <title>Limitations and future research</title>
      <p>Currently, DeepPheno suffers from several limitations. Firstly, we use mainly function annotations and gene expressions as features. This gives our model the ability to predict phenotypes for many genes; however, phenotypes do not only depend on functions of individual gene products but also they arise from complex genetic and environmental interactions. Including such information may further improve our model. Specifically, we plan to include different types of interactions between genes in order to improve prediction of complex phenotypes.</p>
      <p>Secondly, DeepPheno currently can only predict a limited number of phenotypes for which we find at least 10 annotated genes. This limitation is caused by the need to train our neural network model and limits DeepPheno’s ability to predict specific phenotypes which are the most informative. One way to overcome this limitation is to include phenotype associations with different evidence, such as those derived from GWAS study instead of using only phenotypes resulting from Mendelian disease as included in the HPO database.</p>
      <p>Finally, DeepPheno uses a simple fully connected layer and sparse representation of functional annotations and do not considers the full set of axioms in GO and HPO. Although, this model gave us the best performance in our experiments, we think that more “complex” learning methods which encode all semantics in the ontologies need to be considered in the future.</p>
    </sec>
  </sec>
  <sec sec-type="conclusions" id="sec010">
    <title>Conclusions</title>
    <p>DeepPheno provides a fast and scalable way of generating phenotype annotations from functional annotations and expression values of genes. We developed a novel neural network based hierarchical classification layer which can be easily integrated into any neural network architecture and which is applicable for many prediction tasks with a large number of classes with hierarchical dependencies. Our model can combine different types of features (multi-modal); therefore, it can be extended further by adding new information. We have shown that the performance of the model increases with the number of training data and we believe that this will allow our model to improve further in future. Our predictions are useful in associating genes and diseases, and we make our predictions publicly available for most of human genes.</p>
    <p>We observe that incorporating axioms in ontologies into optimization of learning task helps to improve the model’s performance. Moreover, DeepPheno relies on ontologies to relate altered molecular functions and processes to their physiological consequences. This property of DeepPheno could be exploited for other applications that rely on deriving phenotypes from functional aberrations.</p>
  </sec>
  <sec sec-type="materials|methods" id="sec011">
    <title>Materials and methods</title>
    <sec id="sec012">
      <title>Evaluation and training data</title>
      <sec id="sec013">
        <title>Training and testing dataset</title>
        <p>We downloaded the Human Phenotype Ontology (HPO) version released on 15th of April, 2019 and phenotype annotations released on 3rd of June, 2019 from <ext-link ext-link-type="uri" xlink:href="https://hpo.jax.org">https://hpo.jax.org</ext-link>. The HPO provides annotations from OMIM and Orphanet. We use gene–phenotype annotations from both sources and build a dataset of 4,073 genes annotated with 8,693 different phenotypes. In total, the dataset has 529,475 annotations with an average of 130 annotations per gene after propagating annotations using the HPO structure. 3,944 of the genes map to manually reviewed and annotated proteins from UniProtKB/SwissProt [<xref rid="pcbi.1008453.ref060" ref-type="bibr">60</xref>]. We refer to this dataset as “June 2019”. We use reviewed genes/proteins and split the dataset into 80% training and 20% testing sets. We use 10% of the training set as a validation set to tune the parameters of our prediction model. We generate 5 folds of random split and report 5-fold cross-validation results.</p>
        <p>In order to have sufficient data for training, we select HPO classes that have 10 or more annotated genes. The model trained with this dataset can predict 3,783 classes. However, we use all 8,693 classes when we evaluate our performance counting the classes that we cannot predict as false negatives.</p>
        <p>Our main features from which we predict phenotypes are gene functions. We use the Gene Ontology (GO) [<xref rid="pcbi.1008453.ref027" ref-type="bibr">27</xref>] released on 17th of April, 2019 and GO annotations (uniprot_sprot.dat.gz) from UniProtKB/SwissProt released in April, 2019. We construct three different datasets with different types of functional annotations for the same genes. In the first dataset, we use all annotations from the file which includes electronically inferred ones. The second dataset has only experimental functional annotations. We filter experimental annotations using the evidence codes <monospace>EXP</monospace>, <monospace>IDA</monospace>, <monospace>IPI</monospace>, <monospace>IMP</monospace>, <monospace>IGI</monospace>, <monospace>IEP</monospace>, <monospace>TAS</monospace>, <monospace>IC</monospace>, <monospace>HTP</monospace>, <monospace>HDA</monospace>, <monospace>HMP</monospace>, <monospace>HGI</monospace>, <monospace>HEP</monospace>. For the third dataset, we use GO functions predicted by DeepGOPlus [<xref rid="pcbi.1008453.ref031" ref-type="bibr">31</xref>]. The number of distinct GO classes which are used as features in our model is 24, 274.</p>
        <p>Additionally, we perform an experiment where we combine gene functions with gene expressions data downloaded from Expression Atlas [<xref rid="pcbi.1008453.ref061" ref-type="bibr">61</xref>] Genotype-Tissue Expression (GTEx) Project (<monospace>E-MTAB-5214</monospace>) [<xref rid="pcbi.1008453.ref062" ref-type="bibr">62</xref>]. This data provides 53 features for each gene which are expression values of a gene for 53 different tissues. In total, there are expressions values for 40, 079 genes. We normalize values by genes and use zero for missing values.</p>
      </sec>
      <sec id="sec014">
        <title>Comparison dataset</title>
        <p>To compare our method with state-of-the-art phenotype prediction methods we follow the CAFA [<xref rid="pcbi.1008453.ref029" ref-type="bibr">29</xref>] challenge rules and generate a dataset using a time based split. CAFA2 [<xref rid="pcbi.1008453.ref033" ref-type="bibr">33</xref>] challenge benchmark data was collected from January 2014 until September 2014. We train our model on phenotype annotations that were available before the challenge started and evaluate the model on annotations that appeared during the challenge period. Similarly, we use function annotations that were available before a challenge starts and train DeepGOPlus on a UniProt/Swissprot version released in January 2014. We use the same versions of HPO and GO that were used in the challenge. Here, our model can predict 2, 029 classes that have 10 or more annotations for training.</p>
        <p>In addition, phenotype prediction methods such as PHENOStruct [<xref rid="pcbi.1008453.ref015" ref-type="bibr">15</xref>] and HTD/TPR [<xref rid="pcbi.1008453.ref034" ref-type="bibr">34</xref>] report 5-fold cross-validation evaluation results using the phenotype annotations released in January 2014. We also follow their experimental setup and compare our results on this data.</p>
      </sec>
      <sec id="sec015">
        <title>Protein–protein interactions data</title>
        <p>To evaluate false positive predictions generated by our approach we use protein–protein interactions (PPI) data. We download StringDB PPI networks [<xref rid="pcbi.1008453.ref057" ref-type="bibr">57</xref>] version 11 published in January, 2019. StringDB is a database of protein’s functional associations which includes direct physical and indirect functional interactions. StringDB combines interactions from several primary PPI databases and adds PPI interactions that are predicted with computational methods. We use interactions with a score of 0.7 or above in order to filter high confidence interactions.</p>
      </sec>
    </sec>
    <sec id="sec016">
      <title>Baseline and comparison methods</title>
      <p>We use several approaches to benchmark and compare our prediction results. The “naive” approach was proposed by the CAFA [<xref rid="pcbi.1008453.ref029" ref-type="bibr">29</xref>] challenge as one of the basic methods to assign GO and HPO annotations. Here, each query gene or protein <italic>g</italic> is annotated with the HPO classes with a prediction score computed as
<disp-formula id="pcbi.1008453.e001"><alternatives><graphic xlink:href="pcbi.1008453.e001.jpg" id="pcbi.1008453.e001g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M1"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>S</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi>N</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>o</mml:mi><mml:mi>t</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(1)</label></disp-formula>
where <italic>p</italic> is a HPO class, <italic>N</italic><sub><italic>p</italic></sub> is a number of training genes annotated by HPO class <italic>p</italic>, and <italic>N</italic><sub><italic>total</italic></sub> is a total number of training genes. It represents a prediction based only on the total number of genes associated with a class during training.</p>
      <p>The CAFA2 [<xref rid="pcbi.1008453.ref033" ref-type="bibr">33</xref>] challenge evaluates several phenotype prediction methods which present state-of-the-art performance for this task. We train and test our model on the same data and compare our results with top performing methods. The CAFA3 [<xref rid="pcbi.1008453.ref030" ref-type="bibr">30</xref>] challenge also evaluated HPO predictions but did not release the evaluation results yet.</p>
      <p>HPO2GO predicts HPO classes by learning association rules between HPO and GO classes based on their co-occurrence in annotations [<xref rid="pcbi.1008453.ref019" ref-type="bibr">19</xref>]. The idea is to map every HPO class <italic>p</italic> to a GO class <italic>f</italic> and score the mapping with the following formula:
<disp-formula id="pcbi.1008453.e002"><alternatives><graphic xlink:href="pcbi.1008453.e002.jpg" id="pcbi.1008453.e002g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M2"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>S</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>f</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mo>·</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mo>&amp;</mml:mo><mml:mi>f</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>f</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(2)</label></disp-formula>
where <italic>N</italic><sub><italic>p</italic>&amp;<italic>f</italic></sub> is the number of genes annotated with both <italic>p</italic> and <italic>f</italic>, <italic>N</italic><sub><italic>p</italic></sub> is the number of genes annotated with <italic>p</italic> and <italic>N</italic><sub><italic>f</italic></sub> is the number of genes annotated with <italic>f</italic>. In the prediction phase the mappings are used to assign HPO classes to genes with available GO classes.</p>
      <p>PHENOStruct [<xref rid="pcbi.1008453.ref015" ref-type="bibr">15</xref>] is a hierarchical multilabel classifier which predicts HPO classes using a structured SVM method. The PHENOStruct method relies on multiple gene features such as PPIs, GO functions, literature and genetic variants linked through gene-disease associations.</p>
      <p>The Hierarchcal Top-Down (HTD) and True Path Rule (TPR) [<xref rid="pcbi.1008453.ref034" ref-type="bibr">34</xref>] methods are hierarchical ensemble methods which first train a flat classification method and update prediction scores using the ontology structure to fix inconsistencies of hierarchical label space. In the HTD strategy, scores are propagated from parent to children starting from the root class. If a parent has a lower score than its child then the child’s score will be updated to the parent’s score. In the TPR strategy, all superclasses of predicted classes are added to the predictions. Scores for the parent class are updated based on their children class scores. For example, a parent class can take an average value of positively predicted children or a maximum of all children scores. Both strategies guarantee consistency of prediction scores with hierarchical dependencies of the labels. The main limitation of these strategies is that they do not consider the hierarchical label space while training the models.</p>
    </sec>
    <sec id="sec017">
      <title>Evaluation metrics</title>
      <p>In order to evaluate our phenotype predictions and compare our method with other competing methods we use the CAFA [<xref rid="pcbi.1008453.ref029" ref-type="bibr">29</xref>] gene/protein-centric evaluation metrics <italic>F</italic><sub>max</sub>, area under the precision-recall curve (AUPR) and <italic>S</italic><sub>min</sub> [<xref rid="pcbi.1008453.ref063" ref-type="bibr">63</xref>]. In addition to this, we report term-centric area under the receiver operating characteristic curve (AUROC) [<xref rid="pcbi.1008453.ref064" ref-type="bibr">64</xref>]. We compute AUROC for each ontology class and then take the average.</p>
      <p><italic>F</italic><sub>max</sub> is a maximum gene/protein-centric F-measure computed over all prediction thresholds. First, we compute average precision and recall using the following formulas:
<disp-formula id="pcbi.1008453.e003"><alternatives><graphic xlink:href="pcbi.1008453.e003.jpg" id="pcbi.1008453.e003g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M3"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>p</mml:mi><mml:msub><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mo>∑</mml:mo><mml:mi>p</mml:mi></mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>f</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>∧</mml:mo><mml:mi>p</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mo>∑</mml:mo><mml:mi>p</mml:mi></mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>p</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(3)</label></disp-formula>
<disp-formula id="pcbi.1008453.e004"><alternatives><graphic xlink:href="pcbi.1008453.e004.jpg" id="pcbi.1008453.e004g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M4"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>r</mml:mi><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mo>∑</mml:mo><mml:mi>p</mml:mi></mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>f</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>∧</mml:mo><mml:mi>p</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mo>∑</mml:mo><mml:mi>p</mml:mi></mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>p</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(4)</label></disp-formula>
<disp-formula id="pcbi.1008453.e005"><alternatives><graphic xlink:href="pcbi.1008453.e005.jpg" id="pcbi.1008453.e005g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M5"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>A</mml:mi><mml:mi>v</mml:mi><mml:mi>g</mml:mi><mml:mi>P</mml:mi><mml:mi>r</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>m</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mfrac><mml:mo>·</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:munderover><mml:mi>p</mml:mi><mml:msub><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(5)</label></disp-formula>
<disp-formula id="pcbi.1008453.e006"><alternatives><graphic xlink:href="pcbi.1008453.e006.jpg" id="pcbi.1008453.e006g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M6"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>A</mml:mi><mml:mi>v</mml:mi><mml:mi>g</mml:mi><mml:mi>R</mml:mi><mml:mi>c</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>n</mml:mi></mml:mfrac><mml:mo>·</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:mi>r</mml:mi><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(6)</label></disp-formula>
where <italic>p</italic> is an HPO class, <italic>T</italic><sub><italic>i</italic></sub> is a set of true annotations, <italic>P</italic><sub><italic>i</italic></sub>(<italic>t</italic>) is a set of predicted annotations for a gene <italic>i</italic> and threshold <italic>t</italic>, <italic>m</italic>(<italic>t</italic>) is a number of proteins for which we predict at least one class, <italic>n</italic> is a total number of proteins and <italic>I</italic> is an identity function which returns 1 if the condition is true and 0 otherwise. Then, we compute the <italic>F</italic><sub>max</sub> for prediction thresholds <italic>t</italic> ∈ [0, 1] with a step size of 0.01. We count a class as a prediction if its prediction score is higher than <italic>t</italic>:
<disp-formula id="pcbi.1008453.e007"><alternatives><graphic xlink:href="pcbi.1008453.e007.jpg" id="pcbi.1008453.e007g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M7"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mtext>max</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mtext>max</mml:mtext><mml:mi>t</mml:mi></mml:munder><mml:mo>{</mml:mo><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mo>·</mml:mo><mml:mi>A</mml:mi><mml:mi>v</mml:mi><mml:mi>g</mml:mi><mml:mi>P</mml:mi><mml:mi>r</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mo>·</mml:mo><mml:mi>A</mml:mi><mml:mi>v</mml:mi><mml:mi>g</mml:mi><mml:mi>R</mml:mi><mml:mi>c</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mi>v</mml:mi><mml:mi>g</mml:mi><mml:mi>P</mml:mi><mml:mi>r</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:mi>A</mml:mi><mml:mi>v</mml:mi><mml:mi>g</mml:mi><mml:mi>R</mml:mi><mml:mi>c</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mfrac><mml:mo>}</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(7)</label></disp-formula>
<italic>S</italic><sub>min</sub> computes the semantic distance between real and predicted annotations based on information content of the classes. The information content <italic>IC</italic>(<italic>c</italic>) is computed based on the annotation probability of the class <italic>c</italic>:
<disp-formula id="pcbi.1008453.e008"><alternatives><graphic xlink:href="pcbi.1008453.e008.jpg" id="pcbi.1008453.e008g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M8"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>I</mml:mi><mml:mi>C</mml:mi><mml:mo>(</mml:mo><mml:mi>c</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mtext>log</mml:mtext><mml:mo>(</mml:mo><mml:mi>P</mml:mi><mml:mi>r</mml:mi><mml:mo>(</mml:mo><mml:mi>c</mml:mi><mml:mo>|</mml:mo><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mi>c</mml:mi><mml:mo>)</mml:mo><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(8)</label></disp-formula>
where <italic>P</italic>(<italic>c</italic>) is a set of parent classes of the class <italic>c</italic>. The <italic>S</italic><sub>min</sub> is computed using the following formulas:
<disp-formula id="pcbi.1008453.e009"><alternatives><graphic xlink:href="pcbi.1008453.e009.jpg" id="pcbi.1008453.e009g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M9"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mtext>min</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mtext>min</mml:mtext><mml:mi>t</mml:mi></mml:munder><mml:msqrt><mml:mrow><mml:mi>r</mml:mi><mml:mi>u</mml:mi><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msqrt></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(9)</label></disp-formula>
where <italic>ru</italic>(<italic>t</italic>) is the average remaining uncertainty and <italic>mi</italic>(<italic>t</italic>) is average misinformation:
<disp-formula id="pcbi.1008453.e010"><alternatives><graphic xlink:href="pcbi.1008453.e010.jpg" id="pcbi.1008453.e010g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M10"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>r</mml:mi><mml:mi>u</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>n</mml:mi></mml:mfrac><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>c</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:munder><mml:mi>I</mml:mi><mml:mi>C</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>c</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(10)</label></disp-formula>
<disp-formula id="pcbi.1008453.e011"><alternatives><graphic xlink:href="pcbi.1008453.e011.jpg" id="pcbi.1008453.e011g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M11"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>n</mml:mi></mml:mfrac><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>c</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:munder><mml:mi>I</mml:mi><mml:mi>C</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>c</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(11)</label></disp-formula></p>
    </sec>
    <sec id="sec018">
      <title>Gene–disease association prediction</title>
      <p>To evaluate predicted phenotype annotations we downloaded gene-disease association data from OMIM [<xref rid="pcbi.1008453.ref065" ref-type="bibr">65</xref>]. The OMIM database provides associations for around 6,000 diseases and 14,000 genes. We filter these associations with the genes from our randomly split test set and their associated diseases. In total, the dataset has 561 associations of 395 genes with 548 diseases.</p>
      <p>We predict an association between gene and disease by comparing their phenotypes. Our hypothesis is that if a gene and disease are annotated with similar phenotypes then there could be an association between them [<xref rid="pcbi.1008453.ref036" ref-type="bibr">36</xref>]. We compute Resnik’s [<xref rid="pcbi.1008453.ref066" ref-type="bibr">66</xref>] semantic similarity measure for pairs of phenotype classes and use the Best-Match-Average (BMA) [<xref rid="pcbi.1008453.ref067" ref-type="bibr">67</xref>] strategy to combine similarites for two sets of annotations. We use the similarity score to rank diseases for each gene and report recall at top 10 rank, recall at top 100, mean rank and the area under the receiver operating characteristic curve (AUROC) [<xref rid="pcbi.1008453.ref064" ref-type="bibr">64</xref>] for each prediction method.</p>
      <p>Resnik’s similarity measure is defined as the most informative common anchestor (MICA) of the compared classes in the ontology. First, we compute information content (IC) for every class with following formula:
<disp-formula id="pcbi.1008453.e012"><alternatives><graphic xlink:href="pcbi.1008453.e012.jpg" id="pcbi.1008453.e012g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M12"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>I</mml:mi><mml:mi>C</mml:mi><mml:mo>(</mml:mo><mml:mi>c</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mtext>log</mml:mtext><mml:mo>(</mml:mo><mml:mi>p</mml:mi><mml:mo>(</mml:mo><mml:mi>c</mml:mi><mml:mo>)</mml:mo><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
Then, we find Resnik’s similarity by:
<disp-formula id="pcbi.1008453.e013"><alternatives><graphic xlink:href="pcbi.1008453.e013.jpg" id="pcbi.1008453.e013g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M13"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>S</mml:mi><mml:mi>i</mml:mi><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi>R</mml:mi><mml:mi>e</mml:mi><mml:mi>s</mml:mi><mml:mi>n</mml:mi><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>I</mml:mi><mml:mi>C</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>M</mml:mi><mml:mi>I</mml:mi><mml:mi>C</mml:mi><mml:mi>A</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
We compute all possible pairwise similarities of two annotation sets and combine them with:
<disp-formula id="pcbi.1008453.e014"><alternatives><graphic xlink:href="pcbi.1008453.e014.jpg" id="pcbi.1008453.e014g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M14"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>S</mml:mi><mml:mi>i</mml:mi><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi>B</mml:mi><mml:mi>M</mml:mi><mml:mi>A</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:munder><mml:mrow><mml:mi>a</mml:mi><mml:mi>v</mml:mi><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>∈</mml:mo><mml:mi>A</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:munder><mml:mtext>max</mml:mtext><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>∈</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:munder><mml:mrow><mml:mi>a</mml:mi><mml:mi>v</mml:mi><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>∈</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:munder><mml:mtext>max</mml:mtext><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>∈</mml:mo><mml:mi>A</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
where <italic>s</italic>(<italic>x</italic>, <italic>y</italic>) = <italic>Sim</italic><sub><italic>Resnik</italic></sub>(<italic>x</italic>, <italic>y</italic>).</p>
    </sec>
    <sec id="sec019">
      <title>DeepPheno model</title>
      <p>The aim of DeepPheno is to predict phenotypes which result from the loss of function of a single gene. In order to achieve this goal, we need to combine different types of features such as functions of gene products, molecular and multi-cellular interactions, pathways, and physiological interactions. Our approach is to use existing experimental and predicted function annotations of proteins, and learn the associations between combinations of functions and phenotype annotations. We use OMIM [<xref rid="pcbi.1008453.ref011" ref-type="bibr">11</xref>, <xref rid="pcbi.1008453.ref065" ref-type="bibr">65</xref>] diseases and their phenotype annotations from the HPO [<xref rid="pcbi.1008453.ref010" ref-type="bibr">10</xref>] to learn associations between sets of GO functional annotations and sets of HPO phenotype annotations. Since experimental function annotations are not available for all gene products, we also utilize the sequence-based function prediction method DeepGOPlus [<xref rid="pcbi.1008453.ref031" ref-type="bibr">31</xref>], which uses information of function annotations in many organisms, to fill this gap and predict the functions of gene products. Consequently, DeepPheno can predict phenotypes for all protein-coding genes with an available sequence.</p>
      <p>Our phenotype prediction model is a fully-connected neural network followed by a novel hierarchical classification layer which encodes the ontology structure into the neural network. DeepPheno takes a sparse binary vector of functional annotation features and gene expression features as input and outputs phenotype annotation scores which are consistent with the hierarchical dependencies of the phenotypes in HPO; the input vector is deductively closed following the taxonomy and axioms in the GO ontology, i.e., function annotations are propagated. <xref ref-type="fig" rid="pcbi.1008453.g002">Fig 2</xref> describes the model architecture. The first layer is responsible for reducing the dimensionality of our sparse function annotation input and expression values are concatenated to it. The second layer is a multi-class multi-label classification layer with sigmoid activation functions for each neuron. We use a dropout layer after the first fully-connected layer to avoid overfitting during training. The number of units in the second layer is the same as the number of prediction classes and its output is considered as the output of a “flat” classifier, i.e., a classifier which does not take the taxonomy of HPO into account. Our novel hierarchical classification layer computes the score for a class by selecting the maximum score of its descendants (i.e., subclasses according to the HPO axioms).</p>
      <fig id="pcbi.1008453.g002" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1008453.g002</object-id>
        <label>Fig 2</label>
        <caption>
          <title>Neural network model architecture.</title>
        </caption>
        <graphic xlink:href="pcbi.1008453.g002"/>
      </fig>
      <p>DeepPheno’s hierarchical classification layer was inspired by the hierarchical classifier of DeepGO [<xref rid="pcbi.1008453.ref032" ref-type="bibr">32</xref>]. In DeepGO, each output class had a classification layer which was connected to its direct children’s classifiers with a maximum merge layer. The main limitation of this method was its performance both in terms of training and runtime, since all the computations were performed sequentially. Consequently, the model did not scale to large ontologies such as GO or HPO. The novel hierarchical classification layer we implement in DeepPheno overcomes the limitations of the hierarchical classification previously used in DeepGO by using matrix multiplication operations and MaxPooling layers to encode the consistency constraints of phenotype annotations that arise from the ontology’s taxonomic structure. We implement the layer by multiplying the sigmoid output vector with a binary vector encoded for the hierarchical dependencies in GO, where a value of “one” indicates that a class at this positions is a descendant of the class to be predicted; this multiplication is then followed by MaxPooling layer. Formally, given a vector <bold>x</bold> for a set of phenotype classes <italic>P</italic> such that <italic>x</italic><sub><italic>i</italic></sub> is a prediction score for a phenotype <italic>p</italic><sub><italic>i</italic></sub> at position <italic>i</italic>, then we define the hierarchical classification function <italic>h</italic>(<bold>x</bold>) as:
<disp-formula id="pcbi.1008453.e015"><alternatives><graphic xlink:href="pcbi.1008453.e015.jpg" id="pcbi.1008453.e015g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M15"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>h</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:munder><mml:mtext>max</mml:mtext><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:mi>P</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo>·</mml:mo><mml:mi>s</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(12)</label></disp-formula>
where <italic>s</italic> is a function which returns a binary vector that encodes the subclass relations between <italic>p</italic><sub><italic>i</italic></sub> and all other phenotype classes. The value of the vector <italic>s</italic>(<italic>p</italic><sub><italic>i</italic></sub>) at position <italic>j</italic> is 1 if <italic>p</italic><sub><italic>j</italic></sub> is a (reflexive) subclass of <italic>p</italic><sub><italic>i</italic></sub> (<italic>p</italic><sub><italic>j</italic></sub> ⊑ <italic>p</italic><sub><italic>i</italic></sub>), and 0 otherwise. The function returns a vector of the same size as <bold>x</bold> which will be consistent with the <italic>true-path-rule</italic> because a prediction score of a class will be the maximum value of the prediction scores of all its subclasses. The use of elementwise matrix multiplication and pooling allows this hierarchical classification function to be implemented efficiently (in contrast to the sequential computation model of DeepGO) and we use this classification function during training of DeepPheno as well as during prediction. <xref ref-type="fig" rid="pcbi.1008453.g003">Fig 3</xref> provides an example of the hierarchical classification function.</p>
      <fig id="pcbi.1008453.g003" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1008453.g003</object-id>
        <label>Fig 3</label>
        <caption>
          <title>Example of hierarchical classification layer operations.</title>
        </caption>
        <graphic xlink:href="pcbi.1008453.g003"/>
      </fig>
    </sec>
    <sec id="sec020">
      <title>Training and tuning of model parameters</title>
      <p>We evaluated several models with two, three and four fully connected layer models. We selected the number of units for each layer from {250, 500, …, 4000} with dropout rate from {0.2, 0.5} and learning rate from {0.01, 0.001, 0.0001} for the Adam optimizer [<xref rid="pcbi.1008453.ref068" ref-type="bibr">68</xref>]. We trained the models with mini-batch size of 32. We performed 50 trials of random search for best parameters for each type of the models and selected the best model based on validation loss. We use the TensorFlow 2.0 [<xref rid="pcbi.1008453.ref069" ref-type="bibr">69</xref>] machine learning system with Keras API and tune our parameters with Keras Tuner.</p>
      <p>Our model is trained and tuned in less than 1 hour on a single Nvidia Quadro P6000 GPU. In average, it annotates more than 100 samples per second.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material" id="sec021">
    <title>Supporting information</title>
    <supplementary-material content-type="local-data" id="pcbi.1008453.s001">
      <label>S1 Table</label>
      <caption>
        <title>Performance of DeepPheno by phenotypes (Top 100).</title>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pcbi.1008453.s001.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1008453.s002">
      <label>S2 Table</label>
      <caption>
        <title>HPO branches with significantly better performance (Top 100).</title>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pcbi.1008453.s002.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1008453.s003">
      <label>S1 Fig</label>
      <caption>
        <title>Performance of each phenotype class by its specificity measure based on the number of annotations.</title>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pcbi.1008453.s003.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <p>We acknowledge the use of computational resources from the KAUST Supercomputing Core Laboratory.</p>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="pcbi.1008453.ref001">
      <label>1</label>
      <mixed-citation publication-type="journal"><name><surname>Tifft</surname><given-names>CJ</given-names></name>, <name><surname>Adams</surname><given-names>DR</given-names></name>. <article-title>The National Institutes of Health undiagnosed diseases program</article-title>. <source>Curr Opin Pediatr</source>. <year>2014</year>;<volume>26</volume>(<issue>6</issue>):<fpage>626</fpage>–<lpage>633</lpage>. <pub-id pub-id-type="doi">10.1097/MOP.0000000000000155</pub-id><?supplied-pmid 25313974?><pub-id pub-id-type="pmid">25313974</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008453.ref002">
      <label>2</label>
      <mixed-citation publication-type="journal"><name><surname>Manis</surname><given-names>JP</given-names></name>. <article-title>Knock Out, Knock In, Knock Down—Genetically Manipulated Mice and the Nobel Prize</article-title>. <source>New England Journal of Medicine</source>. <year>2007</year>;<volume>357</volume>(<issue>24</issue>):<fpage>2426</fpage>–<lpage>2429</lpage>. <pub-id pub-id-type="doi">10.1056/NEJMp0707712</pub-id><?supplied-pmid 18077807?><pub-id pub-id-type="pmid">18077807</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008453.ref003">
      <label>3</label>
      <mixed-citation publication-type="journal"><name><surname>Collins</surname><given-names>FS</given-names></name>, <name><surname>Finnell</surname><given-names>RH</given-names></name>, <name><surname>Rossant</surname><given-names>J</given-names></name>, <name><surname>Wurst</surname><given-names>W</given-names></name>. <article-title>A new partner for the international knockout mouse consortium</article-title>. <source>Cell</source>. <year>2007</year>;<volume>129</volume>(<issue>2</issue>):<fpage>235</fpage><pub-id pub-id-type="doi">10.1016/j.cell.2007.04.007</pub-id><?supplied-pmid 17448981?><pub-id pub-id-type="pmid">17448981</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008453.ref004">
      <label>4</label>
      <mixed-citation publication-type="journal"><name><surname>Kettleborough</surname><given-names>RNW</given-names></name>, <name><surname>Busch-Nentwich</surname><given-names>EM</given-names></name>, <name><surname>Harvey</surname><given-names>SA</given-names></name>, <name><surname>Dooley</surname><given-names>CM</given-names></name>, <name><surname>de Bruijn</surname><given-names>E</given-names></name>, <name><surname>van Eeden</surname><given-names>F</given-names></name>, <etal>et al</etal><article-title>A systematic genome-wide analysis of zebrafish protein-coding gene function</article-title>. <source>Nature</source>. <year>2013</year>;<volume>496</volume>(<issue>7446</issue>):<fpage>494</fpage>–<lpage>497</lpage>. <pub-id pub-id-type="doi">10.1038/nature11992</pub-id><?supplied-pmid 23594742?><pub-id pub-id-type="pmid">23594742</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008453.ref005">
      <label>5</label>
      <mixed-citation publication-type="journal"><name><surname>Smith</surname><given-names>CL</given-names></name>, <name><surname>Eppig</surname><given-names>JT</given-names></name>. <article-title>Expanding the mammalian phenotype ontology to support automated exchange of high throughput mouse phenotyping data generated by large-scale mouse knockout screens</article-title>. <source>J Biomed Semantics</source>. <year>2015</year>;<volume>6</volume>:<fpage>11</fpage><pub-id pub-id-type="doi">10.1186/s13326-015-0009-1</pub-id><?supplied-pmid 25825651?><pub-id pub-id-type="pmid">25825651</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008453.ref006">
      <label>6</label>
      <mixed-citation publication-type="journal"><name><surname>Bult</surname><given-names>CJ</given-names></name>, <name><surname>Blake</surname><given-names>JA</given-names></name>, <name><surname>Smith</surname><given-names>CL</given-names></name>, <name><surname>Kadin</surname><given-names>JA</given-names></name>, <name><surname>Richardson</surname><given-names>JE</given-names></name>, <collab>the Mouse Genome Database Group</collab>. <article-title>Mouse Genome Database (MGD) 2019</article-title>. <source>Nucleic Acids Research</source>. <year>2018</year>;<volume>47</volume>(<issue>D1</issue>):<fpage>D801</fpage>–<lpage>D806</lpage>. <pub-id pub-id-type="doi">10.1093/nar/gky1056</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008453.ref007">
      <label>7</label>
      <mixed-citation publication-type="journal"><name><surname>Cherry</surname><given-names>JM</given-names></name>, <name><surname>Hong</surname><given-names>EL</given-names></name>, <name><surname>Amundsen</surname><given-names>C</given-names></name>, <name><surname>Balakrishnan</surname><given-names>R</given-names></name>, <name><surname>Binkley</surname><given-names>G</given-names></name>, <name><surname>Chan</surname><given-names>ET</given-names></name>, <etal>et al</etal><article-title>Saccharomyces Genome Database: the genomics resource of budding yeast</article-title>. <source>Nucleic Acids Research</source>. <year>2011</year>;<volume>40</volume>(<issue>D1</issue>):<fpage>D700</fpage>–<lpage>D705</lpage>. <pub-id pub-id-type="doi">10.1093/nar/gkr1029</pub-id><?supplied-pmid 22110037?><pub-id pub-id-type="pmid">22110037</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008453.ref008">
      <label>8</label>
      <mixed-citation publication-type="journal"><name><surname>The Alliance of Genome Resources</surname><given-names>Consortium</given-names></name>. <article-title>Alliance of Genome Resources Portal: unified model organism research platform</article-title>. <source>Nucleic Acids Research</source>. <year>2019</year>;<volume>48</volume>(<issue>D1</issue>):<fpage>D650</fpage>–<lpage>D658</lpage>. <pub-id pub-id-type="doi">10.1093/nar/gkz813</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008453.ref009">
      <label>9</label>
      <mixed-citation publication-type="journal"><name><surname>Washington</surname><given-names>NL</given-names></name>, <name><surname>Haendel</surname><given-names>MA</given-names></name>, <name><surname>Mungall</surname><given-names>CJ</given-names></name>, <name><surname>Ashburner</surname><given-names>M</given-names></name>, <name><surname>Westerfield</surname><given-names>M</given-names></name>, <name><surname>Lewis</surname><given-names>SE</given-names></name>. <article-title>Linking Human Diseases to Animal Models Using Ontology-Based Phenotype Annotation</article-title>. <source>PLOS Biology</source>. <year>2009</year>;<volume>7</volume>(<issue>11</issue>):<fpage>1</fpage>–<lpage>20</lpage>. <pub-id pub-id-type="doi">10.1371/journal.pbio.1000247</pub-id><?supplied-pmid 19956802?><pub-id pub-id-type="pmid">19956802</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008453.ref010">
      <label>10</label>
      <mixed-citation publication-type="journal"><name><surname>Köhler</surname><given-names>S</given-names></name>, <name><surname>Carmody</surname><given-names>L</given-names></name>, <name><surname>Vasilevsky</surname><given-names>N</given-names></name>, <name><surname>Jacobsen</surname><given-names>JO</given-names></name>, <name><surname>Danis</surname><given-names>D</given-names></name>, <name><surname>Gourdine</surname><given-names>JP</given-names></name>, <etal>et al</etal><article-title>Expansion of the Human Phenotype Ontology (HPO) knowledge base and resources</article-title>. <source>Nucleic Acids Research</source>. <year>2018</year>;<volume>47</volume>(<issue>D1</issue>):<fpage>D1018</fpage>–<lpage>D1027</lpage>.</mixed-citation>
    </ref>
    <ref id="pcbi.1008453.ref011">
      <label>11</label>
      <mixed-citation publication-type="journal"><name><surname>Amberger</surname><given-names>J</given-names></name>, <name><surname>Bocchini</surname><given-names>C</given-names></name>, <name><surname>Hamosh</surname><given-names>A</given-names></name>. <article-title>A new face and new challenges for Online Mendelian Inheritance in Man (OMIM)</article-title>. <source>Hum Mutat</source>. <year>2011</year>;<volume>32</volume>:<fpage>564</fpage>–<lpage>567</lpage>. <?supplied-pmid 21472891?><pub-id pub-id-type="pmid">21472891</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008453.ref012">
      <label>12</label>
      <mixed-citation publication-type="journal"><name><surname>Weinreich</surname><given-names>SS</given-names></name>, <name><surname>Mangon</surname><given-names>R</given-names></name>, <name><surname>Sikkens</surname><given-names>JJ</given-names></name>, <name><surname>Teeuw</surname><given-names>ME</given-names></name>, <name><surname>Cornel</surname><given-names>MC</given-names></name>. <article-title>Orphanet: a European database for rare diseases</article-title>. <source>Ned Tijdschr Geneeskd</source>. <year>2008</year>;<volume>9</volume>(<issue>152</issue>):<fpage>518</fpage>–<lpage>9</lpage>. <?supplied-pmid 18389888?><pub-id pub-id-type="pmid">18389888</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008453.ref013">
      <label>13</label>
      <mixed-citation publication-type="journal"><name><surname>Landrum</surname><given-names>MJ</given-names></name>, <name><surname>Lee</surname><given-names>JM</given-names></name>, <name><surname>Benson</surname><given-names>M</given-names></name>, <name><surname>Brown</surname><given-names>G</given-names></name>, <name><surname>Chao</surname><given-names>C</given-names></name>, <name><surname>Chitipiralla</surname><given-names>S</given-names></name>, <etal>et al</etal><article-title>ClinVar: public archive of interpretations of clinically relevant variants</article-title>. <source>Nucleic Acids Research</source>. <year>2016</year>;<volume>44</volume>(<issue>D1</issue>):<fpage>D862</fpage>–<lpage>D868</lpage>. <pub-id pub-id-type="doi">10.1093/nar/gkv1222</pub-id><?supplied-pmid 26582918?><pub-id pub-id-type="pmid">26582918</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008453.ref014">
      <label>14</label>
      <mixed-citation publication-type="journal"><name><surname>Firth</surname><given-names>HV</given-names></name>, <name><surname>Richards</surname><given-names>SM</given-names></name>, <name><surname>Bevan</surname><given-names>AP</given-names></name>, <name><surname>Clayton</surname><given-names>S</given-names></name>, <name><surname>Corpas</surname><given-names>M</given-names></name>, <name><surname>Rajan</surname><given-names>D</given-names></name>, <etal>et al</etal><article-title>DECIPHER: Database of Chromosomal Imbalance and Phenotype in Humans Using Ensembl Resources</article-title>. <source>American journal of human genetics</source>. <year>2009</year>;<volume>84</volume>(<issue>4</issue>):<fpage>524</fpage>–<lpage>533</lpage>. <pub-id pub-id-type="doi">10.1016/j.ajhg.2009.03.010</pub-id><?supplied-pmid 19344873?><pub-id pub-id-type="pmid">19344873</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008453.ref015">
      <label>15</label>
      <mixed-citation publication-type="journal"><name><surname>Kahanda</surname><given-names>I</given-names></name>, <name><surname>Funk</surname><given-names>C</given-names></name>, <name><surname>Verspoor</surname><given-names>K</given-names></name>, <name><surname>Ben-Hur</surname><given-names>A</given-names></name>. <article-title>PHENOstruct: Prediction of human phenotype ontology terms using heterogeneous data sources [version 1; referees: 2 approved]</article-title>. <source>F1000Research</source>. <year>2015</year>;<volume>4</volume>(<issue>259</issue>). <pub-id pub-id-type="doi">10.12688/f1000research.6670.1</pub-id><?supplied-pmid 26834980?><pub-id pub-id-type="pmid">26834980</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008453.ref016">
      <label>16</label>
      <mixed-citation publication-type="journal"><name><surname>Collier</surname><given-names>N</given-names></name>, <name><surname>Groza</surname><given-names>T</given-names></name>, <name><surname>Smedley</surname><given-names>D</given-names></name>, <name><surname>Robinson</surname><given-names>PN</given-names></name>, <name><surname>Oellrich</surname><given-names>A</given-names></name>, <name><surname>Rebholz-Schuhmann</surname><given-names>D</given-names></name>. <article-title>PhenoMiner: from text to a database of phenotypes associated with OMIM diseases</article-title>. <source>Database</source>. <year>2015</year>;<volume>2015</volume>:<fpage>bav104</fpage><pub-id pub-id-type="doi">10.1093/database/bav104</pub-id><?supplied-pmid 26507285?><pub-id pub-id-type="pmid">26507285</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008453.ref017">
      <label>17</label>
      <mixed-citation publication-type="journal"><name><surname>Singhal</surname><given-names>A</given-names></name>, <name><surname>Simmons</surname><given-names>M</given-names></name>, <name><surname>Lu</surname><given-names>Z</given-names></name>. <article-title>Text Mining Genotype-Phenotype Relationships from Biomedical Literature for Database Curation and Precision Medicine</article-title>. <source>PLOS Computational Biology</source>. <year>2016</year>;<volume>12</volume>(<issue>11</issue>):<fpage>1</fpage>–<lpage>19</lpage>. <pub-id pub-id-type="doi">10.1371/journal.pcbi.1005017</pub-id><?supplied-pmid 27902695?><pub-id pub-id-type="pmid">27902695</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008453.ref018">
      <label>18</label>
      <mixed-citation publication-type="journal"><name><surname>Kulmanov</surname><given-names>M</given-names></name>, <name><surname>Schofield</surname><given-names>PN</given-names></name>, <name><surname>Gkoutos</surname><given-names>GV</given-names></name>, <name><surname>Hoehndorf</surname><given-names>R</given-names></name>. <article-title>Ontology-based validation and identification of regulatory phenotypes</article-title>. <source>Bioinformatics</source>. <year>2018</year>;<volume>34</volume>(<issue>17</issue>):<fpage>i857</fpage>–<lpage>i865</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/bty605</pub-id><?supplied-pmid 30423068?><pub-id pub-id-type="pmid">30423068</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008453.ref019">
      <label>19</label>
      <mixed-citation publication-type="journal"><name><surname>Dogan</surname><given-names>T</given-names></name>. <article-title>HPO2GO: prediction of human phenotype ontology term associations for proteins using cross ontology annotation co-occurrences</article-title>. <source>PeerJ</source>. <year>2018</year>;<volume>6</volume>:<fpage>e5298</fpage>–<lpage>e5298</lpage>. <pub-id pub-id-type="doi">10.7717/peerj.5298</pub-id><?supplied-pmid 30083448?><pub-id pub-id-type="pmid">30083448</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008453.ref020">
      <label>20</label>
      <mixed-citation publication-type="journal"><name><surname>Petegrosso</surname><given-names>R</given-names></name>, <name><surname>Park</surname><given-names>S</given-names></name>, <name><surname>Hwang</surname><given-names>TH</given-names></name>, <name><surname>Kuang</surname><given-names>R</given-names></name>. <article-title>Transfer learning across ontologies for phenome–genome association prediction</article-title>. <source>Bioinformatics</source>. <year>2016</year>;<volume>33</volume>(<issue>4</issue>):<fpage>529</fpage>–<lpage>536</lpage>.</mixed-citation>
    </ref>
    <ref id="pcbi.1008453.ref021">
      <label>21</label>
      <mixed-citation publication-type="other">Gao J, Yao S, Mamitsuka H, Zhu S. AiProAnnotator: Low-rank Approximation with network side information for high-performance, large-scale human Protein abnormality Annotator. In: 2018 IEEE International Conference on Bioinformatics and Biomedicine (BIBM); 2018. p. 13–20.</mixed-citation>
    </ref>
    <ref id="pcbi.1008453.ref022">
      <label>22</label>
      <mixed-citation publication-type="journal"><name><surname>Gao</surname><given-names>J</given-names></name>, <name><surname>Liu</surname><given-names>L</given-names></name>, <name><surname>Yao</surname><given-names>S</given-names></name>, <name><surname>Huang</surname><given-names>X</given-names></name>, <name><surname>Mamitsuka</surname><given-names>H</given-names></name>, <name><surname>Zhu</surname><given-names>S</given-names></name>. <article-title>HPOAnnotator: improving large-scale prediction of HPO annotations by low-rank approximation with HPO semantic similarities and multiple PPI networks</article-title>. <source>BMC Medical Genomics</source>. <year>2019</year>;<volume>12</volume>(<issue>10</issue>):<fpage>187</fpage><pub-id pub-id-type="doi">10.1186/s12920-019-0625-1</pub-id><?supplied-pmid 31865916?><pub-id pub-id-type="pmid">31865916</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008453.ref023">
      <label>23</label>
      <mixed-citation publication-type="journal"><name><surname>Xu</surname><given-names>M</given-names></name>, <name><surname>Li</surname><given-names>W</given-names></name>, <name><surname>James</surname><given-names>GM</given-names></name>, <name><surname>Mehan</surname><given-names>MR</given-names></name>, <name><surname>Zhou</surname><given-names>XJ</given-names></name>. <article-title>Automated multidimensional phenotypic profiling using large public microarray repositories</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>2009</year>;<volume>106</volume>(<issue>30</issue>):<fpage>12323</fpage>–<lpage>12328</lpage>. <pub-id pub-id-type="doi">10.1073/pnas.0900883106</pub-id><?supplied-pmid 19590007?><pub-id pub-id-type="pmid">19590007</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008453.ref024">
      <label>24</label>
      <mixed-citation publication-type="journal"><name><surname>Labuzzetta</surname><given-names>CJ</given-names></name>, <name><surname>Antonio</surname><given-names>ML</given-names></name>, <name><surname>Watson</surname><given-names>PM</given-names></name>, <name><surname>Wilson</surname><given-names>RC</given-names></name>, <name><surname>Laboissonniere</surname><given-names>LA</given-names></name>, <name><surname>Trimarchi</surname><given-names>JM</given-names></name>, <etal>et al</etal><article-title>Complementary feature selection from alternative splicing events and gene expression for phenotype prediction</article-title>. <source>Bioinformatics</source>. <year>2016</year>;<volume>32</volume>(<issue>17</issue>):<fpage>i421</fpage>–<lpage>i429</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btw430</pub-id><?supplied-pmid 27587658?><pub-id pub-id-type="pmid">27587658</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008453.ref025">
      <label>25</label>
      <mixed-citation publication-type="journal"><name><surname>Chen</surname><given-names>YC</given-names></name>, <name><surname>Douville</surname><given-names>C</given-names></name>, <name><surname>Wang</surname><given-names>C</given-names></name>, <name><surname>Niknafs</surname><given-names>N</given-names></name>, <name><surname>Yeo</surname><given-names>G</given-names></name>, <name><surname>Beleva-Guthrie</surname><given-names>V</given-names></name>, <etal>et al</etal><article-title>A Probabilistic Model to Predict Clinical Phenotypic Traits from Genome Sequencing</article-title>. <source>PLOS Computational Biology</source>. <year>2014</year>;<volume>10</volume>(<issue>9</issue>):<fpage>1</fpage>–<lpage>11</lpage>. <pub-id pub-id-type="doi">10.1371/journal.pcbi.1003825</pub-id><?supplied-pmid 25188385?><pub-id pub-id-type="pmid">25188385</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008453.ref026">
      <label>26</label>
      <mixed-citation publication-type="journal"><name><surname>Gillis</surname><given-names>J</given-names></name>, <name><surname>Pavlidis</surname><given-names>P</given-names></name>. <article-title>“Guilt by Association” Is the Exception Rather Than the Rule in Gene Networks</article-title>. <source>PLOS Computational Biology</source>. <year>2012</year>;<volume>8</volume>(<issue>3</issue>):<fpage>1</fpage>–<lpage>13</lpage>. <pub-id pub-id-type="doi">10.1371/journal.pcbi.1002444</pub-id><pub-id pub-id-type="pmid">22629235</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008453.ref027">
      <label>27</label>
      <mixed-citation publication-type="journal"><name><surname>Ashburner</surname><given-names>M</given-names></name>, <name><surname>Ball</surname><given-names>CA</given-names></name>, <name><surname>Blake</surname><given-names>JA</given-names></name>, <name><surname>Botstein</surname><given-names>D</given-names></name>, <name><surname>Butler</surname><given-names>H</given-names></name>, <name><surname>Cherry</surname><given-names>MJ</given-names></name>, <etal>et al</etal><article-title>Gene ontology: tool for the unification of biology</article-title>. <source>Nature Genetics</source>. <year>2000</year>;<volume>25</volume>(<issue>1</issue>):<fpage>25</fpage>–<lpage>29</lpage>. <pub-id pub-id-type="doi">10.1038/75556</pub-id><?supplied-pmid 10802651?><pub-id pub-id-type="pmid">10802651</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008453.ref028">
      <label>28</label>
      <mixed-citation publication-type="journal"><article-title>The Gene Ontology Resource: 20 years and still GOing strong</article-title>. <source>Nucleic Acids Research</source>. <year>2018</year>;<volume>47</volume>(<issue>D1</issue>):<fpage>D330</fpage>–<lpage>D338</lpage>.</mixed-citation>
    </ref>
    <ref id="pcbi.1008453.ref029">
      <label>29</label>
      <mixed-citation publication-type="journal"><name><surname>Radivojac</surname><given-names>P</given-names></name>, <name><surname>Clark</surname><given-names>WT</given-names></name>, <name><surname>Oron</surname><given-names>TR</given-names></name>, <name><surname>Schnoes</surname><given-names>AM</given-names></name>, <name><surname>Wittkop</surname><given-names>T</given-names></name>, <name><surname>Sokolov</surname><given-names>A</given-names></name>, <etal>et al</etal><article-title>A large-scale evaluation of computational protein function prediction</article-title>. <source>Nat Meth</source>. <year>2013</year>;<volume>10</volume>(<issue>3</issue>):<fpage>221</fpage>–<lpage>227</lpage>. <pub-id pub-id-type="doi">10.1038/nmeth.2340</pub-id><?supplied-pmid 23353650?><pub-id pub-id-type="pmid">23353650</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008453.ref030">
      <label>30</label>
      <mixed-citation publication-type="journal"><name><surname>Zhou</surname><given-names>N</given-names></name>, <name><surname>Jiang</surname><given-names>Y</given-names></name>, <name><surname>Bergquist</surname><given-names>TR</given-names></name>, <name><surname>Lee</surname><given-names>AJ</given-names></name>, <name><surname>Kacsoh</surname><given-names>BZ</given-names></name>, <name><surname>Crocker</surname><given-names>AW</given-names></name>, <etal>et al</etal><article-title>The CAFA challenge reports improved protein function prediction and new functional annotations for hundreds of genes through experimental screens</article-title>. <source>Genome Biology</source>. <year>2019</year>;<volume>20</volume>:<fpage>244</fpage><pub-id pub-id-type="doi">10.1186/s13059-019-1835-8</pub-id><?supplied-pmid 31744546?><pub-id pub-id-type="pmid">31744546</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008453.ref031">
      <label>31</label>
      <mixed-citation publication-type="journal"><name><surname>Kulmanov</surname><given-names>M</given-names></name>, <name><surname>Hoehndorf</surname><given-names>R</given-names></name>. <article-title>DeepGOPlus: improved protein function prediction from sequence</article-title>. <source>Bioinformatics</source>. <year>2019</year>.</mixed-citation>
    </ref>
    <ref id="pcbi.1008453.ref032">
      <label>32</label>
      <mixed-citation publication-type="journal"><name><surname>Kulmanov</surname><given-names>M</given-names></name>, <name><surname>Khan</surname><given-names>MA</given-names></name>, <name><surname>Hoehndorf</surname><given-names>R</given-names></name>. <article-title>DeepGO: predicting protein functions from sequence and interactions using a deep ontology-aware classifier</article-title>. <source>Bioinformatics</source>. <year>2018</year>;<volume>34</volume>(<issue>4</issue>):<fpage>660</fpage>–<lpage>668</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btx624</pub-id><?supplied-pmid 29028931?><pub-id pub-id-type="pmid">29028931</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008453.ref033">
      <label>33</label>
      <mixed-citation publication-type="journal"><name><surname>Jiang</surname><given-names>Y</given-names></name>, <name><surname>Oron</surname><given-names>TR</given-names></name>, <name><surname>Clark</surname><given-names>WT</given-names></name>, <name><surname>Bankapur</surname><given-names>AR</given-names></name>, <name><surname>D’Andrea</surname><given-names>D</given-names></name>, <name><surname>Lepore</surname><given-names>R</given-names></name>, <etal>et al</etal><article-title>An expanded evaluation of protein function prediction methods shows an improvement in accuracy</article-title>. <source>Genome Biology</source>. <year>2016</year>;<volume>17</volume>(<issue>1</issue>):<fpage>184</fpage><pub-id pub-id-type="doi">10.1186/s13059-016-1037-6</pub-id><?supplied-pmid 27604469?><pub-id pub-id-type="pmid">27604469</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008453.ref034">
      <label>34</label>
      <mixed-citation publication-type="journal"><name><surname>Notaro</surname><given-names>M</given-names></name>, <name><surname>Schubach</surname><given-names>M</given-names></name>, <name><surname>Robinson</surname><given-names>PN</given-names></name>, <name><surname>Valentini</surname><given-names>G</given-names></name>. <article-title>Prediction of Human Phenotype Ontology terms by means of hierarchical ensemble methods</article-title>. <source>BMC Bioinformatics</source>. <year>2017</year>;<volume>18</volume>(<issue>1</issue>):<fpage>449</fpage><pub-id pub-id-type="doi">10.1186/s12859-017-1854-y</pub-id><?supplied-pmid 29025394?><pub-id pub-id-type="pmid">29025394</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008453.ref035">
      <label>35</label>
      <mixed-citation publication-type="journal"><name><surname>Shefchek</surname><given-names>KA</given-names></name>, <name><surname>Harris</surname><given-names>NL</given-names></name>, <name><surname>Gargano</surname><given-names>M</given-names></name>, <name><surname>Matentzoglu</surname><given-names>N</given-names></name>, <name><surname>Unni</surname><given-names>D</given-names></name>, <name><surname>Brush</surname><given-names>M</given-names></name>, <etal>et al</etal><article-title>The Monarch Initiative in 2019: an integrative data and analytic platform connecting phenotypes to genotypes across species</article-title>. <source>Nucleic Acids Research</source>. <year>2019</year>;<volume>48</volume>(<issue>D1</issue>):<fpage>D704</fpage>–<lpage>D715</lpage>. <pub-id pub-id-type="doi">10.1093/nar/gkz997</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008453.ref036">
      <label>36</label>
      <mixed-citation publication-type="journal"><name><surname>Hoehndorf</surname><given-names>R</given-names></name>, <name><surname>Schofield</surname><given-names>PN</given-names></name>, <name><surname>Gkoutos</surname><given-names>GV</given-names></name>. <article-title>PhenomeNET: a whole-phenome approach to disease gene discovery</article-title>. <source>Nucleic Acids Res</source>. <year>2011</year>;<volume>39</volume>(<issue>18</issue>):<fpage>e119</fpage><pub-id pub-id-type="doi">10.1093/nar/gkr538</pub-id><?supplied-pmid 21737429?><pub-id pub-id-type="pmid">21737429</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008453.ref037">
      <label>37</label>
      <mixed-citation publication-type="journal"><name><surname>Smedley</surname><given-names>D</given-names></name>, <name><surname>Jacobsen</surname><given-names>JOB</given-names></name>, <name><surname>Jäger</surname><given-names>M</given-names></name>, <name><surname>Köhler</surname><given-names>S</given-names></name>, <name><surname>Holtgrewe</surname><given-names>M</given-names></name>, <name><surname>Schubach</surname><given-names>M</given-names></name>, <etal>et al</etal><article-title>Next-generation diagnostics and disease-gene discovery with the Exomiser</article-title>. <source>Nature Protocols</source>. <year>2015</year>;<volume>10</volume>(<issue>12</issue>):<fpage>2004</fpage>–<lpage>2015</lpage>. <pub-id pub-id-type="doi">10.1038/nprot.2015.124</pub-id><?supplied-pmid 26562621?><pub-id pub-id-type="pmid">26562621</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008453.ref038">
      <label>38</label>
      <mixed-citation publication-type="journal"><name><surname>Boudellioua</surname><given-names>I</given-names></name>, <name><surname>Kulmanov</surname><given-names>M</given-names></name>, <name><surname>Schofield</surname><given-names>PN</given-names></name>, <name><surname>Gkoutos</surname><given-names>GV</given-names></name>, <name><surname>Hoehndorf</surname><given-names>R</given-names></name>. <article-title>DeepPVP: phenotype-based prioritization of causative variants using deep learning</article-title>. <source>BMC Bioinformatics</source>. <year>2019</year>;<volume>20</volume>(<issue>1</issue>):<fpage>65</fpage><pub-id pub-id-type="doi">10.1186/s12859-019-2633-8</pub-id><?supplied-pmid 30727941?><pub-id pub-id-type="pmid">30727941</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008453.ref039">
      <label>39</label>
      <mixed-citation publication-type="journal"><name><surname>Cornish</surname><given-names>AJ</given-names></name>, <name><surname>David</surname><given-names>A</given-names></name>, <name><surname>Sternberg</surname><given-names>MJE</given-names></name>. <article-title>PhenoRank: reducing study bias in gene prioritization through simulation</article-title>. <source>Bioinformatics</source>. <year>2018</year>;<volume>34</volume>(<issue>12</issue>):<fpage>2087</fpage>–<lpage>2095</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/bty028</pub-id><?supplied-pmid 29360927?><pub-id pub-id-type="pmid">29360927</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008453.ref040">
      <label>40</label>
      <mixed-citation publication-type="journal"><name><surname>Köhler</surname><given-names>S</given-names></name>, <name><surname>Schulz</surname><given-names>MH</given-names></name>, <name><surname>Krawitz</surname><given-names>P</given-names></name>, <name><surname>Bauer</surname><given-names>S</given-names></name>, <name><surname>Dölken</surname><given-names>S</given-names></name>, <name><surname>Ott</surname><given-names>CE</given-names></name>, <etal>et al</etal><article-title>Clinical Diagnostics in Human Genetics with Semantic Similarity Searches in Ontologies</article-title>. <source>The American Journal of Human Genetics</source>. <year>2009</year>;<volume>85</volume>(<issue>4</issue>):<fpage>457</fpage>–<lpage>464</lpage>. <pub-id pub-id-type="doi">10.1016/j.ajhg.2009.09.003</pub-id><?supplied-pmid 19800049?><pub-id pub-id-type="pmid">19800049</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008453.ref041">
      <label>41</label>
      <mixed-citation publication-type="journal"><name><surname>Jagadeesh</surname><given-names>KA</given-names></name>, <name><surname>Birgmeier</surname><given-names>J</given-names></name>, <name><surname>Guturu</surname><given-names>H</given-names></name>, <name><surname>Deisseroth</surname><given-names>CA</given-names></name>, <name><surname>Wenger</surname><given-names>AM</given-names></name>, <name><surname>Bernstein</surname><given-names>JA</given-names></name>, <etal>et al</etal><article-title>Phrank measures phenotype sets similarity to greatly improve Mendelian diagnostic disease prioritization</article-title>. <source>Genetics in Medicine</source>. <year>2019</year>;<volume>21</volume>(<issue>2</issue>):<fpage>464</fpage>–<lpage>470</lpage>. <pub-id pub-id-type="doi">10.1038/s41436-018-0072-y</pub-id><?supplied-pmid 29997393?><pub-id pub-id-type="pmid">29997393</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008453.ref042">
      <label>42</label>
      <mixed-citation publication-type="journal"><name><surname>Shefchek</surname><given-names>KA</given-names></name>, <name><surname>Harris</surname><given-names>NL</given-names></name>, <name><surname>Gargano</surname><given-names>M</given-names></name>, <name><surname>Matentzoglu</surname><given-names>N</given-names></name>, <name><surname>Unni</surname><given-names>D</given-names></name>, <name><surname>Brush</surname><given-names>M</given-names></name>, <etal>et al</etal><article-title>The Monarch Initiative in 2019: an integrative data and analytic platform connecting phenotypes to genotypes across species</article-title>. <source>Nucleic Acids Research</source>. <year>2019</year>;<volume>48</volume>(<issue>D1</issue>):<fpage>D704</fpage>–<lpage>D715</lpage>. <pub-id pub-id-type="doi">10.1093/nar/gkz997</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008453.ref043">
      <label>43</label>
      <mixed-citation publication-type="journal"><name><surname>Harispe</surname><given-names>S</given-names></name>, <name><surname>Ranwez</surname><given-names>S</given-names></name>, <name><surname>Janaqi</surname><given-names>S</given-names></name>, <name><surname>Montmain</surname><given-names>J</given-names></name>. <article-title>The semantic measures library and toolkit: fast computation of semantic similarity and relatedness using biomedical ontologies</article-title>. <source>Bioinformatics</source>. <year>2014</year>;<volume>30</volume>(<issue>5</issue>):<fpage>740</fpage>–<lpage>742</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btt581</pub-id><?supplied-pmid 24108186?><pub-id pub-id-type="pmid">24108186</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008453.ref044">
      <label>44</label>
      <mixed-citation publication-type="journal"><name><surname>Wang</surname><given-names>Q</given-names></name>, <name><surname>Roy</surname><given-names>B</given-names></name>, <name><surname>Dwivedi</surname><given-names>Y</given-names></name>. <article-title>Co-expression network modeling identifies key long non-coding RNA and mRNA modules in altering molecular phenotype to develop stress-induced depression in rats</article-title>. <source>Translational Psychiatry</source>. <year>2019</year>;<volume>9</volume>:<fpage>125</fpage><pub-id pub-id-type="doi">10.1038/s41398-019-0448-z</pub-id><?supplied-pmid 30944317?><pub-id pub-id-type="pmid">30944317</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008453.ref045">
      <label>45</label>
      <mixed-citation publication-type="journal"><name><surname>Han</surname><given-names>SK</given-names></name>, <name><surname>Kim</surname><given-names>I</given-names></name>, <name><surname>Hwang</surname><given-names>J</given-names></name>, <name><surname>Kim</surname><given-names>S</given-names></name>. <article-title>Network Modules of the Cross-Species Genotype-Phenotype Map Reflect the Clinical Severity of Human Diseases</article-title>. <source>PLOS ONE</source>. <year>2015</year>;<volume>10</volume>(<issue>8</issue>):<fpage>1</fpage>–<lpage>13</lpage>. <pub-id pub-id-type="doi">10.1371/journal.pone.0136300</pub-id><?supplied-pmid 26301634?><pub-id pub-id-type="pmid">26301634</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008453.ref046">
      <label>46</label>
      <mixed-citation publication-type="journal"><name><surname>Hoehndorf</surname><given-names>R</given-names></name>, <name><surname>Schofield</surname><given-names>PN</given-names></name>, <name><surname>Gkoutos</surname><given-names>GV</given-names></name>. <article-title>Analysis of the human diseasome using phenotype similarity between common, genetic, and infectious diseases</article-title>. <source>Scientific Reports</source>. <year>2015</year>;<volume>5</volume>:<fpage>10888</fpage><pub-id pub-id-type="doi">10.1038/srep10888</pub-id><?supplied-pmid 26051359?><pub-id pub-id-type="pmid">26051359</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008453.ref047">
      <label>47</label>
      <mixed-citation publication-type="journal"><name><surname>Huckabee</surname><given-names>WE</given-names></name>. <article-title>RELATIONSHIPS OF PYRUVATE AND LACTATE DURING ANAEROBIC METABOLISM. I. EFFECTS OF INFUSION OF PYRUVATE OR GLUCOSE AND OF HYPERVENTILATION</article-title>. <source>J Clin Invest</source>. <year>1958</year>;<volume>37</volume>(<issue>2</issue>):<fpage>244</fpage>–<lpage>254</lpage>. <pub-id pub-id-type="doi">10.1172/JCI103603</pub-id><?supplied-pmid 13513755?><pub-id pub-id-type="pmid">13513755</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008453.ref048">
      <label>48</label>
      <mixed-citation publication-type="journal"><name><surname>Huckabee</surname><given-names>WE</given-names></name>. <article-title>Relationships of pyruvate and lactate during anaerobic metabolism. II. Exercise and formation of O-debt</article-title>. <source>J Clin Invest</source>. <year>1958</year>;<volume>37</volume>(<issue>2</issue>):<fpage>255</fpage>–<lpage>263</lpage>. <pub-id pub-id-type="doi">10.1172/JCI103604</pub-id><?supplied-pmid 13513756?><pub-id pub-id-type="pmid">13513756</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008453.ref049">
      <label>49</label>
      <mixed-citation publication-type="journal"><name><surname>Williamson</surname><given-names>DH</given-names></name>, <name><surname>Lund</surname><given-names>P</given-names></name>, <name><surname>Krebs</surname><given-names>HA</given-names></name>. <article-title>The redox state of free nicotinamide-adenine dinucleotide in the cytoplasm and mitochondria of rat liver</article-title>. <source>Biochem J</source>. <year>1967</year>;<volume>103</volume>(<issue>2</issue>):<fpage>514</fpage>–<lpage>527</lpage>. <pub-id pub-id-type="doi">10.1042/bj1030514</pub-id><?supplied-pmid 4291787?><pub-id pub-id-type="pmid">4291787</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008453.ref050">
      <label>50</label>
      <mixed-citation publication-type="journal"><name><surname>Dahl</surname><given-names>HH</given-names></name>. <article-title>Pyruvate dehydrogenase E1 alpha deficiency: males and females differ yet again</article-title>. <source>Am J Hum Genet</source>. <year>1995</year>;<volume>56</volume>(<issue>3</issue>):<fpage>553</fpage>–<lpage>557</lpage>. <?supplied-pmid 7887408?><pub-id pub-id-type="pmid">7887408</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008453.ref051">
      <label>51</label>
      <mixed-citation publication-type="journal"><name><surname>Brown</surname><given-names>GK</given-names></name>, <name><surname>Otero</surname><given-names>LJ</given-names></name>, <name><surname>LeGris</surname><given-names>M</given-names></name>, <name><surname>Brown</surname><given-names>RM</given-names></name>. <article-title>Pyruvate dehydrogenase deficiency</article-title>. <source>J Med Genet</source>. <year>1994</year>;<volume>31</volume>(<issue>11</issue>):<fpage>875</fpage>–<lpage>879</lpage>. <pub-id pub-id-type="doi">10.1136/jmg.31.11.875</pub-id><?supplied-pmid 7853374?><pub-id pub-id-type="pmid">7853374</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008453.ref052">
      <label>52</label>
      <mixed-citation publication-type="journal"><name><surname>Patel</surname><given-names>KP</given-names></name>, <name><surname>O’Brien</surname><given-names>TW</given-names></name>, <name><surname>Subramony</surname><given-names>SH</given-names></name>, <name><surname>Shuster</surname><given-names>J</given-names></name>, <name><surname>Stacpoole</surname><given-names>PW</given-names></name>. <article-title>The Spectrum of Pyruvate Dehydrogenase Complex Deficiency: Clinical, Biochemical and Genetic Features in 371 Patients</article-title>. <source>Mol Genet Metab</source>. <year>2012</year>;<volume>105</volume>(<issue>1</issue>):<fpage>34</fpage>–<lpage>43</lpage>. <pub-id pub-id-type="doi">10.1016/j.ymgme.2011.09.032</pub-id><?supplied-pmid 22079328?><pub-id pub-id-type="pmid">22079328</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008453.ref053">
      <label>53</label>
      <mixed-citation publication-type="journal"><name><surname>Tappino</surname><given-names>B</given-names></name>, <name><surname>Biancheri</surname><given-names>R</given-names></name>, <name><surname>Mort</surname><given-names>M</given-names></name>, <name><surname>Regis</surname><given-names>S</given-names></name>, <name><surname>Corsolini</surname><given-names>F</given-names></name>, <name><surname>Rossi</surname><given-names>A</given-names></name>, <etal>et al</etal><article-title>Identification and characterization of 15 novel GALC gene mutations causing Krabbe disease</article-title>. <source>Human Mutation</source>. <year>2010</year>;<volume>31</volume>(<issue>12</issue>):<fpage>E1894</fpage>–<lpage>E1914</lpage>. <pub-id pub-id-type="doi">10.1002/humu.21367</pub-id><?supplied-pmid 20886637?><pub-id pub-id-type="pmid">20886637</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008453.ref054">
      <label>54</label>
      <mixed-citation publication-type="journal"><name><surname>Sakai</surname><given-names>N</given-names></name>, <name><surname>Inui</surname><given-names>K</given-names></name>, <name><surname>Fujii</surname><given-names>N</given-names></name>, <name><surname>Fukushima</surname><given-names>H</given-names></name>, <name><surname>Nishimoto</surname><given-names>J</given-names></name>, <name><surname>Yanagihara</surname><given-names>I</given-names></name>, <etal>et al</etal><article-title>Krabbe Disease: Isolation and Characterization of a Full-Length cDNA for Human Galactocerebrosidase</article-title>. <source>Biochemical and Biophysical Research Communications</source>. <year>1994</year>;<volume>198</volume>(<issue>2</issue>):<fpage>485</fpage>–<lpage>491</lpage>. <pub-id pub-id-type="doi">10.1006/bbrc.1994.1071</pub-id><?supplied-pmid 8297359?><pub-id pub-id-type="pmid">8297359</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008453.ref055">
      <label>55</label>
      <mixed-citation publication-type="journal"><name><surname>Gasperi</surname><given-names>RD</given-names></name>, <name><surname>Sosa</surname><given-names>MAG</given-names></name>, <name><surname>Sartorato</surname><given-names>EL</given-names></name>, <name><surname>Battistini</surname><given-names>S</given-names></name>, <name><surname>MacFarlane</surname><given-names>H</given-names></name>, <name><surname>Gusella</surname><given-names>JF</given-names></name>, <etal>et al</etal><article-title>Molecular heterogeneity of late-onset forms of globoid-cell leukodystrophy</article-title>. <source>Am J Hum Genet</source>. <year>1996</year>;<volume>59</volume>(<issue>6</issue>):<fpage>1233</fpage>–<lpage>1242</lpage>. <?supplied-pmid 8940268?><pub-id pub-id-type="pmid">8940268</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008453.ref056">
      <label>56</label>
      <mixed-citation publication-type="journal"><name><surname>Furuya</surname><given-names>H</given-names></name>, <name><surname>ji Kukita</surname><given-names>Y</given-names></name>, <name><surname>Nagano</surname><given-names>S</given-names></name>, <name><surname>Sakai</surname><given-names>Y</given-names></name>, <name><surname>Yamashita</surname><given-names>Y</given-names></name>, <name><surname>Fukuyama</surname><given-names>H</given-names></name>, <etal>et al</etal><article-title>Adult onset globoid cell leukodystrophy (Krabbe disease): analysis of galactosylceramidase cDNA from four Japanese patients</article-title>. <source>Human Genetics</source>. <year>1997</year>;<volume>100</volume>(<issue>3-4</issue>):<fpage>450</fpage>–<lpage>456</lpage>. <pub-id pub-id-type="doi">10.1007/s004390050532</pub-id><?supplied-pmid 9272171?><pub-id pub-id-type="pmid">9272171</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008453.ref057">
      <label>57</label>
      <mixed-citation publication-type="journal"><name><surname>Szklarczyk</surname><given-names>D</given-names></name>, <name><surname>Gable</surname><given-names>AL</given-names></name>, <name><surname>Lyon</surname><given-names>D</given-names></name>, <name><surname>Junge</surname><given-names>A</given-names></name>, <name><surname>Wyder</surname><given-names>S</given-names></name>, <name><surname>Huerta-Cepas</surname><given-names>J</given-names></name>, <etal>et al</etal><article-title>STRING v11: protein–protein association networks with increased coverage, supporting functional discovery in genome-wide experimental datasets</article-title>. <source>Nucleic Acids Research</source>. <year>2018</year>;<volume>47</volume>(<issue>D1</issue>):<fpage>D607</fpage>–<lpage>D613</lpage>. <pub-id pub-id-type="doi">10.1093/nar/gky1131</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008453.ref058">
      <label>58</label>
      <mixed-citation publication-type="journal"><name><surname>Buniello</surname><given-names>A</given-names></name>, <name><surname>MacArthur</surname><given-names>JA</given-names></name>, <name><surname>Cerezo</surname><given-names>M</given-names></name>, <name><surname>Harris</surname><given-names>LW</given-names></name>, <name><surname>Hayhurst</surname><given-names>J</given-names></name>, <name><surname>Malangone</surname><given-names>C</given-names></name>, <etal>et al</etal><article-title>The NHGRI-EBI GWAS Catalog of published genome-wide association studies, targeted arrays and summary statistics 2019</article-title>. <source>Nucleic Acids Research</source>. <year>2018</year>;<volume>47</volume>(<issue>D1</issue>):<fpage>D1005</fpage>–<lpage>D1012</lpage>. <pub-id pub-id-type="doi">10.1093/nar/gky1120</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008453.ref059">
      <label>59</label>
      <mixed-citation publication-type="journal"><name><surname>Ma</surname><given-names>J</given-names></name>, <name><surname>Yu</surname><given-names>MK</given-names></name>, <name><surname>Fong</surname><given-names>S</given-names></name>, <name><surname>Ono</surname><given-names>K</given-names></name>, <name><surname>Sage</surname><given-names>E</given-names></name>, <name><surname>Demchak</surname><given-names>B</given-names></name>, <etal>et al</etal><article-title>Using deep learning to model the hierarchical structure and function of a cell</article-title>. <source>Nature Methods</source>. <year>2018</year>;<volume>15</volume>(<issue>4</issue>):<fpage>290</fpage>–<lpage>298</lpage>. <pub-id pub-id-type="doi">10.1038/nmeth.4627</pub-id><?supplied-pmid 29505029?><pub-id pub-id-type="pmid">29505029</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008453.ref060">
      <label>60</label>
      <mixed-citation publication-type="journal"><name><surname>Consortium</surname><given-names>TU</given-names></name>. <article-title>UniProt: a worldwide hub of protein knowledge</article-title>. <source>Nucleic Acids Research</source>. <year>2018</year>;<volume>47</volume>(<issue>D1</issue>):<fpage>D506</fpage>–<lpage>D515</lpage>. <pub-id pub-id-type="doi">10.1093/nar/gky1049</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008453.ref061">
      <label>61</label>
      <mixed-citation publication-type="journal"><name><surname>Papatheodorou</surname><given-names>I</given-names></name>, <name><surname>Fonseca</surname><given-names>NA</given-names></name>, <name><surname>Keays</surname><given-names>M</given-names></name>, <name><surname>Tang</surname><given-names>Y</given-names></name>, <name><surname>Barrera</surname><given-names>E</given-names></name>, <name><surname>Bazant</surname><given-names>W</given-names></name>, <etal>et al</etal><article-title>Expression Atlas: gene and protein expression across multiple studies and organisms</article-title>. <source>Nucleic Acids Research</source>. <year>2017</year>;<volume>46</volume>(<issue>D1</issue>):<fpage>D246</fpage>–<lpage>D251</lpage>. <pub-id pub-id-type="doi">10.1093/nar/gkx1158</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008453.ref062">
      <label>62</label>
      <mixed-citation publication-type="journal"><name><surname>Ardlie</surname><given-names>KG</given-names></name>, <name><surname>Deluca</surname><given-names>DS</given-names></name>, <name><surname>Segrè</surname><given-names>AV</given-names></name>, <name><surname>Sullivan</surname><given-names>TJ</given-names></name>, <name><surname>Young</surname><given-names>TR</given-names></name>, <name><surname>Gelfand</surname><given-names>ET</given-names></name>, <etal>et al</etal><article-title>The Genotype-Tissue Expression (GTEx) pilot analysis: Multitissue gene regulation in humans</article-title>. <source>Science</source>. <year>2015</year>;<volume>348</volume>(<issue>6235</issue>):<fpage>648</fpage>–<lpage>660</lpage>. <pub-id pub-id-type="doi">10.1126/science.1262110</pub-id><pub-id pub-id-type="pmid">25954001</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008453.ref063">
      <label>63</label>
      <mixed-citation publication-type="journal"><name><surname>Radivojac</surname><given-names>P</given-names></name>, <name><surname>Clark</surname><given-names>WT</given-names></name>. <article-title>Information-theoretic evaluation of predicted ontological annotations</article-title>. <source>Bioinformatics</source>. <year>2013</year>;<volume>29</volume>(<issue>13</issue>):<fpage>i53</fpage>–<lpage>i61</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btt228</pub-id><?supplied-pmid 23813009?><pub-id pub-id-type="pmid">23813009</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008453.ref064">
      <label>64</label>
      <mixed-citation publication-type="journal"><name><surname>Fawcett</surname><given-names>T</given-names></name>. <article-title>An introduction to ROC analysis</article-title>. <source>Pattern Recogn Lett</source>. <year>2006</year>;<volume>27</volume>(<issue>8</issue>):<fpage>861</fpage>–<lpage>874</lpage>. <pub-id pub-id-type="doi">10.1016/j.patrec.2005.10.010</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008453.ref065">
      <label>65</label>
      <mixed-citation publication-type="journal"><name><surname>Hamosh</surname><given-names>A</given-names></name>, <name><surname>Scott</surname><given-names>AF</given-names></name>, <name><surname>Amberger</surname><given-names>JS</given-names></name>, <name><surname>Bocchini</surname><given-names>CA</given-names></name>, <name><surname>McKusick</surname><given-names>VA</given-names></name>. <article-title>Online Mendelian Inheritance in Man (OMIM), a knowledgebase of human genes and genetic disorders</article-title>. <source>Nucleic Acids Research</source>. <year>2005</year>;<volume>33</volume>(<issue>suppl_1</issue>):<fpage>D514</fpage>–<lpage>D517</lpage>. <pub-id pub-id-type="doi">10.1093/nar/gki033</pub-id><?supplied-pmid 15608251?><pub-id pub-id-type="pmid">15608251</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008453.ref066">
      <label>66</label>
      <mixed-citation publication-type="journal"><name><surname>Resnik</surname><given-names>P</given-names></name>. <article-title>Semantic Similarity in a Taxonomy: An Information-Based Measure and its Application to Problems of Ambiguity in Natural Language</article-title>. <source>Journal of Artificial Intelligence Research</source>. <year>1999</year>;<volume>11</volume>:<fpage>95</fpage>–<lpage>130</lpage>. <pub-id pub-id-type="doi">10.1613/jair.514</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008453.ref067">
      <label>67</label>
      <mixed-citation publication-type="journal"><name><surname>Schlicker</surname><given-names>A</given-names></name>, <name><surname>Domingues</surname><given-names>FS</given-names></name>, <name><surname>Rahnenführer</surname><given-names>J</given-names></name>, <name><surname>Lengauer</surname><given-names>T</given-names></name>. <article-title>A new measure for functional similarity of gene products based on Gene Ontology</article-title>. <source>BMC Bioinformatics</source>. <year>2006</year>;<volume>7</volume>(<issue>1</issue>):<fpage>302</fpage><pub-id pub-id-type="doi">10.1186/1471-2105-7-302</pub-id><?supplied-pmid 16776819?><pub-id pub-id-type="pmid">16776819</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008453.ref068">
      <label>68</label>
      <mixed-citation publication-type="other">Kingma DP, Ba J. Adam: A Method for Stochastic Optimization; 2014. Available from: <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/1412.6980">http://arxiv.org/abs/1412.6980</ext-link>.</mixed-citation>
    </ref>
    <ref id="pcbi.1008453.ref069">
      <label>69</label>
      <mixed-citation publication-type="other">Abadi M, Barham P, Chen J, Chen Z, Davis A, Dean J, et al. TensorFlow: A System for Large-scale Machine Learning. In: Proceedings of the 12th USENIX Conference on Operating Systems Design and Implementation. OSDI’16. Berkeley, CA, USA: USENIX Association; 2016. p. 265–283. Available from: <ext-link ext-link-type="uri" xlink:href="http://dl.acm.org/citation.cfm?id=3026877.3026899">http://dl.acm.org/citation.cfm?id=3026877.3026899</ext-link>.</mixed-citation>
    </ref>
  </ref-list>
</back>
<sub-article id="pcbi.1008453.r001" article-type="aggregated-review-documents">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1008453.r001</article-id>
    <title-group>
      <article-title>Decision Letter 0</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Greene</surname>
          <given-names>Casey S.</given-names>
        </name>
        <role>Guest Editor</role>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ma</surname>
          <given-names>Jian</given-names>
        </name>
        <role>Deputy Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2020 Greene, Ma</copyright-statement>
      <copyright-year>2020</copyright-year>
      <copyright-holder>Greene, Ma</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article id="rel-obj001" ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1008453" related-article-type="reviewed-article"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>0</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">16 Aug 2020</named-content>
    </p>
    <p>Dear Mr. Kulmanov,</p>
    <p>Thank you very much for submitting your manuscript "DeepPheno: Predicting single gene loss-of-function phenotypes using an ontology-aware hierarchical classifier" for consideration at PLOS Computational Biology.</p>
    <p>As with all papers reviewed by the journal, your manuscript was reviewed by members of the editorial board and by several independent reviewers. In light of the reviews (below this email), we would like to invite the resubmission of a significantly-revised version that takes into account the reviewers' comments.</p>
    <p>Reviewer 3 notes certain structural issues with the manuscript, and I agree with these. I nearly sent the manuscript back before review, but elected in the end to send it out for review with plans to note the structural considerations at this stage. As I was reading the manuscript, I also found myself thinking conceptually about the structure of the method proposed in Ma et al. (<ext-link ext-link-type="uri" xlink:href="https://www.nature.com/articles/nmeth.4627">https://www.nature.com/articles/nmeth.4627</ext-link>). Discussing how this work fits conceptually with related work in the area (also noted by Reviewer 3) would make it more accessible to the interested reader who may not know the details of every method within the field.</p>
    <p>We cannot make any decision about publication until we have seen the revised manuscript and your response to the reviewers' comments. Your revised manuscript is also likely to be sent to reviewers for further evaluation.</p>
    <p>When you are ready to resubmit, please upload the following:</p>
    <p>[1] A letter containing a detailed list of your responses to the review comments and a description of the changes you have made in the manuscript. Please note while forming your response, if your article is accepted, you may have the opportunity to make the peer review history publicly available. The record will include editor decision letters (with reviews) and your responses to reviewer comments. If eligible, we will contact you to opt in or out.</p>
    <p>[2] Two versions of the revised manuscript: one with either highlights or tracked changes denoting where the text has been changed; the other a clean version (uploaded as the manuscript file).</p>
    <p>Important additional instructions are given below your reviewer comments.</p>
    <p>Please prepare and submit your revised manuscript within 60 days. If you anticipate any delay, please let us know the expected resubmission date by replying to this email. Please note that revised manuscripts received after the 60-day due date may require evaluation and peer review similar to newly submitted manuscripts.</p>
    <p>Thank you again for your submission. We hope that our editorial process has been constructive so far, and we welcome your feedback at any time. Please don't hesitate to contact us if you have any questions or comments.</p>
    <p>Sincerely,</p>
    <p>Casey S. Greene</p>
    <p>Guest Editor</p>
    <p>PLOS Computational Biology</p>
    <p>Jian Ma</p>
    <p>Deputy Editor</p>
    <p>PLOS Computational Biology</p>
    <p>***********************</p>
    <p>Reviewer 3 notes certain structural issues with the manuscript, and I agree with these. I nearly sent the manuscript back before review, but elected in the end to send it out for review with plans to note the structural considerations at this stage. As I was reading the manuscript, I also found myself thinking conceptually about the structure of the method proposed in Ma et al. (<ext-link ext-link-type="uri" xlink:href="https://www.nature.com/articles/nmeth.4627">https://www.nature.com/articles/nmeth.4627</ext-link>). Discussing how this work fits conceptually with related work in the area (also noted by Reviewer 3) would make it more accessible to the interested reader who may not know the details of every method within the field.</p>
    <p>Reviewer's Responses to Questions</p>
    <p>
      <bold>Comments to the Authors:</bold>
    </p>
    <p>
      <bold>Please note here if the review is uploaded as an attachment.</bold>
    </p>
    <p><bold>Reviewer #1: </bold>The authors are predicting genotype-phenotype association using a neural network where GO annotations of gene functions are used as features. The model is trained and tested on Human Phenotype Ontology (HPO) data and CAFA2 data. In terms of evaluation metrics, the authors are by and large using the metrics used in the CAFA2 project.</p>
    <p>On the CAFA2 benchmark dataset DeepPheno has the highest F_max score compared to all the top methods in CAFA2. This shows the model is indeed learning to connect genotype with phenotype. On the CAFA2 training data sub-ontologies, the performance is mixed where in many cases other methods are performing better. Overall, the paper is increasing the state-of-the-art performance in many aspects for the genotype-phenotype association problem which is praiseworthy.</p>
    <p>Having said that, I have the following comments about some aspects-</p>
    <p>1. I would like to compare the performance on CAFA2 datasets with a vanilla random forest that is taking the same input as DeepPheno as my first baseline. Random forests often surprisingly provide a strong baseline that is comparable or better than neural networks.</p>
    <p>2. I am not convinced about the novelty of hierarchical classifier the authors are claiming. I don’t think this needs to be emphasized on the paper. Authors can provide their justification but this is a simple matrix multiplication.</p>
    <p>3. I am not convinced of the analysis of the false positive predictions the authors performed. I don’t think the analysis done with the STRING dataset brings any confirmation or refutation of the false positives. The anecdotal examples mentioned in the False positive section also show that the majority of false positive predictions do not correspond to genotype-phenotype associations. The extrapolation by the authors seems a bit far fetched.</p>
    <p>4. There is no guideline on the github page of the paper on how to apply their method on new datasets. Other researchers should be able to apply this method on their dataset with minimum knowledge.</p>
    <p>Overall, this is a straight-forward paper that improves upon the performance by current methods. I would make some of the other claims in a more cautious manner.</p>
    <p><bold>Reviewer #2:</bold> Reproducibility Report has been uploaded as an attachment.</p>
    <p><bold>Reviewer #3:</bold> In this manuscript, the authors proposed a new gene-loss-of-function based phenotype prediction method that utilizes HPO terms, entitled DeepPheno, based on machine/deep learning. The study is relevant as novel in silico approaches are always required in the fields of protein function prediction and disease association prediction. The manuscript is mostly written well in terms of the use of English; but the sectioning of the text is a little bit problematic. The proposed methodology is novel and effective; however, there are critical issues related to the current state of the manuscript. Below, I list my specific concerns/issues:</p>
    <p>Major issues:</p>
    <p>1) The compartmentalization of the information into sections and sub-sections has issues, which makes it difficult to read the manuscript. For example, some technicalities regarding the structure of DeepPheno is provided at the beginning of the Results section, instead of the Methods section (i.e., the sub-section entitled DeepPheno Model should be under the methods). Additionally, some of the small-scale analyses are given in the discussion section (i.e., under False Positives sub-section), instead of the Results section. Sectioning should be re-considered from beginning to the end of the manuscript.</p>
    <p>2) An additional test should be done considering the performance of DeepPheno on phenotypic terms from varying specificity groups. This grouping may either be based on the levels on the hierarchy of HPO or the number of annotated genes. Since DeepPheno uses deep neural networks and require a certain number of training instances to be able to predict a term, this analysis and its discussion may be critical and will help the reader in terms of machine learning algorithm selection according to the task and data at hand, in future predictive modeling studies.</p>
    <p>3) There should be a use-case study to indicate the real-world value of DeepPheno, beyond performance calculations over the known data. This can be a case where DeepPheno predicts a specific gene-HPO association, which was not presented in the latest version of HPO, thus counted as a false positive. This case can be investigated over the literature to find an evidence for the predicted relation, as a means of validation. There already are a few examples in the discussion part regarding type II diabetes and GWAS; however, this example is also based on statistics and do not delve into the biological relevance of why those 4-5 genes should be associated with type II diabetes.</p>
    <p>4) There are two points regarding a related and cited study, HPO2GO. First of all, the idea of relating the occurrence of a phenotype to the lost function, and thus, using the GO annotations of genes/proteins to predict their phenotypic implications has already been proposed in the HPO2GO study. The same logic is used for DeepPheno as well. This inspiration should be mentioned in this manuscript by referring to HPO2GO in the relevant parts of the text, at least along with the other works that inspired this idea.</p>
    <p>Second, considering Table 2 and Figure 2:</p>
    <p>In its own paper, HPO2GO’s finalized CAFA2 performance is reported to be Fmax = 0.35. Here in thew proposed manuscript, the reported performance of HPO2GO is similar to one of its sub-optimal versions explained in the corresponding article. Since CAFA challenge clearly states the train/test datasets to be used, and directly provides the performance calculation scripts, the results reported in different papers (where the authors state that they obey the CAFA rules) are directly comparable to each other. As a result, it is better to use the optimal CAFA2 results reported in the HPO2GO paper.</p>
    <p>5) The information about the neural network layering is confusing. In figure 1 and the related text, it is stated that there are 2 layers: “The first layer is responsible for reducing the dimensionality of our sparse function annotation input and expression values are concatenated to it. The second layer is a multi-class multi-label classification layer with sigmoid activation functions for each neuron.” However, in the Training and tuning of model parameters sub-section it is stated that the authors evaluated several models with two, three and four fully connected layer models. Where are these models and their performance results? What are the details of these 3-4 layered models? Did the authors settle for the 2 layered model at the end? If so, what was the reason behind? Was it that the 2 layered model performed the best? Or, did the performance gain by increasing the layers did not compensate for the increase in computational complexity?</p>
    <p>Related to this, a few hyper-parameters have been mentioned under Training and tuning of model parameters sub-section. How about the rest of the widely considered hyper-parameters in deep learning-based method development studies (e.g., using mini batches or not, if so, what is the size; and did you use batch normalization), have these been optimized as well, or the default value has been incorporated directly?</p>
    <p>6) "Our phenotype prediction model is a fully-connected neural network followed by a novel hierarchical classification layer which encodes the ontology structure into the neural network. "</p>
    <p>The technical details of this hierarchical classification layer are explained; however, this is a critical step in the proposed method, and the authors emphasize this as one of the important values added to the literature by this study. As a result, it should be explained and discussed in more detail. It is not clear how the hierarchical structure of the ontologies is taken into account inside the deep neural network. The authors stated that, this is achieved by multiplying the values of neurons at the second layer, with a matrix that represents the ontology structure, and then, max pooling is applied. Is this done to transfer, for example, the positive prediction given to a child term to its parent term, so that, even if the parent term did not receive a prediction itself, the system will change this to a positive prediction because its descendant received a positive prediction? If so, this will always behave towards increasing the number of predictions, and thus, the false positives. Moreover, are the flat versions the same models, only without this operation? Please provide precision and recall values in Table 1 along with the given metrics so that the reader can observe the effect of this operation and its advantages/disadvantages over the flat predictions. Please explain this hierarchical operation in more detail over a toy-example (e.g., imaginary prediction of an HPO term with and without the hierarchical processing).</p>
    <p>7) The sizes of the feature vectors should be provided (in terms of both GO and gene expression).</p>
    <p>8) “The best performance in AUROC of 0.75 among methods which use predicted phenotypes were achieved by our DeepPhenoAG and DeepPheno models. Table 4 summarizes the results. Overall, this evaluation shows that our model is predicting phenotype associations which can be used for predicting gene-disease associations.”</p>
    <p>It is not clear how did authors draw this conclusion. Although higher than Naïve, AUROC values between 0.70-0.75 is not considered sufficiently high, so that they could be used with confidence. You can state that this is better compared to random prediction by a margin, but this value alone is not sufficient to say that DeepPheno can be used for predicting gene-disease associations, without further analysis.</p>
    <p>9) “Specifically, it is designed to predict phenotypes which arise from a complete loss of function of a gene.”</p>
    <p>Authors emphasize this at multiple locations of the manuscript; however, it’s not clear why this should be a complete loss of function. It can very well be a partial loss of function that give rise to the occurrence of a phenotype. Authors should either explain this in detail or change their statement.</p>
    <p>Minor issues:</p>
    <p>1) “Similarity between observed phenotypes can be used to infer similarity between</p>
    <p>molecular mechanisms, even across different species. In humans, the Human Phenotype Ontology (HPO) [8] provides an ontology for characterizing phenotypes and a wide range of genotype{phenotype associations have been created based on the human phenotype ontology.”</p>
    <p>Please re-write these sentences, they are problematic in terms of the use of language.</p>
    <p>2) “We use 10% of the training set as a validation set to tune the parameters of our prediction model. We generate 5 folds of random split and report 5-fold cross-validation results.”</p>
    <p>It is not clear how this is done. Normally, when a 5-fold CV is carried out it means that the training dataset is split into 5 pieces and each fold comprise 20% of the dataset. What is the meaning behind using 10% of the training set as a validation set here?</p>
    <p>3) “We use interactions with a score of 700 or above in order to filter high confidence interactions.”</p>
    <p>Scores in StringDB vary between 0 and 1, should this be 0.7?</p>
    <p>4) “The value of the vector si at position j is 1 iff pj is a (reflexive) …”</p>
    <p>Typo.</p>
    <p>**********</p>
    <p>
      <bold>Have all data underlying the figures and results presented in the manuscript been provided?</bold>
    </p>
    <p>Large-scale datasets should be made available via a public repository as described in the <italic>PLOS Computational Biology</italic>
<ext-link ext-link-type="uri" xlink:href="http://journals.plos.org/ploscompbiol/s/data-availability">data availability policy</ext-link>, and numerical data that underlies graphs or summary statistics should be provided in spreadsheet form as supporting information.</p>
    <p>Reviewer #1: Yes</p>
    <p>Reviewer #2: None</p>
    <p>Reviewer #3: Yes</p>
    <p>**********</p>
    <p>PLOS authors have the option to publish the peer review history of their article (<ext-link ext-link-type="uri" xlink:href="https://journals.plos.org/ploscompbiol/s/editorial-and-peer-review-process#loc-peer-review-history">what does this mean?</ext-link>). If published, this will include your full peer review and any attached files.</p>
    <p>If you choose “no”, your identity will remain anonymous but your review may still be made public.</p>
    <p><bold>Do you want your identity to be public for this peer review?</bold> For information about this choice, including consent withdrawal, please see our <ext-link ext-link-type="uri" xlink:href="https://www.plos.org/privacy-policy">Privacy Policy</ext-link>.</p>
    <p>Reviewer #1: No</p>
    <p>Reviewer #2: <bold>Yes: </bold>Anand K. Rampadarath</p>
    <p>Reviewer #3: No</p>
    <p>
      <underline>Figure Files:</underline>
    </p>
    <p>While revising your submission, please upload your figure files to the Preflight Analysis and Conversion Engine (PACE) digital diagnostic tool, <underline><ext-link ext-link-type="uri" xlink:href="https://pacev2.apexcovantage.com/" xlink:type="simple">https://pacev2.apexcovantage.com</ext-link></underline>. PACE helps ensure that figures meet PLOS requirements. To use PACE, you must first register as a user. Then, login and navigate to the UPLOAD tab, where you will find detailed instructions on how to use the tool. If you encounter any issues or have any questions when using PACE, please email us at <underline><email xlink:type="simple">figures@plos.org</email></underline>.</p>
    <p>
      <underline>Data Requirements:</underline>
    </p>
    <p>Please note that, as a condition of publication, PLOS' data policy requires that you make available all data used to draw the conclusions outlined in your manuscript. Data must be deposited in an appropriate repository, included within the body of the manuscript, or uploaded as supporting information. This includes all numerical values that were used to generate graphs, histograms etc.. For an example in PLOS Biology see here: <ext-link ext-link-type="uri" xlink:href="http://www.plosbiology.org/article/info%3Adoi%2F10.1371%2Fjournal.pbio.1001908#s5">http://www.plosbiology.org/article/info%3Adoi%2F10.1371%2Fjournal.pbio.1001908#s5</ext-link>.</p>
    <p>
      <underline>Reproducibility:</underline>
    </p>
    <p>To enhance the reproducibility of your results, PLOS recommends that you deposit laboratory protocols in protocols.io, where a protocol can be assigned its own identifier (DOI) such that it can be cited independently in the future. For instructions, please see <underline><ext-link ext-link-type="uri" xlink:href="http://journals.plos.org/plospathogens/s/submission-guidelines" xlink:type="simple">http://journals.plos.org/compbiol/s/submission-guidelines#loc-materials-and-methods</ext-link></underline></p>
    <supplementary-material content-type="local-data" id="pcbi.1008453.s004">
      <label>Attachment</label>
      <caption>
        <p>Submitted filename: <named-content content-type="submitted-filename">Reproducible_report_PCOMPBIOL_D_20_01270.pdf</named-content></p>
      </caption>
      <media xlink:href="pcbi.1008453.s004.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </body>
</sub-article>
<sub-article id="pcbi.1008453.r002" article-type="author-comment">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1008453.r002</article-id>
    <title-group>
      <article-title>Author response to Decision Letter 0</article-title>
    </title-group>
    <related-article id="rel-obj002" ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1008453" related-article-type="editor-report"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>1</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="author-response-date">6 Oct 2020</named-content>
    </p>
    <supplementary-material content-type="local-data" id="pcbi.1008453.s005">
      <label>Attachment</label>
      <caption>
        <p>Submitted filename: <named-content content-type="submitted-filename">response.pdf</named-content></p>
      </caption>
      <media xlink:href="pcbi.1008453.s005.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </body>
</sub-article>
<sub-article id="pcbi.1008453.r003" article-type="aggregated-review-documents">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1008453.r003</article-id>
    <title-group>
      <article-title>Decision Letter 1</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Greene</surname>
          <given-names>Casey S.</given-names>
        </name>
        <role>Guest Editor</role>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ma</surname>
          <given-names>Jian</given-names>
        </name>
        <role>Deputy Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2020 Greene, Ma</copyright-statement>
      <copyright-year>2020</copyright-year>
      <copyright-holder>Greene, Ma</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article id="rel-obj003" ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1008453" related-article-type="reviewed-article"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>1</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">20 Oct 2020</named-content>
    </p>
    <p>Dear Mr. Kulmanov,</p>
    <p>We are pleased to inform you that your manuscript 'DeepPheno: Predicting single gene loss-of-function phenotypes using an ontology-aware hierarchical classifier' has been provisionally accepted for publication in PLOS Computational Biology.</p>
    <p>Before your manuscript can be formally accepted you will need to complete some formatting changes, which you will receive in a follow up email. A member of our team will be in touch with a set of requests.</p>
    <p>Please note that your manuscript will not be scheduled for publication until you have made the required changes, so a swift response is appreciated.</p>
    <p>IMPORTANT: The editorial review process is now complete. PLOS will only permit corrections to spelling, formatting or significant scientific errors from this point onwards. Requests for major changes, or any which affect the scientific understanding of your work, will cause delays to the publication date of your manuscript.</p>
    <p>Should you, your institution's press office or the journal office choose to press release your paper, you will automatically be opted out of early publication. We ask that you notify us now if you or your institution is planning to press release the article. All press must be co-ordinated with PLOS.</p>
    <p>Thank you again for supporting Open Access publishing; we are looking forward to publishing your work in PLOS Computational Biology. </p>
    <p>Best regards,</p>
    <p>Casey S. Greene</p>
    <p>Guest Editor</p>
    <p>PLOS Computational Biology</p>
    <p>Jian Ma</p>
    <p>Deputy Editor</p>
    <p>PLOS Computational Biology</p>
    <p>***********************************************************</p>
    <p>Your manuscript has now been re-reviewed and is acceptable for publication. I would note that the software that you are describing is currently distributed through GitHub, which is not archival in a way that is ideal for scholarly work. I have requested an archive at Software Heritage, which is now available: <ext-link ext-link-type="uri" xlink:href="https://archive.softwareheritage.org/browse/origin/directory/?origin_url=https://github.com/bio-ontology-research-group/deeppheno">https://archive.softwareheritage.org/browse/origin/directory/?origin_url=https://github.com/bio-ontology-research-group/deeppheno</ext-link> . If you would like to have a directly citable, archived version of your software then I would strongly encourage you to upload the software to figshare( <ext-link ext-link-type="uri" xlink:href="https://figshare.com/">https://figshare.com/</ext-link> ) and to provide the figshare DOI in a software availability section of your manuscript. Please also note the reproducibility report. The results could not be reproduced due to dependency issues with TensorFlow. It could be wise to have a group independently test your software and instructions to improve the instructions that you provide to readers.</p>
    <p>Reviewer's Responses to Questions</p>
    <p>
      <bold>Comments to the Authors:</bold>
    </p>
    <p>
      <bold>Please note here if the review is uploaded as an attachment.</bold>
    </p>
    <p>Reviewer #1: Thank you for addressing my concerns.</p>
    <p>Reviewer #2: Reproducibility report has been uploaded as an attachment.</p>
    <p>Reviewer #3: I would like to thank authors for properly addressing my concerns.</p>
    <p>**********</p>
    <p>
      <bold>Have all data underlying the figures and results presented in the manuscript been provided?</bold>
    </p>
    <p>Large-scale datasets should be made available via a public repository as described in the <italic>PLOS Computational Biology</italic>
<ext-link ext-link-type="uri" xlink:href="http://journals.plos.org/ploscompbiol/s/data-availability">data availability policy</ext-link>, and numerical data that underlies graphs or summary statistics should be provided in spreadsheet form as supporting information.</p>
    <p>Reviewer #1: Yes</p>
    <p>Reviewer #2: None</p>
    <p>Reviewer #3: Yes</p>
    <p>**********</p>
    <p>PLOS authors have the option to publish the peer review history of their article (<ext-link ext-link-type="uri" xlink:href="https://journals.plos.org/ploscompbiol/s/editorial-and-peer-review-process#loc-peer-review-history">what does this mean?</ext-link>). If published, this will include your full peer review and any attached files.</p>
    <p>If you choose “no”, your identity will remain anonymous but your review may still be made public.</p>
    <p><bold>Do you want your identity to be public for this peer review?</bold> For information about this choice, including consent withdrawal, please see our <ext-link ext-link-type="uri" xlink:href="https://www.plos.org/privacy-policy">Privacy Policy</ext-link>.</p>
    <p>Reviewer #1: No</p>
    <p>Reviewer #2: No</p>
    <p>Reviewer #3: <bold>Yes: </bold>Tunca Dogan</p>
    <supplementary-material content-type="local-data" id="pcbi.1008453.s006">
      <label>Attachment</label>
      <caption>
        <p>Submitted filename: <named-content content-type="submitted-filename">Reproducible_report_PCOMPBIOL_D_20_01270R1.pdf</named-content></p>
      </caption>
      <media xlink:href="pcbi.1008453.s006.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </body>
</sub-article>
<sub-article id="pcbi.1008453.r004" article-type="editor-report">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1008453.r004</article-id>
    <title-group>
      <article-title>Acceptance letter</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Greene</surname>
          <given-names>Casey S.</given-names>
        </name>
        <role>Guest Editor</role>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ma</surname>
          <given-names>Jian</given-names>
        </name>
        <role>Deputy Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2020 Greene, Ma</copyright-statement>
      <copyright-year>2020</copyright-year>
      <copyright-holder>Greene, Ma</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article id="rel-obj004" ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1008453" related-article-type="reviewed-article"/>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">12 Nov 2020</named-content>
    </p>
    <p>PCOMPBIOL-D-20-01270R1 </p>
    <p>DeepPheno: Predicting single gene loss-of-function phenotypes using an ontology-aware hierarchical classifier</p>
    <p>Dear Dr Kulmanov,</p>
    <p>I am pleased to inform you that your manuscript has been formally accepted for publication in PLOS Computational Biology. Your manuscript is now with our production department and you will be notified of the publication date in due course.</p>
    <p>The corresponding author will soon be receiving a typeset proof for review, to ensure errors have not been introduced during production. Please review the PDF proof of your manuscript carefully, as this is the last chance to correct any errors. Please note that major changes, or those which affect the scientific understanding of the work, will likely cause delays to the publication date of your manuscript. </p>
    <p>Soon after your final files are uploaded, unless you have opted out, the early version of your manuscript will be published online. The date of the early version will be your article's publication date. The final article will be published to the same URL, and all versions of the paper will be accessible to readers.</p>
    <p>Thank you again for supporting PLOS Computational Biology and open-access publishing. We are looking forward to publishing your work! </p>
    <p>With kind regards,</p>
    <p>Nicola Davies</p>
    <p>PLOS Computational Biology | Carlyle House, Carlyle Road, Cambridge CB4 3DN | United Kingdom <email>ploscompbiol@plos.org</email> | Phone +44 (0) 1223-442824 | <ext-link ext-link-type="uri" xlink:href="http://ploscompbiol.org">ploscompbiol.org</ext-link> | @PLOSCompBiol</p>
  </body>
</sub-article>
