<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20070202//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing.dtd?>
<?SourceDTD.Version 2.3?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Front Behav Neurosci</journal-id>
    <journal-id journal-id-type="iso-abbrev">Front Behav Neurosci</journal-id>
    <journal-id journal-id-type="publisher-id">Front. Behav. Neurosci.</journal-id>
    <journal-title-group>
      <journal-title>Frontiers in Behavioral Neuroscience</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1662-5153</issn>
    <publisher>
      <publisher-name>Frontiers Media S.A.</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7416652</article-id>
    <article-id pub-id-type="doi">10.3389/fnbeh.2020.00116</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Neuroscience</subject>
        <subj-group>
          <subject>Methods</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>SnakeStrike: A Low-Cost Open-Source High-Speed Multi-Camera Motion Capture System</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Jensen</surname>
          <given-names>Grady W.</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="aff2">
          <sup>2</sup>
        </xref>
        <xref ref-type="corresp" rid="c001">
          <sup>*</sup>
        </xref>
        <uri xlink:type="simple" xlink:href="http://loop.frontiersin.org/people/923566/overview"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>van der Smagt</surname>
          <given-names>Patrick</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="aff2">
          <sup>2</sup>
        </xref>
        <xref ref-type="aff" rid="aff3">
          <sup>3</sup>
        </xref>
        <uri xlink:type="simple" xlink:href="http://loop.frontiersin.org/people/67698/overview"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Heiss</surname>
          <given-names>Egon</given-names>
        </name>
        <xref ref-type="aff" rid="aff4">
          <sup>4</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Straka</surname>
          <given-names>Hans</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="aff5">
          <sup>5</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Kohl</surname>
          <given-names>Tobias</given-names>
        </name>
        <xref ref-type="aff" rid="aff6">
          <sup>6</sup>
        </xref>
        <uri xlink:type="simple" xlink:href="http://loop.frontiersin.org/people/914422/overview"/>
      </contrib>
    </contrib-group>
    <aff id="aff1"><sup>1</sup><institution>Graduate School of Systemic Neurosciences (GSN-LMU), Ludwig-Maximilians-University Munich</institution>, <addr-line>Munich</addr-line>, <country>Germany</country></aff>
    <aff id="aff2"><sup>2</sup><institution>argmax.ai, Volkswagen Group Machine Learning Research Lab</institution>, <addr-line>Munich</addr-line>, <country>Germany</country></aff>
    <aff id="aff3"><sup>3</sup><institution>Department of Artificial Intelligence, Faculty of Informatics, Eötvös Lórand University</institution>, <addr-line>Budapest</addr-line>, <country>Hungary</country></aff>
    <aff id="aff4"><sup>4</sup><institution>Institute of Zoology and Evolutionary Research, Friedrich-Schiller-University of Jena</institution>, <addr-line>Jena</addr-line>, <country>Germany</country></aff>
    <aff id="aff5"><sup>5</sup><institution>Department Biology II, Ludwig-Maximilians-University Munich</institution>, <addr-line>Munich</addr-line>, <country>Germany</country></aff>
    <aff id="aff6"><sup>6</sup><institution>Chair of Zoology, Technical University of Munich</institution>, <addr-line>Freising</addr-line>, <country>Germany</country></aff>
    <author-notes>
      <fn fn-type="edited-by">
        <p>Edited by: Ralf Heinrich, University of Göttingen, Germany</p>
      </fn>
      <fn fn-type="edited-by">
        <p>Reviewed by: Bart R. H. Geurten, University of Göttingen, Germany; Andrew D. Straw, University of Freiburg, Germany</p>
      </fn>
      <corresp id="c001">*Correspondence: Grady W. Jensen, <email>gradywjensen@gmail.com</email></corresp>
      <fn fn-type="other" id="fn004">
        <p>This article was submitted to Individual and Social Behaviors, a section of the journal Frontiers in Behavioral Neuroscience</p>
      </fn>
    </author-notes>
    <pub-date pub-type="epub">
      <day>03</day>
      <month>8</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2020</year>
    </pub-date>
    <volume>14</volume>
    <elocation-id>116</elocation-id>
    <history>
      <date date-type="received">
        <day>05</day>
        <month>3</month>
        <year>2020</year>
      </date>
      <date date-type="accepted">
        <day>10</day>
        <month>6</month>
        <year>2020</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Copyright © 2020 Jensen, van der Smagt, Heiss, Straka and Kohl.</copyright-statement>
      <copyright-year>2020</copyright-year>
      <copyright-holder>Jensen, van der Smagt, Heiss, Straka and Kohl</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License (CC BY). The use, distribution or reproduction in other forums is permitted, provided the original author(s) and the copyright owner(s) are credited and that the original publication in this journal is cited, in accordance with accepted academic practice. No use, distribution or reproduction is permitted which does not comply with these terms.</license-p>
      </license>
    </permissions>
    <abstract>
      <p>Current neuroethological experiments require sophisticated technologies to precisely quantify the behavior of animals. In many studies, solutions for video recording and subsequent tracking of animal behavior form a major bottleneck. Three-dimensional (3D) tracking systems have been available for a few years but are usually very expensive and rarely include very high-speed cameras; access to these systems for research is limited. Additionally, establishing custom-built software is often time consuming – especially for researchers without high-performance programming and computer vision expertise. Here, we present an open-source software framework that allows researchers to utilize low-cost high-speed cameras in their research for a fraction of the cost of commercial systems. This software handles the recording of synchronized high-speed video from multiple cameras, the offline 3D reconstruction of that video, and a viewer for the triangulated data, all functions previously also available as separate applications. It supports researchers with a performance-optimized suite of functions that encompass the entirety of data collection and decreases processing time for high-speed 3D position tracking on a variety of animals, including snakes. Motion capture in snakes can be particularly demanding since a strike can be as short as 50 ms, literally twice as fast as the blink of an eye. This is too fast for faithful recording by most commercial tracking systems and therefore represents a challenging test to our software for quantification of animal behavior. Therefore, we conducted a case study investigating snake strike speed to showcase the use and integration of the software in an existing experimental setup.</p>
    </abstract>
    <kwd-group>
      <kwd>motion capture</kwd>
      <kwd>high-speed</kwd>
      <kwd>opensource</kwd>
      <kwd>tracking</kwd>
      <kwd>snake</kwd>
      <kwd>strike</kwd>
    </kwd-group>
    <counts>
      <fig-count count="6"/>
      <table-count count="2"/>
      <equation-count count="0"/>
      <ref-count count="46"/>
      <page-count count="16"/>
      <word-count count="0"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec id="S1">
    <title>Introduction</title>
    <p>High-speed video recording is a common tool to visualize and subsequently quantify fast behavioral performances such as in snakes (<xref rid="B23" ref-type="bibr">Kardong and Bels, 1998</xref>; <xref rid="B46" ref-type="bibr">Young, 2010</xref>; <xref rid="B17" ref-type="bibr">Herrel et al., 2011</xref>; <xref rid="B30" ref-type="bibr">Penning et al., 2016</xref>; <xref rid="B35" ref-type="bibr">Ryerson and Tan, 2017</xref>), other fast moving animals (<xref rid="B29" ref-type="bibr">Patek et al., 2004</xref>; <xref rid="B44" ref-type="bibr">Tobalske et al., 2007</xref>; <xref rid="B37" ref-type="bibr">Seid et al., 2008</xref>), or insect flight (e.g. <xref rid="B1" ref-type="bibr">Altshuler et al., 2005</xref>; <xref rid="B3" ref-type="bibr">Boeddeker et al., 2010</xref>; <xref rid="B11" ref-type="bibr">Geurten et al., 2010</xref>; <xref rid="B39" ref-type="bibr">Straw et al., 2011</xref>). However, in most snake studies only one camera or a maximum of two are used to capture such rapid motion, with the one exception of a recent study where multiple cameras with only moderate temporal resolution, were used to investigate locomotor maneuvers (<xref rid="B10" ref-type="bibr">Gart et al., 2019</xref>). Software such as DLTdv (<xref rid="B16" ref-type="bibr">Hedrick, 2008</xref>), Tracker (Open Source Physics)<sup><xref ref-type="fn" rid="footnote1">1</xref></sup>, ImageJ (<xref rid="B32" ref-type="bibr">Rasband, 1997-2018</xref>), or Didge (Alistair Cullum, Creighton University) have usually been used to process the captured images. These open source solutions are suitable tools to use when capturing with a single camera and with a known distance to the recorded object(s), with an exception for DLTdv as it performs triangulation when combined with calibration information provided by a different software. Single camera capture, however, creates some limitations. Using a mirror allows a single camera to perceive multiple views of the snake such as done by <xref rid="B23" ref-type="bibr">Kardong and Bels (1998)</xref>, but any time a single camera is used to capture three-dimensional (3D) information, the camera must be placed in a setup that is stereotypically well-defined in a way that the distances such as between camera sensors or from the camera sensor to the object are known. The inflexibility of these well-defined setups can be troublesome for the use in multiple experiments, requires extra expertise, and entails extra costs for building and storage.</p>
    <p>Motion capture technology using multiple infrared cameras has been available for experimental studies already for decades. While one of the principal fields of employment for these systems was and still is the capture of human motion, this technology has been used in more recent years for the tracking of animal locomotion (<xref rid="B8" ref-type="bibr">Dahmen and Zeil, 1984</xref>; <xref rid="B9" ref-type="bibr">Fry et al., 2000</xref>; <xref rid="B39" ref-type="bibr">Straw et al., 2011</xref>; <xref rid="B43" ref-type="bibr">Tian et al., 2011</xref>; <xref rid="B41" ref-type="bibr">Theunissen and Dürr, 2013</xref>; <xref rid="B33" ref-type="bibr">Robie et al., 2017</xref>; <xref rid="B42" ref-type="bibr">Theunissen et al., 2017</xref>). Systems such as Vicon, Optitrack, Motion Analysis, Qualisys, or XSense are largely comparable and use infrared reflective spherical surface markers on the subject of interest that are tracked by multiple spatially fixed cameras and allow triangulating the positions of various body parts in virtual 3D space. In contrast, active marker-based tracking systems such as Dari Motion, Myomotion, NDI, or marker-less systems, commonly use depth information and a wire-frame, or similar, model of the tracked object mostly for applications involving humans. These model-based systems are expensive with costs that range from $10,000 to $100,000, though some open source algorithms are available for human pose estimation in video recordings (e.g. OpenPose, <xref rid="B6" ref-type="bibr">Cao et al., 2018</xref>, DeepPose, <xref rid="B45" ref-type="bibr">Toshev and Szegedy, 2014</xref>, ArtTrack, <xref rid="B18" ref-type="bibr">Insafutdinov et al., 2017</xref>, and DeeperCut, <xref rid="B19" ref-type="bibr">Insafutdinov et al., 2016</xref>). While commercial systems work well with low reconstruction error and ease of use, this technology is rather insufficient for high-speed motion capture, mostly because of the typically low maximal camera frame rates of 100–250 Hz. Accordingly, details of ultrafast movements such as strikes of rattlesnakes, which from initiation to target contact are completed within ∼0.05 s (<xref rid="B23" ref-type="bibr">Kardong and Bels, 1998</xref>; <xref rid="B30" ref-type="bibr">Penning et al., 2016</xref>) require a camera with a capture frame rate well beyond 200 Hz. At such a frame rate, and using a state-of-the-art tracking procedure, optical recordings of a rattlesnake strike would comprise a mere 10 frames of triangulated trajectory. Accordingly, many details about the kinematic profile would be unavailable and thus invisible apart from the fact that raw images are usually not stored. Though often done to save disk space as well as to minimize bandwidth saturation, it prevents any re-analysis of the triangulated motion trajectory.</p>
    <p>Here, we present a multi-camera system that allows high-speed motion capture of ultrafast animal movements such as snake strikes using low-priced cameras with high frame rates of 750 Hz and sufficient spatial resolution. The developed software provides a suite of functions that encompass the entirety of data collection, processing, and storage of motion capture with a special focus on processing speeds for high-speed camera capture. Another advantage of using a single software for the data recording and processing pipeline is that the amount of ambiguity and pitfalls that inexperienced motion capture practitioners could encounter is decreased. The amount of data that is generated by high-speed cameras grows quite rapidly with the number of cameras, their speed, and their resolution. Handling this large amount of data often causes problems and can be vastly time consuming when large data sets are processed without performance optimization. This software processes the data to the full extent of the available computer system resources; a feature not available in other tracking software such as DLTdv <xref rid="B16" ref-type="bibr">Hedrick (2008)</xref>, but which greatly diminishes the time required for processing. Although this system was developed in order to capture snake strike motion dynamics, it can easily be employed for motion studies of other animals than snakes. SnakeStrike is an open source framework written to allow users to harness the power from other open source libraries for image manipulation, camera interaction, and computer vision (<xref rid="B5" ref-type="bibr">Bradski, 2000</xref>; <xref rid="B36" ref-type="bibr">Schroeder et al., 2006</xref>; <xref rid="B12" ref-type="bibr">Guennebaud and Jacob, 2010</xref>; <xref rid="B34" ref-type="bibr">Rusu and Cousins, 2011</xref>; <xref rid="B27" ref-type="bibr">Moulon et al., 2013</xref>). Thus, besides assisting in the resource-intense and time-critical initial collection of images at high frame rates with multiple cameras, SnakeStrike performs subsequent offline image processing for triangulation and data visualization. Color thresholding is used for marker identification, allowing simultaneous tracking of multiple animals or body parts when markers with different colors are used. If infrared cameras are used, then infrared markers can subsequently also be used. Marker types need not be spherical or 3D in form. Something as simple as a piece of colored tape can be used, and no wire-frame, or similar model, is required. A major advantage of SnakeStrike is the storage of all original images as reference. This permits repeated off-line data re-interpretation in case new automatic tracking methods or sequential modeling methods become available. Because of the open source code and the modular structure of SnakeStrike, other annotation and pose estimation tools such as DeepLabCut (<xref rid="B26" ref-type="bibr">Mathis et al., 2018</xref>) or LEAP (<xref rid="B31" ref-type="bibr">Pereira et al., 2019</xref>) can be incorporated into the processing pipeline.</p>
  </sec>
  <sec sec-type="materials|methods" id="S2">
    <title>Materials and Methods</title>
    <p>In this section we describe the requirements to use the system and how we fulfilled those requirements, how to use the software from a user’s perspective, as well as provide a high-level overview of how the images are processed such that 3D triangulated points of the markers become available. The order of the sections follows the order the user will generally interact with the interface. This order is reinforced by the software to create a consistent pipeline for the user. Where appropriate we include suggestions for solutions to problems that can arise during use. Furthermore, we describe the experimental setup used for each of our two experimental settings.</p>
    <sec id="S2.SS1">
      <title>Hardware Requirements</title>
      <p>For effective recording of high-speed videos for 3D tracking, it is important to use cameras that are fast enough to capture every detail of the motion of interest and can function together. The only absolute requirements to run the SnakeStrike software are a 64-bit computer running 64-bit Linux. To ensure faithful data transfer to the computer, enough bandwidth on a single bus or multiple busses for the communication protocol is required to save data without dropping individual frames. Therefore, it should be thoroughly calculated which camera communication protocol (e.g. USB3, Ethernet, etc.) is most beneficial given the respective requirements. The only requirements are that the camera adheres to the GenICam standard and has an application programming interface (API). Since very large amounts of data need to be transferred and stored, a computer equipped with sufficient sized RAM and hard drives that have enough storage space to store the recorded raw images is required. However, the precise camera and computer configuration generally depends on the speed of the motion of interest and total recording time necessary to capture every detail. An example data set of only 1 second of recording time from a setup equipped with 5 USB 3.0 cameras with a resolution of 640 × 480 pixels and using lossless data compression requires ∼700 MB of disk space, while ∼3.2 GB of RAM is the minimal requirement for the images from the data capture, assuming that the images are returned from the camera in RGB8 format. If the format is changed to something like Bayer BG8, then the amount of required RAM decreases by a third. Sufficient RAM for running the software should also be included in the calculation. Since AC powered lights flicker when recorded with high-speed cameras, lights for the experimental setup need to have a flicker frequency that is higher than the camera speed or are non-flickering. Note that not all LED lights are non-flickering.</p>
      <p>To satisfy secondary requirements of our experiments, we used a computer with multiple CPU cores, 64 GB RAM, and several Terabytes of available hard disk storage. Furthermore, we used multiple USB 3.0 cameras. Consequently, a PCI card that expanded the available USB 3.0 ports and ensured that each new port had its own controller was utilized. A separate controller for each port guaranteed that the port would not share bandwidth with other USB 3.0 ports. When running a high-speed camera, it is very easy to saturate these buses with a single camera, let alone multiple. For triggering the cameras, a software trigger is usually available, although this does not guarantee synchronized images when using a USB connection. If a hardware trigger is required while using USB cameras, an external hardware trigger must be added.</p>
      <p>We chose Basler Ace acA1300-200uc cameras (Basler AG, Ahrensburg, Germany), which have a maximum image size of 1280 × 1024 pixels. At full spatial resolution, the maximum speed is 203 Hz, however, if the resolution is decreased to 640 × 480 pixels, a frame rate of 750 Hz can be achieved. With camera speeds this high, light flickering of the illumination can be a major issue. Accordingly, surgical lights were used when recording snake strikes in the 3D <italic>X</italic>-ray setup. However, AQ Aquaflora 54-watt fluorescent bulbs (D-D The Aquarium Solution Ltd., Ilford, United Kingdom) are cost-efficient and have successfully been applied in initial tests. When available, non-flickering LED-technology can be used as an alternative. The used cameras were connected to the computer by USB 3.0. To exclude potentially dropped images due to saturation of the bus, a Startech PEXUSB3S44V card (<ext-link ext-link-type="uri" xlink:href="http://startech.com/">StarTech.com</ext-link>, London, ON, Canada) was used. For correct triangulation during our experiments, USB camera synchronization was essential. Accordingly, a Labjack U3 (Lakewood, CO, United States) AD/DA converter with custom-built housing to trigger the cameras <italic>via</italic> three available digital ports was used. A maximum of three cameras can be triggered per port, without critical attenuation of the TTL signal. As long as the camera speed is less than 25,000 fps, i.e. one frame per 40 μs, the 20 μs delay between each of the pulses is short enough to ensure a quasi-simultaneous image recording from all triggered cameras. Thus, recorded images are saved as the same frame. If only one trigger is available, another solution to allow all cameras to be triggered is to use a buffer amplifier; this prevents the signal from being affected by load currents and ensures a truly synchronous trigger.</p>
    </sec>
    <sec id="S2.SS2">
      <title>User Interface</title>
      <p>SnakeStrike is currently only available for 64-bit Linux. The C++ source code and installation instructions are available at “<ext-link ext-link-type="uri" xlink:href="https://github.com/gwjensen/SnakeStrike">https://github.com/gwjensen/SnakeStrike</ext-link>”, while the main user and code documentation can be found at “<ext-link ext-link-type="uri" xlink:href="https://gwjensen.github.io/SnakeStrike/">https://gwjensen.github.io/SnakeStrike/</ext-link>”. Since compiling C++ source code with many dependencies is not an easy task, a docker image with the required dependencies as well as SnakeStrike pre-installed is available on DockerHub at gwjensen/snake_strike with the requisite source for building the Docker image manually located at “<ext-link ext-link-type="uri" xlink:href="https://github.com/gwjensen/SnakeStrikeDocker">https://github.com/gwjensen/SnakeStrikeDocker</ext-link>”. Information regarding plugins or specific functions is available at “<ext-link ext-link-type="uri" xlink:href="https://gwjensen.github.io/SnakeStrike/">https://gwjensen.github.io/SnakeStrike/</ext-link>”.</p>
      <p>The main method of interacting with SnakeStrike is through a basic graphical user interface (GUI). The interface manages folder structure and encapsulates the many steps behind the actions of calibration, capture, and triangulation tasks. The functionality of the interface is divided into three separate tabs in the top left corner of the window (<xref ref-type="fig" rid="F1">Figure 1A</xref>). First, the user creates a new project/experiment, where a project/experiment comprises a single data collection. This ensures consistent data annotation output and reduces workload for the user by automatically organizing created files. After the project is created, new options become available guiding the user along the GUI. For instance, if the cameras are not connected, the user is unable to use any recording options until establishing the connections and pressing “Refresh Camera Connection.” The “Collect Data” tab as well as the side toolbar provides the user with a live preview from the cameras, to initially position the cameras and perform the fine tuning of the focus.</p>
      <fig id="F1" position="float">
        <label>FIGURE 1</label>
        <caption>
          <p>User Interface of the SnakeStrike software and view of the experimental setup used for Study 1. <bold>(A)</bold> Main screen of the software depicting simultaneous previews from four connected cameras. <bold>(B)</bold> Calibration dialog window after a successful calibration attempt. <bold>(C)</bold> DIN A1-sized calibration image adopted from <xref rid="B25" ref-type="bibr">Li et al. (2013)</xref>, affixed to a 1 cm thick cardboard for calibration. <bold>(D)</bold> Example of the dialog window used to triangulate the markers encountered in the images. <bold>(E)</bold> Overview of the experimental setup used for study 1, depicting the arrangement of three low-cost Basler cameras and a Franka Emika Panda robotic arm. <bold>(F)</bold> Close-up of the robotic arm with green markers affixed to a piece of fiberboard.</p>
        </caption>
        <graphic xlink:href="fnbeh-14-00116-g001"/>
      </fig>
      <p>Camera parameters, such as frame size, frame rate, and exposure length need to be set by the software provided by the camera manufacturer and has to be saved in an external configuration file that adheres to the GenICam programming standard. This standard is a generic programming interface that is supported by all compliant cameras and guarantees that a configuration file is transferable between cameras produced by different manufacturers. To set the camera parameters within SnakeStrike, the configuration file must be loaded using the “Load Camera Config” button. Further information, i.e. whether the camera is USB 3.0 or Ethernet-connected, are automatically abstracted. After the configuration of the cameras, the calibration can be started by pressing the “Calibrate Cameras” button that opens the calibration dialogue (<xref ref-type="fig" rid="F1">Figure 1B</xref>). Using the technique described by <xref rid="B25" ref-type="bibr">Li et al. (2013)</xref>, the intrinsic calibrations, i.e. finding the optical center, focal length, and lens distortion of the individual camera, as well as the extrinsic calibrations, i.e. how the cameras are positioned relative to each other in 3D space, are performed.</p>
    </sec>
    <sec id="S2.SS3">
      <title>Undistortion and Calibration</title>
      <p>The size of the image used for calibration depends on the angles between the cameras and the viewing space covered by the cameras. A large viewing angle and/or a large viewing space requires a calibration image that is sufficiently large to be viewed by more than one camera at a time. Optimal calibration objects allow finding correspondences at multiple levels of resolution. The calibration object must be affixed to a movable planar surface such that the image remains flat, but still can be moved through the cameras’ field of view (<xref ref-type="fig" rid="F1">Figure 1C</xref>). It is not necessary for the calibration image to be fully viewable by each camera or that all cameras see the calibration image at the same time. More important for a successful extrinsic calibration is that the cameras can be linked across images that are shared. For example, in a setup with three cameras (A, B, C), where A and B can see the calibration image in a few image captures, and B and C can see the calibration image in a few captures, it is unnecessary for A and C to also share image captures when capturing the calibration image.</p>
      <p>Calibration images should be recorded at low frame rates (e.g. 4 Hz in the current study). This reduces the amount of multiple copies of identical images that would be recorded if the movement of the calibration object is too slow with respect to the camera frame rate. Identical images lead to instabilities in the calibration calculation and unnecessarily increase computation time. Generally, it is recommended to use a slow capture frame rate, and make sure that the calibration object is presented with multiple different orientations relative to the cameras. For a detailed and mathematical explanation of the calibration procedure (see <xref rid="B15" ref-type="bibr">Hartley and Sturm, 1997</xref>; <xref rid="B22" ref-type="bibr">Kanatani et al., 2016</xref>).</p>
      <p>To undistort the images from individual cameras, and to calculate the relative camera positions, we used the technique described by <xref rid="B25" ref-type="bibr">Li et al. (2013)</xref>. One camera sensor will always be used to define the origin of world space. After collection of the images, the user can choose to see the text output of the calibration and can set the lower boundary for the number of matches. The SURF-like (<xref rid="B2" ref-type="bibr">Bay et al., 2006</xref>) difference of Gaussian filter (<xref rid="B25" ref-type="bibr">Li et al., 2013</xref>) detectors must find a pair of images that can be paired for further calibration. If the calibration returns with no errors, then a root-mean square error (RMS) of camera positions in space relative to each other is provided (<xref ref-type="fig" rid="F1">Figure 1B</xref>). As the positioning is an optimization and not a closed-formula solution, the error depends on different parameters, such as camera resolution, quality of focusing, number of recorded images, and number of Gaussian filter matches. After calibration, a mask of the experimental setup can be saved (although not required) along with the project information, to improve post-processing such as thresholding.</p>
    </sec>
    <sec id="S2.SS4">
      <title>Marker Detection and Tracking</title>
      <p>After configuration and calibration of the cameras, the “Record” button in the “Collect Data” tab becomes available and the recording can be started. Once a recording has been completed, offline data processing can be started by pressing the “Process” tab. Pressing “Triangulate Points” brings up the dialog window for thresholding the markers from each camera’s image and triangulating those points into world coordinates (<xref ref-type="fig" rid="F1">Figure 1D</xref>). Our marker detection method is analogous to how commercial tracking systems work in that a specific color range, as supplied by the user, is thresholded to detect the markers in an image. This thresholding combined with the grouping of pixels close to each other and then returning the center of that group is how a colored marker on the object/animal is transformed into a marker position. Typically, commercial systems rely on the markers being IR reflective and of a spherical shape to allow the use of ellipse fitting algorithms. Our approach does not have these restrictions. To decrease computational complexity in our software, the initial correspondence of marker position in relation to the different cameras and the colored marker in 3D space are provided by the user. All subsequent correspondences are performed automatically as described below. For thresholding, a range of colors according to the HSV scale can be chosen. To help remove noise, which can pose a severe problem when using this rudimentary approach, a small configurable filter is available. The preview dialog allows the user to fine tune the values for a particular capture session before proceeding to the triangulation. Images being used for triangulation will automatically be undistorted according to the camera distortion coefficients that were calculated separately for each particular camera during calibration.</p>
      <p>Markers are not required to be 3D in shape when capturing data, i.e. the IR reflective spheres used by commercial systems, however, when capturing data, it must be ensured that at least two cameras see the tracked points. While two cameras are the minimal requirement for 3D triangulation, the quality of triangulation is considerably improved using three cameras (<xref rid="B38" ref-type="bibr">Stewenius et al., 2005</xref>). The benefit of using non-3D markers, like tape or paint, on animals that are difficult to handle such as snakes, is that such 2D markers are more likely to remain attached to the animal. This benefit is offset by the need for more cameras if markers are obscured from one or more cameras. The optimal marker size depends on the camera resolution and size of the object to be tracked. Markers and lighting need to be adjusted to each other. Markers must appear bright enough to allow a dissociation from other low light background colors. On the other hand, markers must not be too bright, because of a potential confoundment with reflections or glare from other surfaces in the experimental environment. We thus recommend choosing colors that have a very high value and saturation in the HSV color space. This facilitates segmenting with both small and large amounts of light. Using a less vibrant color for a marker is possible, but requires that the color is non-glossy; otherwise, reflections on the marker surface can optically change the shape of the marker and thus impair the function of the thresholding algorithm. This could lead to larger errors such as the mid-point of the marker shifting, or even optically splitting the marker into two. In this case, noise smoothing operators in the thresholding dialog are required to rejoin the marker. Accordingly, the larger the markers, the larger the potential error that can occur during triangulation, due to the number of pixels that the marker covers and the problem of finding a representative pixel for this group. When several pixels enter or leave the group, the representative center pixel will most likely change as well. This splitting can also occur because of changes in illumination of the marker, i.e. slight shadow on the marker. This is a source of error related to the lighting of the setup that cannot be fixed by non-flickering lights.</p>
      <p>In a perfect situation, where the cameras in a setup have perfect intrinsic and extrinsic calibration matrices, i.e. the parameters of the camera and its position to every other camera is perfectly known, the triangulation of corresponding pixels across cameras is straightforward. A ray extends from each camera sensor through the corresponding pixel in question. In a perfect setup, these projection rays would intersect in 3D space. In reality, however, there are many sources of noise that prevent an intersection of these lines. These sources include noise in the calibration of the camera, noise in how the camera sensor converts light information, noise caused by the viewing of a 3D object from different positions that might not view the object in the same way, etc. When the lines don’t intersect, as is usually the case, a method for finding the 3D point of intersection is required. This means that a new pixel in each image needs to be found such that all the projection lines through those pixels intersect in 3D space. There are many metrics that can be used for determining where this new pixel in each image is located.</p>
      <p>To help correct for noise inherent in marker location triangulation we used a technique described by <xref rid="B21" ref-type="bibr">Kanatani et al. (2008)</xref> as “optimal correction,” but using the specific implementation from <xref rid="B22" ref-type="bibr">Kanatani et al. (2016)</xref>, that translocates the marker’s center pixel in the image space a minimal amount such that all projection lines from the cameras intersect again in 3D space. This is known as minimizing the reprojection error (geometric error), i.e. the error in pixel space of the data point and its reprojection. In other words, this method finds a pixel as close to the original pixel in the pixel space for each camera such that the projection lines through those pixels will intersect. Once the lines intersect again, the algorithm of Direct Linear Transformation (DLT) (<xref rid="B40" ref-type="bibr">Sutherland, 1974</xref>), which solves using the singular value decomposition (SVD), can be used to calculate the 3D point represented by the corresponding marker locations in each image. If DLT is used without the geometric correction afforded by “optimal correction,” or by another correction algorithm, then the SVD in the equation has multiple possible answers. The algorithm chooses the solution that minimizes the sum of least squares distance, not in the pixel space, but in 3D space from the projection lines of the data points to the point in 3D space that satisfies the intersection constraint. Minimizing the error in the pixel space is generally agreed to be an inferior solution compared to minimizing the error in the geometric space, i.e. the reprojection error (<xref rid="B14" ref-type="bibr">Hartley and Zisserman, 2003</xref>) (See <xref ref-type="supplementary-material" rid="VS1">Supplementary Videos S1</xref>, <xref ref-type="supplementary-material" rid="VS1">S2</xref>).</p>
      <p>When using three or fewer cameras, the globally optimal translocation of data points according to geometric correction can be provided by the polynomial algorithms of <xref rid="B15" ref-type="bibr">Hartley and Sturm (1997)</xref> for two cameras, which was later extended by <xref rid="B38" ref-type="bibr">Stewenius et al. (2005)</xref> to three cameras. However, as the number of cameras grows, the size of the polynomial function to solve becomes unwieldy. As described by <xref rid="B13" ref-type="bibr">Hartley and Kahl (2007)</xref>, Stewenius and Nister, in an unpublished work, calculated the degree of the polynomial that would need to be solved for views 2–7. They found 6, 47, 148, 336, 638, and 1081 to be the respective order of the polynomial for calculating the global optimal solution. This shows how quickly the number of local optima of the cost function increases. For more than three cameras, the search for a global optimal solution is commonly done with optimization of a cost function or gradient descent algorithms. These solutions for more than three cameras, however, as mentioned by <xref rid="B14" ref-type="bibr">Hartley and Zisserman (2003)</xref> can be quite computationally expensive as well as difficult to program. Quite often these methods also rely on assumptions regarding the source of the noise, e.g. Gaussian distributed. We used the iterative method of <xref rid="B21" ref-type="bibr">Kanatani et al. (2008)</xref> to minimize the geometric error without minimizing a cost function or relying on any assumptions regarding the source of the noise. Furthermore, as was shown in <xref rid="B21" ref-type="bibr">Kanatani et al. (2008)</xref>, since this method starts as an approximation of the solution, it typically requires only a couple of iterations to converge and, in the case of three or less cameras, to provide the same solution as the closed form polynomial equations in less time. In our experience with five cameras the algorithm performs quickly and produces high quality results even with the additional noise that is contributed by the movement of marker center positions. These errors are discussed further in Study 1 below.</p>
      <p>Matching multiple points across multiple cameras is not a trivial problem, as <xref rid="B28" ref-type="bibr">Munkres (1957)</xref> demonstrated. If we have M cameras, finding the corresponding point from one camera in the set of all other points in each of the other M-1 cameras is a computationally intensive task. This problem can be solved for two sets in O(N<sup>3</sup>), i.e. the time required to solve the problem scales cubically with the number of inputs, assuming that there are no further constraints to the matching. For more than two sets and when there are additional constraints, such as that the assignment over time stays consistent, these problems are still an active area of research. A general solution to the problem of triangulation of occluded points during tracking has also proved elusive. Only basic methods for the tracking of points are available in our implementation at the moment. Currently, for a triangulation attempt, the user has to select the visible markers in images from a single time step manually using an intuitive GUI. The selection does not need to be pixel precise as the closest visible marker will automatically be selected. This initial marking helps to decrease the computational complexity of assigning matching points across camera views to a more manageable problem. These starting positions are then used as the initial starting positions for points in a Kalman filter (<xref rid="B20" ref-type="bibr">Kalman, 1960</xref>). Using this initial configuration, the Hungarian algorithm, also known as the Munkres-Kuhn algorithm (<xref rid="B28" ref-type="bibr">Munkres, 1957</xref>; <xref rid="B24" ref-type="bibr">Kuhn, 1959</xref>; <xref rid="B4" ref-type="bibr">Bourgeois and Lassalle, 1971</xref>), along with the Kalman filter, which receives its step update information from the matching of the Hungarian algorithm, are used to keep the point assignments consistent through time. These algorithms are only used to support the correct assignment of correspondence, while the pixel positions of the marker come from the thresholding and not from the steps of the filter. A high-level diagram of this processing pipeline is shown in <xref ref-type="fig" rid="F2">Figure 2</xref>. The user has the option to force the algorithm to skip timesteps where not all markers for each camera are visible. When the setup consists of more than two cameras, the user can fall back to a set of fewer cameras that have no occlusion for that timestep. An algorithm library for correspondence is used to match corresponding points from images taken at different angles. In the default case this library is the Kalman filter and Hungarian algorithm combination mentioned above. However, since this library is dynamically loaded, the user has the option to write a correspondence plugin for keeping the identity of thresholded points unique through time, making it unnecessary to rely on the basic method described above.</p>
      <fig id="F2" position="float">
        <label>FIGURE 2</label>
        <caption>
          <p>Diagram depicting the flow of data during the processing of images which results in a 3D triangulated point of the markers being tracked. The variable <italic>S</italic> is the set of markers as they exist in the real world with <italic>S</italic><sub><italic>t=0</italic></sub> being the first time step in the image capture series. The information for initial point correspondence is entered by the user, <italic>via</italic> the labeling GUI. The variable <italic>V</italic><sub><italic>t,j</italic></sub> is the image pixel position of the markers for time step <italic>t</italic> and camera <italic>j</italic>. Variables with a hat such as <inline-formula><mml:math id="INEQ1"><mml:mover accent="true"><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>^</mml:mo></mml:mover></mml:math></inline-formula> or <inline-formula><mml:math id="INEQ2"><mml:mover accent="true"><mml:msub><mml:mi>S</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>^</mml:mo></mml:mover></mml:math></inline-formula> represent calculated guesses as to the true values <italic>V</italic><sub><italic>t,j</italic></sub> and <italic>S</italic><sub><italic>t</italic></sub>, respectively. The arrow with the marking “KFP” is a Kalman filter prediction, and the boxes “Thresh,” “HA,” “OC,” and “Tri” indicate the color thresholding algorithm, the Hungarian algorithm, the optimal correction algorithm, and the triangulation algorithm, respectively.</p>
        </caption>
        <graphic xlink:href="fnbeh-14-00116-g002"/>
      </fig>
      <p>Our framework provides an API where these new algorithms can be supplied to the framework without re-compiling the codebase. This interface is basic in the sense that it provides the points for each timestep, and expects the points to return in ordered lists for each timestep. This creates an interface that puts a minimal amount of constraints on the algorithms that are used to process the point tracking data. More information regarding the API for these algorithms can be found on “<ext-link ext-link-type="uri" xlink:href="https://gwjensen.github.io/SnakeStrike/">https://gwjensen.github.io/SnakeStrike/</ext-link>”. This is where software such as DeepLabCut (<xref rid="B26" ref-type="bibr">Mathis et al., 2018</xref>) or LEAP (<xref rid="B31" ref-type="bibr">Pereira et al., 2019</xref>) can be integrated into SnakeStrike. This also allows data to be processed by many different algorithms, if necessary. It further offers the possibility for the user to maximize the constraints such as how to handle obscured points, what to do when point labels are swapped, etc.</p>
    </sec>
    <sec id="S2.SS5">
      <title>Viewing Tracking Data</title>
      <p>After triangulation, the data can be viewed by the built-in 3D point cloud viewer. This generates an animation of the movement through time, and also allows stepping through each individual timestep. A line connects the points in the order as indicated by the user for disambiguation. This line is useful for relating triangulated points to the body of the animal, but does not directly reflect pose information of the animal. For example, in the case of a snake, the line won’t follow the contours of the snake unless the markers are spaced with minimal distance to each other. The points are also of different colors to prevent ambiguity when viewing the motion of the points through time (<xref ref-type="fig" rid="F3">Figures 3A<sub>2</sub>,B<sub>2</sub>,C<sub>2</sub></xref>). The triangulation performed by SnakeStrike does not perform any direct filtering or smoothing on the triangulated points over time. It only provides a simple forward-backward filter as part of the GUI window to allow the user to see how filtering or smoothing could improve the data.</p>
      <fig id="F3" position="float">
        <label>FIGURE 3</label>
        <caption>
          <p>Experimental setting for capturing and analyzing snake strikes in study 2. <bold>(A–C)</bold> Raw images of a strike of an amazon tree boa (<italic>Corallus hortulanus</italic>) at three different time steps: at a stationary position <bold>(A<sub>1</sub>)</bold>, and approximately in the middle of the strike <bold>(B<sub>1</sub>,C<sub>1</sub>)</bold>. The large black circle behind the snake is the horizontal <italic>X</italic>-ray emitter, while the vertical <italic>X</italic>-ray emitter above the snake is out of view. Corresponding triangulation is plotted as output by the SnakeStrike software for the corresponding images <bold>(A<sub>2</sub>–C<sub>2</sub>)</bold>. The coordinate system has been rotated such that triangulated points and images have the same viewpoint. Each marker (1–5) on the snake is depicted by a different color label in the triangulated data, starting with the red (1) point and ending with the yellow point (5) in <bold>(A<sub>2</sub>–C<sub>2</sub>)</bold>; a red line connects all points in the triangulation. This line corresponds to the marker positions on the snake from rostral to caudal and is not based on pose estimation. The direction of the line is defined by the user during triangulation. The data shown in plots <bold>(B,C)</bold> are 86 images (114.7 ms) apart.</p>
        </caption>
        <graphic xlink:href="fnbeh-14-00116-g003"/>
      </fig>
    </sec>
    <sec id="S2.SS6">
      <title>Procedures for Study 1: Measurement of Accuracy</title>
      <p>The accuracy of SnakeStrike was determined under particular control conditions, that, however, differed with respect to the experimental setting used in study 2 for the strike movements of snakes (e.g. cameras, lighting conditions, etc.). The accuracy of the system was determined with a robotic arm that reproducibly moved an artificial object to calculate the error level for the calibration technique and illustrated the effect of different recording conditions. The setup consisted of a robotic arm (Model: “Franka Emika Panda,” Franka Emika GmbH, Munich, Germany) used to move a flat plane with affixed markers in a specific spatial configuration (<xref ref-type="fig" rid="F1">Figures 1E,F</xref> and <xref rid="T1" ref-type="table">Table 1</xref>). Robotic arm motion allowed for precise movements with identical trajectories, while parameters such as speed were altered under defined conditions. With this approach two types of camera lenses, two different marker dimensions, and two different movement speeds were tested. The definition of the exact distances between the points allowed calculating the error in 3D triangulation between all points. The affixation of the points to a plane allowed calculating the error of the points from the plane that fits all points with the least error.</p>
      <table-wrap id="T1" position="float">
        <label>TABLE 1</label>
        <caption>
          <p>Distance between markers on the calibration object used for Study 1.</p>
        </caption>
        <table frame="hsides" rules="groups" cellspacing="5" cellpadding="5">
          <thead>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td valign="top" align="center" rowspan="1" colspan="1">1</td>
              <td valign="top" align="center" rowspan="1" colspan="1">2</td>
              <td valign="top" align="center" rowspan="1" colspan="1">3</td>
              <td valign="top" align="center" rowspan="1" colspan="1">4</td>
              <td valign="top" align="center" rowspan="1" colspan="1">5</td>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td valign="top" align="center" rowspan="1" colspan="1">
                <bold>Small mark number</bold>
              </td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
            </tr>
            <tr>
              <td valign="top" align="center" rowspan="1" colspan="1">1</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0</td>
              <td valign="top" align="center" rowspan="1" colspan="1">72.0</td>
              <td valign="top" align="center" rowspan="1" colspan="1">80.5</td>
              <td valign="top" align="center" rowspan="1" colspan="1">101.8</td>
              <td valign="top" align="center" rowspan="1" colspan="1">72.0</td>
            </tr>
            <tr>
              <td valign="top" align="center" rowspan="1" colspan="1">2</td>
              <td rowspan="1" colspan="1"/>
              <td valign="top" align="center" rowspan="1" colspan="1">0</td>
              <td valign="top" align="center" rowspan="1" colspan="1">36.0</td>
              <td valign="top" align="center" rowspan="1" colspan="1">72.0</td>
              <td valign="top" align="center" rowspan="1" colspan="1">101.8</td>
            </tr>
            <tr>
              <td valign="top" align="center" rowspan="1" colspan="1">3</td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td valign="top" align="center" rowspan="1" colspan="1">0</td>
              <td valign="top" align="center" rowspan="1" colspan="1">36.0</td>
              <td valign="top" align="center" rowspan="1" colspan="1">80.5</td>
            </tr>
            <tr>
              <td valign="top" align="center" rowspan="1" colspan="1">4</td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td valign="top" align="center" rowspan="1" colspan="1">0</td>
              <td valign="top" align="center" rowspan="1" colspan="1">72.0</td>
            </tr>
            <tr>
              <td valign="top" align="center" rowspan="1" colspan="1">5</td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td valign="top" align="center" rowspan="1" colspan="1">0</td>
            </tr>
            <tr>
              <td valign="top" align="center" rowspan="1" colspan="1">
                <bold>Big mark number</bold>
              </td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
            </tr>
            <tr>
              <td valign="top" align="center" rowspan="1" colspan="1">1</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0</td>
              <td valign="top" align="center" rowspan="1" colspan="1">84.0</td>
              <td valign="top" align="center" rowspan="1" colspan="1">93.9</td>
              <td valign="top" align="center" rowspan="1" colspan="1">118.8</td>
              <td valign="top" align="center" rowspan="1" colspan="1">84.0</td>
            </tr>
            <tr>
              <td valign="top" align="center" rowspan="1" colspan="1">2</td>
              <td rowspan="1" colspan="1"/>
              <td valign="top" align="center" rowspan="1" colspan="1">0</td>
              <td valign="top" align="center" rowspan="1" colspan="1">42.0</td>
              <td valign="top" align="center" rowspan="1" colspan="1">84.0</td>
              <td valign="top" align="center" rowspan="1" colspan="1">118.8</td>
            </tr>
            <tr>
              <td valign="top" align="center" rowspan="1" colspan="1">3</td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td valign="top" align="center" rowspan="1" colspan="1">0</td>
              <td valign="top" align="center" rowspan="1" colspan="1">42.0</td>
              <td valign="top" align="center" rowspan="1" colspan="1">93.9</td>
            </tr>
            <tr>
              <td valign="top" align="center" rowspan="1" colspan="1">4</td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td valign="top" align="center" rowspan="1" colspan="1">0</td>
              <td valign="top" align="center" rowspan="1" colspan="1">84.0</td>
            </tr>
            <tr>
              <td valign="top" align="center" rowspan="1" colspan="1">5</td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td valign="top" align="center" rowspan="1" colspan="1">0</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <attrib>
            <italic>Measurements are all in mm.</italic>
          </attrib>
        </table-wrap-foot>
      </table-wrap>
      <p>The basic experimental setting was as follows: placement of three cameras, oriented around the robotic arm (<xref ref-type="fig" rid="F1">Figure 1F</xref>). Bright neon green markers (small: 10 mm × 10 mm; large: 22 mm × 22 mm) were attached at specific locations on a flat piece of medium-density fiberboard to ensure that the markers were aligned in the same spatial plane; the chosen marker color was unique and did not occur on objects anywhere else in the cameras’ field of view. For the Fujinon DV3.4x3.8SA-1 (Fujifilm, Tokyo, Japan) lens, the distance between cameras and marker plane was about 110 cm (<xref ref-type="fig" rid="F1">Figure 1E</xref>). For the Ricoh FL-CC0614A-2M (Ricoh, Tokyo, Japan) lens, the distance was increased to ∼175 cm, because of the longer focal length of the lens. As the cameras had to be moved, calibration differences as well as lens differences were tested. Each capture session was completed with the cameras set to an image size of 640 × 480 pixels at a frame rate of 750 Hz. For each capture, 6000 images were recorded. For triangulation, the thresholding viewer tools of SnakeStrike were used and set to a color range with the most correct detection of the markers and minimum false-positive detections.</p>
    </sec>
    <sec id="S2.SS7">
      <title>Procedures for Study 2: Strike Movement of the Amazon Tree Boa (<italic>Corallus hortulanus</italic>)</title>
      <p>The tracking framework was applied for the first time ever on living animals in combination with biplanar <italic>X</italic>-ray to capture fast snake strikes. The field of view of the <italic>X</italic>-ray tubes was too small to encompass the entire strike of the snakes while still providing adequate resolution. Therefore, an additional data capturing method was required to compare local information obtained from the biplanar <italic>X</italic>-ray motion capture with global snake movement information. This multi-modal data and the analysis of the resulting data fusion is not a component of the tracking system, and thus out of scope. Nevertheless, we were able to assess the usage of the system with live animals and to demonstrate that this stand-alone 3D motion tracking system can easily be integrated in existing experimental set-ups to record multi-modal data sets.</p>
      <p>The experiment included four amazon tree boas (<italic>Corallus hortulanus</italic>) with a snout-vent-length (SVL) of 100–120 cm. Snakes of either sex and a body mass of 23–69 g were obtained from the in-house animal breeding facility at the Chair of Zoology at the Technical University of Munich. Snakes were kept at a temperature of 22–30°C on a 12 h:12 h light:dark cycle. Permission for the experiments was granted by the respective governmental institution for animal welfare (Thüringer Landesamt für Verbraucherschutz; code: 15-003/16). For the experiments, five cameras running at 750 Hz at a spatial resolution of 640 × 480 pixels were used resulting in 7500 images per camera per capture sequence. This required ∼11GB RAM (We used the Bayer BG8 image format) and ∼7 GB disk space to record and store one capture, excluding any memory or storage space to run SnakeStrike. The orientation of the snake in space when anchored to a branch represented a difficult condition to reliably capture images as snakes can coil back onto themselves, thus potentially occluding markers. Additionally, the placement of markers on the snake, though spaced out along the body of the snake, can end up next to each other when the snake forms its characteristic S-shaped curves. Therefore, multiple cameras were necessary such that at least two cameras saw the markers at any timepoint.</p>
      <p>Avery No. 3320 multipurpose labels (Avery Dennison Corporation, Glendale, CA, United States) were used as markers as they can be stained with any suitable color, and have a good adhesion, without irritating the skin. The labels were painted in a light blue color as it would be the only incidence of that color in the experimental setting. There were blue markers on the body and an additional red marker on the head because the head becomes obscured by the opening of the mouth as described by <xref rid="B7" ref-type="bibr">Cundall and Deufel (1999)</xref> and the <italic>X</italic>-ray tubes did not allow for setting up cameras directly above the snake (<xref ref-type="fig" rid="F3">Figures 3A<sub>1</sub>,B<sub>1</sub>,C<sub>1</sub></xref>). To reduce errors and to avoid correspondence switching of the markers, the body and head markers had different colors. Accordingly, the two marker colors were triangulated separately and then required post-processing to fuse the data manually using a simple script.</p>
    </sec>
  </sec>
  <sec id="S3">
    <title>Results</title>
    <sec id="S3.SS1">
      <title>Study 1: Measurement of Accuracy</title>
      <p>The accuracy of the tracking system was determined by using a robotic arm for the generation of a movement of the flat plane through the visual field of the cameras (<xref ref-type="fig" rid="F1">Figures 1E,F</xref>). Based on the variations of the experimental protocol, it was possible to determine the errors related to the different configurations. To provide an intuitive understanding of the performance abilities of the system, we also converted errors from absolute 3D world space measurements to approximate pixel space equivalencies. <xref ref-type="fig" rid="F4">Figure 4A</xref> (<xref ref-type="supplementary-material" rid="FS1">Supplementary Figure S1A</xref>) and <xref ref-type="fig" rid="F4">Figure 4B</xref> (<xref ref-type="supplementary-material" rid="FS1">Supplementary Figure S1B</xref>) illustrate the errors resulting from running the same movement at two different speeds, two different lenses, and two different marker sizes. The faster robotic arm speed covered the same motion trajectory as the slower speed, but also covered a slightly different motion at the end due to the faster movement. This was expected as it produces the same trajectory as the movement at the slower speed, but over a shorter amount of time. Details of the results with different marker size, lenses, and movement speed were plotted in the various rows and columns in <xref ref-type="fig" rid="F4">Figure 4</xref> and <xref ref-type="supplementary-material" rid="FS1">Supplementary Figure S1</xref>. A major outcome of these experiments was the observation that neither the change of lenses nor the speed of the movement has a substantial effect on the accuracy of the reconstruction. The latter finding was also not too surprising given that the movement speed was far slower than the camera frame rate (750 Hz) for these experiments.</p>
      <fig id="F4" position="float">
        <label>FIGURE 4</label>
        <caption>
          <p>Study 1: Error in marker location while the fiberboard with attached markers was moved through space by the Franka Emika Panda robotic arm. Parameters: two marker sizes and two relative speeds of movement of the markers. Data is shown for one camera lens (Fujinon DV3.4x3.8SA-1) only. In <xref ref-type="supplementary-material" rid="FS1">Supplementary Figure S1</xref> additional data recorded with a second camera lens (Ricoh FL-CC0614A-2M) are presented. <bold>(A)</bold> Each boxplot refers to an interpoint distance error between two points of known distance in the calibration object (<xref rid="T1" ref-type="table">Table 1</xref>); the numbers on the <italic>x</italic>-axis represent the points and are separated by a hyphen. <bold>(B)</bold> Marker distance from the best-fitting plane for all markers.</p>
        </caption>
        <graphic xlink:href="fnbeh-14-00116-g004"/>
      </fig>
      <p>The largest visibly observed differences were found for the size of the markers, with an increase of ∼2–3 mm (∼2 pixels) in the average error per point when using larger markers. This was likely due to the fact that the larger the marker, the more the center of the marker potentially shifts. This shifting can be caused by parameters such as changes in illumination, color intensity, or visibility. It is noteworthy, however, that the planar error did not change between the two marker sizes. In order to better understand the effect that aspects such as viewing angle, lighting, or color intensity changes have on the accuracy, stationary images were collected. <xref ref-type="fig" rid="F5">Figures 5A,B</xref> show the respective distance errors between points and the distance from the closest fitting plane, respectively. During all captures, 6000 images were acquired at a frame rate of 750 Hz. In this case, small markers were used and each plot represented the position of the fiberboard relative to the main camera. The positions were as follows: “facing downwards,” “facing perpendicular,” “slanted right,” “slanted left,” “slanted up,” and “slanted up with a sharper angle.” It is noticeable that the error ranges for “slant right,” “facing downwards,” and for “slanted up with a sharper angle” were considerably larger than for the other capture angles. Variances for both of these positions ranged mostly from 4 to 6 mm (∼3–4.5 pixels), while other positions tended to have less than 4 mm (∼3 pixels) of variance. The markers perpendicular to the camera as well as the “slant left” capture error ranges were considerably smaller than reported for moving markers. Markers at other angles relative to the camera had error variances comparable to those during motion captures.</p>
      <fig id="F5" position="float">
        <label>FIGURE 5</label>
        <caption>
          <p>Study 1: Error in marker location with a stationary fiberboard across 6000 time steps. <bold>(A)</bold> Stationary markers viewed from different angles by the center camera. Each boxplot refers to an interpoint distance error between two points of known distance in the calibration object (<xref rid="T1" ref-type="table">Table 1</xref>). The numbers on the <italic>x</italic>-axis represent the points and are separated by a hyphen. <bold>(B)</bold> Distance of markers from the best-fitting plane for all markers (left). Movement of triangulated points in 3D from their mean while markers were stationary (right). <bold>(C,D)</bold> Same data as shown in <bold>(A,B)</bold> but post-processed with a Kalman filter. For plots of the remaining data post-processed with a Kalman filter (see <xref ref-type="supplementary-material" rid="FS2">Supplementary Figure S2</xref>).</p>
        </caption>
        <graphic xlink:href="fnbeh-14-00116-g005"/>
      </fig>
      <p>To better explain the source of these errors in the triangulation, the original pictures were reanalyzed to potentially discern differences between the positions that showed a smaller error variance and those that showed a larger variance. The first noticeable difference was that the angle of the marker board relative to the camera was larger in the “slanted right” compared to the “slanted left” capture configuration. A similarly sharp angle was also present relative to one of the cameras in the “slanted up with a sharper angle” capture condition. Thus, the sharper the angle of the camera optical axis relative to the marker, the smaller the marker from the view of the camera. The resultant smaller viewable marker size combined with color intensity differences due to the angle relative to the camera caused the center point of the marker to move with either the flickering of the light source or the change in illumination caused by the angle. Part of the error was likely due to the fact that the triangulated points provided by SnakeStrike have not been filtered or smoothed through time. To demonstrate the effect that a filter would have on the error variance, the data from <xref ref-type="fig" rid="F5">Figure 5</xref> were processed by a simple Kalman filter (<xref rid="B20" ref-type="bibr">Kalman, 1960</xref>). As illustrated in <xref ref-type="fig" rid="F5">Figures 5C,D</xref> and <xref ref-type="supplementary-material" rid="FS2">Supplementary Figure S2</xref>, it was clear that the use of such a filter drastically reduces the error variance for both the interpoint error as well as the planar error, indicating the necessity to apply such a simple and easy to implement post-processing to obtain even more reliable motion tracking.</p>
      <p>Analysis of the data collected from this experimental paradigm showed that even though a high frequency fluorescent bulb was used as the main light source, a minor oscillatory flicker occurred in the image sequence. This introduced a noticeable effect on the accuracy of marker positions as the flicker significantly changed the color characteristics of the markers with respect to saturation and hue. To precisely quantify the error, introduced by the flickering light, a second test of the accuracy object was performed in a new setup where the object remained stationary in a position that was perpendicular to the center of three cameras. In this second experimental setting, data was recorded using a completely separate location with a bright light source consisting of four AQ Aquaflora 54-watt fluorescent bulbs that did not produce any light flickering, and the spacing of the cameras was similar to the original setting. The respective data are presented in <xref ref-type="supplementary-material" rid="FS3">Supplementary Figures S3B,C</xref>, <xref ref-type="supplementary-material" rid="FS4">S4B,C</xref> and give a clear approximation of the error that the flickering of the light has introduced in the originally collected data (<xref ref-type="supplementary-material" rid="FS3">Supplementary Figures S3A</xref>, <xref ref-type="supplementary-material" rid="FS4">S4A</xref>), i.e. an average spatial error difference of maximally 1 mm (∼1 pixel) with considerably increased variances, 2–3 mm (∼2 pixels) for the flickering data error. As the errors for both the flickering and the non-flickering light condition show the same trends, there is still a systematic error in the triangulation of the system. Given that the data obtained in the flickering and non-flickering light condition used different camera calibrations, it is more likely that the residual error derived from inaccuracies in the calibration object, or an error in the triangulation and rudimentary thresholding algorithms, though it is nevertheless still small in magnitude.</p>
    </sec>
    <sec id="S3.SS2">
      <title>Study 2: Strikes of the Amazon Tree Boa (<italic>Corallus hortulanus</italic>)</title>
      <p>In the framework of the experimental setting, 20 snake strikes were recorded, out of which 15 were used to provide tracking data that could be fully processed by SnakeStrike (<xref ref-type="fig" rid="F6">Figure 6</xref>). The meta-information regarding successful strikes is presented in <xref rid="T2" ref-type="table">Table 2</xref>. Captures 19 and 20 derived from a smaller snake and thus were not included. Captures 14 and 16 used a rather strong heat element as infrared target to elicit the strike instead of the IR emitter that was used for the other strikes. This strong heat element produced visible light that affected the ability of SnakeStrike to properly track the markers. Capture 11 did not yield a consistent set of images, likely because of partially missing data from one of the 5 cameras and therefore was excluded from further analysis. Details regarding the velocity of each strike over time is presented in <xref ref-type="fig" rid="F6">Figure 6</xref>. The dots indicate the calculation of the velocity for each timestep using 3D triangulation information. The value for each individual dot was calculated as the change in distance between two subsequent timesteps, where a timestep was denoted by a captured image. There are two lines for each capture plot with one showing the best fit for the trial data and the other indicating the average best fit for all trials of a particular snake. Data points that did not allow an analysis were removed from the plot (red bars) based on a velocity threshold of 2.5 ms<sup>–1</sup>. This omission of data typically occurred when the identity of points was swapped for a few timesteps, or when the thresholding process found a different reflection or source of color than the marker in question and assigned a new – but often only temporary – point as marker for that timestep. An example for the velocity change of a snake strike is plotted at the lower right of <xref ref-type="fig" rid="F6">Figure 6</xref> as the best fitting curve for all snake strike trials in comparison to the best fitting curve for all trials of each individual snake.</p>
      <table-wrap id="T2" position="float">
        <label>TABLE 2</label>
        <caption>
          <p>Strike meta-data as calculated from initial forward movement of strike until start of head retraction.</p>
        </caption>
        <table frame="hsides" rules="groups" cellspacing="5" cellpadding="5">
          <thead>
            <tr>
              <td valign="top" align="center" rowspan="1" colspan="1">Trial</td>
              <td valign="top" align="center" rowspan="1" colspan="1">Snake</td>
              <td valign="top" align="center" rowspan="1" colspan="1">Duration (s)</td>
              <td valign="top" align="center" rowspan="1" colspan="1">Distance (m)</td>
              <td valign="top" align="center" rowspan="1" colspan="1">Speed (ms<sup>–1</sup>)</td>
              <td valign="top" align="center" rowspan="1" colspan="1">Max Velocity (ms<sup>–1</sup>)</td>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td valign="top" align="center" rowspan="1" colspan="1">1</td>
              <td valign="top" align="center" rowspan="1" colspan="1">Y4</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.0866458717</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.0958</td>
              <td valign="top" align="center" rowspan="1" colspan="1">1.1055</td>
              <td valign="top" align="center" rowspan="1" colspan="1">1.6393</td>
            </tr>
            <tr>
              <td valign="top" align="center" rowspan="1" colspan="1">2</td>
              <td valign="top" align="center" rowspan="1" colspan="1">Y4</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.1359673678</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.1731</td>
              <td valign="top" align="center" rowspan="1" colspan="1">1.2732</td>
              <td valign="top" align="center" rowspan="1" colspan="1">1.8036</td>
            </tr>
            <tr>
              <td valign="top" align="center" rowspan="1" colspan="1">3</td>
              <td valign="top" align="center" rowspan="1" colspan="1">Y4</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.1506305153</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.2136</td>
              <td valign="top" align="center" rowspan="1" colspan="1">1.4182</td>
              <td valign="top" align="center" rowspan="1" colspan="1">1.9968</td>
            </tr>
            <tr>
              <td valign="top" align="center" rowspan="1" colspan="1">4</td>
              <td valign="top" align="center" rowspan="1" colspan="1">Y4</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.0786477912</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.0829</td>
              <td valign="top" align="center" rowspan="1" colspan="1">1.0542</td>
              <td valign="top" align="center" rowspan="1" colspan="1">1.8137</td>
            </tr>
            <tr>
              <td valign="top" align="center" rowspan="1" colspan="1">5</td>
              <td valign="top" align="center" rowspan="1" colspan="1">Y2</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.1146391533</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.1461</td>
              <td valign="top" align="center" rowspan="1" colspan="1">1.2743</td>
              <td valign="top" align="center" rowspan="1" colspan="1">1.6408</td>
            </tr>
            <tr>
              <td valign="top" align="center" rowspan="1" colspan="1">6</td>
              <td valign="top" align="center" rowspan="1" colspan="1">Y2</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.1066410728</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.2192</td>
              <td valign="top" align="center" rowspan="1" colspan="1">2.0556</td>
              <td valign="top" align="center" rowspan="1" colspan="1">2.3136</td>
            </tr>
            <tr>
              <td valign="top" align="center" rowspan="1" colspan="1">7</td>
              <td valign="top" align="center" rowspan="1" colspan="1">Y2</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.1306353142</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.1472</td>
              <td valign="top" align="center" rowspan="1" colspan="1">1.1270</td>
              <td valign="top" align="center" rowspan="1" colspan="1">2.1715</td>
            </tr>
            <tr>
              <td valign="top" align="center" rowspan="1" colspan="1">8</td>
              <td valign="top" align="center" rowspan="1" colspan="1">Y2</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.1426324349</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.1567</td>
              <td valign="top" align="center" rowspan="1" colspan="1">1.0984</td>
              <td valign="top" align="center" rowspan="1" colspan="1">1.6513</td>
            </tr>
            <tr>
              <td valign="top" align="center" rowspan="1" colspan="1">9</td>
              <td valign="top" align="center" rowspan="1" colspan="1">Y2</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.1652936629</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.1419</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.8583</td>
              <td valign="top" align="center" rowspan="1" colspan="1">1.2661</td>
            </tr>
            <tr>
              <td valign="top" align="center" rowspan="1" colspan="1">10</td>
              <td valign="top" align="center" rowspan="1" colspan="1">Y2</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.1986189981</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.1573</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.7920</td>
              <td valign="top" align="center" rowspan="1" colspan="1">1.3873</td>
            </tr>
            <tr>
              <td valign="top" align="center" rowspan="1" colspan="1">12</td>
              <td valign="top" align="center" rowspan="1" colspan="1">B5</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.1959529713</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.1901</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.9700</td>
              <td valign="top" align="center" rowspan="1" colspan="1">1.4633</td>
            </tr>
            <tr>
              <td valign="top" align="center" rowspan="1" colspan="1">13</td>
              <td valign="top" align="center" rowspan="1" colspan="1">B5</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.1746247567</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.1695</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.9705</td>
              <td valign="top" align="center" rowspan="1" colspan="1">1.3763</td>
            </tr>
            <tr>
              <td valign="top" align="center" rowspan="1" colspan="1">15</td>
              <td valign="top" align="center" rowspan="1" colspan="1">B5</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.1093070996</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.0968</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.8854</td>
              <td valign="top" align="center" rowspan="1" colspan="1">1.4035</td>
            </tr>
            <tr>
              <td valign="top" align="center" rowspan="1" colspan="1">17</td>
              <td valign="top" align="center" rowspan="1" colspan="1">B5</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.1479644885</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.1462</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.9878</td>
              <td valign="top" align="center" rowspan="1" colspan="1">1.3030</td>
            </tr>
            <tr>
              <td valign="top" align="center" rowspan="1" colspan="1">18</td>
              <td valign="top" align="center" rowspan="1" colspan="1">B5</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.155962569</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.1468</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.9411</td>
              <td valign="top" align="center" rowspan="1" colspan="1">1.3333</td>
            </tr>
            <tr>
              <td valign="top" align="center" colspan="2" rowspan="1">All Mean</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.1396109378</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.1522</td>
              <td valign="top" align="center" rowspan="1" colspan="1">1.1208</td>
              <td valign="top" align="center" rowspan="1" colspan="1">1.6376</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
      <fig id="F6" position="float">
        <label>FIGURE 6</label>
        <caption>
          <p>Study 2: Snake strike velocity over time <bold>(A)</bold> 3D positions in study 2 of each snake’s head for each trial are plotted to illustrate the velocity changes during the strike. In some trials, e.g. Y4 markers were obscured from the view of at least one camera resulting in a loss of correspondence as a new and usually temporary point was assigned to be the marker location. These time steps were removed using a velocity threshold of 2.5 ms<sup>– 1</sup> (red vertical bars). <bold>(B)</bold> Group aggregate velocity statistics for all snakes individually and as mean across all snakes tested in this study.</p>
        </caption>
        <graphic xlink:href="fnbeh-14-00116-g006"/>
      </fig>
    </sec>
  </sec>
  <sec id="S4">
    <title>Discussion</title>
    <p>As indicated previously for machine vision in social interaction studies (<xref rid="B33" ref-type="bibr">Robie et al., 2017</xref>), when individual animals are visually indistinguishable, the task of tracking in the presence of occlusions or partial overlap is an unresolved problem. For snake motion tracking, a similar problem exists as positions on the body surface of the snake are nearly identical, such as when the snake skin consists of a repetitive pattern. This makes markerless tracking methods, such as DeepLabCut (<xref rid="B26" ref-type="bibr">Mathis et al., 2018</xref>), much harder to employ successfully on patterned snakes. Markerless annotation programs such as DeepLabCut further require a set of manually labeled images to train the software. In the case of DeepLabCut, this training can require a couple of hundred images per camera, though in practice a smaller number can be sufficient, and if the camera is moved, it might require re-labeling of a set of new images from that camera. Furthermore, DeepLabCut does not provide 3D triangulations of annotated points. On the other hand, non-patterned skin can also be problematic as large sections of the snake surface look very similar and indistinguishable causing specific positions to be difficult to discern with sufficient spatial resolution. With the snake moving and changing body shape in a very short period of time, the labels assigned to these markers will be swapped in most cases, unless the system is able to uniquely identify and track a particular marker over time. This is implemented in many systems by using multiple markers as a single marker and putting them into a unique configuration scheme that is identifiable by the system (<xref rid="B42" ref-type="bibr">Theunissen et al., 2017</xref>), thus filling up even more skin space with markers. Unfortunately, the maintenance of the spatial configuration can be also very problematic since some animals (e.g. insects or small birds) are too small to carry an extra payload or are able to remove these markers very easily (e.g. snakes or squids). For example, a snake easily twists itself and effortlessly removes even the smallest markers. This is the major reason why studies such as that by <xref rid="B42" ref-type="bibr">Theunissen et al. (2017)</xref> used rigid structures attached to the body and head of the animal as markers. This method allows motion capturing of the whole animal as body and head can be tracked even when there is occlusion of some markers. In a large system with many cameras the triangulation is robust to marker loss through the view of many cameras. Unfortunately, this method is not suitable when attempting to capture the kinematics of the animal or the kinematics of particular appendages.</p>
    <p>SnakeStrike is a framework that allows researchers in animal tracking to use one piece of software from experiment start to finish and in combination with high-speed cameras to save time in the processing of 3D triangulation data for animals that can be difficult to track. Our preliminary data set on boid snakes showed that this framework is suitable to track even fast movements such as snake strikes and provides first information about the instantaneous speed during the complete strike of a boid snake. Although this data set primarily serves to demonstrate potential applications of this framework, it already showed that instantaneous strike speed has a similar magnitude, when compared across different individuals. In addition, our data on boid snakes shows similar strike profiles and trajectories as described for strikes of viperid snakes (<xref rid="B23" ref-type="bibr">Kardong and Bels, 1998</xref>; <xref rid="B17" ref-type="bibr">Herrel et al., 2011</xref>), suggesting the presence of a common motor program for executing strike behavior. Similar experiments with an increased number of markers placed on the snake body, would also allow for a further, more detailed analysis of the contribution of typical loop formations in strike progression.</p>
    <p>The data presented in Study 2 shows that the new framework presented here allows for collection of data even from vastly agile animals without the necessity of purchasing costly commercial systems or having to combine multiple other software solutions. Despite room for further improvement, the system provides scientists with new options and another alternative to existing systems such as DLTdv (<xref rid="B16" ref-type="bibr">Hedrick, 2008</xref>) to record novel data sets. Some drawbacks of the system derive from the necessity to simultaneously save the images from multiple high-speed cameras, which requires a large amount of memory for the initial capture, high CPU load for processing, and a large amount of hard drive space for long term storage. This requires a large upfront cost for a computer, although the computer can also be used for other tasks, and still costs only a fraction of a commercial system. However, the storage of the raw data, allows recalculations and reanalysis at any time (see below). Since changes of light intensity, shadowing, and occlusion of markers can occur within a given recording session, thresholding color from the images can be complicated and time consuming. The impact of this issue can be reduced, though not completely eliminated, by pre-tests of the color(s) to be thresholded in the actual setting, as well as by strict adherence to a consistent experimental environment and regime.</p>
    <p>The benefits of this framework considerably compensate for the few disadvantages, also because in many experiments, the latter can be at least partially circumvented. The reduced upfront costs compared to commercial motion tracking systems allows greater ability to incorporate motion tracking at high speed in animal studies. As shown in Study 1, the error in the system is small with regard to normally occurring sources of errors such as flickering lights, color thresholding problems, or marker identity swapping. For animals in which affixing large 3D markers is impossible because the animal might remove the markers or they do not remain affixed, this is a particular improvement. In studies of animal behavior, the goal usually is to obtain the largest amount of usable data as possible. Being able to store and reassess all originally captured images, rather than having to only rely on calculated 3D points is a very big advantage, since various additional analyses can be performed offline. This indicates that the acquired information can be used not only for the initial, principal aim of a project, but also allows answering novel questions without the necessity to perform a second experiment. Since all 3D points are decoupled from the images, the generation of the points in terms of decrease in error can be improved by new methods in the future. The data generated from older studies can therefore be re-interpreted or interpreted in greater detail, when, for example, new algorithms for coping with occlusion of tracking markers has been developed. Triangulation of data collected today would suffer from this aspect of the current state of the art in algorithms. However, if this problem is improved, these data can be easily re-interpreted with new algorithms and possible new insight can be obtained, without having to re-run tedious and often difficult and time-consuming experiments. SnakeStrike brings the functionality of several open source projects together in a way that is highly beneficial to researchers who have no access to expensive motion capture systems. Researchers who work with non-standard and especially fast-moving animals now have an affordable option to exploit novel experimental ideas. In addition, those interested in testing new algorithms for object correspondence over time can generate real-world data sets very quickly and easily, or test ideas on previously collected data.</p>
  </sec>
  <sec sec-type="data-availability" id="S5">
    <title>Data Availability Statement</title>
    <p>The datasets generated for this study are available on request to the corresponding author.</p>
  </sec>
  <sec id="S6">
    <title>Ethics Statement</title>
    <p>The animal study was reviewed and approved by the Thüringer Landesamt für Verbraucherschutz; code: 15-003/16.</p>
  </sec>
  <sec id="S7">
    <title>Author Contributions</title>
    <p>GJ, HS, PS, and TK: conceptualization. GJ: methodology, software, validation, investigation, data curation, writing – original draft. GJ, HS, EH, PS, and TK: formal analysis, writing – review editing. PS and TK: resources. GJ and TK: visualization. HS, EH, PS, and TK: supervision. TK: project administration. HS, PS, and TK: funding acquisition. All authors contributed to the article and approved the submitted version.</p>
  </sec>
  <sec id="conf1">
    <title>Conflict of Interest</title>
    <p>GJ and PS were employed by Volkswagen Group, in the Machine Learning Research Lab. The remaining authors declare that the research was conducted in the absence of any commercial or financial relationships that could be construed as a potential conflict of interest.</p>
  </sec>
</body>
<back>
  <fn-group>
    <fn fn-type="financial-disclosure">
      <p><bold>Funding.</bold> This research was partly funded by a grant from the Bernstein Center for Computational Neuroscience (BCCN) Munich (Project B-T7) as well as additional intramural funding from the Biomimetics Center at TUM.</p>
    </fn>
  </fn-group>
  <ack>
    <p>We would like to thank Dr. Alexandros Paraschos for his help configuring and running the Franka Emika Panda arm for the verification study. We would also like to thank Rommy Petersohn and Ingrid Weiss for their help in collecting the <italic>X</italic>-ray data in Jena.</p>
  </ack>
  <fn-group>
    <fn id="footnote1">
      <label>1</label>
      <p>
        <ext-link ext-link-type="uri" xlink:href="http://www.compadre.org/OSP/">http://www.compadre.org/OSP/</ext-link>
      </p>
    </fn>
  </fn-group>
  <sec id="S10" sec-type="supplementary material">
    <title>Supplementary Material</title>
    <p>The Supplementary Material for this article can be found online at: <ext-link ext-link-type="uri" xlink:href="https://www.frontiersin.org/articles/10.3389/fnbeh.2020.00116/full#supplementary-material">https://www.frontiersin.org/articles/10.3389/fnbeh.2020.00116/full#supplementary-material</ext-link></p>
    <supplementary-material content-type="local-data" id="FS1">
      <label>FIGURE S1</label>
      <caption>
        <p>Study 1: Error in marker location while the fiberboard with attached markers was moved through space by the Franka Emika Panda robotic arm. Parameters: two marker sizes and two relative speeds of movement of the markers. Data is shown for one camera lens (Ricoh FL-CC0614A-2M) <bold>(A)</bold> Each boxplot refers to an interpoint distance error between two points of known distance (<xref rid="T1" ref-type="table">Table 1</xref>) in the calibration object; the numbers on the <italic>x</italic>-axis represent the points and are separated by a hyphen. <bold>(B)</bold> Marker distance from the best-fitting plane for all markers.</p>
      </caption>
      <media xlink:href="Image_1.JPEG">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="FS2">
      <label>FIGURE S2</label>
      <caption>
        <p>Same data as shown in <xref ref-type="fig" rid="F5">Figures 5A,B</xref>, but post-processed with a Kalman filter to illustrate the improvement by filtering or smoothing of the triangulated data for the analysis. <bold>(A)</bold> Each boxplot refers to an interpoint distance error between two points of known distance in the calibration object (<xref rid="T1" ref-type="table">Table 1</xref>). The numbers on the <italic>x</italic>-axis represent the points and are separated by a hyphen. <bold>(B)</bold> Distance of markers from best-fitting plane for all markers (left). Movement of triangulated points in 3D from their mean while markers were stationary (right).</p>
      </caption>
      <media xlink:href="Image_2.JPEG">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="FS3">
      <label>FIGURE S3</label>
      <caption>
        <p>Study 1: Effect of light-flickering on inter-marker distance error variance. The markers were stationary and perpendicular to the cameras’ position. Each boxplot refers to an interpoint distance error between two points of known distance in the calibration object (<xref rid="T1" ref-type="table">Table 1</xref>). The numbers on the <italic>x</italic>-axis represent the points and are separated by a hyphen. <bold>(A)</bold> Example of a trial where flickering was present in the light source. <bold>(B)</bold> Example of a trial in a different setting where light-flickering was absent. <bold>(C)</bold> Example of a trial in the same setup as in <bold>(B)</bold>, but with a different camera calibration.</p>
      </caption>
      <media xlink:href="Image_3.JPEG">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="FS4">
      <label>FIGURE S4</label>
      <caption>
        <p>Study 1: Same data as in <xref ref-type="supplementary-material" rid="FS3">Supplementary Figure S3</xref>, but with the error displayed as the distance of the marker from the best-fitting plane for all of markers. <bold>(A)</bold> Example of a trial where flickering was present in the light source. <bold>(B)</bold> Example of a trial in a different setup where light-flickering was absent. <bold>(C)</bold> Example of a trial in the same setup as in <bold>(B)</bold>, but with a different camera calibration.</p>
      </caption>
      <media xlink:href="Image_4.JPEG">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="VS1">
      <media xlink:href="Video_1.MP4">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="VS2">
      <media xlink:href="Video_2.MP4">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
  <ref-list>
    <title>References</title>
    <ref id="B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Altshuler</surname><given-names>D. L.</given-names></name><name><surname>Dickson</surname><given-names>W. B.</given-names></name><name><surname>Vance</surname><given-names>J. T.</given-names></name><name><surname>Roberts</surname><given-names>S. P.</given-names></name><name><surname>Dickinson</surname><given-names>M. H.</given-names></name></person-group> (<year>2005</year>). <article-title>Short-amplitude high-frequency wing strokes determine the aerodynamics of honeybee flight.</article-title>
<source><italic>Proc. Natl. Acad. Sci. U.S.A.</italic></source>
<volume>102</volume>
<fpage>18213</fpage>–<lpage>18218</lpage>. <pub-id pub-id-type="doi">10.1073/pnas.0506590102</pub-id>
<?supplied-pmid 16330767?><pub-id pub-id-type="pmid">16330767</pub-id></mixed-citation>
    </ref>
    <ref id="B2">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Bay</surname><given-names>H.</given-names></name><name><surname>Tuytelaars</surname><given-names>T.</given-names></name><name><surname>Van Gool</surname><given-names>L.</given-names></name></person-group> (<year>2006</year>). “<article-title>SURF: speeded up robust features</article-title>,” in <source><italic>Computer Vision – ECCV 2006. ECCV 2006. Lecture Notes in Computer Science</italic></source>, <volume>Vol. 3951</volume>
<role>eds</role>
<person-group person-group-type="editor"><name><surname>Leonardis</surname><given-names>A.</given-names></name><name><surname>Bischof</surname><given-names>H.</given-names></name><name><surname>Pinz</surname><given-names>A.</given-names></name></person-group> (<publisher-loc>Berlin</publisher-loc>: <publisher-name>Springer</publisher-name>), <fpage>404</fpage>–<lpage>417</lpage>.</mixed-citation>
    </ref>
    <ref id="B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Boeddeker</surname><given-names>N.</given-names></name><name><surname>Dittmar</surname><given-names>L.</given-names></name><name><surname>Stürzl</surname><given-names>W.</given-names></name><name><surname>Egelhaaf</surname><given-names>M.</given-names></name></person-group> (<year>2010</year>). <article-title>The fine structure of honeybee head and body yaw movements in a homing task.</article-title>
<source><italic>Proc. R. Soc. B Biol. Sci.</italic></source>
<volume>277</volume>
<fpage>1899</fpage>–<lpage>1906</lpage>. <pub-id pub-id-type="doi">10.1098/rspb.2009.2326</pub-id>
<?supplied-pmid 20147329?><pub-id pub-id-type="pmid">20147329</pub-id></mixed-citation>
    </ref>
    <ref id="B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bourgeois</surname><given-names>F.</given-names></name><name><surname>Lassalle</surname><given-names>J.</given-names></name></person-group> (<year>1971</year>). <article-title>An extension of the munkres algorithm for the assignment problem to rectangular matrices.</article-title>
<source><italic>Commun. ACM</italic></source>
<volume>14</volume>
<fpage>802</fpage>–<lpage>804</lpage>. <pub-id pub-id-type="doi">10.1145/362919.362945</pub-id></mixed-citation>
    </ref>
    <ref id="B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bradski</surname><given-names>G.</given-names></name></person-group> (<year>2000</year>). <article-title>The OpenCV library.</article-title>
<source><italic>Dr. Dobbs J. Softw. Tools</italic></source>
<volume>120</volume>
<fpage>122</fpage>–<lpage>125</lpage>.</mixed-citation>
    </ref>
    <ref id="B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cao</surname><given-names>Z.</given-names></name><name><surname>Hidalgo</surname><given-names>G.</given-names></name><name><surname>Simon</surname><given-names>T.</given-names></name><name><surname>Wei</surname><given-names>S.-E.</given-names></name><name><surname>Sheikh</surname><given-names>Y.</given-names></name></person-group> (<year>2018</year>). <article-title>OpenPose: realtime multi-person 2D poseestimation using part affinity fields.</article-title>
<source><italic>InarXiv</italic></source>
<comment>[Preprint]. Xiv:1812.08008</comment></mixed-citation>
    </ref>
    <ref id="B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cundall</surname><given-names>D.</given-names></name><name><surname>Deufel</surname><given-names>A.</given-names></name></person-group> (<year>1999</year>). <article-title>Striking patterns in booid snakes.</article-title>
<source><italic>Copeia.</italic></source>
<volume>4</volume>
<fpage>868</fpage>–<lpage>883</lpage>.</mixed-citation>
    </ref>
    <ref id="B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dahmen</surname><given-names>H. J.</given-names></name><name><surname>Zeil</surname><given-names>J.</given-names></name></person-group> (<year>1984</year>). <article-title>Recording and reconstructing three-dimensional trajectories: a versatile method for the field biologist.</article-title>
<source><italic>Proc. R. Soc. Lond. Ser. B. Biol. Sci.</italic></source>
<volume>222</volume>
<fpage>107</fpage>–<lpage>113</lpage>. <pub-id pub-id-type="doi">10.1098/rspb.1984.0051</pub-id></mixed-citation>
    </ref>
    <ref id="B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fry</surname><given-names>S. N.</given-names></name><name><surname>Bichsel</surname><given-names>M.</given-names></name><name><surname>Müller</surname><given-names>P.</given-names></name><name><surname>Robert</surname><given-names>D.</given-names></name></person-group> (<year>2000</year>). <article-title>Tracking of flying insects using pan-tilt cameras.</article-title>
<source><italic>J. Neurosci. Methods</italic></source>
<volume>101</volume>
<fpage>59</fpage>–<lpage>67</lpage>. <pub-id pub-id-type="doi">10.1016/s0165-0270(00)00253-3</pub-id><pub-id pub-id-type="pmid">10967362</pub-id></mixed-citation>
    </ref>
    <ref id="B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gart</surname><given-names>S. W.</given-names></name><name><surname>Mitchel</surname><given-names>T. W.</given-names></name><name><surname>Li</surname><given-names>C.</given-names></name></person-group> (<year>2019</year>). <article-title>Snakes partition their body to traverse large steps stably.</article-title>
<source><italic>J. Exp. Biol.</italic></source>
<volume>222</volume>:<issue>jeb185991</issue>. <pub-id pub-id-type="doi">10.1242/jeb.185991</pub-id>
<?supplied-pmid 30936272?><pub-id pub-id-type="pmid">30936272</pub-id></mixed-citation>
    </ref>
    <ref id="B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Geurten</surname><given-names>B. R.</given-names></name><name><surname>Kern</surname><given-names>R.</given-names></name><name><surname>Braun</surname><given-names>E.</given-names></name><name><surname>Egelhaaf</surname><given-names>M.</given-names></name></person-group> (<year>2010</year>). <article-title>A syntax of hoverfly flight prototypes.</article-title>
<source><italic>J. Exp. Biol.</italic></source>
<volume>213</volume>
<fpage>2461</fpage>–<lpage>2475</lpage>. <pub-id pub-id-type="doi">10.1242/jeb.036079</pub-id>
<?supplied-pmid 20581276?><pub-id pub-id-type="pmid">20581276</pub-id></mixed-citation>
    </ref>
    <ref id="B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Guennebaud</surname><given-names>G.</given-names></name><name><surname>Jacob</surname><given-names>B.</given-names></name></person-group> (<year>2010</year>). <source><italic>Eigen v3.</italic></source> Available online at: <ext-link ext-link-type="uri" xlink:href="http://eigen.tuxfamily.org">http://eigen.tuxfamily.org</ext-link>
<comment>(accessed May 5, 2017)</comment>.</mixed-citation>
    </ref>
    <ref id="B13">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Hartley</surname><given-names>R.</given-names></name><name><surname>Kahl</surname><given-names>F.</given-names></name></person-group> (<year>2007</year>). “<article-title>Optimal algorithms in multiview geometry</article-title>,” in <source><italic>Computer Vision – ACCV 2007. ACCV 2007. Lecture Notes in Computer Science</italic></source>, <volume>Vol. 4843</volume>
<role>eds</role>
<person-group person-group-type="editor"><name><surname>Yagi</surname><given-names>Y.</given-names></name><name><surname>Kang</surname><given-names>S. B.</given-names></name><name><surname>Kweon</surname><given-names>I. S.</given-names></name><name><surname>Zha</surname><given-names>H.</given-names></name></person-group> (<publisher-loc>Berlin</publisher-loc>: <publisher-name>Springer</publisher-name>).</mixed-citation>
    </ref>
    <ref id="B14">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Hartley</surname><given-names>R.</given-names></name><name><surname>Zisserman</surname><given-names>A.</given-names></name></person-group> (<year>2003</year>). <source><italic>Multiple View Geometry in Computer Vision.</italic></source>
<publisher-loc>New York, NY</publisher-loc>: <publisher-name>Cambridge University Press</publisher-name>.</mixed-citation>
    </ref>
    <ref id="B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hartley</surname><given-names>R. I.</given-names></name><name><surname>Sturm</surname><given-names>P.</given-names></name></person-group> (<year>1997</year>). <article-title>Triangulation.</article-title>
<source><italic>Comput. Vis. Image Underst</italic></source>
<volume>68</volume>
<fpage>146</fpage>–<lpage>157</lpage>. <pub-id pub-id-type="doi">10.1006/cviu.1997.0547</pub-id></mixed-citation>
    </ref>
    <ref id="B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hedrick</surname><given-names>T. L.</given-names></name></person-group> (<year>2008</year>). <article-title>Software techniques for two- and three-dimensional kinematic measurements of biological and biomimetic systems.</article-title>
<source><italic>Bioinspir. Biomim.</italic></source>
<volume>3</volume>:<issue>034001</issue>
<pub-id pub-id-type="doi">10.1088/1748-3182/3/3/034001</pub-id></mixed-citation>
    </ref>
    <ref id="B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Herrel</surname><given-names>A.</given-names></name><name><surname>Huyghe</surname><given-names>K.</given-names></name><name><surname>Oković</surname><given-names>P.</given-names></name><name><surname>Lisičić</surname><given-names>D.</given-names></name><name><surname>Tadić</surname><given-names>Z.</given-names></name></person-group> (<year>2011</year>). <article-title>Fast and furious: effects of body size on strike performance in an arboreal viper Trimeresurus (Cryptelytrops) albolabris.</article-title>
<source><italic>J. Exp. Zool.</italic></source>
<volume>315A</volume>
<fpage>22</fpage>–<lpage>29</lpage>. <pub-id pub-id-type="doi">10.1002/jez.645</pub-id>
<?supplied-pmid 20853417?><pub-id pub-id-type="pmid">20853417</pub-id></mixed-citation>
    </ref>
    <ref id="B18">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Insafutdinov</surname><given-names>E.</given-names></name><name><surname>Andriluka</surname><given-names>M.</given-names></name><name><surname>Pishchulin</surname><given-names>L.</given-names></name><name><surname>Tang</surname><given-names>S.</given-names></name><name><surname>Levinkov</surname><given-names>E.</given-names></name><name><surname>Andres</surname><given-names>B.</given-names></name><name><surname>Schiele</surname><given-names>B.</given-names></name></person-group> (<year>2017</year>). “<article-title>Articulated multi-person tracking in the wild</article-title>” in <source><italic>The IEEE Conference on Computer Vision and Pattern Recognition (CVPR)</italic></source> (<publisher-loc>Piscataway, NJ</publisher-loc>: <publisher-name>IEEE</publisher-name>), <fpage>6457</fpage>–<lpage>6465</lpage>.</mixed-citation>
    </ref>
    <ref id="B19">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Insafutdinov</surname><given-names>E.</given-names></name><name><surname>Pishchulin</surname><given-names>L.</given-names></name><name><surname>Andres</surname><given-names>B.</given-names></name><name><surname>Andriluka</surname><given-names>M.</given-names></name><name><surname>Schiele</surname><given-names>B.</given-names></name></person-group> (<year>2016</year>). “<article-title>DeeperCut: a deeper, stronger, and faster multi-person pose estimation model</article-title>” in <comment>Computer Vision – ECCV 2016. ECCV 2016</comment>
<source><italic>Lecture Notes in Computer Science</italic></source>, vol <volume>9910</volume>
<role>eds</role>
<person-group person-group-type="editor"><name><surname>Leibe</surname><given-names>B.</given-names></name><name><surname>Matas</surname><given-names>J.</given-names></name><name><surname>Sebe</surname><given-names>N.</given-names></name><name><surname>Welling</surname><given-names>M</given-names></name></person-group> (<publisher-loc>Cham</publisher-loc>: <publisher-name>Springer</publisher-name>)</mixed-citation>
    </ref>
    <ref id="B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kalman</surname><given-names>R. E.</given-names></name></person-group> (<year>1960</year>). <article-title>A new approach to linear filtering and prediction problems.</article-title>
<source><italic>Transact. ASME J. Basic Eng.</italic></source>
<volume>82</volume>
<fpage>35</fpage>–<lpage>45</lpage>. <pub-id pub-id-type="doi">10.1115/1.3662552</pub-id></mixed-citation>
    </ref>
    <ref id="B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kanatani</surname><given-names>K.</given-names></name><name><surname>Sugaya</surname><given-names>H.</given-names></name><name><surname>Niitsuma</surname><given-names>H.</given-names></name></person-group> (<year>2008</year>). “<article-title>Triangulation from two views revisited: hartley-Sturm vs optimal correction</article-title>” in <source><italic>Proceedings of the 19th British Machine Vision Conference</italic></source>, <comment>Leeds</comment>, <fpage>173</fpage>–<lpage>182</lpage></mixed-citation>
    </ref>
    <ref id="B22">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Kanatani</surname><given-names>K.</given-names></name><name><surname>Sugaya</surname><given-names>Y.</given-names></name><name><surname>Kanazawa</surname><given-names>Y.</given-names></name></person-group> (<year>2016</year>). <source><italic>Guide to 3D Vision Computation: Geometric Analysis and Implementation</italic></source>, <edition>1st Edn</edition>
<publisher-loc>Berlin</publisher-loc>: <publisher-name>Springer Publishing Company</publisher-name>.</mixed-citation>
    </ref>
    <ref id="B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kardong</surname><given-names>K. V.</given-names></name><name><surname>Bels</surname><given-names>V. L.</given-names></name></person-group> (<year>1998</year>). <article-title>Rattlesnake strike behavior: kinematics.</article-title>
<source><italic>J. Exp. Biol.</italic></source>
<volume>1998</volume>
<fpage>837</fpage>–<lpage>850</lpage>.</mixed-citation>
    </ref>
    <ref id="B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kuhn</surname><given-names>H. W.</given-names></name></person-group> (<year>1959</year>). <article-title>Variants of the hungarian method for assignment problems.</article-title>
<source><italic>Naval Res. Log. Q.</italic></source>
<volume>3</volume>
<fpage>253</fpage>–<lpage>258</lpage>. <pub-id pub-id-type="doi">10.1002/nav.3800030404</pub-id></mixed-citation>
    </ref>
    <ref id="B25">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Li</surname><given-names>B.</given-names></name><name><surname>Heng</surname><given-names>L.</given-names></name><name><surname>Köser</surname><given-names>K.</given-names></name><name><surname>Pollefeys</surname><given-names>M.</given-names></name></person-group> (<year>2013</year>). “<article-title>A multiple camera system calibration toolbox using a feature descriptor-based calibration pattern</article-title>,” in <source><italic>Proceedings of the 2013 IEEE/RSJ International Conference on Intelligent Robots and Systems. Intelligent Robots and Systems (IROS)</italic></source>, <publisher-loc>Tokyo</publisher-loc>, <fpage>1301</fpage>–<lpage>1307</lpage>.</mixed-citation>
    </ref>
    <ref id="B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mathis</surname><given-names>A.</given-names></name><name><surname>Mamidanna</surname><given-names>P.</given-names></name><name><surname>Cury</surname><given-names>K. M.</given-names></name><name><surname>Abe</surname><given-names>T.</given-names></name><name><surname>Murthy</surname><given-names>V. N.</given-names></name><name><surname>Weygandt Mathis</surname><given-names>M.</given-names></name><etal/></person-group> (<year>2018</year>). <article-title>DeepLabCut: markerless pose estimation of user-defined body parts with deep learning.</article-title>
<source><italic>Nat. Neurosci.</italic></source>
<volume>21</volume>
<fpage>1281</fpage>–<lpage>1289</lpage>. <pub-id pub-id-type="doi">10.1038/s41593-018-0209-y</pub-id>
<?supplied-pmid 30127430?><pub-id pub-id-type="pmid">30127430</pub-id></mixed-citation>
    </ref>
    <ref id="B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Moulon</surname><given-names>P.</given-names></name><name><surname>Monasse</surname><given-names>P.</given-names></name><name><surname>Marlet</surname><given-names>R.</given-names></name><name><surname>Perrot</surname><given-names>R.</given-names></name></person-group> (<year>2013</year>). <source><italic>OpenMVG. An Open Multiple View Geometry library.</italic></source> Available online at: <ext-link ext-link-type="uri" xlink:href="https://github.com/openMVG/openMVG">https://github.com/openMVG/openMVG</ext-link>
<comment>(accessed June 16, 2017)</comment>.</mixed-citation>
    </ref>
    <ref id="B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Munkres</surname><given-names>J.</given-names></name></person-group> (<year>1957</year>). <article-title>Algorithms for the assignment and transportation problems.</article-title>
<source><italic>J. Soc. Indust. Appl. Mathem.</italic></source>
<volume>5</volume>
<fpage>32</fpage>–<lpage>38</lpage>.</mixed-citation>
    </ref>
    <ref id="B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Patek</surname><given-names>S. N.</given-names></name><name><surname>Korff</surname><given-names>W. L.</given-names></name><name><surname>Caldwell</surname><given-names>R. L.</given-names></name></person-group> (<year>2004</year>). <article-title>Deadly strike mechanism of a mantis shrimp.</article-title>
<source><italic>Nature</italic></source>
<volume>428</volume>
<fpage>819</fpage>–<lpage>820</lpage>. <pub-id pub-id-type="doi">10.1038/428819a</pub-id>
<?supplied-pmid 15103366?><pub-id pub-id-type="pmid">15103366</pub-id></mixed-citation>
    </ref>
    <ref id="B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Penning</surname><given-names>D.</given-names></name><name><surname>Sawvel</surname><given-names>B.</given-names></name><name><surname>Moon</surname><given-names>B.</given-names></name></person-group> (<year>2016</year>). <article-title>Debunking the viper’s strike:harmless snakes kill a common assumption.</article-title>
<source><italic>Biology Lett.</italic></source>
<volume>12</volume>:<issue>20160011</issue>. <pub-id pub-id-type="doi">10.1098/rsbl.2016.0011</pub-id>
<?supplied-pmid 26979562?><pub-id pub-id-type="pmid">26979562</pub-id></mixed-citation>
    </ref>
    <ref id="B31">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pereira</surname><given-names>T. D.</given-names></name><name><surname>Aldarondo</surname><given-names>D. E.</given-names></name><name><surname>Willmore</surname><given-names>L.</given-names></name><name><surname>Kislin</surname><given-names>M.</given-names></name><name><surname>Kislin</surname><given-names>S. S.-M.</given-names></name><name><surname>Murthy</surname><given-names>M.</given-names></name><etal/></person-group> (<year>2019</year>). <article-title>Fast animal pose estimation using deep neural networks.</article-title>
<source><italic>Nat. Methods</italic></source>
<volume>16</volume>
<fpage>117</fpage>–<lpage>125</lpage>. <pub-id pub-id-type="doi">10.1038/s41592-018-0234-5</pub-id>
<?supplied-pmid 30573820?><pub-id pub-id-type="pmid">30573820</pub-id></mixed-citation>
    </ref>
    <ref id="B32">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Rasband</surname><given-names>W. S.</given-names></name></person-group> (<year>1997-2018</year>). <source><italic>ImageJ.</italic></source>
<publisher-loc>Bethesda, MD</publisher-loc>: <publisher-name>U. S. National Institutes of Health</publisher-name>.</mixed-citation>
    </ref>
    <ref id="B33">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Robie</surname><given-names>A. A.</given-names></name><name><surname>Seagraves</surname><given-names>K. M.</given-names></name><name><surname>Egnor</surname><given-names>S. E. R.</given-names></name><name><surname>Branson</surname><given-names>K.</given-names></name></person-group> (<year>2017</year>). <article-title>Machine vision methods for analyzing social interactions.</article-title>
<source><italic>J. Exp. Biol.</italic></source>
<volume>220</volume>
<fpage>25</fpage>–<lpage>34</lpage>. <pub-id pub-id-type="doi">10.1242/jeb.142281</pub-id>
<?supplied-pmid 28057825?><pub-id pub-id-type="pmid">28057825</pub-id></mixed-citation>
    </ref>
    <ref id="B34">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Rusu</surname><given-names>R. B.</given-names></name><name><surname>Cousins</surname><given-names>S.</given-names></name></person-group> (<year>2011</year>). “<article-title>3D is here: Point Cloud Library (PCL). Robotics and Automation (ICRA)</article-title>,” in <source><italic>Proceedings of the 2011 IEEE International Conference on May</italic></source> (<publisher-loc>Shanghai</publisher-loc>: <publisher-name>IEEE</publisher-name>), <fpage>1</fpage>–<lpage>4</lpage>.</mixed-citation>
    </ref>
    <ref id="B35">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ryerson</surname><given-names>W. G.</given-names></name><name><surname>Tan</surname><given-names>W.</given-names></name></person-group> (<year>2017</year>). <article-title>Strike kinematics and performance in juvenile ball pythons (Python regius).</article-title>
<source><italic>J. Exp. Zool</italic></source>
<volume>327</volume>
<fpage>453</fpage>–<lpage>457</lpage>. <pub-id pub-id-type="doi">10.1002/jez.2131</pub-id>
<?supplied-pmid 29356394?><pub-id pub-id-type="pmid">29356394</pub-id></mixed-citation>
    </ref>
    <ref id="B36">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Schroeder</surname><given-names>W.</given-names></name><name><surname>Martin</surname><given-names>K.</given-names></name><name><surname>Lorensen</surname><given-names>B.</given-names></name></person-group> (<year>2006</year>). <source><italic>The Visualization Toolkit–An Object-Oriented Approach To 3D Graphics</italic></source>, <edition>4th Edn</edition>
<publisher-loc>Clifton Park, NY</publisher-loc>: <publisher-name>Kitware, Inc</publisher-name>.</mixed-citation>
    </ref>
    <ref id="B37">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Seid</surname><given-names>M. A.</given-names></name><name><surname>Scheffrahn</surname><given-names>R. H.</given-names></name><name><surname>Niven</surname><given-names>J. E.</given-names></name></person-group> (<year>2008</year>). <article-title>The rapid mandible strike of a termite soldier.</article-title>
<source><italic>Curr. Biol.</italic></source>
<volume>18</volume>
<fpage>R1049</fpage>–<lpage>R1050</lpage>.<pub-id pub-id-type="pmid">19036330</pub-id></mixed-citation>
    </ref>
    <ref id="B38">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Stewenius</surname><given-names>H.</given-names></name><name><surname>Schaffalitzky</surname><given-names>F.</given-names></name><name><surname>Nister</surname><given-names>D.</given-names></name></person-group> (<year>2005</year>). “<article-title>How hard is 3-view triangulation really?</article-title>,” in <source><italic>Proceedings of the Tenth IEEE International Conference on Computer Vision (ICCV’05)</italic></source>, <volume>Vol. 1</volume> (<publisher-loc>Piscataway, NJ</publisher-loc>: <publisher-name>IEEE</publisher-name>), <fpage>686</fpage>–<lpage>693</lpage>. <pub-id pub-id-type="doi">10.1109/ICCV.2005.115</pub-id></mixed-citation>
    </ref>
    <ref id="B39">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Straw</surname><given-names>A. D.</given-names></name><name><surname>Branson</surname><given-names>K.</given-names></name><name><surname>Neumann</surname><given-names>T. R.</given-names></name><name><surname>Dickinson</surname><given-names>M. H.</given-names></name></person-group> (<year>2011</year>). <article-title>Multi-camera real-time three-dimensional tracking of multiple flying animals.</article-title>
<source><italic>J. R. Soc. Interface</italic></source>
<volume>8</volume>
<fpage>395</fpage>–<lpage>409</lpage>. <pub-id pub-id-type="doi">10.1098/rsif.2010.0230</pub-id>
<?supplied-pmid 20630879?><pub-id pub-id-type="pmid">20630879</pub-id></mixed-citation>
    </ref>
    <ref id="B40">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sutherland</surname><given-names>I. E.</given-names></name></person-group> (<year>1974</year>). <article-title>Three-dimensional data input by tablet.</article-title>
<source><italic>Proc. IEEE</italic></source>
<volume>62</volume>
<fpage>453</fpage>–<lpage>461</lpage>. <pub-id pub-id-type="doi">10.1109/proc.1974.9449</pub-id></mixed-citation>
    </ref>
    <ref id="B41">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Theunissen</surname><given-names>L. M.</given-names></name><name><surname>Dürr</surname><given-names>V.</given-names></name></person-group> (<year>2013</year>). <article-title>Insects use two distinct classes of steps during unrestrained locomotion.</article-title>
<source><italic>PLoS One</italic></source>
<volume>8</volume>:<issue>e85321</issue>. <pub-id pub-id-type="doi">10.1371/journal.pone.0085321</pub-id>
<?supplied-pmid 24376877?><pub-id pub-id-type="pmid">24376877</pub-id></mixed-citation>
    </ref>
    <ref id="B42">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Theunissen</surname><given-names>L. M.</given-names></name><name><surname>Reid</surname><given-names>T.</given-names></name><name><surname>Troje</surname><given-names>N. F.</given-names></name></person-group> (<year>2017</year>). <article-title>Pigeons use distinct stop phases to control pecking.</article-title>
<source><italic>J. Exp. Biol.</italic></source>
<volume>220</volume>
<fpage>437</fpage>–<lpage>444</lpage>. <pub-id pub-id-type="doi">10.1242/jeb.147850</pub-id>
<?supplied-pmid 27885041?><pub-id pub-id-type="pmid">27885041</pub-id></mixed-citation>
    </ref>
    <ref id="B43">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tian</surname><given-names>W.</given-names></name><name><surname>Cong</surname><given-names>Q.</given-names></name><name><surname>Menon</surname><given-names>C. J.</given-names></name></person-group> (<year>2011</year>). <article-title>Investigation on walking and pacing stability of german shepherd dog for different locomotion speeds.</article-title>
<source><italic>Bionic. Eng.</italic></source>
<volume>8</volume>:<issue>18</issue>
<pub-id pub-id-type="doi">10.1016/s1672-6529(11)60002-4</pub-id></mixed-citation>
    </ref>
    <ref id="B44">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tobalske</surname><given-names>B. W.</given-names></name><name><surname>Warrick</surname><given-names>D. R.</given-names></name><name><surname>Clark</surname><given-names>C. J.</given-names></name><name><surname>Powers</surname><given-names>D. R.</given-names></name><name><surname>Hedrick</surname><given-names>T. L.</given-names></name><name><surname>Hyder</surname><given-names>G. A.</given-names></name><etal/></person-group> (<year>2007</year>). <article-title>Three-dimensional kinematics of hummingbird flight.</article-title>
<source><italic>J. Exp. Biol.</italic></source>
<volume>210</volume>
<fpage>2368</fpage>–<lpage>2382</lpage>. <pub-id pub-id-type="doi">10.1242/jeb.005686</pub-id>
<?supplied-pmid 17575042?><pub-id pub-id-type="pmid">17575042</pub-id></mixed-citation>
    </ref>
    <ref id="B45">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Toshev</surname><given-names>A.</given-names></name><name><surname>Szegedy</surname><given-names>C.</given-names></name></person-group> (<year>2014</year>). “<article-title>Deeppose: human pose estimation via deep neural networks</article-title>,” in <source><italic>Proceedings of the 2014 IEEE Conference on Computer Vision and Pattern Recognition (CVPR)</italic></source> (<publisher-loc>Piscataway, NJ</publisher-loc>: <publisher-name>IEEE</publisher-name>), <fpage>1653</fpage>–<lpage>1660</lpage>.</mixed-citation>
    </ref>
    <ref id="B46">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Young</surname><given-names>B. A.</given-names></name></person-group> (<year>2010</year>). <article-title>How a heavy-bodied snake strikes quickly: high-power axial musculature in the puff adder (Bitis arietans).</article-title>
<source><italic>J. Exp. Zool.</italic></source>
<volume>313A</volume>
<fpage>114</fpage>–<lpage>121</lpage>.</mixed-citation>
    </ref>
  </ref-list>
</back>
