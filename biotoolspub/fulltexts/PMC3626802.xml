<?DTDIdentifier.IdentifierValue article.dtd?>
<?DTDIdentifier.IdentifierType system?>
<?SourceDTD.DTDName article.dtd?>
<?SourceDTD.Version 1.0?>
<?ConverterInfo.XSLTName bmc2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">3626802</article-id>
    <article-id pub-id-type="publisher-id">1471-2105-14-39</article-id>
    <article-id pub-id-type="pmid">23379655</article-id>
    <article-id pub-id-type="doi">10.1186/1471-2105-14-39</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>puma 3.0: improved uncertainty propagation methods for gene and transcript expression analysis</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes" id="A1">
        <name>
          <surname>Liu</surname>
          <given-names>Xuejun</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <email>xuejun.liu@nuaa.edu.cn</email>
      </contrib>
      <contrib contrib-type="author" id="A2">
        <name>
          <surname>Gao</surname>
          <given-names>Zhenzhu</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <email>zhenzhu1717@yahoo.cn</email>
      </contrib>
      <contrib contrib-type="author" id="A3">
        <name>
          <surname>Zhang</surname>
          <given-names>Li</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <email>leo.zhang@nuaa.edu.cn</email>
      </contrib>
      <contrib contrib-type="author" corresp="yes" id="A4">
        <name>
          <surname>Rattray</surname>
          <given-names>Magnus</given-names>
        </name>
        <xref ref-type="aff" rid="I2">2</xref>
        <email>magnus.rattray@manchester.ac.uk</email>
      </contrib>
    </contrib-group>
    <aff id="I1"><label>1</label>College of Computer Science and Technology, Nanjing University of Aeronautics and Astronautics, 29 Yudao St., Nanjing, 210016, China</aff>
    <aff id="I2"><label>2</label>Faculty of Life Sciences, University of Manchester, Oxford Road, Manchester M13 9PT, UK</aff>
    <pub-date pub-type="collection">
      <year>2013</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>5</day>
      <month>2</month>
      <year>2013</year>
    </pub-date>
    <volume>14</volume>
    <fpage>39</fpage>
    <lpage>39</lpage>
    <history>
      <date date-type="received">
        <day>13</day>
        <month>9</month>
        <year>2012</year>
      </date>
      <date date-type="accepted">
        <day>18</day>
        <month>1</month>
        <year>2013</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Copyright © 2013 Liu et al.; licensee BioMed Central Ltd.</copyright-statement>
      <copyright-year>2013</copyright-year>
      <copyright-holder>Liu et al.; licensee BioMed Central Ltd.</copyright-holder>
      <license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/2.0">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/2.0">http://creativecommons.org/licenses/by/2.0</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="http://www.biomedcentral.com/1471-2105/14/39"/>
    <abstract>
      <sec>
        <title>Background</title>
        <p>Microarrays have been a popular tool for gene expression profiling at genome-scale for over a decade due to the low cost, short turn-around time, excellent quantitative accuracy and ease of data generation. The Bioconductor package <italic>puma</italic> incorporates a suite of analysis methods for determining uncertainties from Affymetrix GeneChip data and propagating these uncertainties to downstream analysis. As isoform level expression profiling receives more and more interest within genomics in recent years, exon microarray technology offers an important tool to quantify expression level of the majority of exons and enables the possibility of measuring isoform level expression. However, <italic>puma</italic> does not include methods for the analysis of exon array data. Moreover, the current expression summarisation method for Affymetrix 3’ GeneChip data suffers from instability for low expression genes. For the downstream analysis, the method for differential expression detection is computationally intensive and the original expression clustering method does not consider the variance across the replicated technical and biological measurements. It is therefore necessary to develop improved uncertainty propagation methods for gene and transcript expression analysis.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p>We extend the previously developed Bioconductor package <italic>puma</italic> with a new method especially designed for GeneChip Exon arrays and a set of improved downstream approaches. The improvements include: (i) a new gamma model for exon arrays which calculates isoform and gene expression measurements and a level of uncertainty associated with the estimates, using the multi-mappings between probes, isoforms and genes, (ii) a variant of the existing approach for the probe-level analysis of Affymetrix 3’ GeneChip data to produce more stable gene expression estimates, (iii) an improved method for detecting differential expression which is computationally more efficient than the existing approach in the package and (iv) an improved method for robust model-based clustering of gene expression, which takes technical and biological replicate information into consideration.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p>With the extensions and improvements, the <italic>puma</italic> package is now applicable to the analysis of both Affymetrix 3’ GeneChips and Exon arrays for gene and isoform expression estimation. It propagates the uncertainty of expression measurements into more efficient and comprehensive downstream analysis at both gene and isoform level. Downstream methods are also applicable to other expression quantification platforms, such as RNA-Seq, when uncertainty information is available from expression measurements. <italic>puma</italic> is available through Bioconductor and can be found at <ext-link ext-link-type="uri" xlink:href="http://www.bioconductor.org">http://www.bioconductor.org</ext-link>.</p>
      </sec>
    </abstract>
  </article-meta>
</front>
<body>
  <sec>
    <title>Background</title>
    <p>Microarrays have been applied to high-throughput gene expression profiling for over a decade due to several advantages, e.g. high coverage, low cost, short turn-around time, excellent quantitative accuracy and ease of data generation. It has been shown recently that microarrays still remain an efficient and reliable tool for expression quantification especially for low-abundance targets [<xref ref-type="bibr" rid="B1">1</xref>]. We previously developed the Bioconductor package <italic>puma</italic>[<xref ref-type="bibr" rid="B2">2</xref>] for Affymetrix GeneChip data analysis. In the initial probe-level analysis, <italic>puma</italic> uses the multi-mgMOS method [<xref ref-type="bibr" rid="B3">3</xref>] to obtain an expression estimate for each gene and a level of uncertainty associated with this estimate. In the downstream analysis, <italic>puma</italic> propagates these uncertainties to principal component analysis, differential expression detection and gene expression clustering using methods NPPCA [<xref ref-type="bibr" rid="B4">4</xref>], PPLR [<xref ref-type="bibr" rid="B5">5</xref>] and PUMA-CLUST [<xref ref-type="bibr" rid="B6">6</xref>], respectively, and obtains improved analysis results. In addition to expression measurements obtained from microarrays, these downstream methods are also applicable to other expression quantification platforms, e.g. RNA-Seq based on high throughput sequencing technology, providing a level of uncertainty is associated with each measurement.</p>
    <p>As the analysis of alternative splicing gains more and more interest in recent years, exon microarray technology, such as Affymetrix GeneChip Exon arrays, provides an option for measuring isoform level expression. It is therefore necessary for <italic>puma</italic> to include methods for propagating isoform expression uncertainty in the analysis of exon array data. Furthermore, the current probe-level analysis method, multi-mgMOS, obtains unstable expression estimates for low expression genes which can adversely affect the downstream analysis results. For the downstream analysis, the PPLR method for differential expression detection is computationally expensive and the PUMA-CLUST method for expression clustering does not consider the variance across the replicated technical and biological measurements. For all these reasons, we present here a new version of the <italic>puma</italic> package which incorporates a suite of improved probe-level analysis methods for gene and transcript expression summarisation and uncertainty propagation methods for the downstream analysis. The new version of the package covers the wide range of quantitative expression analysis of microarray at both gene and isoform level with the great benefit from propagating uncertainty associated with expression estimates into various advanced downstream analyses.</p>
    <p>Affymetrix microarrays use 25-base long probes to measure transcript abundance. Traditional 3’ GeneChips use two types of probes, perfect match (PM) and mismatch (MM) probes. A PM probe matches the target sequence exactly, whereas the corresponding MM probe differs from the PM probe in the middle base which is changed to the complementary one. MM probes are introduced to act as a control for cross hybridisation and other types of background signal. The GeneChip Exon arrays use only PM probes to obtain higher density of coverage and make exon, isoform and gene level profiling possible. Many probe-level analysis methods for 3’ arrays such as PLIER [<xref ref-type="bibr" rid="B7">7</xref>] and RMA [<xref ref-type="bibr" rid="B8">8</xref>] which do not use MM probe intensities, can be applied to exon arrays directly for exon or gene level expression calculation by using probe-to-exon or probe-to-gene mappings, respectively. With the estimated exon and gene expression, it is possible to perform alternative splicing detection by measuring exon-gene expression ratios [<xref ref-type="bibr" rid="B9">9</xref>-<xref ref-type="bibr" rid="B11">11</xref>]. In addition to calculating exon and gene expression ratios, isoform expression levels can also be quantified for a more refined downstream analysis.</p>
    <p>The expression calculation at isoform level is non-trivial since one probe can be mapped to multiple transcripts or gene loci [<xref ref-type="bibr" rid="B12">12</xref>]. Also, an important characteristic of Affymetrix microarray probes is that they have different sensitivity to transcript abundance according to their sequence content. Many probe-level analysis approaches for 3’ arrays account for these probe-specific effects and have obtained improved results [<xref ref-type="bibr" rid="B3">3</xref>,<xref ref-type="bibr" rid="B13">13</xref>]. Moreover, a level of uncertainty associated with estimated isoform expression would help downstream analyses to obtain more biologically relevant results. With available multi-mappings between probes and Ensembl transcripts, some methods have recently been proposed to address the expression calculation for known isoforms, such as MMBGX [<xref ref-type="bibr" rid="B14">14</xref>] and MEAP [<xref ref-type="bibr" rid="B15">15</xref>]. MMBGX uses a hierarchical Bayesian model to calculates the expression level of target transcripts and results in a posterior distribution of each isoform expression. MMBGX is solved by MCMC method and is therefore computationally intensive. After background removal, MEAP adopts a non-negative matrix factorisation approach to summarise isoform expression as a point estimate and does not provide a level of uncertainty associated with this estimate. MMBGX and MEAP perform cross-hybridisation correction according to different GC content for probes, removing probe-specific effects to a certain extent. However, it has been shown that specific hybridisation also presents probe-specific variations [<xref ref-type="bibr" rid="B8">8</xref>,<xref ref-type="bibr" rid="B16">16</xref>]. We developed a new gamma model for exon array data (GME), which accounts for probe-effects in specific hybridisation and multi-mappings between probes, transcripts and genes. The GME model parameters are estimated by Maximum a Posteriori (MAP) optimisation to give isoform and gene level expression measurements with a level of uncertainty of these estimates, provided by a MAP-Laplace approximation [<xref ref-type="bibr" rid="B17">17</xref>]. The new method has been implemented as an R function in the new version of the <italic>puma</italic> package.</p>
    <p>For traditional 3’ GeneChips, PM probes are thought to mainly measure specific hybridisation and MM probes measure non-specific hybridisation and other background. However, probes for low expression genes often obtain higher background than true signal. When combining PM and the corresponding MM probe intensities to calculate gene expression, the resulting gene expression measurements can be unstable for low expression genes, especially on a log scale. For this reason, most popular methods provide an option of using PM probes only in order to obtain more stable expression values on the log scale, such as PLIER [<xref ref-type="bibr" rid="B7">7</xref>], dCHIP [<xref ref-type="bibr" rid="B16">16</xref>] and RMA [<xref ref-type="bibr" rid="B8">8</xref>]. The previous method for 3’ GeneChips in <italic>puma</italic>, multi-mgMOS [<xref ref-type="bibr" rid="B3">3</xref>], combines both PM and MM probe intensities to calculate gene expression values and provide a level of uncertainty associated with the measurements. For low expression genes the estimated logarithmic expression values are usually negative and the associated variance is typically large. These expression measurements with large error can further affect downstream analyses and may lead to incorrect biological conclusions. This is especially the case when the mean expression estimates are processed by methods outside of the <italic>puma</italic> package which do not account for measurement uncertainty. To alleviate this problem, we propose PM-only multi-mgMOS for 3’ arrays, which uses only PM probe intensities and obtains more stable gene expression estimates for low expression genes.</p>
    <p>For the downstream analyses of gene expression, the new version of <italic>puma</italic> includes two newly improved approaches for finding differentially expressed (DE) genes and gene expression clustering. The previous method PPLR for finding DE genes considers the probe-level measurement error, which can improve results when there are few replicates available [<xref ref-type="bibr" rid="B5">5</xref>,<xref ref-type="bibr" rid="B18">18</xref>]. PPLR uses an importance sampling procedure in the variational EM solver which leads to computational inefficiency since the number of samples needs to be increased to gain better accuracy. By adding a layer of hidden variables to the hierarchical Bayesian model, inference in the PPLR model is faster due to the elimination of this inefficient importance sampling step [<xref ref-type="bibr" rid="B19">19</xref>]. The PUMA-CLUST method provided by the previous version of <italic>puma</italic> propagates probe-level uncertainty to improve results of standard Gaussian mixture clustering of gene expression [<xref ref-type="bibr" rid="B6">6</xref>]. The recently proposed PUMA-CLUSTII [<xref ref-type="bibr" rid="B20">20</xref>] approach improves PUMA-CLUST in several aspects. First, variance across the replicated technical and biological measurements for the same experimental condition is considered. Second, a Student’s <italic>t</italic>-distribution is adopted as the clustering components to improve the robustness of the method. Finally, the optimal number of components can be automatically found, and this is especially important for the clustering when the ground truth in the data is unknown.</p>
  </sec>
  <sec>
    <title>Implementation</title>
    <sec>
      <title>Extended and improved function components in puma</title>
      <p><italic>puma</italic> includes two levels of analyses for expression data, expression summarisation and downstream analyses. At the summarisation level of analysis, the previous version of <italic>puma</italic> as described in [<xref ref-type="bibr" rid="B2">2</xref>] can only processe 3’ GeneChip data using mainly multi-mgMOS. With the obtained gene expression measurements and the associated measurement uncertainty from microarrays or other platforms, <italic>puma</italic> propagates uncertainty into the downstream analyses, including PPLR for finding DE genes, PUMA-CLUST for gene expression clustering and NPPCA [<xref ref-type="bibr" rid="B4">4</xref>] for principal component analysis of gene expression. The diagram of function components for the previous <italic>puma</italic> is shown in the upper part of Figure <xref ref-type="fig" rid="F1">1</xref>. After the extension and improvement in this paper, the functions of the new version of <italic>puma</italic> are illustrated in the lower part of Figure <xref ref-type="fig" rid="F1">1</xref>. The new version provides the following contributions: </p>
      <p>•GME - In addition to traditional 3’ GeneChip data, the new version is capable of processing Exon array data using a new model GME at the summarisation level of analysis. From the Exon array data analysis, both gene and isoform expression can be computed.</p>
      <fig id="F1" position="float">
        <label>Figure 1</label>
        <caption>
          <p><bold>Function components of the previous and new version of puma.</bold> The upper part of the figure shows the function components of the previous version of <italic>puma</italic> package and the lower part shows the new version. After the extension and improvement, the new version covers expression analysis for 3’ GeneChip and Exon array data at both gene and isoform level.</p>
        </caption>
        <graphic xlink:href="1471-2105-14-39-1"/>
      </fig>
      <p>•PM-only multi-mgMOS - PM-only multi-mgMOS is included to improve the stability of multi-mgMOS for gene expression estimation.</p>
      <p>•IPPLR - At the downstream analyses, the new version of the package contains IPPLR as an improvement to speed up PPLR for detecting differential expression.</p>
      <p>•PUMA-CLUSTII - For expression clustering, PUMA-CLUSTII is introduced to consider the technical and biological variance across experimental replicates. The new clustering method increases the robustness of clustering and automatically selects the optimal number of clusters by model selection.</p>
      <p>With these contributions, methods in <italic>puma</italic> can process both gene and isoform expression, making <italic>puma</italic> useful in the analysis of alternative splicing. See Methods for more details on these algorithms.</p>
    </sec>
    <sec>
      <title>Multi-mappings between probes and isoforms</title>
      <p>The increasing availability of mappings of microarray probes to isoforms in the Ensembl database can be used to perform isoform expression estimation. In particular, multi-mappings between probes and isoforms are helpful in separating the intensity contributions from probes shared by multiple isoforms. Transcript expression estimation may benefit from this intensity separation. The database GATExplorer [<xref ref-type="bibr" rid="B12">12</xref>] integrates information from multiple biological sources (including Ensembl database and probe sequences of Affymetrix microarrays) to provide the mappings between microarray probes and the functional transcriptional entities, i.e. gene loci, transcripts, exons and ncRNAs. We include the multi-mappings between Exon array probes, isoforms and genes obtained from GATExplorer into the separate Bioconductor data package <italic>pumadata</italic> which contains example and annotation data used by <italic>puma</italic>. Mappings for human, mouse and rat exon arrays are included and this makes <italic>puma</italic> applicable to all types of Affymetrix Exon arrays.</p>
    </sec>
    <sec>
      <title>Using the extended functions in puma</title>
      <p>The new version of <italic>puma</italic> and the related <italic>pumadata</italic> package can be found at <ext-link ext-link-type="uri" xlink:href="http://www.bioconductor.org">http://www.bioconductor.org</ext-link>. The GEM model is implemented in the function <monospace>gmoExon</monospace> to calculate gene and isoform level expression for Exon arrays. The PM-only multi-mgMOS method is implemented in the function <monospace>PMmmgmos</monospace> to estimate stable gene expression for Affymetrix GeneChips. The improved PPLR for detecting DE genes is implemented in the function <monospace>pumaCombImproved</monospace>. The PUMA-CLUSTII is implemented in the function <monospace>pumaclustii</monospace> for robust expression clustering. To use these functions, type <monospace>library(puma)</monospace> and <monospace>library(pumadata)</monospace> at R prompt to load <italic>puma</italic> package and the data package. A quick start of each of these functions is described below. For detailed use of these functions, please refer to the user manual of the <italic>puma</italic> package.</p>
      <sec>
        <title>Gamma model for Exon arrays</title>
        <p>The expression summarisation method for Exon arrays is GME. The method makes use of multi-mappings between probes, isoforms and genes obtained from GATExplorer to aid the calculation of gene and isoform expression. The mappings are included in the individual package <italic>pumadata</italic>. The following code shows a quick start of this method.</p>
        <sec>
          <title/>
          <p>The above code loads exon array data (CEL files) in the working directory as an <monospace>AffyBatch</monospace> object and processes it using GME method. Among the parameters, <monospace>exontype</monospace> can be one of “Human”, “Mouse” and “Rat”, indicating the exon chip type. <monospace>GT</monospace> can be one of “gene” and “transcript”, specifying the expression estimated at gene and isoform level, respectively. <monospace>gsnorm</monospace> specifies the algorithm used by the global scaling normalisation and can be one of “mean”, “median”, “meanlog” and “none”. “mean” and “meanlog” are mean-centered normalisation on raw and the log scale, respectively, “median” is median-centered normalisation and “none” means no global scaling normalisation. The value of <monospace>gmoExon</monospace> is an object of class <monospace>exprReslt</monospace> which stores the estimated expression and a level of uncertainty associated with this measurement.</p>
        </sec>
      </sec>
      <sec>
        <title>PM-only multi-mgMOS for Affymetrix GeneChips</title>
        <p>PM-only multi-mgMOS increases the stability of the original multi-mgMOS method, especially for weakly expressed genes. We use an example dataset included in the <italic>pumadata</italic> package to demonstrate the use of this method.</p>
        <sec>
          <title/>
          <p>The first parameter of the function <monospace>PMmmgmos</monospace> is an <monospace>AffyBatch</monospace> object containing the raw probe intensities. The parameter <monospace>gsnorm</monospace> has the same meaning as that in the function <monospace>gmoExon</monospace>. The value of <monospace>PMmmgmos</monospace> is an object of class <monospace>exprReslt</monospace> which contains the estimated gene expression and the corresponding estimation uncertainty.</p>
        </sec>
      </sec>
      <sec>
        <title>Improved PPLR for finding DE genes</title>
        <p>IPPLR is designed to improve the computational efficiency of the original PPLR for finding differential expression. Similar to PPLR, it includes two steps to detect DE genes. At the first step, the function <monospace>pumaCombImproved</monospace> is used to combine expression from replicates to give a single measurement for the related condition. At the second step, the existing function <monospace>pumaDE</monospace> is used to calculate the PPLR (probability of positive log-ratio) values to identify DE genes. We use an example dataset in the <italic>puma</italic> package to demonstrate the use of this method as below.</p>
        <sec>
          <title/>
          <p>The parameter of <monospace>pumaCombImproved</monospace> is an object of class <monospace>ExpressionSet</monospace> and can also be the outputs from GME, PM-only multi-mgMOS or multi-mgMOS. The function <monospace>pumaDE</monospace> generates lists of genes ranked by the PPLR values which indicate the significance of differential expression.</p>
        </sec>
      </sec>
      <sec>
        <title>PUMA-CLUSTII for robust clustering</title>
        <p>The existing clustering method PUMA-CLUST in <italic>puma</italic> considers uncertainty of gene expression but does not take into account the technical and biological variance when replicates are available. PUMA-CLUSTII is proposed to address this problem. It also adopts more robust components by using a Student’s <italic>t</italic> distribution instead of the Gaussian components used by PUMA-CLUST. We use an example dataset in the <italic>puma</italic> package to show the use of this method.</p>
        <sec>
          <title/>
          <p>The first two parameters of <monospace>pumaClustii</monospace> are data frames containing the expression measurements and the associated uncertainty respectively. The minimum and maximum numbers of clusters are specified by the parameters <monospace>mincls</monospace> and <monospace>maxcls</monospace>, respectively. The parameter <monospace>conds</monospace> indicates the number of conditions involved in the data and <monospace>reps</monospace> is a vector specifying which condition each column of the input data frame belongs to. The result is a list containing the center of clustering components, the membership of components for each data point, the optional number of clusters and other auxiliary information.</p>
        </sec>
      </sec>
    </sec>
  </sec>
  <sec>
    <title>Results and discussion</title>
    <sec>
      <title>Datasets</title>
      <sec>
        <title>MAQC dataset</title>
        <p>We use the well studied Microarray Quality Control (MAQC) dataset [<xref ref-type="bibr" rid="B21">21</xref>] to evaluate most of the extensions of the new version of <italic>puma</italic> at gene expression level. MAQC project measured gene expression levels from high-quality RNA samples to assess the comparability across multiple platforms. We select two RNA samples, the universal human reference RNA (UHRR) and the human brain reference RNA (HBRR), from Affymetrix Exon array and Affymetrix U133 GeneChip platforms. Each sample type has five replicates for both platforms. Experiments of Exon arrays were carried out in two independent labs: McGill University (MU) and Virginia Tech (VT). We randomly selected data from MU for the evaluation of GME. For U133 GeneChips, we use data AFX_1_[A-B][1-5] from GSE5350. Apart from microarray experiments, MAQC project also conducted qRT-PCR experiments for around one thousand genes which can be served as a gold-standard to benchmark gene expression values estimated from other platforms [<xref ref-type="bibr" rid="B22">22</xref>,<xref ref-type="bibr" rid="B23">23</xref>].</p>
        <p>Among the qRT-PCR data, we use the method similar to [<xref ref-type="bibr" rid="B23">23</xref>] to filter out DE and non-DE genes with high certainty. Firstly, we select genes which were found to be “present” for at least three qRT-PCR replicate assays. Secondly, average gene expression over replicates is calculated for each sample. Genes with absolute log-ratio between the UHRR and HBRR samples less than 0.2 are taken as “non-DE” genes. Those with log-ratio greater than 2.0 are “DE+” genes which are up-regulated in UHRR sample and those with log-ratio less than -2.0 are “DE-” genes being down-regulated in UHRR sample. Finally, we map these non-DE and DE genes to Exon array and U133 GeneChip platforms and obtain the corresponding mapped genes and probe-sets for each platform as shown in Table <xref ref-type="table" rid="T1">1</xref>. Using these qRT-PCR validated data, we produce receiver operator characteristic (ROC) curves for various combinations of gene expression estimation methods and DE gene detection methods with the consideration of the direction sign of regulation.</p>
        <table-wrap position="float" id="T1">
          <label>Table 1</label>
          <caption>
            <p>Number of qRT-PCR validated non-DE and DE genes and probe-sets for Exon arrays and H133 GeneChips</p>
          </caption>
          <table frame="hsides" rules="groups" border="1">
            <colgroup>
              <col align="center"/>
              <col align="center"/>
              <col align="center"/>
              <col align="center"/>
            </colgroup>
            <thead valign="top">
              <tr>
                <th align="center" valign="bottom"> <hr/></th>
                <th align="center" valign="bottom">
                  <bold>non-DE</bold>
                  <hr/>
                </th>
                <th colspan="2" align="center" valign="bottom">
                  <bold>DE</bold>
                  <hr/>
                </th>
              </tr>
              <tr>
                <th align="center"> </th>
                <th align="center"> </th>
                <th align="center">
                  <bold>DE+</bold>
                </th>
                <th align="center">
                  <bold>DE-</bold>
                </th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="center" valign="bottom">Exon arrays<hr/></td>
                <td align="center" valign="bottom">87<hr/></td>
                <td align="center" valign="bottom">116<hr/></td>
                <td align="center" valign="bottom">102<hr/></td>
              </tr>
              <tr>
                <td align="center">U133 GeneChips</td>
                <td align="center">204</td>
                <td align="center">185</td>
                <td align="center">267</td>
              </tr>
            </tbody>
          </table>
          <table-wrap-foot>
            <p>Non-DE and DE genes obtained from qRT-PCR data with high certainty are mapped to Exon arrays and Affymetrix U133 GeneChips. Exon arrays obtain 305 corresponding genes and U133 GeneChips contain 656 related probe-sets. The symbols “+” and “-” stand for up- and down-regulation in UHRR, respectively.</p>
          </table-wrap-foot>
        </table-wrap>
      </sec>
      <sec>
        <title>HNSCC dataset</title>
        <p>The qRT-PCR validated head and neck squamous cell carcinoma (HNSCC) dataset [<xref ref-type="bibr" rid="B15">15</xref>] is used to verify the isoform expression calculated by GME. In HNSCC dataset, 15 cell lines from tongue and larynx were cultured and samples were assayed using Affymetrix Human Exon 1.0 ST microarrays. Amplification of the chromosome region 11q13 is a common genomic alteration in HNSCC. The 15 cell lines are divided into two sample groups, with 11q13 amplification (11q13+) and without 11q13 amplification (11q13-). 11q13+ group contains seven cell lines and 11q13- group contains eight. qRT-PCR experiments were performed for four alternatively spliced variants of two genes (ORAOV1 and NEO1) located in the 11q13 amplified region and associated with HNSCC. We use GME to calculate the expression levels for the four isoforms in all 15 cell lines and then apply PPLR to identify the differential expressed transcripts (DETs). The detected DETs are compared with qRT-PCR findings to verify the performance of GME.</p>
      </sec>
    </sec>
    <sec>
      <title>Accuracy of gene expression estimation for Exon array data</title>
      <p>To evaluate the accuracy of GME for gene expression estimation from exon array data, we compare GME with the other two traditional methods RMA and PLIER. The functions implemented in Bioconductor package <italic>affy</italic> for RMA and PLIER methods are used to produce gene expression. We combine the different expression estimation methods with three DE detection methods, <italic>t</italic>-test, PPLR and IPPLR, to find DE genes on the MAQC dataset. <italic>t</italic>-test is applied to point estimates of gene expression from the three expression estimation methods. PPLR and IPPLR require a level of uncertainty associated with expression estimates, and they are therefore applied to GME and RMA which are able to provide expression measurement error. In addition to process all five replicates for each sample, we also randomly select two replicates to show the performance of each method with fewer number of replicates available. we repeat five runs for the processing of the 2-replicate case. Figure <xref ref-type="fig" rid="F2">2</xref> shows the average ROC curves of the comparison for 2-replicate case and Figure <xref ref-type="fig" rid="F3">3</xref> shows the results for 5-replicate case. GME combined with PPLR obtains lower true positive rate (TPR) at the top of ranking list of DE genes. However, by increasing the number of sample in the importance sampling of PPLR, TPR gets obviously improved. The area under ROC curve (AUC) for the different expression estimation methods combined with various DE detection methods are shown in Table <xref ref-type="table" rid="T2">2</xref>. We can see from Table <xref ref-type="table" rid="T2">2</xref> that GME outperforms the other alternatives at most cases, especially when combined with <italic>t</italic>-test and IPPLR. The comparison results show that GME is a competitive approach in gene expression calculation from Exon array data.</p>
      <fig id="F2" position="float">
        <label>Figure 2</label>
        <caption>
          <p><bold>ROC curves from different methods for 2-replicate Exon array data.</bold> The ROC curves are obtained from the average over the 5 runs each of which randomly selects two replicates. Gene expression estimation methods RMA, PLIER and GMA, are combined with different finding-DE-gene methods, <italic>t</italic>-test, PPLR and IPPLR. PLIER provides only a point estimate for gene expression and therefore is not applicable to PPLR and IPPLR. The number after PPLR indicates the sample number used in the importance sampling of the algorithm.</p>
        </caption>
        <graphic xlink:href="1471-2105-14-39-2"/>
      </fig>
      <fig id="F3" position="float">
        <label>Figure 3</label>
        <caption>
          <p><bold>ROC curves from different methods for 5-replicate Exon array data.</bold> Gene expression estimation methods are combined with different finding-DE-gene methods. PLIER provides only a point estimate for gene expression and therefore is not applicable to PPLR and IPPLR. The number after PPLR indicates the sample number used in the importance sampling of the algorithm.</p>
        </caption>
        <graphic xlink:href="1471-2105-14-39-3"/>
      </fig>
      <table-wrap position="float" id="T2">
        <label>Table 2</label>
        <caption>
          <p>Area under ROC curves from different methods for Exon array data</p>
        </caption>
        <table frame="hsides" rules="groups" border="1">
          <colgroup>
            <col align="left"/>
            <col align="center"/>
            <col align="center"/>
            <col align="center"/>
            <col align="center"/>
            <col align="center"/>
            <col align="center"/>
            <col align="center"/>
            <col align="center"/>
          </colgroup>
          <thead valign="top">
            <tr>
              <th colspan="2" align="center" valign="bottom">
                <bold>Methods</bold>
                <hr/>
              </th>
              <th colspan="4" align="left" valign="bottom">
                <bold>2 replicates</bold>
                <hr/>
              </th>
              <td> </td>
              <td> </td>
              <th align="left" valign="bottom">
                <bold>5 replicates</bold>
                <hr/>
              </th>
            </tr>
            <tr>
              <th align="left"> </th>
              <th align="left"> </th>
              <th align="left">
                <bold>1</bold>
              </th>
              <th align="left">
                <bold>2</bold>
              </th>
              <th align="left">
                <bold>3</bold>
              </th>
              <th align="left">
                <bold>4</bold>
              </th>
              <th align="left">
                <bold>5</bold>
              </th>
              <th align="left">
                <bold>Average</bold>
              </th>
              <th align="left"> </th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="center" valign="bottom"><italic>t</italic>-test<hr/></td>
              <td align="center" valign="bottom">RMA<hr/></td>
              <td align="center" valign="bottom">0.8945<hr/></td>
              <td align="center" valign="bottom">0.8909<hr/></td>
              <td align="center" valign="bottom">0.9107<hr/></td>
              <td align="center" valign="bottom">0.9346<hr/></td>
              <td align="center" valign="bottom">0.9316<hr/></td>
              <td align="center" valign="bottom">0.9118<hr/></td>
              <td align="center" valign="bottom">0.9475<hr/></td>
            </tr>
            <tr>
              <td align="center" valign="bottom"> <hr/></td>
              <td align="center" valign="bottom">PLIER<hr/></td>
              <td align="center" valign="bottom">0.8806<hr/></td>
              <td align="center" valign="bottom">0.8852<hr/></td>
              <td align="center" valign="bottom">0.9004<hr/></td>
              <td align="center" valign="bottom">0.9084<hr/></td>
              <td align="center" valign="bottom">0.9083<hr/></td>
              <td align="center" valign="bottom">0.8937<hr/></td>
              <td align="center" valign="bottom">0.9291<hr/></td>
            </tr>
            <tr>
              <td align="center" valign="bottom"> <hr/></td>
              <td align="center" valign="bottom">GME<hr/></td>
              <td align="center" valign="bottom">0.9082<hr/></td>
              <td align="center" valign="bottom">0.9044<hr/></td>
              <td align="center" valign="bottom">0.9415<hr/></td>
              <td align="center" valign="bottom">0.9544<hr/></td>
              <td align="center" valign="bottom">0.9427<hr/></td>
              <td align="center" valign="bottom">0.9287<hr/></td>
              <td align="center" valign="bottom">0.9580<hr/></td>
            </tr>
            <tr>
              <td align="center" valign="bottom">PPLR_1000<hr/></td>
              <td align="center" valign="bottom">RMA<hr/></td>
              <td align="center" valign="bottom">0.9243<hr/></td>
              <td align="center" valign="bottom">0.9234<hr/></td>
              <td align="center" valign="bottom">0.9385<hr/></td>
              <td align="center" valign="bottom">0.9417<hr/></td>
              <td align="center" valign="bottom">0.9387<hr/></td>
              <td align="center" valign="bottom">0.9323<hr/></td>
              <td align="center" valign="bottom">0.9489<hr/></td>
            </tr>
            <tr>
              <td align="center" valign="bottom"> <hr/></td>
              <td align="center" valign="bottom">GME<hr/></td>
              <td align="center" valign="bottom">0.9208<hr/></td>
              <td align="center" valign="bottom">0.9093<hr/></td>
              <td align="center" valign="bottom">0.9365<hr/></td>
              <td align="center" valign="bottom">0.9297<hr/></td>
              <td align="center" valign="bottom">0.8969<hr/></td>
              <td align="center" valign="bottom">0.9188<hr/></td>
              <td align="center" valign="bottom">0.9447<hr/></td>
            </tr>
            <tr>
              <td align="center" valign="bottom">*PPLR_10000<hr/></td>
              <td align="center" valign="bottom">RMA<hr/></td>
              <td align="center" valign="bottom">0.9227<hr/></td>
              <td align="center" valign="bottom">0.9226<hr/></td>
              <td align="center" valign="bottom">0.9419<hr/></td>
              <td align="center" valign="bottom">0.9453<hr/></td>
              <td align="center" valign="bottom">0.9432<hr/></td>
              <td align="center" valign="bottom">0.9348<hr/></td>
              <td align="center" valign="bottom">0.9492<hr/></td>
            </tr>
            <tr>
              <td align="center" valign="bottom"> <hr/></td>
              <td align="center" valign="bottom">GME<hr/></td>
              <td align="center" valign="bottom">0.9353<hr/></td>
              <td align="center" valign="bottom">0.9317<hr/></td>
              <td align="center" valign="bottom">
                <bold>0.9474</bold>
                <hr/>
              </td>
              <td align="center" valign="bottom">0.9374<hr/></td>
              <td align="center" valign="bottom">0.9324<hr/></td>
              <td align="center" valign="bottom">0.9274<hr/></td>
              <td align="center" valign="bottom">0.9503<hr/></td>
            </tr>
            <tr>
              <td align="center" valign="bottom">IPPLR<hr/></td>
              <td align="center" valign="bottom">RMA<hr/></td>
              <td align="center" valign="bottom">0.9246<hr/></td>
              <td align="center" valign="bottom">0.9301<hr/></td>
              <td align="center" valign="bottom">0.9464<hr/></td>
              <td align="center" valign="bottom">0.9468<hr/></td>
              <td align="center" valign="bottom">0.9463<hr/></td>
              <td align="center" valign="bottom">0.9382<hr/></td>
              <td align="center" valign="bottom">0.9493<hr/></td>
            </tr>
            <tr>
              <td align="center"> </td>
              <td align="center">GME</td>
              <td align="center">
                <bold>0.9379</bold>
              </td>
              <td align="center">
                <bold>0.9391</bold>
              </td>
              <td align="center">0.9457</td>
              <td align="center">
                <bold>0.9597</bold>
              </td>
              <td align="center">
                <bold>0.9549</bold>
              </td>
              <td align="center">
                <bold>0.9475</bold>
              </td>
              <td align="center">
                <bold>0.9589</bold>
              </td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <p>Gene expression estimation methods are combined with different finding-DE-gene methods. PPLR and IPPLR require a level of uncertainty associated with expression estimation, and they are therefore combined with GME and RMA since these two methods can provide variance of gene expression measurements. For <italic>t</italic>-test we use only the point estimates of gene expression. PLIER provides only a point estimate for gene expression and we only evaluate it combining with <italic>t</italic>-test. The number after PPLR indicates the sample number used in the importance sampling of the algorithm. The best result for each comparison is highlighted in bold.</p>
        </table-wrap-foot>
      </table-wrap>
    </sec>
    <sec>
      <title>Validation of isoform expression estimation</title>
      <p>We use the qRT-PCR validated HNSCC data set to verify the isoform expression calculated by GME. In HNSCC dataset, two ORAOV1 alternative splice variants (ORAOV1-201 and ORAOV1-202) and two NEO1 alternative splice variants (NEO1-201 and NEO1-202) are validated by qRT-PCR experiments. We apply GME to this dataset and obtain the expression levels for the four transcripts. For each transcript in every one of the 15 cell lines, GME produces the expression estimate and a level of uncertainty associated with this estimate. Figures <xref ref-type="fig" rid="F4">4</xref> and <xref ref-type="fig" rid="F5">5</xref> show the distributions of isoform expression in each cell line of ORAOV1 and NEO1, respectively. The blue lines are for 11q13+ samples and the red lines for 11q13- samples. We can see from the figures that there is considerable variability in the transcript expression for the cell lines from each sample group. High expression is generally associated with low variance while low expression with large variance. For the expression distribution of NEO1-201 as shown in the upper plot of Figure <xref ref-type="fig" rid="F5">5</xref>, there is extreme low expression for one cell line from each of the two sample groups. We then apply PPLR to the distributions of isoform expression to obtain the distributions of mean expression for each sample group, which are represented by the bold lines as shown in the figures. Note that the effects of low expression outliers are reduced by applying PPLR which accounts for technical and biological components of variance.</p>
      <fig id="F4" position="float">
        <label>Figure 4</label>
        <caption>
          <p><bold>Distribution of isoform expression for gene ORAOV1.</bold> The distributions of the estimated isoform expression for the two alternatively spliced transcripts of gene ORAOV1 in the 15 cell lines are calculated from GME. The blue lines are for 11q13+ group and red lines for 11q13- group. The bold lines are the distributions of the mean expression for each group, obtained from PPLR. Expression is on the log scale.</p>
        </caption>
        <graphic xlink:href="1471-2105-14-39-4"/>
      </fig>
      <fig id="F5" position="float">
        <label>Figure 5</label>
        <caption>
          <p><bold>Distribution of isoform expression for gene NEO1.</bold> The distributions of the estimated isoform expression for the two alternatively spliced transcripts of gene NEO1 in the 15 cell lines are calculated from GME. The blue lines are for 11q13+ group and red lines for 11q13- group. The bold lines are the distributions of the mean expression for each group, obtained from PPLR. Expression is on the log scale.</p>
        </caption>
        <graphic xlink:href="1471-2105-14-39-5"/>
      </fig>
      <p>According to the qRT-PCR results, the four transcripts are overexpressed in 11q13+ sample with less significant change for ORAOV1-202 (<italic>p</italic>&lt;0.0837). ORAOV1-201 presents higher expression levels than ORAOV1-202 in both 11q13+ and 11q13- samples, while NEO1-202 is expressed at higher levels than NEO1-201 in the two samples. Table <xref ref-type="table" rid="T3">3</xref> shows the directions of the relative expression change found by qRT-PCR and GME. The results “+” and “-” stand for up- and down-regulation in the first comparison component, respectively. For GME, the result of “+” indicates <italic>P</italic><italic>P</italic><italic>L</italic><italic>R</italic>&gt;0.5 and the result of “-” indicates <italic>P</italic><italic>P</italic><italic>L</italic><italic>R</italic>&lt;0.5. We also show the probability of differential expression as calculated by <italic>m</italic><italic>a</italic><italic>x</italic>(<italic>P</italic><italic>P</italic><italic>L</italic><italic>R</italic>,1−<italic>P</italic><italic>P</italic><italic>L</italic><italic>R</italic>), with numbers close to 1.0 indicating strong support. It can been seen from Table <xref ref-type="table" rid="T3">3</xref> that the relative expression changes found by GME combined with PPLR are consistent with qRT-PCR results for all comparisons. The results show that GME produces reliable isoform expression estimations for this specific dataset.</p>
      <table-wrap position="float" id="T3">
        <label>Table 3</label>
        <caption>
          <p>GME results for the qRT-PCR validated transcripts</p>
        </caption>
        <table frame="hsides" rules="groups" border="1">
          <colgroup>
            <col align="left"/>
            <col align="center"/>
            <col align="center"/>
            <col align="center"/>
            <col align="center"/>
            <col align="center"/>
          </colgroup>
          <thead valign="top">
            <tr>
              <th align="left"> </th>
              <th align="center">Comparisons</th>
              <th align="center">
                <bold>qRT-PCR</bold>
              </th>
              <th align="center">
                <bold>GME</bold>
              </th>
              <th align="center">
                <bold>
                  <italic>m </italic>
                </bold>
                <bold>
                  <italic>a </italic>
                </bold>
                <bold>
                  <italic>x </italic>
                </bold>
                <bold>( </bold>
                <bold>
                  <italic>P </italic>
                </bold>
                <bold>
                  <italic>P </italic>
                </bold>
                <bold>
                  <italic>L </italic>
                </bold>
                <bold>
                  <italic>R </italic>
                </bold>
                <bold>,1− </bold>
                <bold>
                  <italic>P </italic>
                </bold>
                <bold>
                  <italic>P </italic>
                </bold>
                <bold>
                  <italic>L </italic>
                </bold>
                <bold>
                  <italic>R </italic>
                </bold>
                <bold>)</bold>
              </th>
              <th align="center">
                <bold>Consistency</bold>
              </th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="center" valign="bottom">11q13+ vs. 11q13-<hr/></td>
              <td align="center" valign="bottom">ORAOV1-201<hr/></td>
              <td align="center" valign="bottom">+<hr/></td>
              <td align="center" valign="bottom">+<hr/></td>
              <td align="center" valign="bottom">1.0000<hr/></td>
              <td align="center" valign="bottom">Y<hr/></td>
            </tr>
            <tr>
              <td align="center" valign="bottom"> <hr/></td>
              <td align="center" valign="bottom">ORAOV1-202<hr/></td>
              <td align="center" valign="bottom">+<hr/></td>
              <td align="center" valign="bottom">+<hr/></td>
              <td align="center" valign="bottom">0.9968<hr/></td>
              <td align="center" valign="bottom">Y<hr/></td>
            </tr>
            <tr>
              <td align="center" valign="bottom"> <hr/></td>
              <td align="center" valign="bottom">NEO1-201<hr/></td>
              <td align="center" valign="bottom">+<hr/></td>
              <td align="center" valign="bottom">+<hr/></td>
              <td align="center" valign="bottom">0.8961<hr/></td>
              <td align="center" valign="bottom">Y<hr/></td>
            </tr>
            <tr>
              <td align="center" valign="bottom"> <hr/></td>
              <td align="center" valign="bottom">NEO1-202<hr/></td>
              <td align="center" valign="bottom">+<hr/></td>
              <td align="center" valign="bottom">+<hr/></td>
              <td align="center" valign="bottom">0.9719<hr/></td>
              <td align="center" valign="bottom">Y<hr/></td>
            </tr>
            <tr>
              <td align="center" valign="bottom">ORAOV1-201 vs. 202<hr/></td>
              <td align="center" valign="bottom">11q13+<hr/></td>
              <td align="center" valign="bottom">+<hr/></td>
              <td align="center" valign="bottom">+<hr/></td>
              <td align="center" valign="bottom">0.9154<hr/></td>
              <td align="center" valign="bottom">Y<hr/></td>
            </tr>
            <tr>
              <td align="center" valign="bottom"> <hr/></td>
              <td align="center" valign="bottom">11q13-<hr/></td>
              <td align="center" valign="bottom">+<hr/></td>
              <td align="center" valign="bottom">+<hr/></td>
              <td align="center" valign="bottom">0.5782<hr/></td>
              <td align="center" valign="bottom">Y<hr/></td>
            </tr>
            <tr>
              <td align="center" valign="bottom">NEO1-201 vs. 202<hr/></td>
              <td align="center" valign="bottom">11q13+<hr/></td>
              <td align="center" valign="bottom">-<hr/></td>
              <td align="center" valign="bottom">-<hr/></td>
              <td align="center" valign="bottom">0.9999<hr/></td>
              <td align="center" valign="bottom">Y<hr/></td>
            </tr>
            <tr>
              <td align="center"> </td>
              <td align="center">11q13-</td>
              <td align="center">-</td>
              <td align="center">-</td>
              <td align="center">1.0000</td>
              <td align="center">Y</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <p>The expression changes between groups 11q13+ and 11q13- for each transcript, and between two transcripts of the same gene for each group, are examined. The results of qRT-PCR and GME are “+” or “-” for up- and down-regulation in the first comparison component, respectively. Column of max(PPLR,1-PPLR) gives the probability of differential expression. The concordances between qRT-PCR validation and GME results are given in the right-most column.</p>
        </table-wrap-foot>
      </table-wrap>
    </sec>
    <sec>
      <title>Improvements for detection of differential expression</title>
      <p>IPPLR accelerates the computation of PPLR by eliminating the importance sampling stage of the algorithm which significantly slows down PPLR computation. Table <xref ref-type="table" rid="T4">4</xref> shows the CPU run time of PPLR and IPPLR on 2-replicate and 5-replicate exon array data. The run time for 2-replicate data is the average processing time over the 5 runs. It can be seen from Table <xref ref-type="table" rid="T4">4</xref> that the computation time of PPLR increases with the number of importance samples and IPPLR is therefore much more computationally efficient. The accuracy of detecting DE genes for different methods is shown in Table <xref ref-type="table" rid="T2">2</xref>. We can see that with the same expression estimation method, IPPLR obtains the best accuracy for most datasets. PPLR and IPPLR outperform <italic>t</italic>-test. PPLR was compared with more sophisticated moderated t-tests in the original publication [<xref ref-type="bibr" rid="B5">5</xref>]. These show the usefulness of measurement error propagated into the downstream analysis. The improvement is especially significant for the 2-replicate case demonstrating that probe-level measurement error helps to alleviate the need for experiment replicates. Note that as the number of importance samples increases the accurate of PPLR also gets improved. When the number of importance samples used is 10,000 then the accuracy of PPLR is close to that of IPPLR.</p>
      <table-wrap position="float" id="T4">
        <label>Table 4</label>
        <caption>
          <p>Run time of PPLR and IPPLR</p>
        </caption>
        <table frame="hsides" rules="groups" border="1">
          <colgroup>
            <col align="center"/>
            <col align="center"/>
            <col align="center"/>
            <col align="center"/>
          </colgroup>
          <thead valign="top">
            <tr>
              <th align="center">
                <bold>Datasets</bold>
              </th>
              <th align="center">
                <bold>PPLR_1000</bold>
              </th>
              <th align="center">
                <bold>PPLR_10000</bold>
              </th>
              <th align="center">
                <bold>IPPLR</bold>
              </th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="center" valign="bottom">2 replicates<hr/></td>
              <td align="center" valign="bottom">73.1<hr/></td>
              <td align="center" valign="bottom">1330.8<hr/></td>
              <td align="center" valign="bottom">27.5<hr/></td>
            </tr>
            <tr>
              <td align="center">5 replicates</td>
              <td align="center">125.4</td>
              <td align="center">3127.4</td>
              <td align="center">15.9</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <p>The run time (CPU seconds) for 2-replicate dataset is the average processing time over the 5 runs. The number after PPLR indicates the sample number used in the importance sampling of the algorithm. The program runs on the machine with Intel Pentium Dual-core 2.6GHz CPU and 8.0G RAM.</p>
        </table-wrap-foot>
      </table-wrap>
    </sec>
    <sec>
      <title>Accuracy of gene expression estimation for 3’ GeneChips</title>
      <p>Our previous study [<xref ref-type="bibr" rid="B3">3</xref>] shows that the original multi-mgMOS presents good sensitivity to the concentration change in samples due to the correction of non-specific hybridisation by MM probe intensities. However, for weakly expressed genes the resulting logarithmic expression estimates are usually associated with large variance and this can cause instability in the downstream analysis. We divide the experimental data of Affymetrix U133 GeneChips into three groups, with “low”, “medium” and “high” expression respectively, to show this effect. Figure <xref ref-type="fig" rid="F6">6</xref> shows the partition of the dataset with gene expression calculated from multi-mgMOS. Genes under line <italic>l</italic><sub>1</sub> belong to “low” expression group. Genes between line <italic>l</italic><sub>1</sub> and <italic>l</italic><sub>2</sub> belong to “median” expression group. Genes above line <italic>l</italic><sub>2</sub> belong to “high” expression group. The group of all genes is denoted as “all”. For each gene group, we plot ROC curves individually with the calculation from different expression methods combined with PPLR, as shown in Figure <xref ref-type="fig" rid="F7">7</xref>. The corresponding AUC values are shown in Table <xref ref-type="table" rid="T5">5</xref>. We compare three expression estimation methods, PM-only multi-mgMOS, multi-mgMOS and the popular RMA approach. We can see that PM-only multi-mgMOS and multi-mgMOS outperform RMA for all gene groups. PM-only multi-mgMOS obtains better results than multi-mgMOS for “medium”, “low” and “all” groups, but fails in “high” group compared with multi-mgMOS. This shows PM-only multi-mgMOS performs better for relatively low expression genes while multi-mgMOS works well for high expression genes.</p>
      <fig id="F6" position="float">
        <label>Figure 6</label>
        <caption>
          <p><bold>The partition of qRT-PCR validated probe-sets in H133 GeneChip dataset.</bold> Gene expression estimates are calculated from multi-mgMOS. The scatter plot is drawn with expression of HBRR sample against UHRR sample. Line <italic>l</italic><sub>1</sub>:<italic>y</italic>=−<italic>x</italic>+8 and line <italic>l</italic><sub>2</sub>:<italic>y</italic>=−<italic>x</italic>+14 partition the 656 qRT-PCR validated probe-sets into 3 groups, labelled as “low”, “median” and “high”.</p>
        </caption>
        <graphic xlink:href="1471-2105-14-39-6"/>
      </fig>
      <fig id="F7" position="float">
        <label>Figure 7</label>
        <caption>
          <p><bold>ROC curves from different methods for U133 GeneChip data.</bold> ROC curves are calculated from different gene expression estimation methods, RMA, multi-mgMOS and PM-only multi-mgMOS, combined with PPLR for “low”, “median”, “high” and “all” groups of U133 GeneChips data.</p>
        </caption>
        <graphic xlink:href="1471-2105-14-39-7"/>
      </fig>
      <table-wrap position="float" id="T5">
        <label>Table 5</label>
        <caption>
          <p>Area under ROC curves from different methods for U133 GeneChip data</p>
        </caption>
        <table frame="hsides" rules="groups" border="1">
          <colgroup>
            <col align="center"/>
            <col align="center"/>
            <col align="center"/>
            <col align="center"/>
            <col align="center"/>
            <col align="center"/>
            <col align="center"/>
          </colgroup>
          <thead valign="top">
            <tr>
              <th align="center" valign="bottom">
                <bold>Groups</bold>
                <hr/>
              </th>
              <th colspan="3" align="center" valign="bottom">
                <bold># of probe-sets</bold>
                <hr/>
              </th>
              <th align="center" valign="bottom">
                <bold>PM-only multi-mgMOS</bold>
                <hr/>
              </th>
              <th align="center" valign="bottom">
                <bold>multi-mgMOS</bold>
                <hr/>
              </th>
              <th align="center" valign="bottom">
                <bold>RMA</bold>
                <hr/>
              </th>
            </tr>
            <tr>
              <th align="center"> </th>
              <th align="center">
                <bold>non-DE</bold>
              </th>
              <th align="center">
                <bold>DE+</bold>
              </th>
              <th align="center">
                <bold>DE-</bold>
              </th>
              <th align="center"> </th>
              <th align="center"> </th>
              <th align="center"> </th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="center" valign="bottom">High<hr/></td>
              <td align="center" valign="bottom">65<hr/></td>
              <td align="center" valign="bottom">21<hr/></td>
              <td align="center" valign="bottom">14<hr/></td>
              <td align="center" valign="bottom">0.9842<hr/></td>
              <td align="center" valign="bottom">
                <bold>0.9952</bold>
                <hr/>
              </td>
              <td align="center" valign="bottom">0.9308<hr/></td>
            </tr>
            <tr>
              <td align="center" valign="bottom">Medium<hr/></td>
              <td align="center" valign="bottom">90<hr/></td>
              <td align="center" valign="bottom">73<hr/></td>
              <td align="center" valign="bottom">82<hr/></td>
              <td align="center" valign="bottom">
                <bold>0.9062</bold>
                <hr/>
              </td>
              <td align="center" valign="bottom">0.8880<hr/></td>
              <td align="center" valign="bottom">0.8827<hr/></td>
            </tr>
            <tr>
              <td align="center" valign="bottom">Low<hr/></td>
              <td align="center" valign="bottom">49<hr/></td>
              <td align="center" valign="bottom">91<hr/></td>
              <td align="center" valign="bottom">171<hr/></td>
              <td align="center" valign="bottom">
                <bold>0.8363</bold>
                <hr/>
              </td>
              <td align="center" valign="bottom">0.8180<hr/></td>
              <td align="center" valign="bottom">0.8147<hr/></td>
            </tr>
            <tr>
              <td align="center">All</td>
              <td align="center">204</td>
              <td align="center">185</td>
              <td align="center">267</td>
              <td align="center">
                <bold>0.8227</bold>
              </td>
              <td align="center">0.8130</td>
              <td align="center">0.7971</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <p>Genes are divided into three groups, labelled as “high”, “medium” and “low”, according to the expression levels. The numbers of “non-DE”, “DE+” and “DE-” probe-sets are shown. AUC is calculated individually for each of the three groups from PM-only multi-mgMOS, multi-mgMOS and RMA combined with PPLR. The overall AUC is also shown in the bottom of the table. The winner is highlighted in bold for each group.</p>
        </table-wrap-foot>
      </table-wrap>
      <p>We randomly select two probe-sets, 220818_s_at and 203073_at, out of probe-sets whose PPLR values are significantly different between multi-mgMOS and PM-only multi-mgMOS. Probe-set 220818_s_at is related to a low expression DE gene and 203073_at related to a high expression non-DE gene. The distributions of the expression difference between two conditions for the two probe-sets are shown in Figure <xref ref-type="fig" rid="F8">8</xref>. For the DE probe-set in the left plot, the two methods obtain similar mean values of the expression difference, but obviously different measurement error. The variance of the expression difference calculated from multi-mgMOS is much larger than PM-only multi-mgMOS and this results in lower PPLR value, 0.747, compared with 1.000 from PM-only multi-mgMOS (PPLR values close to 0 or 1 indicate significant DE). Thus, this probe-set is correctly classified as significant DE according to PM-only multi-mgMOS’s result while misclassified as non-DE according to multi-mgMOS’s computation. This shows that PM-only multi-mgMOS increases the stability of multi-mgMOS for gene expression calculation for lower expression. For the non-DE probe-set on the right plot of Figure <xref ref-type="fig" rid="F8">8</xref>, multi-mgMOS correctly classifies this probe-set with PPLR value 0.467 while PM-only multi-mgMOS misclassifies it with PPLR value 0.997 showing that PM-only multi-mgMOS can be less accurate in the high end.</p>
      <fig id="F8" position="float">
        <label>Figure 8</label>
        <caption>
          <p><bold>Distribution of expression difference between two conditions for U133 GeneChip data.</bold> Probe-set 220818_s_at is a low expression DE gene and probe-set 203073_at is a relatively highly expressed non-DE gene. The blue lines stand for the distributions of expression difference between two conditions calculated from multi-mgMOS and the red lines for PM-only multi-mgMOS.</p>
        </caption>
        <graphic xlink:href="1471-2105-14-39-8"/>
      </fig>
    </sec>
    <sec>
      <title>Robust clustering considering technical and biological variance</title>
      <p>PUMA-CLUSTII is a robust Student’s <italic>t</italic> mixture model and takes into accounts expression measurement error, and technical and biological variance. Our work in [<xref ref-type="bibr" rid="B20">20</xref>] has already demonstrated that PUMA-CLUSTII obtained more accurate partitions compared with other alternatives on synthetic data. Furthermore, the method was shown to obtain numbers of clusters similar to the number of underlying groups in realistic simulated data. Applications of PUMA-CLUSTII on yeast metabolic cycle and cell cycle datasets have already shown that the method led to more biologically relevant clusters in terms of both GO category and TF-gene interaction.</p>
    </sec>
  </sec>
  <sec sec-type="conclusions">
    <title>Conclusions</title>
    <p>We have presented the extended and improved functions of the new version of the <italic>puma</italic> package and demonstrated the usefulness of these new functions on the well studied MAQC dataset and the qRT-PCR validated HNSCC dataset. With these extensions and improvements, <italic>puma</italic> is able to provide accurate expression estimates for both Affymetrix 3’ GeneChips and Exon arrays. In addition to gene expression measurements, the new <italic>puma</italic> can also provide reliable estimation of isoform expression from Exon array data. For 3’ GeneChip data, the stability of expression measurements for low expression genes was improved. Furthermore, a level of uncertainty associated with these expression estimates can also be obtained and this measurement error can be propagated into our downstream analysis approaches to obtain improved results. With the consideration of expression measurement error in the downstream analyses, methods can be computationally demanding. The new <italic>puma</italic> package significantly improves the computational efficiency of the previous method for finding DE genes and obtains even better accuracy. As the final contribution, the new <italic>puma</italic> provides a robust clustering method which considers the within-chip measurement error and across-chip technical and biological variance.</p>
    <p>There are two main advantages of the new <italic>puma</italic> package. One is that the package processes Affymetrix 3’ GeneChips and Exon arrays to obtain accurate gene and isoform expression estimates with a level of uncertainty associated with these measurements. The other is that the package offers various downstream analysis approaches which make use of measurement error of expression to produce improved results at both gene and isoform level. Note that the data used for these downstream analyses is not limited to expression measurements from microarrays. The data can be expression measurement obtained from any other platform so long as a reasonable level of uncertainty can be associated with each measurement. For example, RNA-Seq is increasingly applied for transcript quantification [<xref ref-type="bibr" rid="B24">24</xref>]. Some methods proposed to analyse RNA-Seq data are able to provide both expression estimates and measurement uncertainty [<xref ref-type="bibr" rid="B25">25</xref>,<xref ref-type="bibr" rid="B26">26</xref>]. The transcript expression estimates and the related measurement error output by these methods can be used directly by the downstream analysis methods of <italic>puma</italic>. For all these reasons, <italic>puma</italic> is very useful to a large number of researchers who are interested in gene and transcript expression analysis.</p>
  </sec>
  <sec sec-type="methods">
    <title>Methods</title>
    <sec>
      <title>Gamma model for Affymetrix GeneChip Exon array data</title>
      <p>Let <italic>y</italic><sub><italic>g</italic><italic>j</italic><italic>c</italic></sub> represent the <italic>j</italic>th PM probe intensity for the <italic>g</italic>th gene under the <italic>c</italic>th condition. Allowing any number of isoform contributions to <italic>y</italic><sub><italic>g</italic><italic>j</italic><italic>c</italic></sub>, we assume <italic>y</italic><sub><italic>g</italic><italic>j</italic><italic>c</italic></sub>=<italic>Σ</italic><sub><italic>k</italic>∈<italic>M</italic>(<italic>g</italic><italic>j</italic>)</sub><italic>s</italic><sub><italic>g</italic><italic>j</italic><italic>k</italic><italic>c</italic></sub>, where <italic>M</italic>(<italic>g</italic><italic>j</italic>) is the set containing indices of isoforms mapping to probe <italic>j</italic> of gene <italic>g</italic>, and <italic>s</italic><sub><italic>g</italic><italic>j</italic><italic>k</italic><italic>c</italic></sub> is the intensity contribution from the <italic>k</italic>th mapping isoform. Similar to the assumption of the multi-mgMOS method for 3’ array, we assume <italic>s</italic><sub><italic>g</italic><italic>j</italic><italic>k</italic><italic>c</italic></sub> follow a gamma distribution, <italic>s</italic><sub><italic>g</italic><italic>j</italic><italic>k</italic><italic>c</italic></sub>∼Ga(<italic>α</italic><sub><italic>g</italic><italic>k</italic><italic>c</italic></sub>,<italic>β</italic><sub><italic>g</italic><italic>j</italic></sub>), where <italic>β</italic><sub><italic>g</italic><italic>j</italic></sub> is a probe-specific latent variable which models the probe effects and is shared across the isoforms and experimental conditions of the same gene. As the summation of independent gamma-distributed variables, <italic>y</italic><sub><italic>g</italic><italic>j</italic><italic>c</italic></sub> also follows a gamma distribution, <italic>y</italic><sub><italic>g</italic><italic>j</italic><italic>c</italic></sub>∼Ga(<italic>Σ</italic><sub><italic>k</italic>∈<italic>M</italic>(<italic>g</italic><italic>j</italic>)</sub><italic>α</italic><sub><italic>g</italic><italic>k</italic><italic>c</italic></sub>,<italic>β</italic><sub><italic>g</italic><italic>j</italic></sub>). With a gamma prior for the latent variable <italic>β</italic><sub><italic>g</italic><italic>j</italic></sub>, i.e. <italic>β</italic><sub><italic>g</italic><italic>j</italic></sub>∼Ga(<italic>c</italic><sub><italic>g</italic></sub>,<italic>d</italic><sub><italic>g</italic></sub>), the likelihood of probe intensities for a specific gene is </p>
      <p>
        <disp-formula id="bmcM1">
          <label>(1)</label>
          <mml:math id="M1" name="1471-2105-14-39-i1" overflow="scroll">
            <mml:mtable class="align" columnalign="left">
              <mml:mtr>
                <mml:mtd class="align-1"/>
                <mml:mtd class="align-2">
                  <mml:mi>L</mml:mi>
                  <mml:mfenced open="(" close=")">
                    <mml:mrow>
                      <mml:mo>{</mml:mo>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>y</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mtext mathvariant="italic">gjc</mml:mtext>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mo>}</mml:mo>
                      <mml:mo>|</mml:mo>
                      <mml:mo>{</mml:mo>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>α</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mtext mathvariant="italic">gkc</mml:mtext>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mo>}</mml:mo>
                      <mml:mo>,</mml:mo>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>c</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>g</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mo>,</mml:mo>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>d</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>g</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                    </mml:mrow>
                  </mml:mfenced>
                  <mml:mspace width="2em"/>
                </mml:mtd>
                <mml:mtd>
                  <mml:mspace width="2em"/>
                </mml:mtd>
              </mml:mtr>
              <mml:mtr>
                <mml:mtd class="align-1"/>
                <mml:mtd class="align-2">
                  <mml:mspace width="1em"/>
                  <mml:mspace width="1em"/>
                  <mml:mo>=</mml:mo>
                  <mml:munder>
                    <mml:mrow>
                      <mml:mo mathsize="big">∏</mml:mo>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mtext mathvariant="italic">jc</mml:mtext>
                    </mml:mrow>
                  </mml:munder>
                  <mml:mo mathsize="big">∫</mml:mo>
                  <mml:mi>p</mml:mi>
                  <mml:mo>(</mml:mo>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>y</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mtext mathvariant="italic">gjc</mml:mtext>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>|</mml:mo>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>Σ</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>k</mml:mi>
                      <mml:mo>∈</mml:mo>
                      <mml:mi>M</mml:mi>
                      <mml:mo>(</mml:mo>
                      <mml:mtext mathvariant="italic">gj</mml:mtext>
                      <mml:mo>)</mml:mo>
                    </mml:mrow>
                  </mml:msub>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>α</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mtext mathvariant="italic">gkc</mml:mtext>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>,</mml:mo>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>β</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mtext mathvariant="italic">gj</mml:mtext>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>)</mml:mo>
                  <mml:mi>p</mml:mi>
                  <mml:mo>(</mml:mo>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>β</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mtext mathvariant="italic">gj</mml:mtext>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>|</mml:mo>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>c</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>g</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>,</mml:mo>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>d</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>g</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>)</mml:mo>
                  <mml:mi>d</mml:mi>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>β</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mtext mathvariant="italic">gj</mml:mtext>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mi>.</mml:mi>
                  <mml:mspace width="2em"/>
                </mml:mtd>
              </mml:mtr>
            </mml:mtable>
          </mml:math>
        </disp-formula>
      </p>
      <p>The integral in equation (1) can be computed analytically. The Maximum a Posteriori (MAP) solution of the model can thus be found by efficient numerical optimisation. With the estimated parameters <inline-formula><mml:math id="M2" name="1471-2105-14-39-i2" overflow="scroll"><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">gkc</mml:mtext></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:math></inline-formula>, <inline-formula><mml:math id="M3" name="1471-2105-14-39-i3" overflow="scroll"><mml:msub><mml:mrow><mml:mi>ĉ</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="M4" name="1471-2105-14-39-i4" overflow="scroll"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, the distribution of the expression for each isoform is </p>
      <p>
        <disp-formula id="bmcM2">
          <label>(2)</label>
          <mml:math id="M5" name="1471-2105-14-39-i5" overflow="scroll">
            <mml:mi>p</mml:mi>
            <mml:mo>(</mml:mo>
            <mml:msub>
              <mml:mrow>
                <mml:mi>s</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mtext mathvariant="italic">gjkc</mml:mtext>
              </mml:mrow>
            </mml:msub>
            <mml:mo>)</mml:mo>
            <mml:mo>=</mml:mo>
            <mml:mo mathsize="big">∫</mml:mo>
            <mml:mi>p</mml:mi>
            <mml:mo>(</mml:mo>
            <mml:msub>
              <mml:mrow>
                <mml:mi>s</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mtext mathvariant="italic">gjkc</mml:mtext>
              </mml:mrow>
            </mml:msub>
            <mml:mo>|</mml:mo>
            <mml:msub>
              <mml:mrow>
                <mml:mover accent="true">
                  <mml:mrow>
                    <mml:mi>α</mml:mi>
                  </mml:mrow>
                  <mml:mo>^</mml:mo>
                </mml:mover>
              </mml:mrow>
              <mml:mrow>
                <mml:mtext mathvariant="italic">gkc</mml:mtext>
              </mml:mrow>
            </mml:msub>
            <mml:mo>,</mml:mo>
            <mml:msub>
              <mml:mrow>
                <mml:mi>β</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mtext mathvariant="italic">gj</mml:mtext>
              </mml:mrow>
            </mml:msub>
            <mml:mo>)</mml:mo>
            <mml:mi>p</mml:mi>
            <mml:mo>(</mml:mo>
            <mml:msub>
              <mml:mrow>
                <mml:mi>β</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mtext mathvariant="italic">gj</mml:mtext>
              </mml:mrow>
            </mml:msub>
            <mml:mo>|</mml:mo>
            <mml:msub>
              <mml:mrow>
                <mml:mi>ĉ</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>g</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:mo>,</mml:mo>
            <mml:msub>
              <mml:mrow>
                <mml:mover accent="true">
                  <mml:mrow>
                    <mml:mi>d</mml:mi>
                  </mml:mrow>
                  <mml:mo>^</mml:mo>
                </mml:mover>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>g</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:mo>)</mml:mo>
            <mml:mi>d</mml:mi>
            <mml:msub>
              <mml:mrow>
                <mml:mi>β</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mtext mathvariant="italic">gj</mml:mtext>
              </mml:mrow>
            </mml:msub>
            <mml:mi>.</mml:mi>
          </mml:math>
        </disp-formula>
      </p>
      <p>We assume the expression of gene <italic>g</italic> is the sum of signal from its isoforms, i.e. <italic>Σ</italic><sub><italic>k</italic></sub><italic>s</italic><sub><italic>g</italic><italic>j</italic><italic>k</italic><italic>c</italic></sub>. Hence, the distribution of gene expression is also a gamma, <italic>Σ</italic><sub><italic>k</italic></sub><italic>s</italic><sub><italic>g</italic><italic>j</italic><italic>k</italic><italic>c</italic></sub>∼Ga(<italic>Σ</italic><sub><italic>k</italic></sub><italic>α</italic><sub><italic>g</italic><italic>k</italic><italic>c</italic></sub>,<italic>β</italic><sub><italic>g</italic><italic>j</italic></sub>). Similarly, the posterior distribution of the gene expression can be expressed as </p>
      <p>
        <disp-formula id="bmcM3">
          <label>(3)</label>
          <mml:math id="M6" name="1471-2105-14-39-i6" overflow="scroll">
            <mml:mi>p</mml:mi>
            <mml:mo>(</mml:mo>
            <mml:msub>
              <mml:mrow>
                <mml:mi>Σ</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>k</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:msub>
              <mml:mrow>
                <mml:mi>s</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mtext mathvariant="italic">gjkc</mml:mtext>
              </mml:mrow>
            </mml:msub>
            <mml:mo>)</mml:mo>
            <mml:mo>=</mml:mo>
            <mml:mo mathsize="big">∫</mml:mo>
            <mml:mi>p</mml:mi>
            <mml:mo>(</mml:mo>
            <mml:msub>
              <mml:mrow>
                <mml:mi>Σ</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>k</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:msub>
              <mml:mrow>
                <mml:mi>s</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mtext mathvariant="italic">gjkc</mml:mtext>
              </mml:mrow>
            </mml:msub>
            <mml:mo>|</mml:mo>
            <mml:msub>
              <mml:mrow>
                <mml:mi>Σ</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>k</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:msub>
              <mml:mrow>
                <mml:mover accent="true">
                  <mml:mrow>
                    <mml:mi>α</mml:mi>
                  </mml:mrow>
                  <mml:mo>^</mml:mo>
                </mml:mover>
              </mml:mrow>
              <mml:mrow>
                <mml:mtext mathvariant="italic">gkc</mml:mtext>
              </mml:mrow>
            </mml:msub>
            <mml:mo>,</mml:mo>
            <mml:msub>
              <mml:mrow>
                <mml:mi>β</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mtext mathvariant="italic">gj</mml:mtext>
              </mml:mrow>
            </mml:msub>
            <mml:mo>)</mml:mo>
            <mml:mi>p</mml:mi>
            <mml:mo>(</mml:mo>
            <mml:msub>
              <mml:mrow>
                <mml:mi>β</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mtext mathvariant="italic">gj</mml:mtext>
              </mml:mrow>
            </mml:msub>
            <mml:mo>|</mml:mo>
            <mml:msub>
              <mml:mrow>
                <mml:mi>ĉ</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>g</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:mo>,</mml:mo>
            <mml:msub>
              <mml:mrow>
                <mml:mover accent="true">
                  <mml:mrow>
                    <mml:mi>d</mml:mi>
                  </mml:mrow>
                  <mml:mo>^</mml:mo>
                </mml:mover>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>g</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:mo>)</mml:mo>
            <mml:mi mathvariant="normal">d</mml:mi>
            <mml:msub>
              <mml:mrow>
                <mml:mi>β</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mtext mathvariant="italic">gj</mml:mtext>
              </mml:mrow>
            </mml:msub>
            <mml:mi>.</mml:mi>
          </mml:math>
        </disp-formula>
      </p>
      <p>The posterior distributions of the logged gene/isoform expression can be estimated from equation (2) and (3), respectively. The expectation of the logged expression level is then computed and approximated by a Gaussian. The Gaussian approximation to the posterior distribution is useful for propagating the probe-level measurement error in subsequent downstream analyses of both gene and isoform expression.</p>
    </sec>
    <sec>
      <title>PM-only multi-mgMOS for Affymetrix 3’ GeneChip data</title>
      <p>Affymetrix 3’ GeneChips group probes into probe-sets. Most genes are covered by one probe-set and gene expression level can be presented by the expression estimated from the grouped probe intensities. To improve the stability of gene expression measurements for the original multi-mgMOS [<xref ref-type="bibr" rid="B3">3</xref>], we ignore the MM probe signal and assume PM probes measure specific hybridisation in a probe-specific way. The intensities of PM probes within a probe-set are assumed to follow a gamma distribution. Let <italic>y</italic><sub><italic>i</italic><italic>j</italic><italic>c</italic></sub> represent the <italic>j</italic>th PM intensity for the <italic>i</italic>th probe-set under the <italic>c</italic>th condition. The model is defined by </p>
      <p>
        <disp-formula id="bmcM4">
          <label>(4)</label>
          <mml:math id="M7" name="1471-2105-14-39-i7" overflow="scroll">
            <mml:msub>
              <mml:mrow>
                <mml:mi>y</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mtext mathvariant="italic">ijc</mml:mtext>
              </mml:mrow>
            </mml:msub>
            <mml:mspace width="2.77695pt"/>
            <mml:mo>∼</mml:mo>
            <mml:mspace width="2.77695pt"/>
            <mml:mtext>Ga</mml:mtext>
            <mml:mo>(</mml:mo>
            <mml:msub>
              <mml:mrow>
                <mml:mi>α</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mtext mathvariant="italic">ic</mml:mtext>
              </mml:mrow>
            </mml:msub>
            <mml:mo>,</mml:mo>
            <mml:msub>
              <mml:mrow>
                <mml:mi>b</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mtext mathvariant="italic">ij</mml:mtext>
              </mml:mrow>
            </mml:msub>
            <mml:mo>)</mml:mo>
          </mml:math>
        </disp-formula>
      </p>
      <p>
        <disp-formula id="bmcM5">
          <label>(5)</label>
          <mml:math id="M8" name="1471-2105-14-39-i8" overflow="scroll">
            <mml:msub>
              <mml:mrow>
                <mml:mi>b</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mtext mathvariant="italic">ij</mml:mtext>
              </mml:mrow>
            </mml:msub>
            <mml:mspace width="2.77695pt"/>
            <mml:mo>∼</mml:mo>
            <mml:mspace width="2.77695pt"/>
            <mml:mtext>Ga</mml:mtext>
            <mml:mo>(</mml:mo>
            <mml:msub>
              <mml:mrow>
                <mml:mi>c</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>i</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:mo>,</mml:mo>
            <mml:msub>
              <mml:mrow>
                <mml:mi>d</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>i</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:mo>)</mml:mo>
            <mml:mo>,</mml:mo>
          </mml:math>
        </disp-formula>
      </p>
      <p>where <italic>b</italic><sub><italic>i</italic><italic>j</italic></sub> is a latent variable which models probe-specific effects for the same type of chip.</p>
      <p>The MAP solution of this model can be easily found by efficient numerical optimisation. With the estimated parameters <inline-formula><mml:math id="M9" name="1471-2105-14-39-i9" overflow="scroll"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ic</mml:mtext></mml:mrow></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="M10" name="1471-2105-14-39-i10" overflow="scroll"><mml:msub><mml:mrow><mml:mi>ĉ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="M11" name="1471-2105-14-39-i11" overflow="scroll"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, the posterior distribution of PM intensities is </p>
      <p>
        <disp-formula id="bmcM6">
          <label>(6)</label>
          <mml:math id="M12" name="1471-2105-14-39-i12" overflow="scroll">
            <mml:mi>P</mml:mi>
            <mml:mo>(</mml:mo>
            <mml:msub>
              <mml:mrow>
                <mml:mi>y</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mtext mathvariant="italic">ijc</mml:mtext>
              </mml:mrow>
            </mml:msub>
            <mml:mo>)</mml:mo>
            <mml:mo>=</mml:mo>
            <mml:mo mathsize="big">∫</mml:mo>
            <mml:mi>P</mml:mi>
            <mml:mo>(</mml:mo>
            <mml:msub>
              <mml:mrow>
                <mml:mi>y</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mtext mathvariant="italic">ijc</mml:mtext>
              </mml:mrow>
            </mml:msub>
            <mml:mo>|</mml:mo>
            <mml:msub>
              <mml:mrow>
                <mml:mover accent="true">
                  <mml:mrow>
                    <mml:mi>α</mml:mi>
                  </mml:mrow>
                  <mml:mo>^</mml:mo>
                </mml:mover>
              </mml:mrow>
              <mml:mrow>
                <mml:mtext mathvariant="italic">ic</mml:mtext>
              </mml:mrow>
            </mml:msub>
            <mml:mo>,</mml:mo>
            <mml:msub>
              <mml:mrow>
                <mml:mi>b</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mtext mathvariant="italic">ij</mml:mtext>
              </mml:mrow>
            </mml:msub>
            <mml:mo>)</mml:mo>
            <mml:mi>P</mml:mi>
            <mml:mo>(</mml:mo>
            <mml:msub>
              <mml:mrow>
                <mml:mi>b</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mtext mathvariant="italic">ij</mml:mtext>
              </mml:mrow>
            </mml:msub>
            <mml:mo>|</mml:mo>
            <mml:msub>
              <mml:mrow>
                <mml:mi>ĉ</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>i</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:mo>,</mml:mo>
            <mml:msub>
              <mml:mrow>
                <mml:mover accent="true">
                  <mml:mrow>
                    <mml:mi>d</mml:mi>
                  </mml:mrow>
                  <mml:mo>^</mml:mo>
                </mml:mover>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>i</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:mo>)</mml:mo>
            <mml:mi>d</mml:mi>
            <mml:msub>
              <mml:mrow>
                <mml:mi>b</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mtext mathvariant="italic">ij</mml:mtext>
              </mml:mrow>
            </mml:msub>
            <mml:mi>.</mml:mi>
          </mml:math>
        </disp-formula>
      </p>
      <p>We use a Gaussian with a mean <inline-formula><mml:math id="M13" name="1471-2105-14-39-i13" overflow="scroll"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ic</mml:mtext></mml:mrow></mml:msub></mml:math></inline-formula> and a variance <inline-formula><mml:math id="M14" name="1471-2105-14-39-i14" overflow="scroll"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ic</mml:mtext></mml:mrow></mml:msub></mml:math></inline-formula> to approximate the posterior distribution of the expectation of log(<italic>y</italic><sub><italic>i</italic><italic>j</italic><italic>c</italic></sub>). The mean of the Gaussian is taken as the estimated gene expression and the variance shows the measurement error associated with this estimate.</p>
    </sec>
    <sec>
      <title>Improved PPLR for finding differential expressed genes</title>
      <p>In order to overcome the computation limitation of the original PPLR model, we propose an improved PPLR model (IPPLR) to detect DE genes. Similar to PPLR, IPPLR also considers both expression estimates and measurement uncertainty to obtain high accuracy in finding DE genes. We add a hidden variable <italic>x</italic><sub><italic>i</italic><italic>j</italic></sub> to the original PPLR model, representing the true gene expression. We assume that the variable is Gaussian distributed <inline-formula><mml:math id="M15" name="1471-2105-14-39-i15" overflow="scroll"><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mi mathvariant="script">N</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>)</mml:mo></mml:math></inline-formula>, where <italic>μ</italic><sub><italic>j</italic></sub> is the mean logged expression level under condition <italic>j</italic> and <italic>λ</italic> is the inverse of the between-replicate variance and is shared across different conditions. The measured expression level <inline-formula><mml:math id="M16" name="1471-2105-14-39-i16" overflow="scroll"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub></mml:math></inline-formula> can be expressed as, </p>
      <p>
        <disp-formula id="bmcM7">
          <label>(7)</label>
          <mml:math id="M17" name="1471-2105-14-39-i17" overflow="scroll">
            <mml:msub>
              <mml:mrow>
                <mml:mover accent="true">
                  <mml:mrow>
                    <mml:mi>x</mml:mi>
                  </mml:mrow>
                  <mml:mo>^</mml:mo>
                </mml:mover>
              </mml:mrow>
              <mml:mrow>
                <mml:mtext mathvariant="italic">ij</mml:mtext>
              </mml:mrow>
            </mml:msub>
            <mml:mo>∼</mml:mo>
            <mml:mi mathvariant="script">N</mml:mi>
            <mml:mo>(</mml:mo>
            <mml:msub>
              <mml:mrow>
                <mml:mi>x</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mtext mathvariant="italic">ij</mml:mtext>
              </mml:mrow>
            </mml:msub>
            <mml:mo>,</mml:mo>
            <mml:msubsup>
              <mml:mrow>
                <mml:mi>s</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mtext mathvariant="italic">ij</mml:mtext>
              </mml:mrow>
              <mml:mrow>
                <mml:mn>2</mml:mn>
              </mml:mrow>
            </mml:msubsup>
            <mml:mo>)</mml:mo>
            <mml:mo>,</mml:mo>
          </mml:math>
        </disp-formula>
      </p>
      <p>where <inline-formula><mml:math id="M18" name="1471-2105-14-39-i18" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math></inline-formula> is the probe-level measurement error, which can be obtained from multi-mgMOS or PM-only multi-mgMOS.</p>
      <p>We make a prior assumption that <italic>μ</italic><sub><italic>j</italic></sub> and <italic>λ</italic><sup>−1</sup> are independent and put a Gaussian prior on <italic>μ</italic><sub><italic>j</italic></sub>, </p>
      <p>
        <disp-formula id="bmcM8">
          <label>(8)</label>
          <mml:math id="M19" name="1471-2105-14-39-i19" overflow="scroll">
            <mml:msub>
              <mml:mrow>
                <mml:mi>μ</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>j</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:mo>∼</mml:mo>
            <mml:mi mathvariant="script">N</mml:mi>
            <mml:mo>(</mml:mo>
            <mml:msub>
              <mml:mrow>
                <mml:mi>μ</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mn>0</mml:mn>
              </mml:mrow>
            </mml:msub>
            <mml:mo>,</mml:mo>
            <mml:msubsup>
              <mml:mrow>
                <mml:mi>η</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mn>0</mml:mn>
              </mml:mrow>
              <mml:mrow>
                <mml:mo>−</mml:mo>
                <mml:mn>1</mml:mn>
              </mml:mrow>
            </mml:msubsup>
            <mml:mo>)</mml:mo>
            <mml:mo>,</mml:mo>
          </mml:math>
        </disp-formula>
      </p>
      <p>where <italic>μ</italic><sub>0</sub> and <italic>η</italic><sub>0</sub> are hyperparameters, on which we adopt noninformative hyperpriors. We assume a conjugate gamma prior on <italic>λ</italic>, </p>
      <p>
        <disp-formula id="bmcM9">
          <label>(9)</label>
          <mml:math id="M20" name="1471-2105-14-39-i20" overflow="scroll">
            <mml:mi>λ</mml:mi>
            <mml:mo>∼</mml:mo>
            <mml:mtext>Ga</mml:mtext>
            <mml:mo>(</mml:mo>
            <mml:mi>α</mml:mi>
            <mml:mo>,</mml:mo>
            <mml:mi>β</mml:mi>
            <mml:mo>)</mml:mo>
            <mml:mi>.</mml:mi>
          </mml:math>
        </disp-formula>
      </p>
      <p>We use the EM algorithm combined with a variational method to work out the model. In the E-step of PPLR, the variational distribution of <italic>λ</italic> is obtained by importance sampling which slows down the computation of the method. In contrast, the computation in the E-step of IPPLR is analytical due to the introduction of the latent variable <italic>x</italic><sub><italic>i</italic><italic>j</italic></sub>. IPPLR is therefore more computationally efficient than PPLR.</p>
      <p>Once the posterior distribution of <italic>μ</italic><sub><italic>j</italic></sub> is obtained, the probability of positive log-ratio (PPLR) between a treatment <italic>μ</italic><sub><italic>t</italic></sub> and a control <italic>μ</italic><sub><italic>c</italic></sub> can be calculated by </p>
      <p>
        <disp-formula id="bmcM10">
          <label>(10)</label>
          <mml:math id="M21" name="1471-2105-14-39-i21" overflow="scroll">
            <mml:mtext mathvariant="italic">PPLR</mml:mtext>
            <mml:mo>=</mml:mo>
            <mml:munderover>
              <mml:mrow>
                <mml:mo mathsize="big">∫</mml:mo>
              </mml:mrow>
              <mml:mrow>
                <mml:mn>0</mml:mn>
              </mml:mrow>
              <mml:mrow>
                <mml:mo>+</mml:mo>
                <mml:mi>∞</mml:mi>
              </mml:mrow>
            </mml:munderover>
            <mml:mi>d</mml:mi>
            <mml:mo>(</mml:mo>
            <mml:msub>
              <mml:mrow>
                <mml:mi>μ</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>t</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:mo>−</mml:mo>
            <mml:msub>
              <mml:mrow>
                <mml:mi>μ</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>c</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:mo>)</mml:mo>
            <mml:mi>P</mml:mi>
            <mml:mo>(</mml:mo>
            <mml:msub>
              <mml:mrow>
                <mml:mi>μ</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>t</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:mo>−</mml:mo>
            <mml:msub>
              <mml:mrow>
                <mml:mi>μ</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>c</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:mo>|</mml:mo>
            <mml:mi>D</mml:mi>
            <mml:mo>,</mml:mo>
            <mml:mover accent="true">
              <mml:mrow>
                <mml:mi>ϕ</mml:mi>
              </mml:mrow>
              <mml:mo>^</mml:mo>
            </mml:mover>
            <mml:mo>)</mml:mo>
            <mml:mo>,</mml:mo>
          </mml:math>
        </disp-formula>
      </p>
      <p>where <italic>D</italic> is the observed dataset and <inline-formula><mml:math id="M22" name="1471-2105-14-39-i22" overflow="scroll"><mml:mover accent="true"><mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math></inline-formula> is the set of ML estimates of hyperparameters. The examined transcript is up-regulated in the treatment when <italic>P</italic><italic>P</italic><italic>L</italic><italic>R</italic>&gt;0.5 while down-regulated when <italic>P</italic><italic>P</italic><italic>L</italic><italic>R</italic>&lt;0.5.</p>
    </sec>
    <sec>
      <title>PUMA-CLUSTII for clustering of replicated gene expression</title>
      <p>For the cases where technical or biological replicates are available, we propose a robust Student’s <italic>t</italic>-mixture model to deal with the technical and biological variability. Suppose the expression estimate for gene <italic>n</italic> under condition <italic>j</italic> is <italic>x</italic><sub><italic>n</italic><italic>j</italic><italic>i</italic></sub>, and the corresponding true expression and the known probe-level measurement error are <italic>t</italic><sub><italic>n</italic><italic>j</italic><italic>i</italic></sub> and <italic>s</italic><sub><italic>n</italic><italic>j</italic><italic>i</italic></sub> respectively, where <italic>i</italic>=1,…,<italic>R</italic><sub><italic>j</italic></sub> and <italic>R</italic><sub><italic>j</italic></sub> is the number of replicates under condition <italic>j</italic>. The expression estimate <italic>x</italic><sub><italic>n</italic><italic>j</italic><italic>i</italic></sub> is assumed to be generated from the following Gaussian distribution, </p>
      <p>
        <disp-formula id="bmcM11">
          <label>(11)</label>
          <mml:math id="M23" name="1471-2105-14-39-i23" overflow="scroll">
            <mml:msub>
              <mml:mrow>
                <mml:mi>x</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mtext mathvariant="italic">nji</mml:mtext>
              </mml:mrow>
            </mml:msub>
            <mml:mo>∼</mml:mo>
            <mml:mi mathvariant="script">N</mml:mi>
            <mml:mo>(</mml:mo>
            <mml:msub>
              <mml:mrow>
                <mml:mi>t</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mtext mathvariant="italic">nji</mml:mtext>
              </mml:mrow>
            </mml:msub>
            <mml:mo>,</mml:mo>
            <mml:msub>
              <mml:mrow>
                <mml:mi>s</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mtext mathvariant="italic">nji</mml:mtext>
              </mml:mrow>
            </mml:msub>
            <mml:mo>)</mml:mo>
            <mml:mi>.</mml:mi>
          </mml:math>
        </disp-formula>
      </p>
      <p>The true gene expression <italic>t</italic><sub><italic>n</italic><italic>j</italic><italic>i</italic></sub>’s for the replicates under the same condition is also assumed to be drawn from a Gaussian distribution, </p>
      <p>
        <disp-formula id="bmcM12">
          <label>(12)</label>
          <mml:math id="M24" name="1471-2105-14-39-i24" overflow="scroll">
            <mml:msub>
              <mml:mrow>
                <mml:mi>t</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mtext mathvariant="italic">nji</mml:mtext>
              </mml:mrow>
            </mml:msub>
            <mml:mo>∼</mml:mo>
            <mml:mi mathvariant="script">N</mml:mi>
            <mml:mfenced open="(" close=")">
              <mml:mrow>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>w</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mtext mathvariant="italic">nj</mml:mtext>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>,</mml:mo>
                <mml:mfrac>
                  <mml:mrow>
                    <mml:mn>1</mml:mn>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>η</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>n</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                  </mml:mrow>
                </mml:mfrac>
              </mml:mrow>
            </mml:mfenced>
            <mml:mo>,</mml:mo>
          </mml:math>
        </disp-formula>
      </p>
      <p>with the mean expression <italic>w</italic><sub><italic>n</italic><italic>j</italic></sub> for condition <italic>j</italic> and the precision <italic>η</italic><sub><italic>n</italic></sub>. By introducing a latent variable <italic>u</italic><sub><italic>n</italic></sub> for each gene, the <italic>t</italic>-distribution can be written as a convolution of a Gaussian with a Gamma placed on its precisions, </p>
      <p>
        <disp-formula id="bmcM13">
          <label>(13)</label>
          <mml:math id="M25" name="1471-2105-14-39-i25" overflow="scroll">
            <mml:mspace width="-15.0pt"/>
            <mml:mtext>St</mml:mtext>
            <mml:mfenced open="(" close=")">
              <mml:mrow>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>w</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>n</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>|</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>μ</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>k</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>,</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>Σ</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>k</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>,</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>ν</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>k</mml:mi>
                  </mml:mrow>
                </mml:msub>
              </mml:mrow>
            </mml:mfenced>
            <mml:mo>=</mml:mo>
            <mml:munderover>
              <mml:mrow>
                <mml:mo mathsize="big">∫</mml:mo>
              </mml:mrow>
              <mml:mrow>
                <mml:mn>0</mml:mn>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>∞</mml:mi>
              </mml:mrow>
            </mml:munderover>
            <mml:mi mathvariant="script">N</mml:mi>
            <mml:mfenced open="(" close=")">
              <mml:mrow>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>w</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>n</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>|</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>μ</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>k</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>,</mml:mo>
                <mml:mfrac>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>Σ</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>k</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>u</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>n</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                  </mml:mrow>
                </mml:mfrac>
              </mml:mrow>
            </mml:mfenced>
            <mml:mtext>Ga</mml:mtext>
            <mml:mfenced open="(" close=")">
              <mml:mrow>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>u</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>n</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>|</mml:mo>
                <mml:mfrac>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>ν</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>k</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mn>2</mml:mn>
                  </mml:mrow>
                </mml:mfrac>
                <mml:mo>,</mml:mo>
                <mml:mfrac>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>ν</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>k</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mn>2</mml:mn>
                  </mml:mrow>
                </mml:mfrac>
              </mml:mrow>
            </mml:mfenced>
            <mml:mtext mathvariant="italic">du</mml:mtext>
            <mml:mo>,</mml:mo>
          </mml:math>
        </disp-formula>
      </p>
      <p>where <italic>μ</italic><sub><italic>k</italic></sub> and <italic>Σ</italic><sub><italic>k</italic></sub> denote the mean and covariance matrix, respectively, and <italic>ν</italic><sub><italic>k</italic></sub> is degrees of freedom, for component <italic>k</italic>. The mean expression vector <italic>w</italic><sub><italic>n</italic></sub> is modelled as a robust mixture of Student’s <italic>t</italic>-distributions. </p>
      <p>
        <disp-formula id="bmcM14">
          <label>(14)</label>
          <mml:math id="M26" name="1471-2105-14-39-i26" overflow="scroll">
            <mml:mi>p</mml:mi>
            <mml:mo>(</mml:mo>
            <mml:msub>
              <mml:mrow>
                <mml:mi>w</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>n</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:mo>)</mml:mo>
            <mml:mo>=</mml:mo>
            <mml:munderover>
              <mml:mrow>
                <mml:mi mathsize="big">∑</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>k</mml:mi>
                <mml:mo>=</mml:mo>
                <mml:mn>1</mml:mn>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>K</mml:mi>
              </mml:mrow>
            </mml:munderover>
            <mml:msub>
              <mml:mrow>
                <mml:mi>Π</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>k</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:mtext>St</mml:mtext>
            <mml:mo>(</mml:mo>
            <mml:msub>
              <mml:mrow>
                <mml:mi>w</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>n</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:mo>|</mml:mo>
            <mml:msub>
              <mml:mrow>
                <mml:mi>μ</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>k</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:mo>,</mml:mo>
            <mml:msub>
              <mml:mrow>
                <mml:mi>Σ</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>k</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:mo>,</mml:mo>
            <mml:msub>
              <mml:mrow>
                <mml:mi>ν</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>k</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:mo>)</mml:mo>
            <mml:mi>.</mml:mi>
          </mml:math>
        </disp-formula>
      </p>
      <p>We share <italic>η</italic><sub><italic>n</italic></sub> across all conditions for each gene and assume that it captures the biological gene-specific variability. The precision <italic>η</italic><sub><italic>n</italic></sub> is assumed to come from a Gamma distribution </p>
      <p>
        <disp-formula id="bmcM15">
          <label>(15)</label>
          <mml:math id="M27" name="1471-2105-14-39-i27" overflow="scroll">
            <mml:msub>
              <mml:mrow>
                <mml:mi>η</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>n</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:mo>|</mml:mo>
            <mml:msub>
              <mml:mrow>
                <mml:mi>z</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mtext mathvariant="italic">nk</mml:mtext>
              </mml:mrow>
            </mml:msub>
            <mml:mo>=</mml:mo>
            <mml:mn>1</mml:mn>
            <mml:mo>∼</mml:mo>
            <mml:mtext>Ga</mml:mtext>
            <mml:mo>(</mml:mo>
            <mml:msub>
              <mml:mrow>
                <mml:mi>α</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>k</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:mo>,</mml:mo>
            <mml:msub>
              <mml:mrow>
                <mml:mi>β</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>k</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:mo>)</mml:mo>
            <mml:mi>.</mml:mi>
          </mml:math>
        </disp-formula>
      </p>
      <p>Inference can be carried out using the variational EM algorithm. Specifying the maximum and minimum numbers of components, the algorithm automatically converged to the optimal number of mixture components by employing the minimum message length (MML) principle [<xref ref-type="bibr" rid="B27">27</xref>] for model selection.</p>
    </sec>
  </sec>
  <sec>
    <title>Availability and requirements</title>
    <p><bold>Project name:</bold> puma Software</p>
    <p>
      <bold>Project home page:</bold>
      <ext-link ext-link-type="uri" xlink:href="http://www.bioinf.manchester.ac.uk/resources/puma">http://www.bioinf.manchester.ac.uk/resources/puma</ext-link>
    </p>
    <p><bold>Operating systems:</bold> Platform independent</p>
    <p><bold>Programming language:</bold> R, C</p>
    <p><bold>Other requirements:</bold> R</p>
    <p><bold>Any restrictions to use:</bold> it is available for free download except that puma uses C scripts of donlp [<xref ref-type="bibr" rid="B28">28</xref>].</p>
  </sec>
  <sec>
    <title>Competing interests</title>
    <p>The authors declare that they have no competing interests.</p>
  </sec>
  <sec>
    <title>Authors’ contributions</title>
    <p>XL developed PUMA-CLUSTII, partially supervised the development of the extensions of the <italic>puma</italic> package and wrote the manuscript. ZG developed GME and PM-only multi-mgMOS methods. LZ developed IPPLR method. MR initiated the puma project and partially supervised the development of the <italic>puma</italic> package. All authors read and approved the final manuscript.</p>
  </sec>
</body>
<back>
  <sec>
    <title>Acknowledgements</title>
    <p>XL acknowledges support from NSFC (61170152) and Qing Lan Project. LZ acknowledges support by “the Fundamental Research Funds for the Central Universities” (CXZZ11_0217). MR was supported by BBSRC award BB/H018123/2.</p>
  </sec>
  <ref-list>
    <ref id="B1">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Łabaj</surname>
          <given-names>PP</given-names>
        </name>
        <name>
          <surname>Leparc</surname>
          <given-names>GG</given-names>
        </name>
        <name>
          <surname>E</surname>
          <given-names>LB</given-names>
        </name>
        <name>
          <surname>Markillie</surname>
          <given-names>LM</given-names>
        </name>
        <name>
          <surname>S</surname>
          <given-names>WH</given-names>
        </name>
        <name>
          <surname>P</surname>
          <given-names>KD</given-names>
        </name>
        <article-title>Characterization and improvement of RNA-Seq precision in quantitative transcript expression profiling</article-title>
        <source>Bioinformatics</source>
        <year>2011</year>
        <volume>27</volume>
        <issue>13</issue>
        <fpage>i383</fpage>
        <lpage>i391</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btr247</pub-id>
        <?supplied-pmid 21685096?>
        <pub-id pub-id-type="pmid">21685096</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B2">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Pearson</surname>
          <given-names>RD</given-names>
        </name>
        <name>
          <surname>Liu</surname>
          <given-names>X</given-names>
        </name>
        <name>
          <surname>Sanguinetti</surname>
          <given-names>G</given-names>
        </name>
        <name>
          <surname>Milo</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>D</surname>
          <given-names>LN</given-names>
        </name>
        <name>
          <surname>Rattray</surname>
          <given-names>M</given-names>
        </name>
        <article-title>puma: a bioconductor package for propagating uncertainty in microarray analysis</article-title>
        <source>BMC Bioinformatics</source>
        <year>2009</year>
        <volume>10</volume>
        <fpage>211</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-10-211</pub-id>
        <?supplied-pmid 19589155?>
        <pub-id pub-id-type="pmid">19589155</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B3">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Liu</surname>
          <given-names>X</given-names>
        </name>
        <name>
          <surname>Milo</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Lawrence</surname>
          <given-names>ND</given-names>
        </name>
        <name>
          <surname>Rattray</surname>
          <given-names>M</given-names>
        </name>
        <article-title>A tractable probabilistic model for Affymetrix probe-level analysis across multiple chips</article-title>
        <source>Bioinformatics</source>
        <year>2005</year>
        <volume>21</volume>
        <fpage>3637</fpage>
        <lpage>3644</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bti583</pub-id>
        <?supplied-pmid 16020470?>
        <pub-id pub-id-type="pmid">16020470</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B4">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Sanguinetti</surname>
          <given-names>G</given-names>
        </name>
        <name>
          <surname>MIlo</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Rattray</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Lawrence</surname>
          <given-names>ND</given-names>
        </name>
        <article-title>Accounting for probe-level noise in principal component analysis of mmicroarray data</article-title>
        <source>Bioinformatice</source>
        <year>2005</year>
        <volume>21</volume>
        <fpage>3748</fpage>
        <lpage>3754</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bti617</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B5">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Liu</surname>
          <given-names>X</given-names>
        </name>
        <name>
          <surname>Milo</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Lawrence</surname>
          <given-names>ND</given-names>
        </name>
        <name>
          <surname>Rattray</surname>
          <given-names>M</given-names>
        </name>
        <article-title>Probe-level measurement error improves accuracy in detecting differential gene expression</article-title>
        <source>Bioinformatics</source>
        <year>2006</year>
        <volume>22</volume>
        <fpage>2107</fpage>
        <lpage>2113</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btl361</pub-id>
        <?supplied-pmid 16820429?>
        <pub-id pub-id-type="pmid">16820429</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B6">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Liu</surname>
          <given-names>X</given-names>
        </name>
        <name>
          <surname>Lin</surname>
          <given-names>KK</given-names>
        </name>
        <name>
          <surname>Andersen</surname>
          <given-names>B</given-names>
        </name>
        <name>
          <surname>Rattray</surname>
          <given-names>M</given-names>
        </name>
        <article-title>Including probe-level uncertainty in model-based gene expression clustering</article-title>
        <source>BMC Bioinformatics</source>
        <year>2007</year>
        <volume>9</volume>
        <fpage>98</fpage>
        <pub-id pub-id-type="pmid">17376221</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B7">
      <mixed-citation publication-type="other">
        <collab>Affymetrix</collab>
        <source>Guide to Probe Logarithmic Intensity Error</source>
        <year>2008</year>
        <comment>[Technical note]</comment>
      </mixed-citation>
    </ref>
    <ref id="B8">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Irizarry</surname>
          <given-names>RA</given-names>
        </name>
        <name>
          <surname>Hobbs</surname>
          <given-names>B</given-names>
        </name>
        <name>
          <surname>Collin</surname>
          <given-names>F</given-names>
        </name>
        <name>
          <surname>Beazer-Barclay</surname>
          <given-names>YD</given-names>
        </name>
        <name>
          <surname>Antonellis</surname>
          <given-names>KJ</given-names>
        </name>
        <article-title>Exploreation, normalization, and summaries of high density oligonucleotide array probe level data</article-title>
        <source>Biostatistics</source>
        <year>2003</year>
        <volume>4</volume>
        <fpage>249</fpage>
        <lpage>264</lpage>
        <pub-id pub-id-type="doi">10.1093/biostatistics/4.2.249</pub-id>
        <?supplied-pmid 12925520?>
        <pub-id pub-id-type="pmid">12925520</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B9">
      <mixed-citation publication-type="other">
        <collab>Affymetrix</collab>
        <source>Alternative Transcript Analysis Methods for Exon Arrays</source>
        <year>2005</year>
        <comment>(11 October 2005, date last revised) [<ext-link ext-link-type="uri" xlink:href="Http://media.affymetrix.com/support/technical/whitepapers/exon_alt_transcript_analysis_whitepaper.pdf">Http://media.affymetrix.com/support/technical/whitepapers/exon_alt_transcript_analysis_whitepaper.pdf</ext-link>]</comment>
      </mixed-citation>
    </ref>
    <ref id="B10">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Purdom</surname>
          <given-names>E</given-names>
        </name>
        <name>
          <surname>Simpson</surname>
          <given-names>KM</given-names>
        </name>
        <name>
          <surname>Robinson</surname>
          <given-names>MD</given-names>
        </name>
        <name>
          <surname>Conboy</surname>
          <given-names>JG</given-names>
        </name>
        <name>
          <surname>Lapuk</surname>
          <given-names>AV</given-names>
        </name>
        <name>
          <surname>Speed</surname>
          <given-names>TP</given-names>
        </name>
        <article-title>FIRMA: a method for detection of alternative splicing from exon array data</article-title>
        <source>Bioinformatics</source>
        <year>2008</year>
        <volume>24</volume>
        <fpage>1707</fpage>
        <lpage>1714</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btn284</pub-id>
        <?supplied-pmid 18573797?>
        <pub-id pub-id-type="pmid">18573797</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B11">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Xing</surname>
          <given-names>Y</given-names>
        </name>
        <name>
          <surname>Stoilov</surname>
          <given-names>P</given-names>
        </name>
        <name>
          <surname>Kapur</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Han</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Jiang</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>Shen</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Black</surname>
          <given-names>DL</given-names>
        </name>
        <name>
          <surname>Wong</surname>
          <given-names>WH</given-names>
        </name>
        <article-title>MADS: a new and improved method for analysis of differential alternative splicing by exon-tiling microarrays</article-title>
        <source>RNA</source>
        <year>2008</year>
        <volume>14</volume>
        <fpage>1470</fpage>
        <lpage>1479</lpage>
        <pub-id pub-id-type="doi">10.1261/rna.1070208</pub-id>
        <?supplied-pmid 18566192?>
        <pub-id pub-id-type="pmid">18566192</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B12">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Risueño</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Fontanillo</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>E</surname>
          <given-names>DM</given-names>
        </name>
        <name>
          <surname>J</surname>
          <given-names>DLR</given-names>
        </name>
        <article-title>GATExplorer: genomic and transcriptomic explorer; mapping expression probe to gene loci, transcripts, exons and ncRNAs</article-title>
        <source>BMC Bioinformatics</source>
        <year>2010</year>
        <volume>11</volume>
        <fpage>221</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-11-221</pub-id>
        <?supplied-pmid 20429936?>
        <pub-id pub-id-type="pmid">20429936</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B13">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Wu</surname>
          <given-names>Z</given-names>
        </name>
        <name>
          <surname>Irizarry</surname>
          <given-names>RA</given-names>
        </name>
        <name>
          <surname>Gentleman</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Martinez-Murillo</surname>
          <given-names>F</given-names>
        </name>
        <name>
          <surname>Spencer</surname>
          <given-names>F</given-names>
        </name>
        <article-title>A model-based background adjustment for oligonucleotide expression arrays</article-title>
        <source>J Am Stat Assoc</source>
        <year>2004</year>
        <volume>99</volume>
        <fpage>909</fpage>
        <lpage>917</lpage>
        <pub-id pub-id-type="doi">10.1198/016214504000000683</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B14">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Turro</surname>
          <given-names>E</given-names>
        </name>
        <name>
          <surname>Lewin</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Rose</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Dallman</surname>
          <given-names>MJ</given-names>
        </name>
        <name>
          <surname>Richardson</surname>
          <given-names>S</given-names>
        </name>
        <article-title>MMBGX: a method for estimating expression at the isoform level and detecting differential splicing using whole-transcript Affymetrix arrays</article-title>
        <source>Nucleic Acids Res</source>
        <year>2010</year>
        <volume>38</volume>
        <fpage>e4</fpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkp853</pub-id>
        <?supplied-pmid 19854940?>
        <pub-id pub-id-type="pmid">19854940</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B15">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Chen</surname>
          <given-names>P</given-names>
        </name>
        <name>
          <surname>Lepikhova</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Hu</surname>
          <given-names>Y</given-names>
        </name>
        <name>
          <surname>Monni</surname>
          <given-names>O</given-names>
        </name>
        <name>
          <surname>Hautamiemi</surname>
          <given-names>S</given-names>
        </name>
        <article-title>Comprehensive exon array data processing method for quantitative analysis of alternative spliced variants</article-title>
        <source>Nucleic Acids Res</source>
        <year>2011</year>
        <volume>39</volume>
        <fpage>e123</fpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkr513</pub-id>
        <?supplied-pmid 21745820?>
        <pub-id pub-id-type="pmid">21745820</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B16">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Li</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Wong</surname>
          <given-names>W</given-names>
        </name>
        <article-title>Model-based analysis of oligonucleotide arrays: Expression index computation and outlier detection</article-title>
        <source>Proc Natl Acad Sci USA</source>
        <year>2001</year>
        <volume>98</volume>
        <fpage>31</fpage>
        <lpage>36</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.98.1.31</pub-id>
        <?supplied-pmid 11134512?>
        <pub-id pub-id-type="pmid">11134512</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B17">
      <mixed-citation publication-type="book">
        <name>
          <surname>Bishop</surname>
          <given-names>CM</given-names>
        </name>
        <source>Pattern Recognition and Machine Learning</source>
        <year>2006</year>
        <publisher-name>New York: Springer</publisher-name>
      </mixed-citation>
    </ref>
    <ref id="B18">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Pearson</surname>
          <given-names>RD</given-names>
        </name>
        <article-title>A comprehensive re-analysis of the Golden Spike data: Towards a benchmark for differential expression methods</article-title>
        <source>BMC Bioinformatice</source>
        <year>2008</year>
        <volume>9</volume>
        <fpage>164</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-9-164</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B19">
      <mixed-citation publication-type="book">
        <name>
          <surname>Zhang</surname>
          <given-names>L</given-names>
        </name>
        <name>
          <surname>Liu</surname>
          <given-names>X</given-names>
        </name>
        <article-title>An improved probabilistic model for finding differential gene expression</article-title>
        <source>Proceedings of the 2nd International Conference on BioMedical Engineering and Informatics, BMEI 2009</source>
        <year>2009</year>
        <publisher-name>Tianjin, China</publisher-name>
      </mixed-citation>
    </ref>
    <ref id="B20">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Liu</surname>
          <given-names>X</given-names>
        </name>
        <name>
          <surname>Rattray</surname>
          <given-names>M</given-names>
        </name>
        <article-title>Including probe-level measurement error in robust mixture clustering of replicated microarray gene expression</article-title>
        <source>Stat Appl Genet Mol Biol</source>
        <year>2010</year>
        <volume>9</volume>
        <fpage>42</fpage>
      </mixed-citation>
    </ref>
    <ref id="B21">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Consortium</surname>
          <given-names>M</given-names>
        </name>
        <article-title>The MicroArray Quality Control (MAQC) project shows inter- and intraplatform reproducibility of gene expression measurements</article-title>
        <source>Nat Biotechnol</source>
        <year>2006</year>
        <volume>24</volume>
        <fpage>1151</fpage>
        <lpage>1161</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt1239</pub-id>
        <?supplied-pmid 16964229?>
        <pub-id pub-id-type="pmid">16964229</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B22">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Canales</surname>
          <given-names>RD</given-names>
        </name>
        <name>
          <surname>Luo</surname>
          <given-names>Y</given-names>
        </name>
        <name>
          <surname>Willey</surname>
          <given-names>JC</given-names>
        </name>
        <name>
          <surname>Austermiller</surname>
          <given-names>B</given-names>
        </name>
        <name>
          <surname>Barbacioru</surname>
          <given-names>CC</given-names>
        </name>
        <name>
          <surname>Boysen</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Hunkapiller</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Jensen</surname>
          <given-names>RV</given-names>
        </name>
        <name>
          <surname>Knight</surname>
          <given-names>CR</given-names>
        </name>
        <name>
          <surname>Y</surname>
          <given-names>LK</given-names>
        </name>
        <name>
          <surname>Ma</surname>
          <given-names>Y</given-names>
        </name>
        <name>
          <surname>Maqsodi</surname>
          <given-names>B</given-names>
        </name>
        <name>
          <surname>Papallo</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Peters</surname>
          <given-names>EH</given-names>
        </name>
        <name>
          <surname>Poulter</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>L</surname>
          <given-names>RP</given-names>
        </name>
        <name>
          <surname>Samaha</surname>
          <given-names>RR</given-names>
        </name>
        <name>
          <surname>Shi</surname>
          <given-names>L</given-names>
        </name>
        <name>
          <surname>Yang</surname>
          <given-names>W</given-names>
        </name>
        <name>
          <surname>Zhang</surname>
          <given-names>L</given-names>
        </name>
        <name>
          <surname>M</surname>
          <given-names>GF</given-names>
        </name>
        <article-title>Evaluation of DNA microarray results with quantitative gene expression platforms</article-title>
        <source>Nat Biotechnol</source>
        <year>2006</year>
        <volume>24</volume>
        <fpage>1115</fpage>
        <lpage>1122</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt1236</pub-id>
        <?supplied-pmid 16964225?>
        <pub-id pub-id-type="pmid">16964225</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B23">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Bullard</surname>
          <given-names>JH</given-names>
        </name>
        <name>
          <surname>Purdom</surname>
          <given-names>E</given-names>
        </name>
        <name>
          <surname>Hansen</surname>
          <given-names>KD</given-names>
        </name>
        <name>
          <surname>Dudoit</surname>
          <given-names>S</given-names>
        </name>
        <article-title>Evaluation of statistical methods for normalization and differential expression in mRNA-Seq experiments</article-title>
        <source>BMC Bioinformatics</source>
        <year>2010</year>
        <volume>11</volume>
        <fpage>94</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-11-94</pub-id>
        <?supplied-pmid 20167110?>
        <pub-id pub-id-type="pmid">20167110</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B24">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Nagalakshmi</surname>
          <given-names>U</given-names>
        </name>
        <name>
          <surname>Wang</surname>
          <given-names>Z</given-names>
        </name>
        <name>
          <surname>Waem</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Shou</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Raha</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Gerstein</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Snyder</surname>
          <given-names>M</given-names>
        </name>
        <article-title>The transcriptional lanscape of the yeast genome defined by RNA sequencing</article-title>
        <source>Science</source>
        <year>2008</year>
        <volume>320</volume>
        <fpage>1344</fpage>
        <lpage>1349</lpage>
        <pub-id pub-id-type="doi">10.1126/science.1158441</pub-id>
        <?supplied-pmid 18451266?>
        <pub-id pub-id-type="pmid">18451266</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B25">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Katz</surname>
          <given-names>Y</given-names>
        </name>
        <name>
          <surname>Wang</surname>
          <given-names>ET</given-names>
        </name>
        <name>
          <surname>Airoldi</surname>
          <given-names>EM</given-names>
        </name>
        <name>
          <surname>Burge</surname>
          <given-names>CB</given-names>
        </name>
        <article-title>Analysis and design of RNA sequencing experiments for identifying isoform regulation</article-title>
        <source>Nat Methods</source>
        <year>2010</year>
        <volume>7</volume>
        <fpage>1009</fpage>
        <lpage>1015</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.1528</pub-id>
        <?supplied-pmid 21057496?>
        <pub-id pub-id-type="pmid">21057496</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B26">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Glaus</surname>
          <given-names>P</given-names>
        </name>
        <name>
          <surname>Honkela</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Rattray</surname>
          <given-names>M</given-names>
        </name>
        <article-title>Identifying differentially expressed transcripts from RNA-seq data with biological variation</article-title>
        <source>Bioinformatics</source>
        <year>2012</year>
        <volume>28</volume>
        <fpage>1721</fpage>
        <lpage>1728</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bts260</pub-id>
        <?supplied-pmid 22563066?>
        <pub-id pub-id-type="pmid">22563066</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B27">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Figueiredo</surname>
          <given-names>MAT</given-names>
        </name>
        <name>
          <surname>Jain</surname>
          <given-names>AK</given-names>
        </name>
        <article-title>Unsupervised learning of finite mixture models</article-title>
        <source>IEEE Trans Pattern Anal Mach Intell</source>
        <year>2002</year>
        <volume>24</volume>
        <fpage>381</fpage>
        <lpage>396</lpage>
      </mixed-citation>
    </ref>
    <ref id="B28">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Spellucci</surname>
          <given-names>PDB</given-names>
        </name>
        <article-title>An SQP method for general nonlinear programs using only equality constrained subproblems</article-title>
        <source>Math Program</source>
        <year>1998</year>
        <volume>82</volume>
        <fpage>413</fpage>
      </mixed-citation>
    </ref>
  </ref-list>
</back>
