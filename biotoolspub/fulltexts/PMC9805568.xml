<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">9805568</article-id>
    <article-id pub-id-type="pmid">36377787</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btac738</article-id>
    <article-id pub-id-type="publisher-id">btac738</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Paper</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Genetics and Population Analysis</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Achieving improved accuracy for imputation of ancient DNA</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-6212-539X</contrib-id>
        <name>
          <surname>Ausmees</surname>
          <given-names>Kristiina</given-names>
        </name>
        <xref rid="btac738-cor1" ref-type="corresp"/>
        <!--kristiina.ausmees@it.uu.se-->
        <aff><institution>Department of Information Technology, Uppsala University</institution>, Uppsala 751 05, <country country="SE">Sweden</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-0458-6902</contrib-id>
        <name>
          <surname>Nettelblad</surname>
          <given-names>Carl</given-names>
        </name>
        <xref rid="btac738-cor1" ref-type="corresp"/>
        <!--carl.nettelblad@it.uu.se-->
        <aff><institution>Department of Information Technology, Uppsala University</institution>, Uppsala 751 05, <country country="SE">Sweden</country></aff>
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Schwartz</surname>
          <given-names>Russell</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btac738-cor1">To whom correspondence should be addressed. Email: <email>kristiina.ausmees@it.uu.se</email> or <email>carl.nettelblad@it.uu.se</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>1</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2022-11-15">
      <day>15</day>
      <month>11</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>15</day>
      <month>11</month>
      <year>2022</year>
    </pub-date>
    <volume>39</volume>
    <issue>1</issue>
    <elocation-id>btac738</elocation-id>
    <history>
      <date date-type="received">
        <day>02</day>
        <month>6</month>
        <year>2022</year>
      </date>
      <date date-type="rev-recd">
        <day>07</day>
        <month>11</month>
        <year>2022</year>
      </date>
      <date date-type="editorial-decision">
        <day>09</day>
        <month>11</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>14</day>
        <month>11</month>
        <year>2022</year>
      </date>
      <date date-type="corrected-typeset">
        <day>30</day>
        <month>11</month>
        <year>2022</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2022. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2022</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btac738.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>Genotype imputation has the potential to increase the amount of information that can be gained from the often limited biological material available in ancient samples. As many widely used tools have been developed with modern data in mind, their design is not necessarily reflective of the requirements in studies of ancient DNA. Here, we investigate if an imputation method based on the full probabilistic Li and Stephens model of haplotype frequencies might be beneficial for the particular challenges posed by ancient data.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>We present an implementation called prophaser and compare imputation performance to two alternative pipelines that have been used in the ancient DNA community based on the Beagle software. Considering empirical ancient data downsampled to lower coverages as well as present-day samples with artificially thinned genotypes, we show that the proposed method is advantageous at lower coverages, where it yields improved accuracy and ability to capture rare variation. The software prophaser is optimized for running in a massively parallel manner and achieved reasonable runtimes on the experiments performed when executed on a GPU.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>The C++ code for prophaser is available in the GitHub repository <ext-link xlink:href="https://github.com/scicompuu/prophaser" ext-link-type="uri">https://github.com/scicompuu/prophaser</ext-link>.</p>
      </sec>
      <sec id="s5">
        <title>Supplementary information</title>
        <p><xref rid="sup1" ref-type="supplementary-material">Supplementary information</xref> is available at <italic toggle="yes">Bioinformatics</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Formas</institution>
            <institution-id institution-id-type="DOI">10.13039/501100001862</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>2017-00453</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="5"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>The possibility of sequencing ancient human remains has allowed genetic analyses to be incorporated into studies of the history and evolution of our species. While methodological advances have led to an increase in the availability of ancient human genetic data, sample quality, quantity and cost still pose limitations for its analysis. Consequently, a significant amount of the available ancient DNA (aDNA) is sequenced at relatively low coverages of 1× or less, which leads some standard genomic and population genetic tools to be infeasible or unreliable to use (<xref rid="btac738-B20" ref-type="bibr">Marciniak and Perry, 2017</xref>).</p>
    <p>One approach to extending the information content and making available a wider range of methods for such data is to impute genotypes at sites that are unobserved or otherwise not possible to call confidently. Imputation has been successfully applied to present-day data in a wide range of studies, including for conforming samples that have been genotyped on different arrays (<xref rid="btac738-B18" ref-type="bibr">Li <italic toggle="yes">et al.</italic>, 2009</xref>) as well as calling dense diploid genotypes from low- and medium-coverage data (<xref rid="btac738-B3" ref-type="bibr">Auton <italic toggle="yes">et al.</italic>, 2015</xref>).</p>
    <p>Genotype imputation is commonly performed by statistical models that take into account patterns of genetic variation in a panel of reference individuals with known haplotypes. The haplotype frequency model of <xref rid="btac738-B17" ref-type="bibr">Li and Stephens (2003)</xref> is the foundation for many commonly used imputation tools such as IMPUTE2 (<xref rid="btac738-B13" ref-type="bibr">Howie <italic toggle="yes">et al.</italic>, 2009</xref>) and Beagle versions 4.1 and above (<xref rid="btac738-B4" ref-type="bibr">Browning and Browning, 2016</xref>). Beagle 4.0 (<xref rid="btac738-B5" ref-type="bibr">Browning and Browning, 2007</xref>) uses a slightly different underlying model based on local haplotype clusters. Among more recent methods is GLIMPSE (<xref rid="btac738-B25" ref-type="bibr">Rubinacci <italic toggle="yes">et al.</italic>, 2021</xref>), which is designed for imputing low-coverage data and is based on a modified version of the Li and Stephens framework.</p>
    <p>In the aDNA community, imputation has mainly been performed using the algorithm of Beagle 4.0 with genotype likelihoods as input (<xref rid="btac738-B1" ref-type="bibr">Antonio <italic toggle="yes">et al.</italic>, 2019</xref>; <xref rid="btac738-B2" ref-type="bibr">Ausmees <italic toggle="yes">et al.</italic>, 2022</xref>; <xref rid="btac738-B6" ref-type="bibr">Cassidy <italic toggle="yes">et al.</italic>, 2020</xref>; <xref rid="btac738-B9" ref-type="bibr">Gamba <italic toggle="yes">et al.</italic>, 2014</xref>; <xref rid="btac738-B15" ref-type="bibr">Jones <italic toggle="yes">et al.</italic>, 2015</xref>; <xref rid="btac738-B21" ref-type="bibr">Martiniano <italic toggle="yes">et al.</italic>, 2017</xref>). In a recent study, an evaluation of different imputation pipelines on an empirical ancient sample was conducted (<xref rid="btac738-B14" ref-type="bibr">Hui <italic toggle="yes">et al.</italic>, 2020</xref>). They compared imputation performed in a single step based on genotype likelihoods, as implemented in Beagle 4.0 and GLIMPSE, to a two-step methodology in which either GLIMPSE or Beagle is used to determine sites that can be confidently called based on the likelihoods, after which imputation is performed by Beagle 5.0 based on the resulting genotypes. They found that the two-step methodology resulted in more refined posterior genotype probabilities (GP) that allowed for an improved balance between accuracy and the number of retained sites when performing post-imputation filtering.</p>
    <p>In general, methods for genotype imputation have been designed to target present-day data, with algorithm simplifications made in order to prioritize computational efficiency and applicability to increasingly large study samples and reference panels. While Beagle versions up to 4.0 allowed for imputation to be performed based on genotype likelihoods, later versions require genotypes as input, which may introduce errors for low-coverage data in which genotypes cannot be confidently called. Many methods also reduce the number of possible states induced by the phased reference, e.g. by the haplotype cluster model of Beagle 4.0, or by considering a subset of reference haplotypes based on some measure of similarity to the sample, as in IMPUTE2 and GLIMPSE. The latter two are also examples of models that decouple the phasing and imputation steps, iterating haplotype estimation based on sample data and subsequent haploid imputation. This is a strategy that can reduce the computational requirements of imputation and has laid the foundation for pre-phasing approaches in which the two steps are completely separated and imputation requires phased input data. Also supported by IMPUTE2 and Beagle since versions 4.1, pre-phasing improves runtime for imputation with an often small trade-off in accuracy, although larger errors may result for populations where the haplotype phase is more difficult to estimate (<xref rid="btac738-B7" ref-type="bibr">Das <italic toggle="yes">et al.</italic>, 2018</xref>; <xref rid="btac738-B12" ref-type="bibr">Howie <italic toggle="yes">et al.</italic>, 2012</xref>).</p>
    <p>These trends in priorities for the development of imputation methods do not necessarily reflect the requirements of aDNA studies, where the goal is often to extract as much information as possible from a few precious samples in order to perform population genetic analyses, rather than e.g. preparing tens or hundreds of thousands of samples for genome-wide association studies. Further, as low coverage and sequencing errors are prevalent in ancient data, and assumptions of the available phased reference panels being representative of the study samples may not hold, algorithm simplifications may incur larger trade-offs in accuracy than for present-day data.</p>
    <p>In this article, we present a tool for performing genotype imputation that has been designed with ancient and other low-coverage data in mind. Our approach is different from other implementations based on the Li and Stephens model outlined above, in that it is based on genotype likelihood input and implements the full probabilistic model for the entire state space of possible haplotype configurations, rather than a subset. It also integrates over the unknown phase of the target data while performing imputation. Unlike these previous implementations, in which algorithmic simplifications have been made in order to increase computational efficiency, our contribution is intended for scenarios in which particularly challenging data motivates the use of the more comprehensive and expensive algorithm.</p>
    <p>In order to maintain practical usability on large problem sizes, we present an implementation, made available as the software prophaser that extends previous work on reducing the memory requirements of the algorithm. This allows the tool to be executed efficiently on GPUs for datasets of relevant sizes. We can show that this yields wall-clock runtimes comparable to current best practice CPU-based workflows for a reference set of realistic size. We evaluate prophaser on simulated low-coverage data based on present-day samples from the 1000 Genomes project as well as downsampled data from five empirical ancient individuals and compare performance to both a single- and a two-step imputation pipeline based on Beagle from <xref rid="btac738-B14" ref-type="bibr">Hui <italic toggle="yes">et al.</italic> (2020)</xref>.</p>
  </sec>
  <sec>
    <title>2 Materials and methods</title>
    <sec>
      <title>2.1 Empirical data</title>
      <p>Five ancient samples for which high-coverage genomes ranging from 19× to 57× are available were used for evaluation of imputation performance. These were sf12 from <xref rid="btac738-B11" ref-type="bibr">Günther <italic toggle="yes">et al.</italic> (2018)</xref>, Loschbour and LBK from <xref rid="btac738-B16" ref-type="bibr">Lazaridis <italic toggle="yes">et al.</italic> (2014)</xref>, ne1 from <xref rid="btac738-B9" ref-type="bibr">Gamba <italic toggle="yes">et al.</italic> (2014)</xref> and ans17 from Fraser and Sánchez-Quinto <italic toggle="yes">et al.</italic> (in preparation). Gold standard genotypes to which imputed data were compared were obtained by the same pipeline as described in their respective publications, and further filtered to keep only sites that were confidently called. Low-coverage data for the evaluation samples were generated by downsampling reads to coverages ranging from 0.1× to 2×, after which genotype likelihoods were generated using a pipeline based on the Genome Analysis Toolkit (GATK) v3.5.0 (<xref rid="btac738-B22" ref-type="bibr">McKenna <italic toggle="yes">et al.</italic>, 2010</xref>) tool UnifiedGenotyper. Unlike most previous studies of the imputation of aDNA, we did not filter the imputation input to remove genotypes that could be affected by post-mortem damage, which was motivated by the findings in <xref rid="btac738-B14" ref-type="bibr">Hui <italic toggle="yes">et al.</italic> (2020)</xref>. More information about the samples and data preparation procedure can be found in <xref rid="btac738-B2" ref-type="bibr">Ausmees <italic toggle="yes">et al.</italic> (2022)</xref>.</p>
    </sec>
    <sec>
      <title>2.2 Simulated data</title>
      <p>Simulated low-coverage data were generated for 10 individuals from the CEU population of the 1000 Genomes Phase 3 dataset (<xref rid="btac738-B3" ref-type="bibr">Auton <italic toggle="yes">et al.</italic>, 2015</xref>), filtered to keep only biallelic SNPs, by the following procedure.</p>
      <p>For every site <italic toggle="yes">j</italic> with a biallelic SNP with called genotype <italic toggle="yes">G<sub>j</sub></italic>:</p>
      <list list-type="bullet">
        <list-item>
          <p>Decide whether or not to sample a read with probability <italic toggle="yes">p</italic>.</p>
        </list-item>
        <list-item>
          <p>If a read is not sampled, set the likelihood to 0.3333 for all three possible genotypes.</p>
        </list-item>
        <list-item>
          <p>If a read is sampled:
</p>
          <list list-type="alpha-lower">
            <list-item>
              <p>Sample one read from the distribution defined in <xref rid="E1" ref-type="disp-formula">Equation 1</xref>, which, for the biallelic SNP at location <italic toggle="yes">j</italic> that is sampled randomly <italic toggle="yes">N<sub>j</sub></italic> times, describes the probability of sampling <italic toggle="yes">A<sub>j</sub></italic> copies of the alternative allele A and <italic toggle="yes">R<sub>j</sub></italic> copies of the reference allele R (so that <inline-formula id="IE1"><mml:math id="IM1" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>). This assumes independently observed reads, and a constant sequencing error rate per base <italic toggle="yes">δ</italic>.
<disp-formula id="E1"><label>(1)</label><mml:math id="M1" display="block" overflow="scroll"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="true">{</mml:mo><mml:mrow><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mrow><mml:mi mathvariant="italic">Bin</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mo>δ</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mtext>if</mml:mtext><mml:mo> </mml:mo><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>A</mml:mi><mml:mi>A</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mi mathvariant="italic">Bin</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mn>0.5</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mtext>if</mml:mtext><mml:mo> </mml:mo><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>R</mml:mi><mml:mi>A</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mi mathvariant="italic">Bin</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mo>δ</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mtext>if</mml:mtext><mml:mo> </mml:mo><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>R</mml:mi><mml:mi>R</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo stretchy="true">}</mml:mo></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:math></disp-formula></p>
            </list-item>
            <list-item>
              <p>Let <italic toggle="yes">X</italic> denote the allele that was sampled, and <italic toggle="yes">Y</italic> the allele that was not sampled. Calculate likelihoods for the three genotypes according to <xref rid="E2" ref-type="disp-formula">Equation 2</xref>, which is based on the formula for genotype likelihoods from the GATK framework (<xref rid="btac738-B22" ref-type="bibr">McKenna <italic toggle="yes">et al.</italic>, 2010</xref>).
<disp-formula id="E2"><label>(2)</label><mml:math id="M2" display="block" overflow="scroll"><mml:mrow><mml:mi>L</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>G</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="true">{</mml:mo><mml:mrow><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mrow><mml:mn>0.5</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mo>δ</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mn>0.5</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mo>δ</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mtext>for</mml:mtext><mml:mo> </mml:mo><mml:mi>G</mml:mi><mml:mo>=</mml:mo><mml:mi>X</mml:mi><mml:mi>X</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mn>0.5</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:mo>δ</mml:mo><mml:mo>/</mml:mo><mml:mn>3</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mn>0.5</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mo>δ</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mtext>for</mml:mtext><mml:mo> </mml:mo><mml:mi>G</mml:mi><mml:mo>=</mml:mo><mml:mi>Y</mml:mi><mml:mi>X</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mn>0.5</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:mo>δ</mml:mo><mml:mo>/</mml:mo><mml:mn>3</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mn>0.5</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:mo>δ</mml:mo><mml:mo>/</mml:mo><mml:mn>3</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mtext>for</mml:mtext><mml:mo> </mml:mo><mml:mi>G</mml:mi><mml:mo>=</mml:mo><mml:mi>Y</mml:mi><mml:mi>Y</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo stretchy="true">}</mml:mo></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:math></disp-formula></p>
            </list-item>
          </list>
        </list-item>
      </list>
      <p>For different simulated coverage levels <inline-formula id="IE2"><mml:math id="IM2" display="inline" overflow="scroll"><mml:mrow><mml:mi>c</mml:mi><mml:mo>∈</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula>, the sampling probability <italic toggle="yes">p</italic> was selected so that the fraction of sampled sites would be approximately <italic toggle="yes">c</italic>. The called genotypes of the original 1000 Genomes data, <italic toggle="yes">G<sub>j</sub></italic>, were used as gold standard genotypes to which imputed data were compared to assess accuracy. See the <xref rid="sup1" ref-type="supplementary-material">Supplementary Material</xref> for more information about the simulated data.</p>
    </sec>
    <sec>
      <title>2.3 Model and implementation</title>
      <p>The method implemented in the prophaser is based on a diploid version of the Hidden Markov Model (HMM) presented in <xref rid="btac738-B17" ref-type="bibr">Li and Stephens (2003)</xref>. We first outline this model, in which observed data correspond to called genotypes, and later describe the implemented modification which instead considers genotype likelihoods.</p>
      <p>For a set of <italic toggle="yes">H</italic> phased reference haplotypes at genomic positions <inline-formula id="IE3"><mml:math id="IM3" display="inline" overflow="scroll"><mml:mrow><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mn>1</mml:mn><mml:mo>…</mml:mo><mml:mi>M</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula>, the observed states <italic toggle="yes">G<sub>j</sub></italic> of the model correspond to the sample genotypes, and the hidden states <inline-formula id="IE4"><mml:math id="IM4" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> consist of a pair of values that indicate which reference haplotype is used as a template for each chromosome at the position. The observation probabilities, shown in <xref rid="btac738-T1" ref-type="table">Table 1</xref>, are based on the similarity between the observation and the genotype implied by the template haplotypes, and depend on an error parameter <italic toggle="yes">ϵ<sub>j</sub></italic>. The transition probabilities of the HMM are shown in <xref rid="E3" ref-type="disp-formula">Equation 3</xref>. These depend on the number of switches in the template haplotype for each chromosome and are parameterized by <italic toggle="yes">H</italic> and <italic toggle="yes">θ<sub>j</sub></italic>, reflecting the probability of historical recombination events between the two genomic positions. We refer to the <xref rid="sup1" ref-type="supplementary-material">Supplementary Material</xref> for more information about the model and its implementation.
<disp-formula id="E3"><label>(3)</label><mml:math id="M3" display="block" overflow="scroll"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mtable><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mfrac><mml:mrow><mml:msubsup><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mtext>if</mml:mtext><mml:mo> </mml:mo><mml:mn>2</mml:mn><mml:mo> </mml:mo><mml:mtext>switch</mml:mtext></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mi>H</mml:mi></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mtext>if</mml:mtext><mml:mo> </mml:mo><mml:mn>1</mml:mn><mml:mo> </mml:mo><mml:mtext>switch</mml:mtext></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msubsup><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>H</mml:mi></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mtext>if</mml:mtext><mml:mo> </mml:mo><mml:mn>0</mml:mn><mml:mo> </mml:mo><mml:mtext>switch</mml:mtext></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula></p>
      <table-wrap position="float" id="btac738-T1">
        <label>Table 1.</label>
        <caption>
          <p>The observation probability <inline-formula id="IE5"><mml:math id="IM5" display="inline" overflow="scroll"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> of genotype <italic toggle="yes">G<sub>j</sub></italic> at position <italic toggle="yes">j</italic> given the hidden state, with <inline-formula id="IE6"><mml:math id="IM6" display="inline" overflow="scroll"><mml:mrow><mml:mi>G</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> denoting the genotype implied by the hidden state <italic toggle="yes">X<sub>j</sub></italic></p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th rowspan="1" colspan="1"/>
              <th colspan="4" rowspan="1">
                <inline-formula id="IE7">
                  <mml:math id="IM7" display="inline" overflow="scroll">
                    <mml:mrow>
                      <mml:mi>G</mml:mi>
                      <mml:mo stretchy="false">(</mml:mo>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>X</mml:mi>
                        </mml:mrow>
                        <mml:mi>j</mml:mi>
                      </mml:msub>
                      <mml:mo stretchy="false">)</mml:mo>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">
                <italic toggle="yes">G<sub>j</sub></italic>
              </td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">0</td>
              <td rowspan="1" colspan="1">1</td>
              <td rowspan="1" colspan="1">2</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">0</td>
              <td rowspan="1" colspan="1">
                <inline-formula id="IE8">
                  <mml:math id="IM8" display="inline" overflow="scroll">
                    <mml:mrow>
                      <mml:msup>
                        <mml:mrow>
                          <mml:mrow>
                            <mml:mo stretchy="false">(</mml:mo>
                            <mml:mn>1</mml:mn>
                            <mml:mo>−</mml:mo>
                            <mml:msub>
                              <mml:mrow>
                                <mml:mo>ε</mml:mo>
                              </mml:mrow>
                              <mml:mi>j</mml:mi>
                            </mml:msub>
                            <mml:mo stretchy="false">)</mml:mo>
                          </mml:mrow>
                        </mml:mrow>
                        <mml:mn>2</mml:mn>
                      </mml:msup>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula id="IE9">
                  <mml:math id="IM9" display="inline" overflow="scroll">
                    <mml:mrow>
                      <mml:mo stretchy="false">(</mml:mo>
                      <mml:mn>1</mml:mn>
                      <mml:mo>−</mml:mo>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mo>ε</mml:mo>
                        </mml:mrow>
                        <mml:mi>j</mml:mi>
                      </mml:msub>
                      <mml:mo stretchy="false">)</mml:mo>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mo>ε</mml:mo>
                        </mml:mrow>
                        <mml:mi>j</mml:mi>
                      </mml:msub>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula id="IE10">
                  <mml:math id="IM10" display="inline" overflow="scroll">
                    <mml:mrow>
                      <mml:msubsup>
                        <mml:mrow>
                          <mml:mo>ε</mml:mo>
                        </mml:mrow>
                        <mml:mi>j</mml:mi>
                        <mml:mn>2</mml:mn>
                      </mml:msubsup>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">1</td>
              <td rowspan="1" colspan="1">
                <inline-formula id="IE11">
                  <mml:math id="IM11" display="inline" overflow="scroll">
                    <mml:mrow>
                      <mml:mn>2</mml:mn>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mo>ε</mml:mo>
                        </mml:mrow>
                        <mml:mi>j</mml:mi>
                      </mml:msub>
                      <mml:mo stretchy="false">(</mml:mo>
                      <mml:mn>1</mml:mn>
                      <mml:mo>−</mml:mo>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mo>ε</mml:mo>
                        </mml:mrow>
                        <mml:mi>j</mml:mi>
                      </mml:msub>
                      <mml:mo stretchy="false">)</mml:mo>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula id="IE12">
                  <mml:math id="IM12" display="inline" overflow="scroll">
                    <mml:mrow>
                      <mml:msup>
                        <mml:mrow>
                          <mml:mrow>
                            <mml:mo stretchy="false">(</mml:mo>
                            <mml:mn>1</mml:mn>
                            <mml:mo>−</mml:mo>
                            <mml:msub>
                              <mml:mrow>
                                <mml:mo>ε</mml:mo>
                              </mml:mrow>
                              <mml:mi>j</mml:mi>
                            </mml:msub>
                            <mml:mo stretchy="false">)</mml:mo>
                          </mml:mrow>
                        </mml:mrow>
                        <mml:mn>2</mml:mn>
                      </mml:msup>
                      <mml:mo>+</mml:mo>
                      <mml:msubsup>
                        <mml:mrow>
                          <mml:mo>ε</mml:mo>
                        </mml:mrow>
                        <mml:mi>j</mml:mi>
                        <mml:mn>2</mml:mn>
                      </mml:msubsup>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula id="IE13">
                  <mml:math id="IM13" display="inline" overflow="scroll">
                    <mml:mrow>
                      <mml:mn>2</mml:mn>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mo>ε</mml:mo>
                        </mml:mrow>
                        <mml:mi>j</mml:mi>
                      </mml:msub>
                      <mml:mo stretchy="false">(</mml:mo>
                      <mml:mn>1</mml:mn>
                      <mml:mo>−</mml:mo>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mo>ε</mml:mo>
                        </mml:mrow>
                        <mml:mi>j</mml:mi>
                      </mml:msub>
                      <mml:mo stretchy="false">)</mml:mo>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">2</td>
              <td rowspan="1" colspan="1">
                <inline-formula id="IE14">
                  <mml:math id="IM14" display="inline" overflow="scroll">
                    <mml:mrow>
                      <mml:msubsup>
                        <mml:mrow>
                          <mml:mo>ε</mml:mo>
                        </mml:mrow>
                        <mml:mi>j</mml:mi>
                        <mml:mn>2</mml:mn>
                      </mml:msubsup>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula id="IE15">
                  <mml:math id="IM15" display="inline" overflow="scroll">
                    <mml:mrow>
                      <mml:mo stretchy="false">(</mml:mo>
                      <mml:mn>1</mml:mn>
                      <mml:mo>−</mml:mo>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mo>ε</mml:mo>
                        </mml:mrow>
                        <mml:mi>j</mml:mi>
                      </mml:msub>
                      <mml:mo stretchy="false">)</mml:mo>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mo>ε</mml:mo>
                        </mml:mrow>
                        <mml:mi>j</mml:mi>
                      </mml:msub>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula id="IE16">
                  <mml:math id="IM16" display="inline" overflow="scroll">
                    <mml:mrow>
                      <mml:msup>
                        <mml:mrow>
                          <mml:mrow>
                            <mml:mo stretchy="false">(</mml:mo>
                            <mml:mn>1</mml:mn>
                            <mml:mo>−</mml:mo>
                            <mml:msub>
                              <mml:mrow>
                                <mml:mo>ε</mml:mo>
                              </mml:mrow>
                              <mml:mi>j</mml:mi>
                            </mml:msub>
                            <mml:mo stretchy="false">)</mml:mo>
                          </mml:mrow>
                        </mml:mrow>
                        <mml:mn>2</mml:mn>
                      </mml:msup>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
      <p>The described model was used to define an HMM that incorporates the uncertainty of genotypes by having as observed data a vector of genotype likelihoods <italic toggle="yes">L</italic>(<italic toggle="yes">g</italic>) for each possible genotype <italic toggle="yes">g</italic>. For the case of biallelic SNPs, <inline-formula id="IE17"><mml:math id="IM17" display="inline" overflow="scroll"><mml:mrow><mml:mi>g</mml:mi><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula> and the observation at position <italic toggle="yes">j</italic> is thus <inline-formula id="IE18"><mml:math id="IM18" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mi>L</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mi>L</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mi>L</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula>. Uniform likelihoods were assumed for unobserved sample sites. Integration over the unknown genotype yields the joint probability of hidden and observed states shown in <xref rid="E4" ref-type="disp-formula">Equation 4</xref>.
<disp-formula id="E4"><label>(4)</label><mml:math id="M4" display="block" overflow="scroll"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>Y</mml:mi><mml:mo>,</mml:mo><mml:mi>X</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mi>M</mml:mi></mml:munderover><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>M</mml:mi></mml:munderover><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>g</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:munderover><mml:mi>P</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>g</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mi>L</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></disp-formula></p>
      <p>The forward–backward algorithm (<xref rid="btac738-B24" ref-type="bibr">Rabiner, 1989</xref>) was used to calculate posterior probabilities for the hidden states given the sequence of observed data <inline-formula id="IE19"><mml:math id="IM19" display="inline" overflow="scroll"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mi>M</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> for all positions <italic toggle="yes">j</italic>. Phased haplotypes could then be obtained by selecting the state with the highest probability, and posterior GP by integration over the hidden states.</p>
      <p>Our implementation reuses the collapsing of transition probabilities involving switches between haplotypes outlined in <xref rid="btac738-B19" ref-type="bibr">Li <italic toggle="yes">et al.</italic> (2010)</xref>. This brings down the effective computational complexity to linear in the number of states (quadratic in the number of haplotypes). <xref rid="btac738-B19" ref-type="bibr">Li <italic toggle="yes">et al.</italic> (2010)</xref> also employed a checkpointing scheme, only keeping every <italic toggle="yes">k</italic> elements in the permanent forward-backward tables, reducing memory usage to be proportional to the square root of the number of variant positions. In our implementation, we extend the checkpointing scheme to two levels, rather than one. This makes memory usage proportional to the cubic root of the number of SNPs, with a trebling in the amount of computations relative to a non-checkpointing counterpart. The reductions in memory usage make the resulting algorithm more cache-friendly and the total workset small enough to fit in the local memory of a conventional GPU. Using OpenMP offloading pragmas, the same source code can be compiled for multicore CPUs and compliant GPUs.</p>
    </sec>
    <sec>
      <title>2.4 Experimental setup</title>
      <p>Imputation performance was evaluated for three different methodologies: the proposed implementation prophaser as well as a single-step and a two-step pipeline based on Beagle. The single-step approach is the one that has mainly been used in aDNA studies previously and consisted of using Beagle 4.0 to impute data using genotype likelihoods as input. The two-step methodology corresponds to the one that was recommended in <xref rid="btac738-B14" ref-type="bibr">Hui <italic toggle="yes">et al.</italic> (2020)</xref> based on a comparison of single- and two-step pipelines based on Beagle and GLIMPSE. In this pipeline, Beagle 4.1 was used to estimate posterior GP from the genotype likelihoods, to which a pre-imputation filter of maximum GP <inline-formula id="IE20"><mml:math id="IM20" display="inline" overflow="scroll"><mml:mrow><mml:mo>≥</mml:mo><mml:mn>0.99</mml:mn></mml:mrow></mml:math></inline-formula> was applied. The filtered genotypes were used as input for imputation, which was performed using Beagle 5.2. See the <xref rid="sup1" ref-type="supplementary-material">Supplementary Material</xref> for more details on the experimental setup as well as additional results.</p>
      <p>Imputation was performed on chromosome 20 using a panel of phased reference haplotypes from the 1000 Genomes Phase 3 dataset and a genetic map derived from the HapMap2 (<xref rid="btac738-B8" ref-type="bibr">Frazer <italic toggle="yes">et al.</italic>, 2007</xref>) project. The phased reference data contained 2504 individuals and were filtered to include only biallelic SNPs. Experiments were performed on the simulated and empirical datasets separately. When imputing the simulated data, the 10 CEU individuals whose genotypes the sample data were derived from were removed from the reference set.</p>
      <p>Imputation performance was assessed by genotype concordance, defined as the fraction of evaluated sites where the imputed genotype is the same as the gold standard genotype. We also report the number of SNPs evaluated in terms of raw numbers or the fraction they make up of the total amount of sites that are possible to compare, i.e. the number of sites that overlap the gold standard data and the non-filtered output from imputation. Where results are reported for different allele frequencies, the minor allele frequency (MAF) within the phased reference panel was used.</p>
      <p>The Beagle pipelines were run on CPUs, with Beagle 4.0 allocated two cores of a compute server consisting of two 8-core Xeon E5-2660 processors, 218GB memory and Beagle versions 4.1 and 5.2 running on compute servers consisting of two 10-core Xeon E5-2630 V4 processors, 128 GB memory using four and five cores, respectively. The prophaser runs were performed on an NVIDIA A100 Tensor Core GPU with 40 GB on-board HBM2 VRAM.</p>
    </sec>
  </sec>
  <sec>
    <title>3 Results</title>
    <p>For the results in this section, we only considered sites at which the gold standard genotype was heterozygous, as these are more challenging to impute and less subject to chance agreement to the reference majority allele. We also note that we did not see any tendencies of the methods to systematically mispredict homozygotes as heterozygote, and that the patterns in relative performance between the methods considered for different coverages that are visible in the results below were also observed when considering all genotypes. A post-imputation filter requiring the GP value of the most probable imputed genotype to reach a certain threshold was also applied, with different thresholds used for the three imputation methodologies in order to obtain comparable numbers of evaluated SNPs. We found that the two-step Beagle methodology resulted in a less nuanced posterior GP, with many genotypes having the value 1.0, and consequently a relatively large amount of sites being retained. We therefore used a high threshold of 0.999 for this pipeline and adjusted the other two accordingly with 0.9 for single-step Beagle and 0.8 for prophaser. We prioritized obtaining similar numbers of evaluated sites for the lower coverages in particular, as these are of main interest in this study and also the cases with the largest differences in performance between the methods. We refer to the <xref rid="sup1" ref-type="supplementary-material">Supplementary Material</xref> for additional results considering all genotypes as well as different GP thresholds for the post-imputation filter.</p>
    <p>For runtimes, we report the execution time per sample and imputation window, see the <xref rid="sup1" ref-type="supplementary-material">Supplementary Material</xref> for more information about how the different methodologies were executed. Using the computational resources described in the previous section, prophaser execution took 40 min. The runtimes of the Beagle software depended on coverage and ranged between 2.2 and 7.12 h for the single-step pipeline, and between 1 min and 2.5 h for the two-step pipeline.</p>
    <sec>
      <title>3.1 Empirical data</title>
      <p><xref rid="btac738-F1" ref-type="fig">Figure 1</xref> summarizes the performance of the three imputation methodologies for different coverages of the empirical dataset. The single-step Beagle pipeline showed more variable outcomes for the different evaluation individuals and was outperformed by the other approaches. The largest difference between the methods was seen for coverages below 0.5×, where prophaser had higher concordance while retaining a larger share of SNPs. <xref rid="btac738-F2" ref-type="fig">Figure 2</xref> shows the imputation performance over the allele frequency spectrum for coverages 0.1×, 0.5× and 2×. Again, the differences between methodologies were more pronounced for lower coverages, with the prophaser outperforming the others consistently across the MAF spectrum at 0.1× coverage but only showing discernible advantages at the lowest MAF values for 2× data.</p>
      <fig position="float" id="btac738-F1">
        <label>Fig. 1.</label>
        <caption>
          <p>Genotype concordance (top) and fraction of evaluated SNPs (bottom) for heterozygote sites per coverage level, averaged over the five empirical evaluation individuals, with shaded regions displaying standard deviation. The legend indicates the GP thresholds used in the post-imputation filter for the different methodologies</p>
        </caption>
        <graphic xlink:href="btac738f1" position="float"/>
      </fig>
      <fig position="float" id="btac738-F2">
        <label>Fig. 2.</label>
        <caption>
          <p>Genotype concordance (solid lines) and number of evaluated SNPs (dashed lines) for heterozygote sites, displayed over 25 MAF bins, averaged over the five empirical evaluation individuals, for three coverage levels. The three plots share both left and right y-axes, with axis ranges indicated on the respective figure edge. The legend indicates the GP thresholds used in the post-imputation filter</p>
        </caption>
        <graphic xlink:href="btac738f2" position="float"/>
      </fig>
    </sec>
    <sec>
      <title>3.2 Simulated data</title>
      <p>For the simulated data, the range of coverages considered contained lower values than that of the empirical data. <xref rid="btac738-F3" ref-type="fig">Figure 3</xref> shows that for coverages below 0.2×, the single-step Beagle methodology outperformed the two-step one and had the highest concordance overall for the lowest coverage considered of 0.01×. Inspection of the corresponding plot in <xref rid="btac738-F4" ref-type="fig">Figure 4</xref> shows that differences between prophaser and single-step Beagle varied over allele frequencies, where the latter had fewer sites retained at the lower end of the spectrum and a corresponding higher concordance, whereas the opposite holds at the higher end of the MAF range. Their relative performance may be subject to the particular post-imputation GP thresholds used, whereas the two-step Beagle pipeline had consistently lower concordance than the single-step, even when less sites were retained.</p>
      <fig position="float" id="btac738-F3">
        <label>Fig. 3.</label>
        <caption>
          <p>Genotype concordance (top) and fraction of evaluated SNPs (bottom) for heterozygote sites per coverage level, averaged over the 10 simulated evaluation individuals, with shaded regions displaying standard deviation. The legend indicates the GP thresholds used in the post-imputation filter for the different methodologies</p>
        </caption>
        <graphic xlink:href="btac738f3" position="float"/>
      </fig>
      <fig position="float" id="btac738-F4">
        <label>Fig. 4.</label>
        <caption>
          <p>Genotype concordance (solid lines) and number of evaluated SNPs (dashed lines) for heterozygote sites, displayed over 25 MAF bins, averaged over the 10 simulated evaluation individuals, for three coverage levels. The three plots share both left and right y-axes, with axis ranges indicated on the respective figure edge. The legend indicates the GP thresholds used in the post-imputation filter</p>
        </caption>
        <graphic xlink:href="btac738f4" position="float"/>
      </fig>
      <p>For the higher coverages, the trends were largely similar to those observed for the empirical dataset, with the main difference being increased performance for the single-step pipeline over the two-step one for coverage 0.1×, although this could also be driven by differences in number of sites retained by the filter. Another possible explanation for the different patterns seen for the two datasets is that the haplotypes of the simulated samples are expected to have a higher degree of similarity to those in the reference panel as they are derived from the same population, in contrast to the ancient individuals which are temporally distinct from the present-day individuals in the panel.</p>
    </sec>
  </sec>
  <sec>
    <title>4 Discussion and conclusion</title>
    <p>With the majority of ancient genomes being sequenced at coverages for which reliable diploid variant calls are typically not feasible (<xref rid="btac738-B10" ref-type="bibr">Günther and Jakobsson, 2019</xref>; <xref rid="btac738-B20" ref-type="bibr">Marciniak and Perry, 2017</xref>; <xref rid="btac738-B23" ref-type="bibr">Parks and Lambert, 2015</xref>), the use of imputation methods that are based on probabilistic genotypes has become standard in the aDNA community.</p>
    <p>In this article, we propose an imputation tool that accepts genotype likelihood input and implements the full probabilistic Li and Stephens framework for haplotype frequencies. We evaluate performance on empirical ancient samples and simulated sparse genotypes, and show that the proposed tool achieves higher heterozygote concordance than two alternative methodologies adopted in the aDNA community that are based on the Beagle software. We further show that it provides reliable genotype calls over a larger part of the allele frequency spectrum and that it is particularly advantageous on low-coverage data, and we therefore believe that it may be of use in studies of aDNA as a means to increase information content where high-coverage data are not available.</p>
    <p>In addition to aDNA imputation, the tool would also be useful for other cases of challenging low-coverage imputation. Our simulated results on downsampling of 1000 Genomes individuals show that the tool is applicable in such scenarios. However, we believe that the benefits are the highest for ancient data, where the low coverage can also be unevenly distributed across the genome, individual calls can be less certain, and the divergence between the haplotypes found in reference individuals, and those in the study population, can be greater.</p>
    <p>The presented implementation is optimized to run in a highly parallel manner, and we show that it achieves feasible runtimes on a realistic problem size when executed on a GPU. This design is in line with recent trends in the field of machine learning, where such processing architectures are seeing increased use due to applications like the training of deep artificial neural networks.</p>
    <p>The underlying model lends itself to further customization for aDNA, and future work may focus on investigating the possibilities to include sample- or position-dependent adjustments to the HMM. This could include the incorporation of known patterns of errors in aDNA into the observation probabilities, or using estimates of divergence between sample and reference to adjust transition probabilities.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btac738_Supplementary_Data</label>
      <media xlink:href="btac738_supplementary_data.zip">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgements</title>
    <p>The authors acknowledge the use of computational resources provided by Swedish National Infrastructure for Computing (SNIC) and associated centers under projects SNIC 2021/22-94, UPPMAX 2020/2-5 and SNIC 2017/7-162, as well as the use of the Berzelius resource funded by the Knut och Alice Wallenbergs Stiftelse (KAW) under project Berzelius-2021-30.</p>
    <sec>
      <title>Funding</title>
      <p>This work was supported by Formas grant [2017-00453].</p>
      <p><italic toggle="yes">Conflict of Interest</italic>: none declared.</p>
    </sec>
  </ack>
  <sec sec-type="data-availability">
    <title>Data availability</title>
    <p>The authors state that all data necessary for confirming the conclusions presented in the article are represented fully within the article and in its online <xref rid="sup1" ref-type="supplementary-material">supplementary material</xref>.</p>
  </sec>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btac738-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Antonio</surname><given-names>M.L.</given-names></string-name></person-group><etal>et al</etal> (<year>2019</year>) <article-title>Ancient Rome: a genetic crossroads of Europe and the Mediterranean</article-title>. <source>Science</source>, <volume>366</volume>, <fpage>708</fpage>–<lpage>714</lpage>.<pub-id pub-id-type="pmid">31699931</pub-id></mixed-citation>
    </ref>
    <ref id="btac738-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ausmees</surname><given-names>K.</given-names></string-name></person-group><etal>et al</etal> (<year>2022</year>) <article-title>An empirical evaluation of genotype imputation of ancient DNA</article-title>. <source>G3 Genes—Genomes—Genetics</source>, <volume>12</volume>, jkac089.</mixed-citation>
    </ref>
    <ref id="btac738-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Auton</surname><given-names>A.</given-names></string-name></person-group><etal>et al</etal>; <collab>1000 Genomes Project Consortium</collab>. (<year>2015</year>) <article-title>A global reference for human genetic variation</article-title>. <source>Nature</source>, <volume>526</volume>, <fpage>68</fpage>–<lpage>74</lpage>.<pub-id pub-id-type="pmid">26432245</pub-id></mixed-citation>
    </ref>
    <ref id="btac738-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Browning</surname><given-names>B.</given-names></string-name>, <string-name><surname>Browning</surname><given-names>S.</given-names></string-name></person-group> (<year>2016</year>) <article-title>Genotype imputation with millions of reference samples</article-title>. <source>Am. J. Hum. Genet</source>., <volume>98</volume>, <fpage>116</fpage>–<lpage>126</lpage>.<pub-id pub-id-type="pmid">26748515</pub-id></mixed-citation>
    </ref>
    <ref id="btac738-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Browning</surname><given-names>S.R.</given-names></string-name>, <string-name><surname>Browning</surname><given-names>B.L.</given-names></string-name></person-group> (<year>2007</year>) <article-title>Rapid and accurate haplotype phasing and missing-data inference for whole-genome association studies by use of localized haplotype clustering</article-title>. <source>Am. J. Hum. Genet</source>., <volume>81</volume>, <fpage>1084</fpage>–<lpage>1097</lpage>.<pub-id pub-id-type="pmid">17924348</pub-id></mixed-citation>
    </ref>
    <ref id="btac738-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Cassidy</surname><given-names>L.M.</given-names></string-name></person-group><etal>et al</etal> (<year>2020</year>) <article-title>A dynastic elite in monumental Neolithic society</article-title>. <source>Nature</source>, <volume>582</volume>, <fpage>384</fpage>–<lpage>388</lpage>.<pub-id pub-id-type="pmid">32555485</pub-id></mixed-citation>
    </ref>
    <ref id="btac738-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Das</surname><given-names>S.</given-names></string-name></person-group><etal>et al</etal> (<year>2018</year>) <article-title>Genotype imputation from large reference panels</article-title>. <source>Annu. Rev. Genomics Hum. Genet</source>., <volume>19</volume>, <fpage>73</fpage>–<lpage>96</lpage>.<pub-id pub-id-type="pmid">29799802</pub-id></mixed-citation>
    </ref>
    <ref id="btac738-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Frazer</surname><given-names>K.A.</given-names></string-name></person-group><etal>et al</etal>; <collab>International HapMap Consortium</collab>. (<year>2007</year>) <article-title>A second generation human haplotype map of over 3.1 million SNPS</article-title>. <source>Nature</source>, <volume>449</volume>, <fpage>851</fpage>–<lpage>861</lpage>.<pub-id pub-id-type="pmid">17943122</pub-id></mixed-citation>
    </ref>
    <ref id="btac738-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gamba</surname><given-names>C.</given-names></string-name></person-group><etal>et al</etal> (<year>2014</year>) <article-title>Genome flux and stasis in a five millennium transect of European prehistory</article-title>. <source>Nat. Commun</source>., <volume>5</volume>, <fpage>5257</fpage>.<pub-id pub-id-type="pmid">25334030</pub-id></mixed-citation>
    </ref>
    <ref id="btac738-B10">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Günther</surname><given-names>T.</given-names></string-name>, <string-name><surname>Jakobsson</surname><given-names>M.</given-names></string-name></person-group> (<year>2019</year>) <part-title>Population genomic analyses of DNA from ancient remains</part-title>. In: <person-group person-group-type="editor"><string-name><surname>Balding</surname><given-names>D.J.</given-names></string-name></person-group><etal>et al</etal> (eds) <source>Handbook of Statistical Genomics, Chapter 10</source>. <publisher-name>Wiley</publisher-name>, <publisher-loc>Hoboken, NJ</publisher-loc>, pp. <fpage>295</fpage>–<lpage>324</lpage>.</mixed-citation>
    </ref>
    <ref id="btac738-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Günther</surname><given-names>T.</given-names></string-name></person-group><etal>et al</etal> (<year>2018</year>) <article-title>Population genomics of mesolithic scandinavia: investigating early postglacial migration routes and high-latitude adaptation</article-title>. <source>PLoS Biol</source>., <volume>16</volume>, <fpage>e2003703</fpage>.<pub-id pub-id-type="pmid">29315301</pub-id></mixed-citation>
    </ref>
    <ref id="btac738-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Howie</surname><given-names>B.</given-names></string-name></person-group><etal>et al</etal> (<year>2012</year>) <article-title>Fast and accurate genotype i in genome-wide association studies through pre-phasing</article-title>. <source>Nat. Genet</source>., <volume>44</volume>, <fpage>955</fpage>–<lpage>959</lpage>.<pub-id pub-id-type="pmid">22820512</pub-id></mixed-citation>
    </ref>
    <ref id="btac738-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Howie</surname><given-names>B.N.</given-names></string-name></person-group><etal>et al</etal> (<year>2009</year>) <article-title>A flexible and accurate genotype imputation method for the next generation of genome-wide association studies</article-title>. <source>PLoS Genet</source>., <volume>5</volume>, <fpage>e1000529</fpage>.<pub-id pub-id-type="pmid">19543373</pub-id></mixed-citation>
    </ref>
    <ref id="btac738-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hui</surname><given-names>R.</given-names></string-name></person-group><etal>et al</etal> (<year>2020</year>) <article-title>Evaluating genotype imputation pipeline for ultra-low coverage ancient genomes</article-title>. <source>Sci. Rep</source>., <volume>10</volume>, <fpage>18542</fpage>.<pub-id pub-id-type="pmid">33122697</pub-id></mixed-citation>
    </ref>
    <ref id="btac738-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Jones</surname><given-names>E.R.</given-names></string-name></person-group><etal>et al</etal> (<year>2015</year>) <article-title>Upper palaeolithic genomes reveal deep roots of modern Eurasians</article-title>. <source>Nat. Commun</source>., <volume>6</volume>, <fpage>8912</fpage>.<pub-id pub-id-type="pmid">26567969</pub-id></mixed-citation>
    </ref>
    <ref id="btac738-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lazaridis</surname><given-names>I.</given-names></string-name></person-group><etal>et al</etal> (<year>2014</year>) <article-title>Ancient human genomes suggest three ancestral populations for present-day Europeans</article-title>. <source>Nature</source>, <volume>513</volume>, <fpage>409</fpage>–<lpage>413</lpage>.<pub-id pub-id-type="pmid">25230663</pub-id></mixed-citation>
    </ref>
    <ref id="btac738-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Li</surname><given-names>N.</given-names></string-name>, <string-name><surname>Stephens</surname><given-names>M.</given-names></string-name></person-group> (<year>2003</year>) <article-title>Modeling linkage disequilibrium and identifying recombination hotspots using single-nucleotide polymorphism data</article-title>. <source>Genetics</source>, <volume>165</volume>, <fpage>2213</fpage>–<lpage>2233</lpage>.<pub-id pub-id-type="pmid">14704198</pub-id></mixed-citation>
    </ref>
    <ref id="btac738-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Li</surname><given-names>Y.</given-names></string-name></person-group><etal>et al</etal> (<year>2009</year>) <article-title>Genotype imputation</article-title>. <source>Annu. Rev. Genomics Hum. Genet</source>., <volume>10</volume>, <fpage>387</fpage>–<lpage>406</lpage>.<pub-id pub-id-type="pmid">19715440</pub-id></mixed-citation>
    </ref>
    <ref id="btac738-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Li</surname><given-names>Y.</given-names></string-name></person-group><etal>et al</etal> (<year>2010</year>) <article-title>MaCH: using sequence and genotype data to estimate haplotypes and unobserved genotypes</article-title>. <source>Genet. Epidemiol</source>., <volume>34</volume>, <fpage>816</fpage>–<lpage>834</lpage>.<pub-id pub-id-type="pmid">21058334</pub-id></mixed-citation>
    </ref>
    <ref id="btac738-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Marciniak</surname><given-names>S.</given-names></string-name>, <string-name><surname>Perry</surname><given-names>G.H.</given-names></string-name></person-group> (<year>2017</year>) <article-title>Harnessing ancient genomes to study the history of human adaptation</article-title>. <source>Nat. Rev. Genet</source>., <volume>18</volume>, <fpage>659</fpage>–<lpage>674</lpage>.<pub-id pub-id-type="pmid">28890534</pub-id></mixed-citation>
    </ref>
    <ref id="btac738-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Martiniano</surname><given-names>R.</given-names></string-name></person-group><etal>et al</etal> (<year>2017</year>) <article-title>The population genomics of archaeological transition in west Iberia: investigation of ancient substructure using imputation and haplotype-based methods</article-title>. <source>PLoS Genet</source>., <volume>13</volume>, <fpage>e1006852</fpage>.<pub-id pub-id-type="pmid">28749934</pub-id></mixed-citation>
    </ref>
    <ref id="btac738-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>McKenna</surname><given-names>A.</given-names></string-name></person-group><etal>et al</etal> (<year>2010</year>) <article-title>The genome analysis toolkit: a mapreduce framework for analyzing next-generation DNA sequencing data</article-title>. <source>Genome Res</source>., <volume>20</volume>, <fpage>1297</fpage>–<lpage>1303</lpage>.<pub-id pub-id-type="pmid">20644199</pub-id></mixed-citation>
    </ref>
    <ref id="btac738-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Parks</surname><given-names>M.</given-names></string-name>, <string-name><surname>Lambert</surname><given-names>D.</given-names></string-name></person-group> (<year>2015</year>) <article-title>Impacts of low coverage depths and post-mortem DNA damage on variant calling: a simulation study</article-title>. <source>BMC Genomics</source>, <volume>16</volume>, <fpage>19</fpage>.<pub-id pub-id-type="pmid">25613391</pub-id></mixed-citation>
    </ref>
    <ref id="btac738-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Rabiner</surname><given-names>L.R.</given-names></string-name></person-group> (<year>1989</year>) <article-title>A tutorial on hidden Markov models and selected applications in speech recognition</article-title>. <source>Proc. IEEE</source>, <volume>77</volume>, <fpage>257</fpage>–<lpage>286</lpage>.</mixed-citation>
    </ref>
    <ref id="btac738-B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Rubinacci</surname><given-names>S.</given-names></string-name></person-group><etal>et al</etal> (<year>2021</year>) <article-title>Efficient phasing and imputation of low-coverage sequencing data using large reference panels</article-title>. <source>Nat. Genet</source>., <volume>53</volume>, <fpage>120</fpage>–<lpage>126</lpage>.<pub-id pub-id-type="pmid">33414550</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
