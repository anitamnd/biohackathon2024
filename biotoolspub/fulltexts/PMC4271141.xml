<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20070202//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing.dtd?>
<?SourceDTD.Version 2.3?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-id journal-id-type="hwp">bioinfo</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">4271141</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btu590</article-id>
    <article-id pub-id-type="publisher-id">btu590</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Notes</subject>
        <subj-group subj-group-type="heading">
          <subject>Sequence Analysis</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>poRe: an R package for the visualization and analysis of nanopore sequencing data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Watson</surname>
          <given-names>Mick</given-names>
        </name>
        <xref ref-type="aff" rid="btu590-AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="corresp" rid="btu590-COR1">*</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Thomson</surname>
          <given-names>Marian</given-names>
        </name>
        <xref ref-type="aff" rid="btu590-AFF1">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Risse</surname>
          <given-names>Judith</given-names>
        </name>
        <xref ref-type="aff" rid="btu590-AFF1">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Talbot</surname>
          <given-names>Richard</given-names>
        </name>
        <xref ref-type="aff" rid="btu590-AFF1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Santoyo-Lopez</surname>
          <given-names>Javier</given-names>
        </name>
        <xref ref-type="aff" rid="btu590-AFF1">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Gharbi</surname>
          <given-names>Karim</given-names>
        </name>
        <xref ref-type="aff" rid="btu590-AFF1">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Blaxter</surname>
          <given-names>Mark</given-names>
        </name>
        <xref ref-type="aff" rid="btu590-AFF1">
          <sup>2</sup>
        </xref>
      </contrib>
      <aff id="btu590-AFF1"><sup>1</sup>Edinburgh Genomics, The Roslin Institute and R(D)SVS, University of Edinburgh, Easter Bush, Edinburgh EH25 9RG and <sup>2</sup>Edinburgh Genomics, Institute of Evolutionary Biology, Ashworth Laboratories, University of Edinburgh, Edinburgh EH9 3JT, UK</aff>
    </contrib-group>
    <author-notes>
      <corresp id="btu590-COR1">*To whom correspondence should be addressed.</corresp>
      <fn id="FN1">
        <p>Associate Editor: Inanc Birol</p>
      </fn>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>01</day>
      <month>1</month>
      <year>2015</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>29</day>
      <month>8</month>
      <year>2014</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>29</day>
      <month>8</month>
      <year>2014</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the
							<pub-date pub-type="epub"/>. -->
    <volume>31</volume>
    <issue>1</issue>
    <fpage>114</fpage>
    <lpage>115</lpage>
    <history>
      <date date-type="received">
        <day>4</day>
        <month>8</month>
        <year>2014</year>
      </date>
      <date date-type="rev-recd">
        <day>25</day>
        <month>8</month>
        <year>2014</year>
      </date>
      <date date-type="accepted">
        <day>26</day>
        <month>8</month>
        <year>2014</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author 2014. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2014</copyright-year>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/" license-type="creative-commons">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <abstract>
      <p><bold>Motivation:</bold> The Oxford Nanopore MinION device represents a unique sequencing technology. As a mobile sequencing device powered by the USB port of a laptop, the MinION has huge potential applications. To enable these applications, the bioinformatics community will need to design and build a suite of tools specifically for MinION data.</p>
      <p><bold>Results:</bold> Here we present poRe, a package for R that enables users to manipulate, organize, summarize and visualize MinION nanopore sequencing data. As a package for R, poRe has been tested on Windows, Linux and MacOSX. Crucially, the Windows version allows users to analyse MinION data on the Windows laptop attached to the device.</p>
      <p><bold>Availability and implementation:</bold> poRe is released as a package for R at <ext-link ext-link-type="uri" xlink:href="http://sourceforge.net/projects/rpore/">http://sourceforge.net/projects/rpore/</ext-link>. A tutorial and further information are available at <ext-link ext-link-type="uri" xlink:href="https://sourceforge.net/p/rpore/wiki/Home/">https://sourceforge.net/p/rpore/wiki/Home/</ext-link></p>
      <p>
        <bold>Contact:</bold>
        <email>mick.watson@roslin.ed.ac.uk</email>
      </p>
      <p><bold>Supplementary information</bold>: <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu590/-/DC1">Supplementary data</ext-link> are available at <italic>Bioinformatics</italic> online.</p>
    </abstract>
    <counts>
      <page-count count="2"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 INTRODUCTION</title>
    <p>Relative to first- and second-generation sequencing technologies, single-molecule sequencing is a new science, with only Helicos (<xref rid="btu590-B2" ref-type="bibr">Bowers <italic>et al.</italic>, 2009</xref>), Pacific Biosciences (<xref rid="btu590-B3" ref-type="bibr">Eid <italic>et al.</italic>, 2009</xref>) and Oxford Nanopore (ONT) being widely available. Even within the field of single-molecule sequencing, ONT’s nanopore sequencing technology represents a new paradigm; while both Helicos’ and Pacific Biosciences’ sequencing technologies measure incorporation events into a second strand, ONT’s MinION and GridION systems measure a single molecule of DNA as it passes through a protein nanopore. In addition, the MinION is the world’s first mobile DNA sequencer; it is powered by a laptop’s USB port and measures ∼4 inches in length. Recently, ONT opened up the MinION access programme, enabling researchers to use the device for the first time.</p>
    <p>The ultra-low-cost and mobile nature of the MinION device opens up a huge number of applications. However, users of the device are faced with a number of informatics challenges. Users of the MinION must buy a high-specification Windows laptop, and thus there is a need for Windows-based software to handle the data. The MinION outputs binary files in the HDF5 format (<ext-link ext-link-type="uri" xlink:href="http://www.hdfgroup.org/HDF5/">http://www.hdfgroup.org/HDF5/</ext-link>). These contain raw data from the sequencer, which are then processed by a cloud-based base caller called ‘metrichor’. The subsequent called sequence files are also in HDF5 format (with the extension .FAST5). It is not uncommon for users to be presented with 30–50 000 HDF5 files (.fast5), with no software with which to access the data. Furthermore, data from all runs are stored in a single directory, with no subdirectories, and users find themselves needing to manipulate thousands of files manually, which takes time and is error prone.</p>
    <p>We have developed poRe, a package for the statistical package R (<ext-link ext-link-type="uri" xlink:href="http://www.R-project.org/">http://www.R-project.org/</ext-link>; <xref rid="btu590-B1" ref-type="bibr">R Core Team, 2014</xref>), which enables users to manipulate MinION FAST5 files into run folders, extract FASTQ, gather statistics on each run and plot a number of key graphs, such as read-length histograms and yield-over-time. Crucially, as a package for R, poRe is cross-platform and has been tested on Windows, Linux and MacOSX. The Windows version enables users to run poRe on the MinION laptop itself, rather than copying the data to a Linux server to process with Perl or Python. This key feature brings users closer to true mobile DNA sequencing.</p>
  </sec>
  <sec>
    <title>2 METHODS</title>
    <sec id="SEC2.1">
      <title>2.1 Data format</title>
      <p>The FAST5 HDF5 files contain a number of hierarchical groups, datasets and attributes, and these are described in more detail in the <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu590/-/DC1">Supplementary Information</ext-link>.</p>
    </sec>
    <sec id="SEC2.2">
      <title>2.2 Organization and run statistics</title>
      <p>The first task users face is to organize a single MinION folder, which may contain reads from many different runs. We provide the function <italic>copy.runs()</italic> to help with this. The function reads all FAST5 files within a user-defined directory and extracts both the unique run identifier (‘run_id’) and the name and version of the base caller. Each read is then copied to a user-defined destination folder, under subfolders defined by the run_id and the name and version of the analysis. The latter is key, as each raw read may be base called many times by different versions of the metrichor base caller.</p>
      <p>Embedded within each FAST5 file are a number of key statistics about the reads. These can be extracted for all reads in a run by the function <italic>read.fast5.info()</italic>. This returns a data frame with 24 columns of metadata for each read. The function <italic>run.summary.stats()</italic> can be used to extract key summary statistics, such as maximum, minimum and mean read lengths.</p>
    </sec>
    <sec id="SEC2.3">
      <title>2.3 FASTQ and FASTA extraction</title>
      <p>Once the data are organized, users may wish to extract FASTQ/A data. This can be done using the <italic>extract.run.fastq()</italic> and <italic>extract.run.fasta()</italic> functions. For each FAST5 read in a given directory, this function will extract the template, complement and 2D FASTQ/A data where they exist and write these to individual FASTQ/A files.</p>
    </sec>
    <sec id="SEC2.4">
      <title>2.4 Data exploration</title>
      <p>We provide a number of functions that allow users to explore the data visually. Histograms of read length can be created using the <italic>plot.length.histogram()</italic> function. This plots histograms for the template, complement and 2D read lengths (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu590/-/DC1">Supplementary Fig. S1</ext-link>).</p>
      <p>The <italic>plot.cumulative.yield()</italic> function can be used to plot cumulative yield of the run over time, and sums up the template, complement and 2D read lengths over time in seconds since the analysis began (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu590/-/DC1">Supplementary Fig. S2</ext-link>).</p>
      <p>Finally, the MinION device consists of a number of channels, each of which should contain a single nanopore. Users can count and plot the number of reads per channel for a run, using <italic>plot.channel.reads()</italic>, and sum and plot the yield per channel, using <italic>plot.channel.yield().</italic> Both of these can be potentially used to diagnose problems in particular areas of the flowcell.</p>
    </sec>
    <sec id="SEC2.5">
      <title>2.5 Extracting and plotting events</title>
      <p>The raw data from the MinION are the information about the electronic signal measured as each single molecule of DNA passes through the protein nanopore. It is these data that are converted to sequence data by the metrichor agent. However, the raw events data are also available and can be extracted using the function <italic>get.events()</italic>. This will extract the thousands of events for both the template and complement for a particular read. The events data may then be visualized using the <italic>plot.squiggle()</italic> function (see <xref ref-type="fig" rid="btu590-F1">Fig. 1</xref>).
<fig id="btu590-F1" position="float"><label>Fig. 1.</label><caption><p>An example output from the <italic>plot.squiggle</italic> function. Plotted are the events data extracted from a single read. The <italic>y</italic>-axis is the mean electronic signal reported for the pore, and the <italic>x</italic>-axis is time in seconds</p></caption><graphic xlink:href="btu590f1"/></fig></p>
    </sec>
  </sec>
  <sec>
    <title>3 DISCUSSION</title>
    <p>We have written poRe, an R package that enables users to more easily manipulate, summarize and visualize MinION nanopore sequencing data. As a package for R, poRe is available for both Windows and Linux, and crucially the Windows version will allow data analysis on the mandatory Windows laptop on which the MinION depends. In addition, R is now a popular statistical package among biologists, who may feel comfortable using poRe through the R user interface.</p>
    <p>poRe is one of the first bioinformatics packages to offer this necessary functionality. poretools (<xref rid="btu590-B4" ref-type="bibr">Loman and Quinlan, 2014</xref>), a toolkit written in Python, offers similar functionality, although each software has a different set of (overlapping) functions. A table comparing feature sets is available in the <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu590/-/DC1">Supplementary Information</ext-link>. The cross-platform nature of poRe, its ease of installation and poRe’s ability to organize folders of FAST5 files make poRe an important tool for users of the MinION device.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="PMC_1" content-type="local-data">
      <caption>
        <title>Supplementary Data</title>
      </caption>
      <media mimetype="text" mime-subtype="html" xlink:href="supp_31_1_114__index.html"/>
      <media xlink:role="associated-file" mimetype="application" mime-subtype="pdf" xlink:href="supp_btu590_Supplementary_Data_V2.pdf"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <title>ACKNOWLEDGEMENT</title>
    <p>The authors would like to thank Oxford Nanopore for granting Edinburgh Genomics access to the MinION Access Programme (MAP).</p>
    <p><italic>Funding</italic>: Edinburgh Genomics is partly supported through core grants from the <funding-source>National Environmental Research Council</funding-source> (<award-id>NERC R8/H10/56</award-id>), <funding-source>Medical Research Council</funding-source> (<award-id>MRC MR/K001744/1</award-id>) and The <funding-source>Biotechnology and Biological Sciences Research Council</funding-source> (<award-id>BBSRC BB/J004243/1</award-id>).</p>
    <p><italic>Conflict of interest</italic>: none declared.</p>
  </ack>
  <ref-list>
    <title>REFERENCES</title>
    <ref id="btu590-B1">
      <element-citation publication-type="journal">
        <collab>R Core Team</collab>
        <source>R: A Language and Environment for Statistical Computing</source>
        <year>2014</year>
        <comment>R Foundation for Statistical Computing, Vienna, Austria</comment>
      </element-citation>
    </ref>
    <ref id="btu590-B2">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bowers</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Virtual terminator nucleotides for next-generation DNA sequencing</article-title>
        <source>Nat. Methods</source>
        <year>2009</year>
        <volume>6</volume>
        <fpage>593</fpage>
        <lpage>595</lpage>
        <pub-id pub-id-type="pmid">19620973</pub-id>
      </element-citation>
    </ref>
    <ref id="btu590-B3">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Eid</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Real-time DNA sequencing from single polymerase molecules</article-title>
        <source>Science</source>
        <year>2009</year>
        <volume>323</volume>
        <fpage>133</fpage>
        <lpage>138</lpage>
        <pub-id pub-id-type="pmid">19023044</pub-id>
      </element-citation>
    </ref>
    <ref id="btu590-B4">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Loman</surname>
            <given-names>NJ</given-names>
          </name>
          <name>
            <surname>Quinlan</surname>
            <given-names>AR</given-names>
          </name>
        </person-group>
        <article-title>Poretools: a toolkit for analyzing nanopore sequence data</article-title>
        <source>Bioinformatics</source>
        <year>2014</year>
        <comment>pii, btu555</comment>
      </element-citation>
    </ref>
  </ref-list>
</back>
