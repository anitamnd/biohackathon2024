<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Archiving and Interchange DTD v2.3 20070202//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName archivearticle.dtd?>
<?SourceDTD.Version 2.3?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Front Bioeng Biotechnol</journal-id>
    <journal-id journal-id-type="iso-abbrev">Front Bioeng Biotechnol</journal-id>
    <journal-id journal-id-type="publisher-id">Front. Bioeng. Biotechnol.</journal-id>
    <journal-title-group>
      <journal-title>Frontiers in Bioengineering and Biotechnology</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2296-4185</issn>
    <publisher>
      <publisher-name>Frontiers Media S.A.</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7010602</article-id>
    <article-id pub-id-type="doi">10.3389/fbioe.2020.00018</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Bioengineering and Biotechnology</subject>
        <subj-group>
          <subject>Methods</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>CALISTA: Clustering and LINEAGE Inference in Single-Cell Transcriptional Analysis</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Papili Gao</surname>
          <given-names>Nan</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="aff2">
          <sup>2</sup>
        </xref>
        <uri xlink:type="simple" xlink:href="http://loop.frontiersin.org/people/855328/overview"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Hartmann</surname>
          <given-names>Thomas</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
        <uri xlink:type="simple" xlink:href="http://loop.frontiersin.org/people/888093/overview"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Fang</surname>
          <given-names>Tao</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Gunawan</surname>
          <given-names>Rudiyanto</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="aff3">
          <sup>3</sup>
        </xref>
        <xref ref-type="corresp" rid="c001">
          <sup>*</sup>
        </xref>
        <uri xlink:type="simple" xlink:href="http://loop.frontiersin.org/people/806756/overview"/>
      </contrib>
    </contrib-group>
    <aff id="aff1"><sup>1</sup><institution>Institute for Chemical and Bioengineering, ETH Zurich</institution>, <addr-line>Zurich</addr-line>, <country>Switzerland</country></aff>
    <aff id="aff2"><sup>2</sup><institution>Swiss Institute of Bioinformatics</institution>, <addr-line>Lausanne</addr-line>, <country>Switzerland</country></aff>
    <aff id="aff3"><sup>3</sup><institution>Department of Chemical and Biological Engineering, University at Buffalo</institution>, <addr-line>Buffalo, NY</addr-line>, <country>United States</country></aff>
    <author-notes>
      <fn fn-type="edited-by">
        <p>Edited by: Xianwen Ren, Peking University, China</p>
      </fn>
      <fn fn-type="edited-by">
        <p>Reviewed by: Xiaojian Shao, National Research Council Canada (NRC-CNRC), Canada; Yong Wang, Academy of Mathematics and Systems Science (CAS), China</p>
      </fn>
      <corresp id="c001">*Correspondence: Rudiyanto Gunawan <email>rgunawan@buffalo.edu</email></corresp>
      <fn fn-type="other" id="fn001">
        <p>This article was submitted to Bioinformatics and Computational Biology, a section of the journal Frontiers in Bioengineering and Biotechnology</p>
      </fn>
    </author-notes>
    <pub-date pub-type="epub">
      <day>04</day>
      <month>2</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2020</year>
    </pub-date>
    <volume>8</volume>
    <elocation-id>18</elocation-id>
    <history>
      <date date-type="received">
        <day>25</day>
        <month>9</month>
        <year>2019</year>
      </date>
      <date date-type="accepted">
        <day>10</day>
        <month>1</month>
        <year>2020</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Copyright © 2020 Papili Gao, Hartmann, Fang and Gunawan.</copyright-statement>
      <copyright-year>2020</copyright-year>
      <copyright-holder>Papili Gao, Hartmann, Fang and Gunawan</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License (CC BY). The use, distribution or reproduction in other forums is permitted, provided the original author(s) and the copyright owner(s) are credited and that the original publication in this journal is cited, in accordance with accepted academic practice. No use, distribution or reproduction is permitted which does not comply with these terms.</license-p>
      </license>
    </permissions>
    <abstract>
      <p>We present Clustering and Lineage Inference in Single-Cell Transcriptional Analysis (CALISTA), a numerically efficient and highly scalable toolbox for an end-to-end analysis of single-cell transcriptomic profiles. CALISTA includes four essential single-cell analyses for cell differentiation studies, including single-cell clustering, reconstruction of cell lineage specification, transition gene identification, and cell pseudotime ordering, which can be applied individually or in a pipeline. In these analyses, we employ a likelihood-based approach where single-cell mRNA counts are described by a probabilistic distribution function associated with stochastic gene transcriptional bursts and random technical dropout events. We illustrate the efficacy of CALISTA using single-cell gene expression datasets from different single-cell transcriptional profiling technologies and from a few hundreds to tens of thousands of cells. CALISTA is freely available on <ext-link ext-link-type="uri" xlink:href="https://www.cabselab.com/calista">https://www.cabselab.com/calista</ext-link>.</p>
    </abstract>
    <kwd-group>
      <kwd>single-cell</kwd>
      <kwd>gene expression</kwd>
      <kwd>transcriptional bursts</kwd>
      <kwd>random dropouts</kwd>
      <kwd>cell clustering</kwd>
      <kwd>lineage progression</kwd>
      <kwd>pseudotime</kwd>
      <kwd>cell differentiation</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source id="cn001">Schweizerischer Nationalfonds zur FÃ¶rderung der Wissenschaftlichen Forschung<named-content content-type="fundref-id">10.13039/501100001711</named-content></funding-source>
        <award-id rid="cn001">157154</award-id>
        <award-id rid="cn001">176279</award-id>
      </award-group>
    </funding-group>
    <counts>
      <fig-count count="6"/>
      <table-count count="0"/>
      <equation-count count="16"/>
      <ref-count count="51"/>
      <page-count count="16"/>
      <word-count count="10087"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec sec-type="intro" id="s1">
    <title>Introduction</title>
    <p>The differentiation of stem cells into multiple cell types relies on the dynamic regulation of gene expression (Ralston and Shaw, <xref rid="B35" ref-type="bibr">2008</xref>). In this regard, advances in single-cell gene transcriptional profiling technology have given a tremendous boost in elucidating the decision making process governing stem cell commitment to different cell fates (Kalisky et al., <xref rid="B19" ref-type="bibr">2018</xref>). The applications of single-cell transcriptional analysis have led to new insights on the functional role of cell-to-cell gene expression heterogeneity in the physiological cell differentiation process (Guo et al., <xref rid="B13" ref-type="bibr">2010</xref>; Kumar et al., <xref rid="B21" ref-type="bibr">2014</xref>; Cacchiarelli et al., <xref rid="B5" ref-type="bibr">2015</xref>; Reinius et al., <xref rid="B36" ref-type="bibr">2016</xref>; Richard et al., <xref rid="B37" ref-type="bibr">2016</xref>). Along with the surge in single-cell transcriptional profiling studies, algorithms for analyzing single-cell transcriptomics data have received increasing attention. In comparison to measurements from aggregate or bulk samples of cell population, single-cell gene expression profiles display much higher variability, not only due to technical reasons, but also because of the intrinsic stochastic (bursty) dynamics of the gene transcriptional process (Kærn et al., <xref rid="B18" ref-type="bibr">2005</xref>). In particular, the stochastic gene transcription has been shown to generate highly non-Gaussian mRNA count distributions (Raj et al., <xref rid="B34" ref-type="bibr">2006</xref>), which complicate data analysis using established methods that rely on a standard noise distribution model (e.g., Gaussian or Student's <italic>t</italic>-distribution).</p>
    <p>Numerous algorithms have recently been developed specifically for the analysis of single-cell gene expression data. A class of these computational algorithms is geared toward identifying cell groups or clusters within a heterogeneous cell population. Traditional clustering algorithms such as <italic>k</italic>-means and hierarchical clustering have been applied for such a purpose (Grün et al., <xref rid="B12" ref-type="bibr">2015</xref>; Treutlein et al., <xref rid="B45" ref-type="bibr">2016</xref>; Stumpf et al., <xref rid="B41" ref-type="bibr">2017</xref>). Several other single-cell clustering strategies, such as CIDR (Lin et al., <xref rid="B22" ref-type="bibr">2017</xref>), pcaREDUCE (Žurauskiene and Yau, <xref rid="B51" ref-type="bibr">2016</xref>) and SNN-cliq (Xu and Su, <xref rid="B48" ref-type="bibr">2015</xref>), adapt more advanced algorithms such as nearest neighbors search. Time-variant clustering strategies have also been implemented to elucidate the appearance of multiple cell lineages (Huang et al., <xref rid="B16" ref-type="bibr">2014</xref>; Marco et al., <xref rid="B25" ref-type="bibr">2014</xref>). In addition, consensus clustering methods, such as SC3 (Kiselev et al., <xref rid="B20" ref-type="bibr">2017</xref>), have received much interest thanks to their superior stability and robustness. Finally, a likelihood-based method called Simulated Annealing for Bursty Expression Clustering (SABEC) (Ezer et al., <xref rid="B10" ref-type="bibr">2016</xref>) employs a mechanistic model of the bursty stochastic dynamics of gene transcriptional process to cluster cells.</p>
    <p>Another important class of algorithms deals with the reconstruction of lineage progression during cell differentiation process and the pseudotemporal ordering of single cells along the cell developmental path(s). The lineage progression describes the transition of stem cells through one or several developmental stages during the cell differentiation. This progression may comprise a single developmental path from the progenitor cells to one final cell fate, as well as bifurcating paths leading to multiple cell fates. In this class of algorithms, the reconstruction of the lineage progression and developmental paths is commonly implemented for the purpose of pseudotemporal cell ordering. The pseudotime of a cell represents the relative position of the cell along the developmental path and is typically normalized to be between 0 and 1. By plotting the gene expression against the pseudotime of the cells along a developmental path, one obtains a dynamic trajectory of the gene expression based on which the gene regulations driving the cell fate decision-making can be inferred. Numerous algorithms are available for single-cell transcriptional data analysis for cell lineage inference and cell ordering, notably DPT (Haghverdi et al., <xref rid="B14" ref-type="bibr">2016</xref>), MONOCLE 2 (Trapnell et al., <xref rid="B44" ref-type="bibr">2014</xref>; Qiu et al., <xref rid="B32" ref-type="bibr">2017</xref>), and PAGA ((Wolf et al., <xref rid="B47" ref-type="bibr">2019</xref>); for a more complete list, see a recent review by Cannoodt et al. (<xref rid="B6" ref-type="bibr">2016</xref>).</p>
    <p>In this work, we developed Clustering and Lineage Inference in Single Cell Transcriptional Analysis (CALISTA), a numerically efficient and highly scalable toolbox for an end-to-end analysis of single-cell transcriptomics data. CALISTA is capable of and has been tested for analyzing datasets from major single-cell transcriptional profiling technologies, including scRT-qPCR and scRNA-sequencing with both plate-based (e.g., SMART-seq) and droplet-based platforms (scDrop-seq). CALISTA enables four essential analyses of single-cell transcriptomics in stem cell differentiation studies, namely single-cell clustering, reconstruction of lineage progression, transition gene identification and cell pseudotime ordering. In existing literature, these analyses are typically carried out by stringing several task-specific tools together in a bioinformatics pipeline. But, the basic assumptions behind different tools (e.g., regarding the distribution of data noise) maybe incompatible, an issue that has not been delved into more carefully in the literature. In contrast, the different analyses in CALISTA are fully compatible with each other as they are based on the same likelihood-based approach using probabilistic models of gene transcriptional bursts and random dropout events.</p>
    <p>In the next section, we describe the algorithmic aspects and functionalities of CALISTA. The single-cell clustering of CALISTA is adapted from a previous method SABEC with a significant improvement in computational times, while the remaining CALISTA analyses represent novel contributions. For this reason, we focus the performance evaluation of CALISTA on lineage inference and cell pseudotime ordering, and compare CALISTA with widely-used bioinformatics packages including MONOCLE2 (Trapnell et al., <xref rid="B44" ref-type="bibr">2014</xref>; Qiu et al., <xref rid="B32" ref-type="bibr">2017</xref>) and SCANPY (Wolf et al., <xref rid="B46" ref-type="bibr">2018</xref>). Subsequently, we illustrate CALISTA's end-to-end analysis using single-cell transcriptional profiles from the differentiation of human induced pluripotent stem cells (iPSCs) into mesodermal (M) or undesired endodermal (En) cells (Bargaje et al., <xref rid="B2" ref-type="bibr">2017</xref>). Finally, we demonstrate the scalability of CALISTA in analyzing large datasets from scDrop-seq studies.</p>
  </sec>
  <sec sec-type="results" id="s2">
    <title>Results</title>
    <sec>
      <title>Single-Cell Transcriptional Analysis Using CALISTA</title>
      <p><xref ref-type="fig" rid="F1">Figure 1</xref> summarizes the four analyses of single-cell transcriptional profiles in CALISTA, including: (1) clustering of cells, (2) reconstruction of cell lineage progression, (3) identification of key transition genes, and (4) pseudotemporal ordering of cells. In CALISTA, we adopt a likelihood-based approach where the likelihood of a cell is computed using a probability distribution of mRNA defined according to the two-state model of gene transcriptional process (Peccoud and Ycart, <xref rid="B29" ref-type="bibr">1995</xref>) and when appropriate, a random dropout event model (see section Methods). A random dropout occurs when mRNA molecules of a gene are not detected even though the true mRNA count is non-zero. The single-cell clustering in CALISTA is an adaptation of the algorithm SABEC (Ezer et al., <xref rid="B10" ref-type="bibr">2016</xref>), where the single-cell clustering is carried out in two steps as illustrated in <xref ref-type="fig" rid="F1">Figure 1b</xref>: (1) independent runs of maximum likelihood clustering, and (2) consensus clustering. SABEC has a high computational requirement due to the implementation of simulated annealing in the maximum likelihood step. This requirement prohibits the application of SABEC to large scRNA datasets with &gt;10 K cells, such as from scDrop-Seq. CALISTA offers a substantial numerical speed-up over SABEC thanks to the implementation of a greedy algorithm and the reduction in the model parameter space (see <xref ref-type="supplementary-material" rid="SM6">Supplementary Note S1</xref> and <xref ref-type="supplementary-material" rid="SM1">Supplementary Table S1</xref>). CALISTA offers a parallel computing option which enables running the analysis over multiple computing cores for further speed-up.</p>
      <fig id="F1" position="float">
        <label>Figure 1</label>
        <caption>
          <p>CALISTA single-cell analysis workflow. <bold>(a)</bold> Single-cell expression input data are first pre-processed. <bold>(b)</bold> Single-cell clustering in CALISTA combines maximum likelihood and consensus clustering. In the maximum likelihood step, CALISTA relies on the two-state model of the gene transcription process in combination with a model of random dropouts to describe the distribution of single-cell gene expression. The maximum likelihood clustering is implemented multiple times, each starting from random cell assignment into clusters, using a greedy algorithm, the results from which are then used to generate a consensus matrix. The final step implements <italic>k-</italic>medoids clustering algorithm using the consensus matrix. <bold>(c)</bold> CALISTA uses cluster distances—a measure of dissimilarity in the gene expression distribution between any two clusters—to reconstruct the lineage progression graph. The state transition edges are added in increasing magnitude of cluster distances. In addition, CALISTA provides transition genes between any two connected clusters in the lineage graph based on the gene-wise likelihood differences between having the cells separately and having them in one cluster. <bold>(d)</bold> For pseudotemporal ordering of the cells, CALISTA reassigns each cell to a transition edge and computes its pseudotime by maximizing the cell likelihood. CALISTA uses a linear interpolation for evaluating the cell likelihood between two connected clusters. Given a developmental path in the lineage progression, CALISTA generates a moving averaged gene expression trajectory using the pseudotemporally ordered cells in the path.</p>
        </caption>
        <graphic xlink:href="fbioe-08-00018-g0001"/>
      </fig>
      <p>The rest of the single-cell analyses in CALISTA represent new contributions of this work. For reconstructing cell lineage progression, we treat single-cell clusters as cell states through which stem cells transition during the cell differentiation. Here, CALISTA allows the calculation of distances between any pair of cell clusters. The cluster distance—defined as the maximum difference in the cumulative likelihood value upon reassigning the cells from the original cluster to the other cluster (see section Methods)—gives a measure of dissimilarity in their gene expression distributions between any two clusters. CALISTA generates the lineage progression graph by sequentially adding state transition edges connecting closely distanced clusters until every cell cluster is connected to at least another cluster (<xref ref-type="fig" rid="F1">Figure 1c</xref>). CALISTA also provides an interface for users to edit the lineage progression graph, i.e., adding or removing state transition edges, based on the cluster distances and other available information about the cell differentiation. For assigning directionality to the edges, CALISTA relies on user-provided information, for example information on the cell stage or sampling time, the starter/progenitor cells or the expected temporal profiles of the expression of marker genes. CALISTA also allows multiple initial clusters.</p>
      <p>For any two connected clusters in the lineage progression, one can further use CALISTA to obtain the set of transition genes. The transition genes are determined based on the differences of the likelihood between having the cells in separate clusters and having them together in a single cluster (see section Methods). Here, the likelihood difference corresponding to a gene reflects the informative power of that gene for segregating cells into two clusters. The transition genes may point to candidate gene markers and genes regulating the state transition during differentiation. SABEC also allows the determination of transition genes, but using a different strategy, called Estimation of Pairwise changes in Kinetics (EPiK), that is based on the statistical significance of the difference in the two-state model parameters between any two clusters.</p>
      <p>The final component of CALISTA concerns with the pseudotemporal ordering of cells along a developmental path—defined as a sequence of connected clusters—in the lineage progression graph (<xref ref-type="fig" rid="F1">Figure 1d</xref>). More specifically, given a developmental path in the reconstructed lineage progression, CALISTA produces a list of the cells ordered in increasing pseudotimes. For this purpose, we first assign a pseudotime to each cluster, which is normalized such that the starting cluster in the lineage progression graph has a pseudotime of 0 and the final cell cluster (or clusters) has a pseudotime of 1. Subsequently, we assign each cell to a transition edge that is pointing to or emanating from the cluster to which the cell belongs, again by adopting the maximum likelihood principle (see section Methods). Here, we assume that the distribution of the single-cell gene expression varies monotonically between cell states (clusters). For simplicity, the likelihood of a cell along a transition edge is computed using a linear interpolation of the cell likelihood values from the connected clusters. Each cell is then assigned to the transition edge that maximizes its likelihood value. Analogously, the cell pseudotime is computed by a linear interpolation of the cluster pseudotimes and set to the corresponding maximum point of the cell likelihood value.</p>
    </sec>
    <sec>
      <title>Comparison of CALISTA Performance With Other Methods</title>
      <p>We compared the performance of CALISTA with two widely-used single-cell bioinformatics packages for lineage inference and pseudotime cell ordering: MONOCLE 2 (Qiu et al., <xref rid="B32" ref-type="bibr">2017</xref>) and SCANPY (Wolf et al., <xref rid="B46" ref-type="bibr">2018</xref>). More specifically, in SCANPY package, we used Partition-based Graph Abstraction (PAGA) for lineage progression inference (Wolf et al., <xref rid="B47" ref-type="bibr">2019</xref>) and Diffusion Pseudotime (DPT) for pseudotime cell ordering (Haghverdi et al., <xref rid="B14" ref-type="bibr">2016</xref>).</p>
      <p>In the first comparison, we generated <italic>in silico</italic> single-cell expression data of the cell differentiation of central nervous system (CNS) using a stochastic differential equation (SDE) model proposed by Qiu et al. (<xref rid="B31" ref-type="bibr">2012</xref>). We simulated single-cell data for 9 time points and 200 cells per time point, totaling 1,800 cells (see section Methods). As shown in <xref ref-type="fig" rid="F2">Figure 2A</xref>, the simulated single-cell data clearly display two cell lineage bifurcations, as expected in this cell differentiation system (Qiu et al., <xref rid="B31" ref-type="bibr">2012</xref>, <xref rid="B33" ref-type="bibr">2018</xref>): (1) CNS precursors (pCNSs) differentiating into neurons and glia cells; (2) glia cells differentiating into astrocytes and oligodendrocytes (ODCs). <xref ref-type="fig" rid="F2">Figures 2B–D</xref> show the reconstructed lineage progressions produced by MONOCLE 2, PAGA, and CALISTA, respectively. PAGA produced the most inaccurate lineage, deviating significantly from the expected lineage (<xref ref-type="fig" rid="F2">Figure 2C</xref> vs. <xref ref-type="fig" rid="F2">Figure 2A</xref>). MONOCLE 2 performed better than PAGA, producing a lineage progression that is in general agreement with the <italic>in silico</italic> lineage graph. But, looking at MONOCLE 2's lineage more carefully, the method identified many more bifurcation or branching points than expected (13 vs. 2). CALISTA outperformed both MONOCLE 2 and PAGA, generating a lineage progression that agrees very well with the <italic>in silico</italic> lineage.</p>
      <fig id="F2" position="float">
        <label>Figure 2</label>
        <caption>
          <p>Performance comparison of CALISTA, MONOCLE 2 and SCANPY (PAGA and DPT) using <italic>in silico</italic> single-cell gene expression data of cell differentiation in the central nervous system (CNS). <bold>(A)</bold> Single-cell gene expression data of CNS differentiation simulated using a model proposed by Qiu et al. show two branching/bifurcation points (Qiu et al., <xref rid="B31" ref-type="bibr">2012</xref>): (1) Progenitor CNSs forming neurons and glia cells; (2) Glia cells forming astrocytes and oligodendrocytes (ODCs). <bold>(B–D)</bold> Reconstructed lineage progression by MONOCLE 2, PAGA (via SCANPY) and CALISTA, respectively. DDRTree: discriminative dimensionality reduction via learning tree (Mao et al., <xref rid="B24" ref-type="bibr">2015</xref>), FA, ForceAtlas2 (Hua et al., <xref rid="B15" ref-type="bibr">2018</xref>), PC: principal component. <bold>(E–G)</bold> Pseudotemporal ordering of cells by MONOCLE 2, DPT, and CALISTA, respectively.</p>
        </caption>
        <graphic xlink:href="fbioe-08-00018-g0002"/>
      </fig>
      <p><xref ref-type="fig" rid="F2">Figures 2E,F</xref> depict the pseudotemporal cell ordering for the simulated CNS single-cell expression produced by MONOCLE2, DPT, and CALISTA, respectively. Besides visual comparisons of the pseudotemporal ordering, we also computed the correlations between the pseudotimes from each of the methods and the <italic>in silico</italic> times of the cells, i.e., the simulation times at which the single-cell mRNA data were sampled (see <xref ref-type="supplementary-material" rid="SM2">Supplementary Table S2</xref>). Among the three algorithms compared, CALISTA's pseudotimes have the highest correlation with the <italic>in silico</italic> cell times (correlation ρ of 0.856), followed by DPT (ρ = <italic>0.769</italic>) and lastly MONOCLE 2 (ρ = 0.571). The cell orderings in <xref ref-type="fig" rid="F2">Figures 2E–G</xref> further confirm the advantage of CALISTA over the other methods.</p>
      <p>We further evaluated CALISTA's performance using four single-cell gene transcriptional datasets from cell differentiation systems with a variety of lineage topologies, including Bargaje et al. study on the differentiation of human induced pluripotent stem cells (iPSC) into cardiomyocytes (Bargaje et al., <xref rid="B2" ref-type="bibr">2017</xref>), Chu et al. study on the differentiation of human embryonic stem cells (hESC) into endodermal cells (Chu et al., <xref rid="B7" ref-type="bibr">2016</xref>), Moignard et al. study on hematopoietic stem cell (HSC) differentiation (Moignard et al., <xref rid="B26" ref-type="bibr">2013</xref>), and Treutlein et al. study on mouse embryonic fibroblast (mEF) differentiation into neurons (Treutlein et al., <xref rid="B45" ref-type="bibr">2016</xref>). We again compared CALISTA with the same single-cell analyses as in the <italic>in silico</italic> case study above. <xref ref-type="fig" rid="F3">Figures 3</xref> summarizes the reconstructed lineage progression of the cell differentiation using MONOCLE 2, PAGA, and CALISTA. The cell differentiation in these cell systems follows the lineage progression drawn in <xref ref-type="fig" rid="F4">Figure 4A</xref>. As in the <italic>in silico</italic> case study above, CALISTA generated the most accurate lineage progressions, followed by MONOCLE 2 and lastly PAGA. <xref ref-type="fig" rid="F4">Figures 4B–D</xref> show the pseudotemporal ordering of cells produced by MONOCLE 2, DPT, and CALISTA, respectively. In assessing the accuracy of the pseudotimes, we relied on the known lineage progression and cell capture times, since the true cell differentiation times are not known in these datasets. All three methods performed equally well for the HSC differentiation dataset by Moignard et al. (<xref rid="B26" ref-type="bibr">2013</xref>). For iPSC dataset (Bargaje et al., <xref rid="B2" ref-type="bibr">2017</xref>), CALISTA gave the most accurate pseudotimes, while MONOCLE2 and DPT had difficulties in assigning pseudotimes for one of the final cell type due to the close similarity of the gene expression with the progenitor iPSCs (see next section for more detail). For mEF dataset (Treutlein et al., <xref rid="B45" ref-type="bibr">2016</xref>), CALISTA produced pseudotimes that are most consistent with the known lineage and capture times, followed by DPT and then MONOCLE 2. Finally, for hESC dataset (Chu et al., <xref rid="B7" ref-type="bibr">2016</xref>), CALISTA again outperformed DPT and MONOCLE2, but here MONOCLE 2 performed better than DPT. In summary, for both simulated and real life single-cell gene expression datasets, CALISTA is able to reconstruct lineage progression and single-cell pseudotimes much better than widely-used single-cell gene expression analyses.</p>
      <fig id="F3" position="float">
        <label>Figure 3</label>
        <caption>
          <p>Comparison of lineage progressions reconstructed from single-cell transcriptional profiles by MONOCLE 2, PAGA, and CALISTA. (Top row) Induced pluripotent stem cell (iPSC) differentiation into cardiomyocytes in Bargaje et al. study (Bargaje et al., <xref rid="B2" ref-type="bibr">2017</xref>). (Second row) Human embryonic stem cell differentiation into endodermal cells in Chu et al. study (Chu et al., <xref rid="B7" ref-type="bibr">2016</xref>). (Third row) Hematopoietic stem cell differentiation in Moignard et al. study (Moignard et al., <xref rid="B26" ref-type="bibr">2013</xref>). (Bottom row) Mouse embryonic fibroblast differentiation into neurons in Treutlein et al. study (Treutlein et al., <xref rid="B45" ref-type="bibr">2016</xref>). <bold>(A)</bold> MONOCLE 2. <bold>(B)</bold> PAGA. <bold>(C)</bold> CALISTA. DDRTree: discriminative dimensionality reduction via learning tree (Mao et al., <xref rid="B24" ref-type="bibr">2015</xref>), FA, ForceAtlas2 (Hua et al., <xref rid="B15" ref-type="bibr">2018</xref>), PC: principal component. The colors indicate the cell sampling times.</p>
        </caption>
        <graphic xlink:href="fbioe-08-00018-g0003"/>
      </fig>
      <fig id="F4" position="float">
        <label>Figure 4</label>
        <caption>
          <p>Comparison of pseudotemporal cell ordering using single-cell transcriptional profiles by MONOCLE 2, DPT, and CALISTA. (Top row) Induced pluripotent stem cell (iPSC) differentiation into cardiomyocytes in Bargaje et al. study (Bargaje et al., <xref rid="B2" ref-type="bibr">2017</xref>). (Second row) Human embryonic stem cell differentiation into endodermal cells in Chu et al. study (Chu et al., <xref rid="B7" ref-type="bibr">2016</xref>). (Third row) Hematopoietic stem cell differentiation in Moignard et al. study (Moignard et al., <xref rid="B26" ref-type="bibr">2013</xref>). (Bottom row) Mouse embryonic fibroblast differentiation into neurons in Treutlein et al. study (Treutlein et al., <xref rid="B45" ref-type="bibr">2016</xref>). <bold>(A)</bold> Single-cell gene expression data. Pseudotemporal cell ordering from <bold>(B)</bold> MONOCLE 2, <bold>(C)</bold> DPT, and <bold>(D)</bold> CALISTA. PC: principal component. The colors in the first column indicate the cell sampling times, and those in the <bold>(B–D)</bold> indicate the pseudotimes.</p>
        </caption>
        <graphic xlink:href="fbioe-08-00018-g0004"/>
      </fig>
    </sec>
    <sec>
      <title>Application to the Differentiation of Induced Pluripotent Stem Cells to Cardiomyocytes</title>
      <p>In the following, we demonstrated an end-to-end analysis of single-cell gene expression data using CALISTA. Here, we used the single-cell gene expression dataset from the differentiation of human iPSCs into cardiomyocytes in Bargaje et al. study (Bargaje et al., <xref rid="B2" ref-type="bibr">2017</xref>). The dataset includes single-cell expression of 96 genes measured by RT-qPCR for 1896 cells collected across 8 time points (day 0, 1, 1.5, 2, 2.5, 3, 4, 5) after induction to differentiate. <xref ref-type="fig" rid="F5">Figure 5A</xref> shows the developmental states identified in the original study: epiblast cells (E) in the early stage (day 0, 1, 1.5), primitive streak (PS)-like progenitor cells in the intermediate stage (day 2, 2.5), and a lineage bifurcation into either the desired mesodermal (M) or undesired endodermal (En) cell fate in the late stage (day 3, 4, 5).</p>
      <fig id="F5" position="float">
        <label>Figure 5</label>
        <caption>
          <p>End-to-end analysis of single-cell transcriptional profiles during iPSC differentiation into cardiomyocytes. The single-cell gene expression dataset was taken from the study of Bargaje et al. (<xref rid="B2" ref-type="bibr">2017</xref>). <bold>(A,B)</bold> PCA plots of single-cell dataset along the first two principal components. Each dot represents a cell, where the colors indicate <bold>(A)</bold> the capture time info and <bold>(B)</bold> CALISTA single-cell clusters. <bold>(C)</bold> Lineage progression graph reconstructed by CALISTA. The graph was generated by adding transition edges in increasing order of cluster distances until each cluster is connected by an edge. Following this procedure, an edge connecting cluster 1 and 5 was originally added in the graph. We manually removed this edge as the edge bypassed intermediate capture times. <bold>(D)</bold> Pseudotemporal ordering of cells. Cells were first assigned to the state transition edges in the lineage progression, and then pseudotemporally ordered along two developmental paths—mesodermal (M) path (red) and endodermal (En) path (green). <bold>(E)</bold> Cell likelihood landscape. The landscape shows the surface of the negative log-likelihood of the cells. A higher value thus indicates a state of increased gene expression uncertainty. <bold>(F–H)</bold> Moving window average of gene expression along M and En developmental paths for representative <bold>(G)</bold> PS, <bold>(H)</bold> M, and <bold>(I)</bold> En genes (underlined and boldfaced). <bold>(I)</bold> Gene modules of M (red and gray) and En paths (green and gray) [drawn using Cytoscape (Smoot et al., <xref rid="B39" ref-type="bibr">2011</xref>)]. The gray nodes and edges are common between the M and En modules. Solid (dashed) lines indicate positive (negative) gene correlations.</p>
        </caption>
        <graphic xlink:href="fbioe-08-00018-g0005"/>
      </fig>
      <p>First, we clustered the cells by using CALISTA. The optimal number of clusters was chosen to be five based on the eigengap plot (see <xref ref-type="supplementary-material" rid="SM6">Supplementary Figure S1</xref>). The single-cell clustering of CALISTA, as shown in <xref ref-type="fig" rid="F5">Figure 5B</xref>, recapitulates the previously identified developmental states. Here, clusters 1, 2, and 5 contain mostly E, PS, and En cells, respectively, while M cells are split between clusters 3 and 4 that are demarcated by different capture times (see cluster compositions in <xref ref-type="supplementary-material" rid="SM6">Supplementary Figure S2</xref>).</p>
      <p>After single-cell clustering, we employed CALISTA to infer the lineage progression graph. The cluster pseudotimes were set to the modes (most frequent values) of the cell capture times in the clusters divided by the maximum cell capture time (see <xref ref-type="supplementary-material" rid="SM6">Supplementary Figure S3</xref>). The directionality of the state transition edges was set according to the cluster pseudotimes, pointing from a cluster with a lower pseudotime to that with a higher pseudotime. As shown in <xref ref-type="fig" rid="F5">Figure 5C</xref>, the lineage progression graph reconstructed by CALISTA reproduces the lineage bifurcation event as the cells transition from PS-like cells to take on either M or En cell fates (Bargaje et al., <xref rid="B2" ref-type="bibr">2017</xref>). Subsequently, for each state transition edge, we identified the set of transition genes (see <xref ref-type="supplementary-material" rid="SM6">Supplementary Figure S4</xref>). Among the identified transition genes in the lineage progression graph (25 genes in total, see <xref ref-type="supplementary-material" rid="SM3">Supplementary Table S3</xref>), many are known lineage specific transcriptional regulators involved in the iPSC cell differentiation, such as EOMES, GATA4, GSC, HAND1, KIT, MESP1, SOX17, and T (T-Box transcription factor T) (Bargaje et al., <xref rid="B2" ref-type="bibr">2017</xref>).</p>
      <p>Finally, we employed CALISTA to generate the pseudotemporal ordering of cells along the two distinct developmental paths in the lineage progression: (1) the M path forming mesodermal cells (cluster 1–2–3–4; see red dashed path in <xref ref-type="fig" rid="F5">Figure 5D</xref>) and (2) the En path forming endodermal cells (cluster 1–2–5; see green dashed path in <xref ref-type="fig" rid="F5">Figure 5D</xref>). After assigning cells to the state transition edges and prescribing the cell pseudotimes, we ordered cells belonging to each developmental trajectory in increasing pseudotimes with a total of 1,408 cells in the M path and 1,215 cells in the En path.</p>
      <p>The likelihood value of each cell computed during the pseudotemporal cell ordering can further be visualized as a landscape plot. <xref ref-type="fig" rid="F5">Figure 5E</xref> depicts the negative log-likelihood surface of the cells over the first two principal components. A higher value on the surface indicates a cell state with broader mRNA distributions, i.e., a state of higher uncertainty in the gene expression. As shown in <xref ref-type="fig" rid="F5">Figure 5E</xref>, iPSC cells start their journey from a valley in this surface, implying that the progenitor cells are at a low uncertainty state. As the cell differentiation progresses, cells pass through an intermediate state with higher uncertainty, where a peak uncertainty is reached at or around the cell lineage bifurcation. After the bifurcation, cells follow two paths toward lower uncertainty, leading to two valleys corresponding to distinct cell fates (M and En fates). The rise-and-fall in gene expression uncertainty have also been reported in other cell differentiation systems, suggesting that stem cells go through a transition state of high uncertainty before committing to their final cell fate(s) (Richard et al., <xref rid="B37" ref-type="bibr">2016</xref>; Stumpf et al., <xref rid="B41" ref-type="bibr">2017</xref>).</p>
      <p>To visualize the gene expression trajectories along the two cell differentiation paths, we calculated the moving average expression values of transition genes for the pseudotemporally ordered cells using a moving window comprising 10% of the total cells in each path (see <xref ref-type="fig" rid="F5">Figures 5F–H</xref> and <xref ref-type="supplementary-material" rid="SM6">Supplementary Figure S5</xref>). A number of transition genes follow highly similar expression trajectories along the M and En paths, with an increase in expression from E to PS-like state, followed by a decrease in expression from PS-like to M or En state (see <xref ref-type="fig" rid="F5">Figure 5F</xref>). The majority of genes with the aforementioned trajectory are known PS-like markers [for example EOMES, GSC, MESP1, and MIXL1; (Ng et al., <xref rid="B27" ref-type="bibr">2005</xref>; Bargaje et al., <xref rid="B2" ref-type="bibr">2017</xref>; Tiyaboonchai et al., <xref rid="B43" ref-type="bibr">2017</xref>)], and thus, we refer to these genes as PS-genes (see <xref ref-type="supplementary-material" rid="SM3">Supplementary Table S3</xref>). Another group of transition genes show differential profiles between the M and En paths after the lineage bifurcation. Here, we define M-genes as the genes with higher expressions along the M path than the En path (see <xref ref-type="fig" rid="F5">Figure 5G</xref>). Correspondingly, we define En-genes as genes with higher expressions along the En path than the M path (see <xref ref-type="fig" rid="F5">Figure 5H</xref>). Notably, many of the known M marker genes [e.g., BMP4, HAND1, MYL4 and TNNT2; (Jagtap et al., <xref rid="B17" ref-type="bibr">2011</xref>; Bargaje et al., <xref rid="B2" ref-type="bibr">2017</xref>)] are among the M-genes, and several of the known En marker genes [e.g., HNFA4, KIT, and SOX17; (Thomas et al., <xref rid="B42" ref-type="bibr">2006</xref>; Ng et al., <xref rid="B28" ref-type="bibr">2010</xref>; Bargaje et al., <xref rid="B2" ref-type="bibr">2017</xref>)] are among the En-genes (see <xref ref-type="supplementary-material" rid="SM3">Supplementary Table S3</xref>). In general, after the lineage bifurcation, the expressions of M genes increase along the M path, but are either suppressed (BMP4, HAND1, KDR) or unchanged (MYL4, TGFB2, TNNT2) along the En path. Among the known En markers, the expression of HNFA4 increases along the En path after the lineage bifurcation but remains relatively unchanged along the M path. The expression of KIT follows the opposite profile, where the gene expression is downregulated along the M path and is relatively unchanged along the En path. While the expression of SOX17, like KIT, decreases along the M path, the gene is upregulated along the En path immediately after the lineage bifurcation before being downregulated toward the end of the developmental trajectory.</p>
      <p>Finally, we constructed gene co-expression networks for the M and En developmental paths based on the pseudotemporal profiles of the gene expression (pairwise Pearson correlation, <italic>p</italic> ≤ 0.01 and correlation value ≥ 0.8, see <xref ref-type="supplementary-material" rid="SM6">Supplementary Figure S6</xref>). We identified cliques in the M and En gene co-expression networks, i.e., a subset of genes (at least 5) that are connected to each other, using a maximal clique analysis by the Bron-Kerbosch algorithm (Bron and Kerbosch, <xref rid="B4" ref-type="bibr">1973</xref>). <xref ref-type="fig" rid="F5">Figure 5I</xref> depicts the cliques from the M and En gene co-expression networks, showing three gene regulatory modules: one module specific to the M path (red), another specific to the En path (green), and a shared module (gray). Most of the PS genes, including known PS marker genes, belong to the shared module as expected. Among the genes in the shared module, DKK1, FZD1, and T are involved in Wnt signaling pathway, which is known to promote cell differentiation (Davidson et al., <xref rid="B8" ref-type="bibr">2012</xref>). GATA6, which plays an important role in the endoderm commitment (Tiyaboonchai et al., <xref rid="B43" ref-type="bibr">2017</xref>), belongs to the En module. On the other hand, the M module shows activating relationships among mesoderm gene markers (e.g., BMP4, MYL4, and HAND1), and antagonistic relationships between several M genes and KIT, an En gene marker.</p>
    </sec>
    <sec>
      <title>Application of CALISTA to Massively Parallel Drop-Seq Datasets</title>
      <p>To demonstrate the scalability of CALISTA, we analyzed single-cell expression datasets from droplet-based assays. Single-cell Drop-seq is a massively parallel genome-wide expression profiling technology capable of analyzing thousands of cells in a single experiment. However, the bioinformatic analysis of large single-cell transcriptomics datasets poses a significant computational challenge (Angerer et al., <xref rid="B1" ref-type="bibr">2017</xref>). To address this challenge, CALISTA offers a parallelization option for handling large datasets by splitting the greedy optimization runs among multiple computing cores (see <xref ref-type="supplementary-material" rid="SM6">Supplementary Note S2</xref> for more details on CALISTA implementation).</p>
      <p>We first tested the single-cell clustering performance of CALISTA in analyzing Drop-seq datasets using the single-cell study of mouse spinal cord neurons by Sathyamurthy et al. (<xref rid="B38" ref-type="bibr">2018</xref>) (~18 K nuclei) and the study of peripherical blood mononuclear cells by Zheng et al. (<xref rid="B50" ref-type="bibr">2017</xref>) (~68 K cells). We noted that <italic>k-</italic>medoid clustering for large consensus matrices is computationally prohibitive. Thus, we bypassed the consensus clustering and took among the independent runs of the greedy algorithm, the cell clustering corresponding to the highest likelihood value. For Sathyamurthy et al. dataset, CALISTA clustering identified nine single-cell clusters based on the eigengap plot, which agrees well with the original study [by comparing <xref ref-type="supplementary-material" rid="SM6">Supplementary Figure S7</xref> with <xref ref-type="fig" rid="F1">Figure 1D</xref> in the original publication; (Sathyamurthy et al., <xref rid="B38" ref-type="bibr">2018</xref>)]. For the largest cluster (52% of total data) containing neurons, CALISTA further split the cells into two subpopulations—one comprising cells with high expressions of Snap25, Syp, and Rbiox3, and the other comprising cells with medium expression of these genes. Notably, CALISTA was able to distinguish clearly Schwann and Meningeal cells, which in the original study [using SC3; (Kiselev et al., <xref rid="B20" ref-type="bibr">2017</xref>)], were placed into the same cluster (Sathyamurthy et al., <xref rid="B38" ref-type="bibr">2018</xref>). Meanwhile, for Zheng et al. scDrop-seq dataset, CALISTA generated cell clusters that show a general agreement with the original study (see <xref ref-type="supplementary-material" rid="SM6">Supplementary Figure S8</xref>).</p>
      <p>We then tested CALISTA's lineage progression reconstruction on scDrop-seq data of ~38K cells, taken from 12 developmental stages of zebrafish embryogenesis (Farrell et al., <xref rid="B11" ref-type="bibr">2018</xref>). The results of CALISTA are summarized in <xref ref-type="fig" rid="F6">Figure 6</xref>. For this large dataset, we employed a modified clustering procedure (see <xref ref-type="supplementary-material" rid="SM6">Supplementary Note S2</xref>) and identified 82 clusters, 23 of which comprise cells at the final developmental stage. <xref ref-type="fig" rid="F6">Figure 6A</xref> depicts the reconstructed lineage progression by CALISTA (see also <xref ref-type="supplementary-material" rid="SM5">Supplementary Video 1</xref>), while <xref ref-type="fig" rid="F6">Figure 6B</xref> shows the cell type labels for the cell clusters at the final developmental stage based on the expression levels of 26 key gene markers (see <xref ref-type="supplementary-material" rid="SM6">Supplementary Figure S9</xref>). The results are again in good agreement with the known cell types (Farrell et al., <xref rid="B11" ref-type="bibr">2018</xref>).</p>
      <fig id="F6" position="float">
        <label>Figure 6</label>
        <caption>
          <p>Analysis of single-cell Drop-seq gene expression data of zebrafish embryogenesis (Farrell et al., <xref rid="B11" ref-type="bibr">2018</xref>). <bold>(A)</bold> Reconstruction of lineage progression and pseudotimes calculation of cells (see also <xref ref-type="supplementary-material" rid="SM5">Supplementary Video 1</xref>). <bold>(B)</bold> Cell types at the final developmental stage.</p>
        </caption>
        <graphic xlink:href="fbioe-08-00018-g0006"/>
      </fig>
    </sec>
  </sec>
  <sec sec-type="discussion" id="s3">
    <title>Discussion</title>
    <p>CALISTA provides four bioinformatic analyses for single-cell expression data that are essential in studies of stem cell differentiation. The analyses can be implemented either sequentially in a data analytics pipeline or separately in a standalone application. Throughout the development of the analyses in CALISTA, we used the same likelihood approach based on the two-state stochastic gene transcriptional model. Thus, the analyses are fully compatible with each other. The use of a mechanistic model in CALISTA brings an additional advantage, because the model parameters have relevance to the mechanism of gene transcription process and thus can provide insights into the gene regulations during stem cell differentiation. To the best of our knowledge, CALISTA is the first mechanistic model-based toolbox that allows an end-to-end analysis of single-cell transcriptional profiles. Despite the focus on stem cells in our work, each of the tools in CALISTA is agnostic to the source of the single-cell transcriptomic data analysis and thus can be used for other studies.</p>
    <p>CALISTA's single-cell clustering analysis is an adaptation of another method called SABEC (Ezer et al., <xref rid="B10" ref-type="bibr">2016</xref>), with a significant improvement in computational efficiency, thanks to the implementation of greedy algorithm. This improvement is critical and necessary for the analysis of extremely large single-cell datasets with tens to hundreds of thousands of cells, which will become more common in the near future. In addition to computational efficiency, CALISTA is able to account for random technical dropout events, a feature that is missing from SABEC. With the exception of the single-cell clustering analysis, CALISTA includes novel algorithms for transition gene identification, lineage progression inference and pseudotime calculations. As demonstrated in numerous case studies above, when compared to popular single-cell analysis methods for lineage inference and pseudotemporal cell ordering, including MONOCLE 2, PAGA, and DPT, CALISTA performed better than these methods.</p>
    <p>30696980example in setting the number of cell clusters or during the curation of the lineage progression graph (see CALISTA tutorials on <ext-link ext-link-type="uri" xlink:href="https://www.cabselab.com/calista">https://www.cabselab.com/calista</ext-link>). The user interface enables incorporating existing biological knowledge of the cell differentiation system, which is often difficult—if not impossible—to codify. Although such prior knowledge is not necessary for using CALISTA, the ability to incorporate this knowledge, whenever available, is a useful and important feature in the analysis of single-cell transcriptional profiles.</p>
    <p>Obviously, the transcriptome only provides one aspect of the cell phenotype. Besides single-cell transcriptomic profiling, single-cell sequencing technology have enabled other types of molecular profiling at the single cell level, such as the genome and epigenome. Integrating gene expression with other single-cell profiling data is an area of active interest for algorithmic development (Stuart and Satija, <xref rid="B40" ref-type="bibr">2019</xref>). A few notable examples of recent algorithms include those for the integration of scRNA-seq data and single-cell data of DNA accessibility from ATAC-seq (Duren et al., <xref rid="B9" ref-type="bibr">2018</xref>; Zeng et al., <xref rid="B49" ref-type="bibr">2019</xref>).</p>
  </sec>
  <sec sec-type="methods" id="s4">
    <title>Methods</title>
    <sec>
      <title>Input Data and Data Preprocessing</title>
      <p>The single-cell gene expression matrix should be formatted into a <italic>N</italic> × <italic>G</italic> matrix, where <italic>G</italic> denotes the number of genes, <italic>N</italic> denotes the number of cells, and the matrix element <italic>m</italic><sub><italic>n,g</italic></sub> is the transcriptional expression value of gene <italic>g</italic> in the <italic>n</italic>-th cell. CALISTA accepts expression values from RT-qPCR (<inline-formula><mml:math id="M1"><mml:msup><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:math></inline-formula> value) and scRNA-Seq including both plate-based [e.g., log(RPKM) or log(TPM)] and droplet-based measurements (e.g., gene UMI counts). For UMI data from scDrop-seq, CALISTA further scales the expression matrix by dividing each gene UMI count with the total UMI count in the corresponding cell and then multiplying the value with the median of the total UMI counts among cells (Zheng et al., <xref rid="B50" ref-type="bibr">2017</xref>).</p>
      <p>Before performing single-cell analysis, we first preprocess the single-cell expression matrix by removing the genes and cells (i.e., columns and rows of the expression matrix, respectively) with a large fraction of zero expression values, exceeding a user-defined threshold (default threshold: 100% for genes and 100% for cells). For scRNA-seq datasets, CALISTA further selects a number of informative genes <italic>Y</italic> for the single-cell analysis following a previously described procedure (Macosko et al., <xref rid="B23" ref-type="bibr">2015</xref>), with <italic>Y</italic> is to the minimum among the following: 200, the number of genes <italic>G</italic>, and a user-defined percentage of the number of cells <italic>N</italic>.</p>
      <p>Next, CALISTA scales the single-cell expression values such that the maximum value of any gene is 200. The scaling is carried out as follows:</p>
      <disp-formula id="E1">
        <label>(1)</label>
        <mml:math id="M2">
          <mml:mtable class="eqnarray" columnalign="left">
            <mml:mtr>
              <mml:mtd>
                <mml:msub>
                  <mml:mrow>
                    <mml:mover accent="false">
                      <mml:mrow>
                        <mml:mi>m</mml:mi>
                      </mml:mrow>
                      <mml:mo>^</mml:mo>
                    </mml:mover>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>n</mml:mi>
                    <mml:mo>,</mml:mo>
                    <mml:mi>g</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>=</mml:mo>
                <mml:msup>
                  <mml:mrow>
                    <mml:mn>2</mml:mn>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mfrac>
                      <mml:mrow>
                        <mml:mi>l</mml:mi>
                        <mml:mi>o</mml:mi>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>g</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mn>2</mml:mn>
                          </mml:mrow>
                        </mml:msub>
                        <mml:mrow>
                          <mml:mo stretchy="false">(</mml:mo>
                          <mml:mrow>
                            <mml:msub>
                              <mml:mrow>
                                <mml:mi>m</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mi>n</mml:mi>
                                <mml:mo>,</mml:mo>
                                <mml:mi>g</mml:mi>
                              </mml:mrow>
                            </mml:msub>
                            <mml:mo>+</mml:mo>
                            <mml:mn>1</mml:mn>
                          </mml:mrow>
                          <mml:mo stretchy="false">)</mml:mo>
                        </mml:mrow>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>l</mml:mi>
                        <mml:mi>o</mml:mi>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>g</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mn>2</mml:mn>
                          </mml:mrow>
                        </mml:msub>
                        <mml:mrow>
                          <mml:mo stretchy="false">(</mml:mo>
                          <mml:mrow>
                            <mml:msub>
                              <mml:mrow>
                                <mml:mi>m</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mi>m</mml:mi>
                                <mml:mi>a</mml:mi>
                                <mml:mi>x</mml:mi>
                                <mml:mo>,</mml:mo>
                                <mml:mi>g</mml:mi>
                              </mml:mrow>
                            </mml:msub>
                          </mml:mrow>
                          <mml:mo stretchy="false">)</mml:mo>
                        </mml:mrow>
                      </mml:mrow>
                    </mml:mfrac>
                    <mml:mi>l</mml:mi>
                    <mml:mi>o</mml:mi>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>g</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mn>2</mml:mn>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mrow>
                      <mml:mo stretchy="false">(</mml:mo>
                      <mml:mrow>
                        <mml:mn>200</mml:mn>
                      </mml:mrow>
                      <mml:mo stretchy="false">)</mml:mo>
                    </mml:mrow>
                  </mml:mrow>
                </mml:msup>
              </mml:mtd>
            </mml:mtr>
          </mml:mtable>
        </mml:math>
      </disp-formula>
      <p>where <italic>m</italic><sub><italic>n,g</italic></sub> and <inline-formula><mml:math id="M3"><mml:msub><mml:mrow><mml:mover accent="false"><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> represent the original and scaled expression value of gene <italic>g</italic> in the <italic>n</italic>-th cell respectively, and <italic>m</italic><sub><italic>max,g</italic></sub> is the maximum expression value in gene <italic>g</italic> (i.e., the maximum of <italic>m</italic><sub><italic>n,g</italic></sub> over all cells). The scaling above allows CALISTA to use a pre-computed table for the maximum likelihood in the clustering analysis, thereby reducing the computational cost significantly. We tested using <italic>in silico</italic> single-cell gene expression datasets generated using the two-state gene transcriptional model, and confirmed that the scaling does not affect the clustering accuracy (see <xref ref-type="supplementary-material" rid="SM6">Supplementary Note S3</xref>). After scaling, for scDrop-Seq data, we re-rank the top <italic>Y</italic> genes in increasing value of the gene-wise likelihood <italic>v</italic><sup><italic>g</italic></sup> computed following Equation (10) below, with the random dropout model in Equation (4) incorporated in the calculation of likelihood. A lower gene-wise likelihood value indicates a broader distribution of single-cell expression. Genes with likelihood values exceeding a given threshold (by default set at the elbow of the curve of likelihood vs. gene rank) is removed from further analysis.</p>
    </sec>
    <sec>
      <title>Stochastic Two-State Gene Transcriptional Model</title>
      <p>For describing the mRNA distribution of a gene, CALISTA relies on the two-state model developed by Peccoud and Ycart (<xref rid="B29" ref-type="bibr">1995</xref>). The model characterizes the stochastic bursty gene transcriptional process at the single-cell level. More specifically, the model describes a promoter that switches stochastically between an OFF (inactive or non-permissive) state, where the gene transcription cannot start, and an ON (active or permissive) state, where the gene transcription can proceed. The set of reactions describing the stochastic gene transcription in the two-state model are as follows:</p>
      <disp-formula id="E2">
        <mml:math id="M4">
          <mml:mtable columnalign="left">
            <mml:mtr>
              <mml:mtd>
                <mml:mtext>              </mml:mtext>
                <mml:mi>O</mml:mi>
                <mml:mi>F</mml:mi>
                <mml:mi>F</mml:mi>
                <mml:mtext> </mml:mtext>
                <mml:mover>
                  <mml:mo>→</mml:mo>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mi>θ</mml:mi>
                      <mml:mrow>
                        <mml:mi>o</mml:mi>
                        <mml:mi>n</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                  </mml:mrow>
                </mml:mover>
                <mml:mi>O</mml:mi>
                <mml:mi>N</mml:mi>
              </mml:mtd>
            </mml:mtr>
            <mml:mtr>
              <mml:mtd>
                <mml:mtext>            </mml:mtext>
                <mml:mi>O</mml:mi>
                <mml:mi>N</mml:mi>
                <mml:mtext> </mml:mtext>
                <mml:mover>
                  <mml:mo>→</mml:mo>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mi>θ</mml:mi>
                      <mml:mrow>
                        <mml:mi>o</mml:mi>
                        <mml:mi>f</mml:mi>
                        <mml:mi>f</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                  </mml:mrow>
                </mml:mover>
                <mml:mtext> </mml:mtext>
                <mml:mi>O</mml:mi>
                <mml:mi>F</mml:mi>
                <mml:mi>F</mml:mi>
              </mml:mtd>
            </mml:mtr>
            <mml:mtr>
              <mml:mtd>
                <mml:mi>O</mml:mi>
                <mml:mi>N</mml:mi>
                <mml:mtext> </mml:mtext>
                <mml:mover>
                  <mml:mo>→</mml:mo>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mi>θ</mml:mi>
                      <mml:mi>t</mml:mi>
                    </mml:msub>
                  </mml:mrow>
                </mml:mover>
                <mml:mtext> </mml:mtext>
                <mml:mi>O</mml:mi>
                <mml:mi>N</mml:mi>
                <mml:mo>+</mml:mo>
                <mml:mi>m</mml:mi>
                <mml:mi>R</mml:mi>
                <mml:mi>N</mml:mi>
                <mml:mi>A</mml:mi>
              </mml:mtd>
            </mml:mtr>
            <mml:mtr>
              <mml:mtd>
                <mml:mtext>             </mml:mtext>
                <mml:mi>m</mml:mi>
                <mml:mi>R</mml:mi>
                <mml:mi>N</mml:mi>
                <mml:mi>A</mml:mi>
                <mml:mover>
                  <mml:mo>→</mml:mo>
                  <mml:mrow>
                    <mml:msubsup>
                      <mml:mi>θ</mml:mi>
                      <mml:mi>d</mml:mi>
                      <mml:mi>m</mml:mi>
                    </mml:msubsup>
                  </mml:mrow>
                </mml:mover>
                <mml:mtext> </mml:mtext>
                <mml:mo>⊘</mml:mo>
              </mml:mtd>
            </mml:mtr>
          </mml:mtable>
        </mml:math>
      </disp-formula>
      <p>where θ<sub><italic>on</italic></sub> is the rate of the promoter activation, θ<sub><italic>off</italic></sub> is the rate of the promoter inactivation, θ<sub><italic>t</italic></sub>is the rate of mRNA production when the promoter is active, θ<sub><italic>d</italic></sub> is the rate constant of mRNA degradation, and <italic>m</italic> denotes the number of mRNA molecules. At steady state, the probability distribution of mRNA count <italic>m</italic> can be approximated by the following density function (Raj et al., <xref rid="B34" ref-type="bibr">2006</xref>):</p>
      <disp-formula id="E3">
        <label>(2)</label>
        <mml:math id="M5">
          <mml:mtable columnalign="left">
            <mml:mtr>
              <mml:mtd>
                <mml:msub>
                  <mml:mi>P</mml:mi>
                  <mml:mn>2</mml:mn>
                </mml:msub>
                <mml:mrow>
                  <mml:mo>(</mml:mo>
                  <mml:mrow>
                    <mml:mi>m</mml:mi>
                    <mml:mo>;</mml:mo>
                    <mml:mtext> </mml:mtext>
                    <mml:msub>
                      <mml:mi>θ</mml:mi>
                      <mml:mrow>
                        <mml:mi>o</mml:mi>
                        <mml:mi>n</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo>,</mml:mo>
                    <mml:mtext> </mml:mtext>
                    <mml:msub>
                      <mml:mi>θ</mml:mi>
                      <mml:mrow>
                        <mml:mi>o</mml:mi>
                        <mml:mi>f</mml:mi>
                        <mml:mi>f</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo>,</mml:mo>
                    <mml:mtext> </mml:mtext>
                    <mml:msub>
                      <mml:mi>θ</mml:mi>
                      <mml:mi>t</mml:mi>
                    </mml:msub>
                  </mml:mrow>
                  <mml:mo>)</mml:mo>
                </mml:mrow>
              </mml:mtd>
            </mml:mtr>
            <mml:mtr>
              <mml:mtd>
                <mml:mo>=</mml:mo>
                <mml:mfrac>
                  <mml:mrow>
                    <mml:mo>Γ</mml:mo>
                    <mml:mrow>
                      <mml:mo>(</mml:mo>
                      <mml:mrow>
                        <mml:msub>
                          <mml:mi>θ</mml:mi>
                          <mml:mrow>
                            <mml:mi>o</mml:mi>
                            <mml:mi>n</mml:mi>
                          </mml:mrow>
                        </mml:msub>
                        <mml:mo>+</mml:mo>
                        <mml:mi>m</mml:mi>
                      </mml:mrow>
                      <mml:mo>)</mml:mo>
                    </mml:mrow>
                    <mml:mo>Γ</mml:mo>
                    <mml:mrow>
                      <mml:mo>(</mml:mo>
                      <mml:mrow>
                        <mml:msub>
                          <mml:mi>θ</mml:mi>
                          <mml:mrow>
                            <mml:mi>o</mml:mi>
                            <mml:mi>n</mml:mi>
                          </mml:mrow>
                        </mml:msub>
                        <mml:mo>+</mml:mo>
                        <mml:msub>
                          <mml:mi>θ</mml:mi>
                          <mml:mrow>
                            <mml:mi>o</mml:mi>
                            <mml:mi>f</mml:mi>
                            <mml:mi>f</mml:mi>
                          </mml:mrow>
                        </mml:msub>
                      </mml:mrow>
                      <mml:mo>)</mml:mo>
                    </mml:mrow>
                    <mml:msubsup>
                      <mml:mi>θ</mml:mi>
                      <mml:mi>t</mml:mi>
                      <mml:mi>m</mml:mi>
                    </mml:msubsup>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mo>Γ</mml:mo>
                    <mml:mrow>
                      <mml:mo>(</mml:mo>
                      <mml:mrow>
                        <mml:mi>m</mml:mi>
                        <mml:mo>+</mml:mo>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                      <mml:mo>)</mml:mo>
                    </mml:mrow>
                    <mml:mo>Γ</mml:mo>
                    <mml:mrow>
                      <mml:mo>(</mml:mo>
                      <mml:mrow>
                        <mml:msub>
                          <mml:mi>θ</mml:mi>
                          <mml:mrow>
                            <mml:mi>o</mml:mi>
                            <mml:mi>n</mml:mi>
                          </mml:mrow>
                        </mml:msub>
                        <mml:mo>+</mml:mo>
                        <mml:msub>
                          <mml:mi>θ</mml:mi>
                          <mml:mrow>
                            <mml:mi>o</mml:mi>
                            <mml:mi>f</mml:mi>
                            <mml:mi>f</mml:mi>
                          </mml:mrow>
                        </mml:msub>
                        <mml:mo>+</mml:mo>
                        <mml:mi>m</mml:mi>
                      </mml:mrow>
                      <mml:mo>)</mml:mo>
                    </mml:mrow>
                    <mml:mo>Γ</mml:mo>
                    <mml:mrow>
                      <mml:mo>(</mml:mo>
                      <mml:mrow>
                        <mml:msub>
                          <mml:mi>θ</mml:mi>
                          <mml:mrow>
                            <mml:mi>o</mml:mi>
                            <mml:mi>n</mml:mi>
                          </mml:mrow>
                        </mml:msub>
                      </mml:mrow>
                      <mml:mo>)</mml:mo>
                    </mml:mrow>
                  </mml:mrow>
                </mml:mfrac>
                <mml:mtext> </mml:mtext>
                <mml:mmultiscripts>
                  <mml:mi>F</mml:mi>
                  <mml:mprescripts/>
                  <mml:mn>1</mml:mn>
                  <mml:none/>
                </mml:mmultiscripts>
                <mml:msub>
                  <mml:mrow>
                    <mml:mtext> </mml:mtext>
                  </mml:mrow>
                  <mml:mn>1</mml:mn>
                </mml:msub>
                <mml:mrow>
                  <mml:mo>(</mml:mo>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mi>θ</mml:mi>
                      <mml:mrow>
                        <mml:mi>o</mml:mi>
                        <mml:mi>n</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                  </mml:mrow>
                </mml:mrow>
              </mml:mtd>
            </mml:mtr>
            <mml:mtr>
              <mml:mtd>
                <mml:mrow>
                  <mml:mrow>
                    <mml:mo>+</mml:mo>
                    <mml:mi>m</mml:mi>
                    <mml:mo>,</mml:mo>
                    <mml:mtext> </mml:mtext>
                    <mml:msub>
                      <mml:mi>θ</mml:mi>
                      <mml:mrow>
                        <mml:mi>o</mml:mi>
                        <mml:mi>n</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo>+</mml:mo>
                    <mml:msub>
                      <mml:mi>θ</mml:mi>
                      <mml:mrow>
                        <mml:mi>o</mml:mi>
                        <mml:mi>f</mml:mi>
                        <mml:mi>f</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo>+</mml:mo>
                    <mml:mi>m</mml:mi>
                    <mml:mo>,</mml:mo>
                    <mml:mtext> </mml:mtext>
                    <mml:mo>−</mml:mo>
                    <mml:msub>
                      <mml:mi>θ</mml:mi>
                      <mml:mi>t</mml:mi>
                    </mml:msub>
                  </mml:mrow>
                  <mml:mo>)</mml:mo>
                </mml:mrow>
              </mml:mtd>
            </mml:mtr>
          </mml:mtable>
        </mml:math>
      </disp-formula>
      <p>where <sub>1</sub><italic>F</italic><sub>1</sub> represents the confluent hypergeometric function of the first kind.</p>
    </sec>
    <sec>
      <title>Random Dropout Event Model</title>
      <p>If desired and when appropriate, users can account for random dropout events in CALISTA. The inclusion of random dropouts is particularly suitable when dealing with single-cell transcriptional profiles from Drop-Seq technology. In CALISTA, the dropout probability is modeled by a negative exponential function with an optimal decay constant of λ, as follows:</p>
      <disp-formula id="E4">
        <label>(3)</label>
        <mml:math id="M6">
          <mml:mtable class="eqnarray" columnalign="left">
            <mml:mtr>
              <mml:mtd>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>P</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>d</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mrow>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mrow>
                    <mml:mn>0</mml:mn>
                    <mml:mo>|</mml:mo>
                    <mml:mi>m</mml:mi>
                  </mml:mrow>
                  <mml:mo stretchy="false">)</mml:mo>
                </mml:mrow>
                <mml:mo>=</mml:mo>
                <mml:msup>
                  <mml:mrow>
                    <mml:mi>e</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mo>-</mml:mo>
                    <mml:mo>λ</mml:mo>
                    <mml:mi>m</mml:mi>
                  </mml:mrow>
                </mml:msup>
              </mml:mtd>
            </mml:mtr>
          </mml:mtable>
        </mml:math>
      </disp-formula>
      <p>where <italic>P</italic>(0|<italic>m</italic>) denotes the probability that the measured single-cell mRNA count is zero when the true number of mRNA molecules is <italic>m</italic>. A decay constant λ = 0 gives a dropout probability of 1, i.e., dropout occurs regardless of the true mRNA count. The parameter λ is estimated from the plot of the fraction of zeros against the mean expression across all measured genes, following the procedure described in Pierson et al. (Pierson and Yau, <xref rid="B30" ref-type="bibr">2015</xref>) (see examples in <xref ref-type="supplementary-material" rid="SM6">Supplementary Figure S10</xref>). Combining the dropout event model with the two-state gene transcription model above give the following distribution function of measured single-cell mRNA readouts <inline-formula><mml:math id="M7"><mml:mover accent="false"><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover><mml:mo>:</mml:mo></mml:math></inline-formula></p>
      <disp-formula id="E5">
        <label>(4)</label>
        <mml:math id="M8">
          <mml:mtable columnalign="left">
            <mml:mtr>
              <mml:mtd>
                <mml:mi>P</mml:mi>
                <mml:mrow>
                  <mml:mo>(</mml:mo>
                  <mml:mrow>
                    <mml:mover accent="true">
                      <mml:mi>m</mml:mi>
                      <mml:mo>^</mml:mo>
                    </mml:mover>
                    <mml:mo>;</mml:mo>
                    <mml:mtext> </mml:mtext>
                    <mml:msub>
                      <mml:mi>θ</mml:mi>
                      <mml:mrow>
                        <mml:mi>o</mml:mi>
                        <mml:mi>n</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo>,</mml:mo>
                    <mml:mtext> </mml:mtext>
                    <mml:msub>
                      <mml:mi>θ</mml:mi>
                      <mml:mrow>
                        <mml:mi>o</mml:mi>
                        <mml:mi>f</mml:mi>
                        <mml:mi>f</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo>,</mml:mo>
                    <mml:mtext> </mml:mtext>
                    <mml:msub>
                      <mml:mi>θ</mml:mi>
                      <mml:mi>t</mml:mi>
                    </mml:msub>
                  </mml:mrow>
                  <mml:mo>)</mml:mo>
                </mml:mrow>
              </mml:mtd>
            </mml:mtr>
            <mml:mtr>
              <mml:mtd>
                <mml:mo>=</mml:mo>
                <mml:mrow>
                  <mml:mo>{</mml:mo>
                  <mml:mrow>
                    <mml:mtable>
                      <mml:mtr>
                        <mml:mtd>
                          <mml:mrow>
                            <mml:mstyle displaystyle="true">
                              <mml:msub>
                                <mml:mo>∑</mml:mo>
                                <mml:mi>m</mml:mi>
                              </mml:msub>
                              <mml:mrow>
                                <mml:msub>
                                  <mml:mi>P</mml:mi>
                                  <mml:mi>d</mml:mi>
                                </mml:msub>
                                <mml:mrow>
                                  <mml:mo>(</mml:mo>
                                  <mml:mrow>
                                    <mml:mn>0</mml:mn>
                                    <mml:mo>|</mml:mo>
                                    <mml:mi>m</mml:mi>
                                  </mml:mrow>
                                  <mml:mo>)</mml:mo>
                                </mml:mrow>
                                <mml:msub>
                                  <mml:mi>P</mml:mi>
                                  <mml:mn>2</mml:mn>
                                </mml:msub>
                                <mml:mrow>
                                  <mml:mo>(</mml:mo>
                                  <mml:mrow>
                                    <mml:mi>m</mml:mi>
                                    <mml:mo>;</mml:mo>
                                    <mml:mtext> </mml:mtext>
                                    <mml:msub>
                                      <mml:mi>θ</mml:mi>
                                      <mml:mrow>
                                        <mml:mi>o</mml:mi>
                                        <mml:mi>n</mml:mi>
                                      </mml:mrow>
                                    </mml:msub>
                                    <mml:mo>,</mml:mo>
                                    <mml:mtext> </mml:mtext>
                                    <mml:msub>
                                      <mml:mi>θ</mml:mi>
                                      <mml:mrow>
                                        <mml:mi>o</mml:mi>
                                        <mml:mi>f</mml:mi>
                                        <mml:mi>f</mml:mi>
                                      </mml:mrow>
                                    </mml:msub>
                                    <mml:mo>,</mml:mo>
                                    <mml:mtext> </mml:mtext>
                                    <mml:msub>
                                      <mml:mi>θ</mml:mi>
                                      <mml:mi>t</mml:mi>
                                    </mml:msub>
                                  </mml:mrow>
                                  <mml:mo>)</mml:mo>
                                </mml:mrow>
                                <mml:mtext>      </mml:mtext>
                                <mml:mi>f</mml:mi>
                                <mml:mi>o</mml:mi>
                                <mml:mi>r</mml:mi>
                                <mml:mtext> </mml:mtext>
                                <mml:mover accent="true">
                                  <mml:mi>m</mml:mi>
                                  <mml:mo>^</mml:mo>
                                </mml:mover>
                                <mml:mo>=</mml:mo>
                                <mml:mn>0</mml:mn>
                                <mml:mtext> </mml:mtext>
                              </mml:mrow>
                            </mml:mstyle>
                          </mml:mrow>
                        </mml:mtd>
                      </mml:mtr>
                      <mml:mtr>
                        <mml:mtd>
                          <mml:mrow>
                            <mml:mrow>
                              <mml:mo>(</mml:mo>
                              <mml:mrow>
                                <mml:mn>1</mml:mn>
                                <mml:mo>−</mml:mo>
                                <mml:msup>
                                  <mml:mi>e</mml:mi>
                                  <mml:mrow>
                                    <mml:mo>−</mml:mo>
                                    <mml:mo>λ</mml:mo>
                                    <mml:mover accent="true">
                                      <mml:mi>m</mml:mi>
                                      <mml:mo>^</mml:mo>
                                    </mml:mover>
                                  </mml:mrow>
                                </mml:msup>
                              </mml:mrow>
                              <mml:mo>)</mml:mo>
                            </mml:mrow>
                            <mml:msub>
                              <mml:mi>P</mml:mi>
                              <mml:mn>2</mml:mn>
                            </mml:msub>
                            <mml:mrow>
                              <mml:mo>(</mml:mo>
                              <mml:mrow>
                                <mml:mover accent="true">
                                  <mml:mi>m</mml:mi>
                                  <mml:mo>^</mml:mo>
                                </mml:mover>
                                <mml:mo>;</mml:mo>
                                <mml:mtext> </mml:mtext>
                                <mml:msub>
                                  <mml:mi>θ</mml:mi>
                                  <mml:mrow>
                                    <mml:mi>o</mml:mi>
                                    <mml:mi>n</mml:mi>
                                  </mml:mrow>
                                </mml:msub>
                                <mml:mo>,</mml:mo>
                                <mml:mtext> </mml:mtext>
                                <mml:msub>
                                  <mml:mi>θ</mml:mi>
                                  <mml:mrow>
                                    <mml:mi>o</mml:mi>
                                    <mml:mi>f</mml:mi>
                                    <mml:mi>f</mml:mi>
                                  </mml:mrow>
                                </mml:msub>
                                <mml:mo>,</mml:mo>
                                <mml:mtext> </mml:mtext>
                                <mml:msub>
                                  <mml:mi>θ</mml:mi>
                                  <mml:mi>t</mml:mi>
                                </mml:msub>
                              </mml:mrow>
                              <mml:mo>)</mml:mo>
                            </mml:mrow>
                            <mml:mtext>      </mml:mtext>
                            <mml:mi>f</mml:mi>
                            <mml:mi>o</mml:mi>
                            <mml:mi>r</mml:mi>
                            <mml:mtext> </mml:mtext>
                            <mml:mover accent="true">
                              <mml:mi>m</mml:mi>
                              <mml:mo>^</mml:mo>
                            </mml:mover>
                            <mml:mo>&gt;</mml:mo>
                            <mml:mn>0</mml:mn>
                          </mml:mrow>
                        </mml:mtd>
                      </mml:mtr>
                    </mml:mtable>
                  </mml:mrow>
                </mml:mrow>
              </mml:mtd>
            </mml:mtr>
          </mml:mtable>
        </mml:math>
      </disp-formula>
    </sec>
    <sec>
      <title>Cell Clustering</title>
      <p>As illustrated in <xref ref-type="fig" rid="F1">Figure 1B</xref>, CALISTA combines maximum likelihood and consensus clustering algorithms for single-cell clustering analysis. Following a previous method SABEC (Ezer et al., <xref rid="B10" ref-type="bibr">2016</xref>), CALISTA uses the stochastic two-state model of gene transcription to derive the steady-state probability distribution of gene expression values. The probability distribution is used to prescribe a likelihood value to a cell based on the measured single-cell expression values of its genes (Ezer et al., <xref rid="B10" ref-type="bibr">2016</xref>). In contrast to SABEC that employs a simulated annealing algorithm, CALISTA implements a greedy algorithm to solve the likelihood maximization problem (see <xref ref-type="supplementary-material" rid="SM6">Supplementary Note S1</xref>). The greedy algorithm is implemented repeatedly for a specified number of times, each starting from a different random initial cell assignment, to generate a consensus matrix. The (<italic>i, j</italic>)-th element of the consensus matrix records the number of times that the <italic>i</italic>-th and <italic>j-</italic>th cells are assigned to a cluster. The final cell clustering is obtained by applying <italic>k</italic>-medoids on the consensus matrix (Bhat, <xref rid="B3" ref-type="bibr">2014</xref>) (see <xref ref-type="supplementary-material" rid="SM6">Supplementary Note S1</xref> for more details).</p>
    </sec>
    <sec>
      <title>Lineage Inference</title>
      <p>The first novel algorithm in CALISTA is the reconstruction of cell lineage graph, which reflects the lineage progression in the differentiation process (<xref ref-type="fig" rid="F1">Figure 1C</xref>). Based on the view that cell clusters represent cell states, the nodes of the lineage graph comprise cell clusters, while the edges represent state transitions in the lineage progression. For inferring the lineage graph, CALISTA computes cluster distances based on dissimilarities in the gene expressions among cells from two clusters. Again, CALISTA adopts a likelihood-based strategy using the probability distribution of mRNA from the stochastic two-state gene transcription model to define the cluster distances.</p>
    </sec>
    <sec>
      <title>Cluster Distance</title>
      <p>Given <italic>K</italic> clusters from CALISTA single-cell clustering analysis above or the clustering provided by the user, CALISTA evaluates a <italic>K</italic> × <italic>K</italic> dissimilarity matrix <italic>S</italic> where the element s<sub><italic>kj</italic></sub> gives the likelihood of cells from cluster <italic>k</italic> to be assigned to cluster <italic>j</italic>, computed as follows:</p>
      <disp-formula id="E6">
        <label>(5)</label>
        <mml:math id="M9">
          <mml:mtable class="eqnarray" columnalign="left">
            <mml:mtr>
              <mml:mtd>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>s</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>k</mml:mi>
                    <mml:mi>j</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>=</mml:mo>
                <mml:mfrac>
                  <mml:mrow>
                    <mml:mn>1</mml:mn>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>N</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>k</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                  </mml:mrow>
                </mml:mfrac>
                <mml:mfrac>
                  <mml:mrow>
                    <mml:mn>1</mml:mn>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>G</mml:mi>
                  </mml:mrow>
                </mml:mfrac>
                <mml:mrow>
                  <mml:mo stretchy="true">(</mml:mo>
                  <mml:mrow>
                    <mml:mstyle displaystyle="true">
                      <mml:munderover accentunder="false" accent="false">
                        <mml:mrow>
                          <mml:mo>∑</mml:mo>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>n</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>k</mml:mi>
                            </mml:mrow>
                          </mml:msub>
                          <mml:mo>=</mml:mo>
                          <mml:mn>1</mml:mn>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>N</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>k</mml:mi>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                      </mml:munderover>
                    </mml:mstyle>
                    <mml:mstyle displaystyle="true">
                      <mml:munderover accentunder="false" accent="false">
                        <mml:mrow>
                          <mml:mo>∑</mml:mo>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>g</mml:mi>
                          <mml:mo>=</mml:mo>
                          <mml:mn>1</mml:mn>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>G</mml:mi>
                        </mml:mrow>
                      </mml:munderover>
                    </mml:mstyle>
                    <mml:mtext>ln </mml:mtext>
                    <mml:mi>P</mml:mi>
                    <mml:mrow>
                      <mml:mo stretchy="false">(</mml:mo>
                      <mml:mrow>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mover accent="false">
                              <mml:mrow>
                                <mml:mi>m</mml:mi>
                              </mml:mrow>
                              <mml:mo>^</mml:mo>
                            </mml:mover>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:msub>
                              <mml:mrow>
                                <mml:mi>n</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mi>k</mml:mi>
                              </mml:mrow>
                            </mml:msub>
                            <mml:mo>,</mml:mo>
                            <mml:mi>g</mml:mi>
                          </mml:mrow>
                        </mml:msub>
                        <mml:mo>;</mml:mo>
                        <mml:msup>
                          <mml:mrow>
                            <mml:mi>θ</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mo>*</mml:mo>
                          </mml:mrow>
                        </mml:msup>
                        <mml:mrow>
                          <mml:mo stretchy="false">(</mml:mo>
                          <mml:mrow>
                            <mml:mi>g</mml:mi>
                            <mml:mo>,</mml:mo>
                            <mml:mtext> </mml:mtext>
                            <mml:mi>j</mml:mi>
                          </mml:mrow>
                          <mml:mo stretchy="false">)</mml:mo>
                        </mml:mrow>
                      </mml:mrow>
                      <mml:mo stretchy="false">)</mml:mo>
                    </mml:mrow>
                  </mml:mrow>
                  <mml:mo stretchy="true">)</mml:mo>
                </mml:mrow>
              </mml:mtd>
            </mml:mtr>
          </mml:mtable>
        </mml:math>
      </disp-formula>
      <p>where <italic>N</italic><sub><italic>k</italic></sub> is the set of cell indices for the cells in cluster <italic>k</italic> and <inline-formula><mml:math id="M10"><mml:msup><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mi>j</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>o</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>o</mml:mi><mml:mi>f</mml:mi><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> is the parameter vector of two-state gene transcription that maximizes the joint probability of obtaining the gene expression values for gene <italic>g</italic> of the cells in the cluster <italic>j</italic>, as follows:</p>
      <disp-formula id="E7">
        <label>(6)</label>
        <mml:math id="M11">
          <mml:mrow>
            <mml:mi>θ</mml:mi>
            <mml:mo>*</mml:mo>
            <mml:mrow>
              <mml:mo>(</mml:mo>
              <mml:mrow>
                <mml:mi>g</mml:mi>
                <mml:mo>,</mml:mo>
                <mml:mtext> </mml:mtext>
                <mml:mi>j</mml:mi>
              </mml:mrow>
              <mml:mo>)</mml:mo>
            </mml:mrow>
            <mml:mo>=</mml:mo>
            <mml:mtext>arg </mml:mtext>
            <mml:munder>
              <mml:mrow>
                <mml:mtext>max</mml:mtext>
              </mml:mrow>
              <mml:mo>Θ</mml:mo>
            </mml:munder>
            <mml:mstyle displaystyle="true">
              <mml:munder>
                <mml:mo>∑</mml:mo>
                <mml:mrow>
                  <mml:mi>n</mml:mi>
                  <mml:mo>∈</mml:mo>
                  <mml:msub>
                    <mml:mi>N</mml:mi>
                    <mml:mi>j</mml:mi>
                  </mml:msub>
                </mml:mrow>
              </mml:munder>
              <mml:mrow>
                <mml:mtext>ln </mml:mtext>
                <mml:mi>P</mml:mi>
                <mml:mrow>
                  <mml:mo>(</mml:mo>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mover accent="true">
                        <mml:mi>m</mml:mi>
                        <mml:mo>^</mml:mo>
                      </mml:mover>
                      <mml:mrow>
                        <mml:mi>n</mml:mi>
                        <mml:mi>g</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo>;</mml:mo>
                    <mml:mi>θ</mml:mi>
                  </mml:mrow>
                  <mml:mo>)</mml:mo>
                </mml:mrow>
              </mml:mrow>
            </mml:mstyle>
            <mml:mo>.</mml:mo>
          </mml:mrow>
        </mml:math>
      </disp-formula>
      <p>The probability <inline-formula><mml:math id="M12"><mml:mi>P</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover accent="false"><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover><mml:mo>;</mml:mo><mml:mi>θ</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is computed using the steady state probability distribution from the two-state gene transcription model as given in Equation (2) (assuming that random dropout events are insignificant) or using the distribution function defined in Equation (4).</p>
      <p>Note that the diagonal element s<sub><italic>kk</italic></sub> is the sum of the cell likelihood in the original cluster assignment, i.e., <inline-formula><mml:math id="M13"><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munder class="msub"><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:munder class="msub"><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mo>∈</mml:mo><mml:mi>G</mml:mi></mml:mrow></mml:munder><mml:mtext>ln </mml:mtext><mml:mi>P</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mover accent="false"><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mo>;</mml:mo><mml:msup><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mi>k</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mtext> </mml:mtext></mml:math></inline-formula>, and thus are larger than other elements s<sub><italic>kj</italic></sub>, <italic>j</italic> ≠ <italic>k</italic>. The dissimilarity coefficients in the matrix S is subsequently normalized by subtracting each element with the diagonal element of the corresponding rows, as follows:</p>
      <disp-formula id="E8">
        <label>(7)</label>
        <mml:math id="M14">
          <mml:mtable class="eqnarray" columnalign="left">
            <mml:mtr>
              <mml:mtd>
                <mml:msub>
                  <mml:mrow>
                    <mml:mover accent="false">
                      <mml:mrow>
                        <mml:mi>s</mml:mi>
                      </mml:mrow>
                      <mml:mo>^</mml:mo>
                    </mml:mover>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>k</mml:mi>
                    <mml:mi>j</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>=</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>s</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>k</mml:mi>
                        <mml:mi>k</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo>-</mml:mo>
                    <mml:mi>s</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>k</mml:mi>
                    <mml:mi>j</mml:mi>
                  </mml:mrow>
                </mml:msub>
              </mml:mtd>
            </mml:mtr>
          </mml:mtable>
        </mml:math>
      </disp-formula>
      <p>Since the likelihood always takes on negative values, the normalized dissimilarity coefficient assumes a positive value. A larger <inline-formula><mml:math id="M15"><mml:msub><mml:mrow><mml:mover accent="false"><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> reflects a higher degree of dissimilarity between the two clusters. The distance between the <italic>j</italic>-th and <italic>k</italic>-th cluster, denoted by <italic>d</italic><sub><italic>kj</italic></sub>, is defined as:
<disp-formula id="E9"><label>(8)</label><mml:math id="M16"><mml:mtable class="eqnarray" columnalign="left"><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi><mml:mrow><mml:mtext> </mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mover accent="false"><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mover accent="false"><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula></p>
    </sec>
    <sec>
      <title>Lineage Graph Construction</title>
      <p>CALISTA generates a lineage graph by connecting single-cell clusters (states) based on the cluster distances. The lineage graph describes the state transition of stem cells during the cell differentiation process, under the assumption that the transitions occur between closely related cell states (i.e., between clusters with low distances). Briefly, CALISTA starts with a fully disconnected graph of single cell clusters, and sequentially adds one transition edge at a time in increasing magnitude of cluster distance until each cluster is connected by at least one edge. Once the lineage graph has been established, CALISTA assigns directionalities to the edges in the lineage graph according to user-provided information, e.g., starting cells/clusters or expected gene expression profiles. Given information of the starting cells, CALISTA defines the cell cluster(s) containing these cells as the starting cluster(s). On the other hand, given the expected trajectory of some marker genes, CALISTA uses the mean expression of the gene marker(s) in each cell cluster to determine the starting cell cluster.</p>
      <p>When the stage or time information is provided for the cells, CALISTA implements the following lineage reconstruction procedure. First, large outliers in the cluster distances (i.e., cluster distances that are larger than the median value by 3 scaled median absolute deviation) are removed from further consideration. Single-cell clusters are then labeled by their most frequent (mode) cell stage or time. Clusters with the lowest stage/time label are the starting clusters. CALISTA constructs a connected graph by assigning one (and only one) incoming edge for each cluster, except for the starting cluster(s), from the cluster with the lowest cluster distance among the set of feasible parent cluster(s). Here, the feasible parents of a given cluster <italic>j</italic> are any clusters with time/stage labels that are the nearest to but do not exceed a cutoff cell times/stages in cluster <italic>j</italic>. The default cutoff is set to the 5th percentile of the cell times/stages in cluster <italic>j</italic>. This cutoff is used to ensure that there exists sufficient difference in the cell times between the parent and daughter cell clusters.</p>
      <p>Besides the automated lineage reconstruction above, CALISTA further allows the users to manually add or remove transition edges between pairs of clusters/nodes through a user-friendly GUI (see CALISTA user manual).</p>
    </sec>
    <sec>
      <title>Transition Genes</title>
      <p>Another novel contribution in CALISTA is an algorithm to extract the set of transition genes between any two connected clusters in the lineage graph. Here, transition genes are defined as genes whose single-cell expressions are highly informative in grouping cells into the two clusters. More specifically, CALISTA evaluates the likelihood difference between having cells assigned to two separate clusters and having the cells together in one cluster, again using the steady-state distribution of mRNA from the two-state gene transcription model. Given two clusters <italic>j</italic> and <italic>k</italic>, we compute the following:</p>
      <disp-formula id="E10">
        <label>(9)</label>
        <mml:math id="M17">
          <mml:mtable class="eqnarray" columnalign="left">
            <mml:mtr>
              <mml:mtd>
                <mml:msubsup>
                  <mml:mrow>
                    <mml:mi>v</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>j</mml:mi>
                    <mml:mi>k</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mtext> </mml:mtext>
                    <mml:mi>g</mml:mi>
                  </mml:mrow>
                </mml:msubsup>
                <mml:mo>=</mml:mo>
                <mml:msubsup>
                  <mml:mrow>
                    <mml:mi>v</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>j</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mtext> </mml:mtext>
                    <mml:mi>g</mml:mi>
                  </mml:mrow>
                </mml:msubsup>
                <mml:mo>+</mml:mo>
                <mml:msubsup>
                  <mml:mrow>
                    <mml:mi>v</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>k</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mtext> </mml:mtext>
                    <mml:mi>g</mml:mi>
                  </mml:mrow>
                </mml:msubsup>
                <mml:mo>-</mml:mo>
                <mml:msubsup>
                  <mml:mrow>
                    <mml:mi>v</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>j</mml:mi>
                    <mml:mo>+</mml:mo>
                    <mml:mi>k</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mtext> </mml:mtext>
                    <mml:mi>g</mml:mi>
                  </mml:mrow>
                </mml:msubsup>
              </mml:mtd>
            </mml:mtr>
          </mml:mtable>
        </mml:math>
      </disp-formula>
      <p>with</p>
      <disp-formula id="E11">
        <label>(10)</label>
        <mml:math id="M18">
          <mml:mtable class="eqnarray" columnalign="left">
            <mml:mtr>
              <mml:mtd>
                <mml:msubsup>
                  <mml:mrow>
                    <mml:mi>v</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>j</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mtext> </mml:mtext>
                    <mml:mi>g</mml:mi>
                  </mml:mrow>
                </mml:msubsup>
                <mml:mo>=</mml:mo>
                <mml:mstyle displaystyle="true">
                  <mml:munder class="msub">
                    <mml:mrow>
                      <mml:mo>∑</mml:mo>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>n</mml:mi>
                      <mml:mo>∈</mml:mo>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>N</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>j</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                    </mml:mrow>
                  </mml:munder>
                </mml:mstyle>
                <mml:mtext>ln </mml:mtext>
                <mml:mi>P</mml:mi>
                <mml:mrow>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mover accent="false">
                          <mml:mrow>
                            <mml:mi>m</mml:mi>
                          </mml:mrow>
                          <mml:mo>^</mml:mo>
                        </mml:mover>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>n</mml:mi>
                        <mml:mo>,</mml:mo>
                        <mml:mi>g</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo>;</mml:mo>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mi>θ</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mo>*</mml:mo>
                      </mml:mrow>
                    </mml:msup>
                    <mml:mrow>
                      <mml:mo stretchy="false">(</mml:mo>
                      <mml:mrow>
                        <mml:mi>g</mml:mi>
                        <mml:mo>,</mml:mo>
                        <mml:mtext> </mml:mtext>
                        <mml:mi>j</mml:mi>
                      </mml:mrow>
                      <mml:mo stretchy="false">)</mml:mo>
                    </mml:mrow>
                  </mml:mrow>
                  <mml:mo stretchy="false">)</mml:mo>
                </mml:mrow>
              </mml:mtd>
            </mml:mtr>
          </mml:mtable>
        </mml:math>
      </disp-formula>
      <disp-formula id="E12">
        <label>(11)</label>
        <mml:math id="M19">
          <mml:mtable class="eqnarray" columnalign="left">
            <mml:mtr>
              <mml:mtd>
                <mml:msubsup>
                  <mml:mrow>
                    <mml:mi>v</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>k</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mtext> </mml:mtext>
                    <mml:mi>g</mml:mi>
                  </mml:mrow>
                </mml:msubsup>
                <mml:mo>=</mml:mo>
                <mml:mstyle displaystyle="true">
                  <mml:munder class="msub">
                    <mml:mrow>
                      <mml:mo>∑</mml:mo>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>n</mml:mi>
                      <mml:mo>∈</mml:mo>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>N</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>k</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                    </mml:mrow>
                  </mml:munder>
                </mml:mstyle>
                <mml:mtext>ln </mml:mtext>
                <mml:mi>P</mml:mi>
                <mml:mrow>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mover accent="false">
                          <mml:mrow>
                            <mml:mi>m</mml:mi>
                          </mml:mrow>
                          <mml:mo>^</mml:mo>
                        </mml:mover>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>n</mml:mi>
                        <mml:mo>,</mml:mo>
                        <mml:mi>g</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo>;</mml:mo>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mi>θ</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mo>*</mml:mo>
                      </mml:mrow>
                    </mml:msup>
                    <mml:mrow>
                      <mml:mo stretchy="false">(</mml:mo>
                      <mml:mrow>
                        <mml:mi>g</mml:mi>
                        <mml:mo>,</mml:mo>
                        <mml:mtext> </mml:mtext>
                        <mml:mi>k</mml:mi>
                      </mml:mrow>
                      <mml:mo stretchy="false">)</mml:mo>
                    </mml:mrow>
                  </mml:mrow>
                  <mml:mo stretchy="false">)</mml:mo>
                </mml:mrow>
              </mml:mtd>
            </mml:mtr>
          </mml:mtable>
        </mml:math>
      </disp-formula>
      <disp-formula id="E13">
        <label>(12)</label>
        <mml:math id="M20">
          <mml:mtable class="eqnarray" columnalign="left">
            <mml:mtr>
              <mml:mtd>
                <mml:msubsup>
                  <mml:mrow>
                    <mml:mi>v</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>j</mml:mi>
                    <mml:mo>+</mml:mo>
                    <mml:mi>k</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mtext> </mml:mtext>
                    <mml:mi>g</mml:mi>
                  </mml:mrow>
                </mml:msubsup>
                <mml:mo>=</mml:mo>
                <mml:mstyle displaystyle="true">
                  <mml:munder class="msub">
                    <mml:mrow>
                      <mml:mo>∑</mml:mo>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>n</mml:mi>
                      <mml:mo>∈</mml:mo>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>N</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>k</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mo>∪</mml:mo>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>N</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>j</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                    </mml:mrow>
                  </mml:munder>
                </mml:mstyle>
                <mml:mtext>ln </mml:mtext>
                <mml:mi>P</mml:mi>
                <mml:mrow>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mover accent="false">
                          <mml:mrow>
                            <mml:mi>m</mml:mi>
                          </mml:mrow>
                          <mml:mo>^</mml:mo>
                        </mml:mover>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>n</mml:mi>
                        <mml:mo>,</mml:mo>
                        <mml:mi>g</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo>;</mml:mo>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mi>θ</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mo>*</mml:mo>
                      </mml:mrow>
                    </mml:msup>
                    <mml:mrow>
                      <mml:mo stretchy="false">(</mml:mo>
                      <mml:mrow>
                        <mml:mi>g</mml:mi>
                        <mml:mo>,</mml:mo>
                        <mml:mtext> </mml:mtext>
                        <mml:mi>j</mml:mi>
                        <mml:mo>+</mml:mo>
                        <mml:mi>k</mml:mi>
                      </mml:mrow>
                      <mml:mo stretchy="false">)</mml:mo>
                    </mml:mrow>
                  </mml:mrow>
                  <mml:mo stretchy="false">)</mml:mo>
                </mml:mrow>
              </mml:mtd>
            </mml:mtr>
          </mml:mtable>
        </mml:math>
      </disp-formula>
      <p>where the optimal parameter vector θ<sup>*</sup>(<italic>g, j</italic> + <italic>k</italic>) is obtained according to Equation (6) for all cells from clusters <italic>j</italic> and <italic>k</italic> together. The value of <inline-formula><mml:math id="M21"><mml:msubsup><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mtext> </mml:mtext><mml:mi>g</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> reflects the informativeness of single-cell gene expression of gene <italic>g</italic> for grouping cells into two clusters <italic>j</italic> and <italic>k</italic> by the maximum likelihood principle in CALISTA. For each edge in the lineage graph, CALISTA generates a rank list of genes in decreasing values of <inline-formula><mml:math id="M22"><mml:msubsup><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>k</mml:mi><mml:mtext> </mml:mtext></mml:mrow><mml:mrow><mml:mtext> </mml:mtext><mml:mi>g</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula>. The transition genes correspond to the set of top genes in the list such that the ratio between the sum of <inline-formula><mml:math id="M23"><mml:msubsup><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>k</mml:mi><mml:mtext> </mml:mtext></mml:mrow><mml:mrow><mml:mtext> </mml:mtext><mml:mi>g</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula>among these genes and the total sum of <inline-formula><mml:math id="M24"><mml:msubsup><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>k</mml:mi><mml:mtext> </mml:mtext></mml:mrow><mml:mrow><mml:mtext> </mml:mtext><mml:mi>g</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> among all genes exceeds a given threshold (default threshold: 50%).</p>
    </sec>
    <sec>
      <title>Pseudotemporal Ordering of Cells</title>
      <p>Given a lineage progression graph among cell clusters, the third and last novel algorithm in CALISTA concerns with the pseudotemporal ordering of cells. For this purpose, we first assign a pseudotime to each cluster. If the time or stage information of the cells is provided, then the pseudotime of a cluster is set to the mode of the time/stage of the cells in the cluster divided by the largest time/stage. When the time/stage information is not available, but the starting cluster is known (e.g., from knowledge of starting cells or marker genes), we assign a pseudotime of 0 for the starting cluster. We then evaluate the sum of the cluster distances along each path in the lineage progression and identify the maximum cumulative cluster distance. The pseudotime of a cluster is given by its cumulative cluster distance to the starting cluster divided by the maximum cumulative cluster distance. Once the cluster pseudotimes have been set, we assign each cell to one of the state transition edges and compute the cell pseudotime using the maximum likelihood principle (see <italic>Cell assignment to transition edges</italic> below). Finally, given a developmental path in the linage progression, CALISTA provides a pseudotemporal ordering of cells that have been assigned to the edges belonging to the path.</p>
    </sec>
    <sec>
      <title>Cell Assignment to Transition Edges</title>
      <p>For pseudotemporal ordering of the cells, CALISTA first assigns cells to the edges in the lineage graph. In the following illustration, let us consider a cell <italic>n</italic> in cluster <italic>k</italic>. CALISTA allocates the cell <italic>n</italic> to one of the edges that are incident to cluster <italic>k</italic>, again following the maximum likelihood principle. For this purpose, we define the likelihood value of a cell <italic>n</italic> to belong to an edge pointing from any cluster <italic>j</italic> to cluster <italic>k</italic> as follows:</p>
      <disp-formula id="E14">
        <label>(13)</label>
        <mml:math id="M25">
          <mml:msub>
            <mml:mo>Λ</mml:mo>
            <mml:mrow>
              <mml:mi>j</mml:mi>
              <mml:mo>→</mml:mo>
              <mml:mi>k</mml:mi>
            </mml:mrow>
          </mml:msub>
          <mml:mrow>
            <mml:mo>(</mml:mo>
            <mml:mi>n</mml:mi>
            <mml:mo>)</mml:mo>
          </mml:mrow>
          <mml:mo>=</mml:mo>
          <mml:munder>
            <mml:mrow>
              <mml:mtext>max</mml:mtext>
            </mml:mrow>
            <mml:mi>t</mml:mi>
          </mml:munder>
          <mml:msub>
            <mml:mo>Λ</mml:mo>
            <mml:mi>j</mml:mi>
          </mml:msub>
          <mml:mrow>
            <mml:mo>(</mml:mo>
            <mml:mi>n</mml:mi>
            <mml:mo>)</mml:mo>
          </mml:mrow>
          <mml:mo>+</mml:mo>
          <mml:mfrac>
            <mml:mrow>
              <mml:mrow>
                <mml:mo>(</mml:mo>
                <mml:mrow>
                  <mml:mi>t</mml:mi>
                  <mml:mo>−</mml:mo>
                  <mml:msub>
                    <mml:mi>t</mml:mi>
                    <mml:mi>j</mml:mi>
                  </mml:msub>
                </mml:mrow>
                <mml:mo>)</mml:mo>
              </mml:mrow>
            </mml:mrow>
            <mml:mrow>
              <mml:mrow>
                <mml:mo>(</mml:mo>
                <mml:mrow>
                  <mml:msub>
                    <mml:mi>t</mml:mi>
                    <mml:mi>k</mml:mi>
                  </mml:msub>
                  <mml:mo>−</mml:mo>
                  <mml:msub>
                    <mml:mi>t</mml:mi>
                    <mml:mi>j</mml:mi>
                  </mml:msub>
                </mml:mrow>
                <mml:mo>)</mml:mo>
              </mml:mrow>
            </mml:mrow>
          </mml:mfrac>
          <mml:mrow>
            <mml:mo>(</mml:mo>
            <mml:mrow>
              <mml:msub>
                <mml:mo>Λ</mml:mo>
                <mml:mi>k</mml:mi>
              </mml:msub>
              <mml:mrow>
                <mml:mo>(</mml:mo>
                <mml:mi>n</mml:mi>
                <mml:mo>)</mml:mo>
              </mml:mrow>
              <mml:mo>−</mml:mo>
              <mml:msub>
                <mml:mo>Λ</mml:mo>
                <mml:mi>j</mml:mi>
              </mml:msub>
              <mml:mrow>
                <mml:mo>(</mml:mo>
                <mml:mi>n</mml:mi>
                <mml:mo>)</mml:mo>
              </mml:mrow>
            </mml:mrow>
            <mml:mo>)</mml:mo>
          </mml:mrow>
        </mml:math>
      </disp-formula>
      <p>where <italic>t</italic><sub><italic>k</italic></sub> denotes the cluster pseudotime label and Λ<sub><italic>k</italic></sub>(<italic>n</italic>) defines the likelihood value of the <italic>n</italic>-th cell to be in cluster <italic>k</italic>, i.e., <inline-formula><mml:math id="M26"><mml:mrow><mml:msub><mml:mo>Λ</mml:mo><mml:mi>k</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>n</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mi>g</mml:mi><mml:mo>∈</mml:mo><mml:mi>G</mml:mi></mml:mrow></mml:msub><mml:mtext>ln </mml:mtext><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>m</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mo>;</mml:mo><mml:mi>θ</mml:mi><mml:mo>∗</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mi>k</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. Similarly, we define the likelihood value of the same cell to belong to an edge pointing from cluster <italic>k</italic> to any cluster <italic>l</italic> by the following:</p>
      <disp-formula id="E15">
        <label>(14)</label>
        <mml:math id="M27">
          <mml:msub>
            <mml:mo>Λ</mml:mo>
            <mml:mrow>
              <mml:mi>k</mml:mi>
              <mml:mo>→</mml:mo>
              <mml:mi>l</mml:mi>
            </mml:mrow>
          </mml:msub>
          <mml:mrow>
            <mml:mo>(</mml:mo>
            <mml:mi>n</mml:mi>
            <mml:mo>)</mml:mo>
          </mml:mrow>
          <mml:mo>=</mml:mo>
          <mml:munder>
            <mml:mrow>
              <mml:mtext>max</mml:mtext>
            </mml:mrow>
            <mml:mi>t</mml:mi>
          </mml:munder>
          <mml:mtext>​</mml:mtext>
          <mml:msub>
            <mml:mo>Λ</mml:mo>
            <mml:mi>k</mml:mi>
          </mml:msub>
          <mml:mrow>
            <mml:mo>(</mml:mo>
            <mml:mi>n</mml:mi>
            <mml:mo>)</mml:mo>
          </mml:mrow>
          <mml:mo>+</mml:mo>
          <mml:mfrac>
            <mml:mrow>
              <mml:mrow>
                <mml:mo>(</mml:mo>
                <mml:mrow>
                  <mml:mi>t</mml:mi>
                  <mml:mo>−</mml:mo>
                  <mml:msub>
                    <mml:mi>t</mml:mi>
                    <mml:mi>k</mml:mi>
                  </mml:msub>
                </mml:mrow>
                <mml:mo>)</mml:mo>
              </mml:mrow>
            </mml:mrow>
            <mml:mrow>
              <mml:mrow>
                <mml:mo>(</mml:mo>
                <mml:mrow>
                  <mml:msub>
                    <mml:mi>t</mml:mi>
                    <mml:mi>l</mml:mi>
                  </mml:msub>
                  <mml:mo>−</mml:mo>
                  <mml:msub>
                    <mml:mi>t</mml:mi>
                    <mml:mi>k</mml:mi>
                  </mml:msub>
                </mml:mrow>
                <mml:mo>)</mml:mo>
              </mml:mrow>
            </mml:mrow>
          </mml:mfrac>
          <mml:mrow>
            <mml:mo>(</mml:mo>
            <mml:mrow>
              <mml:msub>
                <mml:mo>Λ</mml:mo>
                <mml:mi>l</mml:mi>
              </mml:msub>
              <mml:mrow>
                <mml:mo>(</mml:mo>
                <mml:mi>n</mml:mi>
                <mml:mo>)</mml:mo>
              </mml:mrow>
              <mml:mo>−</mml:mo>
              <mml:msub>
                <mml:mo>Λ</mml:mo>
                <mml:mi>k</mml:mi>
              </mml:msub>
              <mml:mrow>
                <mml:mo>(</mml:mo>
                <mml:mi>n</mml:mi>
                <mml:mo>)</mml:mo>
              </mml:mrow>
            </mml:mrow>
            <mml:mo>)</mml:mo>
          </mml:mrow>
        </mml:math>
      </disp-formula>
      <p>CALISTA computes all possible Λ<sub><italic>j</italic>→<italic>k</italic></sub>(<italic>n</italic>) and Λ<sub><italic>k</italic>→<italic>l</italic></sub>(<italic>n</italic>) lineage graph, and assigns the cell to the edge that gives the maximum of all Λ<sub><italic>j</italic>→<italic>k</italic></sub>(<italic>n</italic>) and Λ<sub><italic>k</italic>→<italic>l</italic></sub>(<italic>n</italic>) values. The pseudotime of the cell <italic>t</italic>(<italic>n</italic>) is set to <italic>t</italic> that gives the maximum likelihood value, as follows:</p>
      <disp-formula id="E16">
        <label>(15)</label>
        <mml:math id="M28">
          <mml:mtable>
            <mml:mtr>
              <mml:mtd>
                <mml:mrow>
                  <mml:mi>t</mml:mi>
                  <mml:mrow>
                    <mml:mo>(</mml:mo>
                    <mml:mi>n</mml:mi>
                    <mml:mo>)</mml:mo>
                  </mml:mrow>
                  <mml:mo>=</mml:mo>
                  <mml:mtext>arg </mml:mtext>
                  <mml:munder>
                    <mml:mrow>
                      <mml:mtext>max</mml:mtext>
                    </mml:mrow>
                    <mml:mi>t</mml:mi>
                  </mml:munder>
                  <mml:mtext>​</mml:mtext>
                  <mml:msub>
                    <mml:mo>Λ</mml:mo>
                    <mml:mi>j</mml:mi>
                  </mml:msub>
                  <mml:mrow>
                    <mml:mo>(</mml:mo>
                    <mml:mi>n</mml:mi>
                    <mml:mo>)</mml:mo>
                  </mml:mrow>
                  <mml:mo>+</mml:mo>
                  <mml:mfrac>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:mrow>
                          <mml:mi>t</mml:mi>
                          <mml:mo>−</mml:mo>
                          <mml:msub>
                            <mml:mi>t</mml:mi>
                            <mml:mi>j</mml:mi>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mi>t</mml:mi>
                            <mml:mi>k</mml:mi>
                          </mml:msub>
                          <mml:mo>−</mml:mo>
                          <mml:msub>
                            <mml:mi>t</mml:mi>
                            <mml:mi>j</mml:mi>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:mfrac>
                  <mml:mrow>
                    <mml:mo>(</mml:mo>
                    <mml:mrow>
                      <mml:msub>
                        <mml:mo>Λ</mml:mo>
                        <mml:mi>k</mml:mi>
                      </mml:msub>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:mi>n</mml:mi>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                      <mml:mo>−</mml:mo>
                      <mml:msub>
                        <mml:mo>Λ</mml:mo>
                        <mml:mi>j</mml:mi>
                      </mml:msub>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:mi>n</mml:mi>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                    </mml:mrow>
                    <mml:mo>)</mml:mo>
                  </mml:mrow>
                </mml:mrow>
              </mml:mtd>
            </mml:mtr>
            <mml:mtr>
              <mml:mtd>
                <mml:mtext>                     </mml:mtext>
                <mml:mrow>
                  <mml:mi>o</mml:mi>
                  <mml:mi>r</mml:mi>
                </mml:mrow>
              </mml:mtd>
            </mml:mtr>
            <mml:mtr>
              <mml:mtd>
                <mml:mrow>
                  <mml:mi>t</mml:mi>
                  <mml:mrow>
                    <mml:mo>(</mml:mo>
                    <mml:mi>n</mml:mi>
                    <mml:mo>)</mml:mo>
                  </mml:mrow>
                  <mml:mo>=</mml:mo>
                  <mml:mtext>arg </mml:mtext>
                  <mml:munder>
                    <mml:mrow>
                      <mml:mtext>max</mml:mtext>
                    </mml:mrow>
                    <mml:mi>t</mml:mi>
                  </mml:munder>
                  <mml:mtext>​</mml:mtext>
                  <mml:msub>
                    <mml:mo>Λ</mml:mo>
                    <mml:mi>k</mml:mi>
                  </mml:msub>
                  <mml:mrow>
                    <mml:mo>(</mml:mo>
                    <mml:mi>n</mml:mi>
                    <mml:mo>)</mml:mo>
                  </mml:mrow>
                  <mml:mo>+</mml:mo>
                  <mml:mfrac>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:mrow>
                          <mml:mi>t</mml:mi>
                          <mml:mo>−</mml:mo>
                          <mml:msub>
                            <mml:mi>t</mml:mi>
                            <mml:mi>k</mml:mi>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mi>t</mml:mi>
                            <mml:mi>l</mml:mi>
                          </mml:msub>
                          <mml:mo>−</mml:mo>
                          <mml:msub>
                            <mml:mi>t</mml:mi>
                            <mml:mi>k</mml:mi>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:mfrac>
                  <mml:mrow>
                    <mml:mo>(</mml:mo>
                    <mml:mrow>
                      <mml:msub>
                        <mml:mo>Λ</mml:mo>
                        <mml:mi>l</mml:mi>
                      </mml:msub>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:mi>n</mml:mi>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                      <mml:mo>−</mml:mo>
                      <mml:msub>
                        <mml:mo>Λ</mml:mo>
                        <mml:mi>k</mml:mi>
                      </mml:msub>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:mi>n</mml:mi>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                    </mml:mrow>
                    <mml:mo>)</mml:mo>
                  </mml:mrow>
                </mml:mrow>
              </mml:mtd>
            </mml:mtr>
          </mml:mtable>
        </mml:math>
      </disp-formula>
      <p>depending on the cell assignment to edges above.</p>
    </sec>
    <sec>
      <title>Cell Ordering Along a Developmental Path</title>
      <p>Given a lineage progression graph, users can identify one or several developmental paths. A developmental path is defined as the sequence of connected clusters in the lineage progression graph with transition edges pointing from one cluster to the next in the sequence. CALISTA generates a pseudotemporal ordering along a given developmental path by first identifying cells belonging to the state transition edges in the path and order these cells according to their pseudotimes. Note that in defining the likelihood function for assigning cells to edges, we have assumed that the steady state probability distributions of gene expressions vary linearly between two connected clusters or states. But the result of the cell ordering does not change if we replace the linear interpolation function with any monotonic function.</p>
    </sec>
    <sec>
      <title><italic>In silico</italic> Single-Cell Time-Stamped Expression Data Generation</title>
      <p>For testing the performance of CALISTA, we simulated synthetic single-cell gene expression data using the stochastic differentiation equation (SDE) model of the gene network (12 genes) governing the differentiation of central nervous system (CNS) proposed by Qiu et al. (<xref rid="B31" ref-type="bibr">2012</xref>). We simulated single-cell gene expression data for 9 time points (<italic>t</italic><sub><italic>sim</italic></sub> = 0, 1, 2, 4, 6, 8, 12, 16, 20) and a total of 1,800 cells (i.e., 200 cells per time point) using a time step of 0.04. Prior to the sampling, we simulated the model until steady state. In order to simulate asynchronous cell differentiation, for each time point <italic>t</italic><sub><italic>sim,i</italic></sub>, we took cells from random simulation times assuming a Gaussian distribution with a mean of <italic>t</italic><sub><italic>sim,i</italic></sub> and a standard deviation of 0.2. The <italic>in silico</italic> data are included in CALISTA package (<ext-link ext-link-type="uri" xlink:href="http://www.cabselab.com/calista">http://www.cabselab.com/calista</ext-link>).</p>
    </sec>
  </sec>
  <sec sec-type="data-availability" id="s5">
    <title>Data Availability Statement</title>
    <p>The datasets generated for this study are available on request to the corresponding author.</p>
  </sec>
  <sec id="s6">
    <title>Author Contributions</title>
    <p>NP and RG designed the computational framework and workflow and wrote the manuscript. NP developed open-course tool and performed all data analyses. NP, TH, and TF collected all necessary data and performed the preliminary analysis. All authors read and approved the final manuscript.</p>
    <sec>
      <title>Conflict of Interest</title>
      <p>The authors declare that the research was conducted in the absence of any commercial or financial relationships that could be construed as a potential conflict of interest.</p>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn fn-type="financial-disclosure">
      <p><bold>Funding.</bold> This work was supported by the Swiss National Science Foundation (grant number 157154 and 176279 - SinCity).</p>
    </fn>
  </fn-group>
  <sec sec-type="supplementary-material" id="s7">
    <title>Supplementary Material</title>
    <p>The Supplementary Material for this article can be found online at: <ext-link ext-link-type="uri" xlink:href="https://www.frontiersin.org/articles/10.3389/fbioe.2020.00018/full#supplementary-material">https://www.frontiersin.org/articles/10.3389/fbioe.2020.00018/full#supplementary-material</ext-link></p>
    <supplementary-material content-type="local-data" id="SM1">
      <label>Supplementary Table S1</label>
      <caption>
        <p>Comparison of computational runtimes for single-cell clustering: SABEC vs. CALISTA.</p>
      </caption>
      <media xlink:href="Table_1.XLSX">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="SM2">
      <label>Supplementary Table S2</label>
      <caption>
        <p>Comparison of pseudotimes: <italic>in silico</italic> (ground truth), Monocle 2, DPT, and CALISTA.</p>
      </caption>
      <media xlink:href="Table_2.XLSX">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="SM3">
      <label>Supplementary Table S3</label>
      <caption>
        <p>Transition genes in Bargaje et al. study (Bargaje et al., <xref rid="B2" ref-type="bibr">2017</xref>) of iPSC differentiation into cardiomyocytes.</p>
      </caption>
      <media xlink:href="Table_3.XLSX">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="SM4">
      <label>Supplementary Table S4</label>
      <caption>
        <p>Single-cell clustering evaluation: cell cluster assignments, adjusted Rand index, and <italic>in silico</italic> datasets.</p>
      </caption>
      <media xlink:href="Table_4.XLSX">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="SM5">
      <label>Supplementary Video S1</label>
      <caption>
        <p>Three-dimensional projection of single-cell gene expression and lineage progression of zebrafish embryogenesis (Farrell et al., <xref rid="B11" ref-type="bibr">2018</xref>).</p>
      </caption>
      <media xlink:href="Video_1.MP4">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="SM6">
      <media xlink:href="Data_Sheet_1.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
  <ref-list>
    <title>References</title>
    <ref id="B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Angerer</surname><given-names>P.</given-names></name><name><surname>Simon</surname><given-names>L.</given-names></name><name><surname>Tritschler</surname><given-names>S.</given-names></name><name><surname>Wolf</surname><given-names>F. A.</given-names></name><name><surname>Fischer</surname><given-names>D.</given-names></name><name><surname>Theis</surname><given-names>F. J.</given-names></name></person-group> (<year>2017</year>). <article-title>Single cells make big data: new challenges and opportunities in transcriptomics</article-title>. <source>Curr. Opin. Syst. Biol.</source>
<volume>4</volume>, <fpage>85</fpage>–<lpage>91</lpage>. <pub-id pub-id-type="doi">10.1016/j.coisb.2017.07.004</pub-id></mixed-citation>
    </ref>
    <ref id="B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bargaje</surname><given-names>R.</given-names></name><name><surname>Trachana</surname><given-names>K.</given-names></name><name><surname>Shelton</surname><given-names>M. N.</given-names></name><name><surname>McGinnis</surname><given-names>C. S.</given-names></name><name><surname>Zhou</surname><given-names>J. X.</given-names></name><name><surname>Chadick</surname><given-names>C.</given-names></name><etal/></person-group>. (<year>2017</year>). <article-title>Cell population structure prior to bifurcation predicts efficiency of directed differentiation in human induced pluripotent cells</article-title>. <source>Proc. Natl. Acad. Sci. U.S.A.</source><volume>114</volume>, <fpage>2271</fpage>–<lpage>2276</lpage>. <pub-id pub-id-type="doi">10.1073/pnas.1621412114</pub-id><?supplied-pmid 28167799?><pub-id pub-id-type="pmid">28167799</pub-id></mixed-citation>
    </ref>
    <ref id="B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bhat</surname><given-names>A.</given-names></name></person-group> (<year>2014</year>). <article-title>K-medoids clustering using partitioning around medoids for performing face recognition</article-title>. <source>Int. J. Soft Comput. Math. Control</source>
<volume>3</volume>, <fpage>1</fpage>–<lpage>12</lpage>. <pub-id pub-id-type="doi">10.14810/ijscmc.2014.3301</pub-id></mixed-citation>
    </ref>
    <ref id="B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bron</surname><given-names>C.</given-names></name><name><surname>Kerbosch</surname><given-names>J.</given-names></name></person-group> (<year>1973</year>). <article-title>Algorithm 457: finding all cliques of an undirected graph</article-title>. <source>Commun. ACM</source>
<volume>16</volume>, <fpage>575</fpage>–<lpage>577</lpage>. <pub-id pub-id-type="doi">10.1145/362342.362367</pub-id></mixed-citation>
    </ref>
    <ref id="B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cacchiarelli</surname><given-names>D.</given-names></name><name><surname>Trapnell</surname><given-names>C.</given-names></name><name><surname>Ziller</surname><given-names>M. J.</given-names></name><name><surname>Soumillon</surname><given-names>M.</given-names></name><name><surname>Cesana</surname><given-names>M.</given-names></name><name><surname>Karnik</surname><given-names>R.</given-names></name><etal/></person-group>. (<year>2015</year>). <article-title>Integrative analyses of human reprogramming reveal dynamic nature of induced pluripotency</article-title>. <source>Cell</source><volume>162</volume>, <fpage>412</fpage>–<lpage>424</lpage>. <pub-id pub-id-type="doi">10.1016/j.cell.2015.06.016</pub-id><?supplied-pmid 26186193?><pub-id pub-id-type="pmid">26186193</pub-id></mixed-citation>
    </ref>
    <ref id="B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cannoodt</surname><given-names>R.</given-names></name><name><surname>Saelens</surname><given-names>W.</given-names></name><name><surname>Saeys</surname><given-names>Y.</given-names></name></person-group> (<year>2016</year>). <article-title>Computational methods for trajectory inference from single-cell transcriptomics</article-title>. <source>Eur. J. Immunol.</source>
<volume>46</volume>, <fpage>2496</fpage>–<lpage>2506</lpage>. <pub-id pub-id-type="doi">10.1002/eji.201646347</pub-id><?supplied-pmid 27682842?><pub-id pub-id-type="pmid">27682842</pub-id></mixed-citation>
    </ref>
    <ref id="B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chu</surname><given-names>L.-F.</given-names></name><name><surname>Leng</surname><given-names>N.</given-names></name><name><surname>Zhang</surname><given-names>J.</given-names></name><name><surname>Hou</surname><given-names>Z.</given-names></name><name><surname>Mamott</surname><given-names>D.</given-names></name><name><surname>Vereide</surname><given-names>D. T.</given-names></name><etal/></person-group>. (<year>2016</year>). <article-title>Single-cell RNA-seq reveals novel regulators of human embryonic stem cell differentiation to definitive endoderm</article-title>. <source>Genome Biol.</source><volume>17</volume>:<fpage>173</fpage>. <pub-id pub-id-type="doi">10.1186/s13059-016-1033-x</pub-id><?supplied-pmid 27534536?><pub-id pub-id-type="pmid">27534536</pub-id></mixed-citation>
    </ref>
    <ref id="B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Davidson</surname><given-names>K. C.</given-names></name><name><surname>Adams</surname><given-names>A. M.</given-names></name><name><surname>Goodson</surname><given-names>J. M.</given-names></name><name><surname>McDonald</surname><given-names>C. E.</given-names></name><name><surname>Potter</surname><given-names>J. C.</given-names></name><name><surname>Berndt</surname><given-names>J. D.</given-names></name><etal/></person-group> (<year>2012</year>). <article-title>Wnt/β-catenin signaling promotes differentiation, not self-renewal, of human embryonic stem cells and is repressed by Oct4</article-title>. <source>Proc. Natl. Acad. Sci. U.S.A.</source>
<volume>109</volume>, <fpage>4485</fpage>–<lpage>4490</lpage>. <pub-id pub-id-type="doi">10.1073/pnas.1118777109</pub-id><pub-id pub-id-type="pmid">22392999</pub-id></mixed-citation>
    </ref>
    <ref id="B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Duren</surname><given-names>Z.</given-names></name><name><surname>Chen</surname><given-names>X.</given-names></name><name><surname>Zamanighomi</surname><given-names>M.</given-names></name><name><surname>Zeng</surname><given-names>W.</given-names></name><name><surname>Satpathy</surname><given-names>A. T.</given-names></name><name><surname>Chang</surname><given-names>H. Y.</given-names></name><etal/></person-group>. (<year>2018</year>). <article-title>Integrative analysis of single-cell genomics data by coupled nonnegative matrix factorizations</article-title>. <source>Proc. Natl. Acad. Sci. U.S.A.</source><volume>115</volume>, <fpage>7723</fpage>–<lpage>7728</lpage>. <pub-id pub-id-type="doi">10.1073/pnas.1805681115</pub-id><?supplied-pmid 29987051?><pub-id pub-id-type="pmid">29987051</pub-id></mixed-citation>
    </ref>
    <ref id="B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ezer</surname><given-names>D.</given-names></name><name><surname>Moignard</surname><given-names>V.</given-names></name><name><surname>Göttgens</surname><given-names>B.</given-names></name><name><surname>Adryan</surname><given-names>B.</given-names></name></person-group> (<year>2016</year>). <article-title>Determining physical mechanisms of gene expression regulation from single cell gene expression data</article-title>. <source>PLoS Comput. Biol.</source>
<volume>12</volume>:<fpage>e1005072</fpage>. <pub-id pub-id-type="doi">10.1371/journal.pcbi.1005072</pub-id><?supplied-pmid 27551778?><pub-id pub-id-type="pmid">27551778</pub-id></mixed-citation>
    </ref>
    <ref id="B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Farrell</surname><given-names>J. A.</given-names></name><name><surname>Wang</surname><given-names>Y.</given-names></name><name><surname>Riesenfeld</surname><given-names>S. J.</given-names></name><name><surname>Shekhar</surname><given-names>K.</given-names></name><name><surname>Regev</surname><given-names>A.</given-names></name><name><surname>Schier</surname><given-names>A. F.</given-names></name></person-group> (<year>2018</year>). <article-title>Single-cell reconstruction of developmental trajectories during zebrafish embryogenesis</article-title>. <source>Science</source>
<volume>360</volume>:<fpage>eaar3131</fpage>. <pub-id pub-id-type="doi">10.1126/science.aar3131</pub-id><?supplied-pmid 29700225?><pub-id pub-id-type="pmid">29700225</pub-id></mixed-citation>
    </ref>
    <ref id="B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Grün</surname><given-names>D.</given-names></name><name><surname>Lyubimova</surname><given-names>A.</given-names></name><name><surname>Kester</surname><given-names>L.</given-names></name><name><surname>Wiebrands</surname><given-names>K.</given-names></name><name><surname>Basak</surname><given-names>O.</given-names></name><name><surname>Sasaki</surname><given-names>N.</given-names></name><etal/></person-group>. (<year>2015</year>). <article-title>Single-cell messenger RNA sequencing reveals rare intestinal cell types</article-title>. <source>Nature</source><volume>525</volume>, <fpage>251</fpage>–<lpage>255</lpage>. <pub-id pub-id-type="doi">10.1038/nature14966</pub-id><?supplied-pmid 26287467?><pub-id pub-id-type="pmid">26287467</pub-id></mixed-citation>
    </ref>
    <ref id="B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Guo</surname><given-names>G.</given-names></name><name><surname>Huss</surname><given-names>M.</given-names></name><name><surname>Tong</surname><given-names>G. Q.</given-names></name><name><surname>Wang</surname><given-names>C.</given-names></name><name><surname>Li Sun</surname><given-names>L.</given-names></name><name><surname>Clarke</surname><given-names>N. D.</given-names></name><etal/></person-group>. (<year>2010</year>). <article-title>Resolution of cell fate decisions revealed by single-cell gene expression analysis from zygote to blastocyst</article-title>. <source>Dev. Cell</source><volume>18</volume>, <fpage>675</fpage>–<lpage>685</lpage>. <pub-id pub-id-type="doi">10.1016/j.devcel.2010.02.012</pub-id><?supplied-pmid 20412781?><pub-id pub-id-type="pmid">20412781</pub-id></mixed-citation>
    </ref>
    <ref id="B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Haghverdi</surname><given-names>L.</given-names></name><name><surname>Büttner</surname><given-names>M.</given-names></name><name><surname>Wolf</surname><given-names>F. A.</given-names></name><name><surname>Buettner</surname><given-names>F.</given-names></name><name><surname>Theis</surname><given-names>F. J.</given-names></name></person-group> (<year>2016</year>). <article-title>Diffusion pseudotime robustly reconstructs lineage branching</article-title>. <source>Nat. Methods</source>
<volume>13</volume>, <fpage>845</fpage>–<lpage>848</lpage>. <pub-id pub-id-type="doi">10.1038/nmeth.3971</pub-id><?supplied-pmid 27571553?><pub-id pub-id-type="pmid">27571553</pub-id></mixed-citation>
    </ref>
    <ref id="B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hua</surname><given-names>J.</given-names></name><name><surname>Lin Huang</surname><given-names>M.</given-names></name><name><surname>Wang</surname><given-names>G.</given-names></name></person-group> (<year>2018</year>). <article-title>Graph layout performance comparisons of force-directed algorithms</article-title>. <source>Int. J. Performabil. Eng.</source>
<volume>14</volume>, <fpage>67</fpage>–<lpage>76</lpage>. <pub-id pub-id-type="doi">10.23940/ijpe.18.01.p8.6776</pub-id></mixed-citation>
    </ref>
    <ref id="B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Huang</surname><given-names>W.</given-names></name><name><surname>Cao</surname><given-names>X.</given-names></name><name><surname>Biase</surname><given-names>F. H.</given-names></name><name><surname>Yu</surname><given-names>P.</given-names></name><name><surname>Zhong</surname><given-names>S.</given-names></name></person-group> (<year>2014</year>). <article-title>Time-variant clustering model for understanding cell fate decisions</article-title>. <source>Proc. Natl. Acad. Sci. U.S.A.</source>
<volume>111</volume>, <fpage>E4797</fpage>–<lpage>E4806</lpage>. <pub-id pub-id-type="doi">10.1073/pnas.1407388111</pub-id><?supplied-pmid 25339442?><pub-id pub-id-type="pmid">25339442</pub-id></mixed-citation>
    </ref>
    <ref id="B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jagtap</surname><given-names>S.</given-names></name><name><surname>Meganathan</surname><given-names>K.</given-names></name><name><surname>Gaspar</surname><given-names>J.</given-names></name><name><surname>Wagh</surname><given-names>V.</given-names></name><name><surname>Winkler</surname><given-names>J.</given-names></name><name><surname>Hescheler</surname><given-names>J.</given-names></name><etal/></person-group>. (<year>2011</year>). <article-title>Cytosine arabinoside induces ectoderm and inhibits mesoderm expression in human embryonic stem cells during multilineage differentiation</article-title>. <source>Br. J. Pharmacol.</source><volume>162</volume>, <fpage>1743</fpage>–<lpage>1756</lpage>. <pub-id pub-id-type="doi">10.1111/j.1476-5381.2010.01197.x</pub-id><?supplied-pmid 21198554?><pub-id pub-id-type="pmid">21198554</pub-id></mixed-citation>
    </ref>
    <ref id="B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kærn</surname><given-names>M.</given-names></name><name><surname>Elston</surname><given-names>T. C.</given-names></name><name><surname>Blake</surname><given-names>W. J.</given-names></name><name><surname>Collins</surname><given-names>J. J.</given-names></name></person-group> (<year>2005</year>). <article-title>Stochasticity in gene expression: from theories to phenotypes</article-title>. <source>Nat. Rev. Genet.</source>
<volume>6</volume>, <fpage>451</fpage>–<lpage>464</lpage>. <pub-id pub-id-type="doi">10.1038/nrg1615</pub-id><?supplied-pmid 15883588?><pub-id pub-id-type="pmid">15883588</pub-id></mixed-citation>
    </ref>
    <ref id="B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kalisky</surname><given-names>T.</given-names></name><name><surname>Oriel</surname><given-names>S.</given-names></name><name><surname>Bar-Lev</surname><given-names>T. H.</given-names></name><name><surname>Ben-Haim</surname><given-names>N.</given-names></name><name><surname>Trink</surname><given-names>A.</given-names></name><name><surname>Wineberg</surname><given-names>Y.</given-names></name><etal/></person-group>. (<year>2018</year>). <article-title>A brief review of single-cell transcriptomic technologies</article-title>. <source>Brief. Funct. Genomics</source><volume>17</volume>, <fpage>64</fpage>–<lpage>76</lpage>. <pub-id pub-id-type="doi">10.1093/bfgp/elx019</pub-id><?supplied-pmid 28968725?><pub-id pub-id-type="pmid">28968725</pub-id></mixed-citation>
    </ref>
    <ref id="B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kiselev</surname><given-names>V. Y.</given-names></name><name><surname>Kirschner</surname><given-names>K.</given-names></name><name><surname>Schaub</surname><given-names>M. T.</given-names></name><name><surname>Andrews</surname><given-names>T.</given-names></name><name><surname>Yiu</surname><given-names>A.</given-names></name><name><surname>Chandra</surname><given-names>T.</given-names></name><etal/></person-group>. (<year>2017</year>). <article-title>SC3: consensus clustering of single-cell RNA-seq data</article-title>. <source>Nat. Methods</source><volume>14</volume>, <fpage>483</fpage>–<lpage>486</lpage>. <pub-id pub-id-type="doi">10.1038/nmeth.4236</pub-id><?supplied-pmid 28346451?><pub-id pub-id-type="pmid">28346451</pub-id></mixed-citation>
    </ref>
    <ref id="B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kumar</surname><given-names>R. M.</given-names></name><name><surname>Cahan</surname><given-names>P.</given-names></name><name><surname>Shalek</surname><given-names>A. K.</given-names></name><name><surname>Satija</surname><given-names>R.</given-names></name><name><surname>DaleyKeyser</surname><given-names>A. J.</given-names></name><name><surname>Li</surname><given-names>H.</given-names></name><etal/></person-group>. (<year>2014</year>). <article-title>Deconstructing transcriptional heterogeneity in pluripotent stem cells</article-title>. <source>Nature</source><volume>516</volume>, <fpage>56</fpage>–<lpage>61</lpage>. <pub-id pub-id-type="doi">10.1038/nature13920</pub-id><?supplied-pmid 25471879?><pub-id pub-id-type="pmid">25471879</pub-id></mixed-citation>
    </ref>
    <ref id="B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lin</surname><given-names>P.</given-names></name><name><surname>Troup</surname><given-names>M.</given-names></name><name><surname>Ho</surname><given-names>J. W. K.</given-names></name></person-group> (<year>2017</year>). <article-title>CIDR: Ultrafast and accurate clustering through imputation for single-cell RNA-seq data</article-title>. <source>Genome Biol.</source>
<volume>18</volume>:<fpage>59</fpage>. <pub-id pub-id-type="doi">10.1186/s13059-017-1188-0</pub-id><?supplied-pmid 28351406?><pub-id pub-id-type="pmid">28351406</pub-id></mixed-citation>
    </ref>
    <ref id="B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Macosko</surname><given-names>E. Z.</given-names></name><name><surname>Basu</surname><given-names>A.</given-names></name><name><surname>Satija</surname><given-names>R.</given-names></name><name><surname>Nemesh</surname><given-names>J.</given-names></name><name><surname>Shekhar</surname><given-names>K.</given-names></name><name><surname>Goldman</surname><given-names>M.</given-names></name><etal/></person-group>. (<year>2015</year>). <article-title>Highly parallel genome-wide expression profiling of individual cells using nanoliter droplets</article-title>. <source>Cell</source><volume>161</volume>, <fpage>1202</fpage>–<lpage>1214</lpage>. <pub-id pub-id-type="doi">10.1016/j.cell.2015.05.002</pub-id><?supplied-pmid 26000488?><pub-id pub-id-type="pmid">26000488</pub-id></mixed-citation>
    </ref>
    <ref id="B24">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Mao</surname><given-names>Q.</given-names></name><name><surname>Wang</surname><given-names>L.</given-names></name><name><surname>Goodison</surname><given-names>S.</given-names></name><name><surname>Sun</surname><given-names>Y.</given-names></name></person-group> (<year>2015</year>). <article-title>Dimensionality reduction via graph structure learning</article-title>, in <source>Proceedings of the 21th ACM SIGKDD International Conference on Knowledge Discovery and Data Mining - KDD'15</source> (<publisher-loc>New York, NY</publisher-loc>: <publisher-name>ACM Press</publisher-name>), <fpage>765</fpage>–<lpage>774</lpage>.</mixed-citation>
    </ref>
    <ref id="B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Marco</surname><given-names>E.</given-names></name><name><surname>Karp</surname><given-names>R. L.</given-names></name><name><surname>Guo</surname><given-names>G.</given-names></name><name><surname>Robson</surname><given-names>P.</given-names></name><name><surname>Hart</surname><given-names>A. H.</given-names></name><name><surname>Trippa</surname><given-names>L.</given-names></name><etal/></person-group>. (<year>2014</year>). <article-title>Bifurcation analysis of single-cell gene expression data reveals epigenetic landscape</article-title>. <source>Proc. Natl. Acad. Sci. U.S.A.</source><volume>111</volume>, <fpage>5643</fpage>–<lpage>5650</lpage>. <pub-id pub-id-type="doi">10.1073/pnas.1408993111</pub-id><?supplied-pmid 25512504?><pub-id pub-id-type="pmid">25512504</pub-id></mixed-citation>
    </ref>
    <ref id="B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Moignard</surname><given-names>V.</given-names></name><name><surname>Macaulay</surname><given-names>I. C.</given-names></name><name><surname>Swiers</surname><given-names>G.</given-names></name><name><surname>Buettner</surname><given-names>F.</given-names></name><name><surname>Schütte</surname><given-names>J.</given-names></name><name><surname>Calero-Nieto</surname><given-names>F. J.</given-names></name><etal/></person-group>. (<year>2013</year>). <article-title>Characterization of transcriptional networks in blood stem and progenitor cells using high-throughput single-cell gene expression analysis</article-title>. <source>Nat. Cell Biol.</source><volume>15</volume>, <fpage>363</fpage>–<lpage>372</lpage>. <pub-id pub-id-type="doi">10.1038/ncb2709</pub-id><?supplied-pmid 23524953?><pub-id pub-id-type="pmid">23524953</pub-id></mixed-citation>
    </ref>
    <ref id="B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ng</surname><given-names>E. S.</given-names></name><name><surname>Azzola</surname><given-names>L.</given-names></name><name><surname>Sourris</surname><given-names>K.</given-names></name><name><surname>Robb</surname><given-names>L.</given-names></name><name><surname>Stanley</surname><given-names>E. G.</given-names></name><name><surname>Elefanty</surname><given-names>A. G.</given-names></name></person-group> (<year>2005</year>). <article-title>The primitive streak gene Mixl1 is required for efficient haematopoiesis and BMP4-induced ventral mesoderm patterning in differentiating ES cells</article-title>. <source>Development</source>
<volume>132</volume>, <fpage>873</fpage>–<lpage>874</lpage>. <pub-id pub-id-type="doi">10.1242/dev.01657</pub-id><?supplied-pmid 15673572?><pub-id pub-id-type="pmid">15673572</pub-id></mixed-citation>
    </ref>
    <ref id="B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ng</surname><given-names>V. Y.</given-names></name><name><surname>Ang</surname><given-names>S. N.</given-names></name><name><surname>Chan</surname><given-names>J. X.</given-names></name><name><surname>Choo</surname><given-names>A. B. H.</given-names></name></person-group> (<year>2010</year>). <article-title>Characterization of Epithelial cell adhesion molecule as a surface marker on undifferentiated human embryonic stem cells</article-title>. <source>Stem Cells</source>
<volume>28</volume>, <fpage>29</fpage>–<lpage>35</lpage>. <pub-id pub-id-type="doi">10.1002/stem.221</pub-id><?supplied-pmid 19785009?><pub-id pub-id-type="pmid">19785009</pub-id></mixed-citation>
    </ref>
    <ref id="B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Peccoud</surname><given-names>J.</given-names></name><name><surname>Ycart</surname><given-names>B.</given-names></name></person-group> (<year>1995</year>). <article-title>Markovian modeling of gene-product synthesis</article-title>. <source>Theor. Popul. Biol.</source>
<volume>48</volume>, <fpage>222</fpage>–<lpage>234</lpage>. <pub-id pub-id-type="doi">10.1006/tpbi.1995.1027</pub-id></mixed-citation>
    </ref>
    <ref id="B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pierson</surname><given-names>E.</given-names></name><name><surname>Yau</surname><given-names>C.</given-names></name></person-group> (<year>2015</year>). <article-title>ZIFA: dimensionality reduction for zero-inflated single-cell gene expression analysis</article-title>. <source>Genome Biol.</source>
<volume>16</volume>:<fpage>241</fpage>. <pub-id pub-id-type="doi">10.1186/s13059-015-0805-z</pub-id><?supplied-pmid 26527291?><pub-id pub-id-type="pmid">26527291</pub-id></mixed-citation>
    </ref>
    <ref id="B31">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Qiu</surname><given-names>X.</given-names></name><name><surname>Ding</surname><given-names>S.</given-names></name><name><surname>Shi</surname><given-names>T.</given-names></name></person-group> (<year>2012</year>). <article-title>From understanding the development landscape of the canonical fate-switch pair to constructing a dynamic landscape for two-step neural differentiation</article-title>. <source>PLoS ONE</source>
<volume>7</volume>:<fpage>e49271</fpage>. <pub-id pub-id-type="doi">10.1371/journal.pone.0049271</pub-id><?supplied-pmid 23300518?><pub-id pub-id-type="pmid">23300518</pub-id></mixed-citation>
    </ref>
    <ref id="B32">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Qiu</surname><given-names>X.</given-names></name><name><surname>Mao</surname><given-names>Q.</given-names></name><name><surname>Tang</surname><given-names>Y.</given-names></name><name><surname>Wang</surname><given-names>L.</given-names></name><name><surname>Chawla</surname><given-names>R.</given-names></name><name><surname>Pliner</surname><given-names>H. A.</given-names></name><etal/></person-group>. (<year>2017</year>). <article-title>Reversed graph embedding resolves complex single-cell trajectories</article-title>. <source>Nat. Methods</source><volume>14</volume>, <fpage>979</fpage>–<lpage>982</lpage>. <pub-id pub-id-type="doi">10.1038/nmeth.4402</pub-id><?supplied-pmid 28825705?><pub-id pub-id-type="pmid">28825705</pub-id></mixed-citation>
    </ref>
    <ref id="B33">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Qiu</surname><given-names>X.</given-names></name><name><surname>Rahimzamani</surname><given-names>A.</given-names></name><name><surname>Wang</surname><given-names>L.</given-names></name><name><surname>Mao</surname><given-names>Q.</given-names></name><name><surname>Durham</surname><given-names>T.</given-names></name><name><surname>Mcfaline-Figueroa</surname><given-names>J. L.</given-names></name><etal/></person-group> (<year>2018</year>). <article-title>Towards inferring causal gene regulatory networks from single cell expression measurements</article-title>. <source>bioRxiv</source>
<volume>426981</volume>
<pub-id pub-id-type="doi">10.1101/426981</pub-id></mixed-citation>
    </ref>
    <ref id="B34">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Raj</surname><given-names>A.</given-names></name><name><surname>Peskin</surname><given-names>C. S.</given-names></name><name><surname>Tranchina</surname><given-names>D.</given-names></name><name><surname>Vargas</surname><given-names>D. Y.</given-names></name><name><surname>Tyagi</surname><given-names>S.</given-names></name></person-group> (<year>2006</year>). <article-title>Stochastic mRNA synthesis in mammalian cells</article-title>. <source>PLoS Biol.</source>
<volume>4</volume>:<fpage>e309</fpage>. <pub-id pub-id-type="doi">10.1371/journal.pbio.0040309</pub-id><?supplied-pmid 17048983?><pub-id pub-id-type="pmid">17048983</pub-id></mixed-citation>
    </ref>
    <ref id="B35">
      <mixed-citation publication-type="webpage"><person-group person-group-type="author"><name><surname>Ralston</surname><given-names>A.</given-names></name><name><surname>Shaw</surname><given-names>K.</given-names></name></person-group> (<year>2008</year>). <article-title>Gene expression regulates cell differentiation</article-title>. <source>Nat. Educ.</source> 1, 127. Available online at: <ext-link ext-link-type="uri" xlink:href="https://www.nature.com/scitable/topicpage/gene-expression-regulates-cell-differentiation-931/">https://www.nature.com/scitable/topicpage/gene-expression-regulates-cell-differentiation-931/</ext-link></mixed-citation>
    </ref>
    <ref id="B36">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Reinius</surname><given-names>B.</given-names></name><name><surname>Plaza Reyes</surname><given-names>A.</given-names></name><name><surname>Edsgärd</surname><given-names>D.</given-names></name><name><surname>Codeluppi</surname><given-names>S.</given-names></name><name><surname>Petropoulos</surname><given-names>S.</given-names></name><name><surname>Deng</surname><given-names>Q.</given-names></name><etal/></person-group>. (<year>2016</year>). <article-title>Single-Cell RNA-seq reveals lineage and X chromosome dynamics in human preimplantation embryos</article-title>. <source>Cell</source><volume>165</volume>, <fpage>1012</fpage>–<lpage>1026</lpage>. <pub-id pub-id-type="doi">10.1016/j.cell.2016.03.023</pub-id><?supplied-pmid 27062923?><pub-id pub-id-type="pmid">27062923</pub-id></mixed-citation>
    </ref>
    <ref id="B37">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Richard</surname><given-names>A.</given-names></name><name><surname>Boullu</surname><given-names>L.</given-names></name><name><surname>Herbach</surname><given-names>U.</given-names></name><name><surname>Bonnafoux</surname><given-names>A.</given-names></name><name><surname>Morin</surname><given-names>V.</given-names></name><name><surname>Vallin</surname><given-names>E.</given-names></name><etal/></person-group>. (<year>2016</year>). <article-title>Single-cell-based analysis highlights a surge in cell-to-cell molecular variability preceding irreversible commitment in a differentiation process</article-title>. <source>PLoS Biol.</source><volume>14</volume>:<fpage>e1002585</fpage>. <pub-id pub-id-type="doi">10.1371/journal.pbio.1002585</pub-id><?supplied-pmid 28027290?><pub-id pub-id-type="pmid">28027290</pub-id></mixed-citation>
    </ref>
    <ref id="B38">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sathyamurthy</surname><given-names>A.</given-names></name><name><surname>Johnson</surname><given-names>K. R.</given-names></name><name><surname>Matson</surname><given-names>K. J. E.</given-names></name><name><surname>Dobrott</surname><given-names>C. I.</given-names></name><name><surname>Li</surname><given-names>L.</given-names></name><name><surname>Ryba</surname><given-names>A. R.</given-names></name><etal/></person-group>. (<year>2018</year>). <article-title>Massively parallel single nucleus transcriptional profiling defines spinal cord neurons and their activity during behavior</article-title>. <source>Cell Rep.</source><volume>22</volume>, <fpage>2216</fpage>–<lpage>2225</lpage>. <pub-id pub-id-type="doi">10.1016/j.celrep.2018.02.003</pub-id><?supplied-pmid 29466745?><pub-id pub-id-type="pmid">29466745</pub-id></mixed-citation>
    </ref>
    <ref id="B39">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Smoot</surname><given-names>M. E.</given-names></name><name><surname>Ono</surname><given-names>K.</given-names></name><name><surname>Ruscheinski</surname><given-names>J.</given-names></name><name><surname>Wang</surname><given-names>P.-L.</given-names></name><name><surname>Ideker</surname><given-names>T.</given-names></name></person-group> (<year>2011</year>). <article-title>Cytoscape 2.8: new features for data integration and network visualization</article-title>. <source>Bioinformatics</source>
<volume>27</volume>, <fpage>431</fpage>–<lpage>432</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btq675</pub-id><?supplied-pmid 21149340?><pub-id pub-id-type="pmid">21149340</pub-id></mixed-citation>
    </ref>
    <ref id="B40">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stuart</surname><given-names>T.</given-names></name><name><surname>Satija</surname><given-names>R.</given-names></name></person-group> (<year>2019</year>). <article-title>Integrative single-cell analysis</article-title>. <source>Nat. Rev. Genet.</source>
<volume>20</volume>, <fpage>257</fpage>–<lpage>272</lpage>. <pub-id pub-id-type="doi">10.1038/s41576-019-0093-7</pub-id><?supplied-pmid 30696980?><pub-id pub-id-type="pmid">30696980</pub-id></mixed-citation>
    </ref>
    <ref id="B41">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stumpf</surname><given-names>P. S.</given-names></name><name><surname>Smith</surname><given-names>R. C. G.</given-names></name><name><surname>Lenz</surname><given-names>M.</given-names></name><name><surname>Schuppert</surname><given-names>A.</given-names></name><name><surname>Müller</surname><given-names>F.-J.</given-names></name><name><surname>Babtie</surname><given-names>A.</given-names></name><etal/></person-group>. (<year>2017</year>). <article-title>Stem cell differentiation as a non-markov stochastic process</article-title>. <source>Cell Syst.</source><volume>5</volume>, <fpage>268</fpage>–<lpage>282.e7</lpage>. <pub-id pub-id-type="doi">10.1016/j.cels.2017.08.009</pub-id><?supplied-pmid 28957659?><pub-id pub-id-type="pmid">28957659</pub-id></mixed-citation>
    </ref>
    <ref id="B42">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Thomas</surname><given-names>T.</given-names></name><name><surname>Nowka</surname><given-names>K.</given-names></name><name><surname>Lan</surname><given-names>L.</given-names></name><name><surname>Derwahl</surname><given-names>M.</given-names></name></person-group> (<year>2006</year>). <article-title>Expression of endoderm stem cell markers: evidence for the presence of adult stem cells in human thyroid glands</article-title>. <source>Thyroid</source>
<volume>16</volume>, <fpage>537</fpage>–<lpage>544</lpage>. <pub-id pub-id-type="doi">10.1089/thy.2006.16.537</pub-id><?supplied-pmid 16839255?><pub-id pub-id-type="pmid">16839255</pub-id></mixed-citation>
    </ref>
    <ref id="B43">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tiyaboonchai</surname><given-names>A.</given-names></name><name><surname>Cardenas-Diaz</surname><given-names>F. L.</given-names></name><name><surname>Ying</surname><given-names>L.</given-names></name><name><surname>Maguire</surname><given-names>J. A.</given-names></name><name><surname>Sim</surname><given-names>X.</given-names></name><name><surname>Jobaliya</surname><given-names>C.</given-names></name><etal/></person-group>. (<year>2017</year>). <article-title>GATA6 Plays an important role in the induction of human definitive endoderm, development of the pancreas, and functionality of pancreatic β cells</article-title>. <source>Stem Cell Rep.</source><volume>8</volume>, <fpage>589</fpage>–<lpage>604</lpage>. <pub-id pub-id-type="doi">10.1016/j.stemcr.2016.12.026</pub-id><?supplied-pmid 28196690?><pub-id pub-id-type="pmid">28196690</pub-id></mixed-citation>
    </ref>
    <ref id="B44">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Trapnell</surname><given-names>C.</given-names></name><name><surname>Cacchiarelli</surname><given-names>D.</given-names></name><name><surname>Grimsby</surname><given-names>J.</given-names></name><name><surname>Pokharel</surname><given-names>P.</given-names></name><name><surname>Li</surname><given-names>S.</given-names></name><name><surname>Morse</surname><given-names>M.</given-names></name><etal/></person-group>. (<year>2014</year>). <article-title>The dynamics and regulators of cell fate decisions are revealed by pseudotemporal ordering of single cells</article-title>. <source>Nat. Biotechnol.</source><volume>32</volume>, <fpage>381</fpage>–<lpage>386</lpage>. <pub-id pub-id-type="doi">10.1038/nbt.2859</pub-id><?supplied-pmid 24658644?><pub-id pub-id-type="pmid">24658644</pub-id></mixed-citation>
    </ref>
    <ref id="B45">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Treutlein</surname><given-names>B.</given-names></name><name><surname>Lee</surname><given-names>Q. Y.</given-names></name><name><surname>Camp</surname><given-names>J. G.</given-names></name><name><surname>Mall</surname><given-names>M.</given-names></name><name><surname>Koh</surname><given-names>W.</given-names></name><name><surname>Shariati</surname><given-names>S. A. M.</given-names></name><etal/></person-group>. (<year>2016</year>). <article-title>Dissecting direct reprogramming from fibroblast to neuron using single-cell RNA-seq</article-title>. <source>Nature</source><volume>534</volume>, <fpage>391</fpage>–<lpage>395</lpage>. <pub-id pub-id-type="doi">10.1038/nature18323</pub-id><?supplied-pmid 27281220?><pub-id pub-id-type="pmid">27281220</pub-id></mixed-citation>
    </ref>
    <ref id="B46">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wolf</surname><given-names>F. A.</given-names></name><name><surname>Angerer</surname><given-names>P.</given-names></name><name><surname>Theis</surname><given-names>F. J.</given-names></name></person-group> (<year>2018</year>). <article-title>SCANPY: large-scale single-cell gene expression data analysis</article-title>. <source>Genome Biol.</source>
<volume>19</volume>:<fpage>15</fpage>. <pub-id pub-id-type="doi">10.1186/s13059-017-1382-0</pub-id><?supplied-pmid 29409532?><pub-id pub-id-type="pmid">29409532</pub-id></mixed-citation>
    </ref>
    <ref id="B47">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wolf</surname><given-names>F. A.</given-names></name><name><surname>Hamey</surname><given-names>F. K.</given-names></name><name><surname>Plass</surname><given-names>M.</given-names></name><name><surname>Solana</surname><given-names>J.</given-names></name><name><surname>Dahlin</surname><given-names>J. S.</given-names></name><name><surname>Göttgens</surname><given-names>B.</given-names></name><etal/></person-group>. (<year>2019</year>). <article-title>PAGA: graph abstraction reconciles clustering with trajectory inference through a topology preserving map of single cells</article-title>. <source>Genome Biol.</source><volume>20</volume>:<fpage>59</fpage>. <pub-id pub-id-type="doi">10.1186/s13059-019-1663-x</pub-id><?supplied-pmid 30890159?><pub-id pub-id-type="pmid">30890159</pub-id></mixed-citation>
    </ref>
    <ref id="B48">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Xu</surname><given-names>C.</given-names></name><name><surname>Su</surname><given-names>Z.</given-names></name></person-group> (<year>2015</year>). <article-title>Identification of cell types from single-cell transcriptomes using a novel clustering method</article-title>. <source>Bioinformatics</source>
<volume>31</volume>, <fpage>1974</fpage>–<lpage>1980</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btv088</pub-id><?supplied-pmid 25805722?><pub-id pub-id-type="pmid">25805722</pub-id></mixed-citation>
    </ref>
    <ref id="B49">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zeng</surname><given-names>W.</given-names></name><name><surname>Chen</surname><given-names>X.</given-names></name><name><surname>Duren</surname><given-names>Z.</given-names></name><name><surname>Wang</surname><given-names>Y.</given-names></name><name><surname>Jiang</surname><given-names>R.</given-names></name><name><surname>Wong</surname><given-names>W. H.</given-names></name></person-group> (<year>2019</year>). <article-title>DC3 is a method for deconvolution and coupled clustering from bulk and single-cell genomics data</article-title>. <source>Nat. Commun.</source>
<volume>10</volume>:<fpage>4613</fpage>. <pub-id pub-id-type="doi">10.1038/s41467-019-12547-1</pub-id><?supplied-pmid 31601804?><pub-id pub-id-type="pmid">31601804</pub-id></mixed-citation>
    </ref>
    <ref id="B50">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zheng</surname><given-names>G. X. Y.</given-names></name><name><surname>Terry</surname><given-names>J. M.</given-names></name><name><surname>Belgrader</surname><given-names>P.</given-names></name><name><surname>Ryvkin</surname><given-names>P.</given-names></name><name><surname>Bent</surname><given-names>Z. W.</given-names></name><name><surname>Wilson</surname><given-names>R.</given-names></name><etal/></person-group>. (<year>2017</year>). <article-title>Massively parallel digital transcriptional profiling of single cells</article-title>. <source>Nat. Commun.</source><volume>8</volume>:<fpage>14049</fpage>. <pub-id pub-id-type="doi">10.1038/ncomms14049</pub-id><?supplied-pmid 28091601?><pub-id pub-id-type="pmid">28091601</pub-id></mixed-citation>
    </ref>
    <ref id="B51">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Žurauskiene</surname><given-names>J.</given-names></name><name><surname>Yau</surname><given-names>C.</given-names></name></person-group> (<year>2016</year>). <article-title>pcaReduce: hierarchical clustering of single cell transcriptional profiles</article-title>. <source>BMC Bioinform.</source>
<volume>17</volume>:<fpage>140</fpage>. <pub-id pub-id-type="doi">10.1186/s12859-016-0984-y</pub-id><?supplied-pmid 27005807?><pub-id pub-id-type="pmid">27005807</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
