<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">4769497</article-id>
    <article-id pub-id-type="publisher-id">966</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-016-0966-0</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>HPG pore: an efficient and scalable framework for nanopore sequencing data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Tarraga</surname>
          <given-names>Joaquin</given-names>
        </name>
        <address>
          <email>jtarraga@cipf.es</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Gallego</surname>
          <given-names>Asunción</given-names>
        </name>
        <address>
          <email>agallego@cipf.es</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Arnau</surname>
          <given-names>Vicente</given-names>
        </name>
        <address>
          <email>Vicente.Arnau@uv.es</email>
        </address>
        <xref ref-type="aff" rid="Aff2"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Medina</surname>
          <given-names>Ignacio</given-names>
        </name>
        <address>
          <email>im411@cam.ac.uk</email>
        </address>
        <xref ref-type="aff" rid="Aff3"/>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-3318-120X</contrib-id>
        <name>
          <surname>Dopazo</surname>
          <given-names>Joaquin</given-names>
        </name>
        <address>
          <email>jdopazo@cipf.es</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
        <xref ref-type="aff" rid="Aff4"/>
        <xref ref-type="aff" rid="Aff5"/>
      </contrib>
      <aff id="Aff1"><label/>Computational Genomics Department, Centro de Investigación Príncipe Felipe (CIPF), Valencia, 46012 Spain </aff>
      <aff id="Aff2"><label/>Departamento de Informática, ETSE, Universidad de Valencia, Valencia, Spain </aff>
      <aff id="Aff3"><label/>HPC Service, University Information Services, University of Cambridge, Cambridge, UK </aff>
      <aff id="Aff4"><label/>Bioinformatics of Rare Diseases (BIER), CIBER de Enfermedades Raras (CIBERER), Valencia, Spain </aff>
      <aff id="Aff5"><label/>Functional Genomics Node, (INB) at CIPF, Valencia, 46012 Spain </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>27</day>
      <month>2</month>
      <year>2016</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>27</day>
      <month>2</month>
      <year>2016</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2016</year>
    </pub-date>
    <volume>17</volume>
    <elocation-id>107</elocation-id>
    <history>
      <date date-type="received">
        <day>3</day>
        <month>9</month>
        <year>2015</year>
      </date>
      <date date-type="accepted">
        <day>22</day>
        <month>2</month>
        <year>2016</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© Tarraga et al. 2016</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold>This article is distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p>The use of nanopore technologies is expected to spread in the future because they are portable and can sequence long fragments of DNA molecules without prior amplification. The first nanopore sequencer available, the MinION™ from Oxford Nanopore Technologies, is a USB-connected, portable device that allows real-time DNA analysis. In addition, other new instruments are expected to be released soon, which promise to outperform the current short-read technologies in terms of throughput. Despite the flood of data expected from this technology, the data analysis solutions currently available are only designed to manage small projects and are not scalable.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p>Here we present HPG Pore, a toolkit for exploring and analysing nanopore sequencing data. HPG Pore can run on both individual computers and in the Hadoop distributed computing framework, which allows easy scale-up to manage the large amounts of data expected to result from extensive use of nanopore technologies in the future.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p>HPG Pore allows for virtually unlimited sequencing data scalability, thus guaranteeing its continued management in near future scenarios. HPG Pore is available in GitHub at <ext-link ext-link-type="uri" xlink:href="http://github.com/opencb/hpg-pore">http://github.com/opencb/hpg-pore</ext-link>.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100003329</institution-id>
            <institution>Ministerio de Economía y Competitividad (ES)</institution>
          </institution-wrap>
        </funding-source>
        <award-id>BIO2014-57291-R</award-id>
        <principal-award-recipient>
          <name>
            <surname>Dopazo</surname>
            <given-names>Joaquin</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100000780</institution-id>
            <institution>European Commission (BE)</institution>
          </institution-wrap>
        </funding-source>
        <award-id>MLPM2012 318861</award-id>
        <principal-award-recipient>
          <name>
            <surname>Dopazo</surname>
            <given-names>Joaquin</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100003359</institution-id>
            <institution>Generalitat Valenciana (ES)</institution>
          </institution-wrap>
        </funding-source>
        <award-id>PROMETEOII/2014/025</award-id>
        <principal-award-recipient>
          <name>
            <surname>Dopazo</surname>
            <given-names>Joaquin</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2016</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1" sec-type="introduction">
    <title>Background</title>
    <p>In the beginning of 2014, Oxford Nanopore Technologies (ONT) released MinION<sup>TM</sup>, the first DNA sequencing device based on biological nanopores, in a limited access program that enabled researchers to use the technology for the first time. MinION<sup>TM</sup> is one of the few single-molecule sequencing technologies available that produces very long reads. Moreover, MinION<sup>TM</sup> constitutes the first portable high-throughput sequencer. It is the size of a smartphone and connects through a USB port to any internet-connected computer. While the technology initially produced data with a substantial amount of noise, recent practical applications have significantly demonstrated improved data quality [<xref ref-type="bibr" rid="CR1">1</xref>, <xref ref-type="bibr" rid="CR2">2</xref>]. In addition, a recent report has also revealed remarkable improvements in accuracy due to enhancement of the sequencing chemistry, to the present level of 85 % for DNA reads from both strands [<xref ref-type="bibr" rid="CR3">3</xref>]. The low cost, portability and the production of very long reads, along with a clear improvement in the quality, makes this technology one of the most promising high-throughput sequencing technologies available [<xref ref-type="bibr" rid="CR4">4</xref>]. Nanopore sequencing has been successfully used to sequence bacterial genomes [<xref ref-type="bibr" rid="CR5">5</xref>, <xref ref-type="bibr" rid="CR6">6</xref>], viral genomes [<xref ref-type="bibr" rid="CR7">7</xref>] and eukaryotic genomes, such as yeast [<xref ref-type="bibr" rid="CR8">8</xref>] or drosophila [<xref ref-type="bibr" rid="CR9">9</xref>], either alone or, in combination with short read technologies [<xref ref-type="bibr" rid="CR10">10</xref>]. Also, Nanopore sequencing technology has demonstrated its efficacy in clinics for real-time pathogen surveillance [<xref ref-type="bibr" rid="CR11">11</xref>], because it can rapidly identify strains [<xref ref-type="bibr" rid="CR12">12</xref>] and detect resistance genes [<xref ref-type="bibr" rid="CR13">13</xref>], or even detecting structural variation in cancer [<xref ref-type="bibr" rid="CR14">14</xref>].</p>
    <p>Initially, the use of the MinION<sup>TM</sup> sequencer was restricted to Windows laptops using specific cloud-based software, <italic>metrichor</italic>, for data handling and variant calling. The sequencer outputs binary files in the HDF5 format (<ext-link ext-link-type="uri" xlink:href="http://www.hdfgroup.org/HDF5/">http://www.hdfgroup.org/HDF5/</ext-link>), which once called result in 30–50 thousand binary files. However, there was no software available for accessing the data. Very recently, alternative solutions for data management and visualization have been proposed that provide more data management and visualization options and expand its use to other computer environments by using R (<ext-link ext-link-type="uri" xlink:href="http://www.r-project.org/">http://www.R-project.org/</ext-link>; R Core Team, 2014) [<xref ref-type="bibr" rid="CR15">15</xref>, <xref ref-type="bibr" rid="CR16">16</xref>]. However, the software available was devised for managing small individual projects with a relatively low throughput, corresponding to the present-day version of the MinION<sup>TM</sup> instrument. New instruments, such as the PromethION<sup>TM</sup> and the GridION<sup>TM</sup> are expected to be released during this year. Such devices are parallelized versions of the MinION<sup>TM</sup> instrument, with an expected throughput which will overrun those of short read technologies. ONT anticipates that the current MinIon MkI will be able to generate up to 40 gigabases per run, the MinIon MkII up to 120 gigabases per run, and the PromethIon up to 6.4 terabases per run (<ext-link ext-link-type="uri" xlink:href="https://goo.gl/RRPXGc">https://goo.gl/RRPXGc</ext-link>). With the aim of being scalable to cope with the foreseeable increasing amounts of data generated by this technology in the near future, here we present HPG pore, a scalable toolkit for exploring and analyzing nanopore sequencing data that can run on both single computers and the Hadoop distributed computing framework.</p>
  </sec>
  <sec id="Sec2">
    <title>Implementation</title>
    <sec id="Sec3">
      <title>The MinION<sup>TM</sup> data format</title>
      <p>The MinION<sup>TM</sup> sequencer outputs binary files in the HDF5 format (<ext-link ext-link-type="uri" xlink:href="http://www.hdfgroup.org/HDF5/">http://www.hdfgroup.org/HDF5/</ext-link>). The calling process generates one file for each MinION<sup>TM</sup> read, which amounts between 30 and 50 thousands of individual FAST5 files (called HDF5 files with.FAST5 extension). Such files can contain a template read, and a complement read or a two-direction (2D) read (a combination of both the template and the complementary reads produced by the base-calling algorithm), alone or in any combination. The template reads are derived from the first of the two DNA strands presented to the nanopore. In the process of sequence reading, a processive motor enzyme, ligated to the leader adapter, slows down the template strands. Hairpins permit reading of the complementary strand, which produces the complement read. The change between these two sequences is recognized by the pore because an AP (apurinic/apyrimidinic) site located in the hairpin produces a specific signal. A different enzyme (named HP motor) has the mission of slowing down the complement strand. The optimal operation of the MinION<sup>TM</sup> is attained when all these molecules are present and the hairpin successfully ligates both DNA strands, which then traverses the pore producing the 2D reads [<xref ref-type="bibr" rid="CR2">2</xref>].</p>
      <p>In addition, a FAST5 file also contains meta-information for that read and the electronic signal measured over time as a DNA molecule passes through the nanopore. A FAST5 file contains a set of hierarchical groups (with the template and complementary read), datasets and attributes (as any HDF5 file) and all the required model parameters used by the HMM for base calling. The content of FAST5 files can be visualized using the HDFView application (<ext-link ext-link-type="uri" xlink:href="http://www.hdfgroup.org/products/java/hdfview/">http://www.hdfgroup.org/products/java/hdfview/</ext-link>).</p>
    </sec>
    <sec id="Sec4">
      <title>Data management</title>
      <p>HPG Pore can run both, on individual computers with a local or distributed POSIX file system such as Lustre, or on a cluster of computers by implementing the map-reduce paradigm in a Hadoop environment, the most popular open-source implementation of the map-reduce [<xref ref-type="bibr" rid="CR17">17</xref>], a distributed programming model for processing large datasets containing relatively independent data items (<ext-link ext-link-type="uri" xlink:href="http://hadoop.apache.org/">http://hadoop.apache.org/</ext-link>). It divides data between processing nodes by splitting them into chunks (defined as key-value pairs) that are then processed separately. Users specify a map function that processes a key-value pair to generate a set of intermediate key-value pairs, and a reduce function that merges all intermediate values associated with the same intermediate key.</p>
      <p>In the Hadoop environment, a Hadoop MapFile is used to store the individual FAST5 files into the Hadoop Distributed File System (HDFS, see <ext-link ext-link-type="uri" xlink:href="http://wiki.apache.org/hadoop/HDFS">http://wiki.apache.org/hadoop/HDFS</ext-link>). A MapFile is a sorted Hadoop SequenceFile with an index to enable lookups by using a key. A SequenceFile is a flat file containing key-value pairs within HPG Pore. Here, the FAST5 filename is stored as the key and the FAST5 file content as the value. Further, the Hadoop map-reduce framework automatically splits the MapFile into key-value pairs and calls the user map function with these pairs. The creation of the Hadoop MapFile from the FAST5 files is accomplished by executing the <italic>import</italic> command in the HPG Pore suite:</p>
      <p>./hpg-pore.sh import --in/local/path/to/fast5/folder --out/path/to/hdfs/file [−−compress]</p>
      <p>The most important command provided by HPG pore is the <italic>stats</italic> command to analyze and visualize the FAST5 files contents.</p>
      <p>./hpg-pore,sh stats --in/path/to/fast5/--out/local/path/to/save/stats [−−hadoop]</p>
      <p>To run the stats command on a Hadoop cluster, the --hadoop option is used. In this case the --in argument corresponds to the Hadoop Mapfile containing the FAST5 files, otherwise, it corresponds to the local FAST5 files folder. The --out argument indicates the folder where the results are saved: a subfolder for each run. Table <xref rid="Tab1" ref-type="table">1</xref> describes the resulting files.<table-wrap id="Tab1"><label>Table 1</label><caption><p>Files generated (for each run) by the stats command in HPG pore, where <italic>seq</italic> can be a template, a complement or a 2D read</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Output file name</th><th>File description</th></tr></thead><tbody><tr><td>summary.txt</td><td>Text file containing the number of reads and nucleotides, the mean, min. and max read length, nucleotide distribution, %GC, and mean quality</td></tr><tr><td><italic>seq</italic>_ length_histogram.jpg</td><td>Image of the read length histogram</td></tr><tr><td><italic>seq</italic>_content_per_pos.jpg</td><td>Image of the nucleotides (A, C, T, G, N) per position in the read</td></tr><tr><td><italic>seq</italic>_ gc_histogram.jpg</td><td>Image of the GC histogram</td></tr><tr><td><italic>seq</italic>_yield.jpg</td><td>Image of the number of nucleotides (yield) over time</td></tr><tr><td><italic>seq</italic>_ quality_histogram.jpg</td><td>Image of the read quality histogram</td></tr><tr><td><italic>seq</italic>_quality_per_pos.jpg</td><td>Image of the mean quality per position in read</td></tr><tr><td><italic>seq</italic>_ reads_per_channel.jpg</td><td>Image of the number of reads processed per channel</td></tr><tr><td><italic>seq</italic>_ yield_per_channel.jpg</td><td>Image of the number of nucleotides (yield) processed per channel</td></tr></tbody></table></table-wrap></p>
    </sec>
    <sec id="Sec5">
      <title>Extracting plotting events as well as FastQ and FASTA files</title>
      <p>The <italic>events</italic> command extracts raw data from the electronic signal measured for a given MinION<sup>TM</sup> read, and the signal command plots that signal over time (Fig. <xref rid="Fig1" ref-type="fig">1</xref>).<fig id="Fig1"><label>Fig. 1</label><caption><p>Electronic signal measured for each nanopore translocation event over time for a given MinION<sup>TM</sup> template read</p></caption><graphic xlink:href="12859_2016_966_Fig1_HTML" id="MO1"/></fig></p>
      <p>Finally, users can also extract the sequences in FastQ and FASTA formats by executing the <italic>fastq</italic> and <italic>fasta</italic> commands respectively:</p>
      <p>./hpg-pore.sh fastq --in/path/to/fast5/--out/local/path/to/save/fastq/sequences [−−hadoop]</p>
      <p>./hpg-pore.sh fasta --in/path/to/fast5/--out/local/path/to/save/fasta/sequences [−−hadoop]</p>
    </sec>
    <sec id="Sec6">
      <title>Availability</title>
      <p>The HPG Pore is open source. This cross-platform software is written in Java and is available on GitHub at <ext-link ext-link-type="uri" xlink:href="http://github.com/opencb/hpg-pore">http://github.com/opencb/hpg-pore</ext-link>. A tutorial and further documentation are available at <ext-link ext-link-type="uri" xlink:href="http://github.com/opencb/hpg-pore/wiki">http://github.com/opencb/hpg-pore/wiki</ext-link></p>
    </sec>
  </sec>
  <sec id="Sec7" sec-type="results">
    <title>Results and discussion</title>
    <sec id="Sec8">
      <title>Features</title>
      <p>HPG Pore has a number of features in common with the poRe and Poretools programs, but also implements several useful unique features related to quality control and other parameters of the sequence obtained, such as mean read quality, %GC, as well as plots per base sequence content and read quality histograms, among others. Some of the features that differentiate the programs originate in the different ways in which data files are managed. For instance, poRe produces one individual file for each sequence in the HDF5 file, which can cause problems with file systems quotas if a large number of reads are present in the HDF5 file. In contrast HPG Pore produces three files containing the three types of reads (template, complement and 2D), which is more convenient for further mapping with other software. Table <xref rid="Tab2" ref-type="table">2</xref> summarizes the HPG Pore features and compares them to those implemented in poRe and Poretools.<table-wrap id="Tab2"><label>Table 2</label><caption><p>Comparison of HPG Pore to the other tools available</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Feature</th><th>HPG Pore</th><th>poRe</th><th>Poretools</th></tr></thead><tbody><tr><td>Extract FASTq</td><td>Y</td><td>Y</td><td>Y</td></tr><tr><td>Extract FASTA</td><td>Y</td><td>Y</td><td>Y</td></tr><tr><td>Organise fast5 into run folders</td><td>–</td><td>Y</td><td>–</td></tr><tr><td>Create tar files of runs</td><td>–</td><td>–</td><td>Y</td></tr><tr><td>Organise the results into run folders</td><td>Y</td><td>–</td><td>–</td></tr><tr><td>Plot yield</td><td>Y</td><td>Y</td><td>Y</td></tr><tr><td>Plot squiggle</td><td>Y</td><td>Y</td><td>Y</td></tr><tr><td>Extract run stats</td><td>Y</td><td>Y</td><td>Y</td></tr><tr><td>Read length histogram</td><td>Y</td><td>Y</td><td>Y</td></tr><tr><td>read length (max., avg., min)</td><td>Y</td><td>Y</td><td>Y</td></tr><tr><td>Mean read quality</td><td>Y</td><td>–</td><td>–</td></tr><tr><td>Nucleotides content: count and %</td><td>Y</td><td>–</td><td>Y<sup>1</sup>
</td></tr><tr><td>%GC</td><td>Y</td><td>–</td><td>–</td></tr><tr><td>Plot Frequency- %GC</td><td>Y</td><td>–</td><td>–</td></tr><tr><td>Plot per base sequence content</td><td>Y</td><td>–</td><td>–</td></tr><tr><td>Read quality histogram</td><td>Y</td><td>–</td><td>–</td></tr><tr><td>Reads per channel histogram</td><td>Y</td><td>Y</td><td>Y<sup>2</sup>
</td></tr><tr><td>Nucleotides per channel histogram</td><td>Y</td><td>Y</td><td>–</td></tr></tbody></table><table-wrap-foot><p>1 Poretools does not display the nucleotide content percentage, only counts</p><p>2 Poretools returns the occupancy of pores, not the reads per channel</p></table-wrap-foot></table-wrap></p>
      <p>Like poRe and Poretools, HPG Pore produces FastQ files that can be used for downstream analysis with any conventional tool for read mapping and further variation (point mutations [<xref ref-type="bibr" rid="CR12">12</xref>, <xref ref-type="bibr" rid="CR13">13</xref>] or structural variants [<xref ref-type="bibr" rid="CR14">14</xref>]) analysis, genome assembly [<xref ref-type="bibr" rid="CR13">13</xref>], etc. Recently appeared programs, such as NanoOK [<xref ref-type="bibr" rid="CR18">18</xref>], provides built-in downstream analysis with an environment in which alignment can be carried out and different statistics can be obtained. However, the optimal benefit would be obtained in a near future scenario in which downstream analysis tools can natively run in the Hadoop environment. In order to avoid the transfer of HDF5 and FastQ files to a local file system, we are currently implementing read mappers, such as HPG Aligner [<xref ref-type="bibr" rid="CR19">19</xref>], in Hadoop clusters.</p>
    </sec>
    <sec id="Sec9">
      <title>Runtimes and scalability</title>
      <p>Since different programs calculated different statistics, running times have been calculated for the generation of FastQ files from the original HDF5 files. The programs were ran in a Hadoop cluster with 8 nodes with 16 cores each (Intel Xeon CPU E5-2667 v2 @ 3.30GHz) and 64 GB of RAM and 12 TB distributed in 24 disks of 500GB.. We have included this information in the paper. Our study shows that runtimes in poRe, Poretools and HPG Pore (running locally) are approximately linearly dependent on the number of sequences in the FAST5 file, with a trend towards an increased slope for high numbers of sequences. HPG Pore runs the fastest, followed by Poretools, while poRe presents remarkably slower execution times (see Fig. <xref rid="Fig2" ref-type="fig">2</xref>). A specific problem with poRe is that the large amount of sequence files that it produces causes disk quota excess errors. To run the program with high number of reads this parameter must specifically be changed in the file system.<fig id="Fig2"><label>Fig. 2</label><caption><p>Runtimes of the three programs, poRe, Poretools, and HPG Pore, as a function of the number of sequences in the FAST5 file</p></caption><graphic xlink:href="12859_2016_966_Fig2_HTML" id="MO2"/></fig></p>
      <p>When HPG Pore runs in Hadoop mode it is faster than Poretools and poRe, despite an initial delay due to the preparation of the Hadoop nodes and, as expected, the speed is even faster when more nodes are available, thus it outperforms the other two programs when running in local mode (see Fig. <xref rid="Fig2" ref-type="fig">2</xref>). The latency of the Hadoop framework (see <ext-link ext-link-type="uri" xlink:href="https://goo.gl/ujNR9F">https://goo.gl/ujNR9F</ext-link>) causes the paradox that the stand alone version of HPG Pore results slightly slower than the Hadoop counterpart running on one node.</p>
      <p>Since reads are randomly distributed across nodes in the Hadoop environment we do not expect from parameters such as read length any specific effect of runtimes or performance.</p>
      <p>The Hadoop environment allows storage as well as speed to be scaled up. Figure <xref rid="Fig3" ref-type="fig">3</xref> (upper panel) shows how runtimes decrease as the number of nodes available in the cluster increases in four different scenarios: with 32,000, 100,000, 300,000 and 1 million sequences in the FAST5 file. The speed-ups are always over the ideal expected acceleration (dotted line), and the increase in speed is clearly higher for larger data sizes (Fig. <xref rid="Fig3" ref-type="fig">3</xref>, lower panel).<fig id="Fig3"><label>Fig. 3</label><caption><p>Runtimes (<italic>upper panel</italic>) and increase in speed (<italic>lower panel</italic>) as the number of nodes increase in the Hadoop system in two different scenarios: FAST5 file containing 32,000 (<italic>blue line</italic>), 100,000 (<italic>red line</italic>), 300,000 (<italic>green line</italic>) and 1 million (<italic>dark blue line</italic>) sequences. Dotted line in the lower panel represents the ideal speed-up according to the number of nodes used. Speed-ups have been calculated using 3 nodes as the starting point given that the 1 million reads could not be calculated for1 only one node</p></caption><graphic xlink:href="12859_2016_966_Fig3_HTML" id="MO3"/></fig></p>
    </sec>
  </sec>
  <sec id="Sec10" sec-type="conclusion">
    <title>Conclusions</title>
    <p>Nanopore MinION<sup>TM</sup> technologies present several advantages, such as low cost, portability and the capability to produce very long reads [<xref ref-type="bibr" rid="CR4">4</xref>] that allow anticipating an extensive use in the near future. Recently, new tools such as Poretools [<xref ref-type="bibr" rid="CR16">16</xref>], poRe [<xref ref-type="bibr" rid="CR15">15</xref>] and NanoOK [<xref ref-type="bibr" rid="CR18">18</xref>] have expanded the possibilities for nanopore data management and its use in operating systems other than Microsoft. However, such programs are designed for the relatively low throughput of current nanopore devices, and even present limitations for large datasets. Moreover, the foreseeable production of enormous amounts of nanopore data by increased throughput in the future by improved versions of MinION<sup>TM</sup> (the MkII version, up to 120 GB per run), as well as new nanopore instruments which have been announced (PromethIon, up to 6.4 TB per run), will soon require of scalable computational technologies to cope with these data. Here we present HPG Pore, the first scalable bioinformatic tool for exploring and analyzing nanopore sequencing data that can run both individual computers and in the Hadoop distributed computing framework. The Hadoop environment allows virtually unlimited scaling up in data size and provides better runtimes for datasets containing a large number of reads. HPG Pore allows efficient management of huge amounts of data and thus constitutes a practical solution for data analysis needs in the near future as well as a promising model for the development of new tools to deal with future genomic big data.</p>
  </sec>
  <sec id="Sec11">
    <title>Availability and requirements</title>
    <p><bold>Project name:</bold> HPG Pore</p>
    <p>
      <bold>Project home page:</bold>
      <ext-link ext-link-type="uri" xlink:href="http://github.com/opencb/hpg-pore">http://github.com/opencb/hpg-pore</ext-link>
    </p>
    <p><bold>Operating system(s):</bold> Linux CentOS release 6.6</p>
    <p><bold>Programming language:</bold> Java</p>
    <p><bold>Other requirements:</bold> in Hadoop mode requires Hadoop installation</p>
    <p><bold>License:</bold> Apache license</p>
    <p><bold>Any restrictions to use by non-academics:</bold> no</p>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>2D</term>
        <def>
          <p>two-direction read</p>
        </def>
      </def-item>
      <def-item>
        <term>AP</term>
        <def>
          <p>apurinic/apyrimidinic</p>
        </def>
      </def-item>
      <def-item>
        <term>HDF5</term>
        <def>
          <p>hierarchical data format version 5</p>
        </def>
      </def-item>
      <def-item>
        <term>HP</term>
        <def>
          <p>hairpin</p>
        </def>
      </def-item>
      <def-item>
        <term>HPG</term>
        <def>
          <p>high performance genomic</p>
        </def>
      </def-item>
      <def-item>
        <term>ONT</term>
        <def>
          <p>Oxford nanopore technologies</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Competing interests</bold>
      </p>
      <p>The authors declare that they have no competing interests.</p>
    </fn>
    <fn>
      <p>
        <bold>Authors’ contributions</bold>
      </p>
      <p>JT, AG and VA developed and tested the code, IM conceived the software and participated in the development, and JD participated in the conception of the software and wrote the paper. All authors read and approved the final manuscript.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>This work was supported by grants BIO2014-57291-R from the Spanish Ministry of Economy and Competitiveness (MINECO) and Plataforma de Recursos Biomoleculares y Bioinformáticos PT 13/0001/0030 from the ISCIII, both co-funded with European Regional Development Funds (ERDF), and PROMETEOII/2014/025 from the Conselleria de Educacio of the Valencian Community, FP7-PEOPLE-2012-ITN MLPM2012 318861 from the EU FP7.</p>
  </ack>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Quick</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Quinlan</surname>
            <given-names>AR</given-names>
          </name>
          <name>
            <surname>Loman</surname>
            <given-names>NJ</given-names>
          </name>
        </person-group>
        <article-title>A reference bacterial genome dataset generated on the MinION portable single-molecule nanopore sequencer</article-title>
        <source>GigaScience</source>
        <year>2014</year>
        <volume>3</volume>
        <fpage>22</fpage>
        <pub-id pub-id-type="doi">10.1186/2047-217X-3-22</pub-id>
        <?supplied-pmid 25386338?>
        <pub-id pub-id-type="pmid">25386338</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ashton</surname>
            <given-names>PM</given-names>
          </name>
          <name>
            <surname>Nair</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Dallman</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Rubino</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Rabsch</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Mwaigwisya</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>MinION nanopore sequencing identifies the position and structure of a bacterial antibiotic resistance island</article-title>
        <source>Nat Biotechnol</source>
        <year>2015</year>
        <volume>33</volume>
        <issue>3</issue>
        <fpage>296</fpage>
        <lpage>300</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.3103</pub-id>
        <?supplied-pmid 25485618?>
        <pub-id pub-id-type="pmid">25485618</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jain</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Fiddes</surname>
            <given-names>IT</given-names>
          </name>
          <name>
            <surname>Miga</surname>
            <given-names>KH</given-names>
          </name>
          <name>
            <surname>Olsen</surname>
            <given-names>HE</given-names>
          </name>
          <name>
            <surname>Paten</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Akeson</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Improved data analysis for the MinION nanopore sequencer</article-title>
        <source>Nat Methods</source>
        <year>2015</year>
        <volume>12</volume>
        <issue>4</issue>
        <fpage>351</fpage>
        <lpage>6</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.3290</pub-id>
        <?supplied-pmid 25686389?>
        <pub-id pub-id-type="pmid">25686389</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Loman</surname>
            <given-names>NJ</given-names>
          </name>
          <name>
            <surname>Watson</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Successful test launch for nanopore sequencing</article-title>
        <source>Nat Methods</source>
        <year>2015</year>
        <volume>12</volume>
        <issue>4</issue>
        <fpage>303</fpage>
        <lpage>4</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.3327</pub-id>
        <?supplied-pmid 25825834?>
        <pub-id pub-id-type="pmid">25825834</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Loman</surname>
            <given-names>NJ</given-names>
          </name>
          <name>
            <surname>Quick</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Simpson</surname>
            <given-names>JT</given-names>
          </name>
        </person-group>
        <article-title>A complete bacterial genome assembled de novo using only nanopore sequencing data</article-title>
        <source>Nat Methods</source>
        <year>2015</year>
        <volume>12</volume>
        <issue>8</issue>
        <fpage>733</fpage>
        <lpage>5</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.3444</pub-id>
        <?supplied-pmid 26076426?>
        <pub-id pub-id-type="pmid">26076426</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Karlsson</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Larkeryd</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Sjodin</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Forsman</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Stenberg</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Scaffolding of a bacterial genome using MinION nanopore sequencing</article-title>
        <source>Sci Rep</source>
        <year>2015</year>
        <volume>5</volume>
        <fpage>11996</fpage>
        <pub-id pub-id-type="doi">10.1038/srep11996</pub-id>
        <?supplied-pmid 26149338?>
        <pub-id pub-id-type="pmid">26149338</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Greninger</surname>
            <given-names>AL</given-names>
          </name>
          <name>
            <surname>Naccache</surname>
            <given-names>SN</given-names>
          </name>
          <name>
            <surname>Federman</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Yu</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Mbala</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Bres</surname>
            <given-names>V</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Rapid metagenomic identification of viral pathogens in clinical samples by real-time nanopore sequencing analysis</article-title>
        <source>Genome Med</source>
        <year>2015</year>
        <volume>7</volume>
        <issue>1</issue>
        <fpage>99</fpage>
        <pub-id pub-id-type="doi">10.1186/s13073-015-0220-9</pub-id>
        <?supplied-pmid 26416663?>
        <pub-id pub-id-type="pmid">26416663</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Goodwin</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Gurtowski</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Ethe-Sayers</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Deshpande</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Schatz</surname>
            <given-names>MC</given-names>
          </name>
          <name>
            <surname>McCombie</surname>
            <given-names>WR</given-names>
          </name>
        </person-group>
        <article-title>Oxford Nanopore sequencing, hybrid error correction, and de novo assembly of a eukaryotic genome</article-title>
        <source>Genome Res</source>
        <year>2015</year>
        <volume>25</volume>
        <issue>11</issue>
        <fpage>1750</fpage>
        <lpage>6</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.191395.115</pub-id>
        <?supplied-pmid 26447147?>
        <pub-id pub-id-type="pmid">26447147</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bolisetty</surname>
            <given-names>MT</given-names>
          </name>
          <name>
            <surname>Rajadinakaran</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Graveley</surname>
            <given-names>BR</given-names>
          </name>
        </person-group>
        <article-title>Determining exon connectivity in complex mRNAs by nanopore sequencing</article-title>
        <source>Genome Biol</source>
        <year>2015</year>
        <volume>16</volume>
        <issue>1</issue>
        <fpage>204</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-015-0777-z</pub-id>
        <?supplied-pmid 26420219?>
        <pub-id pub-id-type="pmid">26420219</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Madoui</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Engelen</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Cruaud</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Belser</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Bertrand</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Alberti</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Genome assembly using Nanopore-guided long and error-free DNA reads</article-title>
        <source>BMC Genomics.</source>
        <year>2015</year>
        <volume>16</volume>
        <fpage>327</fpage>
        <pub-id pub-id-type="doi">10.1186/s12864-015-1519-z</pub-id>
        <?supplied-pmid 25927464?>
        <pub-id pub-id-type="pmid">25927464</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Quick</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Ashton</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Calus</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Chatt</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Gossain</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Hawker</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Rapid draft sequencing and real-time nanopore sequencing in a hospital outbreak of Salmonella</article-title>
        <source>Genome Biol</source>
        <year>2015</year>
        <volume>16</volume>
        <issue>1</issue>
        <fpage>114</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-015-0677-2</pub-id>
        <?supplied-pmid 26025440?>
        <pub-id pub-id-type="pmid">26025440</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kilianski</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Haas</surname>
            <given-names>JL</given-names>
          </name>
          <name>
            <surname>Corriveau</surname>
            <given-names>EJ</given-names>
          </name>
          <name>
            <surname>Liem</surname>
            <given-names>AT</given-names>
          </name>
          <name>
            <surname>Willis</surname>
            <given-names>KL</given-names>
          </name>
          <name>
            <surname>Kadavy</surname>
            <given-names>DR</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Bacterial and viral identification and differentiation by amplicon sequencing on the MinION nanopore sequencer</article-title>
        <source>GigaSci.</source>
        <year>2015</year>
        <volume>4</volume>
        <fpage>12</fpage>
        <pub-id pub-id-type="doi">10.1186/s13742-015-0051-z</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Judge</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Harris</surname>
            <given-names>SR</given-names>
          </name>
          <name>
            <surname>Reuter</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Parkhill</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Peacock</surname>
            <given-names>SJ</given-names>
          </name>
        </person-group>
        <article-title>Early insights into the potential of the Oxford Nanopore MinION for the detection of antimicrobial resistance genes</article-title>
        <source>J Antimicrob Chemother</source>
        <year>2015</year>
        <volume>70</volume>
        <fpage>2775</fpage>
        <pub-id pub-id-type="doi">10.1093/jac/dkv206</pub-id>
        <?supplied-pmid 26221019?>
        <pub-id pub-id-type="pmid">26221019</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <mixed-citation publication-type="other">Norris AL, Workman RE, Fan Y, Eshleman JR, Timp W. Nanopore sequencing detects structural variants in cancer. bioRxiv 2015. Epub ahead of print</mixed-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Watson</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Thomson</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Risse</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Talbot</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Santoyo-Lopez</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Gharbi</surname>
            <given-names>K</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>poRe: an R package for the visualization and analysis of nanopore sequencing data</article-title>
        <source>Bioinformatics</source>
        <year>2015</year>
        <volume>31</volume>
        <issue>1</issue>
        <fpage>114</fpage>
        <lpage>5</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btu590</pub-id>
        <?supplied-pmid 25173419?>
        <pub-id pub-id-type="pmid">25173419</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Loman</surname>
            <given-names>NJ</given-names>
          </name>
          <name>
            <surname>Quinlan</surname>
            <given-names>AR</given-names>
          </name>
        </person-group>
        <article-title>Poretools: a toolkit for analyzing nanopore sequence data</article-title>
        <source>Bioinformatics</source>
        <year>2014</year>
        <volume>30</volume>
        <issue>23</issue>
        <fpage>3399</fpage>
        <lpage>401</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btu555</pub-id>
        <?supplied-pmid 25143291?>
        <pub-id pub-id-type="pmid">25143291</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dean</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Ghemawat</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>MapReduce: simplified data processing on large clusters</article-title>
        <source>Commun ACM</source>
        <year>2008</year>
        <volume>51</volume>
        <issue>1</issue>
        <fpage>107</fpage>
        <lpage>13</lpage>
        <pub-id pub-id-type="doi">10.1145/1327452.1327492</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <mixed-citation publication-type="other">Leggett RM, Heavens D, Caccamo M, Clark MD, Davey RP. NanoOK. multi-reference alignment analysis of nanopore sequencing data, quality and error profiles. Bioinformatics. 2015. doi: 10.1093/bioinformatics/btv540s</mixed-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tarraga</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Arnau</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Martinez</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Moreno</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Cazorla</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Salavert-Torres</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Acceleration of short and long DNA read mapping without loss of accuracy using suffix array</article-title>
        <source>Bioinformatics</source>
        <year>2014</year>
        <volume>30</volume>
        <issue>23</issue>
        <fpage>3396</fpage>
        <lpage>8</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btu553</pub-id>
        <?supplied-pmid 25143289?>
        <pub-id pub-id-type="pmid">25143289</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
