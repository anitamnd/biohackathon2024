<?DTDIdentifier.IdentifierValue -//ES//DTD journal article DTD version 5.1.0//EN//XML?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName art510.dtd?>
<?SourceDTD.Version 5.1.0?>
<?ConverterInfo.XSLTName elsevier2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<?origin publisher?>
<?FILEmeta_COMM3497 xml ?>
<?FILEmain xml ?>
<?FILEgr1 jpg ?>
<?FILEgr2 jpg ?>
<?FILEgr3 jpg ?>
<?FILEgr4 jpg ?>
<?FILEgr5 jpg ?>
<?FILEfx1 jpg ?>
<?FILEsi1 gif ?>
<?FILEsi2 gif ?>
<?FILEsi3 gif ?>
<?FILEsi4 gif ?>
<?FILEsi5 gif ?>
<?FILEsi6 gif ?>
<?FILEsi7 gif ?>
<?FILEsi8 gif ?>
<?FILEsi9 gif ?>
<?FILEsi10 gif ?>
<?FILEsi11 gif ?>
<?FILEsi12 gif ?>
<?FILEsi13 gif ?>
<?FILEsi14 gif ?>
<?FILEsi15 gif ?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Comput Methods Programs Biomed</journal-id>
    <journal-id journal-id-type="iso-abbrev">Comput Methods Programs Biomed</journal-id>
    <journal-title-group>
      <journal-title>Computer Methods and Programs in Biomedicine</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">0169-2607</issn>
    <issn pub-type="epub">1872-7565</issn>
    <publisher>
      <publisher-name>Elsevier Scientific Publishers</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">3693034</article-id>
    <article-id pub-id-type="publisher-id">S0169-2607(13)00013-8</article-id>
    <article-id pub-id-type="doi">10.1016/j.cmpb.2013.01.010</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>The Survival Kit: Software to analyze survival data including possibly correlated random effects</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Mészáros</surname>
          <given-names>G.</given-names>
        </name>
        <email>gabor.meszaros@boku.ac.at</email>
        <xref rid="aff0005" ref-type="aff">a</xref>
        <xref rid="cor0005" ref-type="corresp">⁎</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Sölkner</surname>
          <given-names>J.</given-names>
        </name>
        <xref rid="aff0005" ref-type="aff">a</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ducrocq</surname>
          <given-names>V.</given-names>
        </name>
        <xref rid="aff0010" ref-type="aff">b</xref>
      </contrib>
    </contrib-group>
    <aff id="aff0005"><label>a</label>Division of Livestock Sciences, University of Natural Resources and Life Sciences, Vienna, Gregor-Mendel-Str. 33, A-1180 Vienna, Austria</aff>
    <aff id="aff0010"><label>b</label>INRA, UMR 1313 Génétique Animale et Biologie Intégrative, F-78352 Jouy-en-Josas, France</aff>
    <author-notes>
      <corresp id="cor0005"><label>⁎</label><italic>Corresponding author</italic>. Tel.: +43 1 47654 3259. <email>gabor.meszaros@boku.ac.at</email></corresp>
    </author-notes>
    <pub-date pub-type="pmc-release">
      <day>1</day>
      <month>6</month>
      <year>2013</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on <pub-date
						pub-type="ppub">.-->
    <pub-date pub-type="ppub">
      <month>6</month>
      <year>2013</year>
    </pub-date>
    <volume>110</volume>
    <issue>3</issue>
    <fpage>503</fpage>
    <lpage>510</lpage>
    <history>
      <date date-type="received">
        <day>17</day>
        <month>11</month>
        <year>2011</year>
      </date>
      <date date-type="rev-recd">
        <day>10</day>
        <month>1</month>
        <year>2013</year>
      </date>
      <date date-type="accepted">
        <day>13</day>
        <month>1</month>
        <year>2013</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2013 Elsevier Ireland Ltd.</copyright-statement>
      <copyright-year>2013</copyright-year>
      <copyright-holder>Elsevier Ireland Ltd</copyright-holder>
      <license xlink:href="https://creativecommons.org/licenses/by-nc-nd/3.0/">
        <license-p>Open Access under <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by-nc-nd/3.0/">CC BY-NC-ND 3.0</ext-link> license</license-p>
      </license>
    </permissions>
    <abstract>
      <p>The Survival Kit is a Fortran 90 Software intended for survival analysis using proportional hazards models and their extension to frailty models with a single response time. The hazard function is described as the product of a baseline hazard function and a positive (exponential) function of possibly time-dependent fixed and random covariates. Stratified Cox, grouped data and Weibull models can be used. Random effects can be either log-gamma or normally distributed and can account for a pedigree structure. Variance parameters are estimated in a Bayesian context. It is possible to account for the correlated nature of two random effects either by specifying a known correlation coefficient or estimating it from the data. An R interface of the Survival Kit provides a user friendly way to run the software.</p>
    </abstract>
    <kwd-group>
      <title>Keywords</title>
      <kwd>Survival analysis</kwd>
      <kwd>Proportional hazards</kwd>
      <kwd>Frailty model</kwd>
      <kwd>Correlated random effects</kwd>
    </kwd-group>
  </article-meta>
</front>
<body>
  <sec sec-type="intro" id="sec0005">
    <label>1</label>
    <title>Introduction</title>
    <p>The most popular class of survival models is the class of proportional hazard models <xref rid="bib0005 bib0010" ref-type="bibr">[1,2]</xref>, where the hazard of an individual at time <italic>t</italic> is described as the product of the baseline function and of a positive term which is an exponential function of a vector of covariates <bold>w</bold>′ multiplied by vector of regression parameters <bold>θ</bold>. Frailty models are an extension of standard survival analysis models which allows to account for unobserved random heterogeneity <xref rid="bib0015" ref-type="bibr">[3]</xref> or equivalently, to include random effects. These account for an unobserved environmental or genetic effect affecting the hazard of the individual. When two random effects are included (e.g., <xref rid="bib0020" ref-type="bibr">[4]</xref>), these can be independent from each other or related to some degree, leading to the need to estimate correlated random effects. Analyses failing to account for this underlying correlation in survival times are likely to underestimate the variances of parameters <xref rid="bib0025" ref-type="bibr">[5]</xref>.</p>
    <p>The aim of this paper is to introduce “the Survival Kit”, software for survival analysis capable to handle very large amounts of data, with the possibility to account for their right censored or left truncated status in proportional hazards models. The fixed, random and stratification variables can be time dependent. The estimation of variance components is done in a Bayesian framework and is based on a Laplace approximation of the marginal posterior density of these parameters, from which a modal point estimate can be obtained. Various modeling possibilities are shown in <xref rid="bib0020" ref-type="bibr">[4]</xref>, including stratified and frailty survival models with simultaneous estimation of variances for two random effects, center and interaction of treatment by center. The first random effect corrected for deviation centers from the overall baseline hazard, while the second was to deal with deviation of each center from the overall treatment effect. When required, the first three moments of this posterior density can be estimated and the full posterior density can be approximately constructed and visualized. The program was originally written in Fortran 90 for computational efficiency on very large datasets. An R interface was added to provide easier usage and graphical capabilities.</p>
    <p>In Section <xref rid="sec0010" ref-type="sec">2</xref> we present the statistical model. In Section <xref rid="sec0015" ref-type="sec">3</xref>, the Survival Kit is described and in Section <xref rid="sec0030" ref-type="sec">4</xref> two illustrative applications are presented, one using real infant mortality data, the other using simulated data, and computing variances and covariance of correlated random effects.</p>
  </sec>
  <sec id="sec0010">
    <label>2</label>
    <title>Theoretical background and computational methods</title>
    <p>This section presents a brief overview of the methods used in the Survival Kit. More detailed information can be found in <xref rid="bib0020 bib0030" ref-type="bibr">[4,6]</xref>.</p>
    <p>Proportional hazard models and their extension to include random effects describe the hazard function of each individual <italic>λ</italic>(<italic>t</italic>) (i.e., its limiting probability of dying at time <italic>t</italic>, given it is still alive just prior to <italic>t</italic>) as the product of a baseline hazard function and a positive (exponential) function of explanatory covariates.</p>
    <p>The model is specified as:<disp-formula id="eq0005"><label>(1)</label><mml:math id="M1" altimg="si14.gif" overflow="scroll"><mml:mrow><mml:mi>λ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>;</mml:mo><mml:mstyle mathvariant="bold"><mml:mtext>x</mml:mtext></mml:mstyle><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mstyle mathvariant="bold"><mml:mtext>z</mml:mtext></mml:mstyle><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>exp</mml:mi><mml:mo>{</mml:mo><mml:mstyle mathvariant="bold"><mml:mtext>x</mml:mtext></mml:mstyle><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>′</mml:mo></mml:msup><mml:mstyle mathvariant="bold"><mml:mi mathvariant="normal">β</mml:mi></mml:mstyle><mml:mo>+</mml:mo><mml:mstyle mathvariant="bold"><mml:mtext>z</mml:mtext></mml:mstyle><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>′</mml:mo></mml:msup><mml:mstyle mathvariant="bold"><mml:mtext>s</mml:mtext></mml:mstyle><mml:mo>}</mml:mo></mml:mrow></mml:math></disp-formula>where <bold>β</bold> and <bold>s</bold> are vectors of fixed regression coefficients and random effects. The second part, exp{<bold>x</bold>(<italic>t</italic>)′<bold>β</bold> + <bold>z</bold>(<italic>t</italic>)′<bold>s</bold>}, represents a stress-dependent term specific to the animals with fixed covariates <bold>x</bold> and random covariates <bold>z</bold>. Both the fixed and random covariates can be time dependent. Only stepwise functions of time are considered for <bold>x</bold>(<italic>t</italic>) or <bold>z</bold>(<italic>t</italic>), i.e., <bold>x</bold>(<italic>t</italic>) and <bold>z</bold>(<italic>t</italic>) are supposed to remain constant over intervals [<italic>t</italic><sub><italic>i</italic></sub>, <italic>t</italic><sub><italic>i</italic></sub> + 1[. The first part <italic>λ</italic><sub>0</sub>(<italic>t</italic>) is the baseline hazard function. It is left unspecified in the Cox model <xref rid="bib0005" ref-type="bibr">[1]</xref> or it can take a parametric form as in Weibull model shown in <xref rid="eq0010" ref-type="disp-formula">(2)</xref>.<disp-formula id="eq0010"><label>(2)</label><mml:math id="M2" altimg="si15.gif" overflow="scroll"><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>λ</mml:mi><mml:mi>ρ</mml:mi><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>λ</mml:mi><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></disp-formula>where <italic>λ</italic> and <italic>ρ</italic> are the shape and scale parameters of the Weibull distribution <xref rid="bib0010" ref-type="bibr">[2]</xref>.</p>
    <p>The baseline hazard function can be unique or can differ between groups of individuals. The time scale can be divided into several intervals using stratified models, with specific baseline hazards with a separate origin for each, defining a piecewise (e.g., piecewise Weibull) model. This is useful to evaluate hazards with a repetitive pattern. One example is the modeling of culling in dairy cows which clearly follows a particular within lactation pattern <xref rid="bib0035" ref-type="bibr">[7]</xref>.</p>
    <p>In case of discrete time scale (i.e. with very few distinct time values), there are often many failures occurring at the same time, leading to “ties” between failure times. In such case, the Cox model is no longer valid: if <italic>m</italic> failure times are tied at time <italic>l</italic> and <italic>n</italic> individuals are at risk just prior to <italic>l</italic>, the partial likelihood contribution involves a summation over all possible subsets of size <italic>m</italic> from the <italic>n</italic> at risk, which makes the choice of a Cox model for the discrete time measures inadequate and computationally demanding. Prentice and Gloeckler <xref rid="bib0040" ref-type="bibr">[8]</xref> proposed another approach, the “grouped data model” based on <xref rid="bib0045" ref-type="bibr">[9]</xref>. They assumed that the actual failure times occur in a number of intervals (e.g., years) [0 = <italic>τ</italic><sub>0</sub>, <italic>τ</italic><sub>1</sub>), [<italic>τ</italic><sub>1</sub>, <italic>τ</italic><sub>2</sub>), … [<italic>τ</italic><sub><italic>k</italic>−1</sub>, <italic>τ</italic><sub><italic>k</italic></sub>), … and that the risk of failure is constant within each interval. All failures occurring in the same interval [<italic>τ</italic><sub><italic>k</italic>−1</sub>, <italic>τ</italic><sub><italic>k</italic></sub>) are “grouped”, and the attached failure time is <italic>k</italic>. They also assumed that censoring occurs at the end of each interval. The estimation procedure they proposed was included in the Survival Kit, using a reparameterization described in <xref rid="bib0050" ref-type="bibr">[10]</xref>. Indeed, it is possible to rewrite the model as an exponential regression model including an additional time-dependent effect changing at the beginning of each new interval (see <xref rid="bib0050" ref-type="bibr">[10]</xref> for details).</p>
    <p>Technically, the hyperparameters of the prior distribution of random effects (e.g., genetic variance) are estimated from their marginal posterior density <xref rid="bib0030" ref-type="bibr">[6]</xref>. The latter can be obtained through the exact algebraic integration of the random effect out of the joint posterior density when the random effect is assumed to follow a log-gamma distribution. However this is not possible when a normal (or multivariate normal) distribution is used for random effects, for example genetic effects of related animals. Instead, an approximate integration can be implemented using a Laplace approximation. Then, assuming the hyperparameters known, the estimates of all other parameters are obtained as the mode of their joint posterior density. This maximization is done using a limited memory quasi-Newton approach <xref rid="bib0055" ref-type="bibr">[11]</xref> which only requires the computation of the vector of first derivatives of the function to maximize.</p>
    <p>For very large applications and models involving correlated random effects, the quasi-Newton approach may converge very slowly. In this case, a full Newton–Raphson algorithm (using both the first and the second derivatives of the function to maximize) can be used to guarantee convergence in a much smaller number of (computationally more expensive) iterations. Also a combination of both quasi-Newton and full Newton–Raphson algorithms is possible and even advisable when good starting values are not available.</p>
    <p>Finally, it is also possible to jointly estimate the variance of two random effects using a derivative free algorithm. A normal distribution can be assumed for each level of both random effects. When individuals are (genetically) related, all relationships can be accounted for, assuming a multivariate normal distribution with a (co)variance matrix proportional to <bold>A</bold>, their relationship matrix <xref rid="bib0060" ref-type="bibr">[12]</xref>. These random effects can be independent from each other <xref rid="bib0020" ref-type="bibr">[4]</xref>, but it is also possible to account for their correlated nature as in <xref rid="bib0025" ref-type="bibr">[5]</xref>, for example when they correspond to time-dependent effects, for example two genetic effects influencing differently the trait of interest in early and late life. In this case, the two random effects should have the same number of levels. The variances of the random effects and their correlation coefficient could be specified (in case of availability of good prior estimates) or estimated simultaneously with the program.</p>
  </sec>
  <sec id="sec0015">
    <label>3</label>
    <title>Computer program</title>
    <sec id="sec0020">
      <label>3.1</label>
      <title>General description</title>
      <p>The Survival Kit has been developed since its first release in 1994, gradually adding possibilities of stratification and different model types, notably the possibility to model correlated random effects as its latest feature. It is heavily used mostly in the animal breeding community, demonstrated by over 280 scientific papers using the Survival Kit, as of December 2012. This part will describe the program in its current state (for more information about changes between versions, see <xref rid="bib0065 bib0070 bib0075" ref-type="bibr">[13–15]</xref>).</p>
      <p>The Survival Kit is written in Fortran 90 and can process very large amounts of data, for example several millions of individual records in national breeding value evaluations in cattle <xref rid="bib0035" ref-type="bibr">[7]</xref>. Computational time depends on the actual size of the dataset, the model complexity, whether or not (correlated) random effects are used and whether hyperparameters are assumed to be known or need to be estimated. The program handles time dependent random effects as well (e.g., two different (possibly correlated) genetic effects affecting the risk of the same individual during two different periods). It runs on every operating system after compilation. The source code is freely available on the website mentioned at the end of this paper.</p>
      <p>The Survival Kit handles any number of fixed (possibly time dependent) continuous or discrete covariates with any number of classes. Time dependent covariates are assumed piecewise constant over time intervals. Therefore, records with time dependent effects should include the time of change and the new value of the covariate, as many times as the covariate changes, for example if the <italic>p</italic>th variable in the input dataset has a value of <italic>v</italic><sub>0</sub> at <italic>t</italic> = 0, any change in value is indicated in the input data file as a triplet (<italic>p</italic>, <italic>t</italic><sub><italic>j</italic></sub>, <italic>v</italic><sub><italic>j</italic></sub>), meaning that this p<sup>th</sup> covariate changes to the new value <italic>v</italic><sub><italic>j</italic></sub> at time <italic>t</italic><sub><italic>j</italic></sub>. Any number of triplets can be specified. Consequently, survival records are split into so called “elementary records” internally, each covering only the time span from a change in any covariate to the next. The last column of each record holds the number of triplets for the time dependent variables for that particular record, with 0 if there were no changes for the time dependent effect, or these are not used at all.</p>
      <p>It is possible to include random effects into the evaluated model, which can be interaction terms with other covariates and/or time dependent. The program computes a point estimate and its standard error for each level of the random effect. It can also estimate the variance of the random effect as the mode of its posterior density with the possibility to provide also its mean, standard deviation and skewness. The latter three parameters give a more accurate picture about the approximate posterior density of the random effect, which can be visualized by Gram–Charlier approximation <xref rid="bib0080" ref-type="bibr">[16]</xref> as shown in <xref rid="fig0025" ref-type="fig">Fig. 5</xref>. The knowledge of the mean and standard deviation of this posterior density (or of the whole posterior density) can be used to decide whether the corresponding random effect is statistically different from 0.</p>
      <p>There could be any number of random effects in the evaluated model, out of which the variances for at most two could be estimated simultaneously, the others being assumed to be known (to estimate the variance of more than 2 random effects, cyclic maximization can be used). The two estimated variances are assumed to be independent by default, but they can also be correlated. The correlation coefficient can be assumed to be known (e.g., from a previous analysis) or be estimated.</p>
      <p>Initially, the Survival Kit had to be first compiled on the local computer and then used specifying the model parameters in a text file. Recently an interface to R <xref rid="bib0085" ref-type="bibr">[17]</xref> has been developed to simplify the usage of the software and provide visualization options. With the R interface, it is possible to create graphs such as: Kaplan–Meier curve with 95% confidence intervals, graphical test of the Weibull hazard assumption (e.g., <italic>log(−log(KM estimate))</italic> vs. <italic>log(time)</italic>), survival function and cumulative hazard function for the whole model or each stratum in case of stratified models. The distribution of the random effect can be plotted using the Gram–Charlier approximation. All other results appear in a text file.</p>
    </sec>
    <sec id="sec0025">
      <label>3.2</label>
      <title>Input parameters</title>
      <p>In this section, some of the input parameters of the R interface will be described. Given the wide range of possibilities in the Survival Kit, only a few of its most crucial features are going to be presented.</p>
      <p>The general command is:<table-wrap id="tbl0005" position="float"><table frame="hsides" rules="groups"><tbody><tr><td align="left">SKit4R (<bold>program</bold> = “”, <bold>discrete</bold> = FALSE, <bold>inputData</bold> = “”, <bold>inputPedigree</bold> = “”, <bold>time</bold> = “life”, <bold>idRec</bold> = “idnum”,</td></tr><tr><td align="left"> <bold>censName</bold> = “cens”, <bold>censValue</bold> = 0, <bold>truncate</bold> = “”, <bold>effects</bold> = c(“”,“”), effectType = c(“”,“”)</td></tr><tr><td align="left"> <bold>pedigreeEffect</bold> = “”, <bold>timeDepEffects</bold> = c(“”,“”),“”, <bold>timeDepEffectsType</bold> = c(“”,“”)</td></tr><tr><td align="left"> <bold>classEffects</bold> = c(“”,“”), <bold>outputEffects</bold> = c(“”,“”), <bold>strata</bold> = “”, <bold>origin</bold> = “”, <bold>strataSort</bold> = 0,</td></tr><tr><td align="left"> <bold>ite_quasi</bold> = −1, <bold>model</bold> = c(“”,“”), <bold>std_error</bold> = TRUE, <bold>random</bold> = “”, correlation = c(“”,“”,“”),</td></tr><tr><td align="left"> <bold>test</bold> = c(“”,“”), <bold>baseline</bold> = FALSE, <bold>kaplan</bold> = FALSE, <bold>moments</bold> = FALSE, <bold>survivalOptions</bold> = “”,</td></tr><tr><td align="left"> <bold>residual</bold> = “”, <bold>graphics</bold> = TRUE)</td></tr></tbody></table></table-wrap></p>
      <p>Out of these function arguments the <italic>program, inputData</italic> and <italic>model</italic> are compulsory. The arguments <italic>time</italic>, <italic>censName</italic>, <italic>censValue</italic> and <italic>outputEffects</italic> can be skipped if the default settings are used. The rest of the arguments are describing the data structure (e.g., <italic>classEffect</italic>) or trigger optional features (e.g., <italic>test</italic>).<list list-type="simple"><list-item id="lsti0005"><label>-</label><p><italic>program</italic>: Indicates which compiled executable file should be used (“cox” or “weibull”). There is the possibility to bypass the data preparation step and run only the cox or weibull programs by stating “only_cox” or “only_weibull” in case of multiple analyses on the same data set. This is a compulsory parameter.</p></list-item><list-item id="lsti0010"><label>-</label><p><italic>discrete</italic>: The TRUE value indicates that the time scale is expressed in a few discrete units, therefore the grouped data model of <xref rid="bib0040" ref-type="bibr">[8]</xref> is used. This is available with the <italic>weibull</italic> executable file (although it is not a Weibull model!).</p></list-item><list-item id="lsti0015"><label>-</label><p><italic>inputData</italic>: Name of the input data file. This is a compulsory parameter.</p></list-item><list-item id="lsti0020"><label>-</label><p><italic>inputPedigree</italic>: Name of the pedigree file from which a relationship matrix <xref rid="bib0060" ref-type="bibr">[12]</xref> will be constructed.</p></list-item><list-item id="lsti0025"><label>-</label><p><italic>time</italic>: This could be a single variable name holding the name of an already computed survival time, or a set of 3 variables holding the name of the survival time, the beginning and the end of the observation given as dates. In the latter case the total survival time is computed within the program. Only integer time variables are allowed.</p></list-item><list-item id="lsti0030"><label>-</label><p><italic>idRec</italic>: Name of the variable holding the unique identification number for each record.</p></list-item><list-item id="lsti0035"><label>-</label><p><italic>censName</italic>: Name of the variable holding the censoring codes for each record.</p></list-item><list-item id="lsti0040"><label>-</label><p><italic>censValue</italic>: A number that identifies the censored observations in <italic>censName</italic>, everything else is considered as an uncensored record The default value denoting the censored records is 0 in the R interface, but also can be freely specified by the user.</p></list-item><list-item id="lsti0045"><label>-</label><p><italic>truncate</italic>: In case there are left truncated records in the data set, this variable holds the time of the truncation point, which could be either an integer number or a date. If the variable is coded 0 in the data set, the record is treated as not truncated, independently from data type.</p></list-item><list-item id="lsti0050"><label>-</label><p><italic>effects</italic>: A vector holding the names of all effects as they appear in <italic>inputData</italic>, including the names of <italic>time</italic>, <italic>idRec</italic> and <italic>censName</italic> variables.</p></list-item><list-item id="lsti0055"><label>-</label><p><italic>effectType</italic>: This parameter specifies the types of input variables, as required by the Survival Kit. The statement could be omitted when only integer values are used the whole input data set. Otherwise a character vector is expected. The values are “class” for integer, “continuous” for real, “date6” for date in 6 digit format (<italic>ddmmyy</italic>) and “date8” for date in 8 digit format (<italic>ddmmyyyy</italic>).</p></list-item><list-item id="lsti0060"><label>-</label><p><italic>pedigreeEffect</italic>: This specifies the name of the variable which is linked to the relationship matrix (filename in <italic>inputPedigree</italic>).</p></list-item><list-item id="lsti0065"><label>-</label><p><italic>timeDepEffects</italic>: List of time dependent variables.</p></list-item><list-item id="lsti0070"><label>-</label><p><italic>timeDepEffectsType</italic>: The types of time dependent effects should be specified in the Survival Kit, similarly to the <italic>effects</italic> statement. This parameter behaves in the same way as <italic>effectType</italic> above.</p></list-item><list-item id="lsti0075"><label>-</label><p><italic>classEffects</italic>: List of variables to be treated as discontinuous (class) covariates. Everything else stated in <italic>effects</italic> is treated as a continuous covariate.</p></list-item><list-item id="lsti0080"><label>-</label><p><italic>outputEffects</italic>: List of effects to be included to the internal recoded file. In case of large datasets a sizeable amount of space and memory may be saved if only the variables needed for further analysis are included here. If the keyword is omitted, all effects are included into the output data set by default.</p></list-item><list-item id="lsti0085"><label>-</label><p><italic>strata</italic>: Variable name holding the (possibly time dependent) stratification variable in case of stratified Cox, Weibull or piecewise Weibull models. Any number of strata levels is allowed.</p></list-item><list-item id="lsti0090"><label>-</label><p><italic>origin</italic>: Specifies the time points when the hazard should be set to zero in case of piecewise Weibull models. It is also possible to use the same variable name here as in <italic>strata</italic> which resets the hazard at the beginning of each stratum (for example, the beginning of each parity, in domestic animals).</p></list-item><list-item id="lsti0095"><label>-</label><p><italic>strataSort</italic>: In all stratified models the internal recoded files should be sorted according to <italic>strata</italic>. This is largely an automated process, but requires the user to specify the column number of the stratification variable in the recoded file.</p></list-item><list-item id="lsti0100"><label>-</label><p><italic>ite_quasi</italic>: Specifies the number of quasi Newton Raphson iterations (in <italic>weibull</italic>) before switching to full Newton algorithm. If the value 0 is specified, the program starts with the full Newton algorithm. This parameter is not available with the <italic>cox</italic> program.</p></list-item><list-item id="lsti0105"><label>-</label><p><italic>model</italic>: A vector holding the names of covariates from <italic>outputEffects</italic>, to be included in the evaluated model. This is a compulsory parameter.</p></list-item><list-item id="lsti0110"><label>-</label><p><italic>std_error</italic>: If set to TRUE, the asymptotic standard errors of estimates are computed for estimates of all effects.</p></list-item><list-item id="lsti0115"><label>-</label><p><italic>random</italic>: Specifies the name(s) of the random effect(s). Note that these names should also appear in the <italic>model</italic> part. The distribution of the random effects can be specified by the <italic>loggamma</italic>, <italic>normal</italic> or <italic>multinormal</italic> keywords. The variances of the random effects might be known or estimated adding the <italic>estimate</italic> keyword. In this case, the mode of the (approximate) posterior density of the variance is assumed to be the best value for the variance. The mean, standard deviation and the skewness of the distribution could be estimated as well using the <italic>moments</italic> keyword of Survival Kit in the <italic>random</italic> statement.</p></list-item><list-item id="lsti0120"><label>-</label><p><italic>correlation</italic>: Holds the names of two correlated random effects and the value of the correlation coefficient, or the command to <italic>estimate</italic> its value and a starting value for the estimate.</p></list-item><list-item id="lsti0125"><label>-</label><p><italic>test</italic>: If specified the full model is compared to various submodels using likelihood ratio tests to find out the significance of each effect.</p></list-item><list-item id="lsti0130"><label>-</label><p><italic>baseline</italic>, <italic>kaplan</italic>: Setting these to TRUE computes the baseline hazard function and/or the Kaplan–Meier estimate in the <italic>cox</italic> program and visualizes the outcome via the R graphics window.</p></list-item><list-item id="lsti0135"><label>-</label><p><italic>moments</italic>: If set to TRUE, the moments of the approximate posterior density of the variance parameter are computed and used to plot it using the Gram–Charlier approximation (the <italic>moments</italic> should also be specified also in the <italic>random</italic> statement).</p></list-item><list-item id="lsti0140"><label>-</label><p><italic>survivalOptions</italic>: If specified, information about the survivor function of individuals with specific covariate values is produced. It is a very useful tool to relate the estimated regression coefficients to a more conventional scale like median survival time or probability of survival to certain age (only with the <italic>cox</italic> program).</p></list-item><list-item id="lsti0145"><label>-</label><p><italic>residual</italic>: If set to TRUE, it computes the generalized residuals according to <xref rid="bib0090" ref-type="bibr">[18]</xref> for each initial record (only with the <italic>cox</italic> program).</p></list-item><list-item id="lsti0150"><label>-</label><p><italic>graphics</italic>: If set to TRUE the graphical capabilities of R are used to visualize the results.</p></list-item></list></p>
    </sec>
  </sec>
  <sec id="sec0030">
    <label>4</label>
    <title>Applications</title>
    <sec id="sec0035">
      <label>4.1</label>
      <title>Infant mortality in Austria</title>
      <p>With this example, we intend to show the use of the Survival Kit with its R interface on data from 2.060.979 records of singleton live births between 1984 and 2008 in Austria. All data were extracted from birth certificates provided by Statistics Austria <xref rid="bib0095" ref-type="bibr">[19]</xref>. The variable of interest was the survival of newborns up to 1 year of age.<table-wrap id="tbl0010" position="float"><table frame="hsides" rules="groups"><tbody><tr><td align="left">SKit4R(nrecmax = 2100000,</td></tr><tr><td align="left"> inputData = “main.dat”,</td></tr><tr><td align="left"> effects = c(“idnum”,“life”,“cens”,</td></tr><tr><td align="left">  “byear”,“agem”,“pregl”,“gender”,),</td></tr><tr><td align="left"> effectType = c(“class”,“class”,“class”“class”,“continuous”,“class”,“class”),</td></tr><tr><td align="left"> classEffects = c(“byear”,“pregl”,“gender”),</td></tr><tr><td align="left"> ### parameters for the model</td></tr><tr><td align="left"> program = “cox”,</td></tr><tr><td align="left"> model = c(“byear”,“pregl”,“gender”),</td></tr><tr><td align="left"> baseline = TRUE,</td></tr><tr><td align="left"> kaplan = TRUE)</td></tr></tbody></table></table-wrap></p>
      <p>The input effects were the id number (idnum), length of life (life), censoring code (cens), year of birth (byear), age of the mother (agem), her pregnancy length in weeks (pregl), and the gender of the newborn (gender). From these, the age of the mother was expressed with decimal numbers, therefore the “continuous” specification in the <italic>effects</italic> line (i.e. real values). As it was considered as a continuous effect, it was not specified in the <italic>classEffects</italic> function argument.</p>
      <p>Almost all input parameters are described in the section above. Due to the large amount of data, some pre-defined arrays in the Fortran code would not be sufficient, so an additional parameter was used to change the needed size of computer memory accordingly through the <italic>nrecmax</italic> keyword.</p>
      <p>For simplicity and illustration, only the effects of the birth year, pregnancy length and gender were calculated. The output of the Survival Kit was automatically saved onto a text file. The relevant parts of this file are shown below. Also, as the <italic>baseline</italic> and <italic>kaplan</italic> options were also specified, a set of graphs was produced by R (<xref rid="fig0005 fig0010 fig0015 fig0020" ref-type="fig">Figs. 1–4</xref>). <xref rid="fig0010" ref-type="fig">Fig. 2</xref> shows a graphical test, where a straight line is expected if the Weibull model is adequate. The calculation of the Kaplan–Meier estimate required for this graph is included in the Cox program. If the sole purpose of the run is to compute the Kaplan–Meier estimate, it is possible to delete all effects from the model statement to increase computational speed, as the values of this estimate are not altered by model covariates.<table-wrap id="tbl0015" position="float"><graphic xlink:href="fx1"/></table-wrap></p>
      <p>According to the results the risk of death until one year of age has been steadily decreasing from the 80s. The highly significant 16% lower risk of death for female newborns (coded as 2) is apparent. The reference class in these cases was automatically set to the class with highest number of uncensored observations (default), but it could be set to any other class. As for the continuous effect, no risk ratio was calculated by the program, because it depends on the width of the interval within the continuous effect. It can be computed manually: e.g. the risk of death associated with a <italic>pregl</italic> of 36 weeks compared to a <italic>pregl</italic> of 40 weeks is increased by exp(−0.40 × (36–40)) = 4.95.</p>
    </sec>
    <sec id="sec0040">
      <label>4.2</label>
      <title>Simulation of correlated random effects</title>
      <p>In a second example, we demonstrate the usage of the Survival Kit when the model includes two correlated random effects. The objective is to simultaneously estimate their variances and their correlation coefficient of two correlated random effects. For this purpose we used two simulated datasets with different levels of correlation. A single fixed effect with two levels was assumed, and two random effects with 50 levels in set1 and 100 levels in set2. One hundred records were associated with each level of the first random effect in both cases, with a final size of 5000 records for set1 and 10,000 records for set2. The two effects are cross-classified: the first observation of level 1 of random effect 1 is associated with level 1 of random effect 2, the second observation is associated with the second level of random effect 2, etc. The true values of correlation coefficients were either −0.2, −0.6 or 0.6. Each model was evaluated assuming no correlation or estimating the correlation coefficient during the run, with a total of 12 models. Each model was run 200 times. The mean and standard deviation were computed for the random effects variances and the correlation coefficient were computed over the 200 replicates. The R interface for the computation is:<table-wrap id="tbl0020" position="float"><table frame="hsides" rules="groups"><tbody><tr><td align="left">SKit4R(inputData = “simData.txt”,</td></tr><tr><td align="left"> effects = c(“idnum”,“life”,“cens”,“fixed”,“rnd1”,“rnd2”),</td></tr><tr><td align="left"> classEffects = c(“fixed”,“rnd1”,“rnd2”),</td></tr><tr><td align="left"> program = “cox”,</td></tr><tr><td align="left"> title = “Correlated random effects”,</td></tr><tr><td align="left"> model = c(“fixed”,“rnd1”,“rnd2”),</td></tr><tr><td align="left"> random = “rnd1 estimate moments normal 0.5</td></tr><tr><td align="left">   rnd2 estimate moments normal 0.5”,</td></tr><tr><td align="left"> correlation = c(“rnd1”,“rnd2”,“estimate 0.5”)</td></tr><tr><td align="left"> moments = TRUE)</td></tr></tbody></table></table-wrap></p>
      <p>The main difference with the previous example is the occurrence of the <italic>random</italic> and <italic>correlation</italic> statements. This is to specify the names of the random effects (<italic>rnd1</italic> and <italic>rnd2</italic>) and the fact that we want to estimate the variances and the correlation coefficient using the <italic>estimate</italic> keyword. The 0.5 is a starting value for all computations. The starting value used is not so important when estimating the results, but setting it to a value close to the actual solution (using prior knowledge or literature results) might decrease computing time. The results from all runs are summarized in <xref rid="tbl0025" ref-type="table">Table 1</xref>. They show that correlation was relatively accurately estimated whatever the true value between −0.6 and 0.6. Variances were somewhat underestimated (respectively overestimated) when the correlated nature of the random effects was ignored and the true correlation was negative (respectively, positive). The differences are small, but they may be much larger when the two random effects are not as perfectly cross-classified as in this simulated situation.</p>
      <p>When using the <italic>moments</italic> keyword, the mean, standard deviation and skewness of the approximate marginal posterior density of the variance parameters are computed. This can be shown graphically plotting the results from the Gram–Charlier approximation. <xref rid="fig0025" ref-type="fig">Fig. 5</xref> shows the comparison of posterior distributions plotted in MS Excel with 100 levels for both random effects with and without accounting for correlation of 0.6 between them.</p>
    </sec>
  </sec>
  <sec id="sec0045">
    <label>5</label>
    <title>Availability</title>
    <p>The Survival Kit can be freely used (including for routine genetic evaluations) provided its use is being credited. Use it at your own risk. The source code, compiled executable files, manual and support programs can be found at: <ext-link ext-link-type="uri" xlink:href="http://www.nas.boku.ac.at/nuwi-survivalkit.html">http://www.nas.boku.ac.at/nuwi-survivalkit.html</ext-link>.</p>
  </sec>
</body>
<back>
  <ref-list>
    <title>References</title>
    <ref id="bib0005">
      <label>1</label>
      <element-citation publication-type="journal" id="sbref0005">
        <person-group person-group-type="author">
          <name>
            <surname>Cox</surname>
            <given-names>D.R.</given-names>
          </name>
        </person-group>
        <article-title>Regression models and life-tables</article-title>
        <source>Journal of the Royal Statistical Society: Series B</source>
        <volume>34</volume>
        <year>1972</year>
        <fpage>187</fpage>
        <lpage>220</lpage>
      </element-citation>
    </ref>
    <ref id="bib0010">
      <label>2</label>
      <element-citation publication-type="book" id="sbref0010">
        <person-group person-group-type="author">
          <name>
            <surname>Kalbfleisch</surname>
            <given-names>J.D.</given-names>
          </name>
          <name>
            <surname>Prentice</surname>
            <given-names>R.L.</given-names>
          </name>
        </person-group>
        <chapter-title>The Statistical Analysis of Failure Time Data</chapter-title>
        <year>1980</year>
        <publisher-name>John Wiley and Sons</publisher-name>
        <publisher-loc>NY, USA</publisher-loc>
      </element-citation>
    </ref>
    <ref id="bib0015">
      <label>3</label>
      <element-citation publication-type="journal" id="sbref0015">
        <person-group person-group-type="author">
          <name>
            <surname>Vaupel</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Manton</surname>
            <given-names>K.G.</given-names>
          </name>
          <name>
            <surname>Stallard</surname>
            <given-names>E.</given-names>
          </name>
        </person-group>
        <article-title>The impact of heterogeneity in individual frailty and the dynamics of mortality</article-title>
        <source>Demography</source>
        <volume>16</volume>
        <year>1979</year>
        <fpage>439</fpage>
        <lpage>454</lpage>
        <pub-id pub-id-type="pmid">510638</pub-id>
      </element-citation>
    </ref>
    <ref id="bib0020">
      <label>4</label>
      <element-citation publication-type="journal" id="sbref0020">
        <person-group person-group-type="author">
          <name>
            <surname>Legrand</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Ducrocq</surname>
            <given-names>V.</given-names>
          </name>
          <name>
            <surname>Janssen</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Sylvester</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Duchateau</surname>
            <given-names>L.</given-names>
          </name>
        </person-group>
        <article-title>A Bayesian approach to jointly estimate centre and treatment by centre heterogeneity in a proportional hazards model</article-title>
        <source>Statistics in Medicine</source>
        <volume>24</volume>
        <year>2005</year>
        <fpage>3789</fpage>
        <lpage>3804</lpage>
        <pub-id pub-id-type="pmid">16320274</pub-id>
      </element-citation>
    </ref>
    <ref id="bib0025">
      <label>5</label>
      <element-citation publication-type="journal" id="sbref0025">
        <person-group person-group-type="author">
          <name>
            <surname>Rondeau</surname>
            <given-names>V.</given-names>
          </name>
          <name>
            <surname>Gonzalez</surname>
            <given-names>J.R.</given-names>
          </name>
        </person-group>
        <article-title>Frailtypack: a computer program for the analysis of correlated failure time data using penalized likelihood estimation</article-title>
        <source>Computer Methods and Programs in Biomedicine</source>
        <volume>80</volume>
        <year>2005</year>
        <fpage>154</fpage>
        <lpage>164</lpage>
        <pub-id pub-id-type="pmid">16144730</pub-id>
      </element-citation>
    </ref>
    <ref id="bib0030">
      <label>6</label>
      <element-citation publication-type="journal" id="sbref0030">
        <person-group person-group-type="author">
          <name>
            <surname>Ducrocq</surname>
            <given-names>V.</given-names>
          </name>
          <name>
            <surname>Casella</surname>
            <given-names>G.</given-names>
          </name>
        </person-group>
        <article-title>A Bayesian analysis of mixed survival models</article-title>
        <source>Genetics Selection Evolution</source>
        <volume>28</volume>
        <year>1996</year>
        <fpage>509</fpage>
        <lpage>529</lpage>
      </element-citation>
    </ref>
    <ref id="bib0035">
      <label>7</label>
      <element-citation publication-type="journal" id="sbref0035">
        <person-group person-group-type="author">
          <name>
            <surname>Ducrocq</surname>
            <given-names>V.</given-names>
          </name>
        </person-group>
        <article-title>An improved model for the French genetic evaluation of dairy bulls on length of productive life of their daughters</article-title>
        <source>Animal Science</source>
        <volume>80</volume>
        <year>2005</year>
        <fpage>249</fpage>
        <lpage>256</lpage>
      </element-citation>
    </ref>
    <ref id="bib0040">
      <label>8</label>
      <element-citation publication-type="journal" id="sbref0040">
        <person-group person-group-type="author">
          <name>
            <surname>Prentice</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Gloeckler</surname>
            <given-names>L.</given-names>
          </name>
        </person-group>
        <article-title>Regression analysis of grouped survival data with application to breast cancer data</article-title>
        <source>Biometrics</source>
        <volume>34</volume>
        <year>1978</year>
        <fpage>57</fpage>
        <lpage>67</lpage>
        <pub-id pub-id-type="pmid">630037</pub-id>
      </element-citation>
    </ref>
    <ref id="bib0045">
      <label>9</label>
      <element-citation publication-type="journal" id="sbref0045">
        <person-group person-group-type="author">
          <name>
            <surname>Kalbfleisch</surname>
            <given-names>J.D.</given-names>
          </name>
          <name>
            <surname>Prentice</surname>
            <given-names>R.L.</given-names>
          </name>
        </person-group>
        <article-title>Marginal likelihoods based on Cox's regression and life model</article-title>
        <source>Biometrika</source>
        <volume>60</volume>
        <year>1973</year>
        <fpage>267</fpage>
        <lpage>278</lpage>
      </element-citation>
    </ref>
    <ref id="bib0050">
      <label>10</label>
      <element-citation publication-type="book" id="sbref0050">
        <person-group person-group-type="author">
          <name>
            <surname>Ducrocq</surname>
            <given-names>V.</given-names>
          </name>
        </person-group>
        <chapter-title>Extension of survival analysis to discrete measures of longevity</chapter-title>
        <source>Fourth International Workshop on Genetic Improvement of Functional Traits in Cattle: Longevity</source>
        <conf-name>Jouy-en-Josas, May 9–11, 1999, Interbull Bulletin, 21</conf-name>
        <year>1999</year>
        <fpage>41</fpage>
        <lpage>47</lpage>
      </element-citation>
    </ref>
    <ref id="bib0055">
      <label>11</label>
      <element-citation publication-type="journal" id="sbref0055">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>D.C.</given-names>
          </name>
          <name>
            <surname>Nocedal</surname>
            <given-names>J.</given-names>
          </name>
        </person-group>
        <article-title>On the limited memory BFGS method for large scale optimization</article-title>
        <source>Mathematical Programming</source>
        <volume>45</volume>
        <year>1989</year>
        <fpage>503</fpage>
        <lpage>528</lpage>
      </element-citation>
    </ref>
    <ref id="bib0060">
      <label>12</label>
      <element-citation publication-type="journal" id="sbref0060">
        <person-group person-group-type="author">
          <name>
            <surname>Quaas</surname>
            <given-names>R.L.</given-names>
          </name>
        </person-group>
        <article-title>Computing the diagonal elements and inverse of a large numerator relationship matrix</article-title>
        <source>Biometrics</source>
        <volume>32</volume>
        <year>1976</year>
        <fpage>949</fpage>
        <lpage>953</lpage>
      </element-citation>
    </ref>
    <ref id="bib0065">
      <label>13</label>
      <element-citation publication-type="book" id="sbref0065">
        <person-group person-group-type="author">
          <name>
            <surname>Ducrocq</surname>
            <given-names>V.</given-names>
          </name>
          <name>
            <surname>Sölkner</surname>
            <given-names>J.</given-names>
          </name>
        </person-group>
        <chapter-title>“The Survival Kit”, a FORTRAN package for the analysis of survival data</chapter-title>
        <source>Proc. 5th World Cong. Genet. Appl. Livest. Prod., 22</source>
        <year>1994</year>
        <fpage>51</fpage>
        <lpage>52</lpage>
      </element-citation>
    </ref>
    <ref id="bib0070">
      <label>14</label>
      <element-citation publication-type="book" id="sbref0070">
        <person-group person-group-type="author">
          <name>
            <surname>Ducrocq</surname>
            <given-names>V.</given-names>
          </name>
          <name>
            <surname>Sölkner</surname>
            <given-names>J.</given-names>
          </name>
        </person-group>
        <chapter-title>The Survival Kit – V3.0, a package for large analyses of survival data</chapter-title>
        <source>Proc. 6th World Cong. on Genet. Appl. Livest. Prod.</source>
        <conf-name>January 11–16, University of New-England, Armidale, Australia, 27</conf-name>
        <year>1998</year>
        <fpage>447</fpage>
        <lpage>450</lpage>
      </element-citation>
    </ref>
    <ref id="bib0075">
      <label>15</label>
      <element-citation publication-type="book" id="sbref0075">
        <person-group person-group-type="author">
          <name>
            <surname>Ducrocq</surname>
            <given-names>V.</given-names>
          </name>
          <name>
            <surname>Sölkner</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Mészáros</surname>
            <given-names>G.</given-names>
          </name>
        </person-group>
        <chapter-title>Survival Kit v6 – a software package for survival analysis</chapter-title>
        <source>9th World Congr. Genet. Appl. Livest. Prod.</source>
        <conf-name>Leipzig, Germany</conf-name>
        <year>2010</year>
      </element-citation>
    </ref>
    <ref id="bib0080">
      <label>16</label>
      <element-citation publication-type="journal" id="sbref0080">
        <person-group person-group-type="author">
          <name>
            <surname>Tierney</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Kadane</surname>
            <given-names>J.B.</given-names>
          </name>
        </person-group>
        <article-title>Accurate approximations for posterior moments and marginal densities</article-title>
        <source>Journal of the American Statistical Association</source>
        <volume>81</volume>
        <year>1986</year>
        <fpage>82</fpage>
        <lpage>86</lpage>
      </element-citation>
    </ref>
    <ref id="bib0085">
      <label>17</label>
      <element-citation publication-type="book" id="sbref0085">
        <person-group person-group-type="author">
          <name>
            <surname>R Development Core Team</surname>
          </name>
        </person-group>
        <chapter-title>R: A Language and Environment for Statistical Computing</chapter-title>
        <year>2009</year>
        <publisher-name>R Foundation for Statistical Computing</publisher-name>
        <publisher-loc>Vienna, Austria</publisher-loc>
        <comment>ISBN: 3-900051-07-0, URL <ext-link ext-link-type="uri" xlink:href="http://www.r-project.org/">http://www.R-project.org</ext-link></comment>
      </element-citation>
    </ref>
    <ref id="bib0090">
      <label>18</label>
      <element-citation publication-type="journal" id="sbref0090">
        <person-group person-group-type="author">
          <name>
            <surname>Cox</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Snell</surname>
            <given-names>E.J.</given-names>
          </name>
        </person-group>
        <article-title>A general definition of residuals</article-title>
        <source>Journal of the Royal Statistical Society: Series B</source>
        <volume>30</volume>
        <year>1966</year>
        <fpage>248</fpage>
        <lpage>275</lpage>
      </element-citation>
    </ref>
    <ref id="bib0095">
      <label>19</label>
      <mixed-citation publication-type="other" id="oref0095">Statistics Austria: Vital statistics, <ext-link ext-link-type="uri" xlink:href="http://www.statistik.at/web_en/statistics/population/births/index.html">http://www.statistik.at/web_en/statistics/population/births/index.html</ext-link>.</mixed-citation>
    </ref>
  </ref-list>
  <ack>
    <title>Acknowledgements</title>
    <p>The authors would like to thank to Thomas Waldhör and Harald Heinzl for their contribution in obtaining and analyzing the infant mortality dataset. The financial support by project number P20552-B17 of the <funding-source>Austrian Science Fund</funding-source> is acknowledged. Significant proportion of this work was carried out during several research stays of the first author at INRA in Jouy-en-Josas, France.</p>
  </ack>
</back>
<floats-group>
  <fig id="fig0005">
    <label>Fig. 1</label>
    <caption>
      <p>Kaplan–Meier estimate.</p>
    </caption>
    <graphic xlink:href="gr1"/>
  </fig>
  <fig id="fig0010">
    <label>Fig. 2</label>
    <caption>
      <p>Graphical test of the Weibull hazard assumption (a straight line is expected if the Weibull model is adequate).</p>
    </caption>
    <graphic xlink:href="gr2"/>
  </fig>
  <fig id="fig0015">
    <label>Fig. 3</label>
    <caption>
      <p>Cumulative hazard function.</p>
    </caption>
    <graphic xlink:href="gr3"/>
  </fig>
  <fig id="fig0020">
    <label>Fig. 4</label>
    <caption>
      <p>Survival function.</p>
    </caption>
    <graphic xlink:href="gr4"/>
  </fig>
  <fig id="fig0025">
    <label>Fig. 5</label>
    <caption>
      <p>Gram–Charlier approximations for the simulated example in Section <xref rid="sec0040" ref-type="sec">4.2</xref> with and without accounting for correlation of 0.6 between random effects.</p>
    </caption>
    <graphic xlink:href="gr5"/>
  </fig>
  <table-wrap id="tbl0025" position="float">
    <label>Table 1</label>
    <caption>
      <p>Mean and standard deviation (s) across replicates of estimated variances and correlation for different designs and value of true correlation.</p>
    </caption>
    <table frame="hsides" rules="groups">
      <thead>
        <tr>
          <th/>
          <th/>
          <th colspan="2" align="center"><inline-formula><mml:math id="M3" altimg="si1.gif" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></inline-formula> (true) = 0.3<hr/></th>
          <th colspan="2" align="center"><inline-formula><mml:math id="M4" altimg="si2.gif" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></inline-formula> (true) = 0.3<hr/></th>
          <th align="center"><italic>ρ</italic> (true) = −0.2</th>
        </tr>
        <tr>
          <th/>
          <th/>
          <th align="center">Without <italic>ρ</italic></th>
          <th align="center">With <italic>ρ</italic></th>
          <th align="center">Without <italic>ρ</italic></th>
          <th align="center">With <italic>ρ</italic></th>
          <th align="center">With <italic>ρ</italic></th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td align="left">50 levels</td>
          <td align="left">
            <inline-formula>
              <mml:math id="M5" altimg="si3.gif" overflow="scroll">
                <mml:mover accent="true">
                  <mml:mi>x</mml:mi>
                  <mml:mo>¯</mml:mo>
                </mml:mover>
              </mml:math>
            </inline-formula>
          </td>
          <td align="char">0.285</td>
          <td align="char">0.285</td>
          <td align="char">0.275</td>
          <td align="char">0.275</td>
          <td align="char">−0.179</td>
        </tr>
        <tr>
          <td/>
          <td align="left">
            <italic>s</italic>
          </td>
          <td align="char">0.061</td>
          <td align="char">0.060</td>
          <td align="char">0.060</td>
          <td align="char">0.060</td>
          <td align="char">0.150</td>
        </tr>
        <tr>
          <td align="left">100 levels</td>
          <td align="left">
            <inline-formula>
              <mml:math id="M6" altimg="si4.gif" overflow="scroll">
                <mml:mover accent="true">
                  <mml:mi>x</mml:mi>
                  <mml:mo>¯</mml:mo>
                </mml:mover>
              </mml:math>
            </inline-formula>
          </td>
          <td align="char">0.279</td>
          <td align="char">0.282</td>
          <td align="char">0.274</td>
          <td align="char">0.277</td>
          <td align="char">−0.190</td>
        </tr>
        <tr>
          <td/>
          <td align="left">
            <italic>s</italic>
          </td>
          <td align="char">0.040</td>
          <td align="char">0.041</td>
          <td align="char">0.044</td>
          <td align="char">0.044</td>
          <td align="char">0.107</td>
        </tr>
      </tbody>
    </table>
    <table frame="hsides" rules="groups">
      <thead>
        <tr>
          <th/>
          <th/>
          <th colspan="2" align="center"><inline-formula><mml:math id="M7" altimg="si5.gif" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></inline-formula> (true) = 0.3<hr/></th>
          <th colspan="2" align="center"><inline-formula><mml:math id="M8" altimg="si6.gif" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></inline-formula> (true) = 0.3<hr/></th>
          <th align="center"><italic>ρ</italic> (true) = −0.6</th>
        </tr>
        <tr>
          <th/>
          <th/>
          <th align="center">Without <italic>ρ</italic></th>
          <th align="center">With <italic>ρ</italic></th>
          <th align="center">Without <italic>ρ</italic></th>
          <th align="center">With <italic>ρ</italic></th>
          <th align="center">With <italic>ρ</italic></th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td align="left">50 levels</td>
          <td align="left">
            <inline-formula>
              <mml:math id="M9" altimg="si7.gif" overflow="scroll">
                <mml:mover accent="true">
                  <mml:mi>x</mml:mi>
                  <mml:mo>¯</mml:mo>
                </mml:mover>
              </mml:math>
            </inline-formula>
          </td>
          <td align="char">0.268</td>
          <td align="char">0.284</td>
          <td align="char">0.257</td>
          <td align="char">0.274</td>
          <td align="char">−0.592</td>
        </tr>
        <tr>
          <td/>
          <td align="left">
            <italic>s</italic>
          </td>
          <td align="char">0.058</td>
          <td align="char">0.060</td>
          <td align="char">0.060</td>
          <td align="char">0.062</td>
          <td align="char">0.101</td>
        </tr>
        <tr>
          <td align="left">100 levels</td>
          <td align="left">
            <inline-formula>
              <mml:math id="M10" altimg="si8.gif" overflow="scroll">
                <mml:mover accent="true">
                  <mml:mi>x</mml:mi>
                  <mml:mo>¯</mml:mo>
                </mml:mover>
              </mml:math>
            </inline-formula>
          </td>
          <td align="char">0.262</td>
          <td align="char">0.282</td>
          <td align="char">0.256</td>
          <td align="char">0.277</td>
          <td align="char">−0.597</td>
        </tr>
        <tr>
          <td/>
          <td align="left">
            <italic>s</italic>
          </td>
          <td align="char">0.039</td>
          <td align="char">0.041</td>
          <td align="char">0.042</td>
          <td align="char">0.044</td>
          <td align="char">0.070</td>
        </tr>
      </tbody>
    </table>
    <table frame="hsides" rules="groups">
      <thead>
        <tr>
          <th/>
          <th/>
          <th colspan="2" align="center"><inline-formula><mml:math id="M11" altimg="si9.gif" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></inline-formula> (true) = 0.3<hr/></th>
          <th colspan="2" align="center"><inline-formula><mml:math id="M12" altimg="si10.gif" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></inline-formula> (true) = 0.3<hr/></th>
          <th align="center"><italic>ρ</italic> (true) = 0.6</th>
        </tr>
        <tr>
          <th/>
          <th/>
          <th align="center">Without <italic>ρ</italic></th>
          <th align="center">With <italic>ρ</italic></th>
          <th align="center">Without <italic>ρ</italic></th>
          <th align="center">With <italic>ρ</italic></th>
          <th align="center">with <italic>ρ</italic></th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td align="left">50 levels</td>
          <td align="left">
            <inline-formula>
              <mml:math id="M13" altimg="si11.gif" overflow="scroll">
                <mml:mover accent="true">
                  <mml:mi>x</mml:mi>
                  <mml:mo>¯</mml:mo>
                </mml:mover>
              </mml:math>
            </inline-formula>
          </td>
          <td align="char">0.313</td>
          <td align="char">0.285</td>
          <td align="char">0.313</td>
          <td align="char">0.284</td>
          <td align="char">0.622</td>
        </tr>
        <tr>
          <td/>
          <td align="left">
            <italic>s</italic>
          </td>
          <td align="char">0.065</td>
          <td align="char">0.060</td>
          <td align="char">0.073</td>
          <td align="char">0.068</td>
          <td align="char">0.115</td>
        </tr>
        <tr>
          <td align="left">100 levels</td>
          <td align="left">
            <inline-formula>
              <mml:math id="M14" altimg="si12.gif" overflow="scroll">
                <mml:mover accent="true">
                  <mml:mi>x</mml:mi>
                  <mml:mo>¯</mml:mo>
                </mml:mover>
              </mml:math>
            </inline-formula>
          </td>
          <td align="char">0.307</td>
          <td align="char">0.283</td>
          <td align="char">0.307</td>
          <td align="char">0.282</td>
          <td align="char">0.615</td>
        </tr>
        <tr>
          <td/>
          <td align="left">
            <italic>s</italic>
          </td>
          <td align="char">0.043</td>
          <td align="char">0.041</td>
          <td align="char">0.052</td>
          <td align="char">0.049</td>
          <td align="char">0.082</td>
        </tr>
      </tbody>
    </table>
    <table-wrap-foot>
      <fn>
        <p><inline-formula><mml:math id="M15" altimg="si13.gif" overflow="scroll"><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:math></inline-formula>, mean of the 200 replicates; <italic>s</italic>, standard deviation of the 200 replicates; <italic>ρ</italic>, correlation coefficient between the random effects</p>
      </fn>
    </table-wrap-foot>
  </table-wrap>
</floats-group>
