<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Biophys</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Biophys</journal-id>
    <journal-title-group>
      <journal-title>BMC Biophysics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2046-1682</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">5304404</article-id>
    <article-id pub-id-type="publisher-id">33</article-id>
    <article-id pub-id-type="doi">10.1186/s13628-016-0033-2</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>BFPTool: a software tool for analysis of Biomembrane Force Probe experiments</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Šmít</surname>
          <given-names>Daniel</given-names>
        </name>
        <address>
          <email>daniel.smit@biomed.cas.cz</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Fouquet</surname>
          <given-names>Coralie</given-names>
        </name>
        <address>
          <email>coralie.fouquet@upmc.fr</email>
        </address>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Doulazmi</surname>
          <given-names>Mohamed</given-names>
        </name>
        <address>
          <email>mohamed.doulazmi@upmc.fr</email>
        </address>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Pincet</surname>
          <given-names>Frédéric</given-names>
        </name>
        <address>
          <email>pincet@lps.ens.fr</email>
        </address>
        <xref ref-type="aff" rid="Aff5">5</xref>
        <xref ref-type="aff" rid="Aff6">6</xref>
        <xref ref-type="aff" rid="Aff7">7</xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Trembleau</surname>
          <given-names>Alain</given-names>
        </name>
        <address>
          <email>alain.trembleau@upmc.fr</email>
        </address>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes" equal-contrib="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-0437-2528</contrib-id>
        <name>
          <surname>Zapotocky</surname>
          <given-names>Martin</given-names>
        </name>
        <address>
          <email>zapotocky@biomed.cas.cz</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 1015 3316</institution-id><institution-id institution-id-type="GRID">grid.418095.1</institution-id><institution>Institute of Physiology, </institution><institution>Czech Academy of Sciences, </institution></institution-wrap>Vídeňská 1083, Prague, 14220 Czech Republic </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 1937 116X</institution-id><institution-id institution-id-type="GRID">grid.4491.8</institution-id><institution>Institute of Biophysics and Informatics, First Faculty of Medicine, </institution><institution>Charles University in Prague, </institution></institution-wrap>Kateřinská 2, Prague, 12000 Czech Republic </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 1955 3500</institution-id><institution-id institution-id-type="GRID">grid.5805.8</institution-id><institution/><institution>Sorbonne Université, UPMC Univ Paris 06, INSERM, CNRS, Neurosciences Paris Seine – Institut de Biologie Paris Seine (NPS – IBPS), </institution></institution-wrap>9 Quai Saint Bernard, Paris, 75005 France </aff>
      <aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 1955 3500</institution-id><institution-id institution-id-type="GRID">grid.5805.8</institution-id><institution/><institution>Sorbonne Université, UPMC Univ Paris 06, CNRS, Biological Adaptation and Ageing – Institut de Biologie Paris Seine (B2A – IBPS), </institution></institution-wrap>7 Quai Saint Bernard, Paris, 75005 France </aff>
      <aff id="Aff5"><label>5</label><institution-wrap><institution-id institution-id-type="GRID">grid.440907.e</institution-id><institution>Laboratoire de Physique Statistique, École Normale Supérieure, </institution><institution>PSL Research University, </institution></institution-wrap>Paris, France </aff>
      <aff id="Aff6"><label>6</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2217 0017</institution-id><institution-id institution-id-type="GRID">grid.7452.4</institution-id><institution/><institution>Université Paris Diderot Sorbonne Paris Cité, </institution></institution-wrap>Paris, France </aff>
      <aff id="Aff7"><label>7</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2308 1657</institution-id><institution-id institution-id-type="GRID">grid.462844.8</institution-id><institution/><institution>Sorbonne Universités UPMC Univ Paris 06, CNRS, </institution></institution-wrap>24 rue Lhomond, Paris, 75005 France </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>13</day>
      <month>2</month>
      <year>2017</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>13</day>
      <month>2</month>
      <year>2017</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2017</year>
    </pub-date>
    <volume>10</volume>
    <elocation-id>2</elocation-id>
    <history>
      <date date-type="received">
        <day>23</day>
        <month>7</month>
        <year>2016</year>
      </date>
      <date date-type="accepted">
        <day>22</day>
        <month>12</month>
        <year>2016</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2017</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold> This article is distributed under the terms of the Creative Commons Attribution 4.0 International License(<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p>The Biomembrane Force Probe is an approachable experimental technique commonly used for single-molecule force spectroscopy and experiments on biological interfaces. The technique operates in the range of forces from 0.1 pN to 1000 pN. Experiments are typically repeated many times, conditions are often not optimal, the captured video can be unstable and lose focus; this makes efficient analysis challenging, while out-of-the-box non-proprietary solutions are not freely available.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p>This dedicated tool was developed to integrate and simplify the image processing and analysis of videomicroscopy recordings from BFP experiments. A novel processing feature, allowing the tracking of the pipette, was incorporated to address a limitation of preceding methods. Emphasis was placed on versatility and comprehensible user interface implemented in a graphical form.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p>An integrated analytical tool was implemented to provide a faster, simpler and more convenient way to process and analyse BFP experiments.</p>
      </sec>
      <sec>
        <title>Electronic supplementary material</title>
        <p>The online version of this article (doi:10.1186/s13628-016-0033-2) contains supplementary material, which is available to authorized users.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Biomembrane Force Probe</kwd>
      <kwd>Motion tracking</kwd>
      <kwd>Image analysis</kwd>
      <kwd>Force spectroscopy</kwd>
      <kwd>Cell mechanics</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100001824</institution-id>
            <institution>Grantová Agentura Ceské Republiky</institution>
          </institution-wrap>
        </funding-source>
        <award-id>14-16755S</award-id>
        <principal-award-recipient>
          <name>
            <surname>Zapotocky</surname>
            <given-names>Martin</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100001823</institution-id>
            <institution>Ministerstvo Školství, Mládeže a Telovýchovy</institution>
          </institution-wrap>
        </funding-source>
        <award-id>7AMB12FR002</award-id>
        <principal-award-recipient>
          <name>
            <surname>Zapotocky</surname>
            <given-names>Martin</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100007543</institution-id>
            <institution>Grantová Agentura, Univerzita Karlova</institution>
          </institution-wrap>
        </funding-source>
        <award-id>396213</award-id>
        <principal-award-recipient>
          <name>
            <surname>Šmít</surname>
            <given-names>Daniel</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100001665</institution-id>
            <institution>Agence Nationale de la Recherche</institution>
          </institution-wrap>
        </funding-source>
        <award-id>ANR-2010-BLAN-1401-01</award-id>
        <principal-award-recipient>
          <name>
            <surname>Trembleau</surname>
            <given-names>Alain</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000002</institution-id>
            <institution>National Institutes of Health</institution>
          </institution-wrap>
        </funding-source>
        <award-id>5R01DC012441</award-id>
        <principal-award-recipient>
          <name>
            <surname>Trembleau</surname>
            <given-names>Alain</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100001665</institution-id>
            <institution>Agence Nationale de la Recherche</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2017</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p>With the advent of modern biophysical techniques and devices [<xref ref-type="bibr" rid="CR1">1</xref>, <xref ref-type="bibr" rid="CR2">2</xref>], the need for image analysis (IA) of the recordings and automatic processing of obtained data has been growing. Versatile IA open software solutions, e.g. ImageJ [<xref ref-type="bibr" rid="CR3">3</xref>], Icy [<xref ref-type="bibr" rid="CR4">4</xref>], Vaa3d [<xref ref-type="bibr" rid="CR5">5</xref>] and cellProfiler [<xref ref-type="bibr" rid="CR6">6</xref>], were developed to provide the broad scientific community with tools for analysis of general experimental data. Open-source developers and research groups involved in those software projects contributed many powerful and accessible plug-ins for widely used technologies and common IA tasks. In addition, a plethora of specialized algorithms were designed to process the primary image data of particular experimental devices. The specialized algorithms are however typically complex, their implementation often lacks a graphical user interface (GUI) and is seldom publicly available or documented. Therefore, user-friendly dedicated IT tools are still lacking for specific biophysical techniques; one of such techniques is the Biomembrane Force Probe (BFP). This technique could become more accessible if robust post-experiment analysis were readily feasible—it would decrease the need for specialized equipment, relax constrains on experimental procedure and imaging quality, and allow repeated and more sophisticated analysis. Due to technical constraints (limitations on the bandwidth of video recording and on data file size), such an approach was not practical in the early days of the BFP technique (1990s), but has become readily feasible with current standard equipment. The aim of this work is to provide a Matlab-based processing and analytical tool with intuitive GUI precisely for the BFP.</p>
    <p>The BFP technique (experimental configuration illustrated in Fig. <xref rid="Fig1" ref-type="fig">1</xref>) was invented by Evans et al. [<xref ref-type="bibr" rid="CR7">7</xref>] as a suitable tool for single-molecule force spectroscopy [<xref ref-type="bibr" rid="CR8">8</xref>] and experiments on biological interfaces [<xref ref-type="bibr" rid="CR9">9</xref>]. While the purpose of single-molecule force spectroscopy is to determine the single bond energy landscape, lifetime and failure probability under particular load and loading rate [<xref ref-type="bibr" rid="CR10">10</xref>], experiments on biological interfaces focus on surface adhesion energy and membrane rigidity. The BFP can be directly used in culture medium, it interacts with cells softly and allows measuring a wide range of forces, from tenths of piconewton to nanonewton, e.g. to record the breaking of a protein bond [<xref ref-type="bibr" rid="CR11">11</xref>–<xref ref-type="bibr" rid="CR13">13</xref>]. It is composed of a micro-pipette connected to a controller acting as a manipulative apparatus, and of a red blood cell (RBC) acting as a force transducer. The RBC is aspirated in a pipette and a bead is attached to its apex to serve as an intermediary element. Typically, a biotinylated RBC and a streptavidin-coated bead are used; when brought in contact, a streptavidin-biotin link is formed, keeping the bead attached to the RBC. The bead can then form another bond of interest with a single molecule (e.g. protein, DNA) or with another interface (e.g. cell, vesicle). Controlled movement of the RBC-mounted pipette (RMP) or of the studied sample imposes a load <italic>F</italic> on the studied bond/interface, mediated by the bead and transduced by the RBC. The RBC undergoes a deformation proportional to the load, <italic>Δ</italic>
<italic>x</italic>∝<italic>F</italic>. The deformation <italic>Δ</italic>
<italic>x</italic> can be measured by tracking the centre of the circular bead and a specific point on the pipette tip; the change in the distance of these two tracked points corresponds to the RBC deformation.
<fig id="Fig1"><label>Fig. 1</label><caption><p>Probe calibration illustration. In the linear elastic regime, the probe can be described as a spring with stiffness <italic>k</italic>. The stiffness depends on geometry (<italic>R</italic>
<sub>0</sub>,<italic>R</italic>
<sub><italic>c</italic></sub>,<italic>R</italic>
<sub><italic>p</italic></sub>) of the probe and the aspiration pressure <italic>Δ</italic>
<italic>P</italic> and is given by Eq. <xref rid="Equ1" ref-type="">1</xref>. The force at any time is given by the deformation of the RBC <italic>Δ</italic>
<italic>x</italic>(<italic>t</italic>)=<italic>x</italic>(<italic>t</italic>)−<italic>x</italic>
<sub>0</sub>, where <italic>x</italic>
<sub>0</sub> is a reference distance measured when the RBC is not under load. It is effectively measured as the distance between the centre of bead and a particular anchor point on the pipette (marked by <italic>blue crosses</italic>)—a change in this distance corresponds to the change in length of RBC, <italic>Δ</italic>
<italic>x</italic>
</p></caption><graphic xlink:href="13628_2016_33_Fig1_HTML" id="MO1"/></fig>
</p>
    <p>Surprisingly, no freely-available dedicated processing software is available to analyse BFP recordings. In [<xref ref-type="bibr" rid="CR11">11</xref>, <xref ref-type="bibr" rid="CR14">14</xref>], the bead tracking was performed in real time during the experiment using custom software, fitting a Gaussian blob onto the bead image intensity profile. An alternative method was developed in the proprietary software LabView [<xref ref-type="bibr" rid="CR15">15</xref>], detecting the bead fringe as a minimum in contrast along the probe axis. To our knowledge, none of these software solutions were publicly released. These methods were implemented for experiments in which the RMP was not tracked (i.e. either remained static, or had position obtained indirectly from piezo controller movements), the field was clear and the focus reliable. This would not be the case for many biological applications; the user might need to move the RMP freely, will be faced with debris, unstable focus, littered field and constrains that prohibit the movement of the working stage. Under such circumstances, it is useful to have a more versatile tool offering not only bead tracking but also pipette detection, adjustments, exceptions treatment, thresholding, adaptation and basic analytical features.</p>
    <p>The present software tool addresses these points. It provides a GUI to keep all the functions easily accessible to the end-user, while their implementation is contained in a single, easily installable package. Importantly, it is designed to analyse the captured videos after the experiment, allowing the user to make necessary or optional adjustments to the processing of the recording. The tool is written in Matlab, which makes it cross-platform accessible, and an extensive I/O interface is implemented to allow for post-processing in other programs and easy transferability of the results.</p>
  </sec>
  <sec id="Sec2">
    <title>Implementation</title>
    <p>The tool is presented in the form of a Matlab application package, bundled into an application installation file <bold>BFPTool.mlappinstall</bold>. It can be easily installed into the Matlab application dashbar and run by clicking the icon. The application was tested in Matlab version 2015b and 2016a with Image Processing Toolbox, under Linux (Ubuntu 16.04), Windows 10, and Mac OS 10.9 and later. It is accompanied with a user guide and essential documentation, which are embedded in the installation file; after the first run of the application, the documentation can be reached directly from the home page in the Matlab help browser, and is fully searchable for keywords. During the application installation, the source M files are unpacked into Matlab application folder; the code has been commented extensively and can be readily modified by users to suit their own needs. For convenience of the user, the application was designed for two distinct scenarios of analysis. A basic scenario, using default settings, is suitable for good quality recordings, allowing to do fast tracking and to immediately plot the measured deformation <italic>Δ</italic>
<italic>x</italic>. The user quickly obtains preliminary qualitative information about the force time course, without a need to study the program interface and functions. The second scenario is more detailed, and allows the user to adjust tracking intervals and parameters, visualize the tracking results in different ways, precisely measure the parameters of the probe geometry, and perform basic analysis of the time course of the calculated force and fidelity metrics.</p>
    <sec id="Sec3">
      <title>Computational functions</title>
      <p>The main purpose of the application is to calculate the applied force time course, <italic>F</italic>(<italic>t</italic>). This is implemented by the Matlab class <italic>BFPClass</italic> (child of the native <italic>handle</italic> superclass). The instances of this class are constructed with initial information about the experiment (e.g. geometry, pipette and bead tracking settings, list of frames for processing), they store results (e.g. bead/pipette coordinates, log of bad frames, force) and perform some of the complementary tasks (e.g. plotting, stiffness calculation). The class calls two external functions to perform the tracking of the bead and the pipette tip and calculates the force based on the returned results.</p>
      <p>We assume that the system is approximately axial (centres of the bead and RBC, and the pipette anchor, are all on one axis), so the extension or compression of the RBC along the axis, <italic>Δ</italic>
<italic>x</italic>(<italic>t</italic>), is equal to the change in distance <italic>x</italic>(<italic>t</italic>) between the bead centre and the pipette tip anchor, compared to such distance when the RBC is under zero load, <italic>x</italic>
<sub>0</sub> (see Fig. <xref rid="Fig1" ref-type="fig">1</xref>). The positions of the bead centre and the pipette tip anchor at the given time therefore determine the RBC deformation and consequently the force, <italic>F</italic>(<italic>t</italic>).</p>
      <p>The bead tracking algorithm is based on Matlab’s circle detection function <italic>imfindcircles</italic> from the Image Processing Toolbox, which implements a circular Hough transform, either two-stage or phase coding method. Both algorithms are applied on each frame, on the area around the last confirmed presence of the tracked bead. A list of potential candidates is built from scores (above a threshold) based on the <italic>imfindcircles</italic> detection metric <italic>M</italic>
<sub><italic>b</italic>,<italic>i</italic></sub> (where the index <italic>i</italic> numbers the candidates) and the distance <italic>d</italic>
<sub><italic>i</italic></sub> of candidate centre from the centre of the last known position of the bead, with candidates’ radii within the range (<italic>R</italic>
<sub>&lt;</sub>,<italic>R</italic>
<sub>&gt;</sub>). The bead metric is the value of the accumulator array for the given pixel returned by the <italic>imfindcircles</italic> method, usually in the range <italic>M</italic>
<sub><italic>b</italic>,<italic>i</italic></sub>∈(0,3). A distance factor <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$f_{i}=\frac {\max (d_{i},R_{&lt;})}{R_{&lt;}}$\end{document}</tex-math><mml:math id="M2"><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo>max</mml:mo><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mo>&lt;</mml:mo></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mo>&lt;</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:math><inline-graphic xlink:href="13628_2016_33_Article_IEq1.gif"/></alternatives></inline-formula> is used to decreases the weight of candidates that moved too far; the final sorting scores are <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\frac {M_{b,i}}{f_{i}}=\frac {M_{b,i}R_{&lt;}}{\max (d_{i},R_{&lt;})}$\end{document}</tex-math><mml:math id="M4"><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mo>&lt;</mml:mo></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mo>max</mml:mo><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mo>&lt;</mml:mo></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mfrac></mml:math><inline-graphic xlink:href="13628_2016_33_Article_IEq2.gif"/></alternatives></inline-formula>. The highest score, <inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$M_{b}=\max \left (\!\frac {M_{b,i}}{f_{i}}\!\right)$\end{document}</tex-math><mml:math id="M6"><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>max</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mspace width="0.3em"/><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mspace width="0.3em"/></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="13628_2016_33_Article_IEq3.gif"/></alternatives></inline-formula>, is selected as the match, the position is logged and used to calculate <italic>d</italic>
<sub><italic>i</italic></sub> for the next time frame. The centre of the bead is detected with sub-pixel precision, based on the accumulator array result. The major advantage of this method is that it detects also partially obscured objects, however the more edge pixels are obscured the lower the precision is. The detection accuracy depends on the bead size and image quality, and is typically in the range 30-50 nm.</p>
      <p>The pipette tracking algorithm uses pattern matching, based on evaluating the normalized cross correlation (Matlab <italic>normxcorr2</italic> function) of a user-delineated template of the pipette tip with sub-frames of the video. After the template is repeatedly matched, being moved pixel by pixel across a restricted area in the video frame, the correlation coefficients (for each template position), are saved in a 2D array, <italic>M</italic>
<sub><italic>p</italic>,<italic>i</italic><italic>j</italic></sub>. The best match, <italic>M</italic>
<sub><italic>p</italic></sub>= max(<italic>M</italic>
<sub><italic>p</italic>,<italic>i</italic><italic>j</italic></sub>), is determined at single-pixel precision, and the value <italic>M</italic>
<sub><italic>p</italic></sub> represents the pipette tracking metric value for the given time frame. The array is then interpolated by an elliptical paraboloid to determine the coordinate of maximal correlation with sub-pixel precision, typically <inline-formula id="IEq4"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\lesssim $\end{document}</tex-math><mml:math id="M8"><mml:mo>≲</mml:mo></mml:math><inline-graphic xlink:href="13628_2016_33_Article_IEq4.gif"/></alternatives></inline-formula>10 nm—the detection is more precise than the detection of the bead. The pipette detection is generally very robust and stable during the recorded time course. The procedure implements additional steps, like dilation (erosion) of the pattern, in case the correlation score becomes too low. In such case, the initial frame of the processed time interval is tested against the current pattern. If the pattern is reliably localized, a set of new patterns is extracted from the initial frame by delimiting larger or smaller areas (dilation or erosion). Such new patterns are matched in the problematic frame of low metric reading (which evoked the correction procedure); the final pipette location in the frame is determined by the pattern yielding the highest correlation metric score.</p>
      <p>The pattern matching is a direct method of pipette position tracking with precision <inline-formula id="IEq5"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\lesssim $\end{document}</tex-math><mml:math id="M10"><mml:mo>≲</mml:mo></mml:math><inline-graphic xlink:href="13628_2016_33_Article_IEq5.gif"/></alternatives></inline-formula>10 nm. It is usable with any pipette manipulation setup, thus permitting the use of micromanipulators with unrestricted direction, range and speed. Setups based on piezo translators allow an even higher precision (around 1 nm) of pipette tracking using the piezo feedback signal; however, such setups have a limited operation range (typically around 15 <italic>μ</italic>m) and offer significantly less flexibility.</p>
      <p>The bead and pipette tracking procedures determine the RBC deformation at any given time, <italic>Δ</italic>
<italic>x</italic>(<italic>t</italic>)=<italic>x</italic>(<italic>t</italic>)−<italic>x</italic>
<sub>0</sub> (<italic>B</italic> in Fig. <xref rid="Fig2" ref-type="fig">2</xref>). The force calculation (<italic>A</italic> in Fig. <xref rid="Fig2" ref-type="fig">2</xref>) is performed in linear regime of force-extension relation (see Fig. <xref rid="Fig1" ref-type="fig">1</xref>), i.e. <italic>F</italic>=<italic>k</italic>·<italic>Δ</italic>
<italic>x</italic>, where <italic>k</italic> is the stiffness of the probe. The stiffness is calculated using the following equation [<xref ref-type="bibr" rid="CR16">16</xref>, <xref ref-type="bibr" rid="CR17">17</xref>]: 
<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $${} k = R_{p} \Delta P\frac{\pi}{(1-\hat{R}_{p})} \frac{1}{\log\!\left(\!\frac{4}{\hat{R}_{c}\hat{R}_{p}}\right)- \left(1 - \frac{1}{4} \hat{R}_{p} - \frac{3}{8} \hat{R}_{p}^{2} + \hat{R}_{c}^{2}\right)}  $$ \end{document}</tex-math><mml:math id="M12"><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mi>ΔP</mml:mi><mml:mfrac><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mfrac><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>log</mml:mo><mml:mspace width="0.3em"/><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mspace width="0.3em"/><mml:mfrac><mml:mrow><mml:mn>4</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced><mml:mo>−</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:mfrac><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn>3</mml:mn></mml:mrow><mml:mrow><mml:mn>8</mml:mn></mml:mrow></mml:mfrac><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:mrow></mml:mfrac></mml:math><graphic xlink:href="13628_2016_33_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula>
<fig id="Fig2"><label>Fig. 2</label><caption><p>Program workflow. Red nodes (labelled by <italic>upper-case letters</italic>) represent the basic workflow of the program, which requires little user input. The <italic>blue</italic> nodes provide the optional means of adjustment and optimisation (labelled by <italic>lower-case letters</italic>). The nodes are referred to by their labels at the appropriate sections of the text, where more details are provided</p></caption><graphic xlink:href="13628_2016_33_Fig2_HTML" id="MO2"/></fig>
</p>
      <p>where <italic>R</italic>
<sub><italic>p</italic></sub> is the pipette radius, <italic>R</italic>
<sub><italic>c</italic></sub> is the contact radius and <italic>R</italic>
<sub>0</sub> is the radius of aspirated RBC without any load; <italic>Δ</italic>
<italic>P</italic> is the aspiration pressure (see Fig. <xref rid="Fig1" ref-type="fig">1</xref>). The hat designates a radius normalized as fraction of radius of the RBC (<italic>R</italic>
<sub>0</sub>), e.g. <inline-formula id="IEq6"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat {R}_{p}{=}\frac {R_{p}}{R_{0}}$\end{document}</tex-math><mml:math id="M14"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:math><inline-graphic xlink:href="13628_2016_33_Article_IEq6.gif"/></alternatives></inline-formula>. The linear force-extension regime is known to hold well for RBC deformations smaller than <italic>Δ</italic>
<italic>x</italic> &lt; 0.5 <italic>μ</italic>m; when this threshold is exceeded, the linear relation overestimates the force.</p>
      <p>If no calibration information is provided, the program will calculate the time course of change in length of the RBC, <inline-formula id="IEq7"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\Delta \tilde {x}(t)$\end{document}</tex-math><mml:math id="M16"><mml:mi>Δ</mml:mi><mml:mover accent="true"><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="13628_2016_33_Article_IEq7.gif"/></alternatives></inline-formula>
<sup>1</sup>. This change in length corresponds to the deformation of RBC (<inline-formula id="IEq8"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\Delta \tilde {x}{=}\Delta x$\end{document}</tex-math><mml:math id="M18"><mml:mi>Δ</mml:mi><mml:mover accent="true"><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mi>Δx</mml:mi></mml:math><inline-graphic xlink:href="13628_2016_33_Article_IEq8.gif"/></alternatives></inline-formula>) only if the reference length, <italic>x</italic>
<sub>0</sub> (corresponding to unstrained RBC), is properly defined (i.e. <inline-formula id="IEq9"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$x_{0}{=}\tilde {x}_{0}$\end{document}</tex-math><mml:math id="M20"><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13628_2016_33_Article_IEq9.gif"/></alternatives></inline-formula>)—i.e., the appropriate frame <italic>t</italic>
<sub>0</sub> is selected as illustrated in Fig. <xref rid="Fig1" ref-type="fig">1</xref>. The program otherwise extracts an arbitrary reference length <inline-formula id="IEq10"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\tilde {x}_{0}$\end{document}</tex-math><mml:math id="M22"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13628_2016_33_Article_IEq10.gif"/></alternatives></inline-formula> from the first frame of processed interval, leading to results shifted by <inline-formula id="IEq11"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$x_{0}-\tilde {x}_{0}$\end{document}</tex-math><mml:math id="M24"><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13628_2016_33_Article_IEq11.gif"/></alternatives></inline-formula> from the true value. The program also contains predefined generic values for probe geometry and aspiration pressure (<inline-formula id="IEq12"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\tilde {R}_{p}$\end{document}</tex-math><mml:math id="M26"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13628_2016_33_Article_IEq12.gif"/></alternatives></inline-formula>=1.0 <italic>μ</italic>m, <inline-formula id="IEq13"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\tilde {R}_{0}$\end{document}</tex-math><mml:math id="M28"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13628_2016_33_Article_IEq13.gif"/></alternatives></inline-formula>=2.5 <italic>μ</italic>m, <inline-formula id="IEq14"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\tilde {R}_{c}$\end{document}</tex-math><mml:math id="M30"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13628_2016_33_Article_IEq14.gif"/></alternatives></inline-formula>=0.75 <italic>μ</italic>m, <inline-formula id="IEq15"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\Delta \tilde {P}$\end{document}</tex-math><mml:math id="M32"><mml:mi>Δ</mml:mi><mml:mover accent="true"><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="13628_2016_33_Article_IEq15.gif"/></alternatives></inline-formula>=200 Pa), which can be used to calculate a generic stiffness <inline-formula id="IEq16"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\tilde {k}$\end{document}</tex-math><mml:math id="M34"><mml:mover accent="true"><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="13628_2016_33_Article_IEq16.gif"/></alternatives></inline-formula> and an order of magnitude estimate of the non-calibrated applied force <inline-formula id="IEq17"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\tilde {F}$\end{document}</tex-math><mml:math id="M36"><mml:mover accent="true"><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="13628_2016_33_Article_IEq17.gif"/></alternatives></inline-formula>.</p>
      <p>The tool however contains a feature to conveniently measure the necessary radii of the probe to obtain <italic>k</italic>. The reference frame with the unstrained RBC, to calibrate zero force, has to be always selected based on user’s judgement.</p>
    </sec>
    <sec id="Sec4">
      <title>Basic analysis</title>
      <p>Preliminary analysis of the data can be performed in several direct steps, without setting any particular parameters. Please refer to Fig. <xref rid="Fig2" ref-type="fig">2</xref> to see the functions in context of the workflow; the basic program features form an integrated set, coloured in red and labelled by capital letters.</p>
      <p>The analysis begins with loading of a video of the BFP experiment (<italic>C</italic> in Fig. <xref rid="Fig2" ref-type="fig">2</xref>). Standard video formats compatible with Matlab are supported (including AVI, MP4, MOV, WMV—a complete list can be found at MathWorks website [<xref ref-type="bibr" rid="CR18">18</xref>]); Matlab also supports TIFF stacks through LibTIFF library [<xref ref-type="bibr" rid="CR19">19</xref>]. Note that TIFF metadata fields are not always reliably populated—in case the program cannot detect the framerate parameter, the user is prompted to provide the information during the video import or change it in the GUI. The implemented wrapper class <italic>vidWrap</italic> provides a unified interface for all types of media files; it contains several verification procedures and maintains basic information about the video file and its contrast metric. Once the video file has been opened, GUI buttons are enabled and the user can select a bead to track (<italic>D</italic> in Fig. <xref rid="Fig2" ref-type="fig">2</xref>) and delineate a pattern of pipette tip (<italic>E</italic> in Fig. <xref rid="Fig2" ref-type="fig">2</xref>) to match. Having chosen the interval (<italic>F</italic> in Fig. <xref rid="Fig2" ref-type="fig">2</xref>) of frames to process, the tracking procedure can be started (<italic>B</italic> in Fig. <xref rid="Fig2" ref-type="fig">2</xref>), the <italic>BFPClass</italic> object is constructed and the functions invoked. The program tracks the bead and the pipette, one after the other.</p>
      <p>Several performance metrics are evaluated to ensure robust tracking. The metrics <italic>M</italic>
<sub><italic>p</italic></sub> for pipette and <italic>M</italic>
<sub><italic>b</italic></sub> for bead detection were already presented in the section <xref rid="Sec3" ref-type="sec">Computational functions</xref>. In addition, two types of contrast metric are defined: (1) the time course of the standard deviation (SD2) of pixel intensities in each frame, normalized by the maximal value during the time course and (2) the running standard deviation (rSD2) of SD2 values (based on a 40-frame window by default), also normalized by the maximum. In case the SD2 contrast metric decreases below a threshold (SD2&lt;0.95), or the tracking metrics do (<italic>M</italic>
<sub><italic>p</italic></sub>&lt;0.95, <italic>M</italic>
<sub><italic>b</italic></sub>&lt;0.8 by default), the program issues a warning, logs the frame of incident, and attempts to proceed with tracking, unless either pipette or bead cannot be recognized over several consecutive frames (5 by default). In a successful case, tracking across the interval is completed, the deformation (force) time course is plotted and intervals of potential detection instability are reported. If the probe is not calibrated, the method will invoke generic probe geometry and provide the deformation and the uncalibrated force readings.</p>
    </sec>
    <sec id="Sec5">
      <title>Optional features</title>
      <p>The tool contains many functions allowing the user to narrow down or optimize the analysis. These are marked by blue nodes and labelled by lower-case letters in Fig. <xref rid="Fig2" ref-type="fig">2</xref>. The possibilities are discussed as they follow the main workflow.</p>
      <p>Upon video upload, the SD2 contrast metric is calculated and displayed (<italic>a</italic> in Fig. <xref rid="Fig2" ref-type="fig">2</xref>), helping to keep track of image quality and to suggest sections of the video possibly unsuitable for analysis. Similarly, the rSD2 metric is shown, to point out intervals of variable contrast, most often resulting from focus shifts. If the value of the SD2 metric changes and remains stable during a well-defined interval, the user may try to track the affected interval separately, using an alternative pipette tip pattern. A continually fluctuating contrast however perturbs the response of pipette pattern-matching and bead detection, which impairs the precision of RBC deformation measurement; such intervals are better excluded.</p>
      <p>Using the contrast data or making deliberate choices, the user can take advantage of a video-editing interface (<italic>b</italic> in Fig. <xref rid="Fig2" ref-type="fig">2</xref>) to construct a chain of non-contiguous intervals to track. This is a key feature for analysis of suboptimal recordings. Such recordings contain one or more intervals of frames, where the straightforward method proposed in the section <xref rid="Sec4" ref-type="sec">Basic analysis</xref> fails for reasons as faltering focus, severe obscuring of the bead, physical changes to the probe (e.g. RBC replacement, separation of the probe), or straying out of the field. It allows the user to subdivide the recording analysis, defining a pipette pattern to be shared among some intervals, while changing the inputs for other intervals (<italic>F</italic> in Fig. <xref rid="Fig2" ref-type="fig">2</xref>). The interval selection procedure runs a series of verifications and displays informative messages, to ensure all intervals are properly constructed, eventually prompting the user for ad hoc corrections or additional input (<italic>c</italic> in Fig. <xref rid="Fig2" ref-type="fig">2</xref>).</p>
      <p>The interval chain construction is aided by supplementary functions (<italic>d, e</italic> in Fig. <xref rid="Fig2" ref-type="fig">2</xref>), which allow to save a particular bead and pipette pattern and reuse them later. This can be particularly useful when sections of video suitable for processing are heavily fragmented or when the user repeatedly updates the selection of intervals.</p>
      <p>The tracking procedure itself can be finely tuned. Most of the thresholds and sensitivities are adjustable. When the program detects under-performing metrics, besides issuing warnings, it adaptively attempts to refine the detection by changing some of these thresholds or loosening restrictions on the detection area.</p>
      <p>It is not necessary to set any parameters to obtain uncalibrated deformation and force time courses, as outlined in the <xref rid="Sec4" ref-type="sec">Basic analysis</xref> section. To obtain a precise reading of force, the probe must be calibrated by assigning the RBC stiffness <italic>k</italic> (see Eq. <xref rid="Equ1" ref-type="">1</xref>). The geometrical parameters, <italic>R</italic>
<sub><italic>p</italic></sub>, <italic>R</italic>
<sub><italic>c</italic></sub>, and <italic>R</italic>
<sub>0</sub> can be conveniently measured directly in the video using the program’s dedicated interactive feature (<italic>f</italic> in Fig. <xref rid="Fig2" ref-type="fig">2</xref>). In case the explicit video resolution (pixel to micron ratio) is unknown, it can be calibrated by measuring the video scale bar or any object of known dimensions. As a result, only the aspiration pressure <italic>Δ</italic>
<italic>P</italic> in Pascals must be input by the user as an external parameter—everything else can be extracted from the recording itself.</p>
      <p>Having performed the tracking, its quality can be directly verified by displaying an overlay marking the detected coordinates over the main video frames in the GUI video player. A red circle delineates the detected bead’s edge and a small blue circle identifies the anchor point on pipette tip. This feature is the most direct conceivable way to assure oneself that the tracking was carried out successfully and accurately. More complementary information is accessible through a graphing panel embedded in the GUI (<italic>g</italic> in Fig. <xref rid="Fig2" ref-type="fig">2</xref>). Any obtained data can be visualized: trajectories of the pipette and the bead in time, calculated deformation <italic>Δ</italic>
<italic>x</italic>(<italic>t</italic>) and force <italic>F</italic>(<italic>t</italic>), as well as contrast metrics (SD2, rSD2) and tracking metrics (<italic>M</italic>
<sub><italic>b</italic></sub>, <italic>M</italic>
<sub><italic>p</italic></sub>).</p>
      <p>Some elementary analytical tools were implemented as part of the graphing panel. User can select an interval of interest in the obtained data, and fit the data with a straight line or an exponential, or run a plateau detection procedure (<italic>h</italic> in Fig. <xref rid="Fig2" ref-type="fig">2</xref>). These simple regressions can provide initial information about the loading rate, relaxation time of the system, or an average force applied during an equilibrium situation.</p>
      <p>Finally, we provide several import/export options (<italic>i</italic> in Fig. <xref rid="Fig2" ref-type="fig">2</xref>). It is possible to export graphs, images, data (in CSV format) to a file or to the Matlab base workspace. The major feature is the possibility to save the whole GUI session at the given moment, and load it later to continue the analysis. The corresponding MAT file is fully transferable, and may be imported into the tool runing on another computer (note that the video file must be also present on the target machine).</p>
    </sec>
  </sec>
  <sec id="Sec6">
    <title>Results and discussion</title>
    <p>In this section, we will demonstrate both approaches outlined in the previous section, running analyses on a simple example (with a single tracked interval) and on more complex videos. The videos originate from our BFP experiments and represent typical examples.</p>
    <p>The experiments were performed on biotinylated olfactory epithelium explants after 2 days of cultivation. Streptavidin-coated 3 <italic>μ</italic>m diameter beads were added to the culture and attached to the biotinylated axons during cultivation. RBCs were obtained from a drop of human blood, drawn with a medical lancing device; laboratory gloves were used while handling the blood to prevent infection risk. The protocol was approved by the ENS Safety and Ethics Committee; informed and written consent to participate was obtained from the healthy volunteer whose drop of blood was taken. The isolated RBCs were stored in phosphate buffered saline. The RBCs were then covalently linked with PEG-biotin polymers (purchased from Interchim), following the protocol kindly provided by E. Evans [<xref ref-type="bibr" rid="CR20">20</xref>]. The biotinylated RBCs were used for BFP measurements within 3 weeks.</p>
    <p>The BFP manipulations were done in a thermostated chamber (37 °C) mounted with the Leica DMIRB inverted microscope, and recorded by a JAI CCD digital camera. Biotinylated RBCs were added to the culture, one was selected and aspirated into the micropipette (of diameter 1.5–2.0 <italic>μ</italic>m, aspiration pressure 200–250 Pa), and brought in contact with a bead to allow a streptavidin-biotin link to be formed. The assembled probe was then slowly manipulated to gradually deflect the attached axon. More context can be found in [<xref ref-type="bibr" rid="CR21">21</xref>].</p>
    <p>The main difference between this configuration of the BFP experiment and those reported previously [<xref ref-type="bibr" rid="CR7">7</xref>, <xref ref-type="bibr" rid="CR11">11</xref>–<xref ref-type="bibr" rid="CR13">13</xref>, <xref ref-type="bibr" rid="CR15">15</xref>] is the positioning and tracking of the pipette: the RMP position was inferred from controlled constrained movement of a piezo translator in earlier work, while our experiments relied on free mobility of the probe. This approach gave us flexibility to work with experimental conditions we could not control (such as the distribution and localization of the beads across the axonal network) and to perform manipulations in the direction and extent we needed. Tracking the pipette and the bead in the same frame also removes the need to synchronize the piezo translator feedback with the video acquisition device.</p>
    <sec id="Sec7">
      <title>Basic approach for analysing good quality recordings</title>
      <p>Figure <xref rid="Fig3" ref-type="fig">3</xref>
<xref rid="Fig3" ref-type="fig">a</xref> shows a screenshot of the video overlaid with the tracking results, the bead delineated in red, the reference point (anchor) on the pipette in blue. In this example, the analysed video was 456 frames long (7.0 s at 65 fps), and the whole interval was treated in a single run. After opening the video, the bead was click-selected, and a tight delineating rectangle was drawn around the pipette tip (white dashed in Fig. <xref rid="Fig3" ref-type="fig">3</xref>
<xref rid="Fig3" ref-type="fig">a</xref>) to delimit the pattern for matching. The tracking procedure could be started immediately.
<fig id="Fig3"><label>Fig. 3</label><caption><p>Outputs of quick analysis. Results of simple case analysis of good quality video. <bold>a</bold> Frame from the video, t=5.0 s, contrast is sufficiently high and stable. The bead is marked by the <italic>red ring</italic>, the point tracked on the pipette in <italic>blue</italic>, the pipette tip pattern outlined by the <italic>white dashed box</italic>. <bold>b</bold> Tracking quality metrics of the bead (<italic>red</italic>) and correlation coefficient of the pipette (<italic>blue</italic>). Note that the bead detection quality is very volatile as compared to the pipette. <bold>c</bold> Tracks of the bead centre (<italic>red</italic>) and the pipette anchor point (<italic>blue</italic>) during the experiment time course. In the inset, part of the bead track is magnified; the last second of the path, delimited by the time points 6 s and 7 s, is highlighted (rest is faded). The time point 6.6 s denotes the probe rupture—see panel D. Fluctuations of the bead along the Y-coordinate (perpendicular to the pipette movements) are of order 10 nm. <bold>d</bold> Deformation of the RBC (<italic>Δ</italic>
<italic>x</italic>) and the force exerted by the probe during the experiment. <italic>Red dashed line</italic> indicates the zero force, the red mark indicates a separation of the RBC and bead. Total computational CPU time 105 s. The video file used for this analysis, <italic>basic.avi</italic>, is included in the program repository</p></caption><graphic xlink:href="13628_2016_33_Fig3_HTML" id="MO3"/></fig>
</p>
      <p>The panel in Fig. <xref rid="Fig3" ref-type="fig">3</xref>
<xref rid="Fig3" ref-type="fig">b</xref> shows the tracking metrics, with the blue line corresponding to the pipette correlation <italic>M</italic>
<sub><italic>p</italic></sub>, and the red line to the bead metric <italic>M</italic>
<sub><italic>b</italic></sub>. Both indicators remain sufficiently stable and elevated during the analysis. While the bead metric tends to be more volatile (which is true also in general), the robustness of the pipette correlation is evident, with the correlation coefficient <inline-formula id="IEq18"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$M_{p}\gtrsim 0.97$\end{document}</tex-math><mml:math id="M38"><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>≳</mml:mo><mml:mn>0.97</mml:mn></mml:math><inline-graphic xlink:href="13628_2016_33_Article_IEq18.gif"/></alternatives></inline-formula> during the whole interval.</p>
      <p>Their tracked positions behave in an orderly manner, as can be seen in Fig. <xref rid="Fig3" ref-type="fig">3</xref>
<xref rid="Fig3" ref-type="fig">c</xref>; no rapid changes in position are present, neither for the bead nor for the pipette anchor. The inset in Fig. <xref rid="Fig3" ref-type="fig">3</xref>
<xref rid="Fig3" ref-type="fig">c</xref> magnifies the track of the bead; for the sake of clarity, only the last second of the track is highlighted (the rest is faded). In the panel, the bead moves predominantly along the x-coordinate, reacting to the movements of the pipette. The bead displacements along the y-coordinate are very limited, of the order of ∼10 nm between consecutive frames, corresponding mostly to the uncertainty of bead-tracking method. Strong metrics and smooth trajectories confirm that the tracking was stable during the analysis and the basic procedure was sufficient.</p>
      <p>The time course of RBC deformation <italic>Δ</italic>
<italic>x</italic>(<italic>t</italic>) in Fig. <xref rid="Fig3" ref-type="fig">3</xref>
<xref rid="Fig3" ref-type="fig">d</xref> shows gradual changes, with limited and stable variance in time. The red mark indicates the time point at which the probe separated from the bead. We calibrated the probe in two steps: (1) we measured its geometry and calculated the stiffness (see Eq. <xref rid="Equ1" ref-type="">1</xref>), <inline-formula id="IEq19"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$k= {198}\frac {\text {pN}}{\upmu \mathrm {m}}$\end{document}</tex-math><mml:math id="M40"><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>198</mml:mn><mml:mfrac><mml:mrow><mml:mtext>pN</mml:mtext></mml:mrow><mml:mrow><mml:mi>μ</mml:mi><mml:mi mathvariant="normal">m</mml:mi></mml:mrow></mml:mfrac></mml:math><inline-graphic xlink:href="13628_2016_33_Article_IEq19.gif"/></alternatives></inline-formula>; (2) we identified the frame with the reference distance <italic>x</italic>
<sub>0</sub>—the frame of initial contact of RBC with the bead, where the RBC becomes slightly deformed by adhesive forces, but no load is applied (<italic>F</italic>=0). Calibrated values of the measured force could then be obtained. To estimate the uncertainty of the force measurement, we determined the running variance for the force data using a 40-frame window [<xref ref-type="bibr" rid="CR22">22</xref>]. The standard deviation of force was <inline-formula id="IEq20"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$F\lesssim 10\,\mathrm {p} \mathrm {N}$\end{document}</tex-math><mml:math id="M42"><mml:mi>F</mml:mi><mml:mo>≲</mml:mo><mml:mn>10</mml:mn><mml:mspace width="0.3em"/><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">N</mml:mi></mml:math><inline-graphic xlink:href="13628_2016_33_Article_IEq20.gif"/></alternatives></inline-formula> and was independent on the current force magnitude. The measurement uncertainties are systematically discussed in the section <xref rid="Sec9" ref-type="sec">Advantages, disadvantages and improvements</xref>.</p>
      <p>The user has the option to ignore the particular geometry of the current probe and perform a force calculation using pre-defined values. In such case, the information concerning the RBC deformation <italic>Δ</italic>
<italic>x</italic> is still clearly valid, but the RBC stiffness <inline-formula id="IEq21"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\tilde {k}$\end{document}</tex-math><mml:math id="M44"><mml:mover accent="true"><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="13628_2016_33_Article_IEq21.gif"/></alternatives></inline-formula> is merely generic and the calculated force <inline-formula id="IEq22"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\tilde {F}$\end{document}</tex-math><mml:math id="M46"><mml:mover accent="true"><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="13628_2016_33_Article_IEq22.gif"/></alternatives></inline-formula> gives only information about the time course, but not the correct magnitude, of the load force.</p>
      <p>Additional file <xref rid="MOESM1" ref-type="media">1</xref> is a demonstration video that shows how the analysis was performed in the GUI.</p>
    </sec>
    <sec id="Sec8">
      <title>Advanced options for analysing more complex recordings</title>
      <p><bold>Interrupted tracking:</bold> In many recordings, the stability of focus and the general quality of the video can become sub-optimal; this impairs the detection and may lead to a fatal tracking failure. The user can use the information provided by initial contrast analysis and identify problematic time intervals before starting the tracking procedure. The tool provides features to exclude such intervals from tracking analysis and to link in chain the remaining parts of the recording (<italic>b</italic> in Fig. <xref rid="Fig2" ref-type="fig">2</xref>).</p>
      <p>As can be seen in Fig. <xref rid="Fig4" ref-type="fig">4</xref>
<xref rid="Fig4" ref-type="fig">a</xref>, the SD2 contrast metric declines by the end of the video, eventually dropping below the threshold of 0.95 marked by the blue dashed line. This suggests a change in focus of the video, or a major change in the field (e.g. the pipette is removed). The tracking is therefore stopped before this decline begins, as delimited by the red dashed line after <italic>t</italic>=8 s.
<fig id="Fig4"><label>Fig. 4</label><caption><p>Interrupted tracking. The video could be tracked using a single set of settings, but a gap had to be introduced. <bold>a</bold> Time course of contrast, SD2 of each video frame. No significant drop below the threshold (95%) is observed. <bold>b</bold> Running standard deviation of the contrast metric (rSD2). It defines how variable is the contrast locally. A significant peak can be seen around t=5 s and after t=8 s. This points to intervals of changing focus, which should be treated carefully. <bold>c</bold> The resulting deformation and force. A gap is introduced around t=5 s to avoid tracking failure and again after t=8 s. Because the focus reverts to the previous state in the second tracked interval, we can use the same pipette pattern and the same reference frame, thus the forces of both intervals are fully compatible, with identical calibration. <bold>d</bold> Illustration of BFPtool’s internal treatment of data. On the left, the probe under no load, RBC undeformed (<italic>x</italic>
<sub>0</sub>,<italic>Δ</italic>
<italic>x</italic>=0). The stiffness of the probe is calculated after the geometrical parameters of the probe (R <sub><italic>c</italic></sub>, R<sub>0</sub>, R <sub><italic>p</italic></sub>) are measured, yielding <inline-formula id="IEq23"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$k=274 \frac {\text {pN}}{{\upmu }\text {m}}$\end{document}</tex-math><mml:math id="M48"><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>274</mml:mn><mml:mfrac><mml:mrow><mml:mtext>pN</mml:mtext></mml:mrow><mml:mrow><mml:mi>μ</mml:mi><mml:mtext>m</mml:mtext></mml:mrow></mml:mfrac></mml:math><inline-graphic xlink:href="13628_2016_33_Article_IEq23.gif"/></alternatives></inline-formula>. The RBC acts as a spring in the probe. On the right, the probe at any later time, at 4.2 s and 7.2 s as examples. Note the same pipette pattern is shared by both intervals. The RBC is deformed, the deformation corresponds to the change of distance between the bead centre and the pipette anchor, <italic>Δ</italic>
<italic>x</italic>(<italic>t</italic>)=<italic>x</italic>(<italic>t</italic>)−<italic>x</italic>
<sub>0</sub>, as illustrated. The force is then calculated as <italic>F</italic>(<italic>t</italic>)=<italic>k</italic>·<italic>Δ</italic>
<italic>x</italic>(<italic>t</italic>). Total computational CPU time 152 s. The video file used for this analysis, <italic>interrupted.avi</italic>, is included in the program repository</p></caption><graphic xlink:href="13628_2016_33_Fig4_HTML" id="MO4"/></fig>
</p>
      <p>The examination of the SD2 metric is not always sufficient to determine problematic interval; another useful indicator is rSD2, representing local (in time) contrast variability. The tracking often fails in intervals of highly variable contrast due to changes in pipette tip intensity profile. Figure <xref rid="Fig4" ref-type="fig">4</xref>
<xref rid="Fig4" ref-type="fig">b</xref> shows rSD2 of the experiment; the peak around <italic>t</italic>=5 s clearly indicates a problematic interval of high contrast variability, which needs to be excluded from tracking. The tracking was therefore split into two intervals, introducing a gap around <italic>t</italic>=5 s. Both intervals were fully compatible, matching the same pipette pattern and using the same frame of reference distance <italic>x</italic>
<sub>0</sub>, yielding identically calibrated force. The force time course is shown in Fig. <xref rid="Fig4" ref-type="fig">4</xref>
<xref rid="Fig4" ref-type="fig">c</xref>, with the apparent gap.</p>
      <p>Figure <xref rid="Fig4" ref-type="fig">4</xref>
<xref rid="Fig4" ref-type="fig">d</xref> illustrates the physical concept behind the program. The graphic at the time <italic>t</italic>
<sub>0</sub>=0 s illustrates the probe with a bead attached and no load applied; under such circumstances, the distance between the pipette anchor and the bead corresponds to the reference distance <italic>x</italic>
<sub>0</sub>. The user has to choose the frame <italic>t</italic>
<sub>0</sub> (from the set of frames selected for analysis), which will be used by the program to extract <italic>x</italic>
<sub>0</sub>. To calibrate the probe, parameters determining the probe stiffness (Eq. <xref rid="Equ1" ref-type="">1</xref>) must be provided; <inline-formula id="IEq24"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$k = {274}\frac {\mathrm {p} \mathrm {N}}{\upmu \mathrm {m}}$\end{document}</tex-math><mml:math id="M50"><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>274</mml:mn><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">N</mml:mi></mml:mrow><mml:mrow><mml:mi>μ</mml:mi><mml:mi mathvariant="normal">m</mml:mi></mml:mrow></mml:mfrac></mml:math><inline-graphic xlink:href="13628_2016_33_Article_IEq24.gif"/></alternatives></inline-formula> in case of the experiment presented in Fig. <xref rid="Fig4" ref-type="fig">4</xref>. At any other time <italic>t</italic>&lt;<italic>t</italic>
<sub>0</sub> or <italic>t</italic>&gt;<italic>t</italic>
<sub>0</sub>, the program measures the immediate distance of the pipette anchor and the bead, <italic>x</italic>(<italic>t</italic>); the difference between <italic>x</italic>(<italic>t</italic>) and the reference <italic>x</italic>
<sub>0</sub> corresponds to the RBC deformation. For the example in Fig. <xref rid="Fig4" ref-type="fig">4</xref>, <inline-formula id="IEq25"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\Delta x(t_{1})~{=}~x(t_{1})-x_{0}|_{t_{1}\phantom {\dot {i}\!}={4.2}\mathrm {s}}=0.3\,\upmu $\end{document}</tex-math><mml:math id="M52"><mml:mi>Δx</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mspace width="1em"/><mml:mo>=</mml:mo><mml:mspace width="1em"/><mml:mi>x</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>4.2</mml:mn><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0.3</mml:mn><mml:mspace width="0.3em"/><mml:mi>μ</mml:mi></mml:math><inline-graphic xlink:href="13628_2016_33_Article_IEq25.gif"/></alternatives></inline-formula>m, and the force applied by the probe at the time is <inline-formula id="IEq26"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\phantom {\dot {i}\!}F(t_{1})~{=~}k\cdot \Delta x(t_{1})|_{t_{1}={4.2}\mathrm {s}}={82}\,\text {pN}$\end{document}</tex-math><mml:math id="M54"><mml:mi>F</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mspace width="1em"/><mml:mo>=</mml:mo><mml:mspace width="1em"/><mml:mi>k</mml:mi><mml:mo>·</mml:mo><mml:mi>Δx</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:msub><mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>4.2</mml:mn><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>82</mml:mn><mml:mspace width="0.3em"/><mml:mtext>pN</mml:mtext></mml:math><inline-graphic xlink:href="13628_2016_33_Article_IEq26.gif"/></alternatives></inline-formula>. The experiment in Fig. <xref rid="Fig4" ref-type="fig">4</xref> can be treated by simple exclusion of the problematic interval, because the pipette pattern can be reused in the following interval, i.e. the focus recovers and the same pattern can be matched. Additional file <xref rid="MOESM2" ref-type="media">2</xref> demonstrates how the analysis was performed in the GUI.</p>
      <p><bold>Multi-interval tracking:</bold> In the previous section, we described how intervals of low contrast SD2 metric should be excluded. In some situations, however, they can be treated differently. Figure <xref rid="Fig5" ref-type="fig">5</xref>
<xref rid="Fig5" ref-type="fig">a</xref> shows one brief and two significant dips in contrast. The decrease does not necessarily mean a change in focus; the first brief dip around time <italic>t</italic>=5 s, marked by label (I) in Fig. <xref rid="Fig5" ref-type="fig">5</xref>
<xref rid="Fig5" ref-type="fig">b</xref>, is a result of probe separation and movement of part of the pipette out of the field (shown in Fig. <xref rid="Fig5" ref-type="fig">5</xref>
<xref rid="Fig5" ref-type="fig">c</xref>-I), which decreases the SD2 metric. The tracking did not fail during the separation; as long as the pipette tip and the bead remain in the field and are recognized by the program, it is not necessary to introduce a gap into tracking, the algorithm can handle such a situation. Despite the bead-pipette tip anchor distance <italic>x</italic>(<italic>t</italic>) having been successfully obtained, it is clear that the peak (I) has no physical meaning. As a general side note, any peak of this type appearing in the extension measurement <italic>Δ</italic>
<italic>x</italic>(<italic>t</italic>) should be treated with caution.
<fig id="Fig5"><label>Fig. 5</label><caption><p>Multi interval tracking. The video had to be split into several intervals due to faltering focus. <bold>a</bold> Time course of contrast, SD2 of each video frame; normalized by the maximal value. <italic>Blue dashed line</italic> marks the warning threshold, 5% drop from the maximum. <bold>b</bold> Tracking was divided into four intervals. The peak marked by the label (I) is a result of separation of pipette and the bead, as shown in panel C-I. Intervals of measured deformation marked in green and labelled (II) are mutually compatible, using the same pipette pattern shown in panel C-II and the same reference distance <italic>x</italic>
<sub>0</sub> — the force calibration is identical. The focus during the interval of data in cyan, labelled (III), was locally stable, and could be tracked using local pipette pattern, before the focus reverted to the original state; the pipette pattern is shown at the panel C-III, clearly different from the pattern C-II. The calibration of the cyan interval was set manually to correspond to the final values of preceding interval. Total computational CPU time 432 s. The video file used for this analysis, <italic>multiinterval.avi</italic>, is included in the program repository</p></caption><graphic xlink:href="13628_2016_33_Fig5_HTML" id="MO5"/></fig>
</p>
      <p>Figure <xref rid="Fig5" ref-type="fig">5</xref>
<xref rid="Fig5" ref-type="fig">b</xref> shows the obtained time course of extension <italic>Δ</italic>
<italic>x</italic>(<italic>t</italic>), which has three gaps, around times <italic>t</italic>=20 s and <italic>t</italic>=35 s; those are intervals of changing focus, and could not be tracked. Intervals in green, marked by the label (II), are not contiguous, but were tracked using an identical pipette pattern (shown in Fig. <xref rid="Fig5" ref-type="fig">5</xref>
<xref rid="Fig5" ref-type="fig">c</xref>-II) and one common reference distance <inline-formula id="IEq27"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$x_{0}^{\text {(II)}}|_{t=1.2 \mathrm {s}}$\end{document}</tex-math><mml:math id="M56"><mml:msubsup><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mtext>(II)</mml:mtext></mml:mrow></mml:msubsup><mml:msub><mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>1.2</mml:mn><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13628_2016_33_Article_IEq27.gif"/></alternatives></inline-formula>, the focus always eventually recovered. As such, the forces read in all the three segments of (II) are mutually compatible and comparable in terms of value. This it the approach used in Fig. <xref rid="Fig4" ref-type="fig">4</xref>.</p>
      <p>A different case is the interval marked in cyan, (III): it is a semi-stable period, during which the pipette could be tracked using a locally selected pattern (shown in Fig. <xref rid="Fig5" ref-type="fig">5</xref>
<xref rid="Fig5" ref-type="fig">c</xref>-III) and local reference distance <inline-formula id="IEq28"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$x_{0}^{\text {(III)}}|_{t=20.0\mathrm {s}}$\end{document}</tex-math><mml:math id="M58"><mml:msubsup><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mtext>(III)</mml:mtext></mml:mrow></mml:msubsup><mml:msub><mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>20.0</mml:mn><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13628_2016_33_Article_IEq28.gif"/></alternatives></inline-formula>. Selecting a local pipette pattern and the <inline-formula id="IEq29"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$x_{0}^{\text {(III)}}$\end{document}</tex-math><mml:math id="M60"><mml:msubsup><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mtext>(III)</mml:mtext></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13628_2016_33_Article_IEq29.gif"/></alternatives></inline-formula> reference distance can introduce an incompatibility of the obtained force with results of other intervals, if not done very carefully. A frame containing the RBC under no load may not even exist (as in case of Fig. <xref rid="Fig5" ref-type="fig">5</xref>
<xref rid="Fig5" ref-type="fig">b</xref>–III) in some intervals. For the shown (cyan) data, an arbitrary constant was added to the interval results, so that its beginning is aligned to the final force of the preceding interval (II), because the RMP does not move in the meantime, according to the video. Additional file <xref rid="MOESM3" ref-type="media">3</xref> demonstrates how the analysis was performed in the GUI.</p>
    </sec>
    <sec id="Sec9">
      <title>Advantages, disadvantages and improvements</title>
      <p>To assess the computational time required for the analysis, the program was tested using Matlab’s profiling tool. The results corresponding to each of the three examples (Figs. <xref rid="Fig3" ref-type="fig">3</xref>, <xref rid="Fig4" ref-type="fig">4</xref> and <xref rid="Fig5" ref-type="fig">5</xref>) are presented in Additional file <xref rid="MOESM4" ref-type="media">4</xref>. Considering the typical length of individual recordings, ranging from minutes in cell manipulation experiments up to 30 min in molecular-bond spectroscopy experiments, the processing time on current desktop machines or laptops is not prohibitive for the user. The processing rate on a low-end office computer (with a 2-core 1.30 GHz CPU) is ∼5 frames per second; for a recording of 5 min at 65 fps, the total computation time is ∼1 h (see Additional file <xref rid="MOESM4" ref-type="media">4</xref> for details).</p>
      <p>The tracking is the essential part of the tool. Because <italic>TrackBead</italic> and <italic>TrackPipette</italic> methods are called sequentially for each interval, each analysed frame has to be read twice. The inefficiency could be removed by inserting an intermediate function, which would read each frame only once and provide it (in read-only mode) to the tracking methods, cutting the number of read frames by the factor of two but resulting in increased need for management of returned and forwarded data and number of function calls, making the code more difficult to maintain and debug. Redesigning this part of the program would somewhat improve the computation speed, but would require significant changes to already tested code.</p>
      <p>The analysis becomes substantially more demanding for recordings of low quality, containing frames for which the tracking quality metrics do not exceed the preset thresholds. In such cases, the program attempts to refine the detection by repeating the analysis on a larger sub-field of the subthreshold frame, with dilated or eroded pipette pattern, higher edge sensitivity etc. These methods generally increase the value of the detection metric and help to avoid tracking failures. Pipette dilation/erosion method, for example, can improve the correlation metric by 10% for initial values <italic>M</italic>
<sub><italic>p</italic></sub>≈0.5. The methods however consume considerable amount of computational time, particularly in case of the pipette.</p>
      <p>In order to obtain an estimate of the general tracking precision in a typical recording, we have analysed the variance of outputs. The uncertainty of the RBC deformation measurement <italic>ε</italic>
<sub><italic>Δ</italic></sub>, and the corresponding force uncertainty <italic>ε</italic>
<sub><italic>F</italic></sub>, was calculated as a running standard deviation on intervals of static equilibrium (plateaus), while the intervals containing manipulations were avoided. The results were largely independent of the used size of the running window (between 10 and 100 frames, for 65 fps videos). For the experiment presented in Fig. <xref rid="Fig3" ref-type="fig">3</xref>, <italic>ε</italic>
<sub><italic>Δ</italic> ≈</sub>50 nm, which corresponds to <italic>ε</italic>
<sub><italic>F</italic></sub> ≈ 10 pN; for Fig. <xref rid="Fig5" ref-type="fig">5</xref>, <italic>ε</italic>
<sub><italic>Δ</italic></sub> ≈ 35 nm, which corresponds to <italic>ε</italic>
<sub><italic>F</italic></sub> ≈ 4 pN; for Fig. <xref rid="Fig4" ref-type="fig">4</xref>, <italic>ε</italic>
<sub><italic>Δ</italic></sub> ≈ 44 nm and <italic>ε</italic>
<sub><italic>F</italic></sub> ≈ 12 pN. These results are the upper bounds of the tracking method uncertainty, as it is not possible to completely eliminate all pipette movements from the error analysis.</p>
      <p>These values are consistent with the anticipated precision of the tracking method (see Fig. <xref rid="Fig3" ref-type="fig">3</xref>). The pattern matching uses more pixels for the calculation, and pipette position is further improved by interpolation by a second degree polynomial, which makes the pipette detection one order of magnitude more precise that the bead detection. As long as the pipette metric remains strong, the error in the RBC deformation measurement can be largely attributed to the bead tracking. The precision of bead tracking (using Gaussian blob fitting) reported in literature varies over one order of magnitude, 5–30 nm (5 nm in [<xref ref-type="bibr" rid="CR7">7</xref>, <xref ref-type="bibr" rid="CR15">15</xref>, <xref ref-type="bibr" rid="CR17">17</xref>], and 30 nm in [<xref ref-type="bibr" rid="CR14">14</xref>]). The method applied in our tool might have slightly lower performance at the trade-off of higher robustness. It performs well under complex situation of faltering contrast and more importantly during considerable obscuring of the bead—more that half of the edge of bead in some situations. It is not dependent on the bead intensity profile (i.e. it does not need to be Gaussian).</p>
      <p>It should be noted that the calculated value of the load force <italic>F</italic> is affected by a systematic error arising from the evaluation of the probe stiffness <italic>k</italic>. If the probe geometry is measured directly from the video, the limited resolution of the optical microscope leads to the relative error of roughly <italic>δ</italic>
<italic>k</italic> ≈ 20<italic>%</italic>, for the typical values of <italic>R</italic>
<sub>0</sub> = 2.5 <italic>μ</italic>m, <italic>R</italic>
<sub><italic>p</italic></sub> = 1.0 <italic>μ</italic>m, <italic>R</italic>
<sub><italic>c</italic></sub> = 0.75 <italic>μ</italic>m and <italic>Δ</italic>
<italic>P</italic> = 200 Pa, and the measurement uncertainty 0.2 <italic>μ</italic>m for each diameter (i.e., 0.1 <italic>μ</italic>m for each radius); the uncertainty in aspiration pressure, 5Pa, does not contribute significantly. This estimate of <italic>δ</italic>
<italic>k</italic> is comparable with the value of 14% reported by [<xref ref-type="bibr" rid="CR17">17</xref>]. The tool calculates and provides the magnitude of this geometry-dependent uncertainty to the user during the calibration step. Note that in case the video was captured with sub-optimal resolution, this systematic error may further increase. Another major source of systematic error is the reference distance <italic>x</italic>
<sub>0</sub>. It can be difficult to precisely localize an optimal calibration frame; an improper choice <inline-formula id="IEq30"><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\tilde {x}_{0}{\neq }x_{0}$\end{document}</tex-math><mml:math id="M62"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>≠</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13628_2016_33_Article_IEq30.gif"/></alternatives></inline-formula> shifts all the obtained values of deformation (and force) by a constant.</p>
      <p>Last, but definitely not least, is a systematic error stemming from the linear axial approximation of the probe. The more the probe is off axis (i.e. the pipette axis, the centre of the RBC and the bead are not in line), the less accurate the transformation based on Eq. <xref rid="Equ1" ref-type="">1</xref> becomes. This can be slightly improved by manual selection of the pipette anchor so that it is in line with the RBC and bead centres, although it may mean putting it off the pipette axis. The linear approximation (allowing to treat the RBC as a spring) is valid up to <italic>Δ</italic>
<italic>x</italic>≤ 0.5 <italic>μ</italic>m (or error &lt;5 % for <italic>Δ</italic>
<italic>x</italic>≤ 0.3 <italic>μ</italic>m as reported by [<xref ref-type="bibr" rid="CR17">17</xref>]), for larger deformations, it tends to slightly over-estimate the force. It would improve the program if the full and more general equation of geometry-force relation were implemented, incorporating non-linear terms and the influence of deviations from the axis. While a non-linear axial equation was carefully derived by Simson in [<xref ref-type="bibr" rid="CR17">17</xref>], it is complex and its numerical solution iterative, making its implementation non-trivial.</p>
      <p>The influence of axial deviations in BFP has not yet been studied. A detailed understanding of the force-deformation relation for non-axial probe would make BFP more versatile in applications to cell interfaces (as in our experiments) and as a tool for biophysical manipulations. It would however require to keep track of the angle of deviation, the general RBC shape projection (not only extension) and other possible geometrical descriptors, thus increasing the demands on tracking algorithms in terms of computational cost and robustness.</p>
    </sec>
  </sec>
  <sec id="Sec10" sec-type="conclusion">
    <title>Conclusion</title>
    <p>The present <italic>BFPTool</italic> application is (to our knowledge) the first freely available software for automated analysis of BFP image data and of the exerted force. It has been made with the end-user in mind: a comprehensive and comprehensible GUI was implemented, permitting a fast-track use supplemented by optional advanced functions, running extensive verifications and generating reports and warnings. We made the best efforts to avoid crashes and exceptions and to instead provide the user with assertions and reports, with limited impact on performance.</p>
    <p>The program offers tools to selectively analyse recorded videos of BFP experiments. The user is guided in several ways to exclude faulty segments of the recording and concatenate the remaining parts in an optimal manner, to obtain coherent results. Many internal tracking parameters can be finely tuned to fit the particular experiment. The geometry of the experiment can be measured directly using embedded methods.</p>
    <p>The tool performs the tracking of the components of BFP apparatus and analyses the outcomes to calculate the time course of applied force. Both the detected tracks (and their corresponding tracking fidelity metrics) and the force can be visualized and fitted by standard functions (linear, exponential, plateau detection). The final results can be exported in form of multimedia or data, while the ongoing work can be saved and loaded at later time or on a different computer.</p>
    <p>A novelty brought by the tool is the capacity to track the pipette, which was localized only indirectly in previously reported BFP experiments. The pipette tracking from the image data is sufficiently precise so as not to affect the technique’s accuracy. The possibility to precisely track the pipette while freely moving the probe (not relying on limited-range piezo translators) opens the BFP technique to more versatile use. In addition, many labs are equipped with micromanipulators but do not have a piezo stage. The present approach allows them to use the technique directly without further investment.</p>
    <p>The software tool complements the BFP technique to form a practical and accessible instrument for biophysical applications—interface and membrane experiments, and micro-manipulations of cells or vesicles. It can be used to induce cellular movement in a soft and controlled manner, or to measure adhesion, tension or rigidity, applying calibrated forces with uncertainty at the order of 10 pN. We hope that this software will help to develop and popularize the BFP technique, while simplifying work for those who already use it.</p>
  </sec>
  <sec id="Sec11">
    <title>Availability and requirements</title>
    <p><bold>Project name:</bold> BFPTool <bold>Project homepage:</bold> BFPtool at GitHub, <ext-link ext-link-type="uri" xlink:href="https://github.com/smitdaniel/BFPtool">https://github.com/smitdaniel/BFPtool</ext-link>
<bold>Operating system:</bold> cross-platform under Matlab <bold>Programming language:</bold> Matlab <bold>Requirements:</bold> Matlab 2015a, Image Processing Toolbox <bold>License:</bold> GPL 3 <bold>Any restrictions to use by non-academics:</bold> none</p>
  </sec>
  <sec id="Sec12">
    <title>Endnote</title>
    <p><sup>1</sup> Tilde symbol denotes an estimate of the given quality obtained without proper calibration.</p>
  </sec>
</body>
<back>
  <app-group>
    <app id="App1">
      <sec id="Sec13">
        <title>Additional files</title>
        <p>
          <media position="anchor" xlink:href="13628_2016_33_MOESM1_ESM.mkv" id="MOESM1">
            <label>Additional file 1</label>
            <caption>
              <p>This video describes how to set up the simple analysis without interruption, presented in Fig. <xref rid="Fig3" ref-type="fig">3</xref>. (MKV 1730 kb)</p>
            </caption>
          </media>
        </p>
        <p>
          <media position="anchor" xlink:href="13628_2016_33_MOESM2_ESM.mkv" id="MOESM2">
            <label>Additional file 2</label>
            <caption>
              <p>This video describes how to set up the analysis with an excluded time interval, presented in Fig. <xref rid="Fig4" ref-type="fig">4</xref>. (MKV 1730 kb)</p>
            </caption>
          </media>
        </p>
        <p>
          <media position="anchor" xlink:href="13628_2016_33_MOESM3_ESM.mkv" id="MOESM3">
            <label>Additional file 3</label>
            <caption>
              <p>This video describes how to set up the analysis broken into several intervals with different pipette template patterns, presented in Fig. <xref rid="Fig5" ref-type="fig">5</xref>. (MKV 3700 kb)</p>
            </caption>
          </media>
        </p>
        <p>
          <media position="anchor" xlink:href="13628_2016_33_MOESM4_ESM.pdf" id="MOESM4">
            <label>Additional file 4</label>
            <caption>
              <p>The results of profiling of the BFP runs, presented in Figs. <xref rid="Fig3" ref-type="fig">3</xref>, <xref rid="Fig4" ref-type="fig">4</xref> and <xref rid="Fig5" ref-type="fig">5</xref>, demonstrating the distribution of computational demands. (PDF 58.7 kb)</p>
            </caption>
          </media>
        </p>
      </sec>
    </app>
  </app-group>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>BFP</term>
        <def>
          <p>Biomembrane force probe</p>
        </def>
      </def-item>
      <def-item>
        <term>fps</term>
        <def>
          <p>Frames per second</p>
        </def>
      </def-item>
      <def-item>
        <term>GUI</term>
        <def>
          <p>Graphical user interface</p>
        </def>
      </def-item>
      <def-item>
        <term>IA</term>
        <def>
          <p>Image analysis</p>
        </def>
      </def-item>
      <def-item>
        <term>I/O</term>
        <def>
          <p>Input and output</p>
        </def>
      </def-item>
      <def-item>
        <term>RBC</term>
        <def>
          <p>Red blood cell</p>
        </def>
      </def-item>
      <def-item>
        <term>RMP</term>
        <def>
          <p>RBC-mounted pipette</p>
        </def>
      </def-item>
      <def-item>
        <term>rSD2</term>
        <def>
          <p>Running standard deviation of SD2 contrast metric</p>
        </def>
      </def-item>
      <def-item>
        <term>SD2</term>
        <def>
          <p>Two-dimensional standard deviation</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <ack>
    <title>Acknowledgements</title>
    <p>We thank Nicolas Debray for his help in testing the BFPTool.</p>
    <sec id="d29e2997">
      <title>Funding</title>
      <p>This work was supported by Université Pierre et Marie Curie (UPMC), CNRS, INSERM, Agence Nationale de la Recherche (Grant ANR-2010-BLAN-1401-01 to AT), and by National Institute of Health (Grant 5R01DC012441 to AT), Czech Science Foundation grant (GACR 14-16755S to MZ), Grant Agency of Charles University grant (GAUK 396213 to DS and MZ), Bourse Gouvernement Francaise—French embassy in Prague (to DS), MSMT Barrande (7AMB12FR002 to MZ and AT), and institutional support RVO#67985823. The AT team is affiliated with the Bio-Psy Laboratory of Excellence, Investissements d’Avenir program managed by the Agence Nationale de la Recherche under reference ANR-11-IDEX-0004-02.</p>
    </sec>
    <sec id="d29e3002">
      <title>Authors’ contributions</title>
      <p>DS designed and wrote the code; MD tested the program; DS, MD, FP, AT, MZ wrote the manuscript, advised on the program structure; FP, DS, AT, MZ developed the analysis concepts; CF prepared the explant culture for the experiments and optimized the surface biotinylation protocol; AT, FP and DS set up and performed the BFP experiments; DS and MZ analysed the data. All authors read and approved the final manuscript.</p>
    </sec>
    <sec id="d29e3007">
      <title>Competing interests</title>
      <p>The authors declare that they have no competing interests.</p>
    </sec>
    <sec id="d29e3012">
      <title>Consent for publication</title>
      <p>Not applicable.</p>
    </sec>
    <sec id="d29e3017">
      <title>Ethics approval and consent to participate</title>
      <p>The protocol was approved by the ENS Safety and Ethics Committee; informed and written consent to participate was obtained from the healthy volunteer whose drop of blood was taken.</p>
    </sec>
  </ack>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Neuman</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Lionnet</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Allemand</surname>
            <given-names>JF</given-names>
          </name>
        </person-group>
        <article-title>Single-molecule micromanipulation techniques</article-title>
        <source>Annu Rev Mater Res</source>
        <year>2007</year>
        <volume>37</volume>
        <issue>1</issue>
        <fpage>33</fpage>
        <lpage>67</lpage>
        <pub-id pub-id-type="doi">10.1146/annurev.matsci.37.052506.084336</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Neuman</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Nagy</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Single-molecule force spectroscopy: optical tweezers, magnetic tweezers and atomic force microscopy</article-title>
        <source>Nat Methods</source>
        <year>2008</year>
        <volume>5</volume>
        <issue>6</issue>
        <fpage>491</fpage>
        <lpage>505</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.1218</pub-id>
        <pub-id pub-id-type="pmid">18511917</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schindelin</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Arganda-Carreras</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Frise</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Kaynig</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Longair</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Pietzsch</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Preibisch</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Rueden</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Saalfeld</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Schmid</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Tinevez</surname>
            <given-names>JY</given-names>
          </name>
          <name>
            <surname>White</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>Hartenstein</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Eliceiri</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Tomancak</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Cardona</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Fiji: an open-source platform for biological-image analysis</article-title>
        <source>Nat Methods</source>
        <year>2012</year>
        <volume>9</volume>
        <issue>7</issue>
        <fpage>676</fpage>
        <lpage>82</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.2019</pub-id>
        <pub-id pub-id-type="pmid">22743772</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>de Chaumont</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Dallongeville</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Chenouard</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Hervé</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Pop</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Provoost</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Meas-Yedid</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Pankajakshan</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Lecomte</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Le Montagner</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Lagache</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Dufour</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Olivo-Marin</surname>
            <given-names>JC</given-names>
          </name>
        </person-group>
        <article-title>Icy: an open bioimage informatics platform for extended reproducible research</article-title>
        <source>Nat Methods</source>
        <year>2012</year>
        <volume>9</volume>
        <issue>7</issue>
        <fpage>690</fpage>
        <lpage>6</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.2075</pub-id>
        <pub-id pub-id-type="pmid">22743774</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Peng</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Bria</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Zhou</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Iannello</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Long</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>Extensible visualization and analysis for multidimensional images using vaa3d</article-title>
        <source>Nat Protoc</source>
        <year>2014</year>
        <volume>9</volume>
        <issue>1</issue>
        <fpage>193</fpage>
        <lpage>208</lpage>
        <pub-id pub-id-type="doi">10.1038/nprot.2014.011</pub-id>
        <pub-id pub-id-type="pmid">24385149</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jones</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Kang</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Wheeler</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Lindquist</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Papallo</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Sabatini</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Golland</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Carpenter</surname>
            <given-names>AE</given-names>
          </name>
        </person-group>
        <article-title>Cellprofiler analyst: data exploration and analysis software for complex image-based screens</article-title>
        <source>BMC Bioinformatics</source>
        <year>2008</year>
        <volume>9</volume>
        <issue>1</issue>
        <fpage>482</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-9-482</pub-id>
        <pub-id pub-id-type="pmid">19014601</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Evans</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Ritchie</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Merkel</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Sensitive force technique to probe molecular adhesion and structural linkages at biological interfaces</article-title>
        <source>Biophys J</source>
        <year>1995</year>
        <volume>68</volume>
        <fpage>2580</fpage>
        <lpage>7</lpage>
        <pub-id pub-id-type="doi">10.1016/S0006-3495(95)80441-8</pub-id>
        <pub-id pub-id-type="pmid">7647261</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Clausen-Schaumann</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Seitz</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Krautbauer</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Gaub</surname>
            <given-names>HE</given-names>
          </name>
        </person-group>
        <article-title>Force spectroscopy with single bio-molecules</article-title>
        <source>Curr Opin Chem Biol</source>
        <year>2000</year>
        <volume>4</volume>
        <issue>5</issue>
        <fpage>524</fpage>
        <lpage>30</lpage>
        <pub-id pub-id-type="doi">10.1016/S1367-5931(00)00126-5</pub-id>
        <pub-id pub-id-type="pmid">11006539</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Maître</surname>
            <given-names>JL</given-names>
          </name>
          <name>
            <surname>Heisenberg</surname>
            <given-names>CP</given-names>
          </name>
        </person-group>
        <article-title>The role of adhesion energy in controlling cell-cell contacts</article-title>
        <source>Curr Opin Cell Biol</source>
        <year>2011</year>
        <volume>23</volume>
        <issue>5</issue>
        <fpage>508</fpage>
        <lpage>14</lpage>
        <pub-id pub-id-type="doi">10.1016/j.ceb.2011.07.004</pub-id>
        <pub-id pub-id-type="pmid">21807491</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dudko</surname>
            <given-names>OK</given-names>
          </name>
          <name>
            <surname>Hummer</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Szabo</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Theory, analysis, and interpretation of single-molecule force spectroscopy experiments</article-title>
        <source>PNAS</source>
        <year>2008</year>
        <volume>105</volume>
        <issue>41</issue>
        <fpage>15755</fpage>
        <lpage>60</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.0806085105</pub-id>
        <pub-id pub-id-type="pmid">18852468</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pincet</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Husson</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>The solution to the streptavidin-biotin paradox: The influence of history on the strength of single molecular bonds</article-title>
        <source>Biophys J</source>
        <year>2005</year>
        <volume>89</volume>
        <fpage>4374</fpage>
        <lpage>81</lpage>
        <pub-id pub-id-type="doi">10.1529/biophysj.105.067769</pub-id>
        <pub-id pub-id-type="pmid">16169976</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gourier</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Jegou</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Husson</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Pincet</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>A nanospring named erythrocyte. the biomembrane force probe</article-title>
        <source>Cel Mol Bioeng</source>
        <year>2008</year>
        <volume>1</volume>
        <issue>4</issue>
        <fpage>263</fpage>
        <lpage>75</lpage>
        <pub-id pub-id-type="doi">10.1007/s12195-008-0030-x</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13</label>
      <mixed-citation publication-type="other">Husson J, Dogterom M, Pincet F. Force spectroscopy of a single artificial biomolecule bond: The Kramers’ high-barrier limit holds close to the critical force. J Chem Phys. 2009;130(art. 051103).</mixed-citation>
    </ref>
    <ref id="CR14">
      <label>14</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Husson</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Chemin</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Bohineust</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Hivroz</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Henry</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>Force generation upon t cell receptor engagement</article-title>
        <source>Plot ONE</source>
        <year>2011</year>
        <volume>6</volume>
        <issue>5</issue>
        <fpage>19680</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0019680</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Evans</surname>
            <given-names>EA</given-names>
          </name>
          <name>
            <surname>McEver</surname>
            <given-names>RP</given-names>
          </name>
          <name>
            <surname>Zhu</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Monitoring receptor-ligand interactions between surfaces by thermal fluctuations</article-title>
        <source>Biophys J</source>
        <year>2008</year>
        <volume>94</volume>
        <fpage>694</fpage>
        <lpage>701</lpage>
        <pub-id pub-id-type="doi">10.1529/biophysj.107.117895</pub-id>
        <pub-id pub-id-type="pmid">17890399</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Boye</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <source>Development and application of biomembrane force probe technique</source>
        <year>2007</year>
        <publisher-loc>University of Southern Denmark</publisher-loc>
        <publisher-name>PhD thesis</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Simson</surname>
            <given-names>DA</given-names>
          </name>
          <name>
            <surname>Ziemann</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Strigl</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Merkel</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Micropipet-based pico force transducer: in depth analysis and experimental verification</article-title>
        <source>Biophys J</source>
        <year>1998</year>
        <volume>74</volume>
        <issue>4</issue>
        <fpage>2080</fpage>
        <lpage>8</lpage>
        <pub-id pub-id-type="doi">10.1016/S0006-3495(98)77915-9</pub-id>
        <pub-id pub-id-type="pmid">9545067</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18</label>
      <mixed-citation publication-type="other">MathWorks. Supported File Formats for Import and Export. <ext-link ext-link-type="uri" xlink:href="http://www.mathworks.com/help/matlab/import_export/supported-file-formats.html">http://www.mathworks.com/help/matlab/import_export/supported-file-formats.html</ext-link>. Accessed 22 July 2016.</mixed-citation>
    </ref>
    <ref id="CR19">
      <label>19</label>
      <mixed-citation publication-type="other">MathWorks. Gateway to LibTIFF Library Routines. <ext-link ext-link-type="uri" xlink:href="http://www.mathworks.com/help/matlab/ref/tiff-class.html">http://www.mathworks.com/help/matlab/ref/tiff-class.html</ext-link>. Accessed 22 July 2016.</mixed-citation>
    </ref>
    <ref id="CR20">
      <label>20</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Merkel</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Nassoy</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Leung</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Ritchie</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Evans</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>Energy landscapes of receptor–ligand bonds explored with dynamic force spectroscopy</article-title>
        <source>Nature</source>
        <year>1999</year>
        <volume>397</volume>
        <issue>6714</issue>
        <fpage>50</fpage>
        <lpage>3</lpage>
        <pub-id pub-id-type="doi">10.1038/16219</pub-id>
        <pub-id pub-id-type="pmid">9892352</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Smit</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Fouquet</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Pincet</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Trembleau</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Zapotocky</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Axon zippering in neuronal cell culture and its biophysical modeling [abstract]</article-title>
        <source>BMC Neurosci</source>
        <year>2015</year>
        <volume>16</volume>
        <issue>Suppl 1</issue>
        <fpage>298</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2202-16-S1-P298</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22</label>
      <mixed-citation publication-type="other">Salonen J. Efficient and Accurate Rolling Standard Deviation. <ext-link ext-link-type="uri" xlink:href="http://jonisalonen.com/2014/efficient-and-accurate-rolling-standard-deviation/">http://jonisalonen.com/2014/efficient-and-accurate-rolling-standard-deviation/</ext-link>. Accessed 22 July 2016.</mixed-citation>
    </ref>
  </ref-list>
</back>
