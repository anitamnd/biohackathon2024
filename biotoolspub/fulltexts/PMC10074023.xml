<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinform Adv</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinform Adv</journal-id>
    <journal-id journal-id-type="publisher-id">bioadv</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics Advances</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2635-0041</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10074023</article-id>
    <article-id pub-id-type="doi">10.1093/bioadv/vbad040</article-id>
    <article-id pub-id-type="publisher-id">vbad040</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Application Note</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Genome Analysis</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>TB-ML—a framework for comparing machine learning approaches to predict drug resistance of <italic toggle="yes">Mycobacterium tuberculosis</italic></article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-2208-0895</contrib-id>
        <name>
          <surname>Libiseller-Egger</surname>
          <given-names>Julian</given-names>
        </name>
        <aff><institution>Faculty of Infectious and Tropical Diseases, London School of Hygiene &amp; Tropical Medicine</institution>, London WC1E 7HT, <country country="GB">UK</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wang</surname>
          <given-names>Linfeng</given-names>
        </name>
        <aff><institution>Faculty of Infectious and Tropical Diseases, London School of Hygiene &amp; Tropical Medicine</institution>, London WC1E 7HT, <country country="GB">UK</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-2989-0495</contrib-id>
        <name>
          <surname>Deelder</surname>
          <given-names>Wouter</given-names>
        </name>
        <aff><institution>Faculty of Infectious and Tropical Diseases, London School of Hygiene &amp; Tropical Medicine</institution>, London WC1E 7HT, <country country="GB">UK</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-1403-6138</contrib-id>
        <name>
          <surname>Campino</surname>
          <given-names>Susana</given-names>
        </name>
        <aff><institution>Faculty of Infectious and Tropical Diseases, London School of Hygiene &amp; Tropical Medicine</institution>, London WC1E 7HT, <country country="GB">UK</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-8985-9265</contrib-id>
        <name>
          <surname>Clark</surname>
          <given-names>Taane G</given-names>
        </name>
        <aff><institution>Faculty of Infectious and Tropical Diseases, London School of Hygiene &amp; Tropical Medicine</institution>, London WC1E 7HT, <country country="GB">UK</country></aff>
        <aff><institution>Faculty of Epidemiology and Population Health, London School of Hygiene &amp; Tropical Medicine</institution>, London WC1E 7HT, <country country="GB">UK</country></aff>
        <xref rid="vbad040-FM1" ref-type="author-notes"/>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-8323-7019</contrib-id>
        <name>
          <surname>Phelan</surname>
          <given-names>Jody E</given-names>
        </name>
        <aff><institution>Faculty of Infectious and Tropical Diseases, London School of Hygiene &amp; Tropical Medicine</institution>, London WC1E 7HT, <country country="GB">UK</country></aff>
        <xref rid="vbad040-cor1" ref-type="corresp"/>
        <!--jody.phelan@lshtm.ac.uk-->
        <xref rid="vbad040-FM1" ref-type="author-notes"/>
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Mulder</surname>
          <given-names>Nicola</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <fn id="vbad040-FM1">
        <p>The authors wish it to be known that, in their opinion, the Taane G. Clark and Jody E. Phelan should be regarded as Joint Last Authors.</p>
      </fn>
      <corresp id="vbad040-cor1">To whom correspondence should be addressed. <email>jody.phelan@lshtm.ac.uk</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2023-03-23">
      <day>23</day>
      <month>3</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>23</day>
      <month>3</month>
      <year>2023</year>
    </pub-date>
    <volume>3</volume>
    <issue>1</issue>
    <elocation-id>vbad040</elocation-id>
    <history>
      <date date-type="received">
        <day>13</day>
        <month>12</month>
        <year>2022</year>
      </date>
      <date date-type="rev-recd">
        <day>03</day>
        <month>3</month>
        <year>2023</year>
      </date>
      <date date-type="editorial-decision">
        <day>21</day>
        <month>3</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>22</day>
        <month>3</month>
        <year>2023</year>
      </date>
      <date date-type="corrected-typeset">
        <day>05</day>
        <month>4</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2023</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="vbad040.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>Machine learning (ML) has shown impressive performance in predicting antimicrobial resistance (AMR) from sequence data, including for <italic toggle="yes">Mycobacterium tuberculosis</italic>, the causative agent of tuberculosis. However, current ML development and publication practices make it difficult for researchers and clinicians to use, test or reproduce published models.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>We packaged a number of published and unpublished ML models for predicting AMR of <italic toggle="yes">M.tuberculosis</italic> into Docker containers. Similarly, the pipelines required for pre-processing genomic data into the formats required by the models were also packaged into separate containers. By following a minimal container I/O standard, we ensured as much interoperability as possible. We also created a command-line application, TB-ML, which can be used to easily combine pre-processing and prediction containers into complete pipelines ready for predicting resistance from novel, raw data with a single command. As long as there is adherence to this minimal standard for the container interface, containers produced by researchers holding new models can likewise be included in these pipelines, making benchmark comparisons of different models simple and facilitating faster uptake in the clinic.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>TB-ML contains a simple Docker API written in Python and is available at <ext-link xlink:href="https://github.com/jodyphelan/tb-ml" ext-link-type="uri">https://github.com/jodyphelan/tb-ml</ext-link>. Example Docker containers for resistance prediction and corresponding data pre-processing as well as a tutorial on how to create new containers for TB-ML are available at <ext-link xlink:href="https://tb-ml.github.io/tb-ml-containers/" ext-link-type="uri">https://tb-ml.github.io/tb-ml-containers/</ext-link>.</p>
      </sec>
      <sec id="s4">
        <title>Contact</title>
        <p>
          <email>jody.phelan@lshtm.ac.uk</email>
        </p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Medical Research Council</institution>
            <institution-id institution-id-type="DOI">10.13039/501100000265</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>MR/X005895/1</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="2"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>The emergence of antimicrobial resistance (AMR) represents a serious threat for global public health with an estimated 5 million deaths associated with drug-resistant bacterial infections in 2019 alone (<xref rid="vbad040-B5" ref-type="bibr">Murray <italic toggle="yes">et al.</italic>, 2022</xref>). For example, <italic toggle="yes">Mycobacterium tuberculosis</italic> bacteria are becoming increasingly resistant to commonly used drugs, making the control of tuberculosis disease problematic, especially in high-burden settings (<xref rid="vbad040-B7" ref-type="bibr">WHO, 2021</xref>). Whole genome sequencing can identify known mutations driving AMR, enabling the genotypic profiling of resistance phenotypes. This profiling has the potential to replace laboratory-based drug susceptibility testing as a means of informing clinical treatment decisions in a more timely manner (<xref rid="vbad040-B1" ref-type="bibr">Boolchandani <italic toggle="yes">et al.</italic>, 2019</xref>). Traditional approaches for such <italic toggle="yes">in silico</italic> resistance profiling, however, rely on databases of known resistance-conferring mutations and, even for well-studied bacteria such as <italic toggle="yes">M.tuberculosis</italic>, not all AMR mutations are known.</p>
    <p>Therefore, there has been great interest lately in the application of machine learning (ML) to the problem of resistance prediction (see <xref rid="vbad040-B3" ref-type="bibr">Kim <italic toggle="yes">et al.</italic>, 2022</xref>, for a recent review). In addition to using potentially unknown genomic variants, ML models can also combine information on multiple mutations, allowing them to take epistatic interactions into account. However, the use of ML models also comes with its downsides. One challenging aspect is that some model types are ‘black boxes’ with limited interpretability. Additionally, while superior accuracy compared to traditional approaches has been shown for a number of ML methods (e.g. <xref rid="vbad040-B4" ref-type="bibr">Kouchaki <italic toggle="yes">et al.</italic>, 2019</xref>), large-scale systematic comparisons of published models (e.g. to determine the best model architecture for a certain pathogen or type of genomic input data) are still lacking. One major obstacle in this regard is that researchers rarely publish trained models in a form that can be readily used for generating predictions from new data with little extra effort. Instead, when attempting to reproduce results achieved by an ML model, one often has no other option than to re-train it from scratch. This task usually comes with several practical difficulties, including (but not limited to) unpublished training data, lacking source code (for model training or the pre-processing of raw reads into a format ready for training/prediction) and inadequate information on software dependencies and versions. These issues are likewise impeding quick translation of ML models into the clinic, which is often called for in light of their impressive performance.</p>
  </sec>
  <sec>
    <title>2 A minimal standard for containerized resistance prediction models</title>
    <p>To solve this reproducibility and utilization challenge, we propose that ML models are placed into Docker containers, enabling others to easily predict from new data. We suggest the containerization of any pre-processing code separately from the ML model so that different sources of genomic inputs can be used. To support this, we defined a minimal standard for the interface between pre-processing and prediction containers and provide a Python application (‘TB-ML’) handling inter-container communication. It can be used to combine different containers adhering to this simple standard in a mix-and-match fashion to build prediction pipelines covering the whole prediction process, from raw reads to final report, in a single command.</p>
    <p>In order to facilitate the interoperability of containers for pre-processing and prediction while retaining as much flexibility as possible, TB-ML has the following requirements for the container interface: (i) any output that should be added to the final prediction report has to be printed to STDOUT; (ii) output used by other containers needs to be written to files (ideally in CSV format); (iii) prediction containers should only predict and perform no pre-processing tasks. When possible, prediction containers should also accept input in CSV format (e.g. one-hot-encoded sequences or called variants).</p>
  </sec>
  <sec>
    <title>3 TB-ML functionality and implementation</title>
    <p>Containers adhering to the aforementioned rules can be combined into pipelines with our command-line tool TB-ML. In most basic cases, only two containers will be needed to predict resistance from raw input data: one for bioinformatic processing of the inputs into a suitable format (e.g. called variants or one-hot-encoded consensus sequences) and one for prediction. However, pipelines of arbitrary complexity are possible since TB-ML does not impose a limit on the number of containers used. It has been implemented in Python and mostly consists of a basic Docker API to facilitate the launching of the containers and data transfer between them. All steps are run in a temporary directory. The command-line interface only has a single flag (–container). It is used to specify the name of a Docker image which can be followed by a single string holding all the arguments to be passed to the container. This way, the whole pipeline can be specified in a single command.</p>
    <p>At <ext-link xlink:href="https://tb-ml.github.io/tb-ml-containers/" ext-link-type="uri">https://tb-ml.github.io/tb-ml-containers/</ext-link>, we provide example Docker containers for pre-processing and resistance prediction on <italic toggle="yes">M.tuberculosis</italic> data. So far, they include several neural networks (including one created by <xref rid="vbad040-B2" ref-type="bibr">Green <italic toggle="yes">et al.</italic>, 2022</xref> and a variation which is independent of the dimensionality of the input data), one random forest model, and four pre-processing pipelines to generate input data for the models from either raw or aligned reads.</p>
  </sec>
  <sec>
    <title>4 Discussion and conclusions</title>
    <p>After showing the great potential of ML in AMR prediction, the maturing field now needs to focus on improving reproducibility, usability, and ease of benchmarking. The framework for combining Docker containers provided here represents a first step in this direction. TB-ML is easily installed, requiring only Python and Docker. The standard for inter-container communication is flexible enough to be readily extended to other prediction methods or pre-processing steps, including non-tuberculosis AMR applications. Further, TB-ML can be included into existing profiling software, e.g. TB-Profiler (<xref rid="vbad040-B6" ref-type="bibr">Phelan <italic toggle="yes">et al.</italic>, 2019</xref>), in the future. Overall, this effort aids those working on the genotypic prediction of AMR in comparing, implementing and interpreting the results from ML models, thereby assisting the personalization of clinical interventions, and ultimately improving infection control.</p>
  </sec>
</body>
<back>
  <sec>
    <title>Funding</title>
    <p>This work was supported by the Medical Research Council, UK [Ref. MR/X005895/1].</p>
    <p><italic toggle="yes">Conflict of Interest</italic>: none declared.</p>
  </sec>
  <sec sec-type="data-availability">
    <title>Data availability</title>
    <p>There are no new data associated with this article.</p>
  </sec>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="vbad040-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Boolchandani</surname><given-names>M.</given-names></string-name></person-group><etal>et al</etal> (<year>2019</year>) <article-title>Sequencing-based methods and resources to study antimicrobial resistance</article-title>. <source>Nat. Rev. Genetics</source>, <volume>20</volume>, <fpage>356</fpage>–<lpage>370</lpage>.<pub-id pub-id-type="pmid">30886350</pub-id></mixed-citation>
    </ref>
    <ref id="vbad040-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Green</surname><given-names>A.G.</given-names></string-name></person-group><etal>et al</etal> (<year>2022</year>) <article-title>A convolutional neural network highlights mutations relevant to antimicrobial resistance in <italic toggle="yes">Mycobacterium tuberculosis</italic></article-title>. <source>Nat. Commun</source>., <volume>13</volume>, <fpage>1</fpage>–<lpage>12</lpage>.<pub-id pub-id-type="pmid">34983933</pub-id></mixed-citation>
    </ref>
    <ref id="vbad040-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kim</surname><given-names>J.I.</given-names></string-name></person-group><etal>et al</etal> (<year>2022</year>) <article-title>Machine learning for antimicrobial resistance prediction: current practice, limitations, and clinical perspective</article-title>. <source>Clin. Microbiol. Rev</source>., <volume>35</volume>, <fpage>e0017921</fpage>.<pub-id pub-id-type="pmid">35612324</pub-id></mixed-citation>
    </ref>
    <ref id="vbad040-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kouchaki</surname><given-names>S.</given-names></string-name></person-group><etal>et al</etal> (<year>2019</year>) <article-title>Application of machine learning techniques to tuberculosis drug resistance analysis</article-title>. <source>Bioinformatics</source>, <volume>35</volume>, <fpage>2276</fpage>–<lpage>2282</lpage>.<pub-id pub-id-type="pmid">30462147</pub-id></mixed-citation>
    </ref>
    <ref id="vbad040-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Murray</surname><given-names>C.J.</given-names></string-name></person-group><etal>et al</etal> (<year>2022</year>) <article-title>Global burden of bacterial antimicrobial resistance in 2019: a systematic analysis</article-title>. <source>Lancet</source>, <volume>399</volume>, <fpage>629</fpage>–<lpage>655</lpage>.<pub-id pub-id-type="pmid">35065702</pub-id></mixed-citation>
    </ref>
    <ref id="vbad040-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Phelan</surname><given-names>J.E.</given-names></string-name></person-group><etal>et al</etal> (<year>2019</year>) <article-title>Integrating informatics tools and portable sequencing technology for rapid detection of resistance to anti-tuberculous drugs</article-title>. <source>Genome Med</source>., <volume>11</volume>, <fpage>1</fpage>–<lpage>7</lpage>.<pub-id pub-id-type="pmid">30609936</pub-id></mixed-citation>
    </ref>
    <ref id="vbad040-B7">
      <mixed-citation publication-type="book"><collab>WHO</collab>. <source>Global Tuberculosis Report 2021</source>. <publisher-name>World Health Organization</publisher-name>, Geneva, <year>2021</year>.</mixed-citation>
    </ref>
  </ref-list>
</back>
