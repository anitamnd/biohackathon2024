<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Nat Commun</journal-id>
    <journal-id journal-id-type="iso-abbrev">Nat Commun</journal-id>
    <journal-title-group>
      <journal-title>Nature Communications</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2041-1723</issn>
    <publisher>
      <publisher-name>Nature Publishing Group UK</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">9055051</article-id>
    <article-id pub-id-type="publisher-id">30033</article-id>
    <article-id pub-id-type="doi">10.1038/s41467-022-30033-z</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Reference-free cell type deconvolution of multi-cellular pixel-resolution spatially resolved transcriptomics data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Miller</surname>
          <given-names>Brendan F.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-7241-1509</contrib-id>
        <name>
          <surname>Huang</surname>
          <given-names>Feiyang</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-6113-0082</contrib-id>
        <name>
          <surname>Atta</surname>
          <given-names>Lyla</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Sahoo</surname>
          <given-names>Arpan</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-0212-5451</contrib-id>
        <name>
          <surname>Fan</surname>
          <given-names>Jean</given-names>
        </name>
        <address>
          <email>jeanfan@jhu.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.21107.35</institution-id><institution-id institution-id-type="ISNI">0000 0001 2171 9311</institution-id><institution>Center for Computational Biology, Whiting School of Engineering, </institution><institution>Johns Hopkins University, </institution></institution-wrap>Baltimore, MD 21211 United States </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.21107.35</institution-id><institution-id institution-id-type="ISNI">0000 0001 2171 9311</institution-id><institution>Department of Biomedical Engineering, </institution><institution>Johns Hopkins University, </institution></institution-wrap>Baltimore, MD 21218 United States </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="GRID">grid.21107.35</institution-id><institution-id institution-id-type="ISNI">0000 0001 2171 9311</institution-id><institution>Department of Computer Science, </institution><institution>Johns Hopkins University, </institution></institution-wrap>Baltimore, MD 21218 United States </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>29</day>
      <month>4</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>29</day>
      <month>4</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2022</year>
    </pub-date>
    <volume>13</volume>
    <elocation-id>2339</elocation-id>
    <history>
      <date date-type="received">
        <day>16</day>
        <month>6</month>
        <year>2021</year>
      </date>
      <date date-type="accepted">
        <day>12</day>
        <month>4</month>
        <year>2022</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2022</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The images or other third party material in this article are included in the article’s Creative Commons license, unless indicated otherwise in a credit line to the material. If material is not included in the article’s Creative Commons license and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this license, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1">Recent technological advancements have enabled spatially resolved transcriptomic profiling but at multi-cellular pixel resolution, thereby hindering the identification of cell-type-specific spatial patterns and gene expression variation. To address this challenge, we develop STdeconvolve as a reference-free approach to deconvolve underlying cell types comprising such multi-cellular pixel resolution spatial transcriptomics (ST) datasets. Using simulated as well as real ST datasets from diverse spatial transcriptomics technologies comprising a variety of spatial resolutions such as Spatial Transcriptomics, 10X Visium, DBiT-seq, and Slide-seq, we show that STdeconvolve can effectively recover cell-type transcriptional profiles and their proportional representation within pixels without reliance on external single-cell transcriptomics references. STdeconvolve provides comparable performance to existing reference-based methods when suitable single-cell references are available, as well as potentially superior performance when suitable single-cell references are not available. STdeconvolve is available as an open-source R software package with the source code available at <ext-link ext-link-type="uri" xlink:href="https://github.com/JEFworks-Lab/STdeconvolve">https://github.com/JEFworks-Lab/STdeconvolve</ext-link>.</p>
    </abstract>
    <abstract id="Abs2" abstract-type="web-summary">
      <p id="Par2">Identifying cell-type-specific spatial patterns in ST data is critical for understanding tissue organization but current methods rely on external references. Here the authors develop a reference-free method to effectively recover cell-type transcriptional profiles and proportions.</p>
    </abstract>
    <kwd-group kwd-group-type="npg-subject">
      <title>Subject terms</title>
      <kwd>Computational biology and bioinformatics</kwd>
      <kwd>Transcriptomics</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">https://doi.org/10.13039/100000057</institution-id>
            <institution>U.S. Department of Health &amp; Human Services | NIH | National Institute of General Medical Sciences (NIGMS)</institution>
          </institution-wrap>
        </funding-source>
        <award-id>R35-GM142889</award-id>
        <principal-award-recipient>
          <name>
            <surname>Fan</surname>
            <given-names>Jean</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2022</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1" sec-type="introduction">
    <title>Introduction</title>
    <p id="Par3">Delineating the spatial organization of transcriptionally distinct cell types within tissues is critical for understanding the cellular basis of tissue function<sup><xref ref-type="bibr" rid="CR1">1</xref></sup>. Recent technologies have enabled spatial transcriptomic (ST) profiling within tissues at multi-cellular pixel-resolution<sup><xref ref-type="bibr" rid="CR2">2</xref></sup>. As such, these ST measurements represent cell mixtures that may comprise multiple cell types. This lack of single-cell resolution hinders the characterization of cell-type-specific spatial organization and gene expression variation.</p>
    <p id="Par4">To address this challenge, several reference-based, supervised deconvolution approaches have recently been developed to estimate the proportion of cell types within ST pixels. Of these, SPOTlight<sup><xref ref-type="bibr" rid="CR3">3</xref></sup> uses cell-type marker genes derived from a single-cell RNA-sequencing (scRNA-seq) reference to seed a non-negative matrix factorization. RCTD<sup><xref ref-type="bibr" rid="CR4">4</xref></sup> uses the cell-type-specific mean expression of marker genes derived from a scRNA-seq reference to build a probabilistic model of the contribution of each cell type to the observed gene counts in each pixel. SpatialDWLS<sup><xref ref-type="bibr" rid="CR5">5</xref></sup> uses cell-type signature genes derived from a scRNA-seq reference to first enrich for cell types likely to be in each pixel, then applies a dampened weighted least squares approach to infer the cell-type composition. As such, these approaches rely on the availability of a suitable single-cell reference, which may present limitations if such a reference does not exist due to budgetary, technical<sup><xref ref-type="bibr" rid="CR6">6</xref></sup>, or biological limitations<sup><xref ref-type="bibr" rid="CR7">7</xref></sup>. While the rise of scRNA-seq references through atlasing efforts such as the BRAIN Initiative Cell Census Network<sup><xref ref-type="bibr" rid="CR8">8</xref></sup>, the Human BioMolecular Atlas Program, and Human Cell Atlas<sup><xref ref-type="bibr" rid="CR9">9</xref></sup> may help alleviate such limitations particularly for healthy tissues, processing independent tissue samples or different sections of the same tissue may still result in systematically different gene expression quantifications due to batch effects as well as inter- and intra-sample heterogeneity. Additionally, difficulties dissociating and capturing certain cell types via single-cell sequencing may result in missing or inconsistent cell types between scRNA-seq references and ST datasets<sup><xref ref-type="bibr" rid="CR10">10</xref>,<xref ref-type="bibr" rid="CR11">11</xref></sup>. Further, scRNA-seq references and ST datasets may be affected by different perturbations manifesting as distinct transcriptional differences affecting reference-based deconvolution accuracy and subsequent biological interpretations. As such, a reference-free deconvolution approach provides an alternative strategy for deconvolving cell types when an appropriate reference is not available.</p>
    <p id="Par5">Here, we developed STdeconvolve (available at <ext-link ext-link-type="uri" xlink:href="https://github.com/JEFworks-Lab/STdeconvolve">https://github.com/JEFworks-Lab/STdeconvolve</ext-link> and as Supplementary Software) as a reference-free, unsupervised approach for deconvolving multi-cellular pixel-resolution ST data (Fig. <xref rid="Fig1" ref-type="fig">1</xref>). STdeconvolve builds on latent Dirichlet allocation (LDA), a generative statistical model commonly used in natural language processing for discovering latent topics in collections of documents. In the context of natural language processing, given a count matrix of words in documents, LDA infers the distribution of words for each topic and the distribution of topics in each document. In the context of ST data, given a count matrix of gene expression in multi-cellular ST pixels, STdeconvolve applies LDA to infer the putative transcriptional profile for each cell type and the proportional representation of each cell type in each multi-cellular ST pixel (“Methods”). While LDA has previously been applied in the context of deconvolving cell types in bulk RNA-seq data<sup><xref ref-type="bibr" rid="CR12">12</xref>,<xref ref-type="bibr" rid="CR13">13</xref></sup>, STdeconvolve further leverages several unique aspects of ST data in its application of LDA (Supplementary Note <xref rid="MOESM1" ref-type="media">1</xref>). Briefly, these unique aspects of ST data include (i) the limited number of cells and cell types represented in each ST pixel, (ii) the limited impact of batch effects on the measured gene expression across pixels, (iii) the large number of pixels compared to cell types, and (iv) the likely heterogeneity of cell-type proportional distribution across pixels in tissues. Leveraging these aspects, STdeconvolve feature selects for genes likely to be informative of latent cell types to improve the application of LDA to ST data. Specifically, STdeconvolve selects for significantly overdispersed genes, or genes with higher-than-expected expression variance across ST pixels<sup><xref ref-type="bibr" rid="CR14">14</xref></sup> (“Methods”). In addition, as the application of LDA requires the number of transcriptionally distinct cell types, <italic>K</italic>, to be set a priori, STdeconvolve provides several data-driven metrics to guide the estimation of an appropriate <italic>K</italic> (“Methods”, Supplementary Note <xref rid="MOESM1" ref-type="media">2</xref>).<fig id="Fig1"><label>Fig. 1</label><caption><title>Overview of STdeconvolve.</title><p><bold>a</bold> STdeconvolve takes as input a spatial transcriptomics (ST) gene counts matrix of <italic>D</italic> pixels (rows) by <italic>N</italic> genes (columns). A matrix of spatial coordinates for each of the <italic>D</italic> pixels can also be used for visualization. <bold>b</bold> STdeconvolve first feature selects genes for deconvolution, such as genes with counts in more than 5% and less than 95% of the pixels, and overdispersed across the pixels. STdeconvolve then guides the selection of the optimal number of cell types to be deconvolved, <italic>K</italic>. STdeconvolve finally applies LDA modeling. A graph representation of LDA modeling and the parameters to be learned is shown. Shaded circle indicates observed variables and clear circles indicate latent variables. <bold>c</bold> STdeconvolve outputs two matrices: (1) <italic>β</italic>, the deconvolved transcriptional profile matrix of <italic>K</italic> cell types over <italic>N’</italic> feature selected genes, and (2) <italic>θ</italic>, the proportions of <italic>K</italic> cell types across the <italic>D</italic> pixels. The proportions of deconvolved cell types can then be visualized across the pixels.</p></caption><graphic xlink:href="41467_2022_30033_Fig1_HTML" id="d32e417"/></fig></p>
  </sec>
  <sec id="Sec2" sec-type="results">
    <title>Results</title>
    <sec id="Sec3">
      <title>STdeconvolve accurately recovers cell-type proportions and transcriptional profiles in simulated ST data</title>
      <p id="Par6">As a proof of concept, we first evaluated the performance of STdeconvolve in recovering the proportional representations of cell types and their transcriptional profiles using simulated ST data. We simulated ST data by aggregating the gene expression of cells from single-cell resolution multiplex error-robust fluorescence in situ hybridization (MERFISH) data of the mouse medial preoptic area (MPOA)<sup><xref ref-type="bibr" rid="CR15">15</xref></sup> within spatially contiguous pixels. Previously, MERFISH was previously applied to map the spatial distribution of 135 select genes within MPOA brain tissue. These select 135 genes were chosen to distinguish between major non-neuronal cell types as well as neuronal subtypes. Imaging-based cell segmentation was performed and the counts of genes per cell were quantified to achieve single-cell resolution spatially resolved transcriptomic profiling. Subsequent transcriptional clustering analysis on the single-cell resolution gene expression measurements identified 9 major cell types, including excitatory and inhibitory neurons. Further clustering found that these excitatory and inhibitory neurons could be subdivided into 69 finer neuronal subtypes.</p>
      <p id="Par7">To simulate multi-cellular pixel-resolution ST data, we aggregated the single-cell resolution MERFISH data into 100 µm<sup>2</sup> pixels (Fig. <xref rid="Fig2" ref-type="fig">2a</xref>, Supplementary Fig. <xref rid="MOESM1" ref-type="media">S1A, B</xref>, “Methods”). Given the already limited 135 gene panel chosen to distinguish between cell types, additional feature selection for this dataset was not necessary (Supplementary Note <xref rid="MOESM1" ref-type="media">3</xref>). Applying STdeconvolve, we identified <italic>K</italic> = 9 cell types and deconvolved their proportional representation and transcriptional profiles in each simulated pixel (Fig. <xref rid="Fig2" ref-type="fig">2b</xref>, Supplementary Figs <xref rid="MOESM1" ref-type="media">S1C</xref>, <xref rid="MOESM1" ref-type="media">S2A</xref>, Supplementary Methods). To infer the identities of the deconvolved cell types for benchmarking purposes, we matched their deconvolved transcriptional profiles with the transcriptional profiles of ground truth cell types by testing for enrichment of ground truth cell-type-specific marker genes (Methods, Supplementary Fig. <xref rid="MOESM1" ref-type="media">S2B</xref>). We observed strong correlations between the transcriptional profiles of each deconvolved cell-type and matched ground truth cell type across genes (Fig. <xref rid="Fig2" ref-type="fig">2c</xref>). Likewise, we observed strong correlations between the proportions of each deconvolved cell type and matched ground truth cell type across simulated pixels (Fig. <xref rid="Fig2" ref-type="fig">2d</xref>). We further quantified this performance using the root-mean-square error (RMSE) of the deconvolved cell type proportions compared to ground truth across simulated pixels (“Methods”, Fig. <xref rid="Fig2" ref-type="fig">2e</xref>). In this manner, STdeconvolve can accurately recover the proportional representation and transcriptional profiles of major cell types.<fig id="Fig2"><label>Fig. 2</label><caption><title>Deconvolution of simulated ST data.</title><p><bold>a</bold> Ground truth single-cell resolution MERFISH data of one section of the MPOA partitioned into 100 µm<sup>2</sup> pixels (black dashed squares). Each dot is a single cell colored by its ground truth cell type label. <bold>b</bold> Proportions of deconvolved cell types from STdeconvolve represented as pie charts for each simulated pixel. <bold>c</bold> The ranking of each gene based on its expression level in the deconvolved cell-type transcriptional profiles compared to its gene rank in the matched ground truth cell-type transcriptional profiles. <bold>d</bold> Heatmap of Pearson’s correlations between the deconvolved and ground truth cell type proportions across simulated pixels. Ground truth cell types are ordered by their frequencies in the ground truth dataset. Matched deconvolved and ground truth cell types are boxed. <bold>e</bold> Root-mean-square-error (RMSE) of the deconvolved cell-type proportions (<italic>n</italic> = 3072 pixels) compared to ground truth for STdeconvolve, <bold>f</bold> for supervised deconvolution approaches using the ideal single cell transcriptomics MERFISH MPOA reference, <bold>g</bold> for supervised deconvolution approaches using the single cell transcriptomics MERFISH MPOA reference with missing neurons, and <bold>h</bold> for supervised deconvolution approaches using a brain single-cell RNA-seq reference. Boxplots indicate median (middle line), 25th, 75th percentile (box) and 5th and 95th percentile (whiskers).</p></caption><graphic xlink:href="41467_2022_30033_Fig2_HTML" id="d32e510"/></fig></p>
    </sec>
    <sec id="Sec4">
      <title>STdeconvolve achieves competitive performance to reference-based, supervised deconvolution approaches</title>
      <p id="Par8">We next sought to compare the performance of STdeconvolve to existing supervised reference-based deconvolution approaches SPOTlight, RCTD, and spatialDWLS using our simulated 100 µm<sup>2</sup> resolution ST data of the MPOA. As described previously, these approaches require a single-cell transcriptomics reference for deconvolution. As an ideal single-cell transcriptomics reference, we used the original single-cell MERFISH data that was used to construct the simulated ST data (Supplementary Fig. <xref rid="MOESM1" ref-type="media">S3A</xref>, Supplementary Methods). We again quantified the performance of each approach using the RMSE of the deconvolved cell-type proportions compared to ground truth across simulated pixels. In general, we find the performance of STdeconvolve to be comparable to these reference-based deconvolution approaches when such an ideal single-cell transcriptomics reference is used (Fig. <xref rid="Fig2" ref-type="fig">2e, f</xref>).</p>
      <p id="Par9">One potential limitation of such existing reference-based deconvolution approaches is their reliance on a suitable single-cell transcriptomics reference. We thus sought to evaluate the performance of these reference-based deconvolution approaches when a suitable single-cell reference is not available. To this end, we removed excitatory and inhibitory neuronal cell types to simulate a less suitable single-cell transcriptomics reference (Supplementary Methods). We then deconvolved the simulated ST data of the MPOA using each reference-based deconvolution approach with this new less suitable reference and computed the RMSE across pixels. Because STdeconvolve does not use a reference, its performance does not change. However, the performance for all reference-based deconvolution approaches resulted in a significantly higher RMSE (Diebold–Mariano <italic>p</italic> value &lt; 2.2 × 10<sup>−16</sup>) than STdeconvolve (Fig. <xref rid="Fig2" ref-type="fig">2g</xref>). Likewise, pixels previously comprised of neurons were now erroneously predicted by reference-based deconvolution approaches to be comprised primarily of immature oligodendrocytes (Supplementary Fig. <xref rid="MOESM1" ref-type="media">S3B</xref>). In addition, we evaluated the performance of each reference-based deconvolution approach after removing rarer ependymal cells from the single-cell transcriptomics reference. Again, given this less suitable single-cell transcriptomics reference, pixels previously comprised of ependymal cells were now erroneously predicted by reference-based deconvolution approaches to be comprised primarily of astrocytes (Supplementary Fig. <xref rid="MOESM1" ref-type="media">S3C</xref>). Thus, the performance of reference-based deconvolution approaches is sensitive to differences in cell-type composition between the ST data and the single-cell transcriptomics reference used.</p>
      <p id="Par10">Likewise, such an ideal single-cell transcriptomics reference that optimally matches the cell-type composition and measurement sensitivities of the ST data to be deconvolved may not be available. Therefore, this ideal MERFISH MPOA single-cell transcriptomics reference likely provides an upper bound on performance for reference-based deconvolution approaches. To provide a more realistic evaluation of performance for reference-based deconvolution approaches, we sought to deconvolve our simulated ST data of the MPOA using a scRNA-seq reference from a mouse brain atlasing effort<sup><xref ref-type="bibr" rid="CR16">16</xref></sup>. Again, as a reference-free deconvolution approach, the performance of STdeconvolve does not change. However, again, the performance for all reference-dependent methods resulted in a significantly higher RMSE (Diebold–Mariano <italic>p</italic> value &lt; 2.2 × 10<sup>−16</sup>) than STdeconvolve (Fig. <xref rid="Fig2" ref-type="fig">2h</xref>, Supplementary Methods). Thus, STdeconvolve achieves comparable performance to reference-based, supervised deconvolution approaches when an ideal single-cell transcriptomics reference is used, and potentially better performance when an ideal single-cell transcriptomics reference is not available.</p>
    </sec>
    <sec id="Sec5">
      <title>STdeconvolve recovers perturbation specific gene expression profiles</title>
      <p id="Par11">Though reference-based deconvolution approaches may accurately recover cell-type proportions in ST data, they currently do not deconvolve cell-type-specific gene expression profiles. Nonetheless, perturbations may induce cell-type-specific transcriptional changes in ST data that would not be identifiable by current reference-based deconvolution approaches unless perturbation-matched single-cell transcriptomics references are used. While the availability of scRNA-seq references grows due to single-cell atlasing initiatives, these datasets primarily represent collections of healthy tissues<sup><xref ref-type="bibr" rid="CR8">8</xref>,<xref ref-type="bibr" rid="CR9">9</xref>,<xref ref-type="bibr" rid="CR17">17</xref>–<xref ref-type="bibr" rid="CR19">19</xref></sup>. As such, there is a particular scarcity of suitable scRNA-seq references available for reference-based deconvolution of ST data in the context of disease and other perturbations.</p>
      <p id="Par12">In contrast to current reference-based deconvolution approaches, STdeconvolve can estimate cell-type transcriptional profiles in a manner that is not constrained by the expression profiles of specific cell types defined in single-cell transcriptomics references. We therefore sought to explore the potential of STdeconvolve in detecting these perturbation-driven cell-type-specific gene expression changes using simulated ST data from mixtures of single cells assayed by scRNA-seq (Fig. <xref rid="Fig3" ref-type="fig">3a</xref>, Supplementary Methods). Briefly, we took advantage of scRNA-seq data previously collected from mammary tissues of aged and young mice<sup><xref ref-type="bibr" rid="CR20">20</xref></sup>. Previous transcriptional clustering analysis revealed a subpopulation of macrophages with age-associated gene expression changes. Specifically, aged macrophages upregulated <italic>Cd274</italic> and <italic>Clec4d</italic>, and downregulated <italic>Coro1a</italic> compared to young macrophages. Therefore, we simulated ST data of aged tissue using mixtures of aged macrophages and other luminal cells and ST data of young tissue using mixtures of young macrophages and other luminal cells (Fig. <xref rid="Fig3" ref-type="fig">3b</xref>). We then sought to evaluate the ability of STdeconvolve to recover these age-associated gene expression changes in macrophages (Supplementary Methods). Applying STdeconvolve using <italic>K =</italic> 2 cell types to the simulated ST data of both aged and young tissue, we found that the deconvolved transcriptional profiles were highly correlated with the matched ground truth gene expression profiles from scRNA-seq in all cases (Supplementary Fig. <xref rid="MOESM1" ref-type="media">S4A, B</xref>). Further, when we compared the deconvolved transcriptional profiles of aged versus young macrophages, we were able to identify upregulated genes included <italic>Cd274</italic> and <italic>Clec4d</italic>, and downregulated genes included <italic>Coro1a</italic>, consistent with the original study (Fig. <xref rid="Fig3" ref-type="fig">3c</xref>). Thus, STdeconvolve can potentially recover perturbation-driven cell-type-specific gene expression changes in ST data.<fig id="Fig3"><label>Fig. 3</label><caption><title>Comparing clustering versus deconvolution analysis for ST data.</title><p><bold>a</bold> Overview of simulation approach. Starting from a single-cell RNA-seq clustering result visualized as a 2D t-SNE embedding with cells colored by cell type (top), gene expression counts from cells are combined to simulate cell-type mixtures, with the proportions of cell types are represented as pie charts for each arbitrary spatial pixel (bottom). <bold>b</bold> Simulated ST datasets of aged and young tissues using mixtures of aged macrophages with aged luminal cells and young macrophages with young luminal cells respectively represented as pie charts for each simulated ST pixel. <bold>c</bold> Bar chart of log<sub>2</sub> fold-change for deconvolved aged macrophage versus deconvolved young macrophage gene expression. Select genes are highlighted in red. <bold>d</bold> Simulated ST dataset with 3 cell types represented as pie charts for each simulated ST pixel. <bold>e</bold> Clustering analysis results of simulated ST dataset with 3 cell types. Pie chart proportional representation (left) and t-SNE representation (right). <bold>f</bold> Deconvolution results for the simulated ST dataset with 3 cell types by STdeconvolve. The ranking of each gene based on its expression level in the deconvolved cell-type transcriptional profiles compared to its gene rank in the matched ground truth cell-type transcriptional profiles (top). Heatmap of Pearson’s correlations between the deconvolved cell types proportions and ground truth cell types proportions across simulated pixels (bottom). <bold>g</bold> BayesSpace enhanced resolution clustering results for the simulated ST dataset with 3 cell types represented as pie charts. <bold>h</bold> Root-mean-square-error (RMSE) of the deconvolved cell-type proportions (<italic>n</italic> = 900 pixels) compared to ground truth for the simulated ST dataset with three cell types. <bold>i</bold> Ground truth cell-type proportions derived from single-cell resolution MERFISH data of the mouse brain partitioned into 100 µm<sup>2</sup> pixels. <bold>j</bold> Deconvolved cell-type proportions for the mouse brain by STdeconvolve. <bold>k</bold> Enhanced resolution clustering for the mouse brain by BayesSpace. Inset highlights an interior region corresponding approximately to the thalamus. <bold>l</bold> Root-mean-square-error (RMSE) of the deconvolved cell-type proportions (<italic>n</italic> = 716 pixels) compared to single-cell clustering for the MERFISH mouse brain data for the inset interior region corresponding approximately to the thalamus. Boxplots indicate median (middle line), 25th, 75th percentile (box) and 5th and 95th percentile (whiskers).</p></caption><graphic xlink:href="41467_2022_30033_Fig3_HTML" id="d32e675"/></fig></p>
    </sec>
    <sec id="Sec6">
      <title>Deconvolution provides distinct insights compared to clustering analysis</title>
      <p id="Par13">Generally, we note that deconvolution of multi-cellular pixel resolution ST data can provide distinct insights from clustering analysis. To demonstrate this, we again simulated ST data using mixtures of single cells assayed by scRNA-seq (Supplementary Methods). Specifically, we simulated ST pixels comprised of mixtures of either luminal cells and pericytes or pericytes and macrophages (Fig. <xref rid="Fig3" ref-type="fig">3d</xref>). Applying clustering analysis to these ST pixels, we identified 2 clusters corresponding to either mixtures of luminal cells and pericytes or mixtures of pericytes and macrophages (Fig. <xref rid="Fig3" ref-type="fig">3e</xref>). In contrast, applying STdeconvolve with <italic>K</italic> = 3, we were able to recover the proportional representations of luminal cells, pericytes, and macrophages as well as their original cell-type-specific transcriptional profiles (Fig. <xref rid="Fig3" ref-type="fig">3f</xref>).</p>
      <p id="Par14">Such differences between deconvolution and clustering analysis extends to resolution enhancing clustering approaches such as BayesSpace<sup><xref ref-type="bibr" rid="CR21">21</xref></sup>. Briefly, BayesSpace utilizes a spatial prior that encourages spatially neighboring pixels to cluster into the same transcriptional cluster. Enhanced resolution clustering is obtained after subdividing each pixel and modeling the expression profiles of the subpixels as additional latent parameters estimated in the Bayesian model. Applying BayesSpace with 3 clusters to our simulated ST data, we obtained 3 spatially discrete clusters corresponding to different mixtures of luminal cells and pericytes and mixtures of pericytes and macrophages (Fig. <xref rid="Fig3" ref-type="fig">3g</xref>, Supplementary Methods). Compared to STdeconvolve, both regular transcriptional clustering and resolution enhanced clustering with BayesSpace exhibited significantly higher RMSE (Diebold-Mariano <italic>p</italic> value &lt; 2.2 × 10<sup>−16</sup>) (Fig. <xref rid="Fig3" ref-type="fig">3h</xref>).</p>
      <p id="Par15">To further demonstrate the difference between deconvolution and clustering analysis for ST data, we again simulated ST data using a single-cell resolution MERFISH dataset of a coronal section of the mouse brain. We analyzed the single-cell resolution transcriptional profiles to identify 20 transcriptionally distinct cell types and again simulated multi-cellular pixel-resolution ST data by aggregating the single cells into 100 µm<sup>2</sup> pixels (Fig. <xref rid="Fig3" ref-type="fig">3i</xref>, Supplementary Fig. <xref rid="MOESM1" ref-type="media">S5A, B</xref>, Supplementary Methods). The organization of cell types within the mouse brain is highly complex with many regions including the thalamus at the central region of this coronal section being composed of mixtures of multiple transcriptionally distinct cell types. We thus sought to evaluate whether STdeconvolve could better recover the proportional representation of cell types compared to resolution enhanced clustering with BayesSpace. Applying both STdeconvolve and BayesSpace, we generally recover the cell-type pixel proportions and visually recapitulate the spatial organization of cell types within various brain structures (Fig. <xref rid="Fig3" ref-type="fig">3j, k</xref>, Supplementary Methods). However, focusing in on the central region of the coronal section encompassing the thalamus, we indeed saw a visual difference between the spatial organization of cell types recovered by deconvolution via STdeconvolve compared to resolution enhanced clustering via BayesSpace (Fig. <xref rid="Fig3" ref-type="fig">3j, k</xref> inset). Quantifying performance, BayesSpace exhibited significantly higher RMSE compared to STdeconvolve (Diebold-Mariano <italic>p</italic> value &lt; 2.2 × 10<sup>−16</sup>) as a whole (Supplementary Fig <xref rid="MOESM1" ref-type="media">S5C</xref>, though more discernably in the thalamus region (Fig. <xref rid="Fig3" ref-type="fig">3l</xref>). Taken together, deconvolution approaches such as STdeconvolve can reveal cell types and patterns not evident through clustering and resolution enhanced clustering approaches alone when applied to multi-cellular pixel resolution data for pixels containing heterogeneous mixtures of cell types.</p>
    </sec>
    <sec id="Sec7">
      <title>STdeconvolve characterizes the spatial organization of transcriptionally distinct cell types in real ST data</title>
      <p id="Par16">Having demonstrated the capacity of STdeconvolve to recover cell-type proportions and transcriptional profiles in simulated ST data, we next sought to evaluate the performance of STdeconvolve by analyzing real 100 µm<sup>2</sup> resolution ST data of the mouse main olfactory bulb (MOB)<sup><xref ref-type="bibr" rid="CR22">22</xref></sup>. The MOB consists of multiple bilaterally symmetric and transcriptionally distinct cell layers due to topographically organized sensory inputs<sup><xref ref-type="bibr" rid="CR23">23</xref></sup>. While previous clustering analysis of ST data of the MOB revealed coarse spatial organization of coarse cell layers, finer structures such as the rostral migratory stream (RMS) could not be readily observed (Supplementary Fig. <xref rid="MOESM1" ref-type="media">S6A, B</xref>). We applied STdeconvolve to identify <italic>K</italic> = 12 cell types (Fig. <xref rid="Fig4" ref-type="fig">4a</xref>, Supplementary Fig. <xref rid="MOESM1" ref-type="media">S6C</xref>, Supplementary Methods) that either overlapped with or further split coarse cell layers previously identified from clustering analysis (Supplementary Fig. <xref rid="MOESM1" ref-type="media">S6D</xref>). In particular, deconvolved cell-type X7 overlapped with the granule cell layer previously identified from clustering analysis and was spatially placed where the RMS is expected<sup><xref ref-type="bibr" rid="CR24">24</xref></sup> (Fig. <xref rid="Fig4" ref-type="fig">4b</xref>). Upregulated genes in its deconvolved transcriptional profile, including <italic>Nrep</italic>, <italic>Sox11</italic>, and <italic>Dcx</italic>, are known to be associated with neuronal differentiation and upregulated in neuronal precursor cells within the RMS<sup><xref ref-type="bibr" rid="CR25">25</xref></sup> (Fig. <xref rid="Fig4" ref-type="fig">4c</xref>, Supplementary Fig. <xref rid="MOESM1" ref-type="media">S6E</xref>). Higher resolution ISH staining of these genes further demarcates a region within the granule cell layer where the RMS is expected<sup><xref ref-type="bibr" rid="CR19">19</xref></sup> (Fig. <xref rid="Fig4" ref-type="fig">4d</xref>). This suggests that deconvolved cell-type X7 may correspond to the neuronal precursor cell-type within the RMS unidentified from clustering analysis.<fig id="Fig4"><label>Fig. 4</label><caption><title>Deconvolution of ST data of varying resolution from multiple technologies by STdeconvolve.</title><p><bold>a</bold> Deconvolved cell-type proportions for ST data of the MOB, represented as pie charts for each ST pixel. Pixels are outlined with colors based on the pixel transcriptional cluster assignment corresponding to MOB coarse cell layers. <bold>b</bold> Highlight of deconvolved cell-type X7. Pixel proportion of deconvolved cell-type X7 are indicated as black slices in pie charts. Pixels are outlined with colors as in (<bold>a</bold>). <bold>c</bold> Gene counts in each pixel of the MOB ST dataset for deconvolved cell-type X7’s select top marker genes <italic>Sox11</italic> and <italic>Nrep</italic>. <bold>d</bold> Corresponding ISH images for <italic>Sox11</italic> and <italic>Nrep</italic> from the Allen Brain Atlas<sup><xref ref-type="bibr" rid="CR19">19</xref></sup>. <bold>e</bold> Deconvolved cell-type proportions for Visium data of the mouse brain. <bold>f</bold> Deconvolved cell-type proportions for DBiT-seq data of the lower body of an E11 mouse embryo. <bold>g</bold> Deconvolved cell-type proportions for Slide-seq data of the mouse cerebellum.</p></caption><graphic xlink:href="41467_2022_30033_Fig4_HTML" id="d32e859"/></fig></p>
      <p id="Par17">To further evaluate the biological reproducibility of deconvolved cell types, we applied STdeconvolve independently to 3 additional biological replicates of ST data of the MOB (Supplementary Methods). In each biological replicate, STdeconvolve consistently identified approximately 12 cell types (Supplementary Fig. <xref rid="MOESM1" ref-type="media">S7A</xref>). Transcriptional profiles between deconvolved cell types were also highly correlated across biological replicates (Supplementary Fig. <xref rid="MOESM1" ref-type="media">S7B–D</xref>). This suggests that STdeconvolve can reliably deconvolve consistent cell types, even across biological replicates.</p>
      <p id="Par18">As noted previously using simulated ST data, the performance of reference-based deconvolution approaches is sensitive to differences in cell-type composition between the single-cell transcriptomics reference and the ST data to be deconvolved. To demonstrate this with real ST data, we first compared STdeconvolve and reference-based deconvolution approaches using an appropriate MOB scRNA-seq reference<sup><xref ref-type="bibr" rid="CR26">26</xref></sup> (Supplementary Methods). We found strong correlations between cell-type proportions estimated by STdeconvolve and the evaluated reference-based deconvolution approaches with a high degree of correspondence among all evaluated methods (Supplementary Fig. <xref rid="MOESM1" ref-type="media">S8A, B</xref>). Notably, the proportion and transcriptional profile of deconvolved cell-type X8 identified by STdeconvolve to be enriched in the olfactory nerve layer correlated strongly with the proportion of olfactory ensheathing cells (OECs) identified by reference-based deconvolution approaches.</p>
      <p id="Par19">Next, to simulate a less suitable scRNA-seq reference, we removed OECs from the MOB scRNA-seq reference and again evaluated the performance of reference-based deconvolution approaches given this new scRNA-seq reference without OECs (Supplementary Methods). Again, as a reference-free deconvolution approach, the results of STdeconvolve do not change. However, for some reference-based deconvolution approaches, given this new reference without OECs, pixels in the olfactory nerve layer previously comprised of OECs were now predicted to be comprised of N2 cells (Supplementary Fig. <xref rid="MOESM1" ref-type="media">S9A</xref>). Although we do not know the ground truth cell-type composition of this olfactory nerve layer, we have reasons to believe that this placement of N2 cells is erroneous. First, when a scRNA-seq reference with OECs was used, reference-based deconvolution approaches generally estimated N2 cells to be relatively rare. However, when a scRNA-seq reference without OECs was used, these reference-based deconvolution approaches substantially increased their estimated abundance of N2 cells (Supplementary Fig. <xref rid="MOESM1" ref-type="media">S9B</xref>). Second, while the transcriptional profiles of OECs and N2 cells are highly correlated (Supplementary Fig. <xref rid="MOESM1" ref-type="media">S9C</xref>), the two cell types exhibit significant transcriptionally differences. For example, top differentially upregulated genes in OECs are highly expressed in the olfactory nerve layer (Supplementary Fig. <xref rid="MOESM1" ref-type="media">S8C</xref>) whereas top differentially upregulated genes in N2 cells are not well detected in the olfactory nerve layer (Supplementary Fig. <xref rid="MOESM1" ref-type="media">S9D</xref>). This lack of detection of N2 cell marker genes within the olfactory nerve layer coupled with the rarity of N2 cells in the original reference-based deconvolution with OECs suggests that the placement of N2 cells in the olfactory nerve layer by reference-based deconvolution approaches when using a reference without OECs is erroneous.</p>
      <p id="Par20">Further, a single-cell transcriptomics reference may not always exist for the same tissue from which ST data was generated, prompting the use of a reference from a related but inherently different tissue source. To evaluate the potential effect of using a single-cell transcriptomics reference from a different tissue source on reference-based deconvolution approaches, we sought to deconvolve the MOB ST data using the scRNA-seq reference from the mouse brain described previously. Given this mouse brain reference, pixels in the olfactory nerve layer previously comprised of OECs were now predicted to be comprised of vascular leptomeningeal cells (VLMC) (Supplementary Fig. <xref rid="MOESM1" ref-type="media">S10A</xref>). Again, although we do not know the ground truth cell-type composition of this olfactory nerve layer, top differentially upregulated genes in VLMCs are not well detected in the MOB (Supplementary Fig. <xref rid="MOESM1" ref-type="media">S10B</xref>) and are therefore likely not truly present. Taken together, all this suggests that reference-based deconvolution approaches are sensitive to the cell types represented in the single-cell transcriptomics reference that is used, which may lead to inaccurate results and spurious cell-type assignments when a suitable reference is not available.</p>
    </sec>
    <sec id="Sec8">
      <title>STdeconvolve is applicable across diverse ST dataset resolutions and technologies</title>
      <p id="Par21">We anticipate that continual technological improvements will enhance the resolution of ST data. Already, ST technologies such as Visium (10X Genomics), Slide-seq<sup><xref ref-type="bibr" rid="CR27">27</xref></sup>, and DBiT-seq<sup><xref ref-type="bibr" rid="CR28">28</xref></sup> have achieved resolution that can range from 50 µm<sup>2</sup> to 10 µm<sup>2</sup>. Therefore, we sought to evaluate the performance of STdeconvolve on higher resolution ST data using both simulated as well as real ST data from higher resolution ST technologies including Visium, Slide-seq, and DBiT-seq.</p>
      <p id="Par22">First, to simulate higher resolution ST data, we again aggregated single-cell resolution MERFISH data of the MPOA into 50, 20, and 10 µm<sup>2</sup> resolution pixels. Applying STdeconvolve, we observed similarly strong correlations between the deconvolved cell-type transcriptional profiles and proportions with the ground truth (Supplementary Fig. <xref rid="MOESM1" ref-type="media">S11A–D</xref>). Although the number of cells in each multi-cellular pixel did decrease as the resolution of the pixel increased as expected, we note that even higher resolution pixels may still contain multiple cells representing multiple cell types (Supplementary Fig. <xref rid="MOESM1" ref-type="media">S11E, F</xref>). Thus, deconvolution may still be applicable to higher resolution ST data and STdeconvolve can still accurately deconvolve cell types within these higher resolution multi-cellular pixels.</p>
      <p id="Par23">Encouraged by STdeconvolve’s ability to recover cell types in simulated high-resolution ST data, we then applied STdeconvolve to real high-resolution multi-cellular ST data from several different technologies. First, we applied STdeconvolve to 50 µm<sup>2</sup> resolution ST data of a coronal section of the mouse brain from 10X Visium. Briefly, for 10X Visium, mRNAs from tissue sections are captured onto an array of DNA barcoded spots, resulting in RNA-sequencing measurements with gridded 2D spatial positional information. We applied STdeconvolve to identify <italic>K</italic> = 20 cell types that exhibit spatially distinct patterns that demarcate known brain structures such as the isocortex and fiber tracts (Fig. <xref rid="Fig4" ref-type="fig">4e</xref>, Supplementary Fig. <xref rid="MOESM1" ref-type="media">S12</xref>, Supplementary Methods).</p>
      <p id="Par24">We next applied STdeconvolve to 25 µm<sup>2</sup> resolution ST data of the lower body of the E11 mouse embryo from DBiT-seq. Briefly, for DBiT-seq, parallel microfluidic channels are used to deliver DNA barcodes to the surface of a tissue to enable direct barcoding of mRNAs in situ, resulting in RNA-sequencing measurements in a 2D mosaic of spatial pixels. Previously, the authors identified 13 transcriptionally and spatially distinct features in the E11 mouse embryo including the atrium, ventricle, liver, and blood vessels containing erythrocyte coagulation. Applying STdeconvolve with <italic>K</italic> = 13, we identify deconvolved cell types that corresponded with similar spatially distinct features in agreement with the original findings (Fig. <xref rid="Fig4" ref-type="fig">4f</xref>, Supplementary Fig. <xref rid="MOESM1" ref-type="media">S13A</xref>, Supplementary Methods). Moreover, the top genes in the deconvolved cell-type-specific transcriptional profiles contained the expected marker genes of the matching features, such as <italic>Myh6</italic> for the atrium, <italic>Myh7</italic> for the ventricle, <italic>Apoa2</italic> for the liver, and <italic>Hba.a2</italic> for the blood vessels containing erythrocyte coagulation in agreement with the original findings (Supplementary Fig. <xref rid="MOESM1" ref-type="media">S13B</xref>).</p>
      <p id="Par25">Finally, we applied STdeconvolve to 10 µm<sup>2</sup> resolution ST data of the mouse cerebellum from Slide-seq. Briefly, for Slide-seq, mRNAs from tissue sections are captured onto densely packed barcoded beads, resulting in RNA-sequencing measurements with 2D spatial positional information. Previously, RCTD was also applied to this Slide-seq dataset with a matched Drop-seq scRNA-seq reference of the mouse cerebellum<sup><xref ref-type="bibr" rid="CR29">29</xref></sup> to identify beads representing a distinct layers of Purkinje neurons and Bergmann glia. Applying STdeconvolve, we identified <italic>K</italic> = 14 cell types (Fig. <xref rid="Fig4" ref-type="fig">4g</xref>, Supplementary Methods) whose transcriptional profiles correlated strongly with cell types from the scRNA-seq dataset of the mouse cerebellum (Supplementary Fig. <xref rid="MOESM1" ref-type="media">S14A</xref>). In particular, we found that the deconvolved transcriptional profiles of cell-type X4 and cell-type X2 correlated strongly with the transcriptional profiles of Purkinje neurons and Bergmann glia. Likewise, the deconvolved proportional representation of cell-type X4 and cell-type X2 also agreed significantly (Fisher’s Exact <italic>p</italic> value &lt; 2.2 × 10<sup>−16</sup>) with the predicted proportions of Purkinje neuron and Bergmann glia from RCTD (Supplementary Fig. <xref rid="MOESM1" ref-type="media">S14B, C</xref>). Taken together, these results indicate that STdeconvolve can be applicable to a range of multi-cellular resolution ST technologies.</p>
      <p id="Par26">As the resolution of ST data improves, the number of spatially resolved pixels and cell types represented in the data will presumably also increase. We therefore sought to evaluate the scalability of STdeconvolve in anticipation of these increasingly larger datasets. To this end, we benchmarked the runtime and total memory usage by STdeconvolve when deconvolving varying numbers of cell types using varying numbers of genes across varying numbers of pixels (Methods). We found that both the runtime and memory usage by STdeconvolve increased linearly with the number of pixels and genes in the input dataset (Supplementary Fig. <xref rid="MOESM1" ref-type="media">S15A</xref>) and is comparable to existing reference-based deconvolution methods when applied to current ST datasets<sup><xref ref-type="bibr" rid="CR5">5</xref></sup>. Likewise, runtime scales with the number of deconvolved cell types <italic>K</italic> in the input dataset though memory usage remains stable (Supplementary Fig. <xref rid="MOESM1" ref-type="media">S15B</xref>). To enhance runtime efficiency, STdeconvolve has built in parallelization. In this manner, we anticipate that STdeconvolve will be amenable to larger ST data.</p>
    </sec>
    <sec id="Sec9">
      <title>STdeconvolve identifies immune infiltrates in breast cancer</title>
      <p id="Par27">Finally, to demonstrate the potential of an unsupervised, reference-free deconvolution approach, we applied STdeconvolve to 100 µm<sup>2</sup> resolution ST data of 4 breast cancer sections<sup><xref ref-type="bibr" rid="CR30">30</xref></sup>. Here, a matched scRNA-seq reference was not available and using a scRNA-seq reference from another breast cancer sample may be inappropriate due to potential inter-tumoral heterogeneity<sup><xref ref-type="bibr" rid="CR31">31</xref></sup>. Transcriptional clustering of the ST pixels previously identified 3 transcriptionally distinct clusters that corresponded to 3 histological regions of the tissue: ductal carcinoma in situ (DCIS), invasive ductal carcinoma (IDC), and non-malignant<sup><xref ref-type="bibr" rid="CR30">30</xref></sup> (Fig. <xref rid="Fig5" ref-type="fig">5a</xref>, Supplementary Fig. <xref rid="MOESM1" ref-type="media">16A, B</xref>). However, the tumor microenvironment is a complex milieu of many additional cell types<sup><xref ref-type="bibr" rid="CR32">32</xref></sup>. We thus applied STdeconvolve to identify potential additional cell types and interrogate their spatial organization, resulting in <italic>K</italic> = 15 identified cell types (Fig. <xref rid="Fig5" ref-type="fig">5b</xref>, Supplementary Fig. <xref rid="MOESM1" ref-type="media">S16C</xref>, Supplementary Methods). Of these, deconvolved cell types X3 and X13 pixel proportions corresponded spatially with pixels annotated as the non-malignant and DCIS regions, respectively (Supplementary Fig. <xref rid="MOESM1" ref-type="media">S16D</xref>). Likewise, the deconvolved expression profiles for X3 and X13 included <italic>KRT1</italic>, a keratin gene specifically expressed in mammary myoepithelial cells<sup><xref ref-type="bibr" rid="CR33">33</xref></sup>, and <italic>PRSS23</italic>, a serine protease associated with proliferation of breast cancer cells<sup><xref ref-type="bibr" rid="CR34">34</xref></sup>, respectively, consistent with the non-malignant and DCIS annotations (Supplementary Fig. <xref rid="MOESM1" ref-type="media">S17</xref>). Interestingly, the deconvolved expression profile for cell-type X15 included immune genes such as <italic>CD74</italic> and <italic>CXCL10</italic> (Fig. <xref rid="Fig5" ref-type="fig">5c–e</xref>, Supplementary Fig. <xref rid="MOESM1" ref-type="media">S18</xref>). Gene set enrichment analysis also suggested that genes in the deconvolved expression profile for cell-type X15 are significantly enriched in immune processes such as T cell activation (Supplementary Data <xref rid="MOESM5" ref-type="media">1</xref>, Supplementary Methods). This suggests that deconvolved cell-type X15 may correspond to immune infiltrates. Further, we find a significant the number of pixels with a high proportion of deconvolved cell-type X15 corresponding to IDC regions (Fisher’s exact <italic>p</italic> value = 0.001257) based on previous clustering and pathology annotations. In contrast, we do not see a significant number of pixels with a high proportion of deconvolved cell-type X15 corresponding to DCIS regions (Fisher’s exact <italic>p</italic> value = 0.5625). This is consistent with previous observations that when comparing pure DCIS and IDC, infiltration of immune cells was significantly higher in IDC to pure DCIS<sup><xref ref-type="bibr" rid="CR35">35</xref>,<xref ref-type="bibr" rid="CR36">36</xref></sup>.<fig id="Fig5"><label>Fig. 5</label><caption><title>STdeconvolve characterizes the spatial organization of immune cells in real and simulated breast cancer ST data.</title><p><bold>a</bold> An H&amp;E-stained image of the breast cancer tissue with pathological annotations adapted from Yoosuf et al.<sup><xref ref-type="bibr" rid="CR30">30</xref></sup>. <bold>b</bold> Deconvolved cell-type pixel proportions for ST data of a breast cancer tissue section, represented as pie charts. Pixels are outlined with colors based on the pixel transcriptional cluster assignment corresponding to 3 pathological annotations. <bold>c</bold> Highlight of deconvolved cell-type X15. Pixel proportion of deconvolved cell-type X15 are indicated as black slices in pie charts. Pixels are outlined with colors as in (<bold>b</bold>). Select genes corresponding cell-type X15’s select top marker genes are shown. <bold>d</bold> Barplot of the deconvolved transcriptional profile of cell-type X15 ordered by magnitude. Inset represents the log<sub>2</sub> fold-change of the deconvolved transcriptional profile of cell-type X15 with respect to the mean expression of the other 14 deconvolved cell-type transcriptional profiles. Select highly expressed and high fold-change genes are labeled. <bold>e</bold> Gene set enrichment plot for significantly enriched GO term “T cell activation” for deconvolved cell-type X15. <bold>f</bold> Simulated ST datasets of an immune-excluded tumor sample (top) and immune-infiltrated tumor sample (bottom) using mixtures of single cells represented as pie charts for each simulated ST pixel. <bold>g</bold> Deconvolution results for the simulated ST data by STdeconvolve. The ranking of each gene based on its expression level in the deconvolved-cell-type transcriptional profiles compared to its gene rank in the matched ground truth cell-type transcriptional profiles for the simulated immune-excluded tumor sample (top) and immune-infiltrated tumor sample (bottom). <bold>h</bold> Histogram of the deconvolved proportion of immune cells in the tumor region defined in (<bold>f</bold>) for the simulated immune-excluded tumor sample (top) and immune-infiltrated tumor sample (bottom).</p></caption><graphic xlink:href="41467_2022_30033_Fig5_HTML" id="d32e1157"/></fig></p>
      <p id="Par28">The spatial organization of immune cells within tumors has been previously implicated to be relevant in breast cancer prognosis<sup><xref ref-type="bibr" rid="CR37">37</xref></sup>. In particular, whether immune cells are infiltrated or excluded from the tumor is associated with tumor microenvironments that stratify patient outcomes<sup><xref ref-type="bibr" rid="CR38">38</xref></sup>. To evaluate whether STdeconvolve may be able to distinguish infiltrated versus excluded spatial organization of immune cells in tumors, we simulated ST data representing infiltrated and excluded spatial organizations using mixtures of single cells assayed by scRNA-seq (Fig. <xref rid="Fig5" ref-type="fig">5f</xref>, Supplementary Methods). In both the simulated infiltrated and excluded cases, we find that STdeconvolve can effectively recover the cell-type transcriptional profiles (Fig. <xref rid="Fig5" ref-type="fig">5g</xref>) and enable the quantification of immune infiltration to help distinguish between infiltrated versus excluded spatial organization of immune cells (Fig. <xref rid="Fig5" ref-type="fig">5h</xref>). Therefore, we anticipate that STdeconvolve may be able to assist in deconvolving cell types in heterogeneous cancer tissues to recover potentially clinically interesting spatial organizational patterns.</p>
    </sec>
  </sec>
  <sec id="Sec10" sec-type="discussion">
    <title>Discussion</title>
    <p id="Par29">Multi-cellular pixel-resolution ST technologies have enabled high-throughput transcriptomic profiling of small mixtures of cells within tissues but accurate identification of the underlying cell types within each pixel is critical for elucidating cell-type-specific spatial organizational patterns and gene expression variation. Although several deconvolution methods have already been developed to address this challenge, they currently rely on suitable single-cell transcriptomics references. As we have shown, this reliance on single-cell transcriptomics references constrains the spatial mapping of cell types to those in the reference, which may present limitations if there are missing cell types, mismatched cell types, perturbations, and batch effect differences between the single-cell transcriptomics reference and ST data to be deconvolved. Here, we have presented STdeconvolve, a reference-free computational approach to deconvolve cell-type proportions and their transcriptional profiles in multi-cellular pixel-resolution ST data. We have demonstrated that STdeconvolve can accurately recover underlying cell-type proportions and their transcriptional profiles across a range of different ST technologies and resolutions. STdeconvolve further provides competitive performance to reference-based deconvolution approaches when an ideal single-cell transcriptomics reference is available and potentially better performance in more realistic circumstances where such an ideal reference is not available. Additionally, we showed the advantage of deconvolution over clustering-based analysis methods to interrogate heterogeneous mixtures of cell types. Likewise, using simulated ST data of aged-perturbed tissues, we showed that STdeconvolve can recover perturbation-driven cell-type-specific gene expression changes. Finally, we applied STdeconvolve to identify putative immune infiltration in real and simulated breast cancer ST data.</p>
    <p id="Par30">Though we have shown that STdeconvolve can effectively recover cell-type proportions and transcriptional profiles in simulated and real ST data, its use of LDA modeling relies on several underlying assumptions, which may present limitations when these assumptions are not satisfied. Notably, the performance of LDA in accurately deconvolving cell types depends on the size of the dataset with respect to the number of pixels and the number of genes<sup><xref ref-type="bibr" rid="CR39">39</xref></sup>. As such, deconvolution accuracy generally decreases for ST data containing fewer than 10 pixels (Supplementary Fig. <xref rid="MOESM1" ref-type="media">S19</xref>). While we have generally found the number of pixels in most ST datasets to be well beyond 10 pixels after quality control filtering, the application of ST to profile tissue slivers or other thin structures covering only a few pixels may present challenges to deconvolution by STdeconvolve. Further, LDA modeling attempts to identify tightly occurring, and ideally non-overlapping groups of genes in the pixels as cell types. In this manner, if genes do not exhibit variability across pixels due to a homogeneous or uniform proportional representation of cell types across pixels (Supplementary Fig. <xref rid="MOESM1" ref-type="media">S20</xref>), STdeconvolve may fail to deconvolve transcriptionally distinct cell types. Likewise, if the gene expression in the ST data is too sparse with high rates of stochastic drop-outs<sup><xref ref-type="bibr" rid="CR40">40</xref></sup>, then the LDA model may struggle to identify distinct groups of co-expressed genes and as such STdeconvolve may also struggle to deconvolve transcriptionally distinct cell types as well. Still, when such failures happen, STdeconvolve will indicate to users when distinct cell types cannot be adequately deconvolved.</p>
    <p id="Par31">Although we have demonstrated the applicability of STdeconvolve to current high-resolution multi-cellular pixel resolution ST data, as the resolution of ST data continues to increase, sub-cellular pixel-resolution ST technologies will also become more accessible. Already, a number sub-cellular pixel-resolution ST technologies have emerged<sup><xref ref-type="bibr" rid="CR41">41</xref>–<xref ref-type="bibr" rid="CR45">45</xref></sup>. As the capture efficiency at this resolution and likewise the biological questions of interest may differ substantially from multi-cellular ST data, we anticipate that new methods specifically suited for sub-cellular resolution ST data will be needed. Thus, STdeconvolve may not be best suited for analysis of such sub-cellular resolution ST data. Still, as we have noted previously, even as the resolution of ST data increases, some pixels may still contain multiple cells representing multiple cell types, suggesting that deconvolution may still be necessary. Likewise, the number of cells present in a pixel ultimately will depend on cell size, which can vary depending on the organism, tissue, and/or disease state being profiled. Ultimately, we believe that there will be a need to balance between resolution and throughput of ST technologies depending on the biological question of interest. The potentially larger tissue regions able to be covered by multi-cellular pixel resolution ST data may still be of interest and thus still require deconvolution. We anticipate that STdeconvolve will be applicable to data from a variety of current and future ST technologies as well as potentially inferred ST data<sup><xref ref-type="bibr" rid="CR46">46</xref></sup> to reveal cell-type-specific spatial organizational patterns and transcriptional changes. In general, we foresee that reference-free deconvolution approaches such as STdeconvolve will contribute to the interrogation of the spatial relationships between transcriptionally distinct cell types in heterogeneous tissues.</p>
  </sec>
  <sec id="Sec11">
    <title>Methods</title>
    <sec id="Sec12">
      <title>STdeconvolve overview</title>
      <p id="Par32">STdeconvolve uses LDA<sup><xref ref-type="bibr" rid="CR47">47</xref></sup>, a generative probabilistic model, to deconvolve the latent cell types contained within multi-cellular pixels of spatially resolved transcriptome (ST) measurements. In this context, each pixel is defined as a mixture of <italic>K</italic> cell types represented as a multinomial distribution of cell-type probabilities (<italic>θ</italic>), and each cell type is defined as a probability distribution over the genes (<italic>β</italic>) present in the ST dataset.</p>
      <sec id="Sec13">
        <title>LDA modeling</title>
        <p id="Par33">The ST dataset is represented as a <italic>D</italic> × <italic>N</italic> matrix of discrete gene expression counts for each pixel <italic>d</italic> and gene <italic>n</italic>. The total number of unique molecules, or total gene expression, in a given pixel <italic>d</italic> is <italic>M</italic><sub><italic>d</italic></sub>.</p>
        <p id="Par34">As a generative probabilistic model, the LDA model generates a set of new pixels as follows:</p>
        <p id="Par35">For each pixel <italic>d</italic> ∈ [1:D]:<list list-type="alpha-lower"><list-item><p id="Par36">draw a cell-type distribution <italic>θ</italic><sub><italic>d</italic></sub> ~ <italic>Dir</italic> (α), where <italic>θ</italic><sub><italic>d</italic></sub> is a multinomial distribution of length <italic>K</italic> drawn from a uniform Dirichlet distribution with scaling parameter <italic>α</italic>.</p></list-item><list-item><p id="Par37">for each observed molecule <italic>m</italic> in <italic>M</italic><sub><italic>d</italic></sub>:<list list-type="simple"><list-item><label>i.</label><p id="Par38">draw a cell-type assignment <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${z}_{d,m} \sim {mult}({\theta }_{d})\in [1\!:\!{{{\rm{K}}}}]$$\end{document}</tex-math><mml:math id="M2"><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>~</mml:mo><mml:mi>m</mml:mi><mml:mi>u</mml:mi><mml:mi>l</mml:mi><mml:mi>t</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>∈</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mspace width="0.3em"/><mml:mo>:</mml:mo><mml:mspace width="0.3em"/><mml:mi mathvariant="normal">K</mml:mi></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2022_30033_Article_IEq1.gif"/></alternatives></inline-formula></p></list-item><list-item><label>ii.</label><p id="Par39">based on this cell-type assignment, draw a gene <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${w}_{d,m} \sim {mult}({\beta }_{{z}_{d,m}})\in [1\!:\!{{{\rm{N}}}}]$$\end{document}</tex-math><mml:math id="M4"><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>~</mml:mo><mml:mi>m</mml:mi><mml:mi>u</mml:mi><mml:mi>l</mml:mi><mml:mi>t</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>∈</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mspace width="0.3em"/><mml:mo>:</mml:mo><mml:mspace width="0.3em"/><mml:mi mathvariant="normal">N</mml:mi></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2022_30033_Article_IEq2.gif"/></alternatives></inline-formula></p></list-item></list></p></list-item></list></p>
        <p id="Par40">The central goal is to identify the posterior distribution of the latent parameters, <italic>θ</italic> and <italic>β</italic>, given the input data, i.e., the observed gene expression in the ST dataset. For each pixel <italic>d</italic>, the posterior distribution is defined as:<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p\left({\theta }_{d},\,{{{{{\boldsymbol{z}}}}}}|{{{{{\boldsymbol{w}}}}}},\alpha ,\,\beta \right)=\frac{p\left({\theta }_{d},\,{{{{{\boldsymbol{z}}}}}},\,{{{{{\boldsymbol{w}}}}}}\,|\alpha ,\,\beta \right)}{p\left({{{{{\boldsymbol{w}}}}}}\,|\alpha ,\,\beta \right)}$$\end{document}</tex-math><mml:math id="M6"><mml:mi>p</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:mi mathvariant="bold-italic">z</mml:mi><mml:mo>∣</mml:mo><mml:mi mathvariant="bold-italic">w</mml:mi><mml:mo>,</mml:mo><mml:mi>α</mml:mi><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:mi>β</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>p</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:mi mathvariant="bold-italic">z</mml:mi><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:mi mathvariant="bold-italic">w</mml:mi><mml:mspace width="0.25em"/><mml:mo>∣</mml:mo><mml:mi>α</mml:mi><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:mi>β</mml:mi></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi mathvariant="bold-italic">w</mml:mi><mml:mspace width="0.25em"/><mml:mo>∣</mml:mo><mml:mi>α</mml:mi><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:mi>β</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:mfrac></mml:math><graphic xlink:href="41467_2022_30033_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula>where <bold><italic>z</italic></bold> is the vector of <italic>M</italic><sub><italic>d</italic></sub> cell types assigned to each unique molecule in pixel <italic>d</italic>, and <bold><italic>w</italic></bold> is the vector of <italic>M</italic><sub><italic>d</italic></sub> genes assigned to each molecule in pixel <italic>d</italic>. A variational expectation-maximization approach is used to estimate the values of the latent parameters<sup><xref ref-type="bibr" rid="CR47">47</xref>,<xref ref-type="bibr" rid="CR48">48</xref></sup>. Multiplying the marginal probabilities of the individual pixels gives the probability of the entire ST dataset. By default, <italic>β</italic> is initialized with 0 for all cell types and genes, and <italic>α</italic> as 50/<italic>K</italic>.</p>
        <p id="Par41">The resulting estimated <italic>θ</italic> and <italic>β</italic> matrices represent the deconvolved proportions of cell types in each pixel and the gene expression profiles for each cell type, scaled to a library size of 1. <italic>β</italic> represents a <italic>K</italic> × <italic>N</italic> gene-probability (i.e., expression) matrix for each cell type <italic>k</italic> and each gene <italic>n</italic> with each row summing to 1. The <italic>β</italic> matrix can be multiplied by a scaling factor of one million to be more like conventional counts-per-million expression values for interpretability. <italic>θ</italic> represents a <italic>D</italic> × <italic>K</italic> pixel-cell-type proportion matrix for each pixel <italic>d</italic> and each cell type <italic>k</italic>. LDA modeling in STdeconvolve is implemented through the ‘topicmodels’ R package<sup><xref ref-type="bibr" rid="CR48">48</xref></sup>.</p>
        <p id="Par42">Of note, LDA assumes for each cell type that there is a group of genes highly co-expressed with high probability. Therefore, STdeconvolve selects for genes more likely to be highly co-expressed within cell types, which can improve cell-type deconvolution.</p>
      </sec>
      <sec id="Sec14">
        <title>Selection of genes for LDA model</title>
        <p id="Par43">Latent cell types are best discovered by LDA modeling if cell-type-specific marker genes are included in the input ST data while genes whose expression is shared across cell types are excluded. Therefore, to filter for genes that are more likely to be specifically expressed in particular cell types to improve cell-type deconvolution by LDA, STdeconvolve first removes genes that are not detected in a sufficient number of pixels. By default, genes detected in less than 5% of pixels are removed. Likewise, STdeconvolve also removes genes that are expressed in all pixels. By default, genes detected in 100% of pixels are removed. STdeconvolve then selects for significantly overdispersed genes, or genes with higher-than-expected expression variance across pixels, as a means to detect transcriptionally distinct cell types<sup><xref ref-type="bibr" rid="CR14">14</xref></sup>. We assume that the proportion of cell types will vary across pixels and thus differences in their cell-type-specific transcriptional profiles manifest as overdispersed genes across pixels in the dataset.</p>
        <p id="Par44">If there are too many genes included in the input ST data, LDA may also struggle to identify non-overlapping clusters composed of distinct combinations of co-expressed genes. In these circumstances, users may modulate the number of informative genes included in the input matrix to ensure LDA convergence. By default, only the top 1000 most overdispersed genes are retained in the input ST data because we note that deconvolution accuracy in general stabilizes for larger numbers of informative features (Supplementary Fig. <xref rid="MOESM1" ref-type="media">S22</xref>).</p>
        <p id="Par45">Additional gene filtering or cell-type-specific marker genes to include in the input ST data may also be augmented by the user.</p>
      </sec>
      <sec id="Sec15">
        <title>Selection of LDA model with optimal number of cell types</title>
        <p id="Par46">The number of cell types <italic>K</italic> in the LDA model must be chosen a priori. To determine the optimal number of cell types <italic>K</italic> to choose for a given dataset, we fit a set of LDA models using different values for <italic>K</italic> over a user defined range of positive integers greater than 1. We then compute the perplexity of each fitted model:<disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{\rm{Perplexity}}}}}}\left(D\right)={{{{{\rm{exp }}}}}}\left\{-\frac{{{{{{\rm{log }}}}}}\left(p\left(D\right)\right)}{\mathop{\sum }\limits_{d=1}^{D}\mathop{\sum }\limits_{n=1}^{N}{c}_{d,n}}\right\}$$\end{document}</tex-math><mml:math id="M8"><mml:mi mathvariant="normal">Perplexity</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>D</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mi mathvariant="normal">exp</mml:mi><mml:mfenced close="}" open="{"><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">log</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>p</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>D</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>D</mml:mi></mml:mrow></mml:munderover><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="41467_2022_30033_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula>where <italic>p(D)</italic> is the likelihood of the dataset and <italic>c</italic><sub><italic>d,n</italic></sub> is the gene count, or expression level, of gene <italic>n</italic> in pixel <italic>d</italic>. We can interpret <italic>p(D)</italic> as the posterior likelihood of the dataset conditional on the cell-type assignments using the final estimated <italic>θ</italic> and <italic>β</italic>. The lower the perplexity, the better the model represents the real dataset. Thus, the trend between choice of <italic>K</italic> and the respective model perplexity can then serve as a guide. By default, the perplexity is computed by comparing <italic>p(D)</italic> to the entire input dataset used to estimate <italic>θ</italic> and <italic>β</italic>.</p>
        <p id="Par47">In addition, STdeconvolve also reports the trend between <italic>K</italic> and the number of deconvolved cell types with mean pixel proportions &lt;5% (as default). We chose this default threshold based on the difficulty of STdeconvolve and reference-based deconvolution approaches to deconvolve cell types at low proportions, (i.e., “rare” cell types) (Supplementary Note <xref rid="MOESM1" ref-type="media">2</xref>). We note that as <italic>K</italic> is increased for fitted LDA models, the number of such “rare” cell types generally increases. Such rare deconvolved cell types are often distinguished by fewer distinct transcriptional patterns in the data and may represent non-relevant or spurious subdivisions of primary cell types. We can use this metric to help set an upper bound on <italic>K</italic>.</p>
        <p id="Par48">Generally, perplexity decreases and the number of “rare” deconvolved cell types increases as <italic>K</italic> increases. Given these model perplexities and number of “rare” deconvolved cell types for each tested <italic>K</italic>, the optimal <italic>K</italic> can then be determined by choosing the maximum <italic>K</italic> with the lowest perplexity while minimizing number of “rare” deconvolved cell types. To further guide the choice of <italic>K</italic>, an inflection point (“knee”) is derived from the maximum second derivative of the plotted <italic>K</italic> versus perplexity plot and <italic>K</italic> versus number of “rare” deconvolved cell types.</p>
        <p id="Par49">Still, for a given <italic>K</italic>, the fitted LDA model may fail to identify distinct cell types e.g., the distribution of cell-type proportions in each pixel is uniform. In such a situation, the Dirichlet distribution shape parameter <italic>α</italic> of the LDA model will be ≥1 and STdeconvolve will indicate to the user that the fitted LDA model for a particular <italic>K</italic> has an <italic>α</italic> above this threshold by graying out these <italic>Ks</italic> in the trend plot.</p>
        <p id="Par50">Ultimately, the choice of <italic>K</italic> is left up to the user and can be chosen taking into consideration prior knowledge of the biological system.</p>
      </sec>
    </sec>
    <sec id="Sec16">
      <title>Simulating ST data from single-cell resolution spatially resolved MERFISH data</title>
      <p id="Par51">MERFISH data of the mouse medial preoptic area (MPOA) was obtained from the original publication<sup><xref ref-type="bibr" rid="CR15">15</xref></sup>. Normalized gene expression values were converted back to counts by dividing by 1000 and multiplying by each cell’s absolute volume. Datasets for an untreated female animal containing counts for 135 genes assayed by MERFISH were used. Genes with non-count expression intensities assayed by sequential FISH were omitted. Counts of blank control measurements were also removed. Cells were previously annotated as being one of 9 major cell types (astrocyte, endothelial, microglia, immature or mature oligodendrocyte, ependymal, pericyte, inhibitory neuron, excitatory neuron). Cells originally annotated as “ambiguous” were removed from the dataset to ensure the ground truth was composed of cells with distinguishable cell types. Because certain cell types may be enriched in specific regions of the MPOA, we combined 12 tissue sections across the anterior and posterior regions to ensure that all expected cell types would be well represented in the final simulated ST dataset. After filtering, the final dataset contained 59651 cells representing 9 total cell types and counts for the 135 genes.</p>
      <p id="Par52">To simulate a multi-cellular pixel resolution ST dataset from such single-cell resolution spatially resolved MERFISH data, we generated a grid of squares, each square with an area of 100 µm<sup>2</sup>. Each square was considered a simulated pixel and the gene counts of cells whose x–y centroid was located within the coordinates of a square pixel were summed together. A grid of square pixels was generated for each of the 12 tissue sections separately and the simulated pixels for all 12 tissue sections were subsequently combined into a single ST dataset. For a given tissue section, the bottom edge of the grid was the lowest y-coordinate of the cell centroids and the left edge of the grid was the lowest x-coordinate. Square boundaries were then drawn from each of these edges in 100 µm<sup>2</sup> increments until the position of the farthest increment from the origin was greater than the highest respective cell centroid coordinate. After generating the grid, square pixels whose edges formed one of the outside edges of the grid were discarded in order to remove simulated pixels, which by virtue of their placement, encompassed space outside of the actual tissue sample. The retained pixels covered 49,142 out of the original 59651 cells in the 12 tissue sections. This resulted in a simulated ST dataset with 3072 pixels by 135 genes. We used the original cell type labels of each cell to compute the ground truth proportions in each simulated pixel. Likewise, to generate the ground truth transcriptional profiles of each cell type, we averaged the gene counts for cells of the same cell type from the original 59,651 cells and normalized the resulting gene count matrix to sum to 1 for each cell type. To simulate pixels of 50, 20, and 10 µm<sup>2</sup>, an identical approach was taken using the same cells except those square boundaries were drawn from each edge in 50, 20, or 10 µm<sup>2</sup> increments.</p>
    </sec>
    <sec id="Sec17">
      <title>Annotation and matching of deconvolved and ground truth cell types</title>
      <p id="Par53">Each deconvolved cell type was first matched with the ground truth cell type that had the highest Pearson’s correlation between their transcriptional profiles. This was done by computing the Pearson’s correlation between every combination of deconvolved and ground truth cell-type transcriptional profiles.</p>
      <p id="Par54">The assignment of deconvolved cell types to ground truth cell types was confirmed by testing for enrichment of differentially upregulated genes of the ground truth cell types in the deconvolved cell-type transcriptional profiles. To determine the differentially upregulated genes of the ground truth cell types, ground truth transcriptional profiles were converted to counts per thousand and low expressed genes, defined as those with average expression values less than 5, were removed. For each ground truth cell type, the log<sub>2</sub> fold change of each remaining gene with respect to the average expression across the other ground truth cell types was computed. Differentially upregulated genes were those with log<sub>2</sub> fold-change &gt;1. We performed rank-based gene set enrichment analysis of the ground truth upregulated gene sets in each deconvolved cell-type transcriptional profile using the ‘liger’ R package<sup><xref ref-type="bibr" rid="CR49">49</xref></sup>. A match to a ground truth cell type was confirmed and assigned if the ground truth gene set had the lowest gene set enrichment adjusted <italic>p</italic> value that was at least &lt;0.05, followed by the highest positive edge score<sup><xref ref-type="bibr" rid="CR50">50</xref></sup>, and then highest positive enrichment score to break ties.</p>
    </sec>
    <sec id="Sec18">
      <title>Deconvolution of additional simulated and real ST data</title>
      <p id="Par55">Deconvolution of simulated and real ST data using STdeconvolve in addition to deconvolution of simulated and real ST data using supervised reference-based deconvolution approaches with various single-cell transcriptomics references is further detailed in Supplementary Methods.</p>
    </sec>
    <sec id="Sec19">
      <title>Comparison of deconvolution approaches</title>
      <p id="Par56">How each supervised deconvolution approach was run is further detailed in the Supplementary Methods. To compare the performance between deconvolution methods, the RMSE was computed for each pixel between the deconvolved and matched ground truth cell-type proportions for each pixel in the ST dataset:<disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{\rm{RMSE}}}}}}=\sqrt{\frac{\mathop{\sum }\limits_{k=1}^{K}{({\hat{y}}_{k}-{y}_{k})}^{2}}{K}}$$\end{document}</tex-math><mml:math id="M10"><mml:mi mathvariant="normal">RMSE</mml:mi><mml:mo>=</mml:mo><mml:msqrt><mml:mrow><mml:mfrac><mml:mrow><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:munderover><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mo>^</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:msqrt></mml:math><graphic xlink:href="41467_2022_30033_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula>where <italic>K</italic> is the number of cell types, <inline-formula id="IEq3"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\hat{y}}_{k}$$\end{document}</tex-math><mml:math id="M12"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mo>^</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2022_30033_Article_IEq3.gif"/></alternatives></inline-formula> is the predicted cell-type proportion for the cell type <italic>k</italic>, and <italic>y</italic><sub><italic>k</italic></sub> is the ground truth cell-type proportion for the cell type <italic>k</italic>. To assess whether the distribution of pixel RMSEs was significantly lower for STdeconvolve compared to other methods, a one-sided Diebold–Mariano test<sup><xref ref-type="bibr" rid="CR51">51</xref></sup> was used.</p>
    </sec>
    <sec id="Sec20">
      <title>Runtime and memory evaluation</title>
      <p id="Par57">Using the Visium dataset described in Supplementary Methods ‘<italic>Deconvolution of 10X Visium data with STdeconvolve</italic>’, we generated an input ST dataset of 2702 pixels and feature selected for the top 1000 most significant overdispersed genes. Runtime of STdeconvolve was measured on randomly drawn subsets of input data. Five subsets are drawn with 2702 pixels and 50, 100, 200, 400, and 1000 genes, respectively. Another five subsets are drawn with the 1000 top overdispersed genes and 50, 100, 200, 400, and 1000 pixels, respectively. All subsets are deconvolved with cell type number (<italic>K</italic>) between 4 and 20 as input parameters. Runtime was measured using the R package ‘microbenchmark’<sup><xref ref-type="bibr" rid="CR52">52</xref></sup> (v1.4–7). Memory usage of STdeconvolve was measured using a similar sub-setting procedure and the R package ‘profmem’<sup><xref ref-type="bibr" rid="CR53">53</xref></sup> (v0.6.0). Total memory allocation was measured, which provides an upper bound for peak memory usage. Runtime and memory analyses were run on a machine with i7-6600U 2.60GHz CPU with 8GM of RAM.</p>
    </sec>
    <sec id="Sec21">
      <title>Reporting summary</title>
      <p id="Par58">Further information on research design is available in the <xref rid="MOESM2" ref-type="media">Nature Research Reporting Summary</xref> linked to this article.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary information</title>
    <sec id="Sec22">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="41467_2022_30033_MOESM1_ESM.pdf">
            <caption>
              <p>Supplementary Information</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="41467_2022_30033_MOESM2_ESM.pdf">
            <caption>
              <p>Reporting Summary</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM3">
          <media xlink:href="41467_2022_30033_MOESM3_ESM.pdf">
            <caption>
              <p>Peer Review File</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM4">
          <media xlink:href="41467_2022_30033_MOESM4_ESM.pdf">
            <caption>
              <p>Description of Additional Supplementary Files</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM5">
          <media xlink:href="41467_2022_30033_MOESM5_ESM.xlsx">
            <caption>
              <p>Supplementary Data 1</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM6">
          <media xlink:href="41467_2022_30033_MOESM6_ESM.gz">
            <caption>
              <p>Supplementary Software</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p><bold>Publisher’s note</bold> Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <sec>
    <title>Supplementary information</title>
    <p>The online version contains supplementary material available at 10.1038/s41467-022-30033-z.</p>
  </sec>
  <ack>
    <title>Acknowledgements</title>
    <p>Research reported in this publication was supported by the National Institute of General Medical Sciences of the National Institutes of Health under Award Number R35-GM142889.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author contributions</title>
    <p>J.F. conceived the research. B.F.M. led computational work under the guidance of J.F. F.H., L.A., and A.S. contributed to computational work under the guidance of B.F.M. and J.F. All authors participated in interpretation and writing of the manuscript.</p>
  </notes>
  <notes notes-type="peer-review">
    <title>Peer review</title>
    <sec id="FPar1">
      <title>Peer review information</title>
      <p id="Par59"><italic>Nature Communications</italic> thanks Jana Fischer, Rammohan Shukla and the other, anonymous, reviewer(s) for their contribution to the peer review of this work. <xref rid="MOESM3" ref-type="media">Peer reviewer reports</xref> are available.</p>
    </sec>
  </notes>
  <notes notes-type="data-availability">
    <title>Data availability</title>
    <p>Cell centroid coordinates, gene counts, and metadata of the MERFISH dataset of the mouse medial preoptic area<sup><xref ref-type="bibr" rid="CR15">15</xref></sup> are available for download at <ext-link ext-link-type="uri" xlink:href="https://datadryad.org/stash/dataset/doi:10.5061/dryad.8t8s248/">https://datadryad.org/stash/dataset/doi:10.5061/dryad.8t8s248/</ext-link>. Cell volume data for animal FN7, datasets 171021_FN7_2_M22_M26 and 171023_FN7_1_M22_M26, was also obtained from the original authors. Cell centroid coordinates, gene counts, and metadata of Slice 2, replicate 1 of the MERFISH dataset of the mouse coronal section of the cortex are available as part of the Vizgen Data Release V1.0. May 2021 <ext-link ext-link-type="uri" xlink:href="https://info.vizgen.com/mouse-brain-data">https://info.vizgen.com/mouse-brain-data</ext-link>. Gene count matrices and H&amp;E images for all MOB replicates are available for download at <ext-link ext-link-type="uri" xlink:href="https://www.spatialresearch.org/resources-published-datasets/doi-10-1126science-aaf2403/">https://www.spatialresearch.org/resources-published-datasets/doi-10-1126science-aaf2403/</ext-link>. Gene count matrices and H&amp;E images for all breast cancer tissue replicates are available for download at <ext-link ext-link-type="uri" xlink:href="https://www.spatialresearch.org/resources-published-datasets/doi-10-1126science-aaf2403/">https://www.spatialresearch.org/resources-published-datasets/doi-10-1126science-aaf2403/</ext-link>. 10X Visium data of the mouse coronal section of the cortex (V1_Adult_Mouse_Brain - Adult Mouse Brain (Coronal)) available for download at <ext-link ext-link-type="uri" xlink:href="https://www.10xgenomics.com/resources/datasets/mouse-brain-section-coronal-1-standard-1-1-0">https://www.10xgenomics.com/resources/datasets/mouse-brain-section-coronal-1-standard-1-1-0</ext-link>. DBiT-seq dataset of E11 mouse embryo lower body (GSM4364242_E11-1L) gene count matrices available for download at <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE137986">https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE137986</ext-link>. Slide-seq of the mouse cerebellum (Puck_180819_12) available for download at <ext-link ext-link-type="uri" xlink:href="https://singlecell.broadinstitute.org/single_cell/study/SCP354/slide-seq-study#study-download">https://singlecell.broadinstitute.org/single_cell/study/SCP354/slide-seq-study#study-download</ext-link>. Single-cell gene count matrices and cell metadata used in simulations available for download at <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE150580">https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE150580</ext-link>. scRNA-seq data of the mouse olfactory bulb<sup><xref ref-type="bibr" rid="CR26">26</xref></sup> available for download at <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE121891">https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE121891</ext-link>. Drop-seq single-cell RNA-seq of mouse cerebellum available for download at <ext-link ext-link-type="uri" xlink:href="http://dropviz.org/">http://dropviz.org/</ext-link>.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Code availability</title>
    <p>STdeconvolve is available as an open-source R software package<sup><xref ref-type="bibr" rid="CR54">54</xref></sup> with the source code available as Supplemental Software and on GitHub at <ext-link ext-link-type="uri" xlink:href="https://github.com/JEFworks-Lab/STdeconvolve">https://github.com/JEFworks-Lab/STdeconvolve</ext-link>. Additional documentation, instructions to generate the minimum datasets to reproduce the analyses, and tutorials are available at <ext-link ext-link-type="uri" xlink:href="https://jef.works/STdeconvolve/">https://jef.works/STdeconvolve/</ext-link>.</p>
  </notes>
  <notes id="FPar2" notes-type="COI-statement">
    <title>Competing interests</title>
    <p id="Par60">The authors declare no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhuang</surname>
            <given-names>X</given-names>
          </name>
        </person-group>
        <article-title>Spatially resolved single-cell genomics and transcriptomics by imaging</article-title>
        <source>Nat. Methods</source>
        <year>2021</year>
        <volume>18</volume>
        <fpage>18</fpage>
        <lpage>22</lpage>
        <pub-id pub-id-type="doi">10.1038/s41592-020-01037-8</pub-id>
        <?supplied-pmid 33408406?>
        <pub-id pub-id-type="pmid">33408406</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Larsson</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Frisen</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Lundeberg</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Spatially resolved transcriptomics adds a new dimension to genomics</article-title>
        <source>Nat. Methods</source>
        <year>2021</year>
        <volume>18</volume>
        <fpage>15</fpage>
        <lpage>18</lpage>
        <pub-id pub-id-type="doi">10.1038/s41592-020-01038-7</pub-id>
        <?supplied-pmid 33408402?>
        <pub-id pub-id-type="pmid">33408402</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Elosua-Bayes</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Nieto</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Mereu</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Gut</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Heyn</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>SPOTlight: seeded NMF regression to deconvolute spatial transcriptomics spots with single-cell transcriptomes</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2021</year>
        <pub-id pub-id-type="doi">10.1093/nar/gkab043</pub-id>
        <?supplied-pmid 33544846?>
        <pub-id pub-id-type="pmid">33544846</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cable</surname>
            <given-names>DM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Robust decomposition of cell type mixtures in spatial transcriptomics</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2021</year>
        <pub-id pub-id-type="doi">10.1038/s41587-021-00830-w</pub-id>
        <?supplied-pmid 33603203?>
        <pub-id pub-id-type="pmid">33603203</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dong</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Yuan</surname>
            <given-names>GC</given-names>
          </name>
        </person-group>
        <article-title>SpatialDWLS: accurate deconvolution of spatial transcriptomic data</article-title>
        <source>Genome Biol.</source>
        <year>2021</year>
        <volume>22</volume>
        <fpage>145</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-021-02362-7</pub-id>
        <?supplied-pmid 33971932?>
        <pub-id pub-id-type="pmid">33971932</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <mixed-citation publication-type="other">Kiemen, A. et al. In situ characterization of the 3D microanatomy of the pancreas and pancreatic cancer at single cell resolution. Preprint at <italic>bioRxiv</italic>10.1101/2020.12.08.416909 (2020).</mixed-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nguyen</surname>
            <given-names>QH</given-names>
          </name>
          <name>
            <surname>Pervolarakis</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Nee</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Kessenbrock</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>Experimental considerations for single-cell RNA sequencing approaches</article-title>
        <source>Front. Cell Dev. Biol.</source>
        <year>2018</year>
        <volume>6</volume>
        <fpage>108</fpage>
        <pub-id pub-id-type="doi">10.3389/fcell.2018.00108</pub-id>
        <?supplied-pmid 30234113?>
        <pub-id pub-id-type="pmid">30234113</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Network</surname>
            <given-names>BICC</given-names>
          </name>
        </person-group>
        <article-title>A multimodal cell census and atlas of the mammalian primary motor cortex</article-title>
        <source>Nature</source>
        <year>2021</year>
        <volume>598</volume>
        <fpage>86</fpage>
        <lpage>102</lpage>
        <pub-id pub-id-type="doi">10.1038/s41586-021-03950-0</pub-id>
        <pub-id pub-id-type="pmid">34616075</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <mixed-citation publication-type="other">Regev, A. et al. The human cell atlas Preprint at <italic>bioRxiv</italic>10.1101/121202 (2017).</mixed-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <mixed-citation publication-type="other">Deutsch, A., Feng, D., Pessin, J. E. &amp; Shinoda, K. The impact of single-cell genomics on adipose tissue research. <italic>Int. J. Mol. Sci</italic>. <bold>21</bold>. 10.3390/ijms21134773 (2020).</mixed-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Haque</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Engel</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Teichmann</surname>
            <given-names>SA</given-names>
          </name>
          <name>
            <surname>Lonnberg</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>A practical guide to single-cell RNA-sequencing for biomedical research and clinical applications</article-title>
        <source>Genome Med.</source>
        <year>2017</year>
        <volume>9</volume>
        <fpage>75</fpage>
        <pub-id pub-id-type="doi">10.1186/s13073-017-0467-4</pub-id>
        <?supplied-pmid 28821273?>
        <pub-id pub-id-type="pmid">28821273</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dey</surname>
            <given-names>KK</given-names>
          </name>
          <name>
            <surname>Hsiao</surname>
            <given-names>CJ</given-names>
          </name>
          <name>
            <surname>Stephens</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Visualizing the structure of RNA-seq expression data using grade of membership models</article-title>
        <source>PLoS Genet.</source>
        <year>2017</year>
        <volume>13</volume>
        <fpage>e1006599</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pgen.1006599</pub-id>
        <?supplied-pmid 28333934?>
        <pub-id pub-id-type="pmid">28333934</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kang</surname>
            <given-names>K</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>CDSeq: a novel complete deconvolution method for dissecting heterogeneous samples using gene expression data</article-title>
        <source>PLoS Comput. Biol.</source>
        <year>2019</year>
        <volume>15</volume>
        <fpage>e1007510</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1007510</pub-id>
        <?supplied-pmid 31790389?>
        <pub-id pub-id-type="pmid">31790389</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fan</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Characterizing transcriptional heterogeneity through pathway and gene set overdispersion analysis</article-title>
        <source>Nat. Methods</source>
        <year>2016</year>
        <volume>13</volume>
        <fpage>241</fpage>
        <lpage>244</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.3734</pub-id>
        <?supplied-pmid 26780092?>
        <pub-id pub-id-type="pmid">26780092</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <mixed-citation publication-type="other">Moffitt, J. R. et al. Molecular, spatial, and functional single-cell profiling of the hypothalamic preoptic region. <italic>Science</italic><bold>362</bold>. 10.1126/science.aau5324 (2018).</mixed-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tasic</surname>
            <given-names>B</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Adult mouse cortical cell taxonomy revealed by single cell transcriptomics</article-title>
        <source>Nat. Neurosci.</source>
        <year>2016</year>
        <volume>19</volume>
        <fpage>335</fpage>
        <lpage>346</lpage>
        <pub-id pub-id-type="doi">10.1038/nn.4216</pub-id>
        <?supplied-pmid 26727548?>
        <pub-id pub-id-type="pmid">26727548</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hu</surname>
            <given-names>BC</given-names>
          </name>
        </person-group>
        <article-title>The human body at cellular resolution: the NIH Human Biomolecular Atlas Program</article-title>
        <source>Nature</source>
        <year>2019</year>
        <volume>574</volume>
        <fpage>187</fpage>
        <lpage>192</lpage>
        <pub-id pub-id-type="doi">10.1038/s41586-019-1629-x</pub-id>
        <pub-id pub-id-type="pmid">31597973</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hawrylycz</surname>
            <given-names>MJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>An anatomically comprehensive atlas of the adult human brain transcriptome</article-title>
        <source>Nature</source>
        <year>2012</year>
        <volume>489</volume>
        <fpage>391</fpage>
        <lpage>399</lpage>
        <pub-id pub-id-type="doi">10.1038/nature11405</pub-id>
        <?supplied-pmid 22996553?>
        <pub-id pub-id-type="pmid">22996553</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lein</surname>
            <given-names>ES</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Genome-wide atlas of gene expression in the adult mouse brain</article-title>
        <source>Nature</source>
        <year>2007</year>
        <volume>445</volume>
        <fpage>168</fpage>
        <lpage>176</lpage>
        <pub-id pub-id-type="doi">10.1038/nature05453</pub-id>
        <?supplied-pmid 17151600?>
        <pub-id pub-id-type="pmid">17151600</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>CM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Aging-associated alterations in mammary epithelia and stroma revealed by single-cell RNA sequencing</article-title>
        <source>Cell Rep.</source>
        <year>2020</year>
        <volume>33</volume>
        <fpage>108566</fpage>
        <pub-id pub-id-type="doi">10.1016/j.celrep.2020.108566</pub-id>
        <?supplied-pmid 33378681?>
        <pub-id pub-id-type="pmid">33378681</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhao</surname>
            <given-names>E</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Spatial transcriptomics at subspot resolution with BayesSpace</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2021</year>
        <pub-id pub-id-type="doi">10.1038/s41587-021-00935-2</pub-id>
        <?supplied-pmid 34949778?>
        <pub-id pub-id-type="pmid">34949778</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stahl</surname>
            <given-names>PL</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Visualization and analysis of gene expression in tissue sections by spatial transcriptomics</article-title>
        <source>Science</source>
        <year>2016</year>
        <volume>353</volume>
        <fpage>78</fpage>
        <lpage>82</lpage>
        <pub-id pub-id-type="doi">10.1126/science.aaf2403</pub-id>
        <?supplied-pmid 27365449?>
        <pub-id pub-id-type="pmid">27365449</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nagayama</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Homma</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Imamura</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>Neuronal organization of olfactory bulb circuits</article-title>
        <source>Front. Neural Circuits</source>
        <year>2014</year>
        <volume>8</volume>
        <fpage>98</fpage>
        <pub-id pub-id-type="doi">10.3389/fncir.2014.00098</pub-id>
        <?supplied-pmid 25232305?>
        <pub-id pub-id-type="pmid">25232305</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hintiryan</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Comprehensive connectivity of the mouse main olfactory bulb: analysis and online digital atlas</article-title>
        <source>Front Neuroanat.</source>
        <year>2012</year>
        <volume>6</volume>
        <fpage>30</fpage>
        <pub-id pub-id-type="doi">10.3389/fnana.2012.00030</pub-id>
        <?supplied-pmid 22891053?>
        <pub-id pub-id-type="pmid">22891053</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Identification and characterization of neuroblasts in the subventricular zone and rostral migratory stream of the adult human brain</article-title>
        <source>Cell Res.</source>
        <year>2011</year>
        <volume>21</volume>
        <fpage>1534</fpage>
        <lpage>1550</lpage>
        <pub-id pub-id-type="doi">10.1038/cr.2011.83</pub-id>
        <?supplied-pmid 21577236?>
        <pub-id pub-id-type="pmid">21577236</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tepe</surname>
            <given-names>B</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell RNA-Seq of mouse olfactory bulb reveals cellular heterogeneity and activity-dependent molecular census of adult-born neurons</article-title>
        <source>Cell Rep.</source>
        <year>2018</year>
        <volume>25</volume>
        <fpage>2689</fpage>
        <lpage>2703 e2683</lpage>
        <pub-id pub-id-type="doi">10.1016/j.celrep.2018.11.034</pub-id>
        <?supplied-pmid 30517858?>
        <pub-id pub-id-type="pmid">30517858</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rodriques</surname>
            <given-names>SG</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Slide-seq: a scalable technology for measuring genome-wide expression at high spatial resolution</article-title>
        <source>Science</source>
        <year>2019</year>
        <volume>363</volume>
        <fpage>1463</fpage>
        <lpage>1467</lpage>
        <pub-id pub-id-type="doi">10.1126/science.aaw1219</pub-id>
        <?supplied-pmid 30923225?>
        <pub-id pub-id-type="pmid">30923225</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>Y</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>High-spatial-resolution multi-omics sequencing via deterministic barcoding in tissue</article-title>
        <source>Cell</source>
        <year>2020</year>
        <volume>183</volume>
        <fpage>1665</fpage>
        <lpage>1681 e1618</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2020.10.026</pub-id>
        <?supplied-pmid 33188776?>
        <pub-id pub-id-type="pmid">33188776</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Saunders</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Molecular diversity and specializations among the cells of the adult mouse brain</article-title>
        <source>Cell</source>
        <year>2018</year>
        <volume>174</volume>
        <fpage>1015</fpage>
        <lpage>1030 e1016</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2018.07.028</pub-id>
        <?supplied-pmid 30096299?>
        <pub-id pub-id-type="pmid">30096299</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yoosuf</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Navarro</surname>
            <given-names>JF</given-names>
          </name>
          <name>
            <surname>Salmen</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Stahl</surname>
            <given-names>PL</given-names>
          </name>
          <name>
            <surname>Daub</surname>
            <given-names>CO</given-names>
          </name>
        </person-group>
        <article-title>Identification and transfer of spatial transcriptomics signatures for cancer diagnosis</article-title>
        <source>Breast Cancer Res.</source>
        <year>2020</year>
        <volume>22</volume>
        <fpage>6</fpage>
        <pub-id pub-id-type="doi">10.1186/s13058-019-1242-9</pub-id>
        <?supplied-pmid 31931856?>
        <pub-id pub-id-type="pmid">31931856</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Karaayvaz</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Unravelling subclonal heterogeneity and aggressive disease states in TNBC through single-cell RNA-seq</article-title>
        <source>Nat. Commun.</source>
        <year>2018</year>
        <volume>9</volume>
        <fpage>3588</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-018-06052-0</pub-id>
        <?supplied-pmid 30181541?>
        <pub-id pub-id-type="pmid">30181541</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wei</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Min</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Zhu</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Cellular and extracellular components in tumor microenvironment and their application in early diagnosis of cancers</article-title>
        <source>Anal. Cell Pathol.</source>
        <year>2020</year>
        <volume>2020</volume>
        <fpage>6283796</fpage>
        <pub-id pub-id-type="doi">10.1155/2020/6283796</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Karantza</surname>
            <given-names>V</given-names>
          </name>
        </person-group>
        <article-title>Keratins in health and cancer: more than mere epithelial cell markers</article-title>
        <source>Oncogene</source>
        <year>2011</year>
        <volume>30</volume>
        <fpage>127</fpage>
        <lpage>138</lpage>
        <pub-id pub-id-type="doi">10.1038/onc.2010.456</pub-id>
        <?supplied-pmid 20890307?>
        <pub-id pub-id-type="pmid">20890307</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chan</surname>
            <given-names>HS</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Serine protease PRSS23 is upregulated by estrogen receptor alpha and associated with proliferation of breast cancer cells</article-title>
        <source>PLoS ONE</source>
        <year>2012</year>
        <volume>7</volume>
        <fpage>e30397</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0030397</pub-id>
        <?supplied-pmid 22291950?>
        <pub-id pub-id-type="pmid">22291950</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kim</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Immune microenvironment in ductal carcinoma in situ: a comparison with invasive carcinoma of the breast</article-title>
        <source>Breast Cancer Res.</source>
        <year>2020</year>
        <volume>22</volume>
        <fpage>32</fpage>
        <pub-id pub-id-type="doi">10.1186/s13058-020-01267-w</pub-id>
        <?supplied-pmid 32216826?>
        <pub-id pub-id-type="pmid">32216826</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Beguinot</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Analysis of tumour-infiltrating lymphocytes reveals two new biologically different subgroups of breast ductal carcinoma in situ</article-title>
        <source>BMC Cancer</source>
        <year>2018</year>
        <volume>18</volume>
        <fpage>129</fpage>
        <pub-id pub-id-type="doi">10.1186/s12885-018-4013-6</pub-id>
        <?supplied-pmid 29394917?>
        <pub-id pub-id-type="pmid">29394917</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Keren</surname>
            <given-names>L</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A structured tumor-immune microenvironment in triple negative breast cancer revealed by multiplexed ion beam imaging</article-title>
        <source>Cell</source>
        <year>2018</year>
        <volume>174</volume>
        <fpage>1373</fpage>
        <lpage>1387 e1319</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2018.08.039</pub-id>
        <?supplied-pmid 30193111?>
        <pub-id pub-id-type="pmid">30193111</pub-id>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gruosso</surname>
            <given-names>T</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Spatially distinct tumor immune microenvironments stratify triple-negative breast cancers</article-title>
        <source>J. Clin. Investig</source>
        <year>2019</year>
        <volume>129</volume>
        <fpage>1785</fpage>
        <lpage>1800</lpage>
        <pub-id pub-id-type="doi">10.1172/JCI96313</pub-id>
        <?supplied-pmid 30753167?>
        <pub-id pub-id-type="pmid">30753167</pub-id>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <mixed-citation publication-type="other">Jian, T., Zhaoshi, M., Xuanlong, N., Qiaozhu, M. &amp; Ming, Z. Understanding the Limiting Factors of Topic Modeling via Posterior Contraction Analysis. <italic>PMLR</italic><bold>32</bold>, 190–198 (2014).</mixed-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Asp</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Bergenstrahle</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Lundeberg</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Spatially resolved transcriptomes-next generation tools for tissue exploration</article-title>
        <source>Bioessays</source>
        <year>2020</year>
        <volume>42</volume>
        <fpage>e1900221</fpage>
        <pub-id pub-id-type="doi">10.1002/bies.201900221</pub-id>
        <?supplied-pmid 32363691?>
        <pub-id pub-id-type="pmid">32363691</pub-id>
      </element-citation>
    </ref>
    <ref id="CR41">
      <label>41.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Eng</surname>
            <given-names>CL</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Transcriptome-scale super-resolved imaging in tissues by RNA seqFISH</article-title>
        <source>Nature</source>
        <year>2019</year>
        <volume>568</volume>
        <fpage>235</fpage>
        <lpage>239</lpage>
        <pub-id pub-id-type="doi">10.1038/s41586-019-1049-y</pub-id>
        <?supplied-pmid 30911168?>
        <pub-id pub-id-type="pmid">30911168</pub-id>
      </element-citation>
    </ref>
    <ref id="CR42">
      <label>42.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Xia</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Fan</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Emanuel</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Hao</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Zhuang</surname>
            <given-names>X</given-names>
          </name>
        </person-group>
        <article-title>Spatial transcriptome profiling by MERFISH reveals subcellular RNA compartmentalization and cell cycle-dependent gene expression</article-title>
        <source>Proc. Natl Acad. Sci. USA</source>
        <year>2019</year>
        <volume>116</volume>
        <fpage>19490</fpage>
        <lpage>19499</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.1912459116</pub-id>
        <?supplied-pmid 31501331?>
        <pub-id pub-id-type="pmid">31501331</pub-id>
      </element-citation>
    </ref>
    <ref id="CR43">
      <label>43.</label>
      <mixed-citation publication-type="other">Wang, X. et al. Three-dimensional intact-tissue sequencing of single-cell transcriptional states. <italic>Science</italic><bold>361</bold>. 10.1126/science.aat5691 (2018).</mixed-citation>
    </ref>
    <ref id="CR44">
      <label>44.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>F</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>RNAscope: a novel in situ RNA analysis platform for formalin-fixed, paraffin-embedded tissues</article-title>
        <source>J. Mol. Diagn.</source>
        <year>2012</year>
        <volume>14</volume>
        <fpage>22</fpage>
        <lpage>29</lpage>
        <pub-id pub-id-type="doi">10.1016/j.jmoldx.2011.08.002</pub-id>
        <?supplied-pmid 22166544?>
        <pub-id pub-id-type="pmid">22166544</pub-id>
      </element-citation>
    </ref>
    <ref id="CR45">
      <label>45.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Codeluppi</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Spatial organization of the somatosensory cortex revealed by osmFISH</article-title>
        <source>Nat. Methods</source>
        <year>2018</year>
        <volume>15</volume>
        <fpage>932</fpage>
        <lpage>935</lpage>
        <pub-id pub-id-type="doi">10.1038/s41592-018-0175-z</pub-id>
        <?supplied-pmid 30377364?>
        <pub-id pub-id-type="pmid">30377364</pub-id>
      </element-citation>
    </ref>
    <ref id="CR46">
      <label>46.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Levy-Jurgenson</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Tekpli</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Kristensen</surname>
            <given-names>VN</given-names>
          </name>
          <name>
            <surname>Yakhini</surname>
            <given-names>Z</given-names>
          </name>
        </person-group>
        <article-title>Spatial transcriptomics inferred from pathology whole-slide images links tumor heterogeneity to survival in breast and lung cancer</article-title>
        <source>Sci. Rep.</source>
        <year>2020</year>
        <volume>10</volume>
        <fpage>18802</fpage>
        <pub-id pub-id-type="doi">10.1038/s41598-020-75708-z</pub-id>
        <?supplied-pmid 33139755?>
        <pub-id pub-id-type="pmid">33139755</pub-id>
      </element-citation>
    </ref>
    <ref id="CR47">
      <label>47.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Blei</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>Ng</surname>
            <given-names>AY</given-names>
          </name>
          <name>
            <surname>Jordan</surname>
            <given-names>MI</given-names>
          </name>
        </person-group>
        <article-title>Latent dirichlet allocation</article-title>
        <source>J. Mach. Learn. Res.</source>
        <year>2003</year>
        <volume>3</volume>
        <fpage>993</fpage>
        <lpage>1022</lpage>
      </element-citation>
    </ref>
    <ref id="CR48">
      <label>48.</label>
      <mixed-citation publication-type="other">Grün, B. &amp; Hornik, K. topicmodels: an R package for fitting topic models. <bold>40</bold>, 30. 10.18637/jss.v040.i13 (2011).</mixed-citation>
    </ref>
    <ref id="CR49">
      <label>49.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fan</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Differential pathway analysis</article-title>
        <source>Methods Mol. Biol.</source>
        <year>2019</year>
        <volume>1935</volume>
        <fpage>97</fpage>
        <lpage>114</lpage>
        <pub-id pub-id-type="doi">10.1007/978-1-4939-9057-3_7</pub-id>
        <?supplied-pmid 30758822?>
        <pub-id pub-id-type="pmid">30758822</pub-id>
      </element-citation>
    </ref>
    <ref id="CR50">
      <label>50.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Subramanian</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Gene set enrichment analysis: a knowledge-based approach for interpreting genome-wide expression profiles</article-title>
        <source>Proc. Natl Acad. Sci. USA</source>
        <year>2005</year>
        <volume>102</volume>
        <fpage>15545</fpage>
        <lpage>15550</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.0506580102</pub-id>
        <?supplied-pmid 16199517?>
        <pub-id pub-id-type="pmid">16199517</pub-id>
      </element-citation>
    </ref>
    <ref id="CR51">
      <label>51.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Diebold</surname>
            <given-names>FX</given-names>
          </name>
          <name>
            <surname>Mariano</surname>
            <given-names>RS</given-names>
          </name>
        </person-group>
        <article-title>Comparing predictive accuracy</article-title>
        <source>J. Bus. Economic Stat.</source>
        <year>1995</year>
        <volume>13</volume>
        <fpage>253</fpage>
        <lpage>263</lpage>
      </element-citation>
    </ref>
    <ref id="CR52">
      <label>52.</label>
      <mixed-citation publication-type="other">Mersmann, O. microbenchmark: Accurate Timing Functions. R package version 1.4.7. <ext-link ext-link-type="uri" xlink:href="https://CRAN.R-project.org/package=microbenchmark">https://CRAN.R-project.org/package=microbenchmark</ext-link> (2021).</mixed-citation>
    </ref>
    <ref id="CR53">
      <label>53.</label>
      <mixed-citation publication-type="other">Bengtsson, H. profmem: Simple Memory Profiling for R. R package version 0.6.0. <ext-link ext-link-type="uri" xlink:href="https://CRAN.R-project.org/package=profmem">https://CRAN.R-project.org/package=profmem</ext-link> (2020).</mixed-citation>
    </ref>
    <ref id="CR54">
      <label>54.</label>
      <mixed-citation publication-type="other">R Core Team. <italic>R: A Language and Environment for Statistical Computing</italic>. (R Foundation for Statistical Computing, 2021).</mixed-citation>
    </ref>
  </ref-list>
</back>
