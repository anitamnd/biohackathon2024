<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7672693</article-id>
    <article-id pub-id-type="pmid">32186692</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btaa199</article-id>
    <article-id pub-id-type="publisher-id">btaa199</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Papers</subject>
        <subj-group subj-group-type="heading">
          <subject>Genetics and Population Analysis</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Estimation of dynamic SNP-heritability with Bayesian Gaussian process models</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0002-9545-0244</contrib-id>
        <name>
          <surname>Arjas</surname>
          <given-names>Arttu</given-names>
        </name>
        <xref ref-type="aff" rid="btaa199-aff1">b1</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-3756-8121</contrib-id>
        <name>
          <surname>Hauptmann</surname>
          <given-names>Andreas</given-names>
        </name>
        <xref ref-type="aff" rid="btaa199-aff1">b1</xref>
        <xref ref-type="aff" rid="btaa199-aff2">b2</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-2808-2768</contrib-id>
        <name>
          <surname>Sillanpää</surname>
          <given-names>Mikko J</given-names>
        </name>
        <xref ref-type="corresp" rid="btaa199-cor1"/>
        <xref ref-type="aff" rid="btaa199-aff1">b1</xref>
        <xref ref-type="aff" rid="btaa199-aff3">b3</xref>
        <!--<email>mikko.sillanpaa@oulu.fi</email>-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Schwartz</surname>
          <given-names>Russell</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <aff id="btaa199-aff1"><label>b1</label><institution>Research Unit of Mathematical Sciences</institution>, University of Oulu, Oulu FI-90014, <country country="FI">Finland</country></aff>
    <aff id="btaa199-aff2"><label>b2</label><institution>Department of Computer Science</institution>, University College London, London WC1E 6BT, <country country="GB">UK</country></aff>
    <aff id="btaa199-aff3"><label>b3</label><institution>Infotech Oulu</institution>, University of Oulu, Oulu FI-90014, <country country="FI">Finland</country></aff>
    <author-notes>
      <corresp id="btaa199-cor1">To whom correspondence should be addressed. <email>mikko.sillanpaa@oulu.fi</email></corresp>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>15</day>
      <month>6</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2020-03-18">
      <day>18</day>
      <month>3</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>18</day>
      <month>3</month>
      <year>2020</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. -->
    <volume>36</volume>
    <issue>12</issue>
    <fpage>3795</fpage>
    <lpage>3802</lpage>
    <history>
      <date date-type="received">
        <day>16</day>
        <month>10</month>
        <year>2019</year>
      </date>
      <date date-type="rev-recd">
        <day>10</day>
        <month>3</month>
        <year>2020</year>
      </date>
      <date date-type="accepted">
        <day>17</day>
        <month>3</month>
        <year>2020</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2020. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2020</copyright-year>
      <license license-type="cc-by" xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p><!--CREATIVE COMMONS-->This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btaa199.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>Improved DNA technology has made it practical to estimate single-nucleotide polymorphism (SNP)-heritability among distantly related individuals with unknown relationships. For growth- and development-related traits, it is meaningful to base SNP-heritability estimation on longitudinal data due to the time-dependency of the process. However, only few statistical methods have been developed so far for estimating dynamic SNP-heritability and quantifying its full uncertainty.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>We introduce a completely tuning-free Bayesian Gaussian process (GP)-based approach for estimating dynamic variance components and heritability as their function. For parameter estimation, we use a modern Markov Chain Monte Carlo method which allows full uncertainty quantification. Several datasets are analysed and our results clearly illustrate that the 95% credible intervals of the proposed joint estimation method (which ‘borrows strength’ from adjacent time points) are significantly narrower than of a two-stage baseline method that first estimates the variance components at each time point independently and then performs smoothing. We compare the method with a random regression model using MTG2 and BLUPF90 software and quantitative measures indicate superior performance of our method. Results are presented for simulated and real data with up to 1000 time points. Finally, we demonstrate scalability of the proposed method for simulated data with tens of thousands of individuals.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>The C++ implementation dynBGP and simulated data are available in GitHub: <ext-link ext-link-type="uri" xlink:href="https://github.com/aarjas/dynBGP">https://github.com/aarjas/dynBGP</ext-link>. The programmes can be run in R. Real datasets are available in QTL archive: <ext-link ext-link-type="uri" xlink:href="https://phenome.jax.org/centers/QTLA">https://phenome.jax.org/centers/QTLA</ext-link>.</p>
      </sec>
      <sec id="s5">
        <title>Supplementary information</title>
        <p><xref ref-type="supplementary-material" rid="sup1">Supplementary data</xref> are available at <italic>Bioinformatics</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Academy of Finland Profi 5 funding for mathematics and AI</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Academy of Finland</institution>
            <institution-id institution-id-type="DOI">10.13039/501100002341</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>312123</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Finnish Centre of Excellence in Inverse Modelling and Imaging</institution>
          </institution-wrap>
        </funding-source>
        <award-id>2018–2025</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Engineering and Physical Sciences Research Council</institution>
            <institution-id institution-id-type="DOI">10.13039/501100000266</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>EP/N032055/1</award-id>
        <award-id>EP/M020533/1</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="8"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Heritability, the proportion of phenotypic variation attributable to genetic factors, is a fundamental parameter in population and quantitative genetics (<xref rid="btaa199-B49" ref-type="bibr">Visscher <italic>et al.</italic>, 2008</xref>). The aim in narrow-sense heritability estimation is to separate the variance of the trait into additive genetic and environmental variance components such that their sum equals the total variance of the trait. Generally, heritability is a population-specific parameter which can be estimated either using (i) linear mixed model (LMM) techniques (<xref rid="btaa199-B19" ref-type="bibr">Henderson, 1984</xref>) or with (ii) multi-locus association (MLA) approaches (<xref rid="btaa199-B43" ref-type="bibr">Sillanpää, 2011</xref>). In LMMs, information of the (additive) genetic relationships between the individuals in the population must be available, which can be determined either from known pedigree or from genomic data [single-nucleotide polymorphism (SNP)], while in MLA models, heritability can be estimated from genomic data. In LMMs, the trait variation is assumed to be controlled by a high number of small effect genes (polygenic), whereas MLA models assume that there are only few major genes behind the trait variation. We note, that in case heritability is estimated from genomic data, it is called SNP-heritability, and we will from now on refer by heritability specifically to narrow-sense SNP-heritability.</p>
    <p>It is well known that heritability of a trait may depend on measurement time, age, environmental conditions (like temperature) or size (<xref rid="btaa199-B45" ref-type="bibr">Stinchcombe <italic>et al.</italic>, 2012</xref>). In all such cases, it is natural to consider and estimate heritability as a dynamic function. In particular, functional variation in heritability is motivated by the fact that environmental changes may affect the environmental variance, and genes that control traits can activate or deactivate (<xref rid="btaa199-B3" ref-type="bibr">Bryois <italic>et al.</italic>, 2017</xref>), which then may affect the genetic variance. In general, this kind of dynamic modelling of biological processes is a fast-growing field thanks to modern data collection techniques, see e.g. <xref rid="btaa199-B30" ref-type="bibr">Moore <italic>et al.</italic> (2013)</xref> and <xref rid="btaa199-B26" ref-type="bibr">Li and Sillanpää (2015)</xref>. However, the number of statistical methods and associated (easy-to-use and publicly available) software packages to estimate dynamic heritability is still limited. To discuss this further, let us first put available methods into context. For approaches in the multivariate LMM framework we have the following options.</p>
    <list list-type="roman-lower">
      <list-item>
        <p>A simple approach: considers all time points as dependent traits and estimates their trait-specific genetic variances. This multi-trait model estimates variances jointly but does not apply any smoothing over time points (<xref rid="btaa199-B20" ref-type="bibr">Henderson and Quaas, 1976</xref>; <xref rid="btaa199-B24" ref-type="bibr">Lee and van der Werf, 2016</xref>).</p>
      </list-item>
      <list-item>
        <p><italic>Smoothing at phenotype level</italic> (<xref ref-type="fig" rid="btaa199-F1">Fig. 1C</xref>): fits a linear or non-linear function over phenotypic time points, and then estimates latent-trait heritability influencing each parameter of that function using univariate or multivariate LMMs (e.g. <xref rid="btaa199-B6" ref-type="bibr">Canaza-Cayo <italic>et al.</italic>, 2015</xref>).</p>
      </list-item>
      <list-item>
        <p><italic>Smoothing at breeding value level</italic> (<xref ref-type="fig" rid="btaa199-F1">Fig. 1B</xref>): fits a linear or non-linear function over time in genomic breeding values (and possibly residual effects, i.e. permanent environmental effects). A common approach referred to as random regression (<xref rid="btaa199-B4" ref-type="bibr">Campbell <italic>et al.</italic>, 2018</xref>; <xref rid="btaa199-B42" ref-type="bibr">Schaeffer, 2016</xref>; <ext-link ext-link-type="uri" xlink:href="http://animalbiosciences.uoguelph.ca/%7Elrs/BOOKS/rrmbook.pdf">http://animalbiosciences.uoguelph.ca/%7Elrs/BOOKS/rrmbook.pdf</ext-link>), also requires estimation of the residual covariance matrix if the permanent environmental effects are not smoothed.</p>
      </list-item>
      <list-item>
        <p><italic>Smoothing at variance component level</italic> (<xref ref-type="fig" rid="btaa199-F1">Fig. 1A</xref>): if the residual variance is also smoothed, the residual covariance matrix can be left out of the model. Such an example is given by a spline-based method <xref rid="btaa199-B17" ref-type="bibr">He <italic>et al.</italic> (2016</xref>, <xref rid="btaa199-B18" ref-type="bibr">2017</xref>) which is restricted to only twin data.</p>
      </list-item>
    </list>
    <fig id="btaa199-F1" orientation="portrait" position="float">
      <label>Fig. 1.</label>
      <caption>
        <p>(Top panel) Continuous smoothing over time points can be induced into one of three possible layers in the LMM hierarchy: either in the variance component layer (<bold>A</bold>), genetic value layer (<bold>B</bold>) or phenotype layer (<bold>C</bold>). (Bottom panel) Our suggested LMM structure, where continuous smoothing over time points is induced on the genetic- and residual-variance components</p>
      </caption>
      <graphic xlink:href="btaa199f1"/>
    </fig>
    <p>In comparison, for MLA approaches, we have the two possibilities.
</p>
    <list list-type="roman-lower">
      <list-item>
        <p><italic>Smoothing at phenotype level</italic>: fits a linear or non-linear function over phenotypes, and then estimates latent-trait heritability for trend parameters (e.g. intercepts, slopes), by either using univariate or multivariate methods (see e.g. <xref rid="btaa199-B12" ref-type="bibr">Gee <italic>et al.</italic>, 2003</xref>; <xref rid="btaa199-B21" ref-type="bibr">Heuven and Janss, 2010</xref>; <xref rid="btaa199-B27" ref-type="bibr">Li <italic>et al.</italic>, 2014</xref>; <xref rid="btaa199-B44" ref-type="bibr">Sillanpää <italic>et al.</italic>, 2012</xref>).</p>
      </list-item>
      <list-item>
        <p><italic>Smoothing at quantitative trait locus (QTL) effect level</italic>: fits a linear or non-linear function over time to QTL effects. In particular, these methods have been developed for QTL mapping of function-valued traits, but can also be applied for SNP-heritability estimation. Examples are varying-coefficient models, such as <xref rid="btaa199-B25" ref-type="bibr">Li and Sillanpää (2013)</xref> and <xref rid="btaa199-B47" ref-type="bibr">Vanhatalo <italic>et al.</italic> (2019)</xref>. Considering the residual covariance structure in these models is recommended.</p>
      </list-item>
    </list>
    <p>Dynamic modelling of biological phenomena can be beneficial for a number of reasons. For instance, by improving the precision of the estimation (<xref rid="btaa199-B25" ref-type="bibr">Li and Sillanpää, 2013</xref>). This is due to the simple fact that, as with any statistical modelling, a larger dataset leads to increased precision, and naturally the amount of data increases with the number of measurement points. More importantly, if the nature of a phenomenon is dynamic, it is only rational to model the phenomenon dynamically and exploiting information content over time. Finally, there is a heated debate around heritability estimation as to why the current analysis methods are leading to a noticeable gap (known as missing heritability) between heritability estimates from SNP and pedigree/twin data (see e.g. <xref rid="btaa199-B8" ref-type="bibr">Eichler <italic>et al.</italic>, 2010</xref>; <xref rid="btaa199-B14" ref-type="bibr">Gibson, 2012</xref>; <xref rid="btaa199-B51" ref-type="bibr">Young, 2019</xref>). One important contributor to this is the time-dependent nature of heritability, which our method aims to address.</p>
    <p>One way to induce smoothing in the model (to model dynamic phenomena) is given by Gaussian processes (GPs). These are random processes whose degree of smoothness can be controlled by varying a set of parameters. In particular, they are appealing because of their analytical properties: with certain conjugacy structure the end result is given as an easy-to-calculate formula (<xref rid="btaa199-B37" ref-type="bibr">Rasmussen and Williams, 2006</xref>). Furthermore, GPs have been successfully utilized in genetics before, e.g. by <xref rid="btaa199-B47" ref-type="bibr">Vanhatalo <italic>et al.</italic> (2019)</xref>, where associations between molecular markers and function-valued traits were studied. Also, the idea of using GPs in modelling dynamic biological processes is not new. For example, Pletcher and Geyer (1999) and <xref rid="btaa199-B22" ref-type="bibr">Jaffrézic and Pletcher (2000)</xref> suggested that the genetic breeding values and environmental terms of the phenotype in LMM could be viewed as GPs. They also considered multivariate phenotypes by modelling the covariance function of a process through a parametric representation, which reduces the number of parameters in the model. In fact, this approach differs from ours, because we view the variance components of the LMM as GPs, which is similar to <xref rid="btaa199-B17" ref-type="bibr">He <italic>et al.</italic> (2016</xref>, <xref rid="btaa199-B18" ref-type="bibr">2017</xref>), where variance processes were modelled with splines.</p>
    <p>In this article, we specifically consider the Bayesian framework of statistical modelling. This means that the statistical inference is not only based on the measurement data and the statistical model but also on prior assumptions and information about the subject (<xref rid="btaa199-B13" ref-type="bibr">Gelman <italic>et al.</italic>, 2013</xref>). For example, a common assumption in many research fields about dynamic processes is given by their smoothness, i.e. values at neighbouring time points are expected to be closer than at time points further apart. To estimate the parameters in Bayesian models, it is common to use Markov Chain Monte Carlo (MCMC) simulation methods (<xref rid="btaa199-B38" ref-type="bibr">Robert and Casella, 2009</xref>), but since GP models usually have a high number of highly correlated parameters, efficient MCMC sampling is difficult. Thus, in addition to the traditional Metropolis–Hastings (MH) algorithm, we use the state-of-the-art method of elliptical slice sampling (<xref rid="btaa199-B33" ref-type="bibr">Murray <italic>et al.</italic>, 2010</xref>), which has shown to perform well in GP models.</p>
    <p>In addition to dynamic heritability estimation, the aim of this article is to illustrate the difference in the uncertainty of the estimates of joint and independent modelling of dependent traits. If a trait is measured longitudinally over time, the different measurements can be thought as individual traits. If there is dependence between traits, it makes sense to model them jointly. This dependence can be viewed as increased sample size because the value of one trait affects the value of the other.</p>
    <p>This article is organized as follows: In Section 2, we present our proposed model for dynamic heritability estimation based on GPs. In addition, we introduce a two-stage method that is used as a baseline. In Section 3, we evaluate our method with two simulated and two real datasets and compare with a random regression model (RRM) implemented with MTG2 (<xref rid="btaa199-B24" ref-type="bibr">Lee and van der Werf, 2016</xref>) and BLUPF90 (<xref rid="btaa199-B28" ref-type="bibr">Misztal <italic>et al.</italic>, 2002</xref>) software and ACEt R-package for estimating dynamic heritability (<xref rid="btaa199-B18" ref-type="bibr">He <italic>et al.</italic>, 2017</xref>). In Section 4, we examine the obtained results, followed by a discussion in Section 5.</p>
  </sec>
  <sec>
    <title>2 Materials and methods</title>
    <p>We will address the dynamic estimation of heritability by two methods, a joint estimation and a separated two-stage approach which serves to illustrate why joint modelling is beneficial. Specifically, the two-stage method first estimates the posterior means of the variance components and their credible intervals at every time point individually and subsequently combines the obtained estimates into smooth curves.</p>
    <p>All models in this study are extensions of the basic LMM, defined as (<xref rid="btaa199-B19" ref-type="bibr">Henderson, 1984</xref>).
<disp-formula id="E1"><label>(1)</label><mml:math id="M1"><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mo>=</mml:mo><mml:mtext mathvariant="bold">X</mml:mtext><mml:mo mathvariant="bold">β</mml:mo><mml:mo>+</mml:mo><mml:mtext mathvariant="bold-italic">Zu</mml:mtext><mml:mo>+</mml:mo><mml:mi>ϵ</mml:mi><mml:mo>,</mml:mo></mml:math></disp-formula>where <inline-formula id="IE1"><mml:math id="IM1"><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mo>ℝ</mml:mo><mml:mi>N</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula> is a measurement vector, <bold><italic>X</italic></bold> is a matrix of fixed effects, <inline-formula id="IE2"><mml:math id="IM2"><mml:mi mathvariant="bold-italic">β</mml:mi></mml:math></inline-formula> contains the regression coefficients associated with them and <italic>N</italic> is the number of individuals. The matrix <bold><italic>Z</italic></bold> (in this case <inline-formula id="IE3"><mml:math id="IM3"><mml:mrow><mml:mi mathvariant="bold-italic">Z</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="bold-italic">I</mml:mi></mml:mrow></mml:math></inline-formula>) connects random effects <inline-formula id="IE4"><mml:math id="IM4"><mml:mrow><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mo>ℝ</mml:mo><mml:mi>N</mml:mi></mml:msup><mml:mo>∼</mml:mo><mml:mi mathvariant="script">N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>0</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mo>σ</mml:mo><mml:mi>G</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mi mathvariant="bold-italic">G</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> with correct individuals. Here, <inline-formula id="IE5"><mml:math id="IM5"><mml:mrow><mml:msubsup><mml:mo>σ</mml:mo><mml:mi>G</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></inline-formula> is the genetic variance and <bold><italic>G</italic></bold> is the genomic relationship matrix (defined in detail below). Lastly, <inline-formula id="IE6"><mml:math id="IM6"><mml:mrow><mml:mi>ϵ</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mo>ℝ</mml:mo><mml:mi>N</mml:mi></mml:msup><mml:mo>∼</mml:mo><mml:mi mathvariant="script">N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>0</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mo>σ</mml:mo><mml:mi>E</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mi mathvariant="bold-italic">I</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is the error term. Since we do not have any fixed effects, we can express the centred measurement vector as <inline-formula id="IE7"><mml:math id="IM7"><mml:msub><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mo>+</mml:mo><mml:mi>ϵ</mml:mi></mml:math></inline-formula>. We note that the overall covariance matrix of <inline-formula id="IE8"><mml:math id="IM8"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> can be written as <inline-formula id="IE9"><mml:math id="IM9"><mml:mrow><mml:mi mathvariant="bold-italic">K</mml:mi><mml:mo>=</mml:mo><mml:msubsup><mml:mo>σ</mml:mo><mml:mi>G</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mi mathvariant="bold-italic">G</mml:mi><mml:mo>+</mml:mo><mml:msubsup><mml:mo>σ</mml:mo><mml:mi>E</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mi mathvariant="bold-italic">I</mml:mi></mml:mrow></mml:math></inline-formula>. Narrow-sense heritability is then defined as <inline-formula id="IE10"><mml:math id="IM10"><mml:mrow><mml:msup><mml:mi>h</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>=</mml:mo><mml:msubsup><mml:mo>σ</mml:mo><mml:mi>G</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>/</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mo>σ</mml:mo><mml:mi>G</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mo>σ</mml:mo><mml:mi>E</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>.</p>
    <sec>
      <title>2.1 Genomic relationship matrix</title>
      <p>To separate the genetic and environmental variance components, knowledge of the genetic relations between individuals is needed. A genomic relationship matrix can be estimated from molecular marker data. <xref rid="btaa199-B48" ref-type="bibr">VanRaden (2008)</xref> describes the procedure of constructing such a matrix. First, let <bold><italic>M</italic></bold> be an <italic>N </italic>×<italic> M</italic> genotype matrix where <italic>N</italic> is the number of individuals and <italic>M</italic> is the number of markers. The elements in <bold><italic>M</italic></bold> are coded as <inline-formula id="IE11"><mml:math id="IM11"><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> for homozygote, heterozygote and the other homozygote, respectively. Second, let <italic>p<sub>i</sub></italic> be the allele frequency of the second allele at locus <italic>i</italic>. Then, we construct a matrix <bold><italic>P</italic></bold> with the same dimensions as <bold><italic>M</italic></bold> and set the <italic>i</italic>th column of <bold><italic>P</italic></bold> to <inline-formula id="IE12"><mml:math id="IM12"><mml:mrow><mml:mn>2</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mn>0.5</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. Let <inline-formula id="IE13"><mml:math id="IM13"><mml:mrow><mml:mi mathvariant="bold-italic">Q</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="bold-italic">M</mml:mi><mml:mo>−</mml:mo><mml:mi mathvariant="bold-italic">P</mml:mi></mml:mrow></mml:math></inline-formula>. Finally, we can construct a genomic relationship matrix as:
<disp-formula id="E2"><label>(2)</label><mml:math id="M2"><mml:mi mathvariant="bold-italic">G</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo mathvariant="bold">Q</mml:mo><mml:mo mathvariant="bold">Q</mml:mo><mml:mo>′</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msub><mml:mo>∑</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:math></disp-formula></p>
      <p>To reduce the estimation error, we used a shrinkage estimated version of this matrix, defined in detail by <xref rid="btaa199-B10" ref-type="bibr">Endelman and Jannink (2012)</xref> and implemented in the R-package rrBLUP (<xref rid="btaa199-B9" ref-type="bibr">Endelman, 2011</xref>). We note that the estimated genomic relationship matrix <bold><italic>G</italic></bold> is positive-semidefinite and hence might not be invertible. However, for our model formulation, this will not be a problem. This is due to the fact that we always add positive values to the diagonal of the matrix; see matrix <bold>K </bold>above.</p>
    </sec>
    <sec>
      <title>2.2 Joint model over time points</title>
      <p>To extend the model (1) to the case of longitudinal data, we can use the Kronecker product denoted by ⊗. The extended model defines a probability distribution for a data vector <inline-formula id="IE14"><mml:math id="IM14"><mml:msub><mml:mover accent="true"><mml:mtext mathvariant="bold">y</mml:mtext><mml:mo>~</mml:mo></mml:mover><mml:mi>c</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mo>[</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo><mml:mo>…</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>)</mml:mo><mml:mo>]</mml:mo><mml:mo>′</mml:mo></mml:math></inline-formula> that can be written as
<disp-formula id="E3"><label>(3)</label><mml:math id="M3"><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mi>c</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mover accent="true"><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mo>+</mml:mo><mml:mover accent="true"><mml:mi>ϵ</mml:mi><mml:mo mathvariant="bold">~</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mi>c</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mi>ϵ</mml:mi><mml:mo mathvariant="bold">~</mml:mo></mml:mover><mml:mo>∈</mml:mo><mml:msup><mml:mo mathvariant="double-struck">ℝ</mml:mo><mml:mrow><mml:mi>N</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:msup></mml:math></disp-formula>where <inline-formula id="IE15"><mml:math id="IM15"><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mo stretchy="false">˜</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>…</mml:mo><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">]</mml:mo><mml:mo>′</mml:mo><mml:mo>∼</mml:mo><mml:mi mathvariant="script">N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mtext>diag</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mo>σ</mml:mo><mml:mi>G</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mo>σ</mml:mo><mml:mi>G</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>⊗</mml:mo><mml:mi mathvariant="bold-italic">G</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> contains all breeding values and <inline-formula id="IE16"><mml:math id="IM16"><mml:mover accent="true"><mml:mi>ϵ</mml:mi><mml:mo mathvariant="bold">~</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mo>[</mml:mo><mml:mi>ϵ</mml:mi><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo><mml:mo>…</mml:mo><mml:mi>ϵ</mml:mi><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>)</mml:mo><mml:mo>]</mml:mo><mml:mo>′</mml:mo><mml:mo>~</mml:mo><mml:mi mathvariant="script">N</mml:mi><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mtext>diag</mml:mtext><mml:mo>(</mml:mo><mml:msubsup><mml:mo>σ</mml:mo><mml:mi>E</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mo>σ</mml:mo><mml:mi>E</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>)</mml:mo><mml:mo>)</mml:mo><mml:mo>⊗</mml:mo><mml:mi mathvariant="bold-italic">I</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula> contains all error terms from individual time points consecutively and <italic>T</italic> is the number of time points. The overall covariance matrix for <inline-formula id="IE17"><mml:math id="IM17"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mo stretchy="false">˜</mml:mo></mml:mover></mml:mrow><mml:mi>c</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> can be written as <inline-formula id="IE18"><mml:math id="IM18"><mml:mover accent="true"><mml:mtext mathvariant="bold">K</mml:mtext><mml:mo mathvariant="bold">~</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mtext>diag</mml:mtext><mml:mo>(</mml:mo><mml:msubsup><mml:mo>σ</mml:mo><mml:mi>G</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mo>σ</mml:mo><mml:mi>G</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>)</mml:mo><mml:mo>)</mml:mo><mml:mo>⊗</mml:mo><mml:mi mathvariant="bold-italic">G</mml:mi><mml:mo>+</mml:mo><mml:mtext>diag</mml:mtext><mml:mo>(</mml:mo><mml:msubsup><mml:mo>σ</mml:mo><mml:mi>E</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mo>σ</mml:mo><mml:mi>E</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>)</mml:mo><mml:mo>)</mml:mo><mml:mo>⊗</mml:mo><mml:mi mathvariant="bold-italic">I</mml:mi></mml:math></inline-formula>. The variance component vectors can now be estimated with a Bayesian approach by setting suitable priors for them. It is worth noting that this model structure implies that all covariances across time (within and between individuals) are ignored. For the rapid performance of the algorithm, this assumption is crucial. It is in the priors of the variance component vectors where we assume dependence over time (see <xref ref-type="fig" rid="btaa199-F1">Fig. 1</xref>, bottom panel). This is a fundamental difference compared with for example Pletcher and Geyer (1999) who model the dependence on the level of breeding values. The idea behind our assumption is that the dependence of neighbouring trait values induces dependence on the variance level.</p>
      <p>The priors are based on assumptions about the qualitative features of the variance component functions, namely their continuity and smoothness. Due to the aforementioned reasons, we assume that the variance values at neighbouring time points are on average closer than at time points further apart. To formulate such assumptions mathematically, one can use GPs, fully defined by a mean function and a covariance function (<xref rid="btaa199-B37" ref-type="bibr">Rasmussen and Williams, 2006</xref>). We write <inline-formula id="IE19"><mml:math id="IM19"><mml:mrow><mml:mtext>log</mml:mtext><mml:mo> </mml:mo><mml:mo>⁡</mml:mo><mml:msubsup><mml:mo>σ</mml:mo><mml:mi>G</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>∼</mml:mo><mml:mi mathvariant="script">G</mml:mi><mml:mi mathvariant="script">P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mi>G</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>′</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE20"><mml:math id="IM20"><mml:mrow><mml:mtext>log</mml:mtext><mml:mo> </mml:mo><mml:mo>⁡</mml:mo><mml:msubsup><mml:mo>σ</mml:mo><mml:mi>E</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>∼</mml:mo><mml:mi mathvariant="script">G</mml:mi><mml:mi mathvariant="script">P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mi>E</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>′</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, where <inline-formula id="IE21"><mml:math id="IM21"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mi>G</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>′</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mtext>cov</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mtext>log</mml:mtext><mml:mo> </mml:mo><mml:mo>⁡</mml:mo><mml:msubsup><mml:mo>σ</mml:mo><mml:mi>G</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mtext>log</mml:mtext><mml:mo> </mml:mo><mml:mo>⁡</mml:mo><mml:msubsup><mml:mo>σ</mml:mo><mml:mi>G</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>′</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE22"><mml:math id="IM22"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mi>E</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>′</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mtext>cov</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mtext>log</mml:mtext><mml:mo> </mml:mo><mml:mo>⁡</mml:mo><mml:msubsup><mml:mo>σ</mml:mo><mml:mi>E</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mtext>log</mml:mtext><mml:mo> </mml:mo><mml:mo>⁡</mml:mo><mml:msubsup><mml:mo>σ</mml:mo><mml:mi>E</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>′</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. Logarithms are used to allow negative values for the processes and the zero mean can be achieved approximately by suitable translation of the data. For <italic>C<sub>G</sub></italic> and <italic>C<sub>E</sub></italic>, we use the Matérn covariance function, given by
<disp-formula id="E4"><label>(4)</label><mml:math id="M4"><mml:mrow><mml:mi>C</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>′</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msup><mml:mo>τ</mml:mo><mml:mn>2</mml:mn></mml:msup><mml:mfrac><mml:mrow><mml:msup><mml:mn>2</mml:mn><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mo>ν</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mo>Γ</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mo>ν</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mo>|</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>|</mml:mo></mml:mrow><mml:mo>λ</mml:mo></mml:mfrac></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow><mml:mo>ν</mml:mo></mml:msup><mml:msub><mml:mi>K</mml:mi><mml:mo>ν</mml:mo></mml:msub><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mo>|</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mi>t</mml:mi><mml:mo>′</mml:mo><mml:mo>|</mml:mo></mml:mrow><mml:mo>λ</mml:mo></mml:mfrac></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <inline-formula id="IE23"><mml:math id="IM23"><mml:mrow><mml:msup><mml:mo>τ</mml:mo><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula> is the magnitude parameter that controls the overall variance of the stochastic process, <italic>λ</italic> is the length scale that governs how fast the covariance drops with respect to the distance of time points, <inline-formula id="IE24"><mml:math id="IM24"><mml:mrow><mml:mo>Γ</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mo>·</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> denotes the gamma function and <inline-formula id="IE25"><mml:math id="IM25"><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mo>ν</mml:mo></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mo>·</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> the modified Bessel function of the second kind. The value of <italic>ν</italic> controls the mean-square differentiability of the process, which affects its smoothness. We note that for <inline-formula id="IE26"><mml:math id="IM26"><mml:mrow><mml:mo>ν</mml:mo><mml:mo>=</mml:mo><mml:mn>0.5</mml:mn><mml:mo>,</mml:mo><mml:mn>1.5</mml:mn><mml:mo>,</mml:mo><mml:mn>2.5</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo></mml:mrow></mml:math></inline-formula>, there exists a simple form for the covariance function. In this study, we fix <inline-formula id="IE27"><mml:math id="IM27"><mml:mrow><mml:mo>ν</mml:mo><mml:mo>=</mml:mo><mml:mn>1.5</mml:mn></mml:mrow></mml:math></inline-formula>, which means that a sample process is once mean-square differentiable and we obtain
<disp-formula id="E5"><label>(5)</label><mml:math id="M5"><mml:msub><mml:mi>C</mml:mi><mml:mn>1.5</mml:mn></mml:msub><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>′</mml:mo><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:msup><mml:mo>τ</mml:mo><mml:mn>2</mml:mn></mml:msup><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mo>|</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mi>t</mml:mi><mml:mo>′</mml:mo><mml:mo>|</mml:mo></mml:mrow><mml:mo>λ</mml:mo></mml:mfrac><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mtext>exp</mml:mtext><mml:mo> </mml:mo><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mo>|</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mi>t</mml:mi><mml:mo>′</mml:mo><mml:mo>|</mml:mo></mml:mrow><mml:mo>λ</mml:mo></mml:mfrac><mml:mo stretchy="true">)</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p>
      <p>This means the process is rather smooth, but it is also allowed to change rapidly (<xref rid="btaa199-B37" ref-type="bibr">Rasmussen and Williams, 2006</xref>).</p>
      <p>A common problem with GPs is determining values for the hyperparameters <inline-formula id="IE28"><mml:math id="IM28"><mml:mrow><mml:msup><mml:mo>τ</mml:mo><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula> and <italic>λ</italic>. In the Bayesian framework, one can set up separate priors for each and estimate them together with the other unknowns using MCMC. However, it is known that identifiability issues arise when simultaneously estimating both hyperparameters (<xref rid="btaa199-B53" ref-type="bibr">Zhang, 2004</xref>). Thus, it is common to fix one of them. In our case, we fix <inline-formula id="IE29"><mml:math id="IM29"><mml:mrow><mml:msup><mml:mo>τ</mml:mo><mml:mn>2</mml:mn></mml:msup><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> and scale the data so that the mean of the overall variance over time points equals 2. This means the mean of the environmental and genetic variance over time points is 1 if they are equal.</p>
      <p>Because our GP model is non-parametric, we have to discretize the time axis and define a grid of points where we estimate the variance components. For simplicity, we estimate the variance components at the same locations the measurements were taken. This means that the covariance function <inline-formula id="IE30"><mml:math id="IM30"><mml:mrow><mml:mi>C</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>·</mml:mo><mml:mo>,</mml:mo><mml:mo>·</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> becomes a covariance matrix <bold><italic>C</italic></bold>. Then we have for each element in the matrix that <inline-formula id="IE31"><mml:math id="IM31"><mml:mrow><mml:msub><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>C</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:mi>C</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. We note that a covariance matrix defined this way is dense and computationally heavy to operate with. Hence, we use a sparse approximation for the inverse of the covariance matrix (<xref rid="btaa199-B41" ref-type="bibr">Roininen <italic>et al.</italic>, 2014</xref>), discussed in more detail in the <xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref>.</p>
      <p>The model can be written in hierarchical form as
<disp-formula id="E6"><label>(6)</label><mml:math id="M6"><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mover accent="true"><mml:mtext mathvariant="bold">y</mml:mtext><mml:mo>~</mml:mo></mml:mover><mml:mi mathvariant="bold-italic">c</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:msubsup><mml:mi mathvariant="bold-italic">σ</mml:mi><mml:mi>E</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi mathvariant="bold-italic">σ</mml:mi><mml:mi>G</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mtd><mml:mtd><mml:mo>~</mml:mo><mml:mi mathvariant="script">N</mml:mi><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mtext mathvariant="bold">K</mml:mtext><mml:mo>~</mml:mo></mml:mover><mml:mo>)</mml:mo><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo> </mml:mo><mml:mtext>log</mml:mtext><mml:mo> </mml:mo><mml:mo>⁡</mml:mo><mml:msubsup><mml:mi mathvariant="bold-italic">σ</mml:mi><mml:mi>E</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>|</mml:mo><mml:msub><mml:mo>λ</mml:mo><mml:mi>E</mml:mi></mml:msub></mml:mtd><mml:mtd><mml:mo>~</mml:mo><mml:mi mathvariant="script">N</mml:mi><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">C</mml:mi><mml:mi>E</mml:mi></mml:msub><mml:mo>)</mml:mo><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo> </mml:mo><mml:mtext>log</mml:mtext><mml:mo> </mml:mo><mml:mo>⁡</mml:mo><mml:msubsup><mml:mi mathvariant="bold-italic">σ</mml:mi><mml:mi>G</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>|</mml:mo><mml:msub><mml:mo>λ</mml:mo><mml:mi>G</mml:mi></mml:msub></mml:mtd><mml:mtd><mml:mo>~</mml:mo><mml:mi mathvariant="script">N</mml:mi><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">C</mml:mi><mml:mi>G</mml:mi></mml:msub><mml:mo>)</mml:mo><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo> </mml:mo><mml:mtext>log</mml:mtext><mml:mo> </mml:mo><mml:mo>⁡</mml:mo><mml:msub><mml:mo>λ</mml:mo><mml:mi>E</mml:mi></mml:msub></mml:mtd><mml:mtd><mml:mo>~</mml:mo><mml:mi mathvariant="script">N</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mo>μ</mml:mo><mml:mo>λ</mml:mo></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mo>ζ</mml:mo><mml:mo>λ</mml:mo><mml:mn>2</mml:mn></mml:msubsup><mml:mo>)</mml:mo><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo> </mml:mo><mml:mtext>log</mml:mtext><mml:mo> </mml:mo><mml:mo>⁡</mml:mo><mml:msub><mml:mo>λ</mml:mo><mml:mi>G</mml:mi></mml:msub></mml:mtd><mml:mtd><mml:mo>~</mml:mo><mml:mi mathvariant="script">N</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mo>μ</mml:mo><mml:mo>λ</mml:mo></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mo>ζ</mml:mo><mml:mo>λ</mml:mo><mml:mn>2</mml:mn></mml:msubsup><mml:mo>)</mml:mo><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula></p>
      <p>By Bayes’ formula, the unnormalized posterior density can be expressed as
<disp-formula id="E7"><mml:math id="M7"><mml:mtable><mml:mtr><mml:mtd><mml:mi>p</mml:mi><mml:mo>(</mml:mo><mml:msubsup><mml:mi mathvariant="bold-italic">σ</mml:mi><mml:mi>G</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi mathvariant="bold-italic">σ</mml:mi><mml:mi>E</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>,</mml:mo><mml:msub><mml:mo>λ</mml:mo><mml:mi>E</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mo>λ</mml:mo><mml:mi>G</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mover accent="true"><mml:mtext mathvariant="bold">y</mml:mtext><mml:mo mathvariant="bold">~</mml:mo></mml:mover><mml:mi>c</mml:mi></mml:msub><mml:mo>)</mml:mo><mml:mo>∝</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>p</mml:mi><mml:mi mathvariant="script">N</mml:mi></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mover accent="true"><mml:mtext mathvariant="bold">y</mml:mtext><mml:mo mathvariant="bold">~</mml:mo></mml:mover><mml:mi>c</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mo>0</mml:mo><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mtext mathvariant="bold">K</mml:mtext><mml:mo>~</mml:mo></mml:mover><mml:mo>)</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi mathvariant="script">N</mml:mi></mml:msub><mml:mo>(</mml:mo><mml:mtext>log</mml:mtext><mml:mo> </mml:mo><mml:mo>⁡</mml:mo><mml:msubsup><mml:mi mathvariant="bold-italic">σ</mml:mi><mml:mi>G</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>|</mml:mo><mml:mo>0</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">C</mml:mi><mml:mi>G</mml:mi></mml:msub><mml:mo>)</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi mathvariant="script">N</mml:mi></mml:msub><mml:mo>(</mml:mo><mml:mtext>log</mml:mtext><mml:mo> </mml:mo><mml:mo>⁡</mml:mo><mml:msubsup><mml:mi mathvariant="bold-italic">σ</mml:mi><mml:mi>E</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>|</mml:mo><mml:mo>0</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">C</mml:mi><mml:mi>E</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>p</mml:mi><mml:mi mathvariant="script">N</mml:mi></mml:msub><mml:mo>(</mml:mo><mml:mtext>log</mml:mtext><mml:mo> </mml:mo><mml:mo>⁡</mml:mo><mml:msub><mml:mo>λ</mml:mo><mml:mi>E</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mo>μ</mml:mo><mml:mo>λ</mml:mo></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mo>ζ</mml:mo><mml:mo>λ</mml:mo><mml:mn>2</mml:mn></mml:msubsup><mml:mo>)</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi mathvariant="script">N</mml:mi></mml:msub><mml:mo>(</mml:mo><mml:mtext>log</mml:mtext><mml:mo> </mml:mo><mml:mo>⁡</mml:mo><mml:msub><mml:mo>λ</mml:mo><mml:mi>G</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mo>μ</mml:mo><mml:mo>λ</mml:mo></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mo>ζ</mml:mo><mml:mo>λ</mml:mo><mml:mn>2</mml:mn></mml:msubsup><mml:mo>)</mml:mo><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula>where <inline-formula id="IE32"><mml:math id="IM32"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi mathvariant="script">N</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> refers to the multinormal density.</p>
      <p>In practice, with this parameterization, we observed poor mixing of the hyperparameter chains. Hence, we employed whitening (<xref rid="btaa199-B29" ref-type="bibr">Monterrubio-Gómez <italic>et al.</italic>, 2020</xref>; <xref rid="btaa199-B32" ref-type="bibr">Murray and Adams, 2010</xref>; <xref rid="btaa199-B52" ref-type="bibr">Yu and Meng, 2011</xref>), which breaks the dependencies of the variance component processes and corresponding hyperparameters under the prior. We first note that the logarithmized variance component processes can be expressed as <inline-formula id="IE33"><mml:math id="IM33"><mml:mrow><mml:mtext>log</mml:mtext><mml:mo> </mml:mo><mml:mo>⁡</mml:mo><mml:msubsup><mml:mi mathvariant="bold-italic">σ</mml:mi><mml:mi>E</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi mathvariant="bold-italic">C</mml:mi><mml:mi>E</mml:mi><mml:mrow><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:msubsup><mml:msub><mml:mi mathvariant="bold-italic">η</mml:mi><mml:mi>E</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE34"><mml:math id="IM34"><mml:mrow><mml:mtext>log</mml:mtext><mml:mo> </mml:mo><mml:mo>⁡</mml:mo><mml:msubsup><mml:mi mathvariant="bold-italic">σ</mml:mi><mml:mi>G</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi mathvariant="bold-italic">C</mml:mi><mml:mi>G</mml:mi><mml:mrow><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:msubsup><mml:msub><mml:mi mathvariant="bold-italic">η</mml:mi><mml:mi>G</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, where <inline-formula id="IE35"><mml:math id="IM35"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">η</mml:mi><mml:mi>E</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE36"><mml:math id="IM36"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">η</mml:mi><mml:mi>G</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> are both standard multivariate normally distributed. The matrix square roots are obtained straightforwardly through the approximations (see <xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref>). Instead of <inline-formula id="IE37"><mml:math id="IM37"><mml:mrow><mml:mtext>log</mml:mtext><mml:mo> </mml:mo><mml:mo>⁡</mml:mo><mml:msubsup><mml:mi mathvariant="bold-italic">σ</mml:mi><mml:mi>E</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE38"><mml:math id="IM38"><mml:mrow><mml:mtext>log</mml:mtext><mml:mo> </mml:mo><mml:mo>⁡</mml:mo><mml:msubsup><mml:mi mathvariant="bold-italic">σ</mml:mi><mml:mi>G</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></inline-formula>, we now sample <inline-formula id="IE39"><mml:math id="IM39"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">η</mml:mi><mml:mi>E</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE40"><mml:math id="IM40"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">η</mml:mi><mml:mi>G</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>. The reparametrization corresponds to the following posterior density
<disp-formula id="E8"><mml:math id="M8"><mml:mtable><mml:mtr><mml:mtd><mml:mi>p</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">η</mml:mi><mml:mi>G</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">η</mml:mi><mml:mi>E</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mo>λ</mml:mo><mml:mi>E</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mo>λ</mml:mo><mml:mi>G</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mover accent="true"><mml:mtext mathvariant="bold">y</mml:mtext><mml:mo>~</mml:mo></mml:mover><mml:mi>c</mml:mi></mml:msub><mml:mo>)</mml:mo><mml:mo>∝</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi mathvariant="script">N</mml:mi></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mover accent="true"><mml:mtext>y</mml:mtext><mml:mo>~</mml:mo></mml:mover><mml:mi>c</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mo>0</mml:mo><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mtext mathvariant="bold">K</mml:mtext><mml:mo mathvariant="bold">~</mml:mo></mml:mover><mml:mo>)</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi mathvariant="script">N</mml:mi></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">η</mml:mi><mml:mi>G</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mo>0</mml:mo><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">I</mml:mi><mml:mo>)</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi mathvariant="script">N</mml:mi></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">η</mml:mi><mml:mi>E</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mo>0</mml:mo><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">I</mml:mi><mml:mo>)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>p</mml:mi><mml:mi mathvariant="script">N</mml:mi></mml:msub><mml:mo>(</mml:mo><mml:mtext>log</mml:mtext><mml:mo> </mml:mo><mml:mo>⁡</mml:mo><mml:msub><mml:mo>λ</mml:mo><mml:mi>E</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mo>μ</mml:mo><mml:mo>λ</mml:mo></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mo>ζ</mml:mo><mml:mo>λ</mml:mo><mml:mn>2</mml:mn></mml:msubsup><mml:mo>)</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi mathvariant="script">N</mml:mi></mml:msub><mml:mo>(</mml:mo><mml:mtext>log</mml:mtext><mml:mo> </mml:mo><mml:mo>⁡</mml:mo><mml:msub><mml:mo>λ</mml:mo><mml:mi>G</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mo>μ</mml:mo><mml:mo>λ</mml:mo></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mo>ζ</mml:mo><mml:mo>λ</mml:mo><mml:mn>2</mml:mn></mml:msubsup><mml:mo>)</mml:mo><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula> where <disp-formula id="E9"><mml:math id="M9"><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">K</mml:mi><mml:mo stretchy="true">˜</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mtext>diag</mml:mtext><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mtext>exp</mml:mtext><mml:mo> </mml:mo><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="true">{</mml:mo><mml:mrow><mml:msubsup><mml:mi mathvariant="bold-italic">C</mml:mi><mml:mi>G</mml:mi><mml:mrow><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:msubsup><mml:msub><mml:mi mathvariant="bold-italic">η</mml:mi><mml:mi>G</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="true">}</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo>⊗</mml:mo><mml:mi mathvariant="bold-italic">G</mml:mi><mml:mo>+</mml:mo><mml:mtext>diag</mml:mtext><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mtext>exp</mml:mtext><mml:mo> </mml:mo><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="true">{</mml:mo><mml:mrow><mml:msubsup><mml:mi mathvariant="bold-italic">C</mml:mi><mml:mi>E</mml:mi><mml:mrow><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:msubsup><mml:msub><mml:mi mathvariant="bold-italic">η</mml:mi><mml:mi>E</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="true">}</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo>⊗</mml:mo><mml:mi mathvariant="bold-italic">I</mml:mi></mml:mrow><mml:mo>.</mml:mo></mml:math></disp-formula></p>
      <p>The hyperparameters <inline-formula id="IE41"><mml:math id="IM41"><mml:mrow><mml:msub><mml:mo>μ</mml:mo><mml:mo>λ</mml:mo></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE42"><mml:math id="IM42"><mml:mrow><mml:msubsup><mml:mo>ζ</mml:mo><mml:mo>λ</mml:mo><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></inline-formula> are set by following <xref rid="btaa199-B29" ref-type="bibr">Monterrubio-Gómez <italic>et al.</italic> (2020)</xref>. In particular, it is based on the idea that the length scale is identifiable between the smallest and largest distance between two time points, say <inline-formula id="IE43"><mml:math id="IM43"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula>. Hence we want to place most of its prior probability mass in that interval. By using the quantile function of a standard normal distribution, we can assign ∼95% of the prior mass between the interval by solving the following system of equations:
<disp-formula id="E10"><label>(7)</label><mml:math id="M10"><mml:mrow><mml:mtable><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mo>μ</mml:mo><mml:mo>λ</mml:mo></mml:msub><mml:mo>−</mml:mo><mml:mn>1.96</mml:mn><mml:msub><mml:mo>ζ</mml:mo><mml:mo>λ</mml:mo></mml:msub></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mtext>log</mml:mtext><mml:mo> </mml:mo><mml:mo>⁡</mml:mo><mml:mi>a</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mo>μ</mml:mo><mml:mo>λ</mml:mo></mml:msub><mml:mo>+</mml:mo><mml:mn>1.96</mml:mn><mml:msub><mml:mo>ζ</mml:mo><mml:mo>λ</mml:mo></mml:msub></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mtext>log</mml:mtext><mml:mo> </mml:mo><mml:mo>⁡</mml:mo><mml:mi>b</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula></p>
      <p>We emphasize that this model specification leaves no tuning parameters to fix prior to estimation which eliminates the need for preliminary analyses and consequently saves plenty of time.</p>
      <sec>
        <title>2.2.1 Parameter estimation in the joint model</title>
        <p>To generate dependent MCMC samples from the posterior distribution of parameters <inline-formula id="IE44"><mml:math id="IM44"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">η</mml:mi><mml:mi>G</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE45"><mml:math id="IM45"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">η</mml:mi><mml:mi>E</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, we use the elliptical slice sampling method (<xref rid="btaa199-B33" ref-type="bibr">Murray <italic>et al.</italic>, 2010</xref>). It is a rejection-free sampling algorithm and we noticed that it does perform better for high-dimensional data (more than 100 time points) than the block-update of MH algorithm. The problem with elliptical slice sampling is that the likelihood must be evaluated multiple times in a single MCMC iteration, making it quite a bit slower than MH. For the length scales, we use MH with Gaussian random walk proposals, i.e. the proposal value is sampled from the distribution <inline-formula id="IE46"><mml:math id="IM46"><mml:mrow><mml:mi mathvariant="script">N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mo>θ</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msubsup><mml:mo>σ</mml:mo><mml:mrow><mml:mtext>RW</mml:mtext></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, where <inline-formula id="IE47"><mml:math id="IM47"><mml:mrow><mml:msup><mml:mo>θ</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> is the current value of the parameter. The variance is adapted following Section 3 in <xref rid="btaa199-B39" ref-type="bibr">Roberts and Rosenthal (2009)</xref> to achieve an acceptance rate of 0.44 which is considered optimal in certain settings. The four parameter subsets (<inline-formula id="IE48"><mml:math id="IM48"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">η</mml:mi><mml:mi>E</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">η</mml:mi><mml:mi>G</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mtext>log</mml:mtext><mml:mo> </mml:mo><mml:mo>⁡</mml:mo><mml:msub><mml:mo>λ</mml:mo><mml:mi>E</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mtext>log</mml:mtext><mml:mo> </mml:mo><mml:mo>⁡</mml:mo><mml:msub><mml:mo>λ</mml:mo><mml:mi>G</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>) are sampled in alternatingly while keeping the other values fixed.</p>
        <p>The computationally most intensive part of the algorithm is the evaluation of the likelihood function, due to the inversion and determinant computation of an <italic>NT</italic> × <italic>NT</italic> covariance matrix. Fortunately, the form of the matrix allows us to utilize some basic linear algebra to make the computations feasible. We start by examining the structure of matrix <inline-formula id="IE49"><mml:math id="IM49"><mml:mrow><mml:mover accent="true"><mml:mtext>K</mml:mtext><mml:mo>˜</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> and note the block diagonal structure where the blocks consist of time point-specific covariance matrices:
<disp-formula id="E11"><mml:math id="M11"><mml:mover accent="true"><mml:mtext mathvariant="bold">K</mml:mtext><mml:mo>~</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="true">[</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:msubsup><mml:mo>σ</mml:mo><mml:mi>G</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo><mml:mi mathvariant="bold-italic">G</mml:mi><mml:mo>+</mml:mo><mml:msubsup><mml:mo>σ</mml:mo><mml:mi>E</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo><mml:mi mathvariant="bold-italic">I</mml:mi></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mo>…</mml:mo></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>⋮</mml:mo></mml:mtd><mml:mtd><mml:mo>⋮</mml:mo></mml:mtd><mml:mtd><mml:mo>⋱</mml:mo></mml:mtd><mml:mtd><mml:mo>⋮</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mo>…</mml:mo></mml:mtd><mml:mtd><mml:msubsup><mml:mo>σ</mml:mo><mml:mi>G</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>)</mml:mo><mml:mi mathvariant="bold-italic">G</mml:mi><mml:mo>+</mml:mo><mml:msubsup><mml:mo>σ</mml:mo><mml:mi>E</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>)</mml:mo><mml:mi mathvariant="bold-italic">I</mml:mi></mml:mtd></mml:mtr></mml:mtable><mml:mo stretchy="true">]</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:math></disp-formula></p>
        <p>This means, we can express the overall log-likelihood function of the parameters as a sum of log-likelihood functions of each time point
<disp-formula id="E12"><label>(8)</label><mml:math id="M12"><mml:mtext>log</mml:mtext><mml:mo> </mml:mo><mml:mo>⁡</mml:mo><mml:mi>p</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mover accent="true"><mml:mtext mathvariant="bold">y</mml:mtext><mml:mo mathvariant="bold">~</mml:mo></mml:mover><mml:mi>c</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mo>0</mml:mo><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mtext mathvariant="bold">K</mml:mtext><mml:mo>~</mml:mo></mml:mover><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>T</mml:mi></mml:msubsup><mml:mo> </mml:mo><mml:mtext>log</mml:mtext><mml:mo> </mml:mo><mml:mo>⁡</mml:mo><mml:mi>p</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mo>|</mml:mo><mml:mo>0</mml:mo><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">K</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mo>)</mml:mo><mml:mo>.</mml:mo></mml:math></disp-formula></p>
        <p>Similarly to <xref rid="btaa199-B78154864" ref-type="bibr">Kang<italic> et al.</italic> (2008</xref>), we can now use eigen decomposition to decorrelate the measurements using a linear transformation to speed up the computations. The covariance matrix of the measurements <inline-formula id="IE50"><mml:math id="IM50"><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> at time <italic>t</italic> can be decomposed as <inline-formula id="IE51"><mml:math id="IM51"><mml:mrow><mml:mi mathvariant="bold-italic">UD</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi mathvariant="bold-italic">U</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:math></inline-formula>, where <bold><italic>U</italic></bold> is the eigenvector matrix of <bold><italic>G</italic></bold> and <inline-formula id="IE52"><mml:math id="IM52"><mml:mrow><mml:mi mathvariant="bold-italic">D</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is a diagonal matrix with <inline-formula id="IE53"><mml:math id="IM53"><mml:mrow><mml:msub><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>D</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mo>σ</mml:mo><mml:mi>G</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mo>ξ</mml:mo><mml:mi>n</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mo>σ</mml:mo><mml:mi>E</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> and <italic>ξ<sub>n</sub></italic> being the eigenvalues of <bold><italic>G</italic></bold>. By the orthogonality of <bold><italic>U</italic></bold>, we have that <inline-formula id="IE54"><mml:math id="IM54"><mml:mtext>var</mml:mtext><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">U</mml:mi><mml:mo>′</mml:mo><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mi mathvariant="bold-italic">U</mml:mi><mml:mo>′</mml:mo><mml:mtext mathvariant="bold">UD</mml:mtext><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mi mathvariant="bold-italic">U</mml:mi><mml:mo>′</mml:mo><mml:mi mathvariant="bold-italic">U</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="bold-italic">D</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula>, implicating that the elements in the transformed measurement vector <inline-formula id="IE55"><mml:math id="IM55"><mml:mrow><mml:mi mathvariant="bold-italic">U</mml:mi><mml:mo>′</mml:mo><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> are independent of each other. This reduces the log-likelihood calculation into a sum. Most importantly, since <bold><italic>U</italic></bold> does not depend on the variance components, the transformation has to be done only once. Setting <inline-formula id="IE56"><mml:math id="IM56"><mml:mrow><mml:mi mathvariant="bold-italic">z</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi mathvariant="bold-italic">U</mml:mi><mml:mo>′</mml:mo><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, the resulting log-likelihood can be written as
<disp-formula id="E13"><label>(9)</label><mml:math id="M13"><mml:mtext>log</mml:mtext><mml:mo> </mml:mo><mml:mo>⁡</mml:mo><mml:mi>p</mml:mi><mml:mo>(</mml:mo><mml:mover accent="true"><mml:mtext mathvariant="bold">y</mml:mtext><mml:mo>~</mml:mo></mml:mover><mml:mo>|</mml:mo><mml:mo>0</mml:mo><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mtext mathvariant="bold">K</mml:mtext><mml:mo>~</mml:mo></mml:mover><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>T</mml:mi></mml:msubsup><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:msubsup><mml:mo> </mml:mo><mml:mtext>log</mml:mtext><mml:mo> </mml:mo><mml:mo>⁡</mml:mo><mml:mi>p</mml:mi><mml:mo>(</mml:mo><mml:mi>z</mml:mi><mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mi>n</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msubsup><mml:mo>σ</mml:mo><mml:mi>G</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:msub><mml:mo>ξ</mml:mo><mml:mi>n</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mo>σ</mml:mo><mml:mi>E</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mo>)</mml:mo><mml:mo>.</mml:mo></mml:math></disp-formula></p>
        <p>The pseudocode for the algorithm can be found in the <xref ref-type="supplementary-material" rid="sup1">Supplementary Algorithm S1</xref>.</p>
      </sec>
    </sec>
    <sec>
      <title>2.3 Two-stage method</title>
      <p>To illustrate the benefits of the joint model, we compare it to a baseline approach. The method consists of two stages: (i) the estimation of posterior means of the variance components and their 95% credible intervals at each time point separately and (ii) combining individual estimates together by smoothing the obtained estimates from stage one. The estimation in stage one is based on the same model as in the joint estimation but for one time point
<disp-formula id="E14"><label>(10)</label><mml:math id="M14"><mml:msub><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:mi>ϵ</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mo>,</mml:mo></mml:math></disp-formula>where <inline-formula id="IE57"><mml:math id="IM57"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> is the centred measurement vector at time <italic>t</italic>, <inline-formula id="IE58"><mml:math id="IM58"><mml:mrow><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>∼</mml:mo><mml:mi mathvariant="script">N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msubsup><mml:mo>σ</mml:mo><mml:mi>G</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi mathvariant="bold-italic">G</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE59"><mml:math id="IM59"><mml:mrow><mml:mi>ϵ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>∼</mml:mo><mml:mi mathvariant="script">N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msubsup><mml:mo>σ</mml:mo><mml:mi>E</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi mathvariant="bold-italic">I</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. As in the joint method, the data are scaled such that the overall variance over time points is 2. The covariance matrix of <inline-formula id="IE60"><mml:math id="IM60"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is <inline-formula id="IE61"><mml:math id="IM61"><mml:mrow><mml:mi mathvariant="bold-italic">K</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msubsup><mml:mo>σ</mml:mo><mml:mi>G</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi mathvariant="bold-italic">G</mml:mi><mml:mo>+</mml:mo><mml:msubsup><mml:mo>σ</mml:mo><mml:mi>E</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi mathvariant="bold-italic">I</mml:mi></mml:mrow></mml:math></inline-formula> and the model can be written as
<disp-formula id="E15"><label>(11)</label><mml:math id="M15"><mml:mrow><mml:mtable><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>∼</mml:mo><mml:mi mathvariant="script">N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">K</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mo> </mml:mo><mml:mtext>log</mml:mtext><mml:mo> </mml:mo><mml:mo>⁡</mml:mo><mml:msubsup><mml:mo>σ</mml:mo><mml:mi>G</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>∼</mml:mo><mml:mi mathvariant="script">N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mo> </mml:mo><mml:mtext>log</mml:mtext><mml:mo> </mml:mo><mml:mo>⁡</mml:mo><mml:msubsup><mml:mo>σ</mml:mo><mml:mi>E</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>∼</mml:mo><mml:mi mathvariant="script">N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula></p>
      <p>We note that this is a special case of the joint model presented earlier, see <xref ref-type="disp-formula" rid="E3">Equation (3)</xref>. Posterior means and 95% credible intervals of the variance components at each time point are obtained from this analysis used in the next stage.</p>
      <p>Smoothing of the variance component curves over time is based on the model
<disp-formula id="E16"><label>(12)</label><mml:math id="M16"><mml:msub><mml:mi mathvariant="bold-italic">y</mml:mi><mml:msup><mml:mo>σ</mml:mo><mml:mn>2</mml:mn></mml:msup></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">f</mml:mi><mml:msup><mml:mo>σ</mml:mo><mml:mn>2</mml:mn></mml:msup></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>ϵ</mml:mi><mml:msup><mml:mo>σ</mml:mo><mml:mn>2</mml:mn></mml:msup></mml:msub><mml:mo>,</mml:mo></mml:math></disp-formula>where <inline-formula id="IE62"><mml:math id="IM62"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mrow><mml:msup><mml:mo>σ</mml:mo><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> contains either logarithmized posterior means, lower 95% credible interval limits or upper 95% credible interval limits estimated in stage one, <inline-formula id="IE63"><mml:math id="IM63"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:msup><mml:mo>σ</mml:mo><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mi mathvariant="script">G</mml:mi><mml:mi mathvariant="script">P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mo>λ</mml:mo></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>′</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is a smooth process and <inline-formula id="IE64"><mml:math id="IM64"><mml:msub><mml:mi>ϵ</mml:mi><mml:msup><mml:mo>σ</mml:mo><mml:mn>2</mml:mn></mml:msup></mml:msub><mml:mo>~</mml:mo><mml:mi mathvariant="script">N</mml:mi><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msup><mml:mo>γ</mml:mo><mml:mn>2</mml:mn></mml:msup><mml:mi mathvariant="bold-italic">I</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula> is an error term. <inline-formula id="IE65"><mml:math id="IM65"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mo>λ</mml:mo></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mo>·</mml:mo><mml:mo>,</mml:mo><mml:mo>·</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is again the Matérn covariance function, defined in <xref ref-type="disp-formula" rid="E5">Equation (5)</xref>. Here, <inline-formula id="IE66"><mml:math id="IM66"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mrow><mml:msup><mml:mo>σ</mml:mo><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is scaled to have mean zero and variance one. After discretization, the model can be written as follows:
<disp-formula id="E17"><label>(13)</label><mml:math id="M17"><mml:mrow><mml:mtable><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mrow><mml:msup><mml:mo>σ</mml:mo><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>∼</mml:mo><mml:mi mathvariant="script">N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">C</mml:mi><mml:mo>λ</mml:mo></mml:msub><mml:mo>+</mml:mo><mml:msup><mml:mo>γ</mml:mo><mml:mn>2</mml:mn></mml:msup><mml:mi mathvariant="bold-italic">I</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mo> </mml:mo><mml:mtext>log</mml:mtext><mml:mo> </mml:mo><mml:mo>⁡</mml:mo><mml:msup><mml:mo>γ</mml:mo><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>∼</mml:mo><mml:mi mathvariant="script">N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>10000</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mo> </mml:mo><mml:mtext>log</mml:mtext><mml:mo> </mml:mo><mml:mo>⁡</mml:mo><mml:mo>λ</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>∼</mml:mo><mml:mi mathvariant="script">N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mo>μ</mml:mo><mml:mo>λ</mml:mo></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mo>ζ</mml:mo><mml:mo>λ</mml:mo><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula>where <inline-formula id="IE67"><mml:math id="IM67"><mml:mrow><mml:msup><mml:mo>γ</mml:mo><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula> and <italic>λ</italic> are assumed to be a priori independent. The variance parameter in the error term is given an uninformative prior and the parameters <inline-formula id="IE68"><mml:math id="IM68"><mml:mrow><mml:msub><mml:mo>μ</mml:mo><mml:mo>λ</mml:mo></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE69"><mml:math id="IM69"><mml:mrow><mml:msubsup><mml:mo>ζ</mml:mo><mml:mo>λ</mml:mo><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></inline-formula> are fixed similarly as in joint estimation method following <xref rid="btaa199-B29" ref-type="bibr">Monterrubio-Gómez <italic>et al.</italic> (2020)</xref>. The process <inline-formula id="IE70"><mml:math id="IM70"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:msup><mml:mo>σ</mml:mo><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is analytically integrated out of the model, but we can reconstruct it at the measurement points after the estimation of the hyperparameters (<xref rid="btaa199-B37" ref-type="bibr">Rasmussen and Williams, 2006</xref>) by noting that
<disp-formula id="E18"><mml:math id="M18"><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mi mathvariant="bold-italic">f</mml:mi><mml:msup><mml:mo>σ</mml:mo><mml:mn>2</mml:mn></mml:msup></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">y</mml:mi><mml:msup><mml:mo>σ</mml:mo><mml:mn>2</mml:mn></mml:msup></mml:msub><mml:mo>,</mml:mo><mml:mo>λ</mml:mo><mml:mo>,</mml:mo><mml:msup><mml:mo>γ</mml:mo><mml:mn>2</mml:mn></mml:msup><mml:mo>~</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi mathvariant="script">N</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">C</mml:mi><mml:mo>λ</mml:mo></mml:msub><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">C</mml:mi><mml:mo>λ</mml:mo></mml:msub><mml:mo>+</mml:mo><mml:msup><mml:mo>γ</mml:mo><mml:mn>2</mml:mn></mml:msup><mml:mi mathvariant="bold-italic">I</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mi mathvariant="bold-italic">y</mml:mi><mml:msup><mml:mo>σ</mml:mo><mml:mn>2</mml:mn></mml:msup></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">C</mml:mi><mml:mo>λ</mml:mo></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">C</mml:mi><mml:mo>λ</mml:mo></mml:msub><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">C</mml:mi><mml:mo>λ</mml:mo></mml:msub><mml:mo>+</mml:mo><mml:msup><mml:mo>γ</mml:mo><mml:mn>2</mml:mn></mml:msup><mml:mi mathvariant="bold-italic">I</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mi mathvariant="bold-italic">C</mml:mi><mml:mo>λ</mml:mo></mml:msub><mml:mo>)</mml:mo><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula></p>
      <sec>
        <title>2.3.1 Parameter estimation in the two-stage method</title>
        <p>The parameters <inline-formula id="IE71"><mml:math id="IM71"><mml:mrow><mml:mtext>log</mml:mtext><mml:mo> </mml:mo><mml:mo>⁡</mml:mo><mml:msubsup><mml:mo>σ</mml:mo><mml:mi>G</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE72"><mml:math id="IM72"><mml:mrow><mml:mtext>log</mml:mtext><mml:mo> </mml:mo><mml:mo>⁡</mml:mo><mml:msubsup><mml:mo>σ</mml:mo><mml:mi>E</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> in stage one are estimated using a random walk MH algorithm with the same adaptation as in the joint estimation method. They are sampled at MCMC iteration <italic>i </italic>+<italic> </italic>1 from the distributions <inline-formula id="IE73"><mml:math id="IM73"><mml:mrow><mml:mi mathvariant="script">N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mtext>log</mml:mtext><mml:mo> </mml:mo><mml:mo>⁡</mml:mo><mml:msubsup><mml:mo>σ</mml:mo><mml:mi>G</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:msubsup><mml:mo>σ</mml:mo><mml:mi>G</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mtext>and</mml:mtext><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mi mathvariant="script">N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mtext>log</mml:mtext><mml:mo> </mml:mo><mml:mo>⁡</mml:mo><mml:msubsup><mml:mo>σ</mml:mo><mml:mi>E</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:msubsup><mml:mo>σ</mml:mo><mml:mi>E</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. The proposals are accepted by MH (a single parameter at a time) conditionally on the other parameter fixed to its latest value.</p>
        <p>The parameters <inline-formula id="IE74"><mml:math id="IM74"><mml:mrow><mml:mtext>log</mml:mtext><mml:mo> </mml:mo><mml:mo>⁡</mml:mo><mml:msup><mml:mo>γ</mml:mo><mml:mn>2</mml:mn></mml:msup><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mtext>and</mml:mtext><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mtext>log</mml:mtext><mml:mo> </mml:mo><mml:mo>⁡</mml:mo><mml:mo>λ</mml:mo></mml:mrow></mml:math></inline-formula> of the smoothing model in phase two are estimated similarly as in stage one with the same adaptation. They are sampled at iteration <inline-formula id="IE75"><mml:math id="IM75"><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> from the distributions <inline-formula id="IE76"><mml:math id="IM76"><mml:mrow><mml:mi mathvariant="script">N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mtext>log</mml:mtext><mml:mo> </mml:mo><mml:mo>⁡</mml:mo><mml:msup><mml:mo>γ</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>s</mml:mi><mml:mrow><mml:msup><mml:mo>γ</mml:mo><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mtext>and</mml:mtext><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mi mathvariant="script">N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mtext>log</mml:mtext><mml:mo> </mml:mo><mml:mo>⁡</mml:mo><mml:msup><mml:mo>λ</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>s</mml:mi><mml:mo>λ</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. The proposals are accepted by MH (a single parameter at a time) conditionally on the other parameter fixed to its latest value.</p>
        <p>The pseudocode for both stages can be found in the <xref ref-type="supplementary-material" rid="sup1">Supplementary Algorithms S2 and S3</xref>.</p>
      </sec>
    </sec>
    <sec>
      <title>2.4 Computational considerations</title>
      <p>Since the log-likelihood in the joint estimation method can be expressed as a sum (<xref ref-type="disp-formula" rid="E13">Equation 9</xref>), its computation can be parallelized. We parallelized all log-likelihood calculations, gaining additional speedups. The computation times were between 24 min for the mouse activity data and 31 min for the <italic>Arabidopsis</italic> data with 300 000 MCMC iterations. The workstation used for the simulations had an AMD Ryzen Threadripper 2950X 3.5 GHz processor with 16 cores and 32 GB of RAM. The method is implemented with C++ integrated with R using the Rcpp library (<xref rid="btaa199-B7" ref-type="bibr">Eddelbuettel and François, 2011</xref>) and Eigen (<xref rid="btaa199-B15" ref-type="bibr">Guennebaud <italic>et al.</italic>, 2010</xref>) (<ext-link ext-link-type="uri" xlink:href="http://eigen.tuxfamily.org">http://eigen.tuxfamily.org</ext-link>) for linear algebra. The programme is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/aarjas/dynBGP">https://github.com/aarjas/dynBGP</ext-link>.</p>
    </sec>
  </sec>
  <sec>
    <title>3 Example analyses</title>
    <p>To test the methods described earlier, we used four different datasets with a large number of time points. Two were simulated and the two others were real datasets from <ext-link ext-link-type="uri" xlink:href="https://phenome.jax.org/centers/QTLA">https://phenome.jax.org/centers/QTLA</ext-link>.</p>
    <sec>
      <title>3.1 Simulated dataset</title>
      <p>The simulated data consist of measurements from <inline-formula id="IE77"><mml:math id="IM77"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>1000</mml:mn></mml:mrow></mml:math></inline-formula> individuals from <inline-formula id="IE78"><mml:math id="IM78"><mml:mrow><mml:mi>T</mml:mi><mml:mo>=</mml:mo><mml:mn>50</mml:mn></mml:mrow></mml:math></inline-formula> time points. First, a relationship matrix was created by generating an <inline-formula id="IE79"><mml:math id="IM79"><mml:mrow><mml:mi>N</mml:mi><mml:mo>×</mml:mo><mml:mi>N</mml:mi><mml:mo> </mml:mo><mml:mtext>matrix</mml:mtext><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mi mathvariant="bold-italic">S</mml:mi></mml:mrow></mml:math></inline-formula> with independent standard normally distributed elements. The relationship matrix was then computed as <inline-formula id="IE80"><mml:math id="IM80"><mml:mrow><mml:mi mathvariant="bold-italic">G</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="bold-italic">S</mml:mi><mml:msup><mml:mi mathvariant="bold-italic">S</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mo>/</mml:mo><mml:mi>N</mml:mi><mml:mo>+</mml:mo><mml:mn>0.1</mml:mn><mml:mi mathvariant="bold-italic">I</mml:mi></mml:mrow></mml:math></inline-formula>. A small number was added to the diagonal to make the matrix positive definite. To simulate realistic data, the longitudinal dependencies need be taken into account as well. This was done by computing a <inline-formula id="IE81"><mml:math id="IM81"><mml:mrow><mml:mi>T</mml:mi><mml:mo>×</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:math></inline-formula> GP matrix <inline-formula id="IE82"><mml:math id="IM82"><mml:mi mathvariant="bold-italic">C</mml:mi></mml:math></inline-formula> where the row <inline-formula id="IE83"><mml:math id="IM83"><mml:mi>i</mml:mi></mml:math></inline-formula> and column <inline-formula id="IE84"><mml:math id="IM84"><mml:mi>j</mml:mi></mml:math></inline-formula> intersection was set to <inline-formula id="IE85"><mml:math id="IM85"><mml:mrow><mml:msub><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>C</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:msqrt><mml:mn>5</mml:mn></mml:msqrt><mml:mo>|</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>|</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>50</mml:mn><mml:mo>/</mml:mo><mml:mn>3</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mn>5</mml:mn><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:mn>3</mml:mn><mml:mo>·</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>50</mml:mn><mml:mo>/</mml:mo><mml:mn>3</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mtext>exp</mml:mtext><mml:mo> </mml:mo><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msqrt><mml:mn>5</mml:mn></mml:msqrt><mml:mo>|</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>|</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>50</mml:mn><mml:mo>/</mml:mo><mml:mn>3</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. The genetic and environmental components of the data were simulated from the distributions <inline-formula id="IE86"><mml:math id="IM86"><mml:mrow><mml:mi mathvariant="script">N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">C</mml:mi><mml:mo>⊗</mml:mo><mml:mi mathvariant="bold-italic">G</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mtext>and</mml:mtext><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mi mathvariant="script">N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">C</mml:mi><mml:mo>⊗</mml:mo><mml:mi mathvariant="bold-italic">I</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, respectively. Finally, the components were scaled with the corresponding variances at each time point and summed. A correct relationship matrix was assumed known in the analysis stage. To demonstrate scalability of the approach, we created larger datasets with up to 50 000 individuals and 1000 time points (see <xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S5</xref>).</p>
    </sec>
    <sec>
      <title>3.2 <italic>Arabidopsis thaliana</italic> dataset</title>
      <p>The second dataset contains <italic>A.thaliana</italic> root tip angle measurements (<xref rid="btaa199-B30" ref-type="bibr">Moore <italic>et al.</italic>, 2013</xref>). The population consists of <inline-formula id="IE87"><mml:math id="IM87"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>162</mml:mn></mml:mrow></mml:math></inline-formula> recombinant inbred lines of <italic>Arabidopsis</italic> seeds with 234 markers. The seeds were placed on Petri dishes that were held in front of a camera and rotated 90° so that the roots grew parallel to the ground. The root tip angle was measured every 2 min for 8 h resulting in <inline-formula id="IE88"><mml:math id="IM88"><mml:mrow><mml:mi>T</mml:mi><mml:mo>=</mml:mo><mml:mn>239</mml:mn></mml:mrow></mml:math></inline-formula> time points. <xref rid="btaa199-B30" ref-type="bibr">Moore <italic>et al.</italic> (2013)</xref> describe the measurement process in more detail. We used a version of the data where the phenotype values were averages of multiple individuals representing the same line.</p>
    </sec>
    <sec>
      <title>3.3 Mouse activity dataset</title>
      <p>The third dataset consists of mouse activity measurements (<xref rid="btaa199-B50" ref-type="bibr">Xiong <italic>et al.</italic>, 2011</xref>). The activity of <inline-formula id="IE89"><mml:math id="IM89"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>89</mml:mn></mml:mrow></mml:math></inline-formula> mouses was monitored over a period of <inline-formula id="IE90"><mml:math id="IM90"><mml:mrow><mml:mn>12</mml:mn></mml:mrow></mml:math></inline-formula> days. One day was divided into 6-min intervals and an active state probability of a given mouse in each interval was calculated based on the <inline-formula id="IE91"><mml:math id="IM91"><mml:mrow><mml:mn>12</mml:mn></mml:mrow></mml:math></inline-formula> days of data. This results in <inline-formula id="IE92"><mml:math id="IM92"><mml:mrow><mml:mi>T</mml:mi><mml:mo>=</mml:mo><mml:mn>222</mml:mn></mml:mrow></mml:math></inline-formula> time points. Since the outcome is a probability, normality assumption is not realistic. Hence, we transformed the phenotypic data using logit-transformation following the procedure described by <xref rid="btaa199-B25" ref-type="bibr">Li and Sillanpää (2013)</xref>. The data also have measurements of 251 markers.</p>
    </sec>
    <sec>
      <title>3.4 Comparison with ACEt</title>
      <p>We also compared our joint estimation method with the freely available ACEt R-package for estimating dynamic heritability (<xref rid="btaa199-B17" ref-type="bibr">He <italic>et al.</italic>, 2016</xref>, <xref rid="btaa199-B18" ref-type="bibr">2017</xref>). The method is restricted only for twin data and it uses splines in defining the different dynamic variance components. The ACEt model also includes a common environmental effect as a third variance component, which our model lacks. For uncertainty quantification, ACEt uses delta-method or bootstrap. For the method comparison, we used a simulated twin dataset that comes with the ACEt R-package. It consists of 100 twin pairs, half of who are monozygotic and half of who are dizygotic. The <inline-formula id="IE93"><mml:math id="IM93"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>200</mml:mn></mml:mrow></mml:math></inline-formula> individuals have <inline-formula id="IE94"><mml:math id="IM94"><mml:mrow><mml:mi>T</mml:mi><mml:mo>=</mml:mo><mml:mn>50</mml:mn></mml:mrow></mml:math></inline-formula> equispaced measurements of an artificial trait over 50 years. In twin models, the covariances in the relationship matrix between a monozygotic twin pair and a dizygotic twin pair are assumed to be 1 and 0.5, respectively, while the diagonal values are all 1. Between-pair covariance is assumed to be 0.</p>
    </sec>
    <sec>
      <title>3.5 Completing missing genotype data by imputation</title>
      <p>There were no missing phenotype values in any of the datasets. The mouse activity dataset had <inline-formula id="IE95"><mml:math id="IM95"><mml:mrow><mml:mn>0.3</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math></inline-formula> and the <italic>Arabidopsis</italic> dataset <inline-formula id="IE96"><mml:math id="IM96"><mml:mrow><mml:mn>1.4</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math></inline-formula> missing marker values. All missing values were imputed once before calculating the genomic relationship matrix with the mean value of the given marker over individuals.</p>
    </sec>
  </sec>
  <sec>
    <title>4 Results</title>
    <p>The results from the Bayesian analysis of simulated data are presented in <xref ref-type="fig" rid="btaa199-F2">Figure 2</xref> for both methods. The posterior estimated variance component functions generally follow the real functions that were used to generate the data well. Perhaps the most interesting aspect about the results is the difference in the uncertainty of the estimates between the methods. The 95% credible intervals provided by the joint model are far narrower than those of the two-stage method. This is because the joint model makes use of the whole dataset, whereas the two-stage method uses the data of each time point independently.</p>
    <fig id="btaa199-F2" orientation="portrait" position="float">
      <label>Fig. 2.</label>
      <caption>
        <p>The dynamic variance components and SNP-heritability estimated from the simulated dataset with the two different Bayesian methods. The posterior mean curves are drawn with solid lines and 95% credible intervals with dashed lines</p>
      </caption>
      <graphic xlink:href="btaa199f2"/>
    </fig>
    <p>The estimated posterior mean curves and their 95% credible intervals for variance components and SNP-heritability calculated from the <italic>Arabidopsis</italic> seed data are presented for the joint model and two-stage method in <xref ref-type="fig" rid="btaa199-F3">Figure 3</xref>. Again, one can clearly see much wider 95% credible intervals surrounding the posterior mean curves obtained from the two-stage method. <xref rid="btaa199-B30" ref-type="bibr">Moore <italic>et al.</italic> (2013)</xref> have also estimated the dynamic heritability from this dataset using ANOVA. They calculated the variances within and between genetically distinct lines separately at every point in time. The curve has the same shape but the actual values are somewhat smaller than ours, peaking at 0.25, while our estimate peaks at about 0.4. This offset can be explained by different averaging of used data and in particular, their estimation lacks uncertainty estimates. <xref rid="btaa199-B47" ref-type="bibr">Vanhatalo <italic>et al.</italic> (2019)</xref> have analysed the same data as well and are likely using the same averaging as we do. We note that their obtained heritability estimates coincide very well with ours. However, they also lack uncertainty estimates. Interestingly, similar results were not expected, since the two analysis models differ significantly in structure and especially in terms of assumptions on the underlying genetics.</p>
    <fig id="btaa199-F3" orientation="portrait" position="float">
      <label>Fig. 3.</label>
      <caption>
        <p>The dynamic variance components and SNP-heritability estimated from the <italic>A.thaliana</italic> dataset with the two different Bayesian methods. Posterior mean curves are drawn with solid lines and 95% credible intervals with dashed lines</p>
      </caption>
      <graphic xlink:href="btaa199f3"/>
    </fig>
    <p>The posterior estimates from the mouse activity data are presented in <xref ref-type="fig" rid="btaa199-F4">Figure 4</xref>. This kind of data seems to be challenging for the GP models. This is mainly due to the fact that here the variance processes have very rough features along with smooth areas. Thus, the amount of smoothing needed is very different at different time points. Especially, the heritability process estimated with the two-stage method does not perform so well and produces highly oscillating features. The same data were analysed in <xref rid="btaa199-B47" ref-type="bibr">Vanhatalo <italic>et al.</italic> (2019)</xref> as well. In this case, their heritability estimates look quite different to ours. In particular, our methods have smoothed most rough edges, whereas their estimate has preserved them. Nevertheless, the overall shape is similar. These differences here are likely the consequence of using very different models.</p>
    <fig id="btaa199-F4" orientation="portrait" position="float">
      <label>Fig. 4.</label>
      <caption>
        <p>The dynamic variance components and SNP-heritability estimated from the mouse activity dataset with the two different Bayesian methods. Posterior mean curves are drawn with solid lines and 95% credible intervals with dashed lines</p>
      </caption>
      <graphic xlink:href="btaa199f4"/>
    </fig>
    <p>We also compared the joint model with a RRM [implemented in e.g. BLUPF90 (<xref rid="btaa199-B28" ref-type="bibr">Misztal <italic>et al.</italic>, 2002</xref>), MCMCglmm (<xref rid="btaa199-B16" ref-type="bibr">Hadfield, 2010</xref>) and MTG2 (<xref rid="btaa199-B24" ref-type="bibr">Lee and van der Werf, 2016</xref>)] which is a well-established method for analyzing dynamic biological phenomena. We simulated 10 different datasets with the method from Section 3.1 and fitted a Legendre polynomial of degree five for both the genomic breeding values and permanent environmental effects. The model assumes heterogenous residual variances over time. A more precise model definition can be found in the <xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref>. We computed the mean squared error (MSE) of the estimated genetic and environmental variances as well as heritabilities, where <inline-formula id="IE97"><mml:math id="IM97"><mml:mrow><mml:mtext>MSE</mml:mtext><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>T</mml:mi></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula>, with <inline-formula id="IE98"><mml:math id="IM98"><mml:mrow><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> being the ground truth at time <inline-formula id="IE99"><mml:math id="IM99"><mml:mrow><mml:mi>t</mml:mi><mml:mo> </mml:mo><mml:mtext>and</mml:mtext><mml:mo> </mml:mo><mml:mrow><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> the estimate at time <inline-formula id="IE100"><mml:math id="IM100"><mml:mi>t</mml:mi></mml:math></inline-formula>. We used posterior mean as the point estimate for the joint method. The computed errors can be found in the <xref ref-type="supplementary-material" rid="sup1">Supplementary Table S1</xref>. This analysis was performed using AI-REML method in the software MTG2 (<xref rid="btaa199-B24" ref-type="bibr">Lee and van der Werf, 2016</xref>) and it took on average 14 min. The MSE of the joint method was on average 17% smaller than of the RRM. We note that the MSE varies with the chosen degree of the Legendre polynomials and for this computation; we chose the best performing combinations with a reasonable computation time. Additionally, we fitted a Bayesian version of the same model using BLUPF90 family of programmes (<xref rid="btaa199-B28" ref-type="bibr">Misztal <italic>et al.</italic>, 2002</xref>) and GIBBS2F90 in particular. This allowed us to quantify the uncertainty in the variance components estimated with the RRM. The results of the analysis and further details can be found in the <xref ref-type="supplementary-material" rid="sup1">Supplementary Figure S7</xref>. The 95% credible intervals obtained from the RRM are slightly wider than of the joint model. This might be due to the differences in model structures (cf. <xref ref-type="fig" rid="btaa199-F1">Fig. 1</xref>). The computation time for the Bayesian RRM for the simulated dataset was over 24 h, whereas for the joint method it was &lt;30 min with 300 000 MCMC-iterations in both. Furthermore, we would like to mention that the RRM implemented in both MTG2 and GIBBS2F90 did not converge on our real dataset examples where the number of individuals is small but the number of time points high. Yet, the joint method manages to do so, i.e. the MCMC sampler converges. It is not completely clear to us why this is the case. One possibility might be the difference in assumptions: In RRMs the assumptions about the parametric shape of the breeding values and environmental effects induce some shape for the variance components. In the joint method, the prior assumptions concern only the variances. This direct modelling strategy might simplify the estimation process.</p>
    <p>Finally, the comparison of our joint model with the ACEt model for analyzing twin data is presented in the <xref ref-type="supplementary-material" rid="sup1">Supplementary Figure S4</xref>. The results obtained by both methods are consistent, even though ACEt considers also common environment in its model. In our method, the genetic variance component seems to have absorbed the common environmental variation, resulting in slightly higher heritability estimate than the one given by ACEt. The uncertainty estimates differ a bit between the methods, which is likely due to the common environmental component. Moreover, obtained uncertainty limits are not fully comparable because the frequentist ACEt method uses delta-method and our Bayesian method uses MCMC sampling for generating the limits.</p>
    <p>Performance of the MCMC-algorithm for the joint model can be evaluated from traceplots of the parameters (<xref ref-type="supplementary-material" rid="sup1">Supplementary Figs S1–S3</xref>). All of the parameter chains seem to have converged, although there is some oscillation on the variance component parameters with the lowest effective sample size.</p>
  </sec>
  <sec>
    <title>5 Discussion and conclusions</title>
    <p>We presented a new Bayesian method for estimating dynamic narrow-sense heritability, based on LMMs and GP priors. The method uses data from all time points at once, making it possible for the time points to ‘borrow strength’ from one another through the prior covariance structure. This property makes the resulting posterior distributions narrower compared with the second method where the variance components are estimated separately for each time point and smoothed afterwards. Another benefit of the method presented due to non-parametric smoothing using GPs is that it can handle very general functional shapes.</p>
    <p>The presented estimation method bears some similarities with random regression as both are based on LMMs, but there are essential differences that we would like to point out. Most notably, in our proposed method the smoothing is based on priors that are set for the variance component vectors, while in random regression the smoothness of the variances is induced through the assumptions made about the functional shape of the breeding values and environmental effects. Additionally, our model assumes independence of different traits (measurements made at different points in time) and ties them together with the priors. In multivariate LMMs, traits are assumed to be dependent and random regression attempts to reduce the size of the estimated covariance matrix by reparametrization.</p>
    <p>A benefit of our proposed method is the ability to quantify the uncertainty in the variance component estimates. This is also possible in Bayesian RRMs using MCMC but in frequentistic RRMs additional steps such as application of delta-method or bootstrap are needed to produce the respective confidence intervals. In addition, our method is completely free of tuning whereas in random regression the degree of the polynomial or alternatively knot points in splines must be chosen prior to estimation. In practice, we noticed that the estimation in MTG2 is really fast for a few traits but it slows down quickly as the number of traits increases. In fact, trying to run the algorithm with 1000 individuals and 100 traits causes an insufficient virtual memory error. In contrast, our algorithm still worked well with 50 000 individuals and 100 time points within a reasonable time (∼20 h). Additionally, high number of traits is not an issue either as demonstrated in the <xref ref-type="supplementary-material" rid="sup1">Supplementary Figure S5</xref>. We like to emphasize that the computation times grow almost linearly and hence our algorithm exhibits excellent scalability. Based on our results, we believe that random regression performs best when there is a high number of individuals and low number of time points which was not the case in our real data examples. In MTG2, the time complexity is cubic with respect to the number of time points (<xref rid="btaa199-B24" ref-type="bibr">Lee and van der Werf, 2016</xref>), and we believe this is also the case with other RRM implementations. It is also noted by <xref rid="btaa199-B42" ref-type="bibr">Schaeffer (2016)</xref> that Legendre polynomials might cause artefacts near the boundaries of the covariate domain and hence GPs are favoured. A limitation of our method is the inability to model gene-covariate interactions with possibly only one measurement per individual (cf. <xref rid="btaa199-B31" ref-type="bibr">Moore <italic>et al.</italic>, 2019</xref>; <xref rid="btaa199-B34" ref-type="bibr">Ni <italic>et al.</italic>, 2019</xref>). Theoretically, to perform such analysis, the covariate would have to be split up into discrete groups with each group containing suitably large population (cf. <xref rid="btaa199-B40" ref-type="bibr">Robinson <italic>et al.</italic>, 2017</xref>). This would also result in each group having their own relationship matrix. This is not supported by the algorithm at the moment, however.</p>
    <p>Furthermore, the method presented here can also be extended for further analysis. For example, given the posterior mean estimates <inline-formula id="IE101"><mml:math id="IM101"><mml:mrow><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mi>σ</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mi>G</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mtext>and</mml:mtext><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mi>σ</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mi>E</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> at time <inline-formula id="IE102"><mml:math id="IM102"><mml:mi>t</mml:mi></mml:math></inline-formula>, the conditional distribution of genomic breeding values <inline-formula id="IE103"><mml:math id="IM103"><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mtext>is</mml:mtext><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mi mathvariant="script">N</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mi>u</mml:mi></mml:msub><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mo mathvariant="bold">Σ</mml:mo><mml:mi>u</mml:mi></mml:msub><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mo>)</mml:mo></mml:math></inline-formula> (<xref rid="btaa199-B37" ref-type="bibr">Rasmussen and Williams, 2006</xref>), where
<disp-formula id="E19"><label>(14)</label><mml:math id="M19"><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mi>u</mml:mi></mml:msub><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi>σ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>G</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mi mathvariant="bold-italic">G</mml:mi><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi>σ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>G</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mi mathvariant="bold-italic">G</mml:mi><mml:mo>+</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi>σ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>E</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mi mathvariant="bold-italic">I</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mo> </mml:mo><mml:mtext>and</mml:mtext></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mo mathvariant="bold">Σ</mml:mo><mml:mi>u</mml:mi></mml:msub><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi>σ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>G</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mi mathvariant="bold-italic">G</mml:mi><mml:mo>−</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi>σ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>G</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mi mathvariant="bold-italic">G</mml:mi><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi>σ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>G</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mi mathvariant="bold-italic">G</mml:mi><mml:mo>+</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi>σ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>E</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mi mathvariant="bold-italic">I</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msubsup><mml:mover accent="true"><mml:mi>σ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>G</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mi mathvariant="bold-italic">G</mml:mi><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula></p>
    <p>The posterior means of genomic breeding values are not smooth functions over time (cf. <xref rid="btaa199-B4" ref-type="bibr">Campbell <italic>et al.</italic>, 2018</xref>). After computing the breeding values, the SNP effects <inline-formula id="IE104"><mml:math id="IM104"><mml:mrow><mml:mi mathvariant="bold-italic">m</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> can be estimated for association mapping purposes by the back-transformation formula <inline-formula id="IE105"><mml:math id="IM105"><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">m</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi mathvariant="bold-italic">R</mml:mi><mml:mo>′</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">G</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mi>u</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, where <inline-formula id="IE106"><mml:math id="IM106"><mml:mrow><mml:msub><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>R</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mi>p</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msqrt><mml:mrow><mml:mn>2</mml:mn><mml:msub><mml:mi>p</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msqrt><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> is the allele frequency of the other allele in marker <inline-formula id="IE107"><mml:math id="IM107"><mml:mrow><mml:mi>j</mml:mi><mml:mo> </mml:mo><mml:mtext>and</mml:mtext><mml:mo> </mml:mo><mml:mi mathvariant="bold-italic">M</mml:mi></mml:mrow></mml:math></inline-formula> defined in Section 2.1 (<xref rid="btaa199-B2" ref-type="bibr">Bernal Rubio <italic>et al.</italic>, 2016</xref>). This kind of longitudinal analysis was recently performed by <xref rid="btaa199-B5" ref-type="bibr">Campbell <italic>et al.</italic> (2019)</xref> who first estimated the breeding values with a RRM and then used the back-transformation to solve for the SNP effects. Results were compared with an alternative single time point analysis and the authors found that the dynamic analysis recovered more significant associations. The presented model can also be extended by adding fixed environmental effects that affect the phenotype values. This could further reduce the estimation error. Another strategy is to apply a two-stage pre-correction similar to <xref rid="btaa199-B17" ref-type="bibr">He <italic>et al.</italic> (2016)</xref>. This means that a linear regression model is first fitted to estimate the fixed effect coefficients and the residuals of that model are then used as phenotype values to estimate the variance components in our LMM.</p>
    <p>Further extension would be to consider non-Gaussian longitudinal phenotypes, e.g. binary or count data. In case of binary data, an extra latent-trait layer can be added to the model (<xref rid="btaa199-B1" ref-type="bibr">Albert and Chib, 1993</xref>; <xref rid="btaa199-B11" ref-type="bibr">Felsenstein, 2005</xref>; <xref rid="btaa199-B23" ref-type="bibr">Kärkkäinen and Sillanpää, 2013</xref>). In latent-trait modelling, the binary phenotype can be modelled by considering an underlying hypothetical normally distributed latent-trait variable which gives rise to the binary trait at the observed layer. If the latent-trait variable is smaller than the pre-determined threshold, binary trait at the observed layer obtains the value zero and otherwise it obtains the value one.</p>
    <p>One future extension is also to consider multiple longitudinal quantitative traits simultaneously. Some models and methods have been presented for this purpose—to explain the variation of more than one trait simultaneously over time (<xref rid="btaa199-B35" ref-type="bibr">Oliveira <italic>et al.</italic>, 2019</xref>; <xref rid="btaa199-B46" ref-type="bibr">Sung <italic>et al.</italic>, 2016</xref>).</p>
    <p>To conclude, we presented a new tuning-free method for estimating dynamic heritability using a Bayesian LMM and GP priors. To estimate the parameters in the model, we use MCMC which makes the uncertainty quantification straightforward. Our results clearly illustrate that joint modelling of the data of all time points reduces the uncertainty in the estimates compared with independent modelling.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="sup1">
      <label>btaa199_Supplementary_Data</label>
      <media xlink:href="btaa199_supplementary_data.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgements</title>
    <p>The authors are grateful to the editors and three anonymous referees for their constructive comments that helped us to substantially improve the presentation of this article.</p>
    <sec>
      <title>Funding</title>
      <p>This work was supported by the Academy of Finland Profi 5 funding for mathematics and AI: data insight for high-dimensional dynamics and the Academy of Finland [Project 312123], the Finnish Centre of Excellence in Inverse Modelling and Imaging, 2018–2025. A.H. is partially supported by Engineering and Physical Sciences Research Council [grants EP/N032055/1 and EP/M020533/1]. </p>
      <p><italic>Conflict of Interest</italic>: none declared.</p>
    </sec>
  </ack>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btaa199-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Albert</surname><given-names>J.</given-names></name>, <name name-style="western"><surname>Chib</surname><given-names>S.</given-names></name></person-group> (<year>1993</year>) 
<article-title>Bayesian analysis of binary and polychotomous response data</article-title>. <source>J. Am. Stat. Assoc</source>., <volume>88</volume>, <fpage>669</fpage>–<lpage>679</lpage>.</mixed-citation>
    </ref>
    <ref id="btaa199-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Bernal Rubio</surname><given-names>Y.L.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>Meta-analysis of genome-wide association from genomic prediction models</article-title>. <source>Anim. Genet</source>., <volume>47</volume>, <fpage>36</fpage>–<lpage>48</lpage>.<pub-id pub-id-type="pmid">26607299</pub-id></mixed-citation>
    </ref>
    <ref id="btaa199-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Bryois</surname><given-names>J.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>Time-dependent genetic effects on gene expression implicate aging processes</article-title>. <source>Genome Res</source>., <volume>27</volume>, <fpage>545</fpage>–<lpage>552</lpage>.<pub-id pub-id-type="pmid">28302734</pub-id></mixed-citation>
    </ref>
    <ref id="btaa199-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Campbell</surname><given-names>M.</given-names></name></person-group><etal>et al</etal> (<year>2018</year>) 
<article-title>Utilizing random regression models for genomic prediction of a longitudinal trait derived from high-throughput phenotyping</article-title>. <source>Plant Direct</source>, <volume>2</volume>, <fpage>e00080</fpage>.<pub-id pub-id-type="pmid">31245746</pub-id></mixed-citation>
    </ref>
    <ref id="btaa199-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Campbell</surname><given-names>M.</given-names></name></person-group><etal>et al</etal> (<year>2019</year>) 
<article-title>Leveraging breeding values obtained from random regression models for genetic inference of longitudinal traits</article-title>. <source>Plant Genome</source>, <volume>12</volume>, <fpage>180075</fpage>.</mixed-citation>
    </ref>
    <ref id="btaa199-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Canaza-Cayo</surname><given-names>A.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>Modelling of growth curves and estimation of genetic parameters for growth curve parameters in Peruvian young llamas (<italic>Lama glama</italic>)</article-title>. <source>Small Ruminant Res</source>., <volume>130</volume>, <fpage>81</fpage>–<lpage>89</lpage>.</mixed-citation>
    </ref>
    <ref id="btaa199-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Eddelbuettel</surname><given-names>D.</given-names></name>, <name name-style="western"><surname>François</surname><given-names>R.</given-names></name></person-group> (<year>2011</year>) 
<article-title>Rcpp: seamless R and C++ integration</article-title>. <source>J. Stat. Softw</source>., <volume>40</volume>, <fpage>1</fpage>–<lpage>18</lpage>.</mixed-citation>
    </ref>
    <ref id="btaa199-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Eichler</surname><given-names>E.</given-names></name></person-group><etal>et al</etal> (<year>2010</year>) 
<article-title>Viewpoint: missing heritability and strategies for finding the underlying causes of complex disease</article-title>. <source>Nat. Rev. Genet</source>., <volume>11</volume>, <fpage>446</fpage>–<lpage>450</lpage>.<pub-id pub-id-type="pmid">20479774</pub-id></mixed-citation>
    </ref>
    <ref id="btaa199-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Endelman</surname><given-names>J.B.</given-names></name></person-group> (<year>2011</year>) 
<article-title>Ridge regression and other kernels for genomic selection with R package rrBLUP</article-title>. <source>Plant Genome</source>, <volume>4</volume>, <fpage>250</fpage>–<lpage>255</lpage>.</mixed-citation>
    </ref>
    <ref id="btaa199-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Endelman</surname><given-names>J.B.</given-names></name>, <name name-style="western"><surname>Jannink</surname><given-names>J.-L.</given-names></name></person-group> (<year>2012</year>) 
<article-title>Shrinkage estimation of the realized relationship matrix</article-title>. <source>G3 (Bethesda)</source>, <volume>2</volume>, <fpage>1405</fpage>–<lpage>1413</lpage>.<pub-id pub-id-type="pmid">23173092</pub-id></mixed-citation>
    </ref>
    <ref id="btaa199-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Felsenstein</surname><given-names>J.</given-names></name></person-group> (<year>2005</year>) 
<article-title>Using the quantitative genetic threshold model for inferences between and within species</article-title>. <source>Philos. Trans. R. Soc. B Biol. Sci</source>., <volume>360</volume>, <fpage>1427</fpage>–<lpage>1434</lpage>.</mixed-citation>
    </ref>
    <ref id="btaa199-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Gee</surname><given-names>C.</given-names></name></person-group><etal>et al</etal> (<year>2003</year>) 
<article-title>Segregation and linkage analysis for longitudinal measurements of a quantitative trait</article-title>. <source>BMC Genet</source>., <volume>4</volume>, <fpage>S21</fpage>.<pub-id pub-id-type="pmid">14975089</pub-id></mixed-citation>
    </ref>
    <ref id="btaa199-B13">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name name-style="western"><surname>Gelman</surname><given-names>A.</given-names></name></person-group><etal>et al</etal> (<year>2013</year>) <source>Bayesian Data Analysis</source>. 
<publisher-name>CRC Press LLC</publisher-name>, 
<publisher-loc>Boca Raton</publisher-loc>.</mixed-citation>
    </ref>
    <ref id="btaa199-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Gibson</surname><given-names>G.</given-names></name></person-group> (<year>2012</year>) 
<article-title>Rare and common variants: twenty arguments</article-title>. <source>Nat. Rev. Genet</source>., <volume>13</volume>, <fpage>135</fpage>–<lpage>145</lpage>.<pub-id pub-id-type="pmid">22251874</pub-id></mixed-citation>
    </ref>
    <ref id="btaa199-B15">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><name name-style="western"><surname>Guennebaud</surname><given-names>G.</given-names></name></person-group><etal>et al</etal> (<year>2010</year>) Eigen v3. <ext-link ext-link-type="uri" xlink:href="http://eigen.tuxfamily.org/">http://eigen.tuxfamily.org/</ext-link> (9 April 2020, date last accessed).</mixed-citation>
    </ref>
    <ref id="btaa199-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Hadfield</surname><given-names>J.</given-names></name></person-group> (<year>2010</year>) 
<article-title>MCMC methods for multi-response generalized linear mixed models: the MCMCglmm R package</article-title>. <source>J. Stat. Softw</source>., <volume>33</volume>, <fpage>1</fpage>–<lpage>22</lpage>.<pub-id pub-id-type="pmid">20808728</pub-id></mixed-citation>
    </ref>
    <ref id="btaa199-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>He</surname><given-names>L.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>Estimating modifying effect of age on genetic and environmental variance components in twin models</article-title>. <source>Genetics</source>, <volume>202</volume>, <fpage>1313</fpage>–<lpage>1328</lpage>.<pub-id pub-id-type="pmid">26868768</pub-id></mixed-citation>
    </ref>
    <ref id="btaa199-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>He</surname><given-names>L.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>ACEt: an R package for estimating dynamic heritability and comparing twin models</article-title>. <source>Behav. Genet</source>., <volume>47</volume>, <fpage>620</fpage>–<lpage>641</lpage>.<pub-id pub-id-type="pmid">28879484</pub-id></mixed-citation>
    </ref>
    <ref id="btaa199-B19">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name name-style="western"><surname>Henderson</surname><given-names>C.R.</given-names></name></person-group> (<year>1984</year>) <source>Applications of Linear Models in Animal Breeding</source>. 
<publisher-name>University of Guelph, Guelph</publisher-name>.</mixed-citation>
    </ref>
    <ref id="btaa199-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Henderson</surname><given-names>C.R.</given-names></name>, <name name-style="western"><surname>Quaas</surname><given-names>R.L.</given-names></name></person-group> (<year>1976</year>) 
<article-title>Multiple trait evaluation using relatives’ records</article-title>. <source>J. Anim. Sci</source>., <volume>43</volume>, <fpage>1188</fpage>–<lpage>1197</lpage>.</mixed-citation>
    </ref>
    <ref id="btaa199-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Heuven</surname><given-names>H.C.M.</given-names></name>, <name name-style="western"><surname>Janss</surname><given-names>L.L.G.</given-names></name></person-group> (<year>2010</year>) 
<article-title>Bayesian multi-QTL mapping for growth curve parameters</article-title>. <source>BMC Proc</source>., <volume>4</volume>, <fpage>S12</fpage>.<pub-id pub-id-type="pmid">20380755</pub-id></mixed-citation>
    </ref>
    <ref id="btaa199-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Jaffrézic</surname><given-names>F.</given-names></name>, <name name-style="western"><surname>Pletcher</surname><given-names>S.D.</given-names></name></person-group> (<year>2000</year>) 
<article-title>Statistical models for estimating the genetic basis of repeated measures and other function-valued traits</article-title>. <source>Genetics</source>, <volume>156</volume>, <fpage>913</fpage>–<lpage>922</lpage>.<pub-id pub-id-type="pmid">11014836</pub-id></mixed-citation>
    </ref>
    <ref id="btaa199-B78154864">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Kang,</surname><given-names>H. M.</given-names></name></person-group><etal>et al</etal> (<year>2008</year>) 
<article-title>Efficient control of population structure in model organism association mapping</article-title>. <source>Genetics</source>, <bold>178</bold>, <fpage>1709</fpage>–<lpage>1723</lpage>.<pub-id pub-id-type="pmid">18385116</pub-id></mixed-citation>
    </ref>
    <ref id="btaa199-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Kärkkäinen</surname><given-names>H.P.</given-names></name>, <name name-style="western"><surname>Sillanpää</surname><given-names>M.J.</given-names></name></person-group> (<year>2013</year>) 
<article-title>Fast genomic predictions via Bayesian G-BLUP and multilocus models of threshold traits including censored Gaussian data</article-title>. <source>G3 (Bethesda)</source>, <volume>3</volume>, <fpage>1511</fpage>–<lpage>1523</lpage>.<pub-id pub-id-type="pmid">23821618</pub-id></mixed-citation>
    </ref>
    <ref id="btaa199-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Lee</surname><given-names>S.</given-names></name>, <name name-style="western"><surname>van der Werf</surname><given-names>J.</given-names></name></person-group> (<year>2016</year>) 
<article-title>MTG2: an efficient algorithm for multivariate linear mixed model analysis based on genomic information</article-title>. <source>Bioinformatics</source>, <volume>32</volume>, <fpage>1420</fpage>–<lpage>1422</lpage>.<pub-id pub-id-type="pmid">26755623</pub-id></mixed-citation>
    </ref>
    <ref id="btaa199-B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Li</surname><given-names>Z.</given-names></name>, <name name-style="western"><surname>Sillanpää</surname><given-names>M.J.</given-names></name></person-group> (<year>2013</year>) 
<article-title>A Bayesian nonparametric approach for mapping dynamic quantitative traits</article-title>. <source>Genetics</source>, <volume>194</volume>, <fpage>997</fpage>–<lpage>1016</lpage>.<pub-id pub-id-type="pmid">23770698</pub-id></mixed-citation>
    </ref>
    <ref id="btaa199-B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Li</surname><given-names>Z.</given-names></name>, <name name-style="western"><surname>Sillanpää</surname><given-names>M.J.</given-names></name></person-group> (<year>2015</year>) 
<article-title>Dynamic quantitative trait locus analysis of plant phenomic data</article-title>. <source>Trends Plant Sci</source>., <volume>20</volume>, <fpage>822</fpage>–<lpage>833</lpage>.<pub-id pub-id-type="pmid">26482958</pub-id></mixed-citation>
    </ref>
    <ref id="btaa199-B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Li</surname><given-names>Z.</given-names></name></person-group><etal>et al</etal> (<year>2014</year>) 
<article-title>Functional multi-locus QTL mapping of temporal trends in scots pine wood traits</article-title>. <source>G3 (Bethesda)</source>, <volume>4</volume>, <fpage>2365</fpage>–<lpage>2379</lpage>.<pub-id pub-id-type="pmid">25305041</pub-id></mixed-citation>
    </ref>
    <ref id="btaa199-B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Misztal</surname><given-names>I.</given-names></name></person-group><etal>et al</etal> (<year>2002</year>) 
<article-title>BLUPF90 and related programs (BGF90)</article-title>. In: <source>Proceedings of the 7th World Congress on Genetics Applied to Livestock Production</source>, Institut national de la recherche agronomique, Montpellier, France, Vol. <volume>33</volume>, pp. <fpage>743</fpage>–<lpage>744</lpage>.</mixed-citation>
    </ref>
    <ref id="btaa199-B29">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><name name-style="western"><surname>Monterrubio-Gómez</surname><given-names>K.</given-names></name></person-group><etal>et al</etal> (<year>2020</year>) 
<article-title>Posterior inference for sparse hierarchical non-stationary models</article-title>. <italic>Comp. Stat. and Dat. Anal</italic>, <bold>148</bold>, 106954.</mixed-citation>
    </ref>
    <ref id="btaa199-B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Moore</surname><given-names>C.R.</given-names></name></person-group><etal>et al</etal> (<year>2013</year>) 
<article-title>High-throughput computer vision introduces the time axis to a quantitative trait map of a plant growth response</article-title>. <source>Genetics</source>, <volume>195</volume>, <fpage>1077</fpage>–<lpage>1086</lpage>.<pub-id pub-id-type="pmid">23979570</pub-id></mixed-citation>
    </ref>
    <ref id="btaa199-B31">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Moore</surname><given-names>R.</given-names></name></person-group> (<year>2019</year>) 
<article-title>A linear mixed-model approach to study multivariate gene-environment interactions</article-title>. <source>Nat. Genet</source>., <volume>51</volume>, <fpage>180</fpage>–<lpage>186</lpage>.<pub-id pub-id-type="pmid">30478441</pub-id></mixed-citation>
    </ref>
    <ref id="btaa199-B32">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Murray</surname><given-names>I.</given-names></name>, <name name-style="western"><surname>Adams</surname><given-names>R.P.</given-names></name></person-group> (<year>2010</year>) 
<article-title>Slice sampling covariance hyperparameters of latent Gaussian models</article-title>. <source>Adv. Neural Inform. Process. Syst</source>., <volume>2</volume>, <fpage>1732</fpage>–<lpage>1740</lpage>.</mixed-citation>
    </ref>
    <ref id="btaa199-B33">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Murray</surname><given-names>I.</given-names></name></person-group><etal>et al</etal> (<year>2010</year>) 
<article-title>Elliptical slice sampling</article-title>. <source>Proc. Mach. Learn. Res</source>., <volume>9</volume>, <fpage>541</fpage>–<lpage>548</lpage>.</mixed-citation>
    </ref>
    <ref id="btaa199-B34">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Ni</surname><given-names>G.</given-names></name></person-group><etal>et al</etal> (<year>2019</year>) 
<article-title>Genotype-covariate correlation and interaction disentangled by a whole-genome multivariate reaction norm model</article-title>. <source>Nat. Commun</source>., <volume>10</volume>, <fpage>2239</fpage>–<lpage>2253</lpage>.<pub-id pub-id-type="pmid">31110177</pub-id></mixed-citation>
    </ref>
    <ref id="btaa199-B35">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Oliveira</surname><given-names>H.</given-names></name></person-group><etal>et al</etal> (<year>2019</year>) 
<article-title>Application of single-step genomic evaluation using multiple-trait random regression test-day models in dairy cattle</article-title>. <source>J. Dairy Sci</source>., <volume>102</volume>, <fpage>2365</fpage>–<lpage>2377</lpage>.<pub-id pub-id-type="pmid">30638992</pub-id></mixed-citation>
    </ref>
    <ref id="btaa199-B36">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Pletcher</surname><given-names>S.D. and Geyer,C.J.</given-names></name></person-group> (<year>1999</year>) 
<article-title>The genetic analysis of age-dependent traits: modeling the character process</article-title>. <source>Genetics</source>, <volume>168</volume>, <fpage>477</fpage>–<lpage>835</lpage>.</mixed-citation>
    </ref>
    <ref id="btaa199-B37">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name name-style="western"><surname>Rasmussen</surname><given-names>C.E.</given-names></name>, <name name-style="western"><surname>Williams</surname><given-names>C.K.I.</given-names></name></person-group> (<year>2006</year>). <source>Gaussian Processes for Machine Learning</source>. 
<publisher-name>MIT Press</publisher-name>, 
<publisher-loc>Cambridge</publisher-loc>.</mixed-citation>
    </ref>
    <ref id="btaa199-B38">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name name-style="western"><surname>Robert</surname><given-names>C.P.</given-names></name>, <name name-style="western"><surname>Casella</surname><given-names>G.</given-names></name></person-group> (<year>2009</year>). <source>Introducing Monte Carlo Methods with R</source>. 
<publisher-name>Springer</publisher-name>, 
<publisher-loc>New York</publisher-loc>.</mixed-citation>
    </ref>
    <ref id="btaa199-B39">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Roberts</surname><given-names>G.O.</given-names></name>, <name name-style="western"><surname>Rosenthal</surname><given-names>J.S.</given-names></name></person-group> (<year>2009</year>) 
<article-title>Examples of adaptive MCMC</article-title>. <source>J. Comput. Graph. Stat</source>., <volume>18</volume>, <fpage>349</fpage>–<lpage>367</lpage>.</mixed-citation>
    </ref>
    <ref id="btaa199-B40">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Robinson</surname><given-names>M.</given-names></name></person-group> et al. (<year>2017</year>) 
<article-title>Genotype-covariate interaction effects and the heritability of adult body mass index</article-title>. <source>Nat. Genet</source>., <volume>49</volume>, <fpage>1174</fpage>–<lpage>1181</lpage>.<pub-id pub-id-type="pmid">28692066</pub-id></mixed-citation>
    </ref>
    <ref id="btaa199-B41">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Roininen</surname><given-names>L.</given-names></name></person-group><etal>et al.</etal> (<year>2014</year>) 
<article-title>Whittle-Matérn priors for Bayesian statistical inversion with applications in electrical impedance tomography</article-title>. <source>Inverse Probl. Imaging</source>, <volume>8</volume>, <fpage>561</fpage>–<lpage>586</lpage>.</mixed-citation>
    </ref>
    <ref id="btaa199-B42">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><name name-style="western"><surname>Schaeffer</surname><given-names>L.R.</given-names></name></person-group> (<year>2016</year>) <italic><italic>Random Regression Models.</italic><ext-link ext-link-type="uri" xlink:href="http://animalbiosciences.uoguelph.ca/%7elrs/BOOKS/rrmbook.pdf">http://animalbiosciences.uoguelph.ca/%7elrs/BOOKS/rrmbook.pdf</ext-link> (9 April 2020, date last accessed).</italic></mixed-citation>
    </ref>
    <ref id="btaa199-B43">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Sillanpää</surname><given-names>M.J.</given-names></name></person-group> (<year>2011</year>) 
<article-title>On statistical methods for estimating heritability in wild populations</article-title>. <source>Mol. Ecol</source>., <volume>20</volume>, <fpage>1324</fpage>–<lpage>1332</lpage>.<pub-id pub-id-type="pmid">21426431</pub-id></mixed-citation>
    </ref>
    <ref id="btaa199-B44">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Sillanpää</surname><given-names>M.J.</given-names></name></person-group><etal>et al</etal> (<year>2012</year>) 
<article-title>Simultaneous estimation of multiple quantitative trait loci and growth curve parameters through hierarchical Bayesian modeling</article-title>. <source>Heredity</source>, <volume>108</volume>, <fpage>134</fpage>–<lpage>146</lpage>.<pub-id pub-id-type="pmid">21792229</pub-id></mixed-citation>
    </ref>
    <ref id="btaa199-B45">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Stinchcombe</surname><given-names>J.R.</given-names></name></person-group><italic>et al.</italic> (<year>2012</year>) 
<article-title>Genetics and evolution of function-valued traits: understanding environmentally responsive phenotypes</article-title>. <source>Trends Ecol. Evol</source>., <volume>27</volume>, <fpage>637</fpage>–<lpage>647</lpage>.<pub-id pub-id-type="pmid">22898151</pub-id></mixed-citation>
    </ref>
    <ref id="btaa199-B46">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Sung</surname><given-names>Y.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>A genome-wide association study of multiple longitudinal traits with related subjects</article-title>. <source>Stat</source>., <volume>5</volume>, <fpage>22</fpage>–<lpage>44</lpage>.<pub-id pub-id-type="pmid">27134745</pub-id></mixed-citation>
    </ref>
    <ref id="btaa199-B47">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Vanhatalo</surname><given-names>J.</given-names></name></person-group><etal>et al</etal> (<year>2019</year>) 
<article-title>A Gaussian process model and Bayesian variable selection for mapping function-valued quantitative traits with incomplete phenotypic data</article-title>. <source>Bioinformatics</source>, <volume>35</volume>, <fpage>3684</fpage>–<lpage>3692</lpage>.<pub-id pub-id-type="pmid">30850830</pub-id></mixed-citation>
    </ref>
    <ref id="btaa199-B48">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>VanRaden</surname><given-names>P.M.</given-names></name></person-group> (<year>2008</year>) 
<article-title>Efficient methods to compute genomic predictions</article-title>. <source>J. Dairy Sci</source>., <volume>91</volume>, <fpage>4414</fpage>–<lpage>4423</lpage>.<pub-id pub-id-type="pmid">18946147</pub-id></mixed-citation>
    </ref>
    <ref id="btaa199-B49">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Visscher</surname><given-names>P.M.</given-names></name></person-group><etal>et al</etal> (<year>2008</year>) 
<article-title>Heritability in the genomics era—concepts and misconceptions</article-title>. <source>Nat. Rev. Genet</source>., <volume>9</volume>, <fpage>255</fpage>–<lpage>266</lpage>.<pub-id pub-id-type="pmid">18319743</pub-id></mixed-citation>
    </ref>
    <ref id="btaa199-B50">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Xiong</surname><given-names>H.</given-names></name></person-group><etal>et al</etal> (<year>2011</year>) 
<article-title>A flexible estimating equations approach for mapping function-valued traits</article-title>. <source>Genetics</source>, <volume>189</volume>, <fpage>305</fpage>–<lpage>316</lpage>.<pub-id pub-id-type="pmid">21705752</pub-id></mixed-citation>
    </ref>
    <ref id="btaa199-B51">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Young</surname><given-names>A.</given-names></name></person-group> (<year>2019</year>) 
<article-title>Solving the missing heritability problem</article-title>. <source>PLoS Genet</source>., <volume>15</volume>, <fpage>e1008222</fpage>.<pub-id pub-id-type="pmid">31233496</pub-id></mixed-citation>
    </ref>
    <ref id="btaa199-B52">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Yu</surname><given-names>Y.</given-names></name>, <name name-style="western"><surname>Meng</surname><given-names>X.-L.</given-names></name></person-group> (<year>2011</year>) 
<article-title>To center or not to center: that is not the question—an ancillarity-sufficiency interweaving strategy (ASIS) for boosting MCMC efficiency</article-title>. <source>J. Comput. Graph. Stat</source>., <volume>20</volume>, <fpage>531</fpage>–<lpage>570</lpage>.</mixed-citation>
    </ref>
    <ref id="btaa199-B53">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Zhang</surname><given-names>H.</given-names></name></person-group> (<year>2004</year>) 
<article-title>Inconsistent estimation and asymptotically equal interpolations in model-based geostatistics</article-title>. <source>J. Am. Stat. Assoc</source>., <volume>99</volume>, <fpage>250</fpage>–<lpage>261</lpage>.</mixed-citation>
    </ref>
  </ref-list>
</back>
