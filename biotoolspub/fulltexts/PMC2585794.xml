<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20031101//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing.dtd?>
<?SourceDTD.Version 2.3?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS Genet</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS Genet</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-id journal-id-type="pmc">plosgen</journal-id>
    <journal-title-group>
      <journal-title>PLoS Genetics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1553-7390</issn>
    <issn pub-type="epub">1553-7404</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">2585794</article-id>
    <article-id pub-id-type="pmid">19057666</article-id>
    <article-id pub-id-type="publisher-id">08-PLGE-RA-0255R3</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pgen.1000279</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="Discipline">
        <subject>Genetics and Genomics</subject>
        <subject>Mathematics/Statistics</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Practical Issues in Imputation-Based Association Mapping</article-title>
      <alt-title alt-title-type="running-head">Imputation-Based Association Mapping</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Guan</surname>
          <given-names>Yongtao</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="aff2">
          <sup>2</sup>
        </xref>
        <xref ref-type="corresp" rid="cor1">
          <sup>*</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Stephens</surname>
          <given-names>Matthew</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="aff2">
          <sup>2</sup>
        </xref>
        <xref ref-type="corresp" rid="cor1">
          <sup>*</sup>
        </xref>
      </contrib>
    </contrib-group>
    <aff id="aff1">
      <label>1</label>
      <addr-line>Department of Human Genetics, University of Chicago, Chicago, Illinois, United States of America</addr-line>
    </aff>
    <aff id="aff2">
      <label>2</label>
      <addr-line>Department of Statistics, University of Chicago, Chicago, Illinois, United States of America</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Schork</surname>
          <given-names>Nicholas J.</given-names>
        </name>
        <role>Editor</role>
        <xref ref-type="aff" rid="edit1"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">University of California San Diego and The Scripps Research Institute, United States of America</aff>
    <author-notes>
      <corresp id="cor1">* E-mail: <email>ytguan@uchicago.edu</email> (YG); <email>mstephens@uchicago.edu</email> (MS)</corresp>
      <fn fn-type="con">
        <p>Conceived and designed the experiments: YG MS. Performed the experiments: YG. Analyzed the data: YG MS. Contributed reagents/materials/analysis tools: YG MS. Wrote the paper: YG MS.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="collection">
      <month>12</month>
      <year>2008</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>5</day>
      <month>12</month>
      <year>2008</year>
    </pub-date>
    <volume>4</volume>
    <issue>12</issue>
    <elocation-id>e1000279</elocation-id>
    <history>
      <date date-type="received">
        <day>3</day>
        <month>3</month>
        <year>2008</year>
      </date>
      <date date-type="accepted">
        <day>27</day>
        <month>10</month>
        <year>2008</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Guan, Stephens.</copyright-statement>
      <copyright-year>2008</copyright-year>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are properly credited.</license-p>
      </license>
    </permissions>
    <abstract>
      <p>Imputation-based association methods provide a powerful framework for testing untyped variants for association with phenotypes and for combining results from multiple studies that use different genotyping platforms. Here, we consider several issues that arise when applying these methods in practice, including: (i) factors affecting imputation accuracy, including choice of reference panel; (ii) the effects of imputation accuracy on power to detect associations; (iii) the relative merits of Bayesian and frequentist approaches to testing imputed genotypes for association with phenotype; and (iv) how to quickly and accurately compute Bayes factors for testing imputed SNPs. We find that imputation-based methods can be robust to imputation accuracy and can improve power to detect associations, even when average imputation accuracy is poor. We explain how ranking SNPs for association by a standard likelihood ratio test gives the same results as a Bayesian procedure that uses an unnatural prior assumption—specifically, that difficult-to-impute SNPs tend to have larger effects—and assess the power gained from using a Bayesian approach that does not make this assumption. Within the Bayesian framework, we find that good approximations to a full analysis can be achieved by simply replacing unknown genotypes with a point estimate—their posterior mean. This approximation considerably reduces computational expense compared with published sampling-based approaches, and the methods we present are practical on a genome-wide scale with very modest computational resources (e.g., a single desktop computer). The approximation also facilitates combining information across studies, using only summary data for each SNP. Methods discussed here are implemented in the software package BIMBAM, which is available from <ext-link ext-link-type="uri" xlink:href="http://stephenslab.uchicago.edu/software.html">http://stephenslab.uchicago.edu/software.html</ext-link>.</p>
    </abstract>
    <abstract abstract-type="summary">
      <title>Author Summary</title>
      <p>Genotype imputation is becoming a popular approach to comparing and combining results of multiple association studies that used different SNP genotyping platforms. The basic idea is to exploit the fact that, due to correlation among untyped and typed SNPs, genotypes of untyped SNPs in each study can be inferred (“imputed”) from the genotypes at typed SNPs, often with high accuracy. In this paper, we consider several issues that arise when applying these methods in practice, including factors affecting imputation accuracy, the importance of taking account of imputation uncertainty when testing for association between imputed SNPs and phenotype, how imputation accuracy affects power, and how to combine results across studies when only single-SNP summary data can be shared among research groups.</p>
    </abstract>
    <counts>
      <page-count count="11"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec id="s1">
    <title>Introduction</title>
    <p>Ongoing large-scale genetic association studies, in an attempt to identify variants and genes affecting susceptibility to common diseases, are typing hundreds of thousands of SNPs in thousands of individuals, and testing these SNPs for association with phenotypes. Although this is a large number of SNPs, an even larger number of SNPs remain untyped. For example, the International HapMap Project contains genotype data on more than 3 million SNPs <xref rid="pgen.1000279-The1" ref-type="bibr">[1]</xref>, many of which will not be typed in current studies. Imputation-based association analysis <xref rid="pgen.1000279-Servin1" ref-type="bibr">[2]</xref>,<xref rid="pgen.1000279-Marchini1" ref-type="bibr">[3]</xref> provides a powerful framework for testing these untyped variants for association with a phenotype.</p>
    <p>The idea behind these imputation-based approaches is to exploit the fact that untyped SNPs are often correlated with typed SNPs, so genotype data on typed SNPs can be used to indirectly test untyped SNPs for association with phenotypes. Specifically, the approaches in <xref rid="pgen.1000279-Servin1" ref-type="bibr">[2]</xref>,<xref rid="pgen.1000279-Marchini1" ref-type="bibr">[3]</xref> exploit available information about patterns of correlation among typed and untyped SNPs in a reference <italic>panel</italic> of densely-genotyped individals (e.g. the HapMap samples) to explicitly predict, or “impute”, the genotypes at untyped SNPs in a study sample, and then test these imputed genotypes for association with a phenotype, taking account of uncertainty in the imputed genotypes. We emphasise this last point, because imputation could be interpreted as testing a single estimate of the genotypes (as in <xref rid="pgen.1000279-Lin1" ref-type="bibr">[4]</xref>, for example), ignoring uncertainty, whereas we take a broader interpretation, to include methods that incorporate uncertainty in imputed genotypes.</p>
    <p>Testing untyped variants via imputation both increases power to detect associations <xref rid="pgen.1000279-Servin1" ref-type="bibr">[2]</xref>,<xref rid="pgen.1000279-Marchini1" ref-type="bibr">[3]</xref> and provides improved explanations for detected associations, for example by helping to identify the most plausible causal variant or variants <xref rid="pgen.1000279-Servin1" ref-type="bibr">[2]</xref>. Imputation also provides a powerful framework for combining information across multiple association studies performed on different genotyping platforms, since it allows each study to test the same set of SNPs regardless of the genotyping platform used (e.g. <xref rid="pgen.1000279-Scott1" ref-type="bibr">[5]</xref>,<xref rid="pgen.1000279-Reiner1" ref-type="bibr">[6]</xref>).</p>
    <p>Here we focus on several important issues that arise when applying imputation-based methods in practice. These include i) factors affecting imputation accuracy, including choice of reference panel; ii) the effects of imputation accuracy on power to detect associations; iii) the relative merits of Bayesian and frequentist approaches to testing imputed genotypes for association with phenotype; and iv) how to quickly and accurately compute Bayes factors for testing imputed SNPs.</p>
    <p>We find that imputation-based methods can be relatively robust to imputation accuracy: small changes in imputation accuracy produce small changes in power to detect associations, and even when average imputation accuracy is poor (as could occur if the panel is not well-matched to the study sample), imputation-based approaches can still improve power compared with no imputation. Comparing frequentist and Bayesian methods for testing imputed SNPs, we note that ranking SNPs by their <italic>p</italic> value from a likelihoood ratio test gives the same results as a Bayesian procedure based on a particular prior assumption–specifically that difficult-to-impute SNPs tend to have a larger effect on phenotype. We argue that since this assumption is unnatural, alternative Bayesian approaches that do not make this assumption should have an advantage, in principle, for testing untyped SNPs. We illustrate the practical effect of this advantage via simulation experiments. Within the Bayesian framework we find that good approximations to a full analysis can be achieved by simply replacing unknown genotypes with a point estimate, their posterior mean. This approximation produces results that are more accurate, and orders of magnitude faster to compute, than sampling-based estimates used by <xref rid="pgen.1000279-Servin1" ref-type="bibr">[2]</xref>,<xref rid="pgen.1000279-Marchini1" ref-type="bibr">[3]</xref>. Indeed, the resulting approximation is faster, even, than application of standard frequentist methods in this context, and the methods we discuss are fast enough to be practical on a genome-wide scale with very modest computational resources (e.g. a single desktop computer). The accuracy of this approximation also has helpful implications for combining information across studies in situations where only single SNP summary data can be easily shared.</p>
    <sec id="s1a">
      <title>Imputation-Based Association Mapping</title>
      <p>We now describe more formally the imputation-based approaches to association mapping that we take here, and introduce notation for use in later sections. Readers whose primary interest is in our practical findings may wish to skip the <xref ref-type="sec" rid="s2">Results</xref> section, and refer back to this section for reference.</p>
      <p>The imputation-based approach we take here is based on using a “prospective” model relating phenotypes to genotypes, and so is appropriate for analyzing phenotypes and genotypes on individuals sampled randomly from a population. We consider its applicability to other designs, such as case-control studies, in the <xref ref-type="sec" rid="s3">Discussion</xref>. (See <xref rid="pgen.1000279-Lin1" ref-type="bibr">[4]</xref> for related work based on a retrospective likelihood.)</p>
      <p>Let <italic>Y</italic> denote measured phenotype values for <italic>n</italic> randomly-sampled individuals on whom genome-scan genotype data <italic>G</italic> have been collected. We use <italic>y<sub>i</sub></italic> to denote the phenotype of individual <italic>i</italic>, and g<italic><sub>ij</sub></italic> for the genotype of individual <italic>i</italic> at SNP <italic>j</italic> (coded as 0, 1 or 2 copies of the minor allele), with g<sub>·<italic>j</italic></sub> denoting the vector of genotypes at SNP <italic>j</italic>. We also assume the availability of denser genotype (or haplotype) data, <italic>H</italic>, on a “panel” of unrelated, unphenotyped, individuals. In our examples this panel will consist of subsets of individuals from the International HapMap Project. For notational simplicity we assume that the columns of <italic>H</italic> and <italic>G</italic> are augmented, as necessary, so that they refer to the same set of SNPs (i.e. so they have the same number of columns, with the <italic>j</italic>th column of each referring to the same SNP <italic>j</italic>). Thus, if a SNP <italic>j</italic> is typed in <italic>H</italic> but not in <italic>G</italic> then g<sub>·<italic>j</italic></sub> will consist of all “missing” observations.</p>
      <p>The aim of our imputation-based mapping approach is to assess whether a SNP, <italic>j</italic>, that is genotyped in <italic>H</italic> but not in <italic>G</italic>, is associated with the phenotype <italic>Y</italic>. Let <italic>β</italic> denote the parameters in a model that relates phenotypes <italic>Y</italic> with genotypes g<sub>·<italic>j</italic></sub> at SNP <italic>j</italic>. To obtain a likelihood for <italic>β</italic>, given the observed data <italic>Y</italic>, <italic>G</italic>, <italic>H</italic>, we take the standard regression-based approach of conditioning on the genotypes <italic>G</italic>, <italic>H</italic>, and using the conditional distribution <italic>p</italic>(<italic>Y</italic>|<italic>G</italic>, <italic>H</italic>, <italic>β</italic>) as the likelihood. This approach implicitly assumes that the genotypes alone contain no information about <italic>β</italic> (or, at least, it ignores any such information). [Although in principal the genotypes alone <italic>could</italic> provide information about whether a SNP has an effect on phenotype (e.g. through signatures of selection), such information seems likely to be both limited, and difficult to extract.] Under this assumption the likelihood for <italic>β</italic> can be written as<disp-formula><graphic xlink:href="pgen.1000279.e001.jpg" mimetype="image" position="float"/><label>(1)</label></disp-formula>where the last line invokes the assumption that the genotype distribution does not depend on <italic>β</italic>.</p>
      <p>From Expression (1) we see that, for an untyped SNP, the likelihood is a weighted average of the complete data likelihood (i.e. the likelihood if the genotypes at SNP <italic>j</italic> were observed to be g<sub>·<italic>j</italic></sub>) over all possible values of g<sub>·<italic>j</italic></sub>. The weights, Pr(g<sub>·<italic>j</italic></sub> = g|<italic>G</italic>, <italic>H</italic>), are determined by the distribution of the unobserved genotypes given the observed genotypes (which can be obtained in several ways; here we use methods from <xref rid="pgen.1000279-Scheet1" ref-type="bibr">[7]</xref>). This sum has too many terms to be computed directly. However, if the two distributions that occur in each term of this sum are independent across individuals, as they will be in settings considered here, then the likelihood simplifies to a computationally-tractable form:<disp-formula><graphic xlink:href="pgen.1000279.e002.jpg" mimetype="image" position="float"/><label>(2)</label></disp-formula>
</p>
      <p>We will compare two different approaches to using this likelihood to test the null hypothesis <italic>H</italic>
<sub>0</sub> that SNP <italic>j</italic> is unassociated with phenotype, versus the alternative hypothesis <italic>H</italic>
<sub>1</sub> that SNP <italic>j</italic> is associated with phenotype. The first approach is to use the generalized likelihood ratio test statistic,<disp-formula><graphic xlink:href="pgen.1000279.e003.jpg" mimetype="image" position="float"/><label>(3)</label></disp-formula>where <italic>βˆ</italic>
<sub>0</sub> and <italic>βˆ</italic>
<sub>1</sub> denote the maximum likelihood estimates of <italic>β</italic> under <italic>H</italic>
<sub>0</sub> and <italic>H</italic>
<sub>1</sub> respectively. Under standard theory, 2log(Λ) has an asymptotic <italic>χ</italic>
<sup>2</sup> distribution under <italic>H</italic>
<sub>0</sub>.</p>
      <p>The second approach we consider is the Bayesian approach from <xref rid="pgen.1000279-Servin1" ref-type="bibr">[2]</xref>. In Bayesian statistics, the strength of the evidence for <italic>H</italic>
<sub>1</sub> vs <italic>H</italic>
<sub>0</sub> is given by the Bayes factor for <italic>H</italic>
<sub>1</sub> vs <italic>H</italic>
<sub>0</sub>, defined as<disp-formula><graphic xlink:href="pgen.1000279.e004.jpg" mimetype="image" position="float"/><label>(4)</label></disp-formula>where <italic>p</italic>
<sub>0</sub> (·) and <italic>p</italic>
<sub>1</sub> (·) denote prior distributions on <italic>β</italic> under <italic>H</italic>
<sub>0</sub> and <italic>H</italic>
<sub>1</sub>. Note that this expression for the Bayes factor bears some resemblance to the likelihood ratio Λ, but whereas in Λ the numerator and denominator are maximised with respect to unknown parameters <italic>β</italic>, in the Bayes factor they are <italic>integrated</italic> with respect to these parameters, weighted by the prior (which has the effect of averaging over plausible values of the parameters). Large values of the Bayes factor indicate evidence for <italic>H</italic>
<sub>1</sub> over <italic>H</italic>
<sub>0</sub>, whereas small values indicate evidence for <italic>H</italic>
<sub>0</sub> over <italic>H</italic>
<sub>1</sub>. Bayes factors have a number of general advantages over <italic>p</italic> values as measures of evidence <xref rid="pgen.1000279-Servin1" ref-type="bibr">[2]</xref>,<xref rid="pgen.1000279-Wakefield1" ref-type="bibr">[8]</xref>,<xref rid="pgen.1000279-Wellcome1" ref-type="bibr">[9]</xref>, and, as we show below, a particular advantage, at least in principle, when testing untyped SNPs.</p>
      <p>For a typed SNP at which genotypes are observed to be g, the Bayes factor, BF(g), can sometimes be computed analytically (see below). For an untyped SNP the Bayes factor is the weighted average of BF(g) over all possible values for g. Indeed, substituting the likelihood (1) into the numerator of (4) gives<disp-formula><graphic xlink:href="pgen.1000279.e005.jpg" mimetype="image" position="float"/><label>(5)</label></disp-formula>Since this sum typically has too many terms to be computed directly, it must be approximated by computational methods; we compare three different methods later in this paper.</p>
    </sec>
    <sec id="s1b">
      <title>Example: Normal Phenotype</title>
      <p>We now give explicit expressions for the likelihood and Bayes factor in the case of a continuous (quantitative) phenotype <italic>Y</italic>, which will be our primary focus for the rest of this paper. We assume a normal linear model relating <italic>Y</italic> to the genotypes g<sub>·<italic>j</italic></sub> at a SNP <italic>j</italic> of interest:<disp-formula><graphic xlink:href="pgen.1000279.e006.jpg" mimetype="image" position="float"/><label>(6)</label></disp-formula>where <italic>μ</italic> is the phenotype mean for individuals with g<italic><sub>ij</sub></italic> = 0; <italic>a</italic> and <italic>d</italic> represent, respectively, an additive and dominance effect for SNP <italic>j</italic>; <bold>1</bold>(<italic>A</italic>) is the indicator function, taking value 1 if <italic>A</italic> is true, and 0 otherwise; and <italic>ε<sub>i</sub></italic> are independent and identically distributed <italic>N</italic>(0,1/<italic>τ</italic>) error terms, where 1/<italic>τ</italic> represents the variance of <italic>Y</italic> within each genotype class. Thus the parameters in this model are <italic>β</italic> = (<italic>μ</italic>, <italic>a</italic>, <italic>d</italic>, <italic>τ</italic>), and the null hypothesis <italic>H</italic>
<sub>0</sub> is <italic>a</italic> = <italic>d</italic> = 0.</p>
      <p>Under this model, the likelihood (2) becomes, for each <italic>y<sub>i</sub></italic>, a mixture of three normal distributions:<disp-formula><graphic xlink:href="pgen.1000279.e007.jpg" mimetype="image" position="float"/><label>(7)</label></disp-formula>where <italic>N</italic>(·;<italic>α</italic>, <italic>τ</italic>) denotes the normal density with mean <italic>α</italic> and variance 1/<italic>τ</italic>, and <italic>α</italic>
<sub>0</sub> = <italic>μ</italic>, <italic>α</italic>
<sub>1</sub> = <italic>μ</italic>+<italic>a</italic>+<italic>d</italic>, <italic>α</italic>
<sub>2</sub> = <italic>μ</italic>+2<italic>a</italic>.</p>
      <p>To compute Bayes factors, we use a prior based on prior D2 from <xref rid="pgen.1000279-Servin1" ref-type="bibr">[2]</xref>. Among other assumptions, this prior assumes that <italic>a</italic> and <italic>d</italic> are independent and normally distributed, with mean 0, and respective variances <inline-formula><inline-graphic xlink:href="pgen.1000279.e008.jpg" mimetype="image"/></inline-formula>. As noted by <xref rid="pgen.1000279-Servin1" ref-type="bibr">[2]</xref>, the assumption that <italic>a</italic> and <italic>d</italic> are a priori independent is not ideal, since one might expect <italic>a</italic> and <italic>d</italic> to be dependent. However, dependence can easily be introduced by averaging results from prior D2 over several values of <italic>σ<sub>a</sub></italic> and <italic>σ<sub>d</sub></italic>, as we do here. Furthermore, in simulations, <xref rid="pgen.1000279-Servin1" ref-type="bibr">[2]</xref> found that the results from this prior generally agreed well with results from another prior, D1, based on more realistic assumptions.</p>
      <p>Under this prior, the Bayes factor for a SNP with genotypes g, BF(g), can be computed analytically (<xref rid="pgen.1000279-Servin1" ref-type="bibr">[2]</xref>, Protocol S1):<disp-formula><graphic xlink:href="pgen.1000279.e009.jpg" mimetype="image" position="float"/><label>(8)</label></disp-formula>where <italic>Y̅</italic> is the mean of the phenotypes <italic>Y</italic>; <italic>ν</italic>
<sup>−1</sup> is the 3×3 diagonal matrix with diagonal elements <inline-formula><inline-graphic xlink:href="pgen.1000279.e010.jpg" mimetype="image"/></inline-formula>; and <italic>X</italic> is an n×3 design matrix, which is a function of the genotypes g. Specifically, the first column of <italic>X</italic> is a vector of 1s, the second column is the vector of genotypes g, and the third column is a vector of indicators for whether the genotypes are heterozygotes (<italic>X<sub>i</sub></italic>
<sub>3</sub> = <bold>1</bold>(<italic>g<sub>i</sub></italic> = 1)).</p>
      <p>To compute the likelihood ratio (3) and Bayes factor (5) we now need two things. First, we need expressions for Pr(g<sub>·<italic>j</italic></sub> = g|<italic>G</italic>, <italic>H</italic>); that is, we need to have ways to estimate the (distribution of) genotypes at SNP <italic>j</italic> from the observed genotype data <italic>G</italic>, <italic>H</italic>. Second, because the sum (5) is over all possible genotypes at SNP <italic>j</italic>, and therefore typically contains a very large number of terms, we need efficient computational methods for approximating this sum. (In contrast, Λ can be obtained relatively easily by numerical optimisation of (2) over <italic>β</italic>.) The first two sections of the results, Genotype Imputation, and Bayes Factor Calculation, deal with each of these two issues in turn. Subsequent sections deal with comparisons of the use of the Bayes factor and Λ to detect associations with phenotypes, and the effects of imputation accuracy on power to detect associations.</p>
    </sec>
  </sec>
  <sec id="s2">
    <title>Results</title>
    <sec id="s2a">
      <title>Genotype Imputation</title>
      <p>While there are many possible approaches to predicting unknown genotypes from patterns of LD <xref rid="pgen.1000279-Nicolae1" ref-type="bibr">[e.g. 10]</xref>,<xref rid="pgen.1000279-Dai1" ref-type="bibr">[11]</xref>,<xref rid="pgen.1000279-Browning1" ref-type="bibr">[12]</xref>, both <xref rid="pgen.1000279-Servin1" ref-type="bibr">[2]</xref>,<xref rid="pgen.1000279-Marchini1" ref-type="bibr">[3]</xref> use similar methods based on Hidden Markov models: the PAC model from <xref rid="pgen.1000279-Li1" ref-type="bibr">[13]</xref> implemented in software PHASE and IMPUTE, and the cluster-based model from <xref rid="pgen.1000279-Scheet1" ref-type="bibr">[7]</xref> implemented in software fastPHASE and BIMBAM. In comparisons in <xref rid="pgen.1000279-Scheet1" ref-type="bibr">[7]</xref> the two models produced very similar accuracy for imputed genotypes, and were more accurate than other methods considered. Both models also produced approximately calibrated predictions (e.g. genotypes assigned a probability of 90% by these models were correct in approximately 90% of cases). Here we focus on the cluster-based model from <xref rid="pgen.1000279-Scheet1" ref-type="bibr">[7]</xref> because it has certain computational and practical advantages over the PAC model (e.g. it can deal easily with unphased panel data). However, we expect many of our conclusions to apply more generally (e.g. see <xref ref-type="sec" rid="s3">Discussion</xref>).</p>
      <p>In brief, the model from <xref rid="pgen.1000279-Scheet1" ref-type="bibr">[7]</xref> assumes that each SNP along each sampled haplotype has an (unknown) cluster membership that changes, in a Markovian way, along the chromosome. Conditional on cluster memberships, alleles are sampled independently from cluster-specific and SNP-specific allele frequencies, <italic>θ</italic>. Other parameters of the model include the jump rates for cluster memberships, <italic>r</italic>; and the probabilities of jumping to each cluster, <italic>α</italic>. In the most general version of the model, which we consider here, both <italic>r</italic> and <italic>α</italic> are allowed to vary along the genome; see <xref rid="pgen.1000279-Scheet1" ref-type="bibr">[7]</xref> for full details. <xref rid="pgen.1000279-Scheet1" ref-type="bibr">[7]</xref> give an EM algorithm for estimating the parameters (<italic>θ</italic>, <italic>α</italic>, <italic>r</italic>) from either phased or unphased genotype data, and describe how the model can be used to impute missing genotypes and estimate haplotypic phase. For example, given parameter estimates (<italic>θ̂</italic>, <italic>α̂</italic>, <italic>r̂</italic>), the distribution of a missing genotype in individual <italic>i</italic> at SNP <italic>j</italic> can be approximated as Pr(g<italic><sub>ij</sub></italic> = g|g<italic><sub>i</sub></italic>
<sub>·</sub>,<italic>θ̂</italic>,<italic>α̂</italic>,<italic>r̂</italic>) where g<italic><sub>i</sub></italic>
<sub>·</sub> is the vector of observed genotypes in individual <italic>i</italic>.</p>
      <p><xref rid="pgen.1000279-Scheet1" ref-type="bibr">[7]</xref> compared several approaches to genotype imputation using data with genotypes missing at random. In their comparisons the cluster-based model provided more accurate imputed genotypes than other methods provided that i) the number of clusters was sufficiently large, and ii) predictions of genotype probabilities were averaged across multiple applications of the EM algorithm. Here we examine factors affecting the accuracy of genotypes imputed using this model in the context of imputation-based association mapping, where patterns of missingness are highly structured, not random. We took a genotype data, <italic>G</italic>, on chromosome 22 from 675 Caucasian individuals enrolled in the PRINCE study <xref rid="pgen.1000279-Albert1" ref-type="bibr">[14]</xref> who have been genotyped on the Illumina 317k chip as part of an ongoing genome-wide association study to study statin response and lipid-related phenotypes. To provide a set of test SNPs on which to assess imputation accuracy we masked all 675 genotypes at every 25th SNP (masking 220 SNPs in each trial, this procedure being repeated 5 times by shifting the starting SNP, so masking 1100 SNPs in total). We then assessed various strategies for using the cluster-based model to impute the masked genotypes, using subsets of the HapMap data as a panel, <italic>H</italic>. Except where noted, results here are based on using the 60 HapMap CEU (European) parents as the panel. We assessed accuracy of imputed genotypes by comparing the true genotypes with the “best guess” imputed genotypes (i.e. the genotype assigned the highest probability) and computing the genotype error rate, being the proportion of best guess genotypes that are incorrect.</p>
      <sec id="s2a1">
        <title>Methods of Parameter Estimation</title>
        <p>Our first, most striking, finding is that imputing genotypes using parameter estimates obtained by maximising the full likelihood <italic>L</italic>(<italic>θ</italic>, <italic>α</italic>, <italic>r</italic>; <italic>G</italic>, <italic>H</italic>) = Pr(<italic>G</italic>, <italic>H</italic>|<italic>θ</italic>, <italic>α</italic>, <italic>r</italic>) performs much less well than imputing genotypes using parameter estimates obtained by maximising the likelihood for <italic>H</italic> only, <italic>L</italic>(<italic>θ</italic>, <italic>α</italic>, <italic>r</italic>; <italic>H</italic>) = Pr(<italic>H</italic>|<italic>θ</italic>, <italic>α</italic>, <italic>r</italic>). For example, when using the CEU HapMap parents (phased data) as a panel, the genotype error rates for these two strategies were, respectively, ∼12% vs ∼6%. The poor performance of the former strategy is not simply due to the EM algorithm getting stuck in poor local modes in the likelihood surface for the larger data set: after first fitting the model to <italic>H</italic> only, applying additional iterations of the EM algorithm with the full data <italic>G</italic>, <italic>H</italic> also worsened imputation accuracy (data not shown).</p>
        <p>These results may appear initially counter-intuitive. However, we note that in the available data, only <italic>H</italic> contains information about patterns of LD between typed and untyped SNPs, which is the relevant information when using typed SNPs to impute untyped SNPs. For example, if genotypes at SNPs <italic>A</italic> and <italic>B</italic> are predictive of genotypes at a SNP <italic>C</italic>, and <italic>A</italic> and <italic>B</italic> are typed in the cohort, but <italic>C</italic> is untyped, then all that matters for predicting genotypes at <italic>C</italic> is the conditional distribution Pr(g<italic><sub>C</sub></italic>|g<italic><sub>A</sub></italic>,g<italic><sub>B</sub></italic>) (in an obvious notation); in particular, information on LD between <italic>A</italic> and <italic>B</italic> is irrelevant. The cohort data <italic>G</italic>, which contain data on only the typed SNPs <italic>A</italic> and <italic>B</italic>, do not contain information about this conditional distribution, and so including <italic>G</italic> in the model fit cannot improve imputation accuracy at <italic>C</italic>. This explains why including <italic>G</italic> in the model fit does not improve imputation accuracy, and also supports the strategy used by <xref rid="pgen.1000279-Marchini1" ref-type="bibr">[3]</xref>, who perform imputation for each cohort individual independently conditional only on the panel data. It does not however fully explain why including <italic>G</italic> in the model fit actually <italic>worsens</italic> imputation accuracy. A possible explanation for this is that fitting the model to <italic>G</italic> and <italic>H</italic> effectively reduces the number of clusters available to model <italic>H</italic>, since some are “stolen” by the large number of individuals in <italic>G</italic>, and it is this effective reduction in the number of clusters that worsens imputation accuracy. (Note that one might expect including <italic>G</italic> in the model fit to improve imputation accuracy at sporadically missing genotypes at typed SNPs in <italic>G</italic>—as opposed to systematically missing genotypes at untyped SNPs that are the main focus of imputation—since here LD among typed SNPs is what matters, and <italic>G</italic> contains information on this. In separate experiments (results not shown) we did observe that fitting the model using (<italic>G</italic>, <italic>H</italic>) produced a small improvement in this type of imputation accuracy compared with fitting it to <italic>H</italic> alone.)</p>
        <p>Besides increasing imputation accuracy at untyped SNPs, fitting the model to <italic>H</italic> alone has the happy consequence of considerably reducing computational expense, particularly in studies with many individuals. This computational saving is due both to the reduced number of individuals in <italic>H</italic> compared with <italic>H</italic>, <italic>G</italic>, and to the fact that <italic>H</italic> can often be assumed phase-known (computational cost for phased data is linear in <italic>K</italic>, whereas for unphased data it is quadratic in <italic>K</italic>).</p>
      </sec>
      <sec id="s2a2">
        <title>Number of Clusters and EM Iterations</title>
        <p>We found that accuracy of imputed genotypes improved with increased number of clusters (<italic>K</italic>), and with the number of EM runs over which results were averaged (<italic>E</italic>); see <xref ref-type="table" rid="pgen-1000279-t001">Table 1</xref>. However, differences in genotype accuracy across different values of these parameters were relatively minor (error rates all lay in the range 6.2%–7.3%). Substantially increasing the number of clusters, to 100, produced essentially the same accuracy as using 30 clusters (data not shown). We also experimented with increasing the number of iterations per EM run to improve convergence of parameter estimates during the model fitting procedure, but this did not consistently improve accuracy (error rates typically changed by less than 0.1%, sometimes increasing, sometimes decreasing).</p>
        <table-wrap id="pgen-1000279-t001" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pgen.1000279.t001</object-id>
          <label>Table 1</label>
          <caption>
            <title>Error rates (proportion of cases where the most probable genotype does not match the true genotype) for different genotype imputation strategies, using the model of <xref rid="pgen.1000279-Scheet1" ref-type="bibr">[7]</xref> and the (phased) CEU HapMap parents as a panel.</title>
          </caption>
          <alternatives>
            <graphic id="pgen-1000279-t001-1" xlink:href="pgen.1000279.t001"/>
            <table frame="hsides" rules="groups">
              <colgroup span="1">
                <col align="left" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
              </colgroup>
              <thead>
                <tr>
                  <td align="left" rowspan="1" colspan="1">Number of Clusters</td>
                  <td align="left" rowspan="1" colspan="1">Number of EM runs</td>
                  <td align="left" rowspan="1" colspan="1">Error Rate</td>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td align="left" rowspan="1" colspan="1">K = 10</td>
                  <td align="left" rowspan="1" colspan="1">E = 5</td>
                  <td align="left" rowspan="1" colspan="1">0.073</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">K = 10</td>
                  <td align="left" rowspan="1" colspan="1">E = 10</td>
                  <td align="left" rowspan="1" colspan="1">0.072</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">K = 10</td>
                  <td align="left" rowspan="1" colspan="1">E = 20</td>
                  <td align="left" rowspan="1" colspan="1">0.069</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">K = 20</td>
                  <td align="left" rowspan="1" colspan="1">E = 5</td>
                  <td align="left" rowspan="1" colspan="1">0.068</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">K = 20</td>
                  <td align="left" rowspan="1" colspan="1">E = 10</td>
                  <td align="left" rowspan="1" colspan="1">0.064</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">K = 20</td>
                  <td align="left" rowspan="1" colspan="1">E = 20</td>
                  <td align="left" rowspan="1" colspan="1">0.064</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">K = 30</td>
                  <td align="left" rowspan="1" colspan="1">E = 5</td>
                  <td align="left" rowspan="1" colspan="1">0.064</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">K = 30</td>
                  <td align="left" rowspan="1" colspan="1">E = 10</td>
                  <td align="left" rowspan="1" colspan="1">0.063</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">K = 30</td>
                  <td align="left" rowspan="1" colspan="1">E = 20</td>
                  <td align="left" rowspan="1" colspan="1">0.062</td>
                </tr>
              </tbody>
            </table>
          </alternatives>
          <table-wrap-foot>
            <fn id="nt101">
              <p>We use <italic>K</italic> to denote the number of clusters used, and <italic>E</italic> to denote the number of EM runs over which genotype probabilities are averaged. In each case we used 10 iterations of the EM algorithm in each run.</p>
            </fn>
          </table-wrap-foot>
        </table-wrap>
      </sec>
      <sec id="s2a3">
        <title>Comparison with IMPUTE</title>
        <p>We compared imputation accuracy with that of the PAC model, used by <xref rid="pgen.1000279-Marchini1" ref-type="bibr">[3]</xref>, implemented in the software IMPUTE. For these data IMPUTE produced an error rate of 6.6% (X. Wen, personal communication), very similar to the results from our approach, confirming the finding from <xref rid="pgen.1000279-Scheet1" ref-type="bibr">[7]</xref> that the two models produce very similar genotype accuracy, at least provided <italic>K</italic> in the cluster-based model is set appropriately, and the cluster-based model is fitted only to <italic>H</italic>. (Note that the data we consider here come from chromosome 22, which has an above-average recombination rate, and hence below-average linkage disequilibrium. This is expected to make imputation harder than in typical genomic regions, and may partly explain why error rates reported here are slightly higher than in <xref rid="pgen.1000279-Marchini1" ref-type="bibr">[3]</xref>.)</p>
      </sec>
      <sec id="s2a4">
        <title>Unphased Panel</title>
        <p>One advantage of the cluster-based model over the PAC model is that it can easily deal with the situation where the panel of densely-genotyped individuals is unphased, whereas the PAC model is much harder to adapt to that setting (e.g. IMPUTE assumes that a phased panel is available). Since the HapMap provides many accurately phased individuals, this advantage will not always be important. However, it does make it easier to exploit any denser unphased genotype data that may be available in some cases (e.g. from resequencing of a candidate region). Motivated by this, we examined the effect of having an unphased panel, by performing imputation with the model fit to the <italic>unphased</italic> CEU HapMap parents. Compared with having a phased panel, the error rates for the unphased panel were consistently a few tenths of a percent higher (e.g. 7.6% vs. 7.2% for E = 10, K = 10).</p>
      </sec>
      <sec id="s2a5">
        <title>Mismatched Panel</title>
        <p>We examined the effect of having a panel that is not well matched to the sample, by using the African (YRI) and Asian (CHB+JPT) HapMap samples as a panel to impute genotypes in the European individuals. We found that using either of these panels individually substantially increased error rates (17% for CHB+JPT, 25% for YRI). However, using a combined panel of CEU+YRI+CHB+JPT gave an error rate only slightly higher than using CEU alone (7.8% for combined panel vs. 6.2–7.3% for CEU). This demonstrates that imputation accuracy can be relatively robust to mismatches between the panel and cohort samples, provided that the panel contains at least some individuals with genetic variation representative of the cohort. For intuition into why this happens, note that to impute an individual's genotypes, the cluster-based model (and, indeed, the PAC model) attempts to explain the individual's observed genotypes using a mosaic of panel haplotypes. This can work provided the panel contains suitable haplotypes, even if the panel also contains a large number of unsuitable haplotypes. Thus, although the issue of panel choice merits further study, using the combined panel should be a helpful strategy when imputing genotypes in a cohort that may not be well represented by a single HapMap analysis panel (e.g., admixed individuals).</p>
      </sec>
      <sec id="s2a6">
        <title>Trade-Off between Accuracy and Call Rate</title>
        <p>The error rates above are average error rates across all SNPs, assuming <italic>all</italic> genotypes are called (i.e. 100% call rate). Both the PAC and cluster-based models provide, for each genotype, a probability for each of the three possibilities. If we consider only those genotypes assigned a high probability then error rates can be substantially reduced, at the expense of reduced call rate. For example, if we call only those genotypes assigned a probability of at least 90% then the error rate is reduced to 1%, with a call rate of 74%. <xref ref-type="fig" rid="pgen-1000279-g001">Figure 1</xref> shows the correspondance between call rate and accuracy for these data. Although we have used different data, and different approaches to imputation, the results are rather similar to the analogous results in <xref rid="pgen.1000279-Marchini1" ref-type="bibr">[3]</xref> (their <xref ref-type="fig" rid="pgen-1000279-g001">Figure 1</xref>).</p>
        <fig id="pgen-1000279-g001" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pgen.1000279.g001</object-id>
          <label>Figure 1</label>
          <caption>
            <title>Graph showing the trade-off between call-rate and error rate, as the probability threshold for calling an imputed genotype is varied.</title>
            <p>Numbers along the line indicate the thresholds that produce the corresponding call rate and error rate; small black points indicate results for intermediate thresholds in increments of 0.02. For example, if we call only those imputed genotypes assigned probability &gt;0.9 of being correct, then approximately 74% of imputed genotypes are called, and of these called genotypes approximately 1% are incorrect.</p>
          </caption>
          <graphic xlink:href="pgen.1000279.g001"/>
        </fig>
      </sec>
    </sec>
    <sec id="s2b">
      <title>Bayes Factor Calculations</title>
      <p>The Bayes factor for an untyped SNP (Equation (5)) involves a sum over a very large number of terms, and it is computationally impractical to compute this sum directly. In practice then we must use methods to approximate this Bayes factor. Here we compare three different approaches to making this approximation.</p>
      <p>The first appproach is the “naive” Monte Carlo estimator used by both <xref rid="pgen.1000279-Servin1" ref-type="bibr">[2]</xref>,<xref rid="pgen.1000279-Marchini1" ref-type="bibr">[3]</xref>, given by:<disp-formula><graphic xlink:href="pgen.1000279.e011.jpg" mimetype="image" position="float"/><label>(9)</label></disp-formula>where g<sup>(1)</sup>,…,g<sup>(<italic>M</italic>)</sup> are independent and identically-distributed samples from <italic>Pr</italic>(g<sub>·<italic>j</italic></sub>|<italic>G</italic>, <italic>H</italic>). For sufficiently large <italic>M</italic> this estimator will give an accurate approximation to the BF (5). More precisely, it converges to the true value as <italic>M</italic>→∞. However, in practice we have found that for moderate values of <italic>M</italic> ( = 1,000 say) this estimator can have a large standard deviation, producing unreliable estimates for some SNPs (see below).</p>
      <p>The second approach is based on an importance sampling estimator <xref rid="pgen.1000279-Ripley1" ref-type="bibr">[e.g. 15]</xref>:<disp-formula><graphic xlink:href="pgen.1000279.e012.jpg" mimetype="image" position="float"/><label>(10)</label></disp-formula>where g<sup>(1)</sup>,…,g<sup>(<italic>M</italic>)</sup> are independent samples from an “importance sampling distribution” <italic>Q</italic>(·). With judicious choice of <italic>Q</italic> the standard deviation of this estimator, and hence the accuracy of the approximation, can be much improved compared with BF<sub>naive</sub>. Our importance sampling function is described in <xref ref-type="supplementary-material" rid="pgen.1000279.s001">Text S1</xref>.</p>
      <p>The third approach we consider is motivated by the simple idea of replacing unobserved genotypes at SNP <italic>j</italic> with their posterior mean, and computing a Bayes factor based on these posterior mean genotypes. To describe this approach more precisely, note that the Bayes factor for a typed SNP can be written as a function of a design matrix <italic>X</italic> (equation (8)). The approximation we consider is to replace <italic>X</italic> with its expected value, <italic>X̅</italic> (so in the second column of <italic>X</italic> each element g<italic><sub>ij</sub></italic> is replaced with E(g<italic><sub>ij</sub></italic>|<italic>G</italic>, <italic>H</italic>), and in the third column <italic>I</italic>(g<italic><sub>ij</sub></italic> = 1) is replaced with Pr(g<italic><sub>ij</sub></italic> = 1|<italic>G</italic>, <italic>H</italic>)) and to compute an approximate Bayes factor, BF<sub>mean</sub>, based on this expected design matrix:<disp-formula><graphic xlink:href="pgen.1000279.e013.jpg" mimetype="image" position="float"/><label>(11)</label></disp-formula>Since the elements of <italic>X̅</italic> can be computed analytically (using either the PAC or cluster-based model) the approximation BF<sub>mean</sub> is very quick to compute, reducing the number of Bayes factor evaluations by a factor of <italic>M</italic> (and thus, typically, reducing computation for each SNP by orders of magnitude, once imputation has been performed) compared with BF<sub>naive</sub> and BF<sub>IS</sub>.</p>
      <p>We compared the three approximations by applying them to the genome-scan genotype data on chromosome 22, described above, with phenotypes simulated under both null and alternative hypotheses (see next section for details). Bayes factors were computed by averaging over <italic>σ<sub>a</sub></italic> = 0.05, 0.1, 0.2, 0.4 and <italic>σ<sub>d</sub></italic> = <italic>σ<sub>a</sub></italic>/4. For the sampling-based estimators BF<sub>naive</sub> and BF<sub>IS</sub> we used <italic>M</italic> = 1,000. Values of BF<sub>mean</sub> were generally similar to both BF<sub>IS</sub>, and BF<sub>naive</sub> (<xref ref-type="fig" rid="pgen-1000279-g002">Figure 2</xref>), with the agreement with BF<sub>IS</sub> being better (presumably because BF<sub>IS</sub> has generally smaller standard error than BF<sub>naive</sub>; see red vertical bars on <xref ref-type="fig" rid="pgen-1000279-g002">Figure 2</xref>). Furthermore, at SNPs where the values disagreed most strongly, the standard error of the Monte-Carlo estimators tended to be large (see red vertical bars on <xref ref-type="fig" rid="pgen-1000279-g002">Figure 2</xref>), suggesting that at these SNPs the Monte-Carlo estimates may be unreliable. In summary, BF<sub>mean</sub> appears to provide an adequate approximation to the Bayes factor, more accurate (for <italic>M</italic> = 1,000) than the naive Monte Carlo estimates used by <xref rid="pgen.1000279-Servin1" ref-type="bibr">[2]</xref>,<xref rid="pgen.1000279-Marchini1" ref-type="bibr">[3]</xref>, and orders of magnitude quicker to compute.</p>
      <fig id="pgen-1000279-g002" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pgen.1000279.g002</object-id>
        <label>Figure 2</label>
        <caption>
          <title>Graphs showing correspondence of BF<sub>mean</sub> (<italic>x</italic>-axis) vs BF<sub>IS</sub> (<italic>y</italic>-axis on left panel) and BF<sub>naive</sub> (<italic>y</italic>-axis on right panel).</title>
          <p>In each case the diagonal blue line is <italic>y</italic> = <italic>x</italic>, and the vertical red lines indicate ±2 standard errors of the Bayes factor estimate (for example, on the left they run between log<sub>10</sub>(BF<sub>IS</sub>±2 standard errors)).</p>
        </caption>
        <graphic xlink:href="pgen.1000279.g002"/>
      </fig>
      <p>To explain why, and under what circumstances, BF<sub>mean</sub> provides an accurate approximation to the Bayes factor for <italic>H</italic>
<sub>1</sub> vs <italic>H</italic>
<sub>0</sub>, note that BF<sub>mean</sub> is, in fact, the Bayes factor for a different alternative hypothesis <inline-formula><inline-graphic xlink:href="pgen.1000279.e014.jpg" mimetype="image"/></inline-formula>,<disp-formula><graphic xlink:href="pgen.1000279.e015.jpg" mimetype="image" position="float"/><label>(12)</label></disp-formula>where <italic>ε<sub>i</sub></italic> are independent and identically distributed <italic>N</italic>(0,1/<italic>τ</italic>). The likelihood for this alternative hypothesis <inline-formula><inline-graphic xlink:href="pgen.1000279.e016.jpg" mimetype="image"/></inline-formula> is very similar to the likelihood for <italic>H</italic>
<sub>1</sub> (Equation 7). In particular <italic>Y<sub>i</sub></italic> has the same mean under <inline-formula><inline-graphic xlink:href="pgen.1000279.e017.jpg" mimetype="image"/></inline-formula> and <italic>H</italic>
<sub>1</sub>. The differences between the two are that i) under <inline-formula><inline-graphic xlink:href="pgen.1000279.e018.jpg" mimetype="image"/></inline-formula>, <italic>Y<sub>i</sub></italic> is normal, whereas under <italic>H</italic>
<sub>1</sub> it is a mixture of three normals; and ii) under <inline-formula><inline-graphic xlink:href="pgen.1000279.e019.jpg" mimetype="image"/></inline-formula> the variance of <italic>Y<sub>i</sub></italic> is the same for each <italic>i</italic>, whereas under <italic>H</italic>
<sub>1</sub> the variance of <italic>Y<sub>i</sub></italic> is larger for those <italic>i</italic> whose genotypes are less certain. These differences will be subtle unless <italic>a</italic> and <italic>d</italic> are large compared with 1/<italic>τ</italic> (since with small <italic>a</italic> and <italic>d</italic> the three components of the mixture will have similar means, making the mixture of normals very similar in shape to a normal, and ensuring that differences among individuals in variance of <italic>Y<sub>i</sub></italic> are small). In particular, our empirical results suggest that, at least for priors with <italic>σ<sub>a</sub></italic>&lt;0.4, BF<sub>mean</sub> generally provides an accurate approximation to the full Bayes factor. For different priors, using substantially larger values of <italic>σ<sub>a</sub></italic>, we have seen examples where the accuracy of the approximation is much poorer (data not shown). However, in genome-wide association studies, where effect sizes of single SNPs tend to be small, the use of such large values of <italic>σ<sub>a</sub></italic> will not generally be desirable or appropriate (although see next section).</p>
      <p>We note that it would be relatively straightforward to develop an improved approximation to the Bayes factor for <italic>H</italic>
<sub>1</sub> by modifying <inline-formula><inline-graphic xlink:href="pgen.1000279.e020.jpg" mimetype="image"/></inline-formula> to account for the different variances across <italic>i</italic>. We do not pursue this here since BF<sub>mean</sub> appears adequate for our purposes.</p>
      <p>In subsequent sections we use BF<sub>mean</sub> to approximate the Bayes factor. Motivated by the fact that BF<sub>mean</sub> is the Bayes factor for <inline-formula><inline-graphic xlink:href="pgen.1000279.e021.jpg" mimetype="image"/></inline-formula> vs <italic>H</italic>
<sub>0</sub>, we will also consider an analogous likelihood ratio statistic, Λ<sub>mean</sub>, defined to be the likelihood ratio statistic for <inline-formula><inline-graphic xlink:href="pgen.1000279.e022.jpg" mimetype="image"/></inline-formula> vs <italic>H</italic>
<sub>0</sub>. The statistic Λ<sub>mean</sub> has several practical advantages over Λ: it can be computed analytically (<xref ref-type="supplementary-material" rid="pgen.1000279.s002">Text S2</xref>), which results in a moderate computation saving (a factor of around 10–20 in our implementation, although the exact saving will depend on the details of the numerical optimisation scheme used to obtain Λ); and Λ<sub>mean</sub> can be easily obtained from standard regression software since <inline-formula><inline-graphic xlink:href="pgen.1000279.e023.jpg" mimetype="image"/></inline-formula> is a standard linear regression. (In terms of ranking SNPs in order of significance, Λ<sub>mean</sub> is equivalent to the standard <italic>F</italic> statistic for this regression.)</p>
    </sec>
    <sec id="s2c">
      <title>Choice of Test Statistic for Imputation-Based Analyses</title>
      <p>In this section we use both theoretical arguments and simulation experiments to compare and contrast the use of Bayes factors vs <italic>p</italic> values from likelihood ratio statistics for testing untyped SNPs for association.</p>
      <sec id="s2c1">
        <title>Theoretical Comparison</title>
        <p>Several authors have pointed out advantages of Bayes factors over <italic>p</italic> values as measures of evidence (see for example, in this context, <xref rid="pgen.1000279-Servin1" ref-type="bibr">[2]</xref>,<xref rid="pgen.1000279-Marchini1" ref-type="bibr">[3]</xref>,<xref rid="pgen.1000279-Wakefield1" ref-type="bibr">[8]</xref>). These advantages, which apply to both typed and untyped (imputed) SNPs, include many advantages of interpretation. For example, although <italic>p</italic> values have a straightforward interpretation in principle, they are notorious for being mis-interpreted in practice <xref rid="pgen.1000279-Sellke1" ref-type="bibr">[16]</xref>. Further, the strength of the evidence represented by a particular Bayes factor tends to be less sensitive to context than the evidence represented by a particular <italic>p</italic> value. For example, the probability that a SNP with a Bayes factor of, say, 10<sup>5</sup> is truly associated with the phenotype is the same whether the Bayes factor was computed from a sample of 100 or 10,000 individuals; whereas the probability that a SNP with a <italic>p</italic> value of, say, 10<sup>−6</sup> is truly associated with phenotype will be different in these two settings. In addition it is often desirable, and straightforward, to combine (by averaging) Bayes factors computed under different assumptions (e.g. averaging over additive and dominant models for effects, and thus allowing for dominance while maintaining some of the benefits of simpler additive models). However, in terms of the limited question of simply <italic>ranking</italic> SNPs for association with phenotype, <xref rid="pgen.1000279-Wakefield2" ref-type="bibr">[17]</xref> shows that, under an additive model (no dominance), standard single-SNP <italic>p</italic> values provide the same ranking of SNPs as a particular Bayesian analysis. Specifically, these <italic>p</italic> values give the same ranking as is obtained from Bayes factors computed under the assumption that, under <italic>H</italic>
<sub>1</sub>, the (prior) variance of effect sizes (<inline-formula><inline-graphic xlink:href="pgen.1000279.e024.jpg" mimetype="image"/></inline-formula> in this paper) is proportional to the variance of the maximum likelihood estimator (MLE) of the additive effect <italic>a</italic> at that SNP. Actually, <xref rid="pgen.1000279-Wakefield2" ref-type="bibr">[17]</xref> proves this result for a particular approximate Bayes factor and frequentist test statistic (the Wald statistic) in the setting of a logistic regression model; our <xref ref-type="supplementary-material" rid="pgen.1000279.s002">Text S2</xref> proves the analagous result for BF<sub>mean</sub> and Λ<sub>mean</sub> for the normal linear model. However, we expect that the result will hold more generally; see below for further discussion.</p>
        <p>We now provide a practical interpretation of these results for typed and untyped SNPs.</p>
        <p>For typed SNPs, the variance of the MLE is approximately proportional to 1/<italic>f</italic>(1−<italic>f</italic>), where <italic>f</italic> is the SNP minor allele frequency (MAF). Thus, as <xref rid="pgen.1000279-Wakefield2" ref-type="bibr">[17]</xref> points out, the result says that ranking SNPs by <italic>p</italic> values (from the Wald statistic, or Λ<sub>mean</sub>) can be thought of as making the implicit assumption that effect sizes tend to be larger for SNPs with a small MAF, and specifically that the expected square of the effect size is proportional to 1/<italic>f</italic>(1−<italic>f</italic>). Although we know of no strong evidence for this particular assumption, the general idea that rare SNPs may have larger effects is somewhat biologically plausible, providing a possible rationale for the use of <italic>p</italic> values in ranking typed SNPs for association.</p>
        <p>For untyped SNPs, the variance of the MLE depends not only on the MAF, but also on the confidence with which the untyped SNP genotypes are imputed: the larger the uncertainty in imputed genotypes, the larger the variance of the MLE. Thus, in addition to the assumption for typed SNPs, ranking untyped (imputed) SNPs by <italic>p</italic> values (from the Wald statistic or Λ<sub>mean</sub>) can be thought of as making the implicit assumption that <italic>the harder a SNP is to impute</italic>, <italic>the larger its expected effect size</italic>. This assumption seems hard to argue for on any grounds, and we believe that this explains the results in simulations below, where Λ and Λ<sub>mean</sub> show slightly poorer performance than Bayes factors that do not make this assumption.</p>
      </sec>
      <sec id="s2c2">
        <title>Empirical Comparisons</title>
        <p>To complement the above theoretical arguments, we compared methods empirically, using the real chromosome 22 genotype data described above and simulated phenotype data. To make the comparison as focussed as possible we compare results from the likelihood ratio statistics, Λ and Λ<sub>mean</sub>, with the Bayes factor BF<sub>mean</sub> based on the implicit prior assumed by the likelihood ratio statistic. That is, we used a prior in which the expected square of the effect size, <inline-formula><inline-graphic xlink:href="pgen.1000279.e025.jpg" mimetype="image"/></inline-formula>, is proportional to 1/<italic>f</italic>(1−<italic>f</italic>) (where <italic>f</italic> is the SNP MAF, estimated from the panel data). Specifically we averaged Bayes factors over four values, <inline-formula><inline-graphic xlink:href="pgen.1000279.e026.jpg" mimetype="image"/></inline-formula> with <italic>K</italic> = 0.05,0.1,0.2,0.4. (Note that for the small proportion of SNPs with very small <italic>f</italic> this produces very large values of <italic>σ<sub>a</sub></italic> for which the mean genotype approximation that we are using may not provide a very accurate approximation to the full Bayes factor. This presumably reduces power slightly compared with what could be achieved using a better approximation.) All statistics were computed under a pure additive model (<italic>d</italic> = <italic>σ<sub>d</sub></italic> = 0).</p>
        <p>The key point here is that the priors for the Bayesian approach were chosen so that, under the theory outlined above, the Bayesian and frequentist test statistics will provide the same rankings for typed SNPs. Thus any difference between the methods in ranking SNPs must be due to differences in the treatment of untyped imputed SNPs.</p>
        <p>We simulated phenotype data under two scenarios. The first scenario makes the assumption (also made by the testing methods) that the additive effect at the causal SNP depends on MAF <inline-formula><inline-graphic xlink:href="pgen.1000279.e027.jpg" mimetype="image"/></inline-formula>. The second scenario assumes that the effect size is constant, independent of MAF (<italic>a</italic> = 0.2). These values of <italic>a</italic> provide modest power to detect effects with the sample size (<italic>n</italic> = 675) we use here. Both scenarios assumed no dominance, <italic>d</italic> = 0, consistent with the assumptions made in computing the statistics. For each value of <italic>a</italic> we simulated 1100 sets of phenotypes. Each set of phenotypes was simulated by selecting a masked SNP to be the “causal” variant, and then generating phenotype values according to equation 6. This essentially creates 1100 independent genome scan datasets, for chromosome 22 only, each containing a single causal variant.</p>
        <p>We applied imputation-based association mapping to each dataset, using the HapMap CEU individuals as a panel, and computing test statistics (BF<sub>mean</sub>, Λ and Λ<sub>mean</sub>) for each typed and untyped SNP. To examine effects of lower average imputation accuracy (and confidence) we repeated this experiment using the YRI individuals as a panel. In each case the causal variants were assumed to be untyped (i.e., the genotypes at the causal variant were assumed to be unknown, and were imputed along with all other untyped SNPs). To compute Λ we used numerical maximisation (Nelder-Mead) to maximise the numerator, with initial parameter values obtained from maximising the alternative likelihood (12). The computation for one simulated phenotype (34083 test statistics) for BF<sub>mean</sub>, Λ and Λ<sub>mean</sub> take 20 seconds, 229 seconds, and 10 seconds respectively, after imputed genotype probabilities had been computed.</p>
        <p><xref ref-type="fig" rid="pgen-1000279-g003">Figure 3</xref> illustrates the relationships between BF<sub>mean</sub> and Λ,Λ<sub>mean</sub>, and how they depend on imputation confidence. (The relationships with Λ and Λ<sub>mean</sub> are qualitatively similar, but the relationship with Λ<sub>mean</sub> is cleaner because of the mathematical relationship between BF<sub>mean</sub> and Λ<sub>mean</sub> given in <xref ref-type="supplementary-material" rid="pgen.1000279.s002">Text S2</xref>). Where SNPs are easy to impute, with high confidence genotypes (black in <xref ref-type="fig" rid="pgen-1000279-g003">Figure 3</xref>), the Bayes factor and Likelihood ratio statistics have an almost monotonic relationship, as predicted by the theory. For difficult-to-impute SNPs, with low confidence genotypes, (e.g., red in <xref ref-type="fig" rid="pgen-1000279-g003">Figure 3</xref>) the qualitative behaviour of the statistics differs. The Bayes factor tends to take values close to 1 (log(BF<sub>mean</sub>) close to 0), with the variance about 1 being smallest for those SNPs with the lowest confidence genotypes. This reflects the fact that these difficult-to-impute SNPs tend to be relatively uninformative regarding the null vs alternative hypotheses. In contrast, by design, the likelihood ratio statistics have approximately the same distribution (under the null) for both poorly-imputed and well-imputed SNPs. The practical effect of this is that, when testing difficult-to-impute SNPs, the Bayes factor is less likely to take a large value by chance than is the likelihood ratio statistic, and so difficult-to-impute SNPs are less likely to produce false positives by chance when using the Bayes factor than using the likelihood ratio statistic.</p>
        <fig id="pgen-1000279-g003" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pgen.1000279.g003</object-id>
          <label>Figure 3</label>
          <caption>
            <title>Graph showing correspondance between log<sub>10</sub>(BF<sub>mean</sub>) values and Likelihood ratio statistics Λ (left) and Λ<sub>mean</sub> (right).</title>
            <p>Each point represents one SNP-phenotype combination, colored according to average confidence in imputed genotypes. Specifically, the SNPs were colored according to the value of <italic>r</italic>, defined to be the ratio of the variance of the (posterior mean) genotypes and the expected variance if the SNP were typed, calculated from the MAF assuming Hardy-Weinberg equilibrium (2<italic>f</italic>(1−<italic>f</italic>)). This scaling ensures that for typed and confidently-imputed SNPs <italic>r</italic>≈1, whereas for SNPs with low average confidence <italic>r</italic> will be close to 0. Colors indicate ranges of values of <italic>r</italic>: red <italic>r</italic>∈(0,0.001]; green <italic>r</italic>∈(0.001,0.01]; blue <italic>r</italic>∈(0.01,0.1]; cyan <italic>r</italic>∈(0.1,0.5]; black <italic>r</italic>&gt;0.5.</p>
          </caption>
          <graphic xlink:href="pgen.1000279.g003"/>
        </fig>
        <p>To quantify the practical impact of this difference between the approaches, we compared the power of the BF and LR to distinguish true positive vs false positive signals, and compared both these approaches with not performing imputation. Since large test statistic values tend to cluster together (due to LD among nearby SNPs), and since we want to compare methods that are testing different sets of SNPs (imputation vs no imputation), we took the approach of defining regions, rather than individual SNPs, as the unit of “discovery”. Specifically, we divided the chromosome into adjoining 200 kb regions, chosen in such a way that one region is centered on the causal variant, and scored each region as a “discovery” if the largest Bayes factor (or the largest value of Λ) in that region exceeded some threshold (<italic>T</italic>, say). Each discovery was considered a “true discovery” if it contained the causal variant, and a “false discovery” if it did not. (To reduce the effects of potential false positives due to LD among regions, we ignored the regions either side of the region containing the causal SNP when scoring discoveries as true or false; we also checked that our qualitative conclusions were insensitive to precise choice of region size.) Note that, as threshold <italic>T</italic> decreases, the number of true discoveries and false discoveries necessarily increases. Note also that, since the imputation approach involves computing test statistics for both typed and untyped SNPs, it will inevitably increase the number of both true and false discoveries (for given <italic>T</italic>) compared with testing typed SNPs only. To make a fair comparison between different approaches we therefore focus on comparing the number of true discoveries, for a given number of false discoveries, by plotting the number of true vs. false discoveries as <italic>T</italic> varies. Since the relative performance of different methods was similar for the two simulation scenarios, we show results averaged across the scenarios.</p>
        <p>The results (<xref ref-type="fig" rid="pgen-1000279-g004">Figure 4</xref>) confirm that the BF has an advantage compared with the likelihood ratio statistics: for any given number of true positives, the BF produces fewer false positives. This advantage is small for the CEU panel, and larger for the YRI panel where there are more poorly-imputed SNPs with low confidence genotypes. For the YRI panel the full likelihood ratio performed better than Λ<sub>mean</sub>, presumably because the approximate model on which Λ<sub>mean</sub> is based is a worse approximation for harder-to-impute SNPs.</p>
        <fig id="pgen-1000279-g004" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pgen.1000279.g004</object-id>
          <label>Figure 4</label>
          <caption>
            <title>Effects of different test statistics on power to detect associations.</title>
            <p>Each line shows the trade-off between true and false discoveries when using Bayes factors (black lines) or likelihood ratio test statistics Λ (red solid lines) and Λ<sub>mean</sub> (red dashed lines), as threshold for declaring an association is varied. In each setting the Bayes factor produces as good, or better, performance than the likelihood ratio test (black lines are above the corresponding red lines). Best performance is obtained using CEU panel, which is well-matched to the sample and produces a low imputation error rate (left; imputation error rate 6.2%). Larger increases in imputation error rate, obtained when using YRI panel that is not well-matched to sample, produce a notable reduction in performance (right; imputation error rate 25%). However, even with a high imputation error rate, using the Bayes factor as a test statistic gives better results than no imputation (blue dotted lines in both panel).</p>
          </caption>
          <graphic xlink:href="pgen.1000279.g004"/>
        </fig>
      </sec>
      <sec id="s2c3">
        <title>Summary of Comparisons of Bayes Factor and Likelihood Ratio</title>
        <p>In summary, when testing imputed variants for association with a normal phenotype, we found that using a Bayes factor to rank SNPs for strength of evidence of a association gave better performance than using the Likelihood ratio statistics. Theoretical arguments suggest that this gain in performance may be explained by viewing the Likelihood ratio statistics as making an implicit, and unnatural assumption: that difficult-to-impute variants tend to have larger effect sizes. Consistent with this, we found that the quantitative difference in performance depends on the fraction of difficult-to-impute SNPs, and is larger when many SNPs have low-confidence imputed genotypes. Thus, in practice, the difference between the methods might have greater importance in imputation applications involving harder-to-impute rare variants (e.g. where the panel data are resequencing data, rather than genotype data–a scenario that may be more common in the near future with gains in sequencing technology).</p>
        <p>It is natural to ask whether the advantage of the Bayes factor over the likelihood ratio statistics in this setting (of normal phenotype) also transfers to other settings, and to other frequentist test statistics. In fact we believe there are several reasons to expect it will apply quite generally. For example, regarding the transfer to settings other than normal phenotypes, the theoretical results from <xref rid="pgen.1000279-Wakefield2" ref-type="bibr">[17]</xref> apply to logistic regression models. Further, Wakefield's results are based on an approximate Bayes factor that itself is based on asymptotic normality of the maximum likelihood estimate, and it seems quite probable that similar results can be obtained in other settings where the maximum likelihood estimate is asymptotically normal.</p>
        <p>Regarding the extension to other frequentist test statistics, we note that many test statistics in common use (e.g. the <italic>F</italic> statistic in standard regression) are asymptotically equivalent to the likelihood ratio test statistic. Furthermore, we view the root cause of the loss of power of the likelihood ratio statistics compared with the Bayes factor as being due to the fact that under the null, by design, the likelihood ratio statistics have the same distribution for all SNPs. (In contrast, under the null, the Bayes factors for difficult-to-impute SNPs tend to be closer to 1 than for other SNPs–<xref ref-type="fig" rid="pgen-1000279-g003">Figure 3</xref>–reflecting the fact that there is little information in these SNPs to distinguish the null and alternative hypotheses.) This design feature limits the ability of Λ and Λ<sub>mean</sub> to respond to differences in informativeness among SNPs, and in particular it causes them to occassionally produce, by chance, high ranks for difficult-to-impute SNPs. We therefore expect other test statistics that have this feature of having a fixed distribution under the null (which would include most conventional frequentist test statistics used for single-SNP analyses, including chi-square statistics for case-control studies, and the score test in <xref rid="pgen.1000279-Marchini1" ref-type="bibr">[3]</xref>) to suffer similar problems. Note that, based on this insight, one could attempt to design frequentist procedures that circumvent this problem. For example, one could rank SNPs using the Bayes factors we present here, and then assess significance of the largest Bayes factor by permutation, providing a <italic>p</italic> value for the global null hypothesis of no association between the genotypes and phenotypes, and thus controlling the family-wise type I error rate. Alternatively, and preferably, one could try to design a similar procedure that ranks SNPs by their Bayes factor, and then controls the False Discovery Rate <xref rid="pgen.1000279-Storey1" ref-type="bibr">[18]</xref>. A simpler, and more <italic>ad hoc</italic> fix, would be to simply avoid testing SNPs that are difficult to impute; this may well provide an effective practical solution, although the inevitable arbitrariness in deciding which SNPs are sufficiently well-imputed to test seems inherently unsatisfying.</p>
        <p>We emphasise that we do not view the gain in power discussed here as the only, or indeed the strongest, argument for applying Bayesian methods: we have focussed on it because it is an issue specific to imputation analyses, and one that has not previously been discussed. We also emphasise that the prior we used here, where effect size depends on minor allele frequency, and with no dominance, was adopted purely to facilitate comparisons with the likelihood ratio statistics. If effect sizes are independent of (or only weakly dependent on) MAF, or if some loci exhibit dominant effects, then increased power should be obtained from a Bayesian analysis that incorporate these factors. A strength of the Bayesian approach is its ability to incorporate this type of information where it is available, and to average over assumptions where good data are not available. For example, since there is little direct data on relationship between the MAF and effect size, there is an argument for averaging Bayes factors obtained under both the independence and dependence assumptions; similarly, there is an argument for averaging Bayes factors over different amounts of dominance, for example by setting <italic>σ<sub>d</sub></italic>&gt;0 (of course, any <italic>particular</italic> value of <italic>σ<sub>d</sub></italic> is going to be somewhat arbitrary, but setting it to be small seems preferable to assuming no dominance).</p>
      </sec>
    </sec>
    <sec id="s2d">
      <title>Effect of Imputation Accuracy on Power</title>
      <p>Besides comparing the Bayesian and frequentist approaches to inference, the results in <xref ref-type="fig" rid="pgen-1000279-g004">Figure 4</xref> also illustrate that, at least when using the Bayes factor to test imputed SNPs, the imputation-based approach is relatively robust to very poor imputation accuracy: even with very high average imputation error rate (25% error rate with YRI panel) the imputation-based method using the Bayes factor as a test statistic performs better than testing typed markers only. This is reassuring for the use of imputation in studies where no well-matched panel is available. We also examined the effect of smaller changes in imputation accuracy (imputation error rates in range 6.2% to 7.3%). As might be expected, such small changes in imputation error rate produce correspondingly small changes in performance (comparable in magnitude to the difference between BF<sub>mean</sub> and Λ for the CEU panel in <xref ref-type="fig" rid="pgen-1000279-g004">Figure 4</xref>; data not shown).</p>
    </sec>
    <sec id="s2e">
      <title>Binary Phenotypes</title>
      <p>While we have focussed here on testing quantitative phenotypes for association with genotypes, all of the key results should be expected to also apply to binary (0/1) phenotypes. Indeed, although the natural way to analyse a binary trait is via a logistic, rather than a linear, regression, for the small effect sizes that are typical in genetic studies the two approaches to analysis might be expected to produce similar results (e.g. see <xref rid="pgen.1000279-Cox1" ref-type="bibr">[19]</xref>, p. 18). To examine this further, we simulated binary phenotypes <italic>Y</italic>′, by taking the quantitative phenotypes <italic>Y</italic> simulated above, and setting <inline-formula><inline-graphic xlink:href="pgen.1000279.e028.jpg" mimetype="image"/></inline-formula>. We then compared the Bayes factors for these binary phenotypes under the linear model (using the mean genotype approximation based on (8)), and the logistic model [using the Laplace method to approximate necessary integrals, as was done in 9; see <xref ref-type="supplementary-material" rid="pgen.1000279.s003">Text S3</xref>]. The results (<xref ref-type="fig" rid="pgen-1000279-g005">Figure 5</xref>) show a strong correspondence between Bayes factors based on the two different models, supporting the idea that results obtained here for quantitative traits will apply also to binary traits.</p>
      <fig id="pgen-1000279-g005" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pgen.1000279.g005</object-id>
        <label>Figure 5</label>
        <caption>
          <title>The x-axis is log<sub>10</sub> (<italic>BF</italic>) of linear model and y-axis is log<sub>10</sub>
<italic>BF</italic> of logistic model.</title>
          <p>The blue line is <italic>x</italic> = <italic>y</italic>.</p>
        </caption>
        <graphic xlink:href="pgen.1000279.g005"/>
      </fig>
    </sec>
  </sec>
  <sec id="s3">
    <title>Discussion</title>
    <p>In summary, we have addressed a number of practical issues that arise in implementing imputation-based association mapping for a quantitative trait. Key findings include: i) when using the model of <xref rid="pgen.1000279-Scheet1" ref-type="bibr">[7]</xref> to impute untyped SNPs, fitting the model to only the panel produces substantially improved imputation accuracy compared with fitting the model to all data; ii) although imputation accuracy is affected by mismatches in genetic background between panel and study samples, imputed genotypes can be accurate provided the panel contain at least some samples that are representative of the study sample; iii) when computing Bayes factors based on imputed genotypes, simply replacing the imputed genotypes with their posterior mean produces a good approximation to a full analysis; iv) when ranking imputed SNPs for association, in our simulations Bayes factors produced better rankings than Likelihood ratio statistics; our explanation for this, based on theoretical arguments, is that the Bayes factors take better account of the different amounts of information in different imputed SNPs; v) The power of Bayesian imputation-based association mapping is relatively robust with respect to imputation accuracy: even when average imputation accuracy is low, imputation-based analysis can increase power compared with testing typed SNPs only. More generally, since in our simulations small differences in imputation accuracy had only a small effect on power, we conclude that choice of imputation method may ultimately matter less than what is done with the imputed genotypes. Thus, when selecting software to use in performing imputation-based analyses, it seems important to consider the range of analyses that can be performed, as well as the imputation method used. For example, our software, BIMBAM, can perform not only the single-SNP tests based on Bayes factors described here, but also multi-SNP analyses of individual genes or regions; and it can easily exploit any (unphased) resequencing data that may be available on regions of interest. All these features can increase power to detect, and ability to explain, associations <xref rid="pgen.1000279-Servin1" ref-type="bibr">[2]</xref>.</p>
    <p>While our findings are based on use of a particular imputation method, in the particular context of association mapping of a quantitative phenotype, all of them (except perhaps i) above) are likely to apply more generally. For example, the PAC model used for imputation in <xref rid="pgen.1000279-Marchini1" ref-type="bibr">[3]</xref> has many similarities with the one we use here, including the fact that imputation is essentially performed by modelling each sampled haplotype as a mosaic of template haplotypes (in the PAC model these template haplotypes are the panel haplotypes, where in the cluster-based model these template haplotypes are estimated from the panel haplotypes, and are in some sense a summary of the panel haplotypes). As such, finding (ii) regarding the impact of mismatches in genetic background between panel and cohort individuals are also likely to apply to this method. Similarly, findings (iii–vi) seem likely to apply not only to quantitative traits, but also binary traits, or case-control studies, particularly given the correspondence between the Bayes factors based on linear and logistic models, in <xref ref-type="fig" rid="pgen-1000279-g005">Figure 5</xref>.</p>
    <p>Although imputation-based analyses involve considerably more computation than simply testing typed SNPs, these analyses are nevertheless now practical with very modest computational resources. For example, using the methods we describe here (and particularly findings i) and iii) above), implemented in the software package BIMBAM, analysing the whole of chromosome 22, in 675 individuals, with <italic>E</italic> = 5 and <italic>K</italic> = 10 takes just under an hour on a single Mac PRO desktop computer (with 3.0 GHz CPU and 8G memory, although memory used for simulations here was less than 1G).</p>
    <p>Besides the gain in computational convenience, the effectiveness of Bayes factors based on posterior mean genotypes also has important implications for sharing and combining data across studies. Specifically, we have in mind situations where, for political, ethical, or other reasons, sharing individual-level genotype and phenotype data among investigators working on similar studies is more difficult than sharing summary-level data on each SNP. In these cases, a simple approach is to share and compare Bayes factors (or <italic>p</italic> values) for each SNP. However, better summaries of the data can be easily shared, to allow more powerful subsequent analyses. Specifically, for a quantitative trait, for a typed SNP the Bayes factor (8) depends on the phenotype and genotype data only through the matrices <italic>X<sup>t</sup>X</italic>, <italic>X<sup>t</sup>Y</italic> and the number <italic>Y<sup>t</sup>Y</italic>. Similarly, for an imputed SNP, BF<sub>mean</sub> depends only on <italic>X̅</italic>
<italic><sup>t</sup>X̅</italic>, <italic>X̅</italic>
<italic><sup>t</sup>Y</italic> and <italic>Y<sup>t</sup>Y</italic>. These three quantities represent only summary level data (for example, in the case of the observed SNP they are essentially equivalent to knowing the number of individuals in each genotype class, and the within-genotype-class means and standard deviations of the phenotype). Further, if these three quantities are known for multiple studies, they can be computed for the combined study. Specifically, if <italic>X<sub>s</sub></italic> and <italic>Y<sub>s</sub></italic> denote, respectively, the design matrix and phenotype vector for study <italic>s</italic> (<italic>s</italic> = 1,…,<italic>S</italic>), and <italic>X</italic> and <italic>Y</italic> denote the combined design matrix and phenotype vector for the combination of data across all <italic>S</italic> studies, then it is straightforward to show that<disp-formula><graphic xlink:href="pgen.1000279.e029.jpg" mimetype="image" position="float"/><label>(13)</label></disp-formula>Since <italic>X<sup>t</sup>X</italic>, <italic>X<sup>t</sup>Y</italic> and <italic>Y<sup>t</sup>Y</italic> suffice to compute the Bayes factor for the combined study, this demonstrates that, from appropriate summary-level data from each study, one can compute the Bayes factor BF<sub>mean</sub> for each SNP <italic>as if one had possession of the combined data across all studies</italic>. (Note that the same summary data also suffice to compute Λ<sub>mean</sub>, allowing frequentist inference for the joint data also to be performed without sharing individual-level data.)</p>
    <p>Of course, combining results across studies can present many challenges, including differential inclusion criteria or phenotype definitions; differential genotyping biases, e.g. due to differential DNA quality <xref rid="pgen.1000279-Plagnol1" ref-type="bibr">[20]</xref>; and different phenotype distributions and/or genetic backgrounds within different studies. Some of these problems may be easier to solve than others (e.g. to minimize this last problem we advocate quantile normalizing the phenotype values within each study, to an <italic>N</italic>(0,1) distribution, prior to computing summary statistics.) However, our results do provide a framework for combining results across studies when these other challenges can be surmounted. Our software BIMBAM includes an option to output and input summary statistics of this form, allowing multiple investigators to easily perform a combined imputation-based analysis of multiple data sets, without sharing individual level data among groups.</p>
    <p>The methods described here, like those from <xref rid="pgen.1000279-Marchini1" ref-type="bibr">[3]</xref>, are based on a prospective likelihood. However, they have already been applied to other designs, such as case-control studies <xref rid="pgen.1000279-Wellcome1" ref-type="bibr">[9]</xref>, where use of a retrospective likelihood would be more appropriate. We now consider the validity of this approach. For case-control studies, with observed covariates, the correspondance between Bayesian analyses based on prospective and retrospective likelihoods is derived by <xref rid="pgen.1000279-Seaman1" ref-type="bibr">[21]</xref>. In brief, they show that the Bayesian analysis based on a prospective likelihood is equivalent to a particular Bayesian analysis using the retrospective likelihood, provided that the prospective analysis uses an (improper) uniform prior on the baseline log-odds of the disease (e.g. log-odds of disease for genotype 0). [This is the prior implemented in our software, and it can also be shown (MS, unpublished data) that the approximate BF from <xref rid="pgen.1000279-Wakefield2" ref-type="bibr">[17]</xref> can be derived using this prior. This was not the prior used in <xref rid="pgen.1000279-Wellcome1" ref-type="bibr">[9]</xref>, although it is unclear how much this matters in practice.] This result justifies the use of Bayesian methods based on a prospective model, with an appropriate prior on the baseline log-odds, for analysing typed SNPs in case-control studies. The result does not apply directly to unobserved covariates, and hence does not apply directly to untyped SNPs. However, we note that i) if a SNP is easy to impute, with high confidence genotypes, then the result seems likely to hold approximately, since it is almost as if the SNP is observed; ii) if a SNP is difficult to impute, with very low confidence genotypes, the Bayes factors from prospective and retrospective analyses will both be close to 1, since there will be little information regarding association at such SNPs. Thus, for SNPs that are very easy or very difficult to impute the prospective analysis will approximately agree with a retrospective analysis. This gives grounds for optimism that results from applying these prospective methods to case-control data will not be generally misleading. The situation is slightly less clear for data obtained by genotyping individuals that are at the extremes of a quantitative phenotype distribution (e.g. <xref rid="pgen.1000279-Cohen1" ref-type="bibr">[22]</xref>), since the <xref rid="pgen.1000279-Seaman1" ref-type="bibr">[21]</xref> result applies to binary phenotypes. Thus, although we speculate that direct prospective analyses of the observed quantitative phenotypes will be generally satisfactory here also, it might be prudent to also analyse such data treating the two extremes as binary (case-control) phenotypes.</p>
  </sec>
  <sec sec-type="supplementary-material" id="s4">
    <title>Supporting Information</title>
    <supplementary-material content-type="local-data" id="pgen.1000279.s001">
      <label>Text S1</label>
      <caption>
        <p>Importance sampling.</p>
        <p>(0.06 MB PDF)</p>
      </caption>
      <media xlink:href="pgen.1000279.s001.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pgen.1000279.s002">
      <label>Text S2</label>
      <caption>
        <p>Relationship between BF<sub>mean</sub> and Λ<sub>mean</sub>.</p>
        <p>(0.06 MB PDF)</p>
      </caption>
      <media xlink:href="pgen.1000279.s002.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pgen.1000279.s003">
      <label>Text S3</label>
      <caption>
        <p>Laplace method to approximate Bayes factors for Logistic Regression.</p>
        <p>(0.06 MB PDF)</p>
      </caption>
      <media xlink:href="pgen.1000279.s003.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <p>We thank Dr R. Krauss for permission to use the PRINCE genotypes, which were collected as part of the Pharmacogenetics and risk of Cardiovascular disease project, funded by U01HL069757 (PI R. Krauss); we thank Dr Paul Ridker, Principal Investigator of the PRINCE trial, for providing access to the patient population and DNA used to produce these genotypes. We thank J. Wakefield for helpful comments and sharing a pre-print containing his results relating Bayes factors and F statistics; X. Wen for results from IMPUTE; and the Computational Institute at the University of Chicago for computing resources. We thank two anonymous reviewers for detailed comments on earlier versions of this manuscript.</p>
  </ack>
  <fn-group>
    <fn fn-type="COI-statement">
      <p>The authors have declared that no competing interests exist.</p>
    </fn>
    <fn fn-type="financial-disclosure">
      <p>This work was supported by grants HG02585 and HL084689 to MS.</p>
    </fn>
  </fn-group>
  <ref-list>
    <title>References</title>
    <ref id="pgen.1000279-The1">
      <label>1</label>
      <element-citation publication-type="journal">
        <collab>The International HapMap Consortium</collab>
        <year>2007</year>
        <article-title>A second generation human haplotype map of over 3.1 million snps.</article-title>
        <source>Nature</source>
        <volume>449:7164</volume>
        <fpage>851</fpage>
        <lpage>861</lpage>
        <pub-id pub-id-type="pmid">17943122</pub-id>
      </element-citation>
    </ref>
    <ref id="pgen.1000279-Servin1">
      <label>2</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Servin</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Stephens</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <year>2007</year>
        <article-title>Efficient multipoint analysis of association studies: candidate regions and quantitative traits.</article-title>
        <source>PLoS Genetics</source>
        <volume>3</volume>
      </element-citation>
    </ref>
    <ref id="pgen.1000279-Marchini1">
      <label>3</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Marchini</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Howie</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Myers</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>McVean</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Donnelly</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <year>2007</year>
        <article-title>A new multipoint method for genome-wide association studies by imputation of genotypes.</article-title>
        <source>Nat Genet</source>
        <volume>39</volume>
        <fpage>906</fpage>
        <lpage>913</lpage>
        <pub-id pub-id-type="pmid">17572673</pub-id>
      </element-citation>
    </ref>
    <ref id="pgen.1000279-Lin1">
      <label>4</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lin</surname>
            <given-names>DY</given-names>
          </name>
          <name>
            <surname>Hu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Huang</surname>
            <given-names>BE</given-names>
          </name>
        </person-group>
        <year>2008</year>
        <article-title>Simple and efficient analysis of disease association with missing genotype data.</article-title>
        <source>Am J Hum Genet</source>
        <volume>82</volume>
        <fpage>444</fpage>
        <lpage>452</lpage>
        <pub-id pub-id-type="pmid">18252224</pub-id>
      </element-citation>
    </ref>
    <ref id="pgen.1000279-Scott1">
      <label>5</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Scott</surname>
            <given-names>LJ</given-names>
          </name>
          <name>
            <surname>Mohlke</surname>
            <given-names>KL</given-names>
          </name>
          <name>
            <surname>Bonnycastle</surname>
            <given-names>LL</given-names>
          </name>
          <name>
            <surname>Willer</surname>
            <given-names>CJ</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Duren</surname>
            <given-names>WL</given-names>
          </name>
          <name>
            <surname>Erdos</surname>
            <given-names>MR</given-names>
          </name>
          <name>
            <surname>Stringham</surname>
            <given-names>HM</given-names>
          </name>
          <etal/>
        </person-group>
        <year>2007</year>
        <article-title>A genome-wide association study of type 2 diabetes in finns detects multiple susceptibility variants.</article-title>
        <source>Science</source>
        <volume>316</volume>
        <fpage>1341</fpage>
        <lpage>1345</lpage>
        <pub-id pub-id-type="pmid">17463248</pub-id>
      </element-citation>
    </ref>
    <ref id="pgen.1000279-Reiner1">
      <label>6</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Reiner</surname>
            <given-names>AP</given-names>
          </name>
          <name>
            <surname>Barber</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Guan</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Ridker</surname>
            <given-names>PM</given-names>
          </name>
          <name>
            <surname>Lange</surname>
            <given-names>LA</given-names>
          </name>
          <name>
            <surname>Chasman</surname>
            <given-names>DI</given-names>
          </name>
          <name>
            <surname>Walston</surname>
            <given-names>JD</given-names>
          </name>
          <name>
            <surname>Cooper</surname>
            <given-names>GM</given-names>
          </name>
          <name>
            <surname>Jenny</surname>
            <given-names>NS</given-names>
          </name>
          <name>
            <surname>Rieder</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Durda</surname>
            <given-names>JP</given-names>
          </name>
          <name>
            <surname>Smith</surname>
            <given-names>JD</given-names>
          </name>
          <name>
            <surname>Novembre</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Tracy</surname>
            <given-names>RP</given-names>
          </name>
          <name>
            <surname>Rotter</surname>
            <given-names>JI</given-names>
          </name>
          <name>
            <surname>Stephens</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Nickerson</surname>
            <given-names>DA</given-names>
          </name>
          <name>
            <surname>Krauss</surname>
            <given-names>RM</given-names>
          </name>
        </person-group>
        <year>May 2008</year>
        <article-title>Polymorphisms of the hnf1a gene encoding hepatocyte nuclear factor-1 alpha are associated with c-reactive protein.</article-title>
        <source>Am J Hum Genet</source>
        <volume>82(5)</volume>
        <fpage>1193</fpage>
        <lpage>1201</lpage>
        <pub-id pub-id-type="pmid">18439552</pub-id>
      </element-citation>
    </ref>
    <ref id="pgen.1000279-Scheet1">
      <label>7</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Scheet</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Stephens</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <year>2006</year>
        <article-title>A fast and flexible statistical model for large-scale population genotype data: Applications to inferring missing genotypes and haplotypic phase.</article-title>
        <source>Am J Hum Genet</source>
        <volume>78</volume>
        <fpage>629</fpage>
        <lpage>644</lpage>
        <pub-id pub-id-type="pmid">16532393</pub-id>
      </element-citation>
    </ref>
    <ref id="pgen.1000279-Wakefield1">
      <label>8</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wakefield</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <year>2007</year>
        <article-title>A bayesian measure of the probability of false discovery in genetic epidemiology studies.</article-title>
        <source>Am J Hum Genet</source>
        <volume>81</volume>
        <fpage>208</fpage>
        <lpage>227</lpage>
        <pub-id pub-id-type="pmid">17668372</pub-id>
      </element-citation>
    </ref>
    <ref id="pgen.1000279-Wellcome1">
      <label>9</label>
      <element-citation publication-type="journal">
        <collab>Wellcome Trust Case Control Consortium</collab>
        <year>2007</year>
        <article-title>Genome-wide association study of 14,000 cases of seven common diseases and 3,000 shared controls.</article-title>
        <source>nature</source>
        <volume>447</volume>
        <fpage>661</fpage>
        <lpage>678</lpage>
        <pub-id pub-id-type="pmid">17554300</pub-id>
      </element-citation>
    </ref>
    <ref id="pgen.1000279-Nicolae1">
      <label>10</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nicolae</surname>
            <given-names>DL</given-names>
          </name>
        </person-group>
        <year>2006</year>
        <article-title>Quantifying the amount of missing information in genetic association studies.</article-title>
        <source>Genetic Epidemiology</source>
        <volume>30</volume>
        <fpage>703</fpage>
        <lpage>717</lpage>
        <pub-id pub-id-type="pmid">16986163</pub-id>
      </element-citation>
    </ref>
    <ref id="pgen.1000279-Dai1">
      <label>11</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dai</surname>
            <given-names>JY</given-names>
          </name>
          <name>
            <surname>Ruczinski</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>LeBlanc</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Kooperberg</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <year>2006</year>
        <article-title>Imputation methods to improve inference in snp association studies.</article-title>
        <source>Genet Epidemiol</source>
        <volume>30</volume>
        <fpage>690</fpage>
        <lpage>702</lpage>
        <pub-id pub-id-type="pmid">16986162</pub-id>
      </element-citation>
    </ref>
    <ref id="pgen.1000279-Browning1">
      <label>12</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Browning</surname>
            <given-names>SR</given-names>
          </name>
          <name>
            <surname>Browning</surname>
            <given-names>BL</given-names>
          </name>
        </person-group>
        <year>2007</year>
        <article-title>Rapid and accurate haplotype phasing and missing-data inference for whole-genome association studies by use of localized haplotype clustering.</article-title>
        <source>Am J Hum Genet</source>
        <volume>81(5)</volume>
        <fpage>1084</fpage>
        <lpage>1097</lpage>
        <pub-id pub-id-type="pmid">17924348</pub-id>
      </element-citation>
    </ref>
    <ref id="pgen.1000279-Li1">
      <label>13</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Stephens</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <year>2003</year>
        <article-title>Modelling linkage disequilibrium, and identifying recombination hotspots using snp data.</article-title>
        <source>Genetics</source>
        <volume>165</volume>
        <fpage>2213</fpage>
        <lpage>2233</lpage>
        <pub-id pub-id-type="pmid">14704198</pub-id>
      </element-citation>
    </ref>
    <ref id="pgen.1000279-Albert1">
      <label>14</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Albert</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Danielson</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Rifai</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Ridker</surname>
            <given-names>PM</given-names>
          </name>
        </person-group>
        <year>2001</year>
        <article-title>Effect of statin therapy on c-reactive protein levels.</article-title>
        <source>Journal of American Medical Aassociation</source>
        <volume>286</volume>
        <fpage>64</fpage>
        <lpage>70</lpage>
      </element-citation>
    </ref>
    <ref id="pgen.1000279-Ripley1">
      <label>15</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Ripley</surname>
            <given-names>BD</given-names>
          </name>
        </person-group>
        <year>1987</year>
        <source>Stochastic Simulation</source>
        <publisher-loc>New York</publisher-loc>
        <publisher-name>Wiley</publisher-name>
      </element-citation>
    </ref>
    <ref id="pgen.1000279-Sellke1">
      <label>16</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sellke</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Bayarri</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Berger</surname>
            <given-names>JO</given-names>
          </name>
        </person-group>
        <year>2001</year>
        <article-title>Calibration of p-values for testing precise null hypotheses.</article-title>
        <source>American Statistician</source>
        <volume>55(1)</volume>
        <fpage>62</fpage>
        <lpage>71</lpage>
      </element-citation>
    </ref>
    <ref id="pgen.1000279-Wakefield2">
      <label>17</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wakefield</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <year>2008</year>
        <article-title>Bayes factors for genome-wide association studies: Comparison with p-values.</article-title>
        <source>Genetic Epidemiology</source>
        <comment>to appear, 2008</comment>
      </element-citation>
    </ref>
    <ref id="pgen.1000279-Storey1">
      <label>18</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Storey</surname>
            <given-names>JD</given-names>
          </name>
          <name>
            <surname>Tibshirani</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <year>2003</year>
        <article-title>Statistical significance for genomewide studies.</article-title>
        <source>Proc Natl Acad Sci USA</source>
        <volume>100(16)</volume>
        <fpage>9440</fpage>
        <lpage>9445</lpage>
        <pub-id pub-id-type="pmid">12883005</pub-id>
      </element-citation>
    </ref>
    <ref id="pgen.1000279-Cox1">
      <label>19</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Cox</surname>
            <given-names>DR</given-names>
          </name>
          <name>
            <surname>Snell</surname>
            <given-names>EJ</given-names>
          </name>
        </person-group>
        <year>1989</year>
        <source>Analysis of Binary Data</source>
        <publisher-loc>London</publisher-loc>
        <publisher-name>Chapman and Hall/CRC</publisher-name>
        <comment>2nd edition</comment>
      </element-citation>
    </ref>
    <ref id="pgen.1000279-Plagnol1">
      <label>20</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Plagnol</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Cooper</surname>
            <given-names>JD</given-names>
          </name>
          <name>
            <surname>Todd</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Clayton</surname>
            <given-names>DG</given-names>
          </name>
        </person-group>
        <year>2007</year>
        <article-title>A method to address differential bias in genotyping in large-scale association studies.</article-title>
        <source>PLoS Genetics</source>
        <volume>3</volume>
      </element-citation>
    </ref>
    <ref id="pgen.1000279-Seaman1">
      <label>21</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Seaman</surname>
            <given-names>SR</given-names>
          </name>
          <name>
            <surname>Richardson</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <year>2004</year>
        <article-title>Equivalence of prospective and retrospective models in the bayesian analysis of case-control studies.</article-title>
        <source>Biometrika</source>
        <volume>91</volume>
        <fpage>15</fpage>
        <lpage>25</lpage>
      </element-citation>
    </ref>
    <ref id="pgen.1000279-Cohen1">
      <label>22</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cohen</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Pertsemlidis</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Kotowski</surname>
            <given-names>IK</given-names>
          </name>
          <name>
            <surname>Graham</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Garcia</surname>
            <given-names>CK</given-names>
          </name>
          <name>
            <surname>Hobbs</surname>
            <given-names>HH</given-names>
          </name>
        </person-group>
        <year>2005</year>
        <article-title>Low LDL cholesterol in individuals of African descent resulting from frequent nonsense mutations in PCSK9.</article-title>
        <source>Nature Genetics</source>
        <volume>37</volume>
        <fpage>161</fpage>
        <lpage>165</lpage>
        <pub-id pub-id-type="pmid">15654334</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
