<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20070202//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing.dtd?>
<?SourceDTD.Version 2.3?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-id journal-id-type="hwp">bioinfo</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">4133581</article-id>
    <article-id pub-id-type="pmid">24764462</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btu239</article-id>
    <article-id pub-id-type="publisher-id">btu239</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Papers</subject>
        <subj-group subj-group-type="heading">
          <subject>Gene Expression</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>On non-detects in qPCR data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>McCall</surname>
          <given-names>Matthew N.</given-names>
        </name>
        <xref ref-type="aff" rid="btu239-AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="corresp" rid="btu239-COR1">*</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>McMurray</surname>
          <given-names>Helene R.</given-names>
        </name>
        <xref ref-type="aff" rid="btu239-AFF1">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Land</surname>
          <given-names>Hartmut</given-names>
        </name>
        <xref ref-type="aff" rid="btu239-AFF1">
          <sup>2</sup>
        </xref>
        <xref ref-type="aff" rid="btu239-AFF1">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Almudevar</surname>
          <given-names>Anthony</given-names>
        </name>
        <xref ref-type="aff" rid="btu239-AFF1">
          <sup>1</sup>
        </xref>
      </contrib>
      <aff id="btu239-AFF1"><sup>1</sup>Department of Biostatistics and Computational Biology, <sup>2</sup>Department of Biomedical Genetics and <sup>3</sup>James P Wilmot Cancer Center, University of Rochester Medical Center, Rochester, NY 14642, USA</aff>
    </contrib-group>
    <author-notes>
      <corresp id="btu239-COR1">*To whom correspondence should be addressed.</corresp>
      <fn id="FN1">
        <p>Associate Editor: Ziv Bar-Joseph</p>
      </fn>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>15</day>
      <month>8</month>
      <year>2014</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>23</day>
      <month>4</month>
      <year>2014</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>23</day>
      <month>4</month>
      <year>2014</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the
							<pub-date pub-type="epub"/>. -->
    <volume>30</volume>
    <issue>16</issue>
    <fpage>2310</fpage>
    <lpage>2316</lpage>
    <history>
      <date date-type="received">
        <day>16</day>
        <month>10</month>
        <year>2013</year>
      </date>
      <date date-type="rev-recd">
        <day>21</day>
        <month>3</month>
        <year>2014</year>
      </date>
      <date date-type="accepted">
        <day>20</day>
        <month>4</month>
        <year>2014</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author 2014. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2014</copyright-year>
      <license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by-nc/3.0">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/3.0/">http://creativecommons.org/licenses/by-nc/3.0/</ext-link>), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.com</license-p>
      </license>
    </permissions>
    <abstract>
      <p><bold>Motivation:</bold> Quantitative real-time PCR (qPCR) is one of the most widely used methods to measure gene expression. Despite extensive research in qPCR laboratory protocols, normalization and statistical analysis, little attention has been given to qPCR non-detects—those reactions failing to produce a minimum amount of signal.</p>
      <p><bold>Results:</bold> We show that the common methods of handling qPCR non-detects lead to biased inference. Furthermore, we show that non-detects do not represent data missing completely at random and likely represent missing data occurring not at random. We propose a model of the missing data mechanism and develop a method to directly model non-detects as missing data. Finally, we show that our approach results in a sizeable reduction in bias when estimating both absolute and differential gene expression.</p>
      <p><bold>Availability and implementation:</bold> The proposed algorithm is implemented in the R package, <monospace>nondetects</monospace>. This package also contains the raw data for the three example datasets used in this manuscript. The package is freely available at <ext-link ext-link-type="uri" xlink:href="http://mnmccall.com/software">http://mnmccall.com/software</ext-link> and as part of the Bioconductor project.</p>
      <p>
        <bold>Contact:</bold>
        <email>mccallm@gmail.com</email>
      </p>
    </abstract>
    <counts>
      <page-count count="7"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 INTRODUCTION</title>
    <p>Quantitative real-time PCR (qPCR) (<xref rid="btu239-B3" ref-type="bibr">Bustin, 2000</xref>; <xref rid="btu239-B8" ref-type="bibr">Gibson <italic>et al.</italic>, 1996</xref>; <xref rid="btu239-B11" ref-type="bibr">Higuchi <italic>et al.</italic>, 1992</xref>; <xref rid="btu239-B22" ref-type="bibr">Wittwer <italic>et al.</italic>, 1997</xref>) remains the gold standard for measuring gene expression due to a combination of greater sensitivity and lower cost than gene expression microarrays or RNA-sequencing. It is commonly used to validate results from high-throughput studies and to develop clinical biomarkers. Recently, qPCR-based technologies have been developed to simultaneously measure thousands of transcripts, e.g. the TaqMan OpenArray Real-Time PCR Plates contain 3072 wells. These plates have been used, for example, to simultaneously measure the expression of all microRNAs in a sample.</p>
    <p>The increased use of qPCR (<xref rid="btu239-B9" ref-type="bibr">Ginzinger, 2002</xref>) has prompted research examining qPCR laboratory protocols (<xref rid="btu239-B2" ref-type="bibr">Bustin, 2002</xref>; <xref rid="btu239-B4" ref-type="bibr">Bustin and Nolan, 2004</xref>; <xref rid="btu239-B17" ref-type="bibr">Nolan <italic>et al.</italic>, 2006</xref>) and more recently normalization (<xref rid="btu239-B14" ref-type="bibr">Mar <italic>et al.</italic>, 2009</xref>; <xref rid="btu239-B16" ref-type="bibr">Mestdagh <italic>et al.</italic>, 2009</xref>; <xref rid="btu239-B19" ref-type="bibr">Qureshi and Sacan, 2013</xref>) and statistical analysis strategies (<xref rid="btu239-B12" ref-type="bibr">Karlen <italic>et al.</italic>, 2007</xref>; <xref rid="btu239-B21" ref-type="bibr">Schmittgen and Livak, 2008</xref>; <xref rid="btu239-B23" ref-type="bibr">Yuan <italic>et al.</italic>, 2006</xref>). In 2009, the Minimum Information for Publication of Quantitative Real-Time PCR Experiments (MIQE) guidelines were published. These guidelines are designed to ‘encourage better experimental practice, allowing more reliable and unequivocal interpretation of qPCR results’ (<xref rid="btu239-B5" ref-type="bibr">Bustin <italic>et al.</italic>, 2009</xref>).</p>
    <p>Briefly, qPCR is used to measure the expression of a set of target genes in a given sample through repeated cycles of sequence-specific DNA amplification followed by expression measurements. Between subsequent cycles, the amount of each target transcript approximately doubles during the exponential phase of amplification. The cycle at which the observed expression first exceeds a fixed threshold is commonly called the threshold cycle (Ct) or quantification cycle (Cq). The latter is the MIQE-preferred nomenclature but is not currently widely used. These Ct values represent a quantitative assessment of gene expression and are often treated as the raw data for subsequent analyses.</p>
    <p>However, relatively little attention has been given to handling <italic>non-detects</italic>—those reactions failing to attain the prespecified minimum signal intensity. Currently, there is no consensus manner in which to handle these non-detects in subsequent analyses. The default in the Applied Biosystems DataAssist v3.0 software is to set non-detects equal to the number of PCR cycles performed (typically 40). One has the option of setting a lower <italic>Maximum Allowable Ct Value</italic> to which any greater value is set or excluding these values from subsequent calculations (<xref rid="btu239-B13" ref-type="bibr">Life Technologies, 2011</xref>). Integromics RealTime StatMiner distinguishes between two types of non-detects—<italic>undetermined</italic> values are those that do not exceed the Ct threshold and <italic>absent</italic> values are those for which no reaction occurred. RealTime StatMinder handles non-detects by setting undetermined values to a maximum Ct (e.g. 40) and absent values to the median of the detected replicates (<xref rid="btu239-B10" ref-type="bibr">Goni <italic>et al.</italic>, 2009</xref>). Researchers have also developed their own methods to handle non-detects that combine filtering and thresholding, for example, summarizing replicates with a value of 40 when the majority are non-detects and with an average of the detected Ct values otherwise (<xref rid="btu239-B14" ref-type="bibr">Mar <italic>et al.</italic>, 2009</xref>).</p>
  </sec>
  <sec id="SEC2">
    <title>2 APPROACH</title>
    <p>We begin by showing that the common practice of setting non-detect values equal to 40 introduces substantial bias in normalized gene expression, ΔCt, and differential expression, ΔΔCt, estimates (<xref rid="btu239-B18" ref-type="bibr">Pfaffl, 2001</xref>). Next, we provide evidence that non-detects are not missing completely at random and are likely missing not at random; therefore, filtering these data will also introduce bias in subsequent analyses (for an introduction to missing data terminology, see <xref rid="btu239-B7" ref-type="bibr">Gelman and Hill, 2007</xref>, Chap. 25). To address non-detects, we propose a method to model the missing data mechanism that can be used to impute Ct values for the non-detects or to directly estimate the quantities of interest. Finally, we show that the proposed approach greatly reduces the bias introduced by non-detects in qPCR data analysis. Three published qPCR datasets (described in the Methods Section) are used throughout the manuscript to motivate and illustrate the results.</p>
  </sec>
  <sec>
    <title>3 METHODS</title>
    <sec id="SEC3.1">
      <title>3.1 Three example datasets</title>
      <p>The first dataset consists of nine gene perturbations with matched control samples (<xref rid="btu239-B1" ref-type="bibr">Almudevar <italic>et al.</italic>, 2011</xref>); the second dataset is composed of two cell types and three treatments (<xref rid="btu239-B20" ref-type="bibr">Sampson <italic>et al.</italic>, 2013</xref>); the third dataset is a study of the effect of p53 and/or Ras mutations on gene expression (<xref rid="btu239-B15" ref-type="bibr">McMurray <italic>et al.</italic>, 2008</xref>).</p>
      <p>In the first dataset, cells transformed to malignancy by mutant p53 and activated Ras are perturbed with the aim of restoring gene expression to levels found in non-transformed parental cells via retrovirus-mediated re-expression of corresponding cDNAs or shRNA-dependent stable knock-down. The data contain four to six replicates for each perturbation, and each perturbation has a corresponding control sample in which only the vector has been added (<xref rid="btu239-B1" ref-type="bibr">Almudevar <italic>et al.</italic>, 2011</xref>).</p>
      <p>The second dataset consists of two cell types—young adult mouse colon (YAMC) cells and mutant-p53/activated-Ras transformed YAMC cells—in combination with three treatments—untreated, sodium butyrate or valproic acid. Four replicates were performed for each cell-type/treatment combination (<xref rid="btu239-B20" ref-type="bibr">Sampson <italic>et al.</italic>, 2013</xref>).</p>
      <p>The third dataset is a comparison between four cell types—YAMC cells, mutant-p53 YAMC cells, activated-Ras YAMC cells and p53/Ras double mutant YAMC cells. Three replicates were performed for the untransformed YAMC cells, and four replicates were performed for each of the other cell types (<xref rid="btu239-B15" ref-type="bibr">McMurray <italic>et al.</italic>, 2008</xref>).</p>
      <p>As in the original publications, all three datasets were normalized to a reference gene, Becn1, with the resulting values denoted as ΔCt. In the first dataset, ΔΔCt values were computed by comparing each perturbed sample to its corresponding control sample. Additional details regarding each of these datasets can be found in the original publications.</p>
    </sec>
  </sec>
  <sec>
    <title>4 RESULTS</title>
    <sec id="SEC4.1">
      <title>4.1 Setting non-detects equal to 40 introduces bias</title>
      <p>We begin by examining the common practice of replacing non-detects with a Ct value of 40. Replicates were summarized by calculating the average ΔCt (datasets 2 and 3) or ΔΔCt (dataset 1) values for each unique gene/sample-type combination. The residuals from this summarization for gene <italic>i</italic>, sample-type <italic>j</italic> and sample <italic>k</italic> were calculated as follows:
<disp-formula><mml:math id="UM1"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mtext>Dataset 1</mml:mtext><mml:mo>:</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>Δ</mml:mo><mml:mo>Δ</mml:mo><mml:msub><mml:mtext>Ct</mml:mtext><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>K</mml:mi></mml:mfrac><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>K</mml:mi></mml:munderover><mml:mo>Δ</mml:mo></mml:mstyle><mml:mo>Δ</mml:mo><mml:msub><mml:mtext>Ct</mml:mtext><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mtext>Datasets 2 and 3</mml:mtext><mml:mo>:</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>Δ</mml:mo><mml:msub><mml:mtext>Ct</mml:mtext><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>K</mml:mi></mml:mfrac><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>K</mml:mi></mml:munderover><mml:mo>Δ</mml:mo></mml:mstyle><mml:msub><mml:mtext>Ct</mml:mtext><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula>
The distribution of these residuals differs substantially between those in which the <inline-formula><mml:math id="I1"><mml:mrow><mml:mo>Δ</mml:mo><mml:mtext>Ct</mml:mtext></mml:mrow></mml:math></inline-formula> or <inline-formula><mml:math id="I2"><mml:mrow><mml:mo>Δ</mml:mo><mml:mo>Δ</mml:mo><mml:mtext>Ct</mml:mtext></mml:mrow></mml:math></inline-formula> value contains a non-detect and those in which these values were observed (<xref ref-type="fig" rid="btu239-F1">Fig. 1</xref>). Note that when calculating ΔCt values, the reference gene, Becn1, is always detected, so non-detects can only occur in the target gene; therefore, datasets 2 and 3 are each split into two groups based on whether both Ct values were observed or a non-detect was present in the target gene. A non-detect typically results in lower absolute expression estimates (<xref ref-type="fig" rid="btu239-F1">Fig. 1</xref>B and C). When calculating ΔΔCt values, a non-detect can occur in the perturbed and/or control sample. In general, a non-detect in the perturbed sample results in lower relative expression, and a non-detect ina the control sample results in higher relative expression (<xref ref-type="fig" rid="btu239-F1">Fig. 1</xref>A). Non-detects in both samples yield ΔΔCt values close to zero—these values simply represent differences in Becn1 expression between the perturbed and control samples. While one might expect some difference in the distribution of residuals between the observed values and those containing a non-detect, the large differences seen in <xref ref-type="fig" rid="btu239-F1">Figure 1</xref> likely represent bias introduced by the common method of handling non-detects.
<fig id="btu239-F1" position="float"><label>Fig. 1.</label><caption><p>Within replicate residuals stratified by the presence of non-detects. The average ΔΔCt (<bold>A</bold>) or ΔCt (<bold>B</bold> and <bold>C</bold>) values were calculated within each set of replicates (same gene and sample type). The residuals, for each gene and sample from this summarization are plotted here, stratified by the presence of non-detects. In dataset 1, a non-detect could occur in the perturbation sample, the control sample or both samples. The left-most box in Panel A shows the distribution of residuals in dataset 1 when there are no non-detects. The other boxes in Panel A (from left to right) show the distribution of residuals when there are non-detects in the perturbation sample, the control sample and both samples. Similarly, the left box in Panels B and C shows the distribution of residuals when there are no non-detects. The right box in Panels B and C shows the distribution of residuals when there is a non-detect. Although one would expect some difference in the distribution of residuals between the detects and non-detects, the differences seen here are much larger than one would expect and likely represent bias introduced by setting non-detects equal to 40</p></caption><graphic xlink:href="btu239f1p"/></fig></p>
      <p>To further illustrate the bias introduced by replacing non-detects with a value of 40, the ΔCt and ΔΔCt values for one example gene from each dataset are shown in <xref ref-type="fig" rid="btu239-F2">Figure 2</xref>. These examples were chosen to demonstrate situations in which replacing non-detects with a value of 40 may lead to spurious differential expression.
<fig id="btu239-F2" position="float"><label>Fig. 2.</label><caption><p>Examples of the potential for spurious differential expression produced by replacing non-detects with values of 40. Panel (<bold>A</bold>) shows the response of Sema7a to the perturbation of nine genes from dataset 1. Panel (<bold>B</bold>) shows the expression of Gpr149 in each combination of normal/tumor samples and one of three treatments from dataset 2. Panel (<bold>C</bold>) shows the response of Pdlim2 to p53 and/or Ras mutation from dataset 3. ΔCt and ΔΔCt values produced by replacing a non-detect with a value of 40 are shown as asterisks. Note that in panel A, a non-detect could have also occurred in one of the control samples; however, in these data this did not occur for Sema7a—all of the non-detects happened to occur in the perturbed samples</p></caption><graphic xlink:href="btu239f2p"/></fig></p>
      <p>In <xref ref-type="fig" rid="btu239-F2">Figure 2</xref>A, the response of Sema7a to perturbation of each of nine genes is shown. Looking at only the ΔΔCt values for which there were no non-detects, the expression of Sema7a does not appear to be greatly affected by any of the perturbations, except perhaps Hoxc13. However, there do appear to be a relatively large number of outliers. Focusing on Sema7a’s response to perturbation of Hoxc13, half of the ΔΔCt values contained a non-detect in the perturbed sample. If one replaced these non-detects with a value of 40, the resulting ΔΔCt values would be approximately −3.23 and −5.05, while the ΔΔCt values without non-detects were approximately −0.16 and −1.54. This would produce an average ΔΔCt value of −2.5. This is probably a substantial overestimate of the down-regulation of Sema7a induced by perturbation of Hoxc13, resulting from the common method of handling non-detects.</p>
      <p><xref ref-type="fig" rid="btu239-F2">Figure 2</xref>B shows the expression of Gpr149 in six conditions. Among the normal samples, there does not appear to be a difference in expression between the untreated (UT), sodium butyrate (NB) and valproic acid (VA) samples when looking at only the ΔCt values without non-detects. However, there are three non-detects in the NB samples and one in the VA sample. Replacing these non-detects with a value of 40 would lead to a large (and likely spurious) difference in expression between these treatments.</p>
      <p>Finally, <xref ref-type="fig" rid="btu239-F2">Figure 2</xref>C shows the response of Pdlim2 to mutation of p53 and/or Ras. While there are non-detects in each group, the number of non-detects varies from 3/3 in the normal samples to 1/4 in the Ras and p53/Ras samples. Replacing these non-detects with a value of 40 will produce a sizeable difference in average expression between the normal and p53 samples and the Ras and p53/Ras samples.</p>
    </sec>
    <sec id="SEC4.2">
      <title>4.2 Filtering non-detect Ct values also introduces bias</title>
      <p>Whether one can filter missing values from one’s data without biasing one’s results depends on the type of missing data. Data are said to be <italic>missing completely at random</italic> if the probability of a missing value is the same for all data points. For qPCR data this implies that the probability of a non-detect is the same for every data point regardless of gene, sample-type, sample-replicate, etc. A broader class of missing data is <italic>missing at random</italic> in which the probability of a missing value depends only on the available information. For qPCR data this would imply that the probability of a non-detect is the same for each replicate within a given gene/sample-type combination. Finally, the data are called <italic>missing not at random</italic> when the probability of a missing value depends on either unobserved predictors or the missing value itself. A well-studied example of the latter is censoring. For data missing not at random, filtering the missing values produces bias in one’s inferences.</p>
      <p>If the non-detects are missing completely at random, then the proportion of non-detects should be roughly constant across genes. For each gene, we compute the proportion of non-detects and the average Ct value across replicate samples (<xref ref-type="fig" rid="btu239-F3">Fig. 3</xref>). There appears to be a strong relationship between the average expression of the genes across replicate samples and the proportion of non-detects. In other words, it seems that genes with lower average expression are far more likely to be non-detects. From this we can conclude that the non-detects do not occur completely at random.
<fig id="btu239-F3" position="float"><label>Fig. 3.</label><caption><p>The proportion of non-detects versus median observed gene expression within control samples (<bold>A</bold>) or within each sample condition (<bold>B</bold> and <bold>C</bold>). Logistic regression fits (dashed lines) all show a strong relationship between the proportion of non-detects and the median observed gene expression—<italic>P</italic>-values of (A) <inline-formula><mml:math id="I3"><mml:mrow><mml:mn>2.57</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, (B) <inline-formula><mml:math id="I4"><mml:mrow><mml:mn>1.58</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>12</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, (C) <inline-formula><mml:math id="I5"><mml:mrow><mml:mo>&lt;</mml:mo><mml:mn>2</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>16</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula></p></caption><graphic xlink:href="btu239f3p"/></fig></p>
      <p>While it is relatively easy to distinguish between missing completely at random and missing at random, it is generally not possible to distinguish between missing at random and missing not at random from the observed data. However, in the case of qPCR non-detects, we are able to use two pieces of additional information to suggest that non-detects are likely missing not at random.</p>
      <p>First, the PCR reactions are run for a fixed number of cycles (typically 40), implying that the observed data are censored at the maximum cycle number. This is a type of non-random missingness in which the missing data mechanism depends on the unobserved value. Knowledge of the technology allows us to conclude that the data are at least subject to fixed censoring; however, as we will later show, the qPCR censoring mechanism may actually be a probabilistic function of the unobserved data.</p>
      <p>Second, the experimental design of the first dataset, in which there are a large number of control samples, allows one to estimate an additional piece of information that is not typically available—the proportion of non-detects as a function of the average sample expression across a large number of replicates (<xref ref-type="fig" rid="btu239-F4">Fig. 4</xref>). Here, we see a similar relationship between average expression and proportion of non-detects. It appears that samples with overall lower signal, as a result of technical not biological variability, also result in a greater number of non-detects. Because most qPCR experiments are not designed to allow one to estimate the relationship between overall sample signal and the proportion of non-detects, qPCR data typically exhibit a type of non-random missingness in which the missing data mechanism depends on an unobserved variable.
<fig id="btu239-F4" position="float"><label>Fig. 4.</label><caption><p>The proportion of non-detects versus median sample expression within controls in dataset 1. Logistic regression fit (dashed line) shows a strong relationship between the proportion of non-detects and the median gene expression—<italic>P</italic>-value of 0.0003</p></caption><graphic xlink:href="btu239f4p"/></fig></p>
      <p>This suggests that qPCR non-detects are probably not missing at random; therefore, filtering non-detects will introduce bias in one’s inference. The only principled approach is to attempt to model the missing data mechanism and incorporate this into one’s analysis.</p>
    </sec>
    <sec id="SEC4.3">
      <title>4.3 The missing data mechanism</title>
      <p>Before proposing a missing data mechanism for qPCR non-detects, it is important to first determine what a non-detect represents. There are several possibilities:
<list list-type="order"><list-item><p>Truncation of a continuous expression distribution—a non-detect represents a true Ct value &gt;40. This implies that if the PCR were run for more cycles, one would eventually see an amplification above the Ct threshold. This would mean that the Ct values are a type of censored data.</p></list-item><list-item><p>A completely unexpressed transcript—no matter how long the PCR was run, one would never see amplification above the Ct threshold.</p></list-item><list-item><p>A failure to detect a true Ct value &lt;40—the Ct value should be &lt;40, but in the given experiment the transcript failed to amplify or its amplification efficiency was poor.</p></list-item></list>
</p>
      <p>We begin by evaluating the first potential explanation for non-detects by examining the distribution of Ct values including non-detects coded as 40 (<xref ref-type="fig" rid="btu239-F5">Fig. 5</xref>). The number of non-detects in these datasets far exceeds what one would expect based on fitting a normal distribution to the detected Ct values. Approximately 1.2, 1.8 and 2.8% of the measurements are non-detects in datasets 1, 2 and 3, respectively, where one would expect 0.02, 0.03 and &lt;0.01%. This argues against non-detects being explained completely by a truncation of the Ct value distribution, unless the distribution has an extremely long upper tail.
<fig id="btu239-F5" position="float"><label>Fig. 5.</label><caption><p>The distribution of Ct values in each of the three datasets. Here, non-detects are coded as 40</p></caption><graphic xlink:href="btu239f5p"/></fig></p>
      <p>Furthermore, if the non-detects represented censoring of values &gt;40, one would expect a reduction in bias by replacing the non-detects with a value ≥40. However, in general, bias is reduced by replacing non-detects with a value of 35 rather than 40 (<xref ref-type="fig" rid="btu239-F6">Fig. 6</xref>). This suggests that many non-detects are due to a failure to amplify rather than a true Ct value &gt;40.
<fig id="btu239-F6" position="float"><label>Fig. 6.</label><caption><p>Same as <xref ref-type="fig" rid="btu239-F1">Figure 1</xref>, with additional boxplots showing the residuals when non-detects are replaced with 35 rather than 40. Here, Ct values &gt;35 are also replaced by a value of 35. By replacing non-detects with a value of 35 rather than 40, the distribution of the residuals is far more similar between those in which the Ct values were observed and those containing a non-detect. However, this does not imply that one should replace non-detects with a value of 35. Such an approach makes very strong assumptions about the missing data mechanism and would require one to discard observed Ct values &gt;35</p></caption><graphic xlink:href="btu239f6p"/></fig></p>
      <p>Next, we evaluate the second potential explanation for non-detects—that a non-detect represents a completely unexpressed transcript. As previously mentioned, <xref ref-type="fig" rid="btu239-F4">Figure 4</xref> shows a strong relationship between low overall signal in a sample and a greater proportion of non-detects. Although some non-detects may represent a completely unexpressed gene, this cannot be the only explanation, given that samples with low signal (due to technical not biological differences) typically have a greater proportion of non-detects.</p>
      <p>Finally, examination of <xref ref-type="fig" rid="btu239-F5">Figure 5</xref> shows a relatively low number of Ct values between 35 and 40. Together with <xref ref-type="fig" rid="btu239-F6">Figure 6</xref>, in which replacing non-detects with a value of 35 rather than 40 reduced the bias in ΔCt and ΔΔCt values, this suggests that some non-detects represent a failure to detect a true Ct value &lt;40.</p>
    </sec>
    <sec id="SEC4.4">
      <title>4.4 A potential generative model</title>
      <p>One model to explain the observed behavior of non-detects in the Ct data is the following:
<disp-formula><mml:math id="UM2"><mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="true">{</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mi>ε</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mtext> if </mml:mtext><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mtext> non-detect </mml:mtext></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mtext> if </mml:mtext><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula>
where
<disp-formula><mml:math id="UM3"><mml:mrow><mml:mi>P</mml:mi><mml:mi>r</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="true">{</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mi>g</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mtext> if </mml:mtext><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mrow><mml:mtext> otherwise </mml:mtext></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula>
Here, <italic>Y<sub>ij</sub></italic> is the observed Ct value of gene <italic>i</italic> for sample <italic>j</italic>, <inline-formula><mml:math id="I6"><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is the true expression of gene <italic>i</italic> for sample <italic>j</italic>, <inline-formula><mml:math id="I7"><mml:mrow><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> represents the non-biological effects present in the observed data and <inline-formula><mml:math id="I8"><mml:mrow><mml:msub><mml:mi>ε</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> captures the technical and biological variability in the data. <italic>Z<sub>ij</sub></italic> is a binary variable representing whether a Ct value was obtained for gene <italic>i</italic> and sample <italic>j</italic> that takes on a value of 1 with probability <inline-formula><mml:math id="I9"><mml:mrow><mml:mi>g</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> for values of <italic>Y<sub>ij</sub></italic> less than some threshold <italic>S<sub>ij</sub></italic>. Here, <italic>S<sub>ij</sub></italic> represents the upper Ct value detection limit for gene <italic>i</italic> and sample <italic>j</italic>.</p>
      <p>In this framework, one can represent the standard assumptions regarding non-detects as: (i) <inline-formula><mml:math id="I10"><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>40</mml:mn><mml:mspace width=".2em"/><mml:mo>∀</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, where 40 is the total number of PCR cycles performed and (ii) <inline-formula><mml:math id="I11"><mml:mrow><mml:mi>g</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> meaning that Ct values &lt;40 are never reported as non-detects. However, the results shown above suggest that these assumptions are probably not valid. Specifically, <italic>S<sub>ij</sub></italic> may be &lt;40 for some genes and/or <inline-formula><mml:math id="I12"><mml:mrow><mml:mi>g</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> may be &lt;1.</p>
      <p>Furthermore, this model captures several important aspects of qPCR non-detects. The relationship between technical variability in expression and the proportion of non-detects is formalized in the dependence of <italic>Z<sub>ij</sub></italic> on <italic>Y<sub>ij</sub></italic> rather than <inline-formula><mml:math id="I13"><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>. The gap in observed Ct values between 35 and 40, i.e. the potential for Ct values <inline-formula><mml:math id="I14"><mml:mrow><mml:mo>&lt;</mml:mo><mml:mn>40</mml:mn></mml:mrow></mml:math></inline-formula> to be non-detects, is captured by <inline-formula><mml:math id="I15"><mml:mrow><mml:mi>g</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>&lt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> and/or <inline-formula><mml:math id="I16"><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:mn>40</mml:mn></mml:mrow></mml:math></inline-formula>.</p>
    </sec>
    <sec id="SEC4.5">
      <title>4.5 An EM algorithm to handle non-detects</title>
      <p>Having established that non-detects in qPCR data represent data missing not at random, we now propose a method that incorporates the missing data mechanism into subsequent statistical analyses. The expectation–maximization (EM) algorithm provides a method to obtain maximum likelihood estimates in the presence of missing data by iteratively calculating the conditional expectation:
<disp-formula><mml:math id="UM4"><mml:mrow><mml:mi>Q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>
</mml:mo><mml:mi>ϕ</mml:mi><mml:mo>
</mml:mo><mml:mo>|</mml:mo><mml:mo>
</mml:mo><mml:msub><mml:mi>ϕ</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>
</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>E</mml:mi><mml:mrow><mml:mspace width=".2em"/><mml:mo stretchy="true">[</mml:mo><mml:mrow><mml:mo>
</mml:mo><mml:mi>l</mml:mi><mml:mi>n</mml:mi><mml:mspace width=".4em"/><mml:mo>
</mml:mo><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>X</mml:mi><mml:mo>|</mml:mo><mml:mi>ϕ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mspace width=".2em"/><mml:mo>
</mml:mo><mml:mo>|</mml:mo><mml:mo>
</mml:mo><mml:mi>Y</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>ϕ</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>
</mml:mo></mml:mrow><mml:mo stretchy="true">]</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula>
and maximizing <inline-formula><mml:math id="I17"><mml:mrow><mml:mi>Q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>ϕ</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mi>ϕ</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> with respect to ϕ. Here, <italic>X</italic> is the complete unobserved data and <italic>Y</italic> is the incomplete observed data, ϕ is the set of all parameters, <inline-formula><mml:math id="I18"><mml:mrow><mml:mi>l</mml:mi><mml:mi>n</mml:mi><mml:mspace width=".2em"/><mml:mo>
</mml:mo><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>X</mml:mi><mml:mo>|</mml:mo><mml:mi>ϕ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is the complete data log-likelihood, and <inline-formula><mml:math id="I19"><mml:mrow><mml:msub><mml:mi>ϕ</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> is the estimate of ϕ at iteration <italic>n</italic>. This process is repeated until convergence (<xref rid="btu239-B6" ref-type="bibr">Dempster <italic>et al.</italic>, 1977</xref>).</p>
      <p>The challenging aspect of applying the EM algorithm to qPCR non-detects is calculating the conditional expectation. This requires one to estimate the distribution of gene expression given a non-detect. Here, we proceed via Bayes rule:
<disp-formula><mml:math id="UM5"><mml:mrow><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>
</mml:mo><mml:mo>|</mml:mo><mml:mo>
</mml:mo><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>P</mml:mi><mml:mi>r</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>
</mml:mo><mml:mo>|</mml:mo><mml:mo>
</mml:mo><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>*</mml:mo><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>P</mml:mi><mml:mi>r</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula>
We can estimate <inline-formula><mml:math id="I20"><mml:mrow><mml:mi>P</mml:mi><mml:mi>r</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>
</mml:mo><mml:mo>|</mml:mo><mml:mo>
</mml:mo><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> by examining the relationship between the proportion of non-detects and average observed expression within replicates. This approach permits flexible modeling of the data to either directly estimate the parameters of interest or to obtain estimates of the missing data that can be used to impute the non-detect values.</p>
      <p>To demonstrate the reduction in bias that one can achieve by treating non-detects as missing data, we propose the following model of the observed expression for gene <italic>i</italic>, sample-type <italic>j</italic> and replicate <italic>k</italic>, <italic>Y<sub>ijk</sub></italic>:
<disp-formula><mml:math id="UM6"><mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="true">{</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>ε</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mtext> if </mml:mtext><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mtext> non-detect </mml:mtext></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mtext> if </mml:mtext><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula>
where <inline-formula><mml:math id="I21"><mml:mrow><mml:msub><mml:mi>δ</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> represents a global shift in expression across samples and,
<disp-formula><mml:math id="UM7"><mml:mrow><mml:mi>P</mml:mi><mml:mi>r</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="true">{</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mi>g</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mtext> if </mml:mtext><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:mn>40</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mrow><mml:mtext> otherwise </mml:mtext></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula>
Here, <inline-formula><mml:math id="I22"><mml:mrow><mml:mi>g</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> can be estimated via the following logistic regression:
<disp-formula><mml:math id="UM8"><mml:mrow><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>g</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>P</mml:mi><mml:mi>r</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></disp-formula>
where <inline-formula><mml:math id="I23"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is an estimate of the average expression for gene <italic>i</italic> and sample-type <italic>j</italic>. For the data presented here, <inline-formula><mml:math id="I24"><mml:mrow><mml:msub><mml:mi>δ</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> can be estimated using the reference gene, Becn1.</p>
    </sec>
    <sec id="SEC4.6">
      <title>4.6 Treating non-detects as missing data reduces bias</title>
      <p>We begin by examining the effect of replacing non-detects with an imputed Ct value based on the conditional expectation calculated in the EM algorithm. Looking at the residuals within replicates in each dataset, it is clear that replacing non-detects with these imputed values results in far less bias in the ΔCt and ΔΔCt values than if we replaced the non-detects with a value of 40 (<xref ref-type="fig" rid="btu239-F7">Fig. 7</xref>).
<fig id="btu239-F7" position="float"><label>Fig. 7.</label><caption><p>Same as <xref ref-type="fig" rid="btu239-F1">Figure 1</xref>, but after imputing the non-detects using the proposed EM algorithm</p></caption><graphic xlink:href="btu239f7p"/></fig></p>
      <p>The improvement in bias after imputing the non-detects can also be seen in the example genes shown in <xref ref-type="fig" rid="btu239-F2">Figure 2</xref>. After replacing the non-detects with values imputed using the EM algorithm, the non-detect ΔCt and ΔΔCt values are far more similar to their replicate values, while retaining small differences due to the informative missingness (<xref ref-type="fig" rid="btu239-F8">Fig. 8</xref>). <xref ref-type="fig" rid="btu239-F8">Figure 8</xref>C shows one important limitation of the current implementation. Because the ΔCt values from the three normal samples all contained non-detects, their imputed values are fairly similar to the initial values based on replacing the non-detects with a value of 40. One could address this by implementing a slightly more complex EM algorithm that shrinks the imputed values toward a global mean; however, such an approach assumes that Pdlim2 is actually expressed in the normal samples in dataset 3. Given that all three replicates resulted in a non-detect, it may be that Pdlim2 is truly unexpressed in these samples. Any modeling for such situations will depend on the specific dataset being analyzed and the biological plausibility of the potential assumptions.
<fig id="btu239-F8" position="float"><label>Fig. 8.</label><caption><p>Same as <xref ref-type="fig" rid="btu239-F2">Figure 2</xref>, but after EM imputation of non-detects</p></caption><graphic xlink:href="btu239f8p"/></fig></p>
      <p>One can also use the EM algorithm to directly estimate the parameters of interest. In the example datasets reported here, these might be the average expression of each gene within each sample-type, <inline-formula><mml:math id="I25"><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>. Alternatively, one could use this framework to directly estimate the ΔCt or ΔΔCt values. Furthermore, the EM algorithm allows one to easily combine the treatment of non-detects with more complex statistical analyses.</p>
    </sec>
  </sec>
  <sec>
    <title>5 DISCUSSION</title>
    <p>In this manuscript, we have shown that the default procedure of replacing qPCR non-detects with the maximum PCR cycle number (typically 40) introduces a large bias in subsequent inference. We have carefully examined the nature of non-detects and shown that they likely represent data missing not at random. Furthermore, we have shown that many non-detects represent an amplification failure rather than a true Ct value &gt;40. Finally, we propose a relatively simple EM algorithm and show that it is able to greatly reduce the bias caused by non-detects. The flexibility of our approach allows one to easily tailor the method described here to one’s own analyses. Specifically, one could easily use a different normalization procedure or perform a more complex statistical analysis. Additionally, any analysis based on imputed values (rather than direct estimation of a parameter of interest) would benefit from a multiple imputation procedure.</p>
    <p><italic>Funding</italic>: <funding-source>National Institutes of Health</funding-source> (grant numbers <award-id>CA009363</award-id>, <award-id>CA138249</award-id>, <award-id>HG006853</award-id>); and an <funding-source>Edelman-Gardner Foundation Award</funding-source>.</p>
    <p><italic>Conflict of Interest:</italic> none declared.</p>
  </sec>
</body>
<back>
  <ref-list>
    <title>REFERENCES</title>
    <ref id="btu239-B1">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Almudevar</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Fitting Boolean networks from steady state perturbation data</article-title>
        <source>Stat. Appl. Genet. Mol. Biol.</source>
        <year>2011</year>
        <volume>10</volume>
        <fpage>47</fpage>
      </element-citation>
    </ref>
    <ref id="btu239-B2">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bustin</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Quantification of mRNA using real-time reverse transcription PCR (RT-PCR): trends and problems</article-title>
        <source>J. Mol. Endocrinol.</source>
        <year>2002</year>
        <volume>29</volume>
        <fpage>23</fpage>
        <lpage>39</lpage>
        <pub-id pub-id-type="pmid">12200227</pub-id>
      </element-citation>
    </ref>
    <ref id="btu239-B3">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bustin</surname>
            <given-names>SA</given-names>
          </name>
        </person-group>
        <article-title>Absolute quantification of mRNA using real-time reverse transcription polymerase chain reaction assays</article-title>
        <source>J. Mol. Endocrinol.</source>
        <year>2000</year>
        <volume>25</volume>
        <fpage>169</fpage>
        <lpage>193</lpage>
        <pub-id pub-id-type="pmid">11013345</pub-id>
      </element-citation>
    </ref>
    <ref id="btu239-B4">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bustin</surname>
            <given-names>SA</given-names>
          </name>
          <name>
            <surname>Nolan</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Pitfalls of quantitative real-time reverse-transcription polymerase chain reaction</article-title>
        <source>J. Biomol. Tech.</source>
        <year>2004</year>
        <volume>15</volume>
        <fpage>155</fpage>
        <pub-id pub-id-type="pmid">15331581</pub-id>
      </element-citation>
    </ref>
    <ref id="btu239-B5">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bustin</surname>
            <given-names>SA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The MIQE guidelines: minimum information for publication of quantitative real-time PCR experiments</article-title>
        <source>Clin. Chem.</source>
        <year>2009</year>
        <volume>55</volume>
        <fpage>611</fpage>
        <lpage>622</lpage>
        <pub-id pub-id-type="pmid">19246619</pub-id>
      </element-citation>
    </ref>
    <ref id="btu239-B6">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dempster</surname>
            <given-names>AP</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Maximum likelihood from incomplete data via the EM algorithm</article-title>
        <source>J. R. Stat. Soc. B</source>
        <year>1977</year>
        <volume>39</volume>
        <fpage>1</fpage>
        <lpage>38</lpage>
      </element-citation>
    </ref>
    <ref id="btu239-B7">
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Gelman</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Hill</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <source>Data Analysis Using Regression and Multilevel/Hierarchical Models</source>
        <year>2007</year>
        <publisher-loc>New York, NY, USA</publisher-loc>
        <publisher-name>Cambridge University Press</publisher-name>
      </element-citation>
    </ref>
    <ref id="btu239-B8">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gibson</surname>
            <given-names>U</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A novel method for real time quantitative RT-PCR</article-title>
        <source>Genome Res.</source>
        <year>1996</year>
        <volume>6</volume>
        <fpage>995</fpage>
        <lpage>1001</lpage>
        <pub-id pub-id-type="pmid">8908519</pub-id>
      </element-citation>
    </ref>
    <ref id="btu239-B9">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ginzinger</surname>
            <given-names>DG</given-names>
          </name>
        </person-group>
        <article-title>Gene quantification using real-time quantitative PCR: an emerging technology hits the mainstream</article-title>
        <source>Exp. Hematol.</source>
        <year>2002</year>
        <volume>30</volume>
        <fpage>503</fpage>
        <lpage>512</lpage>
        <pub-id pub-id-type="pmid">12063017</pub-id>
      </element-citation>
    </ref>
    <ref id="btu239-B10">
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Goni</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The qPCR data statistical analysis</article-title>
        <source>Integromics White Paper</source>
        <year>2009</year>
        <publisher-name>Integromics SL</publisher-name>
        <fpage>1</fpage>
        <lpage>9</lpage>
      </element-citation>
    </ref>
    <ref id="btu239-B11">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Higuchi</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Simultaneous amplification and detection of specific DNA sequences</article-title>
        <source>Biotechnology</source>
        <year>1992</year>
        <volume>10</volume>
        <fpage>413</fpage>
        <lpage>417</lpage>
        <pub-id pub-id-type="pmid">1368485</pub-id>
      </element-citation>
    </ref>
    <ref id="btu239-B12">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Karlen</surname>
            <given-names>Y</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Statistical significance of quantitative PCR</article-title>
        <source>BMC Bioinformatics</source>
        <year>2007</year>
        <volume>8</volume>
        <fpage>131</fpage>
        <pub-id pub-id-type="pmid">17445280</pub-id>
      </element-citation>
    </ref>
    <ref id="btu239-B13">
      <element-citation publication-type="book">
        <collab>Life Technologies</collab>
        <article-title>DataAssist v3.0 Software user instructions</article-title>
        <year>2011</year>
      </element-citation>
    </ref>
    <ref id="btu239-B14">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mar</surname>
            <given-names>JC</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Data-driven normalization strategies for high-throughput quantitative RT-PCR</article-title>
        <source>BMC Bioinformatics</source>
        <year>2009</year>
        <volume>10</volume>
        <fpage>110</fpage>
        <pub-id pub-id-type="pmid">19374774</pub-id>
      </element-citation>
    </ref>
    <ref id="btu239-B15">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>McMurray</surname>
            <given-names>HR</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Synergistic response to oncogenic mutations defines gene class critical to cancer phenotype</article-title>
        <source>Nature</source>
        <year>2008</year>
        <volume>453</volume>
        <fpage>1112</fpage>
        <lpage>1116</lpage>
        <pub-id pub-id-type="pmid">18500333</pub-id>
      </element-citation>
    </ref>
    <ref id="btu239-B16">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mestdagh</surname>
            <given-names>P</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A novel and universal method for microRNA RT-qPCR data normalization</article-title>
        <source>Genome Biol.</source>
        <year>2009</year>
        <volume>10</volume>
        <fpage>R64</fpage>
        <pub-id pub-id-type="pmid">19531210</pub-id>
      </element-citation>
    </ref>
    <ref id="btu239-B17">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nolan</surname>
            <given-names>T</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Quantification of mRNA using real-time RT-PCR</article-title>
        <source>Nat. Protoc.</source>
        <year>2006</year>
        <volume>1</volume>
        <fpage>1559</fpage>
        <lpage>1582</lpage>
        <pub-id pub-id-type="pmid">17406449</pub-id>
      </element-citation>
    </ref>
    <ref id="btu239-B18">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pfaffl</surname>
            <given-names>MW</given-names>
          </name>
        </person-group>
        <article-title>A new mathematical model for relative quantification in real-time RT–PCR</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2001</year>
        <volume>29</volume>
        <fpage>e45</fpage>
        <pub-id pub-id-type="pmid">11328886</pub-id>
      </element-citation>
    </ref>
    <ref id="btu239-B19">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Qureshi</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Sacan</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>A novel method for the normalization of microRNA RT-PCR data</article-title>
        <source>BMC Med. Genomics</source>
        <year>2013</year>
        <volume>6</volume>
        <issue>Suppl. 1</issue>
        <fpage>S14</fpage>
        <pub-id pub-id-type="pmid">23369279</pub-id>
      </element-citation>
    </ref>
    <ref id="btu239-B20">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sampson</surname>
            <given-names>E</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Gene signature critical to cancer phenotype as a paradigm for anticancer drug discovery</article-title>
        <source>Oncogene</source>
        <year>2013</year>
        <volume>32</volume>
        <fpage>3809</fpage>
        <lpage>18</lpage>
        <pub-id pub-id-type="pmid">22964631</pub-id>
      </element-citation>
    </ref>
    <ref id="btu239-B21">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schmittgen</surname>
            <given-names>TD</given-names>
          </name>
          <name>
            <surname>Livak</surname>
            <given-names>KJ</given-names>
          </name>
        </person-group>
        <article-title>Analyzing real-time PCR data by the comparative CT method</article-title>
        <source>Nat. Protoc.</source>
        <year>2008</year>
        <volume>3</volume>
        <fpage>1101</fpage>
        <lpage>1108</lpage>
        <pub-id pub-id-type="pmid">18546601</pub-id>
      </element-citation>
    </ref>
    <ref id="btu239-B22">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wittwer</surname>
            <given-names>CT</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Continuous fluorescence monitoring of rapid cycle DNA amplification</article-title>
        <source>Biotechniques</source>
        <year>1997</year>
        <volume>22</volume>
        <fpage>130</fpage>
        <lpage>139</lpage>
        <pub-id pub-id-type="pmid">8994660</pub-id>
      </element-citation>
    </ref>
    <ref id="btu239-B23">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yuan</surname>
            <given-names>JS</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Statistical analysis of real-time PCR data</article-title>
        <source>BMC bioinformatics</source>
        <year>2006</year>
        <volume>7</volume>
        <fpage>85</fpage>
        <pub-id pub-id-type="pmid">16504059</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
