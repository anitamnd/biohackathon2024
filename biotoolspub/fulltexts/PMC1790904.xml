<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-title>BMC Bioinformatics</journal-title>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">1790904</article-id>
    <article-id pub-id-type="publisher-id">1471-2105-8-18</article-id>
    <article-id pub-id-type="pmid">17239253</article-id>
    <article-id pub-id-type="doi">10.1186/1471-2105-8-18</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>PILER-CR: Fast and accurate identification of CRISPR repeats</article-title>
    </title-group>
    <contrib-group>
      <contrib id="A1" corresp="yes" contrib-type="author">
        <name>
          <surname>Edgar</surname>
          <given-names>Robert C</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <email>bob@drive5.com</email>
      </contrib>
    </contrib-group>
    <aff id="I1"><label>1</label>45 Monterey Dr., Tiburon, CA, USA</aff>
    <pub-date pub-type="collection">
      <year>2007</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>20</day>
      <month>1</month>
      <year>2007</year>
    </pub-date>
    <volume>8</volume>
    <fpage>18</fpage>
    <lpage>18</lpage>
    <ext-link ext-link-type="uri" xlink:href="http://www.biomedcentral.com/1471-2105/8/18"/>
    <history>
      <date date-type="received">
        <day>10</day>
        <month>5</month>
        <year>2006</year>
      </date>
      <date date-type="accepted">
        <day>20</day>
        <month>1</month>
        <year>2007</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Copyright © 2007 Edgar; licensee BioMed Central Ltd.</copyright-statement>
      <copyright-year>2007</copyright-year>
      <copyright-holder>Edgar; licensee BioMed Central Ltd.</copyright-holder>
      <license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/2.0">
        <p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/2.0"/>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</p>
        <!--<rdf xmlns="http://web.resource.org/cc/" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:dc="http://purl.org/dc/elements/1.1" xmlns:dcterms="http://purl.org/dc/terms"><Work xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:dcterms="http://purl.org/dc/terms/" rdf:about=""><license rdf:resource="http://creativecommons.org/licenses/by/2.0"/><dc:type rdf:resource="http://purl.org/dc/dcmitype/Text"/><dc:author>
               Edgar
               C
               Robert
               
               bob@drive5.com
            </dc:author><dc:title>
            PILER-CR: Fast and accurate identification of CRISPR repeats
         </dc:title><dc:date>2007</dc:date><dcterms:bibliographicCitation>BMC Bioinformatics 8(1): 18-. (2007)</dcterms:bibliographicCitation><dc:identifier type="sici">1471-2105(2007)8:1&#x0003c;18&#x0003e;</dc:identifier><dcterms:isPartOf>urn:ISSN:1471-2105</dcterms:isPartOf><License rdf:about="http://creativecommons.org/licenses/by/2.0"><permits rdf:resource="http://web.resource.org/cc/Reproduction" xmlns=""/><permits rdf:resource="http://web.resource.org/cc/Distribution" xmlns=""/><requires rdf:resource="http://web.resource.org/cc/Notice" xmlns=""/><requires rdf:resource="http://web.resource.org/cc/Attribution" xmlns=""/><permits rdf:resource="http://web.resource.org/cc/DerivativeWorks" xmlns=""/></License></Work></rdf>-->
      </license>
    </permissions>
    <abstract>
      <sec>
        <title>Background</title>
        <p>Sequencing of prokaryotic genomes has recently revealed the presence of CRISPR elements: short, highly conserved repeats separated by unique sequences of similar length. The distinctive sequence signature of CRISPR repeats can be found using general-purpose repeat- or pattern-finding software tools. However, the output of such tools is not always ideal for studying these repeats, and significant effort is sometimes needed to build additional tools and perform manual analysis of the output.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p>We present PILER-CR, a program specifically designed for the identification and analysis of CRISPR repeats. The program executes rapidly, completing a 5 Mb genome in around 5 seconds on a current desktop computer. We validate the algorithm by manual curation and by comparison with published surveys of these repeats, finding that PILER-CR has both high sensitivity and high specificity. We also present a catalogue of putative CRISPR repeats identified in a comprehensive analysis of 346 prokaryotic genomes.</p>
      </sec>
      <sec>
        <title>Conclusion</title>
        <p>PILER-CR is a useful tool for rapid identification and classification of CRISPR repeats. The software is donated to the public domain. Source code and a Linux binary are freely available at <ext-link ext-link-type="uri" xlink:href="http://www.drive5.com/pilercr"/>.</p>
      </sec>
    </abstract>
  </article-meta>
</front>
<body>
  <sec>
    <title>Background</title>
    <p>Recent analysis of prokaryotic genomes has lead to the discovery of a new class of repeat characterized by short, perfectly conserved elements of typical length 20 to 40 bases separated by unique sequences of similar length [<xref ref-type="bibr" rid="B1">1</xref>-<xref ref-type="bibr" rid="B3">3</xref>], Fig. <xref ref-type="fig" rid="F1">1</xref>. These are conventionally known as Clustered Regularly Interspaced Short Palindromic Repeats (CRISPRs). The use of the term palindromic is somewhat misleading as the sequences are not palindromes, though some have short (4–8 base) terminal regions that are approximately or exactly reverse-complemented. CRISPRs have been implicated in DNA rearrangement [<xref ref-type="bibr" rid="B4">4</xref>], host cell defense, replication and regulation [<xref ref-type="bibr" rid="B5">5</xref>,<xref ref-type="bibr" rid="B6">6</xref>] and provide new tools for evolutionary study and strain typing [<xref ref-type="bibr" rid="B7">7</xref>]. Due to the high conservation and regular spacing of CRISPR repeats (Fig. <xref ref-type="fig" rid="F1">1</xref>), many of them can be found relatively easily using ad hoc software tools [<xref ref-type="bibr" rid="B2">2</xref>,<xref ref-type="bibr" rid="B6">6</xref>] or existing software tools such as Reputer [<xref ref-type="bibr" rid="B8">8</xref>], as used in [<xref ref-type="bibr" rid="B5">5</xref>], and PatScan [<xref ref-type="bibr" rid="B9">9</xref>], as used in [<xref ref-type="bibr" rid="B10">10</xref>]. However, the output of such tools is not necessarily ideal for this purpose, and significant post-processing and manual curation may be needed. We have therefore developed PILER-CR, a dedicated software tool for the identification and preliminary analysis of CRISPR repeats. We will present validation suggesting that PILER-CR has both high sensitivity and high specificity.</p>
    <fig position="float" id="F1">
      <label>Figure 1</label>
      <caption>
        <p><bold>Structure of a CRISPR array</bold>. CRISPR repeats are perfectly (or almost perfectly) conserved short sequences, typically of length 20 to 40 bases, separated by unique sequences known as spacers. The spacer length in a given array is sometimes approximately conserved, varying by a few bases, and sometimes exactly conserved. The spacer length is typically similar to the repeat length.</p>
      </caption>
      <graphic xlink:href="1471-2105-8-18-1"/>
    </fig>
  </sec>
  <sec>
    <title>Implementation</title>
    <sec>
      <title>Algorithm</title>
      <p>PILER-CR is designed to identify the characteristic signature of CRISPR repeats. Once a repeat has been identified by PILER-CR, more sensitive search tools such as BLAST can be used to find fragmented or degraded copies of the repeat family. PILER-CR builds on techniques developed in the PILER family of algorithms for repeat analysis [<xref ref-type="bibr" rid="B12">12</xref>]. We will generically refer to the input sequence(s) as the <italic>genome</italic>. It may be useful to use several genomes as input as this will result in related repeats being clustered together (step 6 below). An <italic>array </italic>is a single CRISPR locus, i.e. set of CRISPR repeats and the intervening unique sequences known as <italic>spacers</italic>. The goal is to find a chain of local alignments that meet the criteria for being a CRISPR array, i.e. the repeats and spacers are within the expected ranges of length and sequence conservation. These ranges are parameters of the algorithm and can be changed by the user (Table <xref ref-type="table" rid="T2">2</xref>).</p>
      <table-wrap position="float" id="T2">
        <label>Table 2</label>
        <caption>
          <p>Major parameters of the PILER-CR algorithm</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <td align="left">
                <bold>Parameter</bold>
              </td>
              <td align="left">
                <bold>Description</bold>
              </td>
              <td align="left">
                <bold>Default</bold>
              </td>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left">minrepeat</td>
              <td align="left">Minimum length of a repeat. Smaller values might increase sensitivity, though repeats &lt; 16 bases are not currently known.</td>
              <td align="left">16</td>
            </tr>
            <tr>
              <td align="left">maxrepeat</td>
              <td align="left">Maximum length of a repeat. Larger values might increase sensitivity, though repeats &gt; 64 bases are not currently known. Larger values may also tend to give more false positives, such as RNAs.</td>
              <td align="left">64</td>
            </tr>
            <tr>
              <td align="left">minspacer</td>
              <td align="left">Minimum spacer length.</td>
              <td align="left">8</td>
            </tr>
            <tr>
              <td align="left">minarray</td>
              <td align="left">Minimum number of repeats in an array. A value &lt; 3 will give large numbers of false positives. A value &gt; 3 might increase specificity at the expense of missing shorter arrays.</td>
              <td align="left">3</td>
            </tr>
            <tr>
              <td align="left">maxspacer</td>
              <td align="left">Maximum spacer length.</td>
              <td align="left">64</td>
            </tr>
            <tr>
              <td align="left">minrepeatratio</td>
              <td align="left">Repeat length ratio (see caption for definition of ratio).</td>
              <td align="left">0.9</td>
            </tr>
            <tr>
              <td align="left">minspacerratio</td>
              <td align="left">Spacer length ratio (see caption for definition of ratio).</td>
              <td align="left">0.75</td>
            </tr>
            <tr>
              <td align="left">mincons</td>
              <td align="left">A run of minarray repeats with at least mincons similarity is required for an array to be reported. The value is specified as fractional identity 0.0 .. 1.0, with 1.0 meaning identical sequences. Increasing this value will tend to increase specificity by reducing the number of degraded or mutated repeats reported.</td>
              <td align="left">0.90</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <p>This table describes the most important parameters of PILER-CR algorithm. The Parameter column gives the name of the command-line option for the pilercr program. "Ratios" (<italic>minrepeatratio </italic>and <italic>minspacerratio</italic>) are defined as the ratio of the smallest to the longest, thus a value close to 1.0 requires lengths to be similar, 1.0 means identical lengths. Spacer lengths sometimes vary significantly, so the default ratio is smaller than for repeat lengths. Using a value of 1.0 for <italic>minrepeatratio </italic>or <italic>mincons </italic>is not recommended as this may lead to false negatives due to boundary mis-identification.</p>
        </table-wrap-foot>
      </table-wrap>
    </sec>
    <sec>
      <title>Step 1: Local alignments</title>
      <p>The first step is to find local alignments (hits) of the genome to itself; each hit is a candidate for being an alignment between two copies of a CRISPR repeat. As CRISPRs are separated by short distances, it suffices to search for alignments of two regions that are close to each other. Viewed as a self-similarity plot (dot-plot), this corresponds to searching for hits within a band around the main diagonal of the plot. PILER-CR uses a variant of Rasmussen <italic>et al.</italic>'s filter [<xref ref-type="bibr" rid="B13">13</xref>] to reduce the dynamic programming space. Searching within a band is accomplished by sliding a window along the genome. The filter utilizes a word index giving the sequence coordinates of each unique word. The index (occurrence table and lookup table, in Rasmussen <italic>et al.</italic>'s terminology) is updated in the obvious way as the window moves: words on the leading edge of the window are added to the index, words on the trailing edge are deleted. Regions of the dynamic programming matrix remaining after application of the filter are then explored for local alignments. Those local alignments that are too short or too long to plausibly align two CRISPRs are discarded. As an optimization, this is done during the dynamic programming step so that time is not wasted constructing long alignments.</p>
    </sec>
    <sec>
      <title>Step 2: Pile construction</title>
      <p>A <italic>pile </italic>is a contiguous set of bases, each one of which is covered by at least one local alignment. In other words, a pile is a repetitive region. By definition, piles are separated by unique regions, i.e. regions with no local alignments. As CRISPR repeats are separated by unique regions, a pile cannot contain more than one repeat. Piles are identified by sorting hit begin- and end-points by genome position, then traversing from beginning to end of the genome, keeping track of the coverage count at each point (add one when a begin point is encountered, subtract one when an end point is encountered). A pile begins where the coverage count rises above zero, and ends when it falls to zero again. Associated with each pile is the set of hits that cover it (Figs. <xref ref-type="fig" rid="F2">2</xref> and <xref ref-type="fig" rid="F3">3</xref>).</p>
      <fig position="float" id="F2">
        <label>Figure 2</label>
        <caption>
          <p><bold>Dot-plot of a CRISPR array against itself</bold>. Self-similarity plot ("dot-plot") of a genome against itself in a CRISPR array region. The main diagonal is shown as a dashed line. As the two axes represent the same sequence, local alignments (diagonal lines) are symmetrical about the main diagonal.</p>
        </caption>
        <graphic xlink:href="1471-2105-8-18-2"/>
      </fig>
      <fig position="float" id="F3">
        <label>Figure 3</label>
        <caption>
          <p><bold>Pile construction</bold>. When local alignments are projected onto the genome, "piles" are produced. A pile is a contiguous sequence of bases, each one of which has a hit to at least one other region in the genome. Bases that are not in a pile are unique sequence. Each local alignment connects two piles. In this figure, each hit has a different color so, for example, the purple hit connects the first and second pile.</p>
        </caption>
        <graphic xlink:href="1471-2105-8-18-3"/>
      </fig>
    </sec>
    <sec>
      <title>Step 3: Graph construction</title>
      <p>Each hit connects two piles. Using hits as edges and piles as nodes, a graph is constructed and the connected components of the graph are identified. Each connected component is a candidate for containing one or more CRISPR arrays. This is not essential but significantly reduces the search space for the following step.</p>
    </sec>
    <sec>
      <title>Step 4: Draft array identification</title>
      <p>Within each connected component, each pile is tested as the possible first member of a putative CRISPR array by following each possible chain of local alignments, abandoning the search as soon as the array fails the test criteria (Fig. <xref ref-type="fig" rid="F4">4</xref>). Hits with the shortest spacers are considered first (because a set of hits that skips every <italic>k</italic>th repeat for a small integer <italic>k </italic>may also meet the criteria for being an array). When an array is positively identified, hits in the range of coordinates covered by the array are discarded and a search for additional arrays in any remaining hits continues. A multiple alignment of the pile sequences is constructed using fast options of the MUSCLE algorithm [<xref ref-type="bibr" rid="B14">14</xref>,<xref ref-type="bibr" rid="B15">15</xref>], and a consensus sequence is generated.</p>
      <fig position="float" id="F4">
        <label>Figure 4</label>
        <caption>
          <p><bold>A chain of hits meeting CRISPR criteria</bold>. CRISPR arrays are identified by following chains of hits. Starting with a given pile, each hit that connects this pile to another pile later in the genome is a potential link in the chain. All possible chains are explored, abandoning the search each time the chain violates the criteria used for CRISPR array recognition (see Table 2). These criteria include maximum and minimum repeat length, maximum and minimum spacer length, and measures of the variance in repeat and spacer lengths. Shorter links are explored before longer links as regularly spaced arrays will be obtained by skipping every second, third... repeat. The figure shows the correct chain (arrows) for the example array from Fig. 3.</p>
        </caption>
        <graphic xlink:href="1471-2105-8-18-4"/>
      </fig>
    </sec>
    <sec>
      <title>Step 5: Array refinement</title>
      <p>Given output from step 4, several heuristics are applied in an attempt to improve the inferred arrays.</p>
      <p>5a. Partial or degraded copies of the repeat at the beginning or end of the array are deleted. These are often found in practice, and deleting them may expose conserved columns in flanking regions that correctly belong in the repeat. A partial or degraded repeat is identified by having three or more gaps when aligned to the current consensus sequence for the array, or by having more than twice as many gaps as the average for the array. This is repeated until there are no such repeats.</p>
      <p>5b. A 100% conserved column immediately preceding or following the current boundary is moved into the repeat. This is repeated until there are no such columns.</p>
      <p>5c. A column at the repeat boundary that is &lt; 90% conserved is deleted from the repeat, i.e. moved into the flanking region. This is repeated until there are no such columns.</p>
    </sec>
    <sec>
      <title>Step 6: Adjacent array merge</title>
      <p>Adjacent arrays with similar consensus sequences and similar spacer lengths are merged. Here, "merging" means that the two arrays are reported as a single array. The reason for this step is that it is quite common for there to be one or a small number of missing or degraded repeats embedded in an array. For two arrays to be merged, the following criteria must all be met. The ratios (a) of the repeat length and (b) spacer lengths for the two arrays must be ≥ 0.95. The two consensus sequences must be globally alignable, where global alignability is defined as having an optimal local alignment (Smith-Waterman) that covers ≥ 95% of the bases in the first array. Finally, the distance between the end of the first array and the beginning of the second array must be approximately <italic>k</italic>(<italic>R </italic>+ <italic>S</italic>), where <italic>k </italic>is 1, 2, 3 or 4, <italic>R </italic>is the average repeat length of the first array, <italic>S </italic>is the average spacer length, and "approximately" means that the ratio must be ≥ 0.95.</p>
    </sec>
    <sec>
      <title>Step 7: Clustering and alignment</title>
      <p>It is often found that repeats in different arrays have recognizably similar sequences. The program therefore clusters consensus sequences into similar groups, meaning groups of sequences having estimated mutual identities of ≥ 50%. For speed, the identity of two (unaligned) sequences is estimated by counting the number of identical words of length 4. Multiple alignments are created for each group, again using fast options of MUSCLE.</p>
    </sec>
    <sec>
      <title>Step 8: Report generation</title>
      <p>Finally, a report is generated; for an example see <xref ref-type="supplementary-material" rid="S2">Additional file 2</xref>. A detailed section specifies each repeat in an array, indicating any differences from the consensus sequence. Summary sections group arrays by estimated sequence similarity (see Step 7 above) and by position in the genome.</p>
    </sec>
    <sec>
      <title>Complexity</title>
      <p>The time and space complexities of the algorithm are strictly O(<italic>L</italic><sup>3</sup>) where <italic>L </italic>is the genome length. Steps 1 though 3 are O(<italic>L</italic><sup>2</sup>) under reasonable assumptions; the cubic term arises in Step 4. In practice, time and space requirements scale approximately as O(<italic>L</italic>).</p>
    </sec>
    <sec>
      <title>Estimating sensitivity</title>
      <p>The most common error made by PILER-CR is to mis-identify the endpoints of a CRISPR repeat by one or more positions (rarely more than one). However, in most such cases the array is essentially correctly identified, and the correct endpoints are immediately evident to the user from the report. When comparing two repeat sequences, we therefore define three categories of match: an exact match, a <italic>close </italic>match and no match (meaning not exact or close). An exact match requires the two sequences to be identical. A close match is defined by the following procedure. A local alignment of the two sequences is made using the Smith-Waterman algorithm, and the number of matching bases <italic>m </italic>in this alignment is computed. If the longest of the two full sequences has length <italic>L</italic>, the identity of the two sequences is defined as <italic>s </italic>= <italic>m</italic>/<italic>L</italic>. (Note the difference between this identity and the conventionally defined identity of the local alignment, which in general will be shorter and thus have higher identity). If <italic>s </italic>exceeds a pre-defined threshold, which we choose to be 0.9, then we consider the match to be close.</p>
    </sec>
    <sec>
      <title>Estimating specificity</title>
      <p>While false positives cannot be reliably determined in all cases, due to the lack of known complete reference data, some can be identified by visual inspection or by searches of databases of other types of repeat. Some RNA genes occur in arrays that are remarkably similar to CRISPR repeats, with the gene sequence and spacer lengths 100% conserved; these are occasionally reported by PILER-CR as CRISPRs.</p>
    </sec>
  </sec>
  <sec>
    <title>Results</title>
    <p>Here we report the results of running PILER-CR on 346 prokaryotic genomes (<xref ref-type="supplementary-material" rid="S1">Additional file 1</xref>, Tables <xref ref-type="table" rid="T1">1</xref> and <xref ref-type="table" rid="T2">2</xref>), and compare the reported CRISPR repeats with two previous surveys due to Jansen <italic>et al</italic>. [<xref ref-type="bibr" rid="B10">10</xref>] and Godde and Bickerton [<xref ref-type="bibr" rid="B11">11</xref>] (Table <xref ref-type="table" rid="T1">1</xref>, also Additional file Tables <xref ref-type="table" rid="T1">1</xref> and <xref ref-type="table" rid="T2">2</xref>). For brevity, we shall refer to these studies as J and G respectively. While J appears to be an attempt to identify all CRISPR repeats in the studied species, G is limited to CRISPRs that are associated with <italic>cas </italic>genes. We can thus use a comparison with J as a guide to both the sensitivity and specificity of PILER-CR, while G can be used as a guide to sensitivity only (a repeat in G should be found by PILER-CR, but the converse is not the case). We also reviewed each array manually and attempted to assess whether the array itself appeared to be a CRISPR, and if so whether the endpoints were correctly identified. While we believe this validation strategy gives a good qualitative overview of the accuracy of PILER-CR, it should not be considered rigorous. There is no independent experimental technique for identifying "true" CRISPR arrays, so we are comparing different computational methods against each other, each one of which has <italic>a priori </italic>unknown accuracy. Also, as accession numbers are not given in J or G, the input sequences used in the different studies may vary due to differences in the strains being sequenced, further data being added to partially sequenced genomes, and differences in draft versus finished genomes. It should also be noted that there is a subjective element in evaluating arrays, especially when they are short (three or four elements long). Finally, the entire J and G sets were used to assist in algorithm parameter tuning. A more rigorous strategy might divide J and G into test and training sets, though we see limited value in this approach given the lack of independent experimental evidence.</p>
    <table-wrap position="float" id="T1">
      <label>Table 1</label>
      <caption>
        <p>Comparison of PILER-CR results with the reference sets due to Jensen <italic>et al. </italic>and Godde and Bickerton</p>
      </caption>
      <table frame="hsides" rules="groups">
        <thead>
          <tr>
            <td align="left">
              <bold>Reference set</bold>
            </td>
            <td align="left">
              <bold>Exact</bold>
            </td>
            <td align="left">
              <bold>Close</bold>
            </td>
            <td align="left">
              <bold>No Match</bold>
            </td>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td align="left">Jensen <italic>et al</italic>.</td>
            <td align="left">34</td>
            <td align="left">19</td>
            <td align="left">6</td>
          </tr>
          <tr>
            <td align="left">Godde and Bickerton</td>
            <td align="left">79</td>
            <td align="left">19</td>
            <td align="left">11</td>
          </tr>
        </tbody>
      </table>
      <table-wrap-foot>
        <p>This table shows a comparison between repeats found by PILER-CR compared with those found by Jensen <italic>et al. </italic>and by Godde and Bickerton. See Estimating Sensitivity for definitions of the categories Exact, Close and No Match. This shows that PILER-CR finds exact or close matches with most sequences in the reference sets. Of the No Match cases, most appear to be due to differences in the genome sequences used in this study versus the previous study, most likely due to the use of different strains.</p>
      </table-wrap-foot>
    </table-wrap>
    <sec>
      <title>Sensitivity</title>
      <p><xref ref-type="supplementary-material" rid="S1">Additional file 1</xref>, Table <xref ref-type="table" rid="T1">1</xref> summarizes the agreement between CRISPR sequences reported by PILER-CR and those in the G and J sets (see Estimating Sensitivity in Methods). In some cases, we found no instances of the sequences reported by G or J in the genome, which is presumably explained by differences in the sequences used here versus the other studies. In other cases, all in the J set, PILER-CR found longer sequences that include the reference repeat as a subsequence, suggesting that Jensen <italic>et al. </italic>may have failed to identify the full repeat sequence. In a few cases, PILER-CR concatenates two arrays with similar repeat sequences, causing the consensus sequence to be truncated. There were no unambiguous false negatives. Thus, the sensitivity of PILER-CR with default parameters may approach 100%.</p>
    </sec>
    <sec>
      <title>Specificity</title>
      <p>Again, <xref ref-type="supplementary-material" rid="S1">Additional 1</xref>, file Table <xref ref-type="table" rid="T1">1</xref> is used (see Estimating Specificity in Methods). If longer lengths are allowed for CRISPR repeats, this may result in false positives due to RNA genes; the one example found in our experimental data with default algorithm settings is the longest repeat in <italic>Chromohalobacter salexigens</italic>. In <xref ref-type="supplementary-material" rid="S1">Additional file 1</xref>, Table <xref ref-type="table" rid="T1">1</xref> we have marked clear false positives as FP and questionable repeats as Q. We found 8 questionable and 11 false positives in a total of 319 repeats. We assume that repeats classified as close or truncated (see methods), or are novel versus the reference data, are true positives as there is no reason to suppose otherwise. If we further assume that all the questionable repeats are errors, we get an estimated specificity of 94%. This estimate is necessarily very approximate, and may be quite optimistic.</p>
    </sec>
  </sec>
  <sec>
    <title>Conclusion</title>
    <p>We have presented PILER-CR, a new software program for the identification of CRISPR repeats, and have shown that the algorithm probably has both good sensitivity and good specificity. While other repeat-finding methods can be applied to finding CRISPRs, sometimes requiring post-processing of their output, PILER-CR provides an integrated package generating a comprehensive and readable report. The program executes rapidly, completing the analysis of 346 prokaryotic genomes in about 15 minutes on a 2 GHz desktop computer. The output is designed to facilitate manual analysis of the reported CRISPR arrays. In addition to a multiple alignment of the repeats in each array, flanking regions and spacers are shown, making it visually obvious when PILER-CR mis-identifies the repeat boundary by one or a few positions. Repeats are clustered by similarity, exposing relationships between different arrays and, where applicable, providing confirmatory evidence of marginal arrays (i.e., arrays with only 3 or 4 repeats that may not be perfectly conserved).</p>
  </sec>
  <sec>
    <title>Availability and requirements</title>
    <p>PILER-CR is donated to the public domain. Source code is written in C++ and is designed to be easily ported across platforms. It has been compiled and tested using Microsoft Visual C++ on Windows and gcc on i86 Linux. Source code and a Linux binary are freely available as <xref ref-type="supplementary-material" rid="S3">Additional File 3</xref>, which contains the version used in this study, and at <ext-link ext-link-type="uri" xlink:href="http://www.drive5.com/pilercr"/>, where any updates and bug fixes will be posted.</p>
  </sec>
  <sec>
    <title>Authors' contributions</title>
    <p>RCE is solely responsible for the manuscript and the work described herein.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="S2">
      <caption>
        <title>Additional File 2</title>
        <p>Sample output generated by PILER-CR. The report has three sections: Detailed, Summary by Similarity and Summary by Position. The detailed section shows each repeat in each putative CRISPR array. The summary sections give one line for each array. Columns in the detailed section are: <italic>Pos</italic>, sequence position; <italic>Repeat</italic>, length of the repeat; <italic>%id</italic>, identity with the consensus; <italic>Spacer</italic>, length of spacer to the right of this repeat; <italic>Left flank</italic>, 10 bases to the left of this repeat, <italic>Repeat</italic>, sequence of this repeat (dots indicate positions where this repeat agrees with the consensus sequence below); <italic>Spacer</italic>, sequence of spacer to the right of this repeat, or 10 bases if this is the last repeat. The left flank sequence duplicates the end of the spacer for the preceding repeat; it is provided to facilitate visual identification of cases where the algorithm does not correctly identify repeat endpoints. At the end of each array there is a sub-heading that gives the average repeat length, average spacer length and consensus sequence. Columns in the summary sections are: <italic>Array</italic>, number 1, 2 ... referring back to the detailed report; <italic>Sequence</italic>, FASTA label of the sequence; <italic>From</italic>, start position of array; <italic>To </italic>end position of array; <italic># copies</italic>, number of repeats in the array, <italic>Repeat</italic>, average repeat length; <italic>Spacer</italic>, average spacer length; +, +/-, indicating orientation relative to the first array in the group, <italic>Distance</italic>, distance from previous array; <italic>Consensus</italic>, consensus sequence. In the Summary by Similarity section, arrays are grouped by similarity of their consensus sequences. If consensus sequences are sufficiently similar, they are aligned to each other to indicate probable relationships between arrays. In this example, Arrays 1–5 are very similar and are thus aligned; Array 6 appears to be unrelated and stands alone. In the Summary by Position section, arrays are sorted by position within the input sequence file. The Distance column facilitates identification of cases where a single array has been reported as two adjacent arrays. In such a case, (a) the consensus sequences will be similar or identical, and (b) the distance will be approximately a small multiple of the repeat length + spacer length. In the above example, we see how the flanking sequences provide immediate visual feedback. Array 4 has only three repeats, and the last column in the repeat alignment is (ACA), i.e. is not conserved. This column should probably be deleted from the repeat and moved to the spacer. Array 1 has a similar issue, but here it is not so clear that the last column should be deleted. The first three repeats in the array are perfectly conserved, and it is common to find degraded copies of the repeat at the beginning and end of an array. This also illustrates the difficulty of developing heuristics that are able to match human performance in making judgments in more difficult cases.</p>
      </caption>
      <media xlink:href="1471-2105-8-18-S2.txt" mimetype="text" mime-subtype="plain">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="S1">
      <caption>
        <title>Additional File 1</title>
        <p>Additional file Tables <xref ref-type="table" rid="T1">1</xref> and <xref ref-type="table" rid="T2">2</xref></p>
      </caption>
      <media xlink:href="1471-2105-8-18-S1.doc" mimetype="application" mime-subtype="msword">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="S3">
      <caption>
        <title>Additional File 3</title>
        <p>Tar with gzip compression. Source code and i86 Linux binary.</p>
      </caption>
      <media xlink:href="1471-2105-8-18-S3.gz" mimetype="application" mime-subtype="x-zip-compressed">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <sec>
      <title>Acknowledgements</title>
      <p>The author funded this work. The author is grateful to Viktor Kunin for suggesting that PILER could be adapted to find CRISPR repeats and for helpful feedback on early versions of the program.</p>
    </sec>
  </ack>
  <ref-list>
    <ref id="B1">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jansen</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>van Embden</surname>
            <given-names>JD</given-names>
          </name>
          <name>
            <surname>Gaastra</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Schouls</surname>
            <given-names>LM</given-names>
          </name>
        </person-group>
        <article-title>Identification of a novel family of sequence repeats among prokaryotes</article-title>
        <source>Omics</source>
        <year>2002</year>
        <volume>6</volume>
        <fpage>23</fpage>
        <lpage>33</lpage>
        <pub-id pub-id-type="pmid">11883425</pub-id>
        <pub-id pub-id-type="doi">10.1089/15362310252780816</pub-id>
      </citation>
    </ref>
    <ref id="B2">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mojica</surname>
            <given-names>FJ</given-names>
          </name>
          <name>
            <surname>Diez-Villasenor</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Soria</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Juez</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Biological significance of a family of regularly spaced repeats in the genomes of Archaea, Bacteria and mitochondria</article-title>
        <source>Mol Microbiol</source>
        <year>2000</year>
        <volume>36</volume>
        <fpage>244</fpage>
        <lpage>246</lpage>
        <pub-id pub-id-type="pmid">10760181</pub-id>
        <pub-id pub-id-type="doi">10.1046/j.1365-2958.2000.01838.x</pub-id>
      </citation>
    </ref>
    <ref id="B3">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bult</surname>
            <given-names>CJ</given-names>
          </name>
          <name>
            <surname>White</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Olsen</surname>
            <given-names>GJ</given-names>
          </name>
          <name>
            <surname>Zhou</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Fleischmann</surname>
            <given-names>RD</given-names>
          </name>
          <name>
            <surname>Sutton</surname>
            <given-names>GG</given-names>
          </name>
          <name>
            <surname>Blake</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>FitzGerald</surname>
            <given-names>LM</given-names>
          </name>
          <name>
            <surname>Clayton</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Gocayne</surname>
            <given-names>JD</given-names>
          </name>
          <name>
            <surname>Kerlavage</surname>
            <given-names>AR</given-names>
          </name>
          <name>
            <surname>Dougherty</surname>
            <given-names>BA</given-names>
          </name>
          <name>
            <surname>Tomb</surname>
            <given-names>JF</given-names>
          </name>
          <name>
            <surname>Adams</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>Reich</surname>
            <given-names>CI</given-names>
          </name>
          <name>
            <surname>Overbeek</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Kirkness</surname>
            <given-names>EF</given-names>
          </name>
          <name>
            <surname>Weinstock</surname>
            <given-names>KG</given-names>
          </name>
          <name>
            <surname>Merrick</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Glodek</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Scott</surname>
            <given-names>JL</given-names>
          </name>
          <name>
            <surname>Geoghagen</surname>
            <given-names>NS</given-names>
          </name>
          <name>
            <surname>Venter</surname>
            <given-names>JC</given-names>
          </name>
        </person-group>
        <article-title>Complete genome sequence of the methanogenic archaeon, Methanococcus jannaschii</article-title>
        <source>Science</source>
        <year>1996</year>
        <volume>273</volume>
        <fpage>1058</fpage>
        <lpage>1073</lpage>
        <pub-id pub-id-type="pmid">8688087</pub-id>
        <pub-id pub-id-type="doi">10.1126/science.273.5278.1058</pub-id>
      </citation>
    </ref>
    <ref id="B4">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>DeBoy</surname>
            <given-names>RT</given-names>
          </name>
          <name>
            <surname>Mongodin</surname>
            <given-names>EF</given-names>
          </name>
          <name>
            <surname>Emerson</surname>
            <given-names>JB</given-names>
          </name>
          <name>
            <surname>Nelson</surname>
            <given-names>KE</given-names>
          </name>
        </person-group>
        <article-title>Chromosome evolution in the Thermotogales: large-scale inversions and strain diversification of CRISPR sequences</article-title>
        <source>J Bacteriol</source>
        <year>2006</year>
        <volume>188</volume>
        <fpage>2364</fpage>
        <lpage>2374</lpage>
        <pub-id pub-id-type="pmid">16547022</pub-id>
        <pub-id pub-id-type="doi">10.1128/JB.188.7.2364-2374.2006</pub-id>
      </citation>
    </ref>
    <ref id="B5">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Haft</surname>
            <given-names>DH</given-names>
          </name>
          <name>
            <surname>Selengut</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Mongodin</surname>
            <given-names>EF</given-names>
          </name>
          <name>
            <surname>Nelson</surname>
            <given-names>KE</given-names>
          </name>
        </person-group>
        <article-title>A Guild of 45 CRISPR-Associated (Cas) Protein Families and Multiple CRISPR/Cas Subtypes Exist in Prokaryotic Genomes</article-title>
        <source>PLoS Comput Biol</source>
        <year>2005</year>
        <volume>1</volume>
        <fpage>e60</fpage>
        <pub-id pub-id-type="pmid">16292354</pub-id>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.0010060</pub-id>
      </citation>
    </ref>
    <ref id="B6">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Makarova</surname>
            <given-names>KS</given-names>
          </name>
          <name>
            <surname>Grishin</surname>
            <given-names>NV</given-names>
          </name>
          <name>
            <surname>Shabalina</surname>
            <given-names>SA</given-names>
          </name>
          <name>
            <surname>Wolf</surname>
            <given-names>YI</given-names>
          </name>
          <name>
            <surname>Koonin</surname>
            <given-names>EV</given-names>
          </name>
        </person-group>
        <article-title>A putative RNA-interference-based immune system in prokaryotes: computational analysis of the predicted enzymatic machinery, functional analogies with eukaryotic RNAi, and hypothetical mechanisms of action</article-title>
        <source>Biol Direct</source>
        <year>2006</year>
        <volume>1</volume>
        <fpage>7</fpage>
        <pub-id pub-id-type="pmid">16545108</pub-id>
        <pub-id pub-id-type="doi">10.1186/1745-6150-1-7</pub-id>
      </citation>
    </ref>
    <ref id="B7">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pourcel</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Salvignol</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Vergnaud</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>CRISPR elements in Yersinia pestis acquire new repeats by preferential uptake of bacteriophage DNA, and provide additional tools for evolutionary studies</article-title>
        <source>Microbiology</source>
        <year>2005</year>
        <volume>151</volume>
        <fpage>653</fpage>
        <lpage>663</lpage>
        <pub-id pub-id-type="pmid">15758212</pub-id>
        <pub-id pub-id-type="doi">10.1099/mic.0.27437-0</pub-id>
      </citation>
    </ref>
    <ref id="B8">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kurtz</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Schleiermacher</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>REPuter: fast computation of maximal repeats in complete genomes</article-title>
        <source>Bioinformatics</source>
        <year>1999</year>
        <volume>15</volume>
        <fpage>426</fpage>
        <lpage>427</lpage>
        <pub-id pub-id-type="pmid">10366664</pub-id>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/15.5.426</pub-id>
      </citation>
    </ref>
    <ref id="B9">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dsouza</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Larsen</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Overbeek</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Searching for patterns in genomic data</article-title>
        <source>Trends Genet</source>
        <year>1997</year>
        <volume>13</volume>
        <fpage>497</fpage>
        <lpage>498</lpage>
        <pub-id pub-id-type="pmid">9433140</pub-id>
        <pub-id pub-id-type="doi">10.1016/S0168-9525(97)01347-4</pub-id>
      </citation>
    </ref>
    <ref id="B10">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jansen</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Embden</surname>
            <given-names>JD</given-names>
          </name>
          <name>
            <surname>Gaastra</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Schouls</surname>
            <given-names>LM</given-names>
          </name>
        </person-group>
        <article-title>Identification of genes that are associated with DNA repeats in prokaryotes</article-title>
        <source>Mol Microbiol</source>
        <year>2002</year>
        <volume>43</volume>
        <fpage>1565</fpage>
        <lpage>1575</lpage>
        <pub-id pub-id-type="pmid">11952905</pub-id>
        <pub-id pub-id-type="doi">10.1046/j.1365-2958.2002.02839.x</pub-id>
      </citation>
    </ref>
    <ref id="B11">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Edgar</surname>
            <given-names>RC</given-names>
          </name>
          <name>
            <surname>Myers</surname>
            <given-names>EW</given-names>
          </name>
        </person-group>
        <article-title>PILER: identification and classification of genomic repeats</article-title>
        <source>Bioinformatics</source>
        <year>2005</year>
        <volume>21 Suppl 1</volume>
        <fpage>i152</fpage>
        <lpage>8</lpage>
        <pub-id pub-id-type="pmid">15961452</pub-id>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bti1003</pub-id>
      </citation>
    </ref>
    <ref id="B12">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rasmussen</surname>
            <given-names>KR</given-names>
          </name>
          <name>
            <surname>Stoye</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Myers</surname>
            <given-names>EW</given-names>
          </name>
        </person-group>
        <article-title>Efficient q-gram filters for finding all epsilon-matches over a given length</article-title>
        <source>J Comput Biol</source>
        <year>2006</year>
        <volume>13</volume>
        <fpage>296</fpage>
        <lpage>308</lpage>
        <pub-id pub-id-type="pmid">16597241</pub-id>
        <pub-id pub-id-type="doi">10.1089/cmb.2006.13.296</pub-id>
      </citation>
    </ref>
    <ref id="B13">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Edgar</surname>
            <given-names>RC</given-names>
          </name>
        </person-group>
        <article-title>MUSCLE: multiple sequence alignment with high accuracy and high throughput</article-title>
        <source>Nucleic Acids Res</source>
        <year>2004</year>
        <volume>32</volume>
        <fpage>1792</fpage>
        <lpage>1797</lpage>
        <pub-id pub-id-type="pmid">15034147</pub-id>
        <pub-id pub-id-type="doi">10.1093/nar/gkh340</pub-id>
      </citation>
    </ref>
    <ref id="B14">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Edgar</surname>
            <given-names>RC</given-names>
          </name>
        </person-group>
        <article-title>MUSCLE: a multiple sequence alignment method with reduced time and space complexity</article-title>
        <source>BMC Bioinformatics</source>
        <year>2004</year>
        <volume>5</volume>
        <fpage>113</fpage>
        <pub-id pub-id-type="pmid">15318951</pub-id>
        <pub-id pub-id-type="doi">10.1186/1471-2105-5-113</pub-id>
      </citation>
    </ref>
    <ref id="B15">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Godde</surname>
            <given-names>JS</given-names>
          </name>
          <name>
            <surname>Bickerton</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>The Repetitive DNA Elements Called CRISPRs and Their Associated Genes: Evidence of Horizontal Transfer Among Prokaryotes</article-title>
        <source>J Mol Evol</source>
        <year>2006</year>
        <pub-id pub-id-type="pmid">16612537</pub-id>
      </citation>
    </ref>
  </ref-list>
</back>
