<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Sci Rep</journal-id>
    <journal-id journal-id-type="iso-abbrev">Sci Rep</journal-id>
    <journal-title-group>
      <journal-title>Scientific Reports</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2045-2322</issn>
    <publisher>
      <publisher-name>Nature Publishing Group UK</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6917719</article-id>
    <article-id pub-id-type="publisher-id">55689</article-id>
    <article-id pub-id-type="doi">10.1038/s41598-019-55689-4</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>SimpactCyan 1.0: An Open-source Simulator for Individual-Based Models in HIV Epidemiology with R and Python Interfaces</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-3648-8031</contrib-id>
        <name>
          <surname>Liesenborgs</surname>
          <given-names>Jori</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Hendrickx</surname>
          <given-names>Diana M.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Kuylen</surname>
          <given-names>Elise</given-names>
        </name>
        <xref ref-type="aff" rid="Aff3">3</xref>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Niyukuri</surname>
          <given-names>David</given-names>
        </name>
        <xref ref-type="aff" rid="Aff5">5</xref>
        <xref ref-type="aff" rid="Aff6">6</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-1881-0637</contrib-id>
        <name>
          <surname>Hens</surname>
          <given-names>Niel</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-8054-1904</contrib-id>
        <name>
          <surname>Delva</surname>
          <given-names>Wim</given-names>
        </name>
        <address>
          <email>wimdelva@gmail.com</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff5">5</xref>
        <xref ref-type="aff" rid="Aff6">6</xref>
        <xref ref-type="aff" rid="Aff7">7</xref>
        <xref ref-type="aff" rid="Aff8">8</xref>
        <xref ref-type="aff" rid="Aff9">9</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 0604 5662</institution-id><institution-id institution-id-type="GRID">grid.12155.32</institution-id><institution>Expertise Centre for Digital Media, </institution><institution>Hasselt University – tUL, </institution></institution-wrap>Diepenbeek, Belgium </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 0604 5662</institution-id><institution-id institution-id-type="GRID">grid.12155.32</institution-id><institution>Center for Statistics, I-BioStat, </institution><institution>Hasselt University, </institution></institution-wrap>Diepenbeek, Belgium </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 0790 3681</institution-id><institution-id institution-id-type="GRID">grid.5284.b</institution-id><institution>IDLab, University of Antwerp, </institution></institution-wrap>Antwerp, Belgium </aff>
      <aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 0790 3681</institution-id><institution-id institution-id-type="GRID">grid.5284.b</institution-id><institution>Centre for Health Economics Research and Modelling Infectious Diseases and Centre for the Evaluation of Vaccination, Vaccine &amp; Infectious Disease Institute, </institution><institution>University of Antwerp, </institution></institution-wrap>Antwerp, Belgium </aff>
      <aff id="Aff5"><label>5</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2214 904X</institution-id><institution-id institution-id-type="GRID">grid.11956.3a</institution-id><institution>The South African Department of Science and Technology-National Research Foundation (DST-NRF) Centre of Excellence in Epidemiological Modelling and Analysis (SACEMA), </institution><institution>Stellenbosch University, </institution></institution-wrap>Stellenbosch, South Africa </aff>
      <aff id="Aff6"><label>6</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2214 904X</institution-id><institution-id institution-id-type="GRID">grid.11956.3a</institution-id><institution>Department of Global Health, Faculty of Medicine and Health, </institution><institution>Stellenbosch University, </institution></institution-wrap>Stellenbosch, South Africa </aff>
      <aff id="Aff7"><label>7</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2069 7798</institution-id><institution-id institution-id-type="GRID">grid.5342.0</institution-id><institution>International Centre for Reproductive Health, </institution><institution>Ghent University, </institution></institution-wrap>Ghent, Belgium </aff>
      <aff id="Aff8"><label>8</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 0668 7884</institution-id><institution-id institution-id-type="GRID">grid.5596.f</institution-id><institution>Rega Institute for Medical Research, </institution><institution>KU Leuven, </institution></institution-wrap>Leuven, Belgium </aff>
      <aff id="Aff9"><label>9</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2214 904X</institution-id><institution-id institution-id-type="GRID">grid.11956.3a</institution-id><institution>School for Data Science and Computational Thinking, </institution><institution>Stellenbosch University, </institution></institution-wrap>Stellenbosch, South Africa </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>17</day>
      <month>12</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>17</day>
      <month>12</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2019</year>
    </pub-date>
    <volume>9</volume>
    <elocation-id>19289</elocation-id>
    <history>
      <date date-type="received">
        <day>31</day>
        <month>10</month>
        <year>2018</year>
      </date>
      <date date-type="accepted">
        <day>29</day>
        <month>11</month>
        <year>2019</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2019</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The images or other third party material in this article are included in the article’s Creative Commons license, unless indicated otherwise in a credit line to the material. If material is not included in the article’s Creative Commons license and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this license, visit <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1">SimpactCyan is an open-source simulator for individual-based models in HIV epidemiology. Its core algorithm is written in C++ for computational efficiency, while the R and Python interfaces aim to make the tool accessible to the fast-growing community of R and Python users. Transmission, treatment and prevention of HIV infections in dynamic sexual networks are simulated by discrete events. A generic “intervention” event allows model parameters to be changed over time, and can be used to model medical and behavioural HIV prevention programmes. First, we describe a more efficient variant of the modified Next Reaction Method that drives our continuous-time simulator. Next, we outline key built-in features and assumptions of individual-based models formulated in SimpactCyan, and provide code snippets for how to formulate, execute and analyse models in SimpactCyan through its R and Python interfaces. Lastly, we give two examples of applications in HIV epidemiology: the first demonstrates how the software can be used to estimate the impact of progressive changes to the eligibility criteria for HIV treatment on HIV incidence. The second example illustrates the use of SimpactCyan as a data-generating tool for assessing the performance of a phylodynamic inference framework.</p>
    </abstract>
    <kwd-group kwd-group-type="npg-subject">
      <title>Subject terms</title>
      <kwd>HIV infections</kwd>
      <kwd>Epidemiology</kwd>
      <kwd>Software</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>Dutch Postcode Lottery</institution>
        </funding-source>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">https://doi.org/10.13039/501100002222</institution-id>
            <institution>The World Academy of Sciences (TWAS)</institution>
          </institution-wrap>
        </funding-source>
        <award-id>100014</award-id>
        <principal-award-recipient>
          <name>
            <surname>Niyukuri</surname>
            <given-names>David</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">https://doi.org/10.13039/501100003130</institution-id>
            <institution>Fonds Wetenschappelijk Onderzoek (Research Foundation Flanders)</institution>
          </institution-wrap>
        </funding-source>
        <award-id>W002514N</award-id>
        <award-id>G0B4314N</award-id>
        <award-id>G091210N</award-id>
        <principal-award-recipient>
          <name>
            <surname>Hens</surname>
            <given-names>Niel</given-names>
          </name>
          <name>
            <surname>Delva</surname>
            <given-names>Wim</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">https://doi.org/10.13039/501100006338</institution-id>
            <institution>Vlaamse Interuniversitaire Raad (Flemish Interuniversity Council)</institution>
          </institution-wrap>
        </funding-source>
        <award-id>ZEIN2010PR375</award-id>
        <principal-award-recipient>
          <name>
            <surname>Delva</surname>
            <given-names>Wim</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2019</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1" sec-type="introduction">
    <title>Introduction</title>
    <p id="Par2">Mathematical models are a commonly used to study key features of infectious disease epidemics. In this way, past or future dynamics of disease progression, transmission, prevention and treatment can be simulated. Deterministic compartmental models are the most popular. Using systems of difference or differential equations, these models represent how the size of population subgroups (e.g. stratified by infection status and disease stages) change over time. However, the implicit assumption of homogeneity of individuals within the same compartment may be particularly inadequate for sexually transmitted diseases, as the behavioural and biological drivers of these diseases are subject to high individual heterogeneity. Rather than simulating population averages, individual-based models (IBMs) simulate events that happen to specific individuals. Because of this, they are able to take various sources of individual heterogeneity into account<sup><xref ref-type="bibr" rid="CR1">1</xref></sup>.</p>
    <p id="Par3">IBMs allow for a bottom-up approach to modelling complex systems: population-level features are not modelled directly, but emerge from processes and events that are modelled at the level of the individual and its immediate environments. Thanks to multi-core processors and increased access to high-performance computing infrastructure, the computational cost of IBMs has become less prohibitive. As a result, a growing use of IBMs in infectious disease epidemiology has been observed<sup><xref ref-type="bibr" rid="CR2">2</xref></sup>.</p>
    <p id="Par4">A large amount of general frameworks for individual-based simulations have been developed in the last decades. These platforms vary widely in terms of platform properties, usability, operating ability, pragmatics and security management, making it difficult to choose the most suitable framework for simulation in the context of a particular research question<sup><xref ref-type="bibr" rid="CR3">3</xref></sup>.</p>
    <p id="Par5">Table <xref rid="Tab1" ref-type="table">1</xref> summarises functional and structural differences between SimpactCyan and ten other tools for constructing individual-based models of HIV transmission between individuals connected via sexual relationships. These tools were identified by an ongoing systematic review of simulation-based methods for the calibration of individual-based models to summary data in epidemiology<sup><xref ref-type="bibr" rid="CR4">4</xref></sup>.<table-wrap id="Tab1"><label>Table 1</label><caption><p>Functional and structural differences between SimpactCyan and existing tools for IBM studies in HIV epidemiology.</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Tool</th><th>Time implementation</th><th>Sexual network</th><th>R interface</th><th>Python interface</th><th>Source code available online</th><th>Reference</th></tr></thead><tbody><tr><td>SimpactCyan</td><td>continuous, mNRM</td><td>dynamic</td><td>✓</td><td>✓</td><td>✓</td><td><sup><xref ref-type="bibr" rid="CR53">53</xref>–<xref ref-type="bibr" rid="CR55">55</xref></sup></td></tr><tr><td>GEMFsim</td><td>continuous, Gillespie algorithm</td><td>static</td><td>✓</td><td>✓</td><td>✓</td><td><sup><xref ref-type="bibr" rid="CR5">5</xref></sup></td></tr><tr><td>FAVITES</td><td>continuous, Gillespie algorithm</td><td>static</td><td>✓</td><td>✓</td><td>✓</td><td><sup><xref ref-type="bibr" rid="CR6">6</xref></sup></td></tr><tr><td>EpiModel</td><td>discrete</td><td>dynamic</td><td>✓</td><td>✗</td><td>✓</td><td><sup><xref ref-type="bibr" rid="CR56">56</xref></sup></td></tr><tr><td>STDsim</td><td>discrete</td><td>dynamic</td><td>✗</td><td>✗</td><td>✗</td><td><sup><xref ref-type="bibr" rid="CR8">8</xref></sup></td></tr><tr><td>NetLogo</td><td>discrete</td><td>dynamic</td><td>✓</td><td>✗</td><td>✓</td><td><sup><xref ref-type="bibr" rid="CR57">57</xref>,<xref ref-type="bibr" rid="CR58">58</xref></sup></td></tr><tr><td>EMOD</td><td>discrete</td><td>dynamic</td><td>✗</td><td>✓</td><td>✓</td><td><sup><xref ref-type="bibr" rid="CR7">7</xref></sup></td></tr><tr><td>HIV-CDM</td><td>discrete</td><td>dynamic</td><td>✗</td><td>✗</td><td>✗</td><td><sup><xref ref-type="bibr" rid="CR59">59</xref></sup></td></tr><tr><td>MicroCOSM</td><td>discrete</td><td>dynamic</td><td>✗</td><td>✗</td><td>✗</td><td><sup><xref ref-type="bibr" rid="CR60">60</xref></sup></td></tr><tr><td>Path 2.0</td><td>discrete</td><td>dynamic</td><td>✓ (through RNetLogo)</td><td>✗</td><td>✗</td><td><sup><xref ref-type="bibr" rid="CR61">61</xref></sup></td></tr><tr><td>TITAN</td><td>discrete</td><td>dynamic</td><td>✓</td><td>✓</td><td>✓</td><td><sup><xref ref-type="bibr" rid="CR62">62</xref></sup></td></tr></tbody></table></table-wrap></p>
    <p id="Par6">As evident from Table <xref rid="Tab1" ref-type="table">1</xref>, available tools for IBM studies in HIV epidemiology vary in their features and limitations. Some tools simulate static instead of dynamic sexual networks. For others the source code is not freely available, or interfaces for Python or R (the most popular languages among infectious disease modellers) do not exist. Run time can be a limitation as well. NetLogo, for example, is a wonderful tool for building simple, didactic models<sup><xref ref-type="bibr" rid="CR3">3</xref></sup>. The problem is that they become painstakingly slow when HIV epidemics are simulated for more than a few hundred time steps and in populations larger than a few hundred individuals.</p>
    <p id="Par7">With a few exceptions (the GEMFsim<sup><xref ref-type="bibr" rid="CR5">5</xref></sup> and FAVITES<sup><xref ref-type="bibr" rid="CR6">6</xref></sup> simulators), existing simulators that can be readily used in HIV epidemiology implement IBMs in discrete time rather than continuous time. By simulation in continuous time we mean that events can take place and subsequently the state of the system can be updated at any point in time. It also means that the time interval between the execution of two consecutive events is only limited by the numeric precision of the implementation of the method used to sample event times. The advantage of a continuous time implementation of IBMs is the elegance with which it can handle competing risks to multiple events. For instance, an individual may be at risk of infecting his partner with HIV while also being at risk of dying because of AIDS. Fixed time steps can result in a situation where both these events are scheduled to take place between now and the next time step. However, this can only happen if the transmission event happens first. In contrast, evaluating the model in continuous time means the method is explicit about the order in which the two events are scheduled. Whichever event that is, the execution of that event includes processing the logical consequences for the likelihood of other, subsequent events. Furthermore, evaluation in continuous time means that the event scheduler "jumps" from one event to the next. In contrast, when the model is evaluated in fixed time steps, simulations that involve both common and rare events can be computationally inefficient. Commonly occurring events will require a small time step, which may lead to the occurrence of rare events being evaluated at a higher frequency than necessary.</p>
    <p id="Par8">To our knowledge, all existing implementations of IBMs for dynamic sexual networks consider the event of relationship formation in a sequential manner. As a consequence they require ad-hoc assumptions and decisions about in what order people “go out” to find partners and can “be found”. For example, in EMOD, males and females are placed in a separate queue, where they stay for a predefined period, after which they form a relationship<sup><xref ref-type="bibr" rid="CR7">7</xref></sup>. In STDsim, the order of going out to search for a partner and for being available for a relationship are both determined by stochastic processes<sup><xref ref-type="bibr" rid="CR8">8</xref></sup>.</p>
    <p id="Par9">SimpactCyan was conceived as a simulator for building IBMs to address research questions in HIV epidemiology. As we show in this paper, IBMs built with SimpactCyan can be used to interrogate hypotheses in the spheres of network and social epidemiology, computational biology, public health policy. The simulator is evaluated in continuous time. Each time an event happens, the state of the system is updated. Furthermore, the time-evolution of the sexual network is modelled by considering all possible relationships simultaneously instead of sequentially.</p>
    <p id="Par10">Simpact (<italic>SimpactWhite</italic>) was first developed in Matlab<sup><xref ref-type="bibr" rid="CR9">9</xref>–<xref ref-type="bibr" rid="CR11">11</xref></sup>. Later, variants were developed as a MASON Multi-agent Simulation Toolkit in Java (<italic>SimpactBlue</italic>), and in Python (<italic>SimpactyPurple</italic>)<sup><xref ref-type="bibr" rid="CR12">12</xref></sup>. To improve both speed and user-friendliness of the tool, we embarked on a major overhaul in 2013, leading to the current version (<italic>SimpactCyan</italic>) that combines a computationally efficient simulation engine written in C++ with R and Python interfaces. An exhaustive, deep comparison of SimpactCyan with all prior Simpact programs is beyond the scope of this paper, and arguably not crucially important, for the simple reason that there is no ongoing development of nor support for any of the legacy versions (SimpactWhite, SimpactBlue and SimpactPurple) and these versions are no longer in use. However, it may be useful to give some perspective of the relative improvement. In the early stages of SimpactCyan development, we conducted a comparison study that indicated runtimes for SimpactCyan were up to 280 times shorter, compared to SimpactWhite<sup><xref ref-type="bibr" rid="CR13">13</xref></sup>.</p>
    <p id="Par11">In this paper, we describe a more efficient variant of the modified Next Reaction Method (mNRM) that drives the simulator, we outline key built-in features and assumptions of individual-based models formulated in SimpactCyan, and provide code snippets for how to formulate, execute and analyse models in SimpactCyan through its R and Python interfaces. The complete documentation for SimpactCyan is availabe at <ext-link ext-link-type="uri" xlink:href="https://simpactcyan.readthedocs.io/en/latest/">https://simpactcyan.readthedocs.io/en/latest/</ext-link>. As runtimes for SimpactCyan strongly depend on population size and the intensity with which relationships are formed and dissolved in the population, we present the results of a concise simulation study to provide additional insights and visual representation of these associations. We end by giving two examples of applications in HIV epidemiology: the first demonstrates how the software can be used to estimate the impact that changes to the eligibility criteria for antiretroviral therapy (ART) had on HIV incidence in a hyperendemic setting. The second example illustrates how SimpactCyan can be used to generate data for evaluating the performance of other frameworks for modelling HIV transmission dynamics. A pre-print version of this paper is freely available on bioRxiv at 10.1101/440834v5.</p>
  </sec>
  <sec id="Sec2">
    <title>Discrete Events Simulation Algorithm</title>
    <sec id="Sec3">
      <title>The modified next reaction method (mNRM)</title>
      <p id="Par12">Event times, i.e. time points in the simulation at which events are scheduled to take place, are determined using the <italic>modified Next Reaction Method</italic> (mNRM)<sup><xref ref-type="bibr" rid="CR14">14</xref></sup>, a more efficient variant of the Gillespie algorithm<sup><xref ref-type="bibr" rid="CR15">15</xref>–<xref ref-type="bibr" rid="CR17">17</xref></sup> and the Next Reaction Method<sup><xref ref-type="bibr" rid="CR18">18</xref></sup>. The mNRM was originally designed for simulating chemical systems with time-dependent propensities and delays, but in SimpactCyan we use it to simulate how individuals are at risk of events according to time-dependent hazard functions<sup><xref ref-type="bibr" rid="CR19">19</xref></sup>. In the mNRM algorithm, there is a core distinction between <italic>internal event times</italic> and (simulated) <italic>real-world event times</italic>. The internal event times determine when an event will be triggered according to the event’s <italic>internal clock</italic>. Internal clock time advances faster as the hazard for the event increases. By real-world time we mean the calendar time in the simulated population.</p>
      <p id="Par13">Calling the <italic>internal</italic> time interval until a specific event fires Δ<italic>T</italic>, such internal time intervals are randomly sampled from an exponential distribution: Δ<italic>T</italic> ~ Exp(1).</p>
      <p id="Par14">The event’s <italic>hazard function h</italic>(•), referred to as the <italic>propensity function</italic> in<sup><xref ref-type="bibr" rid="CR14">14</xref></sup>, maps the internal time interval Δ<italic>T</italic> until the event fires onto Δ<italic>t</italic>, a real-world time interval,<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Delta T={\int }_{t}^{t+\Delta t}h(X(t),s)ds,$$\end{document}</tex-math><mml:math id="M2" display="block"><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>T</mml:mi><mml:mo>=</mml:mo><mml:msubsup><mml:mo>∫</mml:mo><mml:mi>t</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mi>h</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>X</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>d</mml:mi><mml:mi>s</mml:mi></mml:mrow><mml:mo>,</mml:mo></mml:math><graphic xlink:href="41598_2019_55689_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula>in which <italic>t</italic> is the previous time an event was triggered. (This corresponds to equation 13 in the original article<sup><xref ref-type="bibr" rid="CR14">14</xref></sup>, where we have omitted the event-specific index for concision.) It is this hazard <italic>h</italic> that can depend on the state <italic>X</italic>(<italic>t</italic>) of the simulation, and possibly also explicitly on time <italic>t</italic>. In SimpactCyan, the state of the simulation is made up of all the individuals in the population and their respective properties, such as their age, gender, HIV infection status, ART status, and whom they are in relationships with. This state <italic>X</italic>(<italic>t</italic>) does <italic>not</italic> depend on time in a <italic>continuous</italic> manner, it only changes when an event is fired, i.e. when its internal time interval expires. Note that the formula above is for a single event, and while Δ<italic>T</italic> itself is not affected by other events, the mapping onto Δ<italic>t</italic> certainly can be: other events can change the simulation state, and the hazard of the event depends on this state.</p>
      <p id="Par15">The main idea is illustrated in Fig. <xref rid="Fig1" ref-type="fig">1</xref>: internal time intervals are chosen from an exponential distribution, and are mapped onto real-world time intervals through hazard functions. Because hazards can depend on the simulation state and can have an explicit time dependency, this mapping can be rather complex.<fig id="Fig1"><label>Figure 1</label><caption><p>In the modified Next Reaction Method, intervals Δ<italic>T</italic><sub><italic>i</italic></sub> (in general for different events) are generated independently from other events in a straightforward manner, using an exponential probability distribution (Δ<italic>T</italic><sub><italic>i</italic></sub> ~ Exp(1)), and are used to advance an <italic>internal</italic> clock <italic>T</italic>. Using the notion of a hazard function (1), these internal time intervals are mapped onto intervals Δ<italic>t</italic><sub><italic>i</italic></sub>, which advance a (simulated) <italic>real</italic>-<italic>world</italic> time <italic>t</italic>, and need not have a straightforward relation to the internal times: a small internal time difference can lead to a large real-world time difference and vice versa. It is through this hazard function that interdependencies between events can be introduced.</p></caption><graphic xlink:href="41598_2019_55689_Fig1_HTML" id="d29e978"/></fig></p>
      <p id="Par16">While the hazard <italic>can</italic> cause complex behaviour, this is of course not necessarily the case. If one uses a constant hazard, this merely causes a linear scaling between internal time Δ<italic>T</italic> and real-world time Δ<italic>t</italic>:<disp-formula id="Equa"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Delta T=h\Delta t\,({\rm{for}}\,{\rm{a}}\,{\rm{constant}}\,{\rm{hazard}}).$$\end{document}</tex-math><mml:math id="M4" display="block"><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>T</mml:mi><mml:mo>=</mml:mo><mml:mi>h</mml:mi><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi><mml:mspace width="1em"/><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="normal">for</mml:mi><mml:mspace width=".25em"/><mml:mi mathvariant="normal">a</mml:mi><mml:mspace width=".25em"/><mml:mi mathvariant="normal">constant</mml:mi><mml:mspace width=".25em"/><mml:mi mathvariant="normal">hazard</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:math><graphic xlink:href="41598_2019_55689_Article_Equa.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par17">This also illustrates that the larger the hazard, the earlier the event will fire, i.e. the real-world time interval will be smaller.</p>
      <p id="Par18">As an example, let’s consider the event of forming a heterosexual relationship. At a certain time in the simulation, many formation events will be scheduled, one event for each man-woman pair that can possibly form a relationship. The internal time interval for each of these events will be drawn from the simple exponential distribution. The mapping to a real-world time at which the event will fire, is done using the hazard-based method, and the event that will take place next is the one that will have the smallest of these real-world times (cfr. the time ordering in step 6 of algorithm 3 in<sup><xref ref-type="bibr" rid="CR14">14</xref></sup>). This hazard depends on aspects of the simulation state as defined by the hazard function for relationship formation: how many relationships the man and woman of the candidate couple are already engaged in, what the preferred age differences with their respective partners are, etc. One can also imagine an explicit time dependency in the hazard: e.g. the hazard of forming a relationship increases as the time period since the relationship became possible gets longer.</p>
      <p id="Par19">While most of the events in SimpactCyan are scheduled using the exponential distribution to generate values for internal Δ<italic>T</italic>, some events are scheduled directly in real-world time. An example of this is the scheduling of the HIV ‘seeding’ event, i.e. the timing of introducing HIV into the population. This alternative method could still be thought of as a special case of internal and real-world time mapping. This is because if Δ<italic>T</italic> is set to the actual real-world time interval until the event fires, and the hazard is set to <italic>h</italic> = 1, internal and real-world time intervals match.</p>
    </sec>
    <sec id="Sec4">
      <title>More efficient mNRM algorithm</title>
      <p id="Par20">Each time an event is triggered, the state of the simulation changes. Because the hazard of any event can depend on this state, in the most general version of the mNRM algorithm, one would recalculate the real-world event times of all remaining events each time an event gets triggered: this ensures that the possibly changed state is taken into account. Always recalculating all event fire times is computationally very inefficient, however. Although the state may have been changed somewhat, this change may not be relevant for many of the event hazards in use. As a result, most updated real-world event times would be the same as before.</p>
      <p id="Par21">To avoid unnecessary recalculations of event times, SimpactCyan employs a variant of the mNRM algorithm, in which each individual is linked to a list of events that involve him or her, and events that involve multiple people will appear on the lists of all of these individuals. For example, a mortality event would be present in the list of only one individual, while a relationship formation event concerns two people and would therefore appear on two such lists. Figure <xref rid="Fig2" ref-type="fig">2</xref> illustrates this idea. The lists are meant to keep track of event times that may require recalculation as a result of another event firing. If the HIV-positive partner of Person X (not depicted in Fig. <xref rid="Fig2" ref-type="fig">2</xref>) dies, this death will trigger several updates to the system, including that the deceased gets removed from the population, and dissolution events are triggered immediately (i.e. no recalculation needed) for all the relationships that the deceased was engaged in. Such dissolution events will subsequently lead to the removal of the HIV transmission event that was on Person X’s list (also without any recalculation required).<fig id="Fig2"><label>Figure 2</label><caption><p>The Figure shows, for four different people in the population, what the next three scheduled events are after time point <italic>t</italic><sub><italic>k</italic></sub>. Solid lines represent time intervals; the dotted line represents the formation of a relationship; the arrow represents HIV transmission. We can see that Person A and Person B will form a relationship. Concurrent with their relationship to Person A, Person B is also already in a relationship with Person C. We can see that an HIV transmission from Person C to Person B is scheduled, after Person C is diagnosed. After HIV transmission, Person B and Person C break up their relationship. After forming a relationship with Person B, Person A (who was already diagnosed with HIV) is monitored to follow up the progression of HIV. Person A dies a non-AIDS related death. Person D, who is HIV positive, will progress to the chronic stage of HIV infection, after which he or she will develop AIDS, and die of AIDS-related complications.</p></caption><graphic xlink:href="41598_2019_55689_Fig2_HTML" id="d29e1074"/></fig></p>
      <p id="Par22">When an event fires, only the properties of a very limited set of people are changed, hence one only needs to recalculate the fire times of the events in those people’s lists. For example, when the event of Person A forming a relationship with Person B takes place, the real-world fire times for the events in the lists of Person A and Person B will be automatically recalculated. Apart from affecting the people in whose lists an event appears, some events can affect additional people. As an example, a birth event will only appear in the list of the pregnant woman and not in the event list of the father, because the scheduled birth should not be affected in the event of the death of the father. However, when triggered, the newborn will be listed as a child of the father. In general, the number of additionally affected people will be very small compared to the size of the population, causing only a fraction of the event fire times to be recalculated. This allows the modified algorithm to run much faster than the basic algorithm that always recalculates all event times. Furthermore, fire times of events that are present in the event lists of two individuals (e.g. relationship formation), are recalculated by only one of them.</p>
      <p id="Par23">Besides these types of events, there are also ‘global’ events. These events do not refer to a particular person and will modify the state in a very general way. In general, when such a global event is triggered, this causes <italic>all</italic> other event fire times to be recalculated. Introducing HIV into the population through an HIV seeding event is an example of a global event.</p>
    </sec>
  </sec>
  <sec id="Sec5">
    <title>Population and Events in SimpactCyan</title>
    <p id="Par24">Model populations consist of men and/or women. They can be introduced into the simulation in two ways: (i) during the initialization of the simulation, in which case individuals with certain ages (drawn from a distribution) are added to the simulation, and (ii) through the birth of new individuals during the course of the simulation run.</p>
    <p id="Par25">Once born, an individual will become sexually active when a <italic>debut event</italic> is triggered. If the individual is introduced into the population at the start of the simulation, and the age exceeds the debut age, this event no longer needs to be scheduled. Every person always has a ‘normal’ <italic>mortality event</italic> scheduled, which corresponds to a cause of death other than AIDS.</p>
    <p id="Par26">To get an HIV epidemic started, an <italic>HIV seeding event</italic> must be scheduled. When this event is triggered, a number of people in the existing population will be marked as being HIV-infected. An infected individual will go through a number of infection stages, starting with acute HIV infection. After a default duration of 3 months<sup><xref ref-type="bibr" rid="CR20">20</xref></sup>, a <italic>chronic stage event</italic> is triggered, moving the individual to the chronic infection stage. A fixed amount of time before dying of AIDS (15 months by default)<sup><xref ref-type="bibr" rid="CR20">20</xref></sup>, an <italic>AIDS stage event</italic> is triggered, marking the transition of the chronic HIV stage to the AIDS stage. Six months before the expected AIDS-related death, a <italic>final AIDS stage event</italic> is triggered, after which the individual is in the ‘final AIDS stage’. It is assumed that one is too ill to be sexually active during this final stage<sup><xref ref-type="bibr" rid="CR20">20</xref></sup>. When the <italic>AIDS mortality event</italic> is triggered, the individual dies of AIDS.</p>
    <p id="Par27">The population.msm parameter enables simulation of populations in which (some) men only form sexual relationships with other men, and/or can form relationships with with men and women. Under the default parameter setting (population.msm = no), every man-woman pair past the age of sexual debut can potentially form a relationship. For every such pair, a <italic>formation event</italic> is scheduled by sampling from the probability distribution that emerges as a result of the specified hazard function for relationship formation. An example for such a hazard function is the ‘agegap’ hazard, shown in the equation below. Only when an event of this type is triggered, an actual relationship is formed between the involved persons, which in turn can cause other events to get scheduled, e.g. a relationship dissolution event.<disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{array}{rcl}{\rm{hazard}} &amp; = &amp; F\times \exp \,({\alpha }_{{\rm{baseline}}}+{\alpha }_{{\rm{numrel}},{\rm{man}}}{P}_{{\rm{man}}}+{\alpha }_{{\rm{numrel}},{\rm{woman}}}{P}_{{\rm{woman}}}\\  &amp; + &amp; {\alpha }_{{\rm{numrel}},{\rm{diff}}}|{P}_{{\rm{man}}}-{P}_{{\rm{woman}}}|+{\alpha }_{{\rm{meanage}}}({A}_{{\rm{man}}}(t)+{A}_{{\rm{woman}}}(t))/2\\  &amp; + &amp; {\alpha }_{{\rm{eagerness}},{\rm{sum}}}({E}_{{\rm{man}}}+{E}_{{\rm{woman}}})+{\alpha }_{{\rm{eagerness}},{\rm{diff}}}|{E}_{{\rm{man}}}-{E}_{{\rm{woman}}}|\\  &amp; + &amp; {\alpha }_{{\rm{dist}}}|{\overrightarrow{R}}_{{\rm{man}}}-{\overrightarrow{R}}_{{\rm{woman}}}|\\  &amp; + &amp; {\alpha }_{{\rm{gap}},{\rm{factor}},{\rm{man}}}|{A}_{{\rm{man}}}(t)-{A}_{{\rm{woman}}}(t)-{D}_{p,{\rm{man}}}-{\alpha }_{{\rm{gap}},{\rm{agescale}},{\rm{man}}}{A}_{{\rm{man}}}(t)|\\  &amp; + &amp; {\alpha }_{{\rm{gap}},{\rm{factor}},{\rm{woman}}}|{A}_{{\rm{man}}}(t)-{A}_{{\rm{woman}}}(t)-{D}_{p,{\rm{woman}}}-{\alpha }_{{\rm{gap}},{\rm{agescale}},{\rm{woman}}}{A}_{{\rm{woman}}}(t)|\\  &amp; + &amp; \beta (t-{t}_{{\rm{ref}}}))\end{array}$$\end{document}</tex-math><mml:math id="M6" display="block"><mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="right"><mml:mrow><mml:mi mathvariant="normal">hazard</mml:mi></mml:mrow></mml:mtd><mml:mtd columnalign="center"><mml:mo>=</mml:mo></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mi>F</mml:mi><mml:mo>×</mml:mo><mml:mi>exp</mml:mi><mml:mspace width=".10em"/><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">baseline</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">numrel</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">man</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">man</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">numrel</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">woman</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">woman</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"/><mml:mtd columnalign="left"><mml:mo>+</mml:mo></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">numrel</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">diff</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">man</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">woman</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">meanage</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">man</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">woman</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"/><mml:mtd columnalign="left"><mml:mo>+</mml:mo></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">eagerness</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">sum</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">man</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">woman</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">eagerness</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">diff</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">man</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">woman</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"/><mml:mtd columnalign="left"><mml:mo>+</mml:mo></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">dist</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>R</mml:mi><mml:mo>→</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="normal">man</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>R</mml:mi><mml:mo>→</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="normal">woman</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"/><mml:mtd columnalign="left"><mml:mo>+</mml:mo></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">gap</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">factor</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">man</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">man</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">woman</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">man</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">gap</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">agescale</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">man</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">man</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"/><mml:mtd columnalign="left"><mml:mo>+</mml:mo></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">gap</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">factor</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">woman</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">man</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">woman</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">woman</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">gap</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">agescale</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">woman</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">woman</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"/><mml:mtd columnalign="left"><mml:mo>+</mml:mo></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mi>β</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">ref</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="41598_2019_55689_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula></p>
    <p id="Par28">This complex looking hazard is actually of the form exp(<italic>A</italic> + <italic>Bt</italic>). The <italic>α</italic> parameters are weights that need to be set in the configuration of the simulation. They control the importance of various aspects of how individuals choose sexual partners. Via so-called intervention events, these weight parameters can be changed at arbitrary points in time during the simulation. In this way, temporal changes in sexual risk behaviours can be modelled, such as reductions in partner concurrency, age-disparate relationships or overall sexual activity levels. Variable <italic>P</italic> represents the number of relationships that an individual is currently engaged in, <italic>A</italic>(<italic>t</italic>) the age of the individual, and <italic>E</italic> represents a person-specific sex drive, of which the distribution is user-defined to allow control over the amount of heterogeneity in sexual activity within the population. The effect of distance (<inline-formula id="IEq1"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$|{\overrightarrow{R}}_{{\rm{man}}}-{\overrightarrow{R}}_{{\rm{woman}}}|$$\end{document}</tex-math><mml:math id="M8"><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>R</mml:mi><mml:mo>→</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="normal">man</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>R</mml:mi><mml:mo>→</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="normal">woman</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">|</mml:mo></mml:math><inline-graphic xlink:href="41598_2019_55689_Article_IEq1.gif"/></alternatives></inline-formula>) between the candidate partners can also be taken into account.</p>
    <p id="Par29">In the terms about the age gap, the age difference between the man and woman in the potential relationship is compared to the preferred age difference <italic>D</italic><sub><italic>p</italic></sub> (which defaults to zero). If the <italic>α</italic><sub>gap,agescale</sub> values are set to zero, then <italic>D</italic><sub><italic>p</italic></sub> will always be the preferred age gap; a positive value between zero and one will cause the preferred age difference to increase as the individual grows older. The <italic>α</italic><sub>gap,factor</sub> values at the start of these terms in turn determine the importance of the preferred age difference in the hazard. By setting the <italic>α</italic><sub>gap,factor</sub> to a negative value, the hazard decreases as the actual age difference between the candidate partners deviates from the preferred age difference.</p>
    <p id="Par30">The <italic>β</italic> parameter can be used to introduce an effect on the hazard that depends on the time since the relationship became possible. Here, <italic>t</italic><sub>ref</sub> refers to the point in time at which the relationship between the two candidate partners became possible. If no relationship existed between them earlier, this is the time at which the youngest person reached the debut age. On the other hand, if they were previously in a relationship with each other already, it is the time at which that relationship was dissolved. For completeness, the factor <italic>F</italic> is a normalization-like factor, to be able to use similar parameters for different population sizes.</p>
    <p id="Par31">A formation event results in the establishment of a sexual relationship, and subsequently, the female partner is at risk of falling pregnant. In that case a <italic>conception event</italic> will be triggered and a while later a <italic>birth event</italic> will take place, introducing a new individual into the population. In case one of the partners in the relationship is HIV-infected, transmission of the virus may occur. If so, a <italic>transmission event</italic> will fire, and the newly infected individual will go through the different infection stages as described earlier. Of course, it is also possible that the relationship will cease to exist, in which case a <italic>dissolution event</italic> will be triggered. Note that in the version at the time of writing, there is no mother-to-child-transmission (MTCT).</p>
    <p id="Par32">Starting ART and dropping out of treatment is managed by another sequence of events. When an individual becomes HIV-infected, either by HIV seeding or by transmission, first a <italic>diagnosis event</italic> is scheduled. Upon diagnosis, an <italic>HIV monitoring event</italic> is scheduled to monitor the progression of the HIV infection. When this event is fired, ART may be initiated, but only if the individual is both eligible (according to a CD4 cell count threshold) and willing to start HIV treatment; if not, a new monitoring event will be scheduled. If ART is initiated, no more monitoring events will be scheduled, but the individual will be at risk of discontinuing his or her HIV treatment, in which case a <italic>dropout event</italic> is triggered. When a person drops out of treatment, a new <italic>diagnosis event</italic> will be scheduled, which should be interpreted as an act of re-engagement in HIV Care<sup><xref ref-type="bibr" rid="CR21">21</xref></sup>.</p>
  </sec>
  <sec id="Sec6">
    <title>Formulating, Running and Analysing IBMs with SimpactCyan from R or Python</title>
    <p id="Par33">Instructions for installing the core SimpactCyan program and its R interface (the Python interface is automatically installed along with the core program) can be found at <ext-link ext-link-type="uri" xlink:href="http://www.simpact.org/how-to-use-simpact/">http://www.simpact.org/how-to-use-simpact/</ext-link>. To set up a simulation, one needs to prepare a configuration file as a text file with key/value pairs, describing all parameters of the simulation, a snippet of which could look like this:</p>
    <p id="Par34">…</p>
    <p id="Par35">
population.nummen = 200
</p>
    <p id="Par36">
population.numwomen = 200
</p>
    <p id="Par37">
population.simtime = 40
</p>
    <p id="Par38">…</p>
    <p id="Par39">Preparing the configuration file manually is time-consuming work however, as <italic>all</italic> event properties needed in a simulation must be set. To make it easier to prepare and run simulations, there is a Python module that can be used to control SimpactCyan from Python, or alternatively an R library that can be installed in R, with a similar interface. It is also possible to use a combined approach: first prepare a configuration file from within R or Python, and subsequently use this configuration to start simulations from the command-line. It can be very helpful when running simulations on a high performance computing cluster for example, where R or Python may not be available.</p>
    <p id="Par40">To use SimpactCyan from within an R session, the RSimpactCyan library must first be installed and loaded. This provides a simpact.run function that allows a simulation to be configured much more easily than using the configuration file mentioned above: instead of needing to set all parameters of a simulation, only the parameters that are different from the default values need to be specified. The full documentation of all the parameters that can be configured, what they mean and what their default values are, is found at <ext-link ext-link-type="uri" xlink:href="https://simpactcyan.readthedocs.io/en/latest/simpact_simulationdetails.html">https://simpactcyan.readthedocs.io/en/latest/simpact_simulationdetails.html</ext-link>. If only the key/value pairs in the code snippet above deviate from their default values, the configuration of the simulation would simply become:</p>
    <p id="Par41">
cfg &lt;- list()
</p>
    <p id="Par42">
cfg[“population.nummen”] &lt;− 200
</p>
    <p id="Par43">
cfg[“population.numwomen”] &lt;− 200
</p>
    <p id="Par44">
cfg[“population.simtime”] &lt;− 40
</p>
    <p id="Par45">Similarly, the Python module pysimpactcyan defines a PySimpactCyan class with a run member function that also needs only the settings that differ from the defaults:</p>
    <p id="Par46">
cfg = { }
</p>
    <p id="Par47">
cfg[“population.nummen”] = 200
</p>
    <p id="Par48">
cfg[“population.numwomen”] = 200
</p>
    <p id="Par49">
cfg[“population.simtime”] = 40
</p>
    <p id="Par50">Many of the configuration values will be character strings or numbers, but for some options it is allowed to specify one of the supported one- or two-dimensional probability distributions. For example, the birth.pregnancyduration.dist.type is by default set to fixed with a value corresponding to 268/365 (simulation times are expressed in years), such that every pregnant woman would give birth after precisely 268 days. To allow for some variability (e.g. a standard deviation of 16 days), a log-normal distribution could be used instead:</p>
    <p id="Par51">
mu &lt;− 268/365
</p>
    <p id="Par52">
var &lt;- (16/365)2
</p>
    <p id="Par53">
cfg[“birth.pregnancyduration.dist.type”] &lt;- “lognormal”
</p>
    <p id="Par54">
cfg[“birth.pregnancyduration.dist.lognormal.zeta”] &lt;- log(mu/sqrt(1 + var/mu2))
</p>
    <p id="Par55">
cfg[“birth.pregnancyduration.dist.lognormal.sigma”] &lt;- sqrt(log(1 + var/mu2))
</p>
    <p id="Par56">Apart from using a fixed number, supported one-dimensional distributions are the beta, exponential, gamma, log-normal, normal and uniform distributions, as well as user-defined discrete distributions (e.g. based on the frequencies listed in a CSV file). For two-dimensional distributions, one can specify a fixed pair of values, or choose values from binormal or uniform distributions. Here too, user-defined discrete distributions can be specified.</p>
  </sec>
  <sec id="Sec7">
    <title>Runtime Analysis</title>
    <p id="Par57">We conducted a small simulation study with SimpactCyan to explore how the runtime varies as a function of population size (at the outset of the simulation), single-core versus multi-core execution of the simulation, fraction of the population of the opposite sex that each individual can potentially form relationships with, and number of relationships that are formed over the course of the simulation. Specifically, we designed scenarios of HIV epidemics in heterosexual populations and ran each scenario over a calendar time period of 40 years. Each scenario was repeated 10 times with different seeds for the random number generators, and the average runtime was calculated per scenario. Scenarios varied by initial population size (4 000, 10 000 and 20 000), the fraction of the population of the opposite sex that each individual could form relationships with (0.2 and 0.4), and the effect of the number of relationships already engaged in by candidate partners on the log-transformed hazard of these two individuals forming a relationship (i.e. the <italic>α</italic><sub>numrel,man</sub> and <italic>α</italic><sub>numrel,woman</sub> parameters in the hazard function (−0.5 and −5)). These parameters are strongly correlated with the number of relationships that are formed over the course of a simulation. Lastly, we executed simulations with the single-core and multi-core versions of the algorithm. Simulations were run on a MacBook Pro with Intel Core i9 6-core processor, running macOS Mojave (Version 10.14.3).</p>
    <p id="Par58">The results of this simulation study are summarised in Fig. <xref rid="Fig3" ref-type="fig">3</xref>. Runtimes increase faster than linearly with population size. This is to be expected, since the number of potential relationships that needs to be scheduled in a population of x men and y women is x * y. I.e. this number increases quadratically with population size. Reducing the number of potential partners by setting the population.eyecap.fraction parameter to a value smaller than 1, leads to an appreciable reduction in runtime, without affecting the rate at which relationships are formed by much. Running the simulation in parallel (all 6 cores of the machine’s processor are used in the calculations) only leads to a (modest) speedup for scenarios of highly connected networks (many relationships are being formed) in large populations. Typically, simulation studies require several dozens or hundreds of simulation runs, and in that case it is more efficient to distribute single-core simulations in parallel over multiple cores than running multi-core simulations sequentially.<fig id="Fig3"><label>Figure 3</label><caption><p>Mean runtime, in minutes, of simulation runs for model scenarios varying in population size, opposite sex population fraction accessible for relationship formation, mean number of relationships formed over the course of the simulation, and computing cores used for each of the runs.</p></caption><graphic xlink:href="41598_2019_55689_Fig3_HTML" id="d29e1953"/></fig></p>
  </sec>
  <sec id="Sec8">
    <title>Model Applications</title>
    <p id="Par59">The following section discusses two example simulations that were done using SimpactCyan. The first illustrates how SimpactCyan can be used to assess the impact of progressive changes to the ART eligibility criteria in Eswatini (formerly known as Swaziland). The second illustrates the use of SimpactCyan as a data-generating tool for assessing the performance of other modelling frameworks. All code and data files necessary to reproduce the examples are available at <ext-link ext-link-type="uri" xlink:href="https://github.com/wdelva/SimpactCyanExamples">https://github.com/wdelva/SimpactCyanExamples</ext-link>.</p>
    <sec id="Sec9">
      <title>The impact of Early Access to ART for All on HIV incidence</title>
      <p id="Par60">In the MaxART project<sup><xref ref-type="bibr" rid="CR22">22</xref></sup>, SimpactCyan is used to estimate the likely impact of Eswatini’s shift towards “Early Access to ART for All” (EAAA) on the incidence of HIV. HIV incidence is the rate at which HIV-uninfected people acquire the infection. Such infection events are scheduled each time a relationship is formed between an HIV-infected and an HIV-uninfected individual. The hazard for the event is given by<disp-formula id="Equb"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\rm{hazard}}=\exp \,(a+b{V}^{-c}+{\rm{other}}\,{\rm{terms}}),$$\end{document}</tex-math><mml:math id="M10" display="block"><mml:mi mathvariant="normal">hazard</mml:mi><mml:mo>=</mml:mo><mml:mi>exp</mml:mi><mml:mspace width=".10em"/><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo>+</mml:mo><mml:mi>b</mml:mi><mml:msup><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mi mathvariant="normal">other</mml:mi><mml:mspace width=".25em"/><mml:mi mathvariant="normal">terms</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:math><graphic xlink:href="41598_2019_55689_Article_Equb.gif" position="anchor"/></alternatives></disp-formula>where the other terms are not enabled by default, but allow for a hazard-lowering effect of multiple ongoing relationships (so-called coital dilution<sup><xref ref-type="bibr" rid="CR23">23</xref>,<xref ref-type="bibr" rid="CR24">24</xref></sup>), as well as a hazard-increasing effect of adolescent age among women<sup><xref ref-type="bibr" rid="CR25">25</xref></sup>. In this formula, <italic>a</italic>, <italic>b</italic> and <italic>c</italic> are model parameters; the <italic>V</italic> value represents the current HIV viral load of the person that is already infected.</p>
      <p id="Par61">The viral load model is based upon the notion that an infected person has a specific set-point viral load, <italic>V</italic><sub>sp</sub>, which corresponds to the viral load in the chronic stage of the infection. The three parameters person.vsp.toacute.x, person.vsp.toaids.x and person.vsp.tofinalaids.x determine the factors by which the HIV transmission hazard should be multiplied during the initial acute stage, as well as the early and late AIDS stages. The <italic>V</italic> value in this hazard expression can therefore be different from the <italic>V</italic><sub>sp</sub> value, depending on the time since infection. The non-linear form of this hazard function was inspired by equation (9) published by Hargrove <italic>et al</italic>.<sup><xref ref-type="bibr" rid="CR26">26</xref></sup>, while the default parameter values are based on a fit to model output generated by Fraser <italic>et al</italic>.<sup><xref ref-type="bibr" rid="CR27">27</xref></sup>.</p>
      <p id="Par62">At the time of HIV acquisition, time till HIV-related death is determined, based on a paper by Arnaout <italic>et al</italic>.<sup><xref ref-type="bibr" rid="CR28">28</xref></sup>:<disp-formula id="Equc"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${t}_{{\rm{survival}}}=\frac{C}{{V}_{{\rm{sp}}}^{-k}}\times {10}^{x}.$$\end{document}</tex-math><mml:math id="M12" display="block"><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">survival</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mi>C</mml:mi><mml:mrow><mml:msubsup><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">sp</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfrac><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mi>x</mml:mi></mml:msup><mml:mo>.</mml:mo></mml:math><graphic xlink:href="41598_2019_55689_Article_Equc.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par63">In this formula, <italic>C</italic> and <italic>k</italic> are parameters that can be configured by the user if desired; the <italic>x</italic> parameter (which defaults to zero) is person-specific, and its distribution can be configured to control the amount of variation in post-HIV infection survival times among people with the same set-point viral load.</p>
      <p id="Par64">The set-point viral load value allocated to a newly infected individual is partly determined by that of their infector, i.e. some heritability of set-point viral load is assumed<sup><xref ref-type="bibr" rid="CR29">29</xref></sup>. This is done by using a two-dimensional distribution<disp-formula id="Equd"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\rm{prob}}\,({V}_{{\rm{sp}}{\rm{.infector}}},{V}_{{\rm{sp}}{\rm{.infected}}}),$$\end{document}</tex-math><mml:math id="M14" display="block"><mml:mi mathvariant="normal">prob</mml:mi><mml:mspace width=".25em"/><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">sp</mml:mi><mml:mi mathvariant="normal">.infector</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">sp</mml:mi><mml:mi mathvariant="normal">.infected</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:math><graphic xlink:href="41598_2019_55689_Article_Equd.gif" position="anchor"/></alternatives></disp-formula>of which the parameters can be chosen using the configuration values. This is subsequently used to obtain the conditional probability when fixing the initial <italic>V</italic><sub>sp</sub> value for a person that becomes infected due to the transmission event. By default, a symmetric, truncated bivariate normal distribution with mean 4, minimum 1, maximum 8, standard deviation 1 and correlation coefficient 0.33 is used to sample a log10 set-point viral load value for a newly infected person, conditional on the set-point viral load of the infector. To choose the initial set-point viral loads for ‘seed infections’, a marginal probability distribution is used, however.</p>
      <p id="Par65">ART initiation affects both the expected time till HIV-related death and the infectiousness of the person on ART. As soon as ART is started, the log10 viral load is assumed to drop by a user-defined fraction, and the updated current viral load is used to re-calculate <italic>t</italic><sub>survival</sub>. In the EAAA simulation study we assumed that upon ART initiation, the log10 viral load drops by 70%, effectively rendering the viral load “undetectable” for most ART clients. Via intervention events, most model parameters can be changed at arbitrary points in time during the simulation. However, person-specific parameter values (e.g. the probability of accepting ART if ART-eligible) and some event-times (e.g. time of non-HIV-related death) are determined at the time the individual is introduced into the population (at the start of the simulation or at birth). Hence, changing related parameters through an intervention event would only affect individuals born into the population after this intervention event, and not the extant population.</p>
      <p id="Par66">In this study, intervention events allowed us to assume that ART was gradually introduced around the year 2000, and that the CD4 cell count threshold for ART eligibility progressively shifted towards ever more inclusive criteria, alongside a decreasing lagtime between HIV infection and HIV diagnosis. These assumptions hold in both the “Status Quo” scenario and the “Early Access to ART for All” (EAAA) scenario. In the EAAA scenario, however, an additional policy change is modelled: a policy of immediate access to ART for all people infected with HIV is adopted from October 2016. In the alternative scenario, the CD4 cell count threshold for ART eligibility stays at 500 cells/microliter from mid 2013 onwards.</p>
      <p id="Par67">The EAAA model was calibrated to demographic, epidemiological and programmatic data (which we refer to as target features) from Eswatini. Specifically, we used the UNAIDS annual national HIV prevalence estimates (1990–2017) and ART coverage estimates (2010–2017)<sup><xref ref-type="bibr" rid="CR30">30</xref></sup>, the estimated average population growth rate over the period 2000 to 2016<sup><xref ref-type="bibr" rid="CR31">31</xref></sup>, the gender- and age group-specific HIV prevalence and incidence estimates from the 2011–2012 SHIMS I study<sup><xref ref-type="bibr" rid="CR32">32</xref></sup> and the UNAIDS 2017 estimate for the fraction of people aged 15 and above who were virally suppressed (less than 1000 viral copies per mL blood)<sup><xref ref-type="bibr" rid="CR30">30</xref></sup>. Nineteen model parameters were calibrated to these data. Together these parameters determine the sexual behavioural and demographic dynamics of the model population, as well as temporal changes in the rate at which HIV-positive people in the model population were diagnosed with HIV infection, and the extent to which adolescent girls and young women are biologically more susceptible to HIV acquisition than older women and men. In doing so, these 19 parameters drive the model’s features (i.e. summary statistics) that needed to be matched to the target features. Model calibration was achieved by applying the adaptive population Monte Carlo Approximate Bayesian Computation scheme described by Lenormand <italic>et al</italic>.<sup><xref ref-type="bibr" rid="CR33">33</xref></sup>. Iteratively sampling from the parameter space, starting from the prior distributions (wide-ranged uniform distributions) of the 19 model parameters, the method searches for areas in parameter space that produce model features close to the target features. After thirteen waves of simulations, totalling 29 500 model runs, the convergence criterion was reached and the calibration scheme produced a posterior distribution for the 19 parameters, by way of the 250 best fitting models. Here, “model” means a unique parameter combination producing model features similar to the target features. For each of the 250 models that jointly comprised the parameter posterior distribution, we calculated the root means squared relative error between model features and target features, as a summary measure of goodness-of-fit. The 3 models that fit the data best, which one can think of as the estimated mode of the posterior, were used in the forward projecting step of the analysis. In Supplementary Table <xref rid="MOESM1" ref-type="media">S1</xref>, we provide the complete list of the 66 summary statistics (target features) that were used to calibrate the model, as well as the corresponding model features, obtained by averaging over the 10 model runs.</p>
      <p id="Par68">In this second part of the analysis, we simulated two scenarios for the expansion of ART in Eswatini, and for each of the two scenarios we ran each of the 3 models 10 times by keeping the model parameter fixed and only changing the seed of the random number generator. In the EAAA scenario, we simply used the 3 best-fitting models and ran them until 2032. In the counterfactual scenario, the same model parameters were used with the exception that the CD4 threshold for ART eligibility remained capped at 500 CD4 cells per microliter from mid 2013 onwards. In all of the subplots of Fig. <xref rid="Fig4" ref-type="fig">4</xref>, the output from the 3 models is grouped by colour: shades of red for the EAAA scenario and shades of blue for the counterfactual scenario. For each model, the output of the 10 individual model runs is shown in thin dashed lines, and a solid line shows the average model trend. A darker, thick line represents the average across the 30 (3 times 10) runs for each scenario. Grey boxes represent the ranges around the UNAIDS estimates within which the actual numbers lie, based on the best available information<sup><xref ref-type="bibr" rid="CR30">30</xref></sup>. The black dot in Fig. <xref rid="Fig4" ref-type="fig">4b</xref> indicates the 2017 UNAIDS estimate for HIV incidence among 15–49 year-old adults in Eswatini<sup><xref ref-type="bibr" rid="CR34">34</xref></sup> (not used for model calibration).<fig id="Fig4"><label>Figure 4</label><caption><p>Programmatic and epidemic projections under a “Status Quo” (blue) and “Early Access to ART for All” (red) scenario for the roll-out of a nation-wide ART programme. (<bold>a</bold>) ART coverage: Fraction of the adult HIV-positive population (≥15 years old) on ART. (<bold>b</bold>) HIV incidence rate among 15 to 49 year-old people. (<bold>c</bold>) HIV prevalence among 15 to 49 year-old people.</p></caption><graphic xlink:href="41598_2019_55689_Fig4_HTML" id="d29e2261"/></fig></p>
      <p id="Par69">The impact of the policy shift to EAAA was estimated by the relative reduction in HIV incidence (1 minus the ratio of the incidence rates under the two scenarios). Under the counterfactual scenario, HIV incidence was projected to drop by 12% by the end of 2019, from its base level of 2.2/100 PY in October 2016. However, under the factual scenario, the models, on average, estimated that the incidence will decrease by 64% over that same period, to 0.8/100 PY. The impact of EAAA, as measured by the incidence rate ratio for the 2 scenarios is projected to remain stable over the next decade. The variation between the output of these three models, as shown in Fig. <xref rid="Fig4" ref-type="fig">4b</xref>, provides a sense of the uncertainty around our best guess of the future impact of EAAA on HIV incidence. It should, however, not be interpreted as an estimate of the credibility or confidence interval, because only the mode of the posterior was used in the impact estimation.</p>
    </sec>
    <sec id="Sec10">
      <title>SimpactCyan as a data-generating benchmarking tool</title>
      <p id="Par70">Phylogenetic trees - branching diagrams depicting the evolutionary relationships among various biological species based on how similar (parts of) their genomes are, have been used as input into so-called phylodynamic models to infer properties of HIV epidemics such as time-trends in HIV incidence rates<sup><xref ref-type="bibr" rid="CR35">35</xref>,<xref ref-type="bibr" rid="CR36">36</xref></sup> or the age-mixing pattern in HIV transmission clusters<sup><xref ref-type="bibr" rid="CR37">37</xref></sup>. Yet, validating these novel modelling frameworks is challenging, given that the true epidemic properties are typically unknown. Likewise, when precise and accurate empirical evidence is lacking, it is difficult to assess to what extent this model-based inference is sensitive to breaches in the model’s assumptions. For instance, the validity of some phylodynamic models hinges on HIV sequence data being available for the majority of HIV-positive people<sup><xref ref-type="bibr" rid="CR38">38</xref></sup>. In most countries in sub-Saharan Africa, however, this is not the case. In Fig. <xref rid="Fig5" ref-type="fig">5</xref> we illustrate the use of SimpactCyan to assess the effect of reduced HIV sequence coverage on the correlation between the timing of the internal nodes of the time-resolved phylogenetic tree and the timing of the actual HIV transmission events.<fig id="Fig5"><label>Figure 5</label><caption><p>(<bold>a</bold>) The cumulative HIV transmission network, linking all individuals whose HIV infections originated from one seed infector (man 858). (<bold>b</bold>) The time-resolved phylogenetic tree, reconstructed from synthetic HIV sequence data, generated by simulating the molecular evolution of HIV viral strains across the HIV transmission network. (<bold>c</bold>) The probability density of internal nodes in the reconstructed phylogenetic tree(shades of blue) and simulated HIV transmission events (red). The correlation between the timing of the internal nodes and HIV transmission events becomes weaker as the HIV sequence coverage decreases.</p></caption><graphic xlink:href="41598_2019_55689_Fig5_HTML" id="d29e2307"/></fig></p>
      <p id="Par71">First, we simulated an HIV epidemic similar to the epidemics in the EAAA analysis explained in the previous model application. Figure <xref rid="Fig5" ref-type="fig">5a</xref> shows the cumulative HIV transmission network that originated from one of the 20 seed infectors (man 858). This network links all individuals who got infected with HIV by man 858 or one of his descendants by the end of the simulation. Next, we converted the transmission network into a phylogenetic tree by assuming that HIV transmission events correspond to branching points in the phylogeny. While this assumption is obviously overly simplistic, it is not an uncommon assumption in phylodynamic modelling studies<sup><xref ref-type="bibr" rid="CR39">39</xref>–<xref ref-type="bibr" rid="CR42">42</xref></sup>. More importantly, it does not invalidate the didactic purpose of this model application. That purpose is to illustrate SimpactCyan’s potential use in benchmarking the performance of another modelling framework by constructing a range of scenarios in which the extent to which the assumptions made by the other framework are in line with the processes that generated the simulated data. Having converted the transmission network into a phylogenetic tree, we simulated the viral evolution along this phylogeny, using the Seq-Gen program<sup><xref ref-type="bibr" rid="CR43">43</xref></sup>. For this, we assumed a generalised time-reversible substitution model<sup><xref ref-type="bibr" rid="CR44">44</xref></sup> with a gamma-invariable mixture model (GTR + <italic>γ</italic> + I) for rate heterogeneity among sites. In this way, we generated synthetic HIV sequence data. Specifically, for the root sequence we chose a consensus sequence of the pol region of HIV-1 subtype C, isolated in 1989 from South Africa and retrieved from the HIV Sequence Database of the Los Alamos National Library (LANL) (access number HIV.1.C.ZA.PolCDS1989)<sup><xref ref-type="bibr" rid="CR45">45</xref></sup>. The program jModelTest version 2.1.3<sup><xref ref-type="bibr" rid="CR46">46</xref></sup> was used for selecting the best fitting evolutionary model to explain the viral diversity in a dataset of HIV-1 subtype C sequences from 386 South African patients, also extracted from the LANL HIV Sequence Database. Using hierarchical likelihood ratio tests, the GTR + <italic>γ</italic> + I model was ranked as the best fitting evolutionary model for these viral sequence data, and the model’s parameter values as estimated by jModelTest were used in the forward viral evolution simulation. Specifically, the relative frequencies of adenine (A), cytosine (C), guanine (G), and thymine (T) were estimated at 0.3906, 0.1752, 0.2201, and 0.2142 respectively. Further, the inferred value for the shape parameter for the <italic>γ</italic> rate heterogeneity was 0.625, and the heterogeneity in transition rate across sites was discretized into 4 discrete <italic>γ</italic> rate categories. The 6 substitution rate parameters of the GTR model were estimated at 1.9803, 9.4404, 0.9423, 0.8770, 11.6367, and 1.0000, with an assumed evolutionary rate of 0.00475 substitutions per site per year (branch length scaling factor)<sup><xref ref-type="bibr" rid="CR47">47</xref>,<xref ref-type="bibr" rid="CR48">48</xref></sup>. The fraction of invariant sites was estimated at 0.213. Next, we fed these synthetic sequences into the phangorn<sup><xref ref-type="bibr" rid="CR49">49</xref></sup> and treedater R packages<sup><xref ref-type="bibr" rid="CR50">50</xref></sup> to reconstruct the time-resolved phylogenetic tree (Fig. <xref rid="Fig5" ref-type="fig">5b</xref>), by fitting the GTR + <italic>γ</italic> + I model with a likelihood-based approach and root-to-trip regression. Lastly, we summarised the timing of the internal nodes in the reconstructed time-resolved tree by a vector of the number of internal nodes (i.e. branching points) per calendar year time interval.</p>
      <p id="Par72">In Supplementary Table <xref rid="MOESM1" ref-type="media">S2</xref>, we show the model parameters of the generalised time-reversible substitution model with a gamma-invariable mixture model (GTR + <italic>γ</italic> + I) for rate heterogeneity among sites, fitted to the empirical sequence data (sample size = 386), and fitted to the simulated sequences (sample size = 2896). To allow for a more direct comparison, we extracted from the complete synthetic sequence dataset a matching sample of simulated sequences with sampling dates as close as possible to those of the empirical sequence data. In Supplementary Fig. <xref rid="MOESM1" ref-type="media">S1</xref>, we also show the empirical phylogenetic tree, the matching sample simulated tree, and a violin plot of the density of patristic distances of the respective trees. Lastly, we report in Supplementary Table <xref rid="MOESM1" ref-type="media">S3</xref> nine topological properties of the respective trees. Taken together, this additional information shows strong agreement between empirical and simulated data.</p>
      <p id="Par73">In the ideal case, the sequence dataset includes sequences for all people who were ever infected with HIV, and in addition to that, the molecular evolution model used to reconstruct the phylogenetic tree is exactly the same model that was used to generate the sequence data. Under such ideal circumstances, the timing of the simulated HIV transmission events should correlate strongly with the timing of the internal nodes in the reconstructed tree. Indeed, in a perfect scenario of internal consistency and complete data, the distribution of internal nodes in the reconstructed phylogenetic tree and simulated HIV transmission events matched nearly perfected (red and dark blue lines in Fig. <xref rid="Fig5" ref-type="fig">5c</xref>). While an exhaustive sensitivity analysis of how phylodynamic inference could be affected by missing data and assumptions that are not consistent with the data-generating processes is beyond the scope of this paper, we simulated three additional scenarios, to illustrate how reduced sequences coverage (50%, 25% and 12.5%) could add noise and bias to the phylodynamic inference. Coverage here is defined as the fraction of people in the cumulative HIV transmission network for whom a consensus sequence is included in the HIV sequence database. In all three of these imperfect scenarios, we still used the appropriate molecular evolution model to reconstruct the phylogenetic tree. As sequence coverage decreases, the timing of internal nodes becomes a less accurate proxy for the timing of transmission events, and hence, a less reliable source for inferring time trends in HIV incidence.</p>
    </sec>
  </sec>
  <sec id="Sec11">
    <title>Future Directions</title>
    <p id="Par74">While the present version of SimpactCyan allows users to build models that vary greatly in complexity and application area, there are several ongoing developments that will enable investigations in additional domains. Epidemics of Herpes Simplex Virus 2 (HSV-2) and Hepatitis C Virus (HCV) often emerge as a result of complex interactions with the behavioural and biological factors that drive HIV epidemics. Hence, future versions of SimpactCyan should make joint modelling of these sexually transmitted infections possible. Moreover, studies of HIV transmission, treatment and prevention in injecting drug users (IDU) and children will require additional events for parenteral and mother-to-child transmission of HIV. Lastly, we are pursuing software extensions that will enable investigation of the hypothesis that there are negative correlations between sexual risk behaviours and health seeking behaviours. Indeed, Huerga and colleagues have reported a multivariable analysis in which inconsistent condom use in the preceding year was independently associated with unawareness of being HIV-positive. The same team also reported another multivariable analysis in people aware of their HIV-positive status in which, after adjusting for ARV drug presence in blood, age and sex, individuals with more than one sexual partner had a two times increased risk of being virally unsuppressed<sup><xref ref-type="bibr" rid="CR51">51</xref></sup>.</p>
    <p id="Par75">SimpactCyan was conceived in the spirit of the open science movement<sup><xref ref-type="bibr" rid="CR52">52</xref></sup> as a flexible open-source, open access tool. We therefore hope that many groups in the field of HIV epidemiology will find it a useful research instrument, and we welcome various applications by others, be it as a data-generating and/or benchmarking tool in methodological research, or for educational purposes. We also believe that the core engine behind SimpactCyan could be used as the starting point for other simulation engines with use cases outside of HIV epidemiology and even outside of epidemiology altogether.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary information</title>
    <sec id="Sec12">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="41598_2019_55689_MOESM1_ESM.pdf">
            <caption>
              <p>SimpactCyan 1.0: An Open-source Simulator for Individual-Based Models in HIV Epidemiology with R and Python Interfaces</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p><bold>Publisher’s note</bold> Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <sec>
    <title>Supplementary information</title>
    <p>is available for this paper at 10.1038/s41598-019-55689-4.</p>
  </sec>
  <ack>
    <title>Acknowledgements</title>
    <p>The authors thank Jonathan Dushoff and Roxanne Beauclair for valuable comments on earlier drafts of this manuscript. The computational resources and services used for the calibration of the EAAA model were provided by the VSC (Flemish Supercomputer Center). This work was supported by grants G091210N, G0B4314N and W002514N from the Research Foundation – Flanders (FWO), grant ZEIN2010PR375 from the Flemish Interuniversity Council (VLIR), grant 100014 from NRF-TWAS, and a grant from the Dutch Postcode Lottery.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author contributions</title>
    <p>J.L. wrote all the source code of the core engine and the R and Python interfaces presented in this paper, and wrote the first draft of the manuscript. D.M.H. drafted the introduction section and Figure 2. E.K. contributed to Figure 2 and provided editorial assistance. D.N. wrote R code for the second example application. NH contributed to the software design and provided editorial assistance. W.D. contributed to the software design, performed the runtime analysis, wrote R code for the example applications, and wrote the “Model applications” and “Future directions” sections of the manuscript. All authors reviewed the manuscript.</p>
  </notes>
  <notes notes-type="COI-statement">
    <title>Competing interests</title>
    <p id="Par76">The authors declare no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <mixed-citation publication-type="other">Railsback, S. F. &amp; Grimm, V. <italic>Agent-based and individual-based modeling: a practical introduction</italic> (Princeton university press, 2011).</mixed-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Willem</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Verelst</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Bilcke</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Hens</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Beutels</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Lessons from a decade of individual-based models for infectious disease transmission: a systematic review (2006–2015)</article-title>
        <source>BMC Infect. Dis.</source>
        <year>2017</year>
        <volume>17</volume>
        <fpage>612</fpage>
        <pub-id pub-id-type="doi">10.1186/s12879-017-2699-8</pub-id>
        <?supplied-pmid 28893198?>
        <pub-id pub-id-type="pmid">28893198</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kravari</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Bassiliades</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>A survey of agent platforms</article-title>
        <source>J. Artif. Soc. Soc. Simul.</source>
        <year>2015</year>
        <volume>18</volume>
        <fpage>11</fpage>
        <pub-id pub-id-type="doi">10.18564/jasss.2661</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <mixed-citation publication-type="other">Delva, W., Hazelbag, C. M. &amp; Dushoff, J. Simulation-based calibration of individual-based models to summarised data in hiv epidemiology: a systematic literature review and new mice-based method. In <italic>22nd</italic><italic>International</italic><italic>AIDS</italic><italic>Conference</italic> (Amsterdam, The Netherlands, 2018) (<italic>AIDS</italic> 2018).</mixed-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sahneh</surname>
            <given-names>Faryad Darabi</given-names>
          </name>
          <name>
            <surname>Vajdi</surname>
            <given-names>Aram</given-names>
          </name>
          <name>
            <surname>Shakeri</surname>
            <given-names>Heman</given-names>
          </name>
          <name>
            <surname>Fan</surname>
            <given-names>Futing</given-names>
          </name>
          <name>
            <surname>Scoglio</surname>
            <given-names>Caterina</given-names>
          </name>
        </person-group>
        <article-title>GEMFsim: A stochastic simulator for the generalized epidemic modeling framework</article-title>
        <source>Journal of Computational Science</source>
        <year>2017</year>
        <volume>22</volume>
        <fpage>36</fpage>
        <lpage>44</lpage>
        <pub-id pub-id-type="doi">10.1016/j.jocs.2017.08.014</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Moshiri</surname>
            <given-names>Niema</given-names>
          </name>
          <name>
            <surname>Ragonnet-Cronin</surname>
            <given-names>Manon</given-names>
          </name>
          <name>
            <surname>Wertheim</surname>
            <given-names>Joel O</given-names>
          </name>
          <name>
            <surname>Mirarab</surname>
            <given-names>Siavash</given-names>
          </name>
        </person-group>
        <article-title>FAVITES: simultaneous simulation of transmission networks, phylogenetic trees and sequences</article-title>
        <source>Bioinformatics</source>
        <year>2018</year>
        <volume>35</volume>
        <issue>11</issue>
        <fpage>1852</fpage>
        <lpage>1861</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bty921</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <mixed-citation publication-type="other">Bershteyn, A. <italic>et al</italic>. Implementation and applications of emod, an individual-based multi-disease modeling platform. <italic>Pathog</italic>. <italic>Dis</italic>. <bold>76</bold>, 10.1093/femspd/fty059 (2018).</mixed-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bakker</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Stdsim: A microsimulation model for decision support in the control of hiv and other stds</article-title>
        <source>Sex. Transm. Dis.</source>
        <year>2000</year>
        <volume>27</volume>
        <fpage>652</fpage>
        <pub-id pub-id-type="doi">10.1097/00007435-200011000-00029</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <mixed-citation publication-type="other">Tolentino, S. L., Meng, F. &amp; Delva, W. A simulation-based method for efficient resource allocation of combination hiv prevention. In <italic>Proceedings of the 6th International ICST Conference on Simulation Tools and Techniques</italic> (<italic>Cannes</italic>, <italic>France</italic>, <italic>5–7 March</italic> 2013), 31–40 (ICST, Brussels, Belgium, 2013).</mixed-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <mixed-citation publication-type="other">Meng, F., Hummeling, R., Tolentino, S. L., Hens, N. &amp; Delva, W. Modelling the impact of alternative treatment strategies on hiv prevalence in south africa: a simulation study. In <italic>6th South African</italic><italic>AIDS Conference</italic> (Durban, South Africa, 2013).</mixed-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <mixed-citation publication-type="other">Delva, W. <italic>et al</italic>. Age mixing and sustained hiv epidemics: not the size but the variation of age gaps counts. In <italic>Epidemics4</italic><italic>–</italic><italic>4th</italic><italic>International</italic><italic>Conference</italic><italic>on</italic><italic>Infectious</italic><italic>Disease</italic><italic>Dynamics</italic> (Amsterdam, The Netherlands, 2013).</mixed-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <mixed-citation publication-type="other">Tolentino, S. L. <italic>Effective and efficient algorithms for simulating sexually transmitted diseases</italic>. Ph.D. thesis, University of Iowa (2014).</mixed-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <mixed-citation publication-type="other">Meng, F., Liesenborgs, J., Delva, W., Van Reeth, F. &amp; Hens, N. Simpact cyan: accelerating agent-based, continuous time simulation of hiv transmission on vsc. In <italic>VSC Users Day</italic> 2014 (Brussels, Belgium, 2014).</mixed-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Anderson</surname>
            <given-names>David F.</given-names>
          </name>
        </person-group>
        <article-title>A modified next reaction method for simulating chemical systems with time dependent propensities and delays</article-title>
        <source>The Journal of Chemical Physics</source>
        <year>2007</year>
        <volume>127</volume>
        <issue>21</issue>
        <fpage>214107</fpage>
        <pub-id pub-id-type="doi">10.1063/1.2799998</pub-id>
        <pub-id pub-id-type="pmid">18067349</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gillespie</surname>
            <given-names>DT</given-names>
          </name>
        </person-group>
        <article-title>A general method for numerically simulating the stochastic time evolution of coupled chemical reactions</article-title>
        <source>J. Comput. Phys.</source>
        <year>1976</year>
        <volume>22</volume>
        <fpage>403</fpage>
        <lpage>434</lpage>
        <pub-id pub-id-type="doi">10.1016/0021-9991(76)90041-3</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bartlett</surname>
            <given-names>MS</given-names>
          </name>
        </person-group>
        <article-title>Stochastic Processes or the Statistics of Change</article-title>
        <source>J. Royal Stat. Soc. Ser. C (Applied Stat.</source>
        <year>1953</year>
        <volume>2</volume>
        <fpage>44</fpage>
        <lpage>64</lpage>
        <pub-id pub-id-type="doi">10.2307/2985327</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Doob</surname>
            <given-names>JL</given-names>
          </name>
        </person-group>
        <article-title>Topics in the theory of markoff chains</article-title>
        <source>Transactions Am. Math. Soc.</source>
        <year>1942</year>
        <volume>52</volume>
        <fpage>37</fpage>
        <lpage>64</lpage>
        <pub-id pub-id-type="doi">10.1090/S0002-9947-1942-0006633-7</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gibson</surname>
            <given-names>Michael A.</given-names>
          </name>
          <name>
            <surname>Bruck</surname>
            <given-names>Jehoshua</given-names>
          </name>
        </person-group>
        <article-title>Efficient Exact Stochastic Simulation of Chemical Systems with Many Species and Many Channels</article-title>
        <source>The Journal of Physical Chemistry A</source>
        <year>2000</year>
        <volume>104</volume>
        <issue>9</issue>
        <fpage>1876</fpage>
        <lpage>1889</lpage>
        <pub-id pub-id-type="doi">10.1021/jp993732q</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <mixed-citation publication-type="other">Liesenborgs, J. Simpact cyan, <ext-link ext-link-type="uri" xlink:href="https://simpactcyan.readthedocs.io/en/latest/simpact_introduction.html">https://simpactcyan.readthedocs.io/en/latest/simpact_introduction.html</ext-link> Accessed: 2019-11-12 (2017).</mixed-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hollingsworth</surname>
            <given-names>TD</given-names>
          </name>
          <name>
            <surname>Anderson</surname>
            <given-names>RM</given-names>
          </name>
          <name>
            <surname>Fraser</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>HIV-1 Transmission, by Stage of Infection</article-title>
        <source>The J. Infect. Dis.</source>
        <year>2008</year>
        <volume>198</volume>
        <fpage>687</fpage>
        <lpage>693</lpage>
        <pub-id pub-id-type="doi">10.1086/590501</pub-id>
        <?supplied-pmid 18662132?>
        <pub-id pub-id-type="pmid">18662132</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Grimes</surname>
            <given-names>RM</given-names>
          </name>
          <name>
            <surname>Hallmark</surname>
            <given-names>CJ</given-names>
          </name>
          <name>
            <surname>Watkins</surname>
            <given-names>KL</given-names>
          </name>
          <name>
            <surname>Agarwal</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>McNeese</surname>
            <given-names>ML</given-names>
          </name>
        </person-group>
        <article-title>Re-engagement in hiv care: A clinical and public health priority</article-title>
        <source>J AIDS Clin Res</source>
        <year>2016</year>
        <volume>7</volume>
        <fpage>1</fpage>
        <lpage>7</lpage>
        <pub-id pub-id-type="doi">10.4172/2155-6113.1000543</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Walsh</surname>
            <given-names>FJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Impact of early initiation versus national standard of care of antiretroviral therapy in Swaziland’s public sector health system: study protocol for a stepped-wedge randomized trial</article-title>
        <source>Trials</source>
        <year>2017</year>
        <volume>18</volume>
        <fpage>1</fpage>
        <lpage>10</lpage>
        <pub-id pub-id-type="doi">10.1186/s13063-017-2128-8</pub-id>
        <pub-id pub-id-type="pmid">28049491</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Delva</surname>
            <given-names>Wim</given-names>
          </name>
          <name>
            <surname>Meng</surname>
            <given-names>Fei</given-names>
          </name>
          <name>
            <surname>Beauclair</surname>
            <given-names>Roxanne</given-names>
          </name>
          <name>
            <surname>Deprez</surname>
            <given-names>Nele</given-names>
          </name>
          <name>
            <surname>Temmerman</surname>
            <given-names>Marleen</given-names>
          </name>
          <name>
            <surname>Welte</surname>
            <given-names>Alex</given-names>
          </name>
          <name>
            <surname>Hens</surname>
            <given-names>Niel</given-names>
          </name>
        </person-group>
        <article-title>Coital frequency and condom use in monogamous and concurrent sexual relationships in Cape Town, South Africa</article-title>
        <source>Journal of the International AIDS Society</source>
        <year>2013</year>
        <volume>16</volume>
        <issue>1</issue>
        <fpage>18034</fpage>
        <pub-id pub-id-type="doi">10.7448/IAS.16.1.18034</pub-id>
        <pub-id pub-id-type="pmid">23618365</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sawers</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Isaac</surname>
            <given-names>AG</given-names>
          </name>
          <name>
            <surname>Stillwaggon</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>Hiv and concurrent sexual partnerships: modelling the role of coital dilution</article-title>
        <source>J. Int. AIDS Soc.</source>
        <year>2011</year>
        <volume>14</volume>
        <fpage>44</fpage>
        <pub-id pub-id-type="doi">10.1186/1758-2652-14-44</pub-id>
        <pub-id pub-id-type="pmid">21914208</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yi</surname>
            <given-names>TJ</given-names>
          </name>
          <name>
            <surname>Shannon</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Prodger</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>McKinnon</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Kaul</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Genital immunology and HIV susceptibility in young women</article-title>
        <source>Am. J. Reproductive Immunol.</source>
        <year>2013</year>
        <volume>69</volume>
        <fpage>74</fpage>
        <lpage>79</lpage>
        <pub-id pub-id-type="doi">10.1111/aji.12035</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hargrove</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Eastwood</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Mahiane</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>van Schalkwyk</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>How should we best estimate the mean recency duration for the bed method?</article-title>
        <source>Plos One</source>
        <year>2012</year>
        <volume>7</volume>
        <fpage>1</fpage>
        <lpage>12</lpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0049661</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fraser</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Hollingsworth</surname>
            <given-names>T. D.</given-names>
          </name>
          <name>
            <surname>Chapman</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>de Wolf</surname>
            <given-names>F.</given-names>
          </name>
          <name>
            <surname>Hanage</surname>
            <given-names>W. P.</given-names>
          </name>
        </person-group>
        <article-title>Variation in HIV-1 set-point viral load: Epidemiological analysis and an evolutionary hypothesis</article-title>
        <source>Proceedings of the National Academy of Sciences</source>
        <year>2007</year>
        <volume>104</volume>
        <issue>44</issue>
        <fpage>17441</fpage>
        <lpage>17446</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.0708559104</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Arnaout</surname>
            <given-names>R. A.</given-names>
          </name>
          <name>
            <surname>Lloyd</surname>
            <given-names>A. L.</given-names>
          </name>
          <name>
            <surname>O'Brien</surname>
            <given-names>T. R.</given-names>
          </name>
          <name>
            <surname>Goedert</surname>
            <given-names>J. J.</given-names>
          </name>
          <name>
            <surname>Leonard</surname>
            <given-names>J. M.</given-names>
          </name>
          <name>
            <surname>Nowak</surname>
            <given-names>M. A.</given-names>
          </name>
        </person-group>
        <article-title>A simple relationship between viral load and survival time in HIV-1 infection</article-title>
        <source>Proceedings of the National Academy of Sciences</source>
        <year>1999</year>
        <volume>96</volume>
        <issue>20</issue>
        <fpage>11549</fpage>
        <lpage>11553</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.96.20.11549</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fraser</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Virulence and pathogenesis of hiv-1 infection: an evolutionary perspective</article-title>
        <source>Sci.</source>
        <year>2014</year>
        <volume>343</volume>
        <fpage>1243727</fpage>
        <pub-id pub-id-type="doi">10.1126/science.1243727</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <mixed-citation publication-type="other">UNAIDS. AIDSinfo, <ext-link ext-link-type="uri" xlink:href="http://aidsinfo.unaids.org/">http://aidsinfo.unaids.org/</ext-link> Accessed: 2019-04-20 (2019).</mixed-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <mixed-citation publication-type="other">World Bank, <ext-link ext-link-type="uri" xlink:href="https://data.worldbank.org/indicator/SP.POP.GROW?locations=SZ">https://data.worldbank.org/indicator/SP.POP.GROW?locations=SZ</ext-link> Accessed: 2019-04-24 (2019).</mixed-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Justman</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Swaziland hiv incidence measurement survey (shims): a prospective national cohort study</article-title>
        <source>The lancet HIV</source>
        <year>2017</year>
        <volume>4</volume>
        <fpage>e83</fpage>
        <lpage>e92</lpage>
        <pub-id pub-id-type="doi">10.1016/S2352-3018(16)30190-4</pub-id>
        <pub-id pub-id-type="pmid">27863998</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lenormand</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Jabot</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Deffuant</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Adaptive approximate Bayesian computation for complex models</article-title>
        <source>Comput. Stat.</source>
        <year>2013</year>
        <volume>28</volume>
        <fpage>2777</fpage>
        <lpage>2796</lpage>
        <pub-id pub-id-type="doi">10.1007/s00180-013-0428-3</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <mixed-citation publication-type="other">UNAIDS, <ext-link ext-link-type="uri" xlink:href="https://data.worldbank.org/indicator/SH.HIV.INCD.ZS?locations=SZ">https://data.worldbank.org/indicator/SH.HIV.INCD.ZS?locations=SZ</ext-link> Accessed: 2019-04-26 (2018).</mixed-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rasmussen</surname>
            <given-names>David A.</given-names>
          </name>
          <name>
            <surname>Volz</surname>
            <given-names>Erik M.</given-names>
          </name>
          <name>
            <surname>Koelle</surname>
            <given-names>Katia</given-names>
          </name>
        </person-group>
        <article-title>Phylodynamic Inference for Structured Epidemiological Models</article-title>
        <source>PLoS Computational Biology</source>
        <year>2014</year>
        <volume>10</volume>
        <issue>4</issue>
        <fpage>e1003570</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1003570</pub-id>
        <pub-id pub-id-type="pmid">24743590</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lewis</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Hughes</surname>
            <given-names>GJ</given-names>
          </name>
          <name>
            <surname>Rambaut</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Pozniak</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Leigh Brown</surname>
            <given-names>AJ</given-names>
          </name>
        </person-group>
        <article-title>Episodic sexual transmission of HIV revealed by molecular phylodynamics</article-title>
        <source>PLoS Medicine</source>
        <year>2008</year>
        <volume>5</volume>
        <fpage>0392</fpage>
        <lpage>0402</lpage>
        <pub-id pub-id-type="doi">10.1371/journal.pmed.0050050</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>de Oliveira</surname>
            <given-names>T</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Transmission networks and risk of HIV infection in KwaZulu-Natal, South Africa: a community-wide phylogenetic study</article-title>
        <source>The Lancet HIV</source>
        <year>2016</year>
        <volume>3018</volume>
        <fpage>1</fpage>
        <lpage>10</lpage>
        <pub-id pub-id-type="doi">10.1016/S2352-3018(16)30186-2</pub-id>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Novitsky</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Moyo</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Lei</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>DeGruttola</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Essex</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Impact of Sampling Density on the Extent of HIV Clustering</article-title>
        <source>AIDS Res. Hum. Retroviruses</source>
        <year>2014</year>
        <volume>30</volume>
        <fpage>1226</fpage>
        <lpage>1235</lpage>
        <pub-id pub-id-type="doi">10.1089/aid.2014.0173</pub-id>
        <?supplied-pmid 25275430?>
        <pub-id pub-id-type="pmid">25275430</pub-id>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Leventhal</surname>
            <given-names>Gabriel E.</given-names>
          </name>
          <name>
            <surname>Günthard</surname>
            <given-names>Huldrych F.</given-names>
          </name>
          <name>
            <surname>Bonhoeffer</surname>
            <given-names>Sebastian</given-names>
          </name>
          <name>
            <surname>Stadler</surname>
            <given-names>Tanja</given-names>
          </name>
        </person-group>
        <article-title>Using an Epidemiological Model for Phylogenetic Inference Reveals Density Dependence in HIV Transmission</article-title>
        <source>Molecular Biology and Evolution</source>
        <year>2013</year>
        <volume>31</volume>
        <issue>1</issue>
        <fpage>6</fpage>
        <lpage>17</lpage>
        <pub-id pub-id-type="doi">10.1093/molbev/mst172</pub-id>
        <pub-id pub-id-type="pmid">24085839</pub-id>
      </element-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ratmann</surname>
            <given-names>Oliver</given-names>
          </name>
          <name>
            <surname>Hodcroft</surname>
            <given-names>Emma B.</given-names>
          </name>
          <name>
            <surname>Pickles</surname>
            <given-names>Michael</given-names>
          </name>
          <name>
            <surname>Cori</surname>
            <given-names>Anne</given-names>
          </name>
          <name>
            <surname>Hall</surname>
            <given-names>Matthew</given-names>
          </name>
          <name>
            <surname>Lycett</surname>
            <given-names>Samantha</given-names>
          </name>
          <name>
            <surname>Colijn</surname>
            <given-names>Caroline</given-names>
          </name>
          <name>
            <surname>Dearlove</surname>
            <given-names>Bethany</given-names>
          </name>
          <name>
            <surname>Didelot</surname>
            <given-names>Xavier</given-names>
          </name>
          <name>
            <surname>Frost</surname>
            <given-names>Simon</given-names>
          </name>
          <name>
            <surname>Hossain</surname>
            <given-names>A.S. Md Mukarram</given-names>
          </name>
          <name>
            <surname>Joy</surname>
            <given-names>Jeffrey B.</given-names>
          </name>
          <name>
            <surname>Kendall</surname>
            <given-names>Michelle</given-names>
          </name>
          <name>
            <surname>Kühnert</surname>
            <given-names>Denise</given-names>
          </name>
          <name>
            <surname>Leventhal</surname>
            <given-names>Gabriel E.</given-names>
          </name>
          <name>
            <surname>Liang</surname>
            <given-names>Richard</given-names>
          </name>
          <name>
            <surname>Plazzotta</surname>
            <given-names>Giacomo</given-names>
          </name>
          <name>
            <surname>Poon</surname>
            <given-names>Art F.Y.</given-names>
          </name>
          <name>
            <surname>Rasmussen</surname>
            <given-names>David A.</given-names>
          </name>
          <name>
            <surname>Stadler</surname>
            <given-names>Tanja</given-names>
          </name>
          <name>
            <surname>Volz</surname>
            <given-names>Erik</given-names>
          </name>
          <name>
            <surname>Weis</surname>
            <given-names>Caroline</given-names>
          </name>
          <name>
            <surname>Leigh Brown</surname>
            <given-names>Andrew J.</given-names>
          </name>
          <name>
            <surname>Fraser</surname>
            <given-names>Christophe</given-names>
          </name>
        </person-group>
        <article-title>Phylogenetic Tools for Generalized HIV-1 Epidemics: Findings from the PANGEA-HIV Methods Comparison</article-title>
        <source>Molecular Biology and Evolution</source>
        <year>2016</year>
        <volume>34</volume>
        <issue>1</issue>
        <fpage>185</fpage>
        <lpage>203</lpage>
        <pub-id pub-id-type="doi">10.1093/molbev/msw217</pub-id>
        <pub-id pub-id-type="pmid">28053012</pub-id>
      </element-citation>
    </ref>
    <ref id="CR41">
      <label>41.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Delva</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Leventhal</surname>
            <given-names>GE</given-names>
          </name>
          <name>
            <surname>Helleringer</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Connecting the dots: network data and models in hiv epidemiology</article-title>
        <source>AIDS</source>
        <year>2016</year>
        <volume>30</volume>
        <fpage>2009</fpage>
        <lpage>2020</lpage>
        <pub-id pub-id-type="doi">10.1097/QAD.0000000000001184</pub-id>
        <pub-id pub-id-type="pmid">27314176</pub-id>
      </element-citation>
    </ref>
    <ref id="CR42">
      <label>42.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Villandre</surname>
            <given-names>Luc</given-names>
          </name>
          <name>
            <surname>Stephens</surname>
            <given-names>David A.</given-names>
          </name>
          <name>
            <surname>Labbe</surname>
            <given-names>Aurelie</given-names>
          </name>
          <name>
            <surname>Günthard</surname>
            <given-names>Huldrych F.</given-names>
          </name>
          <name>
            <surname>Kouyos</surname>
            <given-names>Roger</given-names>
          </name>
          <name>
            <surname>Stadler</surname>
            <given-names>Tanja</given-names>
          </name>
        </person-group>
        <article-title>Assessment of Overlap of Phylogenetic Transmission Clusters and Communities in Simple Sexual Contact Networks: Applications to HIV-1</article-title>
        <source>PLOS ONE</source>
        <year>2016</year>
        <volume>11</volume>
        <issue>2</issue>
        <fpage>e0148459</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0148459</pub-id>
        <pub-id pub-id-type="pmid">26863322</pub-id>
      </element-citation>
    </ref>
    <ref id="CR43">
      <label>43.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rambaut</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Grassly</surname>
            <given-names>NC</given-names>
          </name>
        </person-group>
        <article-title>Seq-Gen: an application for the Monte Carlo simulation of DNA sequence evolution along phylogenetic trees</article-title>
        <source>Comput. applications biosciences: CABIOS</source>
        <year>1997</year>
        <volume>13</volume>
        <fpage>235</fpage>
        <lpage>8</lpage>
        <pub-id pub-id-type="doi">10.1093/BIOINFORMATICS/13.3.235</pub-id>
      </element-citation>
    </ref>
    <ref id="CR44">
      <label>44.</label>
      <mixed-citation publication-type="other">Tavaré, S. Some probabilistic and statistical problems in the analysis of DNA sequences. <italic>Lect</italic>. <italic>on mathematics life sciences</italic>. <italic>Vol</italic>. 17 57–86 citeulike-article-id:4801403 (1986).</mixed-citation>
    </ref>
    <ref id="CR45">
      <label>45.</label>
      <mixed-citation publication-type="other">Los Alamos National Library. HIV Sequence database, <ext-link ext-link-type="uri" xlink:href="https://www.hiv.lanl.gov/components/sequence/HIV/search/search.html">https://www.hiv.lanl.gov/components/sequence/HIV/search/search.html</ext-link> Accessed: 2018-07-12 (2018).</mixed-citation>
    </ref>
    <ref id="CR46">
      <label>46.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Darriba</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Taboada</surname>
            <given-names>GL</given-names>
          </name>
          <name>
            <surname>Doallo</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Posada</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>jmodeltest 2: more models, new heuristics and parallel computing</article-title>
        <source>Nat. Methods</source>
        <year>2012</year>
        <volume>9</volume>
        <fpage>772 EP –</fpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.2109</pub-id>
      </element-citation>
    </ref>
    <ref id="CR47">
      <label>47.</label>
      <mixed-citation publication-type="other">Patiño-Galindo, J. Á. &amp; González-Candelas, F. The substitution rate of HIV-1 subtypes: a genomic approach. <italic>Virus Evol</italic>., 10.1093/ve/vex029 (2017).</mixed-citation>
    </ref>
    <ref id="CR48">
      <label>48.</label>
      <mixed-citation publication-type="other">Alizon, S. &amp; Fraser, C. Within-host and between-host evolutionary rates across the HIV-1 genome. <italic>Retrovirology</italic>, 10.1186/1742-4690-10-49 (2013).</mixed-citation>
    </ref>
    <ref id="CR49">
      <label>49.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schliep</surname>
            <given-names>KP</given-names>
          </name>
        </person-group>
        <article-title>phangorn: Phylogenetic analysis in R</article-title>
        <source>Bioinforma.</source>
        <year>2011</year>
        <volume>27</volume>
        <fpage>592</fpage>
        <lpage>593</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btq706</pub-id>
      </element-citation>
    </ref>
    <ref id="CR50">
      <label>50.</label>
      <mixed-citation publication-type="other">Volz, E. M. &amp; Frost, S. D. W. Scalable relaxed clock phylogenetic dating. <italic>Virus Evol</italic>. <bold>3</bold>, 10.1093/ve/vex025 (2017).</mixed-citation>
    </ref>
    <ref id="CR51">
      <label>51.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huerga</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Higher risk sexual behaviour is associated with unawareness of hiv-positivity and lack of viral suppression – implications for treatment as prevention</article-title>
        <source>Sci. Reports</source>
        <year>2017</year>
        <volume>7</volume>
        <fpage>16117</fpage>
        <pub-id pub-id-type="doi">10.1038/s41598-017-16382-6</pub-id>
      </element-citation>
    </ref>
    <ref id="CR52">
      <label>52.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Woelfle</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Olliaro</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Todd</surname>
            <given-names>MH</given-names>
          </name>
        </person-group>
        <article-title>Open science is a research accelerator</article-title>
        <source>Nat. Chem.</source>
        <year>2011</year>
        <volume>3</volume>
        <fpage>745</fpage>
        <lpage>748</lpage>
        <pub-id pub-id-type="doi">10.1038/nchem.1149</pub-id>
        <?supplied-pmid 21941234?>
        <pub-id pub-id-type="pmid">21941234</pub-id>
      </element-citation>
    </ref>
    <ref id="CR53">
      <label>53.</label>
      <mixed-citation publication-type="other">Liesenborgs, J. Simpact cyan, <ext-link ext-link-type="uri" xlink:href="https://simpactcyan.readthedocs.io/en/latest/index.html">https://simpactcyan.readthedocs.io/en/latest/index.html</ext-link> Accessed: 2019-04-10 (2017).</mixed-citation>
    </ref>
    <ref id="CR54">
      <label>54.</label>
      <mixed-citation publication-type="other">Liesenborgs, J., Hendrickx, D. M., Van Reeth, F., Hens, N. &amp; Delva, W. Simpactcyan: a simulation engine for individualbased models in hiv epidemiology. In <italic>Epidemics6</italic><italic>–</italic><italic>6th</italic><italic>International</italic><italic>Conference</italic><italic>on</italic><italic>Infectious</italic><italic>Disease</italic><italic>Dynamics</italic> (Sitges, Spain, 2017).</mixed-citation>
    </ref>
    <ref id="CR55">
      <label>55.</label>
      <mixed-citation publication-type="other">Hendrickx, D. M. <italic>et al</italic>. Comparison of two individual-based models for simulating hiv epidemics in a population with hsv-2 using as case study yaound´e-cameroon, 1989–1998. <italic>bioRxiv</italic>, 10.1101/637389, <ext-link ext-link-type="uri" xlink:href="https://www.biorxiv.org/content/early/2019/05/17/637389.full.pdf">https://www.biorxiv.org/content/early/2019/05/17/637389.full.pdf</ext-link> (2019).</mixed-citation>
    </ref>
    <ref id="CR56">
      <label>56.</label>
      <mixed-citation publication-type="other">Jenness, S. M., Goodreau, S. M. &amp; Morris, M. EpiModel: An R Package for Mathematical Modeling of Infectious Disease over Networks. <italic>J</italic>. <italic>Stat</italic>. <italic>Softw</italic>., 10.18637/jss.v084.i08 (2018).</mixed-citation>
    </ref>
    <ref id="CR57">
      <label>57.</label>
      <mixed-citation publication-type="other">Thiele, J. C. R marries netlogo: Introduction to the rnetlogo package. <italic>J</italic>. <italic>Stat</italic>. <italic>Softw</italic>. <bold>58</bold>, 10.18637/jss.v058.i02 (2014).</mixed-citation>
    </ref>
    <ref id="CR58">
      <label>58.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Reniers</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Armbruster</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Lucas</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Sexual networks, partnership mixing, and the female-to-male ratio of HIV infections in generalized epidemics: An agent-based simulation study</article-title>
        <source>Demogr. Res.</source>
        <year>2015</year>
        <volume>33</volume>
        <fpage>425</fpage>
        <lpage>450</lpage>
        <pub-id pub-id-type="doi">10.4054/Dem-Res.2015.33.15</pub-id>
      </element-citation>
    </ref>
    <ref id="CR59">
      <label>59.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>McCormick</surname>
            <given-names>Alethea W.</given-names>
          </name>
          <name>
            <surname>Abuelezam</surname>
            <given-names>Nadia N.</given-names>
          </name>
          <name>
            <surname>Rhode</surname>
            <given-names>Erin R.</given-names>
          </name>
          <name>
            <surname>Hou</surname>
            <given-names>Taige</given-names>
          </name>
          <name>
            <surname>Walensky</surname>
            <given-names>Rochelle P.</given-names>
          </name>
          <name>
            <surname>Pei</surname>
            <given-names>Pamela P.</given-names>
          </name>
          <name>
            <surname>Becker</surname>
            <given-names>Jessica E.</given-names>
          </name>
          <name>
            <surname>DiLorenzo</surname>
            <given-names>Madeline A.</given-names>
          </name>
          <name>
            <surname>Losina</surname>
            <given-names>Elena</given-names>
          </name>
          <name>
            <surname>Freedberg</surname>
            <given-names>Kenneth A.</given-names>
          </name>
          <name>
            <surname>Lipsitch</surname>
            <given-names>Marc</given-names>
          </name>
          <name>
            <surname>Seage</surname>
            <given-names>George R.</given-names>
          </name>
        </person-group>
        <article-title>Development, Calibration and Performance of an HIV Transmission Model Incorporating Natural History and Behavioral Patterns: Application in South Africa</article-title>
        <source>PLoS ONE</source>
        <year>2014</year>
        <volume>9</volume>
        <issue>5</issue>
        <fpage>e98272</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0098272</pub-id>
        <pub-id pub-id-type="pmid">24867402</pub-id>
      </element-citation>
    </ref>
    <ref id="CR60">
      <label>60.</label>
      <mixed-citation publication-type="other">Johnson, L. F., Kubjane, M. &amp; Moolla, H. Microcosm: a model of social and structural drivers of hiv and interventions to reduce hiv incidence in high-risk populations in south africa, <ext-link ext-link-type="uri" xlink:href="https://www.biorxiv.org/content/10.1101/310763v1">https://www.biorxiv.org/content/10.1101/310763v1</ext-link> Accessed: 2019-04-10 (2018).</mixed-citation>
    </ref>
    <ref id="CR61">
      <label>61.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gopalappa</surname>
            <given-names>Chaitra</given-names>
          </name>
          <name>
            <surname>Farnham</surname>
            <given-names>Paul G.</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>Yao-Hsuan</given-names>
          </name>
          <name>
            <surname>Sansom</surname>
            <given-names>Stephanie L.</given-names>
          </name>
        </person-group>
        <article-title>Progression and Transmission of HIV/AIDS (PATH 2.0)</article-title>
        <source>Medical Decision Making</source>
        <year>2016</year>
        <volume>37</volume>
        <issue>2</issue>
        <fpage>224</fpage>
        <lpage>233</lpage>
        <pub-id pub-id-type="doi">10.1177/0272989X16668509</pub-id>
        <pub-id pub-id-type="pmid">27646567</pub-id>
      </element-citation>
    </ref>
    <ref id="CR62">
      <label>62.</label>
      <mixed-citation publication-type="other">Marshall Labs. Treatment of infectious transmissions through agent-based network, <ext-link ext-link-type="uri" xlink:href="https://titan-documentation.readthedocs.io/en/latest/index.html">https://titan-documentation.readthedocs.io/en/latest/index.html</ext-link> Accessed: 2019-04-10 (2017).</mixed-citation>
    </ref>
  </ref-list>
</back>
