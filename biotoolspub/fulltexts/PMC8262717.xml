<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Nucleic Acids Res</journal-id>
    <journal-id journal-id-type="iso-abbrev">Nucleic Acids Res</journal-id>
    <journal-id journal-id-type="publisher-id">nar</journal-id>
    <journal-title-group>
      <journal-title>Nucleic Acids Research</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">0305-1048</issn>
    <issn pub-type="epub">1362-4962</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8262717</article-id>
    <article-id pub-id-type="pmid">34023887</article-id>
    <article-id pub-id-type="doi">10.1093/nar/gkab391</article-id>
    <article-id pub-id-type="publisher-id">gkab391</article-id>
    <article-categories>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI00010</subject>
      </subj-group>
      <subj-group subj-group-type="heading">
        <subject>Web Server Issue</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>DomainViz: intuitive visualization of consensus domain distributions across groups of proteins</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-0828-8681</contrib-id>
        <name>
          <surname>Schläpfer</surname>
          <given-names>Pascal</given-names>
        </name>
        <aff><institution>Institute for Molecular Plant Biology</institution>, D-BIOL, ETH Zurich, Zürich 8092, <country country="CH">Switzerland</country></aff>
        <xref rid="FN1" ref-type="author-notes"/>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-8911-1174</contrib-id>
        <name>
          <surname>Mehta</surname>
          <given-names>Devang</given-names>
        </name>
        <aff><institution>Department of Biological Sciences, University of Alberta</institution>, Edmonton, Alberta T6G 2E9, <country country="CA">Canada</country></aff>
        <xref rid="FN1" ref-type="author-notes"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ridderikhoff</surname>
          <given-names>Cameron</given-names>
        </name>
        <aff><institution>Department of Biological Sciences, University of Alberta</institution>, Edmonton, Alberta T6G 2E9, <country country="CA">Canada</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-2773-4381</contrib-id>
        <name>
          <surname>Uhrig</surname>
          <given-names>R Glen</given-names>
        </name>
        <!--ruhrig@ualberta.ca-->
        <aff><institution>Department of Biological Sciences, University of Alberta</institution>, Edmonton, Alberta T6G 2E9, <country country="CA">Canada</country></aff>
        <xref rid="COR1" ref-type="corresp"/>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="COR1">To whom correspondence should be addressed. Tel: +1 780 492 3088; Email: <email>ruhrig@ualberta.ca</email></corresp>
      <fn id="FN1">
        <p>The authors wish it to be known that, in their opinion, the first two authors should be regarded as Joint First Authors.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="collection">
      <day>02</day>
      <month>7</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2021-05-22">
      <day>22</day>
      <month>5</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>22</day>
      <month>5</month>
      <year>2021</year>
    </pub-date>
    <volume>49</volume>
    <issue>W1</issue>
    <fpage>W169</fpage>
    <lpage>W173</lpage>
    <history>
      <date date-type="accepted">
        <day>28</day>
        <month>4</month>
        <year>2021</year>
      </date>
      <date date-type="rev-recd">
        <day>14</day>
        <month>4</month>
        <year>2021</year>
      </date>
      <date date-type="received">
        <day>08</day>
        <month>3</month>
        <year>2021</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2021. Published by Oxford University Press on behalf of Nucleic Acids Research.</copyright-statement>
      <copyright-year>2021</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbynclicense">https://creativecommons.org/licenses/by-nc/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution-NonCommercial License (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by-nc/4.0/">http://creativecommons.org/licenses/by-nc/4.0/</ext-link>), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact <email>journals.permissions@oup.com</email></license-p>
      </license>
    </permissions>
    <self-uri xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="gkab391.pdf"/>
    <abstract>
      <title>Abstract</title>
      <p>The prediction of functional domains is typically among the first steps towards understanding the function of new proteins and protein families. There are numerous databases of annotated protein domains that permit researchers to identify domains on individual proteins of interest. However, it is necessary to perform high-throughput domain searches to gain evolutionary insight into the functions of proteins and protein families. Unfortunately, at present, it is difficult to search for, and visualize domain conservation across multiple proteins and/or multiple groups of proteins in an intuitive manner. Here we present DomainViz, a new web-server that streamlines the identification and visualization of domains across multiple protein sequences. Currently, DomainViz uses the well-established PFAM and Prosite databases for domain searching and assembles intuitive, publication-ready ‘monument valley’ plots (mv-plots) that display the extent of domain conservation along two dimensions: positionality and frequency of occurrence in the input protein sequences. In addition, DomainViz produces a conventional domain-ordering figure. DomainViz can be used to explore the conservation of domains within a single protein family, across multiple families, and across families from different species to support studies into protein function and evolution. The web-server is publicly available at: <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://uhrigprotools.biology.ualberta.ca/domainviz" ext-link-type="uri">https://uhrigprotools.biology.ualberta.ca/domainviz</ext-link>.</p>
    </abstract>
    <abstract abstract-type="graphical">
      <title>Graphical Abstract</title>
      <p>
        <fig position="float" id="ga1">
          <label>Graphical Abstract</label>
          <caption>
            <p>DomainViz generates intuitive domain conservation plots for multiple proteins and protein families.</p>
          </caption>
          <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="gkab391gra1" position="float"/>
        </fig>
      </p>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Natural Sciences and Engineering Research Council of Canada</institution>
            <institution-id institution-id-type="DOI">10.13039/501100000038</institution-id>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="5"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec sec-type="intro" id="SEC1">
    <title>INTRODUCTION</title>
    <p>Predicting the presence of domains is a fundamental step in assigning function to new proteins and protein families. The identification of conserved protein sequences and domains has been a long-standing endeavour in bioinformatics and has resulted in the creation of databases like PFAM, Prosite and InterPro that provide critical information for genomics projects (<xref rid="B1" ref-type="bibr">1–3</xref>). The classification of protein domains is typically based on the identification of sequence patterns based on evolutionary conservation, the presence of structural features, and / or their functional associations. As a result, comparing the presence and architecture of protein domains across entire protein families, or across evolutionary lineages, can provide valuable insights into the evolution of protein function by elucidating domain gain, loss or re-arrangement.</p>
    <p>Indeed, comparative domain structure analysis has become commonplace in protein evolution studies (<xref rid="B4" ref-type="bibr">4–7</xref>). However, such an analysis invariably involves reducing the complexity of domain presence and ordering within protein sequences to binary representations of domain presence or absence (Figure <xref rid="F1" ref-type="fig">1A</xref>). Such representations elide important details such as the relative distribution of protein domains within evolutionary clades and the degree to which domain sizes are conserved within protein groups and families. In 2017, we pioneered a new format for displaying protein domain structure in an evolutionary analysis of regulatory protein acetylation enzymes (Figure <xref rid="F1" ref-type="fig">1B</xref>) (<xref rid="B8" ref-type="bibr">8</xref>). This new quantitative representation depicted domain architecture in two dimensions, with the position and size of protein domains on the horizontal axis, and conservation frequency on the vertical axis. This representation that we dub ‘mv-plots’ (due to their visual similarity to the sandstone buttes in Arizona's Monument Valley) is information rich and provides viewers with an intuitive grasp of domain presence, position and conservation.</p>
    <fig position="float" id="F1">
      <label>Figure 1.</label>
      <caption>
        <p>Protein domain representation of the Class 1 GCN5/PCAF-related N-acetyltransferases (GNATs). (<bold>A</bold>) Conventional representation of PFAM domain order within a group of 21 GNAT proteins. (<bold>B</bold>) mv-plot representation of PFAM domain conservation within the same group of proteins. Both images have been generated using DomainViz.</p>
      </caption>
      <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="gkab391fig1" position="float"/>
    </fig>
    <p>Constructing mv-plots manually is however, a long and laborious process involving several steps. It involves multiple queries of domain databases (PFAM, Prosite, etc.), calculating domain conservation and position, and then plotting these data points, and then repeating this process for each domain found in the initial query set. Here, we present DomainViz, a web-server based tool that can generate mv-plots of domain conservation for multiple protein sequences, and multiple groups of protein sequences in a single step. DomainViz offers distinct functionality compared to other domain visualization tools such as SMART (<xref rid="B9" ref-type="bibr">9</xref>) and POLYVIEW (<xref rid="B10" ref-type="bibr">10</xref>). Most notably, DomainViz creates two-dimensional outputs that summarize domain conservation across multiple proteins whereas SMART and POLYVIEW output domain position information on single proteins only. However, DomainViz does not predict structural features, and POLYVIEW is more appropriate for such investigation. SMART is also more appropriate for domain specific investigations such as studies that wish to search for all proteins that share a specific user-defined domain. Thus, DomainViz adds to this core set of protein domain analysis tools and fills an important niche in conducting domain analysis across multiple proteins, which is particularly relevant for evolutionary and meta-analysis studies.</p>
    <p>DomainViz uses both PFAM and Prosite databases and simply requires a multi-sequence FASTA file of protein sequences as input to generate publication quality mv-plots. In addition, DomainViz also provides a more conventional domain-ordered protein representation that precisely maps each domain's location based on mv-plot data. The outputs, (including intermediate PFAM and Prosite outputs) are downloadable, and editable with any vector image processing software.</p>
  </sec>
  <sec sec-type="methods" id="SEC2">
    <title>METHODS AND RESULTS</title>
    <sec id="SEC2-1">
      <title>Implementation</title>
      <p>The webserver was created using nginx (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://www.nginx.com/" ext-link-type="uri">https://www.nginx.com/</ext-link>) to serve the frontend, with a reverse proxy to the backend, which is served using gunicorn (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://gunicorn.org/" ext-link-type="uri">https://gunicorn.org/</ext-link>) by following the guide created by Miguel Grinberg (<xref rid="B11" ref-type="bibr">11</xref>). This was then updated to serve onto <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://HTTPS" ext-link-type="uri">HTTPS</ext-link> via a second Grinberg’ guide (<xref rid="B12" ref-type="bibr">12</xref>). The outward facing website was designed using MaterialUI and the server is set up on a remote virtual Linux machine (Ubuntu 20.04.1 LTS) hosted on the University of Alberta Cirrus Compute and Storage Cloud (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://spaces.facsci.ualberta.ca/cirrus/" ext-link-type="uri">https://spaces.facsci.ualberta.ca/cirrus/</ext-link>). The backend consists of a single script, domainviz.py, containing all functions and modules to process input sequences. The script was developed with Python 3.8.2 and has been tested on Linux and macOS. The program uses python modules <italic toggle="yes">sys</italic>, <italic toggle="yes">os</italic>, <italic toggle="yes">pathlib</italic>, <italic toggle="yes">shutil</italic>, <italic toggle="yes">distutils</italic> to handle files, folders, paths and job abortion. We use <italic toggle="yes">re</italic> to perform string manipulations, and numpy and pandas to read, store, and manipulate arrays of data. <italic toggle="yes">math</italic>, <italic toggle="yes">numpy</italic>, and <italic toggle="yes">statistics</italic> are employed for statistical calculations. We use <italic toggle="yes">matplotlib</italic>, <italic toggle="yes">mpl_toolkits</italic> and <italic toggle="yes">plotly</italic> to plot and save images. <italic toggle="yes">Bio</italic> was used to handle Prosite records and <italic toggle="yes">urllib</italic> to retrieve PFAM records. We use <italic toggle="yes">time</italic> and <italic toggle="yes">datetime</italic> to measure time.</p>
    </sec>
    <sec id="SEC2-2">
      <title>Usage</title>
      <p>The DomainViz home-page features a central input panel where users can upload one or more protein FASTA files. Once the file(s) is uploaded, users have the option to rename files with the display name to be used in the final results page. Multiple files can either be uploaded at once, or sequentially. Users can then proceed to click the ‘Submit’ button to launch the job with default parameters, or choose to modify the default parameters. These parameters are:</p>
      <list list-type="order">
        <list-item>
          <p>Minimum domain prevalence: Only domains that appear more frequently in each input file than the defined value (default 0.05, or 5%), are displayed.</p>
        </list-item>
        <list-item>
          <p>Minimum domain position conservation: Only domains that are present more frequently than the defined value (default 0.05, or 5%) at a single position on the consensus protein are displayed.</p>
        </list-item>
        <list-item>
          <p>Figure scaling: This optional parameter scales the size of the image output to the median length of the input protein sequences. (We recommend first-time users operate DomainViz with this option deactivated.)</p>
        </list-item>
        <list-item>
          <p>Absolute y-axis: If selected, the output image will display the conservation frequency in absolute numbers of proteins, rather than percentage of input proteins.</p>
        </list-item>
      </list>
      <p>Upon job submission, a new processing page is loaded where the unique result id is displayed. This result id can be saved to retrieve results at a later time using the ‘Result Id’ text field on the home-page. The processing page will reload showing the progress of the task until completion.</p>
    </sec>
    <sec id="SEC2-3">
      <title>Input processing</title>
      <p>The DomainViz computation pipeline is summarized in Figure <xref rid="F2" ref-type="fig">2</xref>, beginning with users uploading multi-sequence FASTA files. In the event that a user uploads more than one FASTA input, all files are compiled into a single FASTA file with sequence headers amended to include the user defined protein group name, or if absent the source file name. Subsequently, all proteins are queried against an internal database of PFAM and Prosite results to find pre-processed data. Proteins that do not have existing results in our internal database are then queried against PFAM and Prosite. Prosite is queried via biopython (Bio.ExPASy.ScanProsite) accessing <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://prosite.expasy.org" ext-link-type="uri">https://prosite.expasy.org</ext-link>. PFAM domains are queried via a custom script that accesses the hmmer website (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://www.ebi.ac.uk/Tools/hmmer/search/hmmscan" ext-link-type="uri">https://www.ebi.ac.uk/Tools/hmmer/search/hmmscan</ext-link>) and searches for PFAM domains.</p>
      <fig position="float" id="F2">
        <label>Figure 2.</label>
        <caption>
          <p>Schematic representation of the DomainViz computational pipeline.</p>
        </caption>
        <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="gkab391fig2" position="float"/>
      </fig>
      <p>New results are then added to the internal database to accelerate future queries. The internal database only stores domain prediction results, the amino acid sequence of the query protein, and the date of result retrieval. No other information such as the primary job id, IP address, or even the FASTA header of the query sequence is stored. The internal database is structured as a set of files named by the first five amino acids of the constituent protein sequences. Results of proteins with the same five first amino acids are hence grouped, speeding up data retrieval.</p>
      <p>Once the protein domain prediction results are retrieved, a consensus visualization of the results for all proteins in each input file needs to be generated. Since proteins in a single input group are typically not of identical length, each group of proteins has its own distribution of lengths that must be accounted for. After testing various measures (maximal size, median, mean, minimal size, most prevalent size), we decided that results are most easily understandable when the median protein length of the group is used on one axis. Hence, the median length of the protein group is computed. Next, the prevalence of each domain across the median length is calculated to produce a histogram. The prevalence of each domain per amino acid of the median length protein is computed by:<disp-formula><tex-math id="M1">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$\begin{eqnarray*}&amp;&amp; {\rho _{a,D,P}} = \frac{{\mathop \sum \nolimits_{i = 1}^{{n_P}} {1_{{F_i}}}}}{{{n_P}}} \nonumber \\ &amp;&amp; where\;F = \left( {\frac{{{S_{i,D}} \cdot {m_P}}}{{{l_i}}} \le \;a \le \frac{{{E_{i,D}} \cdot {m_P}}}{{{l_i}}}} \right) \end{eqnarray*}$$\end{document}</tex-math></disp-formula><inline-formula><tex-math id="M2">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${\rho _{a,D,P}}$\end{document}</tex-math></inline-formula> is the prevalence <inline-formula><tex-math id="M3">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\rho$\end{document}</tex-math></inline-formula> of domain <inline-formula><tex-math id="M4">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$D$\end{document}</tex-math></inline-formula> at position <inline-formula><tex-math id="M5">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$a$\end{document}</tex-math></inline-formula> of the hypothetical median length of protein group <inline-formula><tex-math id="M6">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$P$\end{document}</tex-math></inline-formula>, <inline-formula><tex-math id="M7">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${n_P}$\end{document}</tex-math></inline-formula> is the number of proteins in the protein group, <inline-formula><tex-math id="M8">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${S_{i,D}}$\end{document}</tex-math></inline-formula> is the start of the domain <italic toggle="yes">D</italic> in the ith protein, <inline-formula><tex-math id="M9">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${m_P}$\end{document}</tex-math></inline-formula> is the median amino acid length of the protein group, <inline-formula><tex-math id="M10">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${l_i}$\end{document}</tex-math></inline-formula> is the length of the ith protein, and <inline-formula><tex-math id="M11">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${E_{i,D}}$\end{document}</tex-math></inline-formula> is the end of the domain <inline-formula><tex-math id="M12">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$D$\end{document}</tex-math></inline-formula> in the <italic toggle="yes">i</italic>th protein. Histograms are then produced for each domain and plotted together to make a single mv-plot (Figure <xref rid="F2" ref-type="fig">2</xref>).</p>
    </sec>
  </sec>
  <sec sec-type="results" id="SEC3">
    <title>RESULTS</title>
    <p>Upon job completion, the progress page redirects to a Results page where three mv-plots for each protein group (one for PFAM, Prosite, and combined results, each) are displayed. Conventional domain representations are also presented adjacent to the respective mv-plot. These web-based results are interactive plots, where users can choose to view or hide selected domains using the interactive legend alongside the mv-plot. This is particularly useful when multiple overlapping domains are present. These interactive plots also possess a snapshot function, whereby users can quickly download their outputs. However, a downloadable compressed output file is also made available to users. The downloadable results include vector editable PDF files for each mv-plot, as well as tab separated text files for the PFAM and Prosite outputs, and for the calculated domain prevalence per amino acid. The Results page can be accessed after job submission by entering the unique job id in the relevant field on the home page.</p>
    <sec id="SEC3-1">
      <title>Processing times</title>
      <p>The processing time of a DomainViz query can vary considerably depending on the type and number of protein sequences entered. Results are displayed almost instantaneously (within 30 s) for queries exclusively containing proteins that have previously been queried using DomainViz. As a result, over time, processing times for most common sequences can be expected to be relatively short. The median processing time per sequence for completely new queries is 21 s and so very large queries consisting of thousands of sequences can even take hours to process. Hence, we recommend users save the unique result id generated per query in order to check for results at later times. Additionally, the processing page for each query automatically updates with the status of the job allowing users to estimate the total time for completion.</p>
    </sec>
    <sec id="SEC3-2">
      <title>Application scenario(s)</title>
      <p>DomainViz has built in example files that users can load to test the program and parameters. These examples are derived from our 2017 genome-scale analysis of enzymes involved in regulatory lysine acetylation (<xref rid="B8" ref-type="bibr">8</xref>). This analysis is an example of a typical application scenario involving the domain conservation analysis of a large family of proteins across a wide range of species.</p>
      <p><italic toggle="yes">N</italic><sup>ϵ</sup>-Lysine acetylation has recently emerged as a wide-ranging regulatory post-translational modification in eukaryotes (<xref rid="B8" ref-type="bibr">8</xref>,<xref rid="B13" ref-type="bibr">13</xref>,<xref rid="B14" ref-type="bibr">14</xref>). As a result, characterization of <italic toggle="yes">N</italic><sup>ϵ</sup>-lysine acetylation catalyzing enzymes (<italic toggle="yes">N</italic><sup>ϵ</sup>-lysine acetyltransferases and deacetylases) from across photosynthetic eukaryotes was essential. First, consensus phylogenetic trees were derived for each <italic toggle="yes">N</italic><sup>ϵ</sup>-lysine acetyltransferase and deacetylase family using both maximum likelihood and bayesian analyses (<xref rid="B8" ref-type="bibr">8</xref>). For the GCN5/PCAF-related N-acetyltransferases (GNATs) this uncovered three phylogenetically distinct subclasses of GNAT proteins. Upon subjecting a selection of sequences from these three subclasses to DomainViz analysis, we found that each GNAT class had distinct domain composition, positionality and abundance, providing functional context to the initial phylogenetic analysis. In particular, sub-class I GNATs maintained a highly conserved acetyltransferase domain and c-terminal bromodomain structure, while sub-class II possessed a conserved HAT1-N acetyltransferase domain. In addition, 60% of sub-class II GNAT sequences uniquely possessed a second acetyltransferase. GNAT sub-class III proteins, on the other hand, possessed a C-terminal acetyltransferase domain with an N-terminal radical-SAM domain, which are implicated in catalyzing an array of unique reactions ranging from post-transcriptional and post-translational modifications to aspects of lipid metabolism and co-factor biosynthesis (<xref rid="B15" ref-type="bibr">15</xref>). Thus, in this use case a DomainViz-style analysis provided significant added value by elucidating the distribution, positionality and conservation of each domain across the three subclasses of the photosynthetic eukaryote GNAT acetyltransferase family, which can now be used to guide future experimentation.</p>
      <p>DomainViz now makes such analyses available to all researchers interested in protein evolution by offering an easy-to-use web service that produces intuitive, easy to understand, high resolution visualizations to drive discovery.</p>
    </sec>
    <sec id="SEC3-3">
      <title>Planned features</title>
      <p>We plan to continually improve the performance and feature set offered by DomainViz. One of our planned features in the short term is background querying of random protein sequences from GenBank against PFAM and Prosite in order to regularly populate and re-populate our internal database in order to speed up job processing. This will also allow us to more accurately predict estimated times for job completion in order to improve the user experience. Further, we will allow users to select their desired colors to be used in constructing mv-plots in order to eliminate any need for additional image editing. A major planned update will also enable users to automatically delineate groups of proteins by clustering input sequences based on the calculated domain prevalences, thus directly supporting the generation of new evolutionary hypotheses.</p>
    </sec>
  </sec>
  <sec sec-type="discussion" id="SEC4">
    <title>DISCUSSION</title>
    <p>Existing protein domain databases like PFAM and Prosite possess information for tens of thousands of protein features, with the on-going revolution in genome sequencing continuing to add to this accumulated knowledge. However, currently, this data can only be accessed through extensive, time-consuming manual searching, and while frequently used in studies of protein family evolution, is rarely represented quantitatively. DomainViz offers scientists a single easy to use tool to query hundreds of protein sequences to retrieve domain data and generate a single quantitatively accurate representation of domain conservation for various domains across multiple proteins. We believe that DomainViz will become an essential tool in the analysis of new protein families and classes and will empower biological researchers of all stripes to gain an intuitive understanding of protein domain conservation.</p>
  </sec>
  <sec sec-type="data-availability" id="SEC5">
    <title>DATA AVAILABILITY</title>
    <p>DomainViz is available at <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://uhrigprotools.biology.ualberta.ca/domainviz" ext-link-type="uri">https://uhrigprotools.biology.ualberta.ca/domainviz</ext-link>. Source code and data is available under a GNU Affero General Public License 3.0 at <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://github.com/UhrigLab/DomainViz" ext-link-type="uri">https://github.com/UhrigLab/DomainViz</ext-link>.</p>
  </sec>
</body>
<back>
  <ack id="ACK1">
    <title>ACKNOWLEDGEMENTS</title>
    <p>The authors thank John Bartoszewski and Broderick Wood of the Faculty of Science Research IT team (University of Alberta) for their assistance in setting up the web server, Mohamad Jamaleddine (University of Alberta) for troubleshooting, and Sukalp Muzumdar (Cold Spring Harbor Laboratory) for assistance with mathematical formulation.</p>
  </ack>
  <sec id="SEC6">
    <title>FUNDING</title>
    <p>Natural Sciences and Engineering Research Council (NSERC) of Canada. Fundig for open access charge: Natural Sciences and Engineering Research Council of Canada</p>
    <p><italic toggle="yes">Conflict of interest statement</italic>. None declared.</p>
  </sec>
  <ref-list id="REF1">
    <title>REFERENCES</title>
    <ref id="B1">
      <label>1.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sigrist</surname><given-names>C.J.A.</given-names></string-name>, <string-name><surname>Cerutti</surname><given-names>L.</given-names></string-name>, <string-name><surname>Hulo</surname><given-names>N.</given-names></string-name>, <string-name><surname>Gattiker</surname><given-names>A.</given-names></string-name>, <string-name><surname>Falquet</surname><given-names>L.</given-names></string-name>, <string-name><surname>Pagni</surname><given-names>M.</given-names></string-name>, <string-name><surname>Bairoch</surname><given-names>A.</given-names></string-name>, <string-name><surname>Bucher</surname><given-names>P.</given-names></string-name></person-group><article-title>PROSITE: a documented database using patterns and profiles as motif descriptors</article-title>. <source>Brief. Bioinformatics</source>. <year>2002</year>; <volume>3</volume>:<fpage>265</fpage>–<lpage>274</lpage>.<pub-id pub-id-type="pmid">12230035</pub-id></mixed-citation>
    </ref>
    <ref id="B2">
      <label>2.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hunter</surname><given-names>S.</given-names></string-name>, <string-name><surname>Apweiler</surname><given-names>R.</given-names></string-name>, <string-name><surname>Attwood</surname><given-names>T.K.</given-names></string-name>, <string-name><surname>Bairoch</surname><given-names>A.</given-names></string-name>, <string-name><surname>Bateman</surname><given-names>A.</given-names></string-name>, <string-name><surname>Binns</surname><given-names>D.</given-names></string-name>, <string-name><surname>Bork</surname><given-names>P.</given-names></string-name>, <string-name><surname>Das</surname><given-names>U.</given-names></string-name>, <string-name><surname>Daugherty</surname><given-names>L.</given-names></string-name>, <string-name><surname>Duquenne</surname><given-names>L.</given-names></string-name><etal>et al</etal>.</person-group><article-title>InterPro: the integrative protein signature database</article-title>. <source>Nucleic Acids Res.</source><year>2009</year>; <volume>37</volume>:<fpage>D211</fpage>–<lpage>D215</lpage>.<pub-id pub-id-type="pmid">18940856</pub-id></mixed-citation>
    </ref>
    <ref id="B3">
      <label>3.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mistry</surname><given-names>J.</given-names></string-name>, <string-name><surname>Chuguransky</surname><given-names>S.</given-names></string-name>, <string-name><surname>Williams</surname><given-names>L.</given-names></string-name>, <string-name><surname>Qureshi</surname><given-names>M.</given-names></string-name>, <string-name><surname>Salazar</surname><given-names>G.A.</given-names></string-name>, <string-name><surname>Sonnhammer</surname><given-names>E.L.L.</given-names></string-name>, <string-name><surname>Tosatto</surname><given-names>S.C.E.</given-names></string-name>, <string-name><surname>Paladin</surname><given-names>L.</given-names></string-name>, <string-name><surname>Raj</surname><given-names>S.</given-names></string-name>, <string-name><surname>Richardson</surname><given-names>L.J.</given-names></string-name><etal>et al</etal>.</person-group><article-title>Pfam: the protein families database in 2021</article-title>. <source>Nucleic Acids Res.</source><year>2021</year>; <volume>49</volume>:<fpage>D412</fpage>–<lpage>D419</lpage>.<pub-id pub-id-type="pmid">33125078</pub-id></mixed-citation>
    </ref>
    <ref id="B4">
      <label>4.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Saito</surname><given-names>M.</given-names></string-name>, <string-name><surname>Sato</surname><given-names>A.</given-names></string-name>, <string-name><surname>Nagata</surname><given-names>S.</given-names></string-name>, <string-name><surname>Tamaki</surname><given-names>S.</given-names></string-name>, <string-name><surname>Tomita</surname><given-names>M.</given-names></string-name>, <string-name><surname>Suzuki</surname><given-names>H.</given-names></string-name>, <string-name><surname>Kanai</surname><given-names>A.</given-names></string-name></person-group><article-title>Large-scale molecular evolutionary analysis uncovers a variety of polynucleotide kinase Clp1 family proteins in the three domains of life</article-title>. <source>Genome Biol. Evol.</source><year>2019</year>; <volume>11</volume>:<fpage>2713</fpage>–<lpage>2726</lpage>.<pub-id pub-id-type="pmid">31513263</pub-id></mixed-citation>
    </ref>
    <ref id="B5">
      <label>5.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mutte</surname><given-names>S.K.</given-names></string-name>, <string-name><surname>Weijers</surname><given-names>D.</given-names></string-name></person-group><article-title>Deep evolutionary history of the phox and bem1 (PB1) domain across eukaryotes</article-title>. <source>Sci. Rep.</source><year>2020</year>; <volume>10</volume>:<fpage>3797</fpage>.<pub-id pub-id-type="pmid">32123237</pub-id></mixed-citation>
    </ref>
    <ref id="B6">
      <label>6.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Dievart</surname><given-names>A.</given-names></string-name>, <string-name><surname>Gottin</surname><given-names>C.</given-names></string-name>, <string-name><surname>Périn</surname><given-names>C.</given-names></string-name>, <string-name><surname>Ranwez</surname><given-names>V.</given-names></string-name>, <string-name><surname>Chantret</surname><given-names>N.</given-names></string-name></person-group><article-title>Origin and diversity of plant receptor-like kinases</article-title>. <source>Annu. Rev. Plant Biol.</source><year>2020</year>; <volume>71</volume>:<fpage>131</fpage>–<lpage>156</lpage>.<pub-id pub-id-type="pmid">32186895</pub-id></mixed-citation>
    </ref>
    <ref id="B7">
      <label>7.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Liu</surname><given-names>B.A.</given-names></string-name>, <string-name><surname>Nash</surname><given-names>P.D.</given-names></string-name></person-group><article-title>Evolution of SH2 domains and phosphotyrosine signalling networks</article-title>. <source>Philos. Trans. R. Soc. Lond. B, Biol. Sci.</source><year>2012</year>; <volume>367</volume>:<fpage>2556</fpage>–<lpage>2573</lpage>.<pub-id pub-id-type="pmid">22889907</pub-id></mixed-citation>
    </ref>
    <ref id="B8">
      <label>8.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Uhrig</surname><given-names>R.G.</given-names></string-name>, <string-name><surname>Schläpfer</surname><given-names>P.</given-names></string-name>, <string-name><surname>Mehta</surname><given-names>D.</given-names></string-name>, <string-name><surname>Hirsch-Hoffmann</surname><given-names>M.</given-names></string-name>, <string-name><surname>Gruissem</surname><given-names>W.</given-names></string-name></person-group><article-title>Genome-scale analysis of regulatory protein acetylation enzymes from photosynthetic eukaryotes</article-title>. <source>BMC Genomics</source>. <year>2017</year>; <volume>18</volume>:<fpage>514</fpage>.<pub-id pub-id-type="pmid">28679357</pub-id></mixed-citation>
    </ref>
    <ref id="B9">
      <label>9.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Letunic</surname><given-names>I.</given-names></string-name>, <string-name><surname>Bork</surname><given-names>P.</given-names></string-name></person-group><article-title>20 years of the SMART protein domain annotation resource</article-title>. <source>Nucleic Acids Res.</source><year>2018</year>; <volume>46</volume>:<fpage>D493</fpage>–<lpage>D496</lpage>.<pub-id pub-id-type="pmid">29040681</pub-id></mixed-citation>
    </ref>
    <ref id="B10">
      <label>10.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Porollo</surname><given-names>A.A.</given-names></string-name>, <string-name><surname>Adamczak</surname><given-names>R.</given-names></string-name>, <string-name><surname>Meller</surname><given-names>J.</given-names></string-name></person-group><article-title>POLYVIEW: a flexible visualization tool for structural and functional annotations of proteins</article-title>. <source>Bioinformatics</source>. <year>2004</year>; <volume>20</volume>:<fpage>2460</fpage>–<lpage>2462</lpage>.<pub-id pub-id-type="pmid">15073023</pub-id></mixed-citation>
    </ref>
    <ref id="B11">
      <label>11.</label>
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Grinberg</surname><given-names>M.</given-names></string-name></person-group><source>How to Deploy a React + Flask Project</source>. <year>2020</year>; <uri xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://www.blog.miguelgrinberg.com/post/how-to-deploy-a-react–flask-project">https://blog.miguelgrinberg.com/post/how-to-deploy-a-react–flask-project</uri>.</mixed-citation>
    </ref>
    <ref id="B12">
      <label>12.</label>
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Grinberg</surname><given-names>M.</given-names></string-name></person-group><source>Running Your Flask Application Over HTTPS</source>. <year>2017</year>; <uri xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://www.blog.miguelgrinberg.com/post/running-your-flask-application-over-https">https://blog.miguelgrinberg.com/post/running-your-flask-application-over-https</uri>.</mixed-citation>
    </ref>
    <ref id="B13">
      <label>13.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hartl</surname><given-names>M.</given-names></string-name>, <string-name><surname>Füßl</surname><given-names>M.</given-names></string-name>, <string-name><surname>Boersema</surname><given-names>P.J.</given-names></string-name>, <string-name><surname>Jost</surname><given-names>J.-O.</given-names></string-name>, <string-name><surname>Kramer</surname><given-names>K.</given-names></string-name>, <string-name><surname>Bakirbas</surname><given-names>A.</given-names></string-name>, <string-name><surname>Sindlinger</surname><given-names>J.</given-names></string-name>, <string-name><surname>Plöchinger</surname><given-names>M.</given-names></string-name>, <string-name><surname>Leister</surname><given-names>D.</given-names></string-name>, <string-name><surname>Uhrig</surname><given-names>G.</given-names></string-name><etal>et al</etal>.</person-group><article-title>Lysine acetylome profiling uncovers novel histone deacetylase substrate proteins in Arabidopsis</article-title>. <source>Mol. Syst. Biol.</source><year>2017</year>; <volume>13</volume>:<fpage>949</fpage>.<pub-id pub-id-type="pmid">29061669</pub-id></mixed-citation>
    </ref>
    <ref id="B14">
      <label>14.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Uhrig</surname><given-names>R.G.</given-names></string-name>, <string-name><surname>Schläpfer</surname><given-names>P.</given-names></string-name>, <string-name><surname>Roschitzki</surname><given-names>B.</given-names></string-name>, <string-name><surname>Hirsch-Hoffmann</surname><given-names>M.</given-names></string-name>, <string-name><surname>Gruissem</surname><given-names>W.</given-names></string-name></person-group><article-title>Diurnal changes in concerted plant protein phosphorylation and acetylation in Arabidopsis organs and seedlings</article-title>. <source>Plant J.</source><year>2019</year>; <volume>99</volume>:<fpage>176</fpage>–<lpage>194</lpage>.<pub-id pub-id-type="pmid">30920011</pub-id></mixed-citation>
    </ref>
    <ref id="B15">
      <label>15.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Holliday</surname><given-names>G.L.</given-names></string-name>, <string-name><surname>Akiva</surname><given-names>E.</given-names></string-name>, <string-name><surname>Meng</surname><given-names>E.C.</given-names></string-name>, <string-name><surname>Brown</surname><given-names>S.D.</given-names></string-name>, <string-name><surname>Calhoun</surname><given-names>S.</given-names></string-name>, <string-name><surname>Pieper</surname><given-names>U.</given-names></string-name>, <string-name><surname>Sali</surname><given-names>A.</given-names></string-name>, <string-name><surname>Booker</surname><given-names>S.J.</given-names></string-name>, <string-name><surname>Babbitt</surname><given-names>P.C.</given-names></string-name></person-group><article-title>Atlas of the radical SAM superfamily: divergent evolution of function using a “plug and play” domain</article-title>. <source>Methods Enzymol.</source><year>2018</year>; <volume>606</volume>:<fpage>1</fpage>–<lpage>71</lpage>.<pub-id pub-id-type="pmid">30097089</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
