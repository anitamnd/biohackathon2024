<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d1 20130915//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 39.96?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Nucleic Acids Res</journal-id>
    <journal-id journal-id-type="iso-abbrev">Nucleic Acids Res</journal-id>
    <journal-id journal-id-type="hwp">nar</journal-id>
    <journal-id journal-id-type="publisher-id">nar</journal-id>
    <journal-title-group>
      <journal-title>Nucleic Acids Research</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">0305-1048</issn>
    <issn pub-type="epub">1362-4962</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">5027496</article-id>
    <article-id pub-id-type="doi">10.1093/nar/gkw540</article-id>
    <article-categories>
      <subj-group subj-group-type="hwp-journal-coll">
        <subject>7</subject>
        <subject>24</subject>
      </subj-group>
      <subj-group subj-group-type="heading">
        <subject>Methods Online</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Boiler: lossy compression of RNA-seq alignments using coverage vectors</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Pritt</surname>
          <given-names>Jacob</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="AFF2">
          <sup>2</sup>
        </xref>
        <xref ref-type="corresp" rid="COR1">*</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Langmead</surname>
          <given-names>Ben</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="AFF2">
          <sup>2</sup>
        </xref>
        <xref ref-type="corresp" rid="COR2">*</xref>
      </contrib>
      <aff id="AFF1"><label>1</label>Department of Computer Science, Johns Hopkins University, Baltimore, MD 21218, USA</aff>
      <aff id="AFF2"><label>2</label>Center for Computational Biology, Johns Hopkins University, Baltimore, MD 21205, USA</aff>
    </contrib-group>
    <author-notes>
      <corresp id="COR1"><label>*</label>To whom correspondence should be addressed. Tel: +1 410 516 2033; Fax: +1 410 516 6134; Email: <email>jacobpritt@gmail.com</email></corresp>
      <corresp id="COR2">Correspondence may also be addressed to Ben Langmead. Tel: +1 410 516 2033; Fax: +1 410 516 6134; Email: <email>langmea@cs.jhu.edu</email></corresp>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>19</day>
      <month>9</month>
      <year>2016</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>13</day>
      <month>6</month>
      <year>2016</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>13</day>
      <month>6</month>
      <year>2016</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. -->
    <volume>44</volume>
    <issue>16</issue>
    <fpage>e133</fpage>
    <lpage>e133</lpage>
    <history>
      <date date-type="accepted">
        <day>04</day>
        <month>6</month>
        <year>2016</year>
      </date>
      <date date-type="rev-recd">
        <day>27</day>
        <month>5</month>
        <year>2016</year>
      </date>
      <date date-type="received">
        <day>02</day>
        <month>3</month>
        <year>2016</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2016. Published by Oxford University Press on behalf of Nucleic Acids Research.</copyright-statement>
      <copyright-year>2016</copyright-year>
      <license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:title="pdf" xlink:href="gkw540.pdf"/>
    <abstract>
      <p>We describe Boiler, a new software tool for compressing and querying large collections of RNA-seq alignments. Boiler discards most per-read data, keeping only a genomic coverage vector plus a few empirical distributions summarizing the alignments. Since most per-read data is discarded, storage footprint is often much smaller than that achieved by other compression tools. Despite this, the most relevant per-read data can be recovered; we show that Boiler compression has only a slight negative impact on results given by downstream tools for isoform assembly and quantification. Boiler also allows the user to pose fast and useful queries without decompressing the entire file. Boiler is free open source software available from <monospace>github.com/jpritt/boiler</monospace>.</p>
    </abstract>
    <counts>
      <page-count count="13"/>
    </counts>
    <custom-meta-group>
      <custom-meta>
        <meta-name>cover-date</meta-name>
        <meta-value>19 September 2016</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec sec-type="intro" id="SEC1">
    <title>INTRODUCTION</title>
    <p>Sequence Alignment/Map (SAM/BAM) (<xref rid="B1" ref-type="bibr">1</xref>). is a ubiquitous file format for storing RNA (and DNA) sequencing read alignments. For each aligned read, SAM/BAM stores the alignment's location, shape (described by the CIGAR string), base and quality sequences, and other data. BAM files are the binary equivalent of SAM and BAM files are often sorted along the genome and compressed.</p>
    <p>A drawback of SAM/BAM, and of any format that stores data on a per-read basis, is that file size grows close to linearly with the number of reads. But as sequencing continues to improve (<xref rid="B2" ref-type="bibr">2</xref>), and as public archives fill with more datasets, the burden of storing aligned sequencing data also increases rapidly. The Sequence Read Archive (<xref rid="B3" ref-type="bibr">3</xref>), which stores raw sequencing reads, grew from three to four petabases from February to August of 2015. It is increasingly common for RNA-seq studies to span hundreds or thousands of samples, with tens of millions of reads per sample (<xref rid="B4" ref-type="bibr">4</xref>,<xref rid="B5" ref-type="bibr">5</xref>).</p>
    <p>Compressed formats eliminate redundant data across reads or alignments, decreasing file size and allowing size to grow sub-linearly (rather than linearly) with the number of reads. CRAM (<xref rid="B6" ref-type="bibr">6</xref>), NGC (<xref rid="B7" ref-type="bibr">7</xref>), Goby (<xref rid="B8" ref-type="bibr">8</xref>) and REFEREE (<xref rid="B9" ref-type="bibr">9</xref>) use reference-based compression, which was proposed earlier (<xref rid="B10" ref-type="bibr">10</xref>,<xref rid="B11" ref-type="bibr">11</xref>), to replace a read sequence with a concise description of how it differs from a substring of the reference. Quip (<xref rid="B12" ref-type="bibr">12</xref>) uses arithmetic coding together with a sequence model trained on-the-fly to compress losslessly and without a reference. Goby uses a range of strategies, including column-wise compression and detailed modeling of relationships between columns. REFEREE uses separable streams and clustering of quality strings. In these formats, the alignments and the fields are largely preserved, but are compressed along with neighbors row-wise (together with the other fields of the same alignment), or column-wise (with other instances of the field across alignments).</p>
    <p>These studies also explore lossy compression schemes, in which less important data, such as read names and quality strings, is selectively discarded. Many tools optionally discard read names and quality values, and REFEREE clusters quality strings and replaces each with a single representative from its cluster.</p>
    <p>Boiler takes a radically lossy approach to compressing RNA-seq alignments, yielding very small compressed outputs. Inspired by the notion of transform coding, Boiler converts alignment data from the ‘alignment domain,’ where location, shape and pairing information are stored for every alignment, to the ‘coverage domain,’ where the coverage vector is stored and alignment information is inferred where needed. Boiler keeps only a set of coverage vectors and a few empirical distributions that partially preserve fields such as <monospace>POS</monospace> (offset into chromosome) <monospace>TLEN</monospace> (genomic outer distance), <monospace>XS:i</monospace> (strand) and <monospace>NH:i</monospace> (number of hits). Consequently, Boiler is lossy in an unusual sense: compressing and decompressing might cause alignments to shift along the genome, change shape or become matched with the wrong mate. Table <xref ref-type="table" rid="tbl1">1</xref> presents a comparison of how CRAM, Goby and Boiler preserve read information.</p>
    <table-wrap id="tbl1" orientation="portrait" position="float">
      <label>Table 1.</label>
      <caption>
        <title>Comparison of the SAM fields stored by different compression tools</title>
      </caption>
      <table frame="hsides" rules="groups">
        <thead>
          <tr>
            <th align="left" rowspan="1" colspan="1"/>
            <th colspan="2" align="center" rowspan="1">CRAM</th>
            <th colspan="2" align="center" rowspan="1">Goby</th>
            <th align="left" rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <th align="left" rowspan="1" colspan="1">SAM feature</th>
            <th align="left" rowspan="1" colspan="1">Default</th>
            <th align="left" rowspan="1" colspan="1">Config.</th>
            <th align="left" rowspan="1" colspan="1">Default</th>
            <th align="left" rowspan="1" colspan="1">Config.</th>
            <th align="left" rowspan="1" colspan="1">Boiler</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td rowspan="1" colspan="1">Read name</td>
            <td align="left" rowspan="1" colspan="1">Yes<sup>1</sup></td>
            <td align="left" rowspan="1" colspan="1">No</td>
            <td align="left" rowspan="1" colspan="1">No</td>
            <td align="left" rowspan="1" colspan="1">Yes</td>
            <td align="left" rowspan="1" colspan="1">No</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Flags</td>
            <td align="left" rowspan="1" colspan="1">Yes</td>
            <td align="left" rowspan="1" colspan="1">No</td>
            <td align="left" rowspan="1" colspan="1">Yes</td>
            <td align="left" rowspan="1" colspan="1">No</td>
            <td align="left" rowspan="1" colspan="1">No</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Mapping quality</td>
            <td align="left" rowspan="1" colspan="1">Yes</td>
            <td align="left" rowspan="1" colspan="1">No</td>
            <td align="left" rowspan="1" colspan="1">Yes</td>
            <td align="left" rowspan="1" colspan="1">No</td>
            <td align="left" rowspan="1" colspan="1">No</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Read sequence</td>
            <td align="left" rowspan="1" colspan="1">Yes</td>
            <td align="left" rowspan="1" colspan="1">No</td>
            <td align="left" rowspan="1" colspan="1">Yes</td>
            <td align="left" rowspan="1" colspan="1">No</td>
            <td align="left" rowspan="1" colspan="1">No</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Quality scores</td>
            <td align="left" rowspan="1" colspan="1">No</td>
            <td align="left" rowspan="1" colspan="1">Yes</td>
            <td rowspan="1" colspan="1">Yes<sup>2</sup></td>
            <td align="left" rowspan="1" colspan="1">Yes</td>
            <td align="left" rowspan="1" colspan="1">No</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Tags</td>
            <td align="left" rowspan="1" colspan="1">No</td>
            <td align="left" rowspan="1" colspan="1">Yes</td>
            <td align="left" rowspan="1" colspan="1">MD</td>
            <td align="left" rowspan="1" colspan="1">Yes<sup>3</sup></td>
            <td align="left" rowspan="1" colspan="1">XS, NH</td>
          </tr>
        </tbody>
      </table>
      <table-wrap-foot>
        <fn id="TFN001">
          <p><sup>1</sup>CRAMtools documentation claims that by default read names should not be preserved, however we were not able to replicate this functionality.</p>
        </fn>
        <fn id="TFN002">
          <p><sup>2</sup>For mismatches only.</p>
        </fn>
        <fn id="TFN003">
          <p><sup>3</sup>Goby preserves either all tags or just the MD tag.</p>
        </fn>
        <fn id="TFN004">
          <p>CRAM and Goby can preserve some fields through configurable options, summarized in the ‘Config’ columns.</p>
        </fn>
      </table-wrap-foot>
    </table-wrap>
    <p>Boiler should not be considered a general-purpose alignment compression tool. Because it discards quality values and non-reference alleles, its output is not appropriate for downstream tools requiring such data, such as variant callers and tools for allele-specific expression. However, Boiler preserves the data most relevant to popular downstream RNA-seq tools for quantification, assembly and differential expression. We show that popular isoform-level tools—Cufflinks (<xref rid="B13" ref-type="bibr">13</xref>) and StringTie (<xref rid="B14" ref-type="bibr">14</xref>)—yield near-identical results when the input is Boiler-compressed.</p>
    <p>Boiler yields extremely small file sizes, more than 3-fold smaller than files produced by CRAM and Goby for paired-end samples with at least 10M paired-end reads. Unlike other compression tools, Boiler's compression ratio improves substantially as input file size grows, growing from about 10-fold for lower-coverage unpaired samples to over 50-fold for higher-coverage samples. Speed and memory footprint are comparable to other compression tools despite the fact that, as we show, recovering alignments from a coverage vector is computationally hard. Also, because nucleotide data is removed, Boiler-compressed data is effectively de-identified, making it easier to pass between parties securely.</p>
    <p>Boiler also provides a range of speedy queries. Many compression tools provide a way for the user to extract alignments spanning a particular genomic interval from the compressed file. REFEREE goes a step further by enabling faster queries when the user is concerned with only a subset of the fields. Boiler goes further still by providing fast queries that are directly relevant to downstream uses of RNA-seq data. Boiler allows the user and downstream tools to (i) iterate over ‘bundles’ of alignments according to inferred gene boundaries, (ii) extract the coverage vector across a genomic interval and (iii) extract alignments overlapping a genomic interval.</p>
  </sec>
  <sec sec-type="materials|methods" id="SEC2">
    <title>MATERIALS AND METHODS</title>
    <sec id="SEC2-1">
      <title>Compression</title>
      <p>Boiler implements a lossy compression scheme that preserves only the data needed by downstream isoform assembly tools such as Cufflinks and StringTie. For this reason, read names and quality strings are discarded, along with other data that has little or no bearing on downstream RNA-seq analysis.</p>
      <p>Given a set of alignments to a reference genome, Boiler first partitions the alignments into ‘bundles’ of overlapping reads. Bundles are computed in the same manner as Cufflinks’ initial bundling step: as sorted reads are processed, if the current read starts within 50 bases of the end of the current bundle, the read is added to the bundle. Otherwise, the current bundle is compressed and a new bundle is initialized beginning with the current read.</p>
      <p>Boiler converts each bundle into a set of coverage vectors and tallies of observed read lengths. For most Illumina sequencing datasets, reads are uniform-length (or nearly so, e.g. after trimming), yielding a concise tally. If any alignments in the bundle are paired-end, Boiler also stores a tally of observed genomic outer distances as reported by the aligner in the <monospace>TLEN</monospace> SAM field. Note that <monospace>TLEN</monospace> includes the lengths of all the introns spanned by the alignment, so we refer to this as ‘genomic outer distance,’ rather than ‘fragment length.’ The coverage vector is compressed using run-length encoding, which is particularly effective in low-coverage regions.</p>
      <p>Each bundle is compressed as follows:
<list list-type="roman-lower"><list-item><p>Boiler scans the bundle's alignments to find splice sites spanned by at least one alignment. Boiler divides the portion of the genome spanned by the bundle into ‘partitions’ formed by cutting at every splice site (Figure <xref ref-type="fig" rid="F1">1A</xref>).</p></list-item><list-item><p>Boiler assigns each alignment to a <italic>bucket</italic> according to: (a) the subset of partitions spanned by the alignment, (b) the value in the alignment's <monospace>NH:i</monospace> field, indicating the number of distinct locations where the read aligned to the reference and (c) the value in the <monospace>XS:A</monospace> field, indicating whether spanned splice motifs are consistent with the sense (<monospace>+</monospace>) or anti-sense (<monospace>−</monospace>) strand of the gene. Alignments not spanning a junction usually lack the <monospace>XS:A</monospace> field; Boiler treats these as though the <monospace>XS:A</monospace> field contains a ‘dummy’ value indicating the strand is unknown.</p></list-item><list-item><p>For each bucket, Boiler computes the coverage vector from the alignments assigned to it. Boiler writes the run-length encoded coverage vector (Figure <xref ref-type="fig" rid="F1">1B</xref>) followed by the read and genomic outer distance distributions (Figure <xref ref-type="fig" rid="F1">1C</xref>) for the junction.</p></list-item></list></p>
      <fig id="F1" orientation="portrait" position="float">
        <label>Figure 1.</label>
        <caption>
          <p>Illustration of how Boiler compresses alignments in a bundle, for a dataset with unpaired reads. (<bold>A</bold>) The genome is divided into ‘partitions’ (colored segments) based on the processed splice sites. A bucket is defined by the subset of partitions spanned (as well as the values of the NH:i and XS:A fields, though these are omitted from the figure for simplicity). Each bucket stores (<bold>B</bold>) the coverage vector and (<bold>C</bold>) the length tally of the reads assigned to the bucket.</p>
        </caption>
        <graphic xlink:href="gkw540fig1"/>
      </fig>
      <p>Each bundle, which consists of many buckets, is compressed independently using the DEFLATE algorithm as implemented in the <monospace>zlib</monospace> package from the Python Standard Library. Each bundle is compressed separately to make targeted queries efficient, as discussed in the ‘Queries’ section.</p>
      <p>Some RNA-seq alignment tools (including HISAT (<xref rid="B15" ref-type="bibr">15</xref>)) output SAM records for reads or ends that fail to align, whereas others (including TopHat 2 (<xref rid="B16" ref-type="bibr">16</xref>)) do not. Boiler deals only with aligned reads. SAM records for unaligned reads are ignored, and those reads are not represented in a compressed Boiler file. Additionally, if one end of a paired-end read is ‘orphaned’—i.e. its opposite end fails to align—Boiler will convert the orphan to an unpaired read. The paired nature of orphaned reads is lost during Boiler compression.</p>
    </sec>
    <sec id="SEC2-2">
      <title>Unbundled alignments</title>
      <p>Prior to compression, Boiler must identify and handle paired-end alignments that span bundles in unexpected ways. We call these <italic>unbundled</italic> alignments. Unbundled alignments fall into four categories: (i) one end falls within an intron spanned by the other end, (ii) the two ends align to different chromosomes, (iii) the two ends align to the same chromosome but very far from each other, (iv) one end is assigned to the sense strand, while its mate is assigned to the anti-sense strand. Both TopHat and HISAT report such alignments, though they constitute only a small fraction of the alignments in a typical dataset.</p>
      <p>These alignments are hard to fit into the bundling scheme described previously. Reads in category (i) are biologically implausible. Boiler treats them as unpaired reads by default, however the user may choose to preserve these pairings.</p>
      <p>Categories (ii) and (iii) could be scientifically relevant and should be preserved. For instance, alignments in category (ii) may be evidence of gene fusions. Boiler stores all alignments in categories (ii) and (iii) in a special ‘unbundled alignments’ section of the compressed file. Unbundled alignments are stored in <italic>bundle-spanning buckets</italic>. A bundle-spanning bucket is identical to a normal bucket, but includes the indices of the two bundles it spans in addition to the list of partitions spanned from each bundle. The bundle-spanning buckets are stored as a contiguous list, compressed in small chunks using zlib and indexed to reduce work for targeted queries.</p>
      <p>Treatment of pairs in category (iv) is configurable by the user. By default, they remain paired and one end, selected at random, is modified to match the other's strand. Optionally (using <monospace>- -split-discordant</monospace>), such pairs can be treated as unpaired reads, which is consistent with how they are treated by Cufflinks and StringTie.</p>
    </sec>
    <sec id="SEC2-3">
      <title>Multi-mapping reads</title>
      <p>RNA-seq reads may align equally well to many genomic locations. Such reads are called ‘multi mappers.’ Because downstream tools might treat multi mappers differently from uniquely mapped reads, at least some multi-mapping information must be preserved by Boiler.</p>
      <p>For a multi-mapping read, Boiler preserves each alignment along with its NH:i extra field. However, Boiler also discards read names. This can have an adverse impact on downstream tools that rely on read names to establish the one-to-many relationship between reads and their alignments. Our fidelity experiments show this does not substantially impact the accuracy of downstream tools for isoform assembly and quantification. However, it does have an adverse effect on quantification accuracy when Cufflinks is asked to quantify from a given gene annotation (<monospace>−G</monospace> mode), as discussed in Supplementary Note 11. StringTie's accuracy when quantifying from a given gene annotation (<monospace>−G −e</monospace> mode) is not substantially affected.</p>
    </sec>
    <sec id="SEC2-4">
      <title>Decompression</title>
      <p>To decompress, Boiler first expands each bundle with the INFLATE algorithm as implemented in the Python <monospace>zlib</monospace> module, then expands each bucket.</p>
      <p>When decompressing a bucket, Boiler seeks to recreate the set of alignment intervals that yielded the bucket's coverage vector and read and genomic outer distance tallies. This is a two-step process; first reads must be recovered from the coverage vector and read length tally (‘read recovery’), then the recovered reads must be paired according to the paired length tally (‘pairing’).</p>
      <p>The <italic>read recovery</italic> problem may not have a unique solution; e.g. consider a compressed dataset with read lengths <italic>l</italic><sub>1</sub> and <italic>l</italic><sub>2</sub> (<italic>l</italic><sub>1</sub> ≠ <italic>l</italic><sub>2</sub>) and a coverage vector containing 1 at all positions in the range [0, <italic>l</italic><sub>1</sub> + <italic>l</italic><sub>2</sub>). This case has two valid solutions:
<disp-formula><tex-math id="M4">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}\begin{equation*} r_1 = \big [ 0, l_1\big ), r_2 = \big [ l_1,l_1+l_2\big ) \end{equation*}\end{document}</tex-math></disp-formula>
and
<disp-formula><tex-math id="M5">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}\begin{equation*} r_1 = \big [0, l_2\big ), r_2 = \big [l_2,l_1+l_2\big ) \end{equation*}\end{document}</tex-math></disp-formula></p>
      <p>Thus, we cannot guarantee perfect recovery of the compressed reads.</p>
      <p>We define the read recovery problem as follows. Given a coverage vector and tally of read lengths, we seek a list of decompressed reads (genomic intervals) such that,
<list list-type="roman-lower"><list-item><p>the decompressed read lengths are a subset of those given in the tally,</p></list-item><list-item><p>at no position does the coverage vector produced by the decompressed reads exceed the value in the original coverage vector, and</p></list-item><list-item><p>the sum of the lengths of all decompressed reads is maximized.</p></list-item></list></p>
      <p>This formulation is general enough to tolerate an input where the read length tally and coverage vector are not compatible, i.e. where no solution fits both precisely. In this case, the algorithm might decompress only some of the reads in the input tally.</p>
      <p>We observe that the read recovery problem is NP-hard in general (proved by reduction from the Multiple Subset Sum Problem in Supplementary Note 1), but that some special cases are easily solved. When all reads are the same length, for example, the solution is unique and can be found efficiently. We also observe that second-generation sequencing produces datasets with uniform or near-uniform (e.g. after trimming) read-length tallies. These facts lead us to propose the greedy algorithm described below. The algorithm is not optimal in general, but it is well suited to cases where the input read lengths are uniform or almost uniform.</p>
      <sec id="SEC2-4-1">
        <title>Greedy algorithms for extracting and pairing reads</title>
        <p>The algorithm works from one end of the coverage vector to the other, extracting reads that are ‘consistent’ with coverage. A read is consistent with coverage if removing the read and decrementing the corresponding coverage-vector elements does not cause any vector elements to fall below zero. When a consistent read is selected for extraction, the corresponding coverage-vector elements are decremented and the process repeats. The process stops when the far end of the coverage vector is reached.</p>
        <p>When reads have uniform length, the algorithm yields the correct solution. When reads have various lengths, the problem is harder and the algorithm may fail to yield the optimal solution. In the case where reads are various lengths, Boiler's algorithm uses heuristics to arrive at a solution where (i) the coverage vector induced by the extracted reads matches the true vector as closely as possible, and (ii) the distribution of extracted read lengths matches the true distribution of read lengths as closely as possible. Boiler favors (i) over (ii); i.e. it will artificially lengthen or shorten the extracted reads to fix small coverage discrepancies. The heuristics are described in Supplementary Note 2.</p>
        <p>If the data contains paired-end reads, we must also solve the <italic>read pairing</italic> problem. We would like Boiler to restore the paired-end relationships in a way that matches the original genomic outer distances as closely as possible. We start with (i) a collection of reads (ends), all of which are initially unpaired and (ii) the ‘true’ genomic outer distance tally, storing the frequencies of each distance, which was compiled and stored during compression.</p>
        <p>We use the following greedy algorithm to pair up reads in a way that closely matches the true genomic outer distance tally. Each read is examined, working inward from the extremes, alternating between the left and right extremes. For each read, we seek the most distant read such that the resulting pairing is compatible with distances remaining in the tally. When two reads are paired in this way, they are removed from future consideration and the corresponding element of the tally is decremented. Reads that are not paired in this way are matched up randomly in a second pass.</p>
      </sec>
    </sec>
    <sec id="SEC2-5">
      <title>Queries</title>
      <p>Boiler allows the user to query a compressed RNA-seq dataset to (i) iterate over genomic intervals delimiting regions of non-zero coverage, roughly corresponding to genes, (ii) extract the genomic coverage vector across a specified genomic interval and (iii) extract alignments overlapping a specified genomic interval. Because each bundle of alignments is compressed separately, Boiler can answer such queries without decompressing the entire file.</p>
      <p>Bundle boundaries are stored in the index at the beginning of the compressed file, so skipping to a particular bundle can be accomplished with a single uncompressed index lookup. To compute the coverage query (query (<italic>ii</italic>), above), Boiler combines the relevant portions of the coverage vectors for all the buckets overlapping the specified region. This requires that Boiler decompress the DEFLATED and run-length encoded coverage vectors, but does not require the more work-intensive read and pair recovery algorithms. Alignment-level queries (queries (<italic>i</italic>) and (<italic>iii</italic>) above) are more expensive, requiring Boiler to run the greedy read recovery algorithm on each of the buckets overlapping the specified region.</p>
      <p>Downstream tools like Cufflinks can be modified to query Boiler-compressed files directly, removing the need for an intermediate SAM/BAM file. When a downstream tool requires access only to information about gene boundaries (query <italic>(i)</italic>, above) or about targeted regions of the coverage vector (query <italic>(ii)</italic>), Boiler's queries can be much faster than directly querying a sorted and indexed BAM file.</p>
    </sec>
    <sec id="SEC2-6">
      <title>Implementation</title>
      <p>Boiler is implemented in Python and is compatible with Python interpreters version 3 and above. All of the Python modules used by Boiler are in the Python Standard Library, making Boiler quite portable across Python installations and interpreters. For example, we use the fast PyPy interpreter for our experiments.</p>
    </sec>
  </sec>
  <sec sec-type="results" id="SEC3">
    <title>RESULTS</title>
    <p>We used Flux Simulator v1.2.1 (<xref rid="B17" ref-type="bibr">17</xref>) to simulate 10 RNA-seq samples from the BDGP5 build of the <italic>Drosophila melanogaster</italic> genome and the Ensembl release 70 (<xref rid="B18" ref-type="bibr">18</xref>) gene annotation. We simulated both paired-end and unpaired RNA-seq samples for a series of library sizes: 0.5, 1, 2.5, 5, 10 and 20 million reads. We also simulated two samples from the hg19 build of the human genome and Gencode v12 gene annotation (<xref rid="B19" ref-type="bibr">19</xref>) containing 20 and 40 million paired-end reads. We also used two real human RNA-seq samples. We used sample HG00100 from the GEUVADIS (<xref rid="B5" ref-type="bibr">5</xref>) study, consisting of about 20 million paired-end reads. We also chose one of the seven technical replicates of the 3:1 ratio of Universal Human Reference RNA to Human Brain Reference RNA from the SEQC study (<xref rid="B20" ref-type="bibr">20</xref>). The study accession is SRP025982 and the individual replicates have run accessions SRR1216073–SRR1216079. Each replicate consists of ∼11-million paired-end reads. We tested sample SRR1216073, labeled ‘SRP025982’ in the results below. All samples were aligned to the reference genome using either TopHat 2 v2.1.0 (<xref rid="B16" ref-type="bibr">16</xref>) with default parameters, or HISAT 0.1.6-β (<xref rid="B15" ref-type="bibr">15</xref>) with default parameters. <italic>D. melanogaster</italic> samples were aligned to the BDGP5 reference and human samples were aligned to the hg19 reference.</p>
    <p>We compared Boiler's speed, compression ratio and peak memory usage to Goby and CRAMTools. Boiler and Goby remove read names by default, but CRAM does not. (CRAMtools has an option to preserve read names, but we cannot find a working mechanism in version 3 to remove them.) For a fair comparison, we stripped the read names before compressing. For Goby, we enabled the full ‘ACT H+ T + D’ compression scheme, as described in the Goby study (<xref rid="B8" ref-type="bibr">8</xref>).</p>
    <p>Further details on software versions and command-line arguments used are included in Supplementary Note 3.</p>
    <sec id="SEC3-1">
      <title>Efficiency and compression ratio</title>
      <p>We compressed each TopHat 2 alignment file with Boiler v1.0.1, CRAMTools v3.0 and Goby v2.3.5. Boiler was run with PyPy v2.4 and CRAMTools and Goby were run with Java v1.7. All tools were run on the Homewood High Performance Compute Cluster at Johns Hopkins University. Each cluster computer has 2 Intel Xeon X5660 2.80GHz processors and 48 GB of RAM. We measured running time by adding the <monospace>user</monospace> and <monospace>sys</monospace> times reported by the Linux <monospace>time</monospace> command. Each tool runs predominantly on a single thread and processor. We measured peak memory usage in Python by spawning a new child process for the command and polling maximum resident set size using the Python <monospace>resource</monospace> package's <monospace>getrusage</monospace> function. Peak memory usage for Boiler and Goby was consistent across runs, but CRAM memory usage varied widely between runs. We report the median peak memory of 10 runs for greater consistency.</p>
      <p>Boiler takes roughly 1.5–2 times longer than CRAMTools and Goby to compress the <italic>D. melanogaster</italic> samples and about 2–12 times longer for the human samples (Table <xref ref-type="table" rid="tbl2">2</xref> and Figure <xref ref-type="fig" rid="F2">2</xref>). It requires less memory than Goby for all but the deeper human samples, and less than CRAM for small datasets. For larger datasets, CRAM memory's memory footprint seems to be capped at around 2 GB (Table <xref ref-type="table" rid="tbl3">3</xref>). Supplementary Note 5 compares the decompression time for all three tools.</p>
      <fig id="F2" orientation="portrait" position="float">
        <label>Figure 2.</label>
        <caption>
          <p>Time required for Boiler, CRAM and Goby to compress simulated <italic>Drosophila melanogaster</italic> paired-end datasets.</p>
        </caption>
        <graphic xlink:href="gkw540fig2"/>
      </fig>
      <table-wrap id="tbl2" orientation="portrait" position="float">
        <label>Table 2.</label>
        <caption>
          <title>Compression times in seconds</title>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <th align="left" rowspan="1" colspan="1">Dataset</th>
              <th align="left" rowspan="1" colspan="1">Boiler</th>
              <th align="left" rowspan="1" colspan="1">CRAM</th>
              <th align="left" rowspan="1" colspan="1">Goby</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td colspan="4" rowspan="1"><italic>Drosophila</italic>, Simulated Unpaired</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">0.5M</td>
              <td rowspan="1" colspan="1">57.4</td>
              <td rowspan="1" colspan="1">17.4</td>
              <td rowspan="1" colspan="1">15.3</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">1M</td>
              <td rowspan="1" colspan="1">66.5</td>
              <td rowspan="1" colspan="1">20.7</td>
              <td rowspan="1" colspan="1">23.2</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">2.5M</td>
              <td rowspan="1" colspan="1">89.1</td>
              <td rowspan="1" colspan="1">40.6</td>
              <td rowspan="1" colspan="1">40.1</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">5M</td>
              <td rowspan="1" colspan="1">126.0</td>
              <td rowspan="1" colspan="1">70.0</td>
              <td rowspan="1" colspan="1">72.9</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">10M</td>
              <td rowspan="1" colspan="1">197.9</td>
              <td rowspan="1" colspan="1">129.6</td>
              <td rowspan="1" colspan="1">122.3</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">20M</td>
              <td rowspan="1" colspan="1">329.5</td>
              <td rowspan="1" colspan="1">246.6</td>
              <td rowspan="1" colspan="1">248.2</td>
            </tr>
            <tr>
              <td colspan="4" rowspan="1"><italic>Drosophila</italic>, simulated paired</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">0.5M</td>
              <td rowspan="1" colspan="1">50.5</td>
              <td rowspan="1" colspan="1">30.9</td>
              <td rowspan="1" colspan="1">24.1</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">1M</td>
              <td rowspan="1" colspan="1">76.8</td>
              <td rowspan="1" colspan="1">40.1</td>
              <td rowspan="1" colspan="1">36.5</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">2.5M</td>
              <td rowspan="1" colspan="1">152.5</td>
              <td rowspan="1" colspan="1">80.8</td>
              <td rowspan="1" colspan="1">81.5</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">5M</td>
              <td rowspan="1" colspan="1">254.8</td>
              <td rowspan="1" colspan="1">142.0</td>
              <td rowspan="1" colspan="1">156.4</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">10M</td>
              <td rowspan="1" colspan="1">497.7</td>
              <td rowspan="1" colspan="1">279.6</td>
              <td rowspan="1" colspan="1">298.4</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">20M</td>
              <td rowspan="1" colspan="1">943.9</td>
              <td rowspan="1" colspan="1">556.1</td>
              <td rowspan="1" colspan="1">626.4</td>
            </tr>
            <tr>
              <td colspan="4" rowspan="1">Human</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">SRP025982 (11M)</td>
              <td rowspan="1" colspan="1">6122.6</td>
              <td rowspan="1" colspan="1">507.6</td>
              <td rowspan="1" colspan="1">674.5</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">HG00100 (20M)</td>
              <td rowspan="1" colspan="1">4118.8</td>
              <td rowspan="1" colspan="1">691.6</td>
              <td rowspan="1" colspan="1">1045.6</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Simulated 20M</td>
              <td rowspan="1" colspan="1">2337.3</td>
              <td rowspan="1" colspan="1">906.8</td>
              <td rowspan="1" colspan="1">1301.3</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Simulated 40M</td>
              <td rowspan="1" colspan="1">7906.3</td>
              <td rowspan="1" colspan="1">1476.8</td>
              <td rowspan="1" colspan="1">2138.7</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
      <table-wrap id="tbl3" orientation="portrait" position="float">
        <label>Table 3.</label>
        <caption>
          <title>Peak memory usage (GB) reported by Python</title>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <th align="left" rowspan="1" colspan="1">Dataset</th>
              <th align="left" rowspan="1" colspan="1">Boiler</th>
              <th align="left" rowspan="1" colspan="1">CRAM</th>
              <th align="left" rowspan="1" colspan="1">Goby</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td colspan="4" rowspan="1">Drosophila, Simulated Unpaired</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">0.5M</td>
              <td rowspan="1" colspan="1">0.38</td>
              <td rowspan="1" colspan="1">0.74</td>
              <td rowspan="1" colspan="1">0.73</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">1M</td>
              <td rowspan="1" colspan="1">0.29</td>
              <td rowspan="1" colspan="1">1.37</td>
              <td rowspan="1" colspan="1">1.39</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">2.5M</td>
              <td rowspan="1" colspan="1">0.24</td>
              <td rowspan="1" colspan="1">1.12</td>
              <td rowspan="1" colspan="1">1.72</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">5M</td>
              <td rowspan="1" colspan="1">0.24</td>
              <td rowspan="1" colspan="1">1.13</td>
              <td rowspan="1" colspan="1">1.73</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">10M</td>
              <td rowspan="1" colspan="1">0.24</td>
              <td rowspan="1" colspan="1">0.96</td>
              <td rowspan="1" colspan="1">2.11</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">20M</td>
              <td rowspan="1" colspan="1">0.50</td>
              <td rowspan="1" colspan="1">1.53</td>
              <td rowspan="1" colspan="1">3.77</td>
            </tr>
            <tr>
              <td colspan="4" rowspan="1">Drosophila, Simulated Paired</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">0.5M</td>
              <td rowspan="1" colspan="1">0.32</td>
              <td rowspan="1" colspan="1">1.15</td>
              <td rowspan="1" colspan="1">0.90</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">1M</td>
              <td rowspan="1" colspan="1">0.31</td>
              <td rowspan="1" colspan="1">1.91</td>
              <td rowspan="1" colspan="1">1.05</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">2.5M</td>
              <td rowspan="1" colspan="1">0.30</td>
              <td rowspan="1" colspan="1">1.96</td>
              <td rowspan="1" colspan="1">1.33</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">5M</td>
              <td rowspan="1" colspan="1">0.32</td>
              <td rowspan="1" colspan="1">1.18</td>
              <td rowspan="1" colspan="1">1.61</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">10M</td>
              <td rowspan="1" colspan="1">0.79</td>
              <td rowspan="1" colspan="1">1.11</td>
              <td rowspan="1" colspan="1">5.67</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">20M</td>
              <td rowspan="1" colspan="1">1.57</td>
              <td rowspan="1" colspan="1">0.99</td>
              <td rowspan="1" colspan="1">7.21</td>
            </tr>
            <tr>
              <td colspan="4" rowspan="1">Human</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">SRP025982 (11M)</td>
              <td rowspan="1" colspan="1">7.10</td>
              <td rowspan="1" colspan="1">2.08</td>
              <td rowspan="1" colspan="1">5.3</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">HG00100 (20M)</td>
              <td rowspan="1" colspan="1">3.23</td>
              <td rowspan="1" colspan="1">2.08</td>
              <td rowspan="1" colspan="1">4.12</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Simulated 20M</td>
              <td rowspan="1" colspan="1">6.11</td>
              <td rowspan="1" colspan="1">2.08</td>
              <td rowspan="1" colspan="1">4.87</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Simulated 40M</td>
              <td rowspan="1" colspan="1">9.14</td>
              <td rowspan="1" colspan="1">2.08</td>
              <td rowspan="1" colspan="1">6.88</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <fn id="TFN005">
            <p>Numbers reported are the median across 10 runs.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
      <p>Importantly, Boiler achieves a compression ratio comparable to BigWig (<xref rid="B21" ref-type="bibr">21</xref>) (Table <xref ref-type="table" rid="tbl4">4</xref>) for all but the largest paired-end datasets, and usually produces far smaller compressed files than CRAMTools or Goby. We measured both compressed file size (Table <xref ref-type="table" rid="tbl4">4</xref>) and the ‘compression ratio’ of original to compressed file size (Figure <xref ref-type="fig" rid="F3">3</xref>) for alignments generated by TopHat 2. The ‘original’ file is a sorted BAM file with read names removed. For low-coverage unpaired datasets, CRAM and Goby's compression ratios are superior to Boiler's. However, we observe that while CRAMTools and Goby's compression ratios remain flat as the <italic>D. melanogaster</italic> library size increases, Boiler's ratios improve substantially (Figure <xref ref-type="fig" rid="F3">3</xref>), achieving its best compression ratios for the 20M-read samples: 56-fold for unpaired and 39-fold for paired-end samples. Boiler's compression ratio is consistently better than the other tools for paired-end samples and improves as library size increases. For high coverage <italic>D. melanogaster</italic> and all human datasets, Boiler achieves compression ratios 3-5-fold higher than both CRAM and Goby.</p>
      <fig id="F3" orientation="portrait" position="float">
        <label>Figure 3.</label>
        <caption>
          <p>Compression ratios for simulated <italic>Drosophila melanogaster</italic> datasets when compressed by Boiler, CRAM and Goby. Ratios are with respect to the original sorted BAM with read names removed.</p>
        </caption>
        <graphic xlink:href="gkw540fig3"/>
      </fig>
      <table-wrap id="tbl4" orientation="portrait" position="float">
        <label>Table 4.</label>
        <caption>
          <title>Size of compressed files (MB) compared to the original sorted BAM with read names removed</title>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <th align="left" rowspan="1" colspan="1">Dataset</th>
              <th align="left" rowspan="1" colspan="1">BAM</th>
              <th align="left" rowspan="1" colspan="1">BigWig</th>
              <th align="left" rowspan="1" colspan="1">Boiler</th>
              <th align="left" rowspan="1" colspan="1">CRAM</th>
              <th align="left" rowspan="1" colspan="1">Goby</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td colspan="6" rowspan="1"><italic>Drosophila</italic>, Simulated Unpaired</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">0.5M</td>
              <td rowspan="1" colspan="1">26.0</td>
              <td rowspan="1" colspan="1">3.7</td>
              <td rowspan="1" colspan="1">2.7</td>
              <td rowspan="1" colspan="1">0.9</td>
              <td rowspan="1" colspan="1">1.2</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">1M</td>
              <td rowspan="1" colspan="1">49.4</td>
              <td rowspan="1" colspan="1">6.4</td>
              <td rowspan="1" colspan="1">3.6</td>
              <td rowspan="1" colspan="1">1.6</td>
              <td rowspan="1" colspan="1">2.4</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">2.5M</td>
              <td rowspan="1" colspan="1">120.3</td>
              <td rowspan="1" colspan="1">12.8</td>
              <td rowspan="1" colspan="1">5.6</td>
              <td rowspan="1" colspan="1">3.8</td>
              <td rowspan="1" colspan="1">5.6</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">5M</td>
              <td rowspan="1" colspan="1">222.2</td>
              <td rowspan="1" colspan="1">19.0</td>
              <td rowspan="1" colspan="1">7.6</td>
              <td rowspan="1" colspan="1">6.7</td>
              <td rowspan="1" colspan="1">10.1</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">10M</td>
              <td rowspan="1" colspan="1">436.1</td>
              <td rowspan="1" colspan="1">28.1</td>
              <td rowspan="1" colspan="1">11.0</td>
              <td rowspan="1" colspan="1">12.6</td>
              <td rowspan="1" colspan="1">19.0</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">20M</td>
              <td rowspan="1" colspan="1">883.0</td>
              <td rowspan="1" colspan="1">37.0</td>
              <td rowspan="1" colspan="1">15.0</td>
              <td rowspan="1" colspan="1">23.2</td>
              <td rowspan="1" colspan="1">35.7</td>
            </tr>
            <tr>
              <td colspan="6" rowspan="1"><italic>Drosophila</italic>, simulated paired</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">0.5M</td>
              <td rowspan="1" colspan="1">56.1</td>
              <td rowspan="1" colspan="1">6.3</td>
              <td rowspan="1" colspan="1">4.3</td>
              <td rowspan="1" colspan="1">7.7</td>
              <td rowspan="1" colspan="1">4.9</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">1M</td>
              <td rowspan="1" colspan="1">104.6</td>
              <td rowspan="1" colspan="1">10.4</td>
              <td rowspan="1" colspan="1">6.7</td>
              <td rowspan="1" colspan="1">14.2</td>
              <td rowspan="1" colspan="1">9.4</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">2.5M</td>
              <td rowspan="1" colspan="1">255.6</td>
              <td rowspan="1" colspan="1">19.8</td>
              <td rowspan="1" colspan="1">12.9</td>
              <td rowspan="1" colspan="1">33.9</td>
              <td rowspan="1" colspan="1">23.8</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">5M</td>
              <td rowspan="1" colspan="1">488.1</td>
              <td rowspan="1" colspan="1">27.8</td>
              <td rowspan="1" colspan="1">20.0</td>
              <td rowspan="1" colspan="1">61.9</td>
              <td rowspan="1" colspan="1">45.9</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">10M</td>
              <td rowspan="1" colspan="1">955.0</td>
              <td rowspan="1" colspan="1">37.2</td>
              <td rowspan="1" colspan="1">31.6</td>
              <td rowspan="1" colspan="1">116.9</td>
              <td rowspan="1" colspan="1">95.8</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">20M</td>
              <td rowspan="1" colspan="1">1902.6</td>
              <td rowspan="1" colspan="1">47.8</td>
              <td rowspan="1" colspan="1">49.0</td>
              <td rowspan="1" colspan="1">226.2</td>
              <td rowspan="1" colspan="1">193.3</td>
            </tr>
            <tr>
              <td colspan="6" rowspan="1">Human</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">EJOYQAZ (7.5M)</td>
              <td rowspan="1" colspan="1">747.9<sup>1</sup></td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">26.9</td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">123.2<sup>1</sup></td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">SRP025982 (11M)</td>
              <td rowspan="1" colspan="1">810.1</td>
              <td rowspan="1" colspan="1">54.6</td>
              <td rowspan="1" colspan="1">38.0</td>
              <td rowspan="1" colspan="1">160.5</td>
              <td rowspan="1" colspan="1">159.8</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">HG00100 (20M)</td>
              <td rowspan="1" colspan="1">2017.9</td>
              <td rowspan="1" colspan="1">98.7</td>
              <td rowspan="1" colspan="1">78.0</td>
              <td rowspan="1" colspan="1">288.8</td>
              <td rowspan="1" colspan="1">352.2</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Simulated 20M</td>
              <td rowspan="1" colspan="1">2117.3</td>
              <td rowspan="1" colspan="1">54.3</td>
              <td rowspan="1" colspan="1">71.6</td>
              <td rowspan="1" colspan="1">273.5</td>
              <td rowspan="1" colspan="1">307.8</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Simulated 40M</td>
              <td rowspan="1" colspan="1">3858.4</td>
              <td rowspan="1" colspan="1">71.7</td>
              <td rowspan="1" colspan="1">118.0</td>
              <td rowspan="1" colspan="1">491.4</td>
              <td rowspan="1" colspan="1">587.6</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <fn id="TFN006">
            <p><sup>1</sup>Datasets downloaded from Goby Supplementary Data.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
      <p>To demonstrate Boiler's performance on an established benchmark, we also ran Boiler on the dataset with Sample ID EJOYQAZ from the Goby study (Table <xref ref-type="table" rid="tbl4">4</xref>). This consists of roughly 7.5 million paired-end reads from <italic>H. sapiens</italic>. The BAM file as well as the compressed Goby output is available at <ext-link ext-link-type="uri" xlink:href="http://data.campagnelab.org/home/compression-of-structured-high-throughput-sequencing-data"><monospace>data.campagnelab.org/home/compression-of-structured-high-throughput-sequencing-data</monospace></ext-link>. Boiler produces a compressed file of 26.9 MB (2.8% of the original BAM) compared to Goby's output of 123.2 MB (13.0% of the original BAM), representing a 77% space reduction for Boiler compared to Goby.</p>
      <p>Boiler achieves a comparable compression ratio for alignments generated by HISAT (Supplementary Note 4). We also show in Supplementary Note 4 that removing orphaned reads or quality scores from the SAM file does not significantly impact Goby's compression ratio.</p>
    </sec>
    <sec id="SEC3-2">
      <title>Fidelity</title>
      <p>Boiler discards read nucleotide and quality-value data. So while Boiler is not appropriate for pipelines where downstream tools measure non-reference alleles—e.g. for variant calling, allele-specific expression or RNA editing—we show that Boiler is appropriate for the common case where downstream tools are concerned with assembling and quantifying isoforms, e.g. Cufflinks and StringTie.</p>
      <p>Boiler tends to ‘shuffle’ alignment data in certain ways during compression. Some of the shuffling is harmless, having no adverse effect on downstream results from Cufflinks and StringTie. But some shuffling could be harmful, negatively impacting the fidelity of downstream results. Using both simulated and real data, we (i) establish the nature of the shuffling introduced by Boiler, (ii) show there is only slight harmful shuffling in practice and (iii) show that the overall amount of shuffling is smaller—often much smaller—than the shuffling that results from substituting one technical replicate for another.</p>
    </sec>
    <sec id="SEC3-3">
      <title>Alignment-level fidelity</title>
      <p>Boiler compression can change where alignments lie on the genome and how they are paired. Here we ask how well alignment locations are preserved after Boiler compression of the TopHat 2-aligned samples. We measure alignment-level precision and recall in two ways. First we ignore read pairings. For each aligned unpaired read (or end of a paired-end read) in the original file, we seek a corresponding alignment in the compressed file where the genomic position of the alignment and of all overlapped splice junctions are identical. This counts as a true positive, and the alignments involved are ‘matched.’ An alignment can be matched with at most one other alignment. An alignment in the original file that fails to match an alignment in the compressed file counts as a false negative and the converse is a false positive Given these definitions, precision and recall are shown in the left-hand columns of Table <xref ref-type="table" rid="tbl5">5</xref> (labeled ‘Ignoring pairings’). These range from 96.2 to 99.4% across the samples tested.</p>
      <table-wrap id="tbl5" orientation="portrait" position="float">
        <label>Table 5.</label>
        <caption>
          <title>Precision and recall of SAM reads</title>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <th align="left" rowspan="1" colspan="1">
</th>
              <th colspan="2" align="center" rowspan="1">Ignoring pairings</th>
              <th colspan="2" align="center" rowspan="1">Including pairings</th>
            </tr>
            <tr>
              <th align="left" rowspan="1" colspan="1">Dataset</th>
              <th align="left" rowspan="1" colspan="1">Precision</th>
              <th align="left" rowspan="1" colspan="1">Recall</th>
              <th align="left" rowspan="1" colspan="1">Precision</th>
              <th align="left" rowspan="1" colspan="1">Recall</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td colspan="5" rowspan="1"><italic>Drosophila</italic>, simulated unpaired</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">0.5M</td>
              <td align="left" rowspan="1" colspan="1">0.991</td>
              <td align="left" rowspan="1" colspan="1">0.993</td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">1M</td>
              <td align="left" rowspan="1" colspan="1">0.986</td>
              <td align="left" rowspan="1" colspan="1">0.989</td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">2.5M</td>
              <td align="left" rowspan="1" colspan="1">0.976</td>
              <td align="left" rowspan="1" colspan="1">0.981</td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">5M</td>
              <td align="left" rowspan="1" colspan="1">0.969</td>
              <td align="left" rowspan="1" colspan="1">0.974</td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">10M</td>
              <td align="left" rowspan="1" colspan="1">0.962</td>
              <td align="left" rowspan="1" colspan="1">0.968</td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">20M</td>
              <td align="left" rowspan="1" colspan="1">0.964</td>
              <td align="left" rowspan="1" colspan="1">0.969</td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
            </tr>
            <tr>
              <td colspan="5" rowspan="1"><italic>Drosophila</italic>, simulated paired</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">0.5M</td>
              <td align="left" rowspan="1" colspan="1">0.990</td>
              <td align="left" rowspan="1" colspan="1">0.992</td>
              <td align="left" rowspan="1" colspan="1">0.544</td>
              <td align="left" rowspan="1" colspan="1">0.545</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">1M</td>
              <td align="left" rowspan="1" colspan="1">0.984</td>
              <td align="left" rowspan="1" colspan="1">0.987</td>
              <td align="left" rowspan="1" colspan="1">0.458</td>
              <td align="left" rowspan="1" colspan="1">0.460</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">2.5M</td>
              <td align="left" rowspan="1" colspan="1">0.972</td>
              <td align="left" rowspan="1" colspan="1">0.978</td>
              <td align="left" rowspan="1" colspan="1">0.338</td>
              <td align="left" rowspan="1" colspan="1">0.340</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">5M</td>
              <td align="left" rowspan="1" colspan="1">0.967</td>
              <td align="left" rowspan="1" colspan="1">0.972</td>
              <td align="left" rowspan="1" colspan="1">0.263</td>
              <td align="left" rowspan="1" colspan="1">0.264</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">10M</td>
              <td align="left" rowspan="1" colspan="1">0.964</td>
              <td align="left" rowspan="1" colspan="1">0.969</td>
              <td align="left" rowspan="1" colspan="1">0.219</td>
              <td align="left" rowspan="1" colspan="1">0.220</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">20M</td>
              <td align="left" rowspan="1" colspan="1">0.964</td>
              <td align="left" rowspan="1" colspan="1">0.968</td>
              <td align="left" rowspan="1" colspan="1">0.176</td>
              <td align="left" rowspan="1" colspan="1">0.177</td>
            </tr>
            <tr>
              <td colspan="5" rowspan="1">Human</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">SRP025982 (11M)</td>
              <td align="left" rowspan="1" colspan="1">0.994</td>
              <td align="left" rowspan="1" colspan="1">0.994</td>
              <td align="left" rowspan="1" colspan="1">0.894</td>
              <td align="left" rowspan="1" colspan="1">0.894</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">HG00100 (20M)</td>
              <td align="left" rowspan="1" colspan="1">0.983</td>
              <td align="left" rowspan="1" colspan="1">0.983</td>
              <td align="left" rowspan="1" colspan="1">0.261</td>
              <td align="left" rowspan="1" colspan="1">0.261</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Simulated 20M</td>
              <td align="left" rowspan="1" colspan="1">0.973</td>
              <td align="left" rowspan="1" colspan="1">0.976</td>
              <td align="left" rowspan="1" colspan="1">0.327</td>
              <td align="left" rowspan="1" colspan="1">0.328</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Simulated 40M</td>
              <td align="left" rowspan="1" colspan="1">0.972</td>
              <td align="left" rowspan="1" colspan="1">0.975</td>
              <td align="left" rowspan="1" colspan="1">0.319</td>
              <td align="left" rowspan="1" colspan="1">0.320</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
      <p>We also measure precision and recall in a way that takes pairing into account: for each aligned pair, we seek a corresponding pair in the compressed file where both ends match their counterparts in terms of their genomic position and the positions of splice junctions. These results are shown in the right-hand columns of Table <xref ref-type="table" rid="tbl5">5</xref> (labeled ‘Including pairings’). Here precision and recall are lower, with most samples ranging from 17.6 to 54.5%. Note that the SEQC sample, SRP025982, exhibited higher unpaired precision and recall than the others (99.4%) and much higher than the others when considering pairing (89.4%). This is likely due to the smaller number of reads in the sample relative to the other human samples, and to the much larger number of Boiler buckets induced by that sample. The larger number of buckets is likely owing to the presence of Universal Human Reference RNA, in which many genes are expressed.</p>
      <p>We also measure genomic outer distance distribution (excluding unbundled alignments) before and after Boiler compression. We find they match closely (Figure <xref ref-type="fig" rid="F4">4</xref>, left) though not perfectly (Figure <xref ref-type="fig" rid="F4">4</xref>, right). The results are emblematic of Boiler's strategy: aggregate distributions are preserved, but links between particular alignments and particular points in the distribution are lost. As a result, some data is ‘shuffled;’ ends themselves are largely unchanged, but pairings between ends are shuffled in a way that preserves the aggregate genomic outer distance distribution.</p>
      <fig id="F4" orientation="portrait" position="float">
        <label>Figure 4.</label>
        <caption>
          <p>Comparison of genomic outer distances for the 10M paired-end <italic>Drosophila melanogaster</italic> sample. Left: frequency ratio of each genomics outer distance, compressed divided by original, up to a distance of 100 000 bases. Right: original and compressed genomic outer distances between 70 and 79 kilobases in length.</p>
        </caption>
        <graphic xlink:href="gkw540fig4"/>
      </fig>
      <p>We repeated these experiments for alignments output by HISAT, as discussed in Supplementary Note 7. The results are similar to those produced by TopHat 2, with precision and recall ranging from 96.7 to 99.3% when ignoring pairings, and from 14 to 32.1% when considering pairings.</p>
    </sec>
    <sec id="SEC3-4">
      <title>Isoform fidelity</title>
      <p>Having established Boiler's lossy-ness and shuffling behavior, we now assess the degree to which loss and shuffling have an adverse effect on downstream results obtained by Cufflinks v2.2.1 and StringTie v1.2.2. StringTie was run with default parameters. Cufflinks was run with the <monospace>- -no-effective-length-correction</monospace> parameter to avoid variability due to an issue (recently resolved) in how Cufflinks performs effective transcript length correction (<ext-link ext-link-type="uri" xlink:href="https://github.com/cole-trapnell-lab/cufflinks/pull/32">https://github.com/cole-trapnell-lab/cufflinks/pull/32</ext-link>).</p>
      <p>Let <italic>T</italic> be the true simulated transcriptome, including abundances for each transcript, which we extract from the Flux-generated <monospace>.pro</monospace> and <monospace>.gtf</monospace> files. Let <inline-formula><tex-math id="M6">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\hat{T}$\end{document}</tex-math></inline-formula> be the transcriptome assembled and quantified from the original alignments, which we extract from the Cufflinks/StringTie output. Let <inline-formula><tex-math id="M7">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\hat{T}^{\prime }$\end{document}</tex-math></inline-formula> be the same but for the Boiler-compressed alignments. Here we ask whether <inline-formula><tex-math id="M8">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\hat{T}$\end{document}</tex-math></inline-formula> and <inline-formula><tex-math id="M9">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\hat{T}^{\prime }$\end{document}</tex-math></inline-formula> are approximately equidistant from <italic>T</italic>, indicating Boiler's loss and shuffling are not having an adverse effect.</p>
      <p>We define a function for measuring the distance between two transcripts <italic>t</italic><sub>1</sub> and <italic>t</italic><sub>2</sub> assembled with respect to a reference genome. The function outputs a value between 0 and 1, with 0 indicating the transcripts do not match and 1 indicating a perfect match.</p>
      <p>A transcript <italic>t</italic> can be represented as a set of exons {<italic>e</italic><sub>1</sub>, ...<italic>e</italic><sub><italic>n</italic></sub>}, each defined by its start and stop positions. We first define a scoring function for two exons <italic>e</italic><sub>1</sub> = (<italic>x</italic><sub>1</sub>, <italic>y</italic><sub>1</sub>) and <italic>e</italic><sub>2</sub> = (<italic>x</italic><sub>2</sub>, <italic>y</italic><sub>2</sub>):
<disp-formula id="M1"><label>(1)</label><tex-math id="M10">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}\begin{equation*} s(e_1,e_2) = 1 - \frac{min(|x_2 - x_1|, k)}{2k} - \frac{min(|y_2-y_1|, k)}{2k} \end{equation*}\end{document}</tex-math></disp-formula></p>
      <p>for some threshold <italic>k</italic>. We further define function <inline-formula><tex-math id="M11">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$max(e, \hat{t})$\end{document}</tex-math></inline-formula> to be the set <inline-formula><tex-math id="M12">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\hat{E}$\end{document}</tex-math></inline-formula> of exons <inline-formula><tex-math id="M13">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\hat{e}$\end{document}</tex-math></inline-formula> from <inline-formula><tex-math id="M14">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\hat{t}$\end{document}</tex-math></inline-formula> with maximal score <inline-formula><tex-math id="M15">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$s(e, \hat{e})$\end{document}</tex-math></inline-formula>.</p>
      <p>
        <inline-graphic xlink:href="gkw540ufig1.jpg"/>
      </p>
      <p>The weighted precision for pre-compression alignments is:
<disp-formula id="M2"><label>(2)</label><tex-math id="M16">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}\begin{equation*} \sum _{\hat{t} \in \hat{T}} \max _{t \in T} \left( score(\hat{t},t) \right) \cdot c(\hat{t}) \end{equation*}\end{document}</tex-math></disp-formula>
Where <inline-formula><tex-math id="M17">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$c(\hat{t})$\end{document}</tex-math></inline-formula> is the predicted coverage level of <italic>t</italic> as reported by Cufflinks/StringTie. This measure is weighted both by the coverage of the assembled transcript and by the similarity of the matched-up transcripts. Precision for the post-compression alignments is calculated similarly, using <inline-formula><tex-math id="M18">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\hat{T}^{\prime }$\end{document}</tex-math></inline-formula> instead of <inline-formula><tex-math id="M19">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\hat{T}$\end{document}</tex-math></inline-formula>.</p>
      <p>Similarly, weighted recall is
<disp-formula id="M3"><label>(3)</label><tex-math id="M20">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}\begin{equation*} \sum _{t \in T} \max _{\hat{t} \in \hat{T}} \left( score(t,\hat{t}) \right) \cdot c(t) \end{equation*}\end{document}</tex-math></disp-formula>
Where <italic>c</italic>(<italic>t</italic>) is the true coverage level for <italic>t</italic> as reported by Flux.</p>
      <p>We used a threshold of <italic>k</italic> = 10 for the exon scoring function (<xref ref-type="disp-formula" rid="M1">1</xref>). The selection of <italic>k</italic> = 10 is discussed in Supplementary Note 6. We calculated the weighted precision (Table <xref ref-type="table" rid="tbl6">6</xref>) and recall (Table <xref ref-type="table" rid="tbl7">7</xref>) for all simulated samples. While there are small differences in all experiments (as expected due to Boiler's shuffling behavior) overall Boiler compression does not have a substantial adverse impact on weighted precision and recall.</p>
      <table-wrap id="tbl6" orientation="portrait" position="float">
        <label>Table 6.</label>
        <caption>
          <title>Reference-based precision</title>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <th align="left" rowspan="1" colspan="1">Dataset</th>
              <th colspan="2" align="center" rowspan="1">TopHat + cufflinks</th>
              <th colspan="2" align="center" rowspan="1">TopHat + StringTie</th>
              <th colspan="2" align="center" rowspan="1">HISAT + StringTie</th>
            </tr>
            <tr>
              <th align="left" rowspan="1" colspan="1"/>
              <th align="left" rowspan="1" colspan="1">Original</th>
              <th align="left" rowspan="1" colspan="1">Compressed</th>
              <th align="left" rowspan="1" colspan="1">Original</th>
              <th align="left" rowspan="1" colspan="1">Compressed</th>
              <th align="left" rowspan="1" colspan="1">Original</th>
              <th align="left" rowspan="1" colspan="1">Compressed</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td colspan="7" rowspan="1"><italic>Drosophila</italic>, simulated unpaired</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">0.5M</td>
              <td align="left" rowspan="1" colspan="1">0.364</td>
              <td align="left" rowspan="1" colspan="1">0.364 (+0.1%)</td>
              <td align="left" rowspan="1" colspan="1">0.466</td>
              <td align="left" rowspan="1" colspan="1">0.466 (+0.0%)</td>
              <td align="left" rowspan="1" colspan="1">0.542</td>
              <td align="left" rowspan="1" colspan="1">0.542 (+0.0%)</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">1M</td>
              <td align="left" rowspan="1" colspan="1">0.432</td>
              <td align="left" rowspan="1" colspan="1">0.434 (+0.3%)</td>
              <td align="left" rowspan="1" colspan="1">0.545</td>
              <td align="left" rowspan="1" colspan="1">0.545 (+0.0%)</td>
              <td align="left" rowspan="1" colspan="1">0.611</td>
              <td align="left" rowspan="1" colspan="1">0.611 (+0.0%)</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">2.5M</td>
              <td align="left" rowspan="1" colspan="1">0.527</td>
              <td align="left" rowspan="1" colspan="1">0.527 (+0.1%)</td>
              <td align="left" rowspan="1" colspan="1">0.627</td>
              <td align="left" rowspan="1" colspan="1">0.627 (+0.0%)</td>
              <td align="left" rowspan="1" colspan="1">0.646</td>
              <td align="left" rowspan="1" colspan="1">0.542 (−0.7%)</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">5M</td>
              <td align="left" rowspan="1" colspan="1">0.564</td>
              <td align="left" rowspan="1" colspan="1">0.564 (+0.1%)</td>
              <td align="left" rowspan="1" colspan="1">0.637</td>
              <td align="left" rowspan="1" colspan="1">0.637 (−0.0%)</td>
              <td align="left" rowspan="1" colspan="1">0.644</td>
              <td align="left" rowspan="1" colspan="1">0.641 (−0.5%)</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">10M</td>
              <td align="left" rowspan="1" colspan="1">0.583</td>
              <td align="left" rowspan="1" colspan="1">0.585 (+0.2%)</td>
              <td align="left" rowspan="1" colspan="1">0.645</td>
              <td align="left" rowspan="1" colspan="1">0.645 (+0.0%)</td>
              <td align="left" rowspan="1" colspan="1">0.639</td>
              <td align="left" rowspan="1" colspan="1">0.637 (−0.3%)</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">20M</td>
              <td align="left" rowspan="1" colspan="1">0.602</td>
              <td align="left" rowspan="1" colspan="1">0.603 (+0.2%)</td>
              <td align="left" rowspan="1" colspan="1">0.654</td>
              <td align="left" rowspan="1" colspan="1">0.653 (−0.1%)</td>
              <td align="left" rowspan="1" colspan="1">0.642</td>
              <td align="left" rowspan="1" colspan="1">0.638 (−0.6%)</td>
            </tr>
            <tr>
              <td colspan="7" rowspan="1"><italic>Drosophila</italic>, simulated paired</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">0.5M</td>
              <td align="left" rowspan="1" colspan="1">0.583</td>
              <td align="left" rowspan="1" colspan="1">0.582 (−0.1%)</td>
              <td align="left" rowspan="1" colspan="1">0.546</td>
              <td align="left" rowspan="1" colspan="1">0.546 (−0.0%)</td>
              <td align="left" rowspan="1" colspan="1">0.628</td>
              <td align="left" rowspan="1" colspan="1">0.628 (−0.0%)</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">1M</td>
              <td align="left" rowspan="1" colspan="1">0.611</td>
              <td align="left" rowspan="1" colspan="1">0.609 (−0.3%)</td>
              <td align="left" rowspan="1" colspan="1">0.614</td>
              <td align="left" rowspan="1" colspan="1">0.613 (−0.1%)</td>
              <td align="left" rowspan="1" colspan="1">0.660</td>
              <td align="left" rowspan="1" colspan="1">0.660 (−0.0%)</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">2.5M</td>
              <td align="left" rowspan="1" colspan="1">0.632</td>
              <td align="left" rowspan="1" colspan="1">0.630 (−0.4%)</td>
              <td align="left" rowspan="1" colspan="1">0.644</td>
              <td align="left" rowspan="1" colspan="1">0.643 (−0.2%)</td>
              <td align="left" rowspan="1" colspan="1">0.666</td>
              <td align="left" rowspan="1" colspan="1">0.665 (−0.2%)</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">5M</td>
              <td align="left" rowspan="1" colspan="1">0.635</td>
              <td align="left" rowspan="1" colspan="1">0.633 (−0.3%)</td>
              <td align="left" rowspan="1" colspan="1">0.652</td>
              <td align="left" rowspan="1" colspan="1">0.652 (−0.1%)</td>
              <td align="left" rowspan="1" colspan="1">0.662</td>
              <td align="left" rowspan="1" colspan="1">0.661 (−0.2%)</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">10M</td>
              <td align="left" rowspan="1" colspan="1">0.644</td>
              <td align="left" rowspan="1" colspan="1">0.643 (−0.1%)</td>
              <td align="left" rowspan="1" colspan="1">0.663</td>
              <td align="left" rowspan="1" colspan="1">0.662 (−0.1%)</td>
              <td align="left" rowspan="1" colspan="1">0.666</td>
              <td align="left" rowspan="1" colspan="1">0.665 (−0.1%)</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">20M</td>
              <td align="left" rowspan="1" colspan="1">0.639</td>
              <td align="left" rowspan="1" colspan="1">0.634 (−0.8%)</td>
              <td align="left" rowspan="1" colspan="1">0.660</td>
              <td align="left" rowspan="1" colspan="1">0.659 (−0.2%)</td>
              <td align="left" rowspan="1" colspan="1">0.660</td>
              <td align="left" rowspan="1" colspan="1">0.657 (−0.4%)</td>
            </tr>
            <tr>
              <td colspan="7" rowspan="1">Human, simulated paired</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">20M</td>
              <td align="left" rowspan="1" colspan="1">0.552</td>
              <td align="left" rowspan="1" colspan="1">0.554 (+0.4%)</td>
              <td align="left" rowspan="1" colspan="1">0.570</td>
              <td align="left" rowspan="1" colspan="1">0.568 (−0.4%)</td>
              <td align="left" rowspan="1" colspan="1">0.613</td>
              <td align="left" rowspan="1" colspan="1">0.613 (−0.1%)</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">40M</td>
              <td align="left" rowspan="1" colspan="1">0.554</td>
              <td align="left" rowspan="1" colspan="1">0.555 (+0.2%)</td>
              <td align="left" rowspan="1" colspan="1">0.576</td>
              <td align="left" rowspan="1" colspan="1">0.572 (−0.6%)</td>
              <td align="left" rowspan="1" colspan="1">0.614</td>
              <td align="left" rowspan="1" colspan="1">0.615 (+0.1%)</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
      <table-wrap id="tbl7" orientation="portrait" position="float">
        <label>Table 7.</label>
        <caption>
          <title>Reference-based Recall</title>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <th align="left" rowspan="1" colspan="1">Dataset</th>
              <th colspan="2" align="center" rowspan="1">Cufflinks</th>
              <th colspan="2" align="center" rowspan="1">StringTie</th>
              <th colspan="2" align="center" rowspan="1">HISAT + StringTie</th>
            </tr>
            <tr>
              <th align="left" rowspan="1" colspan="1"/>
              <th align="left" rowspan="1" colspan="1">Original</th>
              <th align="left" rowspan="1" colspan="1">Compressed</th>
              <th align="left" rowspan="1" colspan="1">Original</th>
              <th align="left" rowspan="1" colspan="1">Compressed</th>
              <th align="left" rowspan="1" colspan="1">Original</th>
              <th align="left" rowspan="1" colspan="1">Compressed</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td colspan="7" rowspan="1">Drosophila, Simulated Unpaired</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">0.5M</td>
              <td align="left" rowspan="1" colspan="1">0.583</td>
              <td align="left" rowspan="1" colspan="1">0.583 (+0.0%)</td>
              <td align="left" rowspan="1" colspan="1">0.526</td>
              <td align="left" rowspan="1" colspan="1">0.526 (+0.0%)</td>
              <td align="left" rowspan="1" colspan="1">0.551</td>
              <td align="left" rowspan="1" colspan="1">0.551 (+0.0%)</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">1M</td>
              <td align="left" rowspan="1" colspan="1">0.708</td>
              <td align="left" rowspan="1" colspan="1">0.707 (−0.1%)</td>
              <td align="left" rowspan="1" colspan="1">0.682</td>
              <td align="left" rowspan="1" colspan="1">0.682 (+0.0%)</td>
              <td align="left" rowspan="1" colspan="1">0.712</td>
              <td align="left" rowspan="1" colspan="1">0.712 (+0.0%)</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">2.5M</td>
              <td align="left" rowspan="1" colspan="1">0.791</td>
              <td align="left" rowspan="1" colspan="1">0.785 (−0.7%)</td>
              <td align="left" rowspan="1" colspan="1">0.795</td>
              <td align="left" rowspan="1" colspan="1">0.795 (−0.0%)</td>
              <td align="left" rowspan="1" colspan="1">0.803</td>
              <td align="left" rowspan="1" colspan="1">0.800 (−0.4%)</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">5M</td>
              <td align="left" rowspan="1" colspan="1">0.822</td>
              <td align="left" rowspan="1" colspan="1">0.822 (+0.0%)</td>
              <td align="left" rowspan="1" colspan="1">0.834</td>
              <td align="left" rowspan="1" colspan="1">0.834 (−0.0%)</td>
              <td align="left" rowspan="1" colspan="1">0.833</td>
              <td align="left" rowspan="1" colspan="1">0.831 (−0.3%)</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">10M</td>
              <td align="left" rowspan="1" colspan="1">0.824</td>
              <td align="left" rowspan="1" colspan="1">0.824 (+0.0%)</td>
              <td align="left" rowspan="1" colspan="1">0.844</td>
              <td align="left" rowspan="1" colspan="1">0.844 (+0.0%)</td>
              <td align="left" rowspan="1" colspan="1">0.835</td>
              <td align="left" rowspan="1" colspan="1">0.834 (−0.2%)</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">20M</td>
              <td align="left" rowspan="1" colspan="1">0.827</td>
              <td align="left" rowspan="1" colspan="1">0.826 (−0.1%)</td>
              <td align="left" rowspan="1" colspan="1">0.851</td>
              <td align="left" rowspan="1" colspan="1">0.850 (−0.1%)</td>
              <td align="left" rowspan="1" colspan="1">0.853</td>
              <td align="left" rowspan="1" colspan="1">0.847 (−0.7%)</td>
            </tr>
            <tr>
              <td colspan="7" rowspan="1"><italic>Drosophila</italic>, simulated paired</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">0.5M</td>
              <td align="left" rowspan="1" colspan="1">0.732</td>
              <td align="left" rowspan="1" colspan="1">0.729 (−0.4%)</td>
              <td align="left" rowspan="1" colspan="1">0.691</td>
              <td align="left" rowspan="1" colspan="1">0.689 (−0.3%)</td>
              <td align="left" rowspan="1" colspan="1">0.715</td>
              <td align="left" rowspan="1" colspan="1">0.715 (−0.1%)</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">1M</td>
              <td align="left" rowspan="1" colspan="1">0.799</td>
              <td align="left" rowspan="1" colspan="1">0.797 (−0.2%)</td>
              <td align="left" rowspan="1" colspan="1">0.792</td>
              <td align="left" rowspan="1" colspan="1">0.791 (−0.1%)</td>
              <td align="left" rowspan="1" colspan="1">0.814</td>
              <td align="left" rowspan="1" colspan="1">0.814 (−0.0%)</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">2.5M</td>
              <td align="left" rowspan="1" colspan="1">0.825</td>
              <td align="left" rowspan="1" colspan="1">0.826 (+0.1%)</td>
              <td align="left" rowspan="1" colspan="1">0.840</td>
              <td align="left" rowspan="1" colspan="1">0.840 (−0.0%)</td>
              <td align="left" rowspan="1" colspan="1">0.843</td>
              <td align="left" rowspan="1" colspan="1">0.840 (−0.4%)</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">5M</td>
              <td align="left" rowspan="1" colspan="1">0.840</td>
              <td align="left" rowspan="1" colspan="1">0.838 (−0.2%)</td>
              <td align="left" rowspan="1" colspan="1">0.857</td>
              <td align="left" rowspan="1" colspan="1">0.855 (−0.2%)</td>
              <td align="left" rowspan="1" colspan="1">0.861</td>
              <td align="left" rowspan="1" colspan="1">0.859 (−0.3%)</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">10M</td>
              <td align="left" rowspan="1" colspan="1">0.828</td>
              <td align="left" rowspan="1" colspan="1">0.824 (−0.5%)</td>
              <td align="left" rowspan="1" colspan="1">0.851</td>
              <td align="left" rowspan="1" colspan="1">0.851 (−0.0%)</td>
              <td align="left" rowspan="1" colspan="1">0.851</td>
              <td align="left" rowspan="1" colspan="1">0.849 (−0.3%)</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">20M</td>
              <td align="left" rowspan="1" colspan="1">0.826</td>
              <td align="left" rowspan="1" colspan="1">0.823 (−0.4%)</td>
              <td align="left" rowspan="1" colspan="1">0.850</td>
              <td align="left" rowspan="1" colspan="1">0.849 (−0.1%)</td>
              <td align="left" rowspan="1" colspan="1">0.854</td>
              <td align="left" rowspan="1" colspan="1">0.849 (−0.6%)</td>
            </tr>
            <tr>
              <td colspan="7" rowspan="1">Human, simulated paired</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">20M</td>
              <td align="left" rowspan="1" colspan="1">0.762</td>
              <td align="left" rowspan="1" colspan="1">0.762 (+0.0%)</td>
              <td align="left" rowspan="1" colspan="1">0.794</td>
              <td align="left" rowspan="1" colspan="1">0.792 (−0.2%)</td>
              <td align="left" rowspan="1" colspan="1">0.851</td>
              <td align="left" rowspan="1" colspan="1">0.850 (−0.1%)</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">40M</td>
              <td align="left" rowspan="1" colspan="1">0.792</td>
              <td align="left" rowspan="1" colspan="1">0.789 (−0.3%)</td>
              <td align="left" rowspan="1" colspan="1">0.824</td>
              <td align="left" rowspan="1" colspan="1">0.821 (−0.4%)</td>
              <td align="left" rowspan="1" colspan="1">0.851</td>
              <td align="left" rowspan="1" colspan="1">0.849 (−0.2%)</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
    </sec>
    <sec id="SEC3-5">
      <title>Other isoform fidelity scores</title>
      <p>Supplementary Note 9 describes a complementary experiment using weighted k-mer recall, which does not depend on a distance function. Supplementary Note 10 describes a third accuracy measure called the Tripartite Score, which uses the same distance, but can compare two assembled transcriptomes to a third ‘reference’ transcriptome. The results from those methods substantially agree with the results above.</p>
    </sec>
    <sec id="SEC3-6">
      <title>Shuffling relative to technical replicates</title>
      <p>Next we investigate the amount of ‘shuffling’ introduced by Boiler—causing some reads to shift along the genome and scrambling some paired-end relationships—and whether the effect is large or small compared to the shuffling that occurs when switching from one technical replicate to another.</p>
      <p>We first construct five artificial technical replicates by generating five times the desired number of reads with Flux Simulator and randomly partitioning the resulting read file five ways. We then assemble and quantify each using Cufflinks and StringTie. Let <inline-formula><tex-math id="M21">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\hat{T}_1$\end{document}</tex-math></inline-formula>, <inline-formula><tex-math id="M22">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\hat{T}_2$\end{document}</tex-math></inline-formula>, ..., <inline-formula><tex-math id="M23">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\hat{T}_5$\end{document}</tex-math></inline-formula> be the corresponding transcriptomes. We also pick a technical replicate (<inline-formula><tex-math id="M24">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\hat{T}_1$\end{document}</tex-math></inline-formula>, say) to compress with Boiler. Let <inline-formula><tex-math id="M25">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\hat{T}^{\prime }_1$\end{document}</tex-math></inline-formula> be the result of running Cufflinks/StringTie on the Boiler-compressed alignments. We calculate the weighted precision and recall of <inline-formula><tex-math id="M26">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\hat{T}^{\prime }_1$\end{document}</tex-math></inline-formula> relative to <inline-formula><tex-math id="M27">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\hat{T}_1$\end{document}</tex-math></inline-formula>. Finally, we calculate weighted precisions and recalls between all 10 unordered pairs of technical-replicate transcriptomes: <inline-formula><tex-math id="M28">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$(\hat{T}_1, \hat{T}_2), (\hat{T}_1, \hat{T}_3), ..., (\hat{T}_4, \hat{T}_5)$\end{document}</tex-math></inline-formula>. Results are presented in Tables <xref ref-type="table" rid="tbl8">8</xref> and <xref ref-type="table" rid="tbl9">9</xref>. Precision and recall between technical replicates is shown as a range from the minimum to the maximum observed among the 10 ordered pairs. Precision and recall after Boiler-compression are consistently higher than precision and recall between technical replicates, indicating that shuffling due to Boiler compression is less consequential than shuffling due to technical variation.</p>
      <table-wrap id="tbl8" orientation="portrait" position="float">
        <label>Table 8.</label>
        <caption>
          <title>Non-reference-based precision</title>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <th align="left" rowspan="1" colspan="1">Dataset</th>
              <th colspan="2" align="center" rowspan="1">Cufflinks</th>
              <th colspan="2" align="center" rowspan="1">StringTie</th>
            </tr>
            <tr>
              <th align="left" rowspan="1" colspan="1"/>
              <th align="left" rowspan="1" colspan="1">Boiler</th>
              <th align="left" rowspan="1" colspan="1">Tech Reps</th>
              <th align="left" rowspan="1" colspan="1">Boiler</th>
              <th align="left" rowspan="1" colspan="1">Tech Reps</th>
            </tr>
            <tr>
              <th align="left" rowspan="1" colspan="1"/>
              <th align="left" rowspan="1" colspan="1"/>
              <th align="left" rowspan="1" colspan="1">(min–max)</th>
              <th align="left" rowspan="1" colspan="1"/>
              <th align="left" rowspan="1" colspan="1">(min–max)</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td colspan="5" rowspan="1"><italic>Drosophila</italic>, simulated unpaired</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">0.5M</td>
              <td align="left" rowspan="1" colspan="1">0.997</td>
              <td align="left" rowspan="1" colspan="1">0.386–0.396</td>
              <td align="left" rowspan="1" colspan="1">0.998</td>
              <td align="left" rowspan="1" colspan="1">0.452–0.470</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">1M</td>
              <td align="left" rowspan="1" colspan="1">0.996</td>
              <td align="left" rowspan="1" colspan="1">0.492–0.502</td>
              <td align="left" rowspan="1" colspan="1">0.998</td>
              <td align="left" rowspan="1" colspan="1">0.559–0.578</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">2.5M</td>
              <td align="left" rowspan="1" colspan="1">0.989</td>
              <td align="left" rowspan="1" colspan="1">0.659–0.669</td>
              <td align="left" rowspan="1" colspan="1">0.993</td>
              <td align="left" rowspan="1" colspan="1">0.729–0.736</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">5M</td>
              <td align="left" rowspan="1" colspan="1">0.988</td>
              <td align="left" rowspan="1" colspan="1">0.757–0.763</td>
              <td align="left" rowspan="1" colspan="1">0.989</td>
              <td align="left" rowspan="1" colspan="1">0.807–0.816</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">10M</td>
              <td align="left" rowspan="1" colspan="1">0.983</td>
              <td align="left" rowspan="1" colspan="1">0.814–0.824</td>
              <td align="left" rowspan="1" colspan="1">0.985</td>
              <td align="left" rowspan="1" colspan="1">0.854–0.863</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">20M</td>
              <td align="left" rowspan="1" colspan="1">0.980</td>
              <td align="left" rowspan="1" colspan="1">0.861–0.868</td>
              <td align="left" rowspan="1" colspan="1">0.983</td>
              <td align="left" rowspan="1" colspan="1">0.892–0.900</td>
            </tr>
            <tr>
              <td colspan="5" rowspan="1"><italic>Drosophila</italic>, simulated paired</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">0.5M</td>
              <td align="left" rowspan="1" colspan="1">0.986</td>
              <td align="left" rowspan="1" colspan="1">0.618–0.636</td>
              <td align="left" rowspan="1" colspan="1">1.000</td>
              <td align="left" rowspan="1" colspan="1">0.568–0.583</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">1M</td>
              <td align="left" rowspan="1" colspan="1">0.980</td>
              <td align="left" rowspan="1" colspan="1">0.724–0.733</td>
              <td align="left" rowspan="1" colspan="1">0.996</td>
              <td align="left" rowspan="1" colspan="1">0.698–0.706</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">2.5M</td>
              <td align="left" rowspan="1" colspan="1">0.965</td>
              <td align="left" rowspan="1" colspan="1">0.806–0.811</td>
              <td align="left" rowspan="1" colspan="1">0.989</td>
              <td align="left" rowspan="1" colspan="1">0.807–0.815</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">5M</td>
              <td align="left" rowspan="1" colspan="1">0.969</td>
              <td align="left" rowspan="1" colspan="1">0.843–0.850</td>
              <td align="left" rowspan="1" colspan="1">0.991</td>
              <td align="left" rowspan="1" colspan="1">0.854–0.862</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">10M</td>
              <td align="left" rowspan="1" colspan="1">0.960</td>
              <td align="left" rowspan="1" colspan="1">0.867–0.879</td>
              <td align="left" rowspan="1" colspan="1">0.986</td>
              <td align="left" rowspan="1" colspan="1">0.890–0.895</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">20M</td>
              <td align="left" rowspan="1" colspan="1">0.952</td>
              <td align="left" rowspan="1" colspan="1">0.893–0.902</td>
              <td align="left" rowspan="1" colspan="1">0.985</td>
              <td align="left" rowspan="1" colspan="1">0.915–0.921</td>
            </tr>
            <tr>
              <td colspan="5" rowspan="1">Human</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">SRP025982 (11M)</td>
              <td align="left" rowspan="1" colspan="1">0.964</td>
              <td align="left" rowspan="1" colspan="1">0.627–0.645</td>
              <td align="left" rowspan="1" colspan="1">0.997</td>
              <td align="left" rowspan="1" colspan="1">0.622–0.641</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">HG00100 (20M)</td>
              <td align="left" rowspan="1" colspan="1">0.939</td>
              <td align="left" rowspan="1" colspan="1">(no replicates)</td>
              <td align="left" rowspan="1" colspan="1">0.997</td>
              <td align="left" rowspan="1" colspan="1">(no replicates)</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Simulated 20M</td>
              <td align="left" rowspan="1" colspan="1">0.969</td>
              <td align="left" rowspan="1" colspan="1">0.897–0.912</td>
              <td align="left" rowspan="1" colspan="1">0.981</td>
              <td align="left" rowspan="1" colspan="1">0.910–0.932</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Simulated 40M</td>
              <td align="left" rowspan="1" colspan="1">0.965</td>
              <td align="left" rowspan="1" colspan="1">0.911–0.927</td>
              <td align="left" rowspan="1" colspan="1">0.976</td>
              <td align="left" rowspan="1" colspan="1">0.935–0.947</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <fn id="TFN007">
            <p>Columns labeled Boiler compare precision before and after Boiler compression. Columns labeled Tech Reps compare pairs of technical replicates.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
      <table-wrap id="tbl9" orientation="portrait" position="float">
        <label>Table 9.</label>
        <caption>
          <title>Non-reference-based recall</title>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <th align="left" rowspan="1" colspan="1">Dataset</th>
              <th colspan="2" align="center" rowspan="1">Cufflinks</th>
              <th colspan="2" align="center" rowspan="1">StringTie</th>
            </tr>
            <tr>
              <th align="left" rowspan="1" colspan="1"/>
              <th align="left" rowspan="1" colspan="1">Boiler</th>
              <th align="left" rowspan="1" colspan="1">Tech Reps</th>
              <th align="left" rowspan="1" colspan="1">Boiler</th>
              <th align="left" rowspan="1" colspan="1">Tech Reps</th>
            </tr>
            <tr>
              <th align="left" rowspan="1" colspan="1"/>
              <th align="left" rowspan="1" colspan="1"/>
              <th align="left" rowspan="1" colspan="1">(min–max)</th>
              <th align="left" rowspan="1" colspan="1"/>
              <th align="left" rowspan="1" colspan="1">(min–max)</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td colspan="5" rowspan="1"><italic>Drosophila</italic>, simulated unpaired</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">0.5M</td>
              <td align="left" rowspan="1" colspan="1">0.996</td>
              <td align="left" rowspan="1" colspan="1">0.386–0.396</td>
              <td align="left" rowspan="1" colspan="1">0.998</td>
              <td align="left" rowspan="1" colspan="1">0.428–0.441</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">1M</td>
              <td align="left" rowspan="1" colspan="1">0.993</td>
              <td align="left" rowspan="1" colspan="1">0.492–0.502</td>
              <td align="left" rowspan="1" colspan="1">0.998</td>
              <td align="left" rowspan="1" colspan="1">0.528–0.549</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">2.5M</td>
              <td align="left" rowspan="1" colspan="1">0.989</td>
              <td align="left" rowspan="1" colspan="1">0.659–0.669</td>
              <td align="left" rowspan="1" colspan="1">0.993</td>
              <td align="left" rowspan="1" colspan="1">0.708–0.716</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">5M</td>
              <td align="left" rowspan="1" colspan="1">0.988</td>
              <td align="left" rowspan="1" colspan="1">0.757–763</td>
              <td align="left" rowspan="1" colspan="1">0.989</td>
              <td align="left" rowspan="1" colspan="1">0.789–0.799</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">10M</td>
              <td align="left" rowspan="1" colspan="1">0.983</td>
              <td align="left" rowspan="1" colspan="1">0.814–0.824</td>
              <td align="left" rowspan="1" colspan="1">0.985</td>
              <td align="left" rowspan="1" colspan="1">0.843–0.851</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">20M</td>
              <td align="left" rowspan="1" colspan="1">0.979</td>
              <td align="left" rowspan="1" colspan="1">0.861–0.868</td>
              <td align="left" rowspan="1" colspan="1">0.983</td>
              <td align="left" rowspan="1" colspan="1">0.892–0.900</td>
            </tr>
            <tr>
              <td colspan="5" rowspan="1"><italic>Drosophila</italic>, simulated paired</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">0.5M</td>
              <td align="left" rowspan="1" colspan="1">0.985</td>
              <td align="left" rowspan="1" colspan="1">0.618–0.636</td>
              <td align="left" rowspan="1" colspan="1">0.999</td>
              <td align="left" rowspan="1" colspan="1">0.568–0.583</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">1M</td>
              <td align="left" rowspan="1" colspan="1">0.981</td>
              <td align="left" rowspan="1" colspan="1">0.724–0.733</td>
              <td align="left" rowspan="1" colspan="1">0.996</td>
              <td align="left" rowspan="1" colspan="1">0.698–0.706</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">2.5M</td>
              <td align="left" rowspan="1" colspan="1">0.970</td>
              <td align="left" rowspan="1" colspan="1">0.806–0.811</td>
              <td align="left" rowspan="1" colspan="1">0.991</td>
              <td align="left" rowspan="1" colspan="1">0.807–0.815</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">5M</td>
              <td align="left" rowspan="1" colspan="1">0.971</td>
              <td align="left" rowspan="1" colspan="1">0.843–0.850</td>
              <td align="left" rowspan="1" colspan="1">0.991</td>
              <td align="left" rowspan="1" colspan="1">0.854–0.862</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">10M</td>
              <td align="left" rowspan="1" colspan="1">0.957</td>
              <td align="left" rowspan="1" colspan="1">0.867–0.879</td>
              <td align="left" rowspan="1" colspan="1">0.986</td>
              <td align="left" rowspan="1" colspan="1">0.890–0.895</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">20M</td>
              <td align="left" rowspan="1" colspan="1">0.949</td>
              <td align="left" rowspan="1" colspan="1">0.893–0.902</td>
              <td align="left" rowspan="1" colspan="1">0.985</td>
              <td align="left" rowspan="1" colspan="1">0.915–0.921</td>
            </tr>
            <tr>
              <td colspan="5" rowspan="1">Human</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">SRP025982 (11M)</td>
              <td align="left" rowspan="1" colspan="1">0.939</td>
              <td align="left" rowspan="1" colspan="1">0.627–0.645</td>
              <td align="left" rowspan="1" colspan="1">0.997</td>
              <td align="left" rowspan="1" colspan="1">0.622–0.641</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">HG00100 (20M)</td>
              <td align="left" rowspan="1" colspan="1">0.936</td>
              <td align="left" rowspan="1" colspan="1">(no replicates)</td>
              <td align="left" rowspan="1" colspan="1">0.995</td>
              <td align="left" rowspan="1" colspan="1">(no replicates)</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Simulated 20M</td>
              <td align="left" rowspan="1" colspan="1">0.967</td>
              <td align="left" rowspan="1" colspan="1">0.897–0.912</td>
              <td align="left" rowspan="1" colspan="1">0.981</td>
              <td align="left" rowspan="1" colspan="1">0.910–0.932</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Simulated 40M</td>
              <td align="left" rowspan="1" colspan="1">0.963</td>
              <td align="left" rowspan="1" colspan="1">0.911–0.927</td>
              <td align="left" rowspan="1" colspan="1">0.977</td>
              <td align="left" rowspan="1" colspan="1">0.935–0.947</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <fn id="TFN008">
            <p>Columns labeled Boiler compare recall before and after Boiler compression. Columns labeled Tech Reps compare pairs of technical replicates.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
      <p>For SRP025982, we followed the same process but using real lane-level technical replicates. The same sample was sequenced in 5 separate lanes of an Illumina instrument, but on the same flowcell. We compressed the first replicate (SRR1216073) with Boiler and used the four others (SRR1216076–SRR1216079) to calculate the ten pairwise precision and recall measures.</p>
      <p>It is notable how precision and recall change relative to per-sample coverage. Precision and recall between technical replicates increases as per-sample coverage increases, indicating that the shuffling effect decreases as more transcripts become deeply covered. On the other hand, precision and recall of <inline-formula><tex-math id="M29">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\hat{T}^{\prime }_1$\end{document}</tex-math></inline-formula> versus <inline-formula><tex-math id="M30">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\hat{T}_1$\end{document}</tex-math></inline-formula> decreases as per-sample coverage increases. Therefore, there may be higher levels of coverage for which Boiler shuffling has a greater impact than technical-replicate shuffling. For the realistic levels of coverage we tested, however, Boiler's shuffling remains less consequential.</p>
      <p>We also measured precision and recall in an unweighted fashion, i.e. omitting the coverage terms <italic>c</italic>(<italic>t</italic>) and <inline-formula><tex-math id="M31">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$c(\hat{t})$\end{document}</tex-math></inline-formula> from equations <xref ref-type="disp-formula" rid="M2">2</xref> and <xref ref-type="disp-formula" rid="M3">3</xref>. These results are similar to the weighted results as discussed in Supplementary Note 8.</p>
    </sec>
    <sec id="SEC3-7">
      <title>Queries</title>
      <p>Recovering coverage vectors from a Boiler-compressed file requires that Boiler decompress and combine coverage vectors for all the relevant bundles and buckets. Decompression of the coverage vector involves the DEFLATE algorithm and run-length decoding, but does not involve the more expensive read and pair recovery algorithms. SAMtools, on the other hand, does not explicitly represent the coverage vectors in a BAM file. Instead, coverage information must be recovered from the BAM file by first extracting the relevant alignments, then composing the coverage vector using another tool like BEDTools:</p>
      <p>
        <monospace>samtools view -b -h x.bam c:start-end | genomeCoverageBed -bga -split -ibam stdin -g chromosomes.txt</monospace>
      </p>
      <p>We compared the time required for Boiler to respond to coverage queries to the time required for SAMtools/BEDTools. Specifically, we iterated over all bundle boundaries in several <italic>D. melanogaster</italic> samples and queried for the coverage vector within those boundaries using both Boiler and SAMtools/BEDTools. Figure <xref ref-type="fig" rid="F5">5</xref> compares the tools both in terms of average query time (left) and per-bundle query time (right). As expected, Boiler is consistently faster than SAMtools/BEDTools, with Boiler taking under 0.1 s on average and SAMtools/BEDTools taking close to 0.75 s.</p>
      <fig id="F5" orientation="portrait" position="float">
        <label>Figure 5.</label>
        <caption>
          <p>Comparison of coverage query times for Boiler the indexed BAM for all bundles. Left: average query time for varying <italic>Drosophila melanogaster</italic> paired-end datasets. Right:<bold>r</bold>atio of Samtools/Boiler query time for each bundle in the 10M <italic>D. melanogaster</italic> paired-end dataset plotted as a function of bundle length. The blue line denotes the best fit line for the points, the red line is <italic>y</italic> = 1.</p>
        </caption>
        <graphic xlink:href="gkw540fig5"/>
      </fig>
      <p>We also compared alignment query times for Boiler to those for the indexed BAM. A SAMtools alignment query uses this command:</p>
      <p>
        <monospace>samtools view -h x.bam chrom:start-end</monospace>
      </p>
      <p>Boiler must both decompress the relevant bundles and run the greedy read and pair recovery algorithms. Figure <xref ref-type="fig" rid="F6">6</xref> compares the tools both in terms of average query time (left) and per-bundle query time (right). As expected, because of the need to run read and pair recovery, Boiler's alignment query is consistently slower than SAMtools. Even so, Boiler's average response time is under 0.15 s.</p>
      <fig id="F6" orientation="portrait" position="float">
        <label>Figure 6.</label>
        <caption>
          <p>Comparison of alignment query times for Boiler versus sorted and indexed BAM for all bundles. Left: average query time for varying <italic>Drosophila melanogaster</italic> paired-end datasets. Right: ratio of Samtools/Boiler query time for each bundle in the 10M <italic>D. melanogaster</italic> paired-end dataset plotted as a function of bundle length. The blue line denotes the best fit line for the points, the red line is <italic>y</italic> = 1.</p>
        </caption>
        <graphic xlink:href="gkw540fig6"/>
      </fig>
    </sec>
  </sec>
  <sec sec-type="discussion" id="SEC4">
    <title>DISCUSSION</title>
    <p>Boiler applies principles of lossy compression and transform coding to the problem of compressing RNA-seq alignments. Beyond discarding unnecessary BAM attributes, Boiler additionally discards most of the data that ties individual reads to their aligned positions and shapes. Boiler instead stores coverage vectors and read- and outer-distance tallies, effective shifting from the ‘alignment domain’ to the ‘coverage domain.’ While this can cause alignments to shift along the genome or pair with the wrong mate, the shuffling effect is modest compared to the shuffling induced by switching between technical replicates and adverse effects on downstream tools for isoform assembly and quantification are minimal.</p>
    <p>Boiler is not a general-purpose substitute for RNA-seq SAM/BAM files, but it is an extremely space-efficient alternative that works well with tools like Cufflinks and StringTie. RNA-seq alignments are much larger than downstream files summarizing coverage (BigWig) or per-isoform expression level (FPKM table). Boiler and BigWig are similar in size, but, importantly, Boiler files preserve the ability to re-run the analysis repeatedly in the future. This can profoundly reduce the cost and difficulty of working with RNA-seq data, especially for large datasets.</p>
    <p>Though we have not explored it here, we expect Boiler compression to work well with annotation-based tools like featureCounts (<xref rid="B22" ref-type="bibr">22</xref>) and HiTseq (<xref rid="B23" ref-type="bibr">23</xref>), as well as downstream differential-expression tools like derfinder (<xref rid="B24" ref-type="bibr">24</xref>) that rely on counts and coverage values.</p>
    <p>Boiler also discards information about non-reference alleles, making Boiler archives readily sharable even when the input data is protected by privacy provisions like dbGaP.</p>
    <p>In future work, it will be important to explore alternatives to the greedy decompression algorithms described here. For example, Boiler's greedy algorithm for extracting reads from a coverage distribution assumes the distribution of input read lengths has a dominant mode. This is a reasonable assumption for Illumina data, but not so for other sequencing technologies. Also, Boiler's compression and decompression algorithms could be accelerated by moving from Python to a compiled language such as C/C++. In general, there are many opportunities to make the read extraction and pairing algorithms more accurate, faster and less hampered by assumptions about the data.</p>
    <p>Another subject for future work is how Boiler represents multi-mapping alignments. By discarding read names, Boiler discards the one-to-many relationship between a multi-mapping read and its alignments. While this does not harm fidelity in most cases, it does adversely affect fidelity when Cufflinks is used to quantify from a gene annotation. It is an open question as to whether and how multi-mapping relationships can be represented in a way that allows trading off between compression ratio and fidelity.</p>
    <p>Finally, we note that the methods used here to characterize Boiler's shuffling effect are more generally useful for evaluating any upstream tool that modifies the data. For example, one could apply the same techniques to evaluate a tool for read trimming or digital normalization, or to compare many parameterizations of the spliced aligner.</p>
    <p>Boiler is available from <ext-link ext-link-type="uri" xlink:href="http://github.com/jpritt/boiler"><monospace>github.com/jpritt/boiler</monospace></ext-link> and is distributed under the open source MIT license.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="PMC_1" content-type="local-data">
      <caption>
        <title>SUPPLEMENTARY DATA</title>
      </caption>
      <media mimetype="text" mime-subtype="html" xlink:href="supp_44_16_e133__index.html"/>
      <media xlink:role="associated-file" mimetype="application" mime-subtype="pdf" xlink:href="supp_gkw540_nar-00651-met-n-2016-File009.pdf"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <p>We are grateful to Abhinav Nellore and Chris Wilks for their comments on the software and manuscript. We are also grateful to Fabien Campagne for his comments on the manuscript.</p>
  </ack>
  <sec id="SEC5">
    <title>SUPPLEMENTARY DATA</title>
    <p><ext-link ext-link-type="uri" xlink:href="http://nar.oxfordjournals.org/lookup/suppl/doi:10.1093/nar/gkw540/-/DC1">Supplementary Data</ext-link> are available at NAR Online.</p>
  </sec>
  <sec id="SEC6">
    <title>FUNDING</title>
    <p>Sloan Research Fellowship (to J.P., BL. in part); National Science Foundation (NSF) [IIS-1349906 to B.L., in part]; National Institute of General Medical Sciences [1R01GM118568 to B.L.]. Funding for open access charge: NSF.</p>
    <p><italic>Conflict of interest statement</italic>. None declared.</p>
  </sec>
  <ref-list>
    <title>REFERENCES</title>
    <ref id="B1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>H.</given-names>
          </name>
          <name>
            <surname>Handsaker</surname>
            <given-names>B.</given-names>
          </name>
          <name>
            <surname>Wysoker</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Fennell</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Ruan</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Homer</surname>
            <given-names>N.</given-names>
          </name>
          <name>
            <surname>Marth</surname>
            <given-names>G.</given-names>
          </name>
          <name>
            <surname>Abecases</surname>
            <given-names>G.</given-names>
          </name>
          <name>
            <surname>Durbin</surname>
            <given-names>R.</given-names>
          </name>
        </person-group>
        <article-title>The sequence alignment/map format and SAMtools</article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>25</volume>
        <fpage>2078</fpage>
        <lpage>2079</lpage>
        <pub-id pub-id-type="pmid">19505943</pub-id>
      </element-citation>
    </ref>
    <ref id="B2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stephens</surname>
            <given-names>Z.D.</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>S.Y.</given-names>
          </name>
          <name>
            <surname>Faghri</surname>
            <given-names>F.</given-names>
          </name>
          <name>
            <surname>Campbell</surname>
            <given-names>R.H.</given-names>
          </name>
          <name>
            <surname>Zhai</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Efron</surname>
            <given-names>M.J.</given-names>
          </name>
          <name>
            <surname>Iyer</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Schatz</surname>
            <given-names>M.C.</given-names>
          </name>
          <name>
            <surname>Sinha</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Robinson</surname>
            <given-names>G.E.</given-names>
          </name>
        </person-group>
        <article-title>Big Data: astronomical or genomical?</article-title>
        <source>PLoS Biol.</source>
        <year>2015</year>
        <volume>13</volume>
        <fpage>e1002195</fpage>
        <pub-id pub-id-type="pmid">26151137</pub-id>
      </element-citation>
    </ref>
    <ref id="B3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Leinonen</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Sugawara</surname>
            <given-names>H.</given-names>
          </name>
          <name>
            <surname>Shumway</surname>
            <given-names>M.</given-names>
          </name>
        </person-group>
        <article-title>The sequence read archive</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2011</year>
        <volume>39</volume>
        <issue>Suppl. 1</issue>
        <fpage>D19</fpage>
        <lpage>D21</lpage>
        <pub-id pub-id-type="pmid">21062823</pub-id>
      </element-citation>
    </ref>
    <ref id="B4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ardlie</surname>
            <given-names>K.G.</given-names>
          </name>
          <name>
            <surname>Deluca</surname>
            <given-names>D.S.</given-names>
          </name>
          <name>
            <surname>Segrè</surname>
            <given-names>A.V.</given-names>
          </name>
          <name>
            <surname>Sullivan</surname>
            <given-names>T.J.</given-names>
          </name>
          <name>
            <surname>Young</surname>
            <given-names>T.R.</given-names>
          </name>
          <name>
            <surname>Gelfand</surname>
            <given-names>E.T.</given-names>
          </name>
          <name>
            <surname>Trowbridge</surname>
            <given-names>C.A.</given-names>
          </name>
          <name>
            <surname>Maller</surname>
            <given-names>J.B.</given-names>
          </name>
          <name>
            <surname>Tukiainen</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Lek</surname>
            <given-names>M.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The Genotype-Tissue Expression (GTEx) pilot analysis: Multitissue gene regulation in humans</article-title>
        <source>Science</source>
        <year>2015</year>
        <volume>348</volume>
        <fpage>648</fpage>
        <lpage>660</lpage>
        <pub-id pub-id-type="pmid">25954001</pub-id>
      </element-citation>
    </ref>
    <ref id="B5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lappalainen</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Sammeth</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Friedländer</surname>
            <given-names>M.R.</given-names>
          </name>
          <name>
            <surname>AC't Hoen</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Monlong</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Rivas</surname>
            <given-names>M.A.</given-names>
          </name>
          <name>
            <surname>Gonzàlez-Porta</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Kurbatova</surname>
            <given-names>N.</given-names>
          </name>
          <name>
            <surname>Griebel</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Ferreira</surname>
            <given-names>P.G.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Transcriptome and genome sequencing uncovers functional variation in humans</article-title>
        <source>Nature</source>
        <year>2013</year>
        <volume>501</volume>
        <fpage>506</fpage>
        <lpage>511</lpage>
        <pub-id pub-id-type="pmid">24037378</pub-id>
      </element-citation>
    </ref>
    <ref id="B6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hsi-Yang</surname>
            <given-names>F.M.</given-names>
          </name>
          <name>
            <surname>Leinonen</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Cochrane</surname>
            <given-names>G.</given-names>
          </name>
          <name>
            <surname>Birney</surname>
            <given-names>E.</given-names>
          </name>
        </person-group>
        <article-title>Efficient storage of high throughput DNA sequencing data using reference-based compression</article-title>
        <source>Genome Res.</source>
        <year>2011</year>
        <volume>5</volume>
        <fpage>734</fpage>
        <lpage>740</lpage>
      </element-citation>
    </ref>
    <ref id="B7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Popitsch</surname>
            <given-names>N.</given-names>
          </name>
          <name>
            <surname>von Haeseler</surname>
            <given-names>A.</given-names>
          </name>
        </person-group>
        <article-title>NGC: lossless and lossy compression of aligned high-throughput sequencing data</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2013</year>
        <volume>41</volume>
        <fpage>e27</fpage>
        <pub-id pub-id-type="pmid">23066097</pub-id>
      </element-citation>
    </ref>
    <ref id="B8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Campagne</surname>
            <given-names>F.</given-names>
          </name>
          <name>
            <surname>Dorff</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Chambwe</surname>
            <given-names>N.</given-names>
          </name>
          <name>
            <surname>Robinson</surname>
            <given-names>J.T.</given-names>
          </name>
          <name>
            <surname>Mesirov</surname>
            <given-names>J.P.</given-names>
          </name>
        </person-group>
        <article-title>Compression of structured high-throughput sequencing data</article-title>
        <source>PLoS One</source>
        <year>2013</year>
        <volume>8</volume>
        <fpage>e79871</fpage>
        <pub-id pub-id-type="pmid">24260313</pub-id>
      </element-citation>
    </ref>
    <ref id="B9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Filippova</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Kingsford</surname>
            <given-names>C.</given-names>
          </name>
        </person-group>
        <article-title>Rapid, separable compression enables fast analyses of sequence alignments</article-title>
        <source>ACM Conf. Bioinform.</source>
        <year>2015</year>
        <fpage>194</fpage>
        <lpage>201</lpage>
      </element-citation>
    </ref>
    <ref id="B10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Daily</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Rigor</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Christley</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Xie</surname>
            <given-names>X.</given-names>
          </name>
          <name>
            <surname>Baldi</surname>
            <given-names>P.</given-names>
          </name>
        </person-group>
        <article-title>Data structures and compression algorithms for high-throughput sequencing technologies</article-title>
        <source>BMC Bioinform.</source>
        <year>2010</year>
        <volume>11</volume>
        <fpage>514</fpage>
      </element-citation>
    </ref>
    <ref id="B11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kozanitis</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Saunders</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Kruglyak</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Bafna</surname>
            <given-names>V.</given-names>
          </name>
          <name>
            <surname>Varghese</surname>
            <given-names>G.</given-names>
          </name>
        </person-group>
        <article-title>Compressing genomic sequence fragments using SlimGene</article-title>
        <source>J. Comput. Biol.</source>
        <year>2011</year>
        <volume>18</volume>
        <fpage>401</fpage>
        <lpage>413</lpage>
        <pub-id pub-id-type="pmid">21385043</pub-id>
      </element-citation>
    </ref>
    <ref id="B12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jones</surname>
            <given-names>D.C.</given-names>
          </name>
          <name>
            <surname>Ruzzo</surname>
            <given-names>W.L.</given-names>
          </name>
          <name>
            <surname>Peng</surname>
            <given-names>X.</given-names>
          </name>
          <name>
            <surname>Katze</surname>
            <given-names>M.G.</given-names>
          </name>
        </person-group>
        <article-title>Compression of next-generation sequencing reads aided by highly efficient de novo assembly</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2012</year>
        <volume>40</volume>
        <fpage>e171</fpage>
        <pub-id pub-id-type="pmid">22904078</pub-id>
      </element-citation>
    </ref>
    <ref id="B13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Trapnell</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Williams</surname>
            <given-names>B.</given-names>
          </name>
          <name>
            <surname>Pertea</surname>
            <given-names>G.</given-names>
          </name>
          <name>
            <surname>Mortazavi</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Kwan</surname>
            <given-names>G.</given-names>
          </name>
          <name>
            <surname>van Baren</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Salzberg</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Wold</surname>
            <given-names>B.</given-names>
          </name>
          <name>
            <surname>Pachter</surname>
            <given-names>L.</given-names>
          </name>
        </person-group>
        <article-title>Transcript assembly and quantification by RNA-Seq reveals unannotated transcripts and isoform switching during cell differentiation</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2010</year>
        <volume>28</volume>
        <fpage>511</fpage>
        <lpage>515</lpage>
        <pub-id pub-id-type="pmid">20436464</pub-id>
      </element-citation>
    </ref>
    <ref id="B14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pertea</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Pertea</surname>
            <given-names>G.M.</given-names>
          </name>
          <name>
            <surname>Antonescu</surname>
            <given-names>C.M.</given-names>
          </name>
          <name>
            <surname>Chang</surname>
            <given-names>T.S.</given-names>
          </name>
          <name>
            <surname>Mendell</surname>
            <given-names>J.T.</given-names>
          </name>
          <name>
            <surname>Salzberg</surname>
            <given-names>S.L.</given-names>
          </name>
        </person-group>
        <article-title>StringTie enables improved reconstruction of a transcriptome from RNA-seq reads</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2015</year>
        <volume>33</volume>
        <fpage>290</fpage>
        <lpage>295</lpage>
        <pub-id pub-id-type="pmid">25690850</pub-id>
      </element-citation>
    </ref>
    <ref id="B15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kim</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Langmead</surname>
            <given-names>B.</given-names>
          </name>
          <name>
            <surname>Salzberg</surname>
            <given-names>S.L.</given-names>
          </name>
        </person-group>
        <article-title>HISAT: a fast spliced aligner with low memory requirements</article-title>
        <source>Nat. Methods</source>
        <year>2013</year>
        <volume>12</volume>
        <fpage>357</fpage>
        <lpage>360</lpage>
        <pub-id pub-id-type="pmid">25751142</pub-id>
      </element-citation>
    </ref>
    <ref id="B16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kim</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Pertea</surname>
            <given-names>G.</given-names>
          </name>
          <name>
            <surname>Trapnell</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Pimentel</surname>
            <given-names>H.</given-names>
          </name>
          <name>
            <surname>Kelley</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Salzberg</surname>
            <given-names>S.L.</given-names>
          </name>
        </person-group>
        <article-title>TopHat2: accurate alignment of transcriptomes in the presence of insertions, deletions and gene fusions</article-title>
        <source>Genome Biol.</source>
        <year>2013</year>
        <volume>14</volume>
        <fpage>R36</fpage>
        <pub-id pub-id-type="pmid">23618408</pub-id>
      </element-citation>
    </ref>
    <ref id="B17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Griebel</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Zacher</surname>
            <given-names>B.</given-names>
          </name>
          <name>
            <surname>Ribeca</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Raineri</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Lacroix</surname>
            <given-names>V.</given-names>
          </name>
          <name>
            <surname>Guigó</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Sammeth</surname>
            <given-names>M.</given-names>
          </name>
        </person-group>
        <article-title>Modelling and simulating generic RNA-Seq experiments with the flux simulator</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2012</year>
        <volume>40</volume>
        <fpage>10073</fpage>
        <lpage>10083</lpage>
        <pub-id pub-id-type="pmid">22962361</pub-id>
      </element-citation>
    </ref>
    <ref id="B18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yates</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Akanni</surname>
            <given-names>W.</given-names>
          </name>
          <name>
            <surname>Amode</surname>
            <given-names>M.R.</given-names>
          </name>
          <name>
            <surname>Barrell</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Billis</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Carvalho-Silva</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Cummins</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Clapham</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Fitzgerald</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Gil</surname>
            <given-names>L.</given-names>
          </name>
        </person-group>
        <article-title>Ensembl 2016</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2015</year>
        <volume>44</volume>
        <fpage>D710</fpage>
        <lpage>D716</lpage>
        <pub-id pub-id-type="pmid">26687719</pub-id>
      </element-citation>
    </ref>
    <ref id="B19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Harrow</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Frankish</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Gonzalez</surname>
            <given-names>J.M.</given-names>
          </name>
          <name>
            <surname>Tapanari</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Diekhans</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Kokocinski</surname>
            <given-names>F.</given-names>
          </name>
          <name>
            <surname>Aken</surname>
            <given-names>B.L.</given-names>
          </name>
          <name>
            <surname>Barrell</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Zadissa</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Searle</surname>
            <given-names>S.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>GENCODE: the reference human genome annotation for The ENCODE Project</article-title>
        <source>Genome Res.</source>
        <year>2012</year>
        <volume>22</volume>
        <fpage>1760</fpage>
        <lpage>1774</lpage>
        <pub-id pub-id-type="pmid">22955987</pub-id>
      </element-citation>
    </ref>
    <ref id="B20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <collab>SEQC/MAQC-III Consortium</collab>
        <article-title>A comprehensive assessment of RNA-seq accuracy, reproducibility and information content by the Sequencing Quality Control Consortium</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2014</year>
        <volume>32</volume>
        <fpage>903</fpage>
        <lpage>914</lpage>
        <pub-id pub-id-type="pmid">25150838</pub-id>
      </element-citation>
    </ref>
    <ref id="B21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kent</surname>
            <given-names>W.J.</given-names>
          </name>
          <name>
            <surname>Zweig</surname>
            <given-names>A.S.</given-names>
          </name>
          <name>
            <surname>Barber</surname>
            <given-names>G.</given-names>
          </name>
          <name>
            <surname>Hinrichs</surname>
            <given-names>A.S.</given-names>
          </name>
          <name>
            <surname>Karolchik</surname>
            <given-names>D.</given-names>
          </name>
        </person-group>
        <article-title>BigWig and BigBed: enabling browsing of large distributed datasets</article-title>
        <source>Bioinformatics</source>
        <year>2010</year>
        <volume>26</volume>
        <fpage>2204</fpage>
        <lpage>2207</lpage>
        <pub-id pub-id-type="pmid">20639541</pub-id>
      </element-citation>
    </ref>
    <ref id="B22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liao</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Smyth</surname>
            <given-names>G.K.</given-names>
          </name>
          <name>
            <surname>Shi</surname>
            <given-names>W.</given-names>
          </name>
        </person-group>
        <article-title>featureCounts: an efficient general purpose program for assigning sequence reads to genomic features</article-title>
        <source>Bioinformatics</source>
        <year>2014</year>
        <volume>30</volume>
        <fpage>923</fpage>
        <lpage>930</lpage>
        <pub-id pub-id-type="pmid">24227677</pub-id>
      </element-citation>
    </ref>
    <ref id="B23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Anders</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Pyl</surname>
            <given-names>P.T.</given-names>
          </name>
          <name>
            <surname>Huber</surname>
            <given-names>W.</given-names>
          </name>
        </person-group>
        <article-title>HTSeq–A Python framework to work with high-throughput sequencing data</article-title>
        <source>Bioinformatics</source>
        <year>2014</year>
        <volume>31</volume>
        <fpage>166</fpage>
        <lpage>169</lpage>
        <pub-id pub-id-type="pmid">25260700</pub-id>
      </element-citation>
    </ref>
    <ref id="B24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Frazee</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Sabunciyan</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Hansen</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Irizarry</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Leek</surname>
            <given-names>J.</given-names>
          </name>
        </person-group>
        <article-title>Differential expression analysis of RNA-seq data at single-base resolution</article-title>
        <source>Biostatistics</source>
        <year>2014</year>
        <volume>15</volume>
        <fpage>413</fpage>
        <lpage>426</lpage>
        <pub-id pub-id-type="pmid">24398039</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
