<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10169335</article-id>
    <article-id pub-id-type="publisher-id">5297</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-023-05297-x</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>HLA-Clus: HLA class I clustering based on 3D structure</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Shen</surname>
          <given-names>Yue</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Parks</surname>
          <given-names>Jerry M.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Smith</surname>
          <given-names>Jeremy C.</given-names>
        </name>
        <address>
          <email>smithjc@ornl.gov</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.411461.7</institution-id><institution-id institution-id-type="ISNI">0000 0001 2315 1184</institution-id><institution>Graduate School of Genome Science and Technology, </institution><institution>University of Tennessee, </institution></institution-wrap>Knoxville, TN 37996 USA </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.135519.a</institution-id><institution-id institution-id-type="ISNI">0000 0004 0446 2659</institution-id><institution>Biosciences Division, </institution><institution>Oak Ridge National Laboratory, </institution></institution-wrap>Oak Ridge, TN 37831 USA </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="GRID">grid.411461.7</institution-id><institution-id institution-id-type="ISNI">0000 0001 2315 1184</institution-id><institution>Department of Biochemistry and Cellular and Molecular Biology, </institution><institution>University of Tennessee, </institution></institution-wrap>Knoxville, TN 37996 USA </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>9</day>
      <month>5</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>9</day>
      <month>5</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2023</year>
    </pub-date>
    <volume>24</volume>
    <elocation-id>189</elocation-id>
    <history>
      <date date-type="received">
        <day>16</day>
        <month>1</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>18</day>
        <month>4</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold>This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">In a previous paper, we classified populated HLA class I alleles into supertypes and subtypes based on the similarity of 3D landscape of peptide binding grooves, using newly defined structure distance metric and hierarchical clustering approach. Compared to other approaches, our method achieves higher correlation with peptide binding specificity, intra-cluster similarity (cohesion), and robustness. Here we introduce HLA-Clus, a Python package for clustering HLA Class I alleles using the method we developed recently and describe additional features including a new nearest neighbor clustering method that facilitates clustering based on user-defined criteria.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">The HLA-Clus pipeline includes three stages: First, HLA Class I structural models are coarse grained and transformed into clouds of labeled points. Second, similarities between alleles are determined using a newly defined structure distance metric that accounts for spatial and physicochemical similarities. Finally, alleles are clustered via hierarchical or nearest-neighbor approaches. We also interfaced HLA-Clus with the peptide:HLA affinity predictor MHCnuggets. By using the nearest neighbor clustering method to select optimal allele-specific deep learning models in MHCnuggets, the average accuracy of peptide binding prediction of rare alleles was improved.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p id="Par3">The HLA-Clus package offers a solution for characterizing the peptide binding specificities of a large number of HLA alleles. This method can be applied in HLA functional studies, such as the development of peptide affinity predictors, disease association studies, and HLA matching for grafting. HLA-Clus is freely available at our GitHub repository (<ext-link ext-link-type="uri" xlink:href="https://github.com/yshen25/HLA-Clus">https://github.com/yshen25/HLA-Clus</ext-link>).</p>
      </sec>
      <sec>
        <title>Supplementary Information</title>
        <p>The online version contains supplementary material available at 10.1186/s12859-023-05297-x.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Human leukocyte antigen</kwd>
      <kwd>Protein structure</kwd>
      <kwd>Clustering</kwd>
      <kwd>Machine learning</kwd>
    </kwd-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© BioMed Central Ltd., part of Springer Nature 2023</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par10">Human leukocyte antigen (HLA) class I proteins, which include HLA-A, HLA-B, and HLA-C, play an essential role in the adaptive immune system by presenting intrinsic peptide antigens to CD8<sup>+</sup> T cells and eliciting a cytotoxic immune response [<xref ref-type="bibr" rid="CR1">1</xref>, <xref ref-type="bibr" rid="CR2">2</xref>]. The extreme functional polymorphism of HLA alleles complicates the investigation of these important macromolecules [<xref ref-type="bibr" rid="CR3">3</xref>] (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S1). To help disentangle this complex system of proteins, supertypes have been defined to include alleles that have similar peptide binding specificities [<xref ref-type="bibr" rid="CR4">4</xref>, <xref ref-type="bibr" rid="CR5">5</xref>]. Comprehensively determining peptide binding specificities using experimental methods requires exorbitant time and effort [<xref ref-type="bibr" rid="CR6">6</xref>–<xref ref-type="bibr" rid="CR8">8</xref>]. Thus, in silico methods have been developed as viable alternatives including affinity prediction-based [<xref ref-type="bibr" rid="CR9">9</xref>, <xref ref-type="bibr" rid="CR10">10</xref>], sequence-based [<xref ref-type="bibr" rid="CR11">11</xref>, <xref ref-type="bibr" rid="CR12">12</xref>], and structure-based methods [<xref ref-type="bibr" rid="CR13">13</xref>, <xref ref-type="bibr" rid="CR14">14</xref>]. Because function is determined by structure, the structure-based methods may provide advantages over sequence-based approaches. However, the accuracy and coverage of previous structure-based approaches has been limited by the lack of availability of high-quality structures, the performance of algorithms, and computational demand for the required analysis.</p>
    <p id="Par11">We recently presented an HLA class I structure-based supertype and subtype classification method that combines multiple targeted solutions [<xref ref-type="bibr" rid="CR15">15</xref>]. We briefly summarize the approach here. By using ColabFold [<xref ref-type="bibr" rid="CR16">16</xref>], a notebook-based implementation of AlphaFold2 [<xref ref-type="bibr" rid="CR17">17</xref>], high-quality HLA class I structures were generated. In addition, coarse graining of protein models was applied to reduce the computational cost of structural analyses and the impact of possibly inaccurate side chain positioning introduced by modeling. Inspired by the successful application of structural similarity in comparing small molecule binding pockets [<xref ref-type="bibr" rid="CR18">18</xref>–<xref ref-type="bibr" rid="CR21">21</xref>], a structure distance metric, SD<italic>,</italic> was adapted from the atom-level point cloud-based <italic>sup-CK</italic> algorithm [<xref ref-type="bibr" rid="CR21">21</xref>], which performs well in classification accuracy applied to binding pocket prediction. To incorporate physicochemical properties and the varied importance of specific HLA binding-site residues, we implemented a similarity matrix and weight factor, which improve the correlation between structural and functional similarity. Compared to previous clustering methods, our approach offers improved correlation with peptide binding specificity, intra-cluster similarity (cohesion), and cluster stability against random sampling (robustness).</p>
    <p id="Par12">Here we present a package, HLA-Clus, for clustering HLA class I alleles based on the method described above. HLA-Clus includes three major stages: structure processing, structure distance calculation, and clustering. First, the 3D HLA structures are processed into labeled point clouds. Then, the structural distances (SD) between alleles are calculated. Lastly, based on the pairwise SD matrix, alleles are clustered hierarchically using a complete linkage method. A nearest-neighbor clustering method is also available to allow new alleles to be easily incorporated into existing, predefined clusters.</p>
    <p id="Par13">As an example application, we interfaced HLA-Clus in the peptide:HLA affinity predictor, MHCnuggets, which employs allele-specific deep learning models. The affinity prediction of alleles lacking a corresponding deep learning model is achieved by selecting the closest prediction model, which is referred to as model selection, based on sequence-based allele similarity and model quality. Instead, we used HLA-Clus nearest neighbor clustering method in model selection. Compared to the default method, HLA-Clus improved the binding prediction accuracy and correlation with experimental affinity on tested alleles.</p>
    <p id="Par14">The pipeline is fully open source to enable easy use and modification by users. Recommended parameters are provided for rapid start-up. Although not demonstrated explicitly, this approach has the potential to be adapted to clustering of other classes of proteins based on structure distance metrics.</p>
  </sec>
  <sec id="Sec2">
    <title>Implementation</title>
    <sec id="Sec3">
      <title>Overview of structure-based HLA class I similarity measurement</title>
      <p id="Par15">The details of implemented methods have been described in detail previously [<xref ref-type="bibr" rid="CR15">15</xref>] but are briefly summarized here.</p>
      <p id="Par16">Similarity between alleles is measured by a newly defined structure distance metric, SD, which was adapted from the Sup-CK method [<xref ref-type="bibr" rid="CR21">21</xref>], a point cloud-based all-atom structure distance metric designed for comparing small molecule binding pockets. However, the high computational demand is a major issue when applying this method in HLA molecules. Furthermore, the Sup-CK requires a gradient ascent optimization to find the optimal relative orientation, which greatly increased the computational demand.</p>
      <p id="Par17">We modified the metric for use with coarse-grained models to improve calculation speed, incorporate weight factors representing the importance of each residue, and implement physicochemical similarity at the residue level. By coarse graining, the number of points in a structure is greatly decreased. Also, structure alignment was used to find the optimal relative orientation between HLAs, so that the gradient ascent optimization could be omitted. This is applicable because all HLA class I molecules are homologous with highly similar structures. In addition, Sup-CK uses a hard cutoff to determine the residues that contact the peptide, instead our method uses the weight factors as a soft threshold, which avoids the inaccuracy brought by falsely detected binding pocket.</p>
      <p id="Par18">The SD metric incorporates three components: spatial similarity, physicochemical similarity, and weight factor. First, the similarity K between two HLA proteins P1 and P2 is defined as:<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$K\left( {P1,\,P2} \right) = \mathop \sum \limits_{i \in P1} \mathop \sum \limits_{j \in P2} \sqrt {w_{i} w_{j} } \cdot S_{ij} \cdot \frac{1}{{{\text{cosh}}^{k} \left( {\sigma \cdot \left\| {x_{i} - x_{j} } \right\|} \right)}}$$\end{document}</tex-math><mml:math id="M2" display="block"><mml:mrow><mml:mi>K</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>P</mml:mi><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:mi>P</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mi>P</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:munder><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mi>P</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:munder><mml:msqrt><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>w</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msqrt><mml:mo>·</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>·</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msup><mml:mrow><mml:mtext>cosh</mml:mtext></mml:mrow><mml:mi>k</mml:mi></mml:msup><mml:mfenced close=")" open="("><mml:mrow><mml:mi>σ</mml:mi><mml:mo>·</mml:mo><mml:mfenced close="∥" open="∥"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:mrow></mml:mfrac></mml:mrow></mml:math><graphic xlink:href="12859_2023_5297_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par19">The spatial similarity is quantified by a kernel function that transforms the Euclidean distance between two pairs of residues x<sub>i</sub> and x<sub>j</sub> into a value between 0 and 1. The physicochemical similarity S<sub>ij</sub> between two residues is measured using a transformed Grantham distance [<xref ref-type="bibr" rid="CR22">22</xref>] matrix, which measures the physicochemical similarity between residues. The weight factors w<sub>i</sub> and w<sub>j</sub> were adapted from a previous study [<xref ref-type="bibr" rid="CR23">23</xref>] that indicated the relative importance of the position in determining peptide binding affinity.</p>
      <p id="Par20">To normalize the positive definite similarity measurement K, the structure distance metric (SD) was defined as:<disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$SD\left( {P1,\,P2} \right) = \sqrt {K\left( {P1,\,P1} \right) + K\left( {P2,\,P2} \right) - 2K\left( {P1,\,P2} \right)}$$\end{document}</tex-math><mml:math id="M4" display="block"><mml:mrow><mml:mi>S</mml:mi><mml:mi>D</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>P</mml:mi><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:mi>P</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:msqrt><mml:mrow><mml:mi>K</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>P</mml:mi><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:mi>P</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:mi>K</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>P</mml:mi><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:mi>P</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:mfenced><mml:mo>-</mml:mo><mml:mn>2</mml:mn><mml:mi>K</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>P</mml:mi><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:mi>P</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:mfenced></mml:mrow></mml:msqrt></mml:mrow></mml:math><graphic xlink:href="12859_2023_5297_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula></p>
      <sec id="Sec4">
        <title>Algorithm overview</title>
        <p id="Par21">We implemented the above-mentioned method in Python 3.8 with publicly available packages, including NumPy, SciPy, pandas, BioPandas, pymol-bundle, Biopython, matplotlib, seaborn, and scikit-learn. The source code is available in our GitHub repository [<xref ref-type="bibr" rid="CR24">24</xref>]. Users can install the package via pip or by cloning the repository. The method has three stages: structure processing, structure distance calculation, and clustering (Fig. <xref rid="Fig1" ref-type="fig">1</xref>). Example outputs are available as supplemental materials (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Tables S1–S4).<fig id="Fig1"><label>Fig. 1</label><caption><p>Flowchart of HLA-Clus clustering pipeline. <bold>a</bold> Figurative demonstration of input and output for each stage in the pipeline. <bold>b</bold> Schematic flowchart. The rectangles represent input and output files, while the blue parallelograms represent callable functions from HLA-Clus package. The stacked rectangle and numeral indicator (i) in file name illustrate that there are multiple files</p></caption><graphic xlink:href="12859_2023_5297_Fig1_HTML" id="MO1"/></fig></p>
      </sec>
      <sec id="Sec5">
        <title>Stage 1: HLA class I structure processing</title>
        <p id="Par22">The HLA-Clus package accepts 3D structures of HLA class I α chains as input. In the previous study we modeled 449 populated HLA class I alleles [<xref ref-type="bibr" rid="CR15">15</xref>]. The structures are available at [<xref ref-type="bibr" rid="CR25">25</xref>] for download and further investigation.</p>
        <sec id="Sec6">
          <title>Trim and align</title>
          <p id="Par23">The 3D structures are trimmed to include only the 179 residues that form the peptide binding domain (residues 2-180). The trimmed models are superimposed onto the structure of the peptide binding domain of the most studied allele HLA-A*02:01 (PDB ID: 1i4f).</p>
        </sec>
        <sec id="Sec7">
          <title>Coarse graining</title>
          <p id="Par24">The structures are coarse grained, with each residue represented by the center of mass of its side chain and the backbone atoms omitted. The coordinates and residue types are stored in a CSV file.</p>
        </sec>
        <sec id="Sec8">
          <title>Assigning weight factors</title>
          <p id="Par25">Weight factors, which were adapted from a previous study [<xref ref-type="bibr" rid="CR23">23</xref>], are assigned to residues by the position according to their relative importance in determining peptide binding specificity. The weight factors are recorded in the CSV files of coarse-grained structures and can be changed by passing a Python dictionary with the residue position as the key and the weight factor as the value.</p>
        </sec>
        <sec id="Sec9">
          <title>Processed HLA structure file</title>
          <p id="Par26">Processed HLA structures are stored in CSV files. Each file includes 179 rows and 7 columns. Each row corresponds to one residue, and the columns are chain identifier, residue number, residue name, Cartesian coordinates, and weight factor.</p>
        </sec>
      </sec>
      <sec id="Sec10">
        <title>Step 2: measuring similarity between alleles using structure distance (SD) metric</title>
        <p id="Par27">This step is the most time consuming in the HLA clustering pipeline, especially for the hierarchical clustering method, and so calculation speed has been optimized as follows. As the definition of SD suggests, the calculation of SD is split into two stages: the similarity score K and the structure distance SD. The similarity score K between a pair of alleles is split into three parts and calculated separately: spatial similarity, physicochemical similarity, and average weight factor. Then, the final result is generated with vectorized calculations.</p>
        <sec id="Sec11">
          <title>Spatial similarity</title>
          <p id="Par28">The spatial similarity is calculated according to the kernel function. The input is a 3D coordinates with shape (179, 3), and the result is a 2D matrix with shape (179, 179).</p>
        </sec>
        <sec id="Sec12">
          <title>Physicochemical similarity</title>
          <p id="Par29">The physicochemical similarity is derived by looking up values in the similarity matrix. The input is a (179, 1) NumPy array, and the result is a 2D matrix with shape (179, 179).</p>
        </sec>
        <sec id="Sec13">
          <title>Average weight factor</title>
          <p id="Par30">The average weight factor is the geometric mean of the weight factors of two compared residues and is calculated as the square root of the outer product of two weight factor NumPy arrays with shape (179, 1). The result is a 2D matrix with shape (179, 179).</p>
        </sec>
        <sec id="Sec14">
          <title>Calculation of structural similarity K</title>
          <p id="Par31">K is calculated as the grand sum of the element-wise product of the three matrices: spatial similarity, physicochemical similarity, and average weight factor.</p>
        </sec>
        <sec id="Sec15">
          <title>Calculation of structure distance SD</title>
          <p id="Par32">As shown in Eq. <xref rid="Equ2" ref-type="disp-formula">2</xref>, the calculation of SD(P1, P2) requires three components: K(P1, P1), K(P2, P2), and K(P1, P2). Because the self-similarity values (e.g., K(P1, P1)) are used multiple times and K(P1, P2) = K(P2, P1), the calculation process was optimized for efficiency.</p>
          <p id="Par33">In the hierarchical clustering mode, the SD matrix is calculated as follows:<list list-type="simple"><list-item><label>(i)</label><p id="Par34">The combination with repetition of query HLA alleles is generated, so that only one of K(P1, P2) and K(P2, P1) will be calculated.</p></list-item><list-item><label>(ii)</label><p id="Par35">The structural similarity K for each allele pair in the combination is calculated, and the values are stored in a Python dictionary.</p></list-item><list-item><label>(iii)</label><p id="Par36">Finally, the elements in the SD matrix are calculated by looking up K values in the dictionary. Because the SD matrix is symmetric about the diagonal, and the diagonal is always 0, only the upper triangular portion of the SD matrix is calculated.</p></list-item></list></p>
          <p id="Par37">In the nearest neighbor clustering mode, because the query and anchor alleles differ, the output SD matrix is not symmetric, and the similarity between two anchor alleles or two query alleles is not needed. Therefore the calculation of K is divided into two cases: the self-similarity (e.g., K(P1, P1)) and anchor-query similarity (e.g., K(P1, P2)). The anchor-query similarity is calculated according to the combination of anchor-query pairs without replacement. Both similarity values are stored in a Python dictionary. Finally, the SD matrix is calculated by looking up K values.</p>
          <p id="Par38">Besides the optimization of the calculation process, a multiprocessing method was implemented to improve calculation speed. In the calculation of structural similarities, the K value of each pair of alleles is calculated in parallel.</p>
        </sec>
      </sec>
      <sec id="Sec16">
        <title>Step 3: clustering of alleles based on SD</title>
        <p id="Par39">Two clustering methods are available. The hierarchical clustering method clusters all query alleles, while the nearest-neighbor clustering approach is used to cluster query alleles according to an existing or user-defined clustering scheme.</p>
        <sec id="Sec17">
          <title>Hierarchical clustering</title>
          <p id="Par40">The hierarchical clustering method first calculates the pairwise SD matrix between alleles to be clustered. Then, hierarchical clustering is performed with a user-defined number of clusters and linkage method.</p>
        </sec>
        <sec id="Sec18">
          <title>Nearest neighbor clustering</title>
          <p id="Par41">To use the nearest-neighbor approach, anchor alleles and corresponding clusters must be defined. An anchor allele is the structure used as a representative of a predefined cluster (Table <xref rid="Tab1" ref-type="table">1</xref>). For each query allele awaiting clustering, the SD to each anchor allele is calculated, and the query allele is assigned to the cluster represented by the nearest anchor allele.<table-wrap id="Tab1"><label>Table 1</label><caption><p>Default anchor alleles and corresponding supertypes/subtypes for nearest-neighbor clustering. The classification is derived from our previous study [<xref ref-type="bibr" rid="CR15">15</xref>]</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Anchor allele</th><th align="left">Subtype</th><th align="left">Supertype</th></tr></thead><tbody><tr><td align="left">HLA-A*01:01</td><td align="left">A01</td><td align="left" rowspan="5">A01-A03-A66</td></tr><tr><td align="left">HLA-A*03:01</td><td align="left" rowspan="3">A03</td></tr><tr><td align="left">HLA-A*11:01</td></tr><tr><td align="left">HLA-A*30:01</td></tr><tr><td align="left">HLA-A*66:01</td><td align="left">A66</td></tr><tr><td align="left">HLA-A*02:01</td><td align="left" rowspan="5">A02</td><td align="left" rowspan="5">A02</td></tr><tr><td align="left">HLA-A*02:03</td></tr><tr><td align="left">HLA-A*02:06</td></tr><tr><td align="left">HLA-A*02:07</td></tr><tr><td align="left">HLA-A*68:01</td></tr><tr><td align="left">HLA-A*24:02</td><td align="left">A24</td><td align="left">A24</td></tr><tr><td align="left">HLA-B*07:02</td><td align="left" rowspan="2">B07</td><td align="left" rowspan="3">B07-B35</td></tr><tr><td align="left">HLA-B*42:01</td></tr><tr><td align="left">HLA-B*35:01</td><td align="left">B35</td></tr><tr><td align="left">HLA-B*08:01</td><td align="left">B08</td><td align="left" rowspan="3">B08-B18-B39</td></tr><tr><td align="left">HLA-B*18:01</td><td align="left">B18</td></tr><tr><td align="left">HLA-B*39:01</td><td align="left">B39</td></tr><tr><td align="left">HLA-B*14:02</td><td align="left">B14</td><td align="left">B14</td></tr><tr><td align="left">HLA-B*15:01</td><td align="left" rowspan="2">B15</td><td align="left" rowspan="3">B15-B40</td></tr><tr><td align="left">HLA-B*40:02</td></tr><tr><td align="left">HLA-B*40:01</td><td align="left">B40</td></tr><tr><td align="left">HLA-B*27:05</td><td align="left">B27</td><td align="left">B27</td></tr><tr><td align="left">HLA-B*44:02</td><td align="left" rowspan="2">B44</td><td align="left" rowspan="2">B44</td></tr><tr><td align="left">HLA-B*44:03</td></tr><tr><td align="left">HLA-B*51:01</td><td align="left">B51</td><td align="left" rowspan="3">B51-B58</td></tr><tr><td align="left">HLA-B*57:01</td><td align="left" rowspan="2">B58</td></tr><tr><td align="left">HLA-B*58:01</td></tr><tr><td align="left">HLA-C*04:01</td><td align="left" rowspan="3">C01</td><td align="left" rowspan="5">C01-C02</td></tr><tr><td align="left">HLA-C*05:01</td></tr><tr><td align="left">HLA-C*08:02</td></tr><tr><td align="left">HLA-B*46:01</td><td align="left" rowspan="2">C02</td></tr><tr><td align="left">HLA-C*06:02</td></tr><tr><td align="left">HLA-C*07:01</td><td align="left">C07</td><td align="left">C07</td></tr></tbody></table></table-wrap></p>
        </sec>
      </sec>
      <sec id="Sec19">
        <title>Choice of optimal number of clusters (N) for hierarchical clustering</title>
        <p id="Par42">To select the optimal number of clusters, the elbow method and silhouette method have been implemented. First, hierarchical clustering is performed given multiple consecutive numbers of clusters (N) and then the sum of squared errors (SSE) and the silhouette coefficient (SC) are calculated for each clustering result.</p>
        <p id="Par43">The SSE is defined as the sum of distances between alleles and corresponding cluster centers, which is conventionally the average of cluster members. However, for a precomputed pairwise distance matrix, this average is not preferred because it may be unphysical. Therefore, we instead use cluster centroids, which are calculated as:<disp-formula id="Equa"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$SSE = \mathop \sum \limits_{C} \mathop \sum \limits_{i \in C} SD\left( {i,\,centroid\left( C \right)} \right)$$\end{document}</tex-math><mml:math id="M6" display="block"><mml:mrow><mml:mi>S</mml:mi><mml:mi>S</mml:mi><mml:mi>E</mml:mi><mml:mo>=</mml:mo><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mi>C</mml:mi></mml:munder><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:munder><mml:mi>S</mml:mi><mml:mi>D</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:mi>c</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>o</mml:mi><mml:mi>i</mml:mi><mml:mi>d</mml:mi><mml:mfenced close=")" open="("><mml:mi>C</mml:mi></mml:mfenced></mml:mrow></mml:mfenced></mml:mrow></mml:math><graphic xlink:href="12859_2023_5297_Article_Equa.gif" position="anchor"/></alternatives></disp-formula></p>
        <p id="Par44">The silhouette coefficients are calculated in several steps. First, for each allele <italic>i</italic> that belongs to cluster <italic>C</italic>, the average distance to all other alleles in the same cluster is defined as:<disp-formula id="Equb"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$a\left( i \right) = \left\{ {\begin{array}{*{20}l} {\frac{1}{size\left( C \right) - 1}} \hfill &amp; {\mathop \sum \limits_{i,j \in C, i \ne j} distance\left( {i,j} \right), \,size\left( C \right) &gt; 1} \hfill \\ {0,} \hfill &amp; {size\left( C \right) = 1} \hfill \\ \end{array} } \right.$$\end{document}</tex-math><mml:math id="M8" display="block"><mml:mrow><mml:mi>a</mml:mi><mml:mfenced close=")" open="("><mml:mi>i</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:mfenced open="{"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>z</mml:mi><mml:mi>e</mml:mi><mml:mfenced close=")" open="("><mml:mi>C</mml:mi></mml:mfenced><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac></mml:mtd><mml:mtd><mml:mrow><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>≠</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>c</mml:mi><mml:mi>e</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:mfenced><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>z</mml:mi><mml:mi>e</mml:mi><mml:mfenced close=")" open="("><mml:mi>C</mml:mi></mml:mfenced><mml:mo>&gt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>z</mml:mi><mml:mi>e</mml:mi><mml:mfenced close=")" open="("><mml:mi>C</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mrow></mml:math><graphic xlink:href="12859_2023_5297_Article_Equb.gif" position="anchor"/></alternatives></disp-formula></p>
        <p id="Par45">Next, the average distance to the closest neighboring cluster <italic>D</italic> for each allele <italic>i</italic> is defined as:<disp-formula id="Equc"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$b\left( i \right) = \mathop {\min }\limits_{C \ne D} \frac{1}{size\left( D \right)}\mathop \sum \limits_{k \in D} distance\left( {i,k} \right)$$\end{document}</tex-math><mml:math id="M10" display="block"><mml:mrow><mml:mi>b</mml:mi><mml:mfenced close=")" open="("><mml:mi>i</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:munder><mml:mo movablelimits="false">min</mml:mo><mml:mrow><mml:mi>C</mml:mi><mml:mo>≠</mml:mo><mml:mi>D</mml:mi></mml:mrow></mml:munder><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>z</mml:mi><mml:mi>e</mml:mi><mml:mfenced close=")" open="("><mml:mi>D</mml:mi></mml:mfenced></mml:mrow></mml:mfrac><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>∈</mml:mo><mml:mi>D</mml:mi></mml:mrow></mml:munder><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>c</mml:mi><mml:mi>e</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:math><graphic xlink:href="12859_2023_5297_Article_Equc.gif" position="anchor"/></alternatives></disp-formula></p>
        <p id="Par46">Lastly, the SC for the clustering result with <italic>n</italic> samples is calculated using the following equation:<disp-formula id="Equd"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$SC = \frac{1}{n}\mathop \sum \limits_{i}^{N} \frac{b\left( i \right) - a\left( a \right)}{{\max \left( {a\left( i \right),b\left( i \right)} \right)}}$$\end{document}</tex-math><mml:math id="M12" display="block"><mml:mrow><mml:mi>S</mml:mi><mml:mi>C</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>n</mml:mi></mml:mfrac><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:mfrac><mml:mrow><mml:mi>b</mml:mi><mml:mfenced close=")" open="("><mml:mi>i</mml:mi></mml:mfenced><mml:mo>-</mml:mo><mml:mi>a</mml:mi><mml:mfenced close=")" open="("><mml:mi>a</mml:mi></mml:mfenced></mml:mrow><mml:mrow><mml:mo movablelimits="true">max</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mi>a</mml:mi><mml:mfenced close=")" open="("><mml:mi>i</mml:mi></mml:mfenced><mml:mo>,</mml:mo><mml:mi>b</mml:mi><mml:mfenced close=")" open="("><mml:mi>i</mml:mi></mml:mfenced></mml:mrow></mml:mfenced></mml:mrow></mml:mfrac></mml:mrow></mml:math><graphic xlink:href="12859_2023_5297_Article_Equd.gif" position="anchor"/></alternatives></disp-formula></p>
        <p id="Par47">The elbow plot (SSE vs N) and silhouette plot (SC vs N) are generated using the Matplotlib library. The optimal value of N can be selected from elbow points (i.e., the inflection point) of the SSE curve or the peaks (i.e., local maxima) of the silhouette curve.</p>
      </sec>
      <sec id="Sec20">
        <title>Test example: model selection for MHCnuggets using HLA-Clus nearest-neighbor clustering</title>
        <p id="Par48">To demonstrate the application of HLA-Clus in characterizing similarities between HLA alleles, we implemented our nearest-neighbor clustering approach in the MHCnuggets pipeline. The peptide:MHC affinity predictor MHCnuggets [<xref ref-type="bibr" rid="CR26">26</xref>] includes allele-specific deep learning models for 102 classical HLA class I alleles. However, affinity prediction for rare alleles lacking a corresponding deep learning model is performed by using the model of the closest well-characterized allele. This procedure is referred to as model selection. Thus, the predictive performance of MHCnuggets on rare alleles is determined by the quality of both the deep learning-based affinity prediction model and the model selection algorithm. We implemented HLA-Clus to replace the default model selection in MHCnuggets and compared its performance to the default algorithm.</p>
        <p id="Par49">The default algorithm was assessed previously by the authors using a leave-one-molecule-out (LOMO) test. In the original LOMO test protocol, 20 well characterized alleles were chosen as pseudo-rare alleles (“LOMO allele”). Then, for each of the 20 alleles the data in the training set for that allele was held out, and deep learning models were trained using data from all other alleles. Finally, the affinity of the held-out peptides was predicted by the remaining models and compared to the held-out experimental data.</p>
        <p id="Par50">Because MHCnuggets has been updated over the years, we reimplemented the LOMO test that was used in the default model selection method. We used the original dataset for the LOMO test containing experimental affinities for peptides binding to 20 alleles, referred to as <italic>IEDB class I rare alleles</italic>. Instead of retraining the deep learning models for each of the LOMO alleles, the model was selected using the <italic>closest_allele</italic> function in the <italic>find_closest_mhcI.py</italic> script by omitting the tested allele one allele at a time in the model search file <italic>examples_per_allele.pkl</italic> from the MHCnuggets source code.</p>
        <p id="Par51">For comparison, we applied the HLA-Clus nearest-neighbor clustering method to select the closest model. Among the 102 alleles that have a prediction model, four are invalid according to the IPD-IMGT/HLA database (version 3.50), including three LOMO alleles, and were therefore excluded from further analysis. Structural models of the 98 valid alleles were generated using ColabFold as described previously [<xref ref-type="bibr" rid="CR15">15</xref>]. Next, each of the remaining 17 alleles was clustered using the nearest-neighbor method together with the remaining 97 alleles, and the closest model was selected according to the clustering result.</p>
        <p id="Par52">Finally, the affinity of peptides to the 17 alleles was predicted using the closest model trained on binding affinity data (i.e., <italic>ba_models</italic> = True) and compared to the corresponding experimental result. The performance was assessed by binding prediction accuracy and correlation between the predicted and experimental IC<sub>50</sub> values. The binding prediction, binder:nonbinder binary classification was based on an IC<sub>50</sub> threshold of 500 nM. The accuracy was calculated as the number of peptides that have identical binding results (i.e., binder or non-binder) between predicted and experimental values divided by the total number of tested peptides. The correlation between predicted and experimental values was calculated as the Spearman rank correlation coefficient.</p>
      </sec>
    </sec>
  </sec>
  <sec id="Sec21">
    <title>Results</title>
    <sec id="Sec22">
      <title>Test example: application of HLA-Clus to MHCnuggets model selection improves peptide binding prediction accuracy for rare alleles</title>
      <p id="Par53">As an example of the use of HLA-Clus in identifying similar alleles for use in peptide binding affinity classification, we demonstrate the application of a newly added nearest-neighbor clustering method in the MHCnuggets package and test its performance. HLA-Clus provides an SD metric for predicting the similarity of peptide binding specificity between HLA class I alleles and two clustering methods: hierarchical clustering and nearest-neighbor clustering. The performance of the SD metric and hierarchical clustering method was demonstrated in our previous article [<xref ref-type="bibr" rid="CR15">15</xref>].</p>
      <p id="Par54">The MHCnuggets package predicts peptide:HLA affinity using allele-specific deep learning models. To make predictions for rare alleles, the closest deep learning model is used, which is selected by a sequence-based algorithm. As we demonstrated previously [<xref ref-type="bibr" rid="CR15">15</xref>], our structure-based method has a higher correlation with peptide binding specificity than does a sequence-based comparison. We now investigate if HLA-Clus improves model selection relative to the default method.</p>
      <p id="Par55">In the model selection result, among the 17 valid LOMO alleles, 12 alleles were assigned different closest models by the two methods. We further compared the performance of MHCnuggets on these 12 alleles using two groups of closest models given by HLA-Clus and the default method, via accuracy of binder:non-binder binary classification and the Spearman rank correlation coefficient. On average, the HLA-Clus group shows higher accuracy in binding prediction than the group obtained with the default method (Fig. <xref rid="Fig2" ref-type="fig">2</xref>a), as the average accuracy of HLA-Clus group is 0.55 compared to 0.47 using the default method (Table <xref rid="Tab2" ref-type="table">2</xref>). Among the 12 alleles, seven have improved accuracy while five show a decrease. The Spearman correlation coefficient shows no significant difference on average (Table <xref rid="Tab2" ref-type="table">2</xref>), while for each individual allele, the correlation coefficient varies significantly (Fig. <xref rid="Fig2" ref-type="fig">2</xref>b). In general, the classification accuracy and correlation coefficient are positively correlated, as a good predictor is expected to perform well on both correlation and classification scenarios.<fig id="Fig2"><label>Fig. 2</label><caption><p>Performance of the default method in ref 24 and HLA-Clus model selection methods in the LOMO test assessed by (<bold>a</bold>) binder:non-binder classification accuracy and (<bold>b</bold>) predicted:experimental affinity correlation</p></caption><graphic xlink:href="12859_2023_5297_Fig2_HTML" id="MO2"/></fig><table-wrap id="Tab2"><label>Table 2</label><caption><p>Binary classification performance from Leave-One-Molecule-Out Tests for 12 HLA Class I alleles that were assigned different closest models by the default model selection algorithm in MHCnuggets and HLA-Clus</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" rowspan="2">LOMO test HLA allele<sup>a</sup></th><th align="left" colspan="4">Default</th><th align="left" colspan="4">HLA-Clus</th></tr><tr><th align="left">Closest model<sup>b</sup></th><th align="left">Training set size</th><th align="left">Accuracy</th><th align="left">Correlation</th><th align="left">Closest model</th><th align="left">Training set size</th><th align="left">Accuracy</th><th align="left">Correlation</th></tr></thead><tbody><tr><td align="left">A*32:07</td><td align="left">A*01:01</td><td char="." align="char">6209</td><td char="." align="char">0.11</td><td char="." align="char">− 0.09</td><td align="left">A*31:01</td><td char="." align="char">6280</td><td char="." align="char">0.32</td><td char="." align="char">0.19</td></tr><tr><td align="left">A*68:23</td><td align="left">A*03:01</td><td char="." align="char">9651</td><td char="." align="char">0.10</td><td char="." align="char">0.17</td><td align="left">A*68:01</td><td char="." align="char">4385</td><td char="." align="char">0.37</td><td char="." align="char">0.44</td></tr><tr><td align="left">B*14:01</td><td align="left">B*27:05</td><td char="." align="char">4402</td><td char="." align="char">0.55</td><td char="." align="char">0.06</td><td align="left">B*14:02</td><td char="." align="char">223</td><td char="." align="char">0.60</td><td char="." align="char">0.55</td></tr><tr><td align="left">B*15:16</td><td align="left">B*58:01</td><td char="." align="char">4422</td><td char="." align="char">0.48</td><td char="." align="char">0.25</td><td align="left">B*15:17</td><td char="." align="char">1452</td><td char="." align="char">0.67</td><td char="." align="char">0.23</td></tr><tr><td align="left">B*27:02</td><td align="left">B*27:05</td><td char="." align="char">4402</td><td char="." align="char">0.77</td><td char="." align="char">0.65</td><td align="left">B*27:03</td><td char="." align="char">912</td><td char="." align="char">0.67</td><td char="." align="char">0.27</td></tr><tr><td align="left">B*27:06</td><td align="left">B*27:05</td><td char="." align="char">4402</td><td char="." align="char">0.69</td><td char="." align="char">0.32</td><td align="left">B*27:20</td><td char="." align="char">91</td><td char="." align="char">0.75</td><td char="." align="char">0.35</td></tr><tr><td align="left">B*27:20</td><td align="left">B*27:05</td><td char="." align="char">4402</td><td char="." align="char">0.46</td><td char="." align="char">0.69</td><td align="left">B*27:06</td><td char="." align="char">87</td><td char="." align="char">0.43</td><td char="." align="char">-0.12</td></tr><tr><td align="left">B*39:06</td><td align="left">B*27:05</td><td char="." align="char">4402</td><td char="." align="char">0.42</td><td char="." align="char">0.52</td><td align="left">B*39:01</td><td char="." align="char">1692</td><td char="." align="char">0.33</td><td char="." align="char">0.48</td></tr><tr><td align="left">B*40:13</td><td align="left">B*40:01</td><td char="." align="char">4337</td><td char="." align="char"><italic>0.29</italic></td><td char="." align="char">0.30</td><td align="left">B*40:02</td><td char="." align="char">1087</td><td char="." align="char">0.26</td><td char="." align="char">0.20</td></tr><tr><td align="left">B*57:03</td><td align="left">B*58:01</td><td char="." align="char">4422</td><td char="." align="char"><italic>0.79</italic></td><td char="." align="char">0.66</td><td align="left">B*57:01</td><td char="." align="char">2914</td><td char="." align="char">0.74</td><td char="." align="char">0.61</td></tr><tr><td align="left">B*81:01</td><td align="left">B*07:02</td><td char="." align="char">6938</td><td char="." align="char"><italic>0.53</italic></td><td char="." align="char">0.36</td><td align="left">B*42:01</td><td char="." align="char">218</td><td char="." align="char">0.73</td><td char="." align="char">0.48</td></tr><tr><td align="left">C*08:01</td><td align="left">C*08:02</td><td char="." align="char">135</td><td char="." align="char"><italic>0.55</italic></td><td char="." align="char">0.16</td><td align="left">C*03:03</td><td char="." align="char">164</td><td char="." align="char">0.75</td><td char="." align="char">0.40</td></tr><tr><td align="left">Average</td><td align="left"/><td char="." align="char"/><td char="." align="char">0.47</td><td char="." align="char">0.34</td><td align="left"/><td char="." align="char"/><td char="." align="char">0.55</td><td char="." align="char">0.34</td></tr></tbody></table><table-wrap-foot><p><sup>a</sup>For simplicity, the “HLA-” prefix was omitted for all alleles in this table</p><p><sup>b</sup>The closest allele was not reported in ref 24 but was identified here by applying the procedure described therein</p></table-wrap-foot></table-wrap></p>
      <p id="Par56">We further investigated the potential cause of the cases in which the prediction performance decreased when HLA-Clus was used by examining the number of peptides in the training data for each model contained in the <italic>examples_per_allele.pkl</italic> file in the MHCnuggets source code. In most cases (10 out of 12), the models selected by HLA-Clus have a much smaller training set than the default algorithm, especially for the five alleles that show a decrease in prediction performance (Table <xref rid="Tab2" ref-type="table">2</xref>). In the extreme example, the tested allele HLA-B*27:20, the default method selected model HLA-B*27:05 includes 4402 peptides in the training set, while HLA-Clus selected HLA-B*27:06, which contains only 87 peptides in the training set. Therefore, we conclude that the insufficient training data is the main cause of the decreased performance using HLA-Clus to identify the closest allele. On the other hand, this finding also suggests the advantage of HLA-Clus over the default method, as a better prediction performance was achieved using much smaller training sets. By combining HLA-Clus with the consideration of model quality applied in the default MHCnuggets model selection algorithm, a substantial improvement in performance is expected.</p>
    </sec>
  </sec>
  <sec id="Sec23">
    <title>Conclusions</title>
    <p id="Par57">Here we presented the HLA-Clus package for clustering HLA class I alleles with similar peptide binding specificities based on similarity of the peptide binding groove landscape. The clustering pipeline first processes modeled 3D HLA structures into coarse-grained point clouds. It then calculates the pairwise SD matrix between HLA alleles and clusters alleles into groups using a hierarchical or nearest-neighbor method. The structure distance metric SD correlates strongly with the peptide binding specificity, leading to reliable supertype and subtype classification [<xref ref-type="bibr" rid="CR15">15</xref>].</p>
    <p id="Par58">In addition, HLA-Clus is versatile and can be readily applied in various scenarios. For example, we have demonstrated that using the nearest-neighbor clustering method in HLA-Clus can improve peptide binding prediction in MHCnuggets for rare alleles by upgrading the model selection algorithm. Moreover, HLA-Clus has the potential to be used in disease association studies to merge similar alleles into groups for streamlining analyses. It may also be useful for HLA matching in transplantation studies (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S1 and Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Tables S1–S4).</p>
  </sec>
  <sec id="Sec24">
    <title>Availability and requirements</title>
    <p id="Par59">Project name: HLA-Clus.</p>
    <p id="Par60">Project home page: <ext-link ext-link-type="uri" xlink:href="https://github.com/yshen25/HLA-Clus">https://github.com/yshen25/HLA-Clus</ext-link>.</p>
    <p id="Par61">Operating system(s): Platform independent.</p>
    <p id="Par62">Programming language: Python.</p>
    <p id="Par63">Other requirements:</p>
    <p id="Par64">License: GPL-3.0</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Information</title>
    <sec id="Sec25">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="12859_2023_5297_MOESM1_ESM.png">
            <caption>
              <p><bold>Additional file1</bold>. <bold>Figure S1</bold>: Comparison between the number of HLA class I alleles studied previously.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="12859_2023_5297_MOESM2_ESM.xlsx">
            <caption>
              <p><bold>Additional file2</bold>. <bold>Table S1</bold>: Example output of the Processing_pipeline function. <bold>Table S2</bold>: Example output of HC_pipeline function. <bold>Table S3</bold>: Example of anchor_dictionary parameter for NN_pipeline function. <bold>Table S4</bold>: Example output of NN_pipeline output.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>HLA</term>
        <def>
          <p id="Par4">Human leukocyte antigen</p>
        </def>
      </def-item>
      <def-item>
        <term>3D</term>
        <def>
          <p id="Par5">Three-dimensional</p>
        </def>
      </def-item>
      <def-item>
        <term>SD</term>
        <def>
          <p id="Par6">Structure distance</p>
        </def>
      </def-item>
      <def-item>
        <term>SSE</term>
        <def>
          <p id="Par7">Sum of squared errors</p>
        </def>
      </def-item>
      <def-item>
        <term>SC</term>
        <def>
          <p id="Par8">Silhouette coefficient</p>
        </def>
      </def-item>
      <def-item>
        <term>LOMO</term>
        <def>
          <p id="Par9">Leave-one-molecule-out</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher's Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>Not applicable.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author contributions</title>
    <p>YS developed the package and wrote the manuscript with contributions from all authors; JMP and JCS supervised the studies. All authors have read and approved the manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>This research received no external funding.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>The HLA-Clus package is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/yshen25/HLA-Clus">https://github.com/yshen25/HLA-Clus</ext-link>. The functions and scripts were written in Python 3 using publicly available packages. The clustering pipeline and examples are also provided as Jupyter notebooks. The datasets supporting the conclusions of this article are included within the article and its additional files.</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar1">
      <title>Ethics approval and consent to participate</title>
      <p id="Par65">Not applicable.</p>
    </notes>
    <notes id="FPar2">
      <title>Consent for publication</title>
      <p id="Par66">Not applicable.</p>
    </notes>
    <notes id="FPar3" notes-type="COI-statement">
      <title>Competing interests</title>
      <p id="Par67">The authors declare that they have no competing interests.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Klein</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Sato</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>The HLA system</article-title>
        <source>N Engl J Med</source>
        <year>2000</year>
        <volume>343</volume>
        <issue>10</issue>
        <fpage>702</fpage>
        <lpage>709</lpage>
        <pub-id pub-id-type="doi">10.1056/NEJM200009073431006</pub-id>
        <?supplied-pmid 10974135?>
        <pub-id pub-id-type="pmid">10974135</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hewitt</surname>
            <given-names>EW</given-names>
          </name>
        </person-group>
        <article-title>The MHC class I antigen presentation pathway: strategies for viral immune evasion</article-title>
        <source>Immunology</source>
        <year>2003</year>
        <volume>110</volume>
        <issue>2</issue>
        <fpage>163</fpage>
        <lpage>169</lpage>
        <pub-id pub-id-type="doi">10.1046/j.1365-2567.2003.01738.x</pub-id>
        <?supplied-pmid 14511229?>
        <pub-id pub-id-type="pmid">14511229</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bird</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>Advantages to being different</article-title>
        <source>Nat Rev Immunol</source>
        <year>2004</year>
        <volume>4</volume>
        <issue>8</issue>
        <fpage>577</fpage>
        <pub-id pub-id-type="doi">10.1038/nri1427</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sette</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Sidney</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Nine major HLA class I supertypes account for the vast preponderance of HLA-A and-B polymorphism</article-title>
        <source>Immunogenetics</source>
        <year>1999</year>
        <volume>50</volume>
        <issue>3</issue>
        <fpage>201</fpage>
        <lpage>212</lpage>
        <pub-id pub-id-type="doi">10.1007/s002510050594</pub-id>
        <?supplied-pmid 10602880?>
        <pub-id pub-id-type="pmid">10602880</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lund</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Nielsen</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Kesmir</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Petersen</surname>
            <given-names>AG</given-names>
          </name>
          <name>
            <surname>Lundegaard</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Worning</surname>
            <given-names>P</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Definition of supertypes for HLA molecules using clustering of specificity matrices</article-title>
        <source>Immunogenetics</source>
        <year>2004</year>
        <volume>55</volume>
        <issue>12</issue>
        <fpage>797</fpage>
        <lpage>810</lpage>
        <pub-id pub-id-type="doi">10.1007/s00251-004-0647-4</pub-id>
        <?supplied-pmid 14963618?>
        <pub-id pub-id-type="pmid">14963618</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kobayashi</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Lu</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Celis</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>Identification of helper T-cell epitopes that encompass or lie proximal to cytotoxic T-cell epitopes in the gp100 melanoma tumor antigen</article-title>
        <source>Can Res</source>
        <year>2001</year>
        <volume>61</volume>
        <issue>20</issue>
        <fpage>7577</fpage>
        <lpage>7584</lpage>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Panigada</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Sturniolo</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Besozzi</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Boccieri</surname>
            <given-names>MG</given-names>
          </name>
          <name>
            <surname>Sinigaglia</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Grassi</surname>
            <given-names>GG</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Identification of a promiscuous T-cell epitope in Mycobacterium tuberculosis Mce proteins</article-title>
        <source>Infect Immun</source>
        <year>2002</year>
        <volume>70</volume>
        <issue>1</issue>
        <fpage>79</fpage>
        <lpage>85</lpage>
        <pub-id pub-id-type="doi">10.1128/IAI.70.1.79-85.2002</pub-id>
        <?supplied-pmid 11748166?>
        <pub-id pub-id-type="pmid">11748166</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Doytchinova</surname>
            <given-names>IA</given-names>
          </name>
          <name>
            <surname>Flower</surname>
            <given-names>DR</given-names>
          </name>
        </person-group>
        <article-title>In silico identification of supertypes for class II MHCs</article-title>
        <source>J Immunol</source>
        <year>2005</year>
        <volume>174</volume>
        <issue>11</issue>
        <fpage>7085</fpage>
        <lpage>7095</lpage>
        <pub-id pub-id-type="doi">10.4049/jimmunol.174.11.7085</pub-id>
        <?supplied-pmid 15905552?>
        <pub-id pub-id-type="pmid">15905552</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Thomsen</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Lundegaard</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Buus</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Lund</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Nielsen</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>MHCcluster, a method for functional clustering of MHC molecules</article-title>
        <source>Immunogenetics</source>
        <year>2013</year>
        <volume>65</volume>
        <issue>9</issue>
        <fpage>655</fpage>
        <lpage>665</lpage>
        <pub-id pub-id-type="doi">10.1007/s00251-013-0714-9</pub-id>
        <?supplied-pmid 23775223?>
        <pub-id pub-id-type="pmid">23775223</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Reche</surname>
            <given-names>PA</given-names>
          </name>
          <name>
            <surname>Reinherz</surname>
            <given-names>EL</given-names>
          </name>
        </person-group>
        <person-group person-group-type="editor">
          <name>
            <surname>Flower</surname>
            <given-names>DR</given-names>
          </name>
        </person-group>
        <article-title>Definition of MHC supertypes through clustering of MHC peptide-binding repertoires</article-title>
        <source>Immunoinformatics</source>
        <year>2007</year>
        <publisher-name>Springer</publisher-name>
        <fpage>163</fpage>
        <lpage>173</lpage>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cano</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Fan</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Stass</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>A geometric study of the amino acid sequence of class I HLA molecules</article-title>
        <source>Immunogenetics</source>
        <year>1998</year>
        <volume>48</volume>
        <issue>5</issue>
        <fpage>324</fpage>
        <lpage>334</lpage>
        <pub-id pub-id-type="doi">10.1007/s002510050439</pub-id>
        <?supplied-pmid 9745009?>
        <pub-id pub-id-type="pmid">9745009</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>McKenzie</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Pecon-Slattery</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Carrington</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>O’Brien</surname>
            <given-names>SJ</given-names>
          </name>
        </person-group>
        <article-title>Taxonomic hierarchy of HLA class I allele sequences</article-title>
        <source>Genes Immun</source>
        <year>1999</year>
        <volume>1</volume>
        <issue>2</issue>
        <fpage>120</fpage>
        <lpage>129</lpage>
        <pub-id pub-id-type="doi">10.1038/sj.gene.6363648</pub-id>
        <?supplied-pmid 11196658?>
        <pub-id pub-id-type="pmid">11196658</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Doytchinova</surname>
            <given-names>IA</given-names>
          </name>
          <name>
            <surname>Guan</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Flower</surname>
            <given-names>DR</given-names>
          </name>
        </person-group>
        <article-title>Identifiying human MHC supertypes using bioinformatic methods</article-title>
        <source>J Immunol</source>
        <year>2004</year>
        <volume>172</volume>
        <issue>7</issue>
        <fpage>4314</fpage>
        <lpage>4323</lpage>
        <pub-id pub-id-type="doi">10.4049/jimmunol.172.7.4314</pub-id>
        <?supplied-pmid 15034046?>
        <pub-id pub-id-type="pmid">15034046</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tong</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Tan</surname>
            <given-names>TW</given-names>
          </name>
          <name>
            <surname>Ranganathan</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>In silico grouping of peptide/HLA class I complexes using structural interaction characteristics</article-title>
        <source>Bioinformatics</source>
        <year>2007</year>
        <volume>23</volume>
        <issue>2</issue>
        <fpage>177</fpage>
        <lpage>183</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btl563</pub-id>
        <?supplied-pmid 17090577?>
        <pub-id pub-id-type="pmid">17090577</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shen</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Parks</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Smith</surname>
            <given-names>JC</given-names>
          </name>
        </person-group>
        <article-title>HLA class I supertype classification based on structural similarity</article-title>
        <source>J Immunol</source>
        <year>2022</year>
        <volume>210</volume>
        <fpage>103</fpage>
        <pub-id pub-id-type="doi">10.4049/jimmunol.2200685</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mirdita</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Schütze</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Moriwaki</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Heo</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Ovchinnikov</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Steinegger</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>ColabFold: making protein folding accessible to all</article-title>
        <source>Nat Methods</source>
        <year>2022</year>
        <volume>19</volume>
        <fpage>679</fpage>
        <pub-id pub-id-type="doi">10.1038/s41592-022-01488-1</pub-id>
        <?supplied-pmid 35637307?>
        <pub-id pub-id-type="pmid">35637307</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jumper</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Evans</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Pritzel</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Green</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Figurnov</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Ronneberger</surname>
            <given-names>O</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Highly accurate protein structure prediction with AlphaFold</article-title>
        <source>Nature</source>
        <year>2021</year>
        <volume>596</volume>
        <issue>7873</issue>
        <fpage>583</fpage>
        <lpage>589</lpage>
        <pub-id pub-id-type="doi">10.1038/s41586-021-03819-2</pub-id>
        <?supplied-pmid 34265844?>
        <pub-id pub-id-type="pmid">34265844</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gao</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Skolnick</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>APoc: large-scale identification of similar protein pockets</article-title>
        <source>Bioinformatics</source>
        <year>2013</year>
        <volume>29</volume>
        <issue>5</issue>
        <fpage>597</fpage>
        <lpage>604</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btt024</pub-id>
        <?supplied-pmid 23335017?>
        <pub-id pub-id-type="pmid">23335017</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shulman-Peleg</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Nussinov</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Wolfson</surname>
            <given-names>HJ</given-names>
          </name>
        </person-group>
        <article-title>SiteEngines: recognition and comparison of binding sites and protein-protein interfaces</article-title>
        <source>Nucleic Acids Res</source>
        <year>2005</year>
        <volume>33</volume>
        <issue>Web Server issue</issue>
        <fpage>W337</fpage>
        <lpage>W341</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gki482</pub-id>
        <?supplied-pmid 15980484?>
        <pub-id pub-id-type="pmid">15980484</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lee</surname>
            <given-names>HS</given-names>
          </name>
          <name>
            <surname>Im</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>G-LoSA: an efficient computational tool for local structure-centric biological studies and drug design</article-title>
        <source>Protein Sci</source>
        <year>2016</year>
        <volume>25</volume>
        <issue>4</issue>
        <fpage>865</fpage>
        <lpage>876</lpage>
        <pub-id pub-id-type="doi">10.1002/pro.2890</pub-id>
        <?supplied-pmid 26813336?>
        <pub-id pub-id-type="pmid">26813336</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hoffmann</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Zaslavskiy</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Vert</surname>
            <given-names>J-P</given-names>
          </name>
          <name>
            <surname>Stoven</surname>
            <given-names>V</given-names>
          </name>
        </person-group>
        <article-title>A new protein binding pocket similarity measure based on comparison of clouds of atoms in 3D: application to ligand prediction</article-title>
        <source>BMC Bioinform</source>
        <year>2010</year>
        <volume>11</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>16</lpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-11-99</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Grantham</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Amino acid difference formula to help explain protein evolution</article-title>
        <source>Science</source>
        <year>1974</year>
        <volume>185</volume>
        <issue>4154</issue>
        <fpage>862</fpage>
        <lpage>864</lpage>
        <pub-id pub-id-type="doi">10.1126/science.185.4154.862</pub-id>
        <?supplied-pmid 4843792?>
        <pub-id pub-id-type="pmid">4843792</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>van Deutekom</surname>
            <given-names>HW</given-names>
          </name>
          <name>
            <surname>Kesmir</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Zooming into the binding groove of HLA molecules: which positions and which substitutions change peptide binding most?</article-title>
        <source>Immunogenetics</source>
        <year>2015</year>
        <volume>67</volume>
        <issue>8</issue>
        <fpage>425</fpage>
        <lpage>436</lpage>
        <pub-id pub-id-type="doi">10.1007/s00251-015-0849-y</pub-id>
        <?supplied-pmid 26040913?>
        <pub-id pub-id-type="pmid">26040913</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <mixed-citation publication-type="other">HLA-Clus repository. Available from: <ext-link ext-link-type="uri" xlink:href="https://github.com/yshen25/HLA-Clus">https://github.com/yshen25/HLA-Clus</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <mixed-citation publication-type="other">GitHub repository for article "HLA Class I Supertype Classification Based on Structural Similarity" [Available from: <ext-link ext-link-type="uri" xlink:href="https://github.com/yshen25/HLA_clustering">https://github.com/yshen25/HLA_clustering</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shao</surname>
            <given-names>XM</given-names>
          </name>
          <name>
            <surname>Bhattacharya</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Huang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Sivakumar</surname>
            <given-names>IKA</given-names>
          </name>
          <name>
            <surname>Tokheim</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Zheng</surname>
            <given-names>L</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>High-throughput prediction of MHC class I and II neoantigens with MHCnuggets</article-title>
        <source>Cancer Immunol Res</source>
        <year>2020</year>
        <volume>8</volume>
        <issue>3</issue>
        <fpage>396</fpage>
        <lpage>408</lpage>
        <pub-id pub-id-type="doi">10.1158/2326-6066.CIR-19-0464</pub-id>
        <?supplied-pmid 31871119?>
        <pub-id pub-id-type="pmid">31871119</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
