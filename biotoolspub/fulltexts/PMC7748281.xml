<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 39.96?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS Comput Biol</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-id journal-id-type="pmc">ploscomp</journal-id>
    <journal-title-group>
      <journal-title>PLoS Computational Biology</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1553-734X</issn>
    <issn pub-type="epub">1553-7358</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, CA USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7748281</article-id>
    <article-id pub-id-type="pmid">33290385</article-id>
    <article-id pub-id-type="publisher-id">PCOMPBIOL-D-19-01813</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1008479</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Physical Sciences</subject>
        <subj-group>
          <subject>Mathematics</subject>
          <subj-group>
            <subject>Applied Mathematics</subject>
            <subj-group>
              <subject>Algorithms</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Simulation and Modeling</subject>
          <subj-group>
            <subject>Algorithms</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Physical Sciences</subject>
        <subj-group>
          <subject>Mathematics</subject>
          <subj-group>
            <subject>Applied Mathematics</subject>
            <subj-group>
              <subject>Algorithms</subject>
              <subj-group>
                <subject>Clustering Algorithms</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Simulation and Modeling</subject>
          <subj-group>
            <subject>Algorithms</subject>
            <subj-group>
              <subject>Clustering Algorithms</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Physical Sciences</subject>
        <subj-group>
          <subject>Mathematics</subject>
          <subj-group>
            <subject>Optimization</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Simulation and Modeling</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Imaging Techniques</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Microscopy</subject>
          <subj-group>
            <subject>Light Microscopy</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Imaging Techniques</subject>
          <subj-group>
            <subject>Fluorescence Imaging</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Physical Sciences</subject>
        <subj-group>
          <subject>Mathematics</subject>
          <subj-group>
            <subject>Statistics</subject>
            <subj-group>
              <subject>Statistical Data</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>FOCAL3D: A 3-dimensional clustering package for single-molecule localization microscopy</article-title>
      <alt-title alt-title-type="running-head">FOCAL3D: A 3D clustering package for SMLM</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-3913-4810</contrib-id>
        <name>
          <surname>Nino</surname>
          <given-names>Daniel F.</given-names>
        </name>
        <role content-type="https://casrai.org/credit/">Formal analysis</role>
        <role content-type="https://casrai.org/credit/">Investigation</role>
        <role content-type="https://casrai.org/credit/">Methodology</role>
        <role content-type="https://casrai.org/credit/">Software</role>
        <role content-type="https://casrai.org/credit/">Validation</role>
        <role content-type="https://casrai.org/credit/">Writing – original draft</role>
        <role content-type="https://casrai.org/credit/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="aff002">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-2996-8547</contrib-id>
        <name>
          <surname>Djayakarsana</surname>
          <given-names>Daniel</given-names>
        </name>
        <role content-type="https://casrai.org/credit/">Investigation</role>
        <role content-type="https://casrai.org/credit/">Software</role>
        <xref ref-type="aff" rid="aff002">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-2515-4025</contrib-id>
        <name>
          <surname>Milstein</surname>
          <given-names>Joshua N.</given-names>
        </name>
        <role content-type="https://casrai.org/credit/">Conceptualization</role>
        <role content-type="https://casrai.org/credit/">Funding acquisition</role>
        <role content-type="https://casrai.org/credit/">Methodology</role>
        <role content-type="https://casrai.org/credit/">Project administration</role>
        <role content-type="https://casrai.org/credit/">Software</role>
        <role content-type="https://casrai.org/credit/">Supervision</role>
        <role content-type="https://casrai.org/credit/">Validation</role>
        <role content-type="https://casrai.org/credit/">Writing – original draft</role>
        <role content-type="https://casrai.org/credit/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="aff002">
          <sup>2</sup>
        </xref>
        <xref ref-type="corresp" rid="cor001">*</xref>
      </contrib>
    </contrib-group>
    <aff id="aff001">
      <label>1</label>
      <addr-line>Department of Physics, University of Toronto, Toronto, Ontario, Canada</addr-line>
    </aff>
    <aff id="aff002">
      <label>2</label>
      <addr-line>Department of Chemical and Physical Sciences, University of Toronto Mississauga, Mississauga, Ontario, Canada</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Papin</surname>
          <given-names>Jason A.</given-names>
        </name>
        <role>Editor</role>
        <xref ref-type="aff" rid="edit1"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">
      <addr-line>University of Virginia, UNITED STATES</addr-line>
    </aff>
    <author-notes>
      <fn fn-type="COI-statement" id="coi001">
        <p>The authors have declared that no competing interests exist.</p>
      </fn>
      <corresp id="cor001">* E-mail: <email>josh.milstein@utoronto.ca</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>12</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>8</day>
      <month>12</month>
      <year>2020</year>
    </pub-date>
    <volume>16</volume>
    <issue>12</issue>
    <elocation-id>e1008479</elocation-id>
    <history>
      <date date-type="received">
        <day>17</day>
        <month>10</month>
        <year>2019</year>
      </date>
      <date date-type="accepted">
        <day>30</day>
        <month>10</month>
        <year>2020</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2020 Nino et al</copyright-statement>
      <copyright-year>2020</copyright-year>
      <copyright-holder>Nino et al</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:href="pcbi.1008479.pdf"/>
    <abstract>
      <p>Single-molecule localization microscopy (SMLM) is a powerful tool for studying intracellular structure and macromolecular organization at the nanoscale. The increasingly massive pointillistic data sets generated by SMLM require the development of new and highly efficient quantification tools. Here we present FOCAL3D, an accurate, flexible and exceedingly fast (scaling linearly with the number of localizations) density-based algorithm for quantifying spatial clustering in large 3D SMLM data sets. Unlike DBSCAN, which is perhaps the most commonly employed density-based clustering algorithm, an optimum set of parameters for FOCAL3D may be objectively determined. We initially validate the performance of FOCAL3D on simulated datasets at varying noise levels and for a range of cluster sizes. These simulated datasets are used to illustrate the parametric insensitivity of the algorithm, in contrast to DBSCAN, and clustering metrics such as the F1 and Silhouette score indicate that FOCAL3D is highly accurate, even in the presence of significant background noise and mixed populations of variable sized clusters, once optimized. We then apply FOCAL3D to 3D astigmatic dSTORM images of the nuclear pore complex (NPC) in human osteosaracoma cells, illustrating both the validity of the parameter optimization and the ability of the algorithm to accurately cluster complex, heterogeneous 3D clusters in a biological dataset. FOCAL3D is provided as an open source software package written in Python.</p>
    </abstract>
    <abstract abstract-type="summary">
      <title>Author summary</title>
      <p>We have developed an accurate, highly-efficient and flexible algorithm for quantifying spatial clustering in large, 3-dimensional single-molecule localization microscopy (SMLM) datasets. Our method, FOCAL3D, is provided as an open-source software package written in Python. FOCAL3D scales linearly with the number of localizations and the algorithmic parameters may be systematically optimized so that the resulting analysis is insensitive to variation over a range of parameter choices. We initially validate the performance and parametric insensitivity of FOCAL3D on simulated datasets, then apply the algorithm to 3-dimensional, astigmatic dSTORM images of the nuclear pore complex in human osteosarcoma cells.</p>
    </abstract>
    <funding-group>
      <award-group id="award001">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100000038</institution-id>
            <institution>Natural Sciences and Engineering Research Council of Canada</institution>
          </institution-wrap>
        </funding-source>
        <award-id>RGPIN-2019-06520</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-3913-4810</contrib-id>
          <name>
            <surname>Nino</surname>
            <given-names>Daniel F.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award002">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100000038</institution-id>
            <institution>Natural Sciences and Engineering Research Council of Canada</institution>
          </institution-wrap>
        </funding-source>
        <award-id>RGPIN-2019-06520</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-2515-4025</contrib-id>
          <name>
            <surname>Milstein</surname>
            <given-names>Joshua N.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award003">
        <funding-source>
          <institution>Natural Sciences and Engineering Research Council of Canada</institution>
        </funding-source>
        <award-id>RGPIN-2019-06520</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-2996-8547</contrib-id>
          <name>
            <surname>Djayakarsana</surname>
            <given-names>Daniel</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award004">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100003400</institution-id>
            <institution>Ontario Ministry of Research, Innovation and Science</institution>
          </institution-wrap>
        </funding-source>
        <award-id>ER14-10-182</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-2515-4025</contrib-id>
          <name>
            <surname>Milstein</surname>
            <given-names>Joshua N.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award005">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100003400</institution-id>
            <institution>Ontario Ministry of Research, Innovation and Science</institution>
          </institution-wrap>
        </funding-source>
        <award-id>ER14-10-182</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-3913-4810</contrib-id>
          <name>
            <surname>Nino</surname>
            <given-names>Daniel F.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <funding-statement>Funding for this research was provided by a Discovery Grant from the Natural Sciences and Engineering Research Council of Canada [DFN, DD, and JNM] (<ext-link ext-link-type="uri" xlink:href="http://www.nserc-crsng.gc.ca">http://www.nserc-crsng.gc.ca</ext-link>; RGPIN-2019-06520) and an Early Researcher Award from the Ontario Ministry of Research, Innovation and Science [DFN and JNM] (<ext-link ext-link-type="uri" xlink:href="http://mri.gov.on.ca">http://mri.gov.on.ca</ext-link>; ER14-10-182). The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
    </funding-group>
    <counts>
      <fig-count count="8"/>
      <table-count count="1"/>
      <page-count count="19"/>
    </counts>
    <custom-meta-group>
      <custom-meta>
        <meta-name>PLOS Publication Stage</meta-name>
        <meta-value>vor-update-to-uncorrected-proof</meta-value>
      </custom-meta>
      <custom-meta>
        <meta-name>Publication Update</meta-name>
        <meta-value>2020-12-18</meta-value>
      </custom-meta>
      <custom-meta id="data-availability">
        <meta-name>Data Availability</meta-name>
        <meta-value>All simulation data files are available from the OSF repository at <ext-link ext-link-type="uri" xlink:href="https://osf.io/pejaq/">https://osf.io/pejaq/</ext-link>. The NPC data underlying the results presented in the study are available by request from Dr. Jonas Reis (<ext-link ext-link-type="uri" xlink:href="https://rieslab.de/">https://rieslab.de/</ext-link>).</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
  <notes>
    <title>Data Availability</title>
    <p>All simulation data files are available from the OSF repository at <ext-link ext-link-type="uri" xlink:href="https://osf.io/pejaq/">https://osf.io/pejaq/</ext-link>. The NPC data underlying the results presented in the study are available by request from Dr. Jonas Reis (<ext-link ext-link-type="uri" xlink:href="https://rieslab.de/">https://rieslab.de/</ext-link>).</p>
  </notes>
</front>
<body>
  <disp-quote>
    <p>This is a <italic>PLOS Computational Biology</italic> Methods paper.</p>
  </disp-quote>
  <sec sec-type="intro" id="sec001">
    <title>Introduction</title>
    <p>Single-molecule localization microscopy (SMLM) techniques [<xref rid="pcbi.1008479.ref001" ref-type="bibr">1</xref>] such as photo-activated localization microscopy (PALM) [<xref rid="pcbi.1008479.ref002" ref-type="bibr">2</xref>], direct stochastic optical reconstruction microscopy (dSTORM) [<xref rid="pcbi.1008479.ref003" ref-type="bibr">3</xref>], DNA-based point accumulation for imaging in nanoscale topography (PAINT) [<xref rid="pcbi.1008479.ref004" ref-type="bibr">4</xref>], and so on, have enabled us to visualize aspects of the biological world at an unprecedented level of detail [<xref rid="pcbi.1008479.ref005" ref-type="bibr">5</xref>]. These techniques can resolve cellular features 1-2 orders of magnitude smaller than what is achievable by conventional, diffraction-limited light microscopy [<xref rid="pcbi.1008479.ref006" ref-type="bibr">6</xref>]. Typical lateral resolutions are approximately 10-20 nm with slightly poorer depth resolution, although recent advances suggest this may be further reduced by another factor of 10 [<xref rid="pcbi.1008479.ref007" ref-type="bibr">7</xref>, <xref rid="pcbi.1008479.ref008" ref-type="bibr">8</xref>]. Considering that nucleic acids such as DNA or RNA are 2 nm wide and that a typical protein is on the order of 4 − 6 nm in diameter, the domain of light microscopy will soon begin to overlap with that of electron microscopy, enabling us to quantify cellular organization and physiology down to the scale of single macromolecules.</p>
    <p>Images acquired by conventional fluorescence microscopy are diffraction-limited, spatial maps of fluorophore intensity while SMLM yields a pointillistic set of approximate single-molecule coordinates (i.e. localizations). There are various approaches to generating image reconstructions from SMLM datasets that appear to produce images analogous to conventional microscopy, albeit with an enhanced resolution. For instance, one can render a Gaussian with a width of the localization precision at each localization coordinate, but the resulting image is not actually an intensity map, rather it represents the probability density of finding a single-molecule at a given location. Regardless, image processing techniques used to analyze conventional microscopy images are often applied to SMLM image reconstructions. A more quantitative approach, however, is to work directly with the table of localizations.</p>
    <p>Various techniques exist to analyze statistical properties of pointillistic data sets and have already been applied to analyze SMLM data, such as pair-correlation analysis [<xref rid="pcbi.1008479.ref009" ref-type="bibr">9</xref>] or the Ripley’s K-function [<xref rid="pcbi.1008479.ref010" ref-type="bibr">10</xref>]. These ensemble measures are able to quantify statistical properties of the localization data such as the degree of clustering or the average size of a cluster, but do not directly identify individual clusters within a dataset. Density based spatial clustering algorithms, on the other hand, attempt to directly assign groups of localizations to a single cluster and can provide information both on the distribution of cluster size and shape as well as quantify intracellular, spatial organization.</p>
    <p>Density based spatial clustering with noise (DBSCAN) [<xref rid="pcbi.1008479.ref011" ref-type="bibr">11</xref>] is arguably the most popular of these methods [<xref rid="pcbi.1008479.ref012" ref-type="bibr">12</xref>, <xref rid="pcbi.1008479.ref013" ref-type="bibr">13</xref>]. How DBSCAN performs is determined by two user-defined parameters: a length-scale <italic>ϵ</italic> specifying the neighbourhood in which to define a local density, and a density threshold <italic>minPts</italic> that determines if a point is part of a cluster or not. While there are some suggestions in the literature on how best to select these parameters, such as the heuristic of setting <italic>minPts</italic> = <italic>D</italic> + 1, where <italic>D</italic> is the dimensionality, and searching for elbows in k-distance plots to fix <italic>ϵ</italic>, these suggestions often fail in practice on SMLM datasets (for a further discussion see [<xref rid="pcbi.1008479.ref015" ref-type="bibr">15</xref>]). In practice, selection of <italic>ϵ</italic> and <italic>minPts</italic> is almost always a subjective process whereby the user tunes the parameters until DBSCAN does a reasonable job identifying clusters in the data. Tuning of the parameters requires DBSCAN to be run multiple times on each dataset, a process that can be arduous for large SMLM datasets (<italic>n</italic><sub><italic>l</italic></sub> &gt; 1 × 10<sup>6</sup> localizations) since DBSCAN scales on average like <italic>n</italic><sub><italic>l</italic></sub> log <italic>n</italic><sub><italic>l</italic></sub> [<xref rid="pcbi.1008479.ref011" ref-type="bibr">11</xref>]. To address these issues, a variety of ‘parameter free’ clustering algorithms have recently appeared in the literature that are specifically designed for SMLM.</p>
    <p>Originally developed for 2-dimensional datasets, Griffié et al. [<xref rid="pcbi.1008479.ref015" ref-type="bibr">15</xref>] employ Bayesian analysis to optimize cluster selection, whereas Levet et al. [<xref rid="pcbi.1008479.ref016" ref-type="bibr">16</xref>] take a geometrical approach that makes use of Voronoi tessellation. While 2-dimensional algorithms are useful for analyzing clustering in a plane, say within the cellular membrane, many biological systems require a true 3-dimensional analysis and simply clustering a projection of the data will often lead to false artefacts. In response, both of these methods have recently been extended to handle 3-dimensional datasets [<xref rid="pcbi.1008479.ref017" ref-type="bibr">17</xref>, <xref rid="pcbi.1008479.ref018" ref-type="bibr">18</xref>]. The runtime of these algorithms, however, is quite long, requiring several hours at best to evaluate a single analysis on a reasonably large set of 3-dimensional SMLM data. Moreover, both have their drawbacks. The Bayesian approach is quite sensitive to imaging artifacts as well as the prior settings (currently limiting detection to similar sized spherical Gaussian clusters), and the Voronoi method has difficulty identifying non-isotropic or hollow, ring-like structures [<xref rid="pcbi.1008479.ref019" ref-type="bibr">19</xref>].</p>
    <p>Here we present FOCAL3D, a 3-dimensional implementation of our previously released Fast Optimized Clustering Algorithm for Localization Microscopy (FOCAL) [<xref rid="pcbi.1008479.ref014" ref-type="bibr">14</xref>]. FOCAL3D is a density based approach similar to DBSCAN, but performed upon an appropriately discretized spatial grid. Under most conditions, this discretization greatly speeds up the algorithm, which scales linearly with the number of localizations <italic>n</italic><sub><italic>l</italic></sub>, enabling the user to rapidly optimize and identify clusters in SMLM data, facilitating the throughput of image analysis. FOCAL3D is highly flexible and is capable of identifying heterogenous and complex, ring-like clusters. FOCAL3D is written in Python with the source code, a user’s guide and example data made available at <ext-link ext-link-type="uri" xlink:href="https://github.com/MilsteinLab/FOCAL3D">https://github.com/MilsteinLab/FOCAL3D</ext-link>. Here we additionally provide a simple graphical user interface (GUI) so the software can easily be implemented by those with no computer programming experience.</p>
    <p>An overview of this manuscript is as follows. In Section 2.1 we provide background on the FOCAL3D clustering algorithm and, in Section 2.2, discuss the procedure for optimizing the algorithmic parameters. In Section 3.1 we present SMLM simulations used to benchmark the algorithm and, in Section 3.2, evaluate the performance of FOCAL3D in clustering the simulated data at moderate and high noise conditions as well as when the cluster populations are mixed or heterogeneous. Then, in Section 3.3, we assess the clustering of FOCAL3D applied to 3D SMLM images of the nuclear pore complex (NPC). We conclude with a discussion of our results in Section 4.</p>
  </sec>
  <sec sec-type="materials|methods" id="sec002">
    <title>Materials and methods</title>
    <sec id="sec003">
      <title>FOCAL3D algorithm</title>
      <p>FOCAL3D follows a similar algorithm to the 2-dimensional implementation elaborated in [<xref rid="pcbi.1008479.ref014" ref-type="bibr">14</xref>]. Starting from a localization table, which is a list of the approximate spatial coordinates (or localizations) of all fluorescent labels detected within a sample, each localization is first assigned to a discrete spatial bin (voxel) of volume Δ<sup>3</sup>. This creates a discretized localization density map (<xref ref-type="fig" rid="pcbi.1008479.g001">Fig 1A</xref>). To enhance contrast between the noise and target (i.e. cluster) points, rather than use the raw density map, we assemble an enhanced density map by replacing the value at each voxel by a sum over all neighbouring voxels (i.e. a 3x3 grid in 2D or a 3x3x3 cubic grid in 3D centred on the voxel under consideration). This contrast enhancement is performed only for bins that contain at least one localization (<xref ref-type="fig" rid="pcbi.1008479.g001">Fig 1B</xref>).</p>
      <fig id="pcbi.1008479.g001" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1008479.g001</object-id>
        <label>Fig 1</label>
        <caption>
          <title>FOCAL(3D) algorithm.</title>
          <p>A.) The area (volume) is first discretized into a grid of symmetric bins with sides of length Δ, here shown in 2D, with the total number of localizations per bin indicated. B.) An enhanced density map is created by replacing each non-zero bin assignment with the sum of all neighbouring 3x3 (3x3x3) bins in 2D (3D). Bins at the edge of the sample volume are exempt from the clustering analysis as indicated by the grey boxes. C.) All voxels that exceed the threshold <italic>minL</italic> = 14, in this example, are categorized as core (bold) while those below the threshold that share an edge or face with a core voxel are categorized as edge voxels (red). Together, the connected core and edge voxels form candidate clusters. D.) Candidates consisting of at least <italic>minC</italic> connected voxels are considered as clusters (here <italic>minC</italic> &lt; 6).</p>
        </caption>
        <graphic xlink:href="pcbi.1008479.g001"/>
      </fig>
      <p>Candidate clusters are selected by first identifying voxels in the enhanced density map that have a value above a density threshold <italic>minL</italic>. These voxels are then labeled as core voxels. Voxels adjacent to any one of the faces of a core voxel, but that did not satisfy the density threshold, are retained as well and classified as border voxels. These core and border voxels comprise the candidate clusters (<xref ref-type="fig" rid="pcbi.1008479.g001">Fig 1C</xref>). As we will see empirically, this way of building the clusters by connecting voxels enables the algorithm to be significantly more flexible at identifying heterogeneous and complex shaped clusters than by imposing a radius, for instance, to define the cluster volume. The final step then is to narrow down the field of candidates by imposing a threshold <italic>minC</italic> on cluster size, where <italic>minC</italic> is simply the minimum number of connected voxels containing core and border voxels that will be accepted as a cluster (<xref ref-type="fig" rid="pcbi.1008479.g001">Fig 1D</xref>).</p>
      <p>A number of improvements to our original 2D MATLAB implementation of this algorithm [<xref rid="pcbi.1008479.ref014" ref-type="bibr">14</xref>] had to be incorporated in the Python implementation of FOCAL3D to efficiently handle 3D datasets. Most significantly, indexing has been largely replaced by vectorized implementations for constructing the enhanced density map, identifying border voxels and determining the size of clusters. To build the enhanced density map, we now convolve the discretized density map with a 3x3x3 kernel to perform the necessary sum of localizations over neighbouring voxels. To label the border voxels, we convolve a binary map of the core voxels with a 6-connected kernel, again eliminating the need for indexing. Finally, cluster sizes in terms of the number of connected voxels are computed using the sum function from the multi-dimensional image processing module in the Scipy library.</p>
    </sec>
    <sec id="sec004">
      <title>Parameter selection for FOCAL3D</title>
      <p>The overall performance of FOCAL3D is dependent upon an appropriate choice of three user-defined parameters: Δ, <italic>minL</italic> and <italic>minC</italic>. The density threshold <italic>minL</italic> and cluster size threshold <italic>minC</italic> are the discrete analogs of <italic>minPts</italic> and <italic>ϵ</italic> in DBSCAN, respectively (see <xref rid="pcbi.1008479.t001" ref-type="table">Table 1</xref>). By discretizing space in FOCAL3D, we greatly enhance the speed at which we can evaluate the local density and, therefore, the full clustering of a dataset. This speed up comes at a cost, namely, the introduction of an additional parameter Δ specifying the grid size.</p>
      <table-wrap id="pcbi.1008479.t001" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1008479.t001</object-id>
        <label>Table 1</label>
        <caption>
          <title>A guide to the parameters used throughout the manuscript.</title>
          <p>Units are indicated in parentheses (with <italic>ℓ</italic> indicating the units of length).</p>
        </caption>
        <alternatives>
          <graphic id="pcbi.1008479.t001g" xlink:href="pcbi.1008479.t001"/>
          <table frame="box" rules="all" border="0">
            <colgroup span="1">
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th align="left" rowspan="1" colspan="1"/>
                <th align="center" rowspan="1" colspan="1">Density Threshold (# of localizations)</th>
                <th align="center" rowspan="1" colspan="1">Local Volume</th>
                <th align="center" rowspan="1" colspan="1">Grid Spacing</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" rowspan="1" colspan="1">DBSCAN</td>
                <td align="center" rowspan="1" colspan="1">
                  <italic>minPts</italic>
                </td>
                <td align="center" rowspan="1" colspan="1">(4<italic>π</italic>/3)<italic>ϵ</italic><sup>3</sup> (<italic>ℓ</italic><sup>3</sup>)</td>
                <td align="center" rowspan="1" colspan="1">-</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">FOCAL3D</td>
                <td align="center" rowspan="1" colspan="1">
                  <italic>minL</italic>
                </td>
                <td align="center" rowspan="1" colspan="1"><italic>minC</italic> (<italic>voxels</italic>)</td>
                <td align="center" rowspan="1" colspan="1">Δ (<italic>ℓ</italic>)</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
      </table-wrap>
      <p>The grid size Δ was previously chosen in [<xref rid="pcbi.1008479.ref014" ref-type="bibr">14</xref>] based on the localization precision of the SMLM data, which reflected an uncertainty inherent in the imaging method. Unfortunately, it is not obvious how to extend our original 2D optimization to 3D datasets. Imposing a grid size on the order of the localization precision results in such a fine grid that in 3D it can drastically slow down the algorithm. Even more problematic, a fundamental step in the 2D optimization was to filter out of focus localizations by tuning <italic>minL</italic> until the localization precision was minimized. It is not clear how to extend this to 3D data where clusters appear at various depths and where the localization precision in <italic>x</italic> and <italic>y</italic> often differs significantly from that in the <italic>z</italic> plane. Moreover, the localization precision must be repeatedly calculated on the filtered data, which in 2D was done via a temporal adjacent neighbour analysis [<xref rid="pcbi.1008479.ref020" ref-type="bibr">20</xref>]–an analysis that is only valid in 2D.</p>
      <p>In response to these technical hurdles, we developed an entirely new approach to optimizing the parameter selection that works with both 2D and 3D datasets. We show that by properly tuning Δ, the performance of FOCAL3D displays regions of insensitivity to the choice of <italic>minC</italic>, and that within these regions one obtains a best estimate of the ideal clustering.</p>
      <sec id="sec005">
        <title>Selecting the density threshold (<italic>minL</italic>)</title>
        <p>For each choice of grid size Δ and cluster size threshold <italic>minC</italic>, it is necessary to set an optimal density threshold <italic>minL</italic>*. We first generate an artificial localization table consisting of the same number of localizations as in the actual dataset, but with each localization randomly positioned within the same volume as the experimental data. We then repeatedly run FOCAL3D on this random dataset over a range of values of <italic>minL</italic>, keeping Δ and <italic>minC</italic> constant. The optimal density threshold <italic>minL</italic>* is chosen as the lowest threshold value where FOCAL3D returns zero clusters for the randomly scattered data (see <xref ref-type="fig" rid="pcbi.1008479.g002">Fig 2</xref> inset). While randomly positioned localizations may occasionally, by chance, form small clusters, these are typically filtered out by the size thresholding and have little effect on the analysis.</p>
        <fig id="pcbi.1008479.g002" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1008479.g002</object-id>
          <label>Fig 2</label>
          <caption>
            <title>Graphical illustration of the typical behaviour seen in plots of the number of clusters vs. minC.</title>
            <p>Close to an ideal grid size Δ*, regions of insensitivity to <italic>minC</italic> appear (solid line). For Δ ≪ Δ*, a steep dependence on <italic>minC</italic> is often observed (dashed line), while for Δ ≫ Δ* a plateau in <italic>minC</italic> may persist, but generally yields an underestimation in the number of clusters (dotted line). The target number is indicated by the horizontal line (red dashed). Note, <italic>minL</italic> is tuned at each point along the curves to differentiate from a random background (inset).</p>
          </caption>
          <graphic xlink:href="pcbi.1008479.g002"/>
        </fig>
      </sec>
      <sec id="sec006">
        <title>Tuning the grid size (Δ) and cluster size threshold (<italic>minC</italic>)</title>
        <p>The selection of the optimum density threshold <italic>minL</italic>* can simply be automated and performed in the background at each value of the grid size Δ and the cluster size threshold <italic>minC</italic>. However, at present, the user must supervise the optimization of Δ and <italic>minC</italic>. This is done by generating a series of plots at varying Δ of the number of detected clusters vs. <italic>minC</italic> (now on the original localization table as opposed to a uniformly scattered set of localizations). <xref ref-type="fig" rid="pcbi.1008479.g002">Fig 2</xref> illustrates the general trend of these plots for a range of grid sizes about an optimal value Δ*. For increasing Δ, near Δ* a relatively flat and extended plateau appears. At Δ* the clustering displays the largest region of insensitivity to <italic>minC</italic>, and along the plateau FOCAL3D is most accurate at clustering the localization data and predicting the number of clusters. For grids smaller than Δ*, the curves will typically display a monotonically decreasing trend. For grids larger than Δ*, the plateau tends to both shrink and, at values of <italic>minC</italic> along the plateau, the algorithm increasingly underestimates the number of clusters.</p>
        <p>As a rule of thumb, the optimal grid size tends to fall below the cluster radius Δ* &lt; <italic>R</italic><sub><italic>C</italic></sub>, with too small a choice leading to an overly sensitive dependence on <italic>minC</italic>, and too large a choice resulting in a significant number of missed clusters. Note that it is not necessary to know the mean cluster size <italic>R</italic><sub><italic>C</italic></sub>
<italic>a priori</italic>, but a good estimate can narrow the range of values for Δ that need to be searched, significantly decreasing the computational time required to optimize the algorithm. For instance, statistical models such as the Ripley’s K-function can yield a reasonable starting point for the search and can be rapidly calculated on localization data. As will be shown, there is some flexibility in the choice of grid size that will result in an accurate performance by the clustering algorithm. A user guide is provided with the software and a detailed discussion on practical aspects of implementing this optimization is given in <xref ref-type="supplementary-material" rid="pcbi.1008479.s001">S1 Text</xref>.</p>
        <p>One should also note that this parameter selection routine can be translated to DBSCAN. In this case, <italic>minPts</italic> is found from analyzing a random distribution of the original localizations and set once the algorithm no longer detects clusters. Then, since there is no equivalent to the grid size Δ in DBSCAN, a single plot of the number of clusters detected vs. <italic>ϵ</italic>, optimizing <italic>minPts</italic> at each point, is generated and <italic>ϵ</italic> is set within the flat region of the curve.</p>
      </sec>
    </sec>
  </sec>
  <sec sec-type="results" id="sec007">
    <title>Results</title>
    <sec id="sec008">
      <title>Clustering simulations</title>
      <p>We performed a series of analyses on simulated SMLM clustering data to quantitatively assess the performance of FOCAL3D (see <ext-link ext-link-type="uri" xlink:href="https://osf.io/pejaq/">https://osf.io/pejaq/</ext-link> for simulated datasets). Here we considered the case of 100 spherically symmetric clusters, with approximately 1 cluster per <italic>μ</italic>m<sup>3</sup>, of various mean radii: 80 ± 16 nm, 60 ± 12 nm and 40 ± 8. Like most density-based methods, FOCAL3D is not designed to deal with spatial overlap so the centroids of the simulated clusters, while otherwise randomly positioned, were well separated by at least 330 nm for the 80 nm clusters, 310 nm for the 60 nm clusters, and 290 nm for the 40 nm clusters.</p>
      <p>Each cluster consisted of a Poisson-distributed number of ‘dyes’ randomly placed, with uniform probability, throughout the cluster volume. The mean number of dyes were <inline-formula id="pcbi.1008479.e001"><alternatives><graphic xlink:href="pcbi.1008479.e001.jpg" id="pcbi.1008479.e001g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M1"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>N</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mrow><mml:mi>d</mml:mi><mml:mi>y</mml:mi><mml:mi>e</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>20</mml:mn><mml:mo>,</mml:mo><mml:mn>20</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>, and 10 for the 80, 60, and 40 nm clusters, respectively. To account for blinking, each dye then yielded an exponentially distributed number of localizations <inline-formula id="pcbi.1008479.e002"><alternatives><graphic xlink:href="pcbi.1008479.e002.jpg" id="pcbi.1008479.e002g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M2"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>N</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mrow><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>c</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>O</mml:mi><mml:mi>N</mml:mi></mml:mrow></mml:msub><mml:mo>/</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mo>λ</mml:mo></mml:mrow></mml:msup><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:math></alternatives></inline-formula> (see <xref ref-type="supplementary-material" rid="pcbi.1008479.s001">S1 Text</xref>), where <italic>τ</italic><sub><italic>ON</italic></sub> is the average ON time of a blink and λ is the characteristic number of blinks of a fluorophore. Each blink was in turn scattered about the corresponding dye centre with a Gaussian distribution whose width was sampled from a distribution of localization precisions (see <xref ref-type="supplementary-material" rid="pcbi.1008479.s001">S1 Text</xref>). We assumed that the spread in localization precision was slightly poorer in the axial direction (<italic>δ</italic><sub><italic>z</italic></sub> = 20 nm) than in the lateral plane (<italic>δ</italic><sub><italic>x</italic>,<italic>y</italic></sub> = 10 nm) reflecting the reduced axial resolution of SMLM. This also makes the underlying, symmetric clusters appear slightly elongated along the <italic>z</italic>-axis. The end result is clusters of an approximate mean localization density of 1 × 10<sup>−4</sup> nm<sup>−3</sup>, 2 × 10<sup>−4</sup> nm<sup>−3</sup>, and 4 × 10<sup>−4</sup> nm<sup>−3</sup> for 80, 60 and 40 nm radius clusters, respectively.</p>
      <p>Throughout the manuscript, we quantify the performance of FOCAL3D in clustering the simulated data both in terms of precision and recall, which are standard metrics of the performance of a clustering algorithm. Precision is defined as the fraction of localizations identified as being part of a cluster that were correctly identified (<italic>P</italic> ≡ TruePositives/(TruePositives + FalsePositives)), while recall measures the fraction of clustered localizations identified by the algorithm (R ≡ TruePositives/(TruePositives + FalseNegatives)). By taking the weighted average of the precision and recall, these two metrics can be combined into a single measure called the <italic>F</italic>1 score, where <italic>F</italic>1 = 2<italic>PR</italic>/(<italic>P</italic> + <italic>R</italic>).</p>
      <p>Another useful metric is the silhouette score <italic>S</italic><sub><italic>C</italic></sub>, which quantifies the degree of overlap in the detected clusters. Formally, this is defined as <inline-formula id="pcbi.1008479.e003"><alternatives><graphic xlink:href="pcbi.1008479.e003.jpg" id="pcbi.1008479.e003g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M3"><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mi>C</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>d</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mrow><mml:mi>N</mml:mi><mml:mi>N</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>d</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mi>C</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>/</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>d</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mrow><mml:mi>N</mml:mi><mml:mi>N</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>〉</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, where <inline-formula id="pcbi.1008479.e004"><alternatives><graphic xlink:href="pcbi.1008479.e004.jpg" id="pcbi.1008479.e004g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M4"><mml:msub><mml:mover accent="true"><mml:mi>d</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mrow><mml:mi>N</mml:mi><mml:mi>N</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> is the mean nearest-neighbour cluster distance and <inline-formula id="pcbi.1008479.e005"><alternatives><graphic xlink:href="pcbi.1008479.e005.jpg" id="pcbi.1008479.e005g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M5"><mml:msub><mml:mover accent="true"><mml:mi>d</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mi>C</mml:mi></mml:msub></mml:math></alternatives></inline-formula> is the mean intra-cluster distance for a sample. <italic>S</italic><sub><italic>C</italic></sub> will range from -1 to 1 with a higher positive score indicating more definition and spatial separation of the clusters.</p>
    </sec>
    <sec id="sec009">
      <title>Performance clustering noisy data</title>
      <p>We define a measure of the noise in our simulations as follows:
<disp-formula id="pcbi.1008479.e006"><alternatives><graphic xlink:href="pcbi.1008479.e006.jpg" id="pcbi.1008479.e006g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M6"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>ζ</mml:mi><mml:mo>=</mml:mo><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>N</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mrow><mml:mi>c</mml:mi><mml:mi>l</mml:mi><mml:mi>u</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>V</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mrow><mml:mi>c</mml:mi><mml:mi>l</mml:mi><mml:mi>u</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mi>o</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:msup><mml:mo>)</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(1)</label></disp-formula>
The quantity in parentheses is the level of signal-to-noise, given here by the ratio of the mean density of clustered localizations to the density of noise. <inline-formula id="pcbi.1008479.e007"><alternatives><graphic xlink:href="pcbi.1008479.e007.jpg" id="pcbi.1008479.e007g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M7"><mml:msub><mml:mover accent="true"><mml:mi>N</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mrow><mml:mi>c</mml:mi><mml:mi>l</mml:mi><mml:mi>u</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> is the mean number of localizations within a cluster, <inline-formula id="pcbi.1008479.e008"><alternatives><graphic xlink:href="pcbi.1008479.e008.jpg" id="pcbi.1008479.e008g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M8"><mml:msub><mml:mover accent="true"><mml:mi>V</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mrow><mml:mi>c</mml:mi><mml:mi>l</mml:mi><mml:mi>u</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> is the mean volume of a cluster, <italic>N</italic><sub><italic>noise</italic></sub> is the total number of localizations uniformly added as noise to the simulation, and <italic>V</italic><sub><italic>sim</italic></sub> is the total simulation volume. A reasonable range of values for <italic>ζ</italic> to consider runs from <italic>ζ</italic> = 0, where there’s no noise, to <italic>ζ</italic> = 1 where the density of the noise is equivalent to the density of the clusters.</p>
      <sec id="sec010">
        <title>Optimization at moderate noise levels</title>
        <p><xref ref-type="fig" rid="pcbi.1008479.g003">Fig 3</xref> displays the number of clusters detected by FOCAL3D as a function of <italic>minC</italic> for a noise level of <italic>ζ</italic> = 0.01 and mean cluster radii of 80 nm, 60 nm and 40 nm. For 80 nm clusters, the behaviour illustrated in <xref ref-type="fig" rid="pcbi.1008479.g002">Fig 2</xref> can now be seen empirically. In this case, for a grid size of half the mean cluster radius (Δ = 40 nm), the number of clusters found by FOCAL3D displays an extended plateau in the neighbourhood of the target number, providing a range of values for <italic>minC</italic> that yield optimal results. However, as <italic>minC</italic> is decreased below this optimal range, the algorithm detects an increasing number of small clusters, which leads to a severe overestimation of the number of target clusters. Likewise, as <italic>minC</italic> is elevated beyond the plateau, FOCAL3D begins rejecting ever larger clusters and the number of clusters predicted by the algorithm steadily decreases to zero.</p>
        <fig id="pcbi.1008479.g003" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1008479.g003</object-id>
          <label>Fig 3</label>
          <caption>
            <title>FOCAL3D performance for clusters of mean radius R<sub>c</sub> = 80 nm, 60 nm and 40 nm at a noise level of <italic>ζ</italic> = 0.01.</title>
            <p>At each radius, the number of clusters as a function of <italic>minC</italic> is displayed for a range of grid sizes (<italic>R</italic><sub><italic>c</italic></sub> = 80 nm: Δ = 20 nm (∘), 40 nm (▫), 90 nm (◊); <italic>R</italic><sub><italic>c</italic></sub> = 60 nm: Δ = 20 nm (∘), 30 nm (▫), 70 nm (◊); <italic>R</italic><sub><italic>c</italic></sub> = 40 nm: Δ = 20 nm (∘), 40 nm (▫), 60 nm (◊)). The red, dashed line indicates the actual number of simulated clusters (100). Insets: Distribution in cluster radii estimated from convex hull determined at three points along <italic>minC</italic> (indicated by solid red squares). For comparison, we also display the ground truth distribution in cluster radii, shown by the solid black curves (see <xref ref-type="supplementary-material" rid="pcbi.1008479.s003">S1 Fig</xref>).</p>
          </caption>
          <graphic xlink:href="pcbi.1008479.g003"/>
        </fig>
        <p>If we then adjust the grid size so that too fine of a grid is chosen (Δ = 20 nm), the plateau disappears and the performance of the algorithm becomes strongly dependent on the choice of <italic>minC</italic> (<xref ref-type="fig" rid="pcbi.1008479.g003">Fig 3</xref>). While the curve does intersect with the target value, without knowing the number of clusters <italic>a priori</italic>, it would be challenging to select the appropriate value of <italic>minC</italic>. Likewise, if the grid is chosen to be too coarse (Δ = 90 nm), an insensitivity to the choice of <italic>minC</italic> may appear, but the algorithm tends to miss a significant amount of clusters within this region of parameter space. We should note that, to obtain the plots in <xref ref-type="fig" rid="pcbi.1008479.g003">Fig 3</xref>, we scanned through a range of grid sizes Δ (in 10 nm steps) and selected for our optimized choice the one that displayed the most extended plateau at the target. For clarity, not all grid sizes are shown (see <xref ref-type="supplementary-material" rid="pcbi.1008479.s004">S2 Fig</xref>).</p>
        <p>We also find that the calculated F1 scores, displayed in <xref ref-type="fig" rid="pcbi.1008479.g004">Fig 4</xref>, are consistently the highest along the plateau at the optimized grid size (Δ* = 40 nm), and are significantly poorer within this same region for both the coarse (Δ = 90 nm) and fine (Δ = 20 nm) grids (see <xref ref-type="supplementary-material" rid="pcbi.1008479.s005">S3 Fig</xref>). Furthermore, the F1 scores remain relatively constant along the plateau.</p>
        <fig id="pcbi.1008479.g004" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1008479.g004</object-id>
          <label>Fig 4</label>
          <caption>
            <title>Clustering performance as indicated by the F1 score.</title>
            <p>(Corresponding to the analysis in <xref ref-type="fig" rid="pcbi.1008479.g003">Fig 3</xref>). The plots show that the algorithm is most accurate when identifying clusters within the plateau region (compare to <xref ref-type="fig" rid="pcbi.1008479.g003">Fig 3</xref>) near a grid spacing Δ*. Symbols the same as indicated in <xref ref-type="fig" rid="pcbi.1008479.g003">Fig 3</xref>.</p>
          </caption>
          <graphic xlink:href="pcbi.1008479.g004"/>
        </fig>
        <p>Similar behaviour is observed for smaller clusters, with the results for 60 nm and 40 nm clusters shown here (<xref ref-type="fig" rid="pcbi.1008479.g003">Fig 3</xref>). We note that as the mean cluster size is decreased, the region of insensitivity of the algorithm to <italic>minC</italic> diminishes. For 40 nm clusters, and an appropriate choice of grid size, a plateau is still visible, if just, in a plot of the number of clusters vs. <italic>minC</italic>. We also note that, due to the reduced localization precision along the z-axis, the 40 nm clusters are significantly more elongated than the 80 nm clusters. This tends to shift the choice of ideal grid size to larger values as seen in the figure. Moreover, in both cases the F1 scores are highest, and relatively constant, along the plateau region of the Δ* curve (<xref ref-type="fig" rid="pcbi.1008479.g004">Fig 4</xref>).</p>
      </sec>
      <sec id="sec011">
        <title>DBSCAN at moderate noise levels</title>
        <p>We next consider how DBSCAN performs on the same simulated data sets with an analogous optimization of input parameters. In <xref ref-type="fig" rid="pcbi.1008479.g005">Fig 5</xref>, for the case of 80 nm clusters, we plot the number of clusters detected by DBSCAN as a function of <italic>ϵ</italic>, which corresponds to <italic>minC</italic> in FOCAL3D (results for 60 nm and 40 nm clusters are provided in <xref ref-type="supplementary-material" rid="pcbi.1008479.s006">S4 Fig</xref>). At each point we have optimized the density threshold <italic>minPts</italic> to differentiate from random background noise, similar to the corresponding selection of <italic>minL</italic> in FOCAL3D.</p>
        <fig id="pcbi.1008479.g005" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1008479.g005</object-id>
          <label>Fig 5</label>
          <caption>
            <title>DBSCAN performance at <italic>ζ</italic> = 0.01 for target clusters of radius 80, 60 and 40 nm.</title>
            <p>Figures display the detected number of clusters vs. the length scale <italic>ϵ</italic> defining the local volume. The dashed line indicates the target number of clusters. Insert: F1 score vs. <italic>ϵ</italic>.</p>
          </caption>
          <graphic xlink:href="pcbi.1008479.g005"/>
        </fig>
        <p>For these simulations, DBSCAN also displays a clear plateau or region of insensitivity to the input parameter defining the local area (i.e. <italic>ϵ</italic>). However, the F1 scores appear to peak at the onset of the plateau, for lower values of <italic>ϵ</italic>, then steeply decline while still within the plateau region (see <xref ref-type="supplementary-material" rid="pcbi.1008479.s007">S5 Fig</xref>). Regardless, the plateau appearing in plots of cluster number vs. <italic>ϵ</italic> indicate a non-biased way to select the appropriate parameters for DBSCAN. As we will show, these regions of insensitivity may disappear in more complex datasets than those we have simulated, leaving the user without a guide for selecting the clustering parameters.</p>
      </sec>
      <sec id="sec012">
        <title>FOCAL3D performance under high noise conditions</title>
        <p>We now consider the performance of FOCAL3D under increasingly noisy conditions, both at <italic>ξ</italic> = 0.05 and <italic>ξ</italic> = 0.20. Our numerical results are displayed in <xref ref-type="fig" rid="pcbi.1008479.g006">Fig 6</xref>. For large 80 nm clusters and <italic>ξ</italic> = 0.05, signature curves appear in a plot of cluster number vs. <italic>minC</italic>. A steep descent is seen at overly fine grid sizes (Δ = 20 nm), giving way to a plateau near an optimized grid size (Δ* = 40 nm), which then drops below the target for coarser grids (Δ = 90 nm). We find that the region of insensitivity seen at Δ* = 40 nm holds even at very high noise levels (<italic>ξ</italic> = 0.20). FOCAL3D performs quite well for smaller clusters (<italic>R</italic><sub><italic>C</italic></sub> = 60 nm) under these noisy conditions and appears to actually show less sensitivity to the choice of target grid size. However, the algorithm begins to underestimate the number of target clusters for the smallest clusters we simulated (<italic>R</italic><sub><italic>C</italic></sub> = 40 nm), resulting in significantly poorer performance as the noise is increased from <italic>ξ</italic> = 0.05 to <italic>ξ</italic> = 0.20.</p>
        <fig id="pcbi.1008479.g006" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1008479.g006</object-id>
          <label>Fig 6</label>
          <caption>
            <title>FOCAL3D performance at higher noise levels.</title>
            <p><italic>ζ</italic> = 0.05 and <italic>ζ</italic> = 0.20 for 80 nm clusters: Δ = 20 nm (∘), Δ = 40 nm (▫), Δ = 90 nm (◊); 60 nm clusters: Δ = 20 nm (∘), Δ = 30 nm (▫), Δ = 80 nm (◊); 40 nm clusters: Δ = 20 nm (∘), Δ = 40 nm (▫), Δ = 60 nm (◊).</p>
          </caption>
          <graphic xlink:href="pcbi.1008479.g006"/>
        </fig>
        <p>Again, at the target grid size Δ*, the F1 scores all display a relatively flat, maximum throughout the corresponding plateau region of <italic>minC</italic> (see <xref ref-type="supplementary-material" rid="pcbi.1008479.s008">S6 Fig</xref>). We note that at these higher noise levels the F1 scores lower, in part, because the background noise in the simulations is randomly distributed throughout the volume. For example, at <italic>ξ</italic> = 0.20, roughly 20% of the points contained within a cluster are considered background noise. Even if the algorithm were to perfectly identify the clusters, it would have no way to discern that these points are noise, resulting in an increased number of false positives.</p>
      </sec>
      <sec id="sec013">
        <title>Performance on mixed populations</title>
        <p>To illustrate the performance of FOCAL3D at identifying heterogenous clustering, we analyzed simulated data sets with mixed populations of clusters of different mean radii and at moderate noise levels (<italic>ζ</italic> = 0.01). We considered three mixtures: 1) a 50/50 mixed population of mean radii <italic>R</italic><sub><italic>c</italic></sub> = 40 ± 8 nm and <italic>R</italic><sub><italic>c</italic></sub> = 80 ± 16 clusters (100 clusters in total), 2) a 50/50 mixed population of <italic>R</italic><sub><italic>c</italic></sub> = 60 ± 12 nm and <italic>R</italic><sub><italic>c</italic></sub> = 80 ± 16 clusters (100 clusters in total), and 3) a mixed population of <italic>R</italic><sub><italic>c</italic></sub> = 40 ± 8, <italic>R</italic><sub><italic>c</italic></sub> = 60 ± 12 nm, and <italic>R</italic><sub><italic>c</italic></sub> = 80 ± 16 nm clusters in equal proportion (40/40/40 for a total of 120 clusters). The average density of localizations in the clusters was the same as for the single population data sets at each cluster radii, and the centers of each cluster were separated by at least 250 nm. Despite the clear heterogeneity, the parameter scans continued to yield regions of insensitivity to <italic>minC</italic> at an optimal grid size Δ* for each of these mixed populations (see <xref ref-type="supplementary-material" rid="pcbi.1008479.s009">S7 Fig</xref>). Parameters chosen along these plateaus not only correctly detect the number of clusters but continue to display the highest F1 Scores (see <xref ref-type="supplementary-material" rid="pcbi.1008479.s010">S8 Fig</xref>) indicating the accuracy of FOCAL3D at identifying heterogeneous clustering. This is further confirmed by directly visualizing the cluster analysis (see <xref ref-type="supplementary-material" rid="pcbi.1008479.s011">S9 Fig</xref>). Any clustering errors tended to involve the sparse localizations at the edges of the clusters that resulted from the localization precision used to scatter the localizations within each cluster.</p>
      </sec>
    </sec>
    <sec id="sec014">
      <title>Run-time scaling comparison</title>
      <p>An important characteristic of any clustering algorithm is the run-time performance and scaling as a function of the size of the data set. Algorithms with a low run-time would expedite the analysis of multiple, large SMLM data sets, which are often needed to obtain the necessary statistics of a cluster phenotype. This is particularly relevant for three-dimensional SMLM data sets that typically have on the order of hundreds of thousands to millions of localizations per acquisition. In view of this, we directly compare the run time of FOCAL3D and DBSCAN as a function of their respective parameters and as a function of the number of localizations (<italic>n</italic><sub><italic>l</italic></sub>) in the data set. We performed this analysis on simulated data of 80 nm clusters (<inline-formula id="pcbi.1008479.e009"><alternatives><graphic xlink:href="pcbi.1008479.e009.jpg" id="pcbi.1008479.e009g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M9"><mml:mrow><mml:mi>ζ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>01</mml:mn><mml:mo>,</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>l</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mn>166274</mml:mn></mml:mrow></mml:math></alternatives></inline-formula> localizations), and made use of a desktop computer housing an i5 quad-core single processor with 24 Gb of memory. Our results are summarized in <xref ref-type="fig" rid="pcbi.1008479.g007">Fig 7</xref>.</p>
      <fig id="pcbi.1008479.g007" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1008479.g007</object-id>
        <label>Fig 7</label>
        <caption>
          <title>Run-time comparison between FOCAL3D and DBSCAN.</title>
          <p>Clustering of simulated data of 80 nm clusters (<inline-formula id="pcbi.1008479.e010"><alternatives><graphic id="pcbi.1008479.e010g" xlink:href="pcbi.1008479.e010"/><mml:math id="M10"><mml:mrow><mml:mi>ζ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>01</mml:mn><mml:mo>,</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>l</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mn>166274</mml:mn></mml:mrow></mml:math></alternatives></inline-formula> localizations). A) Run-time scaling of FOCAL3D for varying local volume <italic>minC</italic> and grid size Δ. B) Scaling of DBSCAN for varying local volume <italic>ϵ</italic>. C) Scaling of FOCAL3D for a varying number of localizations and at fixed <italic>minC</italic> = 15 for: Δ = 25 nm (∘), Δ = 45 nm (◊), and Δ = 65 nm (▫). D) Scaling of DBSCAN for a varying number of localizations at: <italic>ϵ</italic> = 40 nm (∘), <italic>ϵ</italic> = 70 nm (◊) and <italic>ϵ</italic> = 100 nm (▫). These values were chosen to roughly match the local volumes used in the FOCAL3D run-time analysis through the relation <italic>minC</italic> * Δ<sup>3</sup> = (4<italic>π</italic>/3)<italic>ϵ</italic><sup>3</sup>.</p>
        </caption>
        <graphic xlink:href="pcbi.1008479.g007"/>
      </fig>
      <p>We first consider the run-time scaling of the two algorithms by varying the local volumes (i.e. <italic>minC</italic> and <italic>ϵ</italic> for FOCAL3D and DBSCAN, respectively). The run-time for FOCAL3D stays relatively constant when increasing <italic>minC</italic> (<xref ref-type="fig" rid="pcbi.1008479.g007">Fig 7A</xref>), compared to the rapid power law scaling displayed by DBSCAN (<xref ref-type="fig" rid="pcbi.1008479.g007">Fig 7B</xref>) for increasing <italic>ϵ</italic>. However, while varying the grid size Δ in FOCAL3D hardly affects this observed independence of the run-time scaling on <italic>minC</italic>, it does greatly slow down the algorithm for increasingly small grids.</p>
      <p>A further comparison is provided by matching the local volumes employed by the two algorithms with the relation <italic>minC</italic> * Δ<sup>3</sup> = (4<italic>π</italic>/3)<italic>ϵ</italic><sup>3</sup>. FOCAL3D’s run-time scales linearly with the number of localizations in the data set, resulting in a time complexity of <italic>O</italic>(<italic>n</italic><sub><italic>l</italic></sub>) (<xref ref-type="fig" rid="pcbi.1008479.g007">Fig 7C</xref>). Moreover, the rate at which the run-time increases with data set size is lower for larger grid sizes. This is in contrast with DBSCAN, whose run-time has been shown to scale as <italic>O</italic>(<italic>n</italic><sub><italic>l</italic></sub> log <italic>n</italic><sub><italic>l</italic></sub>) at best [<xref rid="pcbi.1008479.ref011" ref-type="bibr">11</xref>]. For the Python implementation tested here (Scikit-learn), the run-time scaling appears even more complex and significantly worsens above a critical number of localizations (<xref ref-type="fig" rid="pcbi.1008479.g007">Fig 7D</xref>).</p>
    </sec>
    <sec id="sec015">
      <title>Clustering of the nuclear pore complex</title>
      <p>We now apply our clustering algorithm to 3-dimensional astigmatic dSTORM images of the nuclear pore complex (NPC) [<xref rid="pcbi.1008479.ref021" ref-type="bibr">21</xref>–<xref rid="pcbi.1008479.ref023" ref-type="bibr">23</xref>]. This will illustrate the validity of the parameter optimization as well as the ability of the algorithm to cluster complex biological data. The NPCs serve as clustering targets that are both heterogeneous, due to a reported labeling efficiency of only ∼ 55%, and complex in that they are of an extended, ring-like shape. The images were acquired in wild-type U-2 human osteosarcoma (OS) cells expressing Nup107-SNAP, which were fluorescently labeled with the organic dye Alexa-647 and induced to photoswitch by modifying the imaging buffer. Details on the cell cultures, labeling, fixation, and imaging can be found in [<xref rid="pcbi.1008479.ref021" ref-type="bibr">21</xref>].</p>
      <p>We initially partition the dataset focusing on an approximately 2 <italic>μ</italic>m × 2 <italic>μ</italic>m region in the lateral plane centred on the nucleus. <xref ref-type="fig" rid="pcbi.1008479.g008">Fig 8A, 8B and 8C</xref> show the results of the clustering analysis with FOCAL3D. In <xref ref-type="fig" rid="pcbi.1008479.g008">Fig 8A</xref>, we scan through grid sizes ranging from 15-45 nm in steps of 10 nm. The smallest grid size (Δ = 15 nm) shows a steep decline in the number of clusters detected as a function of <italic>minC</italic>. This dependence significantly levels out at a grid size of Δ = 25 nm, with both the extent of the flat region and the estimated number of clusters decreasing for larger choices of the grid size. The discrete, step-like behaviour seen in the curves is simply an artifact of the small number of clusters that we are considering here (we, therefore, identify the plateau as the initial step after the inflection point of the curves). We identify Δ* = 25 and choose <italic>minC</italic>* = 60, which is just at the cusp of the plateau (red square). <xref ref-type="fig" rid="pcbi.1008479.g008">Fig 8B</xref> displays the localizations for this subset of the data, projected onto the x-y plane, in which we can manually identify NPCs by eye. A comparison with the clustering results (<xref ref-type="fig" rid="pcbi.1008479.g008">Fig 8C</xref>) nicely illustrates the performance of FOCAL3D. Note, the clustering is not strongly dependent upon the choice of grid size for a range of Δ*. For instance, we could have, alternatively, chosen Δ* = 35, which at <italic>minC</italic>* = 60 identifies roughly 1 less NPC and clusters the localizations in a similar fashion.</p>
      <fig id="pcbi.1008479.g008" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1008479.g008</object-id>
        <label>Fig 8</label>
        <caption>
          <title>Cluster analysis of NPC dataset in U-2 OS cells.</title>
          <p>A) FOCAL3D analysis of the number of Clusters vs. <italic>minC</italic>, for the cropped dataset, for grid sizes of Δ = 15 nm (∘), 25 nm (▫), 35 nm (◊), 45 nm (∇). Insert: Corresponding DBSCAN analysis of the # of Clusters vs. <italic>ϵ</italic>. B) Localization data. C) FOCAL3D clustered dataset at Δ* = 25 nm and <italic>minC</italic>* = 60. D) FOCAL3D analysis of # of Clusters vs. <italic>minC</italic> for the full dataset. Symbols are the same as in the cropped dataset. Insert: Corresponding DBSCAN analysis of the # of Clusters vs. <italic>ϵ</italic>. E) Localization data. F) FOCAL3D clustering results at <italic>minC</italic>* = 46 and Δ* = 25.</p>
        </caption>
        <graphic xlink:href="pcbi.1008479.g008"/>
      </fig>
      <p>We also attempted to guide a similar analysis with DBSCAN by generating a plot of the number of detected clusters vs. <italic>ϵ</italic> (insert to <xref ref-type="fig" rid="pcbi.1008479.g008">Fig 8A</xref>). However, the results showed a steep functional dependence with no clear indication of how to select for <italic>ϵ</italic>. While a number of steps or plateaus appeared in this plot, the most extensive ones occurred far from the target number of clusters (around N = 10 and 40).</p>
      <p>In <xref ref-type="fig" rid="pcbi.1008479.g008">Fig 8D, 8E and 8F</xref> we consider the full NPC dataset in which a manual enumeration of the NPCs would be difficult. <xref ref-type="fig" rid="pcbi.1008479.g008">Fig 8D</xref> shows an analysis of the detected number of clusters vs. <italic>minC</italic> over the same range of grid sizes (Δ = 15 − 45 nm) as analyzed for the smaller data subset. Once again, an overly fine grid size (Δ = 15 nm) shows a steep dependence on <italic>minC</italic>, with the curves levelling off at Δ = 25 nm, after which the plateau region shrinks and the number of clusters identified for a given <italic>minC</italic> drops. Again, we provide a localization image (<xref ref-type="fig" rid="pcbi.1008479.g008">Fig 8E</xref>), shown as a projection onto the x-y plane, that can be compared to the clustering results (<xref ref-type="fig" rid="pcbi.1008479.g008">Fig 8F</xref>). Here we have chosen Δ* = 25 and <italic>minC</italic>* = 46 (red square). A similar analysis for DBSCAN gives no indication of an appropriate way to select for <italic>ϵ</italic> (insert of <xref ref-type="fig" rid="pcbi.1008479.g008">Fig 8D</xref>).</p>
      <p>For this larger dataset, we note that there is a certain level of ambiguity in the choice of Δ*, and the clustering that results is more sensitive to this choice. The effect is primarily due to the close proximity of many of the clusters, a facet that was not explored in our simulations where we explicitly prevented the clusters from overlapping. This can be quantified to some extent by the silhouette score <italic>S</italic><sub><italic>C</italic></sub> (see <xref ref-type="supplementary-material" rid="pcbi.1008479.s002">S1 Table</xref>). For example, in the simulations shown in <xref ref-type="fig" rid="pcbi.1008479.g003">Fig 3</xref>, optimal clustering resulted in a silhouette score within the range of <italic>S</italic><sub><italic>C</italic></sub> = 0.80 − 0.85. For the restricted NPC dataset shown in <xref ref-type="fig" rid="pcbi.1008479.g008">Fig 8A and 8B</xref>, <italic>S</italic><sub><italic>C</italic></sub> = 0.53 at Δ* = 25 nm. However, at the inflection points along the other curves in <xref ref-type="fig" rid="pcbi.1008479.g008">Fig 8D</xref>, indicated by the shaded blue symbols at <italic>minC</italic>* = 46, we find <italic>S</italic><sub><italic>C</italic></sub> = 0.48, 0.46, and 0.42 for Δ = 15 nm, 35 nm, and 45 nm, respectively. This indicates that within the image, on average, the predicted clusters are significantly more tightly packed.</p>
      <p>FOCAL3D was not designed to distinguish overlapping clusters, so we would expect it to have difficulty with such a dataset. To better understand the behaviour of our algorithm, however, and to further guide us in our parameter selection, we considered the distribution of cluster radii detected at the cusp of each plateau in <xref ref-type="fig" rid="pcbi.1008479.g008">Fig 8D</xref> (indicated by the shaded red and blue points in the figure). Starting from the smallest grid size and increasing, the distribution in cluster radii tend to shift toward a peaked distribution, but then develop an increasingly long tail containing larger clusters (see <xref ref-type="supplementary-material" rid="pcbi.1008479.s012">S10 Fig</xref>). The latter effect most likely arises when the algorithm begins to merge the clusters, so the ideal clustering should occur just before this tail develops. This is supported by direct visualization of the clustering results (see <xref ref-type="supplementary-material" rid="pcbi.1008479.s013">S11 Fig</xref>). This is further justification that our choice of Δ* = 25 was appropriate. As a final check, the peak of the distribution in cluster sizes agrees with a Ripley’s K-function analysis (see <xref ref-type="supplementary-material" rid="pcbi.1008479.s014">S12</xref> and <xref ref-type="supplementary-material" rid="pcbi.1008479.s015">S13</xref> Figs, respectively).</p>
    </sec>
  </sec>
  <sec sec-type="conclusions" id="sec016">
    <title>Discussion</title>
    <p>As SMLM continues to push the resolution limit obtainable by light microscopy, efficient algorithms need to be developed that can cope with the concomitantly larger datasets that will be generated. In this manuscript, we have presented an extension of our 2-dimensional Fast Optimized Clustering Algorithm for Localization Microscopy (FOCAL) [<xref rid="pcbi.1008479.ref014" ref-type="bibr">14</xref>] to 3-dimensions. FOCAL3D is a density based algorithm, so directly identifies clusters in noisy SMLM images, and outperforms the classical density based algorithm DBSCAN both in terms of performance (scaling like <italic>n</italic><sub><italic>l</italic></sub> compared to <italic>n</italic><sub><italic>l</italic></sub> log <italic>n</italic><sub><italic>l</italic></sub>) and ability to identify complex, heterogeneous clusters. Moreover, unlike DBSCAN, the algorithmic parameters that determine FOCAL3D’s performance can be systematically tuned such that, within a constrained range of parameters, the clustering is only weakly dependent upon the exact choice of these parameters.</p>
    <p>While the speed gains of working on a grid can be considerable, for small clusters that necessitate an excessively fine grid, the computational cost of FOCAL3D can outweigh that of DBSCAN. As we saw in our simulations, the region of parametric insensitivity is also reduced making it harder to optimize the cluster detection. However, the localization precision of SMLM, which is typically on the order of 10s of nanometers, effectively sets a lower limit to the grid size [<xref rid="pcbi.1008479.ref014" ref-type="bibr">14</xref>]. This is because all photoswitchable or photoactivatable fluorophores tend to blink, with the same dye giving rise to multiple localizations. In quantitative SMLM, which attempts to quantify the abundance of nucleic acids or proteins from SMLM data, blinking gives rise to an overcounting problem [<xref rid="pcbi.1008479.ref024" ref-type="bibr">24</xref>–<xref rid="pcbi.1008479.ref028" ref-type="bibr">28</xref>]. In a clustering analysis, unclustered molecules with a single fluorophore label may appear as small clusters, of a size determined by the localization precision, due to blinking. For most cluster detection problems, the optimal grid size and the cluster threshold <italic>minC</italic> will exclude blinking artefacts from the cluster analysis.</p>
    <p>Finally, FOCAL3D may have issues analyzing dense SMLM image reconstructions, particularly when the clusters begin to overlap. Future extensions to FOCAL3D may alleviate these issues, such as by incorporating a segmentation algorithm to differentiate anomalously large, dense clusters of localizations.</p>
    <p>FOCAL3D is designed to automate and rapidly perform an analysis of large 3-dimensional SMLM data sets. Likewise, the resulting clustering may be used as a way to filter out noise in SMLM image reconstructions, retaining only the features of interest. FOCAL3D should serve as a useful addition to the set of quantitative techniques now available for super-resolved microscopy, providing a foundation for further analysis of intracellular organization, protein assemblages, and spatial patterning.</p>
  </sec>
  <sec sec-type="supplementary-material" id="sec017">
    <title>Supporting information</title>
    <supplementary-material content-type="local-data" id="pcbi.1008479.s001">
      <label>S1 Text</label>
      <caption>
        <title>Supporting text.</title>
        <p>Practical aspects of the clustering optimization and simulation details.</p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pcbi.1008479.s001.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1008479.s002">
      <label>S1 Table</label>
      <caption>
        <title>Supporting table.</title>
        <p>Silhouette Scores from the clustering of the NPC dataset.</p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pcbi.1008479.s002.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1008479.s003">
      <label>S1 Fig</label>
      <caption>
        <title>Simulated ground truth cluster sizes.</title>
        <p>Simulated ground truth cluster radii obtained by convex hull for A) 80 ± 16 nm clusters, B) 60 ± 12 nm clusters, C) 40 ± 8nm clusters. Solid black line is a Gaussian fit to the peak of the distribution.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pcbi.1008479.s003.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1008479.s004">
      <label>S2 Fig</label>
      <caption>
        <title>Insensitivity to grid selection of clustering.</title>
        <p>There is some flexibility on the choice of optimal grid size as illustrated in these graphs, which correspond to the results from <xref ref-type="fig" rid="pcbi.1008479.g003">Fig 3</xref> of the main text. FOCAL3D performance for simulations at a noise level of <italic>ζ</italic> = 0.01. For <italic>R</italic><sub><italic>c</italic></sub> = 80 nm: Δ = 35 nm (∇), Δ = 40 nm (▫), Δ = 45 nm (Δ). For <italic>R</italic><sub><italic>c</italic></sub> = 60 nm: Δ = 25 nm (∇), Δ = 30 nm (▫), Δ = 35 nm (Δ). For <italic>R</italic><sub><italic>c</italic></sub> = 40 nm: Δ = 30 nm (∇), Δ = 40 nm (▫), Δ = 50 nm (Δ).</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pcbi.1008479.s004.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1008479.s005">
      <label>S3 Fig</label>
      <caption>
        <title>FOCAL3D Precision and Recall at moderate noise.</title>
        <p>Precision and Recall curves used to calculate the F1 Scores in <xref ref-type="fig" rid="pcbi.1008479.g004">Fig 4</xref> of the main text (<italic>ζ</italic> = 0.01).</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pcbi.1008479.s005.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1008479.s006">
      <label>S4 Fig</label>
      <caption>
        <title>DBSCAN performance with smaller clusters.</title>
        <p>DBSCAN performance at detecting 60 nm and 40 nm clusters at moderate noise (<italic>ζ</italic> = 0.01 simulations).</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pcbi.1008479.s006.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1008479.s007">
      <label>S5 Fig</label>
      <caption>
        <title>DBSCAN Precision and Recall at moderate noise.</title>
        <p>Precision and Recall curves used to calculate the F1 Scores in the inset of <xref ref-type="fig" rid="pcbi.1008479.g005">Fig 5</xref> of the main text (<italic>ζ</italic> = 0.01 simulations).</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pcbi.1008479.s007.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1008479.s008">
      <label>S6 Fig</label>
      <caption>
        <title>FOCAL3D Precision and Recall at high noise.</title>
        <p>Precision and Recall curves used to calculate the F1 Scores for <italic>ζ</italic> = 0.05 and <italic>ζ</italic> = 0.20. Shown are the results for cluster sizes of 80 nm, 60 nm and 40 nm in <xref ref-type="fig" rid="pcbi.1008479.g006">Fig 6</xref> of the main text.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pcbi.1008479.s008.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1008479.s009">
      <label>S7 Fig</label>
      <caption>
        <title>Parameter selection for mixture of different cluster sizes.</title>
        <p>FOCAL3D performance for simulated populations of mixed cluster sizes at a noise level of <italic>ζ</italic> = 0.01. At each radius, the number of clusters as a function of <italic>minC</italic> is displayed for a range of grid sizes. (Mixture of <italic>R</italic><sub><italic>c</italic></sub> = 80 nm and <italic>R</italic><sub><italic>c</italic></sub> = 40 nm: Δ = 20 nm (∘), 40 nm (▫), 80 nm (◊); mixture of <italic>R</italic><sub><italic>c</italic></sub> = 80 nm and <italic>R</italic><sub><italic>c</italic></sub> = 60 nm: Δ = 20 nm (∘), 45 nm (▫), 80 nm (◊); mixture of <italic>R</italic><sub><italic>c</italic></sub> = 80 nm, <italic>R</italic><sub><italic>c</italic></sub> = 60 nm, and <italic>R</italic><sub><italic>c</italic></sub> = 40 nm: Δ = 20 nm (∘), 35 nm (▫), 80 nm (◊)). The red, dashed line indicates the actual number of simulated clusters: 100 and 120.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pcbi.1008479.s009.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1008479.s010">
      <label>S8 Fig</label>
      <caption>
        <title>F1 Scores for mixture of different cluster sizes.</title>
        <p>F1 Scores for mixture of <italic>R</italic><sub><italic>c</italic></sub> = 80 nm and <italic>R</italic><sub><italic>c</italic></sub> = 40 nm: Δ = 20 nm (∘), 40 nm (▫), 80 nm (◊); mixture of <italic>R</italic><sub><italic>c</italic></sub> = 80 nm and <italic>R</italic><sub><italic>c</italic></sub> = 60 nm: Δ = 20 nm (∘), 45 nm (▫), 80 nm (◊); mixture of <italic>R</italic><sub><italic>c</italic></sub> = 80 nm, <italic>R</italic><sub><italic>c</italic></sub> = 60 nm, and <italic>R</italic><sub><italic>c</italic></sub> = 40 nm: Δ = 20 nm (∘), 35 nm (▫), 80 nm (◊). For simulations at <italic>ζ</italic> = 0.01.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pcbi.1008479.s010.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1008479.s011">
      <label>S9 Fig</label>
      <caption>
        <title>Visualization of cluster analysis for mixture of different simulated cluster sizes.</title>
        <p>Visualization of the mixed population data set (40 clusters of 40 nm, 60 nm and 80 nm cluster sizes each, for a total of 120 clusters) at moderate noise levels (<italic>ζ</italic> = 0.01). A. Raw data with noise localizations included. B. Raw cluster data with noise localizations removed (for visualization purposes). C. FOCAL3D clustering results at <italic>minC</italic> = 13, Δ = 35, as identified from <xref ref-type="supplementary-material" rid="pcbi.1008479.s009">S7 Fig</xref>, with noise localizations removed for visualization purposes. D. FOCAL3D results showing only clustered localizations (noise localizations removed for visualization purposes). A few of the localizations at the edge of each cluster are missed, but FOCAL3D precisely and accurately identifies 120 of the clusters (out of 120).</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pcbi.1008479.s011.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1008479.s012">
      <label>S10 Fig</label>
      <caption>
        <title>Cluster radius vs. grid spacing for NPC dataset.</title>
        <p>Effective cluster radii for NPC dataset at different grid sizes (evaluated at <italic>minC</italic> = 46 in <xref ref-type="fig" rid="pcbi.1008479.g008">Fig 8</xref>). For increasing grid size, the distribution in cluster radii first shifts toward a peaked distribution. Then for larger grids, this peaked distribution gradually diminishes while increasingly extending a long tail (indicating large clusters). This is due to separate, but neighbouring, NPCs being grouped into the same cluster.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pcbi.1008479.s012.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1008479.s013">
      <label>S11 Fig</label>
      <caption>
        <title>NPC cluster analysis at non-optimal parameters.</title>
        <p>FOCAL3D clustering results at <italic>minC</italic> = 46 and grid sizes Δ = 15 nm, 35 nm, and 45 nm. The optimal grid size, shown in the main text, was selected to be Δ = 25. For too small of a grid size (Δ = 15 nm), FOCAL3D misses many clusters. For larger grid sizes (Δ = 35 nm and 45 nm), FOCAL3D joins neighbouring distinct clusters together, indicating sub-optimal performance for this data set.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pcbi.1008479.s013.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1008479.s014">
      <label>S12 Fig</label>
      <caption>
        <title>Cluster radius vs. minC for the NPC dataset.</title>
        <p>Effective cluster radius, determined by convex hull, for NPC dataset at different values of minC (Δ* = 25 nm). A similar behaviour is observed as in the simulations. For small <italic>minC</italic>, several false small clusters are identified. About some optimal value, we find a single peaked distribution. And for too large a choice of <italic>minC</italic>, reasonable, smaller clusters begin to get cut by the size threshold. The average cluster size for a <italic>minC</italic> of 46 is 109 ± 39.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pcbi.1008479.s014.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1008479.s015">
      <label>S13 Fig</label>
      <caption>
        <title>Effective cluster radius from Ripley’s H-function for the NPC dataset.</title>
        <p>Ripley’s H-function (left) and its derivative (right) for the NPC data set. The cluster size is estimated to be about 132 nm.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pcbi.1008479.s015.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <p>We thank Dr. Jonas Ries at EMBL in Heidelberg, Germany for sharing 3D SMLM data on the nuclear pore complex. We also thank Muhammad Kamal for developing a graphical user interface for FOCAL3D. Andreas Hilfinger and Emiel Visser provided valuable feedback on the manuscript.</p>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="pcbi.1008479.ref001">
      <label>1</label>
      <mixed-citation publication-type="journal"><name><surname>Fürstenberg</surname><given-names>A</given-names></name>, <name><surname>Heilemann</surname><given-names>M</given-names></name>. <article-title>Single-molecule localization microscopy-near-molecular spatial resolution in light microscopy with photoswitchable fluorophores</article-title>. <source>Phys Chem Chem Phys</source>. <year>2013</year>;<volume>15</volume>(<issue>36</issue>):<fpage>14919</fpage>–<lpage>30</lpage>. <pub-id pub-id-type="doi">10.1039/c3cp52289j</pub-id><?supplied-pmid 23925641?><pub-id pub-id-type="pmid">23925641</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008479.ref002">
      <label>2</label>
      <mixed-citation publication-type="journal"><name><surname>Betzig</surname><given-names>E</given-names></name>, <name><surname>Patterson</surname><given-names>GH</given-names></name>, <name><surname>Sougrat</surname><given-names>R</given-names></name>, <name><surname>Lindwasser</surname><given-names>OW</given-names></name>, <name><surname>Olenych</surname><given-names>S</given-names></name>, <name><surname>Bonifacino</surname><given-names>JS</given-names></name>, <etal>et al</etal><article-title>Imaging intracellular fluorescent proteins at nanometer resolution</article-title>. <source>Science (New York, NY)</source>. <year>2006</year>;<volume>313</volume>(<issue>5793</issue>):<fpage>1642</fpage>–<lpage>5</lpage>. <pub-id pub-id-type="doi">10.1126/science.1127344</pub-id><?supplied-pmid 16902090?><pub-id pub-id-type="pmid">16902090</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008479.ref003">
      <label>3</label>
      <mixed-citation publication-type="journal"><name><surname>van de Linde</surname><given-names>S</given-names></name>, <name><surname>Löschberger</surname><given-names>A</given-names></name>, <name><surname>Klein</surname><given-names>T</given-names></name>, <name><surname>Heidbreder</surname><given-names>M</given-names></name>, <name><surname>Wolter</surname><given-names>S</given-names></name>, <name><surname>Heilemann</surname><given-names>M</given-names></name>, <etal>et al</etal><article-title>Direct stochastic optical reconstruction microscopy with standard fluorescent probes</article-title>. <source>Nature protocols</source>. <year>2011</year>;<volume>6</volume>(<issue>7</issue>):<fpage>991</fpage>–<lpage>1009</lpage>. <pub-id pub-id-type="doi">10.1038/nprot.2011.336</pub-id><?supplied-pmid 21720313?><pub-id pub-id-type="pmid">21720313</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008479.ref004">
      <label>4</label>
      <mixed-citation publication-type="journal"><name><surname>Jungmann</surname><given-names>R</given-names></name>, <name><surname>Steinhauer</surname><given-names>C</given-names></name>, <name><surname>Scheible</surname><given-names>M</given-names></name>, <name><surname>Kuzyk</surname><given-names>A</given-names></name>, <name><surname>Tinnefeld</surname><given-names>P</given-names></name>, <name><surname>Simmel</surname><given-names>FC</given-names></name>. <article-title>Single-molecule kinetics and super-resolution microscopy by fluorescence imaging of transient binding on DNA origami</article-title>. <source>Nano Lett</source>. <year>2010</year>;<volume>10</volume>(<issue>11</issue>):<fpage>4756</fpage>–<lpage>61</lpage>. <pub-id pub-id-type="doi">10.1021/nl103427w</pub-id><?supplied-pmid 20957983?><pub-id pub-id-type="pmid">20957983</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008479.ref005">
      <label>5</label>
      <mixed-citation publication-type="journal"><name><surname>Huang</surname><given-names>B</given-names></name>, <name><surname>Babcock</surname><given-names>H</given-names></name>, <name><surname>Zhuang</surname><given-names>X</given-names></name>. <article-title>Breaking the diffraction barrier: super-resolution imaging of cells</article-title>. <source>Cell</source>. <year>2010</year>;<volume>143</volume>(<issue>7</issue>):<fpage>1047</fpage>–<lpage>58</lpage>. <pub-id pub-id-type="doi">10.1016/j.cell.2010.12.002</pub-id><?supplied-pmid 21168201?><pub-id pub-id-type="pmid">21168201</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008479.ref006">
      <label>6</label>
      <mixed-citation publication-type="journal"><name><surname>Galbraith</surname><given-names>CG</given-names></name>, <name><surname>Galbraith</surname><given-names>JA</given-names></name>. <article-title>Super-resolution microscopy at a glance</article-title>. <source>Journal of Cell Science</source>. <year>2011</year>;<volume>124</volume>(<issue>10</issue>):<fpage>1607</fpage>–<lpage>1611</lpage>. <pub-id pub-id-type="doi">10.1242/jcs.080085</pub-id><?supplied-pmid 21536831?><pub-id pub-id-type="pmid">21536831</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008479.ref007">
      <label>7</label>
      <mixed-citation publication-type="journal"><name><surname>Pertsinidis</surname><given-names>A</given-names></name>, <name><surname>Zhang</surname><given-names>Y</given-names></name>, <name><surname>Chu</surname><given-names>S</given-names></name>. <article-title>Subnanometre single-molecule localization, registration and distance measurements</article-title>. <source>Nature</source>. <year>2010</year>;<volume>466</volume>(<issue>7306</issue>):<fpage>647</fpage>–<lpage>51</lpage>. <pub-id pub-id-type="doi">10.1038/nature09163</pub-id><?supplied-pmid 20613725?><pub-id pub-id-type="pmid">20613725</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008479.ref008">
      <label>8</label>
      <mixed-citation publication-type="journal"><name><surname>Balzarotti</surname><given-names>F</given-names></name>, <name><surname>Eilers</surname><given-names>Y</given-names></name>, <name><surname>Gwosch</surname><given-names>KC</given-names></name>, <name><surname>Gynnå</surname><given-names>AH</given-names></name>, <name><surname>Westphal</surname><given-names>V</given-names></name>, <name><surname>Stefani</surname><given-names>FD</given-names></name>, <etal>et al</etal><article-title>Nanometer resolution imaging and tracking of fluorescent molecules with minimal photon fluxes</article-title>. <source>Science</source>. <year>2017</year>;<volume>355</volume>(<issue>6325</issue>):<fpage>606</fpage>–<lpage>612</lpage>. <pub-id pub-id-type="doi">10.1126/science.aak9913</pub-id><?supplied-pmid 28008086?><pub-id pub-id-type="pmid">28008086</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008479.ref009">
      <label>9</label>
      <mixed-citation publication-type="journal"><name><surname>Sengupta</surname><given-names>P</given-names></name>, <name><surname>Jovanovic-Talisman</surname><given-names>T</given-names></name>, <name><surname>Lippincott-Schwartz</surname><given-names>J</given-names></name>. <article-title>Quantifying spatial organization in point-localization superresolution images using pair correlation analysis</article-title>. <source>Nature Protocols</source>. <year>2013</year>;<volume>8</volume>(<issue>2</issue>):<fpage>345</fpage>–<lpage>354</lpage>. <pub-id pub-id-type="doi">10.1038/nprot.2013.005</pub-id><?supplied-pmid 23348362?><pub-id pub-id-type="pmid">23348362</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008479.ref010">
      <label>10</label>
      <mixed-citation publication-type="journal"><name><surname>Owen</surname><given-names>DM</given-names></name>, <name><surname>Rentero</surname><given-names>C</given-names></name>, <name><surname>Rossy</surname><given-names>J</given-names></name>, <name><surname>Magenau</surname><given-names>A</given-names></name>, <name><surname>Williamson</surname><given-names>D</given-names></name>, <name><surname>Rodriguez</surname><given-names>M</given-names></name>, <etal>et al</etal><article-title>PALM imaging and cluster analysis of protein heterogeneity at the cell surface</article-title>. <source>Journal of Biophotonics</source>. <year>2010</year>;<volume>3</volume>(<issue>7</issue>):<fpage>446</fpage>–<lpage>454</lpage>. <pub-id pub-id-type="doi">10.1002/jbio.200900089</pub-id><?supplied-pmid 20148419?><pub-id pub-id-type="pmid">20148419</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008479.ref011">
      <label>11</label>
      <mixed-citation publication-type="other">Ester M, Kriegel HP, Sander J, Xu X. A Density-based Algorithm for Discovering Clusters a Density-based Algorithm for Discovering Clusters in Large Spatial Databases with Noise. In: Proceedings of the Second International Conference on Knowledge Discovery and Data Mining. KDD’96. AAAI Press; 1996. p. 226–231.</mixed-citation>
    </ref>
    <ref id="pcbi.1008479.ref012">
      <label>12</label>
      <mixed-citation publication-type="journal"><name><surname>Khater</surname><given-names>IM</given-names></name>, <name><surname>Nabi</surname><given-names>IR</given-names></name>, <name><surname>Hamarneh</surname><given-names>G</given-names></name>. <article-title>A Review of Super-Resolution Single-Molecule Localization Microscopy Cluster Analysis and Quantification Methods</article-title>. <source>Patterns</source>. <year>2020</year>;<volume>1</volume>(<issue>3</issue>):<fpage>100038</fpage><pub-id pub-id-type="doi">10.1016/j.patter.2020.100038</pub-id><?supplied-pmid 33205106?><pub-id pub-id-type="pmid">33205106</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008479.ref013">
      <label>13</label>
      <mixed-citation publication-type="journal"><name><surname>Wu</surname><given-names>YL</given-names></name>, <name><surname>Tschanz</surname><given-names>A</given-names></name>, <name><surname>Krupnik</surname><given-names>L</given-names></name>, <name><surname>Ries</surname><given-names>J</given-names></name>. <article-title>Quantitative Data Analysis in Single-Molecule Localization Microscopy</article-title>. <source>Trends Cell Biol</source>. <year>2020</year>;<volume>30</volume>(<issue>11</issue>):<fpage>837</fpage>–<lpage>51</lpage>. <pub-id pub-id-type="doi">10.1016/j.tcb.2020.07.005</pub-id><pub-id pub-id-type="pmid">32830013</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008479.ref014">
      <label>14</label>
      <mixed-citation publication-type="journal"><name><surname>Mazouchi</surname><given-names>A</given-names></name>, <name><surname>Milstein</surname><given-names>JN</given-names></name>. <article-title>Fast Optimized Cluster Algorithm for Localizations (FOCAL): a spatial cluster analysis for super-resolved microscopy</article-title>. <source>Bioinformatics</source>. <year>2016</year>;<volume>32</volume>(<issue>5</issue>):<fpage>747</fpage>–<lpage>54</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btv630</pub-id><?supplied-pmid 26543172?><pub-id pub-id-type="pmid">26543172</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008479.ref015">
      <label>15</label>
      <mixed-citation publication-type="journal"><name><surname>Griffié</surname><given-names>J</given-names></name>, <name><surname>Shannon</surname><given-names>M</given-names></name>, <name><surname>Bromley</surname><given-names>CL</given-names></name>, <name><surname>Boelen</surname><given-names>L</given-names></name>, <name><surname>Burn</surname><given-names>GL</given-names></name>, <name><surname>Williamson</surname><given-names>DJ</given-names></name>, <etal>et al</etal><article-title>A Bayesian cluster analysis method for single-molecule localization microscopy data</article-title>. <source>Nature Protocols</source>. <year>2016</year>;<volume>11</volume>(<issue>12</issue>):<fpage>2499</fpage>–<lpage>2514</lpage>. <pub-id pub-id-type="doi">10.1038/nprot.2016.149</pub-id><?supplied-pmid 27854362?><pub-id pub-id-type="pmid">27854362</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008479.ref016">
      <label>16</label>
      <mixed-citation publication-type="journal"><name><surname>Levet</surname><given-names>F</given-names></name>, <name><surname>Hosy</surname><given-names>E</given-names></name>, <name><surname>Kechkar</surname><given-names>A</given-names></name>, <name><surname>Butler</surname><given-names>C</given-names></name>, <name><surname>Beghin</surname><given-names>A</given-names></name>, <name><surname>Choquet</surname><given-names>D</given-names></name>, <etal>et al</etal><article-title>SR-Tesseler: a method to segment and quantify localization-based super-resolution microscopy data</article-title>. <source>Nature Methods</source>. <year>2015</year>;<volume>12</volume>(<issue>11</issue>):<fpage>1065</fpage>–<lpage>1071</lpage>. <pub-id pub-id-type="doi">10.1038/nmeth.3579</pub-id><?supplied-pmid 26344046?><pub-id pub-id-type="pmid">26344046</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008479.ref017">
      <label>17</label>
      <mixed-citation publication-type="journal"><name><surname>Griffié</surname><given-names>J</given-names></name>, <name><surname>Shlomovich</surname><given-names>L</given-names></name>, <name><surname>Williamson</surname><given-names>DJ</given-names></name>, <name><surname>Shannon</surname><given-names>M</given-names></name>, <name><surname>Aaron</surname><given-names>J</given-names></name>, <name><surname>Khuon</surname><given-names>S</given-names></name>, <etal>et al</etal><article-title>3D Bayesian cluster analysis of super-resolution data reveals LAT recruitment to the T cell synapse</article-title>. <source>Scientific Reports</source>. <year>2017</year>;<volume>7</volume>(<issue>1</issue>):<fpage>4077</fpage><pub-id pub-id-type="doi">10.1038/s41598-017-04450-w</pub-id><?supplied-pmid 28642595?><pub-id pub-id-type="pmid">28642595</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008479.ref018">
      <label>18</label>
      <mixed-citation publication-type="journal"><name><surname>Andronov</surname><given-names>L</given-names></name>, <name><surname>Michalon</surname><given-names>J</given-names></name>, <name><surname>Ouararhni</surname><given-names>K</given-names></name>, <name><surname>Orlov</surname><given-names>I</given-names></name>, <name><surname>Hamiche</surname><given-names>A</given-names></name>, <name><surname>Vonesch</surname><given-names>JL</given-names></name>, <etal>et al</etal><article-title>3DClusterViSu: 3D clustering analysis of super-resolution microscopy data by 3D Voronoi tessellations</article-title>. <source>Bioinformatics</source>. <year>2018</year>;<volume>34</volume>(<issue>17</issue>):<fpage>3004</fpage>–<lpage>3012</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/bty200</pub-id><?supplied-pmid 29635310?><pub-id pub-id-type="pmid">29635310</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008479.ref019">
      <label>19</label>
      <mixed-citation publication-type="journal"><name><surname>Khater</surname><given-names>IM</given-names></name>, <name><surname>Nabi</surname><given-names>IR</given-names></name>, <name><surname>Hamarneh</surname><given-names>G</given-names></name>. <article-title>A Review of Super-Resolution Single-Molecule Localization Microscopy Cluster Analysis and Quantification Methods</article-title>. <source>Patterns</source>. <year>2020</year>;<volume>1</volume>(<issue>3</issue>):<fpage>100038</fpage><pub-id pub-id-type="doi">10.1016/j.patter.2020.100038</pub-id><?supplied-pmid 33205106?><pub-id pub-id-type="pmid">33205106</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008479.ref020">
      <label>20</label>
      <mixed-citation publication-type="journal"><name><surname>Endesfelder</surname><given-names>U</given-names></name>, <name><surname>Malkusch</surname><given-names>S</given-names></name>, <name><surname>Fricke</surname><given-names>F</given-names></name>, <name><surname>Heilemann</surname><given-names>M</given-names></name>. <article-title>A simple method to estimate the average localization precision of a single-molecule localization microscopy experiment</article-title>. <source>Histochem Cell Biol</source>. <year>2014</year>;<volume>141</volume>(<issue>6</issue>):<fpage>629</fpage>–<lpage>38</lpage>. <pub-id pub-id-type="doi">10.1007/s00418-014-1192-3</pub-id><?supplied-pmid 24522395?><pub-id pub-id-type="pmid">24522395</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008479.ref021">
      <label>21</label>
      <mixed-citation publication-type="journal"><name><surname>Li</surname><given-names>Y</given-names></name>, <name><surname>Mund</surname><given-names>M</given-names></name>, <name><surname>Hoess</surname><given-names>P</given-names></name>, <name><surname>Deschamps</surname><given-names>J</given-names></name>, <name><surname>Matti</surname><given-names>U</given-names></name>, <name><surname>Nijmeijer</surname><given-names>B</given-names></name>, <etal>et al</etal><article-title>Real-time 3D single-molecule localization using experimental point spread functions</article-title>. <source>Nat Methods</source>. <year>2018</year>;<volume>15</volume>(<issue>5</issue>):<fpage>367</fpage>–<lpage>369</lpage>. <pub-id pub-id-type="doi">10.1038/nmeth.4661</pub-id><?supplied-pmid 29630062?><pub-id pub-id-type="pmid">29630062</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008479.ref022">
      <label>22</label>
      <mixed-citation publication-type="journal"><name><surname>Sage</surname><given-names>D</given-names></name>, <name><surname>Pham</surname><given-names>TA</given-names></name>, <name><surname>Babcock</surname><given-names>H</given-names></name>, <name><surname>Lukes</surname><given-names>T</given-names></name>, <name><surname>Pengo</surname><given-names>T</given-names></name>, <name><surname>Chao</surname><given-names>J</given-names></name>, <etal>et al</etal><article-title>Super-resolution fight club: assessment of 2D and 3D single-molecule localization microscopy software</article-title>. <source>Nat Methods</source>. <year>2019</year>;<volume>16</volume>(<issue>5</issue>):<fpage>387</fpage>–<lpage>395</lpage>. <pub-id pub-id-type="doi">10.1038/s41592-019-0364-4</pub-id><?supplied-pmid 30962624?><pub-id pub-id-type="pmid">30962624</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008479.ref023">
      <label>23</label>
      <mixed-citation publication-type="journal"><name><surname>Thevathasan</surname><given-names>JV</given-names></name>, <name><surname>Kahnwald</surname><given-names>M</given-names></name>, <name><surname>Cieśliński</surname><given-names>K</given-names></name>, <name><surname>Hoess</surname><given-names>P</given-names></name>, <name><surname>Peneti</surname><given-names>SK</given-names></name>, <name><surname>Reitberger</surname><given-names>M</given-names></name>, <etal>et al</etal><article-title>Nuclear pores as versatile reference standards for quantitative superresolution microscopy</article-title>. <source>Nature Methods</source>. <year>2019</year>;<volume>16</volume>(<issue>10</issue>):<fpage>1045</fpage>–<lpage>1053</lpage>. <pub-id pub-id-type="doi">10.1038/s41592-019-0574-9</pub-id><?supplied-pmid 31562488?><pub-id pub-id-type="pmid">31562488</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008479.ref024">
      <label>24</label>
      <mixed-citation publication-type="journal"><name><surname>Annibale</surname><given-names>P</given-names></name>, <name><surname>Vanni</surname><given-names>S</given-names></name>, <name><surname>Scarselli</surname><given-names>M</given-names></name>, <name><surname>Rothlisberger</surname><given-names>U</given-names></name>, <name><surname>Radenovic</surname><given-names>A</given-names></name>. <article-title>Identification of clustering artifacts in photoactivated localization microscopy</article-title>. <source>Nature Methods</source>. <year>2011</year>;<volume>8</volume>(<issue>7</issue>):<fpage>527</fpage>–<lpage>528</lpage>. <pub-id pub-id-type="doi">10.1038/nmeth.1627</pub-id><?supplied-pmid 21666669?><pub-id pub-id-type="pmid">21666669</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008479.ref025">
      <label>25</label>
      <mixed-citation publication-type="journal"><name><surname>Sengupta</surname><given-names>P</given-names></name>, <name><surname>Jovanovic-Talisman</surname><given-names>T</given-names></name>, <name><surname>Skoko</surname><given-names>D</given-names></name>, <name><surname>Renz</surname><given-names>M</given-names></name>, <name><surname>Veatch</surname><given-names>SL</given-names></name>, <name><surname>Lippincott-Schwartz</surname><given-names>J</given-names></name>. <article-title>Probing protein heterogeneity in the plasma membrane using PALM and pair correlation analysis</article-title>. <source>Nature Methods</source>. <year>2011</year>;<volume>8</volume>(<issue>11</issue>):<fpage>969</fpage>–<lpage>975</lpage>. <pub-id pub-id-type="doi">10.1038/nmeth.1704</pub-id><?supplied-pmid 21926998?><pub-id pub-id-type="pmid">21926998</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008479.ref026">
      <label>26</label>
      <mixed-citation publication-type="journal"><name><surname>Baumgart</surname><given-names>F</given-names></name>, <name><surname>Arnold</surname><given-names>AM</given-names></name>, <name><surname>Leskovar</surname><given-names>K</given-names></name>, <name><surname>Staszek</surname><given-names>K</given-names></name>, <name><surname>Fölser</surname><given-names>M</given-names></name>, <name><surname>Weghuber</surname><given-names>J</given-names></name>, <etal>et al</etal><article-title>Varying label density allows artifact-free analysis of membrane-protein nanoclusters</article-title>. <source>Nature Methods</source>. <year>2016</year>;<volume>13</volume>(<issue>8</issue>):<fpage>661</fpage>–<lpage>664</lpage>. <pub-id pub-id-type="doi">10.1038/nmeth.3897</pub-id><?supplied-pmid 27295310?><pub-id pub-id-type="pmid">27295310</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008479.ref027">
      <label>27</label>
      <mixed-citation publication-type="journal"><name><surname>Nino</surname><given-names>D</given-names></name>, <name><surname>Djayakarsana</surname><given-names>D</given-names></name>, <name><surname>Milstein</surname><given-names>JN</given-names></name>. <article-title>Nanoscopic Stoichiometry and Single-Molecule Counting</article-title>. <source>Small Methods</source>. <year>2019</year>;<volume>3</volume>(<issue>10</issue>):<fpage>1900082</fpage><pub-id pub-id-type="doi">10.1002/smtd.201900082</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008479.ref028">
      <label>28</label>
      <mixed-citation publication-type="journal"><name><surname>Arnold</surname><given-names>AM</given-names></name>, <name><surname>Schneider</surname><given-names>MC</given-names></name>, <name><surname>Hüsson</surname><given-names>C</given-names></name>, <name><surname>Sablatnig</surname><given-names>R</given-names></name>, <name><surname>Brameshuber</surname><given-names>M</given-names></name>, <name><surname>Baumgart</surname><given-names>F</given-names></name>, <etal>et al</etal><article-title>Verifying molecular clusters by 2-color localization microscopy and significance testing</article-title>. <source>Scientific Reports</source>. <year>2020</year>;<volume>10</volume>(<issue>1</issue>):<fpage>4230</fpage><pub-id pub-id-type="doi">10.1038/s41598-020-60976-6</pub-id><?supplied-pmid 32144344?><pub-id pub-id-type="pmid">32144344</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
