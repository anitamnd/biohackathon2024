<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6873395</article-id>
    <article-id pub-id-type="publisher-id">2882</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-019-2882-6</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Methodology</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>metaSPARSim: a 16S rRNA gene sequencing count data simulator</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Patuzzi</surname>
          <given-names>Ilaria</given-names>
        </name>
        <address>
          <email>ipatuzzi@izsvenezie.it</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Baruzzo</surname>
          <given-names>Giacomo</given-names>
        </name>
        <address>
          <email>giacomo.baruzzo@unipd.it</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Losasso</surname>
          <given-names>Carmen</given-names>
        </name>
        <address>
          <email>closasso@izsvenezie.it</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ricci</surname>
          <given-names>Antonia</given-names>
        </name>
        <address>
          <email>aricci@izsvenezie.it</email>
        </address>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Di Camillo</surname>
          <given-names>Barbara</given-names>
        </name>
        <address>
          <email>barbara.dicamillo@unipd.it</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 1757 3470</institution-id><institution-id institution-id-type="GRID">grid.5608.b</institution-id><institution>Department of Information Engineering, University of Padova, </institution></institution-wrap>via Giovanni Gradenigo, 6, Padova, 35131 Italy </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 1805 1826</institution-id><institution-id institution-id-type="GRID">grid.419593.3</institution-id><institution>Microbial Ecology Unit, Istituto Zooprofilattico Sperimentale delle Venezie, </institution></institution-wrap>Viale dell’Università, 10, Legnaro (PD), 35020 Italy </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 1805 1826</institution-id><institution-id institution-id-type="GRID">grid.419593.3</institution-id><institution>Istituto Zooprofilattico Sperimentale delle Venezie, </institution></institution-wrap>Viale dell’Università, 10, Legnaro (PD), 35020 Italy </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>22</day>
      <month>11</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>22</day>
      <month>11</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2019</year>
    </pub-date>
    <volume>20</volume>
    <issue>Suppl 9</issue>
    <issue-sponsor>Publication of this supplement has not been supported by sponsorship. Information about the source of funding for publication charges can be found in the individual articles. The articles have undergone the journal's standard peer review process for supplements. The Supplement Editors declare that they have no competing interests.</issue-sponsor>
    <elocation-id>416</elocation-id>
    <history>
      <date date-type="received">
        <day>19</day>
        <month>4</month>
        <year>2019</year>
      </date>
      <date date-type="accepted">
        <day>7</day>
        <month>5</month>
        <year>2019</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2019</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold> This article is distributed under the terms of the Creative Commons Attribution 4.0 International License(<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The Creative Commons Public Domain Dedication waiver(<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p>In the last few years, 16S rRNA gene sequencing (16S rDNA-seq) has seen a surprisingly rapid increase in election rate as a methodology to perform microbial community studies. Despite the considerable popularity of this technique, an exiguous number of specific tools are currently available for proper 16S rDNA-seq count data preprocessing and simulation. Indeed, the great majority of tools have been developed adapting methodologies previously used for bulk RNA-seq data, with poor assessment of their applicability in the metagenomics field. For such tools and the few ones specifically developed for 16S rDNA-seq data, performance assessment is challenging, mainly due to the complex nature of the data and the lack of realistic simulation models. In fact, to the best of our knowledge, no software thought for data simulation are available to directly obtain synthetic 16S rDNA-seq count tables that properly model heavy sparsity and compositionality typical of these data.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p>In this paper we present metaSPARSim, a sparse count matrix simulator intended for usage in development of 16S rDNA-seq metagenomic data processing pipelines. metaSPARSim implements a new generative process that models the sequencing process with a Multivariate Hypergeometric distribution in order to realistically simulate 16S rDNA-seq count table, resembling real experimental data compositionality and sparsity. It provides ready-to-use count matrices and comes with the possibility to reproduce different pre-coded scenarios and to estimate simulation parameters from real experimental data. The tool is made available at <ext-link ext-link-type="uri" xlink:href="http://sysbiobig.dei.unipd.it/?q=Software#metaSPARSim">http://sysbiobig.dei.unipd.it/?q=Software#metaSPARSim</ext-link>and <ext-link ext-link-type="uri" xlink:href="https://gitlab.com/sysbiobig/metasparsim">https://gitlab.com/sysbiobig/metasparsim</ext-link>.</p>
      </sec>
      <sec>
        <title>Conclusion</title>
        <p>metaSPARSim is able to generate count matrices resembling real 16S rDNA-seq data. The availability of count data simulators is extremely valuable both for methods developers, for which a ground truth for tools validation is needed, and for users who want to assess state of the art analysis tools for choosing the most accurate one. Thus, we believe that metaSPARSim is a valuable tool for researchers involved in developing, testing and using robust and reliable data analysis methods in the context of 16S rRNA gene sequencing.</p>
      </sec>
      <sec>
        <title>Electronic supplementary material</title>
        <p>The online version of this article (10.1186/s12859-019-2882-6) contains supplementary material, which is available to authorized users.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>16S rRNA</kwd>
      <kwd>Metagenomic</kwd>
      <kwd>Simulator</kwd>
      <kwd>Sparse</kwd>
      <kwd>Count data</kwd>
      <kwd>Microbiome</kwd>
      <kwd>Compositional</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100003500</institution-id>
            <institution>Università degli Studi di Padova</institution>
          </institution-wrap>
        </funding-source>
        <award-id>-</award-id>
      </award-group>
    </funding-group>
    <conference xlink:href="http://bioinformatics.it/">
      <conf-name>Annual Meeting of the Bioinformatics Italian Society (BITS 2018)</conf-name>
      <conf-acronym>BITS 2018</conf-acronym>
      <conf-loc>Turin, Italy</conf-loc>
      <conf-date>27 - 29 June 2018</conf-date>
    </conference>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2019</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p>Next generation sequencing (NGS) has now become the most widely used approach to perform microbial community studies. In particular, the discovery of the 16S ribosomial RNA universal marker gene and the ever-decreasing experimental costs of sequencing, made it the most adopted method for taxonomic studies [<xref ref-type="bibr" rid="CR1">1</xref>–<xref ref-type="bibr" rid="CR3">3</xref>]. Among all NGS methodologies, targeted amplicon sequencing of the 16S ribosomial RNA (16S rRNA) gene, referred to as “16S rDNA-seq” from here on, is currently one of the most used strategies for the identification and quantification of microbial population residing in a specific ecological niche. The 16S rRNA gene was chosen as a target because of its ubiquitous presence in prokaryotes and its natural structure that is made from both highly conserved and highly variable regions. The conserved regions are used as amplification targets for polymerase chain reaction (PCR) universal primers to select one or more hypervariable regions of the 16S rRNA gene [<xref ref-type="bibr" rid="CR4">4</xref>–<xref ref-type="bibr" rid="CR6">6</xref>]. The variable regions are species-specific regions that demonstrate considerable sequence diversity among different bacteria and consequently allow for taxonomic classification and phylogenetic analysis. After targeted amplification, the obtained fragments undergo the sequencing process from which thousands of nucleotidic sequences, called “reads”, are obtained. Then, reads are usually clustered according to their sequence similarity into the so-called “operational taxonomic units” (OTUs) or into Amplicon Sequence Variants (ASVs). The number of reads corresponding to each OTU/ASV is used as a proxy of the abundance of that feature in the original sample and results are summarized in a matrix known as “OTU table”. In this table, OTUs are organized by row and samples by column and each matrix entry is filled with the number of reads belonging to each OTU within each sample. Throughout the manuscript, we will refer to these numbers as “counts” and we will use the terms “taxon”, “OTU”, “ASV”, “species” and “feature” interchangeably to identify the rows of these matrices. Additionally, many experimental conditions (also called “groups” in this work) are usually present within the same experiment; for example, samples from “treated” vs “control” individuals or samples from different body sites may be present. Samples belonging to the same group are referred to as biological replicates.</p>
    <p>The analysis of 16S count data is usually performed using either methods developed for RNA sequencing or methods, when available, specifically developed for 16S count data. Benchmarking these different methods against common gold standards would be a good practice to identify the best analysis pipelines and to improve the quality of data analysis methods.</p>
    <p>However, 16S rDNA-seq data characteristics, such as strong sparsity and variability levels, make their simulation challenging, also due to the difficulty of choosing the most appropriate generating model. In the following sections, we first report a brief excursus of the models that have been proposed in the literature for modelling count data and then, we summarize 16S rDNA-seq data simulation state-of-the-art. Finally, we introduce metaSPARSim, a stand alone tool specifically proposed for 16S count data simulation.</p>
    <sec id="Sec2">
      <title>Modelling sequencing count data</title>
      <p>In the past years, several models were proposed to describe the nature of sequencing count data. A classical approach for modelling count data is by using a Poisson random variable, <italic>Y</italic><sub><italic>ij</italic></sub>, whose parameter <italic>λ</italic><sub><italic>ik</italic></sub> represents the mean expected count value for feature <italic>i</italic> in experimental group <italic>k</italic> to which sample <italic>j</italic> belongs. The above model has a well known main characteristic, that is the mean equals the variance. This modellization is based on the fact that a DNA sample can be seen as a collection of fragments taken from the species present within it and then DNA sequencing can be compared to a random sampling of the species, with the aim of estimating the relative abundance of each species in the niche. If we think each DNA fragment like having the same chance of being selected for sequencing and the fragments being selected independently, then the number of counts for a given feature in repeated measurements could be described with a Poisson variation law. The consistency of this hypothesis has been examined in Marioni et al. [<xref ref-type="bibr" rid="CR7">7</xref>], in which the same initial collection of RNA distributed across multiple lanes of Genome Analyzer (Illumina) sequencer was used. In this work, the Poisson model turned out to be a good description of technical replicates for most of the features. When biological replicates are also considered, the count variance is observed to be higher then the mean (the so-called over-dispersion phenomenon) due to the fact that the number of fragments for the same species among different samples is affected by biological variability. Therefore, to describe the biological plus technical variability, another well established approach based on the Negative Binomial (NB) distribution has been adopted in sequencing count data modellization [<xref ref-type="bibr" rid="CR8">8</xref>, <xref ref-type="bibr" rid="CR9">9</xref>]. The NB arises as a compound probability distribution where the distribution of the Poisson rate <italic>λ</italic><sub><italic>ik</italic></sub> is described by a gamma distribution, which is why the NB is also called Poisson-gamma mixture distribution. Due to the extra-variation introduced by the gamma component, the resulting distribution then acts like an over-dispersed Poisson model. Indeed, according to this model the total variance of <italic>Y</italic><sub><italic>ij</italic></sub> is:
<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ Var(Y_{ij})=\lambda_{ik}(1+\lambda_{ik}\phi_{ik}),  $$ \end{document}</tex-math><mml:math id="M2"><mml:mtext mathvariant="italic">Var</mml:mtext><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ik</mml:mtext></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ik</mml:mtext></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ik</mml:mtext></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>,</mml:mo></mml:math><graphic xlink:href="12859_2019_2882_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>where <italic>ϕ</italic><sub><italic>ik</italic></sub> is known as the dispersion parameter. When <italic>ϕ</italic><sub><italic>ik</italic></sub> goes to zero, the variance of <italic>Y</italic><sub><italic>ij</italic></sub> equals its mean, thus obtaining again the Poisson distribution.</p>
      <p>Both the above modellizations come from bulk RNA sequencing count data context and their translation in 16S rDNA-seq framework is not straightforward. In fact, 16S rDNA-seq OTU tables share with RNA-seq count data some main characteristics, such that of being non-negative and over-dispersed, but they are typically affected by a high number of zeros. The latter phenomenon is known as “zero-inflation”. As recalled in Xu et al. [<xref ref-type="bibr" rid="CR10">10</xref>], one way to deal with such a big amount of zeros in count data is to use zero-inflated (ZI) models [<xref ref-type="bibr" rid="CR11">11</xref>], which are basically mixtures of Poisson (ZIP) or Negative Binomial (ZINB) models with a point mass at zero. Another approach is to use a hurdle model [<xref ref-type="bibr" rid="CR12">12</xref>], a model formed by two parts, the first being modelled by a binomial distribution used to determine whether a zero or non-zero outcome occurs, and the second being a count data modelling truncated at zero to characterize positive counts. The main difference between the two approaches lies in the fact that ZI models assume that the zero observations have two different origins: “structural” and “random”. The first zero values are real zeros that indicate the absence of the feature in the sample; whereas, random zeros are caused by insufficient sequencing depth when performing sequencing, thus causing rare taxa to be dropped from the sequenced population. On the contrary, hurdle models do not make the distinction between structural and sampling zeros, assuming that all zero data are from one unique structural source. The idea is that positive counts occur once a threshold is crossed, or a hurdle is cleared. If the hurdle is not cleared, then we have a count of 0.</p>
      <p>It is noteworthy that the above models consider all the features present in a sample as being independent one from each other, thus ignoring the sum constraint imposed by the fact that sequencing platforms can produce reads only up to their capacity (i.e. the sequencing depth). Indeed, it is now well established that sequencing data only carry relative information [<xref ref-type="bibr" rid="CR13">13</xref>, <xref ref-type="bibr" rid="CR14">14</xref>], i.e. count tables entries are not actually absolute counts, but rather portions of a whole. This characteristic, known in the compositional data analysis framework as <italic>scale invariance</italic> [<xref ref-type="bibr" rid="CR15">15</xref>], is in contrast with the assumption of OTU independence and, consequently, with the simulation of count tables modelling single taxa separately [<xref ref-type="bibr" rid="CR16">16</xref>]. To deal with this limitation, Dirichlet-multinomial [<xref ref-type="bibr" rid="CR17">17</xref>, <xref ref-type="bibr" rid="CR18">18</xref>] and logistic normal multinomial models [<xref ref-type="bibr" rid="CR19">19</xref>] have been proposed for modelling all features simultaneously based on their relative abundances.</p>
    </sec>
    <sec id="Sec3">
      <title>Simulation of 16S rDNA-seq count tables in the literature</title>
      <p>Most of the available tools in the literature intended for 16S rDNA-seq data simulation are focused on producing synthetic reads [<xref ref-type="bibr" rid="CR20">20</xref>, <xref ref-type="bibr" rid="CR21">21</xref>]. While such tools are very useful for read-level tasks (e.g. read quality filtering, sequences clustering, etc.), their main goal is generating realistic nucleotide sequences, more than achieving realistic reads abundances. In addition, simulated reads must be processed to obtain the final OTU table, requiring additional and computational intensive steps.</p>
      <p>The availability of simulators for synthetic count data generation is of pivotal importance for all those researchers who deal with benchmarking or testing procedures to assess the performance of available preprocessing and analysis methods. To serve this function, a simulator has to encompass some key characteristics. First, its code has to be available for users in a direct way, such that the simulating procedure is encoded and easily reproducible by anyone. Second, it should be accompanied by a user guide in which the simulation procedure is clearly explained so that misuses of the tool are avoided. Third, input parameters should be provided either directly or indirectly (e.g. by automatic estimation from a real dataset) in order not to leave the user the full charge of making assumptions and hypothesis on them. Lastly, but very important, the simulator should have been tested before the release and a sufficient evaluation of its performance should be available before releasing it to the scientific community. To the best of our knowledge, no simulator with the above mentioned features is now available in the literature for a user-friendly simulation of 16S rDNA-seq count tables. Indeed, the distributions used to model 16S data were originally proposed as modelling frameworks addressing data analysis issues (clustering, classification, variable selection, etc.) [<xref ref-type="bibr" rid="CR17">17</xref>–<xref ref-type="bibr" rid="CR19">19</xref>] and not with the aim of giving researchers a tool for synthetic data generation. Therefore, no comprehensive assessment of goodness of simulated data via comparison with real experimental data was included in the original works. Additionally, even though several benchmarking papers are based on these modellizations ([<xref ref-type="bibr" rid="CR22">22</xref>–<xref ref-type="bibr" rid="CR24">24</xref>]), each of these studies includes its own synthetic data simulation, and no simulating tool with an appropriate guide for data simulation has been released within these works. For example, in Chen et al. work [<xref ref-type="bibr" rid="CR25">25</xref>] a novel test for differential distribution analysis of microbiome sequencing data is proposed and the authors use the ZINB model to simulate synthetic datasets for testing their method performance. In Chen et al., only a part of the R scripts used for simulation is freely accessible, mainly for illustrative purpose. Another work, by Kurtz et al. [<xref ref-type="bibr" rid="CR26">26</xref>], proposes a statistical method for the inference of microbial ecological networks from 16S rDNA-seq data accompanied by computational tools able to generate OTU count data. The simulation procedure is included within the ecological networks inference tool package. However, the related tutorial only shows how to launch a zero-inflated negative binomial simulation with some specified parameters and very little space was given in the paper to assess simulation performance.</p>
    </sec>
    <sec id="Sec4">
      <title>Rationale of our work</title>
      <p>Our simulator is proposed as a stand-alone tool intended for simulating synthetic 16S count tables to be used for the assessment of tools for preprocessing and downstream analysis, such as count data normalization, zero-values imputation, differential abundance testing and so on. metaSPARSim is freely accessible and equipped with a user guide where examples and applications to possible benchmarking frameworks are included to facilitate scientists in the usage of its estimation and simulation functionalities.</p>
      <p>In this article, the Multivariate hypergeometric (MHG) distribution is exploited to accurately model 16S rDNA-seq count data. The proposed modellization is included in metaSPARSim, a novel 16S rDNA-seq count table simulator implemented as an R package (see below). We model 16S gene sequencing as a sampling process with limited number of extractions and not independent sampling, i.e. under a multivariate framework. Contrarily to the above mentioned multinomial models, our model considers sampling modellization of the sequencing procedure without replacement; this reflects the fact that the probability that a read comes from a precise bacterial agent is dependent on the abundance of that and the other agents within the total population, but it is variable during sequencing, because when a fragment is captured and read, it is no longer available for other binding sites. That is, one member of that bacterial class is no longer available for the future drawings.</p>
      <p>In the literature MHG distribution is approximated by the Multinomial in many applications and sampling with or without replacement are converging models when the population size and the sampling size are sufficiently far away one from each other so that different fragment sampling probabilities can be considered as constants. However, the shape of the population class abundance vector distribution greatly influences the allowed magnitude of the gap between population and sampling size for Multinomial-MHG convergence and therefore it does not exist a unique and standard cut-off to numerically guarantee the legitimacy and applicability of this approximation. Indeed, the replacement effect on a uniformly distributed and on a strongly-skewed distribution would be very different. The proposed MHG modellization overcomes the problem of verifying if the conditions for multinomial approximation hold, providing a framework that is theoretically more rigorous and realistic to model real abundance inter-dependency.</p>
      <p>To obtain typical overdispersion detected in 16S rRNA data, the parameters defining internal classes subdivision for the MHG distribution are modelled according to a gamma distribution.</p>
    </sec>
  </sec>
  <sec id="Sec5">
    <title>Methods</title>
    <sec id="Sec6">
      <title>The model</title>
      <p>metaSPARSim simulation is based on a two-steps gamma-MHG model: first, species abundances varying between biological replicates are modeled using a gamma distribution; second, the technical variability originated by the sequencing process is modelled using a Multivariate Hypergeometric model.</p>
      <p>In particular, let <italic>C</italic> be the number of observed features (OTUs) and <bold>Y</bold><sub><italic>j</italic></sub> the vector of counts <italic>Y</italic><sub><italic>ij</italic></sub> for feature <italic>i</italic> in sample <italic>j</italic> belonging to experimental group <italic>k</italic>. Then we can write:
<disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ \begin{aligned} \mathbf{Y}_{j}\sim MHG\left(n_{j},\mathbf{m}_{j}\right), \\ m_{ij}\sim Gamma\left(\frac{1}{\phi_{ik}},\phi_{ik}\cdot\mu_{ik}\right). \end{aligned}  $$ \end{document}</tex-math><mml:math id="M4"><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi mathvariant="bold">Y</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mtext mathvariant="italic">MHG</mml:mtext><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">m</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mtext mathvariant="italic">Gamma</mml:mtext><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ik</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ik</mml:mtext></mml:mrow></mml:msub><mml:mo>·</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ik</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mi>.</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="12859_2019_2882_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>where
<list list-type="bullet"><list-item><p><italic>n</italic><sub><italic>j</italic></sub> is the library size of sample <italic>j</italic></p></list-item><list-item><p><bold>m</bold><sub><italic>j</italic></sub>=(<italic>m</italic><sub>1<italic>j</italic></sub>,<italic>m</italic><sub>2<italic>j</italic></sub>,…,<italic>m</italic><sub><italic>Cj</italic></sub>) is the vector indicating the number of fragments that are available in sample <italic>j</italic> for OTU <italic>i</italic> before sequencing</p></list-item><list-item><p><italic>μ</italic><sub><italic>ik</italic></sub> is the “average” abundance level of OTU <italic>i</italic> in group <italic>k</italic>, to which sample <italic>j</italic> belongs</p></list-item><list-item><p><italic>ϕ</italic><sub><italic>ik</italic></sub> is a parameter describing the biological variability in the abundance level of OTU <italic>i</italic> in group <italic>k</italic>, to which sample <italic>j</italic> belongs.</p></list-item></list></p>
    </sec>
    <sec id="Sec7">
      <title>The tool</title>
      <p>metaSPARSim is a tool written in <italic>R</italic> language with core function implementation in <italic>C++</italic> (<italic>C++</italic> code was integrated into the R script using <italic>Rcpp</italic> library). It generates datasets with a number of experimental groups and biological replicates specified by the user in input. For each sample group, the simulation takes as input a vector of species abundances, together with a measure of biological variability. These parameters can be specified by the user, estimated from a real dataset or taken from a set of pre-coded scenarios that are integrated into the simulator. For each OTU, a gamma distribution with specified mean and variance is used to generate species abundances in different replicates. Then, the sequencing step is reproduced by sampling the wanted sequencing depth from each biological replicate accordingly to a MHG distribution, whose internal probabilities are defined by sample-specific proportional abundances.</p>
      <p>In the following, metaSPARSim inputs, outputs and available precoded datasets are presented.</p>
      <sec id="Sec8">
        <title>Inputs</title>
        <p>The simulation of 16S rDNA-seq data needs as input a pair of vectors (<italic>μ</italic><sub><italic>ik</italic></sub> and <italic>ϕ</italic><sub><italic>ik</italic></sub>) modelling abundance and biological variance for each group <italic>k</italic> and OTU <italic>i</italic> (see Eq. <xref rid="Equ2" ref-type="">2</xref>). In addition, the library size for each simulated sample is needed. To specify the above parameters, the user can choose among three different input modes, as follows. Case 1. <bold>Direct specification</bold> In the first modality, the user can specify his/her own parameters. Once the number of sample groups is fixed, the only compulsory parameters to give the simulator for each group are:
<list list-type="bullet"><list-item><p>One vector of species abundances, (<italic>μ</italic><sub>1<italic>k</italic></sub>,…,<italic>μ</italic><sub><italic>Ck</italic></sub>)</p></list-item><list-item><p>One vector of species abundance variability, (<italic>ϕ</italic><sub>1<italic>k</italic></sub>,…,<italic>ϕ</italic><sub><italic>Ck</italic></sub>)</p></list-item><list-item><p>One vector of desired library sizes, <inline-formula id="IEq1"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$(n_{1}, \dots, n_{n_{k}})$\end{document}</tex-math><mml:math id="M6"><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2019_2882_Article_IEq1.gif"/></alternatives></inline-formula>, with <italic>n</italic><sub><italic>k</italic></sub> the total number of samples in experimental group <italic>k</italic>.</p></list-item></list>Case 2. <bold>Estimation procedure from real datasets</bold> metaSPARSim also allows for estimation of parameters from real count tables. Obviously, it is not possible to reconstruct real absolute abundances of OTUs from a real dataset. However, a raw estimate to be used as input for the simulation is sufficient, since our purpose here is to obtain from a known input a count table which resembles the characteristics of a real dataset.</p>
        <p>Given a real count matrix, metaSPARSim internally estimates species abundances, species abundance variabilities and library size vectors for simulation by the use of built-in functions (see Additional file <xref rid="MOESM1" ref-type="media">1</xref>). Additionally, also the hybrid mode is available. For example, one may want to take information about mean values from a real experiment while using personally specified vectors of species abundance variabilities or library sizes. Case 3. <bold>Available presets included in the simulator</bold> The user can simulate his/her own 16S count matrix by taking advantage of the pre-coded scenarios present in the simulator (see Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S1). In fact, different sets of parameters taken from real datasets or synthetically designed to describe theoretical distributions of interest in microbiome studies are available in our tool.</p>
      </sec>
      <sec id="Sec9">
        <title>Outputs</title>
        <p>metaSPARSim outputs its results as a list composed by two elements:
<list list-type="bullet"><list-item><p>A matrix containing simulated count data organized with features (OTUs, ASVs, …) on rows and samples on columns. This has to be intended as the count table coming from a simulated sequencing experiment, i.e. a synthetic analogue of an OTU table coming from a targeted microbiome sequencing run.</p></list-item><list-item><p>A matrix with features (OTUs, ASVs, …) on rows and samples on columns containing sample relative abundance values <inline-formula id="IEq2"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\left (m_{ij}/{\sum \nolimits }_{i} m_{ij}\right)$\end{document}</tex-math><mml:math id="M8"><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2019_2882_Article_IEq2.gif"/></alternatives></inline-formula> after the first simulation step of biological variability using the gamma distribution. Despite not being the main result of the simulation procedure, this intermediate output is a fundamental tool for users who want to perform benchmarking on preprocessing/analysis methods dealing with sequencing bias correction or recognition, because it encloses the information about the simulated microbiomes composition before the sequencing step simulation with MHG sampling. This should be indeed intended as the ground truth values to use as golden standard when comparing data processed with, for example, different normalization, zero-imputation or differential abundance tools.</p></list-item></list></p>
      </sec>
    </sec>
    <sec id="Sec10">
      <title>Test datasets and evaluation criteria</title>
      <p>The goodness of metaSPARSim simulations was assessed using both publicly available datasets, such as Human Microbiome Project (HMP) data [<xref ref-type="bibr" rid="CR27">27</xref>, <xref ref-type="bibr" rid="CR28">28</xref>], and two proprietary datasets monitoring animal gut and raw milk cheese microbial communities. The main characteristics of the real datasets used for comparison are shown in Table <xref rid="Tab1" ref-type="table">1</xref> (additional details can be found in Additional file <xref rid="MOESM1" ref-type="media">1</xref>). These datasets were chosen to obtain a wide range of different scenarios, including experiments based on different sequencing platforms and with different group, sample and replicate numbers and sequencing depths.
<table-wrap id="Tab1"><label>Table 1</label><caption><p>Real datasets characteristics</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Characteristic</th><th align="left">Animal gut</th><th align="left">Raw milk cheese</th><th align="left">HMP</th></tr></thead><tbody><tr><td align="left"><italic>Samples</italic></td><td align="left">110</td><td align="left">118</td><td align="left">40</td></tr><tr><td align="left"><italic>Replicates</italic></td><td align="left">5</td><td align="left">2-3</td><td align="left">5</td></tr><tr><td align="left"><italic>Groups</italic></td><td align="left">22</td><td align="left">40</td><td align="left">8</td></tr><tr><td align="left"><italic>Features</italic></td><td align="left">3541</td><td align="left">3109</td><td align="left">758</td></tr><tr><td align="left"><italic>Sequencing depth (range)</italic></td><td align="left">88692-832309</td><td align="left">28536-349754</td><td align="left">2798-24095</td></tr><tr><td align="left"><italic>Count data sparsity</italic></td><td align="left">78.69%</td><td align="left">97.12%</td><td align="left">81.37%</td></tr></tbody></table></table-wrap></p>
      <p>To explore metaSPARSim performance, a comparison between real and simulated data was performed. In particular, we compared real and simulated data in terms of:
<list list-type="bullet"><list-item><p><bold>Sparsity:</bold> the percentage of zero counts per row, per column, and in total;</p></list-item><list-item><p><bold>Intensity:</bold> the normalized (<italic>scran</italic><italic>R</italic> package [<xref ref-type="bibr" rid="CR29">29</xref>] was used) count value intensity averaged across replicates within the same group;</p></list-item><list-item><p><bold>Variability:</bold> the variance and the relative variance of normalized count values, calculated across replicates within the same group.</p></list-item></list></p>
      <p>A Mann-Whitney U test was performed to test for group mean distribution differences between real experimental count tables and simulated count tables for each dataset. Additionally, the related effect size was calculated and a bootstrap procedure (10000 extractions with 5% of total feature number) paired with a Mann-Whitney U test was performed to test for significance in subsamplings, thus overcoming sampling size issue for significance (see Additional file <xref rid="MOESM1" ref-type="media">1</xref> for further details).</p>
    </sec>
  </sec>
  <sec id="Sec11" sec-type="results">
    <title>Results</title>
    <p>
      <bold>
        <italic>Sparsity</italic>
      </bold>
    </p>
    <p>The first examined metric was the level of sparsity of the simulated matrix. The overall zero abundances were very well reproduced in all the datasets, the real ones being of 78.7%, 97.1% and 81.4% and the simulated ones of 77.9%, 93.8% and 80% respectively for animal gut, raw milk cheese and HMP data. For all the three datasets, in Fig. <xref rid="Fig1" ref-type="fig">1</xref> the true sparsity percentages calculated on group submatrices is plotted against the simulated ones. As can be seen, all the results confirm that the accuracy in recreating datasets with realistic overall sparsity remains valid when looking at intra-group sparsity. Additionally, zeros-by-row (feature) and zeros-by-column (samples) distributions were calculated to check if the simulator was able to reconstruct not only the true zero abundance but also the true location of zero counts. As showed in Fig. <xref rid="Fig2" ref-type="fig">2</xref>, the zero distributions per row and per column are well reproduced in all the datasets.
<fig id="Fig1"><label>Fig. 1</label><caption><p>Group-specific sparsity in real and simulated data. Scatter plot of group-specific percentage of zeros in real and simulated datasets. From the left, animal gut, raw milk cheese and HMP data results. <italic>R</italic><sup>2</sup> values are also reported</p></caption><graphic xlink:href="12859_2019_2882_Fig1_HTML" id="MO1"/></fig>
<fig id="Fig2"><label>Fig. 2</label><caption><p>Sample-wise and feature-wise sparsity in real and simulated data. Q −Q plot of percentage of zeros in real and simulated datasets, calculated by sample (<bold>a</bold>, <bold>c</bold>, <bold>e</bold>) and by feature (<bold>b</bold>, <bold>d</bold>, <bold>f</bold>) for animal gut (first row), raw milk cheese (second row) and HMP (third row) data. <italic>R</italic><sup>2</sup> values are also reported</p></caption><graphic xlink:href="12859_2019_2882_Fig2_HTML" id="MO2"/></fig></p>
    <p>
      <bold>
        <italic>Intensity</italic>
      </bold>
    </p>
    <p>Count values in real and simulated data showed very similar characteristics, as shown by RDI (Raw (data), Description and Inference) plots (Fig. <xref rid="Fig3" ref-type="fig">3</xref>a, c, e) and scatter plots (Fig. <xref rid="Fig3" ref-type="fig">3</xref>b, d, f). The performances observed for whole count data were maintained when looking at the intensity within each group (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figures S4–S12), assuring that the overall good behaviour was the result of a good performance in each single group.
<fig id="Fig3"><label>Fig. 3</label><caption><p>Count intensity in real and simulated data. Comparison of Log2 count mean intensity in real and simulated datasets, represented as RDI plot (<bold>a</bold>, <bold>c</bold>, <bold>e</bold>) and scatter plot (<bold>b</bold>, <bold>d</bold>, <bold>f</bold>) for animal gut (first row), raw milk cheese (second row) and HMP (third row) data, excluding zero mean features</p></caption><graphic xlink:href="12859_2019_2882_Fig3_HTML" id="MO3"/></fig></p>
    <p>Results of the statistical tests (shown in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Tables S2–S4) confirmed real and simulated values came from the same distribution. In fact, although many groups showed significant differences for the global test, the related effect size was always found to be negligible and the percentage of bootstrap extractions in which significance was found was null for all the groups, thus confirming significance was strongly due to the huge sample sizes (number of features).</p>
    <p>To further investigate the ability to reproduce real experimental data structure and characteristics, the relation between the first two metrics (intensity and sparsity) was studied. As reported in Fig. <xref rid="Fig4" ref-type="fig">4</xref>, the dependency between mean intensity and sparsity was accurately maintained from real to simulated datasets, for all the three investigated cases.
<fig id="Fig4"><label>Fig. 4</label><caption><p>Intensity-sparsity relation in real and simulated data. Scatter plot of the relation between Log2 count mean intensity and sparsity in real and simulated datasets, for animal gut (<bold>a</bold>), raw milk cheese (<bold>b</bold>) and HMP (<bold>c</bold>) data, excluding zero mean features</p></caption><graphic xlink:href="12859_2019_2882_Fig4_HTML" id="MO4"/></fig></p>
    <p>
      <bold>Variability</bold>
    </p>
    <p>For variability metric, results are shown in terms of both variance and relative variance (RV, or variance-to-mean ratio), i.e.
<disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ RV=\frac{\sigma^{2}}{\mu}.  $$ \end{document}</tex-math><mml:math id="M10"><mml:mtext mathvariant="italic">RV</mml:mtext><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi>μ</mml:mi></mml:mrow></mml:mfrac><mml:mi>.</mml:mi></mml:math><graphic xlink:href="12859_2019_2882_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula></p>
    <p>As for intensity, metaSPARSim was able to reproduce in a realistic way data variability in HMP and animal gut datasets, while for raw milk cheese data it was able to capture the median values (Fig. <xref rid="Fig5" ref-type="fig">5</xref> and Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figures S14–S25). However, no statistical difference was found between real and simulated data variance, the effect sizes being always negligible and the bootstrap percentage of significant tests always being under the 9% (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Tables S5–S7).
<fig id="Fig5"><label>Fig. 5</label><caption><p>Count variability in real and simulated data. Comparison of Log2 variability values in real and simulated datasets, calculated as variance (<bold>a</bold>, <bold>c</bold>, <bold>e</bold>) and RV (<bold>b</bold>, <bold>d</bold>, <bold>f</bold>). Results are shown for animal gut (first row), raw milk cheese (second row) and HMP (third row) data, excluding zero mean features</p></caption><graphic xlink:href="12859_2019_2882_Fig5_HTML" id="MO5"/></fig></p>
    <p>Lastly, the goodness in recreating the dependency between variance and intensity was investigated for all the datasets. The results (Fig. <xref rid="Fig6" ref-type="fig">6</xref>) showed a very good adherence to real experimental data characteristics, with animal gut dataset being the one for which we obtained the best results and raw milk cheese dataset being the most problematic one.
<fig id="Fig6"><label>Fig. 6</label><caption><p>Intensity-variability relation in real and simulated data. Scatter plot of the relation between Log2 count mean intensity and variability in real and simulated datasets, for animal gut (<bold>a</bold>), raw milk cheese (<bold>b</bold>) and HMP (<bold>c</bold>) data, excluding zero mean features</p></caption><graphic xlink:href="12859_2019_2882_Fig6_HTML" id="MO6"/></fig></p>
  </sec>
  <sec id="Sec15" sec-type="discussion">
    <title>Discussion</title>
    <p>Despite a number of different models to simulate 16S rDNA-seq count data were proposed during the last years, no consensus on which one is the most appropriate to use has been reached yet. Additionally, to the best of our knowledge, no simulation tool that underwent adequate validation procedure is currently available to produce synthetic 16S sequencing datasets. Indeed, a lot of different simulation procedures have been proposed in the various banchmarking and new methods presentation papers. However, none of these includes a well-documented, freely accessible and easily usable 16S rDNA-seq count data simulator.</p>
    <p>In this work, we propose a gamma-MHG model in which the sequencing process is modelled as a sampling without replacement, i.e. with variable internal probabilities, that follows the rationale of experimental data production and captures directly the mechanisms of structural and random zeros generation. Adopting this modellization, it is possible to consider the compositional nature of 16S rDNA-seq data and to produce sparsity and variability in a natural and intrinsic way, avoiding artificial and possibly imprecise zero count introduction. Indeed, according to this modellization, zero count values rise naturally from the sampling procedure, following the real scenario in which rare OTUs result more frequently than others in zero counts because they are the most probable features not read (i.e. sampled) by the sequencer.</p>
    <p>The metaSPARSim performance assessment was performed by considering real OTU tables, estimating the parameters for simulation from them and comparing the resulting simulated count matrices with the real ones, as also done by Zappia et al. in their work [<xref ref-type="bibr" rid="CR30">30</xref>]. We tested our 16S rDNA-seq data simulator in three very different conditions. This allowed to obtain a solid assessment of performance in different situations.</p>
    <p>In particular, the animal gut dataset was characterized by a good number of biological replicates per group (5) and a high but not extreme sparsity level (78.7%). metaSPARSim was able to reconstruct real experimental data properties almost perfectly, in terms of all the three features (sparsity, intensity and variability) considered. In all three scenarios, intensity-sparsity and intensity-variance dependencies, were faithfully reproduced.</p>
    <p>Secondly, HMP dataset was chosen to add another challenging element to the testing framework, i.e. a very high biological variability. The biological replicates present in these data were indeed constituted by samples collected in the same body site, but from different individuals and, consequently, they presented a higher variability. The tests confirmed the robustness of the simulator even in this scenario. In fact, simulated sparsity, intensity and variability correctly mimicked the real ones, proving the ability of metaSPARSim in producing realistic human-microbiome-like synthetic dataset.</p>
    <p>When the raw milk cheese data were used as metaSPARSim input, a worsening of the performance was observed. We hypothesized that the reason was a poor estimate of the input parameters due to the low number of replicates per experimental group (2 or 3) and the high number of zeros (97.1%). To test this hypothesis, we performed an experiment artificially diminishing the number of replicates and augmenting the number of zeros used in HMP dataset to estimate the input parameters for the simulation. Indeed, the performance of the simulator dropped in terms of ability to reproduce the original dataset. Note however that, in a simulation framework, the purpose is not to create a copy of a real dataset, but rather to generate a realistic count table from a known given input.</p>
    <p>A possible limitation of this work is the lack of comparison with other simulation approaches proposed in the literature. However, as said above, the availability of simulators for synthetic count data generation is limited to papers that use simulators to benchmark new proposed analysis methods or literature methods. Most of the times, a software is not available, but only the R scripts used to perform the simulations are released with poor guidelines about how to use them. In addition, in order to compare the resulting simulated count matrices with the real ones, a simulator should accept as input real OTU tables and estimate the parameters for the simulation from them. For the above reasons, a direct comparison with other software tools was not possible within this work.</p>
  </sec>
  <sec id="Sec16" sec-type="conclusion">
    <title>Conclusions</title>
    <p>The availability of count data simulators is extremely valuable for methods developers, which can exploit the ground truth provided by simulated data to test and validate their tools. In addition, simulated data are useful even for end users who want to find the most accurate analysis methods fitting their dataset characteristics among the many available in the literature. Indeed, the availability of simulated data allows to assess state of the art analysis tools and to identify the more suitable one for the specific scenario. Thus, we believe that metaSPARSim could be a valuable tool for researchers involved in developing, testing and using robust and reliable data analysis methods in the context of 16S rDNA-seq.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Additional file</title>
    <sec id="Sec17">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="12859_2019_2882_MOESM1_ESM.pdf">
            <label>Additional file 1</label>
            <caption>
              <p>Supplementary material, including Supplementary Figures and Tables. (PDF 8514 kb)</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>HMP</term>
        <def>
          <p>Human microbiome project</p>
        </def>
      </def-item>
      <def-item>
        <term>HTS</term>
        <def>
          <p>High-throughput sequencing</p>
        </def>
      </def-item>
      <def-item>
        <term>MHG</term>
        <def>
          <p>Multivariate hypergeometric</p>
        </def>
      </def-item>
      <def-item>
        <term>NB</term>
        <def>
          <p>Negative binomial</p>
        </def>
      </def-item>
      <def-item>
        <term>NBH</term>
        <def>
          <p>Negative binomial hurdle</p>
        </def>
      </def-item>
      <def-item>
        <term>NGS</term>
        <def>
          <p>Next generation sequencing</p>
        </def>
      </def-item>
      <def-item>
        <term>OTU</term>
        <def>
          <p>Operational taxonomic unit</p>
        </def>
      </def-item>
      <def-item>
        <term>PCR</term>
        <def>
          <p>Polymerase chain reaction</p>
        </def>
      </def-item>
      <def-item>
        <term>PH</term>
        <def>
          <p>Poisson hurdle</p>
        </def>
      </def-item>
      <def-item>
        <term>RDI</term>
        <def>
          <p>Raw (data), description and inference</p>
        </def>
      </def-item>
      <def-item>
        <term>ZI</term>
        <def>
          <p>Zero-inflated</p>
        </def>
      </def-item>
      <def-item>
        <term>ZINB</term>
        <def>
          <p>Zero-inflated negative binomial</p>
        </def>
      </def-item>
      <def-item>
        <term>ZIP</term>
        <def>
          <p>Zero-inflated Poisson</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher’s Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>We thank the Istituto Zooprofilattico Sperimentale delle Venezie for experimental data production and Professor Lorenzo Finesso for the fruitful discussions about statistical modelling of count data. We would also like to thank the reviewers for their constructive comments that greatly contributed to the improvement of the paper and the Editor for the helpful remarks and the support during the review process.</p>
    <sec id="d29e1464">
      <title>About this supplement</title>
      <p>This article has been published as part of BMC Bioinformatics, Volume 20 Supplement 9, 2019: Italian Society of Bioinformatics (BITS): Annual Meeting 2018. The full contents of the supplement are available at <ext-link ext-link-type="uri" xlink:href="https://bmcbioinformatics.biomedcentral.com/articles/supplements/volume-20-supplement-9">https://bmcbioinformatics.biomedcentral.com/articles/supplements/volume-20-supplement-9</ext-link>.</p>
    </sec>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>IP developed metaSPARSim count modelizzation, with the help of GB and the supervision of BDC. IP and GB developed the metaSPARSim R package. IP performed testing and analyses. AR and CL provided the proprietary experimental data and helped in formulation of ideas. IP wrote the paper, with the help of GB. IP, GB an BDC read and revised the work. All the authors have read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>Publication costs are funded by the project PROACTIVE 2017 “From Single-Cell to Multi-Cells Information Systems Analysis” (Department of Information Engineering, University of Padova).</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>metaSPARSim is available at <ext-link ext-link-type="uri" xlink:href="http://sysbiobig.dei.unipd.it/?q=Software#metaSPARSim">http://sysbiobig.dei.unipd.it/?q=Software#metaSPARSim</ext-link>and <ext-link ext-link-type="uri" xlink:href="https://gitlab.com/sysbiobig/metasparsim">https://gitlab.com/sysbiobig/metasparsim</ext-link>under GNU General Public License. The other datasets generated and analyzed during the current study are available from the corresponding author on reasonable request.</p>
  </notes>
  <notes>
    <title>Ethics approval and consent to participate</title>
    <p>The experimental design was approved by IZSVe ethical committee (OpBA project n. 05/2015).</p>
  </notes>
  <notes>
    <title>Consent for publication</title>
    <p>Not applicable.</p>
  </notes>
  <notes notes-type="COI-statement">
    <title>Competing interests</title>
    <p>The authors declare that they have no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Choi</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Wyss</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Göbel</surname>
            <given-names>U</given-names>
          </name>
        </person-group>
        <article-title>Phylogenetic analysis of pathogen-related oral spirochetes</article-title>
        <source>J Clin Microbiol</source>
        <year>1996</year>
        <volume>34</volume>
        <issue>8</issue>
        <fpage>1922</fpage>
        <lpage>5</lpage>
        <?supplied-pmid 8818882?>
        <pub-id pub-id-type="pmid">8818882</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Munson</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Banerjee</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Watson</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Wade</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>Molecular analysis of the microflora associated with dental caries</article-title>
        <source>J Clin Microbiol</source>
        <year>2004</year>
        <volume>42</volume>
        <issue>7</issue>
        <fpage>3023</fpage>
        <lpage>9</lpage>
        <pub-id pub-id-type="doi">10.1128/JCM.42.7.3023-3029.2004</pub-id>
        <pub-id pub-id-type="pmid">15243054</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schmalenberger</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Schwieger</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Tebbe</surname>
            <given-names>CC</given-names>
          </name>
        </person-group>
        <article-title>Effect of primers hybridizing to different evolutionarily conserved regions of the small-subunit rRNA gene in PCR-based microbial community analyses and genetic profiling</article-title>
        <source>Appl Environ Microbiol</source>
        <year>2001</year>
        <volume>67</volume>
        <issue>8</issue>
        <fpage>3557</fpage>
        <lpage>63</lpage>
        <pub-id pub-id-type="doi">10.1128/AEM.67.8.3557-3563.2001</pub-id>
        <pub-id pub-id-type="pmid">11472932</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Qian</surname>
            <given-names>PY</given-names>
          </name>
        </person-group>
        <article-title>Conservative fragments in bacterial 16S rRNA genes and primer design for 16S ribosomal DNA amplicons in metagenomic studies</article-title>
        <source>PloS ONE</source>
        <year>2009</year>
        <volume>4</volume>
        <issue>10</issue>
        <fpage>e7401</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0007401</pub-id>
        <pub-id pub-id-type="pmid">19816594</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sambo</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Finotello</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Lavezzo</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Baruzzo</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Masi</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Peta</surname>
            <given-names>E</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Optimizing PCR primers targeting the bacterial 16S ribosomal RNA gene</article-title>
        <source>BMC Bioinformatics</source>
        <year>2018</year>
        <volume>19</volume>
        <issue>1</issue>
        <fpage>343</fpage>
        <pub-id pub-id-type="doi">10.1186/s12859-018-2360-6</pub-id>
        <pub-id pub-id-type="pmid">30268091</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dieffenbach</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Lowe</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Dveksler</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>General concepts for PCR primer design</article-title>
        <source>PCR Methods Appl</source>
        <year>1993</year>
        <volume>3</volume>
        <issue>3</issue>
        <fpage>S30</fpage>
        <lpage>7</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.3.3.S30</pub-id>
        <pub-id pub-id-type="pmid">8118394</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Marioni</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Mason</surname>
            <given-names>CE</given-names>
          </name>
          <name>
            <surname>Mane</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Stephens</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Gilad</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>RNA-seq: an assessment of technical reproducibility and comparison with gene expression arrays</article-title>
        <source>Genome Res</source>
        <year>2008</year>
        <volume>18.9</volume>
        <fpage>1509</fpage>
        <lpage>17</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.079558.108</pub-id>
        <pub-id pub-id-type="pmid">18550803</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Anders</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Huber</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>Differential expression analysis for sequence count data</article-title>
        <source>Genome Biol</source>
        <year>2010</year>
        <volume>11</volume>
        <issue>10</issue>
        <fpage>R106</fpage>
        <pub-id pub-id-type="doi">10.1186/gb-2010-11-10-r106</pub-id>
        <pub-id pub-id-type="pmid">20979621</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Robinson</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>McCarthy</surname>
            <given-names>DJ</given-names>
          </name>
        </person-group>
        <article-title>Smyth GK. edgeR: a Bioconductor package for differential expression analysis of digital gene expression data</article-title>
        <source>Bioinformatics</source>
        <year>2010</year>
        <volume>26</volume>
        <issue>1</issue>
        <fpage>139</fpage>
        <lpage>40</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btp616</pub-id>
        <pub-id pub-id-type="pmid">19910308</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Xu</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Paterson</surname>
            <given-names>AD</given-names>
          </name>
          <name>
            <surname>Turpin</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>Assessment and selection of competing models for zero-inflated microbiome data</article-title>
        <source>PloS ONE</source>
        <year>2015</year>
        <volume>10</volume>
        <issue>7</issue>
        <fpage>e0129606</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0129606</pub-id>
        <pub-id pub-id-type="pmid">26148172</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lambert</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Zero-inflated Poisson regression, with an application to defects in manufacturing</article-title>
        <source>Technometrics</source>
        <year>1992</year>
        <volume>34</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>14</lpage>
        <pub-id pub-id-type="doi">10.2307/1269547</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mullahy</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Specification and testing of some modified count data models</article-title>
        <source>J Econ</source>
        <year>1986</year>
        <volume>33</volume>
        <issue>3</issue>
        <fpage>341</fpage>
        <lpage>65</lpage>
        <pub-id pub-id-type="doi">10.1016/0304-4076(86)90002-3</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Quinn</surname>
            <given-names>TP</given-names>
          </name>
          <name>
            <surname>Erb</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Richardson</surname>
            <given-names>MF</given-names>
          </name>
          <name>
            <surname>Crowley</surname>
            <given-names>TM</given-names>
          </name>
        </person-group>
        <article-title>Understanding sequencing data as compositions: an outlook and review</article-title>
        <source>Bioinformatics</source>
        <year>2018</year>
        <volume>34</volume>
        <issue>16</issue>
        <fpage>2870</fpage>
        <lpage>8</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bty175</pub-id>
        <pub-id pub-id-type="pmid">29608657</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Vandeputte</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Kathagen</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>D’hoe</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Vieira-Silva</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Valles-Colomer</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Sabino</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Quantitative microbiome profiling links gut community variation to microbial load</article-title>
        <source>Nature</source>
        <year>2017</year>
        <volume>551</volume>
        <fpage>507</fpage>
        <lpage>11</lpage>
        <pub-id pub-id-type="doi">10.1038/nature24460</pub-id>
        <pub-id pub-id-type="pmid">29143816</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Pawlowsky-Glahn</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Egozcue</surname>
            <given-names>JJ</given-names>
          </name>
          <name>
            <surname>Tolosana-Delgado</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <source>Modeling and analysis of compositional data</source>
        <year>2015</year>
        <publisher-loc>Hoboken</publisher-loc>
        <publisher-name>Wiley</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Äijö</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Müller</surname>
            <given-names>CL</given-names>
          </name>
          <name>
            <surname>Bonneau</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Temporal probabilistic modeling of bacterial compositions derived from 16S rRNA sequencing</article-title>
        <source>Bioinformatics</source>
        <year>2017</year>
        <volume>34</volume>
        <issue>3</issue>
        <fpage>372</fpage>
        <lpage>80</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btx549</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Variable selection for sparse Dirichlet-multinomial regression with an application to microbiome data analysis</article-title>
        <source>Ann Appl Stat</source>
        <year>2013</year>
        <volume>7</volume>
        <issue>1</issue>
        <fpage>418</fpage>
        <lpage>42</lpage>
        <pub-id pub-id-type="doi">10.1214/12-AOAS592</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Holmes</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Harris</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Quince</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Dirichlet multinomial mixtures: generative models for microbial metagenomics</article-title>
        <source>PloS ONE</source>
        <year>2012</year>
        <volume>7</volume>
        <issue>2</issue>
        <fpage>e30126</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0030126</pub-id>
        <pub-id pub-id-type="pmid">22319561</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Xia</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Fung</surname>
            <given-names>WK</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>A logistic normal multinomial regression model for microbiome compositional data analysis</article-title>
        <source>Biometrics</source>
        <year>2013</year>
        <volume>69</volume>
        <issue>4</issue>
        <fpage>1053</fpage>
        <lpage>63</lpage>
        <pub-id pub-id-type="doi">10.1111/biom.12079</pub-id>
        <pub-id pub-id-type="pmid">24128059</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Angly</surname>
            <given-names>FE</given-names>
          </name>
          <name>
            <surname>Willner</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Rohwer</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Hugenholtz</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Tyson</surname>
            <given-names>GW</given-names>
          </name>
        </person-group>
        <article-title>Grinder: a versatile amplicon and shotgun sequence simulator</article-title>
        <source>Nucleic Acids Res</source>
        <year>2012</year>
        <volume>40</volume>
        <issue>12</issue>
        <fpage>e94</fpage>
        <pub-id pub-id-type="doi">10.1093/nar/gks251</pub-id>
        <pub-id pub-id-type="pmid">22434876</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Richter</surname>
            <given-names>DC</given-names>
          </name>
          <name>
            <surname>Ott</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Auch</surname>
            <given-names>AF</given-names>
          </name>
          <name>
            <surname>Schmid</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Huson</surname>
            <given-names>DH</given-names>
          </name>
        </person-group>
        <article-title>MetaSim—a sequencing simulator for genomics and metagenomics</article-title>
        <source>PloS ONE</source>
        <year>2008</year>
        <volume>3</volume>
        <issue>10</issue>
        <fpage>e3373</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0003373</pub-id>
        <pub-id pub-id-type="pmid">18841204</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hawinkel</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Mattiello</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Bijnens</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Thas</surname>
            <given-names>O</given-names>
          </name>
        </person-group>
        <article-title>A broken promise: microbiome differential abundance methods do not control the false discovery rate</article-title>
        <source>Brief Bioinform</source>
        <year>2017</year>
        <volume>20.1</volume>
        <fpage>210</fpage>
        <lpage>21</lpage>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Weiss</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>ZZ</given-names>
          </name>
          <name>
            <surname>Peddada</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Amir</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Bittinger</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Gonzalez</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Normalization and microbial differential abundance strategies depend upon data characteristics</article-title>
        <source>Microbiome</source>
        <year>2017</year>
        <volume>5</volume>
        <issue>1</issue>
        <fpage>27</fpage>
        <pub-id pub-id-type="doi">10.1186/s40168-017-0237-y</pub-id>
        <pub-id pub-id-type="pmid">28253908</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>McMurdie</surname>
            <given-names>PJ</given-names>
          </name>
          <name>
            <surname>Holmes</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Waste not, want not: why rarefying microbiome data is inadmissible</article-title>
        <source>PLoS Comput Biol</source>
        <year>2014</year>
        <volume>10</volume>
        <issue>4</issue>
        <fpage>e1003531</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1003531</pub-id>
        <pub-id pub-id-type="pmid">24699258</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>King</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Deek</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Wei</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Yu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Grill</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>An omnibus test for differential distribution analysis of microbiome sequencing data</article-title>
        <source>Bioinformatics</source>
        <year>2017</year>
        <volume>34</volume>
        <issue>4</issue>
        <fpage>643</fpage>
        <lpage>51</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btx650</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kurtz</surname>
            <given-names>ZD</given-names>
          </name>
          <name>
            <surname>Müller</surname>
            <given-names>CL</given-names>
          </name>
          <name>
            <surname>Miraldi</surname>
            <given-names>ER</given-names>
          </name>
          <name>
            <surname>Littman</surname>
            <given-names>DR</given-names>
          </name>
          <name>
            <surname>Blaser</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Bonneau</surname>
            <given-names>RA</given-names>
          </name>
        </person-group>
        <article-title>Sparse and compositionally robust inference of microbial ecological networks</article-title>
        <source>PLoS Comput Biol</source>
        <year>2015</year>
        <volume>11</volume>
        <issue>5</issue>
        <fpage>e1004226</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1004226</pub-id>
        <pub-id pub-id-type="pmid">25950956</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huttenhower</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Gevers</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Knight</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Abubucker</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Badger</surname>
            <given-names>JH</given-names>
          </name>
          <name>
            <surname>Chinwalla</surname>
            <given-names>AT</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Structure, function and diversity of the healthy human microbiome</article-title>
        <source>Nature</source>
        <year>2012</year>
        <volume>486</volume>
        <issue>7402</issue>
        <fpage>207</fpage>
        <pub-id pub-id-type="doi">10.1038/nature11234</pub-id>
        <pub-id pub-id-type="pmid">22699609</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Methé</surname>
            <given-names>BA</given-names>
          </name>
          <name>
            <surname>Nelson</surname>
            <given-names>KE</given-names>
          </name>
          <name>
            <surname>Pop</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Creasy</surname>
            <given-names>HH</given-names>
          </name>
          <name>
            <surname>Giglio</surname>
            <given-names>MG</given-names>
          </name>
          <name>
            <surname>Huttenhower</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A framework for human microbiome research</article-title>
        <source>Nature</source>
        <year>2012</year>
        <volume>486</volume>
        <issue>7402</issue>
        <fpage>215</fpage>
        <pub-id pub-id-type="doi">10.1038/nature11209</pub-id>
        <pub-id pub-id-type="pmid">22699610</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lun</surname>
            <given-names>ATL</given-names>
          </name>
          <name>
            <surname>McCarthy</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>Marioni</surname>
            <given-names>JC</given-names>
          </name>
        </person-group>
        <article-title>A step-by-step workflow for low-level analysis of single-cell RNA-seq data with Bioconductor</article-title>
        <source>F1000Res</source>
        <year>2016</year>
        <volume>5</volume>
        <fpage>2122</fpage>
        <?supplied-pmid 27909575?>
        <pub-id pub-id-type="pmid">27909575</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zappia</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Phipson</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Oshlack</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Splatter: simulation of single-cell RNA sequencing data</article-title>
        <source>Genome Biol</source>
        <year>2017</year>
        <volume>18</volume>
        <issue>1</issue>
        <fpage>174</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-017-1305-0</pub-id>
        <pub-id pub-id-type="pmid">28899397</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
