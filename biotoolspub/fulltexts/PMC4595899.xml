<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d1 20130915//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 39.96?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-id journal-id-type="hwp">bioinfo</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">4595899</article-id>
    <article-id pub-id-type="pmid">26099264</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btv368</article-id>
    <article-id pub-id-type="publisher-id">btv368</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Notes</subject>
        <subj-group subj-group-type="heading">
          <subject>Gene Expression</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title><italic>Sincell</italic>: an R/Bioconductor package for statistical assessment of cell-state hierarchies from single-cell RNA-seq</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Juliá</surname>
          <given-names>Miguel</given-names>
        </name>
        <xref ref-type="aff" rid="btv368-AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="btv368-AFF2">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Telenti</surname>
          <given-names>Amalio</given-names>
        </name>
        <xref ref-type="aff" rid="btv368-AFF3">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Rausell</surname>
          <given-names>Antonio</given-names>
        </name>
        <xref ref-type="aff" rid="btv368-AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="btv368-AFF2">
          <sup>2</sup>
        </xref>
        <xref ref-type="corresp" rid="btv368-COR1">*</xref>
      </contrib>
      <aff id="btv368-AFF1"><sup>1</sup>Vital-IT group, SIB Swiss Institute of Bioinformatics, 1015 Lausanne, Switzerland,</aff>
      <aff id="btv368-AFF2"><sup>2</sup>University of Lausanne, 1015 Lausanne, Switzerland and</aff>
      <aff id="btv368-AFF3"><sup>3</sup>J. Craig Venter Institute, La Jolla, CA 92037</aff>
    </contrib-group>
    <author-notes>
      <corresp id="btv368-COR1">*To whom correspondence should be addressed.</corresp>
      <fn id="btv368-FN1">
        <p>Associate Editor: Ivo Hofacker</p>
      </fn>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>15</day>
      <month>10</month>
      <year>2015</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>22</day>
      <month>6</month>
      <year>2015</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>22</day>
      <month>6</month>
      <year>2015</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the
							<pub-date pub-type="epub"/>. -->
    <volume>31</volume>
    <issue>20</issue>
    <fpage>3380</fpage>
    <lpage>3382</lpage>
    <history>
      <date date-type="received">
        <day>29</day>
        <month>1</month>
        <year>2015</year>
      </date>
      <date date-type="rev-recd">
        <day>31</day>
        <month>5</month>
        <year>2015</year>
      </date>
      <date date-type="accepted">
        <day>10</day>
        <month>6</month>
        <year>2015</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author 2015. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2015</copyright-year>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/" license-type="creative-commons">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <abstract>
      <p><bold>Summary:</bold> Cell differentiation processes are achieved through a continuum of hierarchical intermediate cell states that might be captured by single-cell RNA seq. Existing computational approaches for the assessment of cell-state hierarchies from single-cell data can be formalized under a general framework composed of (i) a metric to assess cell-to-cell similarities (with or without a dimensionality reduction step) and (ii) a graph-building algorithm (optionally making use of a cell clustering step). The <italic>Sincell</italic> R package implements a methodological toolbox allowing flexible workflows under such a framework. Furthermore, <italic>Sincell</italic> contributes new algorithms to provide cell-state hierarchies with statistical support while accounting for stochastic factors in single-cell RNA seq. Graphical representations and functional association tests are provided to interpret hierarchies. The functionalities of <italic>Sincell</italic> are illustrated in a real case study, which demonstrates its ability to discriminate noisy from stable cell-state hierarchies.</p>
      <p><bold>Availability and implementation:</bold><italic>Sincell</italic> is an open-source R/Bioconductor package available at <ext-link ext-link-type="uri" xlink:href="http://bioconductor.org/packages/sincell">http://bioconductor.org/packages/sincell</ext-link>. A detailed manual and a vignette are provided with the package.</p>
      <p>
        <bold>Contact:</bold>
        <email>antonio.rausell@isb-sib.ch</email>
      </p>
      <p><bold>Supplementary information</bold>: <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btv368/-/DC1">Supplementary data</ext-link> are available at <italic>Bioinformatics</italic> online.</p>
    </abstract>
    <counts>
      <page-count count="3"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Unbiased profiling of individual cells through single-cell RNA-seq allows assessing heterogeneity of transcriptional states within a cell population (<xref rid="btv368-B8" ref-type="bibr">Wu <italic>et al.</italic>, 2014</xref>). In the context of a cell population’s differentiation or activation process, such transcriptional heterogeneity might reflect a continuum of intermediate cell states and lineages resulting from dynamic regulatory programs. Such a continuum might be captured through the assessment of cell-state hierarchies, where each cell is placed in a relative ordering in the transcriptional landscape. Additionally, statistical support should be provided to discriminate reliable hierarchies from stochastic heterogeneity, arising from both technical and biological factors.</p>
    <p>A number of algorithms have been used to assess cell-state hierarchies from single-cell data (<xref rid="btv368-B1" ref-type="bibr">Amir <italic>et al.</italic>, 2013</xref>; <xref rid="btv368-B2" ref-type="bibr">Bendall <italic>et al.</italic>, 2014</xref>; <xref rid="btv368-B3" ref-type="bibr">Buettner <italic>et al.</italic>, 2015</xref>; <xref rid="btv368-B4" ref-type="bibr">Jaitin <italic>et al.</italic>, 2014</xref>; <xref rid="btv368-B5" ref-type="bibr">Moignard <italic>et al.</italic>, 2015</xref>; <xref rid="btv368-B6" ref-type="bibr">Qiu <italic>et al.</italic>, 2011</xref>; <xref rid="btv368-B7" ref-type="bibr">Trapnell <italic>et al.</italic>, 2014</xref>). These approaches can be formalized under a general framework (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btv368/-/DC1">Supplementary Table S1</ext-link>). Here we present <italic>Sincell</italic>, an R/Bioconductor package where the various building blocks of that general workflow are extended and combined (<xref ref-type="fig" rid="btv368-F1">Fig. 1</xref>). Notably, <italic>Sincell</italic> implements algorithms to provide statistical support to the cell-state hierarchies derived from single-cell RNA-seq. The package is complemented with graphical representations and functional association tests to help interpret the results.
<fig id="btv368-F1" orientation="portrait" position="float"><label>Fig. 1.</label><caption><p>Overall workflow for the statistical assessment of cell-state hierarchies implemented by the <italic>Sincell</italic> R package. Dashed arrows correspond to optional steps in the analysis</p></caption><graphic xlink:href="btv368f1p"/></fig>
</p>
  </sec>
  <sec>
    <title>2 Description</title>
    <p>As input, <italic>Sincell</italic> requires an expression matrix with user-defined normalized gene expression levels per single cell (<xref ref-type="fig" rid="btv368-F1">Fig. 1</xref>). Variance stabilization is recommended (e.g. through log transformation). First, a cell-to-cell distance matrix is calculated using a metric of choice. <italic>Sincell</italic> provides both linear and non-linear distances: Euclidean, Mutual Information, L1 distance, Pearson and Spearman correlation. Optionally, the distance matrix may be obtained from the leading dimensions of a data reduction technique, performed to keep the most informative parts of the data while excluding noise. Both linear and non-linear algorithms are provided: Principal Component Analysis, Independent Component Analysis, t-Distributed Stochastic Neighbor Embedding and non-metric Multidimensional Scaling.</p>
    <p>Second, a cell-state hierarchy is obtained by applying a graph-building algorithm on the cell-to-cell distance matrix. Graph-building algorithms may consider cells both individually and in clusters of highly similar cells. S<italic>incell</italic> provides different clustering methods (K-Mutual Nearest Neighbors, k-medoids, agglomerative clustering, etc.) and graph-building algorithms (MST, SST and IMC; <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btv368/-/DC1">Supplementary Text</ext-link>).</p>
    <p>Stochastic technical and biological factors may drive cell-state heterogeneity observed in single-cell RNA seq data. Additionally, hierarchies derived from experiments with a low number of individual cells (e.g. 96 cells when using a Fluidigm C1<sup>™</sup> Single-Cell Auto Prep System) are more susceptible to noise artifacts than experiments profiling thousands of individual cells (e.g. flow cytometry data). <italic>Sincell</italic> implements two algorithms to discriminate reliable hierarchies from noise-driven ones. The first strategy relies on a gene resampling procedure. The second one is based on random cell substitution with <italic>in silico</italic>-generated cell replicates. These replicates are built by perturbing observed gene expression levels with random noise, following patterns of stochasticity observed in single-cell RNA-seq (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btv368/-/DC1">Supplementary Text</ext-link>). Either approach generates a population of hierarchies whose similarities to the reference show the distribution of the hierarchy stability against changes in the data.</p>
    <p>To help interpret hierarchies in functional terms, <italic>Sincell</italic> provides graphical representations of cell-to-cell similarities in low-dimensional space as well as different graph displays of hierarchies, coloring cells, e.g. by expression levels of a marker of choice. Furthermore, <italic>Sincell</italic> implements an algorithm to determine the statistical significance of the association of the hierarchy with the expression levels of a given gene set (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btv368/-/DC1">Supplementary Text</ext-link>). Gene set collections (e.g. Gene Ontology terms) can be systematically evaluated.</p>
  </sec>
  <sec>
    <title>3 Application</title>
    <p>The <italic>Sincell</italic> R package includes a detailed vignette illustrating all functionalities using real single-cell RNA-seq data. We use data from (<xref rid="btv368-B7" ref-type="bibr">Trapnell <italic>et al.</italic>, 2014</xref>) quantifying gene expression levels in differentiating myoblast at 0, 24, 48 and 72 h. Here, we analyze each time-point separately and evaluate the statistical evidence of cell-state heterogeneity within them (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btv368/-/DC1">Supplementary Fig. 1</ext-link>). Our results show that early differentiation timepoints produce unstable hierarchies suggesting a low level of cell-state heterogeneity. However, late differentiation timepoints produce statistically significant hierarchies that reflect cell-state diversity along the differentiation process (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btv368/-/DC1">Supplementary Text</ext-link>).</p>
  </sec>
  <sec>
    <title>4 Discussion</title>
    <p>The landscape of computational approaches to assess cell-state hierarchies from single-cell data is far from being fully explored. The diversity of biological studies and rapid evolution of single-cell technologies require a comprehensive toolbox where users may easily tailor workflows and compare alternative methods and assumptions. Furthermore, cell-state hierarchies should be statistically supported before being used as input in subsequent analyses. The <italic>Sincell</italic> R package addresses these needs by providing a general analysis framework, new algorithms for statistical support as well as tools for functional interpretation of cell-state hierarchies.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>This research was supported by the <funding-source>European Union's Seventh Framework Programme</funding-source>
<award-id>FP7/2007-2013/</award-id> under grant agreement no. 305762 and the <funding-source>Swiss National Science Foundation</funding-source> grant no. <award-id>149724</award-id>. Computations were performed at the Vital-IT (<ext-link ext-link-type="uri" xlink:href="http://www.vital-it.ch">http://www.vital-it.ch</ext-link>) Center for high-performance computing of the SIB Swiss Institute of Bioinformatics.</p>
    <p><italic>Conflict of interest</italic>: none declared.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="PMC_1" content-type="local-data">
      <caption>
        <title>Supplementary Data</title>
      </caption>
      <media mimetype="text" mime-subtype="html" xlink:href="supp_31_20_3380__index.html"/>
      <media xlink:role="associated-file" mimetype="application" mime-subtype="pdf" xlink:href="supp_btv368_Sincell_Bioinformatics_Rausell_SuppInfo_v2_online.pdf"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <ref-list>
    <title>References</title>
    <ref id="btv368-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Amir</surname><given-names>E.D.</given-names></name><etal/></person-group> (<year>2013</year>) <article-title>viSNE enables visualization of high dimensional single-cell data and reveals phenotypic heterogeneity of leukemia</article-title>. <source>Nat. Biotechnol.</source>, <volume>31</volume>, <fpage>545</fpage>–<lpage>552</lpage>.<pub-id pub-id-type="pmid">23685480</pub-id></mixed-citation>
    </ref>
    <ref id="btv368-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bendall</surname><given-names>S.C.</given-names></name><etal/></person-group> (<year>2014</year>) <article-title>Single-cell trajectory detection uncovers progression and regulatory coordination in human B cell development</article-title>. <source>Cell</source>, <volume>157</volume>, <fpage>714</fpage>–<lpage>725</lpage>.<pub-id pub-id-type="pmid">24766814</pub-id></mixed-citation>
    </ref>
    <ref id="btv368-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Buettner</surname><given-names>F.</given-names></name><etal/></person-group> (<year>2015</year>) <article-title>Computational analysis of cell-to-cell heterogeneity in single-cell RNA-sequencing data reveals hidden subpopulations of cells</article-title>. <source>Nat. Biotechnol.</source>, <volume>33</volume>, <fpage>155</fpage>–<lpage>160</lpage>.<pub-id pub-id-type="pmid">25599176</pub-id></mixed-citation>
    </ref>
    <ref id="btv368-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jaitin</surname><given-names>D.A.</given-names></name><etal/></person-group> (<year>2014</year>) <article-title>Massively parallel single-cell RNA-seq for marker-free decomposition of tissues into cell types</article-title>. <source>Science</source>, <volume>343</volume>, <fpage>776</fpage>–<lpage>779</lpage>.<pub-id pub-id-type="pmid">24531970</pub-id></mixed-citation>
    </ref>
    <ref id="btv368-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Moignard</surname><given-names>V.</given-names></name><etal/></person-group> (<year>2015</year>) <article-title>Decoding the regulatory network of early blood development from single-cell gene expression measurements</article-title>. <source>Nat. Biotechnol.</source>, <volume>33</volume>, <fpage>269</fpage>–<lpage>276</lpage>.<pub-id pub-id-type="pmid">25664528</pub-id></mixed-citation>
    </ref>
    <ref id="btv368-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Qiu</surname><given-names>P.</given-names></name><etal/></person-group> (<year>2011</year>) <article-title>Extracting a cellular hierarchy from high-dimensional cytometry data with SPADE</article-title>. <source>Nat. Biotechnol.</source>, <volume>29</volume>, <fpage>886</fpage>–<lpage>891</lpage>.<pub-id pub-id-type="pmid">21964415</pub-id></mixed-citation>
    </ref>
    <ref id="btv368-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Trapnell</surname><given-names>C.</given-names></name><etal/></person-group> (<year>2014</year>) <article-title>The dynamics and regulators of cell fate decisions are revealed by pseudotemporal ordering of single cells</article-title>. <source>Nat. Biotechnol.</source>, <volume>32</volume>, <fpage>381</fpage>–<lpage>386</lpage>.<pub-id pub-id-type="pmid">24658644</pub-id></mixed-citation>
    </ref>
    <ref id="btv368-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wu</surname><given-names>A.R.</given-names></name><etal/></person-group> (<year>2014</year>) <article-title>Quantitative assessment of single-cell RNA-sequencing methods</article-title>. <source>Nat. Methods</source>, <volume>11</volume>, <fpage>41</fpage>–<lpage>46</lpage>.<pub-id pub-id-type="pmid">24141493</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
