<?all-math-mml yes?>
<?use-mml?>
<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName nihms2pmcx2.xsl?>
<?ConverterInfo.Version 1?>
<?origin ukpmcpa?>
<?ManuscriptPrefix new?>
<?iso-abbr Nat Biotechnol?>
<?submitter-system ukmss?>
<?submitter-canonical-name Nature Publishing Group?>
<?submitter-canonical-id NATURE-STRUCTUR?>
<?submitter-userid 0?>
<?submitter-authority publisher?>
<?submitter-login NPG?>
<?submitter-name Nature Publishing Group?>
<?domain wtpa?>
<?pmc-id-preallocated 7610616?>
<?properties manuscript?>
<?origin ukpmcpa?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-journal-id">9604648</journal-id>
    <journal-id journal-id-type="nlm-ta">Nat Biotechnol</journal-id>
    <journal-id journal-id-type="iso-abbrev">Nat Biotechnol</journal-id>
    <journal-title-group>
      <journal-title>Nature biotechnology</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1087-0156</issn>
    <issn pub-type="epub">1546-1696</issn>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7610616</article-id>
    <article-id pub-id-type="manuscript">ems118410</article-id>
    <article-id pub-id-type="pmid">33257864</article-id>
    <article-id pub-id-type="doi">10.1038/s41587-020-00746-x</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Readfish enables targeted nanopore sequencing of gigabase-sized genomes</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Payne</surname>
          <given-names>Alexander</given-names>
        </name>
        <xref ref-type="aff" rid="A1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Holmes</surname>
          <given-names>Nadine</given-names>
        </name>
        <xref ref-type="aff" rid="A1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Clarke</surname>
          <given-names>Thomas</given-names>
        </name>
        <xref ref-type="aff" rid="A1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Munro</surname>
          <given-names>Rory</given-names>
        </name>
        <xref ref-type="aff" rid="A1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Debebe</surname>
          <given-names>Bisrat J</given-names>
        </name>
        <xref ref-type="aff" rid="A1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Loose</surname>
          <given-names>Matthew</given-names>
        </name>
        <xref ref-type="aff" rid="A1">1</xref>
        <xref ref-type="corresp" rid="CR1">*</xref>
      </contrib>
    </contrib-group>
    <aff id="A1"><label>1</label>DeepSeq, School of Life Sciences, Queens Medical Centre, University of Nottingham, Nottingham, NG7 2UH, UK</aff>
    <author-notes>
      <corresp id="CR1"><label>*</label>Author for correspondence: <email>matt.loose@nottingham.ac.uk</email></corresp>
    </author-notes>
    <pub-date pub-type="nihms-submitted">
      <day>04</day>
      <month>3</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="ppub">
      <day>01</day>
      <month>4</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>30</day>
      <month>11</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>30</day>
      <month>5</month>
      <year>2021</year>
    </pub-date>
    <volume>39</volume>
    <issue>4</issue>
    <fpage>442</fpage>
    <lpage>450</lpage>
    <permissions>
      <ali:free_to_read xmlns:ali="http://www.niso.org/schemas/ali/1.0/"/>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/">http://www.nature.com/authors/editorial_policies/license.html#terms</ali:license_ref>
        <license-p>Users may view, print, copy, and download text and data-mine the content in such documents, for the purposes of academic research, subject always to the full Conditions of use: <ext-link ext-link-type="uri" xlink:href="http://www.nature.com/authors/editorial_policies/license.html#terms">http://www.nature.com/authors/editorial_policies/license.html#terms</ext-link></license-p>
      </license>
    </permissions>
    <abstract>
      <p id="P1">Nanopore sequencers can be used to selectively sequence certain DNA molecules in a pool by reversing the voltage across individual nanopores to reject specific sequences, enabling enrichment and depletion to address biological questions. Previously, we achieved this using dynamic time warping to map the signal to a reference genome, but the method required substantial computational resources and did not scale to gigabase-sized references. Here we overcome this limitation by using GPU base calling. We show enrichment of specific chromosomes from the human genome and of low-abundance organisms in mixed populations without a priori knowledge of sample composition. Finally, we enrich targeted panels comprising 25,600 exons from 10,000 human genes and 717 genes implicated in cancer, identifying PML-RARA fusions in the NB4 cell line in &lt;15 hours sequencing. These methods can be used to efficiently screen any target panel of genes without specialised sample preparation using any computer and suitable GPU. Our toolkit, readfish, is available at <ext-link ext-link-type="uri" xlink:href="https://www.github.com/looselab/readfish">https://www.github.com/looselab/readfish</ext-link>.</p>
    </abstract>
  </article-meta>
</front>
<body>
  <sec sec-type="intro" id="S1">
    <title>Introduction</title>
    <p id="P2">Selective sequencing, or “Read Until”, refers to the ability of a nanopore sequencer to reject individual molecules whilst they are being sequenced. This requires the rapid classification of current signal from the first part of the read to determine whether the molecule should be sequenced or removed and replaced with a new molecule. We first demonstrated this using dynamic time warping (DTW) to compare the signal with a simulated current trace derived from a reference sequence <sup><xref rid="R1" ref-type="bibr">1</xref></sup>. Although DTW enabled a small set of use cases, it required significant computational resources, preventing its generalised use <sup><xref rid="R2" ref-type="bibr">2</xref></sup>. Another recent method using raw signal, UNCALLED <sup><xref rid="R3" ref-type="bibr">3</xref></sup>, has a lighter computational footprint than previous signal-based methods, but is limited in search space and still requires significant computational resources. An alternative approach, which uses direct base calling of signal chunks <sup><xref rid="R4" ref-type="bibr">4</xref></sup>, demonstrated benefit compared with sequencing without Read Until as it filtered out unwanted reads, but did not provide any enrichment and required significant CPU resources.</p>
    <p id="P3">Our goal was to work with nucleotide sequences rather than raw signals to exploit existing tools, utilise reasonable computational resources and show enrichment of targets. To do this, we used Oxford Nanopore Technologies (ONT) base calling software. ONT have developed a number of base callers for nanopore sequence data, initially utilising Hidden Markov Models and available through the metrichor cloud service <sup><xref rid="R5" ref-type="bibr">5</xref></sup>. They replaced these with neural network models running on CPU and then Graphical Processing Units (GPU). For real time base calling, ONT provide a range of computational platforms with integrated GPUs (minIT, Mk1C, GridION and PromethION). These devices enable real time base calling sufficient to keep pace with flow cells generating data. Most recently, these base callers acquired a server-client configuration, such that raw signal can be passed to the server and a nucleotide sequence returned. Using this, we show that GPU base calling can be used to deliver a real time stream of nucleotide data from flow cells sequencing with up to 512 channels simultaneously. At the same time, the GPU can base call completed reads, and optimised tools such as minimap2 <sup><xref rid="R6" ref-type="bibr">6</xref></sup> can therefore be used to map reads as they are generated, enabling dynamic updating of both the targets and the reference genome as results change.</p>
    <p id="P4">As our method does not use raw signal comparison, we do not have to convert reference genomes into signal space as in DTW or other signal methods <sup><xref rid="R1" ref-type="bibr">1</xref>,<xref rid="R3" ref-type="bibr">3</xref></sup>. We are constrained by access to a sufficiently powerful GPU. The results presented here mainly utilise the ONT GridION MK1, which includes an NVIDIA GV100 GPU, but we also use an NVIDIA 1080, showing that this approach works on any device capable of real time base calling. We apply this approach to a range of model problems. First, we select specific human chromosomes, illustrating gigabase references are not a constraint. Second, we enrich low-abundance genomes from a mixed population and find we reduce the time required to answer a biological question (time-to-answer) and improve the ability to assemble low-copy genomes. Adaptive sampling is the process by which the software changes what is being sequenced in response to what has been seen during an experiment. To illustrate this, we use Centrifuge to identify the most abundant species present in a metagenomic sample, monitor depth of coverage for each in real time and enrich for the least abundant genomes without <italic>a priori</italic> knowledge of content <sup><xref rid="R7" ref-type="bibr">7</xref></sup>. This method is necessarily limited by the composition of the reference database and also requires network access to retrieve references once identified. Finally, we enrich panels of human genes, including 25,600 target regions corresponding to ~10,000 genes and 717 genes from the COSMIC (Catalogue of Somatic Mutations in Cancer) panel <sup><xref rid="R8" ref-type="bibr">8</xref></sup>. We demonstrate how Read Until can be used to capture information on key targets without the need for custom library preparation and show we can identify a known translocation in the NB4 cell line in &lt;15 hours <sup><xref rid="R9" ref-type="bibr">9</xref></sup>.</p>
    <p id="P5">We provide a configurable toolkit, readfish, enabling targeted sequencing of gigabase-sized genomes. This includes depletion of host sequences as well as example methods giving minimum coverage depth for specific sequences in a population. Configuration of these tools is relatively straightforward and requires no additional computation as long as a sufficiently powerful GPU capable of base calling multiple flow cells in real time is available.</p>
  </sec>
  <sec sec-type="results" id="S2">
    <title>Results</title>
    <sec id="S3">
      <title>Methods Overview</title>
      <p id="P6">Selective sequencing requires bidirectional communication with a nanopore sequencer through the Read Until API <sup><xref rid="R10" ref-type="bibr">10</xref></sup>. The API provides a stream of raw current samples from every sequencing pore on the flow cell and allows the user to respond in real time, either rejecting a read from a specific pore or allowing a read to finish naturally. Previous API implementations served any signal seen as a potential read and so required processing many signals that were not genuine reads, causing analysis challenges <sup><xref rid="R4" ref-type="bibr">4</xref></sup>. The current API discriminates true DNA signal from background more efficiently and is configured to only provide signals identified as DNA reducing the analysis burden. We reasoned that the signal served by the API should be compatible with the Guppy basecaller and so retrieve short sequences that are processed in base space.</p>
      <p id="P7"><xref ref-type="supplementary-material" rid="SD1">Supplementary Figure 1A</xref> illustrates the workflow for base calling reads as they are being sequenced. Briefly, data chunks of signal are served from the Read Until API. Chunks default to one second duration but can be configured by the user. We found 0.4s chunk durations (~180 bases, see methods) balanced the need for small chunks with API performance (<xref ref-type="supplementary-material" rid="SD1">Supplementary Table 1</xref> and <xref ref-type="supplementary-material" rid="SD1">Supplementary Figure 2</xref>). The data chunk (up to 512 reads from a MinION flow cell) is converted to a Guppy compatible format and base called using pyguppyclient <sup><xref rid="R11" ref-type="bibr">11</xref></sup>. Base called data are then mapped to a reference with minimap2 <sup><xref rid="R6" ref-type="bibr">6</xref></sup>. Reads may uniquely map, map to multiple locations, or may not map at all. In response the user can choose to reject a read (unblock), acquire more data for that read (proceed) or stop receiving data for the remainder of that read (stop receiving).</p>
    </sec>
    <sec id="S4">
      <title>Read Until Performance</title>
      <p id="P8">To test performance of our real time base calling approach on enrichment and depletion, we sequenced the well-studied NA12878 reference cell line <sup><xref rid="R12" ref-type="bibr">12</xref></sup>. The flow cell was configured to operate in quadrants each sequencing: a control (all reads accepted), chromosomes 1-8 (50% of reads accepted), chromosomes 9-14 (25% of reads accepted), and finally chromosomes 16-20 (12.5% of reads accepted). Reads are base called and mapped to the reference regardless of quadrant. Median read lengths per chromosome in each quadrant indicate those sequenced or rejected (<xref ref-type="fig" rid="F1">Figure 1A</xref>). Selectively sequenced reads have a median read length of ~15 kb. Rejected reads have a median length of ~500 bases, equating to ~1.1 seconds of sequencing time at 450 bases per second, although median data collected was closer to 1.5 seconds. Reads are base called, mapped and the unblock action sent and actioned within ~1s of the read starting. This run generated 9.5 Gb of sequence data, unevenly distributed across the quadrants; 3.47 Gb in the control, 2.79 Gb at 50% acceptance, 1.84 at 25% acceptance and only 1.22 Gb at 12% (<xref ref-type="fig" rid="F1">Figure 1B</xref>, <xref ref-type="supplementary-material" rid="SD1">Supplementary Table 2</xref>). For each quadrant the optimal enrichment is 2-fold, 4-fold and 8-fold but we see lower enrichments by the end of the experiment, presumably due to reduced yield (<xref ref-type="fig" rid="F1">Figure 1C</xref>). We observe enrichment of target sequences in all cases compared with control. Relative enrichment is closer to the theoretical maximum at the beginning of the sequencing run (<xref ref-type="fig" rid="F1">Figure 1D</xref>). Analysis of available channels contributing to data generation shows that sequencing capacity is lost faster as more reads are rejected (<xref ref-type="fig" rid="F1">Figure 1E</xref>). For this experiment, we did not nuclease flush the flow cell, but anticipate improvements in both yield and enrichment if we did. We were able to call all batches within our 0.4 second window (<xref ref-type="supplementary-material" rid="SD1">Supplementary Figure 3E</xref>).</p>
      <p id="P9">A common goal in sequencing library preparation is to remove host DNA to enrich for a metagenomic subpopulation <sup><xref rid="R13" ref-type="bibr">13</xref>,<xref rid="R14" ref-type="bibr">14</xref></sup>. Selective sequencing may be beneficial in conjunction with library preparation methods. We considered metagenomics applications as a similar class of problem. Nicholls et. al. generated a reference dataset using the ZymoBIOMICS Microbial Community Standards <sup><xref rid="R15" ref-type="bibr">15</xref></sup>. They were able to generate sufficient data to assemble several of the bacteria into single contigs (without binning). Notably, eukaryotic genomes that were present at lower abundance (2%) did not generate high contiguity assemblies. This is not surprising as the coverage depth for <italic>Saccharomyces cerevisiae</italic> was 17x and <italic>Cryptococcus neoformans</italic> 10x when sequencing on a single GridION flow cell <sup><xref rid="R15" ref-type="bibr">15</xref></sup>. Enriching for these low abundance components is conceptually similar to depleting host material from a sample. In our experiments we utilise the ZymoBIOMICS high molecular weight DNA standard (D6322). This sample will <italic>a priori</italic> improve assemblies due to the longer read lengths and further differs from Nicholls et al. as it excludes <italic>C. neoformans</italic>.</p>
      <p id="P10">To see if selective sequencing could improve the relative coverage of low abundance material we developed a simple pipeline (readfish align) to drive our selective sequencing decisions (<xref ref-type="supplementary-material" rid="SD1">Supplementary Figure 1B</xref>). This pipeline aligns completed reads against a reference as they are written to disc, then calculates coverage depth. Once an individual species reaches the desired coverage depth, new reads mapping to that species are rejected. We simultaneously base call both the real time stream from Read Until and completed reads. Finally, we implemented Run Until to stop the run once all targets had reached sufficient coverage. These experiments used a community specific reference file. Mean read lengths for target genomes reduce as they are added to the rejection list and the mean read length becomes dominated by short, rejected reads (<xref ref-type="fig" rid="F2">Figure 2A</xref>). Plotting coverage over time for reads not rejected by Read Until shows a decrease in coverage accumulation for completed genomes (i.e those at the desired coverage level) with an increase in sequencing potential for the least abundant sample, <italic>S. cerevisiae</italic> (<xref ref-type="fig" rid="F2">Figure 2B</xref>). The proportion of bases mapping to each genome reveals the shift in sequencing capacity to <italic>S. cerevisiae</italic> (<xref ref-type="fig" rid="F2">Figure 2C</xref>). Relative abundance can still be determined when running Read Until as the proportion of reads mapping to each genome does not change (<xref ref-type="fig" rid="F2">Figure 2D</xref>). The run automatically stops once each genome reaches 40x, taking ~16 hours and 4.4 Gb of sequence data (<xref ref-type="supplementary-material" rid="SD1">Supplementary Figure 4</xref>).</p>
      <p id="P11">This sample should be 2% <italic>S. cerevisiae</italic> by bases, typically yielding ~88 Mb or 7x of sequence data. Using selective sequencing we see 40x coverage, naively a 5.7 fold increase in on target data. However, a flow cell not implementing selective sequencing would have higher yield, so real world enrichment is lower. Nicholls et al. report 16 Gb on a similar sample generated in 48 hours, which would result in ~25x of <italic>S. cerevisiae</italic> bringing enrichment closer to 1.6x <sup><xref rid="R15" ref-type="bibr">15</xref>,<xref rid="R16" ref-type="bibr">16</xref></sup>. Theoretically enrichment of a 2% subset should be greater, but there is a cost to rejecting an individual read. Even so we could enrich the least abundant element compared with that expected from the sample composition in multiple experiments (n=3). Thus we accelerate time-to-answer for a particular coverage depth (16 hours vs 48 hours). This approach assumes knowledge of the sample <italic>a priori</italic> and so is of limited practical relevance. By integrating a metagenomics classifier into our pipeline (readfish centrifuge) we avoid this requirement <sup><xref rid="R7" ref-type="bibr">7</xref></sup>. As strains are identified within the sample they can be dynamically tracked and added to a rejection list illustrating the principle of adaptive sequencing.</p>
      <p id="P12">Using this approach we generated 5.995 Gb of sequence data and identified all bacterial genomes in the sample, although we observed enrichment, the flow cell became completely blocked before reaching target coverage (<xref ref-type="fig" rid="F3">Figure 3</xref>, <xref ref-type="supplementary-material" rid="SD1">Supplementary Table 2</xref>, <xref ref-type="supplementary-material" rid="SD1">Supplementary Figures. 5</xref> and <xref ref-type="supplementary-material" rid="SD1">6</xref>). 6 Gb of sequence should result in ~10x coverage; here we obtained 41x coverage (<xref ref-type="fig" rid="F3">Figure 3B</xref>). In this case, we considered the entire read as a candidate for read until, consequently some reads are rejected later into the read. This results in a wider range of mean rejected read lengths, particularly for <italic>S. cerevisiae</italic> (<xref ref-type="fig" rid="F3">Figure 3A</xref>). This experiment was completed within 24 hours, illustrating the benefits in terms of time-to-answer. As expected, improved coverage depth results in almost complete assemblies using MetaFlye compared to that achieved by Nicholls et. al (<xref ref-type="supplementary-material" rid="SD1">Supplementary Figure 7</xref>); in part a consequence of improved read lengths here <sup><xref rid="R15" ref-type="bibr">15</xref>,<xref rid="R17" ref-type="bibr">17</xref></sup>. Subsequent nuclease flushing of the flow cell would increase effective throughput, but this was not our goal.</p>
      <p id="P13">Methods for target panel enrichment include PCR amplification, bait capture methods and CRISPR-Cas9 approaches <sup><xref rid="R18" ref-type="bibr">18</xref>–<xref rid="R21" ref-type="bibr">21</xref></sup>. These methods are reliable and cost effective at scale, but have development, instrument and consumable costs. Unlike methods that capture native DNA <sup><xref rid="R20" ref-type="bibr">20</xref></sup>, PCR based methods cannot capture methylation information without additional processing. Such panels cannot be altered easily.</p>
      <p id="P14">Selective sequencing provides an alternative and so we identified 19,296 target genes annotated as protein coding with Transcript Name IDs (see methods) from the human genome (GRCh38) excluding those on X and Y and ignoring alt chromosomes <sup><xref rid="R22" ref-type="bibr">22</xref></sup>. We extracted exon coordinates, extended 3kb either side and collapsed overlapping targets. We enriched for targets found on odd numbered chromosomes, rejecting all reads from outside these targets. This results in a total search space of 176 Mb (~5%) containing 25,600 targets covering ~10,000 genes (<xref ref-type="fig" rid="F4">Figure 4A</xref>). A single GridION flow cell with 1,660 pores gave 6.1 Gb of sequence data in 24 hours. After nuclease flushing, loading additional library and 24 hours more sequencing gave 5.573 Gb (total yield: 11.675 Gb, N50 9 kb, <xref ref-type="supplementary-material" rid="SD1">Supplementary Table 2</xref>). Exon targets had median coverage of 17.23x (mean 17.39x) with 75%&gt;14.15x, 25%&gt;20.42x. On “control” even chromosomes, median coverage was 0.98x (mean 1.2x). Detailed coverage plots of targets on ODD (<xref ref-type="fig" rid="F4">Figures. 4C and D</xref>) and EVEN (<xref ref-type="fig" rid="F4">Figures 4E and F</xref>) chromosomes correlate with the target regions. Controlling for these experiments is complicated by flow cell variability. We compare with theoretical yields of 10, 20 and 30 Gb resulting in approximately 3-10x coverage. Our effective enrichment is from 2.7-5.4x consistent with our earlier observations. Nuclease flushing significantly assists enrichment and flow cell efficiency (<xref ref-type="supplementary-material" rid="SD1">Supplementary Figure 8</xref>).</p>
      <p id="P15">Our exon panel contains 371 genes from COSMIC with median coverage of 13.7x (<xref ref-type="fig" rid="F4">Figure 4B</xref>) <sup><xref rid="R8" ref-type="bibr">8</xref></sup>. <xref ref-type="fig" rid="F4">Figures 4C</xref> and <xref ref-type="fig" rid="F4">4D</xref> show coverage for BRCA1, PML and surrounding targets. Although preferable to include introns, here we excluded intronic sequences to reduce the total search space (although not required). To further explore this and illustrate the flexibility of our approach, we targeted the entire COSMIC panel (717 genes) excluding those with no given genomic coordinates (<xref ref-type="supplementary-material" rid="SD2">Supplementary File 1</xref>). Including flanking 5 kb sequences, our search space was 89.9 Mb (~2.7% of the genome). Using a flow cell with 1,724 pores we generated 3.7 Gb within 24 hours. Nuclease flush and reload generated a further 6.03 Gb giving a total of 9.73 Gb, with a read N50 of 940 bases (<xref ref-type="fig" rid="F5">Figure 5</xref>, <xref ref-type="supplementary-material" rid="SD1">Supplementary Figure 9</xref>, <xref ref-type="supplementary-material" rid="SD1">Supplementary Table 2</xref>). Deliberately rejected reads had an N50 of 515 bases; sequenced reads had an N50 of 11,564 bases. Gene targets had median coverage 32.2x (mean 30.7x) (<xref ref-type="fig" rid="F5">Figure 5A</xref>, <xref ref-type="supplementary-material" rid="SD2">Supplementary File 1</xref>), with 75% of genes &gt;28x, 25% of genes &gt; 35x. <xref ref-type="fig" rid="F5">Figure 5C-F</xref> shows coverage for BRCA1, PML, WIF1, HOXC11/C13. The specificity of selective sequencing is clear, particularly where neighbouring genes in the HOXC cluster are not sequenced. A second run, utilising three flushes, one every 24 hours, generated a total of 17.87 Gb with a read N50 of 793 bases (<xref ref-type="supplementary-material" rid="SD1">Supplementary Figure 10</xref>, <xref ref-type="supplementary-material" rid="SD1">Supplementary Table 2</xref>). Gene targets had median coverage 42.3x (mean 40.5x) (<xref ref-type="fig" rid="F5">Figure 5B</xref>), with 75% of genes &gt;44x, 25% of genes &gt;38x. To test performance of readfish on non-ONT hardware, we ran the same experiment using an NVIDIA GeForce GTX 1080 GPU using the fast model of the basecaller. This run generated only 6.7 Gb of data with a read N50 of 799 bases (<xref ref-type="supplementary-material" rid="SD1">Supplementary Figure 11</xref>, <xref ref-type="supplementary-material" rid="SD1">Supplementary Table 2</xref>). Median coverage of genes was 19.6x (mean 19.1x), with 75% of genes &gt;20.99x, 25% of genes &gt;17.78x.</p>
      <p id="P16">The difference in yield between these runs is largely due to flow cell variation, particularly the third run which showed unusual flow cell activity (<xref ref-type="supplementary-material" rid="SD1">Supplementary Figure 12</xref>). However, normalising enrichment to the total yield of each flow cell shows similar performance in each experiment for a selection of target genes including PML, WIF1, HoxC11/C13, RARA and BRCA1 (<xref ref-type="supplementary-material" rid="SD1">Supplementary Figures 13-17</xref>). This suggests that any steps taken to maximise yield, such as flushing, will result in enhanced enrichment. As with any native nanopore sequence data, these data can be used to assess structural variants and nucleotide variation. As shown in <xref ref-type="supplementary-material" rid="SD1">Supplementary Table 3</xref>, these data show recall and precision equivalent to, or better than, reference Nanopore whole genome data at similar coverage without targeting <sup><xref rid="R12" ref-type="bibr">12</xref></sup>. Structural variants within the targeted regions can be detected with high recall (<xref ref-type="supplementary-material" rid="SD1">Supplementary Table 4</xref>). Crucially, between 5-10 typical flow cells would be required to generate equivalent coverage without read until.</p>
      <p id="P17">To test screening for structural variants we used the NB4 acute promyelocytic leukemia (APL) cell line <sup><xref rid="R9" ref-type="bibr">9</xref></sup>. Using the same COSMIC panel we identified the translocation using a flow cell with only 1,196 pores, generating 4.5 Gb of sequence data in under 15 hours (<xref ref-type="supplementary-material" rid="SD1">Supplementary Figure 18</xref>. Median coverage of targets was 11.46x (mean 11.78x) (<xref ref-type="fig" rid="F6">Figures 6A</xref>,<xref ref-type="fig" rid="F6">C</xref>,<xref ref-type="fig" rid="F6">D</xref>), with 75% of genes &gt;9.5x, 25% of genes &gt; 13.4x. Analysis with svim looking for breakpoint ends, ignoring in/dels, identified two candidates passing default filtering (see methods) <sup><xref rid="R23" ref-type="bibr">23</xref></sup>. The breakpoint can also be detected with sniffles (data not shown) <sup><xref rid="R24" ref-type="bibr">24</xref></sup>. Of these candidates, one captured the known breakpoint supported by six reads. A further 24 hours of sequencing (~3Gb) resulted in median coverage of 17.37x (mean 18x) and 9 reads supporting the variant (<xref ref-type="fig" rid="F6">Figure 6E</xref>, <xref ref-type="supplementary-material" rid="SD1">Supplementary Table 5</xref>). No complex rearrangements were reported in NA12878 using the same COSMIC panel (<xref ref-type="supplementary-material" rid="SD1">Supplementary Table 5</xref>). A subsequent repeat of this experiment (<xref ref-type="supplementary-material" rid="SD1">Supplementary Figure 19</xref>), with flushing every 24 hours, generated 15.9 Gb of sequence data. Median coverage of targets was 34x (mean 35.5x) (<xref ref-type="fig" rid="F6">Figure 6B</xref>), with 75% of genes &gt; 38x, 25% of genes &gt; 30x and 23 reads supporting the breakpoint (<xref ref-type="fig" rid="F6">Figure 6F</xref>, <xref ref-type="supplementary-material" rid="SD1">Supplementary Table 5</xref>).</p>
    </sec>
  </sec>
  <sec sec-type="discussion" id="S5">
    <title>Discussion</title>
    <p id="P18">The idea of selectively sequencing (‘Read Until’) individual molecules using only computational methods is a unique capability of nanopore sequencing <sup><xref rid="R1" ref-type="bibr">1</xref></sup>. Here we exploit ONT tools to provide a true real time stream of sequence data as nucleotide bases and provide a toolkit to design and control selective sequencing experiments called readfish. This approach removes the need for complex signal mapping algorithms but does require a sufficiently fast base caller. Prior work illustrated that this method was feasible, but required extensive additional computation and did not show significant enrichment over throughput achieved without running ‘Read Until’ <sup><xref rid="R4" ref-type="bibr">4</xref></sup>. Here we demonstrate real enrichment over that expected from a similar control flow cell. We also show that standard techniques for enhancing flow cell yield such as nuclease flushing and loading additional library are similarly beneficial for read until experiments. Although not extensively exploited here, nuclease flushing and reuse of flow cells does increase yield and enrichment and we have taken to flushing read until experiments every 24 hours.</p>
    <p id="P19">We find that increased rejection of reads on a flow cell negatively impacts sequencing yield and so observed enrichment. The main benefit of selective sequencing in metagenomics and host depletion is to improve time-to-answer. For samples which sequence well (i.e do not tend to block the flow cell), additional enrichment benefits may be observed. Notably, running selective sequencing does not disrupt the proportion of reads by count that map to a specific reference. Thus, for metagenomics, it is still possible to assess relative abundance whilst focussing sequencing length on specific subsets of reads. Future methods proposed by ONT to address blocking, such as onboard nucleases, might increase throughput in future.</p>
    <p id="P20">Key benefits of our approach are that we utilise only computational resources available in the GridION Mk1. As we use current commercially provided base callers, we can utilise new algorithms and pores as they are developed. Thus, although not yet tested, we could use this method on RNA if sufficiently long reads require depletion. Similarly. we could use methylation-aware base callers to sequence regions of DNA starting from either high or low methylation regions. As we obtain sequence, rather than signal, we greatly simplify the construction of pipelines for downstream analysis of reads. Although we focus on results for the GridION Mk1 we show this method can be used with any MinION configuration provided sufficient available GPU to base call a sequencing run in real time (<xref ref-type="supplementary-material" rid="SD1">Supplementary Note 1</xref>). As we show here, it is possible to utilise the fast base calling model and obtain effective enrichment using a single Nvidia GeForceGTX 1080 GPU. Other users have reported success with the high accuracy model on systems configured with NVIDIA 2080 GPUs (J Tyson, Pers. Comm.). In cost terms, any platform capable of real time base calling will be compatible with our approach. In principle this method should scale to the PromethION.</p>
    <p id="P21">We demonstrate that selective sequencing of arbitrary targeted regions of the human genome results in actionable coverage and can identify SNVs and SVs in the COSMIC panel. For SV analysis, DNA extraction, library preparation, sequencing and analysis could be completed within 24 hours. When sequencing a subset of a large genome, large numbers of off-target reads are sampled whilst detecting those of interest and the precise parameters of optimal target size and coverage have yet to be defined. Consequently, library preparation methods enriching for regions of interest will result in higher coverage than ‘Read Until’. But the design of such panels is relatively costly and inflexible once developed. Methods relying on amplification result in the loss of methylation data, which can be found using the methods presented here.</p>
    <p id="P22">In readfish selective sequencing, targets can be updated by a single configuration file. Developing a new panel is as straightforward as compiling a list of target regions. Here we also illustrate the concept of adaptive sequencing, as in our metagenomics examples, where targets can be dynamically adjusted during a run. In theory a panel could be updated in response to observations of the data in real time, perhaps adding targets where candidate novel structural variants have been identified or removing targets where sufficient evidence is available to eliminate the possibility of an SV existing.</p>
    <p id="P23">Of course, throughput achievable on platforms such as the PromethION at scale provides efficient whole genome sequencing <sup><xref rid="R25" ref-type="bibr">25</xref></sup>. Thus, any effective method for enrichment must be as efficient, including the additional computation required. By utilising the available GPU computational capacity during the sequencing run, we address this issue. There is no reason, in theory, why samples could not be multiplexed on a single flow cell as long as sufficient yield can be obtained to address the biological question.</p>
    <p id="P24">Although we have focussed exclusively on applications for ‘Read Until’, we believe that a real time sequence data stream as bases has significant advantages for future pipelines. If sequence data can be streamed directly into an analysis pipeline and conclusions drawn without the requirements for data storage, then field deployment of sequencing for detection of specific sequences might be accelerated. Ultimately, it may be possible to stream sequence data for calling of structural variants and further analysis in real time.</p>
  </sec>
  <sec sec-type="web-only" id="S6">
    <title>Online Methods</title>
    <sec id="S7">
      <title>Library preparation and sequencing</title>
      <p id="P25">Standard LSK-109 (ONT) sequencing libraries were prepared from either the ZymoBIOMICS HMW DNA Standard (DS6322 ZymoBIOMICS USA) or DNA extracted from GM12878 cells (Coriell), or NB4 cells (gift from M. Hubank) as described in Jain et al <sup><xref rid="R12" ref-type="bibr">12</xref></sup>. Human DNA for exon enrichment or gene targeting was sheared to approximately 12kb using g-TUBE (Covaris). Sequencing runs used either the GridION Mk1 or a MinION with NVIDIA GeForceGTX 1080 GPU (see <xref ref-type="supplementary-material" rid="SD1">Supplementary Table S2</xref>). Standard scripts for sequencing were used with one modification, namely that the size of data chunk delivered by MinKNOW was reduced from 1 second to 0.4 seconds by changing the value of the break_reads_after_seconds parameter in the relevant TOML file (located in ../minknow/conf/package/sequencing/ for MinKNOW core version 3.6). All sequencing used FLO-MIN106 R9.4.1 flow cells.</p>
      <p id="P26">When running read until experiments seeking to maximise yield, throughput on the flow cell should be monitored closely. Our practice has been to nuclease flush flow cells every 24 hours to maximise throughput. For maximising occupancy on the flow cell, users should experiment with loading more library than they might otherwise do. For example, where a user might load 400 ng of library with a read length N50 of 10-15 kb, we would recommend loading 600 ng of library. This assumes R9.4 flow cells. This protocol has not yet been tested on R10.</p>
    </sec>
    <sec id="S8">
      <title>Single Nucleotide Variant Detection</title>
      <p id="P27">SNPs in NA12878 read data were called using Nanopolish in methylation aware mode <sup><xref rid="R26" ref-type="bibr">26</xref></sup>. Reads were mapped to hg38 removing ALTs with minimap2 using standard settings for ONT reads <sup><xref rid="R6" ref-type="bibr">6</xref></sup>. High confidence gold standard SNPs were identified from the Genome In A Bottle (GIAB) truth set <sup><xref rid="R27" ref-type="bibr">27</xref></sup>. SNPs were compared with a 35x WGS NA12878 reference set recalled using the same guppy basecaller model <sup><xref rid="R12" ref-type="bibr">12</xref></sup>. SNP comparisons were made using HAP.PY using default settings and the same target sites used for selective sequencing <sup><xref rid="R28" ref-type="bibr">28</xref></sup>.</p>
    </sec>
    <sec id="S9">
      <title>Structural Variant Detection and Concordance</title>
      <p id="P28">Reads were mapped to the hg38 primary assembly with minimap2 and standard ONT settings. Variants were called using SVIM and Sniffles with default settings and minimum variant length set as 50 <sup><xref rid="R23" ref-type="bibr">23</xref>,<xref rid="R24" ref-type="bibr">24</xref></sup>. Only SVIM variant calls with QUAL above 10 and longer than 50bp were kept. Variants of the same type present in both SVIM and Sniffles callsets were selected as the final call set using SURVIVOR and a maximal distance between breakpoints was set to 500 <sup><xref rid="R29" ref-type="bibr">29</xref></sup>. Only insertions and deletions intersecting the COSMIC Target Panel were considered for concordance calculations in WGS, Run1 and Run2. Concordance calculations were performed with Truvari <sup><xref rid="R30" ref-type="bibr">30</xref></sup> with reference distance set as 1.5Kb, percent size similarity as 0.3 and only insertions and deletions larger than 50bp within the COSMIC Target Panel were considered. For analysis of the translocation in the NB4 cell lines, variant calls were filtered with quality 10 and non BND (Breakpoint End) structural variant types were ignored. SVs were visualised with Ribbon <sup><xref rid="R31" ref-type="bibr">31</xref></sup>.</p>
    </sec>
    <sec id="S10">
      <title>Target Lists</title>
      <p id="P29">The exact target list used to configure exon capture can be obtained at the following link: <ext-link ext-link-type="uri" xlink:href="http://www.ensembl.org/biomart/martview/454f99b3f65c7e62669229fd48de8e47?VIRTUALSCHEMANAME=default&amp;ATTRIBUTES=hsapiens_gene_ensembl.default.structure.ensembl_gene_id|hsapiens_gene_ensembl.default.structure.ensembl_gene_id_version|hsapiens_gene_ensembl.default.structure.ensembl_transcript_id|hsapiens_gene_ensembl.default.structure.ensembl_transcript_id_version|hsapiens_gene_ensembl.default.structure.chromosome_name|hsapiens_gene_ensembl.default.structure.exon_chrom_start|hsapiens_gene_ensembl.default.structure.exon_chrom_end&amp;FILTERS=hsapiens_gene_ensembl.default.filters.with_hgnc_trans_name.only|hsapiens_gene_ensembl.default.filters.chromosome_name.‘1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y’|hsapiens_gene_ensembl.default.filters.biotype.‘protein_coding’&amp;VISIBLEPANEL=attributepanel">http://www.ensembl.org/biomart/martview/454f99b3f65c7e62669229fd48de8e47?VIRTUALSCHEMANAME=default&amp;ATTRIBUTES=hsapiens_gene_ensembl.default.structure.ensembl_gene_id|hsapiens_gene_ensembl.default.structure.ensembl_gene_id_version|hsapiens_gene_ensembl.default.structure.ensembl_transcript_id|hsapiens_gene_ensembl.default.structure.ensembl_transcript_id_version|hsapiens_gene_ensembl.default.structure.chromosome_name|hsapiens_gene_ensembl.default.structure.exon_chrom_start|hsapiens_gene_ensembl.default.structure.exon_chrom_end&amp;FILTERS=hsapiens_gene_ensembl.default.filters.with_hgnc_trans_name.only|hsapiens_gene_ensembl.default.filters.chromosome_name.‘1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y’|hsapiens_gene_ensembl.default.filters.biotype.‘protein_coding’&amp;VISIBLEPANEL=attributepanel</ext-link>
</p>
    </sec>
    <sec id="S11">
      <title>Read Until Cache Configuration and Chunk Size</title>
      <p id="P30">A read begins with adapter sequences as well as optional barcodes. Additionally read starts sometimes stall as DNA engages with the pore before signal containing sequence data are available. The first chunk of data may not provide an optimal base call and additional data may be required. Calling any single fragment of data in isolation is less informative than calling the entire signal and so we implement a read cache concatenating adjacent signal data from the same read. This enables base calling the complete signal for each read since it started. As of MinKNOW version 3.6, the sequencing platform is effectively limited to a lower bound chunk size of 0.4s. As shown in <xref ref-type="supplementary-material" rid="SD1">Supplementary Figure. S2</xref> and <xref ref-type="supplementary-material" rid="SD1">Supplementary Table S1</xref>, more than 80% of human reads can be base called and aligned within 2 chunks or 0.8s worth of data. For bacterial sequences more than 40% of reads can be base called and aligned within a single chunk or 0.4s worth of data. So by observation, the smallest possible chunk size will enable the fastest decision making for any given sequence. In a typical experiment we find that 90% of reads can be processed (called, mapped, and decision made) within three chunks (1.2 s, <xref ref-type="supplementary-material" rid="SD1">Supplementary Figure. S2</xref>, <xref ref-type="supplementary-material" rid="SD1">Supplementary Table S1</xref>).</p>
    </sec>
    <sec id="S12">
      <title>Base caller Configuration</title>
      <p id="P31">The Guppy basecaller contains several models for base calling that trade speed (fast) for accuracy (high accuracy model, hac) and can optionally call methylation. For selective sequencing, the goal is speed and so we investigated the efficacy of both the fast and hac models finding the GridION Mk1 easily powerful enough to use the hac model. Across all experiments shown here the average batch of reads called in 0.28s and contained 30 reads. At maximum load, individual reads are processed in less than 0.002s. Thus we call at least 100 read fragments per second and even at peak load can typically call all 512 reads (see <xref ref-type="supplementary-material" rid="SD1">Supplementary Figures. S3-7</xref>, <xref ref-type="supplementary-material" rid="SD1">Supplementary Figure S10</xref>).</p>
    </sec>
    <sec id="S13">
      <title>Experiment Configuration</title>
      <p id="P32">Depending on experiment configuration, the response to read mapping varies (see online methods). If depleting contaminants (host depletion) then reads mapping to that reference should be rejected. For enrichment, reads mapping to a target should be sequenced. The action for non mapping reads will depend on the experiment. If the experimental goal is enriching low abundance or unknown targets, non mapping reads should be sequenced. If enriching for subsets of a known reference, non mapping reads might be rejected in favour of sampling more. Given the variety of options, we provide a configuration file allowing any mapping result to trigger any action. We include the option to dynamically update this file during sequencing enabling target switches whilst sequencing. The configuration also allows different experiments on regions of the same flow cell (see <ext-link ext-link-type="uri" xlink:href="https://github.com/LooseLab/readfish/blob/master/TOML.md">https://github.com/LooseLab/readfish/blob/master/TOML.md</ext-link>).</p>
    </sec>
    <sec id="S14">
      <title>readfish Code availability</title>
      <p id="P33">The ONT Read Until API is required for running Read Until <sup><xref rid="R10" ref-type="bibr">10</xref></sup>. The results presented here used an updated version of this API, available from our GitHub (<ext-link ext-link-type="uri" xlink:href="https://github.com/LooseLab/read_until_api_v2">https://github.com/LooseLab/read_until_api_v2</ext-link>; Git commit cff0f52). These changes were required for Python3 compatibility and also change the behaviour of the read cache enabling consecutive chunks of data to be stored for calling. As the ONT tool chain matures to Python3 such changes will no longer be required. pyguppyclient (v0.0.5), a python interface to the Guppy base calling server is currently available on PyPI. Our code is available open source at <ext-link ext-link-type="uri" xlink:href="http://www.github.com/LooseLab/readfish">http://www.github.com/LooseLab/readfish</ext-link> and installable via PyPI.</p>
    </sec>
    <sec id="S15">
      <title>Read Until Implementation</title>
    </sec>
    <sec id="S16">
      <title>ReadFish scripts</title>
      <p id="P34">ReadFish is a set of scripts that control sequencing in real time. Each script is accessed as a sub-command, and a description is given below.</p>
      <sec id="S17">
        <title>targets</title>
        <p id="P35">This script runs the core Read Until process as specified in the experiment TOML file. It can select specific regions of a genome, mapping reads in real time using minimap2 and rejecting reads appropriately. This script should be started once the initial mux scan has completed. The experiment TOML file can be updated during a sequencing run to change the configuration of the Read Until process. It is through this mechanism that the align and centrifuge commands can change Read Until behaviour during a run. Configuration parameters are available under the help flag. <xref rid="T1" ref-type="table">Tables 1</xref> and <xref rid="T2" ref-type="table">2</xref> describe the mapping parameters and configuration options for various possible experiment types.</p>
      </sec>
      <sec id="S18">
        <title>align</title>
        <p id="P36">This script runs an instance of the “Run Until” monitoring system that watches as completed reads are written to disc. When new data is detected this pipeline will map the data against the target reference genome (specified in the experiment TOML file) and compute the cumulative coverage for the sequencing run. Once a genomic target reaches sufficient coverage, it will be added to the unblock list. Optionally, the user can provide additional targets from the start of the run to implement “host depletion”. Finally, the user can configure align to stop the entire run if all samples have reached the required coverage depth. At present, this coverage depth is uniform for all samples, so it is not possible to have variable coverage over a target set.</p>
      </sec>
      <sec id="S19">
        <title>centrifuge</title>
        <p id="P37">This script runs an instance of the “Run Until” monitoring system. As completed reads are written to disc this programme (<xref ref-type="supplementary-material" rid="SD1">Supplementary Figure. S1C</xref>) will classify the reads using centrifuge and a user defined index. When 2000 reads are uniquely classified the corresponding reference genome is downloaded from RefSeq <sup><xref rid="R32" ref-type="bibr">32</xref></sup> and incorporated into a minimap2 index. At this point the same process as in align is used to determine coverage depth. The new alignment index is passed to the core Read Until script (targets) by updating the experiment TOML file allowing dynamic updates for both the unblock list and the genomic reference.</p>
      </sec>
      <sec id="S20">
        <title>unblock-all</title>
        <p id="P38">This script is provided as a test of the Read Until API where all incoming read fragments are immediately unblocked. It allows a user to quickly determine if their MinKNOW instance is able to provide and process unblock signals at the correct rate. Users should provide a bulk FAST5 file for playback for this testing process.</p>
      </sec>
      <sec id="S21">
        <title>validate</title>
        <p id="P39">This script is a standalone tool for validating an experiment TOML file. We provide a ru_schema.json (<ext-link ext-link-type="uri" xlink:href="https://github.com/LooseLab/readfish/blob/master/ru/static/ru_toml.schema.json">https://github.com/LooseLab/readfish/blob/master/ru/static/ru_toml.schema.json</ext-link>) that describes the required configuration format.</p>
      </sec>
      <sec id="S22">
        <title>Reporting Summary</title>
        <p id="P40">For further details see the Reporting Summary for this manuscript.</p>
      </sec>
    </sec>
  </sec>
  <sec sec-type="supplementary-material" id="SM">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="SD1">
      <label>Supplementary Figures</label>
      <media xlink:href="EMS118410-supplement-Supplementary_Figures.pdf" mimetype="application" mime-subtype="pdf" orientation="portrait" id="d40e777" position="anchor"/>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="SD2">
      <label>Supplementary File 1</label>
      <media xlink:href="EMS118410-supplement-Supplementary_File_1.csv" mimetype="text" mime-subtype="csv; charset=utf-8" orientation="portrait" id="d40e781" position="anchor"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="S23">
    <title>Acknowledgments</title>
    <p>The authors thank J Quick, J Tyson, J Simpson and N Loman for helpful comments and (mainly) criticisms. E Birney, N Goldman and A Senf for helpful insights and discussion on these approaches. We thank M Hubank and L Gallagher for access to materials and reagents as well as general boundless enthusiasm. We thank M Jain for assisting in manipulating data. The authors also thank S Reid, C Wright, C Seymour, J Pugh and G Pimm from Oxford Nanopore Technologies for advice on MinKNOW and Guppy operations as well as extensive troubleshooting!</p>
    <sec id="S24">
      <title>Funding</title>
      <p>This work was supported by the Biotechnology and Biological Sciences Research Council [grant number BB/N017099/1 RM, ML, BB/M020061/1 ML,, BB/M008770/1, 1949454 AP], and the Wellcome Trust [grant number 204843/Z/16/Z, NH, ML], and the Defence Science and Technology Laboratory [grant number DSTLX-1000138444 RM, ML]..</p>
    </sec>
  </ack>
  <fn-group>
    <fn id="FN1" fn-type="con">
      <p id="P43">
        <bold>Author contributions</bold>
      </p>
      <p id="P44">M.L and A.P conceived the study. A.P, N.H and M.L acquired data. T.C and R.M designed and implemented metagenomics applications. A.P, B.J.D and M.L analysed and interpreted data. All authors discussed the results and contributed to the final manuscript.</p>
    </fn>
    <fn fn-type="COI-statement" id="FN2">
      <p id="P45">
        <bold>Competing interests</bold>
      </p>
      <p id="P46">ML was a member of the MinION access program and has received free flow cells and sequencing reagents in the past. ML has received reimbursement for travel, accommodation and conference fees to speak at events organized by Oxford Nanopore Technologies.</p>
    </fn>
  </fn-group>
  <sec id="S25" sec-type="data-availability">
    <title>Data Availability</title>
    <p id="P41">All reads generated in the course of this study are available from the ENA under project id PRJEB36644.</p>
  </sec>
  <sec id="S26" sec-type="data-availability">
    <title>Code availability</title>
    <p id="P42">Our code is available open source at <ext-link ext-link-type="uri" xlink:href="http://www.github.com/LooseLab/readfish">http://www.github.com/LooseLab/readfish</ext-link>
</p>
  </sec>
  <ref-list>
    <ref id="R1">
      <label>1</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Loose</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Malla</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Stout</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Real-time selective sequencing using nanopore technology</article-title>
        <source>Nat Methods</source>
        <year>2016</year>
        <volume>13</volume>
        <fpage>751</fpage>
        <lpage>754</lpage>
        <pub-id pub-id-type="pmid">27454285</pub-id>
      </element-citation>
    </ref>
    <ref id="R2">
      <label>2</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Masutani</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Morishita</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>A framework and an algorithm to detect low-abundance DNA by a handy sequencer and a palm-sized computer</article-title>
        <source>Bioinformatics</source>
        <year>2019</year>
        <volume>35</volume>
        <fpage>584</fpage>
        <lpage>592</lpage>
        <pub-id pub-id-type="pmid">30776078</pub-id>
      </element-citation>
    </ref>
    <ref id="R3">
      <label>3</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kovaka</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Fan</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Ni</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Timp</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Schatz</surname>
            <given-names>MC</given-names>
          </name>
        </person-group>
        <article-title>Targeted nanopore sequencing by real-time mapping of raw electrical signal with UNCALLED</article-title>
        <pub-id pub-id-type="doi">10.1101/2020.02.03.931923</pub-id>
      </element-citation>
    </ref>
    <ref id="R4">
      <label>4</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Edwards</surname>
            <given-names>HS</given-names>
          </name>
          <name>
            <surname>Krishnakumar</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Sinha</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Bird</surname>
            <given-names>SW</given-names>
          </name>
          <name>
            <surname>Patel</surname>
            <given-names>KD</given-names>
          </name>
          <name>
            <surname>Bartsch</surname>
            <given-names>MS</given-names>
          </name>
        </person-group>
        <article-title>Real-Time Selective Sequencing with RUBRIC: Read Until with Basecall and Reference-Informed Criteria</article-title>
        <source>Sci Rep</source>
        <year>2019</year>
        <volume>9</volume>
        <comment>11475</comment>
      </element-citation>
    </ref>
    <ref id="R5">
      <label>5</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rang</surname>
            <given-names>FJ</given-names>
          </name>
          <name>
            <surname>Kloosterman</surname>
            <given-names>WP</given-names>
          </name>
          <name>
            <surname>de Ridder</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>From squiggle to basepair: computational approaches for improving nanopore sequencing read accuracy</article-title>
        <source>Genome Biol</source>
        <year>2018</year>
        <volume>19</volume>
        <fpage>90</fpage>
        <pub-id pub-id-type="pmid">30005597</pub-id>
      </element-citation>
    </ref>
    <ref id="R6">
      <label>6</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Minimap2: pairwise alignment for nucleotide sequences</article-title>
        <source>Bioinformatics</source>
        <year>2018</year>
        <volume>34</volume>
        <fpage>3094</fpage>
        <lpage>3100</lpage>
        <pub-id pub-id-type="pmid">29750242</pub-id>
      </element-citation>
    </ref>
    <ref id="R7">
      <label>7</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kim</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Song</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Breitwieser</surname>
            <given-names>FP</given-names>
          </name>
          <name>
            <surname>Salzberg</surname>
            <given-names>SL</given-names>
          </name>
        </person-group>
        <article-title>Centrifuge: rapid and sensitive classification of metagenomic sequences</article-title>
        <source>Genome Res</source>
        <year>2016</year>
        <volume>26</volume>
        <fpage>1721</fpage>
        <lpage>1729</lpage>
        <pub-id pub-id-type="pmid">27852649</pub-id>
      </element-citation>
    </ref>
    <ref id="R8">
      <label>8</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tate</surname>
            <given-names>JG</given-names>
          </name>
          <name>
            <surname>Bamford</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Jubb</surname>
            <given-names>HC</given-names>
          </name>
          <name>
            <surname>Sondka</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Beare</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>Bindal</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Boutselakis</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Cole</surname>
            <given-names>CG</given-names>
          </name>
          <name>
            <surname>Creatore</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Dawson</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Fish</surname>
            <given-names>P</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>COSMIC: the Catalogue Of Somatic Mutations In Cancer</article-title>
        <source>Nucleic Acids Res</source>
        <year>2019</year>
        <volume>47</volume>
        <fpage>D941</fpage>
        <lpage>D947</lpage>
        <pub-id pub-id-type="pmid">30371878</pub-id>
      </element-citation>
    </ref>
    <ref id="R9">
      <label>9</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mozziconacci</surname>
            <given-names>M-J</given-names>
          </name>
          <name>
            <surname>Rosenauer</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Restouin</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Fanelli</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Shao</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Fernandez</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Toiron</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Viscardi</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Gambacorti-Passerini</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Miller</surname>
            <given-names>WH</given-names>
            <suffix>Jr</suffix>
          </name>
        </person-group>
        <article-title>Molecular cytogenetics of the acute promyelocytic leukemia-derived cell line NB4 and of four all-trans retinoic acid--resistant subclones</article-title>
        <source>Genes Chromosomes Cancer</source>
        <year>2002</year>
        <volume>35</volume>
        <fpage>261</fpage>
        <lpage>270</lpage>
        <comment>Others</comment>
        <pub-id pub-id-type="pmid">12353268</pub-id>
      </element-citation>
    </ref>
    <ref id="R10">
      <label>10</label>
      <element-citation publication-type="web">
        <article-title>read_until_api</article-title>
        <date-in-citation>Accessed: 4th August 2020</date-in-citation>
        <comment>Available at: <ext-link ext-link-type="uri" xlink:href="https://github.com/nanoporetech/read_until_api">https://github.com/nanoporetech/read_until_api</ext-link></comment>
      </element-citation>
    </ref>
    <ref id="R11">
      <label>11</label>
      <element-citation publication-type="web">
        <article-title>pyguppyclient</article-title>
        <date-in-citation>Accessed: 4th August 2020</date-in-citation>
        <comment>Available at: <ext-link ext-link-type="uri" xlink:href="https://github.com/nanoporetech/pyguppyclient">https://github.com/nanoporetech/pyguppyclient</ext-link></comment>
      </element-citation>
    </ref>
    <ref id="R12">
      <label>12</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jain</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Koren</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Miga</surname>
            <given-names>KH</given-names>
          </name>
          <name>
            <surname>Quick</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Rand</surname>
            <given-names>AC</given-names>
          </name>
          <name>
            <surname>Sasani</surname>
            <given-names>TA</given-names>
          </name>
          <name>
            <surname>Tyson</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Beggs</surname>
            <given-names>AD</given-names>
          </name>
          <name>
            <surname>Dilthey</surname>
            <given-names>AT</given-names>
          </name>
          <name>
            <surname>Fiddes</surname>
            <given-names>IT</given-names>
          </name>
          <name>
            <surname>Malla</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Nanopore sequencing and assembly of a human genome with ultra-long reads</article-title>
        <source>Nat Biotechnol</source>
        <year>2018</year>
        <volume>36</volume>
        <fpage>338</fpage>
        <lpage>345</lpage>
        <pub-id pub-id-type="pmid">29431738</pub-id>
      </element-citation>
    </ref>
    <ref id="R13">
      <label>13</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wain</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Leggett</surname>
            <given-names>RM</given-names>
          </name>
          <name>
            <surname>Livermore</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>O’Grady</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Nanopore metagenomics enables rapid clinical diagnosis of bacterial lower respiratory infection</article-title>
        <source>Biotechnology</source>
        <year>2019</year>
      </element-citation>
    </ref>
    <ref id="R14">
      <label>14</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Marotz</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Sanders</surname>
            <given-names>JG</given-names>
          </name>
          <name>
            <surname>Zuniga</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Zaramela</surname>
            <given-names>LS</given-names>
          </name>
          <name>
            <surname>Knight</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Zengler</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>Improving saliva shotgun metagenomics by chemical host DNA depletion</article-title>
        <source>Microbiome</source>
        <year>2018</year>
        <volume>6</volume>
      </element-citation>
    </ref>
    <ref id="R15">
      <label>15</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nicholls</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Quick</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Tang</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Loman</surname>
            <given-names>NJ</given-names>
          </name>
        </person-group>
        <article-title>Ultra-deep, long-read nanopore sequencing of mock microbial community standards</article-title>
        <source>Gigascience</source>
        <year>2019</year>
        <volume>8</volume>
      </element-citation>
    </ref>
    <ref id="R16">
      <label>16</label>
      <element-citation publication-type="web">
        <article-title>mockcommunity</article-title>
        <date-in-citation>Accessed: 17th January 2020</date-in-citation>
        <comment>Available at: <ext-link ext-link-type="uri" xlink:href="https://github.com/LomanLab/mockcommunity">https://github.com/LomanLab/mockcommunity</ext-link></comment>
      </element-citation>
    </ref>
    <ref id="R17">
      <label>17</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kolmogorov</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Yuan</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Pevzner</surname>
            <given-names>PA</given-names>
          </name>
        </person-group>
        <article-title>Assembly of long, error-prone reads using repeat graphs</article-title>
        <source>Nat Biotechnol</source>
        <year>2019</year>
        <volume>37</volume>
        <fpage>540</fpage>
        <lpage>546</lpage>
        <pub-id pub-id-type="pmid">30936562</pub-id>
      </element-citation>
    </ref>
    <ref id="R18">
      <label>18</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kozarewa</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Armisen</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Gardner</surname>
            <given-names>AF</given-names>
          </name>
          <name>
            <surname>Slatko</surname>
            <given-names>BE</given-names>
          </name>
          <name>
            <surname>Hendrickson</surname>
            <given-names>CL</given-names>
          </name>
        </person-group>
        <article-title>Overview of Target Enrichment Strategies</article-title>
        <source>Curr Protoc Mol Biol</source>
        <year>2015</year>
        <volume>112</volume>
        <fpage>7.21.1</fpage>
        <lpage>7.21.23</lpage>
        <pub-id pub-id-type="pmid">26423591</pub-id>
      </element-citation>
    </ref>
    <ref id="R19">
      <label>19</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gnirke</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Melnikov</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Maguire</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Rogov</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>LeProust</surname>
            <given-names>EM</given-names>
          </name>
          <name>
            <surname>Brockman</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Fennell</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Giannoukos</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Fisher</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Russ</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Gabriel</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Solution hybrid selection with ultra-long oligonucleotides for massively parallel targeted sequencing</article-title>
        <source>Nat Biotechnol</source>
        <year>2009</year>
        <volume>27</volume>
        <fpage>182</fpage>
        <lpage>189</lpage>
        <pub-id pub-id-type="pmid">19182786</pub-id>
      </element-citation>
    </ref>
    <ref id="R20">
      <label>20</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bowen</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Heron</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Sedlazeck</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Timp</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>Targeted Nanopore Sequencing with Cas9 for studies of methylation, structural variants and mutations</article-title>
        <source>BioRxiv</source>
        <year>2019</year>
      </element-citation>
    </ref>
    <ref id="R21">
      <label>21</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Loose</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Finding the Needle: Targeted Nanopore Sequencing and CRISPR-Cas9</article-title>
        <source>The CRISPR Journal</source>
        <year>2018</year>
        <volume>1</volume>
        <fpage>265</fpage>
        <lpage>267</lpage>
        <pub-id pub-id-type="pmid">31021218</pub-id>
      </element-citation>
    </ref>
    <ref id="R22">
      <label>22</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cunningham</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Achuthan</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Akanni</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Allen</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Amode</surname>
            <given-names>MR</given-names>
          </name>
          <name>
            <surname>Armean</surname>
            <given-names>IM</given-names>
          </name>
          <name>
            <surname>Bennett</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Bhai</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Billis</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Boddu</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Cummins</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Ensembl 2019</article-title>
        <source>Nucleic Acids Res</source>
        <year>2019</year>
        <volume>47</volume>
        <fpage>D745</fpage>
        <lpage>D751</lpage>
        <pub-id pub-id-type="pmid">30407521</pub-id>
      </element-citation>
    </ref>
    <ref id="R23">
      <label>23</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Heller</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Vingron</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>SVIM: structural variant identification using mapped long reads</article-title>
        <source>Bioinformatics</source>
        <year>2019</year>
        <volume>35</volume>
        <fpage>2907</fpage>
        <lpage>2915</lpage>
        <pub-id pub-id-type="pmid">30668829</pub-id>
      </element-citation>
    </ref>
    <ref id="R24">
      <label>24</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sedlazeck</surname>
            <given-names>FJ</given-names>
          </name>
          <name>
            <surname>Rescheneder</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Smolka</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Fang</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Nattestad</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>von Haeseler</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Schatz</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Accurate detection of complex structural variations using single molecule sequencing</article-title>
        <source>bioRxiv</source>
        <year>2017</year>
        <comment>169557</comment>
        <pub-id pub-id-type="doi">10.1101/169557</pub-id>
      </element-citation>
    </ref>
    <ref id="R25">
      <label>25</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Beyter</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Ingimundardottir</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Eggertsson</surname>
            <given-names>HP</given-names>
          </name>
        </person-group>
        <article-title>Long read sequencing of 1,817 Icelanders provides insight into the role of structural variants in human disease</article-title>
        <source>BioRxiv</source>
        <year>2019</year>
      </element-citation>
    </ref>
    <ref id="R26">
      <label>26</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Simpson</surname>
            <given-names>JT</given-names>
          </name>
          <name>
            <surname>Workman</surname>
            <given-names>RE</given-names>
          </name>
          <name>
            <surname>Zuzarte</surname>
            <given-names>PC</given-names>
          </name>
          <name>
            <surname>David</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Dursi</surname>
            <given-names>LJ</given-names>
          </name>
          <name>
            <surname>Timp</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>Detecting DNA cytosine methylation using nanopore sequencing</article-title>
        <source>Nat Methods</source>
        <year>2017</year>
        <volume>14</volume>
        <fpage>407</fpage>
        <lpage>410</lpage>
        <pub-id pub-id-type="pmid">28218898</pub-id>
      </element-citation>
    </ref>
    <ref id="R27">
      <label>27</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zook</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>McDaniel</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Olson</surname>
            <given-names>ND</given-names>
          </name>
          <name>
            <surname>Wagner</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Parikh</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Heaton</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Irvine</surname>
            <given-names>SA</given-names>
          </name>
          <name>
            <surname>Trigg</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Truty</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>McLean</surname>
            <given-names>CY</given-names>
          </name>
          <name>
            <surname>De La Vega</surname>
            <given-names>FM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>An open resource for accurately benchmarking small variant and reference calls</article-title>
        <source>Nat Biotechnol</source>
        <year>2019</year>
        <volume>37</volume>
        <fpage>561</fpage>
        <lpage>566</lpage>
        <pub-id pub-id-type="pmid">30936564</pub-id>
      </element-citation>
    </ref>
    <ref id="R28">
      <label>28</label>
      <element-citation publication-type="web">
        <article-title>hap.py</article-title>
        <date-in-citation>Accessed: 4th August 2020</date-in-citation>
        <comment>Available at: <ext-link ext-link-type="uri" xlink:href="https://github.com/Illumina/hap.py">https://github.com/Illumina/hap.py</ext-link></comment>
      </element-citation>
    </ref>
    <ref id="R29">
      <label>29</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jeffares</surname>
            <given-names>DC</given-names>
          </name>
          <name>
            <surname>Jolly</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Hoti</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Speed</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Shaw</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Rallis</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Balloux</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Dessimoz</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Bähler</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Sedlazeck</surname>
            <given-names>FJ</given-names>
          </name>
        </person-group>
        <article-title>Transient structural variations have strong effects on quantitative traits and reproductive isolation in fission yeast</article-title>
        <source>Nat Commun</source>
        <year>2017</year>
        <volume>8</volume>
        <comment>14061</comment>
      </element-citation>
    </ref>
    <ref id="R30">
      <label>30</label>
      <element-citation publication-type="web">
        <article-title>truvari</article-title>
        <date-in-citation>Accessed: 7th August 2020</date-in-citation>
        <comment>Available at: <ext-link ext-link-type="uri" xlink:href="https://github.com/spiralgenetics/truvari">https://github.com/spiralgenetics/truvari</ext-link></comment>
      </element-citation>
    </ref>
    <ref id="R31">
      <label>31</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nattestad</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Chin</surname>
            <given-names>C-S</given-names>
          </name>
          <name>
            <surname>Schatz</surname>
            <given-names>MC</given-names>
          </name>
        </person-group>
        <article-title>Ribbon: Visualizing complex genome alignments and structural variation</article-title>
        <source>bioRxiv</source>
        <year>2016</year>
        <comment>082123</comment>
        <pub-id pub-id-type="doi">10.1101/082123</pub-id>
      </element-citation>
    </ref>
    <ref id="R32">
      <label>32</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pruitt</surname>
            <given-names>KD</given-names>
          </name>
          <name>
            <surname>Maglott</surname>
            <given-names>DR</given-names>
          </name>
        </person-group>
        <article-title>RefSeq and LocusLink: NCBI gene-centered resources</article-title>
        <source>Nucleic Acids Res</source>
        <year>2001</year>
        <volume>29</volume>
        <fpage>137</fpage>
        <lpage>140</lpage>
        <pub-id pub-id-type="pmid">11125071</pub-id>
      </element-citation>
    </ref>
    <ref id="R33">
      <label>33</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pedersen</surname>
            <given-names>BS</given-names>
          </name>
          <name>
            <surname>Quinlan</surname>
            <given-names>AR</given-names>
          </name>
        </person-group>
        <article-title>Mosdepth: quick coverage calculation for genomes and exomes</article-title>
        <source>Bioinformatics</source>
        <year>2018</year>
        <volume>34</volume>
        <fpage>867</fpage>
        <lpage>868</lpage>
        <pub-id pub-id-type="pmid">29096012</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
<floats-group>
  <fig id="F1" orientation="portrait" position="float">
    <label>Figure 1</label>
    <caption>
      <title>Human Genome Scale Selective Sequencing.</title>
      <p>A) Median read lengths for reads sequenced from GM12878 and mapped against HG38 excluding alt chromosomes. The four panels each represent a quadrant of the flow cell. In the control all reads are sequenced, in the second reads mapping to chromosomes 1-8, in the third reads mapping to chromosomes 9-14 and the fourth reads mapping to chromosomes 16-20. The combined length of each of these target sets equates to approximately ½, ¼ and ⅛ of the human genome respectively. B) Heatmap of throughput per channel in each quadrant from the flow cell illustrating reduced yield as the proportion of reads rejected is increased. C) Yield ratio for each chromosome in each condition normalised against yield observed for each chromosome in the control quadrant. D) Yield of on target reads calculated in a rolling window over the course of the sequencing run showing the loss of enrichment potential. E) Plot of the number of channels contributing sequence data over the course of the sequencing run. Channels are lost at a greater rate when more reads are rejected.</p>
    </caption>
    <graphic xlink:href="EMS118410-f001"/>
  </fig>
  <fig id="F2" orientation="portrait" position="float">
    <label>Figure 2</label>
    <caption>
      <title>Adaptive sequencing enriching for the least abundant genome and ensuring uniform 40x coverage.</title>
      <p>A) Mean read lengths for reads sequenced from the ZymoBIOMICS mock metagenomic community mapped against the provided references (ZymoBIOMICS, USA). Read lengths are reported for the whole run, the deliberately sequenced reads and those which were actively unblocked. B) Shows cumulative coverage of each ZymoBIOMICS genome during the sequencing run. The total coverage still accumulated as unblocked reads, though short, still map. Sequencing was automatically terminated once each sample reached 40x. C) Stacked area graph illustrating how the proportion of bases mapping to each species changes over time. D) In contrast, the proportion of reads mapping to each species over time doesn’t change significantly. <italic>Species and composition are: bs - Bacillus subtilis (14%), ef - Enterococcus faecalis (14%), ec - Escherichia coli (14%), lm - Listeria monocytogenes (14%), pa - Pseudomonas aeruginosa (14%), sc - Saccharomyces cerevisiae (2%), se - Salmonella enterica (14%), sa - Staphylococcus aureus (14%)</italic>.</p>
    </caption>
    <graphic xlink:href="EMS118410-f002"/>
  </fig>
  <fig id="F3" orientation="portrait" position="float">
    <label>Figure 3</label>
    <caption>
      <title>Adaptive sequencing enriching for the least abundant genome with centrifuge read classification and ensuring uniform 50x coverage.</title>
      <p>A) Mean read lengths for reads sequenced from the ZymoBIOMICS mock metagenomic community mapped against the provided references. Read lengths are reported for the whole run, the deliberately sequenced reads and those which were actively unblocked. B) Shows cumulative coverage of each ZymoBIOMICS genome during the sequencing run. The total coverage still accumulated as unblocked reads, though short, still map. Sequencing was automatically terminated once each sample reached 50x. The small overshoot in sequenced reads coverage is likely caused by the centrifuge step lagging as reads are not instantly written to disk. C) Stacked area graph illustrating how the proportion of bases mapping to each species changes over time. D) In contrast, the proportion of reads mapping to each species over time doesn’t change significantly. Species and composition as in <xref ref-type="fig" rid="F2">Figure 2</xref>.</p>
    </caption>
    <graphic xlink:href="EMS118410-f003"/>
  </fig>
  <fig id="F4" orientation="portrait" position="float">
    <label>Figure 4</label>
    <caption>
      <title>Half Exome Panel Targeted Sequencing.</title>
      <p>A) Mean coverage across each exon target in the genome ordered by chromosome. Exons on odd numbered chromosomes are enriched (green) and depleted on even numbered chromosomes (red). B) Mean coverage across each exon for genes within the COSMIC panels. For A and B, horizontal lines represent approximate mean expected coverage for flow cells yielding 10, 20 or 30 Gb of data in a single run. Mean coverage calculated by mosdepth <sup><xref rid="R33" ref-type="bibr">33</xref></sup>. C,D,E,F) Coverage plots for highlighted genes including BRCA1 (C), PML (D), WIF1 (E) and HOXC13 and HOXC11 (F). C and D are enriched as they are found on chromosome 17 and 15 whilst E and F are depleted as genes are on chromosome 12. Exon target regions indicated by arrows. In this experiment, different targets were used for the Watson and Crick strands as illustrated by the offsets. Note the absence of target regions for panels E and F.</p>
    </caption>
    <graphic xlink:href="EMS118410-f004"/>
  </fig>
  <fig id="F5" orientation="portrait" position="float">
    <label>Figure 5</label>
    <caption>
      <title>COSMIC Panel Targeted Sequencing.</title>
      <p>A &amp; B) Mean coverage across the selected COSMIC gene regions ordered by chromosome for two independent sequencing runs of NA12878. Horizontal lines represent approximate mean expected coverage for flow cells yielding 10, 20 or 30 Gb of data in a single run. Mean coverage calculated by mosdepth <sup><xref rid="R33" ref-type="bibr">33</xref></sup>. C,D,E,F) Coverage plots from each run (light green) for highlighted genes including BRCA1 (C), PML (D), WIF1 (E) and HOXC13 and HOXC11 (F). For comparison, coverage in the same regions for a 35X whole genome sequenced nanopore run shown in blue. COSMIC Target regions indicated by blue bars and include intronic sequence.</p>
    </caption>
    <graphic xlink:href="EMS118410-f005"/>
  </fig>
  <fig id="F6" orientation="portrait" position="float">
    <label>Figure 6</label>
    <caption>
      <title>COSMIC Panel Targeted Sequencing of NB4.</title>
      <p>A &amp; B) Mean coverage across each of the COSMIC target regions ordered by chromosome for two independent sequencing runs of the NB4 cell line. Horizontal dashed line indicates expected coverage from a flow cell yielding 10, 20 or 30 Gb of sequence data in a single run. C &amp; D) Coverage plots for each NB4 sequencing run shown in orange for PML (C) and RARA (D). E &amp; F) Reads mapping to chromosomes 15 and 17 derived from the NB4 cell line runs 1 and 2 respectively indicating the fusion between PML and RARA. Mappings of example individual reads are shown. Breakpoints identified using svim, visualisations using Ribbon <sup><xref rid="R23" ref-type="bibr">23</xref>,<xref rid="R31" ref-type="bibr">31</xref></sup>.</p>
    </caption>
    <graphic xlink:href="EMS118410-f006"/>
  </fig>
  <table-wrap id="T1" position="float" orientation="portrait">
    <label>Table 1</label>
    <caption>
      <title>Description of possible read mapping conditions.</title>
    </caption>
    <table frame="box" rules="all">
      <thead>
        <tr>
          <th align="left" valign="middle" rowspan="1" colspan="1">Mapping Condition</th>
          <th align="left" valign="middle" rowspan="1" colspan="1">Description</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td align="left" valign="top" rowspan="1" colspan="1">multi_on</td>
          <td align="left" valign="top" rowspan="1" colspan="1">Read fragment maps multiple locations including region of interest.</td>
        </tr>
        <tr>
          <td align="left" valign="top" rowspan="1" colspan="1">multi_off</td>
          <td align="left" valign="top" rowspan="1" colspan="1">Read fragment maps to multiple locations not including region of interest.</td>
        </tr>
        <tr>
          <td align="left" valign="top" rowspan="1" colspan="1">single_on</td>
          <td align="left" valign="top" rowspan="1" colspan="1">Read fragment only maps to region of interest.</td>
        </tr>
        <tr>
          <td align="left" valign="top" rowspan="1" colspan="1">single_off</td>
          <td align="left" valign="top" rowspan="1" colspan="1">Read fragment maps to one location but it is not a region of interest.</td>
        </tr>
        <tr>
          <td align="left" valign="top" rowspan="1" colspan="1">no_map</td>
          <td align="left" valign="top" rowspan="1" colspan="1">Read fragment does not map to the reference.</td>
        </tr>
        <tr>
          <td align="left" valign="top" rowspan="1" colspan="1">no_seq</td>
          <td align="left" valign="top" rowspan="1" colspan="1">No sequence was obtained for the signal fragment.</td>
        </tr>
      </tbody>
    </table>
  </table-wrap>
  <table-wrap id="T2" position="float" orientation="portrait">
    <label>Table 2</label>
    <caption>
      <p>Example configurations for different experiment types. “Unblock” causes a read to be ejected from the pore, “proceed” means that a read continues to sequence and serve data through the API for later decisions, “stop receiving” allows the read to continue sequencing with no further data served through the API.</p>
    </caption>
    <table frame="box" rules="all">
      <thead>
        <tr>
          <th rowspan="2" align="left" valign="middle" colspan="1">Experiment Type</th>
          <th rowspan="2" align="left" valign="middle" colspan="1">Region of Interest for Alignments</th>
          <th colspan="6" align="left" valign="top" rowspan="1">Mapping Condition</th>
        </tr>
        <tr>
          <th align="left" valign="top" rowspan="1" colspan="1">multi_on</th>
          <th align="left" valign="top" rowspan="1" colspan="1">multi_off</th>
          <th align="left" valign="top" rowspan="1" colspan="1">single_on</th>
          <th align="left" valign="top" rowspan="1" colspan="1">single_off</th>
          <th align="left" valign="top" rowspan="1" colspan="1">no_map</th>
          <th align="left" valign="top" rowspan="1" colspan="1">no_seq</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td align="left" valign="top" rowspan="1" colspan="1">
            <bold>Host Depletion</bold>
          </td>
          <td align="left" valign="top" rowspan="1" colspan="1">Known Host Genome</td>
          <td align="left" valign="top" rowspan="1" colspan="1">unblock</td>
          <td align="left" valign="top" rowspan="1" colspan="1">proceed</td>
          <td align="left" valign="top" rowspan="1" colspan="1">unblock</td>
          <td align="left" valign="top" rowspan="1" colspan="1">proceed</td>
          <td align="left" valign="top" rowspan="1" colspan="1">proceed</td>
          <td align="left" valign="top" rowspan="1" colspan="1">proceed</td>
        </tr>
        <tr>
          <td align="left" valign="top" rowspan="1" colspan="1">
            <bold>Targeted Sequencing</bold>
          </td>
          <td align="left" valign="top" rowspan="1" colspan="1">Known regions from one or more genomes.</td>
          <td align="left" valign="top" rowspan="1" colspan="1">stop receiving</td>
          <td align="left" valign="top" rowspan="1" colspan="1">proceed</td>
          <td align="left" valign="top" rowspan="1" colspan="1">stop receiving</td>
          <td align="left" valign="top" rowspan="1" colspan="1">unblock</td>
          <td align="left" valign="top" rowspan="1" colspan="1">proceed</td>
          <td align="left" valign="top" rowspan="1" colspan="1">proceed</td>
        </tr>
        <tr>
          <td align="left" valign="top" rowspan="1" colspan="1"><bold>Target Coverage Depth</bold> (known sample composition)</td>
          <td align="left" valign="top" rowspan="1" colspan="1">All known genomes within the sample, tracked for coverage depth.</td>
          <td align="left" valign="top" rowspan="1" colspan="1">stop receiving</td>
          <td align="left" valign="top" rowspan="1" colspan="1">proceed</td>
          <td align="left" valign="top" rowspan="1" colspan="1">stop receiving</td>
          <td align="left" valign="top" rowspan="1" colspan="1">unblock</td>
          <td align="left" valign="top" rowspan="1" colspan="1">proceed</td>
          <td align="left" valign="top" rowspan="1" colspan="1">proceed</td>
        </tr>
        <tr>
          <td align="left" valign="top" rowspan="1" colspan="1"><bold>Low Abundance Enrichment</bold> (unknown sample composition)</td>
          <td align="left" valign="top" rowspan="1" colspan="1">All genomes within the sample that can be identified as well as those that cannot.</td>
          <td align="left" valign="top" rowspan="1" colspan="1">stop receiving</td>
          <td align="left" valign="top" rowspan="1" colspan="1">proceed</td>
          <td align="left" valign="top" rowspan="1" colspan="1">stop receiving</td>
          <td align="left" valign="top" rowspan="1" colspan="1">unblock</td>
          <td align="left" valign="top" rowspan="1" colspan="1">proceed</td>
          <td align="left" valign="top" rowspan="1" colspan="1">proceed</td>
        </tr>
      </tbody>
    </table>
  </table-wrap>
</floats-group>
