<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 39.96?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS Comput Biol</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-title-group>
      <journal-title>PLoS Computational Biology</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1553-734X</issn>
    <issn pub-type="epub">1553-7358</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, CA USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8330942</article-id>
    <article-id pub-id-type="pmid">34292930</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1009203</article-id>
    <article-id pub-id-type="publisher-id">PCOMPBIOL-D-20-01578</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Gene Expression</subject>
            <subj-group>
              <subject>Gene Regulation</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Gene Expression</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Genomics</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Cell Biology</subject>
          <subj-group>
            <subject>Chromosome Biology</subject>
            <subj-group>
              <subject>Chromatin</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Epigenetics</subject>
            <subj-group>
              <subject>Chromatin</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Gene Expression</subject>
            <subj-group>
              <subject>Chromatin</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Physical Sciences</subject>
        <subj-group>
          <subject>Mathematics</subject>
          <subj-group>
            <subject>Probability Theory</subject>
            <subj-group>
              <subject>Probability Distribution</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>DNA</subject>
            <subj-group>
              <subject>Promoter Regions</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Biochemistry</subject>
          <subj-group>
            <subject>Nucleic Acids</subject>
            <subj-group>
              <subject>DNA</subject>
              <subj-group>
                <subject>Promoter Regions</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Gene Expression</subject>
            <subj-group>
              <subject>Gene Regulation</subject>
              <subj-group>
                <subject>Promoter Regions</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and life sciences</subject>
        <subj-group>
          <subject>Computational biology</subject>
          <subj-group>
            <subject>Genome analysis</subject>
            <subj-group>
              <subject>Chromatin immunoprecipitation</subject>
              <subj-group>
                <subject>ChIA PET</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and life sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Genomics</subject>
            <subj-group>
              <subject>Genome analysis</subject>
              <subj-group>
                <subject>Chromatin immunoprecipitation</subject>
                <subj-group>
                  <subject>ChIA PET</subject>
                </subj-group>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Cell Biology</subject>
          <subj-group>
            <subject>Cell Physiology</subject>
            <subj-group>
              <subject>Cell Binding</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>ChIP-GSM: Inferring active transcription factor modules to predict functional regulatory elements</article-title>
      <alt-title alt-title-type="running-head">ChIP-GSM to infer trans-regulatory modules</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-3782-9029</contrib-id>
        <name>
          <surname>Chen</surname>
          <given-names>Xi</given-names>
        </name>
        <role content-type="https://casrai.org/credit/">Conceptualization</role>
        <role content-type="https://casrai.org/credit/">Formal analysis</role>
        <role content-type="https://casrai.org/credit/">Methodology</role>
        <role content-type="https://casrai.org/credit/">Software</role>
        <role content-type="https://casrai.org/credit/">Writing – original draft</role>
        <role content-type="https://casrai.org/credit/">Writing – review &amp; editing</role>
        <xref rid="aff001" ref-type="aff">
          <sup>1</sup>
        </xref>
        <xref rid="aff002" ref-type="aff">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-0086-5755</contrib-id>
        <name>
          <surname>Neuwald</surname>
          <given-names>Andrew F.</given-names>
        </name>
        <role content-type="https://casrai.org/credit/">Writing – review &amp; editing</role>
        <xref rid="aff003" ref-type="aff">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-7052-6513</contrib-id>
        <name>
          <surname>Hilakivi-Clarke</surname>
          <given-names>Leena</given-names>
        </name>
        <role content-type="https://casrai.org/credit/">Funding acquisition</role>
        <role content-type="https://casrai.org/credit/">Writing – review &amp; editing</role>
        <xref rid="aff004" ref-type="aff">
          <sup>4</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-9278-0854</contrib-id>
        <name>
          <surname>Clarke</surname>
          <given-names>Robert</given-names>
        </name>
        <role content-type="https://casrai.org/credit/">Conceptualization</role>
        <role content-type="https://casrai.org/credit/">Funding acquisition</role>
        <xref rid="aff004" ref-type="aff">
          <sup>4</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-7256-1374</contrib-id>
        <name>
          <surname>Xuan</surname>
          <given-names>Jianhua</given-names>
        </name>
        <role content-type="https://casrai.org/credit/">Conceptualization</role>
        <role content-type="https://casrai.org/credit/">Formal analysis</role>
        <role content-type="https://casrai.org/credit/">Funding acquisition</role>
        <role content-type="https://casrai.org/credit/">Methodology</role>
        <role content-type="https://casrai.org/credit/">Project administration</role>
        <role content-type="https://casrai.org/credit/">Supervision</role>
        <role content-type="https://casrai.org/credit/">Writing – original draft</role>
        <role content-type="https://casrai.org/credit/">Writing – review &amp; editing</role>
        <xref rid="aff001" ref-type="aff">
          <sup>1</sup>
        </xref>
        <xref rid="cor001" ref-type="corresp">*</xref>
      </contrib>
    </contrib-group>
    <aff id="aff001">
      <label>1</label>
      <addr-line>Bradley Department of Electrical and Computer Engineering, Virginia Polytechnic Institute and State University, Arlington, Virginia, United States of America</addr-line>
    </aff>
    <aff id="aff002">
      <label>2</label>
      <addr-line>Center for Computational Biology, Flatiron Institute, Simons Foundation, New York, New York, United States of America</addr-line>
    </aff>
    <aff id="aff003">
      <label>3</label>
      <addr-line>Institute for Genome Sciences and Department Biochemistry &amp; Molecular Biology, University of Maryland School of Medicine, Baltimore, Maryland, United States of America</addr-line>
    </aff>
    <aff id="aff004">
      <label>4</label>
      <addr-line>Hormel Institute, University of Minnesota, Minnesota, United States of America</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Zang</surname>
          <given-names>Chongzhi</given-names>
        </name>
        <role>Editor</role>
        <xref rid="edit1" ref-type="aff"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">
      <addr-line>University of Virginia, UNITED STATES</addr-line>
    </aff>
    <author-notes>
      <fn fn-type="COI-statement" id="coi001">
        <p>The authors have declared that no competing interests exist.</p>
      </fn>
      <corresp id="cor001">* E-mail: <email>xuan@vt.edu</email></corresp>
    </author-notes>
    <pub-date pub-type="epub">
      <day>22</day>
      <month>7</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="collection">
      <month>7</month>
      <year>2021</year>
    </pub-date>
    <volume>17</volume>
    <issue>7</issue>
    <elocation-id>e1009203</elocation-id>
    <history>
      <date date-type="received">
        <day>31</day>
        <month>8</month>
        <year>2020</year>
      </date>
      <date date-type="accepted">
        <day>20</day>
        <month>6</month>
        <year>2021</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2021 Chen et al</copyright-statement>
      <copyright-year>2021</copyright-year>
      <copyright-holder>Chen et al</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article distributed under the terms of the <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <self-uri xmlns:xlink="http://www.w3.org/1999/xlink" content-type="pdf" xlink:href="pcbi.1009203.pdf"/>
    <abstract>
      <p>Transcription factors (TFs) often function as a module including both master factors and mediators binding at cis-regulatory regions to modulate nearby gene transcription. ChIP-seq profiling of multiple TFs makes it feasible to infer functional TF modules. However, when inferring TF modules based on co-localization of ChIP-seq peaks, often many weak binding events are missed, especially for mediators, resulting in incomplete identification of modules. To address this problem, we develop a <underline>ChIP</underline>-seq data-driven <underline>G</underline>ibbs <underline>S</underline>ampler to infer <underline>M</underline>odules (ChIP-GSM) using a Bayesian framework that integrates ChIP-seq profiles of multiple TFs. ChIP-GSM samples read counts of module TFs iteratively to estimate the binding potential of a module to each region and, across all regions, estimates the module abundance. Using inferred module-region probabilistic bindings as feature units, ChIP-GSM then employs logistic regression to predict active regulatory elements. Validation of ChIP-GSM predicted regulatory regions on multiple independent datasets sharing the same context confirms the advantage of using TF modules for predicting regulatory activity. In a case study of K562 cells, we demonstrate that the ChIP-GSM inferred modules form as groups, activate gene expression at different time points, and mediate diverse functional cellular processes. Hence, ChIP-GSM infers biologically meaningful TF modules and improves the prediction accuracy of regulatory region activities.</p>
    </abstract>
    <abstract abstract-type="summary">
      <title>Author summary</title>
      <p>Investigating TF binding to different types of regulatory regions can help reveal underlying activation mechanisms. However, accurately inferring modules among a large set of TFs is challenging due to the existence of weak, noisy, and context-sensitive binding signals. To reliably infer TF modules, here we describe ChIP-GSM, a Gibbs sampler built upon a Bayesian framework, that can further predict active regulatory elements. A comparison with other methods demonstrates ChIP-GSM’s improved performance on module identification and active regulatory element prediction. Experimental results demonstrate that TF modules identified by ChIP-GSM are likely mediating distinct cellular functions by activating regulatory regions at different time points.</p>
    </abstract>
    <funding-group>
      <award-group id="award001">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000054</institution-id>
            <institution>National Cancer Institute</institution>
          </institution-wrap>
        </funding-source>
        <award-id>149653</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-7256-1374</contrib-id>
          <name>
            <surname>Xuan</surname>
            <given-names>Jianhua</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award002">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000054</institution-id>
            <institution>National Cancer Institute</institution>
          </institution-wrap>
        </funding-source>
        <award-id>149147</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-9278-0854</contrib-id>
          <name>
            <surname>Clarke</surname>
            <given-names>Robert</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award003">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000054</institution-id>
            <institution>National Cancer Institute</institution>
          </institution-wrap>
        </funding-source>
        <award-id>184902</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-9278-0854</contrib-id>
          <name>
            <surname>Clarke</surname>
            <given-names>Robert</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award004">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000054</institution-id>
            <institution>National Cancer Institute</institution>
          </institution-wrap>
        </funding-source>
        <award-id>164384</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-7052-6513</contrib-id>
          <name>
            <surname>Hilakivi-Clarke</surname>
            <given-names>Leena</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award005">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000057</institution-id>
            <institution>National Institute of General Medical Sciences</institution>
          </institution-wrap>
        </funding-source>
        <award-id>125878</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-0086-5755</contrib-id>
          <name>
            <surname>Neuwald</surname>
            <given-names>Andrew F.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <funding-statement>This work was supported in part by the National Cancer Institute (CA149653 to J.X., CA149147 &amp; CA184902 to R.C., CA164384 to L,H.-C.) and National Institute of General Medical Sciences (GM125878 to A.F.N). The funders had no role in study design, data collection, and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
    </funding-group>
    <counts>
      <fig-count count="6"/>
      <table-count count="0"/>
      <page-count count="22"/>
    </counts>
    <custom-meta-group>
      <custom-meta>
        <meta-name>PLOS Publication Stage</meta-name>
        <meta-value>vor-update-to-uncorrected-proof</meta-value>
      </custom-meta>
      <custom-meta>
        <meta-name>Publication Update</meta-name>
        <meta-value>2021-08-03</meta-value>
      </custom-meta>
      <custom-meta id="data-availability">
        <meta-name>Data Availability</meta-name>
        <meta-value>The authors confirm that all data underlying the findings are fully available without restriction. R scripts of ChIP-GSM, its user manual, and simulated and pre-processed ChIP-seq data can be accessed at <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://sourceforge.net/projects/chipgsm/" ext-link-type="uri">https://sourceforge.net/projects/chipgsm/</ext-link>. All the other relevant data are within the paper and its <xref rid="sec020" ref-type="sec">Supporting Information</xref> files.</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
  <notes>
    <title>Data Availability</title>
    <p>The authors confirm that all data underlying the findings are fully available without restriction. R scripts of ChIP-GSM, its user manual, and simulated and pre-processed ChIP-seq data can be accessed at <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://sourceforge.net/projects/chipgsm/" ext-link-type="uri">https://sourceforge.net/projects/chipgsm/</ext-link>. All the other relevant data are within the paper and its <xref rid="sec020" ref-type="sec">Supporting Information</xref> files.</p>
  </notes>
</front>
<body>
  <sec sec-type="intro" id="sec001">
    <title>Introduction</title>
    <p>DNA-binding proteins like transcription factors (TFs) usually function coordinatively as a module, a molecular complex that binds at cis-regulatory regions to modulate the expression of nearby genes. These modules consist of both master factors and mediators [<xref rid="pcbi.1009203.ref001" ref-type="bibr">1</xref>,<xref rid="pcbi.1009203.ref002" ref-type="bibr">2</xref>]. Master factors recruit different mediators to activate different types of regulatory regions and their cooperation may change in different contexts [<xref rid="pcbi.1009203.ref003" ref-type="bibr">3</xref>]. Joint analysis of multiple TFs ChIP-seq profiles have demonstrated the power to recover cell-type-specific regulatory modules [<xref rid="pcbi.1009203.ref004" ref-type="bibr">4</xref>–<xref rid="pcbi.1009203.ref009" ref-type="bibr">9</xref>]. ChromHMM [<xref rid="pcbi.1009203.ref004" ref-type="bibr">4</xref>] inferred chromatin states along the whole genome by modeling the presence or absence of histone marks using a multivariate hidden Markov model. jMOSAiCS [<xref rid="pcbi.1009203.ref005" ref-type="bibr">5</xref>] inferred combinatorial patterns of TF enrichment at each genomic region by modeling their ChIP-seq read counts using negative binomial mixture distributions. SignalSpider [<xref rid="pcbi.1009203.ref006" ref-type="bibr">6</xref>] modeled ChIP-seq read coverage using Gaussian mixture distributions and decipher the combinatorial TF binding events in a layered hierarchical probabilistic framework. In these methods, the input ChIP-seq data, which play a key role in modeling background regions and have been demonstrated important for accurate TF binding events identification [<xref rid="pcbi.1009203.ref010" ref-type="bibr">10</xref>–<xref rid="pcbi.1009203.ref013" ref-type="bibr">13</xref>], however, were not used, so the amplified background regions that could produce high read counts and confound the identification of binding events, especially weak ones, were not specifically modeled. The false rate on module identification could be high if weak binding events were included in their analysis. Among hundreds of TFs, there are more coactivators than master factors, and little is known about their associations. We need an approach to infer TF modules efficiently and accurately in a wide range of applications.</p>
    <p>Here we present ChIP-GSM, a <underline>ChIP</underline>-seq data-driven <underline>G</underline>ibbs <underline>S</underline>ampler to infer <underline>M</underline>odules (ChIP-GSM) using a Bayesian framework that integrates ChIP-seq profiles of multiple TFs. Using ChIP-seq read counts as input, for each genomic region ChIP-GSM estimates the binding potential of a TF module by jointly modeling ChIP-seq read counts of associated TFs in that module. Specifically, given a TF ChIP-seq profile, ChIP-GSM models its distribution of read counts as a mixture of Power-Law and Gamma distributions [<xref rid="pcbi.1009203.ref014" ref-type="bibr">14</xref>,<xref rid="pcbi.1009203.ref015" ref-type="bibr">15</xref>], at TF-bound and background regions, respectively. Using Gibbs sampling, which is designed to sample one parameter at a time to draw samples from a high dimensional probability distribution, ChIP-GSM iteratively evaluates TF-region binding potential, samples ChIP-seq read counts, and probabilistically draws TF module samples for each region. With many rounds of sampling, every candidate module will be sampled and evaluated for the binding occurrence at individual regions. ChIP-GSM will ultimately generate a region-specific sample distribution of all modules. A region can be bound by one or multiple modules as determined by the sample distribution. Across regions in the whole genome, the accumulated samples of each module represent its abundance in the current tissue or cell type.</p>
    <p>We compared ChIP-GSM against other approaches [<xref rid="pcbi.1009203.ref005" ref-type="bibr">5</xref>, <xref rid="pcbi.1009203.ref006" ref-type="bibr">6</xref>] that can infer regulatory modules at genome-wide locations using TF ChIP-seq profiles as the input. Using both simulated data and ENCODE ChIP-seq data, we successfully demonstrated that ChIP-GSM predicted a wide variety of modules more accurately, especially those with many weakly bound TFs, than the comparable methods. Further applying ChIP-GSM respectively to enhancers and promoters, we found significantly different associations of the same TFs between these two categories of regions, suggesting that one should infer modules using different models for enhancers and promoters.</p>
    <p>Existing data show that transcriptional activities of regulatory regions correlated with binding signals of epigenetic marks [<xref rid="pcbi.1009203.ref004" ref-type="bibr">4</xref>] and TFs [<xref rid="pcbi.1009203.ref016" ref-type="bibr">16</xref>]. Here we further demonstrated that ChIP-GSM-inferred TF modules better predict enhancer or promoter transcriptional activities. To achieve this, we trained a logistic regression classifier [<xref rid="pcbi.1009203.ref017" ref-type="bibr">17</xref>] by combining, in the same context, the learned weighted bindings of TF modules to regulatory regions with the FANTOM5 regulatory region activities (CAGE data) [<xref rid="pcbi.1009203.ref018" ref-type="bibr">18</xref>]. Using the trained classifier, we predicted systematically the activities of hold-out regions for each of nine select cell types. Results showed that ChIP-GSM (featuring TF modules) performed better than methods that use histone proteins, TFs, or both as feature units [<xref rid="pcbi.1009203.ref004" ref-type="bibr">4</xref>,<xref rid="pcbi.1009203.ref016" ref-type="bibr">16</xref>]. Moreover, the top-predicted active regions were significantly more enriched with enhancer or promoter marker signals than the annotated regions in the FANTOM5 database, revealing the refinement on context-specific active regulatory region identification using ChIP-GSM predictions.</p>
    <p>Finally, we conducted a case study analyzing the target genes regulated by ChIP-GSM-identified TF modules in K562 cells. We clustered TF modules into groups based on the similarity of TFs between modules and checked the target genes and their expression mediated by each module group. Time-course analysis using a K562 gene expression dataset [<xref rid="pcbi.1009203.ref019" ref-type="bibr">19</xref>] revealed that genes co-regulated by modules from the same group are significantly co-expressed and involved in similar cellular processes associated with leukemia development. Hence, ChIP-GSM infers biological meaningful TF modules that play important roles in modulating gene expression and mediating functional cellular processes.</p>
  </sec>
  <sec sec-type="results" id="sec002">
    <title>Results</title>
    <sec id="sec003">
      <title>ChIP-GSM framework</title>
      <p>Given ChIP-seq data and candidate genomic regions (regions enriched with ChIP-seq signals and/or with regulation annotations), ChIP-GSM infers TF modules for each region using a Gibbs Sampler and then uses an elastic-net classifier to predict regions transcriptional activities (<bold><xref rid="pcbi.1009203.g001" ref-type="fig">Fig 1</xref></bold>). To integrate ChIP-seq data of multiple TFs, we partition the candidate genomic regions into fixed-length bins (i.e., 500 bps long) and calculate the normalized ChIP-seq read count for each TF in each bin using HOMER [<xref rid="pcbi.1009203.ref020" ref-type="bibr">20</xref>]. ChIP-GSM focuses on regions that are likely to be regulated by a module with more than ten ChIP-seq reads observed from each of at least two TFs.</p>
      <fig position="float" id="pcbi.1009203.g001">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1009203.g001</object-id>
        <label>Fig 1</label>
        <caption>
          <title>A flowchart of ChIP-GSM for TF module inference.</title>
          <p>Given ChIP-seq data of multiple TFs and candidate genomic regions, ChIP-GSM learns a mixture model of Power-Law (for binding events) and Gamma (for non-binding events) distributions that best explains the read counts in TF-bound and background regions. ChIP-GSM’s Gibbs sampler iteratively samples TF modules for each region until convergence toward a posterior probability distribution of modules for all regions. Using logistic regression, ChIP-GSM correlates TF module binding likelihoods at individual regions with experimentally measured regulatory activities to systematically predict activities for each region with TF module regulation.</p>
        </caption>
        <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009203.g001" position="float"/>
      </fig>
      <p>A probabilistic Power Law-Gamma mixture model is fitted for each pair of TF and control ChIP-seq profiles to respectively model read count distributions of TF-bound and background regions. For each TF, a Power-Law model is fitted to regions with ChIP-seq read counts larger than ten and at least two-fold increase to the read counts in the matched input ChIP-seq profile, as only such regions are likely to be bound by the TF. Background regions that contain amplified open chromatin regions can also have high read counts in a TF ChIP-seq profile [<xref rid="pcbi.1009203.ref021" ref-type="bibr">21</xref>]. These regions will confound the correct identification of TF-bound regions, especially regions with weak binding events. Therefore, we include a background Gamma model to facilitate the differentiation of TF-bound regions from background regions. This Gamma model is fitted to read counts in the input ChIP-seq profile to learn the distribution features of background regions.</p>
      <p>Given multiple TFs ChIP-seq profiles, ChIP-GSM uses a Gibbs sampler to sample TFs iteratively as binding or non-binding according to the Power-Law/Gamma mixture model and estimate the binding potential of each module (a combination of TFs) at individual regions. Specifically, we develop a weight-based read tag tossing approach to identify binding events for multiple TFs simultaneously, where any ‘weak’ binding event with a relatively low read count can be well captured by assigning a weight much higher than that of a background region. These ‘weak’ bindings will help identify the complete association of TFs across regions and further highlight their cooperative action in a tissue or cell type. Once the Gibbs sampler appears to converge on the equilibrium distribution, ChIP-GSM accumulates samples that probabilistically define modules for each region. One region can be bound by one or multiple modules as determined by the modes of the sampling distribution. The accumulated samples of a module across all regions represent its abundance in the current regulatory context. Finally, ChIP-GSM correlates the predictive probabilities of modules with the experimentally measured activity at labeled regions using elastic-net logistic regression and systematically predicts activity of every region. A detailed workflow of ChIP-GSM is provided in <bold><xref rid="pcbi.1009203.s004" ref-type="supplementary-material">S1 Fig</xref></bold> and <bold><xref rid="pcbi.1009203.s001" ref-type="supplementary-material">S1 Text</xref></bold>.</p>
    </sec>
    <sec id="sec004">
      <title>ChIP-GSM accurately identifies TF modules across genome-wide locations</title>
      <p>To infer modules among a small number of TFs (e.g., 4), ChIP-GSM performed an exhaustive search of all possible TF combinations. For benchmarking we used ENCODE H1-hESC cell ChIP-seq data for four proteins: EZH2, SUZ12, H3K27me3, and H3K4me3. EZH2 and SUZ12 are Polycomb-group (PcG) proteins [<xref rid="pcbi.1009203.ref022" ref-type="bibr">22</xref>] and often co-bind to ‘bivalent’ domains marked by H3K27me3 and H3K4me3 [<xref rid="pcbi.1009203.ref023" ref-type="bibr">23</xref>,<xref rid="pcbi.1009203.ref024" ref-type="bibr">24</xref>]. Given strong associations between the four proteins, a high abundance (# of regions with a TF module / # of all regions) for a full module of all four factors was expected. We compared ChIP-GSM to two approaches: jMOSAiCs featuring a negative binomial model and SignalSpider featuring a Gaussian mixture model. Totally, ChIP-GSM identified 6,564 regions regulated by a module of all four proteins, with an abundance of 29%, while the other comparable methods like SignalSpider [<xref rid="pcbi.1009203.ref006" ref-type="bibr">6</xref>] and jMOSAiCs [<xref rid="pcbi.1009203.ref005" ref-type="bibr">5</xref>] identified fewer such regions, with the module abundance of 21.6% and 9.65%, respectively.</p>
      <p>To quantitively evaluate ChIP-GSM’s accuracy, we simulated genome-wide read counts for four proteins based on the real ChIP-seq data (with real TF combinations retained to individual regions) [<xref rid="pcbi.1009203.ref014" ref-type="bibr">14</xref>] and generated 10 replicates with random noise read counts added to individual regions. ChIP-GSM and comparable methods were applied to the simulated data under the default settings for each method. To fairly compare performances of competing methods, we evaluated for each model the accuracy on TF-region binding events identification. Then, binding events in incompletely identified modules were still counted as the competing methods might miss weak binding events. To account for both false positive and false negative rates, we calculated the F-measure (= 2/(1/precision+1/recall)), for binding events at all regions (<bold><xref rid="pcbi.1009203.g002" ref-type="fig">Fig 2A</xref>,</bold> Case 1) or at regions containing at least one ‘weak’ binding factor (<bold><xref rid="pcbi.1009203.g002" ref-type="fig">Fig 2B</xref>,</bold> Case 1). The F-measure of ChIP-GSM was 0.96 for all regions, higher than the best performance of the competing methods. Although ChIP-GSM performed an exhaustive search of all possible TF combinations for each region, due to the ChIP-seq signal noise and possibly imperfect separation of some weak bindings from background regions, the F-measure was not 1. For regions with weak binding events, ChIP-GSM maintained its accuracy around 0.9 while the competing methods dropped their performance to 0.8.</p>
      <fig position="float" id="pcbi.1009203.g002">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1009203.g002</object-id>
        <label>Fig 2</label>
        <caption>
          <title>ChIP-GSM and competing methods abilities to infer TF modules using realistically simulated ChIP-seq data.</title>
          <p>We simulate ChIP-seq read counts for 100,000 regions and examine the accuracy of module inference by applying each competing method to a low challenging case (Case 1, four TFs), a middle challenging case (Case 2, seven TFs) and a high challenging case (Case 3, eighteen TFs). (A) F-measure of each method on module inference across all regions; (B) F-measure of each method on regions with at least one weak binding event. ChIP-GSM performs better than the comparable methods, especially when there are many TFs with weak binding events.</p>
        </caption>
        <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009203.g002" position="float"/>
      </fig>
      <p>When the number of investigated TFs grows, the TF-TF cooperation becomes complex and computationally intractable for an exhaustive search over all possible TF combinations. Therefore, In large-scale applications, for example, inferring modules from more than 10 TFs, ChIP-GSM first performs a primary search of candidate modules based on the frequency of TF co-colocalizations across the whole genome and then efficiently identifies regions bound by each candidate module. To evaluate the performance of ChIP-GSM in such cases, we designed realistic simulations based on real ChIP-seq profiles. Our design had three advantages as: (1) each ChIP-seq profile was unique in binding/non-binding locations and read count distributions; (2) it had both strong and weak binding events (to simulate TFs with a range of binding strengths); (3) real associations among TFs were largely retained at the original locations (not using artificial combinatorial patterns and assignments to random locations). We simulated two scenarios: Case 2 with a medium number of seven TFs and Case 3 with a high number of eighteen TFs. As can be seen from <bold><xref rid="pcbi.1009203.g002" ref-type="fig">Fig 2</xref></bold> that in both cases, ChIP-GSM performed the best among all competing methods, especially for module inference at regions with weak bindings. The primary search of candidate modules would miss some rare TF combinations and their associated regions; thus, the performance of ChIP-GSM indeed degraded, but overall, it was comparable to the performance of exhaustive search. These results demonstrated that the Power-Law/Gamma mixture model proposed in ChIP-GSM worked better on identifying module-bound regions than the negative binomial model used in jMOSAiCs or the Gaussian mixture model used in SignalSpider.</p>
    </sec>
    <sec id="sec005">
      <title>ChIP-GSM infers TF modules specific to enhancers or promoters</title>
      <p>It has been known that epigenetic marks at enhancers differ from those at promoters [<xref rid="pcbi.1009203.ref025" ref-type="bibr">25</xref>,<xref rid="pcbi.1009203.ref026" ref-type="bibr">26</xref>], e.g., H3K27ac for enhancers and H3K4me3 for promoters. For these well-annotated regulatory regions, we further studied the difference of TF-associations at these two types of regions using ChIP-seq data from nine different cell types including breast cancer MCF-7 cells, leukemia K562 cells, and other major cell types that have a sufficient number of TF ChIP-seq profiles in the ENCODE database (<bold><xref rid="pcbi.1009203.s014" ref-type="supplementary-material">S1 Table</xref></bold>). For each cell type, ChIP-GSM integrated cell type-specific TF ChIP-seq data from the ENCODE data portal and inferred TF modules at enhancers and promoters, respectively. We found that the mean percentage of TF modules shared between enhancers and promoters across nine cell types was only 47% (<bold><xref rid="pcbi.1009203.s015" ref-type="supplementary-material">S2 Table</xref></bold>), revealing the big difference in the modulization of TFs at these two types of regions. Further analysis of module abundance showed that enhancer- or promoter-specific modules can be as strong as common modules (<xref rid="pcbi.1009203.g003" ref-type="fig"><bold>Fig 3B</bold> and <bold>3D</bold></xref>). Identified modules for each cell type are provided in <bold><xref rid="pcbi.1009203.s016" ref-type="supplementary-material">S3 Table</xref>.</bold></p>
      <fig position="float" id="pcbi.1009203.g003">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1009203.g003</object-id>
        <label>Fig 3</label>
        <caption>
          <title>ChIP-GSM-inferred TF modules for enhancer and promoter regions respectively.</title>
          <p>The number of modules functioning at enhancer or promoter regions in (A) MCF-7 cells or (B) K562 cells. Module abundance reveals that region-specific modules can be as strong as common modules functioning in both enhancer and promoter regions, in (C) MCF-7 cells or in (D) K562 cells.</p>
        </caption>
        <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009203.g003" position="float"/>
      </fig>
      <p>For breast cancer MCF-7 cells, ChIP-GSM identified 52 enhancer-modules and 66 promoter-modules, with a similarity of 54% (<bold>Figs <xref rid="pcbi.1009203.g003" ref-type="fig">3A</xref></bold> and <bold><xref rid="pcbi.1009203.s005" ref-type="supplementary-material">S2</xref></bold> and <bold><xref rid="pcbi.1009203.s016" ref-type="supplementary-material">S3 Table</xref></bold>). The top two enhancer-modules were ERalpha-EP300 and POL2A-TAF1 (listed in <bold><xref rid="pcbi.1009203.g003" ref-type="fig">Fig 3A</xref></bold>). Both associations were well supported by their known functions as: EP300 was a signature protein of enhancers; ER-alpha was a major enhancer activator in MCF-7 cells [<xref rid="pcbi.1009203.ref027" ref-type="bibr">27</xref>]; TAF1- POLR2A was also an enhancer signature [<xref rid="pcbi.1009203.ref028" ref-type="bibr">28</xref>]. The top promoter-module was E2F1-MAX-MYC-POLR2A. The association of MYC, MAX, and POLR2A was frequently found at both enhancers and promoters in MCF-7 cells [<xref rid="pcbi.1009203.ref029" ref-type="bibr">29</xref>], but E2F1 bound more often to promoters [<xref rid="pcbi.1009203.ref030" ref-type="bibr">30</xref>]. Consistent with this finding, ChIP-GSM identified a promoter-module containing the promoter-specific factor E2F1 and a common submodule MAX-MYC-POLR2A between enhancers and promoters.</p>
      <p>For K562 cells, ChIP-GSM identified 81 enhancer-modules and 67 promoter-modules, with a similarity of 55% (<bold>Figs <xref rid="pcbi.1009203.g003" ref-type="fig">3C</xref></bold> and <bold><xref rid="pcbi.1009203.s005" ref-type="supplementary-material">S2</xref></bold> and <bold><xref rid="pcbi.1009203.s016" ref-type="supplementary-material">S3 Table</xref></bold>). A strong association was highlighted among CEBPD, GATA2, TAL1, and TEAD4 at enhancers. TAL1, TEAD4, and CEBPD were all master transcription factors with binding signals enriched at super-enhancers [<xref rid="pcbi.1009203.ref002" ref-type="bibr">2</xref>], GATA2 was prevalent at dynamic enhancers [<xref rid="pcbi.1009203.ref031" ref-type="bibr">31</xref>], and a similar module was previously found at K562 enhancer regions in an independent study [<xref rid="pcbi.1009203.ref032" ref-type="bibr">32</xref>]. At promoter regions, the top-predicted module was E2F6-PHF8-ZFX. E2F6 binding sites were demonstrated to be proximal to TSSs [<xref rid="pcbi.1009203.ref033" ref-type="bibr">33</xref>] and PHF8 usually bound to H3K4me3-enriched regions, also close to TSSs [<xref rid="pcbi.1009203.ref034" ref-type="bibr">34</xref>]. ZFX was reported to be binding at CpG island promoters in many tumor cell types [<xref rid="pcbi.1009203.ref035" ref-type="bibr">35</xref>].</p>
    </sec>
    <sec id="sec006">
      <title>ChIP-GSM improves the prediction of regulatory region activity</title>
      <p>Regulatory regions usually harbor histone mark enrichments and are primarily activated by a molecular complex of TFs. ChIP-GSM, which models TF modulization at regulatory regions, could further improve the prediction performance on active regulatory regions than methods using individual histone marks or TFs as feature units. To explore these, we used FANTOM5 CAGE data [<xref rid="pcbi.1009203.ref018" ref-type="bibr">18</xref>] as experimental measures of the annotated enhancers activities and studied the prediction performance of ChIP-GSM results on these regions in a supervised framework. Specifically, for each cell type, an enhancer region was labeled as ‘positive’ if its eRNA TPM value was larger than 1 in at least two FANTOM5 CAGE samples of the current cell type; labeled as ‘negative’ if it was inactive in the current cell type but active in others. Similar labeling was done for promoter regions based on the genes mRNA expression.</p>
      <p>For each cell type, we trained an elastic net logistic regression classifier by combining ChIP-GSM TF module probabilistic estimations with 80% labeled active/inactive regulatory regions. Features were ChIP-GSM inferred probabilities of all TF modules binding to individual regions. Here, ChIP-GSM parameters like PowerLaw-Gamma distribution parameters and thye candidate TF combinations were fitted only using data from training regions (<bold><xref rid="pcbi.1009203.s017" ref-type="supplementary-material">S4 Table</xref></bold>). Feature values (module probabilities) between training and testing regions were independent as the modules were sampled and evaluated individually and independently at different regions (<bold>Methods</bold>). For performance comparison, we included three supervised approaches: EMERGE [<xref rid="pcbi.1009203.ref016" ref-type="bibr">16</xref>], an elastic net model using as input all cell type relevant histone marks and TF ChIP-seq profiles; MatchedFilter [<xref rid="pcbi.1009203.ref025" ref-type="bibr">25</xref>], a linear SVM model with matched-filter scores of discriminative epigenetic marks H3K27ac, H3K4me1, H3K4me2, H3K4me3, H3K9ac and DHS; and a Baseline model using as input features of TF binding profiles (i.e., peaks from ENCODE).</p>
      <p>We applied the above methods to nine cell types and for each cell type compared their prediction accuracy (F-measure) on the 20% hold-out regions. ChIP-GSM indeed performed better at predicting active regulatory elements than did methods that used histone marks, transcription factors, or both as feature units (<bold><xref rid="pcbi.1009203.g004" ref-type="fig">Fig 4</xref></bold> and <bold><xref rid="pcbi.1009203.s018" ref-type="supplementary-material">S5 Table</xref></bold>). For each cell type, the baseline model using TF binding signals performed similarly to MatchedFilter, a method featuring epigenetic marks, though requiring considerably fewer input files. EMERGE combined TF and HM binding signals and got a higher prediction accuracy but it still performed worse than ChIP-GSM. In the more challenging test where only 50% of regions were used during the module learning and classifier training process, ChIP-GSM still had a higher prediction accuracy than EMERGE (<bold><xref rid="pcbi.1009203.s005" ref-type="supplementary-material">S2 Fig</xref></bold>).</p>
      <fig position="float" id="pcbi.1009203.g004">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1009203.g004</object-id>
        <label>Fig 4</label>
        <caption>
          <title>Improved ChIP-GSM prediction of cell type-specific active enhancers and promoters.</title>
          <p>(A) and (C) show the F-measure of ChIP-GSM on the 20% hold-out labelled enhancers or promoters. (B) and (D) show boxplots of F-measures of ChIP-GSM and three comparable methods across all cell types.</p>
        </caption>
        <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009203.g004" position="float"/>
      </fig>
      <p>We trained a classifier using all labeled regions and reprioritized all regions based on the ChIP-GSM predicted activities. We validated the top predictions by assessing the enrichment of enhancer markers H3K4me1 and H3K27ac or promoter marker H3K4me3 [<xref rid="pcbi.1009203.ref026" ref-type="bibr">26</xref>]. ChIP-seq peaks for each marker were downloaded from the ENCODE database. Taking MCF-7 and K562 cell types for examples, compared to the active enhancers reported in the FANTOM5 database, the top 10% of the ChIP-GSM-predicted enhancers were significantly more enriched with ChIP-seq peaks of H3K4me1 (+), H3K27ac (+) and H3K4me3 (-) (<bold><xref rid="pcbi.1009203.g005" ref-type="fig">Fig 5A</xref></bold>, <italic toggle="yes">p</italic>-values = 2.76e-5 for K562 and 3.83e-3 for MCF-7; <bold>Methods</bold>). The top 10% ChIP-GSM-predicted promoters were also significantly more enriched in peaks with H3K4me1 (-), H3K27ac (-) and H3K4me3 (+) than did FANTOM5 active promoter regions (<bold><xref rid="pcbi.1009203.g005" ref-type="fig">Fig 5D</xref></bold>, <italic toggle="yes">p</italic>-values = 9.23e-5 for K562 and 4.7e-3 for MCF-7). These results suggested that active regulatory regions can be further refined by combining their activity measurements with TF modules binding there.</p>
      <fig position="float" id="pcbi.1009203.g005">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1009203.g005</object-id>
        <label>Fig 5</label>
        <caption>
          <title>ChIP-GSM-predicted active regions are significantly enriched with epigenetic markers and significantly correlated with 3D chromatin interactions.</title>
          <p>(A) The top 10% predicted enhancers are significantly enriched with marker ChIP-seq peaks of H3K4me1 and H3K27ac but not H3K4me3. (B) and (C) The ChIP-GSM-predicted enhancer activities are significantly correlated with ChIA-PET 3D chromatin interactions in MCF7 and K562 cells, respectively. (D) The top 10% of predicted enhancers are significantly enriched with marker peaks of H3K4me3 but not H3K4me1 or H3K27ac. (E) and (F) The ChIP-GSM-predicted promoter activities are significantly correlated with ChIA-PET 3D chromatin interactions in MCF7 and K562 cells, respectively.</p>
        </caption>
        <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009203.g005" position="float"/>
      </fig>
      <p>Furthermore, it has been reported that the activities of enhancers or promoters are highly associated with nearby 3D chromatin interactions [<xref rid="pcbi.1009203.ref036" ref-type="bibr">36</xref>,<xref rid="pcbi.1009203.ref037" ref-type="bibr">37</xref>]. Consistent with this notion, for cell types MCF7 and K562 we examined the correlation of ChIP-GSM-predicted activities and the number of nearby ChIA-PET interactions. Shown in <bold><xref rid="pcbi.1009203.g005" ref-type="fig">Fig 5</xref></bold> are smoothed scatter plots represented as matrices, where each cell is colored proportional to the number of data points where the x- and y-axes correspond to the ChIP-GSM predicted activity and the number of ChIA-PET loops, respectively. For the MCF-7 cell type, the ChIP-GSM-predicted activity was significantly correlated with the number of ChIA-PET interactions (<xref rid="pcbi.1009203.g005" ref-type="fig"><bold>Fig 5B</bold> and <bold>5E</bold></xref>, <italic toggle="yes">p</italic>-values = 3.2e-26 for enhancers and 8.4e-8 for promoters). Similarly, significant results were found for the K562 cell type, too (<xref rid="pcbi.1009203.g005" ref-type="fig"><bold>Fig 5C</bold> and <bold>5F</bold></xref>, <italic toggle="yes">p</italic>-values = 1.1e-23 for enhancers and 9.7e-16 for promoters). Raw scatter plots were provided in <bold><xref rid="pcbi.1009203.s006" ref-type="supplementary-material">S3 Fig</xref></bold>, from which we can also see that regions with higher scores predicated by ChIP-GSM were actively interacting with more nearby regions through the 3D genome folding.</p>
    </sec>
    <sec id="sec007">
      <title>ChIP-GSM inferred modules mediate diverse cellular functions in K562 cells</title>
      <p>Finally, we studied target genes of ChIP-GSM-inferred modules and further, cellular functions that they regulated. Here, we selected K562 promoter-modules (as listed in <bold><xref rid="pcbi.1009203.s007" ref-type="supplementary-material">S4 Fig</xref></bold>) for further analysis because: (1) these modules were most highly predicted to be activating promoters (<bold><xref rid="pcbi.1009203.g004" ref-type="fig">Fig 4C</xref></bold>; F-measure = 0.89); and (2) ChIP-GSM identified more high-resolution, biologically important modules (<bold><xref rid="pcbi.1009203.s007" ref-type="supplementary-material">S4 Fig</xref></bold>) than other methods for inferring modules from a large number of TFs (<bold><xref rid="pcbi.1009203.s008" ref-type="supplementary-material">S5</xref>–<xref rid="pcbi.1009203.s010" ref-type="supplementary-material">S7</xref> Figs</bold>). In total, these modules were clustered into eight non-overlapping groups based on the TFs they shared in common (<bold><xref rid="pcbi.1009203.g006" ref-type="fig">Fig 6A</xref></bold>). Gene expression and functional analysis of these TFs showed that TFs in each module group are highly co-expressed [<xref rid="pcbi.1009203.ref019" ref-type="bibr">19</xref>] (GEO access number: GSE1036) and shared coherent functions (<bold>Figs <xref rid="pcbi.1009203.g006" ref-type="fig">6B</xref></bold> and <bold><xref rid="pcbi.1009203.s011" ref-type="supplementary-material">S8</xref></bold> and <bold><xref rid="pcbi.1009203.s002" ref-type="supplementary-material">S2 Text</xref></bold>), thereby supporting the notion that cooperative TFs were typically activated simultaneously [<xref rid="pcbi.1009203.ref038" ref-type="bibr">38</xref>, <xref rid="pcbi.1009203.ref039" ref-type="bibr">39</xref>].</p>
      <fig position="float" id="pcbi.1009203.g006">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1009203.g006</object-id>
        <label>Fig 6</label>
        <caption>
          <title>ChIP-GSM-identified TF modules at the gene promoter regions of K562 cells.</title>
          <p>(A) Eight groups of modules identified by ChIP-GSM functioning at gene promoter regions in leukemia K562 cells (TF modules are defined in <bold><xref rid="pcbi.1009203.s007" ref-type="supplementary-material">S4 Fig</xref></bold>); (B) mRNA co-expression of pairwise TFs in each group; (C) selected modules whose target genes are significantly enriched (hypergeometric p-value &lt; 0.001) in activated genes as shown in (D). Each color label or box represents a unique module group.</p>
        </caption>
        <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009203.g006" position="float"/>
      </fig>
      <p>Gene set functional enrichment analysis (using DAVID [<xref rid="pcbi.1009203.ref040" ref-type="bibr">40</xref>]) showed that these module groups regulate diverse cellular functions associated with leukemia development. And each group tend to mediate cellular functions different from those of other groups (<bold><xref rid="pcbi.1009203.s012" ref-type="supplementary-material">S9 Fig</xref></bold> and <bold><xref rid="pcbi.1009203.s019" ref-type="supplementary-material">S6 Table</xref></bold>). For example, Group 1 TFs regulated genes significantly associated with acute myeloid leukemia; Group 4 TFs regulated genes that were involved in cancer development, including chronic myeloid leukemia; Group 5 TFs regulated genes significantly associated with cell survival-related functions including cell death, apoptosis, and p53 signaling. These results suggested that TFs in one group likely regulated specific cellular processes than did TFs in the other groups.</p>
      <p>To examine if the identified TF module groups were active at different cell stages, we checked the target gene expression (<bold><xref rid="pcbi.1009203.g006" ref-type="fig">Fig 6D</xref></bold>). Totally we collected 1,569 genes that are actively expressed in K562 cells [<xref rid="pcbi.1009203.ref019" ref-type="bibr">19</xref>]. Based on their time course expression pattern, we clustered genes into eight clusters (Clusters 1–8) and for each cluster, we assessed its enrichment of target genes regulated by each module. Significant gene cluster-TF module pairs (adjusted hypergeometric <italic toggle="yes">p</italic>-value &lt; 0.001) are shown in <bold><xref rid="pcbi.1009203.g006" ref-type="fig">Fig 6C</xref></bold> (boxed in colors that match the colors of the module groups in <bold><xref rid="pcbi.1009203.g006" ref-type="fig">Fig 6A</xref></bold>; gene symbols are listed in <bold><xref rid="pcbi.1009203.s020" ref-type="supplementary-material">S7 Table</xref></bold>). We found that modules from different groups rarely functioned at the same time. For instance, one module from Group 3 (labeled by the ‘cyan’ box) was highly enriched in Cluster 1. Modules (labeled by the ‘purple’ box) from Group 5 and their target genes were significantly enriched in Cluster 3. Modules from Group 4 (labeled by the ‘yellow’ box) did not share many genes, but both were enriched in Cluster 8. These observations suggested that our identified module groups regulated genes at different cell stages of K562 cells and mediated specific cellular functions associated with leukemia development.</p>
    </sec>
  </sec>
  <sec sec-type="conclusions" id="sec008">
    <title>Discussion</title>
    <p>Inferring modules among many TFs is challenging because TF binding signals are diverse, noisy, and sensitive to the cellular environment. A benefit of this analysis, however, is that it helps explain regulatory region activation and target gene expression. ChIP-GSM probabilistically predicts TF modules and active regulatory elements based on ChIP-seq read counts; consequently, it can help characterize modules that are associated with regions containing weak, potentially cell-type-specific binding signals (which can be easily missed by peak callers). Moreover, we demonstrate that TF modules are better than TF peaks or histone modifications at predicting active regulatory elements. As a general computational framework, ChIP-GSM can infer modules from genome-wide locations with ChIP-seq read coverage of at least two TFs, not limited to annotated regulatory regions, although applications to known regions would allow better results interpretation and validation.</p>
    <p>Using the cell type K562 as a case study, we demonstrate the functional diversity of ChIP-GSM inferred modules: target genes of different modules are actively expressing at different time points and regulating distinct cellular processes. We anticipate that TF modules at enhancer regions have similar functional diversity. Currently, however, the sparsity of high-resolution chromosome interaction data, such as ChIA-PET, obscures the association between enhancers and genes, especially for enhancers that are distantly located from the genes they regulate.</p>
    <p>Because most ChIP-seq profiles are generated using cell line models, we mainly applied ChIP-GSM to cell line ChIP-seq data. ChIP-GSM can also be applied to ChIP-seq data from human tissues, for which the binding signals are much noisier and exhibit more variable binding strengths than <italic toggle="yes">in vitro</italic> cell lines, which may limit ChIP-GSM’s accuracy. Major host databases, like ENCODE, are periodically updated by replacing low-quality samples with new, high-quality replicates. The ChIP-GSM code is publicly accessible (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://sourceforge.net/projects/chipgsm/" ext-link-type="uri">https://sourceforge.net/projects/chipgsm/</ext-link>) so that users can apply it to the newest release of ENCODE or newly published high-quality ChIP-seq data. Hence, ChIP-GSM has the potential to uncover more detailed TF associations overlooked by conventional methods, thereby leading to new biological insights relevant to human disease.</p>
  </sec>
  <sec sec-type="materials|methods" id="sec009">
    <title>Methods</title>
    <sec id="sec010">
      <title>ChIP-GSM: TF module inference</title>
      <sec id="sec011">
        <title>Candidate TF module searching</title>
        <p>The computational complexity of TF module inference (studying associations between TFs) increases exponentially with the number of TFs (<italic toggle="yes">T</italic>): for a large set of TFs, exploring exhaustively all possible combinations is intractable (e.g., for <italic toggle="yes">T</italic> = 50 there will be 2<sup>50</sup> combinations). Consequently, ChIP-GSM first identifies a list of candidate modules based on the number of TFs and their ChIP-seq read counts across all regions. In detail, if the number of TFs is no larger than 6, ChIP-GSM will perform an exhaustive search using all TF combinations as candidate modules. This is suitable in small-scale studies with selected ChIP-seq data of closely related TFs (see the study of Polycomb-group proteins in H1-hESC cells and simulation). If the number of TF is larger than 7, ChIP-GSM will primarily search for a candidate list of TF modules. Specifically, for each TF ChIP-GSM roughly identifies its binding sites as regions with a read count larger than 10 and a fold change to the input read count larger than 2. Then it selects the top 100 TF combinations that regulate the most regions as candidate modules. This is suitable in large-scale studies (see the study of MCF-7 and K562 cell types). The candidate modules are stored in matrix <bold>B,</bold> with <italic toggle="yes">M</italic> rows (the total number of candidate modules) and <italic toggle="yes">T</italic> columns (the total number of TFs), where each row is a binary vector [<italic toggle="yes">b</italic>(<italic toggle="yes">m</italic>, 1), <italic toggle="yes">b</italic>(<italic toggle="yes">m</italic>, 2),…,<italic toggle="yes">b</italic>(<italic toggle="yes">m</italic>, <italic toggle="yes">t</italic>),…,<italic toggle="yes">b</italic>(<italic toggle="yes">m</italic>, <italic toggle="yes">T</italic>)] representing a candidate TF combination. To model background regions that are not regulated by any module, we add an all-zero row (<italic toggle="yes">m</italic> = 0) to <bold>B</bold>.</p>
      </sec>
      <sec id="sec012">
        <title>Read count modeling</title>
        <p>Given a total of <italic toggle="yes">K</italic> regions, for each region <italic toggle="yes">k</italic> we define a module index variable <italic toggle="yes">c</italic><sub><italic toggle="yes">k</italic></sub>, with <italic toggle="yes">c</italic><sub><italic toggle="yes">k</italic></sub>∈[1…<italic toggle="yes">m</italic>…<italic toggle="yes">M</italic>] if this region is regulated by a candidate module or <italic toggle="yes">c</italic><sub><italic toggle="yes">k</italic></sub> = 0 otherwise. Further, if <italic toggle="yes">b</italic>(<italic toggle="yes">c</italic><sub><italic toggle="yes">k</italic></sub>,<italic toggle="yes">t</italic>) = 1, the region <italic toggle="yes">k</italic> is a binding region of TF <italic toggle="yes">t</italic>; if <italic toggle="yes">b</italic>(<italic toggle="yes">c</italic><sub><italic toggle="yes">k</italic></sub>,<italic toggle="yes">t</italic>) = 0, the region <italic toggle="yes">k</italic> is a background region. The observed read count <italic toggle="yes">Y</italic><sub><italic toggle="yes">k</italic>,<italic toggle="yes">t</italic></sub> is fitted to a mixture model as follows:
<disp-formula id="pcbi.1009203.e001"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009203.e001.jpg" id="pcbi.1009203.e001g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M1" display="block" overflow="scroll"><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>b</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>b</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:math></alternatives><label>(1)</label></disp-formula>
<disp-formula id="pcbi.1009203.e002"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009203.e002.jpg" id="pcbi.1009203.e002g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M2" display="block" overflow="scroll"><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mi mathvariant="normal">PowerLaw</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>,</mml:mo></mml:math></alternatives><label>(2)</label></disp-formula>
<disp-formula id="pcbi.1009203.e003"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009203.e003.jpg" id="pcbi.1009203.e003g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M3" display="block" overflow="scroll"><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mi mathvariant="normal">Gamma</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>,</mml:mo></mml:math></alternatives><label>(3)</label></disp-formula>
<disp-formula id="pcbi.1009203.e004"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009203.e004.jpg" id="pcbi.1009203.e004g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M4" display="block" overflow="scroll"><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mi mathvariant="normal">Gaussian</mml:mi><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>)</mml:mo><mml:mo>,</mml:mo></mml:math></alternatives><label>(4)</label></disp-formula>
<disp-formula id="pcbi.1009203.e005"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009203.e005.jpg" id="pcbi.1009203.e005g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M5" display="block" overflow="scroll"><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mi mathvariant="normal">Uniform</mml:mi><mml:mo>[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>M</mml:mi><mml:mo>]</mml:mo><mml:mo>,</mml:mo></mml:math></alternatives><label>(5)</label></disp-formula>
where <italic toggle="yes">X</italic><sub><italic toggle="yes">k</italic>,<italic toggle="yes">t</italic></sub> represents the read count of a TF-bound region and follows a Power-Law distribution with hyper-parameters <italic toggle="yes">X</italic><sub><italic toggle="yes">min</italic></sub> and <italic toggle="yes">γ</italic><sub><italic toggle="yes">t</italic></sub>; <italic toggle="yes">I</italic><sub><italic toggle="yes">k</italic>,<italic toggle="yes">t</italic></sub> represents the read count for a background region and follows a Gamma distribution with mean and shape parameters <italic toggle="yes">α</italic><sub><italic toggle="yes">t</italic></sub> and <italic toggle="yes">β</italic><sub><italic toggle="yes">t</italic></sub>; <italic toggle="yes">N</italic><sub><italic toggle="yes">k</italic>,<italic toggle="yes">t</italic></sub>, represents the residual between the observed read count and the distribution-fitted read count. A residual at each individual region can be either positive or negative. We assume a zero-mean Gaussian distribution on it to ensure that the mean of probabilistically sampled read counts (<italic toggle="yes">X</italic><sub><italic toggle="yes">k</italic>,<italic toggle="yes">t</italic></sub> or <italic toggle="yes">I</italic><sub><italic toggle="yes">k</italic>,<italic toggle="yes">t</italic></sub>) across all regions is the same as the mean of observed ChIP-seq read counts (<italic toggle="yes">Y</italic><sub><italic toggle="yes">k</italic>,<italic toggle="yes">t</italic></sub>). To control the scale of residuals of all regions, we use a prior Inverse-Gamma distribution on the variance variable <inline-formula id="pcbi.1009203.e006"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009203.e006.jpg" id="pcbi.1009203.e006g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M6" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula>. Inverse-Gamma distribution has been widely used to model the posterior distribution for the unknown variance of a normal distribution. Its probability density distribution has a thin tail so that the possibility for <inline-formula id="pcbi.1009203.e007"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009203.e007.jpg" id="pcbi.1009203.e007g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M7" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> to be large is very low. That will ensure that in most cases, the fitted model aligns tightly to the input data.</p>
        <p>The mixture model is then applied to each TF ChIP-seq profile for TF-bound/background determination at each genomic location. With <italic toggle="yes">X</italic><sub><italic toggle="yes">min</italic></sub> = 10 as a hard cut-off, any regions with read counts less than 10 will not be evaluated for binding occurrence. Under this setting, as shown in <bold><xref rid="pcbi.1009203.s013" ref-type="supplementary-material">S10 Fig</xref></bold>, the Power-Law distribution fits well the real ChIP-seq count data at TF-bound regions. Background regions with high read counts will likely confound the identification of true but weak binding events. Therefore, for background regions, we turn the Gamma distribution parameters to better fit the high read count regions from the input ChIP-seq profile, with the underestimation mostly on regions with read counts less than 10 (<bold><xref rid="pcbi.1009203.s013" ref-type="supplementary-material">S10 Fig</xref></bold>), because these regions are always treated as background regions (with probability = 1), independent from their fitted probabilities. Learned ChIP-GSM model parameters for cell-type-specific ChIP-seq signals at promoters or enhancers are provided in <bold><xref rid="pcbi.1009203.s017" ref-type="supplementary-material">S4 Table</xref></bold>. Variable <italic toggle="yes">N</italic> is used to control the residue between the fitted model and the observed data. We control its variance using an inverse Gamma distribution during the sampling process to ensure that the estimated read counts by our model overall fit the observed raw values tightly. Using simulation studies we demonstrate that this Power-Law/Gamma mixture model works better on identifying TF-bound regions than the negative binomial mixture model [<xref rid="pcbi.1009203.ref005" ref-type="bibr">5</xref>] or the Gaussian mixture model [<xref rid="pcbi.1009203.ref006" ref-type="bibr">6</xref>] (<bold><xref rid="pcbi.1009203.g002" ref-type="fig">Fig 2</xref></bold>).</p>
        <p>For TF-bound regions at gene promoters, previous studies reveal that there is an exponential decay effect on read enrichment along with the increase of relative distance to the nearest transcription starting site (TSS) [<xref rid="pcbi.1009203.ref010" ref-type="bibr">10</xref>,<xref rid="pcbi.1009203.ref041" ref-type="bibr">41</xref>]. For background regions, the distribution of read enrichment is usually uniform. At enhancers, because both TF-bound and background regions are distal to TSSs, the regulatory effects are independent of their binding locations (due to the loop structure between enhancers and target genes). To better identify TF-bound regions near the TSS, we model the effects of a regulatory region on target gene using the distance-based mixture model:
<disp-formula id="pcbi.1009203.e008"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009203.e008.jpg" id="pcbi.1009203.e008g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M8" display="block" overflow="scroll"><mml:mrow><mml:mo>{</mml:mo><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mrow><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:mi>b</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo><mml:mo>∼</mml:mo><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">x</mml:mi><mml:mi mathvariant="normal">p</mml:mi><mml:mo>(</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:mi>b</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mo>)</mml:mo><mml:mo>∼</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>d</mml:mi><mml:mo>/</mml:mo><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable><mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives><label>(6)</label></disp-formula>
where <italic toggle="yes">d</italic><sub><italic toggle="yes">k</italic></sub> represents the relative distance of region <italic toggle="yes">k</italic> to the nearest TSS; <italic toggle="yes">λ</italic><sub><italic toggle="yes">t</italic></sub> is the exponential decaying parameter; Δ<italic toggle="yes">d</italic> represents the region length (500 bps); <italic toggle="yes">d</italic><sub><italic toggle="yes">p</italic></sub> represents the length of the promoter around the TSS (20k bps: +/- 10k bps around TSS). Here, parameter <italic toggle="yes">λ</italic><sub><italic toggle="yes">t</italic></sub> is TF-specific and estimated from the relative distance distribution of TF <italic toggle="yes">t</italic> binding regions.</p>
        <p>For all <italic toggle="yes">K</italic> regions, given the observed ChIP-seq read counts (<bold>Y</bold>), candidate modules (<bold>B</bold>), and the relative binding locations to TSS (<bold>D</bold>), we jointly and iteratively estimate module indexes <bold>C</bold> for all regions based on the conditional probability:
<disp-formula id="pcbi.1009203.e009"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009203.e009.jpg" id="pcbi.1009203.e009g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M9" display="block" overflow="scroll"><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="bold">C</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">X</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">I</mml:mi></mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:mi mathvariant="bold">Y</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">B</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">D</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>∝</mml:mo><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="bold">Y</mml:mi></mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:mi mathvariant="bold">C</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">X</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">I</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">B</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">D</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:math></alternatives><label>(7)</label></disp-formula></p>
        <p>Variables of <bold>X</bold> (read counts of TF-bound regions) and <bold>I</bold> (read counts of background regions) are both dependent on <bold>C</bold>, because the binding status of each TF at each region is determined by the binary binding variable in <bold>B</bold> indexed by <bold>C</bold>. Iterative Gibbs sampling of module variables after reaching equilibrium approximates the following posterior probability distributions:
<disp-formula id="pcbi.1009203.e010"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009203.e010.jpg" id="pcbi.1009203.e010g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M10" display="block" overflow="scroll"><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="bold">X</mml:mi></mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:mi mathvariant="bold">Y</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">C</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">B</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">D</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>,</mml:mo></mml:math></alternatives><label>(8)</label></disp-formula>
<disp-formula id="pcbi.1009203.e011"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009203.e011.jpg" id="pcbi.1009203.e011g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M11" display="block" overflow="scroll"><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="bold">I</mml:mi></mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:mi mathvariant="bold">Y</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">C</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">B</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">D</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>,</mml:mo></mml:math></alternatives><label>(9)</label></disp-formula>
<disp-formula id="pcbi.1009203.e012"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009203.e012.jpg" id="pcbi.1009203.e012g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M12" display="block" overflow="scroll"><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="bold">C</mml:mi></mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:mi mathvariant="bold">Y</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">X</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">I</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">B</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">D</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>.</mml:mo></mml:math></alternatives><label>(10)</label></disp-formula></p>
      </sec>
      <sec id="sec013">
        <title>Gibbs sampler initialization</title>
        <p>To initialize the sampler, ChIP-GSM first calculates <italic toggle="yes">T</italic> weights for each region, corresponding to the binding likelihoods of <italic toggle="yes">T</italic> TFs, where each weight is estimated based on the TF read count <italic toggle="yes">X</italic><sub><italic toggle="yes">k</italic>,<italic toggle="yes">t</italic></sub> (or <italic toggle="yes">I</italic><sub><italic toggle="yes">k</italic>,<italic toggle="yes">t</italic></sub>) given the binding or non-binding status of the region <italic toggle="yes">k</italic>. <italic toggle="yes">R</italic><sub><italic toggle="yes">t</italic></sub> denotes the total number of reads for the TF <italic toggle="yes">t</italic> across all <italic toggle="yes">K</italic> regions from its ChIP-seq profile. To calculate the initial weight of each region, ChIP-GSM first roughly estimates the number of reads to be respectively assigned to TF-bound and background regions by simulating the ChIP-seq sequencing process [<xref rid="pcbi.1009203.ref014" ref-type="bibr">14</xref>]. In detail, we assume that all regions are background and calculate an initial weight <italic toggle="yes">p</italic><sub><italic toggle="yes">k</italic>,<italic toggle="yes">t</italic></sub> according to the observed read count of the TF <italic toggle="yes">t</italic> at the region <italic toggle="yes">k</italic>. We then select regions with a read count (<italic toggle="yes">Y</italic><sub><italic toggle="yes">k</italic>,<italic toggle="yes">t</italic></sub>) larger than 50 as TF-bound regions and amplify their weight by <italic toggle="yes">F</italic> times (denoting the fold change of a TF-bound region to a background region). The total number of reads aligned to all TF-bound regions is estimated as:
<disp-formula id="pcbi.1009203.e013"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009203.e013.jpg" id="pcbi.1009203.e013g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M13" display="block" overflow="scroll"><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:msub><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mi>b</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mi>F</mml:mi><mml:mrow><mml:msub><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mi>b</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:msub><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>b</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:math></alternatives><label>(11)</label></disp-formula></p>
        <p>We assign <italic toggle="yes">R</italic><sub><italic toggle="yes">X</italic>,<italic toggle="yes">t</italic></sub> reads one by one to each of its target regions according to their amplified weights and get an initial read count <italic toggle="yes">X</italic><sub><italic toggle="yes">k</italic>,<italic toggle="yes">t</italic></sub> for each. Similarly, we assign the remaining reads (<italic toggle="yes">R</italic><sub><italic toggle="yes">t</italic></sub>−<italic toggle="yes">R</italic><sub><italic toggle="yes">X</italic>,<italic toggle="yes">t</italic></sub>) to each of the other background regions according to the initial weights and get a read count <italic toggle="yes">I</italic><sub><italic toggle="yes">k</italic>,<italic toggle="yes">t</italic></sub> for the region <italic toggle="yes">k</italic>. In general, <italic toggle="yes">X</italic><sub><italic toggle="yes">k</italic>,<italic toggle="yes">t</italic></sub> or <italic toggle="yes">I</italic><sub><italic toggle="yes">k</italic>,<italic toggle="yes">t</italic></sub> may differ from the observed ChIP-seq read count <italic toggle="yes">Y</italic><sub><italic toggle="yes">k</italic>,<italic toggle="yes">t</italic></sub>. We aim to minimize this difference across all regions and all TFs by iteratively estimating the TF module variables.</p>
      </sec>
      <sec id="sec014">
        <title>Sampling ChIP-seq read counts</title>
        <p>To sample the read count for each region, ChIP-GSM updates the weight for each region, assigns reads to them probabilistically and estimates a new read count for each TF. Specifically, for the region <italic toggle="yes">k</italic>, given the observed read count <italic toggle="yes">Y</italic><sub><italic toggle="yes">k</italic>,<italic toggle="yes">t</italic></sub>, the binding state <italic toggle="yes">b</italic>(<italic toggle="yes">c</italic><sub><italic toggle="yes">k</italic></sub>, <italic toggle="yes">t</italic>), and the estimated read count <italic toggle="yes">X</italic><sub><italic toggle="yes">k</italic>,<italic toggle="yes">t</italic></sub> or <italic toggle="yes">I</italic><sub><italic toggle="yes">k</italic>,<italic toggle="yes">t</italic></sub>, ChIP-GSM calculates a conditional probability as that region’s updated weight:
<disp-formula id="pcbi.1009203.e014"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009203.e014.jpg" id="pcbi.1009203.e014g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M14" display="block" overflow="scroll"><mml:mrow><mml:mo>{</mml:mo><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="bold">B</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>∝</mml:mo><mml:msub><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>b</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mrow><mml:mi>b</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="bold">B</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>∝</mml:mo><mml:msub><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>b</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mrow><mml:mi>b</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></alternatives><label>(12)</label></disp-formula></p>
        <p>Each TF-bound region, according to the definition of Power-Law distribution, must contain at least <italic toggle="yes">X</italic><sub><italic toggle="yes">min</italic></sub> reads. Thus, ChIP-GSM assigns <italic toggle="yes">X</italic><sub><italic toggle="yes">min</italic></sub> reads evenly to all assumed TF-bound regions and then assigns the remaining reads (<italic toggle="yes">R</italic><sub><italic toggle="yes">X</italic>,<italic toggle="yes">t</italic></sub>−∑<sub><italic toggle="yes">k</italic></sub><italic toggle="yes">b</italic>(<italic toggle="yes">c</italic><sub><italic toggle="yes">k</italic></sub>, <italic toggle="yes">t</italic>)<italic toggle="yes">X</italic><sub><italic toggle="yes">min</italic></sub>) one by one to each of them according to the distribution of their updated weights—leading to each region having a new read count <italic toggle="yes">X</italic>′<sub><italic toggle="yes">k</italic>,<italic toggle="yes">t</italic></sub>. Similarly, for background regions, ChIP-GSM assigns <italic toggle="yes">R</italic><sub><italic toggle="yes">t</italic></sub>−<italic toggle="yes">R</italic><sub><italic toggle="yes">X</italic>,<italic toggle="yes">t</italic></sub> reads one by one to them according to the distribution of updated weights—leading to each background region having new a read count <italic toggle="yes">I</italic>′<sub><italic toggle="yes">k</italic>,<italic toggle="yes">t</italic></sub>. Finally, for every region, a probabilistically sampled read count <italic toggle="yes">Y</italic>′<sub><italic toggle="yes">k</italic>,<italic toggle="yes">t</italic></sub> (<italic toggle="yes">b</italic>(<italic toggle="yes">c</italic><sub><italic toggle="yes">k</italic></sub>, <italic toggle="yes">t</italic>)<italic toggle="yes">X</italic>′<sub><italic toggle="yes">k</italic>,<italic toggle="yes">t</italic></sub>+(1−<italic toggle="yes">b</italic>(<italic toggle="yes">c</italic><sub><italic toggle="yes">k</italic></sub>, <italic toggle="yes">t</italic>))<italic toggle="yes">I</italic>′<sub><italic toggle="yes">k</italic>,<italic toggle="yes">t</italic></sub>) is generated, with a residual <italic toggle="yes">N</italic><sub><italic toggle="yes">k</italic>,<italic toggle="yes">t</italic></sub> from the observed read count <italic toggle="yes">Y</italic>′<sub><italic toggle="yes">k</italic>,<italic toggle="yes">t</italic></sub>. We control the residual variance <inline-formula id="pcbi.1009203.e015"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009203.e015.jpg" id="pcbi.1009203.e015g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M15" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> using an inverse Gamma distribution. The conditional probability of the variable <inline-formula id="pcbi.1009203.e016"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009203.e016.jpg" id="pcbi.1009203.e016g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M16" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> is calculated as follows:
<disp-formula id="pcbi.1009203.e017"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009203.e017.jpg" id="pcbi.1009203.e017g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M17" display="block" overflow="scroll"><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:mi mathvariant="bold">Y</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">X</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">I</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">C</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>∝</mml:mo><mml:mrow><mml:mstyle displaystyle="false"><mml:msub><mml:mo>∏</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mstyle><mml:mrow><mml:msub><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mi>Y</mml:mi><mml:mo>′</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives><label>(13)</label></disp-formula></p>
        <p>As detailed in <bold><xref rid="pcbi.1009203.s003" ref-type="supplementary-material">S3 Text</xref></bold>, Eq (<xref rid="pcbi.1009203.e017" ref-type="disp-formula">13</xref>) is an inverse-Gamma distribution. We directly sample <inline-formula id="pcbi.1009203.e018"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009203.e018.jpg" id="pcbi.1009203.e018g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M18" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> with the updated mean and shape parameters as <inline-formula id="pcbi.1009203.e019"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009203.e019.jpg" id="pcbi.1009203.e019g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M19" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mi>K</mml:mi><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac></mml:math></alternatives></inline-formula> and <italic toggle="yes">β</italic><sub><italic toggle="yes">N</italic></sub>+∑<sub><italic toggle="yes">k</italic>,<italic toggle="yes">t</italic></sub>(<italic toggle="yes">Y</italic><sub><italic toggle="yes">k</italic>,<italic toggle="yes">t</italic></sub>−<italic toggle="yes">Y</italic>′<sub><italic toggle="yes">k</italic>,<italic toggle="yes">t</italic></sub>)<sup>2</sup>/2.</p>
      </sec>
      <sec id="sec015">
        <title>Sampling TF modules</title>
        <p>For the region <italic toggle="yes">k</italic>, to sample a module from all candidates, ChIP-GSM estimates a discrete probability distribution for all modules by calculating a conditional probability for every candidate module <italic toggle="yes">c</italic><sub><italic toggle="yes">k</italic></sub> = <italic toggle="yes">m</italic>, and then probabilistically samples a module for the current region:
<disp-formula id="pcbi.1009203.e020"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009203.e020.jpg" id="pcbi.1009203.e020g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M20" display="block" overflow="scroll"><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>m</mml:mi></mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:mi mathvariant="bold">Y</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">X</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">I</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">D</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">B</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:msub><mml:mo stretchy="false">∏</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:msup><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:msup><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mi>b</mml:mi><mml:mo>(</mml:mo><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mrow><mml:msub><mml:mo stretchy="false">∏</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:msup><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:msup><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mi>b</mml:mi><mml:mo>(</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:math></alternatives><label>(14)</label></disp-formula></p>
        <p>After repeating module sampling at all regions, an updated matrix <bold>C</bold> is obtained and brought back to Eq (<xref rid="pcbi.1009203.e013" ref-type="disp-formula">11</xref>) to initiate a new round of sampling. We run the sampling process until the sampler appears to converge on the equilibrium distribution and then start accumulating samples on TF modules per region. After drawing enough samples, we obtain a weighted matrix <inline-formula id="pcbi.1009203.e021"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009203.e021.jpg" id="pcbi.1009203.e021g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M21" display="inline" overflow="scroll"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">C</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> with each element <inline-formula id="pcbi.1009203.e022"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009203.e022.jpg" id="pcbi.1009203.e022g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M22" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mn>0</mml:mn><mml:mo>≤</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>≤</mml:mo><mml:mn>1</mml:mn></mml:math></alternatives></inline-formula> (sampling frequency) denoting the posterior probability for the module <italic toggle="yes">m</italic> regulating the region <italic toggle="yes">k</italic>. We, therefore, generate a discrete posterior probability distribution of all TF modules for each region. The final number of regulatory modules for each region corresponds to the number of modes in the posterior module distribution. The accumulated samples for each module across all regions proportionally reflect the abundance of this module in the given context. More details about the sampling procedure are given in <bold><xref rid="pcbi.1009203.s003" ref-type="supplementary-material">S3 Text</xref></bold>.</p>
      </sec>
    </sec>
    <sec id="sec016">
      <title>ChIP-GSM: TF module-based active regulatory region prediction</title>
      <p>The TF module-region posterior regulation matrix <inline-formula id="pcbi.1009203.e023"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009203.e023.jpg" id="pcbi.1009203.e023g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M23" display="inline" overflow="scroll"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">C</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> is further used to predict active regulatory regions under the assumption that a region bound by multiple TFs is more likely an active regulatory element. By combining ChIP-GSM inferred TF module-region posterior probabilities with experimentally measurements of regulatory region activities in the same context (i.e., breast cancer MCF-7 cells), we train a binomial model using elastic net logistic regression [<xref rid="pcbi.1009203.ref042" ref-type="bibr">42</xref>] and predict the active/non-active regulatory elements bound by TF modules. Elastic net regression is a natural fit for this application because the modules (features in this binomial model) are highly correlated (sharing TFs) and tend to be highly grouped. Elastic net regression assigns similar weights to correlated features or removes them altogether by assigning zero weights [<xref rid="pcbi.1009203.ref017" ref-type="bibr">17</xref>]. Unlike linear regression, elastic net regression extends the method of least squares by adding a regularization (or penalty) that includes the feature weights <bold>β</bold> in the minimization process:
<disp-formula id="pcbi.1009203.e024"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009203.e024.jpg" id="pcbi.1009203.e024g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M24" display="block" overflow="scroll"><mml:mfrac linethickness="0pt"><mml:mrow><mml:mi mathvariant="normal">min</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mrow><mml:mstyle displaystyle="false"><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mstyle><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mrow><mml:mstyle displaystyle="false"><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mstyle><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="normal">log</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="normal">exp</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:mstyle displaystyle="false"><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mstyle><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>α</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>β</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:math></alternatives><label>(15)</label></disp-formula>
<disp-formula id="pcbi.1009203.e025"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009203.e025.jpg" id="pcbi.1009203.e025g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M25" display="block" overflow="scroll"><mml:mi mathvariant="normal">w</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">h</mml:mi><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>α</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:mrow><mml:mstyle displaystyle="false"><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mstyle><mml:mrow><mml:msubsup><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mi>α</mml:mi><mml:mrow><mml:mstyle displaystyle="false"><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mstyle><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives></disp-formula>
where <italic toggle="yes">z</italic><sub><italic toggle="yes">k</italic></sub> is a binary (+/-) label for regions with experimentally determined cell-type specific activity; <italic toggle="yes">K</italic>′ is the total number of labelled regions; <italic toggle="yes">λ</italic><sub><italic toggle="yes">p</italic></sub> is a non-negative parameter controlling the model complexity; 0≤<italic toggle="yes">α</italic>≤1 controls the relative contributions of ridge regression and LASSO to overall regularization penalty. After the training, we obtain an optimal set of weights including <italic toggle="yes">β</italic><sub>0</sub> and <italic toggle="yes">β</italic><sub>1</sub>,…,<italic toggle="yes">β</italic><sub><italic toggle="yes">m</italic></sub>…,<italic toggle="yes">β</italic><sub><italic toggle="yes">M</italic></sub> for individual modules.</p>
      <p>To examine the prediction performance of ChIP-GSM-learned modules and fairly compare the prediction accuracy to methods featuring TFs and/or HMs bindings as inputs, we divide all regions into training and testing groups. ChIP-GSM parameters like the distribution parameters <italic toggle="yes">γ</italic><sub><italic toggle="yes">t</italic></sub>, <italic toggle="yes">α</italic><sub><italic toggle="yes">t</italic></sub> and <italic toggle="yes">β</italic><sub><italic toggle="yes">t</italic></sub>, candidate modules <bold>B</bold>, and classifier weights <italic toggle="yes">β</italic><sub>0</sub>, <italic toggle="yes">β</italic><sub>1</sub>,…,<italic toggle="yes">β</italic><sub><italic toggle="yes">m</italic></sub>…,<italic toggle="yes">β</italic><sub><italic toggle="yes">M</italic></sub> are all learned from the training regions only. ChIP-GSM then estimates the probabilities of candidate modules on testing regions and further predicts their regulatory activities. We repeat this experiment 100 times by randomly selecting regions for model training so that any potential bias on region selection can be largely eliminated. The variation of module parameters from the original values (learned from all regions) are assessed in terms of root of mean square error (RMSE) for each parameter estimation under each of the nine selected cell types.</p>
      <p>With 80% regions as input, the learned model parameters have very small variations from their original values (RMSE across all TFs/mean across all TFs per parameter &lt; 2%), and on average 86% of candidate modules stay the same (<bold><xref rid="pcbi.1009203.s017" ref-type="supplementary-material">S4 Table</xref></bold>). In this case, the changes caused by region holdout are similar between promoters and enhancers. The F-measure of ChIP-GSM on testing region activity prediction is higher than that of each comparable method under the same settings (<bold><xref rid="pcbi.1009203.g004" ref-type="fig">Fig 4</xref></bold>). In the more challenging experiments where only 50% of regions are used for training, most of the model parameters still hold, with only ~5% variation from the original values. Some less frequent modules are missed during the candidate module searching process so that the similarity candidate modules to the original whole set drops to 70% for promoters and 60% for enhancers (<bold><xref rid="pcbi.1009203.s017" ref-type="supplementary-material">S4 Table</xref></bold>). As shown in <bold><xref rid="pcbi.1009203.s005" ref-type="supplementary-material">S2 Fig</xref></bold>, the performance of ChIP-GSM mostly holds even with 50% regions as input because model parameters are accurately estimated, and major modules (regulating regions frequently) are well captured. The F-measure of ChIP-GSM is higher than that of EMERGE, the best performing method among the selected comparable methods.</p>
    </sec>
    <sec id="sec017">
      <title>Epigenetic markers and chromatin interactions enrichment analysis</title>
      <p>H3K27ac and H3K4me1 are enhancer marker proteins while H3K4me3 is often used as a promoter marker protein [<xref rid="pcbi.1009203.ref026" ref-type="bibr">26</xref>]. We download marker proteins ChIP-seq peaks for MCF7 and K562 cell types from the ENCODE database. For each of the three marker proteins, we label a region ‘+’ if there is at least one ChIP-seq peak within 2k bps from the region center; or we label it as ‘-’. Then, two categories of labeled regions are selected as (H3K27ac ‘+’, H3K4me1 ‘+’, H3K4me3 ‘-’) and (H3K27ac ‘-’, H3K4me1 ‘-’, H3K4me3 ‘+’), representing the valid enhancer and promoters, respectively. We assess the enrichment of labeled regions among the top (e.g., 10%) ChIP-GSM-predicted enhancers or promoters, against the enrichment of labeled regions among the FANTOM5 enhancers or promoters of the same cell type. A hypergeometric <italic toggle="yes">p</italic>-value is calculated as:
<disp-formula id="pcbi.1009203.e026"><alternatives><graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009203.e026.jpg" id="pcbi.1009203.e026g" position="anchor"/><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M26" display="block" overflow="scroll"><mml:mi>p</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi>h</mml:mi><mml:mo>≥</mml:mo><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mi>o</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mstyle displaystyle="false"><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mi>o</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup></mml:mstyle><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac linethickness="0pt"><mml:mrow><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo><mml:mo>(</mml:mo><mml:mrow><mml:mfrac linethickness="0pt"><mml:mrow><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mi>o</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mi>h</mml:mi></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>/</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mfrac linethickness="0pt"><mml:mrow><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mi>o</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives><label>(16)</label></disp-formula>
where <italic toggle="yes">K</italic><sub><italic toggle="yes">all</italic></sub> is the number of active enhancers (or promoters) in the FANTOM5 database; <italic toggle="yes">H</italic><sub><italic toggle="yes">all</italic></sub> is the number of labelled regions among <italic toggle="yes">K</italic><sub><italic toggle="yes">all</italic></sub>; <italic toggle="yes">K</italic><sub><italic toggle="yes">top</italic></sub> is the number of the top predicted regions by ChIP-GSM; <italic toggle="yes">H</italic><sub><italic toggle="yes">top</italic></sub> is the number of labelled regions among <italic toggle="yes">K</italic><sub><italic toggle="yes">top</italic></sub>.</p>
      <p>Cell type-specific ChIA-PET chromatin interactions are downloaded from the ENCODE database. To eliminate nonsense interactions, we select interactions looping between annotated enhancers and promoters. And for each enhancer or promoter, we count the number of interactions around it. Across all enhancers (or promoters), we assess the correlation between ChIP-GSM predicted enhancer (or promoter) activities and the number of ChIA-PET loops of the same regions by fitting a linear model.</p>
    </sec>
    <sec id="sec018">
      <title>K562 time-course gene expression analysis</title>
      <p>We download a time-course K562 gene expression dataset [<xref rid="pcbi.1009203.ref019" ref-type="bibr">19</xref>] from the GEO database (GEO accession number: GSE1036). K562 cells (duplicate cultures A &amp; B) were treated with 50 micromolar hemin for 0, 6, 12, 24, 48, 72 hours followed by RNA extraction and gene expression profiling on Affymetrix human U133A arrays. Under each time point, there were two duplicates as A0 and B0 under time point ‘0’ and Ai and Bi under each time point ‘i’. For a pair of TFs, we calculate the Pearson correlation coefficient using their mRNA transcription, assuming associated TFs in the same module are more likely to be active at the same time—though the relationship between the protein activity and mRNA transcription may not be linear. We also select up or down-regulated genes if at any time point <italic toggle="yes">i</italic>, compared to time point ‘0’, the gene expression log2 fold change is larger than 1: |log2(A0)-log2(Ai)|&gt;1, |log2(A0)-log2(Bi)|&gt;1, |log2(B0)-log2(Ai)|&gt;1, and |log2(B0)-log2(Bi)|&gt;1. In total, we collected 1,569 genes and assigned them into eight clusters using hierarchical clustering (<bold><xref rid="pcbi.1009203.g006" ref-type="fig">Fig 6D</xref></bold>).</p>
    </sec>
  </sec>
  <sec id="sec020" sec-type="supplementary-material">
    <title>Supporting information</title>
    <supplementary-material id="pcbi.1009203.s001" position="float" content-type="local-data">
      <label>S1 Text</label>
      <caption>
        <title>ChIP-GSM workflow.</title>
        <p>(DOCX)</p>
      </caption>
      <media xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009203.s001.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1009203.s002" position="float" content-type="local-data">
      <label>S2 Text</label>
      <caption>
        <title>ChIP-GSM inferred TF modules at K562 promoters.</title>
        <p>(DOCX)</p>
      </caption>
      <media xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009203.s002.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1009203.s003" position="float" content-type="local-data">
      <label>S3 Text</label>
      <caption>
        <title>Supplementary Methods.</title>
        <p>(DOCX)</p>
      </caption>
      <media xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009203.s003.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1009203.s004" position="float" content-type="local-data">
      <label>S1 Fig</label>
      <caption>
        <title>A detailed workflow of the ChIP-GSM approach.</title>
        <p>(TIF)</p>
      </caption>
      <media xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009203.s004.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1009203.s005" position="float" content-type="local-data">
      <label>S2 Fig</label>
      <caption>
        <title>Two-fold cross-validation on predicting cell type-specific active regulatory regions.</title>
        <p>(A) F-measure on active enhancers; (B) F-measure on active promoters.</p>
        <p>(TIF)</p>
      </caption>
      <media xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009203.s005.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1009203.s006" position="float" content-type="local-data">
      <label>S3 Fig</label>
      <caption>
        <title>Scatter plots of ChIP-GSM-predicted regulatory activities and ChIA-PET 3D chromatin interactions in MCF7 and K562 cells, respectively.</title>
        <p>Rare regions with loop count higher than 30 in MCF7 cells or 50 in K562 cells were plotted at 30 in (A) and (C) or at 50 in (B) and (D).</p>
        <p>(TIF)</p>
      </caption>
      <media xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009203.s006.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1009203.s007" position="float" content-type="local-data">
      <label>S4 Fig</label>
      <caption>
        <title>Top 30 ChIP-GSM inferred TF modules from K562 promoters.</title>
        <p>(TIF)</p>
      </caption>
      <media xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009203.s007.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1009203.s008" position="float" content-type="local-data">
      <label>S5 Fig</label>
      <caption>
        <title>11 TF modules inferred using the Rulefit approach, labeled using the same group color as ChIP-GSM.</title>
        <p>(TIF)</p>
      </caption>
      <media xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009203.s008.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1009203.s009" position="float" content-type="local-data">
      <label>S6 Fig</label>
      <caption>
        <title>TF modules inferred by ISA.</title>
        <p>Module identified by ISA can be roughly clustered into four major groups (recovering the Groups 1, 2, 4 and 6 inferred by ChIP-GSM). However, modules in Groups 5 and 8 are missing in the results of ISA.</p>
        <p>(TIF)</p>
      </caption>
      <media xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009203.s009.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1009203.s010" position="float" content-type="local-data">
      <label>S7 Fig</label>
      <caption>
        <title>TF modules inferred by Plaid.</title>
        <p>Plaid identified five modules with only high-level large-scale associations captured.</p>
        <p>(TIF)</p>
      </caption>
      <media xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009203.s010.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1009203.s011" position="float" content-type="local-data">
      <label>S8 Fig</label>
      <caption>
        <title>Co-expression of TFs in K562 cells.</title>
        <p>Gene expression data was downloaded from GEO database with ID: GSE1036. Color bar represents–log10(<italic toggle="yes">p</italic>-value) of Pearson correlation coefficient. Rectangles with different colors represent the ChIP-GSM identified module groups.</p>
        <p>(TIF)</p>
      </caption>
      <media xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009203.s011.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1009203.s012" position="float" content-type="local-data">
      <label>S9 Fig</label>
      <caption>
        <title>Target genes regulated by ChIP-GSM inferred modules at K562 promoters.</title>
        <p>(TIF)</p>
      </caption>
      <media xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009203.s012.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1009203.s013" position="float" content-type="local-data">
      <label>S10 Fig</label>
      <caption>
        <title>Histograms of ChIP-seq read counts in 500 bps binned promoter regions.</title>
        <p>Red lines in (A), (C) and (E) represent Power-Law distribution fittings to the TF ChIP-seq read counts. Red lines in (B), (D) and (F) represent Gamma distribution fittings to the input ChIP-seq read counts.</p>
        <p>(TIF)</p>
      </caption>
      <media xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009203.s013.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1009203.s014" position="float" content-type="local-data">
      <label>S1 Table</label>
      <caption>
        <title>ENCODE ChIP-seq profiles used by ChIP-GSM for transcription factor module inference.</title>
        <p>(XLSX)</p>
      </caption>
      <media xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009203.s014.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1009203.s015" position="float" content-type="local-data">
      <label>S2 Table</label>
      <caption>
        <title>The similarity of ChIP-GSM-inferred modules between promoter and enhancer regions.</title>
        <p>(XLSX)</p>
      </caption>
      <media xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009203.s015.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1009203.s016" position="float" content-type="local-data">
      <label>S3 Table</label>
      <caption>
        <title>ChIP-GSM identified modules.</title>
        <p>(XLSX)</p>
      </caption>
      <media xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009203.s016.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1009203.s017" position="float" content-type="local-data">
      <label>S4 Table</label>
      <caption>
        <title>Robustness of ChIP-GSM parameter estimation.</title>
        <p>(XLSX)</p>
      </caption>
      <media xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009203.s017.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1009203.s018" position="float" content-type="local-data">
      <label>S5 Table</label>
      <caption>
        <title>Performrance of ChIP-GSM on cell type-specific active regulatory element prediction (F-measure on 20% hold-out regions).</title>
        <p>(XLSX)</p>
      </caption>
      <media xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009203.s018.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1009203.s019" position="float" content-type="local-data">
      <label>S6 Table</label>
      <caption>
        <title>Significantly enriched cellular functions in genes regulated by each group of modules in K562 cells.</title>
        <p>(XLSX)</p>
      </caption>
      <media xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009203.s019.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1009203.s020" position="float" content-type="local-data">
      <label>S7 Table</label>
      <caption>
        <title>Differentially expressed genes regulated by each group of modules in K562 cells.</title>
        <p>(XLSX)</p>
      </caption>
      <media xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="pcbi.1009203.s020.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ref-list>
    <title>References</title>
    <ref id="pcbi.1009203.ref001">
      <label>1</label>
      <mixed-citation publication-type="journal"><name><surname>Hardison</surname><given-names>RC</given-names></name>, <name><surname>Taylor</surname><given-names>J</given-names></name>. <article-title>Genomic approaches towards finding cis-regulatory modules in animals</article-title>. <source>Nat Rev Genet</source>. <year>2012</year>;<volume>13</volume>(<issue>7</issue>):<fpage>469</fpage>–<lpage>83</lpage>. Epub 2012/06/19. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/nrg3242</pub-id> ; PubMed Central PMCID: PMC3541939.<?supplied-pmid 22705667?><pub-id pub-id-type="pmid">22705667</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009203.ref002">
      <label>2</label>
      <mixed-citation publication-type="journal"><name><surname>Hnisz</surname><given-names>D</given-names></name>, <name><surname>Abraham</surname><given-names>BJ</given-names></name>, <name><surname>Lee</surname><given-names>TI</given-names></name>, <name><surname>Lau</surname><given-names>A</given-names></name>, <name><surname>Saint-Andre</surname><given-names>V</given-names></name>, <name><surname>Sigova</surname><given-names>AA</given-names></name>, <etal>et al</etal>. <article-title>Super-enhancers in the control of cell identity and disease</article-title>. <source>Cell</source>. <year>2013</year>;<volume>155</volume>(<issue>4</issue>):<fpage>934</fpage>–<lpage>47</lpage>. Epub 2013/10/15. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.cell.2013.09.053</pub-id> ; PubMed Central PMCID: PMC3841062.<?supplied-pmid 24119843?><pub-id pub-id-type="pmid">24119843</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009203.ref003">
      <label>3</label>
      <mixed-citation publication-type="journal"><name><surname>Cheng</surname><given-names>AS</given-names></name>, <name><surname>Jin</surname><given-names>VX</given-names></name>, <name><surname>Fan</surname><given-names>M</given-names></name>, <name><surname>Smith</surname><given-names>LT</given-names></name>, <name><surname>Liyanarachchi</surname><given-names>S</given-names></name>, <name><surname>Yan</surname><given-names>PS</given-names></name>, <etal>et al</etal>. <article-title>Combinatorial analysis of transcription factor partners reveals recruitment of c-MYC to estrogen receptor-alpha responsive promoters</article-title>. <source>Molecular cell</source>. <year>2006</year>;<volume>21</volume>(<issue>3</issue>):<fpage>393</fpage>–<lpage>404</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.molcel.2005.12.016</pub-id> .<?supplied-pmid 16455494?><pub-id pub-id-type="pmid">16455494</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009203.ref004">
      <label>4</label>
      <mixed-citation publication-type="journal"><name><surname>Ernst</surname><given-names>J</given-names></name>, <name><surname>Kellis</surname><given-names>M</given-names></name>. <article-title>ChromHMM: automating chromatin-state discovery and characterization</article-title>. <source>Nat Methods</source>. <year>2012</year>;<volume>9</volume>(<issue>3</issue>):<fpage>215</fpage>–<lpage>6</lpage>. Epub 2012/03/01. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/nmeth.1906</pub-id> ; PubMed Central PMCID: PMC3577932.<?supplied-pmid 22373907?><pub-id pub-id-type="pmid">22373907</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009203.ref005">
      <label>5</label>
      <mixed-citation publication-type="journal"><name><surname>Zeng</surname><given-names>X</given-names></name>, <name><surname>Sanalkumar</surname><given-names>R</given-names></name>, <name><surname>Bresnick</surname><given-names>EH</given-names></name>, <name><surname>Li</surname><given-names>H</given-names></name>, <name><surname>Chang</surname><given-names>Q</given-names></name>, <name><surname>Keles</surname><given-names>S</given-names></name>. <article-title>jMOSAiCS: joint analysis of multiple ChIP-seq datasets</article-title>. <source>Genome Biol</source>. <year>2013</year>;<volume>14</volume>(<issue>4</issue>):<fpage>R38</fpage>. Epub 2013/07/13. <comment>doi: </comment><pub-id pub-id-type="doi">10.1186/gb-2013-14-4-r38</pub-id> ; PubMed Central PMCID: PMC4053760.<?supplied-pmid 23844871?><pub-id pub-id-type="pmid">23844871</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009203.ref006">
      <label>6</label>
      <mixed-citation publication-type="journal"><name><surname>Wong</surname><given-names>KC</given-names></name>, <name><surname>Li</surname><given-names>Y</given-names></name>, <name><surname>Peng</surname><given-names>C</given-names></name>, <name><surname>Zhang</surname><given-names>Z</given-names></name>. <article-title>SignalSpider: probabilistic pattern discovery on multiple normalized ChIP-Seq signal profiles</article-title>. <source>Bioinformatics</source>. <year>2015</year>;<volume>31</volume>(<issue>1</issue>):<fpage>17</fpage>–<lpage>24</lpage>. Epub 2014/09/07. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bioinformatics/btu604</pub-id> .<?supplied-pmid 25192742?><pub-id pub-id-type="pmid">25192742</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009203.ref007">
      <label>7</label>
      <mixed-citation publication-type="journal"><name><surname>Aerts</surname><given-names>S</given-names></name>, <name><surname>Van Loo</surname><given-names>P</given-names></name>, <name><surname>Thijs</surname><given-names>G</given-names></name>, <name><surname>Moreau</surname><given-names>Y</given-names></name>, <name><surname>De Moor</surname><given-names>B</given-names></name>. <article-title>Computational detection of cis -regulatory modules</article-title>. <source>Bioinformatics</source>. <year>2003</year>;<volume>19</volume><issue>Suppl 2</issue>:<fpage>ii5</fpage>–<lpage>14</lpage>. Epub 2003/10/10. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bioinformatics/btg1052</pub-id> .<?supplied-pmid 14534164?><pub-id pub-id-type="pmid">14534164</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009203.ref008">
      <label>8</label>
      <mixed-citation publication-type="journal"><name><surname>Van Loo</surname><given-names>P</given-names></name>, <name><surname>Marynen</surname><given-names>P</given-names></name>. <article-title>Computational methods for the detection of cis-regulatory modules</article-title>. <source>Brief Bioinform</source>. <year>2009</year>;<volume>10</volume>(<issue>5</issue>):<fpage>509</fpage>–<lpage>24</lpage>. Epub 2009/06/06. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bib/bbp025</pub-id> .<?supplied-pmid 19498042?><pub-id pub-id-type="pmid">19498042</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009203.ref009">
      <label>9</label>
      <mixed-citation publication-type="journal"><name><surname>Duren</surname><given-names>Z</given-names></name>, <name><surname>Chen</surname><given-names>X</given-names></name>, <name><surname>Jiang</surname><given-names>R</given-names></name>, <name><surname>Wang</surname><given-names>Y</given-names></name>, <name><surname>Wong</surname><given-names>WH</given-names></name>. <article-title>Modeling gene regulation from paired expression and chromatin accessibility data</article-title>. <source>Proc Natl Acad Sci U S A</source>. <year>2017</year>;<volume>114</volume>(<issue>25</issue>):<fpage>E4914</fpage>–<lpage>E23</lpage>. Epub 2017/06/04. <comment>doi: </comment><pub-id pub-id-type="doi">10.1073/pnas.1704553114</pub-id> ; PubMed Central PMCID: PMC5488952.<?supplied-pmid 28576882?><pub-id pub-id-type="pmid">28576882</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009203.ref010">
      <label>10</label>
      <mixed-citation publication-type="journal"><name><surname>Chen</surname><given-names>X</given-names></name>, <name><surname>Jung</surname><given-names>JG</given-names></name>, <name><surname>Shajahan-Haq</surname><given-names>AN</given-names></name>, <name><surname>Clarke</surname><given-names>R</given-names></name>, <name><surname>Shih Ie</surname><given-names>M</given-names></name>, <name><surname>Wang</surname><given-names>Y</given-names></name>, <etal>et al</etal>. <article-title>ChIP-BIT: Bayesian inference of target genes using a novel joint probabilistic model of ChIP-seq profiles</article-title>. <source>Nucleic Acids Res</source>. <year>2016</year>;<volume>44</volume>(<issue>7</issue>):<fpage>e65</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/nar/gkv1491</pub-id> ; PubMed Central PMCID: PMC4838354.<?supplied-pmid 26704972?><pub-id pub-id-type="pmid">26704972</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009203.ref011">
      <label>11</label>
      <mixed-citation publication-type="journal"><name><surname>Feng</surname><given-names>J</given-names></name>, <name><surname>Liu</surname><given-names>T</given-names></name>, <name><surname>Qin</surname><given-names>B</given-names></name>, <name><surname>Zhang</surname><given-names>Y</given-names></name>, <name><surname>Liu</surname><given-names>XS</given-names></name>. <article-title>Identifying ChIP-seq enrichment using MACS</article-title>. <source>Nat Protoc</source>. <year>2012</year>;<volume>7</volume>(<issue>9</issue>):<fpage>1728</fpage>–<lpage>40</lpage>. Epub 2012/09/01. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/nprot.2012.101</pub-id> ; PubMed Central PMCID: PMC3868217.<?supplied-pmid 22936215?><pub-id pub-id-type="pmid">22936215</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009203.ref012">
      <label>12</label>
      <mixed-citation publication-type="journal"><name><surname>Ma</surname><given-names>W</given-names></name>, <name><surname>Wong</surname><given-names>WH</given-names></name>. <article-title>The analysis of ChIP-Seq data</article-title>. <source>Methods Enzymol</source>. <year>2011</year>;<volume>497</volume>:<fpage>51</fpage>–<lpage>73</lpage>. Epub 2011/05/24. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/B978-0-12-385075-1.00003-2</pub-id> .<?supplied-pmid 21601082?><pub-id pub-id-type="pmid">21601082</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009203.ref013">
      <label>13</label>
      <mixed-citation publication-type="journal"><name><surname>Gerstein</surname><given-names>MB</given-names></name>, <name><surname>Kundaje</surname><given-names>A</given-names></name>, <name><surname>Hariharan</surname><given-names>M</given-names></name>, <name><surname>Landt</surname><given-names>SG</given-names></name>, <name><surname>Yan</surname><given-names>KK</given-names></name>, <name><surname>Cheng</surname><given-names>C</given-names></name>, <etal>et al</etal>. <article-title>Architecture of the human regulatory network derived from ENCODE data</article-title>. <source>Nature</source>. <year>2012</year>;<volume>489</volume>(<issue>7414</issue>):<fpage>91</fpage>–<lpage>100</lpage>. Epub 2012/09/08. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/nature11245</pub-id> ; PubMed Central PMCID: PMC4154057.<?supplied-pmid 22955619?><pub-id pub-id-type="pmid">22955619</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009203.ref014">
      <label>14</label>
      <mixed-citation publication-type="journal"><name><surname>Zhang</surname><given-names>ZD</given-names></name>, <name><surname>Rozowsky</surname><given-names>J</given-names></name>, <name><surname>Snyder</surname><given-names>M</given-names></name>, <name><surname>Chang</surname><given-names>J</given-names></name>, <name><surname>Gerstein</surname><given-names>M</given-names></name>. <article-title>Modeling ChIP sequencing in silico with applications</article-title>. <source>PLoS Comput Biol</source>. <year>2008</year>;<volume>4</volume>(<issue>8</issue>):<fpage>e1000158</fpage>. Epub 2008/08/30. <comment>doi: </comment><pub-id pub-id-type="doi">10.1371/journal.pcbi.1000158</pub-id> ; PubMed Central PMCID: PMC2507756.<?supplied-pmid 18725927?><pub-id pub-id-type="pmid">18725927</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009203.ref015">
      <label>15</label>
      <mixed-citation publication-type="journal"><name><surname>Datta</surname><given-names>V</given-names></name>, <name><surname>Hannenhalli</surname><given-names>S</given-names></name>, <name><surname>Siddharthan</surname><given-names>R</given-names></name>. <article-title>ChIPulate: A comprehensive ChIP-seq simulation pipeline</article-title>. <source>PLoS Comput Biol</source>. <year>2019</year>;<volume>15</volume>(<issue>3</issue>):<fpage>e1006921</fpage>. Epub 2019/03/22. <comment>doi: </comment><pub-id pub-id-type="doi">10.1371/journal.pcbi.1006921</pub-id> ; PubMed Central PMCID: PMC6445533.<?supplied-pmid 30897079?><pub-id pub-id-type="pmid">30897079</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009203.ref016">
      <label>16</label>
      <mixed-citation publication-type="journal"><name><surname>van Duijvenboden</surname><given-names>K</given-names></name>, <name><surname>de Boer</surname><given-names>BA</given-names></name>, <name><surname>Capon</surname><given-names>N</given-names></name>, <name><surname>Ruijter</surname><given-names>JM</given-names></name>, <name><surname>Christoffels</surname><given-names>VM</given-names></name>. <article-title>EMERGE: a flexible modelling framework to predict genomic regulatory elements from genomic signatures</article-title>. <source>Nucleic Acids Res</source>. <year>2016</year>;<volume>44</volume>(<issue>5</issue>):<fpage>e42</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/nar/gkv1144</pub-id> ; PubMed Central PMCID: PMC4797259.<?supplied-pmid 26531828?><pub-id pub-id-type="pmid">26531828</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009203.ref017">
      <label>17</label>
      <mixed-citation publication-type="journal"><name><surname>Zou</surname><given-names>H</given-names></name>, <name><surname>Hastie</surname><given-names>T</given-names></name>. <article-title>Regularization and variable selection via the elastic net</article-title>. <source>Journal of the Royal Statistical Society: Series B (Statistical Methodology)</source>. <year>2005</year>;<volume>67</volume>(<issue>2</issue>):<fpage>301</fpage>–<lpage>20</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1111/j.1467-9868.2005.00503.x</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009203.ref018">
      <label>18</label>
      <mixed-citation publication-type="journal"><name><surname>Lizio</surname><given-names>M</given-names></name>, <name><surname>Abugessaisa</surname><given-names>I</given-names></name>, <name><surname>Noguchi</surname><given-names>S</given-names></name>, <name><surname>Kondo</surname><given-names>A</given-names></name>, <name><surname>Hasegawa</surname><given-names>A</given-names></name>, <name><surname>Hon</surname><given-names>CC</given-names></name>, <etal>et al</etal>. <article-title>Update of the FANTOM web resource: expansion to provide additional transcriptome atlases</article-title>. <source>Nucleic Acids Res</source>. <year>2019</year>;<volume>47</volume>(<issue>D1</issue>):<fpage>D752</fpage>–<lpage>D8</lpage>. Epub 2018/11/09. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/nar/gky1099</pub-id> ; PubMed Central PMCID: PMC6323950.<?supplied-pmid 30407557?><pub-id pub-id-type="pmid">30407557</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009203.ref019">
      <label>19</label>
      <mixed-citation publication-type="journal"><name><surname>Addya</surname><given-names>S</given-names></name>, <name><surname>Keller</surname><given-names>MA</given-names></name>, <name><surname>Delgrosso</surname><given-names>K</given-names></name>, <name><surname>Ponte</surname><given-names>CM</given-names></name>, <name><surname>Vadigepalli</surname><given-names>R</given-names></name>, <name><surname>Gonye</surname><given-names>GE</given-names></name>, <etal>et al</etal>. <article-title>Erythroid-induced commitment of K562 cells results in clusters of differentially expressed genes enriched for specific transcription regulatory elements</article-title>. <source>Physiol Genomics</source>. <year>2004</year>;<volume>19</volume>(<issue>1</issue>):<fpage>117</fpage>–<lpage>30</lpage>. Epub 2004/07/15. <comment>doi: </comment><pub-id pub-id-type="doi">10.1152/physiolgenomics.00028.2004</pub-id> .<?supplied-pmid 15252187?><pub-id pub-id-type="pmid">15252187</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009203.ref020">
      <label>20</label>
      <mixed-citation publication-type="journal"><name><surname>Heinz</surname><given-names>S</given-names></name>, <name><surname>Benner</surname><given-names>C</given-names></name>, <name><surname>Spann</surname><given-names>N</given-names></name>, <name><surname>Bertolino</surname><given-names>E</given-names></name>, <name><surname>Lin</surname><given-names>YC</given-names></name>, <name><surname>Laslo</surname><given-names>P</given-names></name>, <etal>et al</etal>. <article-title>Simple combinations of lineage-determining transcription factors prime cis-regulatory elements required for macrophage and B cell identities</article-title>. <source>Molecular cell</source>. <year>2010</year>;<volume>38</volume>(<issue>4</issue>):<fpage>576</fpage>–<lpage>89</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.molcel.2010.05.004</pub-id> ; PubMed Central PMCID: PMC2898526.<?supplied-pmid 20513432?><pub-id pub-id-type="pmid">20513432</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009203.ref021">
      <label>21</label>
      <mixed-citation publication-type="journal"><name><surname>Auerbach</surname><given-names>RK</given-names></name>, <name><surname>Euskirchen</surname><given-names>G</given-names></name>, <name><surname>Rozowsky</surname><given-names>J</given-names></name>, <name><surname>Lamarre-Vincent</surname><given-names>N</given-names></name>, <name><surname>Moqtaderi</surname><given-names>Z</given-names></name>, <name><surname>Lefrancois</surname><given-names>P</given-names></name>, <etal>et al</etal>. <article-title>Mapping accessible chromatin regions using Sono-Seq</article-title>. <source>Proc Natl Acad Sci U S A</source>. <year>2009</year>;<volume>106</volume>(<issue>35</issue>):<fpage>14926</fpage>–<lpage>31</lpage>. Epub 2009/08/27. <comment>doi: </comment><pub-id pub-id-type="doi">10.1073/pnas.0905443106</pub-id> ; PubMed Central PMCID: PMC2736440.<?supplied-pmid 19706456?><pub-id pub-id-type="pmid">19706456</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009203.ref022">
      <label>22</label>
      <mixed-citation publication-type="journal"><name><surname>Pasini</surname><given-names>D</given-names></name>, <name><surname>Bracken</surname><given-names>AP</given-names></name>, <name><surname>Hansen</surname><given-names>JB</given-names></name>, <name><surname>Capillo</surname><given-names>M</given-names></name>, <name><surname>Helin</surname><given-names>K</given-names></name>. <article-title>The polycomb group protein Suz12 is required for embryonic stem cell differentiation</article-title>. <source>Mol Cell Biol</source>. <year>2007</year>;<volume>27</volume>(<issue>10</issue>):<fpage>3769</fpage>–<lpage>79</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1128/MCB.01432-06</pub-id> WOS:000246269400019. <?supplied-pmid 17339329?><pub-id pub-id-type="pmid">17339329</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009203.ref023">
      <label>23</label>
      <mixed-citation publication-type="journal"><name><surname>Richly</surname><given-names>H</given-names></name>, <name><surname>Aloia</surname><given-names>L</given-names></name>, <name><surname>Di Croce</surname><given-names>L</given-names></name>. <article-title>Roles of the Polycomb group proteins in stem cells and cancer</article-title>. <source>Cell death &amp; disease</source>. <year>2011</year>;<volume>2</volume>:<fpage>e204</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/cddis.2011.84</pub-id> ; PubMed Central PMCID: PMC3186902.<?supplied-pmid 21881606?><pub-id pub-id-type="pmid">21881606</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009203.ref024">
      <label>24</label>
      <mixed-citation publication-type="journal"><name><surname>Boyer</surname><given-names>LA</given-names></name>, <name><surname>Plath</surname><given-names>K</given-names></name>, <name><surname>Zeitlinger</surname><given-names>J</given-names></name>, <name><surname>Brambrink</surname><given-names>T</given-names></name>, <name><surname>Medeiros</surname><given-names>LA</given-names></name>, <name><surname>Lee</surname><given-names>TI</given-names></name>, <etal>et al</etal>. <article-title>Polycomb complexes repress developmental regulators in murine embryonic stem cells</article-title>. <source>Nature</source>. <year>2006</year>;<volume>441</volume>(<issue>7091</issue>):<fpage>349</fpage>–<lpage>53</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/nature04733</pub-id> .<?supplied-pmid 16625203?><pub-id pub-id-type="pmid">16625203</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009203.ref025">
      <label>25</label>
      <mixed-citation publication-type="journal"><name><surname>Sethi</surname><given-names>A</given-names></name>, <name><surname>Gu</surname><given-names>M</given-names></name>, <name><surname>Gumusgoz</surname><given-names>E</given-names></name>, <name><surname>Chan</surname><given-names>L</given-names></name>, <name><surname>Yan</surname><given-names>KK</given-names></name>, <name><surname>Rozowsky</surname><given-names>J</given-names></name>, <etal>et al</etal>. <article-title>Supervised enhancer prediction with epigenetic pattern recognition and targeted validation</article-title>. <source>Nat Methods</source>. <year>2020</year>;<volume>17</volume>(<issue>8</issue>):<fpage>807</fpage>–<lpage>14</lpage>. Epub 2020/08/02. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/s41592-020-0907-8</pub-id> .<?supplied-pmid 32737473?><pub-id pub-id-type="pmid">32737473</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009203.ref026">
      <label>26</label>
      <mixed-citation publication-type="journal"><name><surname>Ernst</surname><given-names>J</given-names></name>, <name><surname>Kellis</surname><given-names>M</given-names></name>. <article-title>Chromatin-state discovery and genome annotation with ChromHMM</article-title>. <source>Nat Protoc</source>. <year>2017</year>;<volume>12</volume>(<issue>12</issue>):<fpage>2478</fpage>–<lpage>92</lpage>. Epub 2017/11/10. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/nprot.2017.124</pub-id> ; PubMed Central PMCID: PMC5945550.<?supplied-pmid 29120462?><pub-id pub-id-type="pmid">29120462</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009203.ref027">
      <label>27</label>
      <mixed-citation publication-type="journal"><name><surname>Li</surname><given-names>W</given-names></name>, <name><surname>Notani</surname><given-names>D</given-names></name>, <name><surname>Ma</surname><given-names>Q</given-names></name>, <name><surname>Tanasa</surname><given-names>B</given-names></name>, <name><surname>Nunez</surname><given-names>E</given-names></name>, <name><surname>Chen</surname><given-names>AY</given-names></name>, <etal>et al</etal>. <article-title>Functional roles of enhancer RNAs for oestrogen-dependent transcriptional activation</article-title>. <source>Nature</source>. <year>2013</year>;<volume>498</volume>(<issue>7455</issue>):<fpage>516</fpage>–<lpage>20</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/nature12210</pub-id> ; PubMed Central PMCID: PMC3718886.<?supplied-pmid 23728302?><pub-id pub-id-type="pmid">23728302</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009203.ref028">
      <label>28</label>
      <mixed-citation publication-type="journal"><name><surname>Heintzman</surname><given-names>ND</given-names></name>, <name><surname>Stuart</surname><given-names>RK</given-names></name>, <name><surname>Hon</surname><given-names>G</given-names></name>, <name><surname>Fu</surname><given-names>Y</given-names></name>, <name><surname>Ching</surname><given-names>CW</given-names></name>, <name><surname>Hawkins</surname><given-names>RD</given-names></name>, <etal>et al</etal>. <article-title>Distinct and predictive chromatin signatures of transcriptional promoters and enhancers in the human genome</article-title>. <source>Nat Genet</source>. <year>2007</year>;<volume>39</volume>(<issue>3</issue>):<fpage>311</fpage>–<lpage>8</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/ng1966</pub-id> .<?supplied-pmid 17277777?><pub-id pub-id-type="pmid">17277777</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009203.ref029">
      <label>29</label>
      <mixed-citation publication-type="journal"><name><surname>Chen</surname><given-names>X</given-names></name>, <name><surname>Gu</surname><given-names>J</given-names></name>, <name><surname>Wang</surname><given-names>X</given-names></name>, <name><surname>Jung</surname><given-names>JG</given-names></name>, <name><surname>Wang</surname><given-names>TL</given-names></name>, <name><surname>Hilakivi-Clarke</surname><given-names>L</given-names></name>, <etal>et al</etal>. <article-title>CRNET: An efficient sampling approach to infer functional regulatory networks by integrating large-scale ChIP-seq and time-course RNA-seq data</article-title>. <source>Bioinformatics</source>. <year>2017</year>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bioinformatics/btx827</pub-id> .<?supplied-pmid 29280996?><pub-id pub-id-type="pmid">29280996</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009203.ref030">
      <label>30</label>
      <mixed-citation publication-type="journal"><name><surname>Wells</surname><given-names>J</given-names></name>, <name><surname>Graveel</surname><given-names>CR</given-names></name>, <name><surname>Bartley</surname><given-names>SM</given-names></name>, <name><surname>Madore</surname><given-names>SJ</given-names></name>, <name><surname>Farnham</surname><given-names>PJ</given-names></name>. <article-title>The identification of E2F1-specific target genes</article-title>. <source>Proc Natl Acad Sci U S A</source>. <year>2002</year>;<volume>99</volume>(<issue>6</issue>):<fpage>3890</fpage>–<lpage>5</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1073/pnas.062047499</pub-id> ; PubMed Central PMCID: PMC122619.<?supplied-pmid 11904439?><pub-id pub-id-type="pmid">11904439</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009203.ref031">
      <label>31</label>
      <mixed-citation publication-type="journal"><name><surname>Huang</surname><given-names>J</given-names></name>, <name><surname>Liu</surname><given-names>X</given-names></name>, <name><surname>Li</surname><given-names>D</given-names></name>, <name><surname>Shao</surname><given-names>Z</given-names></name>, <name><surname>Cao</surname><given-names>H</given-names></name>, <name><surname>Zhang</surname><given-names>Y</given-names></name>, <etal>et al</etal>. <article-title>Dynamic Control of Enhancer Repertoires Drives Lineage and Stage-Specific Transcription during Hematopoiesis</article-title>. <source>Dev Cell</source>. <year>2016</year>;<volume>36</volume>(<issue>1</issue>):<fpage>9</fpage>–<lpage>23</lpage>. Epub 2016/01/15. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.devcel.2015.12.014</pub-id> ; PubMed Central PMCID: PMC4714361.<?supplied-pmid 26766440?><pub-id pub-id-type="pmid">26766440</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009203.ref032">
      <label>32</label>
      <mixed-citation publication-type="journal"><name><surname>Guo</surname><given-names>Y</given-names></name>, <name><surname>Gifford</surname><given-names>DK</given-names></name>. <article-title>Modular combinatorial binding among human trans-acting factors reveals direct and indirect factor binding</article-title>. <source>BMC Genomics</source>. <year>2017</year>;<volume>18</volume>(<issue>1</issue>):<fpage>45</fpage>. Epub 2017/01/08. <comment>doi: </comment><pub-id pub-id-type="doi">10.1186/s12864-016-3434-3</pub-id> ; PubMed Central PMCID: PMC5219757.<?supplied-pmid 28061806?><pub-id pub-id-type="pmid">28061806</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009203.ref033">
      <label>33</label>
      <mixed-citation publication-type="journal"><name><surname>Xu</surname><given-names>X</given-names></name>, <name><surname>Bieda</surname><given-names>M</given-names></name>, <name><surname>Jin</surname><given-names>VX</given-names></name>, <name><surname>Rabinovich</surname><given-names>A</given-names></name>, <name><surname>Oberley</surname><given-names>MJ</given-names></name>, <name><surname>Green</surname><given-names>R</given-names></name>, <etal>et al</etal>. <article-title>A comprehensive ChIP-chip analysis of E2F1, E2F4, and E2F6 in normal and tumor cells reveals interchangeable roles of E2F family members</article-title>. <source>Genome Res</source>. <year>2007</year>;<volume>17</volume>(<issue>11</issue>):<fpage>1550</fpage>–<lpage>61</lpage>. Epub 2007/10/03. <comment>doi: </comment><pub-id pub-id-type="doi">10.1101/gr.6783507</pub-id> ; PubMed Central PMCID: PMC2045138.<?supplied-pmid 17908821?><pub-id pub-id-type="pmid">17908821</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009203.ref034">
      <label>34</label>
      <mixed-citation publication-type="journal"><name><surname>Pasini</surname><given-names>D</given-names></name>, <name><surname>Hansen</surname><given-names>KH</given-names></name>, <name><surname>Christensen</surname><given-names>J</given-names></name>, <name><surname>Agger</surname><given-names>K</given-names></name>, <name><surname>Cloos</surname><given-names>PA</given-names></name>, <name><surname>Helin</surname><given-names>K</given-names></name>. <article-title>Coordinated regulation of transcriptional repression by the RBP2 H3K4 demethylase and Polycomb-Repressive Complex 2</article-title>. <source>Genes Dev</source>. <year>2008</year>;<volume>22</volume>(<issue>10</issue>):<fpage>1345</fpage>–<lpage>55</lpage>. Epub 2008/05/17. <comment>doi: </comment><pub-id pub-id-type="doi">10.1101/gad.470008</pub-id> ; PubMed Central PMCID: PMC2377189.<?supplied-pmid 18483221?><pub-id pub-id-type="pmid">18483221</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009203.ref035">
      <label>35</label>
      <mixed-citation publication-type="journal"><name><surname>Rhie</surname><given-names>SK</given-names></name>, <name><surname>Yao</surname><given-names>L</given-names></name>, <name><surname>Luo</surname><given-names>Z</given-names></name>, <name><surname>Witt</surname><given-names>H</given-names></name>, <name><surname>Schreiner</surname><given-names>S</given-names></name>, <name><surname>Guo</surname><given-names>Y</given-names></name>, <etal>et al</etal>. <article-title>ZFX acts as a transcriptional activator in multiple types of human tumors by binding downstream of transcription start sites at the majority of CpG island promoters</article-title>. <source>Genome Res</source>. <year>2018</year>. Epub 2018/02/13. <comment>doi: </comment><pub-id pub-id-type="doi">10.1101/gr.228809.117</pub-id> ; PubMed Central PMCID: PMC5848610.<?supplied-pmid 29429977?><pub-id pub-id-type="pmid">29429977</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009203.ref036">
      <label>36</label>
      <mixed-citation publication-type="journal"><name><surname>Lieberman-Aiden</surname><given-names>E</given-names></name>, <name><surname>van Berkum</surname><given-names>NL</given-names></name>, <name><surname>Williams</surname><given-names>L</given-names></name>, <name><surname>Imakaev</surname><given-names>M</given-names></name>, <name><surname>Ragoczy</surname><given-names>T</given-names></name>, <name><surname>Telling</surname><given-names>A</given-names></name>, <etal>et al</etal>. <article-title>Comprehensive mapping of long-range interactions reveals folding principles of the human genome</article-title>. <source>Science</source>. <year>2009</year>;<volume>326</volume>(<issue>5950</issue>):<fpage>289</fpage>–<lpage>93</lpage>. Epub 2009/10/10. <comment>doi: </comment><pub-id pub-id-type="doi">10.1126/science.1181369</pub-id> ; PubMed Central PMCID: PMC2858594.<?supplied-pmid 19815776?><pub-id pub-id-type="pmid">19815776</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009203.ref037">
      <label>37</label>
      <mixed-citation publication-type="journal"><name><surname>Fullwood</surname><given-names>MJ</given-names></name>, <name><surname>Liu</surname><given-names>MH</given-names></name>, <name><surname>Pan</surname><given-names>YF</given-names></name>, <name><surname>Liu</surname><given-names>J</given-names></name>, <name><surname>Xu</surname><given-names>H</given-names></name>, <name><surname>Mohamed</surname><given-names>YB</given-names></name>, <etal>et al</etal>. <article-title>An oestrogen-receptor-alpha-bound human chromatin interactome</article-title>. <source>Nature</source>. <year>2009</year>;<volume>462</volume>(<issue>7269</issue>):<fpage>58</fpage>–<lpage>64</lpage>. Epub 2009/11/06. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/nature08497</pub-id> ; PubMed Central PMCID: PMC2774924.<?supplied-pmid 19890323?><pub-id pub-id-type="pmid">19890323</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009203.ref038">
      <label>38</label>
      <mixed-citation publication-type="journal"><name><surname>Wang</surname><given-names>W</given-names></name>, <name><surname>Cherry</surname><given-names>JM</given-names></name>, <name><surname>Nochomovitz</surname><given-names>Y</given-names></name>, <name><surname>Jolly</surname><given-names>E</given-names></name>, <name><surname>Botstein</surname><given-names>D</given-names></name>, <name><surname>Li</surname><given-names>H</given-names></name>. <article-title>Inference of combinatorial regulation in yeast transcriptional networks: a case study of sporulation</article-title>. <source>Proc Natl Acad Sci U S A</source>. <year>2005</year>;<volume>102</volume>(<issue>6</issue>):<fpage>1998</fpage>–<lpage>2003</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1073/pnas.0405537102</pub-id> ; PubMed Central PMCID: PMC548531.<?supplied-pmid 15684073?><pub-id pub-id-type="pmid">15684073</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009203.ref039">
      <label>39</label>
      <mixed-citation publication-type="journal"><name><surname>Wang</surname><given-names>Y</given-names></name>, <name><surname>Zhang</surname><given-names>XS</given-names></name>, <name><surname>Xia</surname><given-names>Y</given-names></name>. <article-title>Predicting eukaryotic transcriptional cooperativity by Bayesian network integration of genome-wide data</article-title>. <source>Nucleic Acids Res</source>. <year>2009</year>;<volume>37</volume>(<issue>18</issue>):<fpage>5943</fpage>–<lpage>58</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/nar/gkp625</pub-id> ; PubMed Central PMCID: PMC2764433.<?supplied-pmid 19661283?><pub-id pub-id-type="pmid">19661283</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009203.ref040">
      <label>40</label>
      <mixed-citation publication-type="journal"><name><surname>Huang da</surname><given-names>W</given-names></name>, <name><surname>Sherman</surname><given-names>BT</given-names></name>, <name><surname>Lempicki</surname><given-names>RA</given-names></name>. <article-title>Systematic and integrative analysis of large gene lists using DAVID bioinformatics resources</article-title>. <source>Nat Protoc</source>. <year>2009</year>;<volume>4</volume>(<issue>1</issue>):<fpage>44</fpage>–<lpage>57</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/nprot.2008.211</pub-id> .<?supplied-pmid 19131956?><pub-id pub-id-type="pmid">19131956</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009203.ref041">
      <label>41</label>
      <mixed-citation publication-type="journal"><name><surname>Ouyang</surname><given-names>Z</given-names></name>, <name><surname>Zhou</surname><given-names>Q</given-names></name>, <name><surname>Wong</surname><given-names>WH</given-names></name>. <article-title>ChIP-Seq of transcription factors predicts absolute and differential gene expression in embryonic stem cells</article-title>. <source>Proc Natl Acad Sci U S A</source>. <year>2009</year>;<volume>106</volume>(<issue>51</issue>):<fpage>21521</fpage>–<lpage>6</lpage>. Epub 2009/12/10. <comment>doi: </comment><pub-id pub-id-type="doi">10.1073/pnas.0904863106</pub-id> ; PubMed Central PMCID: PMC2789751.<?supplied-pmid 19995984?><pub-id pub-id-type="pmid">19995984</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1009203.ref042">
      <label>42</label>
      <mixed-citation publication-type="book"><name><surname>Hastie</surname><given-names>T</given-names></name>, <name><surname>Tibshirani</surname><given-names>R</given-names></name>, <name><surname>Friedman</surname><given-names>JH</given-names></name>. <source>The elements of statistical learning: data mining, inference, and prediction</source>. <edition designator="2">2nd ed</edition>. <publisher-loc>New York, NY</publisher-loc>: <publisher-name>Springer</publisher-name>; <year>2009</year>. <volume>xxii</volume>, 745 p. p.</mixed-citation>
    </ref>
  </ref-list>
</back>
