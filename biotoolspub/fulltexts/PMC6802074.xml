<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD with OASIS Tables with MathML3 v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-archive-oasis-article1-mathml3.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jpoasis-nisons2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Ecol Evol</journal-id>
    <journal-id journal-id-type="iso-abbrev">Ecol Evol</journal-id>
    <journal-id journal-id-type="doi">10.1002/(ISSN)2045-7758</journal-id>
    <journal-id journal-id-type="publisher-id">ECE3</journal-id>
    <journal-title-group>
      <journal-title>Ecology and Evolution</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2045-7758</issn>
    <publisher>
      <publisher-name>John Wiley and Sons Inc.</publisher-name>
      <publisher-loc>Hoboken</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6802074</article-id>
    <article-id pub-id-type="doi">10.1002/ece3.5448</article-id>
    <article-id pub-id-type="publisher-id">ECE35448</article-id>
    <article-categories>
      <subj-group subj-group-type="overline">
        <subject>Original Research</subject>
      </subj-group>
      <subj-group subj-group-type="heading">
        <subject>Original Research</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Analysis of interval‐grouped data in weed science: The <monospace>binnednp</monospace> Rcpp package</article-title>
      <alt-title alt-title-type="left-running-head">BARREIRO‐URES et al.</alt-title>
    </title-group>
    <contrib-group>
      <contrib id="ece35448-cr-0001" contrib-type="author">
        <name>
          <surname>Barreiro‐Ures</surname>
          <given-names>Daniel</given-names>
        </name>
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-4930-3603</contrib-id>
        <xref ref-type="aff" rid="ece35448-aff-0001">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib id="ece35448-cr-0002" contrib-type="author">
        <name>
          <surname>Francisco‐Fernández</surname>
          <given-names>Mario</given-names>
        </name>
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-9201-5423</contrib-id>
        <xref ref-type="aff" rid="ece35448-aff-0001">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib id="ece35448-cr-0003" contrib-type="author">
        <name>
          <surname>Cao</surname>
          <given-names>Ricardo</given-names>
        </name>
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-8304-687X</contrib-id>
        <xref ref-type="aff" rid="ece35448-aff-0001">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib id="ece35448-cr-0004" contrib-type="author">
        <name>
          <surname>Fraguela</surname>
          <given-names>Basilio B.</given-names>
        </name>
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-3438-5960</contrib-id>
        <xref ref-type="aff" rid="ece35448-aff-0002">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib id="ece35448-cr-0005" contrib-type="author">
        <name>
          <surname>Doallo</surname>
          <given-names>Ramón</given-names>
        </name>
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-6011-3387</contrib-id>
        <xref ref-type="aff" rid="ece35448-aff-0002">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib id="ece35448-cr-0006" contrib-type="author" corresp="yes">
        <name>
          <surname>González‐Andújar</surname>
          <given-names>José Luis</given-names>
        </name>
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-2356-4098</contrib-id>
        <xref ref-type="aff" rid="ece35448-aff-0003">
          <sup>3</sup>
        </xref>
        <address>
          <email>andujar@ias.csic.es</email>
        </address>
      </contrib>
      <contrib id="ece35448-cr-0007" contrib-type="author">
        <name>
          <surname>Reyes</surname>
          <given-names>Miguel</given-names>
        </name>
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-1460-1814</contrib-id>
        <xref ref-type="aff" rid="ece35448-aff-0004">
          <sup>4</sup>
        </xref>
      </contrib>
    </contrib-group>
    <aff id="ece35448-aff-0001">
      <label>
        <sup>1</sup>
      </label>
      <named-content content-type="organisation-division">Research Group MODES, CITIC, Departamento de Matemáticas, Facultade de Informática</named-content>
      <institution>Universidade da Coruña</institution>
      <city>A Coruña</city>
      <country country="ES">Spain</country>
    </aff>
    <aff id="ece35448-aff-0002">
      <label>
        <sup>2</sup>
      </label>
      <named-content content-type="organisation-division">Research Group GAC, CITIC, Departamento de Ingeniería de Computadores, Facultade de Informática</named-content>
      <institution>Universidade da Coruña</institution>
      <city>A Coruña</city>
      <country country="ES">Spain</country>
    </aff>
    <aff id="ece35448-aff-0003">
      <label>
        <sup>3</sup>
      </label>
      <institution>Instituto de Agricultura Sostenible (CSIC)</institution>
      <city>Córdoba</city>
      <country country="ES">Spain</country>
    </aff>
    <aff id="ece35448-aff-0004">
      <label>
        <sup>4</sup>
      </label>
      <named-content content-type="organisation-division">Departamento de Actuaría, Física y Matemáticas</named-content>
      <institution>Universidad de las Américas‐Puebla</institution>
      <city>Puebla</city>
      <country country="MX">México</country>
    </aff>
    <author-notes>
      <corresp id="correspondenceTo"><label>*</label><bold>Correspondence</bold><break/>
José Luis González‐Andújar, Instituto de Agricultura Sostenible (CSIC), Apartado 4084, Córdoba 14080, Spain.<break/>
Email: <email>andujar@ias.csic.es</email><break/></corresp>
    </author-notes>
    <pub-date pub-type="epub">
      <day>13</day>
      <month>9</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="collection">
      <month>10</month>
      <year>2019</year>
    </pub-date>
    <volume>9</volume>
    <issue>19</issue>
    <issue-id pub-id-type="doi">10.1002/ece3.v9.19</issue-id>
    <fpage>10903</fpage>
    <lpage>10915</lpage>
    <history>
      <date date-type="received">
        <day>17</day>
        <month>1</month>
        <year>2019</year>
      </date>
      <date date-type="rev-recd">
        <day>18</day>
        <month>6</month>
        <year>2019</year>
      </date>
      <date date-type="accepted">
        <day>20</day>
        <month>6</month>
        <year>2019</year>
      </date>
    </history>
    <permissions>
      <!--<copyright-statement content-type="issue-copyright"> &#x000a9; 2019 Published by John Wiley & Sons Ltd. <copyright-statement>-->
      <copyright-statement content-type="article-copyright">© 2019 The Authors. <italic>Ecology and Evolution</italic> published by John Wiley &amp; Sons Ltd.</copyright-statement>
      <license license-type="creativeCommonsBy">
        <license-p>This is an open access article under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link> License, which permits use, distribution and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:href="file:ECE3-9-10903.pdf"/>
    <abstract id="ece35448-abs-0001">
      <title>Abstract</title>
      <p>
        <list list-type="order" id="ece35448-list-0001">
          <list-item>
            <p>Weed scientists are usually interested in the study of the distribution and density functions of the random variable that relates weed emergence with environmental indices like the hydrothermal time (HTT). However, in many situations, experimental data are presented in a grouped way and, therefore, the standard nonparametric kernel estimators cannot be computed.</p>
          </list-item>
          <list-item>
            <p>Kernel estimators for the density and distribution functions for interval‐grouped data, as well as bootstrap confidence bands for these functions, have been proposed and implemented in the <monospace>binnednp</monospace> package. Analysis with different treatments can also be performed using a bootstrap approach and a Cramér‐von Mises type distance. Several bandwidth selection procedures were also implemented. This package also allows to estimate different emergence indices that measure the shape of the data distribution. The values of these indices are useful for the selection of the soil depth at which HTT should be measured which, in turn, would maximize the predictive power of the proposed methods.</p>
          </list-item>
          <list-item>
            <p>This paper presents the functions of the package and provides an example using an emergence data set of <italic>Avena sterilis</italic> (wild oat).</p>
          </list-item>
          <list-item>
            <p>The <monospace>binnednp</monospace> package provides investigators with a unique set of tools allowing the weed science research community to analyze interval‐grouped data.</p>
          </list-item>
        </list>
      </p>
    </abstract>
    <abstract abstract-type="graphical" id="ece35448-abs-0002">
      <p>An R package, called <monospace>binnednp</monospace>, implementing nonparametric methods for interval‐grouped data is presented. In particular, weed emergence data are usually presented in a grouped way and can be analyzed using this package. An example of emergence data set of <italic>Avena sterilis</italic> (wild oat) is also included in the paper.<boxed-text position="anchor" content-type="graphic" id="ece35448-blkfxd-0001" orientation="portrait"><graphic xlink:href="ECE3-9-10903-g005.jpg" position="anchor" id="nlm-graphic-1" orientation="portrait"/></boxed-text>
</p>
    </abstract>
    <kwd-group kwd-group-type="author-generated">
      <kwd id="ece35448-kwd-0001">bandwidth selection</kwd>
      <kwd id="ece35448-kwd-0002">hydrothermal time</kwd>
      <kwd id="ece35448-kwd-0003">nonparametric kernel estimation</kwd>
      <kwd id="ece35448-kwd-0004">weed emergence model</kwd>
    </kwd-group>
    <funding-group>
      <award-group id="funding-0001">
        <funding-source>
          <institution-wrap>
            <institution>Ministerio de Economía y Competitividad </institution>
            <institution-id institution-id-type="open-funder-registry">10.13039/501100003329</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id> AGL2015-64130-R</award-id>
        <award-id> MTM2014-52876-R</award-id>
        <award-id> MTM2017-82724-R</award-id>
        <award-id>AGL2012-33736</award-id>
      </award-group>
      <award-group id="funding-0002">
        <funding-source>
          <institution-wrap>
            <institution>Consellería de Cultura, Educación e Ordenación Universitaria, Xunta de Galicia </institution>
            <institution-id institution-id-type="open-funder-registry">10.13039/501100008425</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>ED431C-2016-015</award-id>
        <award-id>ED431G/01</award-id>
      </award-group>
      <award-group id="funding-0003">
        <funding-source>
          <institution-wrap>
            <institution>European Regional Development Fund </institution>
            <institution-id institution-id-type="open-funder-registry">10.13039/501100008530</institution-id>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <counts>
      <fig-count count="3"/>
      <table-count count="1"/>
      <page-count count="13"/>
      <word-count count="10001"/>
    </counts>
    <custom-meta-group>
      <custom-meta>
        <meta-name>source-schema-version-number</meta-name>
        <meta-value>2.0</meta-value>
      </custom-meta>
      <custom-meta>
        <meta-name>cover-date</meta-name>
        <meta-value>October 2019</meta-value>
      </custom-meta>
      <custom-meta>
        <meta-name>details-of-publishers-convertor</meta-name>
        <meta-value>Converter:WILEY_ML3GV2_TO_JATSPMC version:5.7.0 mode:remove_FC converted:21.10.2019</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
  <notes>
    <p content-type="self-citation">
      <mixed-citation publication-type="journal" id="ece35448-cit-1001"><string-name><surname>Barreiro‐Ures</surname><given-names>D</given-names></string-name>, <string-name><surname>Francisco‐Fernández</surname><given-names>M</given-names></string-name>, <string-name><surname>Cao</surname><given-names>R</given-names></string-name>, et al. <article-title>Analysis of interval‐grouped data in weed science: The <monospace>binnednp</monospace> Rcpp package</article-title>. <source xml:lang="en">Ecol Evol</source>. <year>2019</year>;<volume>9</volume>:<fpage>10903</fpage>–<lpage>10915</lpage>. <pub-id pub-id-type="doi">10.1002/ece3.5448</pub-id></mixed-citation>
    </p>
  </notes>
</front>
<body id="ece35448-body-0001">
  <sec id="ece35448-sec-0001">
    <label>1</label>
    <title>INTRODUCTION</title>
    <p>The knowledge of the factors affecting the emergence patterns of weeds is not only interesting from a plant ecology perspective, but also in applied research, where the emergence of weeds is an important phase of the population dynamics (González‐Andújar, <xref rid="ece35448-bib-0010" ref-type="ref">2008</xref>). This critical phase has important implications, either because of its effects on the determination of competition with the crop or because of the type and timing of the control tactics that must be used (Forcella, Benech‐Arnold, Sánchez, &amp; Ghersa, <xref rid="ece35448-bib-0009" ref-type="ref">2000</xref>). Temperature and water potential have been identified as essential factors that control weed emergence (Forcella et al., <xref rid="ece35448-bib-0009" ref-type="ref">2000</xref>). Some indices (Hunter, Glasbey, &amp; Naylor, <xref rid="ece35448-bib-0015" ref-type="ref">1984</xref>; Naylor, <xref rid="ece35448-bib-0018" ref-type="ref">1981</xref>) and modelling techniques (González‐Andújar, Chantre, Morvillo, Blanco, &amp; Forcella, <xref rid="ece35448-bib-0011" ref-type="ref">2016</xref>) are often used to predict weed emergence. In this context, thermal time (TT) models and hydrothermal time (HTT) models are useful tools to describe weed emergence (Bradford, <xref rid="ece35448-bib-0003" ref-type="ref">2002</xref>; Grundy, <xref rid="ece35448-bib-0013" ref-type="ref">2003</xref>; Zambrano‐Navea, Bastida, &amp; González‐Andújar, <xref rid="ece35448-bib-0027" ref-type="ref">2013</xref>). Parametric regression models for emergence are usually employed in this framework. They may offer the simplicity and flexibility required for practical decision support (Grundy, <xref rid="ece35448-bib-0013" ref-type="ref">2003</xref>). However, due to the limitations of this approach, different modeling approaches have been proposed, including techniques that account for censoring (Onofri, Gresta, &amp; Tei, <xref rid="ece35448-bib-0019" ref-type="ref">2010</xref>; Onofri, Mesgaran, Tei, &amp; Cousens, <xref rid="ece35448-bib-0020" ref-type="ref">2011</xref>; Onofri, Piepho, &amp; Kozak, <xref rid="ece35448-bib-0021" ref-type="ref">2019</xref>), genetic algorithms (Blanco et al., <xref rid="ece35448-bib-0002" ref-type="ref">2014</xref>; Haj Seyed‐Hadi &amp; Gonzalez‐Andujar, <xref rid="ece35448-bib-0014" ref-type="ref">2009</xref>), and artificial neural networks (Chantre et al., <xref rid="ece35448-bib-0006" ref-type="ref">2012</xref>). Alternatively, the problem of studying the relation between HTT and weed emergence has been dealt with through nonparametric estimation of the distribution and density functions of cumulative HTT (CHTT) at emergence (Cao, Francisco‐Fernández, Anand, Bastida, &amp; González‐Andújar, <xref rid="ece35448-bib-0005" ref-type="ref">2013</xref>; Reyes, Francisco‐Fernández, &amp; Cao, <xref rid="ece35448-bib-0024" ref-type="ref">2016</xref>). These nonparametric methods have been recently proven to outperform the usual regression approaches in terms of prediction error (González‐Andújar, Francisco‐Fernández, et al., <xref rid="ece35448-bib-0012" ref-type="ref">2016</xref>).</p>
    <p>In addition, when gathering experimental data, a different problem arises due to the fact that seedlings are generally buried at different depths and, therefore, the best depth at which HTT should be measured has to be selected. For this task, emergence indices have been defined and nonparametric estimators for them have been constructed (Cao, Francisco‐Fernández, Anand, Bastida, &amp; González‐Andújar, <xref rid="ece35448-bib-0004" ref-type="ref">2011</xref>).</p>
    <p>The techniques required for both, the nonparametric estimation of the density and distribution functions and the emergence indices, have been implemented in the <monospace>binnednp</monospace> Rcpp package (Barreiro et al., <xref rid="ece35448-bib-0001" ref-type="ref">2019</xref>).</p>
  </sec>
  <sec sec-type="methods" id="ece35448-sec-0002">
    <label>2</label>
    <title>METHODS</title>
    <sec id="ece35448-sec-0003">
      <label>2.1</label>
      <title>Density and distribution estimation</title>
      <p>Let us suppose that modeling the emergence of a certain weed seedling, based on CHTT at emergence, is being investigated. Denote by <italic>n</italic> the number of seedlings that have emerged at the end of the monitoring process, and by <italic>X</italic> the random variable measuring the CHTT at emergence (with density function <italic>f</italic> and distribution function <italic>F</italic>). Since the inspections to count the number of emerged seedlings are performed at a limited number of instants, say <italic>k</italic>, the values <italic>X</italic>
<sub>1</sub>, <italic>X</italic>
<sub>2</sub>, …, <italic>X<sub>n</sub></italic>, measuring the CHTT at emergence of every single seedling, cannot be observed. However, what is observed is the total number of seedlings that have emerged in the intervals between consecutive inspection times, <italic>n</italic>
<sub>1</sub>, <italic>n</italic>
<sub>2</sub>, …, <italic>n<sub>k</sub></italic>, or the corresponding sample proportions, <italic>w</italic>
<sub>1</sub>, <italic>w</italic>
<sub>2</sub>, …, <italic>w</italic>
<sub>k</sub>, with <italic>w<sub>i</sub></italic> = <italic>n<sub>i</sub></italic>/<italic>n</italic>. In this sense, this type of data is called interval‐grouped data.</p>
      <p>In this interval‐group framework, if the interest is to estimate the density function <italic>f</italic>, the standard kernel density estimator (Parzen, <xref rid="ece35448-bib-0022" ref-type="ref">1962</xref>; Rosenblatt, <xref rid="ece35448-bib-0025" ref-type="ref">1956</xref>),<disp-formula id="ece35448-disp-0001"><mml:math id="nlm-math-1"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>h</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi mathvariant="italic">nh</mml:mi></mml:mfrac><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:mrow><mml:mi>K</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mstyle displaystyle="false" scriptlevel="0"><mml:mfrac><mml:mrow><mml:mi>x</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mi>h</mml:mi></mml:mfrac></mml:mstyle><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>cannot be computed. An appropriate version of this estimator for interval‐grouped data has been proposed in Cao et al. (<xref rid="ece35448-bib-0004" ref-type="ref">2011</xref>),<disp-formula id="ece35448-disp-0002"><label>(1)</label><mml:math id="nlm-math-2"><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>h</mml:mi><mml:mi>g</mml:mi></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>h</mml:mi></mml:mfrac><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>k</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mi>K</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mstyle displaystyle="false" scriptlevel="0"><mml:mfrac><mml:mrow><mml:mi>x</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mi>h</mml:mi></mml:mfrac></mml:mstyle><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <italic>t<sub>i</sub></italic>, <italic>i </italic>= 1, …, <italic>k</italic>, are the central values between every pair of consecutive observed CHTT. In Equation (<xref rid="ece35448-disp-0002" ref-type="disp-formula">1</xref>), the function <italic>K</italic>(·) is the kernel function, and <italic>h</italic> is the bandwidth or smoothing parameter, controlling the amount of smoothing.</p>
      <p>Similarly, to estimate the distribution function <italic>F</italic>, a kernel distribution estimator adapted for interval‐grouped data, derived from (<xref rid="ece35448-disp-0002" ref-type="disp-formula">1</xref>), was proposed in Cao et al. (<xref rid="ece35448-bib-0005" ref-type="ref">2013</xref>),<disp-formula id="ece35448-disp-0003"><label>(2)</label><mml:math id="nlm-math-3"><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>F</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>h</mml:mi><mml:mi>g</mml:mi></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>k</mml:mi></mml:munderover><mml:msub><mml:mi>w</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mi mathvariant="double-struck">K</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mfrac><mml:mrow><mml:mi>x</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mi>h</mml:mi></mml:mfrac></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <mml:math id="nlm-math-4"><mml:mrow><mml:mi mathvariant="double-struck">K</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>u</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mi>∞</mml:mi></mml:mrow><mml:mi>u</mml:mi></mml:msubsup><mml:mi>K</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mi>t</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:math>
</p>
      <p>It has been proven that the selection of the kernel function, <italic>K</italic>(·), is of secondary importance in terms of efficiency. However, the selection of the bandwidth, <italic>h</italic>, is crucial in the behavior of estimators (<xref rid="ece35448-disp-0002" ref-type="disp-formula">1</xref>) and (<xref rid="ece35448-disp-0003" ref-type="disp-formula">2</xref>).</p>
      <p>As pointed out in the Introduction, nonparametric estimators (<xref rid="ece35448-disp-0002" ref-type="disp-formula">1</xref>) and (<xref rid="ece35448-disp-0003" ref-type="disp-formula">2</xref>) are novel approaches to model weed emergence, presenting some advantages over the parametric regression techniques traditionally used in this framework (Cao et al., <xref rid="ece35448-bib-0005" ref-type="ref">2013</xref>; González‐Andújar, Francisco‐Fernández, et al., <xref rid="ece35448-bib-0012" ref-type="ref">2016</xref>). These estimators, jointly with two types of bandwidth selectors, plug‐in and bootstrap, have been implemented in the <monospace>binnednp</monospace> package. Moreover, a new and successful method to select the pilot bandwidth for the bootstrap bandwidths has been proposed and also implemented. Plug‐in bandwidth selectors estimate the unknown terms in the expression of the asymptotically optimal bandwidth, whereas bootstrap bandwidths try to directly estimate the optimal bandwidth by mimicking the sampling process through resampling.</p>
      <p>The <monospace>binnednp</monospace> package also allows to compute bootstrap confidence bands for the density and distribution functions that can be used to assess the uncertainty of the corresponding estimates. Additionally, the <monospace>binnednp</monospace> package includes a function to evaluate the effect of a specific factor on weed emergence, for example, when considering different treatments. This procedure is based on a bootstrap approach properly designed to address the multiple testing problem (Westfall &amp; Young, <xref rid="ece35448-bib-0026" ref-type="ref">1993</xref>). The idea of this approach is the following. (a) Split the data set into subsets according to the different levels of the factor under study. (b) Compute the nonparametric estimator of the emergence curve considering the pooled sample and, for each level, the nonparametric estimators of the emergence curves using the corresponding data subsets. (c) A reasonable statistic, <italic>D</italic>, to test the null hypothesis that the factor effect is not significant is defined based on a Cramér‐von Mises distance between the nonparametric estimator with the pooled sample and the nonparametric estimators in the different groups. This distance is inspired in the generalization of the Cramér‐von Mises statistic to the problem of comparing <italic>k</italic> independent samples, proposed by Kiefer (<xref rid="ece35448-bib-0016" ref-type="ref">1959</xref>). (d) To calibrate the test, a bootstrap procedure is used. For this, under the null hypothesis, <italic>B</italic> resamples for each one of the factor levels are generated, and the corresponding <italic>B</italic> bootstrap statistics, <mml:math id="nlm-math-5"><mml:msubsup><mml:mi>D</mml:mi><mml:mi>i</mml:mi><mml:mtext>∗</mml:mtext></mml:msubsup></mml:math>, <italic>i</italic> = 1, …, <italic>B</italic>, are computed. (e) Finally, given a significance level <italic>α</italic>, the null hypothesis is rejected if <italic>D</italic> is larger than the 1 − <italic>α</italic> quantile of {<mml:math id="nlm-math-6"><mml:msubsup><mml:mi>D</mml:mi><mml:mn>1</mml:mn><mml:mtext>∗</mml:mtext></mml:msubsup></mml:math>, …, <mml:math id="nlm-math-7"><mml:msubsup><mml:mi>D</mml:mi><mml:mi>B</mml:mi><mml:mtext>∗</mml:mtext></mml:msubsup></mml:math>}. The <italic>p</italic>‐value of this test can also be approximated by Monte Carlo. A more detailed description of this algorithm is given in Appendix <xref rid="ece35448-app-0003" ref-type="app">3</xref>.</p>
      <p>Both bandwidth selection methods, plug‐in and bootstrap, for the nonparametric estimators (<xref rid="ece35448-disp-0002" ref-type="disp-formula">1</xref>) and (<xref rid="ece35448-disp-0003" ref-type="disp-formula">2</xref>) implemented in the corresponding functions of the <monospace>binnednp</monospace> package are described in Appendix <xref rid="ece35448-app-0001" ref-type="app">1</xref>. Moreover, Appendix <xref rid="ece35448-app-0002" ref-type="app">2</xref> contains the steps of the bootstrap algorithm used in the <monospace>binnednp</monospace> package to compute confidence bands for the distribution function. Finally, Appendix <xref rid="ece35448-app-0003" ref-type="app">3</xref> describes the statistical procedure implemented in the <monospace>binnednp</monospace> package to test whether a factor can be statistically significant.</p>
    </sec>
    <sec id="ece35448-sec-0004">
      <label>2.2</label>
      <title>Emergence indices estimation</title>
      <p>In this context, another interesting problem is that of finding the best soil depth at which to measure the HTT. For this, moment‐based indices and probability density‐based indices were proposed in Cao et al. (<xref rid="ece35448-bib-0004" ref-type="ref">2011</xref>), and estimates of them are also implemented in the <monospace>binnednp</monospace> package. Some of these index estimators are based on nonparametric methods and require the selection of a bandwidth. Different techniques to automatically obtain approximately optimal bandwidths have also been included in the package.</p>
      <p>In order to maximize the predictive power of the weed emergence models considered, one should choose the depth such that the density function of <italic>X</italic>, measuring the CHTT at emergence, is as flatter as possible (or the distribution of <italic>X</italic> has as much spread as possible). Taking this into account, two indices based on the moments of <italic>X</italic>, the coefficient of variation and the kurtosis of <italic>X</italic>, have been considered:<disp-formula id="ece35448-disp-0004"><mml:math id="nlm-math-8"><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mi>σ</mml:mi><mml:mi>μ</mml:mi></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
<disp-formula id="ece35448-disp-0005"><mml:math id="nlm-math-9"><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi>m</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:msup><mml:mi>σ</mml:mi><mml:mn>4</mml:mn></mml:msup></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <mml:math id="nlm-math-10"><mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="double-struck">E</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>X</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math>, <mml:math id="nlm-math-11"><mml:mrow><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>=</mml:mo><mml:mi mathvariant="double-struck">V</mml:mi><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>X</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math>, and <mml:math id="nlm-math-12"><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mi mathvariant="double-struck">E</mml:mi><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>X</mml:mi><mml:mo>-</mml:mo><mml:mi>μ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>4</mml:mn></mml:msup><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math> are the mean, the variance, and the fourth central moment of <italic>X</italic>, respectively. Large values for <italic>I</italic>
<sub>1</sub> and small values for <italic>I</italic>
<sub>2</sub> would be associated with a highly spread and light‐tailed distribution and, therefore, are desirable for good weed emergence prediction properties. Indices based on the density of <italic>X</italic>, namely.<disp-formula id="ece35448-disp-0006"><mml:math id="nlm-math-13"><mml:mrow><mml:msub><mml:mi>J</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mn>3</mml:mn></mml:msup><mml:mo>∫</mml:mo><mml:msup><mml:mi>f</mml:mi><mml:mi>′</mml:mi></mml:msup><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mi mathvariant="normal">d</mml:mi><mml:mi>x</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
<disp-formula id="ece35448-disp-0007"><mml:math id="nlm-math-14"><mml:mrow><mml:msub><mml:mi>J</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mn>5</mml:mn></mml:msup><mml:mo>∫</mml:mo><mml:msup><mml:mi>f</mml:mi><mml:mo>″</mml:mo></mml:msup><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mi mathvariant="normal">d</mml:mi><mml:mi>x</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>have been also considered.</p>
      <p>The indices <italic>J</italic>
<sub>1</sub> and <italic>J</italic>
<sub>2</sub> measure the curvature of the distribution and density functions of <italic>X</italic>, respectively. Therefore, small values for both <italic>J</italic>
<sub>1</sub> and <italic>J</italic>
<sub>2</sub> are desirable.</p>
    </sec>
  </sec>
  <sec id="ece35448-sec-0005">
    <label>3</label>
    <title>PACKAGE ARCHITECTURE</title>
    <p><monospace>binnednp</monospace> is an R package (R Development Core Team, <xref rid="ece35448-bib-0023" ref-type="ref">2019</xref>) designed for nonparametric estimation of both density and distribution functions of interval‐grouped data. Although <monospace>binnednp</monospace> can be used for the analysis of any variable presented as grouped in intervals, the package and its structure were designed for its use by the weed science research community.</p>
    <p>The package was developed using the Rcpp API (Eddelbuettel &amp; François, <xref rid="ece35448-bib-0008" ref-type="ref">2011</xref>) which allows the integration of C++ code in R. The parts of the package code relative to bandwidth selection are quite consuming in terms of computation time, especially those that make use of bootstrapping. For this reason, writing portions of the package in C++ was crucial since it allows obtaining numerical results in a very short time. Moreover, the runtime of some of the functions can be further reduced (up to 60%) by means of parallelism with sockets. This was observed in a simulation study (not shown here for the sake of brevity) performed to analyze the CPU time of the functions of the package, when the sample size increases, and the effect of using (or not) parallel computing.</p>
    <p>Regarding the structure of the package, it consists of the four functions described below (Sections <xref rid="ece35448-sec-0006" ref-type="sec">3.1</xref>, <xref rid="ece35448-sec-0007" ref-type="sec">3.2</xref>, <xref rid="ece35448-sec-0008" ref-type="sec">3.3</xref>–<xref rid="ece35448-sec-0009" ref-type="sec">3.4</xref>). A more complete description and additional examples can be found in the reference manual of the package (Barreiro et al., <xref rid="ece35448-bib-0001" ref-type="ref">2019</xref>). Next, the following notation is considered in the arguments of those functions:
<list list-type="order" id="ece35448-list-0002"><list-item><p><monospace>n</monospace>: Number of seedlings that have emerged at the end of the experiment. In general, it is the size of the unknown complete sample.</p></list-item><list-item><p><monospace>y</monospace>: Vector with the measurements of the CHTT at each inspection time. In general, this vector contains the endpoints of the intervals where the data are grouped.</p></list-item><list-item><p><monospace>w (ni)</monospace>: Vector with the proportion (number) of seedlings that have emerged between each pair of consecutive CHTT. In general, each element of this vector indicates the proportion (number) of observations lying within each of the intervals where the data are grouped.</p></list-item></list>
</p>
    <sec id="ece35448-sec-0006">
      <label>3.1</label>
      <title>Density estimation</title>
      <p>
        <code xml:space="preserve" position="float" orientation="portrait">
<monospace>bw.dens.binned (n, y, w, ni, gboot, pilot.type = 3, hn = 100,
plugin.type = "N", confband = FALSE, alpha = 0.05, B = 1000,
plot = TRUE, print = TRUE, model, parallel = FALSE, pars = new.env())

</monospace></code>
      </p>
      <p>This function computes the plug‐in and bootstrap bandwidths for the density estimator (<xref rid="ece35448-disp-0002" ref-type="disp-formula">1</xref>). Regarding the plug‐in bandwidth, with the parameter plugin.type, the iterative process to estimate the bandwidth can be chosen. As for the bootstrap bandwidth, the parameter pilot.type allows the user to select the method to automatically compute the pilot bandwidth needed for the calculation of the bootstrap bandwidth, whereas the parameter gboot allows to manually select that pilot bandwidth. In most situations, it is recommended to employ the default values of these parameters. Additionally, the estimation process can be further personalized using parameters like hn, that determines the number of iterations done during the optimization stage, or B, that indicates the number of bootstrap replicates used for the construction of confidence bands, in case that confband = TRUE. Furthermore, if parallel = TRUE, confidence bands are estimated using parallel computing. Finally, for the sake of comparison with (<xref rid="ece35448-disp-0002" ref-type="disp-formula">1</xref>), the parameter model allows to fit different parametric families of distributions to the grouped sample. The parameters of these distributions are estimated by maximum likelihood.</p>
    </sec>
    <sec id="ece35448-sec-0007">
      <label>3.2</label>
      <title>Distribution estimation</title>
      <p>
        <code xml:space="preserve" position="float" orientation="portrait">
<monospace>bw.dist.binned(n, y, w, ni, gplugin, type = "N", confband = FALSE,
B = 1000, alpha = 0.05, plot = TRUE, print = TRUE, model,
parallel = FALSE, pars = new.env())

</monospace></code>
      </p>
      <p>This function computes the plug‐in bandwidth for the distribution estimator (<xref rid="ece35448-disp-0003" ref-type="disp-formula">2</xref>). The parameter type allows the user to choose the iterative process to be used to estimate the bandwidth, whereas with the parameter <monospace>gplugin</monospace>, the bandwidth used in the last iteration, when <monospace>type = "A"</monospace>, can be manually selected. Due to the erratic behavior of the bandwidth selector with <monospace>type = "A"</monospace>, it is strongly recommended to compute the plug‐in bandwidth using <monospace>type = "N"</monospace>. Anyway, the bootstrap bandwidth selector, computed with the function described below, has shown a better performance than any of the plug‐in bandwidths in most scenarios. If <monospace>confband = TRUE</monospace>, bootstrap confidence bands are calculated considering <monospace>B</monospace> replicates and using parallel computing, in the case that <monospace>parallel = TRUE</monospace>.</p>
      <p>Parameter <monospace>model</monospace> plays a similar role as in <monospace>bw.dens.binned</monospace>.</p>
      <p>
        <code xml:space="preserve" position="float" orientation="portrait">
<monospace>bw.dist.binned.boot(n, y, w, ni, g, pilot.type = 2, nit = 10,
confband = FALSE, B = 1000, alpha = 0.05, print = TRUE, plot = TRUE,
parallel = FALSE, pars = new.env())

</monospace></code>
      </p>
      <p>This function computes the bootstrap bandwidth selector for the distribution estimator (<xref rid="ece35448-disp-0003" ref-type="disp-formula">2</xref>). The parameter <monospace>pilot.type</monospace> defines the method to select the pilot bandwidth used for the estimation of the final bandwidth, whereas the parameter <monospace>g</monospace> allows the user to manually select that pilot bandwidth. The parameter <monospace>nit</monospace> fixes the number of iterations to be done in the optimization stage. If <monospace>confband = TRUE</monospace>, bootstrap confidence bands are estimated considering <monospace>B</monospace> resamples and using parallel computing, in the case that <monospace>parallel = TRUE</monospace>.</p>
    </sec>
    <sec id="ece35448-sec-0008">
      <label>3.3</label>
      <title>Emergence indices estimation</title>
      <p>
        <code xml:space="preserve" position="float" orientation="portrait">
<monospace>emergence.indices(n, y, w, ni, hseq, hn = 200, nmix = 4, B = 500,
method = "np", last.iter.np = F, confint = FALSE, B.conf = 1000,
alpha = 0.05, print = TRUE, parallel = FALSE, pars = new.env())

</monospace></code>
      </p>
      <p>This function computes estimates for grouped data of the moment‐based and density‐based emergence indices presented in Section <xref rid="ece35448-sec-0004" ref-type="sec">2.2</xref>. In the case of the density‐based indices, with the parameter <monospace>method</monospace>, the method to select the bandwidth used for their estimation can be chosen: if <monospace>method = "plugin"</monospace>, a plug‐in approach is considered, whereas if <monospace>method = "mix"</monospace> or <monospace>method = "np"</monospace>, a parametric or nonparametric bootstrap approach is considered, respectively. If <monospace>confint = TRUE</monospace>, bootstrap confidence intervals are constructed considering <monospace>B</monospace> resamples and using parallel computing, in the case that <monospace>parallel = TRUE</monospace>.</p>
    </sec>
    <sec id="ece35448-sec-0009">
      <label>3.4</label>
      <title>Analysis with different treatments</title>
      <p>
        <code xml:space="preserve" position="float" orientation="portrait">
<monospace>anv.binned(n, y, trt.w, abs.values = FALSE, B = 500)

</monospace></code>
      </p>
      <p>This function allows to analyze whether a factor has a significant effect on the emergence curve. The idea behind this approach was briefly explained in Section <xref rid="ece35448-sec-0003" ref-type="sec">2.1</xref>, and it is described in detail in Appendix <xref rid="ece35448-app-0003" ref-type="app">3</xref>. It consists in using a bootstrap approach and a Cramér‐von‐Mises type distance.</p>
      <p>In this case, <monospace>n</monospace> is a vector composed of the sizes of the complete samples corresponding to each treatment, and <monospace>trt.w</monospace> is a matrix each of whose columns contains the proportion of observations lying within each of the intervals for the corresponding treatment. If instead of proportions the user wants to provide absolute values, the parameter <monospace>abs.values</monospace> must be set to TRUE. Furthermore, the user can choose the number of bootstrap resamples through the parameter <monospace>B</monospace>. The function <monospace>anv.binned</monospace> returns the <italic>p</italic>‐value of the test.</p>
    </sec>
  </sec>
  <sec id="ece35448-sec-0010">
    <label>4</label>
    <title>EXAMPLE</title>
    <p>In this section, an unpublished data set of wild oat (<italic>Avena sterilis</italic> L.) emergence is considered to illustrate the use of the <monospace>binnednp</monospace> Rcpp package. These data were taken from an experiment performed during Winter–Spring 2006–2007 in Gibraleon (37°C 22′N, 6°C 54′W; altitude 26 m), located in the province of Huelva (Andalucia, South of Spain).</p>
    <p>Briefly, the experiment consisted in four polyvinylchloride cylinders (250 mm diameter 50 mm height) placed 1 m apart. For each sample, 200 seeds of <italic>A. sterilis</italic> were mixed thoroughly with the soil and distributed over the 0–100 mm depth. Numbers of emerged weed seedlings were recorded once or twice a week and then removed by cutting seedling stems at ground level with minimum disturbance of the substrate. All the data for the cumulative numbers of seedling emergence from the field were converted to a square meter basis. Additionally, following the same procedure as that described in Cao et al. (<xref rid="ece35448-bib-0004" ref-type="ref">2011</xref>), the CHTT at emergence in the different inspection days, at three depths (10, 20, and 50 mm), was calculated.</p>
    <p>The observed emergence data are shown in Table <xref rid="ece35448-tbl-0001" ref-type="table">1</xref>. As it can be seen, the cumulative hydrothermal time at emergence cannot be observed for every individual seed, but just in an aggregated way.</p>
    <table-wrap id="ece35448-tbl-0001" xml:lang="en" orientation="portrait" position="float">
      <label>Table 1</label>
      <caption>
        <p>Seedling emergence data of <italic>Avena sterilis</italic>
</p>
      </caption>
      <table frame="hsides" rules="groups">
        <col style="border-right:solid 1px #000000" span="1"/>
        <col style="border-right:solid 1px #000000" span="1"/>
        <col style="border-right:solid 1px #000000" span="1"/>
        <col style="border-right:solid 1px #000000" span="1"/>
        <col style="border-right:solid 1px #000000" span="1"/>
        <col style="border-right:solid 1px #000000" span="1"/>
        <col style="border-right:solid 1px #000000" span="1"/>
        <col style="border-right:solid 1px #000000" span="1"/>
        <col style="border-right:solid 1px #000000" span="1"/>
        <thead valign="bottom">
          <tr style="border-bottom:solid 1px #000000">
            <th align="left" rowspan="3" valign="bottom" colspan="1">Date</th>
            <th align="left" colspan="3" style="border-bottom:solid 1px #000000" valign="bottom" rowspan="1">CHTTT</th>
            <th align="left" colspan="4" style="border-bottom:solid 1px #000000" valign="bottom" rowspan="1">No. seedlings</th>
            <th align="left" rowspan="3" valign="bottom" colspan="1">Pooled</th>
          </tr>
          <tr style="border-bottom:solid 1px #000000">
            <th align="left" colspan="3" style="border-bottom:solid 1px #000000" valign="bottom" rowspan="1">Depth</th>
            <th align="left" colspan="4" style="border-bottom:solid 1px #000000" valign="bottom" rowspan="1">Cylinder</th>
          </tr>
          <tr style="border-bottom:solid 1px #000000">
            <th align="left" valign="bottom" rowspan="1" colspan="1">10 mm</th>
            <th align="left" valign="bottom" rowspan="1" colspan="1">20 mm</th>
            <th align="left" valign="bottom" rowspan="1" colspan="1">50 mm</th>
            <th align="left" valign="bottom" rowspan="1" colspan="1">1</th>
            <th align="left" valign="bottom" rowspan="1" colspan="1">2</th>
            <th align="left" valign="bottom" rowspan="1" colspan="1">3</th>
            <th align="left" valign="bottom" rowspan="1" colspan="1">4</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td align="left" rowspan="1" colspan="1">27 November 2006</td>
            <td align="left" rowspan="1" colspan="1">100</td>
            <td align="left" rowspan="1" colspan="1">92</td>
            <td align="left" rowspan="1" colspan="1">67</td>
            <td align="left" rowspan="1" colspan="1">0</td>
            <td align="left" rowspan="1" colspan="1">0</td>
            <td align="left" rowspan="1" colspan="1">0</td>
            <td align="left" rowspan="1" colspan="1">0</td>
            <td align="left" rowspan="1" colspan="1">0</td>
          </tr>
          <tr>
            <td align="left" rowspan="1" colspan="1">4 December 2006</td>
            <td align="left" rowspan="1" colspan="1">160</td>
            <td align="left" rowspan="1" colspan="1">146</td>
            <td align="left" rowspan="1" colspan="1">105</td>
            <td align="left" rowspan="1" colspan="1">0</td>
            <td align="left" rowspan="1" colspan="1">0</td>
            <td align="left" rowspan="1" colspan="1">0</td>
            <td align="left" rowspan="1" colspan="1">0</td>
            <td align="left" rowspan="1" colspan="1">0</td>
          </tr>
          <tr>
            <td align="left" rowspan="1" colspan="1">12 December 2006</td>
            <td align="left" rowspan="1" colspan="1">218</td>
            <td align="left" rowspan="1" colspan="1">199</td>
            <td align="left" rowspan="1" colspan="1">143</td>
            <td align="left" rowspan="1" colspan="1">2</td>
            <td align="left" rowspan="1" colspan="1">6</td>
            <td align="left" rowspan="1" colspan="1">8</td>
            <td align="left" rowspan="1" colspan="1">3</td>
            <td align="left" rowspan="1" colspan="1">19</td>
          </tr>
          <tr>
            <td align="left" rowspan="1" colspan="1">14 December 2006</td>
            <td align="left" rowspan="1" colspan="1">218</td>
            <td align="left" rowspan="1" colspan="1">217</td>
            <td align="left" rowspan="1" colspan="1">155</td>
            <td align="left" rowspan="1" colspan="1">1</td>
            <td align="left" rowspan="1" colspan="1">0</td>
            <td align="left" rowspan="1" colspan="1">0</td>
            <td align="left" rowspan="1" colspan="1">1</td>
            <td align="left" rowspan="1" colspan="1">2</td>
          </tr>
          <tr>
            <td align="left" rowspan="1" colspan="1">19 December 2006</td>
            <td align="left" rowspan="1" colspan="1">218</td>
            <td align="left" rowspan="1" colspan="1">217</td>
            <td align="left" rowspan="1" colspan="1">185</td>
            <td align="left" rowspan="1" colspan="1">2</td>
            <td align="left" rowspan="1" colspan="1">1</td>
            <td align="left" rowspan="1" colspan="1">1</td>
            <td align="left" rowspan="1" colspan="1">3</td>
            <td align="left" rowspan="1" colspan="1">7</td>
          </tr>
          <tr>
            <td align="left" rowspan="1" colspan="1">22 December 2006</td>
            <td align="left" rowspan="1" colspan="1">218</td>
            <td align="left" rowspan="1" colspan="1">217</td>
            <td align="left" rowspan="1" colspan="1">199</td>
            <td align="left" rowspan="1" colspan="1">2</td>
            <td align="left" rowspan="1" colspan="1">1</td>
            <td align="left" rowspan="1" colspan="1">1</td>
            <td align="left" rowspan="1" colspan="1">0</td>
            <td align="left" rowspan="1" colspan="1">4</td>
          </tr>
          <tr>
            <td align="left" rowspan="1" colspan="1">26 December 2006</td>
            <td align="left" rowspan="1" colspan="1">218</td>
            <td align="left" rowspan="1" colspan="1">217</td>
            <td align="left" rowspan="1" colspan="1">204</td>
            <td align="left" rowspan="1" colspan="1">1</td>
            <td align="left" rowspan="1" colspan="1">1</td>
            <td align="left" rowspan="1" colspan="1">0</td>
            <td align="left" rowspan="1" colspan="1">0</td>
            <td align="left" rowspan="1" colspan="1">2</td>
          </tr>
          <tr>
            <td align="left" rowspan="1" colspan="1">28 December 2006</td>
            <td align="left" rowspan="1" colspan="1">218</td>
            <td align="left" rowspan="1" colspan="1">217</td>
            <td align="left" rowspan="1" colspan="1">204</td>
            <td align="left" rowspan="1" colspan="1">0</td>
            <td align="left" rowspan="1" colspan="1">0</td>
            <td align="left" rowspan="1" colspan="1">0</td>
            <td align="left" rowspan="1" colspan="1">0</td>
            <td align="left" rowspan="1" colspan="1">0</td>
          </tr>
          <tr>
            <td align="left" rowspan="1" colspan="1">2 January 2007</td>
            <td align="left" rowspan="1" colspan="1">218</td>
            <td align="left" rowspan="1" colspan="1">217</td>
            <td align="left" rowspan="1" colspan="1">204</td>
            <td align="left" rowspan="1" colspan="1">0</td>
            <td align="left" rowspan="1" colspan="1">0</td>
            <td align="left" rowspan="1" colspan="1">0</td>
            <td align="left" rowspan="1" colspan="1">0</td>
            <td align="left" rowspan="1" colspan="1">0</td>
          </tr>
          <tr>
            <td align="left" rowspan="1" colspan="1">5 January 2007</td>
            <td align="left" rowspan="1" colspan="1">218</td>
            <td align="left" rowspan="1" colspan="1">217</td>
            <td align="left" rowspan="1" colspan="1">204</td>
            <td align="left" rowspan="1" colspan="1">0</td>
            <td align="left" rowspan="1" colspan="1">2</td>
            <td align="left" rowspan="1" colspan="1">0</td>
            <td align="left" rowspan="1" colspan="1">0</td>
            <td align="left" rowspan="1" colspan="1">2</td>
          </tr>
          <tr>
            <td align="left" rowspan="1" colspan="1">9 January 2007</td>
            <td align="left" rowspan="1" colspan="1">218</td>
            <td align="left" rowspan="1" colspan="1">217</td>
            <td align="left" rowspan="1" colspan="1">204</td>
            <td align="left" rowspan="1" colspan="1">2</td>
            <td align="left" rowspan="1" colspan="1">2</td>
            <td align="left" rowspan="1" colspan="1">9</td>
            <td align="left" rowspan="1" colspan="1">2</td>
            <td align="left" rowspan="1" colspan="1">15</td>
          </tr>
          <tr>
            <td align="left" rowspan="1" colspan="1">12 January 2007</td>
            <td align="left" rowspan="1" colspan="1">218</td>
            <td align="left" rowspan="1" colspan="1">217</td>
            <td align="left" rowspan="1" colspan="1">204</td>
            <td align="left" rowspan="1" colspan="1">3</td>
            <td align="left" rowspan="1" colspan="1">7</td>
            <td align="left" rowspan="1" colspan="1">18</td>
            <td align="left" rowspan="1" colspan="1">11</td>
            <td align="left" rowspan="1" colspan="1">39</td>
          </tr>
          <tr>
            <td align="left" rowspan="1" colspan="1">18 January 2007</td>
            <td align="left" rowspan="1" colspan="1">218</td>
            <td align="left" rowspan="1" colspan="1">217</td>
            <td align="left" rowspan="1" colspan="1">204</td>
            <td align="left" rowspan="1" colspan="1">12</td>
            <td align="left" rowspan="1" colspan="1">7</td>
            <td align="left" rowspan="1" colspan="1">19</td>
            <td align="left" rowspan="1" colspan="1">22</td>
            <td align="left" rowspan="1" colspan="1">60</td>
          </tr>
          <tr>
            <td align="left" rowspan="1" colspan="1">25 January 2007</td>
            <td align="left" rowspan="1" colspan="1">218</td>
            <td align="left" rowspan="1" colspan="1">217</td>
            <td align="left" rowspan="1" colspan="1">204</td>
            <td align="left" rowspan="1" colspan="1">6</td>
            <td align="left" rowspan="1" colspan="1">5</td>
            <td align="left" rowspan="1" colspan="1">8</td>
            <td align="left" rowspan="1" colspan="1">13</td>
            <td align="left" rowspan="1" colspan="1">32</td>
          </tr>
          <tr>
            <td align="left" rowspan="1" colspan="1">1 February 2007</td>
            <td align="left" rowspan="1" colspan="1">265</td>
            <td align="left" rowspan="1" colspan="1">261</td>
            <td align="left" rowspan="1" colspan="1">232</td>
            <td align="left" rowspan="1" colspan="1">2</td>
            <td align="left" rowspan="1" colspan="1">5</td>
            <td align="left" rowspan="1" colspan="1">7</td>
            <td align="left" rowspan="1" colspan="1">7</td>
            <td align="left" rowspan="1" colspan="1">21</td>
          </tr>
          <tr>
            <td align="left" rowspan="1" colspan="1">9 February 2007</td>
            <td align="left" rowspan="1" colspan="1">352</td>
            <td align="left" rowspan="1" colspan="1">340</td>
            <td align="left" rowspan="1" colspan="1">287</td>
            <td align="left" rowspan="1" colspan="1">13</td>
            <td align="left" rowspan="1" colspan="1">12</td>
            <td align="left" rowspan="1" colspan="1">5</td>
            <td align="left" rowspan="1" colspan="1">8</td>
            <td align="left" rowspan="1" colspan="1">38</td>
          </tr>
          <tr>
            <td align="left" rowspan="1" colspan="1">15 February 2007</td>
            <td align="left" rowspan="1" colspan="1">405</td>
            <td align="left" rowspan="1" colspan="1">421</td>
            <td align="left" rowspan="1" colspan="1">343</td>
            <td align="left" rowspan="1" colspan="1">7</td>
            <td align="left" rowspan="1" colspan="1">12</td>
            <td align="left" rowspan="1" colspan="1">13</td>
            <td align="left" rowspan="1" colspan="1">4</td>
            <td align="left" rowspan="1" colspan="1">36</td>
          </tr>
          <tr>
            <td align="left" rowspan="1" colspan="1">23 February 2007</td>
            <td align="left" rowspan="1" colspan="1">459</td>
            <td align="left" rowspan="1" colspan="1">505</td>
            <td align="left" rowspan="1" colspan="1">421</td>
            <td align="left" rowspan="1" colspan="1">0</td>
            <td align="left" rowspan="1" colspan="1">0</td>
            <td align="left" rowspan="1" colspan="1">1</td>
            <td align="left" rowspan="1" colspan="1">0</td>
            <td align="left" rowspan="1" colspan="1">1</td>
          </tr>
          <tr>
            <td align="left" rowspan="1" colspan="1">5 March 2007</td>
            <td align="left" rowspan="1" colspan="1">509</td>
            <td align="left" rowspan="1" colspan="1">571</td>
            <td align="left" rowspan="1" colspan="1">538</td>
            <td align="left" rowspan="1" colspan="1">0</td>
            <td align="left" rowspan="1" colspan="1">0</td>
            <td align="left" rowspan="1" colspan="1">0</td>
            <td align="left" rowspan="1" colspan="1">0</td>
            <td align="left" rowspan="1" colspan="1">0</td>
          </tr>
          <tr>
            <td align="left" rowspan="1" colspan="1">19 March 2007</td>
            <td align="left" rowspan="1" colspan="1">509</td>
            <td align="left" rowspan="1" colspan="1">571</td>
            <td align="left" rowspan="1" colspan="1">538</td>
            <td align="left" rowspan="1" colspan="1">0</td>
            <td align="left" rowspan="1" colspan="1">0</td>
            <td align="left" rowspan="1" colspan="1">0</td>
            <td align="left" rowspan="1" colspan="1">0</td>
            <td align="left" rowspan="1" colspan="1">0</td>
          </tr>
          <tr>
            <td align="left" rowspan="1" colspan="1">Num emerged seedlings</td>
            <td align="left" rowspan="1" colspan="1"/>
            <td align="left" rowspan="1" colspan="1"/>
            <td align="left" rowspan="1" colspan="1"/>
            <td align="left" rowspan="1" colspan="1">53</td>
            <td align="left" rowspan="1" colspan="1">61</td>
            <td align="left" rowspan="1" colspan="1">90</td>
            <td align="left" rowspan="1" colspan="1">74</td>
            <td align="left" rowspan="1" colspan="1"><italic>n</italic> = 278</td>
          </tr>
        </tbody>
      </table>
      <permissions>
        <copyright-holder>John Wiley &amp; Sons, Ltd</copyright-holder>
      </permissions>
    </table-wrap>
    <p>In the first part of the study, we use the function <monospace>anv.binned</monospace> to evaluate whether a factor (in this case, “the cylinder factor") has a significant effect on the emergence curve, for any of the three depths. As pointed out in Section <xref rid="ece35448-sec-0003" ref-type="sec">2.1</xref>, the test implemented in the function <monospace>anv.binned</monospace> is based on a Cramér‐von Mises distance between the nonparametric estimator with the pooled sample and the nonparametric estimators in the different levels of the factor. For example, in the case of depth 10 mm, the distance between all these curves could be visually observed comparing Figures <xref rid="ece35448-fig-0001" ref-type="fig">1</xref> and <xref rid="ece35448-fig-0003" ref-type="fig">3</xref>. Figure <xref rid="ece35448-fig-0001" ref-type="fig">1</xref> contains the nonparametric emergence curve estimates with bootstrap bandwidths (jointly with the corresponding 95% bootstrap confidence bands) for each one of the four cylinders. Figure <xref rid="ece35448-fig-0003" ref-type="fig">3</xref> depicts the emergence curve estimates using the nonparametric approach with the pooled sample. However, it is clear that a reliable and formal solution for this problem requires the application of a statistical test, such as that implemented in the function <monospace>anv.binned</monospace>.</p>
    <fig fig-type="Figure" xml:lang="en" id="ece35448-fig-0001" orientation="portrait" position="float">
      <label>Figure 1</label>
      <caption>
        <p>Nonparametric estimates of the emergence curves using the samples in each of the four cylinders, jointly with the corresponding 95% bootstrap confidence bands</p>
      </caption>
      <graphic id="nlm-graphic-3" xlink:href="ECE3-9-10903-g001"/>
    </fig>
    <p>Note that, in this case, the identical experimentation conditions carried out in the four cylinders seem to support the idea that the null hypothesis could be true and, for this, only a very strong evidence against it will lead us to reject the null hypothesis of “nonsignificant cylinder effect."</p>
    <p>Denoting by <monospace>y1</monospace>, <monospace>y2</monospace>, and <monospace>y3</monospace> the CHTT was calculated for 10, 20, and 50 mm, respectively, and after applying the function <monospace>anv.binned</monospace> for the three depths, using the following code:</p>
    <p><code xml:space="preserve" position="float" orientation="portrait">
<monospace># Observed values of CHTT for each depth
y1 = c(100,160,218,265,352,405,459,509)
y2 = c(92,146,199,217,261,340,421,505,571)
y3 = c(67,105,143,155,185,199,204,232,287,343,421,538)

# size of the complete sample for each treatment
n = c(53,61,90,74)

# nij: number of emerged seedlings for treatment i and depth j
n11 = c(0,0,31,2,13,7,0)
n21 = c(0,0,32,5,12,12,0)
n31 = c(0,0,64,7,5,13,1)
n41 = c(0,0,55,7,8,4,0)

# wij: proportion of emerged seedlings for treatment i and depth j
w11 = n11/n[1]
w21 = n21/n[2]
w31 = n31/n[3]
w41 = n41/n[4]

# Analysis with different treatments for 10 mm
res1 = anv.binned(n,y1,cbind(w11,w21,w31,w41),B=1000)
n12 = c(0,0,2,29,2,13,7,0)
n22 = c(0,0,6,33,5,12,12,0)
n32 = c(0,0,8,56,7,5,13,1)
n42 = c(0,0,3,42,7,8,4,0)

w12 = n12/n[1]
w22 = n22/n[2]
w32 = n32/n[3]
w42 = n42/n[4]

# Analysis with different treatments for 20 mm
res2 = anv.binned(n,y2,cbind(w12,w22,w32,w42),B=1000)

n13 = c(0,0,2,1,2,2,24,2,13,7,0)
n23 = c(0,0,6,0,1,1,24,5,12,12,0)
n33 = c(0,0,8,0,1,1,54,7,5,13,1)
n43 = c(0,0,3,1,3,0,48,7,8,4,0)

w13 = n13/n[1]
w23 = n23/n[2]
w33 = n33/n[3]
w43 = n43/n[4]

# Analysis with different treatments for 50 mm
res3 = anv.binned(n,y3,cbind(w13,w23,w33,w43),B=1000)
</monospace></code>
the results obtained are:</p>
    <p>––––– Result of the application of anv.binned to the samples of the four cylinders –––––</p>
    <p>
      <code xml:space="preserve" position="float" orientation="portrait">
<monospace>&gt; res1
[1] 0.016

&gt; res2
[1] 0.144

&gt; res3
[1] 0.011

</monospace></code>
    </p>
    <p>This indicates that, with a significance level of 0.01, the effect of the cylinders is not significant for any of the three depths. The strong certainty of the null hypothesis justifies the use of this significance level (see, e.g. Cramer &amp; Howit, <xref rid="ece35448-bib-0007" ref-type="ref">2004</xref>, p. 151, for a comment on the election of the significance level). Therefore, it makes sense to analyze the samples jointly and not separately.</p>
    <p>Taking into account the result obtained after applying function <monospace>anv.binned</monospace> to the samples of the four cylinders, in the second part of the study, the data with the pooled number of emerged seedlings, given in the last column of Table <xref rid="ece35448-tbl-0001" ref-type="table">1</xref>, are considered. Note that the total sample size of emerged seedlings at the end of the experiment is <italic>n</italic> =278.</p>
    <p>Given these weed emergence data, a first interesting issue is to find out what is the best depth, among the three possibilities available in this case, 10, 20, and 50 mm, to measure the CHTT in order to have more prediction power. Denoting, as before, by <monospace>y1</monospace>, <monospace>y2</monospace>, and <monospace>y3</monospace> the CHTT calculated for 10, 20, and 50 mm, respectively, and by <monospace>ni</monospace> the vector with pooled number of emerged seedlings, the function <monospace>emergence.indices</monospace> can be applied to (<monospace>y1</monospace>, <monospace>ni</monospace>), (<monospace>y2</monospace>, <monospace>ni</monospace>), and (<monospace>y3</monospace>, <monospace>ni</monospace>) to obtain estimates of the indices presented in Section <xref rid="ece35448-sec-0004" ref-type="sec">2.2</xref>.</p>
    <p>
      <code xml:space="preserve" position="float" orientation="portrait">
<monospace>ind1 &lt;- emergence.indices(n, y1, ni) # emergence indices for 10 mm
ind2 &lt;- emergence.indices(n, y2, ni) # emergence indices for 20 mm
ind3 &lt;- emergence.indices(n, y3, ni) # emergence indices for 50 mm

indices &lt;- data.frame(I1=c(ind1$I1,ind2$I1,ind3$I1), I2=c(ind1$I2,ind2$I2,ind3$I2), J1=c(ind1$J1,ind2$J1,ind3$J1), J2=c(ind1$J2,ind2$J2,ind3$J2))

</monospace></code>
    </p>
    <p>Obtaining the results:<boxed-text position="anchor" content-type="graphic" id="ece35448-blkfxd-0002" orientation="portrait"><graphic xlink:href="ECE3-9-10903-g004.jpg" position="anchor" id="nlm-graphic-5" orientation="portrait"/></boxed-text>
</p>
    <p>To maximize the predictive power a specific weed emergence model, the HTT should be measured at a depth producing a density function as flat as possible or, equivalently, a distribution function as dispersed as possible. Therefore, small values of <italic>J</italic>
<sub>1</sub> and <italic>J</italic>
<sub>2</sub> are preferable. On the other hand, CHTT samples with higher coefficient of variation (higher value of <italic>I<sub>1</sub></italic>) and a lower kurtosis (lower value of <italic>I<sub>2</sub></italic>) will improve weed emergence prediction. Consequently, 10 mm seems to be the best soil depth to predict weed emergence in terms of indices <italic>I</italic>
<sub>1</sub>, <italic>I</italic>
<sub>2</sub>, <italic>J</italic>
<sub>1</sub>, and <italic>J</italic>
<sub>2</sub> and, therefore, only observations at 10 mm are considered in what follows.</p>
    <p>Now, the function <monospace>bw.dens.binned</monospace>, described in Section <xref rid="ece35448-sec-0006" ref-type="sec">3.1</xref>, can be applied using the pooled sample and the CHTT at 10 mm to compute the plug‐in and bootstrap bandwidths for the kernel density estimator (<xref rid="ece35448-disp-0002" ref-type="disp-formula">1</xref>).</p>
    <p>
      <code xml:space="preserve" position="float" orientation="portrait">
<monospace># computing bandwidths for kernel density estimator
dens &lt;– bw.dens.binned (n, y, ni, plot = FALSE) # Bandwidths for density

</monospace></code>
    </p>
    <p>Obtaining the results:</p>
    <p>–––––Plug‐in and bootstrap bandwidths for the density estimator–––––</p>
    <p>
      <code xml:space="preserve" position="float" orientation="portrait">
<monospace>&gt; dens
$h_plugin
[1] 14.93051
$h_boot
[1] 19.68239

</monospace></code>
    </p>
    <p>Figure <xref rid="ece35448-fig-0002" ref-type="fig">2</xref> shows, in the left panel, the kernel density estimates computed using (<xref rid="ece35448-disp-0002" ref-type="disp-formula">1</xref>) with the obtained plug‐in (green lines) and bootstrap (red lines) bandwidths. Moreover, the parameter <monospace>model</monospace> was used in <monospace>bw.dens.binned</monospace> to fit parametric logistic and Weibull densities to the emergence data. The right panel of Figure <xref rid="ece35448-fig-0002" ref-type="fig">2</xref> shows the corresponding density estimators (green and blue lines for the Weibull and the logistic densities, respectively). Additionally, the nonparametric estimator computed with the bootstrap bandwidth is also included in this figure (red line) for the sake of comparison.</p>
    <fig fig-type="Figure" xml:lang="en" id="ece35448-fig-0002" orientation="portrait" position="float">
      <label>Figure 2</label>
      <caption>
        <p>Left panel: kernel density estimates considering plug‐in (green line) and bootstrap (red line) bandwidths. Right panel: parametric Weibull (green line) and logistic (blue line) density estimates, and nonparametric kernel density estimate using the bootstrap bandwidth (red line)</p>
      </caption>
      <graphic id="nlm-graphic-7" xlink:href="ECE3-9-10903-g002"/>
    </fig>
    <p>Next, using the functions <monospace>bw.dist.binned</monospace> and <monospace>bw.dist.binned.boot</monospace>, described in Section <xref rid="ece35448-sec-0007" ref-type="sec">3.2</xref>, the plug‐in and bootstrap bandwidths for the kernel distribution estimator (<xref rid="ece35448-disp-0003" ref-type="disp-formula">2</xref>) are calculated.</p>
    <p>
      <code xml:space="preserve" position="float" orientation="portrait">
<monospace># computing bandwidths for kernel distribution estimator

# Plug–in bandwidth
dist_pi &lt;– bw. dist. binned (n, y, ni, plot = FALSE) $h # Plug–in

# Bootstrap bandwidth
dist_boot &lt;– bw. dist. binned. boot (n, y, ni, plot = FALSE)$h # Bootstrap

</monospace></code>
    </p>
    <p>Obtaining the results:</p>
    <p>–––––Plug‐in and bootstrap bandwidths for the distribution estimator–––––</p>
    <p>
      <code xml:space="preserve" position="float" orientation="portrait">
<monospace>&gt; dist_pi$h
[1] 9.833762
&gt; dist_boot$h
[1] 13.73533

</monospace></code>
    </p>
    <p>Figure <xref rid="ece35448-fig-0003" ref-type="fig">3</xref> shows, in the left panel, the kernel distribution estimates computed using (<xref rid="ece35448-disp-0003" ref-type="disp-formula">2</xref>) with the obtained plug‐in (green line) and bootstrap (red line) bandwidths, that is, the estimates of the emergence curves using the nonparametric approach. In contrast to the density case, the effect that the bandwidth has on the behavior of the distribution estimator is less evident, since slightly different bandwidths produce very similar distribution estimates. As in the density case, the parameter <monospace>model</monospace> in the function <monospace>bw.dist.binned</monospace> was set to <monospace>weibull</monospace> and <monospace>logistic</monospace> to fit parametric regression functions following these models to describe seedling emergence. The corresponding fits are shown in the right panel of Figure <xref rid="ece35448-fig-0003" ref-type="fig">3</xref>, using a green line for the Weibull and a blue line for the logistic. The nonparametric distribution estimator (<xref rid="ece35448-disp-0003" ref-type="disp-formula">2</xref>) is also included in this plot (red line). In both figures, the empirical distribution of the grouped sample data is represented with black lines.</p>
    <fig fig-type="Figure" xml:lang="en" id="ece35448-fig-0003" orientation="portrait" position="float">
      <label>Figure 3</label>
      <caption>
        <p>Kernel distribution estimates considering plug‐in (green line) and bootstrap (red line) bandwidths. Right panel: parametric regression fits, Weibull (green line) and logistic (blue line), and nonparametric kernel distribution estimate using the bootstrap bandwidth (red line). The empirical distribution of the grouped sample (black lines) is also shown</p>
      </caption>
      <graphic id="nlm-graphic-9" xlink:href="ECE3-9-10903-g003"/>
    </fig>
  </sec>
  <sec sec-type="conclusions" id="ece35448-sec-0011">
    <label>5</label>
    <title>CONCLUSION</title>
    <p>The <monospace>binnednp</monospace> R package gives the weed science research community a simple tool to analyze interval‐grouped data. This is useful to study, for example, the CHTT at seedling emergence. Using nonparametric density and distribution estimation, the researcher can both visualize the underlying nature of the data and make predictions without loosing flexibility or making inadequate assumptions about the data. Moreover, estimation of emergence indices measures the adequacy of the depth chosen to register the values of CHTT. Additionally, analyses to test the effect of a specific factor on weed emergence can be also performed.</p>
  </sec>
  <sec sec-type="COI-statement" id="ece35448-sec-0012">
    <title>CONFLICT OF INTEREST</title>
    <p>None declared.</p>
  </sec>
  <sec id="ece35448-sec-0013">
    <title>AUTHOR'S CONTRIBUTIONS</title>
    <p>RC, MF‐F, and JLG‐A conceived the ideas and designed the methodology; DB‐U, BBF, RD, and MR wrote the code; JLG‐A provided the data; DB‐U, RC, MF‐F, MR, and JLG‐A analyzed the data. All authors led the writing of the manuscript and contributed critically to the drafts and gave final approval for publication.</p>
  </sec>
</body>
<back>
  <ack id="ece35448-sec-0016">
    <title>ACKNOWLEDGEMENTS</title>
    <p>This research has been partially supported by MINECO grants MTM2014‐52876‐R and MTM2017‐82724‐R, for the first three authors, and by the Xunta de Galicia (Grupos de Referencia Competitiva ED431C‐2016‐015 and Centro Singular de Investigación de Galicia ED431G/01), for the first fifth authors, all of them through the European Regional Development Funds (ERDF). The research of sixth author has been partially funded by FEDER (ERDF) and MINECO grants AGL2012‐33736 and AGL2015‐64130‐R. The authors thank Dr. Fernando Bastida for permission to use the <italic>Avena sterilis</italic> L. emergence data employed in Section <xref rid="ece35448-sec-0010" ref-type="sec">4</xref>. The authors also thank two anonymous referees for numerous useful comments that significantly improved this article.</p>
  </ack>
  <sec sec-type="data-availability" id="ece35448-sec-0015">
    <title>DATA AVAILABILITY STATEMENT</title>
    <p>The current stable version of the <monospace>binnednp</monospace> package requires R (≥2.10) and is distributed under the GPL‐3 license. It is publicly available on the Comprehensive R Archive Network at <ext-link ext-link-type="uri" xlink:href="https://cran.r-project.org/package=binnednp" specific-use="software is-supplemented-by">https://cran.r-project.org/package=binnednp</ext-link>
</p>
  </sec>
  <ref-list content-type="cited-references" id="ece35448-bibl-0001">
    <title>REFERENCES</title>
    <ref id="ece35448-bib-0001">
      <mixed-citation publication-type="book" id="ece35448-cit-0001"><string-name><surname>Barreiro</surname>, <given-names>D.</given-names></string-name>, <string-name><surname>Fraguela</surname>, <given-names>B.</given-names></string-name>, <string-name><surname>Doallo</surname>, <given-names>R.</given-names></string-name>, <string-name><surname>Cao</surname>, <given-names>R.</given-names></string-name>, <string-name><surname>Francisco‐Fernández</surname>, <given-names>M.</given-names></string-name>, &amp; <string-name><surname>Reyes</surname>, <given-names>M.</given-names></string-name>. (<year>2019</year>). <source xml:lang="en">binnednp: nonparametric estimation for interval‐grouped data</source>. Retrieved from <ext-link ext-link-type="uri" xlink:href="https://cran.r-project.org/package=binnednp">https://cran.r-project.org/package=binnednp</ext-link>, R package version 0.4.0.</mixed-citation>
    </ref>
    <ref id="ece35448-bib-0002">
      <mixed-citation publication-type="journal" id="ece35448-cit-0002"><string-name><surname>Blanco</surname>, <given-names>A. M.</given-names></string-name>, <string-name><surname>Chantre</surname>, <given-names>G. R.</given-names></string-name>, <string-name><surname>Lodovichi</surname>, <given-names>M. V.</given-names></string-name>, <string-name><surname>Bandoni</surname>, <given-names>J. A.</given-names></string-name>, <string-name><surname>López</surname>, <given-names>R. L.</given-names></string-name>, <string-name><surname>Vigna</surname>, <given-names>M. R.</given-names></string-name>, … <string-name><surname>Sabbatini</surname>, <given-names>M. R.</given-names></string-name> (<year>2014</year>). <article-title>Modelling seed dormancy release and germination for predicting <italic>Avena fatua</italic> L. field emergence: A genetic algorithm approach</article-title>. <source xml:lang="en">Ecological Modelling</source>, <volume>272</volume>, <fpage>293</fpage>–<lpage>300</lpage>.</mixed-citation>
    </ref>
    <ref id="ece35448-bib-0003">
      <mixed-citation publication-type="journal" id="ece35448-cit-0003"><string-name><surname>Bradford</surname>, <given-names>K. J.</given-names></string-name> (<year>2002</year>). <article-title>Applications of hydrothermal time to quantifying and modeling seed germination and dormancy</article-title>. <source xml:lang="en">Weed Science</source>, <volume>50</volume>, <fpage>248</fpage>–<lpage>260</lpage>. <pub-id pub-id-type="doi">10.1614/0043-1745(2002)050[0248:AOHTTQ]2.0.CO;2</pub-id>
</mixed-citation>
    </ref>
    <ref id="ece35448-bib-0004">
      <mixed-citation publication-type="journal" id="ece35448-cit-0004"><string-name><surname>Cao</surname>, <given-names>R.</given-names></string-name>, <string-name><surname>Francisco‐Fernández</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Anand</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Bastida</surname>, <given-names>F.</given-names></string-name>, &amp; <string-name><surname>González‐Andújar</surname>, <given-names>J. L.</given-names></string-name> (<year>2011</year>). <article-title>Computing statistical indices for hydrothermal times using weed emergence data</article-title>. <source xml:lang="en">Journal of Agricultural Science</source>, <volume>149</volume>, <fpage>701</fpage>–<lpage>712</lpage>. <pub-id pub-id-type="doi">10.1017/S002185961100030X</pub-id>
</mixed-citation>
    </ref>
    <ref id="ece35448-bib-0005">
      <mixed-citation publication-type="journal" id="ece35448-cit-0005"><string-name><surname>Cao</surname>, <given-names>R.</given-names></string-name>, <string-name><surname>Francisco‐Fernández</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Anand</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Bastida</surname>, <given-names>F.</given-names></string-name>, &amp; <string-name><surname>González‐Andújar</surname>, <given-names>J. L.</given-names></string-name> (<year>2013</year>). <article-title>Modeling <italic>Bromus diandrus</italic> seedling emergence using nonparametric estimation</article-title>. <source xml:lang="en">Journal of Agricultural, Biological and Environmental Statistics</source>, <volume>18</volume>, <fpage>64</fpage>–<lpage>86</lpage>. <pub-id pub-id-type="doi">10.1007/s13253-012-0122-x</pub-id>
</mixed-citation>
    </ref>
    <ref id="ece35448-bib-0006">
      <mixed-citation publication-type="journal" id="ece35448-cit-0006"><string-name><surname>Chantre</surname>, <given-names>G. R.</given-names></string-name>, <string-name><surname>Blanco</surname>, <given-names>A. M.</given-names></string-name>, <string-name><surname>Lodovichi</surname>, <given-names>M. V.</given-names></string-name>, <string-name><surname>Bandoni</surname>, <given-names>J. A.</given-names></string-name>, <string-name><surname>Sabbatini</surname>, <given-names>M. R.</given-names></string-name>, <string-name><surname>López</surname>, <given-names>R. L.</given-names></string-name>, … <string-name><surname>Gigón</surname>, <given-names>R.</given-names></string-name> (<year>2012</year>). <article-title>Modeling Avena fatua seedling emergence dynamics: An artificial neural network approach</article-title>. <source xml:lang="en">Computers and Electronics in Agriculture</source>, <volume>88</volume>, <fpage>95</fpage>–<lpage>102</lpage>. <pub-id pub-id-type="doi">10.1016/j.compag.2012.07.005</pub-id>
</mixed-citation>
    </ref>
    <ref id="ece35448-bib-0007">
      <mixed-citation publication-type="book" id="ece35448-cit-0007"><string-name><surname>Cramer</surname>, <given-names>D.</given-names></string-name>, &amp; <string-name><surname>Howit</surname>, <given-names>D.</given-names></string-name> (<year>2004</year>). <source xml:lang="en">The SAGE dictionary of statistics</source>. <publisher-loc>London</publisher-loc>: <publisher-name>SAGE Publications</publisher-name>.</mixed-citation>
    </ref>
    <ref id="ece35448-bib-0008">
      <mixed-citation publication-type="journal" id="ece35448-cit-0008"><string-name><surname>Eddelbuettel</surname>, <given-names>D.</given-names></string-name>, &amp; <string-name><surname>François</surname>, <given-names>R.</given-names></string-name> (<year>2011</year>). <article-title>Rcpp: Seamless R and C++ integration</article-title>. <source xml:lang="en">Journal of Statistical Software</source>, <volume>40</volume>(<issue>8</issue>), <fpage>1</fpage>–<lpage>18</lpage>.</mixed-citation>
    </ref>
    <ref id="ece35448-bib-0009">
      <mixed-citation publication-type="journal" id="ece35448-cit-0009"><string-name><surname>Forcella</surname>, <given-names>F.</given-names></string-name>, <string-name><surname>Benech‐Arnold</surname>, <given-names>R.</given-names></string-name>, <string-name><surname>Sánchez</surname>, <given-names>R.</given-names></string-name>, &amp; <string-name><surname>Ghersa</surname>, <given-names>C.</given-names></string-name> (<year>2000</year>). <article-title>Modelling seedling emergence</article-title>. <source xml:lang="en">Field Crops Research</source>, <volume>67</volume>, <fpage>123</fpage>–<lpage>139</lpage>.</mixed-citation>
    </ref>
    <ref id="ece35448-bib-0010">
      <mixed-citation publication-type="book" id="ece35448-cit-0010"><string-name><surname>González‐Andújar</surname>, <given-names>J. L.</given-names></string-name> (<year>2008</year>). <chapter-title>Weed control models</chapter-title> In <person-group person-group-type="editor"><name name-style="western"><surname>Jørgensen</surname><given-names>S. E.</given-names></name></person-group>, &amp; <person-group person-group-type="editor"><name name-style="western"><surname>Fath</surname><given-names>B. D.</given-names></name></person-group> (Eds.), <source xml:lang="en">Population dynamics. Vol. [5] of encyclopedia of ecology</source> (pp. <fpage>3776</fpage>–<lpage>3780</lpage>). <publisher-loc>Oxford</publisher-loc>: <publisher-name>Elsevier</publisher-name>.</mixed-citation>
    </ref>
    <ref id="ece35448-bib-0011">
      <mixed-citation publication-type="journal" id="ece35448-cit-0011"><string-name><surname>González‐Andújar</surname>, <given-names>J. L.</given-names></string-name>, <string-name><surname>Chantre</surname>, <given-names>G. R.</given-names></string-name>, <string-name><surname>Morvillo</surname>, <given-names>C.</given-names></string-name>, <string-name><surname>Blanco</surname>, <given-names>A.</given-names></string-name>, &amp; <string-name><surname>Forcella</surname>, <given-names>F.</given-names></string-name> (<year>2016</year>). <article-title>Predicting field weed emergence with empirical models and soft computing techniques</article-title>. <source xml:lang="en">Weed Research</source>, <volume>56</volume>, <fpage>415</fpage>–<lpage>423</lpage>. <pub-id pub-id-type="doi">10.1111/wre.12223</pub-id>
</mixed-citation>
    </ref>
    <ref id="ece35448-bib-0012">
      <mixed-citation publication-type="journal" id="ece35448-cit-0012"><string-name><surname>González‐Andújar</surname>, <given-names>J. L.</given-names></string-name>, <string-name><surname>Francisco‐Fernández</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Cao</surname>, <given-names>R.</given-names></string-name>, <string-name><surname>Reyes</surname>, <given-names>M. A.</given-names></string-name>, <string-name><surname>Urbano</surname>, <given-names>J. M.</given-names></string-name>, <string-name><surname>Forcella</surname>, <given-names>F.</given-names></string-name>, &amp; <string-name><surname>Bastida</surname>, <given-names>F.</given-names></string-name> (<year>2016</year>). <article-title>A comparative study between nonlinear regression and nonparametric approaches for modeling <italic>Phalaris paradoxa</italic> seedling emergence</article-title>. <source xml:lang="en">Weed Research</source>, <volume>56</volume>, <fpage>367</fpage>–<lpage>376</lpage>.</mixed-citation>
    </ref>
    <ref id="ece35448-bib-0013">
      <mixed-citation publication-type="journal" id="ece35448-cit-0013"><string-name><surname>Grundy</surname>, <given-names>A. C.</given-names></string-name> (<year>2003</year>). <article-title>Predicting weed emergence: A review of approaches and future challenges</article-title>. <source xml:lang="en">Weed Research</source>, <volume>43</volume>, <fpage>1</fpage>–<lpage>11</lpage>. <pub-id pub-id-type="doi">10.1046/j.1365-3180.2003.00317.x</pub-id>
</mixed-citation>
    </ref>
    <ref id="ece35448-bib-0014">
      <mixed-citation publication-type="journal" id="ece35448-cit-0014"><string-name><surname>Haj Seyed‐Hadi</surname>, <given-names>M. R.</given-names></string-name>, &amp; <string-name><surname>Gonzalez‐Andujar</surname>, <given-names>J. L.</given-names></string-name> (<year>2009</year>). <article-title>Comparison of fitting weed seedling emergence models with nonlinear regression and genetic algorithm</article-title>. <source xml:lang="en">Computers and Electronics in Agriculture</source>, <volume>65</volume>, <fpage>19</fpage>–<lpage>25</lpage>.</mixed-citation>
    </ref>
    <ref id="ece35448-bib-0015">
      <mixed-citation publication-type="journal" id="ece35448-cit-0015"><string-name><surname>Hunter</surname>, <given-names>E. A.</given-names></string-name>, <string-name><surname>Glasbey</surname>, <given-names>C. A.</given-names></string-name>, &amp; <string-name><surname>Naylor</surname>, <given-names>R. E. L.</given-names></string-name> (<year>1984</year>). <article-title>The analysis of data from germination tests</article-title>. <source xml:lang="en">Journal of Agricultural Science, Cambridge</source>, <volume>102</volume>, <fpage>207</fpage>–<lpage>213</lpage>. <pub-id pub-id-type="doi">10.1017/S0021859600041642</pub-id>
</mixed-citation>
    </ref>
    <ref id="ece35448-bib-0016">
      <mixed-citation publication-type="journal" id="ece35448-cit-0016"><string-name><surname>Kiefer</surname>, <given-names>J.</given-names></string-name> (<year>1959</year>). <article-title><italic>k</italic>‐Sample analogues of the Kolmogorov‐Smirnov, Cramér‐von Mises tests</article-title>. <source xml:lang="en">Annals of Mathematical Statistics</source>, <volume>30</volume>, <fpage>420</fpage>–<lpage>447</lpage>.</mixed-citation>
    </ref>
    <ref id="ece35448-bib-0018">
      <mixed-citation publication-type="journal" id="ece35448-cit-0018"><string-name><surname>Naylor</surname>, <given-names>R. E. L.</given-names></string-name> (<year>1981</year>). <article-title>An evaluation of various germination indices for predicting differences in seed vigour in Italian ryegrass</article-title>. <source xml:lang="en">Seed Science and Technology</source>, <volume>9</volume>, <fpage>593</fpage>–<lpage>600</lpage>.</mixed-citation>
    </ref>
    <ref id="ece35448-bib-0019">
      <mixed-citation publication-type="journal" id="ece35448-cit-0019"><string-name><surname>Onofri</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Gresta</surname>, <given-names>F.</given-names></string-name>, &amp; <string-name><surname>Tei</surname>, <given-names>F.</given-names></string-name> (<year>2010</year>). <article-title>A new method for the analysis of germination and emergence data of weed species</article-title>. <source xml:lang="en">Weed Research</source>, <volume>50</volume>, <fpage>187</fpage>–<lpage>198</lpage>. <pub-id pub-id-type="doi">10.1111/j.1365-3180.2010.00776.x</pub-id>
</mixed-citation>
    </ref>
    <ref id="ece35448-bib-0020">
      <mixed-citation publication-type="journal" id="ece35448-cit-0020"><string-name><surname>Onofri</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Mesgaran</surname>, <given-names>M. B.</given-names></string-name>, <string-name><surname>Tei</surname>, <given-names>F.</given-names></string-name>, &amp; <string-name><surname>Cousens</surname>, <given-names>R. D.</given-names></string-name> (<year>2011</year>). <article-title>The cure model: An improvement way to describe seed germination</article-title>. <source xml:lang="en">Weed Research</source>, <volume>51</volume>, <fpage>516</fpage>–<lpage>524</lpage>.</mixed-citation>
    </ref>
    <ref id="ece35448-bib-0021">
      <mixed-citation publication-type="journal" id="ece35448-cit-0021"><string-name><surname>Onofri</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Piepho</surname>, <given-names>H.‐P.</given-names></string-name>, &amp; <string-name><surname>Kozak</surname>, <given-names>M.</given-names></string-name> (<year>2019</year>). <article-title>Analysing censored data in agricultural research: A review with examples and software tips</article-title>. <source xml:lang="en">Annals of Applied Biology</source>, <volume>174</volume>, <fpage>3</fpage>–<lpage>13</lpage>. <pub-id pub-id-type="doi">10.1111/aab.12477</pub-id>
</mixed-citation>
    </ref>
    <ref id="ece35448-bib-0022">
      <mixed-citation publication-type="journal" id="ece35448-cit-0022"><string-name><surname>Parzen</surname>, <given-names>E.</given-names></string-name> (<year>1962</year>). <article-title>On estimation of a probability density function and mode</article-title>. <source xml:lang="en">The Annals of Mathematical Statistics</source>, <volume>32</volume>, <fpage>1065</fpage>–<lpage>1076</lpage>. <pub-id pub-id-type="doi">10.1214/aoms/1177704472</pub-id>
</mixed-citation>
    </ref>
    <ref id="ece35448-bib-0023">
      <mixed-citation publication-type="book" id="ece35448-cit-0023"><collab collab-type="authors">R Development Core Team</collab>
(<year>2019</year>). <source xml:lang="en">R: A language and environment for statistical computing</source>. <publisher-loc>Vienna, Austria</publisher-loc>: <publisher-name>R Foundation for Statistical Computing</publisher-name> Retrieved from <ext-link ext-link-type="uri" xlink:href="http://www.R-project.org">http://www.R-project.org</ext-link>
</mixed-citation>
    </ref>
    <ref id="ece35448-bib-0024">
      <mixed-citation publication-type="journal" id="ece35448-cit-0024"><string-name><surname>Reyes</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Francisco‐Fernández</surname>, <given-names>M.</given-names></string-name>, &amp; <string-name><surname>Cao</surname>, <given-names>R.</given-names></string-name> (<year>2016</year>). <article-title>Nonparametric kernel density estimation for general grouped data</article-title>. <source xml:lang="en">Journal of Nonparametric Statistics</source>, <volume>2</volume>, <fpage>235</fpage>–<lpage>249</lpage>.</mixed-citation>
    </ref>
    <ref id="ece35448-bib-0025">
      <mixed-citation publication-type="journal" id="ece35448-cit-0025"><string-name><surname>Rosenblatt</surname>, <given-names>M.</given-names></string-name> (<year>1956</year>). <article-title>Remarks on some nonparametric estimates of a density function</article-title>. <source xml:lang="en">The Annals of Mathematical Statistics</source>, <volume>27</volume>, <fpage>832</fpage>–<lpage>837</lpage>. <pub-id pub-id-type="doi">10.1214/aoms/1177728190</pub-id>
</mixed-citation>
    </ref>
    <ref id="ece35448-bib-0026">
      <mixed-citation publication-type="book" id="ece35448-cit-0026"><string-name><surname>Westfall</surname>, <given-names>P. H.</given-names></string-name>, &amp; <string-name><surname>Young</surname>, <given-names>S. S.</given-names></string-name> (<year>1993</year>). <source xml:lang="en">Resamplig‐based multiple testing: Examples and methods for p‐value adjustment</source>. <publisher-loc>New York</publisher-loc>: <publisher-name>John Wiley &amp; Sons Inc</publisher-name>.</mixed-citation>
    </ref>
    <ref id="ece35448-bib-0027">
      <mixed-citation publication-type="journal" id="ece35448-cit-0027"><string-name><surname>Zambrano‐Navea</surname>, <given-names>C.</given-names></string-name>, <string-name><surname>Bastida</surname>, <given-names>F.</given-names></string-name>, &amp; <string-name><surname>González‐Andújar</surname>, <given-names>J. L.</given-names></string-name> (<year>2013</year>). <article-title>A hydrothermal seedling emergence model for <italic>Conyza bonariensis</italic>
</article-title>. <source xml:lang="en">Weed Research</source>, <volume>53</volume>, <fpage>213</fpage>–<lpage>220</lpage>.</mixed-citation>
    </ref>
  </ref-list>
  <app-group>
    <app id="ece35448-app-0001" content-type="APPENDIX">
      <label>APPENDIX 1</label>
      <sec sec-type="opening-section" id="ece35448-sec-0017">
        <p>In this appendix, the plug‐in and bootstrap bandwidth selection methods implemented in the functions <monospace>bw.dens.binned</monospace>, bw.dist.binned, and bw.dist.binned.boot are briefly described.</p>
        <sec id="ece35448-sec-0018">
          <title>BANDWIDTH SELECTION FOR THE DENSITY FUNCTION</title>
          <p>The function <monospace>bw.dens.binned</monospace> of the <monospace>binnednp</monospace> package computes plug‐in and bootstrap bandwidths for the density estimator (<xref rid="ece35448-disp-0002" ref-type="disp-formula">1</xref>). Plug‐in bandwidths are obtained minimizing in <italic>h</italic> the expression of the asymptotic mean squared error (AMISE) of (<xref rid="ece35448-disp-0002" ref-type="disp-formula">1</xref>) and estimating the unknown quantities in the minimizer of the AMISE. Under suitable assumptions, asymptotic properties of (<xref rid="ece35448-disp-0002" ref-type="disp-formula">1</xref>) were obtained in Reyes et al. (<xref rid="ece35448-bib-0024" ref-type="ref">2016</xref>). In that paper, it is obtained that the AMISE of (<xref rid="ece35448-disp-0002" ref-type="disp-formula">1</xref>) is:<disp-formula id="ece35448-disp-0008"><label>(A1)</label><mml:math id="nlm-math-15"><mml:mrow><mml:mi mathvariant="normal">AMISE(</mml:mi><mml:msubsup><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>h</mml:mi><mml:mi>g</mml:mi></mml:msubsup><mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo></mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mn>4</mml:mn></mml:mfrac><mml:msub><mml:mi>μ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>K</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:msup><mml:mi>h</mml:mi><mml:mn>4</mml:mn></mml:msup><mml:mi>A</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>f</mml:mi><mml:mo>″</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi mathvariant="italic">nh</mml:mi></mml:mfrac><mml:mi>A</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>K</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <mml:math id="nlm-math-16"><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>K</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo>∫</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mi>K</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mi>x</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math>, <mml:math id="nlm-math-17"><mml:mrow><mml:mi>A</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>K</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo>∫</mml:mo><mml:msup><mml:mi>K</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:math> and <mml:math id="nlm-math-18"><mml:mrow><mml:mi>A</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>f</mml:mi><mml:mo>″</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo>∫</mml:mo><mml:mrow><mml:msup><mml:mi>f</mml:mi><mml:mo>″</mml:mo></mml:msup><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mi mathvariant="normal">d</mml:mi><mml:mi>x</mml:mi></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math>
</p>
          <p>From (<xref rid="ece35448-disp-0008" ref-type="disp-formula">A1</xref>), it follows that the asymptotically optimal global bandwidth for (<xref rid="ece35448-disp-0002" ref-type="disp-formula">1</xref>) is<disp-formula id="ece35448-disp-0009"><label>(A2)</label><mml:math id="nlm-math-19"><mml:mrow><mml:msubsup><mml:mi>h</mml:mi><mml:mi>g</mml:mi><mml:mtext>dens</mml:mtext></mml:msubsup><mml:mo>=</mml:mo><mml:msup><mml:mfenced close="]" open="[" separators=""><mml:mfrac><mml:mrow><mml:mi>A</mml:mi><mml:mfenced close=")" open="("><mml:mi>K</mml:mi></mml:mfenced></mml:mrow><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>K</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mi>A</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:msup><mml:mi>f</mml:mi><mml:mo>″</mml:mo></mml:msup></mml:mfenced><mml:mi>n</mml:mi></mml:mrow></mml:mfrac></mml:mfenced><mml:mfrac><mml:mn>1</mml:mn><mml:mn>5</mml:mn></mml:mfrac></mml:msup><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula>
</p>
          <p>Using (<xref rid="ece35448-disp-0009" ref-type="disp-formula">A2</xref>) and estimating the unknown quantity <italic>A</italic>(<italic>f</italic>′′), a plug‐in bandwidth for estimator (<xref rid="ece35448-disp-0002" ref-type="disp-formula">1</xref>) can be derived. In Cao et al. (<xref rid="ece35448-bib-0004" ref-type="ref">2011</xref>), a nonparametric estimator for <italic>A</italic>(<italic>f</italic>′′), denoted by <mml:math id="nlm-math-20"><mml:msubsup><mml:mover accent="true"><mml:mi>A</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>η</mml:mi><mml:mi>g</mml:mi></mml:msubsup></mml:math>, depending on an auxiliary smoothing parameter <mml:math id="nlm-math-21"><mml:mi>η</mml:mi></mml:math> was proposed. Plugging <mml:math id="nlm-math-22"><mml:msubsup><mml:mover accent="true"><mml:mi>A</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>η</mml:mi><mml:mi>g</mml:mi></mml:msubsup></mml:math> in (<xref rid="ece35448-disp-0009" ref-type="disp-formula">A2</xref>) gives the plug‐in bandwidth selector for <mml:math id="nlm-math-23"><mml:msubsup><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>h</mml:mi><mml:mi>g</mml:mi></mml:msubsup></mml:math>:<disp-formula id="ece35448-disp-0010"><mml:math id="nlm-math-24"><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>h</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>g</mml:mi><mml:mtext>dens</mml:mtext></mml:msubsup><mml:mo>=</mml:mo><mml:msup><mml:mfenced close="]" open="[" separators=""><mml:mfrac><mml:mrow><mml:mi>A</mml:mi><mml:mfenced close=")" open="("><mml:mi>K</mml:mi></mml:mfenced></mml:mrow><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>K</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:msubsup><mml:mover accent="true"><mml:mi>A</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>η</mml:mi><mml:mi>g</mml:mi></mml:msubsup><mml:mi>n</mml:mi></mml:mrow></mml:mfrac></mml:mfenced><mml:mfrac><mml:mn>1</mml:mn><mml:mn>5</mml:mn></mml:mfrac></mml:msup><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula>
</p>
          <p>In practice, to calculate <mml:math id="nlm-math-25"><mml:msubsup><mml:mover accent="true"><mml:mi>A</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>η</mml:mi><mml:mi>g</mml:mi></mml:msubsup></mml:math> a new bandwidth <mml:math id="nlm-math-26"><mml:mi>η</mml:mi></mml:math> has to be selected. This pilot smoothing parameter can be selected using again a plug‐in procedure, appearing new auxiliary bandwidths, and so on. The usual strategy is to stop this iterative process after two steps and estimate the unknown quantities assuming that <italic>f</italic> is Gaussian.</p>
          <p>As for the bootstrap bandwidth selector for (<xref rid="ece35448-disp-0002" ref-type="disp-formula">1</xref>) implemented in <monospace>bw.dens.binned</monospace>, this is obtained minimizing the bootstrap version of the mean integrated squared error (MISE) of <mml:math id="nlm-math-27"><mml:msubsup><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>h</mml:mi><mml:mi>g</mml:mi></mml:msubsup></mml:math>.</p>
          <p>Using standard calculations, a closed form expression for the MISE of estimator (<xref rid="ece35448-disp-0002" ref-type="disp-formula">1</xref>) is given by:<disp-formula id="ece35448-disp-0011"><label>(A3)</label><mml:math id="nlm-math-28"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mtext>MISE</mml:mtext><mml:mfenced close=")" open="(" separators=""><mml:msubsup><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>h</mml:mi><mml:mi>g</mml:mi></mml:msubsup></mml:mfenced><mml:mo>=</mml:mo><mml:mi mathvariant="double-struck">E</mml:mi><mml:mfenced close="]" open="[" separators=""><mml:mrow><mml:mo>∫</mml:mo><mml:msup><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>h</mml:mi><mml:mi>g</mml:mi></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:mi>f</mml:mi><mml:mfenced close=")" open="("><mml:mi>x</mml:mi></mml:mfenced></mml:mrow></mml:mfenced><mml:mn>2</mml:mn></mml:msup><mml:mi mathvariant="normal">d</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mo>=</mml:mo><mml:mo>∫</mml:mo><mml:msup><mml:mfenced close="]" open="[" separators=""><mml:mrow><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>k</mml:mi></mml:munderover><mml:msub><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>K</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>x</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfenced><mml:mo>-</mml:mo><mml:mi>f</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mfenced><mml:mn>2</mml:mn></mml:msup><mml:mi mathvariant="normal">d</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mi>A</mml:mi><mml:mfenced close=")" open="("><mml:mi>K</mml:mi></mml:mfenced></mml:mrow><mml:mi mathvariant="italic">nh</mml:mi></mml:mfrac><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>n</mml:mi></mml:mfrac><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>k</mml:mi></mml:munderover><mml:mrow><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>k</mml:mi></mml:munderover><mml:msub><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:msub><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>K</mml:mi><mml:mtext>∗</mml:mtext><mml:mi>K</mml:mi></mml:mrow></mml:mfenced><mml:mi>h</mml:mi></mml:msub><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula>where <mml:math id="nlm-math-29"><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>u</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>h</mml:mi></mml:mfrac><mml:mi>K</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mfrac><mml:mi>u</mml:mi><mml:mi>h</mml:mi></mml:mfrac></mml:mfenced></mml:mrow></mml:math>, <italic>p<sub>j</sub></italic> = <italic>F</italic>(<italic>y<sub>j</sub></italic>) − <italic>F</italic>(<italic>y<sub>j</sub></italic>
<sub> − 1</sub>), for <italic>j</italic> = 1, …, <italic>k</italic>, and symbol * stands for convolution.</p>
          <p>The bootstrap version MISE<sup>*</sup> of the MISE is obtained as follows. Let<disp-formula id="ece35448-disp-0012"><mml:math id="nlm-math-30"><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>ζ</mml:mo><mml:mi>g</mml:mi></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>k</mml:mi></mml:munderover><mml:msub><mml:mi>w</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>K</mml:mi><mml:mo>ζ</mml:mo></mml:msub><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>x</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:math></disp-formula>be the estimator (<xref rid="ece35448-disp-0002" ref-type="disp-formula">1</xref>) based on a pilot bandwidth <mml:math id="nlm-math-31"><mml:mo>ζ</mml:mo></mml:math>. Draw a bootstrap sample <mml:math id="nlm-math-32"><mml:mrow><mml:msubsup><mml:mi>X</mml:mi><mml:mn>1</mml:mn><mml:mtext>∗</mml:mtext></mml:msubsup><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:msubsup><mml:mi>X</mml:mi><mml:mn>2</mml:mn><mml:mtext>∗</mml:mtext></mml:msubsup><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:mi>…</mml:mi><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:msubsup><mml:mi>X</mml:mi><mml:mi>n</mml:mi><mml:mtext>∗</mml:mtext></mml:msubsup></mml:mrow></mml:math> from <mml:math id="nlm-math-33"><mml:msubsup><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>ζ</mml:mo><mml:mi>g</mml:mi></mml:msubsup></mml:math> and, given a bandwidth <italic>h</italic>, consider the analogue of the kernel density estimator, <mml:math id="nlm-math-34"><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>h</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mtext>∗</mml:mtext></mml:mrow></mml:msubsup><mml:mfenced close=")" open="("><mml:mi>x</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>k</mml:mi></mml:msubsup><mml:mrow><mml:msubsup><mml:mi>w</mml:mi><mml:mi>i</mml:mi><mml:mtext>∗</mml:mtext></mml:msubsup><mml:msub><mml:mi>K</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>x</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mrow></mml:math>, where <mml:math id="nlm-math-35"><mml:mrow><mml:msubsup><mml:mi>w</mml:mi><mml:mi>i</mml:mi><mml:mtext>∗</mml:mtext></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi>F</mml:mi><mml:mi>n</mml:mi><mml:mtext>∗</mml:mtext></mml:msubsup><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>-</mml:mo></mml:mrow></mml:mfenced><mml:mo>-</mml:mo><mml:msubsup><mml:mi>F</mml:mi><mml:mi>n</mml:mi><mml:mtext>∗</mml:mtext></mml:msubsup><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>-</mml:mo></mml:mrow></mml:mfenced></mml:mrow></mml:math>, with <mml:math id="nlm-math-36"><mml:mrow><mml:msubsup><mml:mi>F</mml:mi><mml:mi>n</mml:mi><mml:mtext>∗</mml:mtext></mml:msubsup><mml:mfenced close=")" open="("><mml:mi>y</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>n</mml:mi></mml:mfrac><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:msub><mml:mn>1</mml:mn><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msubsup><mml:mi>X</mml:mi><mml:mi>i</mml:mi><mml:mtext>∗</mml:mtext></mml:msubsup><mml:mo>≤</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:math>. Then<disp-formula id="ece35448-disp-0013"><label>(A4)</label><mml:math id="nlm-math-37"><mml:mrow><mml:msup><mml:mtext>MISE</mml:mtext><mml:mtext>∗</mml:mtext></mml:msup><mml:mfenced close=")" open="(" separators=""><mml:msubsup><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>h</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mtext>∗</mml:mtext></mml:mrow></mml:msubsup></mml:mfenced><mml:mo>=</mml:mo><mml:msup><mml:mi mathvariant="double-struck">E</mml:mi><mml:mtext>∗</mml:mtext></mml:msup><mml:mfenced close="]" open="[" separators=""><mml:mrow><mml:mo>∫</mml:mo><mml:msup><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>h</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mtext>∗</mml:mtext></mml:mrow></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>ζ</mml:mo><mml:mi>g</mml:mi></mml:msubsup><mml:mfenced close=")" open="("><mml:mi>x</mml:mi></mml:mfenced></mml:mrow></mml:mfenced><mml:mn>2</mml:mn></mml:msup><mml:mi mathvariant="normal">d</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <mml:math id="nlm-math-38"><mml:msup><mml:mi mathvariant="double-struck">E</mml:mi><mml:mtext>∗</mml:mtext></mml:msup></mml:math> denotes the bootstrap expectation (with respect to <mml:math id="nlm-math-39"><mml:msubsup><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>ζ</mml:mo><mml:mi>g</mml:mi></mml:msubsup></mml:math>).</p>
          <p>Using a parallel process to that followed to obtain (3), it is possible to derive a closed representation for (4). This expression is given by<disp-formula id="ece35448-disp-0014"><label>(A5)</label><mml:math id="nlm-math-40"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msup><mml:mtext>MISE</mml:mtext><mml:mtext>∗</mml:mtext></mml:msup><mml:mfenced close=")" open="(" separators=""><mml:msubsup><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>h</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mtext>∗</mml:mtext></mml:mrow></mml:msubsup></mml:mfenced><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:mfrac><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>k</mml:mi></mml:munderover><mml:mrow><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>k</mml:mi></mml:munderover><mml:msubsup><mml:mi>w</mml:mi><mml:mi>i</mml:mi><mml:mo>ζ</mml:mo></mml:msubsup></mml:mrow><mml:msubsup><mml:mi>w</mml:mi><mml:mi>j</mml:mi><mml:mo>ζ</mml:mo></mml:msubsup><mml:msub><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>K</mml:mi><mml:mtext>∗</mml:mtext><mml:mi>K</mml:mi></mml:mrow></mml:mfenced><mml:mi>h</mml:mi></mml:msub><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mo>-</mml:mo><mml:mn>2</mml:mn><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>k</mml:mi></mml:munderover><mml:mrow><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>k</mml:mi></mml:munderover><mml:msubsup><mml:mi>w</mml:mi><mml:mi>i</mml:mi><mml:mo>ζ</mml:mo></mml:msubsup></mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mtext>∗</mml:mtext><mml:msub><mml:mi>K</mml:mi><mml:mo>ζ</mml:mo></mml:msub></mml:mrow></mml:mfenced><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mo>+</mml:mo><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>k</mml:mi></mml:munderover><mml:mrow><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>k</mml:mi></mml:munderover><mml:msub><mml:mi>w</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:msub><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>K</mml:mi><mml:mtext>∗</mml:mtext><mml:mi>K</mml:mi></mml:mrow></mml:mfenced><mml:mo>ζ</mml:mo></mml:msub><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mi>A</mml:mi><mml:mfenced close=")" open="("><mml:mi>K</mml:mi></mml:mfenced></mml:mrow><mml:mi mathvariant="italic">nh</mml:mi></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula>
</p>
          <p>Note that expression (<xref rid="ece35448-disp-0014" ref-type="disp-formula">A5</xref>) allows us to directly evaluate MISE* over a grid of values of <italic>h</italic>, without using Monte Carlo. The bootstrap bandwidth <mml:math id="nlm-math-41"><mml:msubsup><mml:mi>h</mml:mi><mml:mtext>MISE</mml:mtext><mml:mtext>∗</mml:mtext></mml:msubsup></mml:math> is obtained minimizing (<xref rid="ece35448-disp-0014" ref-type="disp-formula">A5</xref>), that is,<disp-formula id="ece35448-disp-0015"><mml:math id="nlm-math-42"><mml:mrow><mml:msubsup><mml:mi>h</mml:mi><mml:mtext>dens</mml:mtext><mml:mtext>∗</mml:mtext></mml:msubsup><mml:mo>=</mml:mo><mml:munder><mml:mtext>argmin</mml:mtext><mml:mrow><mml:mi>h</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:munder><mml:msup><mml:mtext>MISE</mml:mtext><mml:mtext>∗</mml:mtext></mml:msup><mml:mfenced close=")" open="(" separators=""><mml:msubsup><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>h</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mtext>∗</mml:mtext></mml:mrow></mml:msubsup></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
</p>
          <p>To select the pilot bandwidth <mml:math id="nlm-math-43"><mml:mo>ζ</mml:mo></mml:math>, the method implemented in the <monospace>binnednp</monospace> package is inspired by the idea of smoothing splines, based on selecting the pilot parameter that minimizes the squared distance between the nonparametric density estimator, <mml:math id="nlm-math-44"><mml:msubsup><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>h</mml:mi><mml:mi>g</mml:mi></mml:msubsup></mml:math>, and the histogram of the grouped data, <mml:math id="nlm-math-45"><mml:mover accent="true"><mml:mi>H</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math>, plus a penalty term to avoid obtaining very small bandwidths. The idea consists in finding the parameter denoted by <mml:math id="nlm-math-46"><mml:msubsup><mml:mo>ζ</mml:mo><mml:mtext>hist</mml:mtext><mml:mi>λ</mml:mi></mml:msubsup></mml:math>, such that,<disp-formula id="ece35448-disp-0016"><mml:math id="nlm-math-47"><mml:mrow><mml:msubsup><mml:mo>ζ</mml:mo><mml:mtext>hist</mml:mtext><mml:mi>λ</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mspace width="0.166667em"/><mml:munder><mml:mtext>argmin</mml:mtext><mml:mrow><mml:mi>h</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:munder><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>k</mml:mi></mml:munderover><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo></mml:mrow><mml:mover accent="true"><mml:mi>H</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mo stretchy="false">(</mml:mo></mml:mrow></mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msup><mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>-</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>h</mml:mi><mml:mi>g</mml:mi></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:mi>λ</mml:mi><mml:mo>∫</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>h</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>″</mml:mo></mml:mrow></mml:msubsup><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mi mathvariant="normal">d</mml:mi><mml:mi>x</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <mml:math id="nlm-math-48"><mml:mrow><mml:mi>λ</mml:mi><mml:mo>≥</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math> determines the penalty degree over the global curvature of the nonparametric density estimator, defined in (<xref rid="ece35448-disp-0002" ref-type="disp-formula">1</xref>). To select an ''optimal'' penalty degree, <mml:math id="nlm-math-49"><mml:msub><mml:mi>λ</mml:mi><mml:mtext>opt</mml:mtext></mml:msub></mml:math>, we have used the rule of finding the penalty allowing to obtain a pilot bandwidth that best approximate the overall curvature of the population density, that is,<disp-formula id="ece35448-disp-0017"><mml:math id="nlm-math-50"><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mtext>opt</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mtext>argmin</mml:mtext><mml:mrow><mml:mi>λ</mml:mi><mml:mo>≥</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:munder><mml:mfenced close="|" open="|" separators=""><mml:mrow><mml:mi>A</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:msubsup><mml:mo>ζ</mml:mo><mml:mtext>hist</mml:mtext><mml:mi>λ</mml:mi></mml:msubsup><mml:mrow><mml:mi>g</mml:mi><mml:mo>″</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:mi>A</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>f</mml:mi><mml:mo>″</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mfenced><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula>
</p>
          <p>In practice, <mml:math id="nlm-math-51"><mml:msub><mml:mi>λ</mml:mi><mml:mtext>opt</mml:mtext></mml:msub></mml:math> can be estimated by<disp-formula id="ece35448-disp-0018"><mml:math id="nlm-math-52"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>λ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mtext>opt</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mtext>argmin</mml:mtext><mml:msub><mml:mspace width="0.277778em"/><mml:mrow><mml:mi>λ</mml:mi><mml:mo>≥</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:munder><mml:mfenced close="|" open="|" separators=""><mml:mrow><mml:mi>A</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:msubsup><mml:mo>ζ</mml:mo><mml:mtext>hist</mml:mtext><mml:mi>λ</mml:mi></mml:msubsup><mml:mrow><mml:mi>g</mml:mi><mml:mo>″</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:mi>A</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mtext>mix</mml:mtext><mml:mo>″</mml:mo></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <mml:math id="nlm-math-53"><mml:msub><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mtext>mix</mml:mtext></mml:msub></mml:math> is a normal mixture model with a maximum number of <italic>r</italic> = 5 components fitted with the grouped‐data sample. In practice, the expectation–maximization (EM) method was used to estimate the parameters of the mixture model, using the BIC criterion to select the best fit.</p>
        </sec>
        <sec id="ece35448-sec-0019">
          <title>BANDWIDTH SELECTION FOR THE DISTRIBUTION FUNCTION</title>
          <p>Following analogous arguments to those described for the case of the density function, plug‐in and bootstrap bandwidth selectors can be proposed for the nonparametric distribution estimator given in (<xref rid="ece35448-disp-0003" ref-type="disp-formula">2</xref>). They are implemented in the functions bw.dist.binned and bw.dist.binned.boot, respectively.</p>
          <p>Regarding the plug‐in bandwidth, under some assumptions, it can be obtained that the AMISE of (<xref rid="ece35448-disp-0003" ref-type="disp-formula">2</xref>) is:<disp-formula id="ece35448-disp-0019"><label>(A6)</label><mml:math id="nlm-math-54"><mml:mrow><mml:mi mathvariant="normal">AMISE</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:msubsup><mml:mover accent="true"><mml:mi>F</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>h</mml:mi><mml:mi>g</mml:mi></mml:msubsup></mml:mfenced><mml:mo>=</mml:mo><mml:mfrac><mml:msup><mml:mi>h</mml:mi><mml:mn>4</mml:mn></mml:msup><mml:mn>4</mml:mn></mml:mfrac><mml:msub><mml:mi>μ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msup><mml:mfenced close=")" open="("><mml:mi>K</mml:mi></mml:mfenced><mml:mn>2</mml:mn></mml:msup><mml:mi>A</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:msup><mml:mi>f</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mfenced><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>n</mml:mi></mml:mfrac><mml:mo>∫</mml:mo><mml:mi>F</mml:mi><mml:mfenced close=")" open="("><mml:mi>x</mml:mi></mml:mfenced><mml:mfenced close="]" open="[" separators=""><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>F</mml:mi><mml:mfenced close=")" open="("><mml:mi>x</mml:mi></mml:mfenced></mml:mrow></mml:mfenced><mml:mi mathvariant="normal">d</mml:mi><mml:mi>x</mml:mi><mml:mo>-</mml:mo><mml:mfrac><mml:mi>h</mml:mi><mml:mi>n</mml:mi></mml:mfrac><mml:msub><mml:mi>C</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></disp-formula>with <mml:math id="nlm-math-55"><mml:mrow><mml:mi>A</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:msup><mml:mi>f</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mfenced><mml:mo>=</mml:mo><mml:mo>∫</mml:mo><mml:msup><mml:mi>f</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mi mathvariant="normal">d</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:math>, and<disp-formula id="ece35448-disp-0020"><mml:math id="nlm-math-56"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mo>∫</mml:mo><mml:mi>z</mml:mi><mml:mi>K</mml:mi><mml:mfenced close=")" open="("><mml:mi>z</mml:mi></mml:mfenced><mml:mi mathvariant="double-struck">K</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mi>z</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula>
</p>
          <p>From equation (<xref rid="ece35448-disp-0019" ref-type="disp-formula">A6</xref>), it is immediate to get an asymptotically optimal global bandwidth for <mml:math id="nlm-math-57"><mml:msubsup><mml:mover accent="true"><mml:mi>F</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>h</mml:mi><mml:mi>g</mml:mi></mml:msubsup></mml:math>. Taking the first derivative of (<xref rid="ece35448-disp-0019" ref-type="disp-formula">A6</xref>), equating to zero and solving for <italic>h</italic>, it is obtained<disp-formula id="ece35448-disp-0021"><label>(A7)</label><mml:math id="nlm-math-58"><mml:mrow><mml:msubsup><mml:mi>h</mml:mi><mml:mi>g</mml:mi><mml:mtext>dist</mml:mtext></mml:msubsup><mml:mo>=</mml:mo><mml:msup><mml:mfenced close="]" open="[" separators=""><mml:mfrac><mml:msub><mml:mi>C</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msup><mml:mfenced close=")" open="("><mml:mi>K</mml:mi></mml:mfenced><mml:mn>2</mml:mn></mml:msup><mml:mi>A</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:msup><mml:mi>f</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mfenced><mml:mi>n</mml:mi></mml:mrow></mml:mfrac></mml:mfenced><mml:mfrac><mml:mn>1</mml:mn><mml:mn>3</mml:mn></mml:mfrac></mml:msup><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula>
</p>
          <p>In equation (<xref rid="ece35448-disp-0021" ref-type="disp-formula">A7</xref>), an estimate of <italic>A</italic>(<italic>f</italic>′) is required to have a practical bandwidth. Using a similar process to that described for the case of the density estimator, a practical plug‐in bandwidth selector for <mml:math id="nlm-math-59"><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>F</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>h</mml:mi><mml:mi>g</mml:mi></mml:msubsup><mml:mfenced close=")" open="("><mml:mi>x</mml:mi></mml:mfenced></mml:mrow></mml:math> is obtained:<disp-formula id="ece35448-disp-0022"><mml:math id="nlm-math-60"><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>h</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>g</mml:mi><mml:mtext>dist</mml:mtext></mml:msubsup><mml:mo>=</mml:mo><mml:msup><mml:mfenced close="]" open="[" separators=""><mml:mfrac><mml:msub><mml:mi>C</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msup><mml:mfenced close=")" open="("><mml:mi>K</mml:mi></mml:mfenced><mml:mn>2</mml:mn></mml:msup><mml:msubsup><mml:mover accent="true"><mml:mi>A</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mi>η</mml:mi><mml:mi>g</mml:mi></mml:msubsup><mml:mi>n</mml:mi></mml:mrow></mml:mfrac></mml:mfenced><mml:mfrac><mml:mn>1</mml:mn><mml:mn>3</mml:mn></mml:mfrac></mml:msup><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <mml:math id="nlm-math-61"><mml:msubsup><mml:mover accent="true"><mml:mi>A</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mi>η</mml:mi><mml:mi>g</mml:mi></mml:msubsup></mml:math> denotes an estimator of <italic>A</italic>(<italic>f</italic>′) depending on a pilot bandwidth<mml:math id="nlm-math-62"><mml:mi>η</mml:mi></mml:math>. A similar iterative procedure to that described in the case of the density function is used here.</p>
          <p>On the other hand, the bootstrap bandwidth implemented in the function bw.dist.binned.boot is based on minimizing the bootstrap version of the MISE of <mml:math id="nlm-math-63"><mml:msubsup><mml:mover accent="true"><mml:mi>F</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>h</mml:mi><mml:mi>g</mml:mi></mml:msubsup></mml:math>.</p>
          <p>In this case, using standard calculations and assuming that <italic>F</italic>(<italic>y<sub>k</sub></italic>) = 1 and <italic>F</italic>(<italic>y</italic>
<sub>0</sub>) = 0, it is easy to prove that the expectation and the variance of <mml:math id="nlm-math-64"><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>F</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>h</mml:mi><mml:mi>g</mml:mi></mml:msubsup><mml:mfenced close=")" open="("><mml:mi>x</mml:mi></mml:mfenced></mml:mrow></mml:math> are, respectively,<disp-formula id="ece35448-disp-0023"><label>(A8)</label><mml:math id="nlm-math-65"><mml:mrow><mml:mi mathvariant="double-struck">E</mml:mi><mml:mfenced close="]" open="[" separators=""><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>F</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>h</mml:mi><mml:mi>g</mml:mi></mml:msubsup><mml:mfenced close=")" open="("><mml:mi>x</mml:mi></mml:mfenced></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>k</mml:mi></mml:munderover><mml:mi mathvariant="double-struck">K</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mfrac><mml:mrow><mml:mi>x</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mi>h</mml:mi></mml:mfrac></mml:mfenced><mml:msub><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></disp-formula>and<disp-formula id="ece35448-disp-0024"><label>(A9)</label><mml:math id="nlm-math-66"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mi mathvariant="double-struck">V</mml:mi><mml:mfenced close="]" open="[" separators=""><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>F</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>h</mml:mi><mml:mi>g</mml:mi></mml:msubsup><mml:mfenced close=")" open="("><mml:mi>x</mml:mi></mml:mfenced></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>n</mml:mi></mml:mfrac><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>k</mml:mi></mml:munderover><mml:msup><mml:mi mathvariant="double-struck">K</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mfenced close=")" open="(" separators=""><mml:mfrac><mml:mrow><mml:mi>x</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mi>h</mml:mi></mml:mfrac></mml:mfenced><mml:msub><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mo>-</mml:mo><mml:mfrac><mml:mn>2</mml:mn><mml:mi>n</mml:mi></mml:mfrac><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:mi mathvariant="double-struck">K</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mfrac><mml:mrow><mml:mi>x</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mi>h</mml:mi></mml:mfrac></mml:mfenced><mml:mi mathvariant="double-struck">K</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mfrac><mml:mrow><mml:mi>x</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mi>h</mml:mi></mml:mfrac></mml:mfenced><mml:msub><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>p</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula>
</p>
          <p>From (<xref rid="ece35448-disp-0023" ref-type="disp-formula">A8</xref>) and (<xref rid="ece35448-disp-0024" ref-type="disp-formula">A9</xref>), it is straightforward to obtain a closed expression for the MISE of the estimator defined in (<xref rid="ece35448-disp-0003" ref-type="disp-formula">2</xref>):<disp-formula id="ece35448-disp-0025"><mml:math id="nlm-math-67"><mml:mrow><mml:mtext>MISE</mml:mtext><mml:mfenced close=")" open="(" separators=""><mml:msubsup><mml:mover accent="true"><mml:mi>F</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>h</mml:mi><mml:mi>g</mml:mi></mml:msubsup></mml:mfenced><mml:mo>=</mml:mo><mml:mi mathvariant="double-struck">E</mml:mi><mml:mfenced close="}" open="{" separators=""><mml:mrow><mml:mo>∫</mml:mo><mml:msup><mml:mfenced close="]" open="[" separators=""><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>F</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>h</mml:mi><mml:mi>g</mml:mi></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:mi>F</mml:mi><mml:mfenced close=")" open="("><mml:mi>x</mml:mi></mml:mfenced></mml:mrow></mml:mfenced><mml:mn>2</mml:mn></mml:msup><mml:mi mathvariant="normal">d</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mi>B</mml:mi><mml:mo>+</mml:mo><mml:mi>V</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where,<disp-formula id="ece35448-disp-0026"><mml:math id="nlm-math-68"><mml:mrow><mml:mi>B</mml:mi><mml:mo>=</mml:mo><mml:mo>∫</mml:mo><mml:msup><mml:mfenced close="}" open="{" separators=""><mml:mrow><mml:mi mathvariant="double-struck">E</mml:mi><mml:mfenced close="]" open="[" separators=""><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>F</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>h</mml:mi><mml:mi>g</mml:mi></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mfenced><mml:mo>-</mml:mo><mml:mi>F</mml:mi><mml:mfenced close=")" open="("><mml:mi>x</mml:mi></mml:mfenced></mml:mrow></mml:mfenced><mml:mn>2</mml:mn></mml:msup><mml:mi mathvariant="normal">d</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:math></disp-formula>denotes the integrated squared bias and<disp-formula id="ece35448-disp-0027"><mml:math id="nlm-math-69"><mml:mrow><mml:mi>V</mml:mi><mml:mo>=</mml:mo><mml:mo>∫</mml:mo><mml:mi mathvariant="double-struck">V</mml:mi><mml:mfenced close="]" open="[" separators=""><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>F</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>h</mml:mi><mml:mi>g</mml:mi></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mfenced><mml:mi mathvariant="normal">d</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:math></disp-formula>is the integrated variance.</p>
          <p>To build a bootstrap version of MISE, we consider a pilot bandwidth, <mml:math id="nlm-math-70"><mml:mo>ζ</mml:mo></mml:math>, and construct the grouped‐data smooth estimator of <italic>F</italic> as defined in (<xref rid="ece35448-disp-0003" ref-type="disp-formula">2</xref>), but replacing <italic>h</italic> by <mml:math id="nlm-math-71"><mml:mo>ζ</mml:mo></mml:math>. The idea is to draw resamples from <mml:math id="nlm-math-72"><mml:msubsup><mml:mover accent="true"><mml:mi>F</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>ζ</mml:mo><mml:mi>g</mml:mi></mml:msubsup></mml:math>, to group the data and to compute the estimator <mml:math id="nlm-math-73"><mml:msubsup><mml:mover accent="true"><mml:mi>F</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>h</mml:mi><mml:mi>g</mml:mi></mml:msubsup></mml:math> with those bootstrap samples. The bootstrap resampling plan proceeds as follows.</p>
          <p>
            <list list-type="order" id="wer1136-list-0001">
              <list-item>
                <p>Fix some pilot bandwidth, <mml:math id="nlm-math-74"><mml:mo>ζ</mml:mo></mml:math>, and consider the grouped‐data smooth cdf estimator, <mml:math id="nlm-math-75"><mml:msubsup><mml:mover accent="true"><mml:mi>F</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>ζ</mml:mo><mml:mi>g</mml:mi></mml:msubsup></mml:math>.</p>
              </list-item>
              <list-item>
                <p>Draw <mml:math id="nlm-math-76"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mn>1</mml:mn><mml:mtext>∗</mml:mtext></mml:msubsup><mml:mo>,</mml:mo><mml:mi>…</mml:mi><mml:mo>,</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>k</mml:mi><mml:mtext>∗</mml:mtext></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math> from a multinomial distribution <mml:math id="nlm-math-77"><mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mi>;</mml:mi><mml:msubsup><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mi>~</mml:mi></mml:mover><mml:mn>1</mml:mn><mml:mo>ζ</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:mi>…</mml:mi><mml:mo>,</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mi>~</mml:mi></mml:mover><mml:mi>k</mml:mi><mml:mo>ζ</mml:mo></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math> with <mml:math id="nlm-math-78"><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mi>~</mml:mi></mml:mover><mml:mi>i</mml:mi><mml:mo>ζ</mml:mo></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi>F</mml:mi><mml:mi>^</mml:mi></mml:mover><mml:mo>ζ</mml:mo><mml:mi>g</mml:mi></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi>F</mml:mi><mml:mi>^</mml:mi></mml:mover><mml:mo>ζ</mml:mo><mml:mi>g</mml:mi></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>⋯</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:math>, and define <mml:math id="nlm-math-79"><mml:mrow><mml:msubsup><mml:mi>w</mml:mi><mml:mi>i</mml:mi><mml:mtext>∗</mml:mtext></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>i</mml:mi><mml:mtext>∗</mml:mtext></mml:msubsup><mml:mo stretchy="false">/</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math>.</p>
              </list-item>
              <list-item>
                <p>Compute the grouped‐data smooth cdf estimator based on this bootstrap resample:<disp-formula id="ece35448-disp-0028"><mml:math id="nlm-math-80"><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>F</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>h</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mtext>∗</mml:mtext></mml:mrow></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>k</mml:mi></mml:munderover><mml:msubsup><mml:mi>w</mml:mi><mml:mi>i</mml:mi><mml:mtext>∗</mml:mtext></mml:msubsup><mml:mi mathvariant="double-struck">K</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mfrac><mml:mrow><mml:mi>x</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mi>h</mml:mi></mml:mfrac></mml:mfenced><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula>
</p>
              </list-item>
              <list-item>
                <p>Define the bootstrap version of MISE<disp-formula id="ece35448-disp-0029"><mml:math id="nlm-math-81"><mml:mrow><mml:msup><mml:mtext>MISE</mml:mtext><mml:mtext>∗</mml:mtext></mml:msup><mml:mfenced close=")" open="(" separators=""><mml:msubsup><mml:mover accent="true"><mml:mi>F</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>h</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mtext>∗</mml:mtext></mml:mrow></mml:msubsup></mml:mfenced><mml:mo>=</mml:mo><mml:msup><mml:mi mathvariant="double-struck">E</mml:mi><mml:mtext>∗</mml:mtext></mml:msup><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mo>∫</mml:mo><mml:msup><mml:mfenced close="]" open="[" separators=""><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>F</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>h</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mtext>∗</mml:mtext></mml:mrow></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi>F</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>ζ</mml:mo><mml:mi>g</mml:mi></mml:msubsup><mml:mfenced close=")" open="("><mml:mi>x</mml:mi></mml:mfenced></mml:mrow></mml:mfenced><mml:mn>2</mml:mn></mml:msup><mml:mi mathvariant="normal">d</mml:mi><mml:mi>x</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
</p>
              </list-item>
            </list>
          </p>
          <p>where, <mml:math id="nlm-math-82"><mml:msup><mml:mi mathvariant="double-struck">E</mml:mi><mml:mtext>∗</mml:mtext></mml:msup></mml:math> denotes the bootstrap expectation (with respect to <mml:math id="nlm-math-83"><mml:msubsup><mml:mover accent="true"><mml:mi>F</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>ζ</mml:mo><mml:mi>g</mml:mi></mml:msubsup></mml:math>).</p>
          <p>Therefore, defining<disp-formula id="ece35448-disp-0030"><mml:math id="nlm-math-84"><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mi>^</mml:mi></mml:mover><mml:mi>i</mml:mi><mml:mo>ζ</mml:mo></mml:msubsup><mml:mo>=</mml:mo><mml:mfrac><mml:msubsup><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mi>~</mml:mi></mml:mover><mml:mi>i</mml:mi><mml:mo>ζ</mml:mo></mml:msubsup><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>k</mml:mi></mml:msubsup><mml:msubsup><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mi>~</mml:mi></mml:mover><mml:mi>j</mml:mi><mml:mo>ζ</mml:mo></mml:msubsup></mml:mrow></mml:mfrac><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>…</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>and substituting <italic>p<sub>i</sub></italic> by <mml:math id="nlm-math-85"><mml:msubsup><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mi>^</mml:mi></mml:mover><mml:mi>i</mml:mi><mml:mo>ζ</mml:mo></mml:msubsup></mml:math> in (<xref rid="ece35448-disp-0023" ref-type="disp-formula">A8</xref>) and (<xref rid="ece35448-disp-0024" ref-type="disp-formula">A9</xref>), the bootstrap version of the MISE admits the following closed expression:<disp-formula id="ece35448-disp-0031"><mml:math id="nlm-math-86"><mml:mrow><mml:msup><mml:mtext>MISE</mml:mtext><mml:mtext>∗</mml:mtext></mml:msup><mml:mfenced close=")" open="(" separators=""><mml:msubsup><mml:mover accent="true"><mml:mi>F</mml:mi><mml:mi>^</mml:mi></mml:mover><mml:mi>h</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mtext>∗</mml:mtext></mml:mrow></mml:msubsup></mml:mfenced><mml:mo>=</mml:mo><mml:msup><mml:mi mathvariant="double-struck">E</mml:mi><mml:mtext>∗</mml:mtext></mml:msup><mml:mrow><mml:mo>{</mml:mo><mml:mo>∫</mml:mo><mml:msup><mml:mfenced close="]" open="[" separators=""><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>F</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>h</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mtext>∗</mml:mtext></mml:mrow></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi>F</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>ζ</mml:mo><mml:mi>g</mml:mi></mml:msubsup><mml:mfenced close=")" open="("><mml:mi>x</mml:mi></mml:mfenced></mml:mrow></mml:mfenced><mml:mn>2</mml:mn></mml:msup><mml:mi mathvariant="normal">d</mml:mi><mml:mi>x</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mi>B</mml:mi><mml:mtext>∗</mml:mtext></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mi>V</mml:mi><mml:mtext>∗</mml:mtext></mml:msup><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where<disp-formula id="ece35448-disp-0032"><mml:math id="nlm-math-87"><mml:mrow><mml:msup><mml:mi>B</mml:mi><mml:mtext>∗</mml:mtext></mml:msup><mml:mo>=</mml:mo><mml:mo largeop="false">∫</mml:mo><mml:mspace width="0.166667em"/><mml:msup><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msup><mml:mi mathvariant="double-struck">E</mml:mi><mml:mtext>∗</mml:mtext></mml:msup><mml:mfenced close="]" open="[" separators=""><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>F</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>h</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mtext>∗</mml:mtext></mml:mrow></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mfenced><mml:mo>-</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi>F</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>ζ</mml:mo><mml:mi>g</mml:mi></mml:msubsup><mml:mfenced close=")" open="("><mml:mi>x</mml:mi></mml:mfenced><mml:mo stretchy="false">}</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mi mathvariant="normal">d</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:math></disp-formula>and<disp-formula id="ece35448-disp-0033"><mml:math id="nlm-math-88"><mml:mrow><mml:msup><mml:mi>V</mml:mi><mml:mtext>∗</mml:mtext></mml:msup><mml:mo>=</mml:mo><mml:mo>∫</mml:mo><mml:msup><mml:mi mathvariant="double-struck">V</mml:mi><mml:mtext>∗</mml:mtext></mml:msup><mml:mfenced close="]" open="[" separators=""><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>F</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>h</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mtext>∗</mml:mtext></mml:mrow></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mfenced><mml:mi mathvariant="normal">d</mml:mi><mml:mi>x</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>with<disp-formula id="ece35448-disp-0034"><mml:math id="nlm-math-89"><mml:mrow><mml:msup><mml:mi mathvariant="double-struck">E</mml:mi><mml:mtext>∗</mml:mtext></mml:msup><mml:mfenced close="]" open="[" separators=""><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>F</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>h</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mtext>∗</mml:mtext></mml:mrow></mml:msubsup><mml:mfenced close=")" open="("><mml:mi>x</mml:mi></mml:mfenced></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>k</mml:mi></mml:munderover><mml:mi mathvariant="double-struck">K</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mfrac><mml:mrow><mml:mi>x</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mi>h</mml:mi></mml:mfrac></mml:mfenced><mml:msubsup><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>i</mml:mi><mml:mo>ζ</mml:mo></mml:msubsup></mml:mrow></mml:math></disp-formula>and<disp-formula id="ece35448-disp-0035"><mml:math id="nlm-math-90"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msup><mml:mi mathvariant="double-struck">V</mml:mi><mml:mtext>∗</mml:mtext></mml:msup><mml:mfenced close="]" open="[" separators=""><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>F</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>h</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mtext>∗</mml:mtext></mml:mrow></mml:msubsup><mml:mfenced close=")" open="("><mml:mi>x</mml:mi></mml:mfenced></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>n</mml:mi></mml:mfrac><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>k</mml:mi></mml:munderover><mml:msup><mml:mi mathvariant="double-struck">K</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mfenced close=")" open="(" separators=""><mml:mfrac><mml:mrow><mml:mi>x</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mi>h</mml:mi></mml:mfrac></mml:mfenced><mml:msubsup><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>i</mml:mi><mml:mo>ζ</mml:mo></mml:msubsup><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>i</mml:mi><mml:mo>ζ</mml:mo></mml:msubsup></mml:mrow></mml:mfenced></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mo>-</mml:mo><mml:mfrac><mml:mn>2</mml:mn><mml:mi>n</mml:mi></mml:mfrac><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:mi mathvariant="double-struck">K</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mfrac><mml:mrow><mml:mi>x</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mi>h</mml:mi></mml:mfrac></mml:mfenced><mml:mi mathvariant="double-struck">K</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mfrac><mml:mrow><mml:mi>x</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mi>h</mml:mi></mml:mfrac></mml:mfenced><mml:msubsup><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>i</mml:mi><mml:mo>ζ</mml:mo></mml:msubsup><mml:msubsup><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>j</mml:mi><mml:mo>ζ</mml:mo></mml:msubsup><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula>
</p>
          <p>Finally, the bootstrap bandwidth is defined as the minimizer of <mml:math id="nlm-math-91"><mml:mrow><mml:msup><mml:mtext>MISE</mml:mtext><mml:mtext>∗</mml:mtext></mml:msup><mml:mfenced close=")" open="(" separators=""><mml:msubsup><mml:mover accent="true"><mml:mi>F</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>h</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mtext>∗</mml:mtext></mml:mrow></mml:msubsup></mml:mfenced></mml:mrow></mml:math>, in the smoothing parameter, <italic>h</italic>:<disp-formula id="ece35448-disp-0036"><mml:math id="nlm-math-92"><mml:mrow><mml:msubsup><mml:mi>h</mml:mi><mml:mtext>dist</mml:mtext><mml:mtext>∗</mml:mtext></mml:msubsup><mml:mo>=</mml:mo><mml:mspace width="0.166667em"/><mml:munder><mml:mtext>argmin</mml:mtext><mml:mrow><mml:mi>h</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:munder><mml:msup><mml:mtext>MISE</mml:mtext><mml:mtext>∗</mml:mtext></mml:msup><mml:mfenced close=")" open="(" separators=""><mml:msubsup><mml:mover accent="true"><mml:mi>F</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>h</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mtext>∗</mml:mtext></mml:mrow></mml:msubsup></mml:mfenced><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula>
</p>
          <p>As in the case of the bootstrap bandwidth selector for the density function, an important step in this bootstrap procedure is that of selecting the pilot bandwidth <mml:math id="nlm-math-93"><mml:mo>ζ</mml:mo></mml:math>. The same type of procedure inspired by the idea of smoothing splines, but adapted for the distribution function, was employed. In this case, the idea consists in finding the parameter, denoted by <mml:math id="nlm-math-94"><mml:msubsup><mml:mo>ζ</mml:mo><mml:mtext>emp</mml:mtext><mml:mi>λ</mml:mi></mml:msubsup></mml:math>, such that,<disp-formula id="ece35448-disp-0037"><mml:math id="nlm-math-95"><mml:mrow><mml:msubsup><mml:mo>ζ</mml:mo><mml:mtext>emp</mml:mtext><mml:mi>λ</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:munder><mml:mtext>argmin</mml:mtext><mml:mrow><mml:mi>h</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:munder><mml:mspace width="0.166667em"/><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mi>k</mml:mi></mml:munderover><mml:msup><mml:mfenced close="]" open="[" separators=""><mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi>F</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>h</mml:mi><mml:mi>g</mml:mi></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mfenced><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:mi>λ</mml:mi><mml:mo>∫</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>h</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:msubsup><mml:msup><mml:mfenced close=")" open="("><mml:mi>x</mml:mi></mml:mfenced><mml:mn>2</mml:mn></mml:msup><mml:mi mathvariant="normal">d</mml:mi><mml:mi>x</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <mml:math id="nlm-math-96"><mml:mrow><mml:mi>λ</mml:mi><mml:mo>≥</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math> determines the penalty degree over the global slope of the nonparametric density estimator, defined in (<xref rid="ece35448-disp-0003" ref-type="disp-formula">2</xref>). To select an “optimal” penalty degree, <mml:math id="nlm-math-97"><mml:msub><mml:mi>λ</mml:mi><mml:mtext>opt</mml:mtext></mml:msub></mml:math>, we have used the rule of finding the penalty allowing to obtain a pilot bandwidth that best approximate the overall slope of the population density, that is,<disp-formula id="ece35448-disp-0038"><mml:math id="nlm-math-98"><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mtext>opt</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mtext>argmin</mml:mtext><mml:mrow><mml:mi>λ</mml:mi><mml:mo>≥</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:munder><mml:mspace width="0.166667em"/><mml:mfenced close="|" open="|" separators=""><mml:mrow><mml:mi>A</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:msubsup><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:msubsup><mml:mo>ζ</mml:mo><mml:mtext>emp</mml:mtext><mml:mi>λ</mml:mi></mml:msubsup><mml:mrow><mml:mi>g</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:msubsup></mml:mfenced><mml:mo>-</mml:mo><mml:mi>A</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>f</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mfenced><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula>
</p>
          <p>In practice, <mml:math id="nlm-math-99"><mml:msub><mml:mi>λ</mml:mi><mml:mtext>opt</mml:mtext></mml:msub></mml:math> can be estimated by<disp-formula id="ece35448-disp-0039"><mml:math id="nlm-math-100"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>λ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mtext>opt</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mtext>argmin</mml:mtext><mml:mrow><mml:mi>λ</mml:mi><mml:mo>≥</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:munder><mml:mfenced close="|" open="|" separators=""><mml:mrow><mml:mi>A</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:msubsup><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:msubsup><mml:mo>ζ</mml:mo><mml:mtext>emp</mml:mtext><mml:mi>λ</mml:mi></mml:msubsup><mml:mrow><mml:mi>g</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:msubsup></mml:mfenced><mml:mo>-</mml:mo><mml:mi>A</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>θ</mml:mi><mml:mo>′</mml:mo></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <mml:math id="nlm-math-101"><mml:msubsup><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>θ</mml:mi><mml:mo>′</mml:mo></mml:msubsup></mml:math> represents a parametric estimator of the first derivative of the density function, fitted with the grouped‐data sample and flexible enough to capture, at least partially, the global slope of <italic>f</italic>. It was checked that fitting normal mixture models with a maximum number of <italic>r</italic> = 5 components provided, in general, very good results. In practice, the expectation‐‐maximization (EM) method was used to estimate the parameters of these models, using the BIC criterion to select the best fit.</p>
        </sec>
      </sec>
    </app>
    <app id="ece35448-app-0002" content-type="APPENDIX">
      <label>APPENDIX 2</label>
      <sec sec-type="opening-section" id="ece35448-sec-0020">
        <p>As an option, the functions <monospace>bw.dens.binneC</monospace>, <monospace>bw.dist.binned</monospace>, and <monospace>bw.dist.binned.boot</monospace> allow to compute bootstrap confidence bands for the density and distribution functions, using the nonparametric estimators (<xref rid="ece35448-disp-0002" ref-type="disp-formula">1</xref>) and (<xref rid="ece35448-disp-0003" ref-type="disp-formula">2</xref>). This bands are designed to contain the whole function with a prescribed high probability, typically 95%, and can be employed, for example, to assess the uncertainty of the corresponding estimates or to perform analyses with different treatments. The procedures used for the density and the distribution functions follow the same steps, and therefore, for the sake of brevity, in this appendix, only the algorithm used in <monospace>bw.dist.binned</monospace> and <monospace>bw.dist.binned.boot</monospace> to compute the bootstrap confidence bands for the distribution function, <italic>F</italic>(<italic>t</italic>), is detailed.</p>
        <p>First, given an initial confidence level, 1–α, for a small α (α = .01 or .05, typically), we start by constructing individual (1–α)‐confidence intervals, (<mml:math id="nlm-math-102"><mml:msub><mml:mi>ℓ</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math>, <italic>u<sub>j</sub></italic>), for <italic>F</italic>, in the cumulative observed HTT at inspections, <italic>y</italic>
<sub>1</sub>, <italic>y</italic>
<sub>2</sub>, …, <italic>y<sub>k</sub></italic>. The process is the following:
<list list-type="order" id="ece35448-list-0003"><list-item><p>Fix a pilot bandwidth, <italic>g</italic>, and compute <mml:math id="nlm-math-103"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>F</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>g</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math>, the smooth cumulative distribution function estimation given in (<xref rid="ece35448-disp-0003" ref-type="disp-formula">2</xref>).</p></list-item><list-item><p>Draw <italic>B</italic> complete bootstrap resamples of size <italic>n</italic> from <mml:math id="nlm-math-104"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>F</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>g</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>:</mml:mo><mml:msubsup><mml:mi>X</mml:mi><mml:mn>1</mml:mn><mml:mrow><mml:mtext>∗</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>X</mml:mi><mml:mn>2</mml:mn><mml:mrow><mml:mtext>∗</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mi>…</mml:mi><mml:mo>,</mml:mo><mml:msubsup><mml:mi>X</mml:mi><mml:mi>n</mml:mi><mml:mrow><mml:mtext>∗</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo></mml:mrow></mml:math>
<italic>j</italic> = 1, 2, …, <italic>B</italic>. To do this, we first draw <italic>n</italic> observations from a discrete random variable, <italic>I</italic>, that takes the values 1, 2, …, <italic>k</italic>, with probabilities <italic>w</italic>
<sub>1</sub>, <italic>w</italic>
<sub>2</sub>, …, <italic>w<sub>k</sub></italic>. Let us denote these observations by <mml:math id="nlm-math-105"><mml:mrow><mml:msubsup><mml:mi>I</mml:mi><mml:mn>1</mml:mn><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>I</mml:mi><mml:mn>2</mml:mn><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mi>…</mml:mi><mml:mo>,</mml:mo><mml:msubsup><mml:mi>I</mml:mi><mml:mi>n</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math>. Now, for every <italic>i</italic> = 1, 2, …, <italic>n</italic>, we generate <mml:math id="nlm-math-106"><mml:msubsup><mml:mi>V</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:math> with cdf <mml:math id="nlm-math-107"><mml:mi mathvariant="double-struck">K</mml:mi></mml:math> and define the bootstrap observations as <mml:math id="nlm-math-108"><mml:mrow><mml:msubsup><mml:mi>X</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mtext>∗</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:msubsup><mml:mi>I</mml:mi><mml:mi>j</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:msub><mml:mo>+</mml:mo><mml:mi>g</mml:mi><mml:mo>·</mml:mo><mml:msubsup><mml:mi>V</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>.</mml:mo></mml:mrow></mml:math>
</p></list-item><list-item><p>Consider the incomplete version of these bootstrap resamples: <mml:math id="nlm-math-109"><mml:mrow><mml:msubsup><mml:mi>F</mml:mi><mml:mi>n</mml:mi><mml:mrow><mml:mtext>∗</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>≤</mml:mo><mml:msubsup><mml:mi>F</mml:mi><mml:mi>n</mml:mi><mml:mrow><mml:mtext>∗</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>≤</mml:mo><mml:mi>⋯</mml:mi><mml:mo>≤</mml:mo><mml:msubsup><mml:mi>F</mml:mi><mml:mi>n</mml:mi><mml:mrow><mml:mtext>∗</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math> for <italic>j </italic>= 1, 2, …, B.</p></list-item><list-item><p>Compute the estimation given in (<xref rid="ece35448-disp-0003" ref-type="disp-formula">2</xref>) using the incomplete bootstrap resamples: <mml:math id="nlm-math-110"><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>F</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>h</mml:mi><mml:mrow><mml:mtext>∗</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math>, <italic>j</italic> = 1, 2, …, <italic>B</italic>.</p></list-item><list-item><p>Aproximate the sampling distribution of the stochastic process <mml:math id="nlm-math-111"><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mi>x</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>F</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>h</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:mi>F</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math> by the bootstrap distribution of <mml:math id="nlm-math-112"><mml:mrow><mml:msubsup><mml:mi>D</mml:mi><mml:mi>n</mml:mi><mml:mtext>∗</mml:mtext></mml:msubsup><mml:mfenced close=")" open="("><mml:mi>x</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi>F</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>h</mml:mi><mml:mtext>∗</mml:mtext></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>F</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>g</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math>.</p></list-item><list-item><p>Now, the <mml:math id="nlm-math-113"><mml:mfrac><mml:mi>α</mml:mi><mml:mn>2</mml:mn></mml:mfrac></mml:math> and <mml:math id="nlm-math-114"><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mfrac><mml:mi>α</mml:mi><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:math> quantiles of the bootstrap distribution are computed: <mml:math id="nlm-math-115"><mml:mrow><mml:msubsup><mml:mi>D</mml:mi><mml:mi>n</mml:mi><mml:mrow><mml:mtext>∗</mml:mtext><mml:mfenced close=")" open="("><mml:mfenced close="⌉" open="⌈" separators=""><mml:mrow><mml:mfrac><mml:mi>α</mml:mi><mml:mn>2</mml:mn></mml:mfrac><mml:mi>B</mml:mi></mml:mrow></mml:mfenced></mml:mfenced></mml:mrow></mml:msubsup><mml:mfenced close=")" open="("><mml:mi>x</mml:mi></mml:mfenced></mml:mrow></mml:math> and <mml:math id="nlm-math-116"><mml:mrow><mml:msubsup><mml:mi>D</mml:mi><mml:mi>n</mml:mi><mml:mrow><mml:mtext>∗</mml:mtext><mml:mfenced close=")" open="("><mml:mfenced close="⌉" open="⌈" separators=""><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mfrac><mml:mi>α</mml:mi><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:mfenced><mml:mi>B</mml:mi></mml:mrow></mml:mfenced></mml:mfenced></mml:mrow></mml:msubsup><mml:mfenced close=")" open="("><mml:mi>x</mml:mi></mml:mfenced><mml:mrow><mml:mo stretchy="false">(</mml:mo></mml:mrow><mml:mfenced close="⌉" open="⌈"><mml:mo>ζ</mml:mo></mml:mfenced></mml:mrow></mml:math> denotes the integer part of <mml:math id="nlm-math-117"><mml:mo>ζ</mml:mo></mml:math>).</p></list-item><list-item><p>The final bootstrap confidence interval for <italic>F</italic>(<italic>x</italic>) is</p></list-item></list>
<disp-formula id="ece35448-disp-0040"><mml:math id="nlm-math-118"><mml:mrow><mml:mfenced close="]" open="[" separators=""><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>F</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>h</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:msubsup><mml:mi>D</mml:mi><mml:mi>n</mml:mi><mml:mrow><mml:mtext>∗</mml:mtext><mml:mfenced close=")" open="("><mml:mfenced close="⌉" open="⌈" separators=""><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mfrac><mml:mi>α</mml:mi><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:mfenced><mml:mi>B</mml:mi></mml:mrow></mml:mfenced></mml:mfenced></mml:mrow></mml:msubsup><mml:mfenced close=")" open="("><mml:mi>x</mml:mi></mml:mfenced><mml:mo>,</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>F</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>h</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:msubsup><mml:mi>D</mml:mi><mml:mi>n</mml:mi><mml:mrow><mml:mtext>∗</mml:mtext><mml:mfenced close=")" open="("><mml:mfenced close="⌉" open="⌈" separators=""><mml:mrow><mml:mfrac><mml:mi>α</mml:mi><mml:mn>2</mml:mn></mml:mfrac><mml:mi>B</mml:mi></mml:mrow></mml:mfenced></mml:mfenced></mml:mrow></mml:msubsup><mml:mfenced close=")" open="("><mml:mi>x</mml:mi></mml:mfenced></mml:mrow></mml:mfenced><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula>
</p>
        <p>Steps 4–7 are repeated for every <italic>x</italic> = <italic>y<sub>j</sub></italic>, <italic>j</italic> = 1, …, <italic>k</italic>, and, therefore, <italic>k</italic> pointwise intervals (<mml:math id="nlm-math-119"><mml:msub><mml:mi>ℓ</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math>, <italic>u<sub>j</sub></italic>), for each value <italic>F</italic>(<italic>y<sub>j</sub></italic>), <italic>j</italic> = 1, …, <italic>k</italic>, are calculated. Individual confidence intervals have approximately the nominal coverage probability, 1–<italic>α</italic>, when they are considered separately (for a particular grid point). However, the probability that the whole curve is included in the band depicted by the set of intervals is much smaller. This is known as the multiple range testing problem or the false discovery rate in high dimensional statistical problems.</p>
        <p>A typical way to correct for multiple testing is the popular Bonferroni approach. In a hypothesis testing context, the idea behind this approach is to consider a new significance level, <italic>α</italic>
<sub>Bonf </sub>= <italic>α</italic>/<italic>k</italic>, and compute individual tests using this new level. The resulting multiple test has a multiple level which is much closer to the desired <italic>α</italic>. However, it is well known that the Bonferroni approach is a conservative procedure. In our context, this means that the joint coverage probability of the confidence "band," computed with the Bonferroni approach, would be larger than the desired 1<italic>–α</italic>.</p>
        <p>Starting from the conservative Bonferroni approach and the anticonservative individual testing approach, the following algorithm finds an approximate (1–<italic>α</italic>) confidence interval, with a given approximation error <italic>δ</italic> (<italic>δ</italic> is typically small in comparison with the nominal <italic>α</italic>, for instance <mml:math id="nlm-math-120"><mml:mrow><mml:mi>δ</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mi>α</mml:mi><mml:mn>10</mml:mn></mml:mfrac></mml:mrow></mml:math>):
<list list-type="order" id="ece35448-list-0004"><list-item><p>Fix <mml:math id="nlm-math-121"><mml:mrow><mml:msubsup><mml:mi>α</mml:mi><mml:mtext>low</mml:mtext><mml:mfenced close=")" open="("><mml:mn>0</mml:mn></mml:mfenced></mml:msubsup><mml:mo>=</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mtext>Bonf</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mi>α</mml:mi><mml:mi>k</mml:mi></mml:mfrac></mml:mrow></mml:math> and <mml:math id="nlm-math-122"><mml:mrow><mml:msubsup><mml:mi>α</mml:mi><mml:mtext>high</mml:mtext><mml:mfenced close=")" open="("><mml:mn>0</mml:mn></mml:mfenced></mml:msubsup><mml:mo>=</mml:mo><mml:mi>α</mml:mi></mml:mrow></mml:math>. Fix the iteration number, <italic>i</italic> = 0.</p></list-item><list-item><p>Compute <mml:math id="nlm-math-123"><mml:mrow><mml:msubsup><mml:mi>α</mml:mi><mml:mtext>mean</mml:mtext><mml:mfenced close=")" open="("><mml:mi>i</mml:mi></mml:mfenced></mml:msubsup><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>α</mml:mi><mml:mtext>low</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>α</mml:mi><mml:mtext>high</mml:mtext><mml:mfenced close=")" open="("><mml:mi>i</mml:mi></mml:mfenced></mml:msubsup></mml:mrow><mml:mn>2</mml:mn></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:math>
</p></list-item><list-item><p>Use the bootstrap resamples to compute individual confidence intervals with <mml:math id="nlm-math-124"><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msubsup><mml:mi>α</mml:mi><mml:mtext>low</mml:mtext><mml:mfenced close=")" open="("><mml:mi>i</mml:mi></mml:mfenced></mml:msubsup><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msubsup><mml:mi>α</mml:mi><mml:mtext>mean</mml:mtext><mml:mfenced close=")" open="("><mml:mi>i</mml:mi></mml:mfenced></mml:msubsup><mml:mspace width="0.166667em"/><mml:mtext>and</mml:mtext><mml:mspace width="0.166667em"/><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msubsup><mml:mi>α</mml:mi><mml:mtext>high</mml:mtext><mml:mfenced close=")" open="("><mml:mi>i</mml:mi></mml:mfenced></mml:msubsup></mml:mrow></mml:math> confidence levels.</p></list-item><list-item><p>Compute, with the same bootstrap resamples, the proportion of bootstrap curves that are included in each of these confidence bands. These proportions satisfy <mml:math id="nlm-math-125"><mml:mrow><mml:msubsup><mml:mi>p</mml:mi><mml:mtext>low</mml:mtext><mml:mfenced close=")" open="("><mml:mi>i</mml:mi></mml:mfenced></mml:msubsup><mml:mo>≥</mml:mo><mml:msubsup><mml:mi>p</mml:mi><mml:mtext>mean</mml:mtext><mml:mfenced close=")" open="("><mml:mi>i</mml:mi></mml:mfenced></mml:msubsup><mml:mo>≥</mml:mo><mml:msubsup><mml:mi>p</mml:mi><mml:mtext>high</mml:mtext><mml:mfenced close=")" open="("><mml:mi>i</mml:mi></mml:mfenced></mml:msubsup><mml:mspace width="0.166667em"/><mml:mtext>and</mml:mtext><mml:mspace width="0.166667em"/><mml:msubsup><mml:mi>p</mml:mi><mml:mtext>low</mml:mtext><mml:mfenced close=")" open="("><mml:mi>i</mml:mi></mml:mfenced></mml:msubsup><mml:mo>≥</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>α</mml:mi><mml:mo>≥</mml:mo><mml:msubsup><mml:mi>p</mml:mi><mml:mtext>high</mml:mtext><mml:mfenced close=")" open="("><mml:mi>i</mml:mi></mml:mfenced></mml:msubsup><mml:mo>.</mml:mo></mml:mrow></mml:math>
</p></list-item><list-item><p>If <mml:math id="nlm-math-126"><mml:mrow><mml:msubsup><mml:mi>p</mml:mi><mml:mtext>mean</mml:mtext><mml:mfenced close=")" open="("><mml:mi>i</mml:mi></mml:mfenced></mml:msubsup><mml:mo>≥</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>α</mml:mi></mml:mrow></mml:math>, then define <mml:math id="nlm-math-127"><mml:mrow><mml:msubsup><mml:mi>α</mml:mi><mml:mtext>low</mml:mtext><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi>α</mml:mi><mml:mtext>mean</mml:mtext><mml:mfenced close=")" open="("><mml:mi>i</mml:mi></mml:mfenced></mml:msubsup></mml:mrow></mml:math> and <mml:math id="nlm-math-128"><mml:mrow><mml:msubsup><mml:mi>α</mml:mi><mml:mtext>high</mml:mtext><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi>α</mml:mi><mml:mtext>high</mml:mtext><mml:mfenced close=")" open="("><mml:mi>i</mml:mi></mml:mfenced></mml:msubsup></mml:mrow></mml:math>. Otherwise define <mml:math id="nlm-math-129"><mml:mrow><mml:msubsup><mml:mi>α</mml:mi><mml:mtext>low</mml:mtext><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi>α</mml:mi><mml:mtext>low</mml:mtext><mml:mfenced close=")" open="("><mml:mi>i</mml:mi></mml:mfenced></mml:msubsup></mml:mrow></mml:math> and <mml:math id="nlm-math-130"><mml:mrow><mml:msubsup><mml:mi>α</mml:mi><mml:mtext>high</mml:mtext><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi>α</mml:mi><mml:mtext>mean</mml:mtext><mml:mfenced close=")" open="("><mml:mi>i</mml:mi></mml:mfenced></mml:msubsup><mml:mo>.</mml:mo></mml:mrow></mml:math>
</p></list-item><list-item><p>Stop at step <italic>i</italic> if <mml:math id="nlm-math-131"><mml:mrow><mml:mfenced close="|" open="|" separators=""><mml:mrow><mml:msubsup><mml:mi>p</mml:mi><mml:mtext>mean</mml:mtext><mml:mfenced close=")" open="("><mml:mi>i</mml:mi></mml:mfenced></mml:msubsup><mml:mo>-</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mfenced><mml:mo>&lt;</mml:mo><mml:mi>δ</mml:mi></mml:mrow></mml:math>. Otherwise increase <italic>i</italic> in one unit and repeat Steps 2–5.</p></list-item></list>
</p>
        <p>The final approximate (1–<italic>α</italic>) simultaneous confidence intervals are those obtained for level <mml:math id="nlm-math-132"><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msubsup><mml:mi>α</mml:mi><mml:mtext>mean</mml:mtext><mml:mfenced close=")" open="("><mml:mi>i</mml:mi></mml:mfenced></mml:msubsup></mml:mrow></mml:math> in the last iteration.</p>
      </sec>
    </app>
    <app id="ece35448-app-0003" content-type="APPENDIX">
      <label>APPENDIX 3</label>
      <sec sec-type="opening-section" id="ece35448-sec-0021">
        <p>In this appendix, the statistical procedure implemented in the function <monospace>anv.binned</monospace>, presented in Section <xref rid="ece35448-sec-0009" ref-type="sec">3.4</xref>, is described in detail.</p>
        <p>Consider an interval‐grouped sample of size <italic>n</italic>. This means that given a set of <italic>k</italic> intervals [<italic>y</italic>
<sub>j–1</sub>, <italic>y<sub>j</sub></italic>), <italic>j</italic> = 1, …, <italic>k</italic>, only the number of observations (<italic>n</italic>
<sub>1</sub>, …, <italic>n<sub>k</sub></italic>) within each interval (instead of the value of every single observation) is known. Note that <italic>n</italic> = <italic>n</italic>
<sub>1</sub> + … +<italic>n<sub>k</sub></italic>. For example, as described in Section <xref rid="ece35448-sec-0003" ref-type="sec">2.1</xref>, in the weed emergence problem studied in this paper, the vector (<italic>y</italic>
<sub>0</sub>, <italic>y</italic>
<sub>1</sub>, …, <italic>y<sub>k</sub></italic>) denotes the CHTT at emergence and the vector (<italic>n</italic>
<sub>1</sub>, …, <italic>n<sub>k</sub></italic>) represents the number of seedlings that have emerged in each interval. Additionally, consider that there exists a factor of interest, with <italic>G</italic> levels or treatments, and we want to test whether this factor has a significant effect in the emergence. Let us denote by <mml:math id="nlm-math-133"><mml:msubsup><mml:mi>N</mml:mi><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:msubsup></mml:math> the number of observations in the interval <italic>j</italic> considering the treatment <italic>i</italic>, with <italic>j</italic> = 1, …, <italic>k</italic> and <italic>i</italic> = 1, …, <italic>G</italic>. Then, <mml:math id="nlm-math-134"><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>k</mml:mi></mml:msubsup><mml:msubsup><mml:mi>N</mml:mi><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math>, where <italic>N<sub>i</sub></italic> denotes the number of observations associated with treatment <italic>i</italic>, <italic>i</italic> = 1, …, <italic>G</italic> (<italic>n</italic> = <italic>N</italic>
<sub>1</sub>+<mml:math id="nlm-math-135"><mml:mi>⋯</mml:mi></mml:math> + <italic>N<sub>G</sub></italic>), and <mml:math id="nlm-math-136"><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>G</mml:mi></mml:msubsup><mml:msubsup><mml:mi>N</mml:mi><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math>, <italic>j</italic> = 1, …, <italic>k</italic>.</p>
        <p>Denoting by <italic>F<sub>i</sub></italic> the emergence curve considering treatment <italic>i</italic>, <italic>i</italic> = 1, …, <italic>G</italic>, the problem of testing whether the factor has a significant effect in the emergence can be formulated as:<disp-formula id="ece35448-disp-0041"><mml:math id="nlm-math-137"><mml:mfenced close="" open="{" separators=""><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>:</mml:mo><mml:msub><mml:mi>F</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>F</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mo>∀</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>…</mml:mi><mml:mo>,</mml:mo><mml:mi>G</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>:</mml:mo><mml:mfenced close="|" open="" separators=""><mml:mrow><mml:mo>∃</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>…</mml:mi><mml:mo>,</mml:mo><mml:mi>G</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mfenced><mml:msub><mml:mi>F</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>≠</mml:mo><mml:msub><mml:mi>F</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:math></disp-formula>
</p>
        <p>A reasonable statistic to address this hypothesis testing is, for example, the following one, of Cramér‐von Mises type, based on the statistic to compare <italic>k</italic> independent samples, proposed by Kiefer (<xref rid="ece35448-bib-0016" ref-type="ref">1959</xref>):<disp-formula id="ece35448-disp-0042"><mml:math id="nlm-math-138"><mml:mrow><mml:mi>D</mml:mi><mml:mo>=</mml:mo><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>G</mml:mi></mml:munderover><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∫</mml:mo><mml:msup><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>F</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>i</mml:mi><mml:mi>g</mml:mi></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:msup><mml:mover accent="true"><mml:mi>F</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>g</mml:mi></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mfenced><mml:mn>2</mml:mn></mml:msup><mml:mi>d</mml:mi><mml:msup><mml:mover accent="true"><mml:mi>F</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>g</mml:mi></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <mml:math id="nlm-math-139"><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>F</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>i</mml:mi><mml:mi>g</mml:mi></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>·</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math> denotes the corresponding nonparametric estimator of <mml:math id="nlm-math-140"><mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>·</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math>, using (<xref rid="ece35448-disp-0003" ref-type="disp-formula">2</xref>), computed using <italic>N<sub>i</sub></italic> and (<mml:math id="nlm-math-141"><mml:mrow><mml:msubsup><mml:mi>N</mml:mi><mml:mn>1</mml:mn><mml:mi>i</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:mi>…</mml:mi><mml:mo>,</mml:mo><mml:msubsup><mml:mi>N</mml:mi><mml:mi>k</mml:mi><mml:mi>i</mml:mi></mml:msubsup></mml:mrow></mml:math>), for every <italic>i</italic> = 1, …, <italic>G</italic>, and where <mml:math id="nlm-math-142"><mml:mrow><mml:msup><mml:mover accent="true"><mml:mi>F</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>g</mml:mi></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>·</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math> represents the nonparametric estimator (<xref rid="ece35448-disp-0003" ref-type="disp-formula">2</xref>) using the pooled sample <italic>n</italic> and (<italic>n</italic>
<sub>1</sub>, …, <italic>n<sub>k</sub></italic>).</p>
        <p>Intuitively, the null hypothesis <italic>H</italic>
<sub>0</sub> will be accepted for small values of <italic>D</italic> and rejected for large values of <italic>D</italic>. To calibrate the test, a bootstrap procedure is employed to approximate the sampling distribution of <italic>D</italic>. The specific steps are the following:
<list list-type="order" id="ece35448-list-0005"><list-item><p>Using a bandwidth <italic>h</italic> (e.g., the one provided by <monospace>bw.dist.binned.boot</monospace>), consider the grouped‐data nonparametric estimator, <mml:math id="nlm-math-143"><mml:msubsup><mml:mover accent="true"><mml:mi>F</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>h</mml:mi><mml:mi>g</mml:mi></mml:msubsup></mml:math>, using the pooled data set with <italic>n</italic> and (<italic>n</italic>
<sub>1</sub>, …, <italic>n<sub>k</sub></italic>).</p></list-item><list-item><p>For each treatment <italic>i</italic>, <italic>i</italic> = 1, …, <italic>G</italic>, draw (<mml:math id="nlm-math-144"><mml:mrow><mml:msubsup><mml:mi>N</mml:mi><mml:mn>1</mml:mn><mml:mrow><mml:mi>i</mml:mi><mml:mtext>∗</mml:mtext></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mi>…</mml:mi><mml:mo>,</mml:mo><mml:msubsup><mml:mi>N</mml:mi><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mtext>∗</mml:mtext></mml:mrow></mml:msubsup></mml:mrow></mml:math>) from a multinomial distribution <mml:math id="nlm-math-145"><mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>;</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mn>1</mml:mn><mml:mi>h</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:mi>…</mml:mi><mml:mo>,</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>k</mml:mi><mml:mi>h</mml:mi></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math>, with <mml:math id="nlm-math-146"><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>j</mml:mi><mml:mi>h</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi>F</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>h</mml:mi><mml:mi>g</mml:mi></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi>F</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>h</mml:mi><mml:mi>g</mml:mi></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math>, <italic>j</italic> = 1, …, <italic>k</italic>, and define <mml:math id="nlm-math-147"><mml:mrow><mml:msubsup><mml:mi>w</mml:mi><mml:mi>j</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mtext>∗</mml:mtext></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi>N</mml:mi><mml:mi>j</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mspace width="0.277778em"/><mml:mtext>∗</mml:mtext></mml:mrow></mml:msubsup><mml:mo stretchy="false">/</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math>.</p></list-item><list-item><p>Using the weights <mml:math id="nlm-math-148"><mml:mrow><mml:msubsup><mml:mi>w</mml:mi><mml:mn>1</mml:mn><mml:mrow><mml:mi>i</mml:mi><mml:mspace width="0.277778em"/><mml:mtext>∗</mml:mtext></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mi>…</mml:mi><mml:mo>,</mml:mo><mml:msubsup><mml:mi>w</mml:mi><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mspace width="0.277778em"/><mml:mtext>∗</mml:mtext></mml:mrow></mml:msubsup></mml:mrow></mml:math>, compute the grouped‐data nonparametric estimator <mml:math id="nlm-math-149"><mml:msubsup><mml:mover accent="true"><mml:mi>F</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>i</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mspace width="0.277778em"/><mml:mtext>∗</mml:mtext></mml:mrow></mml:msubsup></mml:math>, for each treatment <italic>i</italic> = 1, …, <italic>G</italic>, and the nonparametric estimator <mml:math id="nlm-math-150"><mml:msup><mml:mover accent="true"><mml:mi>F</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mi>g</mml:mi><mml:mspace width="0.277778em"/><mml:mtext>∗</mml:mtext></mml:mrow></mml:msup></mml:math> using the pooled bootstrap resample <italic>n</italic> and <mml:math id="nlm-math-151"><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>G</mml:mi></mml:msubsup><mml:mrow><mml:msubsup><mml:mi>N</mml:mi><mml:mn>1</mml:mn><mml:mrow><mml:mi>i</mml:mi><mml:mspace width="0.277778em"/><mml:mtext>∗</mml:mtext></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mi>…</mml:mi><mml:mo>,</mml:mo></mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>G</mml:mi></mml:msubsup><mml:msubsup><mml:mi>N</mml:mi><mml:mi>k</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mspace width="0.277778em"/><mml:mtext>∗</mml:mtext></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:math>. In all the cases, the bootstrap bandwidths obtained with <monospace>bw.dist.binned.boot</monospace> can be employed.</p></list-item><list-item><p>Define the bootstrap version of <italic>D</italic>:<disp-formula id="ece35448-disp-0043"><mml:math id="nlm-math-152"><mml:mrow><mml:msup><mml:mi>D</mml:mi><mml:mtext>∗</mml:mtext></mml:msup><mml:mo>=</mml:mo><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>G</mml:mi></mml:munderover><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∫</mml:mo><mml:msup><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>F</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>i</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mspace width="0.277778em"/><mml:mtext>∗</mml:mtext></mml:mrow></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:msup><mml:mover accent="true"><mml:mi>F</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mi>g</mml:mi><mml:mspace width="0.277778em"/><mml:mtext>∗</mml:mtext></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mfenced><mml:mn>2</mml:mn></mml:msup><mml:mi mathvariant="normal">d</mml:mi><mml:msup><mml:mover accent="true"><mml:mi>F</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mi>g</mml:mi><mml:mspace width="0.277778em"/><mml:mtext>∗</mml:mtext></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
</p></list-item><list-item><p>Steps 2–4 are repeated a large number of times, <italic>B</italic> and, then, a sequence {<mml:math id="nlm-math-153"><mml:mrow><mml:msubsup><mml:mi>D</mml:mi><mml:mn>1</mml:mn><mml:mtext>∗</mml:mtext></mml:msubsup><mml:mo>,</mml:mo><mml:mi>…</mml:mi><mml:mo>,</mml:mo><mml:msubsup><mml:mi>D</mml:mi><mml:mi>B</mml:mi><mml:mtext>∗</mml:mtext></mml:msubsup></mml:mrow></mml:math>} is obtained. Given a significance level <italic>α</italic>, the null hypothesis is rejected if<disp-formula id="ece35448-disp-0044"><mml:math id="nlm-math-154"><mml:mrow><mml:mi>D</mml:mi><mml:mo>&gt;</mml:mo><mml:msubsup><mml:mi>D</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mfenced close="⌉" open="⌈" separators=""><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>·</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:mfenced><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mtext>∗</mml:mtext></mml:msubsup><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
</p></list-item></list>where <mml:math id="nlm-math-155"><mml:mfenced close="⌉" open="⌈"><mml:mo>·</mml:mo></mml:mfenced></mml:math> represents the integer part, and <mml:math id="nlm-math-156"><mml:msubsup><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msubsup><mml:mi>D</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mtext>∗</mml:mtext></mml:msubsup><mml:mo stretchy="false">}</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>B</mml:mi></mml:msubsup></mml:math> is the sample <mml:math id="nlm-math-157"><mml:msubsup><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msubsup><mml:mi>D</mml:mi><mml:mi>i</mml:mi><mml:mtext>∗</mml:mtext></mml:msubsup><mml:mo stretchy="false">}</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>B</mml:mi></mml:msubsup></mml:math> arranged in increasing order of magnitude. Additionally, the <italic>p</italic>‐value of this test can be approximated by:<disp-formula id="ece35448-disp-0045"><mml:math id="nlm-math-158"><mml:mrow><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>B</mml:mi></mml:mfrac><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>B</mml:mi></mml:munderover><mml:msub><mml:mi mathvariant="double-struck">I</mml:mi><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msubsup><mml:mi>D</mml:mi><mml:mi>i</mml:mi><mml:mtext>∗</mml:mtext></mml:msubsup><mml:mo>&gt;</mml:mo><mml:mi>D</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <mml:math id="nlm-math-159"><mml:msub><mml:mi mathvariant="double-struck">I</mml:mi><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mo>·</mml:mo><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:msub></mml:math> is the indicator function.</p>
        <p>It is important to note that with the resampling process described in Step 2, the bootstrap resamples for each treatment are generated under the null hypothesis.</p>
      </sec>
    </app>
  </app-group>
</back>
