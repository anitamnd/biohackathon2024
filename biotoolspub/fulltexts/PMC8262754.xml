<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Nucleic Acids Res</journal-id>
    <journal-id journal-id-type="iso-abbrev">Nucleic Acids Res</journal-id>
    <journal-id journal-id-type="publisher-id">nar</journal-id>
    <journal-title-group>
      <journal-title>Nucleic Acids Research</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">0305-1048</issn>
    <issn pub-type="epub">1362-4962</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8262754</article-id>
    <article-id pub-id-type="pmid">33905501</article-id>
    <article-id pub-id-type="doi">10.1093/nar/gkab296</article-id>
    <article-id pub-id-type="publisher-id">gkab296</article-id>
    <article-categories>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI00010</subject>
      </subj-group>
      <subj-group subj-group-type="heading">
        <subject>Web Server Issue</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Recognizing and validating ligands with CheckMyBlob</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-9723-525X</contrib-id>
        <name>
          <surname>Brzezinski</surname>
          <given-names>Dariusz</given-names>
        </name>
        <!--dariusz.brzezinski@cs.put.poznan.pl-->
        <aff><institution>Department of Molecular Physiology and Biological Physics, University of Virginia</institution>, Charlottesville, VA 22908, <country country="US">USA</country></aff>
        <aff><institution>Institute of Computing Science, Poznan University of Technology</institution>, Poznan, 60-965, <country country="PL">Poland</country></aff>
        <aff><institution>Center for Biocrystallographic Research, Institute of Bioorganic Chemistry</institution>, Polish Academy of Sciences, Poznan, 61-704, <country country="PL">Poland</country></aff>
        <xref rid="COR1" ref-type="corresp"/>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-8012-5791</contrib-id>
        <name>
          <surname>Porebski</surname>
          <given-names>Przemyslaw J</given-names>
        </name>
        <aff><institution>Department of Molecular Physiology and Biological Physics, University of Virginia</institution>, Charlottesville, VA 22908, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-6269-3151</contrib-id>
        <name>
          <surname>Kowiel</surname>
          <given-names>Marcin</given-names>
        </name>
        <aff><institution>Center for Biocrystallographic Research, Institute of Bioorganic Chemistry</institution>, Polish Academy of Sciences, Poznan, 61-704, <country country="PL">Poland</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-1760-2668</contrib-id>
        <name>
          <surname>Macnar</surname>
          <given-names>Joanna M</given-names>
        </name>
        <aff><institution>Department of Molecular Physiology and Biological Physics, University of Virginia</institution>, Charlottesville, VA 22908, <country country="US">USA</country></aff>
        <aff><institution>College of Inter-Faculty Individual Studies in Mathematics and Natural Sciences, University of Warsaw</institution>, Warsaw, 02-097, <country country="PL">Poland</country></aff>
        <aff><institution>Faculty of Chemistry, Biological and Chemical Research Center, University of Warsaw</institution>, Warsaw, 02-089, <country country="PL">Poland</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-7075-7090</contrib-id>
        <name>
          <surname>Minor</surname>
          <given-names>Wladek</given-names>
        </name>
        <!--wladek@iwonka.med.virginia.edu-->
        <aff><institution>Department of Molecular Physiology and Biological Physics, University of Virginia</institution>, Charlottesville, VA 22908, <country country="US">USA</country></aff>
        <xref rid="COR2" ref-type="corresp"/>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="COR1">To whom correspondence should be addressed. Tel: +48 61 665 3057; Fax: +48 61 877 1525; Email: <email>dariusz.brzezinski@cs.put.poznan.pl</email></corresp>
      <corresp id="COR2">Correspondence may also be addressed to Wladek Minor. Tel: +1 434 243 6865; Fax: +1 434 243 2981; Email: <email>wladek@iwonka.med.virginia.edu</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <day>02</day>
      <month>7</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2021-04-27">
      <day>27</day>
      <month>4</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>27</day>
      <month>4</month>
      <year>2021</year>
    </pub-date>
    <volume>49</volume>
    <issue>W1</issue>
    <fpage>W86</fpage>
    <lpage>W92</lpage>
    <history>
      <date date-type="accepted">
        <day>11</day>
        <month>4</month>
        <year>2021</year>
      </date>
      <date date-type="rev-recd">
        <day>04</day>
        <month>4</month>
        <year>2021</year>
      </date>
      <date date-type="received">
        <day>22</day>
        <month>2</month>
        <year>2021</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2021. Published by Oxford University Press on behalf of Nucleic Acids Research.</copyright-statement>
      <copyright-year>2021</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="gkab296.pdf"/>
    <abstract>
      <title>Abstract</title>
      <p>Structure-guided drug design depends on the correct identification of ligands in crystal structures of protein complexes. However, the interpretation of the electron density maps is challenging and often burdened with confirmation bias. Ligand identification can be aided by automatic methods such as CheckMyBlob, a machine learning algorithm that learns to generalize ligand descriptions from sets of moieties deposited in the Protein Data Bank. Here, we present the CheckMyBlob web server, a platform that can identify ligands in unmodeled fragments of electron density maps or validate ligands in existing models. The server processes PDB/mmCIF and MTZ files and returns a ranking of 10 most likely ligands for each detected electron density blob along with interactive 3D visualizations. Additionally, for each prediction/validation, a plugin script is generated that enables users to conduct a detailed analysis of the server results in Coot. The CheckMyBlob web server is available at <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://checkmyblob.bioreproducibility.org" ext-link-type="uri">https://checkmyblob.bioreproducibility.org</ext-link>.</p>
    </abstract>
    <abstract abstract-type="graphical">
      <title>Graphical Abstract</title>
      <p>
        <fig position="float" id="ga1">
          <label>Graphical Abstract</label>
          <caption>
            <p>CheckMyBlob is a machine learning system that automatically detects and validates ligands in X-ray electron density maps.</p>
          </caption>
          <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="gkab296gra1" position="float"/>
        </fig>
      </p>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>National Institute of General Medical Sciences</institution>
            <institution-id institution-id-type="DOI">10.13039/100000057</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>R01-GM132595</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Polish National Agency for Academic Exchange</institution>
            <institution-id institution-id-type="DOI">10.13039/501100014434</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>PPN/BEK/2018/1/00058/U/00001</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>European Social Fund</institution>
            <institution-id institution-id-type="DOI">10.13039/501100004895</institution-id>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="7"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec sec-type="intro" id="SEC1">
    <title>INTRODUCTION</title>
    <p>Many macromolecular crystal structures contain ligand molecules that can reveal the function of the protein or nucleic acid. Ligands are usually manually modeled by crystallographers, which requires good judgment and expertise. This process is time-consuming and prone to human error, particularly when the resolution of the diffraction data is not very high, there is local disorder, or the ligand is bound to only a fraction of the molecules. The often-questionable assignment of ligands to electron density ‘blobs’ (<xref rid="B1" ref-type="bibr">1</xref>) shows that automatic methods for ligand recognition and validation are needed to streamline the interpretation and remove potential cognitive bias (<xref rid="B2" ref-type="bibr">2</xref>).</p>
    <p>Several approaches are used to automate fitting <italic toggle="yes">known</italic> ligands to electron density maps. They are typically based on recognition of the ligand's core atoms followed by iterative element addition (<xref rid="B3" ref-type="bibr">3</xref>,<xref rid="B4" ref-type="bibr">4</xref>), Metropolis-type optimization (<xref rid="B5" ref-type="bibr">5</xref>), or similar techniques (<xref rid="B6" ref-type="bibr">6–8</xref>). These methods can be adapted to identify <italic toggle="yes">unknown</italic> ligands by iteratively fitting moieties from a predefined list of candidates, an approach (<xref rid="B9" ref-type="bibr">9</xref>) that was reported to achieve 48% accuracy in recognizing instances of the 200 most frequently observed ligands in structures stored in the Protein Data Bank (PDB) (<xref rid="B10" ref-type="bibr">10</xref>). However, for thorough large-scale searches evaluating tens or hundreds of ligands, these approaches can be prohibitively slow. Alternatives to iterative fitting mainly use mathematical descriptions of 3D electron density map fragments (<xref rid="B11" ref-type="bibr">11–15</xref>). Although these methods are much faster than iterative ligand fitting, the best approaches from this group only achieve 30–32% accuracy in identifying the correct ligand from a list of the 100 most common ligands (<xref rid="B13" ref-type="bibr">13</xref>,<xref rid="B15" ref-type="bibr">15</xref>).</p>
    <p>CheckMyBlob (<xref rid="B16" ref-type="bibr">16</xref>) is a machine learning based algorithm that identifies ligands in electron density maps. In contrast to the methods mentioned above, CheckMyBlob learns to generalize ligand descriptions from sets of moieties deposited in the PDB, rather than comparing density maps to theoretical models, graphs, or selected template structures. Moreover, in contrast to other methods, the algorithm does not require human intervention during the ligand recognition process, making it a completely automatic approach for the initial interpretation of residual electron density blobs after structure determination and preliminary biopolymer refinement. In benchmark tests on portfolios of up to 219 931 ligands, CheckMyBlob achieved 73% accuracy in recognizing instances of the 100 most popular ligands and 56% accuracy in recognizing the 200 most popular ligands, while requiring significantly less time than competitive approaches (<xref rid="B16" ref-type="bibr">16</xref>).</p>
    <p>Here, we present the CheckMyBlob web server, a tool that helps users identify ligands in unmodeled fragments of electron density maps or validate ligands in existing models. The web server uses the CheckMyBlob algorithm trained to recognize over 200 classes of ligands grouped according to their geometry and molecular weight. Moreover, the web server model was trained to recognize metal ions, water molecules, and polymers (ligands that the PDB encodes as several monomers). The server visualizes the detected electron density blobs, and for each prediction/validation, a plugin script is generated that enables users to analyze the results in Coot (<xref rid="B17" ref-type="bibr">17</xref>). To the best of our knowledge, this is the first online tool to automatically identify and predict ligands in electron density maps.</p>
  </sec>
  <sec sec-type="materials|methods" id="SEC2">
    <title>MATERIALS AND METHODS</title>
    <sec id="SEC2-1">
      <title>Data collection and curation</title>
      <p>To obtain training data for the ligand recognition model, we downloaded all PDB entries as of 19 January 2020. We converted the associated structure factors from mmCIF to mtz format using the cif2mtz program from the CCP4 suite (<xref rid="B18" ref-type="bibr">18</xref>). Due to the large number of water molecules in macromolecular structures, only a subset was added to the training data. In an attempt to sample water molecules from a diverse set of structures, we divided the pool of available PDB deposits into 25 evenly-populated resolution bins. Next, within each bin we chose deposits that were non-redundant at a 50% pairwise sequence identity threshold, as calculated by BLASTclust (<xref rid="B19" ref-type="bibr">19</xref>). Therefore, to sample water molecules we chose structures of proteins that were significantly different from each other. This procedure resulted in 241 709 water molecule blobs extracted from 10 726 structures, which were later filtered according to various quality criteria (see below). In total, the data collection process resulted in 957 855 blob descriptions.</p>
      <p>As input to the ligand identification pipeline, we calculated <italic toggle="yes">F</italic><sub>o</sub> <italic toggle="yes">– F</italic><sub>c</sub> electron density maps, with 0.2 Å grid spacing, based on data in the mtz files and on atomic coordinates of the main-chain and side-chain atoms. Small-molecule moieties and solvent molecules were excluded. The resulting partial models were refined with five cycles of REFMAC (<xref rid="B20" ref-type="bibr">20</xref>) to reduce the ‘memory’ and modeling bias of the excluded molecules in the calculated structure factors and maps. Next, blobs were automatically found by analyzing all positive electron density peaks within the <italic toggle="yes">F</italic><sub>o</sub><italic toggle="yes">– F</italic><sub>c</sub> map. To mitigate the problem of ligands being divided into multiple blobs, the system detected local maxima, skeletonized the electron density within each blob's isosurface, and combined adjacent blobs when the distance between the local maxima or skeleton nodes was less than 2.15 Å (<xref rid="B16" ref-type="bibr">16</xref>). Any fragments of electron density in the blob isosurface that overlapped with the isosurface of the modeled biopolymer atoms were cut out from the blob. Finally, each detected ligand was described by a set of numerical features, such as 3D shape descriptors, blob volume, map statistics, and PCA eigenvalues based on positive peaks from <italic toggle="yes">F</italic><sub>o</sub><italic toggle="yes">– F</italic><sub>c</sub> maps. A detailed description of the data processing, ligand detection, and ligand label assignment methods can be found in (<xref rid="B16" ref-type="bibr">16</xref>).</p>
      <p>The final training data set consisted of ligands from X-ray diffraction experiments of at least 4.0 Å resolution. We also eliminated all suspicious deposits and ligands according to various quality criteria, such as RSCC &lt; 0.6, real space <italic toggle="yes">Z</italic><sub>obs</sub> (RSZO) &lt; 1.0, real space <italic toggle="yes">Z</italic><sub>diff</sub> (RSZD) ≥6.0, R factor &gt;0.3, or occupancy &lt;0.3. The details of the filtering process are described in (<xref rid="B16" ref-type="bibr">16</xref>). The resulting training data set consisted of 696 887 examples of blobs, which were assigned ligand labels (clustered).</p>
    </sec>
    <sec id="SEC2-2">
      <title>Ligand clustering</title>
      <p>Several ligands are indistinguishable by electron density alone. For example, for most resolution ranges, it is extremely challenging to distinguish between 6, 7 or 8 electrons (carbon, nitrogen, oxygen) or distinguish between single, double, or triple bonds in some configurations. To improve the robustness of the classification algorithm, we decided to cluster ligands based on the expected shape of their electron density derived from their chemical definitions. Namely, we considered the atom connectivity, chirality and significant differences in the number of electrons but disregarded atom types and bond order in some equivalent bond configurations. The clustering procedure was as follows:</p>
      <list list-type="order">
        <list-item>
          <p>Group molecules by matching number of atoms, rings, and aromatic rings;</p>
        </list-item>
        <list-item>
          <p>Group by connectivity (matching substructures using generic atoms and generic bonds);</p>
        </list-item>
        <list-item>
          <p>Check if the chirality of all matching combinations agrees;</p>
        </list-item>
        <list-item>
          <p>Check if the following SMART patterns match in equivalent positions: [!D1]#[!D1] (non-terminal triple bond), [!D1]=*=[!D1] (subsequent non-terminal double bonds), [D1]#[D2]-* or [D1]=[D2]=* (linear configuration of three atoms);</p>
        </list-item>
        <list-item>
          <p>Check if the equivalent atoms are in the same atomic number group (&lt;5, 5–13, 14–20, 21–31, 32–38, 39–49, &gt;50).</p>
        </list-item>
      </list>
      <p>A schematic of the clustering procedure is presented in Figure <xref rid="F1" ref-type="fig">1</xref>.</p>
      <fig position="float" id="F1">
        <label>Figure 1.</label>
        <caption>
          <p>Schematic of the ligand clustering procedure. Arrows depict example cluster splits based on different criteria at subsequent stages of the process.</p>
        </caption>
        <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="gkab296fig1" position="float"/>
      </fig>
      <p>Clustering was performed using RDKit with PostgreSQL and Python interfaces (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://www.rdkit.org" ext-link-type="uri">https://www.rdkit.org</ext-link>). Chemical descriptions of ligands were based on the SMILES and InChI descriptors provided by the PDB.</p>
    </sec>
    <sec id="SEC2-3">
      <title>Classification model</title>
      <p>The primary classification model was trained to recognize the 219 most popular ligand groups (clusters). This number was achieved by limiting the training to classes with at least 100 examples in the training set. All the ligands that were not in those 219 groups were labeled as a separate class called <italic toggle="yes">rare</italic>. When the primary classification model predicts <italic toggle="yes">rare</italic>, the example is additionally processed by a secondary model trained only on ligands in the <italic toggle="yes">rare</italic> group.</p>
      <p>The server's primary classification model was trained using the gradient boosting machine (GBM) algorithm (<xref rid="B21" ref-type="bibr">21</xref>). The classifier used the same features and hyperparameters as described in (<xref rid="B16" ref-type="bibr">16</xref>). To preprocess the data, the server uses the scikit-learn library v.0.20.4, whereas the GBM implementation was taken from Microsoft's LightGBM package v.2.3.0. The secondary model that provides predictions for the class <italic toggle="yes">rare</italic> was a 1-NN classifier (<xref rid="B22" ref-type="bibr">22</xref>). By using a 1-NN classifier as a secondary model, even ligands that occur only once in the PDB have a chance of being predicted.</p>
    </sec>
    <sec id="SEC2-4">
      <title>Model evaluation results</title>
      <p>The resulting machine learning model was first validated in a stratified 10-fold cross-validation experiment involving the gathered 696 887 training ligand instances with a mean resolution of 2.2 Å. The model achieved 71% accuracy and 95% top-10 accuracy (the chance that the correct ligand group is within the server's suggestion of 10 ligands). After the model was created, we processed additional (held out) PDB deposits with the same pipeline and created a separate test set. The test set included 17 150 ligand instances with a mean resolution of 2.5 Å, on which the model achieved 59% accuracy and 93% top-10 accuracy. The holdout test set was more challenging because it contained lower resolution structures, but the results are still superior to those reported for non-clustered ligands with at least two non-hydrogen atoms (<xref rid="B16" ref-type="bibr">16</xref>). A summary of the model's performance, according to different evaluation measures (<xref rid="B23" ref-type="bibr">23</xref>), is presented in Table <xref rid="tbl1" ref-type="table">1</xref>. The ‘About’ page of the CheckMyBlob web server contains an interactive calibration plot and a confusion matrix that describes the predictive performance for particular ligands.</p>
      <table-wrap position="float" id="tbl1">
        <label>Table 1.</label>
        <caption>
          <p>Basic statistics and average predictive performance metrics with standard deviations (in parentheses, in the unit of the last significant digit of the mean value) on the cross-validated (10-fold CV) training set and the holdout test set</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <th rowspan="1" colspan="1"/>
              <th rowspan="1" colspan="1">10-fold CV</th>
              <th rowspan="1" colspan="1">Holdout set</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">Ligand instances</td>
              <td rowspan="1" colspan="1">696 887</td>
              <td rowspan="1" colspan="1">17 150</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Mean resolution (Å)</td>
              <td align="center" rowspan="1" colspan="1">2.2</td>
              <td align="center" rowspan="1" colspan="1">2.5</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Accuracy (%)</td>
              <td align="center" rowspan="1" colspan="1">71.2(9)</td>
              <td align="center" rowspan="1" colspan="1">58.9</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Top-5 accuracy (%)</td>
              <td align="center" rowspan="1" colspan="1">90.7(5)</td>
              <td align="center" rowspan="1" colspan="1">87.2</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Top-10 accuracy (%)</td>
              <td align="center" rowspan="1" colspan="1">94.9(2)</td>
              <td align="center" rowspan="1" colspan="1">92.5</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Micro-averaged recall (%)</td>
              <td align="center" rowspan="1" colspan="1">71.2(9)</td>
              <td align="center" rowspan="1" colspan="1">58.9</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Micro-averaged precision (%)</td>
              <td align="center" rowspan="1" colspan="1">69.3(11)</td>
              <td align="center" rowspan="1" colspan="1">62.7</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Micro-averaged F1 (%)</td>
              <td align="center" rowspan="1" colspan="1">69.3(11)</td>
              <td align="center" rowspan="1" colspan="1">55.7</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Cohen's kappa (%)</td>
              <td align="center" rowspan="1" colspan="1">64.6(12)</td>
              <td align="center" rowspan="1" colspan="1">46.2</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
    </sec>
    <sec id="SEC2-5">
      <title>Server implementation</title>
      <p>The web server was developed in Python using the Django framework (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://www.djangoproject.com" ext-link-type="uri">https://www.djangoproject.com</ext-link>) with a PostgreSQL database (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://www.postgresql.org" ext-link-type="uri">https://www.postgresql.org</ext-link>) to store ligand definitions and job processing data. The submitted jobs are queued using Celery (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://docs.celeryproject.org/" ext-link-type="uri">https://docs.celeryproject.org/</ext-link>) with a RabbitMQ message broker (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://www.rabbitmq.com/" ext-link-type="uri">https://www.rabbitmq.com/</ext-link>). All the website pages are formatted with Bootstrap (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://getbootstrap.com" ext-link-type="uri">https://getbootstrap.com</ext-link>), and the result views are dynamically created using the doT templating engine (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://olado.github.io/" ext-link-type="uri">https://olado.github.io/</ext-link>). The website also uses the NGL JavaScript library for electron density visualization (<xref rid="B24" ref-type="bibr">24</xref>,<xref rid="B25" ref-type="bibr">25</xref>).</p>
    </sec>
  </sec>
  <sec sec-type="results" id="SEC3">
    <title>RESULTS</title>
    <sec id="SEC3-1">
      <title>Workflow</title>
      <p>The CheckMyBlob protocol is presented as a workflow in Figure <xref rid="F2" ref-type="fig">2</xref>.</p>
      <fig position="float" id="F2">
        <label>Figure 2.</label>
        <caption>
          <p>Schematic representation of the CheckMyBlob workflow and screenshots of the interactive results visualization page and Coot ligand analysis script. The user provides input files (an MTZ file and PDB or mmCIF file) and chooses to either detect unmodeled ligands or validate existing ligands. Next, blobs are detected, extracted from electron density maps, and described by a set of numerical features. The obtained numerical features are input to a machine learning model, which outputs a ranking of the ten most likely ligands for each blob. This probability-based ranking can be viewed on the interactive results visualization page and tested in Coot through a downloadable script.</p>
        </caption>
        <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="gkab296fig2" position="float"/>
      </fig>
      <sec id="SEC3-1-1">
        <title>Input</title>
        <p>Users can choose between two tasks that the server can perform: 1) the <italic toggle="yes">Identify</italic> task, where the server looks for unmodeled ligands and 2) the <italic toggle="yes">Validate</italic> task, where the server compares existing ligands with CheckMyBlob's predictions. To perform these tasks, users must submit a structural model in the form of a PDB or mmCIF file and MTZ map coefficients. In the <italic toggle="yes">Validate</italic> task, users can also provide the PDB code of an existing deposit. In both cases, the user can optionally choose to evaluate water molecules, which can be used to verify whether a set of water molecules was inserted instead of a potential ligand.</p>
      </sec>
      <sec id="SEC3-1-2">
        <title>Processing and prediction</title>
        <p>The input files are first prepared for blob detection. In the <italic toggle="yes">Identify</italic> task, this means running a zero-cycle of refinement and in the <italic toggle="yes">Validate</italic> task this means removing all the small-molecules from the model and running five cycles of refinement. Following data preparation, the blobs are detected, described by numerical features, and fed to the classification model. In the identification task, the classifier is a model trained on the entire PDB. In contrast, during the validation of an existing PDB deposit, the server uses a model that was trained on 90% of the PDB, excluding the deposit in question. Therefore, the validation of existing PDB deposits is always done using a model that was not trained on the structure being validated. Following model inference, a ranking of ten ligand predictions is prepared. If the primary classification model predicts the <italic toggle="yes">rare</italic> class within the top 10 most probable ligand groups, the secondary model is used to predict a set of 10 rare ligands.</p>
      </sec>
      <sec id="SEC3-1-3">
        <title>Result presentation</title>
        <p>CheckMyBlob predictions are displayed as an interactive report (Figure <xref rid="F2" ref-type="fig">2</xref>). Each detected blob has a separate section containing a ranking of 10 ligand predictions and a visualization panel. In the ranking, each ligand prediction is accompanied by a probability score. Higher probabilities mean greater chances of correct predictions. On the other hand, if the probability is low, users should treat the prediction with more caution even if it is at the top of the ranking. Each blob prediction or validation is additionally color-coded to indicate CheckMyBlob's certainty level. Based on the calibration plot of the classification model, validation probabilities above 90% were set to be color-coded with a green icon, between 50–90% with orange, and below 50% with red. Ligand identification color coding uses a 65% unsure threshold instead of 50% to take into account the higher difficulty of this task. To help users navigate the large number of potential ligands, hovering on a ligand's PDB ID shows the compound's full chemical name and diagram. Clicking on a ligand ID opens the ligand's page at the PDB website. In the visualization panel, users can zoom, pan, rotate the view, and hide different parts of the electron density map to analyze the blob. If the set of blobs needs a more in-depth inspection, a script can be downloaded that creates a CheckMyBlob report window in Coot. The report window contains tabs that allow a user to jump to different blobs in the map and display predictions. When the user clicks the button of a possible ligand, Coot performs a simple jiggle fit to fit the ligand into the electron density.</p>
      </sec>
    </sec>
    <sec id="SEC3-2">
      <title>Case studies</title>
      <sec id="SEC3-2-1">
        <title>Ligand validations</title>
        <p>CheckMyBlob was successfully used to recognize ligands in a set of example structures, including the PDB entries:</p>
        <list list-type="bullet">
          <list-item>
            <p>1OGV, 3MB5 and 4IUN, which represent medium and large moieties that were examined in previous ligand prediction studies (<xref rid="B9" ref-type="bibr">9</xref>,<xref rid="B15" ref-type="bibr">15</xref>);</p>
          </list-item>
          <list-item>
            <p>5N0H, which illustrates the recognition of buffer components;</p>
          </list-item>
          <list-item>
            <p>2PDT, 1FPX, 4RK3 and 1KWN, which showcase correct predictions of ligands that were misidentified in the original PDB deposits.</p>
          </list-item>
        </list>
        <p>The last four of the above-mentioned structures were cases where CheckMyBlob identified the ligand correctly, but the original authors of the PDB deposit either mislabeled a molecule or modeled it incorrectly. In 2PDT, flavin-adenine dinucleotide was reinterpreted by CheckMyBlob as flavin mononucleotide. In 1KWN, the modeled atoms of the ligand had the configuration of <sc>l</sc>(+)-tartaric acid (TLA) as identified by CheckMyBlob, whereas the deposition authors labeled this moiety (inconsistently with the configuration of the ligand) as <sc>d</sc>(–)-tartaric acid (TAR). In 1FPX, the modeled <italic toggle="yes">S</italic>-adenosyl-<sc>l</sc>-methionine (SAM) was reinterpreted as <italic toggle="yes">S</italic>-adenosyl-<sc>l</sc>-homocysteine (SAH). In 4RK3, disordered glycerol was reinterpreted as a TRIS buffer. The above cases can be viewed as interactive visualizations in Molstack (<xref rid="B26" ref-type="bibr">26</xref>,<xref rid="B27" ref-type="bibr">27</xref>) at <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://molstack.bioreproducibility.org/collection/view/YskIjr2eiLoQelKrwnIG/" ext-link-type="uri">http://molstack.bioreproducibility.org/collection/view/YskIjr2eiLoQelKrwnIG/</ext-link>. The authors of these four deposits (2PDT, 1FPX, 4RK3, 1KWN) agreed with the CheckMyBlob reinterpretation, and the structures were corrected, re-refined, and re-deposited jointly with the original authors into the PDB. In some cases, the improvements of model quality were as large as a 5% reduction of <italic toggle="yes">R</italic><sub>free</sub> or a drop of the clashscore by 20 points. This demonstrates that CheckMyBlob can correctly identify ligands, even in sub-optimally modeled structures. Details of this case study can be found in (<xref rid="B16" ref-type="bibr">16</xref>).</p>
      </sec>
      <sec id="SEC3-2-2">
        <title>Missed polypeptide and ligands masked by water</title>
        <p>The CheckMyBlob web server attempts to recognize not only unmodeled single-molecule ligands but also polymers, i.e., ligands that the PDB encodes as several monomers, and ligands ‘masked’ by water molecules. Figure <xref rid="F2" ref-type="fig">2</xref> presents such a case for the validation of PDB deposit 6SYH. CheckMyBlob shows that the deposition authors improperly modeled part of the protein main-chain and did not model two molecules of the crystallization buffer components—HEPES or MES and sulphate or phosphate (the exact nature of the buffer molecules is not possible to determine due to the lack of metadata for this deposit). The significance of this CheckMyBlob use case is twofold. First, our validation procedure is sensitive to some classes of macromolecule modeling errors. In this case, the part of the protein's main-chain (B289-B293) was assigned a wrong sequence and effectively was not bonded to the rest of the protein. Second, when the user chooses to remove waters before the analysis, CheckMyBlob can determine the nature of the ligand even if the density was previously ‘masked’ by the addition of waters in place of the ligand. Both of these types of errors happen frequently during the automatic stages of structure modeling and this example demonstrates the benefit of using the CheckMyBlob server as an aide for crystallographers during the early modeling phase. To facilitate actionable analysis of the server's predictions, CheckMyBlob generates a script for Coot, which lets users jump between blobs and quickly test different ligand fits.</p>
      </sec>
      <sec id="SEC3-2-3">
        <title>Analysis of metal ion predictions</title>
        <p>We have also validated the predictive performance of CheckMyBlob on metal ions. Since a significant fraction of structures in the PDB contains poorly modeled metal binding sites (<xref rid="B28" ref-type="bibr">28</xref>), we have focused on a high-quality subset of metal ligands. The subset was created by selecting metals that were favorably validated by the CheckMyMetal (CMM) web server (<xref rid="B28" ref-type="bibr">28</xref>,<xref rid="B29" ref-type="bibr">29</xref>). A metal ion in a structure was considered valid if all CMM validation criteria could be calculated and none of them were reported as an outlier. This procedure resulted in a dataset of 34 932 metal ion ligands, which were passed through CheckMyBlob's validation procedure. The overall classification accuracy on this dataset was 92.3%, although with varying precision and recall for different metal groups (Table <xref rid="tbl2" ref-type="table">2</xref>). The best performance was observed for Zn-like metals (Zn, Mn, Cu, Fe, Ni, Co, Cr, Ga, Ti, V), which are also the most populous metal ligand group. On the other hand, CheckMyBlob was not able to recognize any of the Sr-like metals (Sr, Rb). It is worth noting that CheckMyBlob was not specifically trained to predict metal ions. The prediction of metals could be improved in the future by training a classifier on groups of metals with similar conformations and using additional knowledge about the expected properties of the binding pocket.</p>
        <table-wrap position="float" id="tbl2">
          <label>Table 2.</label>
          <caption>
            <p>CheckMyBlob's predictive performance on metal ions validated by CMM (<xref rid="B28" ref-type="bibr">28</xref>,<xref rid="B29" ref-type="bibr">29</xref>). Total number of ligands: 34 932. Total classification accuracy on this dataset: 92.3%</p>
          </caption>
          <table frame="hsides" rules="groups">
            <thead>
              <tr>
                <th rowspan="1" colspan="1">Ligand group</th>
                <th rowspan="1" colspan="1">Precision (%)</th>
                <th rowspan="1" colspan="1">Recall (%)</th>
                <th rowspan="1" colspan="1">F1-score (%)</th>
                <th rowspan="1" colspan="1">Ligand instances</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td rowspan="1" colspan="1">MG-like</td>
                <td align="center" rowspan="1" colspan="1">88.8</td>
                <td align="center" rowspan="1" colspan="1">87.4</td>
                <td align="center" rowspan="1" colspan="1">88.1</td>
                <td rowspan="1" colspan="1">7 063</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">CA-like</td>
                <td align="center" rowspan="1" colspan="1">89.9</td>
                <td align="center" rowspan="1" colspan="1">93.0</td>
                <td align="center" rowspan="1" colspan="1">91.4</td>
                <td rowspan="1" colspan="1">12 682</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">ZN-like</td>
                <td align="center" rowspan="1" colspan="1">96.4</td>
                <td align="center" rowspan="1" colspan="1">95.2</td>
                <td align="center" rowspan="1" colspan="1">95.8</td>
                <td rowspan="1" colspan="1">14 686</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">SR-like</td>
                <td align="center" rowspan="1" colspan="1">0.0</td>
                <td align="center" rowspan="1" colspan="1">0.0</td>
                <td align="center" rowspan="1" colspan="1">0.0</td>
                <td rowspan="1" colspan="1">19</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">CD-like</td>
                <td align="center" rowspan="1" colspan="1">85.1</td>
                <td align="center" rowspan="1" colspan="1">59.6</td>
                <td align="center" rowspan="1" colspan="1">70.1</td>
                <td rowspan="1" colspan="1">441</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">HG-like</td>
                <td align="center" rowspan="1" colspan="1">40.5</td>
                <td align="center" rowspan="1" colspan="1">41.5</td>
                <td align="center" rowspan="1" colspan="1">41.0</td>
                <td rowspan="1" colspan="1">41</td>
              </tr>
            </tbody>
          </table>
          <table-wrap-foot>
            <fn id="T2TFN1">
              <p>MG-like: Mg, Na, Al; CA-like: Ca, K; ZN-like: Zn, Mn, Cu, Fe, Ni, Co, Cr, Ga, Ti, V; SR-like: Sr, Rb; CD-like: Cd, Ag, Mo, Ru, Pd, Y, Rh, Zr, In; HG-like: all metals with atomic number 55 (Cs) or higher.</p>
            </fn>
          </table-wrap-foot>
        </table-wrap>
      </sec>
    </sec>
    <sec id="SEC3-3">
      <title>Limitations</title>
      <p>The performance of machine learning systems relies on the number and quality of training examples. Indeed, CheckMyBlob requires training data in the form of previous observations of any particular target ligand. Therefore, to detect ligands without examples in the PDB, one can only predict moieties that are structurally similar to the target ligand. Moreover, even though the ligand instances used for training were selected based on several quality criteria, it is impossible to eliminate all noisy examples without removing most of the training data. X-ray electron density maps are noisy by nature and, as evidenced by the case studies, PDB deposits can contain mislabeled ligands. Nevertheless, as the number and quality of PDB deposits grow, it will be possible to tighten the ligand selection criteria for training data even further.</p>
      <p>It must also be noted that each prediction should be analyzed on a case-by-case basis. CheckMyBlob's prediction is based solely on the electron density map, and the knowledge about all ligands that might be present in the crystal should be used to select the most probable suggestions, even if they are not at the top of the prediction list. One should consider crystallization conditions, protein buffer components, compounds potentially retained during protein purification, and any potential chemical reactions in between. Moreover, as our study discussing the classification model has shown (<xref rid="B16" ref-type="bibr">16</xref>), higher resolution structures have, on average, higher chances of yielding correct predictions.</p>
      <p>The current version of the server also has a technical limitation of not being able to fully automatically process models that contain residues that are not present in REFMAC’s standard monomer dictionary. Both ligand validation and identification require a REFMAC run to standardize the map. If the analyzed model contains non-standard or unconventionally named residues, the re-refinement step of the processing pipeline can fail. Currently, the PDB does not host restraint libraries used during refinement; therefore, this might be a problem even during the validation of some PDB deposits. To alleviate this issue, future versions of the server will use automatically generated restraints for moieties that are not present in the standard monomer dictionary.</p>
    </sec>
  </sec>
  <sec sec-type="discussion" id="SEC4">
    <title>DISCUSSION</title>
    <p>Here, we have presented an intuitive, easy-to-use web server that aids users in predicting small-molecule ligands in unmodeled fragments of electron density maps and helps validate ligands in existing models. The CheckMyBlob web server is free and open to all users, and there is no login requirement. This work builds on previous efforts to predict ligands using machine learning algorithms (<xref rid="B16" ref-type="bibr">16</xref>) and extends that approach by clustering ligands into groups and by taking into account water molecules and metal ions. In case studies, we have shown how CheckMyBlob can be used to find errors in PDB deposits and identify missing ligands. We feel that this work is a valuable contribution to the scientific community by providing a way of ligand validation that is complementary to density fit metrics. Moreover, CheckMyBlob is complementary to structure-remediation servers, such as PDB_REDO (<xref rid="B30" ref-type="bibr">30</xref>), which do not handle ligand misinterpretation. Finally, CheckMyBlob can help find ligands that were unmodeled or masked by water molecules. By providing a method for autonomous detection of blobs, the presented method has the potential of being another step toward fully automated model building.</p>
  </sec>
  <sec sec-type="data-availability" id="SEC5">
    <title>DATA AVAILABILITY</title>
    <p>The ligand clustering code and prediction evaluation scripts are available at GitHub (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://github.com/dabrze/cmb_server_validation" ext-link-type="uri">https://github.com/dabrze/cmb_server_validation</ext-link>). The ligand datasets used for evaluating CheckMyBlob are hosted at bioreproducibility.org (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://bioreproducibility.org/test-data-checkmyblob-server/" ext-link-type="uri">https://bioreproducibility.org/test-data-checkmyblob-server</ext-link>) and Zenodo (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="10.5281/zenodo.4554473" ext-link-type="doi">10.5281/zenodo.4554473</ext-link>).</p>
  </sec>
</body>
<back>
  <ack id="ACK1">
    <title>ACKNOWLEDGEMENTS</title>
    <p>We would like to thank Ivan Shabalin, Mateusz Czub, Bernhard Rupp and David Cooper for providing us with valuable feedback during the development of the server and Tomasz Osinski for providing technical support.</p>
  </ack>
  <sec id="SEC6">
    <title>FUNDING</title>
    <p>National Institute of General Medical Sciences [R01-GM132595 to W.M.]; Polish National Agency for Academic Exchange [PPN/BEK/2018/1/00058/U/00001 to D.B.]; University of Warsaw's Integrated Development Programme (ZIP), co-financed by the European Social Fund within the framework of Operational Programme Knowledge Education Development 2016–2020, action 3.5 [to J.M.M]. Funding for open access charge: National Institute of General Medical Sciences.</p>
    <p><italic toggle="yes">Conflict of interest statement</italic>. None declared.</p>
  </sec>
  <ref-list id="REF1">
    <title>REFERENCES</title>
    <ref id="B1">
      <label>1.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pozharski</surname><given-names>E.</given-names></string-name>, <string-name><surname>Weichenberger</surname><given-names>C.X.</given-names></string-name>, <string-name><surname>Rupp</surname><given-names>B.</given-names></string-name></person-group><article-title>Techniques, tools and best practices for ligand electron-density analysis and results from their application to deposited crystal structures</article-title>. <source>Acta Crystallogr. Sect. D Biol. Crystallogr.</source><year>2013</year>; <volume>69</volume>:<fpage>150</fpage>–<lpage>167</lpage>.<pub-id pub-id-type="pmid">23385452</pub-id></mixed-citation>
    </ref>
    <ref id="B2">
      <label>2.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Adams</surname><given-names>P.D.</given-names></string-name>, <string-name><surname>Aertgeerts</surname><given-names>K.</given-names></string-name>, <string-name><surname>Bauer</surname><given-names>C.</given-names></string-name>, <string-name><surname>Bell</surname><given-names>J.A.</given-names></string-name>, <string-name><surname>Berman</surname><given-names>H.M.</given-names></string-name>, <string-name><surname>Bhat</surname><given-names>T.N.</given-names></string-name>, <string-name><surname>Blaney</surname><given-names>J.M.</given-names></string-name>, <string-name><surname>Bolton</surname><given-names>E.</given-names></string-name>, <string-name><surname>Bricogne</surname><given-names>G.</given-names></string-name>, <string-name><surname>Brown</surname><given-names>D.</given-names></string-name><etal>et al</etal>.</person-group><article-title>Outcome of the First wwPDB/CCDC/D3R ligand validation workshop</article-title>. <source>Structure</source>. <year>2016</year>; <volume>24</volume>:<fpage>502</fpage>–<lpage>508</lpage>.<pub-id pub-id-type="pmid">27050687</pub-id></mixed-citation>
    </ref>
    <ref id="B3">
      <label>3.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Oldfield</surname><given-names>T.J.</given-names></string-name></person-group><article-title>X-LIGAND: an application for the automated addition of flexible ligands into electron density</article-title>. <source>Acta Crystallogr. Sect. D Biol. Crystallogr.</source><year>2001</year>; <volume>57</volume>:<fpage>696</fpage>–<lpage>705</lpage>.<pub-id pub-id-type="pmid">11320310</pub-id></mixed-citation>
    </ref>
    <ref id="B4">
      <label>4.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Terwilliger</surname><given-names>T.C.</given-names></string-name>, <string-name><surname>Klei</surname><given-names>H.</given-names></string-name>, <string-name><surname>Adams</surname><given-names>P.D.</given-names></string-name>, <string-name><surname>Moriarty</surname><given-names>N.W.</given-names></string-name>, <string-name><surname>Cohn</surname><given-names>J.D.</given-names></string-name></person-group><article-title>Automated ligand fitting by core-fragment fitting and extension into density</article-title>. <source>Acta Crystallogr. Sect. D Biol. Crystallogr.</source><year>2006</year>; <volume>62</volume>:<fpage>915</fpage>–<lpage>922</lpage>.<pub-id pub-id-type="pmid">16855309</pub-id></mixed-citation>
    </ref>
    <ref id="B5">
      <label>5.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Debreczeni</surname><given-names>J.É.</given-names></string-name>, <string-name><surname>Emsley</surname><given-names>P.</given-names></string-name></person-group><article-title>Handling ligands with Coot</article-title>. <source>Acta Crystallogr. Sect. D Biol. Crystallogr.</source><year>2012</year>; <volume>68</volume>:<fpage>425</fpage>–<lpage>430</lpage>.<pub-id pub-id-type="pmid">22505262</pub-id></mixed-citation>
    </ref>
    <ref id="B6">
      <label>6.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zwart</surname><given-names>P.H.</given-names></string-name>, <string-name><surname>Langer</surname><given-names>G.G.</given-names></string-name>, <string-name><surname>Lamzin</surname><given-names>V.S.</given-names></string-name></person-group><article-title>Modelling bound ligands in protein crystal structures</article-title>. <source>Acta Crystallogr. Sect. D Biol. Crystallogr.</source><year>2004</year>; <volume>60</volume>:<fpage>2230</fpage>–<lpage>2239</lpage>.<pub-id pub-id-type="pmid">15572776</pub-id></mixed-citation>
    </ref>
    <ref id="B7">
      <label>7.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Evrard</surname><given-names>G.X.</given-names></string-name>, <string-name><surname>Langer</surname><given-names>G.G.</given-names></string-name>, <string-name><surname>Perrakis</surname><given-names>A.</given-names></string-name>, <string-name><surname>Lamzin</surname><given-names>V.S.</given-names></string-name></person-group><article-title>Assessment of automatic ligand building in ARP /wARP</article-title>. <source>Acta Crystallogr. Sect. D Biol. Crystallogr.</source><year>2007</year>; <volume>63</volume>:<fpage>108</fpage>–<lpage>117</lpage>.<pub-id pub-id-type="pmid">17164533</pub-id></mixed-citation>
    </ref>
    <ref id="B8">
      <label>8.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Langer</surname><given-names>G.G.</given-names></string-name>, <string-name><surname>Hazledine</surname><given-names>S.</given-names></string-name>, <string-name><surname>Wiegels</surname><given-names>T.</given-names></string-name>, <string-name><surname>Carolan</surname><given-names>C.</given-names></string-name>, <string-name><surname>Lamzin</surname><given-names>V.S.</given-names></string-name></person-group><article-title>Visual automated macromolecular model building</article-title>. <source>Acta Crystallogr. Sect. D Biol. Crystallogr.</source><year>2013</year>; <volume>69</volume>:<fpage>635</fpage>–<lpage>641</lpage>.<pub-id pub-id-type="pmid">23519672</pub-id></mixed-citation>
    </ref>
    <ref id="B9">
      <label>9.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Terwilliger</surname><given-names>T.C.</given-names></string-name>, <string-name><surname>Adams</surname><given-names>P.D.</given-names></string-name>, <string-name><surname>Moriarty</surname><given-names>N.W.</given-names></string-name>, <string-name><surname>Cohn</surname><given-names>J.D.</given-names></string-name></person-group><article-title>Ligand identification using electron-density map correlations</article-title>. <source>Acta Crystallogr. Sect. D Biol. Crystallogr.</source><year>2007</year>; <volume>63</volume>:<fpage>101</fpage>–<lpage>107</lpage>.<pub-id pub-id-type="pmid">17164532</pub-id></mixed-citation>
    </ref>
    <ref id="B10">
      <label>10.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Berman</surname><given-names>H.M.</given-names></string-name></person-group><article-title>The protein data bank</article-title>. <source>Nucleic Acids Res.</source><year>2000</year>; <volume>28</volume>:<fpage>235</fpage>–<lpage>242</lpage>.<pub-id pub-id-type="pmid">10592235</pub-id></mixed-citation>
    </ref>
    <ref id="B11">
      <label>11.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Aishima</surname><given-names>J.</given-names></string-name>, <string-name><surname>Russel</surname><given-names>D.S.</given-names></string-name>, <string-name><surname>Guibas</surname><given-names>L.J.</given-names></string-name>, <string-name><surname>Adams</surname><given-names>P.D.</given-names></string-name>, <string-name><surname>Brunger</surname><given-names>A.T.</given-names></string-name></person-group><article-title>Automated crystallographic ligand building using the medial axis transform of an electron-density isosurface</article-title>. <source>Acta Crystallogr. Sect. D Biol. Crystallogr.</source><year>2005</year>; <volume>61</volume>:<fpage>1354</fpage>–<lpage>1363</lpage>.<pub-id pub-id-type="pmid">16204887</pub-id></mixed-citation>
    </ref>
    <ref id="B12">
      <label>12.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sommer</surname><given-names>I.</given-names></string-name>, <string-name><surname>Muller</surname><given-names>O.</given-names></string-name>, <string-name><surname>Domingues</surname><given-names>F.S.</given-names></string-name>, <string-name><surname>Sander</surname><given-names>O.</given-names></string-name>, <string-name><surname>Weickert</surname><given-names>J.</given-names></string-name>, <string-name><surname>Lengauer</surname><given-names>T.</given-names></string-name></person-group><article-title>Moment invariants as shape recognition technique for comparing protein binding sites</article-title>. <source>Bioinformatics</source>. <year>2007</year>; <volume>23</volume>:<fpage>3139</fpage>–<lpage>3146</lpage>.<pub-id pub-id-type="pmid">17977888</pub-id></mixed-citation>
    </ref>
    <ref id="B13">
      <label>13.</label>
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Gunasekaran</surname><given-names>P.</given-names></string-name>, <string-name><surname>Grandison</surname><given-names>S.</given-names></string-name>, <string-name><surname>Cowtan</surname><given-names>K.</given-names></string-name>, <string-name><surname>Mak</surname><given-names>L.</given-names></string-name>, <string-name><surname>Lawson</surname><given-names>D.M.</given-names></string-name>, <string-name><surname>Morris</surname><given-names>R.J.</given-names></string-name></person-group><article-title>Ligand electron density shape recognition using 3D zernike descriptors</article-title>. <source>Pattern Recognition in Bioinformatics. PRIB 2009</source>. <year>2009</year>; <fpage>125</fpage>–<lpage>136</lpage>.</mixed-citation>
    </ref>
    <ref id="B14">
      <label>14.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hattne</surname><given-names>J.</given-names></string-name>, <string-name><surname>Lamzin</surname><given-names>V.S.</given-names></string-name></person-group><article-title>A moment invariant for evaluating the chirality of three-dimensional objects</article-title>. <source>J. R. Soc. Interface</source>. <year>2011</year>; <volume>8</volume>:<fpage>144</fpage>–<lpage>151</lpage>.<pub-id pub-id-type="pmid">20685692</pub-id></mixed-citation>
    </ref>
    <ref id="B15">
      <label>15.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Carolan</surname><given-names>C.G.</given-names></string-name>, <string-name><surname>Lamzin</surname><given-names>V.S.</given-names></string-name></person-group><article-title>Automated identification of crystallographic ligands using sparse-density representations</article-title>. <source>Acta Crystallogr. Sect. D Biol. Crystallogr.</source><year>2014</year>; <volume>70</volume>:<fpage>1844</fpage>–<lpage>1853</lpage>.<pub-id pub-id-type="pmid">25004962</pub-id></mixed-citation>
    </ref>
    <ref id="B16">
      <label>16.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kowiel</surname><given-names>M.</given-names></string-name>, <string-name><surname>Brzezinski</surname><given-names>D.</given-names></string-name>, <string-name><surname>Porebski</surname><given-names>P.J.</given-names></string-name>, <string-name><surname>Shabalin</surname><given-names>I.G.</given-names></string-name>, <string-name><surname>Jaskolski</surname><given-names>M.</given-names></string-name>, <string-name><surname>Minor</surname><given-names>W.</given-names></string-name></person-group><article-title>Automatic recognition of ligands in electron density by machine learning</article-title>. <source>Bioinformatics</source>. <year>2019</year>; <volume>35</volume>:<fpage>452</fpage>–<lpage>461</lpage>.<pub-id pub-id-type="pmid">30016407</pub-id></mixed-citation>
    </ref>
    <ref id="B17">
      <label>17.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Casañal</surname><given-names>A.</given-names></string-name>, <string-name><surname>Lohkamp</surname><given-names>B.</given-names></string-name>, <string-name><surname>Emsley</surname><given-names>P.</given-names></string-name></person-group><article-title>Current developments in Coot for macromolecular model building of Electron Cryo-microscopy and Crystallographic Data</article-title>. <source>Protein Sci.</source><year>2020</year>; <volume>29</volume>:<fpage>1055</fpage>–<lpage>1064</lpage>.</mixed-citation>
    </ref>
    <ref id="B18">
      <label>18.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Winn</surname><given-names>M.D.</given-names></string-name>, <string-name><surname>Ballard</surname><given-names>C.C.</given-names></string-name>, <string-name><surname>Cowtan</surname><given-names>K.D.</given-names></string-name>, <string-name><surname>Dodson</surname><given-names>E.J.</given-names></string-name>, <string-name><surname>Emsley</surname><given-names>P.</given-names></string-name>, <string-name><surname>Evans</surname><given-names>P.R.</given-names></string-name>, <string-name><surname>Keegan</surname><given-names>R.M.</given-names></string-name>, <string-name><surname>Krissinel</surname><given-names>E.B.</given-names></string-name>, <string-name><surname>Leslie</surname><given-names>A.G.W.</given-names></string-name>, <string-name><surname>McCoy</surname><given-names>A.</given-names></string-name><etal>et al</etal>.</person-group><article-title>Overview of the CCP4 suite and current developments</article-title>. <source>Acta Crystallogr. Sect. D Biol. Crystallogr.</source><year>2011</year>; <volume>67</volume>:<fpage>235</fpage>–<lpage>242</lpage>.<pub-id pub-id-type="pmid">21460441</pub-id></mixed-citation>
    </ref>
    <ref id="B19">
      <label>19.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Altschul</surname><given-names>S.</given-names></string-name></person-group><article-title>Gapped BLAST and PSI-BLAST: a new generation of protein database search programs</article-title>. <source>Nucleic Acids Res.</source><year>1997</year>; <volume>25</volume>:<fpage>3389</fpage>–<lpage>3402</lpage>.<pub-id pub-id-type="pmid">9254694</pub-id></mixed-citation>
    </ref>
    <ref id="B20">
      <label>20.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Murshudov</surname><given-names>G.N.</given-names></string-name>, <string-name><surname>Skubák</surname><given-names>P.</given-names></string-name>, <string-name><surname>Lebedev</surname><given-names>A.A.</given-names></string-name>, <string-name><surname>Pannu</surname><given-names>N.S.</given-names></string-name>, <string-name><surname>Steiner</surname><given-names>R.A.</given-names></string-name>, <string-name><surname>Nicholls</surname><given-names>R.A.</given-names></string-name>, <string-name><surname>Winn</surname><given-names>M.D.</given-names></string-name>, <string-name><surname>Long</surname><given-names>F.</given-names></string-name>, <string-name><surname>Vagin</surname><given-names>A.A.</given-names></string-name></person-group><article-title>REFMAC5 for the refinement of macromolecular crystal structures</article-title>. <source>Acta Crystallogr. Sect. D Biol. Crystallogr.</source><year>2011</year>; <volume>67</volume>:<fpage>355</fpage>–<lpage>367</lpage>.<pub-id pub-id-type="pmid">21460454</pub-id></mixed-citation>
    </ref>
    <ref id="B21">
      <label>21.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Friedman</surname><given-names>J.H.</given-names></string-name></person-group><article-title>Greedy function approximation: a gradient boosting machine</article-title>. <source>Ann. Stat.</source><year>2001</year>; <volume>29</volume>:<fpage>1189</fpage>–<lpage>1232</lpage>.</mixed-citation>
    </ref>
    <ref id="B22">
      <label>22.</label>
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Flach</surname><given-names>P.</given-names></string-name></person-group><source>Machine Learning: the Art and Science of Algorithms that Make Sense of Data</source>. <year>2012</year>; <publisher-name>Cambridge University Press</publisher-name>.</mixed-citation>
    </ref>
    <ref id="B23">
      <label>23.</label>
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Japkowicz</surname><given-names>N.</given-names></string-name>, <string-name><surname>Shah</surname><given-names>M.</given-names></string-name></person-group><source>Evaluating Learning Algorithms: A Classification Perspective</source>. <year>2011</year>; <publisher-loc>NY</publisher-loc><publisher-name>Cambridge University Press</publisher-name>.</mixed-citation>
    </ref>
    <ref id="B24">
      <label>24.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Rose</surname><given-names>A.S.</given-names></string-name>, <string-name><surname>Hildebrand</surname><given-names>P.W.</given-names></string-name></person-group><article-title>NGL viewer: a web application for molecular visualization</article-title>. <source>Nucleic Acids Res.</source><year>2015</year>; <volume>43</volume>:<fpage>W576</fpage>–<lpage>W579</lpage>.<pub-id pub-id-type="pmid">25925569</pub-id></mixed-citation>
    </ref>
    <ref id="B25">
      <label>25.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Rose</surname><given-names>A.S.</given-names></string-name>, <string-name><surname>Bradley</surname><given-names>A.R.</given-names></string-name>, <string-name><surname>Valasatava</surname><given-names>Y.</given-names></string-name>, <string-name><surname>Duarte</surname><given-names>J.M.</given-names></string-name>, <string-name><surname>Prlić</surname><given-names>A.</given-names></string-name>, <string-name><surname>Rose</surname><given-names>P.W.</given-names></string-name></person-group><article-title>NGL viewer: web-based molecular graphics for large complexes</article-title>. <source>Bioinformatics</source>. <year>2018</year>; <volume>34</volume>:<fpage>3755</fpage>–<lpage>3758</lpage>.<pub-id pub-id-type="pmid">29850778</pub-id></mixed-citation>
    </ref>
    <ref id="B26">
      <label>26.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Porebski</surname><given-names>P.J.</given-names></string-name>, <string-name><surname>Bokota</surname><given-names>G.</given-names></string-name>, <string-name><surname>Venkataramany</surname><given-names>B.S.</given-names></string-name>, <string-name><surname>Minor</surname><given-names>W.</given-names></string-name></person-group><article-title>Molstack: a platform for interactive presentations of electron density and cryo-EM maps and their interpretations</article-title>. <source>Protein Sci.</source><year>2020</year>; <volume>29</volume>:<fpage>120</fpage>–<lpage>127</lpage>.<pub-id pub-id-type="pmid">31605409</pub-id></mixed-citation>
    </ref>
    <ref id="B27">
      <label>27.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Porebski</surname><given-names>P.J.</given-names></string-name>, <string-name><surname>Sroka</surname><given-names>P.</given-names></string-name>, <string-name><surname>Zheng</surname><given-names>H.</given-names></string-name>, <string-name><surname>Cooper</surname><given-names>D.R.</given-names></string-name>, <string-name><surname>Minor</surname><given-names>W.</given-names></string-name></person-group><article-title>Molstack-Interactive visualization tool for presentation, interpretation, and validation of macromolecules and electron density maps</article-title>. <source>Protein Sci.</source><year>2018</year>; <volume>27</volume>:<fpage>86</fpage>–<lpage>94</lpage>.<pub-id pub-id-type="pmid">28815771</pub-id></mixed-citation>
    </ref>
    <ref id="B28">
      <label>28.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zheng</surname><given-names>H.</given-names></string-name>, <string-name><surname>Cooper</surname><given-names>D.R.</given-names></string-name>, <string-name><surname>Porebski</surname><given-names>P.J.</given-names></string-name>, <string-name><surname>Shabalin</surname><given-names>I.G.</given-names></string-name>, <string-name><surname>Handing</surname><given-names>K.B.</given-names></string-name>, <string-name><surname>Minor</surname><given-names>W.</given-names></string-name></person-group><article-title>CheckMyMetal: a macromolecular metal-binding validation tool</article-title>. <source>Acta Crystallogr. Sect. D Struct. Biol.</source><year>2017</year>; <volume>73</volume>:<fpage>223</fpage>–<lpage>233</lpage>.<pub-id pub-id-type="pmid">28291757</pub-id></mixed-citation>
    </ref>
    <ref id="B29">
      <label>29.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zheng</surname><given-names>H.</given-names></string-name>, <string-name><surname>Chordia</surname><given-names>M.D.</given-names></string-name>, <string-name><surname>Cooper</surname><given-names>D.R.</given-names></string-name>, <string-name><surname>Chruszcz</surname><given-names>M.</given-names></string-name>, <string-name><surname>Müller</surname><given-names>P.</given-names></string-name>, <string-name><surname>Sheldrick</surname><given-names>G.M.</given-names></string-name>, <string-name><surname>Minor</surname><given-names>W.</given-names></string-name></person-group><article-title>Validation of metal-binding sites in macromolecular structures with the CheckMyMetal web server</article-title>. <source>Nat. Protoc.</source><year>2014</year>; <volume>9</volume>:<fpage>156</fpage>–<lpage>170</lpage>.<pub-id pub-id-type="pmid">24356774</pub-id></mixed-citation>
    </ref>
    <ref id="B30">
      <label>30.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Joosten</surname><given-names>R.P.</given-names></string-name>, <string-name><surname>Long</surname><given-names>F.</given-names></string-name>, <string-name><surname>Murshudov</surname><given-names>G.N.</given-names></string-name>, <string-name><surname>Perrakis</surname><given-names>A.</given-names></string-name></person-group><article-title>The PDB_REDO server for macromolecular structure model optimization</article-title>. <source>IUCrJ</source>. <year>2014</year>; <volume>1</volume>:<fpage>213</fpage>–<lpage>220</lpage>.</mixed-citation>
    </ref>
  </ref-list>
</back>
