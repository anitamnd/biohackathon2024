<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">5860068</article-id>
    <article-id pub-id-type="pmid">28505286</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btx305</article-id>
    <article-id pub-id-type="publisher-id">btx305</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Papers</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Data and Text Mining</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>PIXiE: an algorithm for automated ion mobility arrival time extraction and collision cross section calculation using global data association</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Ma</surname>
          <given-names>Jian</given-names>
        </name>
        <xref ref-type="aff" rid="btx305-aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Casey</surname>
          <given-names>Cameron P</given-names>
        </name>
        <xref ref-type="aff" rid="btx305-aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Zheng</surname>
          <given-names>Xueyun</given-names>
        </name>
        <xref ref-type="aff" rid="btx305-aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ibrahim</surname>
          <given-names>Yehia M</given-names>
        </name>
        <xref ref-type="aff" rid="btx305-aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wilkins</surname>
          <given-names>Christopher S</given-names>
        </name>
        <xref ref-type="aff" rid="btx305-aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Renslow</surname>
          <given-names>Ryan S</given-names>
        </name>
        <xref ref-type="aff" rid="btx305-aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Thomas</surname>
          <given-names>Dennis G</given-names>
        </name>
        <xref ref-type="aff" rid="btx305-aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Payne</surname>
          <given-names>Samuel H</given-names>
        </name>
        <xref ref-type="aff" rid="btx305-aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Monroe</surname>
          <given-names>Matthew E</given-names>
        </name>
        <xref ref-type="aff" rid="btx305-aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Smith</surname>
          <given-names>Richard D</given-names>
        </name>
        <xref ref-type="aff" rid="btx305-aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Teeguarden</surname>
          <given-names>Justin G</given-names>
        </name>
        <xref ref-type="aff" rid="btx305-aff1">1</xref>
        <xref ref-type="aff" rid="btx305-aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Baker</surname>
          <given-names>Erin S</given-names>
        </name>
        <xref ref-type="aff" rid="btx305-aff1">1</xref>
        <xref ref-type="corresp" rid="btx305-cor1"/>
        <!--<email>erin.baker@pnnl.gov</email>-->
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Metz</surname>
          <given-names>Thomas O</given-names>
        </name>
        <xref ref-type="aff" rid="btx305-aff1">1</xref>
        <xref ref-type="corresp" rid="btx305-cor1"/>
        <!--<email>thomas.metz@pnnl.gov</email>-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Wren</surname>
          <given-names>Jonathan</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <aff id="btx305-aff1"><label>1</label>Biological Sciences Division, Pacific Northwest National Laboratory, Richland, WA, USA</aff>
    <aff id="btx305-aff2"><label>2</label>Department of Environmental and Molecular Toxicology, Oregon State University, Corvallis, OR, USA</aff>
    <author-notes>
      <corresp id="btx305-cor1">To whom correspondence should be addressed. Email: <email>erin.baker@pnnl.gov</email> or <email>thomas.metz@pnnl.gov</email></corresp>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>01</day>
      <month>9</month>
      <year>2017</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2017-05-15">
      <day>15</day>
      <month>5</month>
      <year>2017</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>15</day>
      <month>5</month>
      <year>2017</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. -->
    <volume>33</volume>
    <issue>17</issue>
    <fpage>2715</fpage>
    <lpage>2722</lpage>
    <history>
      <date date-type="received">
        <day>09</day>
        <month>12</month>
        <year>2016</year>
      </date>
      <date date-type="rev-recd">
        <day>02</day>
        <month>5</month>
        <year>2017</year>
      </date>
      <date date-type="accepted">
        <day>12</day>
        <month>5</month>
        <year>2017</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Â© The Author 2017. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2017</copyright-year>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/" license-type="cc-by">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btx305.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="SA1">
        <title>Motivation</title>
        <p>Drift tube ion mobility spectrometry coupled with mass spectrometry (DTIMS-MS) is increasingly implemented in high throughput omics workflows, and new informatics approaches are necessary for processing the associated data. To automatically extract arrival times for molecules measured by DTIMS at multiple electric fields and compute their associated collisional cross sections (CCS), we created the PNNL Ion Mobility Cross Section Extractor (PIXiE). The primary application presented for this algorithm is the extraction of data that can then be used to create a reference library of experimental CCS values for use in high throughput omics analyses.</p>
      </sec>
      <sec id="SA2">
        <title>Results</title>
        <p>We demonstrate the utility of this approach by automatically extracting arrival times and calculating the associated CCSs for a set of endogenous metabolites and xenobiotics. The PIXiE-generated CCS values were within error of those calculated using commercially available instrument vendor software. </p>
      </sec>
      <sec id="SA3">
        <title>Availability and implementation</title>
        <p>PIXiE is an open-source tool, freely available on Github. The documentation, source code of the software, and a GUI can be found at <ext-link ext-link-type="uri" xlink:href="https://github.com/PNNL-Comp-Mass-Spec/PIXiE">https://github.com/PNNL-Comp-Mass-Spec/PIXiE</ext-link> and the source code of the backend workflow library used by PIXiE can be found at <ext-link ext-link-type="uri" xlink:href="https://github.com/PNNL-Comp-Mass-Spec/IMS-Informed-Library">https://github.com/PNNL-Comp-Mass-Spec/IMS-Informed-Library</ext-link>.</p>
      </sec>
      <sec id="SA4">
        <title>Supplementary information</title>
        <p><xref ref-type="supplementary-material" rid="sup1">Supplementary data</xref> are available at <italic>Bioinformatics</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">Laboratory Directed Research and Development</named-content>
          <named-content content-type="funder-identifier">10.13039/100007000</named-content>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">LDRD</named-content>
          <named-content content-type="funder-identifier">10.13039/100007000</named-content>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">U.S. Department of Energy</named-content>
          <named-content content-type="funder-identifier">10.13039/100000015</named-content>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">DOE</named-content>
          <named-content content-type="funder-identifier">10.13039/100000015</named-content>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">DOE</named-content>
          <named-content content-type="funder-identifier">10.13039/100000015</named-content>
        </funding-source>
        <award-id>DE-AC05-76RLO 1830</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="8"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>The field of metabolomics has made great strides since its early explorations by Pauling and Robinson (<xref rid="btx305-B20" ref-type="bibr">Pauling <italic>et al.</italic> (1971</xref>), <xref rid="btx305-B23" ref-type="bibr">Robinson <italic>et al.</italic> (1973</xref>), <xref rid="btx305-B24" ref-type="bibr">Robinson <italic>et al.</italic> (1974)</xref>), and conceptualization as an âomicsâ by <xref rid="btx305-B19" ref-type="bibr">Nicholson <italic>et al.</italic> (1999)</xref>. Many analytical platforms exist for collecting metabolomics data, although methods based upon gas chromatography (GC) and liquid chromatography (LC) coupled with mass spectrometry (MS) dominate most applications. Similarly, many algorithms and software packages are available for analyzing the data in the associated informatics pipelines. These informatics tools are used for identification and alignment of detected features (i.e. initially unidentified, putative metabolites) across multiple analyses (<xref rid="btx305-B14" ref-type="bibr">LaMarche <italic>et al.</italic> 2013</xref>; <xref rid="btx305-B21" ref-type="bibr">Pluskal <italic>et al.</italic> 2010</xref>; <xref rid="btx305-B27" ref-type="bibr">Smith <italic>et al.</italic> 2006</xref>), normalization of metabolite abundance information (<xref rid="btx305-B22" ref-type="bibr">Polpitiya <italic>et al.</italic> 2008</xref>; <xref rid="btx305-B33" ref-type="bibr">Xia <italic>et al.</italic> 2015</xref>), and matching the experimental metabolite characteristics to reference libraries containing spectra, retention times or chemical shifts from analyses of authentic chemical standards ( <xref rid="btx305-B7" ref-type="bibr">Gerlich and Neumann 2013</xref>, <xref rid="btx305-B13" ref-type="bibr">Kind <italic>et al.</italic> 2013</xref>; <xref rid="btx305-B31" ref-type="bibr">Weljie <italic>et al.</italic> 2006</xref>). However, a desire for the complete characterization of both xenobiotics and endogenous chemicals in human exposures has initiated a transformation in metabolomics (<xref rid="btx305-B4" ref-type="bibr">Council 2012</xref>; <xref rid="btx305-B18" ref-type="bibr">Metz <italic>et al.</italic> 2016</xref>; <xref rid="btx305-B28" ref-type="bibr">Soltow <italic>et al.</italic> 2011</xref>), resulting in the need for measurements that provide much higher throughput while still maintaining high sensitivity.</p>
    <p>Drift tube ion mobility spectrometry (DTIMS) is a rapid gas phase separation technique that is easily combined with MS for high throughput multi-dimensional separations (<xref rid="btx305-B9" ref-type="bibr">Guevremont <italic>et al.</italic> 1997</xref>; <xref rid="btx305-B29" ref-type="bibr">Steiner <italic>et al.</italic> 2001</xref>). In DTIMS, ions are subject to a constant electric field while traveling through a buffer gas and separate quickly based on ion shape and size, e.g. compact species drift faster than those with extended structures (<xref rid="btx305-B9" ref-type="bibr">Guevremont <italic>et al.</italic> 1997</xref>; <xref rid="btx305-B16" ref-type="bibr">Mason and McDaniel 1988</xref>). By measuring DTIMS arrival times it is possible to derive a moleculeâs collisional cross section (CCS), which characterizes its chemical structure and increases the specificity of metabolite identifications, particularly when combined with accurate mass measurements. Herein, we report an approach for automatically extracting arrival times for metabolites from DTIMS-MS measurements and for subsequently calculating their CCS values, where multiple electric fields are utilized to obtain the most accurate experimental CCS measurements. Given a list of empirical formulae for target molecules of interest, our algorithm analyzes the DTIMS-MS data for each target ion and extracts the arrival times at the peak centroids for each electric field measurement. These arrival times are then utilized to calculate the CCS for each ion. When candidate ions are indistinguishable using mass information alone, the algorithm calculates and tracks CCSs for all possible candidate ions throughout the experiment by implementing a unique, global data association approach inspired from multi-object tracking in video sequences (Berclaz Fleuret <italic>et al.</italic> 2011; <xref rid="btx305-B26" ref-type="bibr">Siems <italic>et al.</italic> 1994</xref>). The resulting algorithm, implemented in the PNNL Ion Mobility Cross Section Extractor (PIXiE) software supports the extraction of arrival times, molecular CCSs and accurate mass data for the rapid construction of reference libraries for use in high throughput DTIMS-MS-based studies.</p>
  </sec>
  <sec>
    <title>2 Materials and methods</title>
    <sec>
      <title>2.1 Overview: CCS calculations from IMS data</title>
      <p>Reference libraries for high throughput identification of molecules ideally contain two or more orthogonal metrics such as accurate mass, isotopic signature, LC elution time, NMR spectra, MS/MS spectra, or DTIMS CCS values (<xref rid="btx305-B15" ref-type="bibr">Lapthorn <italic>et al.</italic> 2013</xref>). These criteria adhere to the recommendations of the Metabolomics Societyâs Metabolomics Standards Initiative for highest confidence in metabolite identification (<xref rid="btx305-B3" ref-type="bibr">Castle <italic>et al.</italic> 2006</xref>; <xref rid="btx305-B30" ref-type="bibr">Sumner <italic>et al.</italic> 2007</xref>). While methods for experimentally determining molecular CCS values are well established, software implementations to calculate these values remain limited with currently available open source tools either needing calibrant ions to calculate CCS values, requiring that CCS values be provided, or having difficulties calculating values for molecules other than native proteins (<xref rid="btx305-B1" ref-type="bibr">Allison <italic>et al.</italic> 2015</xref>; <xref rid="btx305-B6" ref-type="bibr">Eschweiler <italic>et al.</italic> 2015</xref>).This manuscript describes the automatic extraction of measured drift times and calculation of associated experimental CCS values by collecting ion arrival time distributions (ATDs) from analyses conducted at multiple, different electric fields (seven in this demonstration), a capability which is not currently available for DTIMS in open source format. Although it is possible to determine molecular CCS values experimentally using single electric field approaches together with calibration against molecules with known CCS values, we chose to measure CCS directly using multiple DTIMS electric fields, for higher accuracy. While we utilized seven electric fields for each measurement, any number &gt;2 can be used, with higher numbers enabling more accurate results. To acquire CCS, the mobility of each ion must be calculated by extracting the arrival time, <italic>t</italic><sub>A</sub>, from its peak apex, and then plotting it against <italic>p</italic>/(<italic>TV</italic>), as shown in <xref ref-type="disp-formula" rid="E1">Equation (1)</xref>.
<disp-formula id="E1"><label>(1)</label><mml:math id="M1"><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi mathvariant="normal">A</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mi>l</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mi>o</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mo>â</mml:mo><mml:mfrac><mml:mrow><mml:mn>273.15</mml:mn></mml:mrow><mml:mrow><mml:mn>760</mml:mn></mml:mrow></mml:mfrac><mml:mo>â</mml:mo><mml:mfrac><mml:mi>p</mml:mi><mml:mrow><mml:mi>V</mml:mi><mml:mo>â</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>o</mml:mi></mml:msub><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula>
The expression for <italic>t</italic><sub>A</sub> is an equation for a straight line (<italic>y</italic>â=â<italic>mx</italic>â+â<italic>b</italic>) where the slope of the line is inversely proportional to the reduced mobility of the ion (<italic>K<sub>o</sub></italic>), and the <italic>y</italic>-intercept is equal to the time outside the IMS drift cell (<italic>t<sub>o</sub></italic>). <italic>t</italic><sub>A</sub> is also a function of drift voltage (<italic>V</italic>, in volts), temperature (<italic>T</italic>, in Kelvins), pressure (<italic>p</italic>, in torr) and the physical length of the drift tube (<italic>l</italic>, in meters). Plots of <italic>t</italic><sub>A</sub> versus <italic>p</italic>/(<italic>TV</italic>) are highly linear with <italic>R</italic><sup>2</sup> values of at least 0.9999. The relationship between the mobility of an ion, <italic>K<sub>o</sub></italic>, and its CCS has been derived in detail using kinetic theory (<xref rid="btx305-B17" ref-type="bibr">Mason <italic>et al.</italic> 1958</xref>) and is given by <xref ref-type="disp-formula" rid="E2">Equation (2)</xref>.
<disp-formula id="E2"><label>(2)</label><mml:math id="M2"><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mi>o</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>3</mml:mn><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mn>16</mml:mn><mml:mi>N</mml:mi></mml:mrow></mml:mfrac><mml:mo>â</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mo>Ï</mml:mo></mml:mrow><mml:mrow><mml:mo>Î¼</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mi mathvariant="normal">B</mml:mi></mml:msub><mml:mi>T</mml:mi></mml:mrow></mml:mfrac></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>â</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mo>Î©</mml:mo></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
where <italic>q</italic> is the ion charge, <italic>N</italic> is the buffer gas density, Î¼ is the reduced mass of the collision partners, <italic>k</italic><sub>B</sub> is Boltzmannâs constant and <inline-formula id="IE1"><mml:math id="IM1"><mml:mo>Î©</mml:mo></mml:math></inline-formula> is the momentum transfer collision integral, which describes the collision between the ion and the buffer gas atoms and gives direct information about the conformation of the ion traveling through the drift cell. To reduce errors in the experimental evaluation of <inline-formula id="IE2"><mml:math id="IM2"><mml:mo>Î©</mml:mo></mml:math></inline-formula>, multiple measurements are made on each system studied so that standard deviations can be determined.</p>
      <p>Automated processing of DTIMS-MS data is required to support high-throughput creation of reference libraries, which would otherwise involve extensive manual data analysis. However, there are challenges associated with automated extraction of CCS as the DTIMS ATD peak at the expected <italic>m/z</italic> of a target ion can correspond to three distinct possibilities: (1) the actual target ion; (2) a co-drifting, unresolved compound that is indistinguishable from the target ion using <italic>m/z</italic>; or (3) noise. Further, to determine the link between observed and expected ions, as well as to identify and remove noise, peaks need to be detected and tracked across multiple electrical fields. We formulated this last challenge as a global data association problem, and refer to each of the potential solutions as an association hypothesis. To solve the global association problem, PIXiE creates the association hypotheses set based on analyses of peak diffusion profiles across electric fields. From this set, PIXiE selects the optimal association hypothesis as the final solution to the global data association problem. The following sections describe the details of each step of the algorithm in the order they are implemented (<xref ref-type="fig" rid="btx305-F1">Fig. 1</xref>).
</p>
      <fig id="btx305-F1" orientation="portrait" position="float">
        <label>Fig. 1.</label>
        <caption>
          <p>(<bold>a</bold>) Steps of the mobility extraction algorithm. A raw data file in UIMF format and a set of target ions are provided as inputs to PIXiE. The preprocessing step starts after voltage grouping to extract and filter peaks. After filtering, the algorithm uses K-shortest path and maximum <italic>a posteriori</italic> probability estimation to solve the global data association problem and process the peaks into mobility information of conformer ions; (<bold>b</bold>) Application of isotopic score for improved chemical identification. In the example shown, the software extracted two candidate conformers for bisphenol S (sulfonyl diphenol) when given a low isotopic score threshold in the preprocessing step. When the isotopic score threshold is raised, the latter conformer is removed due to its low isotopic score; (<bold>c</bold>) the ion transition graph G. Each path from source to sink represents a potential association hypothesis of ion peaks (<italic>x</italic><sub>1</sub>â¦<italic>x<sub>n</sub></italic>) across multiple electric fields. These hypotheses are evaluated for robustness, and those that pass all filtering steps are used to calculate CCS values. In the example above, two hypotheses, <italic>T</italic><sub>1</sub>â=â(<italic>x</italic><sub>1</sub>, <italic>x</italic><sub>4</sub>, <italic>x</italic><sub>7</sub>) and <italic>T</italic><sub>2</sub>â=â(<italic>x</italic><sub>2</sub>, <italic>x</italic><sub>6</sub>, <italic>x</italic><sub>9</sub>), represent two conformers measured across three electric fields </p>
        </caption>
        <graphic xlink:href="btx305f1"/>
      </fig>
    </sec>
    <sec>
      <title>2.2 Data collection and target lists</title>
      <p>For the CCS calculations made by PIXiE, <italic>n</italic> different electric fields are used. In our case, seven electric fields ranging from 10.8 to 18.5âV/cm were analyzed for 30âs each, resulting in 3.5âmin analyses for each ion collected in the same unified ion mobility file (UIMF) (<xref rid="btx305-B25" ref-type="bibr">Shah <italic>et al.</italic> 2010</xref>). PIXiE requires a target list to begin the analyses. This list consists of known empirical formulae and putative adducts for the molecules of interest in each UIMF. PIXiE then extracts CCSs for all molecular conformers of the target molecules that can be distinguished by the IMS separations.</p>
    </sec>
    <sec>
      <title>2.3 Peak identification, scoring and filtering</title>
      <p>PIXiE performs electric field grouping, multidimensional peak extraction (<xref rid="btx305-B5" ref-type="bibr">Crowell <italic>et al.</italic> 2013</xref>), scoring, and filtering (<xref ref-type="fig" rid="btx305-F1">Fig. 1</xref>). These steps detect candidate peak(s) for each target ion and remove those that do not have sufficient peak quality for further analysis or whose isotopic distribution(s) do not match that of the target empirical formula. These steps are described briefly below.</p>
      <sec>
        <title>2.3.1 Electric field grouping and multidimensional peak extraction</title>
        <p>The first step in processing the data in PIXiE is to bin the IMS-MS spectra according to the electric field at which the spectrum was collected. Spectra sharing the same electric field are then averaged to enhance the signal-to-noise ratio. DTIMS-MS features are then characterized by <italic>m/z</italic>, arrival time and intensity and extracted from the raw data using a modified version of the LC-IMS-MS Feature Finder (<xref rid="btx305-B5" ref-type="bibr">Crowell <italic>et al.</italic> 2013</xref>). The original implementation of the feature finder modeled a peak in two dimensions on an intensity map with LC retention time and IMS arrival time as <italic>x</italic>- and <italic>y</italic>-axes, respectively. We modified this algorithm to extract 2D peaks from an intensity map with <italic>m/z</italic> and arrival time as <italic>x</italic>- and <italic>y</italic>-axes. In order to increase computational performance, the peak detector was applied to the 2D intensity area within a Â±250-ppm mass window surrounding the expected <italic>m/z</italic> of the target molecule to determine noise and peaks. Filtering of co-drifting compounds based on measured <italic>m/z</italic> is implicitly done in the global data association step, as ions with a measured mass closer to the expected value produce a higher <italic>a posterior</italic> probability. A second mass measurement error threshold of Â±15âppm was then applied as part of the post-filtering process after the global data association step for better ion selection.</p>
      </sec>
      <sec>
        <title>2.3.2 Peak scoring and filtering</title>
        <p>For apex extraction, peaks are characterized according to the following: base peak intensity, <italic>m/z</italic> at the apex, arrival time at the apex, <italic>m/z</italic> width at the base peak, and the arrival time as full width at half maximum. In addition, a peak shape and isotopic distribution score (<xref rid="btx305-B8" ref-type="bibr">Ghavidel <italic>et al.</italic> 2014</xref>) are calculated to further characterize the quality of the peak and the proximity of the peak to the ideal isotopic distribution of the target molecule. The peak shape score is calculated by quantifying how closely the IMS peak diffusion profile matches the expected Gaussian distribution using the JaqueâBera Statistical Test (<xref rid="btx305-B12" ref-type="bibr">Jarque 1981</xref>). Peak shapes deviating significantly from the expected Gaussian distribution are likely to be instrumental or computational artifacts.</p>
        <p>The isotopic distribution score is calculated by quantifying the similarity between the theoretical (<xref rid="btx305-B11" ref-type="bibr">Jaitly <italic>et al.</italic> 2009</xref>) and observed isotopic distribution for each target molecule. The angle between the theoretical and observed isotopic distribution vectors (whose value is normalized to 1) is used as an isotopic matching score (<xref ref-type="disp-formula" rid="E3">Equation 3</xref>). The angle scoring method is preferred to conventional methods (e.g. Euclidean distance or Pearson correlation) for quantifying differences between expected and observed isotopic signatures when differences are large. This attribute is useful for filtering of peaks with a very low probability of being associated with target ions in the preprocessing step.
<disp-formula id="E3"><label>(3)</label><mml:math id="M3"><mml:mtable><mml:mtr><mml:mtd><mml:mo>â</mml:mo><mml:mtext>cos</mml:mtext><mml:mo>â</mml:mo><mml:mo>â¡</mml:mo><mml:mo>Î¸</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>I</mml:mi><mml:mo>â</mml:mo></mml:mover></mml:mrow><mml:mo>Ï</mml:mo></mml:msub><mml:mo>â</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>I</mml:mi><mml:mo>â</mml:mo></mml:mover></mml:mrow><mml:mi>o</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msqrt><mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>I</mml:mi><mml:mo>â</mml:mo></mml:mover></mml:mrow><mml:mo>Ï</mml:mo></mml:msub></mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mo>â</mml:mo><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>I</mml:mi><mml:mo>â</mml:mo></mml:mover></mml:mrow><mml:mi>o</mml:mi></mml:msub></mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mrow></mml:msqrt></mml:mrow></mml:mfrac></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mtext>Score</mml:mtext><mml:mrow><mml:mtext>isotopic</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mo>Î¸</mml:mo><mml:mrow><mml:mo>Ï</mml:mo><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mfrac></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula>
In addition, peaks with a summed intensity lower than 3% of the most abundant peak in the extraction window were also discarded as low relative intensity to prevent PIXiE from reporting false conformers. Peaks that did not pass the peak shape threshold, isotopic score threshold or the relative intensity threshold were also discarded in this step.</p>
      </sec>
    </sec>
    <sec>
      <title>2.4 Global data association</title>
      <p>Following the preprocessing steps, the global data association step further removes peaks that are artifacts and determines the link between observed peaks and target molecules. PIXiE makes the following assumptions for this step.
<list list-type="order"><list-item><p>Conformers and isobaric species of the target ion(s), are indistinguishable in the <italic>m/z</italic> dimension, and CCSs will be extracted for those ions, if detected.</p></list-item><list-item><p>Even under varying electric field, some aspects of the 2D diffusion profiles of a given ion remain the same. For example, the ion cloud distribution is largely determined by the initial pulse into the drift tube and the diffusion that occurs as the ions drift (<xref rid="btx305-B26" ref-type="bibr">Siems <italic>et al.</italic> 1994</xref>). As a result, the peak profile for a given molecule will broaden predictably (<xref rid="btx305-B16" ref-type="bibr">Mason and McDaniel 1988</xref>).</p></list-item><list-item><p>Peak apices corresponding to the same ion at different electric fields are subject to kinetic theory and can thus be modeled using <xref ref-type="disp-formula" rid="E1">Equation (1)</xref>.</p></list-item></list>To solve the global association problem, we implemented a <italic>K</italic>-shortest path scheme to identify potential association hypotheses constrained by the above assumptions. Next, in the association hypotheses set identified by the <italic>K</italic>-shortest path algorithm, we adapted Bayesian statistics and used maximum <italic>a posterior</italic> estimation (MAP) (<xref rid="btx305-B2" ref-type="bibr">Berclaz <italic>et al.</italic> 2011</xref>; <xref rid="btx305-B26" ref-type="bibr">Siems <italic>et al.</italic> 1994</xref>) to test association hypotheses against observed peaks and ultimately select the optimal case.</p>
      <sec>
        <title>2.4.1 <italic>K</italic>-shortest path for hypothesis space reduction</title>
        <p>If an ion is detected at more than one electric field, an ion path defining the ionâs presence at different electric fields is formed. When large numbers of peaks are observed in the targeted <italic>m/z</italic> space due to low signal to noise ratio or a high number of conformers or co-drifting compounds, the number of possible ion paths that can be formed becomes large enough that the subsequent MAP becomes computationally expensive. To reduce the computational complexity of the MAP calculation, we introduced <italic>K</italic>-shortest path (<xref rid="btx305-B2" ref-type="bibr">Berclaz <italic>et al.</italic> 2011</xref>) to select the <italic>K</italic> most likely ion paths across the different electric fields. First, we defined an ion transition graph <italic>G</italic> as a weighted and directed graph, where the vertices are the set of all the peaks observed in the targeted <italic>m/z</italic> window: <italic>X</italic>â=â{<italic>x</italic><sub>1</sub>, <italic>x</italic><sub>2</sub>, <italic>x</italic><sub>3</sub>â¦ <italic>x<sub>i</sub></italic>â¦ <italic>x<sub>n</sub></italic>} in all electric fields. Edges are then inserted for every peak in a given electric field to all peaks in the adjacent electric fields (<xref ref-type="fig" rid="btx305-F1">Fig. 1c</xref>). Next, the weight of an edge is defined as the negative log of the matching score, <italic>P</italic><sub>match</sub>(<italic>x<sub>i</sub></italic>, <italic>x<sub>i</sub></italic><sub>+1</sub>), which corresponds to the diffusion profile matching the probability of a pair of peaks in adjacent electric fields (<xref ref-type="disp-formula" rid="E4">Equation 4</xref>). In addition, two non-peak vertices are added to the graph as the source and sink. A hypothetical ion path <italic>T<sub>k</sub></italic> is thus defined as a path in <italic>G</italic> from the source to the sink (<xref ref-type="fig" rid="btx305-F1">Fig. 1b</xref>). Notably, the shorter an ion path, the more consistent are the peaks associated with the path in terms of diffusion profiles as shown by <xref ref-type="disp-formula" rid="E5">Equation (5)</xref>. Finding <italic>K</italic> shortest path in the ion transition graph is thus equivalent to finding <italic>T<sub>k</sub></italic> with the most consistent peak diffusion profiles.
<disp-formula id="E4"><label>(4)</label><mml:math id="M4"><mml:mrow><mml:mtext>weight</mml:mtext><mml:mo stretchy="true">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="true">)</mml:mo><mml:mo>=</mml:mo><mml:mo>â</mml:mo><mml:mtext>log</mml:mtext><mml:mo>â</mml:mo><mml:mo>â¡</mml:mo><mml:mo stretchy="true">(</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mtext>match</mml:mtext></mml:msub><mml:mo stretchy="true">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="true">)</mml:mo><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:math></disp-formula><disp-formula id="E5"><label>(5)</label><mml:math id="M5"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mo>|</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mo>=</mml:mo><mml:munderover><mml:mo>â</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>â</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:mrow><mml:mtext>weight</mml:mtext><mml:mo stretchy="true">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>â</mml:mo><mml:mo>â</mml:mo><mml:mo>=</mml:mo><mml:munderover><mml:mo>â</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>â</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:mrow><mml:mo>â</mml:mo><mml:mtext>log</mml:mtext><mml:mo>â</mml:mo><mml:mo>â¡</mml:mo><mml:mo stretchy="true">(</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mtext>match</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="true">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="true">)</mml:mo><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>â</mml:mo><mml:mo>â</mml:mo><mml:mo>=</mml:mo><mml:mo>â</mml:mo><mml:mtext>log</mml:mtext><mml:mo>â</mml:mo><mml:mo>â¡</mml:mo><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:munderover><mml:mo>â</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>â</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>match</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="true">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>â</mml:mo><mml:mo>â</mml:mo><mml:mo>=</mml:mo><mml:mo>â</mml:mo><mml:mtext>log</mml:mtext><mml:mo>â</mml:mo><mml:mo>â¡</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mtext>diffusion</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="true">(</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="true">)</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula>
We solve the <italic>K</italic>-shortest paths problem from <italic>G</italic> using the HoffmanâPavley algorithm (<xref rid="btx305-B10" ref-type="bibr">Hoffman and Pavley 1959</xref>) to acquire the <italic>K</italic> most likely hypothetical ion paths. Subject to the computing resources available, the number <italic>K</italic> can range from hundreds to thousands if the association result does not converge. <italic>T<sub>k</sub></italic> would then be combined to form the association hypotheses for the data. The next step is to then use the MAP approach and determine the optimal association of peaks across electric fields.</p>
      </sec>
      <sec>
        <title>2.4.2 <italic>A posteriori</italic> probability of association hypothesis</title>
        <p>After <italic>K</italic>-shortest path reduces the hypothesis space, the next step is to define and compare the <italic>a posteriori</italic> probability of different association hypotheses. If <italic>X</italic> continues to be the set of all peaks observed in the targeted <italic>m/z</italic> window <italic>X</italic>â=â{<italic>x</italic><sub>1</sub>, <italic>x</italic><sub>2</sub>, <italic>x</italic><sub>3</sub>â¦<italic>x<sub>i</sub></italic>â¦<italic>x<sub>n</sub></italic>} in all electric fields, and <italic>T</italic> is the association hypothesis represented by <italic>T</italic>â=â{<italic>T<sub>k</sub></italic>}, where <italic>T<sub>k</sub></italic> â© <italic>T<sub>l</sub></italic>â=âÃ, then the optimal association hypothesis is one that maximizes its probability given the peaks observed.
<disp-formula id="E6"><label>(6)</label><graphic xlink:href="btx305m6.jpg" position="float" orientation="portrait"/></disp-formula>
According to <xref ref-type="disp-formula" rid="E6">Equation (6)</xref>, the association hypothesis with the highest <italic>a posteriori</italic> probability, <italic>P</italic>(<italic>T<sub>k</sub></italic>) and <italic>P</italic>(<italic>x<sub>i</sub></italic> | <italic>T</italic>), needs to be modeled as a function of individual peak profiles, relationships of peaks to ion paths, and the probability of a peak to not reject the association hypothesis. We then model the probability of ion path <italic>P</italic>(<italic>T<sub>k</sub></italic>) based on Assumptions 2 and 3: where the ion path <italic>T<sub>k</sub></italic> is more likely to be real if (1) the peak responses share similar diffusion profiles and (2) the arrival time and electric field pairs of the peak comply with the kinetic theory described in <xref ref-type="disp-formula" rid="E1">Equation (1)</xref>. <italic>P</italic>(<italic>T<sub>k</sub></italic>) is thus defined in <xref ref-type="supplementary-material" rid="sup1">Supplementary Equation 2</xref> (<xref ref-type="supplementary-material" rid="sup2">Supplementary Material S1</xref>) as the weighted geometric mean of the correlation of determination value of the least squares fit line (<italic>R</italic><sup>2</sup>) and the diffusion profile matching the probability for all the observations of an ion (including conformers), which is the <italic>P</italic><sub>diffusion</sub> used in the <italic>K</italic> shortest path ion tracking step (<xref ref-type="disp-formula" rid="E5">Equation 5</xref>). For <italic>Pr</italic>(<italic>x<sub>i</sub></italic> | <italic>T</italic>) we implemented a simplified likelihood model as shown in <xref ref-type="supplementary-material" rid="sup1">Supplementary Equation 3</xref> (<xref ref-type="supplementary-material" rid="sup2">Supplementary Material S1</xref>). If the peak <italic>x<sub>i</sub></italic> is on one of the paths <italic>T<sub>k</sub></italic>, we evaluate the arrival time error between the observed peak and what the path <italic>T<sub>k</sub></italic> predicts. The error corresponds to the degree to which the peak is rejecting hypothetical ion path <italic>T<sub>k</sub></italic> as a valid ion path. When the peak <italic>x<sub>i</sub></italic> is not on the ion path <italic>T<sub>k</sub></italic>, <italic>Pr</italic>(<italic>x<sub>i</sub></italic> | <italic>T</italic>) is evaluated as Î´ or the probability of a peak being an artifact or interference within the target <italic>m/z</italic>, which is a constant that can be tuned based on the noise level of the data.</p>
      </sec>
      <sec>
        <title>2.4.3 Diffusion profile matching</title>
        <p>Both the weight calculation of the ion transition graph and computing <italic>Pr</italic>(<italic>T<sub>k</sub></italic>) requires computation of the matching probability of base peak diffusion profiles of two peaks measured at different electric fields. We characterize the distance between diffusion profiles of two ions with the following parameters: <italic>Îmzc</italic>, <italic>Îmzw</italic>, <italic>Îmzl</italic>, <italic>Îdtc</italic>, <italic>Îdtw</italic>, <italic>Îdtl</italic>, which correspond to the differences in <italic>m/z</italic> at peak apex, <italic>m/z</italic> full width at half maximum, percentage of peak intensities on the lower <italic>m/z</italic> side of the peak apex, ATD value at peak apex, ATD full width at half maximum and percentage of peak intensities before the peak apex. By calculating the geometric mean of these six parameters weighted according to their impact on the diffusion profile matching, we can obtain a score that favors peaks sharing similar diffusion profiles. This matching score can then be normalized to 1 to model <italic>P</italic><sub>match</sub>(<italic>x<sub>i</sub></italic><sub>,</sub><italic>x<sub>i</sub></italic><sub>+1</sub>) (<xref ref-type="supplementary-material" rid="sup2">Supplementary Material S1</xref>, <xref ref-type="supplementary-material" rid="sup1">Supplementary Equation 1</xref>).</p>
      </sec>
    </sec>
    <sec>
      <title>2.5 CCS calculation and post-filtering</title>
      <p><italic>t</italic><sub>A</sub> is calculated for all ion paths in the optimized association hypothesis using the least squares fit of <xref ref-type="disp-formula" rid="E1">Equation (1)</xref> to obtain mobility. Mobility can then be converted to CCS using <xref ref-type="disp-formula" rid="E2">Equation (2)</xref>. In addition to the linear simple least squares typically used to calculate ion mobility, PIXiE offers an option to use iteratively reweighted least squares as an alternative with bisquare weight (<xref rid="btx305-B32" ref-type="bibr">Wolke and Schwetlick 1988</xref>) to account for numerical and instrumental errors in determining the apex of ATD (<xref ref-type="supplementary-material" rid="sup2">Supplementary Material S1</xref>, Part 2). Although the isotopic filtering and global data association is able to filter out various kinds of artifacts and identify co-drifting compounds, these steps cannot identify the remaining ions as conformers of the target. The identifications might be clear for a simple sample of known composition (e.g. an authentic chemical standard in solution); however, in the case of data from complex samples (e.g. blood plasma), it is still possible that a co-drifting compound could pass the isotopic filter and global association step for CCS extraction. The next step is to use discretional thresholds on multiple scores generated in various steps of the algorithm, such as the isotopic similarity score, mass error in ppm, or the <italic>a posteriori</italic> probability to further identify any remaining co-drifting chemicals. For example, users can establish thresholds such as a mass measurement error â¤10âppm, or an <italic>a posteriori</italic> probability &gt;0.7. To aid this process, PIXiE generates an analysis database for each batch performed so that users can easily adjust various parameter thresholds for post-filtering through database queries, while viewing the results generated from the optimal association hypothesis.</p>
    </sec>
  </sec>
  <sec>
    <title>3 Results</title>
    <sec>
      <title>3.1 An automated tool for DTIMS CCS calculation</title>
      <p>We developed PIXiE as an open source, C# software toolkit that automatically extracts arrival times and calculates CCS values for target molecules measured across multiple electric fields in DTIMS-MS experiments. PIXiE implements the preprocessing steps and global data association algorithm described in <xref ref-type="fig" rid="btx305-F1">Figure 1</xref>. The primary application for PIXiE is to extract data that can then be independently used in the construction of a reference library containing accurate mass and CCS data for metabolites and other small molecules. To further automate data analysis for an arbitrary amount of targets in a given amount of data, we developed a parallel batch processor function. This allows the user to schedule searches for multiple targets from a set of DTIMS-MS data. The batch processor will run multiple analysis processes, aggregating the results to a single SQLite database consisting of relational tables such as chemical targets, data files, analyses, detected ions and peaks. This database can later be queried directly for quality control, post-processing or visualization purposes. Results after post-processing can then be exported and used to populate an accurate mass and CCS library. Intensive testing of PIXiE on data from DTIMS-MS analyses of 472 small molecules in mixed and standard datasets with seven different IMS electric fields shows that on a windows server with 8-core Intel Xeon X5560 CPU with 2.8âGHz and 25âGB of RAM, PIXiE required 2â5âs to analyze one adduct variant of a target molecule with the maximum <italic>K</italic> in <italic>K</italic>-shortest path set to 3000. The processing time of PIXiE scales linearly with the number of CCS analyses needed.</p>
    </sec>
    <sec>
      <title>3.2 Peak extraction and filtering</title>
      <p>To test the peak extraction and filtering, we manually inspected analyses of 12 standards in positive and negative ionization modes. In addition to listing their optimal association hypotheses in <xref ref-type="supplementary-material" rid="sup2">Supplementary Material S2</xref>, we here walk through an analysis record from <sc>d</sc>-tryptophan (PubChem CID 9060) as an example (<xref rid="btx305-T1" ref-type="table">Table 1</xref>). The empirical formula of the target molecule, C<sub>11</sub>H<sub>12</sub>N<sub>2</sub>O<sub>2</sub>, was set in PIXiE to form the corresponding sodiated, protonated and deprotonated adduct ions. Taking the protonated <sc>d</sc>-tryptophan ion analysis as an example, the accurate mass of the corresponding target <italic>m/z</italic> is 205.0977. PIXiE first grouped the DTIMS-MS data frames into seven electric fields. After averaging the IMS data within the initial <italic>m/z</italic> window of 205.0977Â Â±Â 15âppm, the peak detector found 1, 1, 1, 1, 1, 2 and 2 peaks in electric fields 1 through 7, respectively. Next, the global data association step was applied and the optimal association hypothesis consisted of a single ion. The PIXiE result from peak filtering and peak extraction matches visual inspection of the raw data (<xref ref-type="fig" rid="btx305-F2">Fig. 2</xref>). Such peak extraction and filtering information is logged for each optimal association hypothesis to ensure the provenance of PIXiE CCS calculations. In addition, each CCS extracted by PIXiE can be traced to the optimal association hypothesis used and is visualized graphically, as shown in <xref ref-type="fig" rid="btx305-F2">Figure 2b</xref>. The optimal association hypothesis plot shows all observed peaks as scatter points according to their arrival time, the value of <italic>p</italic>/(<italic>TV</italic>), and peak intensity.
<table-wrap id="btx305-T1" orientation="portrait" position="float"><label>Table 1.</label><caption><p>Peak statistics averaged across electric fields for the protonated form of <sc>d</sc>-tryptophan and the filter thresholds used in preprocessing</p></caption><table frame="hsides" rules="groups"><colgroup span="1"><col valign="top" align="left" span="1"/><col valign="top" align="center" span="1"/><col valign="top" align="char" char="." span="1"/></colgroup><thead><tr><th rowspan="2" colspan="1">Criteria</th><th colspan="2" rowspan="1">Value<hr/></th></tr><tr><th rowspan="1" colspan="1">Threshold</th><th rowspan="1" colspan="1">Measured</th></tr></thead><tbody><tr><td rowspan="1" colspan="1"/><td colspan="2" rowspan="1">Target detection 1<hr/></td></tr><tr><td rowspan="1" colspan="1"/><td colspan="2" rowspan="1"><hr/></td></tr><tr><td rowspan="1" colspan="1">Intensity score</td><td rowspan="1" colspan="1">â</td><td rowspan="1" colspan="1">0.9189</td></tr><tr><td rowspan="1" colspan="1">Peak shape score</td><td rowspan="1" colspan="1">&gt;0.4</td><td rowspan="1" colspan="1">0.9037</td></tr><tr><td rowspan="1" colspan="1">Isotopic distribution score</td><td rowspan="1" colspan="1">&gt;0.4</td><td rowspan="1" colspan="1">0.8125</td></tr><tr><td rowspan="1" colspan="1">Mass error</td><td rowspan="1" colspan="1">&lt;15âppm</td><td rowspan="1" colspan="1">1.8âppm</td></tr><tr><td rowspan="1" colspan="1"><italic>T</italic><sub>0</sub></td><td rowspan="1" colspan="1">â</td><td rowspan="1" colspan="1">4.45âms</td></tr><tr><td rowspan="1" colspan="1"><italic>R</italic><sup>2</sup></td><td rowspan="1" colspan="1">0.96</td><td rowspan="1" colspan="1">0.9999</td></tr><tr><td rowspan="1" colspan="1">Mobility (cm<sup>2</sup>/(s*V))</td><td rowspan="1" colspan="1">â</td><td rowspan="1" colspan="1">1.3930</td></tr><tr><td rowspan="1" colspan="1">Cross section (Ã<sup>2</sup>)</td><td rowspan="1" colspan="1">â</td><td rowspan="1" colspan="1">154.4439</td></tr></tbody></table></table-wrap></p>
      <fig id="btx305-F2" orientation="portrait" position="float">
        <label>Fig. 2.</label>
        <caption>
          <p>(<bold>a</bold>) Protonated <sc>d</sc>-tryptophan data at <italic>m/z</italic> 205.0977âDa. As seen in the raw data, as the DTIMS electric field decreases the arrival time of the ions increases. <bold>(b)</bold> Ions were tracked by PIXIE using global data association. The optimal association hypothesis consisted of a single ion path. This association hypothesis had an <italic>a posteriori</italic> probability higher than all other association hypotheses and was thus chosen to explain the observed peaks. Other peaks failed to meet the criteria for identification of the target ion and were thus registered as artifacts. Based on the optimal association hypothesis, a single conformer was reported for the target <italic>m/z</italic> with a CCS value of 154.44Â Ã<sup>2</sup></p>
        </caption>
        <graphic xlink:href="btx305f2"/>
      </fig>
    </sec>
    <sec>
      <title>3.3 Validation of PIXiE extracted CCSs</title>
      <p>To verify the accuracy of PIXiE extracted CCSs, we performed a side by side comparison of PIXiE results with those calculated by Agilentâs IM-MS Browser for 12 common metabolites which form 25 total ionic species. The results in <xref rid="btx305-T2" ref-type="table">Table 2</xref> show that PIXiE-determined CCSs are nearly identical with those calculated by Agilent IM-MS Browser. Slight discrepancies in CCS between the two programs were due to the fact that PIXiE uses the set of points that optimizes the <italic>a posteriori</italic> probability score of an ion path, while Agilent IM-MS Browser uses all available points. This choice in heuristics for PIXiE ensures that specious features are not incorporated in the CCS calculation and preserves confidence in a low false discovery rate during automated batch processing.
<table-wrap id="btx305-T2" orientation="portrait" position="float"><label>Table 2.</label><caption><p>Comparison of PIXiE and Agilent IM-MS browser determined CCSs for 12 metabolites</p></caption><table frame="hsides" rules="groups"><colgroup span="1"><col valign="top" align="left" span="1"/><col valign="top" align="center" span="1"/><col valign="top" align="char" char="." span="1"/><col valign="top" align="char" char="." span="1"/><col valign="top" align="char" char="." span="1"/></colgroup><thead><tr><th rowspan="1" colspan="1">Metabolite</th><th rowspan="1" colspan="1">Adduct</th><th rowspan="1" colspan="1">PIXiE CCS (Ã<sup>2</sup>)</th><th rowspan="1" colspan="1">IM-MS browser CCS (Ã<sup>2</sup>)</th><th rowspan="1" colspan="1">Difference between programs (%)</th></tr></thead><tbody><tr><td rowspan="1" colspan="1">(â)-Epinephrine</td><td rowspan="1" colspan="1">[MâH]</td><td rowspan="1" colspan="1">142.4496</td><td rowspan="1" colspan="1">144.0134</td><td rowspan="1" colspan="1">1.09</td></tr><tr><td rowspan="1" colspan="1">Adenosine</td><td rowspan="1" colspan="1">[M+H] (1)</td><td rowspan="1" colspan="1">155.555</td><td rowspan="1" colspan="1">156.2909</td><td rowspan="1" colspan="1">0.47</td></tr><tr><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1">[M+H] (2)</td><td rowspan="1" colspan="1">168.2187</td><td rowspan="1" colspan="1">166.1145</td><td rowspan="1" colspan="1">1.27</td></tr><tr><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1">[M+Na]</td><td rowspan="1" colspan="1">170.7047</td><td rowspan="1" colspan="1">170.9785</td><td rowspan="1" colspan="1">0.16</td></tr><tr><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1">[MâH]</td><td rowspan="1" colspan="1">166.5123</td><td rowspan="1" colspan="1">168.3901</td><td rowspan="1" colspan="1">1.12</td></tr><tr><td rowspan="1" colspan="1">Choline</td><td rowspan="1" colspan="1">[M+]</td><td rowspan="1" colspan="1">117.4588</td><td rowspan="1" colspan="1">118.2236</td><td rowspan="1" colspan="1">0.65</td></tr><tr><td rowspan="1" colspan="1">Cytidine</td><td rowspan="1" colspan="1">[M+H]</td><td rowspan="1" colspan="1">153.8407</td><td rowspan="1" colspan="1">154.2226</td><td rowspan="1" colspan="1">0.25</td></tr><tr><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1">[M+Na]</td><td rowspan="1" colspan="1">162.347</td><td rowspan="1" colspan="1">162.6927</td><td rowspan="1" colspan="1">0.21</td></tr><tr><td rowspan="1" colspan="1">D-Fructose-1,6-BP</td><td rowspan="1" colspan="1">[MâH]</td><td rowspan="1" colspan="1">156.4098</td><td rowspan="1" colspan="1">155.8715</td><td rowspan="1" colspan="1">0.35</td></tr><tr><td rowspan="1" colspan="1">D-Glucosamine 6-P</td><td rowspan="1" colspan="1">[M+H]</td><td rowspan="1" colspan="1">154.2323</td><td rowspan="1" colspan="1">155.2702</td><td rowspan="1" colspan="1">0.67</td></tr><tr><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1">[M+Na]</td><td rowspan="1" colspan="1">162.9773</td><td rowspan="1" colspan="1">161.5521</td><td rowspan="1" colspan="1">0.88</td></tr><tr><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1">[MâH]</td><td rowspan="1" colspan="1">150.5087</td><td rowspan="1" colspan="1">150.481</td><td rowspan="1" colspan="1">0.02</td></tr><tr><td rowspan="1" colspan="1">D-Tryptophan</td><td rowspan="1" colspan="1">[M+H]</td><td rowspan="1" colspan="1">154.4439</td><td rowspan="1" colspan="1">153.8472</td><td rowspan="1" colspan="1">0.39</td></tr><tr><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1">[M+Na]</td><td rowspan="1" colspan="1">149.2501</td><td rowspan="1" colspan="1">150.1552</td><td rowspan="1" colspan="1">0.60</td></tr><tr><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1">[MâH]</td><td rowspan="1" colspan="1">155.872</td><td rowspan="1" colspan="1">156.5406</td><td rowspan="1" colspan="1">0.43</td></tr><tr><td rowspan="1" colspan="1">Folic acid</td><td rowspan="1" colspan="1">[M+H]</td><td rowspan="1" colspan="1">195.2117</td><td rowspan="1" colspan="1">195.2644</td><td rowspan="1" colspan="1">0.03</td></tr><tr><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1">[M+Na]</td><td rowspan="1" colspan="1">203.1976</td><td rowspan="1" colspan="1">204.6301</td><td rowspan="1" colspan="1">0.70</td></tr><tr><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1">[MâH]</td><td rowspan="1" colspan="1">194.6636</td><td rowspan="1" colspan="1">194.4258</td><td rowspan="1" colspan="1">0.12</td></tr><tr><td rowspan="1" colspan="1">NAD</td><td rowspan="1" colspan="1">[M+H]</td><td rowspan="1" colspan="1">227.936</td><td rowspan="1" colspan="1">226.236</td><td rowspan="1" colspan="1">0.75</td></tr><tr><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1">[M+Na]</td><td rowspan="1" colspan="1">223.3434</td><td rowspan="1" colspan="1">223.4154</td><td rowspan="1" colspan="1">0.03</td></tr><tr><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1">[MâH]</td><td rowspan="1" colspan="1">227.1015</td><td rowspan="1" colspan="1">227.8383</td><td rowspan="1" colspan="1">0.32</td></tr><tr><td rowspan="1" colspan="1">Sucrose</td><td rowspan="1" colspan="1">[M+Na]</td><td rowspan="1" colspan="1">174.6098</td><td rowspan="1" colspan="1">174.2231</td><td rowspan="1" colspan="1">0.22</td></tr><tr><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1">[MâH]</td><td rowspan="1" colspan="1">170.1421</td><td rowspan="1" colspan="1">169.641</td><td rowspan="1" colspan="1">0.30</td></tr><tr><td rowspan="1" colspan="1">Taurine</td><td rowspan="1" colspan="1">[M+H]</td><td rowspan="1" colspan="1">139.7391</td><td rowspan="1" colspan="1">140.4202</td><td rowspan="1" colspan="1">0.49</td></tr><tr><td rowspan="1" colspan="1">UDP-Galactose</td><td rowspan="1" colspan="1">[MâH]</td><td rowspan="1" colspan="1">210.8353</td><td rowspan="1" colspan="1">211.6699</td><td rowspan="1" colspan="1">0.39</td></tr></tbody></table></table-wrap></p>
    </sec>
    <sec>
      <title>3.4 Algorithm robustness</title>
      <p>To evaluate how robust PIXiE was for determining optimal association hypotheses, we tested the algorithm on datasets containing multiple conformers. We also observed cases where the small molecules would form non-covalent dimers and break into monomers prior to detection, so these were also evaluated. For these molecules, multiple peaks were observed several times for a target (<xref ref-type="supplementary-material" rid="sup2">Supplementary Material S2</xref>). However, in the analyses of authentic reference materials we have yet to encounter a case where the sample complexity at a single mass range was too complex for PIXiE to determine a reasonable optimal association hypothesis. There are times though that PIXiE ignores certain high-leverage peaks from the optimal association hypothesis as these peaks can sometimes reduce the <italic>a posterior</italic> probability of the association hypothesis. This behavior can be seen in <xref ref-type="supplementary-material" rid="sup2">Supplementary Material S2</xref> for NAD [M+H], taurine [M+H], adenosine [M+Na] and others.</p>
    </sec>
    <sec>
      <title>3.5 Limitations</title>
      <p>Although PIXiE can reliably locate ions in the data that match the mass and isotopic pattern specified by the target, it does not offer absolute identification nor can PIXiE draw a line between conformers and dimers. For the use of library construction purposes, sample purity should be high to ensure corresponding high confidence in the determined CCS value. Extraction of data for library building is best conducted using conservative parameters (e.g. low mass error threshold, high isotopic score threshold, etc.) to limit the probability of incorrect association of peaks with target molecules.</p>
    </sec>
  </sec>
  <sec>
    <title>4 Conclusion</title>
    <p>The use of CCS as a metric for confident identification of metabolites and other small molecules in metabolomics studies has high potential. However, the difficulty of implementing automated data analysis has limited the throughput of multi-electric field DTIMS-MS CCS extraction. To address these challenges, we have developed PIXiE for reliably extracting CCSs from multi-electric field DTIMS-MS data. Using the global data association algorithm, PIXiE was able to track targets in the presence of co-drifting ions representing conformers or chemical noise. The optimal association hypothesis distills ions from the collected DTIMS-MS data having <italic>m/z</italic> consistent with the target molecule, isotopic profiles similar to the expected isotopic profile of the target, and peak responses across electric fields that comply with ion kinetic theory (<xref rid="btx305-B16" ref-type="bibr">Mason and McDaniel 1988</xref>). Most importantly, CCS values can easily be calculated for each ion distilled based on the arrival times at the different electric fields. Arrival times can then be documented using the measured arrival time and subtracting the time an ion spends outside the drift tube, which is independently evaluated in the least squares step. For applications where multi-electric field DTIMS-MS measurements are performed, PIXiE increases the throughput of CCS determination.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>This research was supported by the Laboratory Directed Research and Development (LDRD) program at the Pacific Northwest National Laboratory (PNNL) and is a contribution of the Global Forensic Chemical Exposure Assessment for the Environmental Exposome project and the Microbiomes in Transition Initiative. The work was also supported by the National Institute of Environmental Health Sciences of the National Institutes of Health [R01 ES022190]. Portions of this research utilized capabilities developed with support from the Department of Energy Office of Biological and Environmental Research Genomic Science Program under the PNNL Pan-omics Program. DTIMS-MS analyses were performed in the Environmental Molecular Sciences Laboratory, a national scientific user facility sponsored by the U.S. Department of Energy (DOE) Office of Biological and Environmental Research and located at PNNL. PNNL is a multi-program national laboratory operated by Battelle for the DOE under Contract DE-AC05-76RLO 1830.</p>
    <p><italic>Conflict of Interest</italic>: none declared.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="sup1">
      <label>Supplementary Data</label>
      <media xlink:href="btx305_supplementary_pixie-s1-methods_bioinformatics_revised.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="sup2">
      <label>Supplementary Data</label>
      <media xlink:href="btx305_supplementary_pixie-s2-association_bioinformatics_revised.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ref-list>
    <title>References</title>
    <ref id="btx305-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Allison</surname><given-names>T.M.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>Quantifying the stabilizing effects of protein-ligand interactions in the gas phase</article-title>. <source>Nat. Commun</source>., <volume>6</volume>, <fpage>8551.</fpage><pub-id pub-id-type="pmid">26440106</pub-id></mixed-citation>
    </ref>
    <ref id="btx305-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Berclaz</surname><given-names>J.</given-names></name></person-group><etal>et al</etal> (<year>2011</year>) 
<article-title>Multiple object tracking using K-shortest paths optimization</article-title>. <source>IEEE Trans. Pattern Anal. Mach. Intell</source>., <volume>33</volume>, <fpage>1806</fpage>â<lpage>1819</lpage>.<pub-id pub-id-type="pmid">21282851</pub-id></mixed-citation>
    </ref>
    <ref id="btx305-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Castle</surname><given-names>A.L.</given-names></name></person-group><etal>et al</etal> (<year>2006</year>) 
<article-title>Metabolomics standards workshop and the development of international standards for reporting metabolomics experimental results</article-title>. <source>Brief. Bioinform</source>., <volume>7</volume>, <fpage>159</fpage>â<lpage>165</lpage>.<pub-id pub-id-type="pmid">16772263</pub-id></mixed-citation>
    </ref>
    <ref id="btx305-B4">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name name-style="western"><surname>Council</surname><given-names>N.R.</given-names></name></person-group> (<year>2012</year>) <source>Exposure Science in the 21st Century: A Vision and a Strategy</source>. 
<publisher-name>The National Academies Press</publisher-name>, 
<publisher-loc>Washington, DC</publisher-loc>.</mixed-citation>
    </ref>
    <ref id="btx305-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Crowell</surname><given-names>K.L.</given-names></name></person-group><etal>et al</etal> (<year>2013</year>) 
<article-title>LC-IMS-MS Feature Finder: detecting multidimensional liquid chromatography, ion mobility and mass spectrometry features in complex datasets</article-title>. <source>Bioinformatics</source>, <volume>29</volume>, <fpage>2804</fpage>â<lpage>2805</lpage>.<pub-id pub-id-type="pmid">24008421</pub-id></mixed-citation>
    </ref>
    <ref id="btx305-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Eschweiler</surname><given-names>J.D.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>CIUSuite: a quantitative analysis package for collision induced unfolding measurements of gas-phase protein ions</article-title>. <source>Anal. Chem</source>., <volume>87</volume>, <fpage>11516</fpage>â<lpage>11522</lpage>.<pub-id pub-id-type="pmid">26489593</pub-id></mixed-citation>
    </ref>
    <ref id="btx305-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Gerlich</surname><given-names>M.</given-names></name>, <name name-style="western"><surname>Neumann</surname><given-names>S.</given-names></name></person-group> (<year>2013</year>) 
<article-title>MetFusion: integration of compound identification strategies</article-title>. <source>J. Mass Spectrom</source>., <volume>48</volume>, <fpage>291</fpage>â<lpage>298</lpage>.<pub-id pub-id-type="pmid">23494783</pub-id></mixed-citation>
    </ref>
    <ref id="btx305-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Ghavidel</surname><given-names>F.Z.</given-names></name></person-group><etal>et al</etal> (<year>2014</year>) 
<article-title>The use of the isotopic distribution as a complementary quality metric to assess tandem mass spectra results</article-title>. <source>J. Proteomics</source>, <volume>98</volume>, <fpage>150</fpage>â<lpage>158</lpage>.<pub-id pub-id-type="pmid">24384257</pub-id></mixed-citation>
    </ref>
    <ref id="btx305-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Guevremont</surname><given-names>R.</given-names></name></person-group><etal>et al</etal> (<year>1997</year>) 
<article-title>Combined ion mobility/time-of-flight mass spectrometry study of electrospray-generated ions</article-title>. <source>Anal. Chem</source>., <volume>69</volume>, <fpage>3959</fpage>â<lpage>3965</lpage>.<pub-id pub-id-type="pmid">21639212</pub-id></mixed-citation>
    </ref>
    <ref id="btx305-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Hoffman</surname><given-names>W.</given-names></name>, <name name-style="western"><surname>Pavley</surname><given-names>R.</given-names></name></person-group> (<year>1959</year>) 
<article-title>A method for the solution of the Nth best path problem</article-title>. <source>J. ACM (JACM)</source>, <volume>6</volume>, <fpage>506</fpage>â<lpage>514</lpage>.</mixed-citation>
    </ref>
    <ref id="btx305-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Jaitly</surname><given-names>N.</given-names></name></person-group><etal>et al</etal> (<year>2009</year>) 
<article-title>Decon2LS: an open-source software package for automated processing and visualization of high resolution mass spectrometry</article-title>. <source>BMC Bioinformatics</source>, <volume>10</volume>, <fpage>87.</fpage><pub-id pub-id-type="pmid">19292916</pub-id></mixed-citation>
    </ref>
    <ref id="btx305-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Jarque</surname><given-names>B.A.</given-names></name></person-group> (<year>1981</year>) 
<article-title>Efficient tests for normality, heteroskedasticity and serial independence of regression residuals: Monte Carlo evidence</article-title>. <source>Econ. Lett</source>., <volume>7</volume>, <fpage>313</fpage>â<lpage>318</lpage>.</mixed-citation>
    </ref>
    <ref id="btx305-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Kind</surname><given-names>T.</given-names></name></person-group><etal>et al</etal> (<year>2013</year>) 
<article-title>LipidBlast in silico tandem mass spectrometry database for lipid identification</article-title>. <source>Nat. Methods</source>, <volume>10</volume>, <fpage>755</fpage>â<lpage>758</lpage>.<pub-id pub-id-type="pmid">23817071</pub-id></mixed-citation>
    </ref>
    <ref id="btx305-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>LaMarche</surname><given-names>B.L.</given-names></name></person-group><etal>et al</etal> (<year>2013</year>) 
<article-title>MultiAlign: a multiple LC-MS analysis tool for targeted omics analysis</article-title>. <source>BMC Bioinformatics</source>, <volume>14</volume>, <fpage>49.</fpage><pub-id pub-id-type="pmid">23398735</pub-id></mixed-citation>
    </ref>
    <ref id="btx305-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Lapthorn</surname><given-names>C.</given-names></name></person-group><etal>et al</etal> (<year>2013</year>) 
<article-title>Ion mobility spectrometry-mass spectrometry (IMS-MS) of small molecules: separating and assigning structures to ions</article-title>. <source>Mass Spectrom. Rev</source>., <volume>32</volume>, <fpage>43</fpage>â<lpage>71</lpage>.<pub-id pub-id-type="pmid">22941854</pub-id></mixed-citation>
    </ref>
    <ref id="btx305-B16">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name name-style="western"><surname>Mason</surname><given-names>E.A.</given-names></name>, <name name-style="western"><surname>McDaniel</surname><given-names>E.W.</given-names></name></person-group> (<year>1988</year>) <source>Transport Properties of Ions in Gases</source>. 
<publisher-name>Wiley</publisher-name>, 
<publisher-loc>New York</publisher-loc>.</mixed-citation>
    </ref>
    <ref id="btx305-B17">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name name-style="western"><surname>Mason</surname><given-names>E.A.</given-names></name></person-group><etal>et al</etal> (<year>1958</year>) <source>Mobility of Gaseous Ions in Weak Electric Fields</source>. 
<publisher-name>United States Air Force, Office of Scientific Research</publisher-name>.</mixed-citation>
    </ref>
    <ref id="btx305-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Metz</surname><given-names>T.O.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>Integrating ion mobility spectrometry into mass spectrometry-based exposome measurements: what can it add and how far can it go?</article-title><source>Bioanalysis</source>, <volume>9</volume>, <fpage>81</fpage>â<lpage>98</lpage>.</mixed-citation>
    </ref>
    <ref id="btx305-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Nicholson</surname><given-names>J.K.</given-names></name></person-group><etal>et al</etal> (<year>1999</year>) â
<article-title>Metabonomicsâ: understanding the metabolic responses of living systems to pathophysiological stimuli via multivariate statistical analysis of biological NMR spectroscopic data</article-title>. <source>Xenobiotica</source>, <volume>29</volume>, <fpage>1181</fpage>â<lpage>1189</lpage>.<pub-id pub-id-type="pmid">10598751</pub-id></mixed-citation>
    </ref>
    <ref id="btx305-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Pauling</surname><given-names>L.</given-names></name></person-group><etal>et al</etal> (<year>1971</year>) 
<article-title>Quantitative analysis of urine vapor and breath by gas-liquid partition chromatography</article-title>. <source>Proc. Natl Acad. Sci. U. S. A</source>., <volume>68</volume>, <fpage>2374</fpage>â<lpage>2376</lpage>.<pub-id pub-id-type="pmid">5289873</pub-id></mixed-citation>
    </ref>
    <ref id="btx305-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Pluskal</surname><given-names>T.</given-names></name></person-group><etal>et al</etal> (<year>2010</year>) 
<article-title>MZmine 2: modular framework for processing, visualizing, and analyzing mass spectrometry-based molecular profile data</article-title>. <source>BMC Bioinformatics</source>, <volume>11</volume>, <fpage>395.</fpage><pub-id pub-id-type="pmid">20650010</pub-id></mixed-citation>
    </ref>
    <ref id="btx305-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Polpitiya</surname><given-names>A.D.</given-names></name></person-group><etal>et al</etal> (<year>2008</year>) 
<article-title>DAnTE: a statistical tool for quantitative analysis of -omics data</article-title>. <source>Bioinformatics</source>, <volume>24</volume>, <fpage>1556</fpage>â<lpage>1558</lpage>.<pub-id pub-id-type="pmid">18453552</pub-id></mixed-citation>
    </ref>
    <ref id="btx305-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Robinson</surname><given-names>A.B.</given-names></name></person-group><etal>et al</etal> (<year>1973</year>) 
<article-title>An apparatus for the quantitative analysis of volatile compounds in urine</article-title>. <source>J. Chromatogr</source>., <volume>85</volume>, <fpage>19</fpage>â<lpage>29</lpage>.<pub-id pub-id-type="pmid">4754402</pub-id></mixed-citation>
    </ref>
    <ref id="btx305-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Robinson</surname><given-names>A.B.</given-names></name></person-group><etal>et al</etal> (<year>1974</year>) 
<article-title>Multiple sclerosis: urinary amine measurement for orthomolecular diagnosis</article-title>. <source>Life Sci</source>., <volume>14</volume>, <fpage>1747</fpage>â<lpage>1753</lpage>.<pub-id pub-id-type="pmid">4407498</pub-id></mixed-citation>
    </ref>
    <ref id="btx305-B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Shah</surname><given-names>A.R.</given-names></name></person-group><etal>et al</etal> (<year>2010</year>) 
<article-title>An efficient data format for mass spectrometry-based proteomics</article-title>. <source>J. Am. Soc. Mass Spectrom</source>., <volume>21</volume>, <fpage>1784</fpage>â<lpage>1788</lpage>.<pub-id pub-id-type="pmid">20674389</pub-id></mixed-citation>
    </ref>
    <ref id="btx305-B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Siems</surname><given-names>W.F.</given-names></name></person-group><etal>et al</etal> (<year>1994</year>) 
<article-title>Measuring the resolving power of ion mobility spectrometers</article-title>. <source>Anal. Chem</source>., <volume>66</volume>, <fpage>4195</fpage>â<lpage>4201</lpage>.</mixed-citation>
    </ref>
    <ref id="btx305-B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Smith</surname><given-names>C.A.</given-names></name></person-group><etal>et al</etal> (<year>2006</year>) 
<article-title>XCMS: processing mass spectrometry data for metabolite profiling using nonlinear peak alignment, matching, and identification</article-title>. <source>Anal. Chem</source>., <volume>78</volume>, <fpage>779</fpage>â<lpage>787</lpage>.<pub-id pub-id-type="pmid">16448051</pub-id></mixed-citation>
    </ref>
    <ref id="btx305-B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Soltow</surname><given-names>Q.A.</given-names></name></person-group><etal>et al</etal> (<year>2011</year>) 
<article-title>High-performance metabolic profiling with dual chromatography-Fourier-transform mass spectrometry (DC-FTMS) for study of the exposome</article-title>. <source>Metabolomics</source>, <volume>9</volume>, <fpage>132</fpage>â<lpage>143</lpage>.</mixed-citation>
    </ref>
    <ref id="btx305-B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Steiner</surname><given-names>W.E.</given-names></name></person-group><etal>et al</etal> (<year>2001</year>) 
<article-title>Electrospray ionization with ambient pressure ion mobility separation and mass analysis by orthogonal time-of-flight mass spectrometry</article-title>. <source>Rapid Commun. Mass Spectrom</source>., <volume>15</volume>, <fpage>2221</fpage>â<lpage>2226</lpage>.<pub-id pub-id-type="pmid">11746889</pub-id></mixed-citation>
    </ref>
    <ref id="btx305-B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Sumner</surname><given-names>L.W.</given-names></name></person-group><etal>et al</etal> (<year>2007</year>) 
<article-title>Proposed minimum reporting standards for chemical analysis Chemical Analysis Working Group (CAWG) Metabolomics Standards Initiative (MSI)</article-title>. <source>Metabolomics</source>, <volume>3</volume>, <fpage>211</fpage>â<lpage>221</lpage>.<pub-id pub-id-type="pmid">24039616</pub-id></mixed-citation>
    </ref>
    <ref id="btx305-B31">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Weljie</surname><given-names>A.M.</given-names></name></person-group><etal>et al</etal> (<year>2006</year>) 
<article-title>Targeted profiling: quantitative analysis of 1H NMR metabolomics data</article-title>. <source>Anal. Chem</source>., <volume>78</volume>, <fpage>4430</fpage>â<lpage>4442</lpage>.<pub-id pub-id-type="pmid">16808451</pub-id></mixed-citation>
    </ref>
    <ref id="btx305-B32">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Wolke</surname><given-names>R.</given-names></name>, <name name-style="western"><surname>Schwetlick</surname><given-names>H.</given-names></name></person-group> (<year>1988</year>) 
<article-title>Iteratively reweighted least squares: algorithms, convergence analysis, and numerical comparisons</article-title>. <source>SIAM J. Sci. Stat. Comput</source>., <volume>9</volume>, <fpage>907</fpage>â<lpage>921</lpage>.</mixed-citation>
    </ref>
    <ref id="btx305-B33">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Xia</surname><given-names>J.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>MetaboAnalyst 3.0-making metabolomics more meaningful</article-title>. <source>Nucleic Acids Res</source>., <volume>43</volume>, <fpage>W251</fpage>â<lpage>W257</lpage>.<pub-id pub-id-type="pmid">25897128</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
