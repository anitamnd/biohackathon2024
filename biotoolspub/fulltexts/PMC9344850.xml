<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">9344850</article-id>
    <article-id pub-id-type="pmid">35748697</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btac413</article-id>
    <article-id pub-id-type="publisher-id">btac413</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Papers</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Genetics and Population Analysis</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>XSI—a genotype compression tool for compressive genomics in large biobanks</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-4114-6615</contrib-id>
        <name>
          <surname>Wertenbroek</surname>
          <given-names>Rick</given-names>
        </name>
        <xref rid="btac413-cor1" ref-type="corresp"/>
        <!--rick.wertenbroek@unil.ch-->
        <aff><institution>School of Management and Engineering Vaud (HEIG-VD), HES-SO University of Applied Sciences and Arts Western Switzerland</institution>, Yverdon-les-Bains 1401, <country country="CH">Switzerland</country></aff>
        <aff><institution>Department of Computational Biology, University of Lausanne</institution>, Lausanne 1015, <country country="CH">Switzerland</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Rubinacci</surname>
          <given-names>Simone</given-names>
        </name>
        <aff><institution>Department of Computational Biology, University of Lausanne</institution>, Lausanne 1015, <country country="CH">Switzerland</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Xenarios</surname>
          <given-names>Ioannis</given-names>
        </name>
        <aff><institution>Department of Computational Biology, University of Lausanne</institution>, Lausanne 1015, <country country="CH">Switzerland</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Thoma</surname>
          <given-names>Yann</given-names>
        </name>
        <aff><institution>School of Management and Engineering Vaud (HEIG-VD), HES-SO University of Applied Sciences and Arts Western Switzerland</institution>, Yverdon-les-Bains 1401, <country country="CH">Switzerland</country></aff>
        <xref rid="btac413-FM1" ref-type="author-notes"/>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Delaneau</surname>
          <given-names>Olivier</given-names>
        </name>
        <xref rid="btac413-cor1" ref-type="corresp"/>
        <!--olivier.delaneau@unil.ch-->
        <aff><institution>Department of Computational Biology, University of Lausanne</institution>, Lausanne 1015, <country country="CH">Switzerland</country></aff>
        <xref rid="btac413-FM1" ref-type="author-notes"/>
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Schwartz</surname>
          <given-names>Russell</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btac413-cor1">To whom correspondence should be addressed. <email>rick.wertenbroek@unil.ch</email> or <email>olivier.delaneau@unil.ch</email></corresp>
      <fn id="btac413-FM1">
        <label>†</label>
        <p>Co-supervised this work.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="collection">
      <day>01</day>
      <month>8</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2022-06-24">
      <day>24</day>
      <month>6</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>24</day>
      <month>6</month>
      <year>2022</year>
    </pub-date>
    <volume>38</volume>
    <issue>15</issue>
    <fpage>3778</fpage>
    <lpage>3784</lpage>
    <history>
      <date date-type="received">
        <day>19</day>
        <month>4</month>
        <year>2022</year>
      </date>
      <date date-type="rev-recd">
        <day>13</day>
        <month>6</month>
        <year>2022</year>
      </date>
      <date date-type="editorial-decision">
        <day>13</day>
        <month>6</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>22</day>
        <month>6</month>
        <year>2022</year>
      </date>
      <date date-type="corrected-typeset">
        <day>01</day>
        <month>7</month>
        <year>2022</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2022. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2022</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btac413.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>Generation of genotype data has been growing exponentially over the last decade. With the large size of recent datasets comes a storage and computational burden with ever increasing costs. To reduce this burden, we propose XSI, a file format with reduced storage footprint that also allows computation on the compressed data and we show how this can improve future analyses.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>We show that xSqueezeIt (XSI) allows for a file size reduction of <inline-formula id="IE1"><mml:math id="IM1" display="inline" overflow="scroll"><mml:mn>4</mml:mn><mml:mo>-</mml:mo><mml:mn>20</mml:mn><mml:mo>×</mml:mo></mml:math></inline-formula> compared with compressed BCF and demonstrate its potential for ‘compressive genomics’ on the UK Biobank whole-genome sequencing genotypes with <inline-formula id="IE2"><mml:math id="IM2" display="inline" overflow="scroll"><mml:mrow><mml:mn>8</mml:mn><mml:mo>×</mml:mo></mml:mrow></mml:math></inline-formula> faster loading times, <inline-formula id="IE3"><mml:math id="IM3" display="inline" overflow="scroll"><mml:mrow><mml:mn>5</mml:mn><mml:mo>×</mml:mo></mml:mrow></mml:math></inline-formula> faster run of homozygozity computation, <inline-formula id="IE4"><mml:math id="IM4" display="inline" overflow="scroll"><mml:mrow><mml:mn>30</mml:mn><mml:mo>×</mml:mo></mml:mrow></mml:math></inline-formula> faster dot products computation and <inline-formula id="IE5"><mml:math id="IM5" display="inline" overflow="scroll"><mml:mrow><mml:mn>280</mml:mn><mml:mo>×</mml:mo></mml:mrow></mml:math></inline-formula> faster allele counts.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>The XSI file format specifications, API and command line tool are released under open-source (MIT) license and are available at <ext-link xlink:href="https://github.com/rwk-unil/xSqueezeIt" ext-link-type="uri">https://github.com/rwk-unil/xSqueezeIt</ext-link></p>
      </sec>
      <sec id="s6">
        <title>Supplementary information</title>
        <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>School of Management and Engineering Vaud (HEIG-VD)</institution>
          </institution-wrap>
        </funding-source>
        <award-id>SNSF-PP00P3_176977</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="7"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Generation of genotype data has been exponentially growing over the last decade. Projects including hundreds of thousands of participants with genotype data coming from SNP arrays, whole-genome or exome sequencing (WGS/WES) at hundreds of millions of genome loci are becoming more common. The use of data from large cohorts has become instrumental for disease research (<xref rid="btac413-B12" ref-type="bibr">Gudmundsson <italic toggle="yes">et al.</italic>, 2021</xref>; <xref rid="btac413-B23" ref-type="bibr">Morris and Cardon, 2019</xref>; <xref rid="btac413-B26" ref-type="bibr">Sudlow <italic toggle="yes">et al.</italic>, 2015</xref>; <xref rid="btac413-B29" ref-type="bibr">Visscher <italic toggle="yes">et al.</italic>, 2017</xref>) and population genetics (<xref rid="btac413-B24" ref-type="bibr">Nait Saada <italic toggle="yes">et al.</italic>, 2020</xref>). Large sample sizes combined with WGS/WES technology allow the analysis of rare variants to detect small effects with higher statistical power, leading to novel discoveries. Large datasets also allow for better haplotype phasing and genotype imputation of new samples, boosting accuracy of downstream analysis methods (<xref rid="btac413-B20" ref-type="bibr">Marchini, 2019</xref>).</p>
    <p>The growth of genotyped cohorts comes with a larger storage footprint as well as increasing loading times. As an example of state-of-the-art WGS datasets, data from the UK Biobank project providing genotypes from WGS contain ∼150 000 samples typed on ∼600 000 000 variants (<xref rid="btac413-B13" ref-type="bibr">Halldorsson <italic toggle="yes">et al.</italic>, 2021</xref>), the TOPMed project contains ∼50 000 samples with ∼400 000 000 variants (<xref rid="btac413-B27" ref-type="bibr">Taliun <italic toggle="yes">et al.</italic>, 2021</xref>) and GnomAD contains ∼76 000 samples with ∼700 000 000 variants (<xref rid="btac413-B14" ref-type="bibr">Karczewski <italic toggle="yes">et al.</italic>, 2020</xref>). The resulting footprints of these datasets are substantial, ∼700 TB of storage for the UK Biobank WGS GATK genotype calls (<xref rid="btac413-B13" ref-type="bibr">Halldorsson <italic toggle="yes">et al.</italic>, 2021</xref>). The data generated from such projects are becoming excessively large and hard to handle.</p>
    <p>The standardly adopted formats for genotype data are the text-based Variant Call Format (VCF), its binary equivalent BCF (<xref rid="btac413-B6" ref-type="bibr">Danecek <italic toggle="yes">et al.</italic>, 2011</xref>) and PLINK (<xref rid="btac413-B3" ref-type="bibr">Chang <italic toggle="yes">et al.</italic>, 2015</xref>). Formats that can all be further compressed with standard compression methods such as gzip. However, these formats are not optimal for population scale WGS genotype data. Several formats have been introduced in recent years to reduce the data size (<xref rid="btac413-B7" ref-type="bibr">Danek and Deorowicz, 2018</xref>; <xref rid="btac413-B9" ref-type="bibr">Deorowicz and Danek, 2019</xref>; <xref rid="btac413-B10" ref-type="bibr">Deorowicz <italic toggle="yes">et al.</italic>, 2013</xref>; <xref rid="btac413-B11" ref-type="bibr">Durbin, 2014</xref>; <xref rid="btac413-B16" ref-type="bibr">Layer <italic toggle="yes">et al.</italic>, 2016</xref>; <xref rid="btac413-B17" ref-type="bibr">LeFaive <italic toggle="yes">et al.</italic>, 2021</xref>; <xref rid="btac413-B18" ref-type="bibr">Li, 2016</xref>; <xref rid="btac413-B28" ref-type="bibr">Tatwawadi <italic toggle="yes">et al.</italic>, 2016</xref>). Exploitation of sparse representations, reordering of the data and re-encoding allowed file sizes to be reduced by an order of magnitude compared with standard VCF+gzip. However, one of the major issues of novel formats is that they lack application support, as they only come with a compression and decompression tool that allows conversion from and to a common format (e.g. VCF). This saves space for long-term storage but only adds overhead to analyses.</p>
    <p>To tackle this issue, in this article, we present xSqueezeIt (XSI), a file format made to store genotype data in a compact representation that allows for fast computation and analysis. Using data from the one thousand genome project (<xref rid="btac413-B5" ref-type="bibr">The 1000 Genomes Project Consortium, 2015</xref>), the Haplotype Reference Consortium (<xref rid="btac413-B22" ref-type="bibr">McCarthy <italic toggle="yes">et al.</italic>, 2016</xref>), the UK Biobank (SNP array and WGS) (<xref rid="btac413-B2" ref-type="bibr">Bycroft <italic toggle="yes">et al.</italic>, 2018</xref>; <xref rid="btac413-B13" ref-type="bibr">Halldorsson <italic toggle="yes">et al.</italic>, 2021</xref>) and simulated data, we demonstrate the compression performance of XSI, in both file size and access time compared with existing methods. To show how to integrate XSI in an application, file format support was added to SHAPEIT4 (<xref rid="btac413-B8" ref-type="bibr">Delaneau <italic toggle="yes">et al.</italic>, 2019</xref>). Finally, benchmarks of computation performed directly on the encoded data structures are given to show the benefits of the format in terms of performance for future analyses.</p>
  </sec>
  <sec>
    <title>2 Materials and methods</title>
    <p>XSI relies on a hierarchical block-based compression strategy. The compression hierarchy has two levels. First a (genetic) data specific algorithm is used and second the resulting data are handled as a general purpose file compression problem. In order to achieve fast random access to any variant loci, a block-based approach combined with indexing is used.</p>
    <p><xref rid="btac413-F1" ref-type="fig">Figure 1</xref> shows an overview of a VCF/BCF file and its equivalent XSI representation with internal structure. Variant information is kept in BCF format and holds a reference to the associated XSI file instead of the original genotype (and other) data. This reference is used to query the XSI file and extract the data. The XSI file itself is a collection of binary blocks, which contain a given number (8192 by default) of BCF lines (variant loci) encoded in a way specific to the data type. Blocks hold a dictionary that references its contents and are compressed with Zstandard (zstd) (<xref rid="btac413-B4" ref-type="bibr">Collet and Kucherawy, 2018</xref>). The file format specifications, internal binary structures and algorithms are available at <ext-link xlink:href="https://github.com/rwk-unil/xSqueezeIt" ext-link-type="uri">https://github.com/rwk-unil/xSqueezeIt</ext-link>.</p>
    <fig position="float" id="btac413-F1">
      <label>Fig. 1.</label>
      <caption>
        <p>The original VCF/BCF file is split in two files: a BCF file with variant information and a XSI file with per sample information (e.g. genotype data). The BCF can be queried to retrieve the per-sample information with an index referencing the XSI file. The XSI file itself is composed of binary data blocks which hold the sample data for a number of BCF lines, each block being compressed by zstd. The blocks themselves hold a small dictionary referencing their content, for example genotype data. The sub-blocks are independent and compressed with a method specific to the data type. Dashed arrows represent references</p>
      </caption>
      <graphic xlink:href="btac413f1" position="float"/>
    </fig>
    <sec>
      <title>2.1 Compression of genotype data</title>
      <p>We use two different strategies to compress genotype data, depending on allele frequency. First, for common variants [minor allele frequency (MAF) <inline-formula id="IE6"><mml:math id="IM6" display="inline" overflow="scroll"><mml:mrow><mml:mo>&gt;</mml:mo><mml:mn>0.1</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math></inline-formula>, by default], we exploit linkage disequilibrium (LD) in the population to reorder the data and allow for better compression. This is done by leveraging the positional Burrows–Wheeler transform (PBWT) to reorder the data before re-encoding. This approach has been shown to be effective (<xref rid="btac413-B11" ref-type="bibr">Durbin, 2014</xref>) and is the main component of many genotype compression algorithms (<xref rid="btac413-B9" ref-type="bibr">Deorowicz and Danek, 2019</xref>; <xref rid="btac413-B17" ref-type="bibr">LeFaive <italic toggle="yes">et al.</italic>, 2021</xref>; <xref rid="btac413-B18" ref-type="bibr">Li, 2016</xref>). After transforming the data through the PBWT, genotype data are encoded using a word-aligned hybrid (WAH) approach (<xref rid="btac413-B31" ref-type="bibr">Wu <italic toggle="yes">et al.</italic>, 2001</xref>). This is a variation of run length encoding (RLE) that is more robust to patterns of alternating symbols. WAH also allows efficient operations on the encoded data (<xref rid="btac413-B30" ref-type="bibr">Wu, 2001</xref>). Second, for the rare variants (MAF <inline-formula id="IE7"><mml:math id="IM7" display="inline" overflow="scroll"><mml:mrow><mml:mo>≤</mml:mo><mml:mn>0.1</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math></inline-formula>), we employ a sparse representation, directly exploiting the fact that the number of samples carrying the variant is small. These two methods are the main contributors to the file size reduction. <xref rid="btac413-F2" ref-type="fig">Figure 2</xref> illustrates the procedure on a few samples from the one thousand genome project (<xref rid="btac413-B5" ref-type="bibr">The 1000 Genomes Project Consortium, 2015</xref>).</p>
      <fig position="float" id="btac413-F2">
        <label>Fig. 2.</label>
        <caption>
          <p>Sketch of data reordering and re-encoding scheme. Input genotype data shown on the left: each column is a sample, each line a variant loci, an empty square is the reference allele, a colored square the alternate allele. The data are split into rare and common variants based on a MAF threshold. Rare variants are encoded as sparse lines. For common variants, each line is reordered given the previous lines, thanks to the PBWT. Reordered lines are WAH encoded</p>
        </caption>
        <graphic xlink:href="btac413f2" position="float"/>
      </fig>
      <p>The PBWT is applied on the common variants where it improves compression the most, as applying the transformation to all variant loci would be expensive, especially with large numbers of samples because each locus would require rearrangement of all samples. In order to improve per variant random access performance, the PBWT is recomputed from the initial sample ordering for each block, making each block independent. Therefore, access to data in a block does not require decoding any other block. This improves random access performance at the cost of a slightly bigger file.</p>
      <p>The chosen algorithms and encoded representations required to be computationally inexpensive in order to scale with large datasets. Ideally, the compression, access and decompression algorithms should not exhibit worse than linear complexity with relation to the number of genotypes. The sparse representation of XSI allows for computations through numerous existing libraries (e.g. BLAS and libboost) and the PBWT WAH-encoded representation also allows for interesting direct computations, for example, haplotype search and matching (<xref rid="btac413-B11" ref-type="bibr">Durbin, 2014</xref>; <xref rid="btac413-B30" ref-type="bibr">Wu, 2001</xref>).</p>
    </sec>
    <sec>
      <title>2.2 Storage and compression of other fields</title>
      <p>The hierarchical format shown in <xref rid="btac413-F1" ref-type="fig">Figure 1</xref> allows the addition of other sub-blocks for storage of other data found in VCF files, such as genotype likelihoods, read count and imputed dosages. Each sub-block can be specifically encoded and can employ different compression strategies. This also makes the format extensible without breaking compatibility. Older versions of the software simply ignore unknown sub-blocks. This also allows for development of sub-block formats by other developers. Sub-blocks are identified by their dictionary ID and developers can ask for a unique non-overlapping ID range through a github issue. This would guarantee that different implementations do not overlap even if their specifications are kept as closed source. This also makes it possible to add encrypted sub-blocks, providing privacy where needed without necessarily encrypting all the data. Finally, this also allows for alternative compression methods on already supported data types.</p>
    </sec>
    <sec>
      <title>2.3 Compression of encoded blocks</title>
      <p>Once the sub-blocks have been re-encoded with their specific compression scheme, further reduction can still be achieved. At this stage, a general purpose compression algorithm is applied to each block. Where VCF/BCF employs bgzip, we apply zstd (<xref rid="btac413-B4" ref-type="bibr">Collet and Kucherawy, 2018</xref>), a state-of-the-art LZ (<xref rid="btac413-B32" ref-type="bibr">Ziv and Lempel, 1977</xref>) compressor, because of its compression and decompression speed (lzbench an in-memory benchmark of open-source LZ77/LZSS/LZMA compressors. <ext-link xlink:href="https://github.com/inikep/lzbench" ext-link-type="uri">https://github.com/inikep/lzbench</ext-link>).</p>
    </sec>
  </sec>
  <sec>
    <title>3 Results</title>
    <p>We compared XSI with BCF (<xref rid="btac413-B6" ref-type="bibr">Danecek <italic toggle="yes">et al.</italic>, 2011</xref>), BGT (<xref rid="btac413-B18" ref-type="bibr">Li, 2016</xref>), GTC (<xref rid="btac413-B7" ref-type="bibr">Danek and Deorowicz, 2018</xref>), GTShark (<xref rid="btac413-B9" ref-type="bibr">Deorowicz and Danek, 2019</xref>), PBWT (<xref rid="btac413-B11" ref-type="bibr">Durbin, 2014</xref>), SAVVY (<xref rid="btac413-B17" ref-type="bibr">LeFaive <italic toggle="yes">et al.</italic>, 2021</xref>) and PLINK2 (<xref rid="btac413-B3" ref-type="bibr">Chang <italic toggle="yes">et al.</italic>, 2015</xref>) in terms of features, file size and conversion times across four gold standard datasets and a simulated region: The 1000 genome project phase 3 (<xref rid="btac413-B5" ref-type="bibr">The 1000 Genomes Project Consortium, 2015</xref>), the Haplotype Reference Consortium (<xref rid="btac413-B22" ref-type="bibr">McCarthy <italic toggle="yes">et al.</italic>, 2016</xref>), SNP array genotypes from the UK biobank (<xref rid="btac413-B2" ref-type="bibr">Bycroft <italic toggle="yes">et al.</italic>, 2018</xref>), WGS genotypes from the UK biobank (<xref rid="btac413-B13" ref-type="bibr">Halldorsson <italic toggle="yes">et al.</italic>, 2021</xref>) and a 10-Mb region with 1 million samples and over 2 million variants simulated with msprime (<xref rid="btac413-B15" ref-type="bibr">Kelleher and Lohse, 2020</xref>) (extended information in <xref rid="sup1" ref-type="supplementary-material">Supplementary Section S1</xref>).</p>
    <p>The benchmarks for UK Biobank WGS data have been run on the DNANexus research access platform on Xeon Platinum 8000 series with 64 GB of RAM. All other benchmarks have been run on an Intel Xeon E5-2680v3 CPU with 64 GB of RAM.</p>
    <sec>
      <title>3.1 Feature support</title>
      <p>Alternative file formats usually only implement a subset of all VCF/BCF features. <xref rid="btac413-T1" ref-type="table">Table 1</xref> summarizes features of XSI in comparison to existing formats.</p>
      <table-wrap position="float" id="btac413-T1">
        <label>Table 1.</label>
        <caption>
          <p>Features per file format (details in <xref rid="sup1" ref-type="supplementary-material">Supplementary Section S4</xref>)</p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th rowspan="1" colspan="1"/>
              <th rowspan="1" colspan="1">xsi</th>
              <th rowspan="1" colspan="1">bgt</th>
              <th rowspan="1" colspan="1">gtc</th>
              <th rowspan="1" colspan="1">gtshark</th>
              <th rowspan="1" colspan="1">pbwt</th>
              <th rowspan="1" colspan="1">savvy</th>
              <th rowspan="1" colspan="1">plink2</th>
              <th rowspan="1" colspan="1">bcf</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">Keeps variant info</td>
              <td rowspan="1" colspan="1">✓</td>
              <td rowspan="1" colspan="1">✗</td>
              <td rowspan="1" colspan="1">✗</td>
              <td rowspan="1" colspan="1">✓</td>
              <td rowspan="1" colspan="1">✗</td>
              <td rowspan="1" colspan="1">✓</td>
              <td rowspan="1" colspan="1">✓</td>
              <td rowspan="1" colspan="1">✓</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Mixed ploidy support</td>
              <td rowspan="1" colspan="1">1–2</td>
              <td rowspan="1" colspan="1">✗</td>
              <td rowspan="1" colspan="1">✗</td>
              <td rowspan="1" colspan="1">✗</td>
              <td rowspan="1" colspan="1">✗</td>
              <td rowspan="1" colspan="1">✓</td>
              <td rowspan="1" colspan="1">✓</td>
              <td rowspan="1" colspan="1">✓</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Keeps phase information</td>
              <td rowspan="1" colspan="1">✓</td>
              <td rowspan="1" colspan="1">✗</td>
              <td rowspan="1" colspan="1">✗</td>
              <td rowspan="1" colspan="1">✗</td>
              <td rowspan="1" colspan="1">✗</td>
              <td rowspan="1" colspan="1">✓</td>
              <td rowspan="1" colspan="1">✗</td>
              <td rowspan="1" colspan="1">✓</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Multi-allelic site support</td>
              <td rowspan="1" colspan="1">✓</td>
              <td rowspan="1" colspan="1">Split</td>
              <td rowspan="1" colspan="1">Split</td>
              <td rowspan="1" colspan="1">Split</td>
              <td rowspan="1" colspan="1">Split</td>
              <td rowspan="1" colspan="1">✓</td>
              <td rowspan="1" colspan="1">Split</td>
              <td rowspan="1" colspan="1">✓</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Sample extraction</td>
              <td rowspan="1" colspan="1">✓</td>
              <td rowspan="1" colspan="1">✓</td>
              <td rowspan="1" colspan="1">✓</td>
              <td rowspan="1" colspan="1">1</td>
              <td rowspan="1" colspan="1">✓</td>
              <td rowspan="1" colspan="1">✓</td>
              <td rowspan="1" colspan="1">✓</td>
              <td rowspan="1" colspan="1">✓</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Region extraction</td>
              <td rowspan="1" colspan="1">✓</td>
              <td rowspan="1" colspan="1">✓</td>
              <td rowspan="1" colspan="1">✓</td>
              <td rowspan="1" colspan="1">✗</td>
              <td rowspan="1" colspan="1">✓</td>
              <td rowspan="1" colspan="1">✓</td>
              <td rowspan="1" colspan="1">✓</td>
              <td rowspan="1" colspan="1">✓</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Simultaneous access with VCF files through HTSLIB (sync_reader)</td>
              <td rowspan="1" colspan="1">✓</td>
              <td rowspan="1" colspan="1">∼</td>
              <td rowspan="1" colspan="1">∼</td>
              <td rowspan="1" colspan="1">✗</td>
              <td rowspan="1" colspan="1">✗</td>
              <td rowspan="1" colspan="1">✗</td>
              <td rowspan="1" colspan="1">✗</td>
              <td rowspan="1" colspan="1">✓</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
      <p>Several file formats discard variant information, such as allele count (AC), allele frequency, filters, etc. (see <xref rid="sup1" ref-type="supplementary-material">Supplementary Section S4</xref>) and may therefore be unsuitable for certain tasks. Of the existing file formats, SAVVY, PLINK2 and XSI offer features closest to BCF. Because XSI keeps the variants in BCF format, it is compatible with BCFTools at the variant level. It can also be queried synchronously with VCF/BCF files through the HTSLIB. For example, to query common variant loci between a VCF sample and a XSI reference panel.</p>
    </sec>
    <sec>
      <title>3.2 Compression</title>
      <p>The different file formats have been evaluated for file size and conversion times from and to BCF on all datasets (dataset details in <xref rid="sup1" ref-type="supplementary-material">Supplementary Section S1</xref> and commands in <xref rid="sup1" ref-type="supplementary-material">Supplementary Section S2</xref>). <xref rid="btac413-F3" ref-type="fig">Figure 3</xref> summarizes the results. The methods can be split into three classes: BCF relies on a binary representation of the data followed by standard compression, PLINK2 employs a binary and sparse representation and finally all remaining methods employ data rearrangement (PBWT, sorting) before re-encoding and compressing. Rearrangement-based methods achieve the smallest footprint at the cost of conversion or access time. Overall, XSI achieves between <inline-formula id="IE8"><mml:math id="IM8" display="inline" overflow="scroll"><mml:mrow><mml:mn>4</mml:mn><mml:mo>×</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE9"><mml:math id="IM9" display="inline" overflow="scroll"><mml:mrow><mml:mn>20</mml:mn><mml:mo>×</mml:mo></mml:mrow></mml:math></inline-formula> file size reduction.</p>
      <fig position="float" id="btac413-F3">
        <label>Fig. 3.</label>
        <caption>
          <p>(<bold>A</bold>) File sizes with conversion time to and from BCF on data from the 1000 Genome Project Phase 3, the Haplotype Reference Consortium, the UK Biobank SNP Array genotypes, the UK Biobank WGS genotypes and a 10-Mb simulated region with 1 million samples. (<bold>B</bold>) MAF distribution for the real (non-simulated) datasets</p>
        </caption>
        <graphic xlink:href="btac413f3" position="float"/>
      </fig>
      <p>The reported decompression times reflect the conversion of a given format to uncompressed BCF (bypassing the gzip compression) in order to demonstrate the format decompression speed and because this is what would be used to pipe into other tools. Piping compressed BCF is an issue because the first tool has to reconvert to BCF and compress it (gzip) and then the second tool will have to decompress the data right after to use it. This chained compression–decompression is an unnecessary and computationally expensive step in an analysis pipeline. SAVVY did not provide the option to output uncompressed BCF and therefore exhibited longer decompression time because it output compressed BCF.</p>
      <p>GTC failed to compress the larger datasets with the allocated resources (24 h, 64 GB of memory), BGT would crash when compressing the UKB WGS data. The resulting output files of GTShark for UKB WGS and SIM datasets were corrupted (this issue has been mentioned to the authors). PBWT can achieve small file sizes but does not provide efficient random access on the data and the per variant locus dependency makes it costly to access. PLINK2 uses custom code to encode and decode BCF and is faster compared with other methods that rely on the HTSLIB but exhibits larger file sizes. XSI manages to compress and decompress all datasets, with a competitive file size and access time. Allele frequency bin counts are given for the real datasets in <xref rid="btac413-F3" ref-type="fig">Figure  3B</xref> to show the sparsity of the data, low MAF values mean sparse data.</p>
    </sec>
    <sec>
      <title>3.3 Data access</title>
      <p>In order to assess the impact of using XSI compressed data inside a software tool, we looked at the time needed to load data in memory from a compressed XSI file against BCF (<xref rid="btac413-F4" ref-type="fig">Fig. 4</xref>) and found that the performance depends on the balance between rare and common variants; from <inline-formula id="IE10"><mml:math id="IM10" display="inline" overflow="scroll"><mml:mrow><mml:mn>2</mml:mn><mml:mo>×</mml:mo></mml:mrow></mml:math></inline-formula> slower on UKB SNP array data to <inline-formula id="IE11"><mml:math id="IM11" display="inline" overflow="scroll"><mml:mrow><mml:mn>8</mml:mn><mml:mo>×</mml:mo></mml:mrow></mml:math></inline-formula> faster on UKB WGS and simulated data (<xref rid="btac413-F4" ref-type="fig">Fig. 4</xref>). The MAF threshold of XSI can be adapted to improve loading times at the cost of file size (see <xref rid="sup1" ref-type="supplementary-material">Supplementary Section S3</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S1</xref>). We used the XSI C API we provide to modify SHAPEIT4 (<xref rid="btac413-B8" ref-type="bibr">Delaneau <italic toggle="yes">et al.</italic>, 2019</xref>) so that genotype data can be directly loaded from XSI files. This significantly speeds-up loading times for WGS data such as the UKB and simulated datasets with minimal coding efforts (changes of less than 10 C/C++ lines of code). For the UK Biobank SNP array, data loading time is slower because it is mostly common variants (see <xref rid="btac413-F3" ref-type="fig">Fig.  3B</xref>) and has to perform many costly PBWT rearrangements during access.</p>
      <fig position="float" id="btac413-F4">
        <label>Fig. 4.</label>
        <caption>
          <p>Loading times compared with BCF on real and simulated datasets. Total loading time for chr1-22 on 1KGP3, HRC and UKB SNP. Loading time for chr20 only on UKB WGS</p>
        </caption>
        <graphic xlink:href="btac413f4" position="float"/>
      </fig>
      <p>It is also possible to directly pipe the output of the XSI decompressor into a pipeline that expects BCF. An example is given with a BCFTools run of homozygosity (ROH) pipeline (<xref rid="btac413-B25" ref-type="bibr">Narasimhan <italic toggle="yes">et al.</italic>, 2016</xref>), once by reading directly from a BCF file and once by redirecting the output of XSI into BCFTools. The analysis was performed on a single chromosome with sample subsets of 1, 10, and 100 samples to assess sample extraction performance as well. Outputs for both methods are identical. The commands for both pipelines are given in <xref rid="sup1" ref-type="supplementary-material">Supplementary Section S5</xref>. Results are shown in <xref rid="btac413-F5" ref-type="fig">Figure 5</xref> and exhibit similar results to the loading time benchmark except a slightly worse performance for the 1KGP3 and HRC datasets, because the decompressor not only decompresses the data but also converts it back to BCF before writing it into the pipeline. The UKB SNP array dataset suffers from the PBWT rearrangements needed when extracting samples. However, running with the UKB WGS and simulated data, the results are sped-up by a factor of over <inline-formula id="IE12"><mml:math id="IM12" display="inline" overflow="scroll"><mml:mrow><mml:mn>5</mml:mn><mml:mo>×</mml:mo></mml:mrow></mml:math></inline-formula> compared with BCF.</p>
      <fig position="float" id="btac413-F5">
        <label>Fig. 5.</label>
        <caption>
          <p>Runtimes of the ROH pipeline XSI decompressed and piped into BCFTools compared with BCF</p>
        </caption>
        <graphic xlink:href="btac413f5" position="float"/>
      </fig>
    </sec>
    <sec>
      <title>3.4 Computation on encoded data</title>
      <p>The idea of computing directly on encoded data instead of decoding the data for analysis has been proposed in <xref rid="btac413-B19" ref-type="bibr">Loh <italic toggle="yes">et al.</italic> (2012)</xref> under the term ‘compressive genomics’ and introduces the concept of ‘algorithms that compute directly on compressed genomic data to allow analyses to keep pace with data generation’. This concept was developed and applied to further bioinformatics fields as ‘compressive acceleration’ (<xref rid="btac413-B1" ref-type="bibr">Berger <italic toggle="yes">et al.</italic>, 2016</xref>). In order to allow for ‘compressive acceleration’, XSI provides access to the internal data structures. This makes it possible to apply algorithms on encoded data and do computations without full decompression. In order to demonstrate the advantages of ‘compressive’ methods, two example applications are provided. First, computation of ACs for every variant. Second, dot products between encoded genotype data and phenotype data.</p>
      <sec>
        <title>3.4.1 Computation of AC (allele frequency)</title>
        <p>The computation of AC is done for example each time a BCF is subsetted. We compared updating the fields ‘AC’ (alternative AC) and ‘AN’ (total allele number) with BCFTools (fill-tags plugin) and using the XSI internal representation. Because these statistics do not rely on the ordering of the samples, they can be extracted without the costly PBWT transform and only require us to decompress the zstd layer. The internal sparse and WAH representations allow us to get the counts in a very efficient manner. XSI allowed for a speed-up from <inline-formula id="IE13"><mml:math id="IM13" display="inline" overflow="scroll"><mml:mrow><mml:mn>25</mml:mn><mml:mo>×</mml:mo></mml:mrow></mml:math></inline-formula> to over <inline-formula id="IE14"><mml:math id="IM14" display="inline" overflow="scroll"><mml:mrow><mml:mn>1000</mml:mn><mml:mo>×</mml:mo></mml:mrow></mml:math></inline-formula> (<xref rid="btac413-T2" ref-type="table">Table 2</xref>). Commands are given in <xref rid="sup1" ref-type="supplementary-material">Supplementary Section S6</xref>.</p>
        <table-wrap position="float" id="btac413-T2">
          <label>Table 2.</label>
          <caption>
            <p>Runtimes of the alternative AC and total AC (AN) recomputation with BCFTools (plugin fill-tags) versus XSI</p>
          </caption>
          <table frame="hsides" rules="groups">
            <colgroup span="1">
              <col valign="top" align="left" span="1"/>
              <col valign="top" align="center" span="1"/>
              <col valign="top" align="center" span="1"/>
              <col valign="top" align="char" char="×" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th rowspan="1" colspan="1">AC/AN Count</th>
                <th rowspan="1" colspan="1">bcf fill-tags</th>
                <th rowspan="1" colspan="1">xsi</th>
                <th align="center" rowspan="1" colspan="1">Speed-up</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td rowspan="1" colspan="1">1KGP3 chr1</td>
                <td rowspan="1" colspan="1">29m27s</td>
                <td rowspan="1" colspan="1">1m09s</td>
                <td rowspan="1" colspan="1">
                  <inline-formula id="IE15">
                    <mml:math id="IM15" display="inline" overflow="scroll">
                      <mml:mrow>
                        <mml:mo>&gt;</mml:mo>
                        <mml:mn>25</mml:mn>
                        <mml:mo>×</mml:mo>
                      </mml:mrow>
                    </mml:math>
                  </inline-formula>
                </td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">HRC chr1</td>
                <td rowspan="1" colspan="1">130m26s</td>
                <td rowspan="1" colspan="1">2m59s</td>
                <td rowspan="1" colspan="1">
                  <inline-formula id="IE16">
                    <mml:math id="IM16" display="inline" overflow="scroll">
                      <mml:mrow>
                        <mml:mo>&gt;</mml:mo>
                        <mml:mn>43</mml:mn>
                        <mml:mo>×</mml:mo>
                      </mml:mrow>
                    </mml:math>
                  </inline-formula>
                </td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">UKB SNP chr1</td>
                <td rowspan="1" colspan="1">89m01s</td>
                <td rowspan="1" colspan="1">2m19s</td>
                <td rowspan="1" colspan="1">
                  <inline-formula id="IE17">
                    <mml:math id="IM17" display="inline" overflow="scroll">
                      <mml:mrow>
                        <mml:mo>&gt;</mml:mo>
                        <mml:mn>38</mml:mn>
                        <mml:mo>×</mml:mo>
                      </mml:mrow>
                    </mml:math>
                  </inline-formula>
                </td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">UKB WGS chr20</td>
                <td rowspan="1" colspan="1">2464m58s</td>
                <td rowspan="1" colspan="1">8m36s</td>
                <td rowspan="1" colspan="1">
                  <inline-formula id="IE18">
                    <mml:math id="IM18" display="inline" overflow="scroll">
                      <mml:mrow>
                        <mml:mo>&gt;</mml:mo>
                        <mml:mn>280</mml:mn>
                        <mml:mo>×</mml:mo>
                      </mml:mrow>
                    </mml:math>
                  </inline-formula>
                </td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">SIM</td>
                <td rowspan="1" colspan="1">2768m37s</td>
                <td rowspan="1" colspan="1">2m12s</td>
                <td rowspan="1" colspan="1">
                  <inline-formula id="IE19">
                    <mml:math id="IM19" display="inline" overflow="scroll">
                      <mml:mrow>
                        <mml:mo>&gt;</mml:mo>
                        <mml:mn>1250</mml:mn>
                        <mml:mo>×</mml:mo>
                      </mml:mrow>
                    </mml:math>
                  </inline-formula>
                </td>
              </tr>
            </tbody>
          </table>
          <table-wrap-foot>
            <fn id="tblfn1">
              <p><italic toggle="yes">Note</italic>: Both programs annotate the BCF file with the same results.</p>
            </fn>
          </table-wrap-foot>
        </table-wrap>
        <p>Computation and access to these summary statistics is key for many applications. For example, when getting the alternative ACs for all samples of a given population, working with the encoded representations allows us to get the counts orders of magnitude faster than with the BCF plugin.</p>
      </sec>
      <sec>
        <title>3.4.2 Dot products</title>
        <p>Dot products are at the base of many statistical tests performed in the context of GWAS, the most known being linear regression. We therefore wanted to evaluate the performance of the XSI internal structures for this operation. A benchmark was created to run dot products between genotypes and phenotypes (floating point double values). We compare the traditional array of genotypes (as in BCF) to our PBWT WAH encoded and sparse data structures. A program was written to compute the dot products from genotypes from either a BCF or a XSI file against given phenotype values, which allowed us to compare runtimes as well as the validity of the results.</p>
        <p><xref rid="btac413-F6" ref-type="fig">Figure  6A</xref> shows the runtimes on all datasets. This runtime encompasses file loading and decompression (gzip for BCF and zstd for XSI). XSI shows faster runtimes on all datasets. <xref rid="btac413-F6" ref-type="fig">Figure  6B</xref> shows a synthetic benchmark (1 million samples) to assess the performance of the structures as a function of MAF compared with a plain array (baseline). The sparse representation only computes values for non-zero (hom ref) data and therefore scales with sparsity (low MAF values). Sparse computation is key to many methods, for example (<xref rid="btac413-B21" ref-type="bibr">Mbatchou <italic toggle="yes">et al.</italic>, 2021</xref>). PBWT-reordered WAH suffers from non-linear data access patterns and performs worse than baseline for high MAF (<inline-formula id="IE20"><mml:math id="IM20" display="inline" overflow="scroll"><mml:mrow><mml:mo>&gt;</mml:mo><mml:mn>5</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math></inline-formula>). However, lower MAF values still allow to skip portions of zero values and achieve good performances. The MAF distribution inside the dataset (<xref rid="btac413-F3" ref-type="fig">Fig.  3B</xref>) will dictate performance. Nevertheless, for all datasets, using XSI and performing computations on the encoded data resulted in a speed-up (<inline-formula id="IE21"><mml:math id="IM21" display="inline" overflow="scroll"><mml:mrow><mml:mn>30</mml:mn><mml:mo>×</mml:mo></mml:mrow></mml:math></inline-formula> for UKB WGS) compared with computing the dot product on a plain array (baseline) from BCF, even for the UKB SNP data. The dot product benchmark can outperform the loading time benchmark because data are not decompressed into plain arrays but used directly.</p>
        <fig position="float" id="btac413-F6">
          <label>Fig. 6.</label>
          <caption>
            <p>(<bold>A</bold>) Runtimes of the dot product computation between the genotype array and a phenotype array at each variant locus, for all the datasets (single chromosome). (<bold>B</bold>) The number of dot products per second relative to encoding and MAF compared with baseline (plain array). Cases slower than baseline are shown in red.</p>
          </caption>
          <graphic xlink:href="btac413f6" position="float"/>
        </fig>
        <p>Many software suites make use of the sparse representation when effective. However, they require conversion from the input format to the internal representation, while here it is possible to directly load the file without any conversions and directly work with the encoded data. This does not only speed up computations but file loading as well, which sometimes is the major bottleneck. The WAH representation, even with the cost of PBWT rearrangement, allows our method to achieve further gains for variants with MAF <inline-formula id="IE22"><mml:math id="IM22" display="inline" overflow="scroll"><mml:mrow><mml:mo>&lt;</mml:mo><mml:mn>5</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math></inline-formula>. The increased computation cost for variants with MAF <inline-formula id="IE23"><mml:math id="IM23" display="inline" overflow="scroll"><mml:mrow><mml:mo>≥</mml:mo><mml:mn>5</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math></inline-formula> is not a major concern because the number of these extremely common variants is limited and will not increase much in the future, newly discovered variants being (very) rare as can be seen in the UKB WGS MAF distribution (<xref rid="btac413-F3" ref-type="fig">Fig.  3B</xref>).</p>
      </sec>
    </sec>
  </sec>
  <sec>
    <title>4 Discussion</title>
    <p>In this article, we have presented XSI, a new file format that comes with a command line tool XSI, C API, open-source code and format specifications. XSI was shown to reduce file size footprint, 4–<inline-formula id="IE24"><mml:math id="IM24" display="inline" overflow="scroll"><mml:mrow><mml:mn>20</mml:mn><mml:mo>×</mml:mo></mml:mrow></mml:math></inline-formula> times compared with BCF, to improve loading times, up to <inline-formula id="IE25"><mml:math id="IM25" display="inline" overflow="scroll"><mml:mrow><mml:mn>8</mml:mn><mml:mo>×</mml:mo></mml:mrow></mml:math></inline-formula> times faster than BCF and to speed-up computations for analyses on real and simulated datasets. XSI is particularly effective on WGS data such as from the UK biobank and we show the usefulness of computation on the encoded data with <inline-formula id="IE26"><mml:math id="IM26" display="inline" overflow="scroll"><mml:mrow><mml:mn>280</mml:mn><mml:mo>×</mml:mo></mml:mrow></mml:math></inline-formula> faster computation of ACs and <inline-formula id="IE27"><mml:math id="IM27" display="inline" overflow="scroll"><mml:mrow><mml:mn>30</mml:mn><mml:mo>×</mml:mo></mml:mrow></mml:math></inline-formula> faster dot product computation on the UK biobank WGS data. Simulated data show that with future WGS datasets, the difference between BCF and XSI will increase further.</p>
    <p>Data generated from population scale projects with WGS created the need for novel file formats in order to scale and reduce costs, not only for data storage and transfer but also for analyses. XSI achieves the goals of providing a smaller footprint, speeding up data access and computations and allows future extensions.</p>
    <p>XSI was mainly designed to reduce the footprint of large human genotype collections so it focused on genotype data alone and does not yet support other fields such as genotype likelihoods or dosages. However, because the format is extensible, data blocks for these fields can be added without breaking compatibility with the current version.</p>
    <p>Future works include developing specialized compression methods for other fields. Other future works include adapting existing methods to take advantage of XSI internal data structures to improve performance through ‘compressive genomics’, for example, for GWAS or haplotype imputation. Finally, with the smaller file footprint and efficient internal data structures, XSI would also fit computations on accelerators with limited memory such as graphic cards (GPUs) or field programmable gate arrays (FPGAs).</p>
    <p>We provide a solution to compress VCF/BCF files, a command line tool, an API for synchronous mixed format reading compatible with HTSLIB and access to inner data structures for fast computation. A structured format approach also allows to expand XSI in the future. Our results show the format to be well suited for storage, access and analysis of existing and future WGS genotype datasets such as from the UK biobank.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btac413_Supplementary_Data</label>
      <media xlink:href="btac413_supplementary_data.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgements</title>
    <p>The authors would like to thank Diogo Ribeiro for the fruitful discussions and insights into the project. The benchmarks on the UK Biobank data have been conducted using the UK Biobank Resource under Application Number 66995.</p>
    <sec>
      <title>Funding</title>
      <p>This work has been supported by the School of Management and Engineering Vaud (HEIG-VD). S.R. and O.D. are supported by SNF grant number: SNSF-PP00P3_176977.</p>
      <p><italic toggle="yes">Conflict of Interest</italic>: none declared.</p>
    </sec>
  </ack>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btac413-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Berger</surname><given-names>B.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2016</year>) <article-title>Computational biology in the 21st century: Scaling with compressive algorithms</article-title>. <source>Commun. ACM</source>, <volume>59</volume>, <fpage>72</fpage>–<lpage>80</lpage>.<pub-id pub-id-type="pmid">28966343</pub-id></mixed-citation>
    </ref>
    <ref id="btac413-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bycroft</surname><given-names>C.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2018</year>) <article-title>The UK biobank resource with deep phenotyping and genomic data</article-title>. <source>Nature</source>, <volume>562</volume>, <fpage>203</fpage>–<lpage>209</lpage>.<pub-id pub-id-type="pmid">30305743</pub-id></mixed-citation>
    </ref>
    <ref id="btac413-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Chang</surname><given-names>C.C.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2015</year>) <article-title>Second-generation PLINK: rising to the challenge of larger and richer datasets</article-title>. <source>Gigascience</source>, <volume>4</volume>, <fpage>s13742</fpage>–<lpage>015</lpage>.</mixed-citation>
    </ref>
    <ref id="btac413-B4">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Collet</surname><given-names>Y.</given-names></string-name>, <string-name><surname>Kucherawy</surname><given-names>M.</given-names></string-name></person-group> (<year>2018</year>) Zstandard compression and the application/zstd media type. <italic toggle="yes">RFC 8478.</italic></mixed-citation>
    </ref>
    <ref id="btac413-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Danecek</surname><given-names>P.</given-names></string-name></person-group>  <etal>et al</etal>; 1000 Genomes Project Analysis Group. (<year>2011</year>) <article-title>The variant call format and VCFtools</article-title>. <source>Bioinformatics</source>, <volume>27</volume>, <fpage>2156</fpage>–<lpage>2158</lpage>.<pub-id pub-id-type="pmid">21653522</pub-id></mixed-citation>
    </ref>
    <ref id="btac413-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Danek</surname><given-names>A.</given-names></string-name>, <string-name><surname>Deorowicz</surname><given-names>S.</given-names></string-name></person-group> (<year>2018</year>) <article-title>GTC: How to maintain huge genotype collections in a compressed form</article-title>. <source>Bioinformatics</source>, <volume>34</volume>, <fpage>1834</fpage>–<lpage>1840</lpage>.<pub-id pub-id-type="pmid">29351600</pub-id></mixed-citation>
    </ref>
    <ref id="btac413-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Delaneau</surname><given-names>O.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019</year>) <article-title>Accurate, scalable and integrative haplotype estimation</article-title>. <source>Nat. Commun</source>., <volume>10</volume>, <fpage>1</fpage>–<lpage>10</lpage>.<pub-id pub-id-type="pmid">30602773</pub-id></mixed-citation>
    </ref>
    <ref id="btac413-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Deorowicz</surname><given-names>S.</given-names></string-name>, <string-name><surname>Danek</surname><given-names>A.</given-names></string-name></person-group> (<year>2019</year>) <article-title>GTShark: Genotype compression in large projects</article-title>. <source>Bioinformatics</source>, <volume>35</volume>, <fpage>4791</fpage>–<lpage>4793</lpage>.<pub-id pub-id-type="pmid">31225861</pub-id></mixed-citation>
    </ref>
    <ref id="btac413-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Deorowicz</surname><given-names>S.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2013</year>) <article-title>Genome compression: A novel approach for large collections</article-title>. <source>Bioinformatics</source>, <volume>29</volume>, <fpage>2572</fpage>–<lpage>2578</lpage>.<pub-id pub-id-type="pmid">23969136</pub-id></mixed-citation>
    </ref>
    <ref id="btac413-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Durbin</surname><given-names>R.</given-names></string-name></person-group> (<year>2014</year>) <article-title>Efficient haplotype matching and storage using the positional burrows–wheeler transform (PBWT)</article-title>. <source>Bioinformatics</source>, <volume>30</volume>, <fpage>1266</fpage>–<lpage>1272</lpage>.<pub-id pub-id-type="pmid">24413527</pub-id></mixed-citation>
    </ref>
    <ref id="btac413-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gudmundsson</surname><given-names>S.</given-names></string-name></person-group>  <etal>et al</etal>; Genome Aggregation Database Consortium. (<year>2021</year>) <article-title>Variant interpretation using population databases: Lessons from gnomAD</article-title>. <source>Hum Mutat</source>. <ext-link xlink:href="https://onlinelibrary.wiley.com/doi/full/10.1002/humu.24309" ext-link-type="uri">https://onlinelibrary.wiley.com/doi/full/10.1002/humu.24309</ext-link>.</mixed-citation>
    </ref>
    <ref id="btac413-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Halldorsson</surname><given-names>B.V.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2021</year>) The sequences of <volume>150</volume>,119 genomes in the UK biobank. <italic toggle="yes">bioRxiv.</italic></mixed-citation>
    </ref>
    <ref id="btac413-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Karczewski</surname><given-names>K.J.</given-names></string-name></person-group>  <etal>et al</etal>; Genome Aggregation Database Consortium. (<year>2020</year>) <article-title>The mutational constraint spectrum quantified from variation in 141,456 humans</article-title>. <source>Nature</source>, <volume>581</volume>, <fpage>434</fpage>–<lpage>443</lpage>.<pub-id pub-id-type="pmid">32461654</pub-id></mixed-citation>
    </ref>
    <ref id="btac413-B15">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Kelleher</surname><given-names>J.</given-names></string-name>, <string-name><surname>Lohse</surname><given-names>K.</given-names></string-name></person-group> (<year>2020</year>) <part-title>Coalescent simulation with msprime</part-title>. In: Dutheil, J.Y. (ed.) <source>Statistical Population Genomics</source>. <publisher-name>Humana</publisher-name>, <publisher-loc>New York, NY</publisher-loc>. pp. <fpage>191</fpage>–<lpage>230</lpage>.</mixed-citation>
    </ref>
    <ref id="btac413-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Layer</surname><given-names>R.M.</given-names></string-name></person-group>  <etal>et al</etal>; Exome Aggregation Consortium. (<year>2016</year>) <article-title>Efficient genotype compression and analysis of large genetic-variation data sets</article-title>. <source>Nat. Methods</source>, <volume>13</volume>, <fpage>63</fpage>–<lpage>65</lpage>.<pub-id pub-id-type="pmid">26550772</pub-id></mixed-citation>
    </ref>
    <ref id="btac413-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>LeFaive</surname><given-names>J.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2021</year>) <article-title>Sparse allele vectors and the savvy software suite</article-title>. <source>Bioinformatics</source>, <volume>37</volume>, <fpage>4248</fpage>–<lpage>4250</lpage>.<pub-id pub-id-type="pmid">33989384</pub-id></mixed-citation>
    </ref>
    <ref id="btac413-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Li</surname><given-names>H.</given-names></string-name></person-group> (<year>2016</year>) <article-title>BGT: Efficient and flexible genotype query across many samples</article-title>. <source>Bioinformatics</source>, <volume>32</volume>, <fpage>590</fpage>–<lpage>592</lpage>.<pub-id pub-id-type="pmid">26500154</pub-id></mixed-citation>
    </ref>
    <ref id="btac413-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Loh</surname><given-names>P.-R.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2012</year>) <article-title>Compressive genomics</article-title>. <source>Nat. Biotechnol</source>., <volume>30</volume>, <fpage>627</fpage>–<lpage>630</lpage>.<pub-id pub-id-type="pmid">22781691</pub-id></mixed-citation>
    </ref>
    <ref id="btac413-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Marchini</surname><given-names>J.</given-names></string-name></person-group> (<year>2019</year>) <article-title>Haplotype estimation and genotype imputation</article-title>. In: Balding, D. <italic toggle="yes">et al.</italic> (eds.) <source>Handbook of Statistical Genomics: Two Volume Set</source>, pp. <fpage>87</fpage>–<lpage>114</lpage>.</mixed-citation>
    </ref>
    <ref id="btac413-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mbatchou</surname><given-names>J.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2021</year>) <article-title>Computationally efficient whole-genome regression for quantitative and binary traits</article-title>. <source>Nat. Genet</source>., <volume>53</volume>, <fpage>1097</fpage>–<lpage>1103</lpage>.<pub-id pub-id-type="pmid">34017140</pub-id></mixed-citation>
    </ref>
    <ref id="btac413-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>McCarthy</surname><given-names>S.</given-names></string-name></person-group>  <etal>et al</etal>; Haplotype Reference Consortium. (<year>2016</year>) <article-title>A reference panel of 64,976 haplotypes for genotype imputation</article-title>. <source>Nat. Genet</source>., <volume>48</volume>, <fpage>1279</fpage>–<lpage>1283</lpage>.<pub-id pub-id-type="pmid">27548312</pub-id></mixed-citation>
    </ref>
    <ref id="btac413-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Morris</surname><given-names>A.P.</given-names></string-name>, <string-name><surname>Cardon</surname><given-names>L.R.</given-names></string-name></person-group> (<year>2019</year>) <article-title>Genome-wide association studies</article-title>. In: <source>Handbook of Statistical Genomics: Two Volume Set</source>, pp. <fpage>597</fpage>–<lpage>550</lpage>.</mixed-citation>
    </ref>
    <ref id="btac413-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Nait Saada</surname><given-names>J.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2020</year>) <article-title>Identity-by-descent detection across 487,409 British samples reveals fine scale population structure and ultra-rare variant associations</article-title>. <source>Nat. Commun</source>., <volume>11</volume>, <fpage>1</fpage>–<lpage>15</lpage>.<pub-id pub-id-type="pmid">31911652</pub-id></mixed-citation>
    </ref>
    <ref id="btac413-B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Narasimhan</surname><given-names>V.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2016</year>) <article-title>BCFtools/RoH: A hidden Markov model approach for detecting autozygosity from next-generation sequencing data</article-title>. <source>Bioinformatics</source>, <volume>32</volume>, <fpage>1749</fpage>–<lpage>1751</lpage>.<pub-id pub-id-type="pmid">26826718</pub-id></mixed-citation>
    </ref>
    <ref id="btac413-B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sudlow</surname><given-names>C.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2015</year>) <article-title>UK biobank: An open access resource for identifying the causes of a wide range of complex diseases of Middle and old age</article-title>. <source>PLoS Med</source>., <volume>12</volume>, <fpage>e1001779</fpage>.<pub-id pub-id-type="pmid">25826379</pub-id></mixed-citation>
    </ref>
    <ref id="btac413-B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Taliun</surname><given-names>D.</given-names></string-name></person-group>  <etal>et al</etal>; NHLBI Trans-Omics for Precision Medicine (TOPMed) Consortium. (<year>2021</year>) <article-title>Sequencing of 53,831 diverse genomes from the NHLBI TOPMed program</article-title>. <source>Nature</source>, <volume>590</volume>, <fpage>290</fpage>–<lpage>299</lpage>.<pub-id pub-id-type="pmid">33568819</pub-id></mixed-citation>
    </ref>
    <ref id="btac413-B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tatwawadi</surname><given-names>K.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2016</year>) <article-title>GTRAC: Fast retrieval from compressed collections of genomic variants</article-title>. <source>Bioinformatics</source>, <volume>32</volume>, <fpage>i479</fpage>–<lpage>i486</lpage>.<pub-id pub-id-type="pmid">27587665</pub-id></mixed-citation>
    </ref>
    <ref id="btac413-B5">
      <mixed-citation publication-type="journal">The 1000 Genomes Project Consortium (<year>2015</year>) <article-title>A global reference for human genetic variation</article-title>. <source>Nature</source>, <volume>526</volume>, <fpage>68</fpage>.<pub-id pub-id-type="pmid">26432245</pub-id></mixed-citation>
    </ref>
    <ref id="btac413-B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Visscher</surname><given-names>P.M.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2017</year>) <article-title>10 years of GWAS discovery: Biology, function, and translation</article-title>. <source>Am. J. Hum. Genet</source>., <volume>101</volume>, <fpage>5</fpage>–<lpage>22</lpage>.<pub-id pub-id-type="pmid">28686856</pub-id></mixed-citation>
    </ref>
    <ref id="btac413-B30">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Wu</surname><given-names>K.</given-names></string-name></person-group> (<year>2001</year>) <italic toggle="yes">Notes on design and implementation of compressed bit vectors</italic>. Lawrence Berkeley National Laboratory, LBNL Report #: LBNL/PUB-3161. Retrieved from <ext-link xlink:href="https://escholarship.org/uc/item/9zz3r6k7" ext-link-type="uri">https://escholarship.org/uc/item/9zz3r6k7</ext-link>.</mixed-citation>
    </ref>
    <ref id="btac413-B31">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Wu</surname><given-names>K.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2001</year>) <italic toggle="yes">Compressed bitmap indices for efficient query processing</italic>. Lawrence Berkeley National Laboratory. Retrieved from <ext-link xlink:href="https://escholarship.org/uc/item/8k22w7q2" ext-link-type="uri">https://escholarship.org/uc/item/8k22w7q2</ext-link>.</mixed-citation>
    </ref>
    <ref id="btac413-B32">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ziv</surname><given-names>J.</given-names></string-name>, <string-name><surname>Lempel</surname><given-names>A.</given-names></string-name></person-group> (<year>1977</year>) <article-title>A universal algorithm for sequential data compression</article-title>. <source>IEEE Trans. Inform. Theory</source>, <volume>23</volume>, <fpage>337</fpage>–<lpage>343</lpage>.</mixed-citation>
    </ref>
  </ref-list>
</back>
