<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6581438</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/bty915</article-id>
    <article-id pub-id-type="publisher-id">bty915</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Notes</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Genome Analysis</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>wgd—simple command line tools for the analysis of ancient whole-genome duplications</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Zwaenepoel</surname>
          <given-names>Arthur</given-names>
        </name>
        <xref ref-type="aff" rid="bty915-aff1">1</xref>
        <xref ref-type="aff" rid="bty915-aff2">2</xref>
        <xref ref-type="aff" rid="bty915-aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Van de Peer</surname>
          <given-names>Yves</given-names>
        </name>
        <xref ref-type="aff" rid="bty915-aff1">1</xref>
        <xref ref-type="aff" rid="bty915-aff2">2</xref>
        <xref ref-type="aff" rid="bty915-aff3">3</xref>
        <xref ref-type="aff" rid="bty915-aff4">4</xref>
        <xref ref-type="corresp" rid="bty915-cor1"/>
        <!--<email>yves.vandepeer@psb.vib-ugent.be</email>-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Hancock</surname>
          <given-names>John</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <aff id="bty915-aff1"><label>1</label>Department of Plant Biotechnology and Bioinformatics, Ghent University</aff>
    <aff id="bty915-aff2"><label>2</label>Center for Plant Systems Biology, VIB</aff>
    <aff id="bty915-aff3"><label>3</label>Bioinformatics Institute Ghent, Ghent University, Ghent, Belgium</aff>
    <aff id="bty915-aff4"><label>4</label>Department of Biochemistry, Genetics and Microbiology, University of Pretoria, Pretoria, South Africa</aff>
    <author-notes>
      <corresp id="bty915-cor1">To whom correspondence should be addressed. Email: <email>yves.vandepeer@psb.vib-ugent.be</email></corresp>
    </author-notes>
    <pub-date pub-type="ppub">
      <month>6</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2018-11-06">
      <day>06</day>
      <month>11</month>
      <year>2018</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>06</day>
      <month>11</month>
      <year>2018</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. -->
    <volume>35</volume>
    <issue>12</issue>
    <fpage>2153</fpage>
    <lpage>2155</lpage>
    <history>
      <date date-type="received">
        <day>11</day>
        <month>9</month>
        <year>2018</year>
      </date>
      <date date-type="rev-recd">
        <day>11</day>
        <month>10</month>
        <year>2018</year>
      </date>
      <date date-type="accepted">
        <day>05</day>
        <month>11</month>
        <year>2018</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2018. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2018</copyright-year>
      <license license-type="cc-by" xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="bty915.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Summary</title>
        <p>Ancient whole-genome duplications (WGDs) have been uncovered in almost all major lineages of life on Earth and the search for traces or remnants of such events has become standard practice in most genome analyses. This is especially true for plants, where ancient WGDs are abundant. Common approaches to find evidence for ancient WGDs include the construction of <italic>K</italic><sub>S</sub> distributions and the analysis of intragenomic colinearity. Despite the increased interest in WGDs and the acknowledgment of their evolutionary importance, user-friendly and comprehensive tools for their analysis are lacking. Here, we present an easy to use command-line tool for <italic>K</italic><sub>S</sub> distribution construction named wgd. The wgd suite provides commonly used <italic>K</italic><sub>S</sub> and colinearity analysis workflows together with tools for modeling and visualization, rendering these analyses accessible to genomics researchers in a convenient manner.</p>
      </sec>
      <sec id="s2">
        <title>Availability and implementation</title>
        <p>wgd is free and open source software implemented in Python and is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/arzwa/wgd">https://github.com/arzwa/wgd</ext-link>.</p>
      </sec>
      <sec id="s3">
        <title>Supplementary information</title>
        <p><xref ref-type="supplementary-material" rid="sup1">Supplementary data</xref> are available at <italic>Bioinformatics</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">European Union Seventh Framework Programme</named-content>
          <named-content content-type="funder-identifier">10.13039/100011102</named-content>
        </funding-source>
        <award-id>FP7/2007-2013</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">European Research Council</named-content>
          <named-content content-type="funder-identifier">10.13039/100010663</named-content>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">PhD Fellowship of the Research Foundation—Flanders</named-content>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">FWO</named-content>
          <named-content content-type="funder-identifier">10.13039/501100003130</named-content>
        </funding-source>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="3"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec sec-type="intro">
    <title>1 Introduction</title>
    <p>In this era of whole-genome sequencing, many ancient whole-genome duplication (WGD) events have been uncovered across the eukaryotic tree of life (<xref rid="bty915-B8" ref-type="bibr">Van de Peer <italic>et al.</italic>, 2017</xref>). One of the main approaches for revealing ancient WGDs using genomic data is the construction of whole paranome <italic>K</italic><sub>S</sub> distributions (e.g. <xref rid="bty915-B1" ref-type="bibr">Blanc and Wolfe, 2004</xref>; <xref rid="bty915-B2" ref-type="bibr">Cui <italic>et al.</italic>, 2006</xref>; <xref rid="bty915-B3" ref-type="bibr">Lynch and Conery, 2000</xref>; <xref rid="bty915-B10" ref-type="bibr">Vanneste <italic>et al.</italic>, 2013</xref>), where <italic>K</italic><sub>S</sub> is the synonymous distance or the estimated number of synonymous substitutions per synonymous site. Under the assumption of neutral evolution at synonymous sites, the synonymous distance between two coding sequences serves as a proxy for the divergence time of two sequences. Under a model of continuous small-scale gene duplication (SSD) and loss of duplicated copies not under selection, a whole paranome <italic>K</italic><sub>S</sub> distribution is expected to show an exponential decay of the number of retained duplicates in function of age (<xref rid="bty915-B1" ref-type="bibr">Blanc and Wolfe, 2004</xref>; <xref rid="bty915-B3" ref-type="bibr">Lynch and Conery, 2000</xref>). Against this background of SSDs, large-scale duplication events, such as WGDs, are visible as peaks in the number of retained duplicates at a particular age.</p>
    <p>Several issues compromise the use of <italic>K</italic><sub>S</sub> distributions for WGD inference, and these were extensively addressed in <xref rid="bty915-B10" ref-type="bibr">Vanneste <italic>et al</italic>. (2013)</xref>. When high-quality genome assemblies are available, gene colinearity (often called synteny) based analyses may further aid in unveiling WGDs or large segmental duplications (<xref rid="bty915-B7" ref-type="bibr">Van de Peer, 2004</xref>). WGDs are expected to leave large blocks with high intragenomic colinearity, and paralogs located in such colinear segments (anchor pairs) can therefore be traced back more reliably to a particular event, enabling their use for downstream analyses such as molecular dating (<xref rid="bty915-B11" ref-type="bibr">Vanneste <italic>et al.</italic>, 2014</xref>) or functional analysis.</p>
    <p>While these methods have been used frequently in genomics research, no comprehensive and user-friendly software is available to perform these analyses, and researchers have often resorted to custom pipelines. Here, we fill this gap with an integrated suite for <italic>K</italic><sub>S</sub> and colinearity based analysis of ancient WGDs. We briefly discuss the methods implemented here, but refer to the documentation and <xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref> for more information.</p>
  </sec>
  <sec sec-type="materials|methods">
    <title>2 Materials and methods</title>
    <sec>
      <title>2.1 Gene family delineation</title>
      <p>Delineation of paralogous gene families and one-to-one orthologs starts from all-versus-all BLASTp similarity searches or precomputed BLAST results and is performed using ‘wgd mcl’. For whole paranome delineation, MCL (<xref rid="bty915-B9" ref-type="bibr">van Dongen, 2000</xref>) is then used to cluster sequences in paralogous gene families. One-to-one orthologs are determined using the commonly employed reciprocal best hit strategy.</p>
    </sec>
    <sec>
      <title>2.2 <italic>K</italic><sub>S</sub> distribution construction</title>
      <p>A <italic>K</italic><sub>S</sub> distribution for a set of paralogous families or one-to-one orthologs can be constructed using the ‘wgd ksd’ subcommand, and we closely follow the approach used by <xref rid="bty915-B10" ref-type="bibr">Vanneste <italic>et al</italic>. (2013)</xref>. We refrain from a full description of the methodology here and refer to the <xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref> instead.</p>
    </sec>
    <sec>
      <title>2.3 Colinearity analyses</title>
      <p>When high-quality structural genome annotations are available, the ‘wgd syn’ tool allows the identification of intragenomic colinear blocks and their corresponding anchor pairs using I-ADHoRe 3.0 (<xref rid="bty915-B5" ref-type="bibr">Proost <italic>et al.</italic>, 2012</xref>). Whole-genome syntenic dotplots are generated, and if a <italic>K</italic><sub>S</sub> distribution is provided, <italic>K</italic><sub>S</sub>-colored dotplots and anchor pair <italic>K</italic><sub>S</sub> distributions are generated (<xref ref-type="fig" rid="bty915-F1">Fig. 1</xref>).</p>
      <fig id="bty915-F1" orientation="portrait" position="float">
        <label>Fig. 1.</label>
        <caption>
          <p>Illustration of the various tools and visualizations in wgd. (<bold>A</bold>) <italic>Arabidopsis thaliana</italic> and <italic>Carica papaya</italic> paranome <italic>K</italic><sub>S</sub> distributions overlayed with the <italic>K</italic><sub>S</sub> distribution of anchor pairs for <italic>A. thaliana</italic> and <italic>K</italic><sub>S</sub> distribution of one-to-one orthologs of <italic>C. papaya</italic> and <italic>A. thaliana.</italic> (<bold>B</bold>) Mixture of three log-normal distributions fitted to the <italic>K</italic><sub>S</sub> distribution of <italic>A. thaliana</italic>, using the Variational Bayes algorithm with <italic>γ = </italic>10<sup>−3</sup>. (<bold>C</bold>) Plot showing the probability to belong to a particular component of the mixture shown in (B) in function of <italic>K</italic><sub>S.</sub> These probabilities can be used to define component-wise paralogs for further downstream analyses. (<bold>D</bold>) <italic>K</italic><sub>S</sub>-colored dotplot for <italic>A. thaliana</italic>, showing colinear blocks identified by I-ADHoRe, colored by their median <italic>K</italic><sub>S</sub> value. (<bold>E</bold>) Interactive histogram visualization (user interface not shown, see <xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S1</xref>), showing the whole paranome <italic>K</italic><sub>S</sub> distributions using histograms and kernel density estimates for <italic>A. thaliana</italic> and <italic>C. papaya</italic> together with the <italic>K</italic><sub>S</sub> distribution of one-to-one orthologs in these species. We refer to the <xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref> for detailed methods</p>
        </caption>
        <graphic xlink:href="bty915f1"/>
      </fig>
    </sec>
    <sec>
      <title>2.4 Kernel density estimation and mixture modeling</title>
      <p>Downstream analyses of <italic>K</italic><sub>S</sub> distributions have often consisted in fitting statistical models and visualizing these. We provide tools (‘wgd kde’) for fitting kernel density estimates (KDEs). Importantly, we apply a correction for boundary effects, which are often neglected but may lead to artificial peaks in low <italic>K</italic><sub>S</sub> regions. As peaks derived from WGDs are expected to be approximately log-normally distributed, Gaussian mixture models (GMMs) have also been used frequently to analyze <italic>K</italic><sub>S</sub> distributions. We provide tools (‘wgd mix’) for fitting mixtures of log-normal components using different inference algorithms, implemented using the scikit-learn python library (<xref rid="bty915-B4" ref-type="bibr">Pedregosa <italic>et al.</italic>, 2011</xref>). Common approaches to determine the optimal number of components are provided, using the Akaike or Bayesian information criterion, however we would like to warn prospective users to carefully interpret ‘significant’ components, as these GMMs may strongly overfit the empirical distribution (<xref rid="bty915-B6" ref-type="bibr">Tiley <italic>et al.</italic>, 2018</xref>).</p>
    </sec>
    <sec>
      <title>2.5 Interactive visualization</title>
      <p>Lastly, we provide tools for (interactive) visualization of histograms and KDEs in ‘wgd viz’ (<xref ref-type="fig" rid="bty915-F1">Fig. 1</xref>). These tools allow visualization of multiple <italic>K</italic><sub>S</sub> distributions for comparative purposes as well as modification of key visualization parameters such as the histogram bin-width or the KDE bandwidth. We encourage researchers to modify and explore the influence of these to guide careful analysis of the distributions and to prevent misinterpretations of KDE or histogram artifacts as biologically interesting features.</p>
    </sec>
  </sec>
  <sec sec-type="conclusions">
    <title>3 Conclusion</title>
    <p>We provide, to our knowledge, the first comprehensive toolshed for <italic>K</italic><sub>S</sub> and colinearity based analysis of WGDs in an easy to use and freely available package named wgd. We hope that, besides being a useful tool for researchers, it will also aid in preventing common pitfalls and misinterpretations when analyzing putative WGDs in genomic data.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>This work was supported by the European Union Seventh Framework Programme (FP7/2007-2013) under European Research Council Advanced Grant Agreement 322739—DOUBLEUP [to Y.V.d.P]; and a PhD Fellowship of the Research Foundation—Flanders (FWO) [to A.Z.].</p>
    <p><italic>Conflict of Interest</italic>: none declared.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="sup1">
      <label>bty915_Supplementary_Data</label>
      <media xlink:href="bty915_supplementary_data.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ref-list id="REF1">
    <title>References</title>
    <ref id="bty915-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Blanc</surname><given-names>G.</given-names></name>, <name name-style="western"><surname>Wolfe</surname><given-names>K.H.</given-names></name></person-group> (<year>2004</year>) 
<article-title>Widespread paleopolyploidy in model plant species inferred from age distributions of duplicate genes</article-title>. <source>Plant Cell</source>, <volume>16</volume>, <fpage>1667</fpage>–<lpage>1678</lpage>.<pub-id pub-id-type="pmid">15208399</pub-id></mixed-citation>
    </ref>
    <ref id="bty915-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Cui</surname><given-names>L.</given-names></name><etal>et al</etal></person-group> (<year>2006</year>) 
<article-title>Widespread genome duplications throughout the history of flowering plants</article-title>. <source>Genome Res.</source>, <volume>16</volume>, <fpage>738</fpage>–<lpage>749</lpage>.<pub-id pub-id-type="pmid">16702410</pub-id></mixed-citation>
    </ref>
    <ref id="bty915-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Lynch</surname><given-names>M.</given-names></name>, <name name-style="western"><surname>Conery</surname><given-names>J.S.</given-names></name></person-group> (<year>2000</year>) 
<article-title>The evolutionary fate and consequences of duplicate genes</article-title>. <source>Science</source>, <volume>290</volume>, <fpage>1151</fpage>–<lpage>1155</lpage>.<pub-id pub-id-type="pmid">11073452</pub-id></mixed-citation>
    </ref>
    <ref id="bty915-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Pedregosa</surname><given-names>F.</given-names></name><etal>et al</etal></person-group> (<year>2011</year>) 
<article-title>Scikit-learn: machine learning in Python</article-title>. <source>J. Mach. Learn. Res.</source>, <volume>12</volume>, <fpage>2825</fpage>–<lpage>2830</lpage>.</mixed-citation>
    </ref>
    <ref id="bty915-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Proost</surname><given-names>S.</given-names></name><etal>et al</etal></person-group> (<year>2012</year>) 
<article-title>i-ADHoRe 3.0: fast and sensitive detection of genomic homology in extremely large data sets</article-title>. <source>Nucleic Acids Res.</source>, <volume>40</volume>, <fpage>e11</fpage>.<pub-id pub-id-type="pmid">22102584</pub-id></mixed-citation>
    </ref>
    <ref id="bty915-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Tiley</surname><given-names>G.P.</given-names></name><etal>et al</etal></person-group> (<year>2018</year>) 
<article-title>Assessing the performance of Ks plots for detecting ancient whole genome duplications</article-title>. <source>Genome Biol. Evol.</source>, <volume>10</volume>, <fpage>2882</fpage>–<lpage>2898</lpage>. <pub-id pub-id-type="pmid">30239709</pub-id></mixed-citation>
    </ref>
    <ref id="bty915-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Van de Peer</surname><given-names>Y.</given-names></name></person-group> (<year>2004</year>) 
<article-title>Computational approaches to unveiling ancient genome duplications</article-title>. <source>Nat. Rev. Genet.</source>, <volume>5</volume>, <fpage>752</fpage>–<lpage>763</lpage>.<pub-id pub-id-type="pmid">15510166</pub-id></mixed-citation>
    </ref>
    <ref id="bty915-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Van de Peer</surname><given-names>Y.</given-names></name><etal>et al</etal></person-group> (<year>2017</year>) 
<article-title>The evolutionary significance of polyploidy</article-title>. <source>Nat. Rev. Genet.</source>, <volume>18</volume>, <fpage>411</fpage>–<lpage>424</lpage>.<pub-id pub-id-type="pmid">28502977</pub-id></mixed-citation>
    </ref>
    <ref id="bty915-B9">
      <mixed-citation publication-type="thesis"><person-group person-group-type="author"><name name-style="western"><surname>van Dongen</surname><given-names>S.</given-names></name></person-group> (<year>2000</year>) <source>Graph Clustering by Flow Simulation</source>. <comment>PhD Thesis, University of Utrecht, Utrecht, The Netherlands</comment>.</mixed-citation>
    </ref>
    <ref id="bty915-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Vanneste</surname><given-names>K.</given-names></name><etal>et al</etal></person-group> (<year>2013</year>) 
<article-title>Inference of genome duplications from age distributions revisited</article-title>. <source>Mol. Biol. Evol.</source>, <volume>30</volume>, <fpage>177</fpage>–<lpage>190</lpage>.<pub-id pub-id-type="pmid">22936721</pub-id></mixed-citation>
    </ref>
    <ref id="bty915-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Vanneste</surname><given-names>K.</given-names></name><etal>et al</etal></person-group> (<year>2014</year>) 
<article-title>Analysis of 41 plant genomes supports a wave of successful genome duplications in association with the Cretaceous-Paleogene boundary</article-title>. <source>Genome Res.</source>, <volume>24</volume>, <fpage>1334</fpage>–<lpage>1347</lpage>.<pub-id pub-id-type="pmid">24835588</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
