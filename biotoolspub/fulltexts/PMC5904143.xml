<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Nat Commun</journal-id>
    <journal-id journal-id-type="iso-abbrev">Nat Commun</journal-id>
    <journal-title-group>
      <journal-title>Nature Communications</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2041-1723</issn>
    <publisher>
      <publisher-name>Nature Publishing Group UK</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">5904143</article-id>
    <article-id pub-id-type="publisher-id">3933</article-id>
    <article-id pub-id-type="doi">10.1038/s41467-018-03933-2</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>A geometric approach to characterize the functional identity of single cells</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-8734-2326</contrib-id>
        <name>
          <surname>Mohammadi</surname>
          <given-names>Shahin</given-names>
        </name>
        <address>
          <email>mohammadi@broadinstitute.org</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ravindra</surname>
          <given-names>Vikram</given-names>
        </name>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Gleich</surname>
          <given-names>David F.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Grama</surname>
          <given-names>Ananth</given-names>
        </name>
        <address>
          <email>ayg@purdue.cs.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2341 2786</institution-id><institution-id institution-id-type="GRID">grid.116068.8</institution-id><institution>Computer Science and Artificial Intelligence Laboratory, </institution><institution>MIT, </institution></institution-wrap>Cambridge, MA 02139 USA </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.66859.34</institution-id><institution>Broad Institute of MIT and Harvard, </institution></institution-wrap>Cambridge, MA 02142 USA </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 1937 2197</institution-id><institution-id institution-id-type="GRID">grid.169077.e</institution-id><institution>Department of Computer Science, </institution><institution>Purdue University, </institution></institution-wrap>West Lafayette, IN 47907 USA </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>17</day>
      <month>4</month>
      <year>2018</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>17</day>
      <month>4</month>
      <year>2018</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2018</year>
    </pub-date>
    <volume>9</volume>
    <elocation-id>1516</elocation-id>
    <history>
      <date date-type="received">
        <day>17</day>
        <month>2</month>
        <year>2017</year>
      </date>
      <date date-type="accepted">
        <day>20</day>
        <month>3</month>
        <year>2018</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2018</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The images or other third party material in this article are included in the article’s Creative Commons license, unless indicated otherwise in a credit line to the material. If material is not included in the article’s Creative Commons license and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this license, visit <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1">Single-cell transcriptomic data has the potential to radically redefine our view of cell-type identity. Cells that were previously believed to be homogeneous are now clearly distinguishable in terms of their expression phenotype. Methods for automatically characterizing the functional identity of cells, and their associated properties, can be used to uncover processes involved in lineage differentiation as well as sub-typing cancer cells. They can also be used to suggest personalized therapies based on molecular signatures associated with pathology. We develop a new method, called ACTION, to infer the functional identity of cells from their transcriptional profile, classify them based on their dominant function, and reconstruct regulatory networks that are responsible for mediating their identity. Using ACTION, we identify novel Melanoma subtypes with differential survival rates and therapeutic responses, for which we provide biomarkers along with their underlying regulatory networks.</p>
    </abstract>
    <abstract id="Abs2" abstract-type="web-summary">
      <p id="Par2">Functional characterisation of single cells is crucial for uncovering the true extent of cellular heterogeneity. Here the authors offer an approach to infer functional identities of cells from their transcriptomes, identify their dominant function, and reconstruct the underlying regulatory networks.</p>
    </abstract>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2018</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1" sec-type="introduction">
    <title>Introduction</title>
    <p id="Par3">Complex tissues typically consist of heterogeneous populations of interacting cells that are specialized to perform different functions. A cell’s functional identity is a quantitative measure of its specialization in performing a set of primary functions. The functional space of cells is then defined as space spanned by these primary functions, and equivalently, the functional identity is a coordinate in this space. Recent advances in single-cell technologies have greatly expanded our view of the functional identity of cells. Cells that were previously believed to constitute a homogeneous group are now recognized as an ecosystem of cell types<sup><xref ref-type="bibr" rid="CR1">1</xref></sup>. Within the tumor microenvironment, for example, the exact composition of these cells, as well as their molecular makeup, have a significant impact on diagnosis, prognosis, and treatment of cancer patients<sup><xref ref-type="bibr" rid="CR2">2</xref></sup>.</p>
    <p id="Par4">The functional identity of each cell is closely associated with its underlying type<sup><xref ref-type="bibr" rid="CR3">3</xref></sup>. A number of methods have been proposed to directly identify cell types from the transcriptional profiles of single cells<sup><xref ref-type="bibr" rid="CR4">4</xref>–<xref ref-type="bibr" rid="CR9">9</xref></sup>. The majority of these methods rely on classical measures of distance between transcriptional profiles to establish cell types and their relationships. However, these measures fail to capture weakly expressed, but highly cell-type-specific genes<sup><xref ref-type="bibr" rid="CR10">10</xref></sup>. They often require user-specified parameters, such as the underlying number of cell types, which critically determine their performance. Finally, once the identity of a cell has been established using these methods, it is often unclear what distinguishes one cell type from others in terms of the associated functions.</p>
    <p id="Par5">To address these issues, we propose a new method, called archetypal-analysis for cell-type identification (ACTION), for identifying cell types, establishing their functional identity, and uncovering underlying regulatory factors from single-cell expression datasets. A key element of ACTION is a biologically inspired metric for capturing cell similarities. The idea behind our approach is that the transcriptional profile of a cell is dominated by universally expressed genes, whereas its functional identity is determined by a set of weak, but preferentially expressed genes. We use this metric to find a set of candidate cells to represent characteristic sets of primary functions, which are associated with specialized cells. For the rest of the cells, that perform multiple tasks, they face an evolutionary trade-off—they cannot be optimal in all those tasks, but they attain varying degrees of efficiency<sup><xref ref-type="bibr" rid="CR11">11</xref></sup>. We implement this concept by representing the functional identity of cells as a convex combination of the primary functions. Finally, we develop a statistical framework for identifying key marker genes for each cell type, as well as transcription factors that are responsible for mediating the observed expression of these markers. We use these regulatory elements to construct cell-type-specific transcriptional regulatory networks (TRN).</p>
    <p id="Par6">We show that the ACTION metric effectively represents known functional relationships between cells. Using the dominant primary function of each cell to estimate its putative cell type, ACTION outperforms state-of-the-art methods for identifying cell types. Furthermore, we report on a case study of cells collected from the tumor microenvironment of 19 melanoma patients<sup><xref ref-type="bibr" rid="CR12">12</xref></sup>. We identify two novel, phenotypically distinct subclasses of <italic>MITF</italic>-high patients, for which we construct the TRN and identify regulatory factors that mediate their function. These factors provide novel biomarkers, as well as potential therapeutic targets for future development.</p>
  </sec>
  <sec id="Sec2" sec-type="results">
    <title>Results</title>
    <p id="Par7">The ACTION framework consists of three major components, shown in Fig. <xref rid="Fig1" ref-type="fig">1</xref>: (i) a robust, yet sensitive measure of cell-to-cell similarity, (ii) a geometric approach for identification of primary functions, and (iii) a statistical framework for constructing cell-type-specific TRN. Our framework starts by defining a cell similarity metric that simultaneously suppresses the shared, but highly expressed genes and enhances the signal contributed by preferentially expressed markers. The next component of our method is a geometric approach for identifying primary functions of cells. Each of these primary functions is represented by a corner of the convex hull of points defined within the functional space of cells. We refer to these corners as archetypes and the functional identity of each cell is represented by a convex combination of these archetypes. Finally, ACTION uses a novel method to orthogonalize archetypes, find key marker genes, and assess the significance of each transcriptional factor in mediating the transcriptional phenotype associated with each archetype. Finally, we use this method to construct the characteristic TRN of each cell type. In what follows, we describe, validate, and discuss each component in detail.<fig id="Fig1"><label>Fig. 1</label><caption><p>Overview of ACTION. ACTION consists of five main steps: <bold>i</bold> A biologically inspired metric to capture similarity among cells. <bold>ii</bold> A geometric approach for identifying the set of primary functions. <bold>iii</bold> An automated mechanism for identifying the number of primary functions needed to represent all cells. <bold>iv</bold> An orthogonalization procedure for identifying key markers for each primary function. <bold>v</bold> A statistical approach for identifying key regulatory elements in the transcriptional regulatory network. These steps are grouped into three main components in the ACTION method that are each discussed in the methods section</p></caption><graphic xlink:href="41467_2018_3933_Fig1_HTML" id="d29e314"/></fig></p>
    <sec id="Sec3">
      <title>Representing functional relationships between single cells</title>
      <p id="Par8">A fundamental component of many methods for identifying cell types is a measure for quantifying the similarity between individual cells. Most prior methods rely on traditional measures, such as linear correlation, which are not specifically targeted towards transcriptomic profiles. In contrast, we define a similarity metric, or formally a kernel, specifically designed for measuring the similarity between single-cell transcriptomes<sup><xref ref-type="bibr" rid="CR10">10</xref></sup>. Our approach is illustrated in Fig. <xref rid="Fig2" ref-type="fig">2</xref> and the mathematical models underlying the metric are described in the Methods section, Computing ACTION metric. In summary, we first adjust the raw transcriptional profiles of cells to remove the effect of universally expressed genes by projecting them onto the orthogonal space relative to the universally expressed profile. We then boost the contribution of cell-type-specific genes using an information theoretic approach. The final similarity is then a weighted inner-product kernel between these adjusted profiles.<fig id="Fig2"><label>Fig. 2</label><caption><p>Workflow of ACTION cell-to-cell similarity metric. Computation of the ACTION metric consists of three main steps. i The effect of universally expressed genes is masked out to construct an adjusted transcriptional profile. ii A gene expression specificity vector is computed that assigns weights to each gene based on its informativeness. iii The ACTION kernel is computed as the weighted dot product of adjusted transcriptional vectors</p></caption><graphic xlink:href="41467_2018_3933_Fig2_HTML" id="d29e335"/></fig></p>
      <p id="Par9">To establish the superiority of our metric, we compare it against an alternate measure specifically designed for single-cell analysis, SIMLR<sup><xref ref-type="bibr" rid="CR13">13</xref></sup>. SIMLR combines a number of distance metrics to learn a joint similarity score that maximizes the block diagonal structure of the resulting matrix. We also compare ACTION with the normalized dot product resulting from two nonlinear dimension-reduction techniques: multidimensional scaling (MDS) and Isomap. While ACTION is a non-parametric method, the other methods have one or more parameters that need to be specified by the user. For SIMLR, we need to specify the true number of cell types. For all methods other than ACTION, we must specify the dimension of the low-dimensional subspace. To give them the best chance at competing with ACTION, we evaluate ten different values for the dimension of projected subspace (from 5 to 50 with increments of 5) and report the best results obtained over all configurations.</p>
      <p id="Par10">To assess the quality of computed similarities between cells, we used each metric with kernel <italic>k</italic>-means, starting from 100 different initializations, in order to comprehensively assess their ability to identify discrete cell types. We apply this technique to four different datasets (see Methods, Datasets). These datasets are derived from different single-cell technologies, have hundreds to thousands of cells, and span a wide range of normal and cancerous cells. We compare the predicted cell types against the annotated cell types in the original dataset using three different measures, namely Adjusted Rand Index (ARI), F-score, and Normalized Mutual Information (NMI).</p>
      <p id="Par11">Figure <xref rid="Fig3" ref-type="fig">3</xref> present the performance of the cell-type identification technique when operating with different similarity measures. Our results demonstrate that in all cases the ACTION metric either outperforms or is jointly the best among competing metrics, except in the Brain dataset in which case SIMLR performs better when looking at all measures combined. A detailed analysis of the underlying distributions and the significance of differences among the top-ranked vs. the runner-up methods is provided in the Supplementary Note <xref rid="MOESM1" ref-type="media">3</xref>. Additionally, for the CellLines dataset, which is specifically designed to evaluate cell-type identification methods, we report the heatmap of marker genes for identified cell types to facilitate the visual assessment of the clustering differences, which is also available in Supplementary Note <xref rid="MOESM1" ref-type="media">4</xref>.<fig id="Fig3"><label>Fig. 3</label><caption><p>Performance of ACTION Similarity Metric. Various extrinsic measures of clustering quality for different cell similarity scores. <bold>a</bold> Adjusted Rand Index (ARI), <bold>b</bold> F-score, and <bold>c</bold> Normalized Mutual Information (NMI). All of these measures are upper-bounded by one with larger values indicating better results. The results in the table are the mean value over 100 individual runs of kernel k-means clustering with different initializations. The ACTION metric has no tunable parameters. For the other methods, we tested a range of parameters and report the best results. For each dataset, the corresponding row has been color-coded such that the darker green indicates better performance. Except for the Brain dataset, ACTION is either the best, or jointly the best. For Brain, the SIMLR metric is slightly better in an aggregation over all three measures</p></caption><graphic xlink:href="41467_2018_3933_Fig3_HTML" id="d29e375"/></fig></p>
      <p id="Par12">To assess whether ACTION kernel can extract weak cell-type-specific signals with increasing levels of dropout, we focus on the CellLines dataset that is specifically assayed to evaluate different cell-type identification methods. We created a series of simulated expression profiles, seeded on the CellLines dataset, to mimic different levels of dropout. We iteratively removed nonzero elements at random, with the probability of removal being inversely proportional to the expression value, following previous work<sup><xref ref-type="bibr" rid="CR14">14</xref></sup>. More specifically, the probability of removing each element is (1)/(2<sup>6<italic>x</italic></sup>), where <italic>x</italic> is the expression value. For each case, we generated 10 independent replicas and used each of them to compute different cell similarity metrics. Finally, we used each metric with kernel k-means and traced changes in the quality of clustering, which is presented in Fig. <xref rid="Fig4" ref-type="fig">4</xref>. The ACTION method has the most stable behavior (RSS of the linear fit) with a minor downward trend as density goes below 10%. Furthermore, in each data point, ACTION has lower variation among different replicas. Other methods start to fluctuate unpredictably when density goes below 15%.<fig id="Fig4"><label>Fig. 4</label><caption><p>ACTION Kernel Robustness. A series of expression profiles with varying degrees of dropout has been simulated from the CellLines dataset. In each case, we compute different metrics and use kernel k-means to identify cell types. The quality of cell-type identification is assessed with respect to known annotation from the original paper using three different extrinsic measures: <bold>a</bold> Adjusted Rand Index (ARI), <bold>b</bold> F-score, and <bold>c</bold> Normalized Mutual Information (NMI). These results show that ACTION and MDS have the most stable performance over dropout. Error bars correspond to repeated samples of perturbed expression profiles</p></caption><graphic xlink:href="41467_2018_3933_Fig4_HTML" id="d29e410"/></fig></p>
      <p id="Par13">Overall, these results establish the ACTION metric as a fast, non-parametric, and accurate method for computing similarity among single cells. We use this measure throughout the rest of our study.</p>
    </sec>
    <sec id="Sec4">
      <title>Uncovering functional identity of single cells</title>
      <p id="Par14">Using the ACTION metric as a measure of similarity between cells, we develop a new method for characterizing the functional identity of cells in a given experiment. Our method is based on a geometric interpretation of cellular functions. In this view, each cell corresponds to a data-point in a high-dimensional space. Our method identifies 'extreme' corners, or archetypes in this space, each of which represents a primary function. The functional identity of each cell is subsequently characterized as a convex combination of these primary functions. (A convex combination is a linear combination of points, such that all coefficients are non-negative and sum to 1.) The choice of the number of primary functions or archetypes is based on a novel non-parametric statistical procedure. See Methods section, Characterizing the functional space, for a detailed description.</p>
      <p id="Par15">To approximate discrete cell types from the primary functions identified using ACTION, we assigned each cell to a single dominant function, as determined by its closest archetype. We compare our method to five recently proposed methods: Seurat (v2.2)<sup><xref ref-type="bibr" rid="CR15">15</xref></sup>, SNNCliq<sup><xref ref-type="bibr" rid="CR7">7</xref></sup>, BackSPIN<sup><xref ref-type="bibr" rid="CR16">16</xref></sup>, single-cell ParTI<sup><xref ref-type="bibr" rid="CR8">8</xref>,<xref ref-type="bibr" rid="CR17">17</xref></sup>, and TSCAN<sup><xref ref-type="bibr" rid="CR9">9</xref></sup> (Supplementary Note <xref rid="MOESM1" ref-type="media">1</xref>) to predict annotated cell types on the same four datasets (see Methods, Datasets). For the Melanoma dataset, SNNCliq did not terminate after 72 h, after which we stopped the experiment.</p>
      <p id="Par16">We report the results of each method applied to each dataset. In addition, to further validate these results, we select 90% of cells in each dataset, proportional to the total cell-type counts, and run each method on each of these 10-folds, and report mean and standard deviation of these results. In all cases, we observe that ACTION performs as well or better than the other methods (Fig. <xref rid="Fig5" ref-type="fig">5</xref>). For the Melanoma dataset, however, there is no consensus among the top-ranked methods. This can be attributed, in part, to the extent of available annotations in this dataset and the varying resolution of different methods. We further investigate our results on this dataset in the following sections.<fig id="Fig5"><label>Fig. 5</label><caption><p>Performance of ACTION in identifying discrete cell types. ACTION identifies cell types by classifying cells according to their dominant primary function (closest archetype). Performance is measured via various measures with respect to the cell types provided with the data: <bold>a</bold> Adjusted Rand Index (ARI), <bold>b</bold> F-score, and <bold>c</bold> Normalized Mutual Information (NMI) of cell-type identification. Larger values are better, and the perfect score (upper bound) is one. Lighter shades are the actual results when using all cells/ samples, whereas the darker bar and the error bar indicates the standard error in a 10-fold test to estimate the variability and stability of predictions for each method. In the CellLines dataset, which was originally created to benchmark cell-type identification methods, ACTION outperforms other methods with respect to ARI and NMI measures, and ties with Seurat in terms of F-score. In the MouseBrain dataset, ACTION significantly outperforms other methods in all three measures. In the Brain datasets there is a competition between ACTION and Seurat, whereas in the Melanoma there is more variability among different methods. This is particularly associated with the level of annotations in this dataset (lack of annotations for T-cell subclasses and tumor subtypes, for example) and the varying resolution of different methods</p></caption><graphic xlink:href="41467_2018_3933_Fig5_HTML" id="d29e469"/></fig></p>
      <p id="Par17">In terms of computational time, graph-based techniques, such as SNNCliq and Seurat, perform better than ACTION for smaller datasets; however, ACTION scales more gracefully as the size of the dataset increases (see Supplementary Note <xref rid="MOESM1" ref-type="media">8</xref> for the details). Also, an example heatmap for the results of the CellLines dataset is provided in the Supplementary Note <xref rid="MOESM1" ref-type="media">5</xref> for an illustration of the benefits of our approach.</p>
      <p id="Par18">In Supplementary Note <xref rid="MOESM1" ref-type="media">9</xref>, we study the robustness of ACTION in presence of noise and outliers, as well as its sensitivity to identify rare cell types. We found that preconditioning the adjusted expression profiles significantly enhances the accuracy of predictions, while relaxing the pure pixel assumption further stabilizes these predictions. Furthermore, we show that our method is sensitive enough to identify rare cell types with 2% of the total population. Below this population, they are characterized as noise and outlier cells.</p>
      <p id="Par19">Overall, these experiments show that ACTION, while designed to explore the continuous functional space of cells, is successful in identifying discrete cell types as stable states in this space.</p>
      <p id="Par20">While the functional identities of cells can be discretized to define cell types, they can also be explored in the continuous space of all primary functions. To illustrate this continuous view, we perform a case study on the Melanoma dataset (Fig. <xref rid="Fig6" ref-type="fig">6</xref>). Each point corresponds to a cell. Given the functional profile of cells, defined in a <italic>k</italic>-dimensional space, with <italic>k</italic> being the number of archetypes, we map cells to a two-dimensional plane using the Stochastic Neighbor Embedding (SNE) method with a deterministic initialization (see Supplemental Note <xref rid="MOESM1" ref-type="media">10</xref>). Our non-parametric method selected 8 archetypes for the Melanoma data, each is marked with a text label (A1, …, A8) and assigned a unique color. We interpolate the color of each cell using its distance from all archetypes to highlight the continuous nature of the data. We use markers from LM22 dataset<sup><xref ref-type="bibr" rid="CR18">18</xref></sup> to distinguish different subtypes of T-cells. For the tumor cells, we perform further analysis of active transcription factors, as described in the next section and the methods section, to identify key driving regulators that distinguish each archetype.<fig id="Fig6"><label>Fig. 6</label><caption><p>A continuous view on the space of primary functions in the Melanoma dataset. Each archetype, representing a primary function, is illustrated using a textual label (A1–A8). Each small dot represents a cell. Cells are color-coded based on their proximity to archetypes. All data points are projected onto a 2D plane using a carefully initialized Stochastic Neighbor Embedding method (SNE, see Supplementary Note <xref rid="MOESM1" ref-type="media">10</xref>). The functional space of cells exhibit a mix of cell state continuum, such as in the case of T-cells, as well as discrete cell types. Three subclasses of melanoma tumor cells are marked accordingly in the map. Subclasses B and C are both MITF-associated. Among them, genes that participate in the transcriptional regulatory network (TRN) for subclass B do not show any significant shift in Cox coefficient, compared to the background of all genes, whereas in subclass C they do. In this sense, high-expression of genes in the TRN of subclass C is significantly associated with worse outcome in the melanoma patients</p></caption><graphic xlink:href="41467_2018_3933_Fig6_HTML" id="d29e515"/></fig></p>
      <p id="Par21">Figure <xref rid="Fig6" ref-type="fig">6</xref> demonstrates the ability of our method to identify both isolated cell types with specialized primary functions, as well as the ones with a mixed combination of functions. As an example, T-cells constitute a continuous spectrum across functional space of cells, which is consistent with previous studies<sup><xref ref-type="bibr" rid="CR19">19</xref></sup>. Subclasses of melanoma cells, on the other hand, exhibit distinct separation and have unique phenotypic behaviors and survival rates. In what follows, we identify key marker genes for each subclass, transcription factors that are significantly associated with regulating these genes, and construct their gene regulatory network.</p>
    </sec>
    <sec id="Sec5">
      <title>Constructing cell-type-specific regulatory networks</title>
      <p id="Par22">We present a new method for constructing regulatory pathways responsible for mediating the phenotypes associated with each archetype. We first perform an archetype orthogonalization to compute a residual expression and identify marker genes that are unique to each archetype. We then assess the role of each transcription factor (TF) in controlling these marker genes. Significant TFs, together with their top-ranked target genes (TGs), constitute the underlying TRN that is responsible for mediating a given primary function, and consequently, the phenotype associated with cells dominantly associated with that function (see Methods, Constructing the TRN, and Fig. <xref rid="Fig7" ref-type="fig">7a</xref> for additional details).<fig id="Fig7"><label>Fig. 7</label><caption><p>The transcriptional regulatory network (TRN) for MITF-associated Melanoma patients highlights a number of genes that have not previously been associated with Melanoma—along with some known markers. <bold>a</bold> Main steps involved in the construction of archetype-specific TRNs: (1) Orthogonalize archetypes with respect to each other, (2) Sort genes based on their residual expression, (3) Map gene targets for TFs to the sorted list genes, (4) Enrichment analysis for fixed cut size <italic>l</italic>, (5) Find optimal cut size and compute minimum HyperGeometric (mHG) score, and (6) Assess significance of the mHG score using Dynamic Programming (DP). <bold>b</bold> A subset of the TRN of subclass A induced by using only the most significant TFs. The yellow nodes are transcription factors (TF), the purple nodes are target genes (TG), and green nodes are target genes that bridge different TFs. Genes marked with black border are known to be involved in the proliferative subclass of Melanoma. <bold>c</bold> The TRN of subclass A with genes color-coded according to their Cox coefficient. Red genes are the ones whose high expression is associated with worse outcome, and brightness of the color relates to the severity of the outcome. Kaplan–Meier plots for two of the targets of MITF that are unique to subclass A, but not subclass C are shown on the plot</p></caption><graphic xlink:href="41467_2018_3933_Fig7_HTML" id="d29e553"/></fig></p>
      <p id="Par23">To evaluate the quality of top-ranked genes identified after orthogonalizing each archetype, we selected the top 20 genes and marked the ones that are known markers (according to the original paper) for the cell-type that is enriched for the archetype. Supplementary Note <xref rid="MOESM1" ref-type="media">11</xref> presents a complete table of these top-ranked genes, where known marker genes are in bold typeface. Upon initial observation, a large fraction of these genes appear to be associated with known markers. To systematically assess the significance of this event, we created a label vector for each archetype according to its sorted list of genes after orthogonalization. Then, we use mHG <italic>p</italic>-value to assess the enrichment of markers among top-ranked genes, which are presented in the last row in the table. It is notable that all archetypes are highly significant with respect to the enrichment of marker genes among their top-ranked residual genes, with the exception of CD4 T-cell and tumor subclass A. After further examination, we observed that the majority of T-cell markers provided in the paper are for CD8 T-cell and provided tumor markers in this dataset are for MITF over-expressed melanoma tumors. Thus, the corresponding columns have less significant results that the others.</p>
      <p id="Par24">Next, to distinguish different subclasses of tumor cells, we computed the TFs that are significantly associated with regulating the top-ranked marker genes for each archetype, as well as the particular subset of TGs that they regulate. We found that both subclasses B and C are associated with SOX10 and MITF, two of the most well-characterized markers for 'proliferative' melanoma tumors<sup><xref ref-type="bibr" rid="CR20">20</xref></sup>. Further analysis of these factors, however, reveals that while both of these subclasses are MITF-associated, the degree of association is higher for subclass C. Examining downstream targets of MITF that are activated in each subclass (see Supplementary Note <xref rid="MOESM1" ref-type="media">12</xref>), we identified that GPNMB, MLANA, PMEL, and TYR are shared between two subclasses, whereas ACP5, CDK2, CTSK, DCT, KIT, OCA2, and TRPM1/P1 are unique to subclass C. To validate these targets, we used a comprehensive list of downregulated genes in response to MITF knockdown in 501Mel melanoma cells<sup><xref ref-type="bibr" rid="CR21">21</xref></sup>. The overlap of identified MITF TGs and the set of downregulated targets was significant for subclasses B and C (hypergeometric test <italic>p</italic>-values of 7.5 × 10<sup>−5</sup> and 1 × 10<sup>−6</sup>, respectively). This further validates that our method is identifying not only the right TFs, but also the right set of TGs for them. Among other distinguishing TFs, subclass B is significantly associated with BRCA1 and TP53, whereas subclass C is associated with MYC. Factors BRCA1 and TP53 are both tumor-suppressors, whereas MYC is a proto-oncogene. Activation of these transcriptional factors, in turn, can differentially regulate downstream targets that may contribute to worse outcome in subclass C.</p>
      <p id="Par25">Based on these observations, we propose the hypothesis that subclass C should have worse outcome than subclass B. To support this hypothesis, we construct subclass-specific TRN for these two subclasses. The set of TFs in these networks have a total of 51 and 91 distinct TGs, respectively, that are functionally active. In order to understand how the difference among these genes contribute to the overall survival of patients, we assessed the association between identified genes in each network and survival rate of Melanoma patients in the TCGA dataset, measured via multivariate Cox regressions<sup><xref ref-type="bibr" rid="CR22">22</xref></sup>. We note that genes in subclass C significantly deviate from the null distribution of Cox coefficients for all genes (Kolmogorov–Smirnov test; <italic>p</italic>-value = 5.4 × 10<sup>−10</sup>), whereas genes in subclass B do not (<italic>p</italic>-value = 0.31), which translates into worse prognosis for subclass C. These observations are summarized in Fig. <xref rid="Fig6" ref-type="fig">6</xref>.</p>
      <p id="Par26">To further study the underlying regulatory mechanisms that drive this poor-outcome phenotype for subclass C, we focus on only the most significant TFs (those with functional activity <italic>p</italic>-values ≤10<sup>−3</sup>, rather than ≤0.05 above) and construct their associated regulatory network. Figure <xref rid="Fig7" ref-type="fig">7a</xref> shows the interaction network among highly significant TFs and their major targets in subclass C. While some of these factors, and their TGs, were previously directly or implicitly associated with Melanoma, this network provides a novel systems view of the interactions, and highlights new regulatory interactions. For instance, amplification of the MYC oncogene has been long associated with poor-outcome in Melanoma patients<sup><xref ref-type="bibr" rid="CR23">23</xref></sup>. Also, E2F1 is a critical TF that is involved in cell cycle transition from G1 to S phase, and its overexpression is commonly associated with poor patient survival in high-grade tumors<sup><xref ref-type="bibr" rid="CR24">24</xref></sup>. The LEF1 factor has a dual role. On one hand, it acts as a downstream effector of the Wnt signaling pathway and is associated with phenotype switching in Melanoma cells between proliferative and invasive states<sup><xref ref-type="bibr" rid="CR25">25</xref></sup>. On the other hand, it has been suggested that LEF1 has a distinct, Wnt-independent, role in activating E2F1<sup><xref ref-type="bibr" rid="CR26">26</xref></sup>. Finally, we note that LEF1 regulates both MITF and MYC. Collectively, we hypothesize that LEF1 is a key TF that regulates phenotype switching from proliferative to invasive state in subclass C, by controlling other TFs, including MITF, MYC, and E2F1.</p>
      <p id="Par27">To revisit the problem of survival analysis, and to recover genes that affect this prognostic change, we project individual Cox coefficients for each gene onto the TRN of subclass C (Fig. <xref rid="Fig7" ref-type="fig">7b</xref>). Two of the most significantly associated genes, <italic>KIT</italic> and <italic>OCA2</italic>, are among <italic>MITF</italic> targets that are unique to subclass C, but not subclass B. The Kaplan–Meier plots for these two genes are visualized alongside the TRN. In addition, there are multiple targets of MYC, LEF1, and E2F1 that are also associated with poor outcomes for melanoma patients.</p>
      <p id="Par28">Finally, to assess the therapeutic indications of these subclasses, we used the pharmacogenomic profiling of cancer cell lines<sup><xref ref-type="bibr" rid="CR27">27</xref></sup>. There are 53 melanoma cell lines in this dataset. For each of these cell lines, we have access to both their transcriptomic profile and drug response for 256 different drugs. We used the top 100 genes in subclasses A–C to find cell lines that closely resemble each of these subclasses. We <italic>z</italic>-score normalize each row of this submatrix and use mHG <italic>p</italic>-value to assess the the enrichment of marker genes among top-ranked genes. We use a <italic>p</italic>-value of 10<sup>−3</sup> to ensure that selected cell lines are closely related to original subclasses. This leaves us with 9, 6, and 15 cell lines for subclasses A, B, and C, respectively, and 23 unclassified cell lines. For cell lines associated with subclasses B and C, we used a <italic>t</italic>-test to assess differences in the distribution of IC50 value between these two subclasses. We found that subclass C is more sensitive to the drugs targeting ERK MAPK signaling, specifically Refametinib, CI-1040, PLX-4720, SB590885, Selumetinib, AZD6482, PLX-4720, and Dabrafenib, among which PLX-4720 and Dabrafenib are the most effective ones.</p>
    </sec>
  </sec>
  <sec id="Sec6" sec-type="discussion">
    <title>Discussion</title>
    <p id="Par29">We present a unified framework for characterizing the state space of single-cell transcriptomes. Our approach, motivated by archetypal analysis (AA), identifies dominant landmarks, or archetypes, among the population of cells. All other cells are then represented with respect to their relationship to these archetypes. This, in turn, simplifies the interpretation of our results, since each archetype corresponds to the transcriptional signature of a putative cell type. By using a locally sparse averaging scheme, our framework alleviates the problem of dropouts, which is a fundamental challenge in the single-cell analysis, while preserving as much of the cell state information as possible. Put together, ACTION provides a natural decomposition that is easy to interpret, facilitates marker detection, and can be applied to both characterize the continuous state of cells, as well as discrete cell types.</p>
  </sec>
  <sec id="Sec7" sec-type="materials|methods">
    <title>Methods</title>
    <sec id="Sec8">
      <title>Datasets</title>
      <p id="Par30">Single-cell gene expression datasets: For all our studies, we rely on the following datasets collected from publicly available sources:</p>
      <p id="Par31">Brain (GEO: GSE67835): This dataset contains 466 cells spanning various cell types in the human brain, including astrocytes, oligodendrocytes, oligodendrocyte precursor cells (OPCs), neurons, microglia, and vascular cells<sup><xref ref-type="bibr" rid="CR28">28</xref></sup>.</p>
      <p id="Par32">CellLines (GEO: GSE81861): This dataset is recently published to benchmark existing cell-type identification methods. It contains 561 cells from seven different cell lines, including A549 (lung epithelial), GM12878 (B-lymphocyte), H1 (embryonic stem cell), H1437 (lung), HCT116 (colon), IMR90 (lung fibroblast), and K562 (lymphoblast). To assess the effect of batch effects, GM12878 and H1 are assayed in two batches<sup><xref ref-type="bibr" rid="CR29">29</xref></sup>.</p>
      <p id="Par33">Melanoma (GEO: GSE72056): This dataset measures the expression profile of 4645 malignant, immune, and stromal cells isolated from 19 freshly procured human melanoma tumors. These cells are classified into 7 major types<sup><xref ref-type="bibr" rid="CR12">12</xref></sup>.</p>
      <p id="Par34">MouseBrain (GEO: GSE60361): This dataset contains the expression profile of 3005 cells from the mouse cortex and hippocampus. These cells classify into seven major types, including astrocytes-ependymal, endothelial-mural, interneurons, microglia, oligodendrocytes, pyramidal CA1, and pyramidal SS<sup><xref ref-type="bibr" rid="CR16">16</xref></sup>.</p>
      <p id="Par35">Transcriptional Regulatory Network (TRN): We collect TF–TG interactions from the TRRUST database<sup><xref ref-type="bibr" rid="CR30">30</xref></sup>. This dataset contains a total of 6314 regulatory interactions between 651 TFs and 2102 TGs.</p>
      <p id="Par36">Drug sensitivity in cell lines: We downloaded processed gene expression and drug sensitivity data from the Genomics of Drug Sensitivity in Cancer Project website<sup><xref ref-type="bibr" rid="CR27">27</xref></sup>. These datasets consist of a total of 1001 cell lines, spanning different types of cancer, 52 of which are melanoma cell lines that also have their gene expression profile available. A total of 256 compounds were screened on these cell lines IC59 values for each pair has been reported.</p>
    </sec>
    <sec id="Sec9">
      <title>Computing ACTION metric as a measure of similarity between cells</title>
      <p id="Par37">The transcriptome of each cell consists of genes that are expressed at different levels and have different specificity with respect to the underlying cell types. Universally expressed genes correspond to the subset of genes responsible for mediating core cellular functions. These functions are needed by all cells to function properly, which result in ubiquitous expression of these genes across all cell types<sup><xref ref-type="bibr" rid="CR31">31</xref></sup>. While fundamental to cellular function, these genes are not informative with respect to the identity of cells. On the other hand, cell-type-specific genes are preferentially expressed in one or a few selected cell types to perform cell-type-specific functions. Unlike universally expressed genes, cell-type-specific genes are, typically, weakly expressed, but are highly relevant for grouping cells according to their common functions. Our goal here is to define a similarity measure between cells that suppresses universally expressed genes and enhances the signal contained in cell-type-specific genes.</p>
      <p id="Par38">To suppress the ubiquitously high expression of universally expressed genes, we adopt a method that we developed recently for bulk tissue measurements and extend it to single-cell analysis<sup><xref ref-type="bibr" rid="CR10">10</xref></sup>. This method projects a standardized representation of expression profiles of cells onto the orthogonal subspace of universally expressed genes. Let us denote the raw expression profile of cells using matrix <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf{X}} \in {\Bbb R}^{m \times n}$$\end{document}</tex-math><mml:math id="M2"><mml:mi mathvariant="bold">X</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>×</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41467_2018_3933_Article_IEq1.gif"/></alternatives></inline-formula>, where each row corresponds to a gene and each column represents a cell. We use <bold><italic>x</italic></bold><sub><italic>i</italic></sub> to denote the expression profile of <italic>i</italic><sup><italic>th</italic></sup> cell. In addition, let us denote the signature vector of universally expressed genes by <bold><italic>v</italic></bold>. As a first order estimate, a universally expressed signature is computed by taking the average expression over all cells: <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf{v}} = \frac{1}{n}\mathop {\sum}\nolimits_{i = 1}^n {\mathbf{x}}_i$$\end{document}</tex-math><mml:math id="M4"><mml:mi mathvariant="bold">v</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:mfrac><mml:msubsup><mml:mrow><mml:mo> ∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:msub><mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2018_3933_Article_IEq2.gif"/></alternatives></inline-formula>; that is, <bold><italic>v</italic></bold><sub><italic>i</italic></sub> is the average expression of gene <italic>i</italic> across all samples. This choice is motivated by the fact that highly expressed genes are more consistently expressed, whereas lowly expressed genes show exhibit higher variability. To this end, by orthogonalizing with respect to the mean value, we significantly reduce the effect of universally expressed genes, while preserving the variation of lowly expressed, but preferential ones<sup><xref ref-type="bibr" rid="CR32">32</xref></sup>. After estimating this baseline expression, we <italic>z</italic>-score normalize the profile of each cell: <inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf{z}}_i = \frac{{{\mathbf{x}}_i - \mu _i}}{{\sigma _i}}$$\end{document}</tex-math><mml:math id="M6"><mml:msub><mml:mrow><mml:mi mathvariant="bold">z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:math><inline-graphic xlink:href="41467_2018_3933_Article_IEq3.gif"/></alternatives></inline-formula>, where <italic>μ</italic><sub><italic>i</italic></sub> and <italic>σ</italic><sub><italic>i</italic></sub> are the mean and sample standard deviation of the entries in the <italic>i</italic>th cell profile. Similarly, we <italic>z</italic>-score normalize the signature vector of universally expressed genes, <bold><italic>v</italic></bold>, to create a new vector <bold><italic>z</italic></bold><sub><italic>v</italic></sub>. Finally, we project out the impact of the universally expressed gene expressions on each cell’s profile as follows:<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf{z}}_i^ \bot = ({\mathbf{I}} - \frac{{{\mathbf{z}}_v{\mathbf{z}}_v^T}}{{\left| {\left| {{\mathbf{z}}_v} \right|} \right|_2^2}}){\mathbf{z}}_i.$$\end{document}</tex-math><mml:math id="M8" display="block"><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>⊥</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="bold">I</mml:mi><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">z</mml:mi></mml:mrow><mml:mrow><mml:mi>v</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">z</mml:mi></mml:mrow><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mfenced close="∣" open="∣" separators=""><mml:mrow><mml:mfenced close="∣" open="∣" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">z</mml:mi></mml:mrow><mml:mrow><mml:mi>v</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>.</mml:mo></mml:math><graphic xlink:href="41467_2018_3933_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par39">This operation projects <bold><italic>z</italic></bold><sub><italic>i</italic></sub> to the orthogonal complement of the space spanned by the universally expressed genes. We then concatenate the column vectors <inline-formula id="IEq4"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf{z}}_i^ \bot$$\end{document}</tex-math><mml:math id="M10"><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>⊥</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="41467_2018_3933_Article_IEq4.gif"/></alternatives></inline-formula> to create a adjusted cell signature matrix <inline-formula id="IEq5"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\cal Z}^ \bot$$\end{document}</tex-math><mml:math id="M12"><mml:msup><mml:mrow><mml:mi mathvariant="script">Z</mml:mi></mml:mrow><mml:mrow><mml:mo>⊥</mml:mo></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41467_2018_3933_Article_IEq5.gif"/></alternatives></inline-formula>.</p>
      <p id="Par40">Next, to enhance the signal contributed by preferentially expressed genes, we propose an information theoretic approach that is inspired by the work of Schug et al.<sup><xref ref-type="bibr" rid="CR33">33</xref></sup>. The main idea is to use Shannon’s entropy to measure the informativeness of genes. If a gene is uniformly utilized across cells, it contains less information as opposed to the case in which it is selectively active in a few cells. To this end, we start with the positive projection of adjusted cell signatures, <inline-formula id="IEq6"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\cal P}^{( + )}\left( {{\cal Z}^ \bot } \right)$$\end{document}</tex-math><mml:math id="M14"><mml:msup><mml:mrow><mml:mi mathvariant="script">P</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>+</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">Z</mml:mi></mml:mrow><mml:mrow><mml:mo>⊥</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2018_3933_Article_IEq6.gif"/></alternatives></inline-formula>, in which case we replace all negative values with zeros. Then, we normalize this matrix to construct a stochastic matrix <bold><italic>P</italic></bold> (every row sums to one). Let <bold><italic>p</italic></bold><sub><italic>i</italic></sub> be the row vector associated with the <italic>i</italic><sup><italic>th</italic></sup> gene. We compute the uniformity, or normalized entropy, of <bold><italic>p</italic></bold><sub><italic>i</italic></sub> as: <italic>u</italic>(<italic>i</italic>) = −∑<sub><italic>j</italic></sub><italic>p</italic><sub><italic>ij</italic></sub>log(<italic>p</italic><sub><italic>ij</italic></sub>)/log(<italic>n</italic>), where <italic>p</italic><sub><italic>ij</italic></sub> is an entry in the matrix <bold>P</bold> and <italic>n</italic> is the number of genes. This value is always between zero and one and is used as a basis to boost contributions from the most informative genes. A detailed comparison of our entropy-based method with dispersion and Gini index is provided in the Supplementary Note <xref rid="MOESM1" ref-type="media">2</xref>.</p>
      <p id="Par41">To scale genes according to their specificity, we compute a coefficient that controls the contribution of each gene. This coefficient is greater than one (scales up) for cell-type-specific genes and less than one (scales down) for universally expressed genes, respectively. To do so, we note that the distribution of the entropy values follows a bimodal distribution, with separate peaks for the cell-type-specific and universally expressed genes. To identify the critical point where these two population separate from each other, we fit a mixture of two Gaussians over the distribution of the values and use it to identify this transition point, denoted by <inline-formula id="IEq7"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hat u$$\end{document}</tex-math><mml:math id="M16"><mml:mi>û</mml:mi></mml:math><inline-graphic xlink:href="41467_2018_3933_Article_IEq7.gif"/></alternatives></inline-formula>, which is the point of equal probability from each Gaussian.Then for each gene <italic>i</italic>, we define a scaling factor as <inline-formula id="IEq8"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$w_i = \hat u{\mathrm{/}}u(i)$$\end{document}</tex-math><mml:math id="M18"><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>û</mml:mi><mml:mi mathvariant="normal">∕</mml:mi><mml:mi>u</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2018_3933_Article_IEq8.gif"/></alternatives></inline-formula>. Finally, we compute the kernel matrix as follows:<disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf{K}}{\mathrm{ = }}({\cal Z}^ \bot )^T\mathrm{diag}({\it{w}}^2){\cal Z}^ \bot$$\end{document}</tex-math><mml:math id="M20" display="block"><mml:mi mathvariant="bold">K</mml:mi><mml:mi mathvariant="normal">=</mml:mi><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">Z</mml:mi></mml:mrow><mml:mrow><mml:mo>⊥</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mi mathvariant="normal">diag</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">Z</mml:mi></mml:mrow><mml:mrow><mml:mo>⊥</mml:mo></mml:mrow></mml:msup></mml:math><graphic xlink:href="41467_2018_3933_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par42">In this formulation, if we denote <inline-formula id="IEq9"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\bf{Y}}={\mathrm{diag}}\left(w \right){\cal Z}^ \bot$$\end{document}</tex-math><mml:math id="M22"><mml:mi mathvariant="bold">Y </mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="normal">diag</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>w</mml:mi></mml:mrow></mml:mfenced><mml:msup><mml:mrow><mml:mi mathvariant="script">Z</mml:mi></mml:mrow><mml:mrow><mml:mo>⊥</mml:mo></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41467_2018_3933_Article_IEq9.gif"/></alternatives></inline-formula>, then <bold>K</bold> is a dot-product kernel defined as <bold>Y</bold><sup><italic>T</italic></sup><bold>Y</bold>. We will refer to <bold>Y</bold> as the adjusted transcriptional profile of cells, and <bold>K</bold> as the cell similarity kernel, or ACTION metric.</p>
    </sec>
    <sec id="Sec10">
      <title>Characterizing the functional space of individual cells</title>
      <p id="Par43">Due to evolutionary constraints, biological systems, including cells, that need to perform multiple primary functions, or tasks, can not be optimal in all those tasks; thus, these systems evolve to be specialized in specific tasks<sup><xref ref-type="bibr" rid="CR11">11</xref></sup>. The functional space of cells then can be represented by a low-dimensional geometric construct, such as a polytope, the corners of which correspond to the set of specialized primary functions. The convex hull of a given set of points is the minimum volume polytope that encloses all points. This can be envisioned as a rubber band fitting to the outermost points. Constructing the convex hull in high-dimensional space is computationally expensive and susceptible to noise and overfitting. As an alternative, we seek a limited number of points on the convex hull that enclose as many points as possible, while being resilient to noise and outliers. Each point here represents a cell and each corner, or archetype, of this polytope is a candidate cell that best represents a unique primary function. To find these candidate cells, we use a modified version of the successive projection algorithm (SPA) combined with a novel model selection technique to identify an optimal number, <italic>k</italic>, of candidate cells on the approximate convex hull that best represent distinct pure cells with specialized primary functions. Finally, we use the principal convex hull algorithm (PCHA) to relax these corners to allow others cells to contribute to the identity of each archetype/corner.</p>
      <p id="Par44">Formally, given a matrix <bold>Y</bold> representing the adjusted transcriptional profile of cells, we aim to construct an optimal set <inline-formula id="IEq10"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\cal S}$$\end{document}</tex-math><mml:math id="M24"><mml:mi mathvariant="script">S</mml:mi></mml:math><inline-graphic xlink:href="41467_2018_3933_Article_IEq10.gif"/></alternatives></inline-formula> of <italic>k</italic> columns such that each selected column is an ideal representative of the cells that perform a given primary function. Let us assume that matrix <bold>Y</bold> can be decomposed as <inline-formula id="IEq11"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf{Y}} = {\mathbf{Y}}(:,{\cal S}){\mathbf{H}} + {\mathbf{N}}$$\end{document}</tex-math><mml:math id="M26"><mml:mi mathvariant="bold">Y </mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="bold">Y </mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>:</mml:mo><mml:mo>,</mml:mo><mml:mi mathvariant="script">S</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi mathvariant="bold">H</mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="bold">N</mml:mi></mml:math><inline-graphic xlink:href="41467_2018_3933_Article_IEq11.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq12"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\cal S}$$\end{document}</tex-math><mml:math id="M28"><mml:mi mathvariant="script">S</mml:mi></mml:math><inline-graphic xlink:href="41467_2018_3933_Article_IEq12.gif"/></alternatives></inline-formula> is the selected column subspace of matrix <bold>Y</bold>, <bold>H</bold> is non-negative with column-sums equal to one, and <bold>N</bold> represents bounded noise, where <inline-formula id="IEq13"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\parallel {{\mathbf{N}}(:,j)} \parallel_2 \le \varepsilon$$\end{document}</tex-math><mml:math id="M30"><mml:mo>∥</mml:mo><mml:mi mathvariant="bold">N</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>:</mml:mo><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mrow><mml:mo>∥</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>≤</mml:mo><mml:mi>ε</mml:mi></mml:math><inline-graphic xlink:href="41467_2018_3933_Article_IEq13.gif"/></alternatives></inline-formula>. That is, we can select <inline-formula id="IEq14"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$|{\cal S}| = k$$\end{document}</tex-math><mml:math id="M32"><mml:mo>∣</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo>∣</mml:mo><mml:mo>=</mml:mo><mml:mi>k</mml:mi></mml:math><inline-graphic xlink:href="41467_2018_3933_Article_IEq14.gif"/></alternatives></inline-formula> columns from matrix <bold>Y</bold> to represent rest of the columns, with consideration for noise. A matrix satisfying this condition is called near-separable and is known as the near-separable non-negative matrix factorization (NMF) when <bold>Y</bold> is non-negative. For a matrix satisfying near-separability, there is an efficient algorithm, with provable performance guarantees, that can identify columns in <inline-formula id="IEq15"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\cal S}$$\end{document}</tex-math><mml:math id="M34"><mml:mi mathvariant="script">S</mml:mi></mml:math><inline-graphic xlink:href="41467_2018_3933_Article_IEq15.gif"/></alternatives></inline-formula>. Furthermore, premultiplying matrix <bold>Y</bold> with a nonsingular matrix <bold>Q</bold> preserves its separability, but if chosen carefully, can enhance the conditioning of the problem and accuracy of results. To find the optimal preconditioning matrix <bold>Q</bold>, we use a theoretically grounded method based on identifying a minimum volume ellipsoid at the origin that contains all columns of <bold>Y</bold> (Supplementary Note <xref rid="MOESM1" ref-type="media">6</xref>).</p>
      <p id="Par45">Given that SPA selects <italic>k</italic> columns of <bold>Y</bold>, <italic>given k</italic>, the next issue is how to find the optimal value of <italic>k</italic> that captures most variation in data without overfitting. We devised a novel monitoring technique that assesses the current <italic>k</italic>-polytope to see if there is any evidence of oversampling the cell-space. If so, it stops the algorithm. Otherwise, it continues by adding new archetypes. Informally, oversampling happens when we start adding new archetypes to regions in the space that are already well-covered by other archetypes, in which case the newly added archetype would be significantly close to one or more other archetypes, compared to the rest of the archetypes. Given that each archetype is a candidate cell, we can measure relationship between them using the ACTION metric. The distribution of similarities resembles a normal distribution; however, as we start to oversample, the right tail of the distribution starts getting heavier. To distinguish the pairs of archetypes in this heavy-tailed region, we <italic>z</italic>-score normalize pairwise similarities between archetypes and select all pairs whose <italic>z</italic>-transformed similarity scores are above 1.96, which corresponds to 95% confidence level under Gaussian assumption for the underlying distribution. Then, we build an archetype similarity graph using these pairs of close archetypes. In this graph, oversampling can be identified by the emergence of dense local regions. We use the Erdös-Rényi (ER) random graph model as a background to assess density of each sub-region, or connected component, in the archetype similarity graph<sup><xref ref-type="bibr" rid="CR34">34</xref></sup>. If we find at least one of the connected components that is significantly dense, which is a sign of oversampling, then we terminate the algorithm and choose the last value of <italic>k</italic> before oversampling happens.</p>
      <p id="Par46">After estimating <italic>k</italic> ideal candidate cells, or pure cells, we use AA<sup><xref ref-type="bibr" rid="CR35">35</xref></sup>, which can be viewed as a generalization of near-separability to relax corners by locally adjusting them to have contributions from multiple cells. Formally, we can formulate AA as follows:<disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{array}{*{20}{l}} {\begin{array}{*{20}{c}} {{\mathrm{minimize}}} \\ {{\mathbf{C}},{\mathbf{H}},{\mathbf{\alpha }}} \end{array}} \hfill &amp; {\parallel {{\mathbf{Y}} - {\mathbf{YCH}}} \parallel} \hfill \\ {{\mathrm{subject}}\,{\mathrm{to}}} \hfill &amp; {\parallel {{\mathbf{C}}(:,i)_1 = 1} \parallel.} \hfill \\ {} \hfill &amp; {\parallel {{\mathbf{H}}(:,i)_1 = 1} \parallel.} \hfill \\ {} \hfill &amp; {0 \le {\mathbf{C}},0 \le {\mathbf{H}}} \hfill \end{array}$$\end{document}</tex-math><mml:math id="M36" display="block"><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mtable><mml:mtr><mml:mtd columnalign="center"><mml:mi mathvariant="normal">minimize</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:mi mathvariant="bold">C</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">H</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">α</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:mtd><mml:mtd columnalign="left"><mml:mo>∥</mml:mo><mml:mi mathvariant="bold">Y </mml:mi><mml:mo>-</mml:mo><mml:mi mathvariant="bold">Y CH</mml:mi><mml:mo>∥</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mi mathvariant="normal">subject</mml:mi><mml:mspace width="0.3em"/><mml:mi mathvariant="normal">to</mml:mi></mml:mtd><mml:mtd columnalign="left"><mml:mo>∥</mml:mo><mml:mi mathvariant="bold">C</mml:mi><mml:msub><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>:</mml:mo><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>∥</mml:mo><mml:mo>.</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"/><mml:mtd columnalign="left"><mml:mo>∥</mml:mo><mml:mi mathvariant="bold">H</mml:mi><mml:msub><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>:</mml:mo><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>∥</mml:mo><mml:mo>.</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"/><mml:mtd columnalign="left"><mml:mn>0</mml:mn><mml:mo>≤</mml:mo><mml:mi mathvariant="bold">C</mml:mi><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>≤</mml:mo><mml:mi mathvariant="bold">H</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="41467_2018_3933_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par47">Near-separable non-negative matrix factorization is a special case of AA in which <bold>Y</bold> is non-negative, <bold>C</bold> has exactly <italic>k</italic> nonzeros, and none of the columns have more than one element. We use an efficient algorithm, called Principal Convex Hull Analysis (PCHA), to solve the above problem to a local optima.</p>
      <p id="Par48">The matrix <bold>A</bold> = <bold>YC</bold> then stores the archetypes. Column stochasticity of <bold>C</bold> indicates that archetypes are convex combinations of data points, and column stochasticity of <bold>H</bold> indicates each data point can be represented as convex combination of archetypes.</p>
      <p id="Par49">A complete pseudo-code fitting all these components together is provided in Supplementary Note <xref rid="MOESM1" ref-type="media">7</xref>.</p>
    </sec>
    <sec id="Sec11">
      <title>Constructing the TRN for each archetype</title>
      <p id="Par50">In order to understand what control mechanisms are responsible for mediating the transcriptional phenotype of each archetype, we first have to identify key marker genes that distinguish a given archetype from the rest of archetypes (see Fig. <xref rid="Fig7" ref-type="fig">7a</xref> for an illustrative guide to this section). To this end, we first orthogonalize each archetype with respect to all other archetypes. In this formulation, what remains, referred to as the residual expression of genes, ranks genes according to their importance in a given archetype. Let matrix <bold>A</bold> = <bold>YC</bold> represent the identified archetypes. Let <inline-formula id="IEq16"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf{A}}^{( + )} = {\cal P}^{( + )}({\mathbf{A}})$$\end{document}</tex-math><mml:math id="M38"><mml:msup><mml:mrow><mml:mi mathvariant="bold">A</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>+</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="script">P</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>+</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="bold">A</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2018_3933_Article_IEq16.gif"/></alternatives></inline-formula> be the projection to positive entries and let <inline-formula id="IEq17"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf{a}}_i^{( + )}$$\end{document}</tex-math><mml:math id="M40"><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>+</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="41467_2018_3933_Article_IEq17.gif"/></alternatives></inline-formula> stand for the column <italic>i</italic> of <bold>A</bold><sup>(+)</sup>. Moreover, let <inline-formula id="IEq18"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf{A}}_{ - i}^{( + )}$$\end{document}</tex-math><mml:math id="M42"><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">A</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>+</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="41467_2018_3933_Article_IEq18.gif"/></alternatives></inline-formula> denote the matrix without the <italic>i</italic>th column. Our goal is to project <inline-formula id="IEq19"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf{a}}_i^{( + )}$$\end{document}</tex-math><mml:math id="M44"><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>+</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="41467_2018_3933_Article_IEq19.gif"/></alternatives></inline-formula> into the subspace orthogonal to the columns spanned by <inline-formula id="IEq20"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf{A}}_{ - i}^{( + )}$$\end{document}</tex-math><mml:math id="M46"><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">A</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>+</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="41467_2018_3933_Article_IEq20.gif"/></alternatives></inline-formula>. Then, the orthogonalization step can be written as:<disp-formula id="Equ4"><label>4</label><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf{a}}_i^ \bot {\mathrm{ = }}\left( {{\mathbf{I}}{\mathrm{ - }}{\mathbf{A}}_{ - i}^{( + )}\left( {{\mathbf{A}}_{ - i}^{( + )^T}{\mathbf{A}}_{ - i}^{( + )}} \right)^{ - 1}{\mathbf{A}}_{ - i}^{( + )^T}} \right){\mathbf{a}}_i^{( + )}$$\end{document}</tex-math><mml:math id="M48" display="block"><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>⊥</mml:mo></mml:mrow></mml:msubsup><mml:mi mathvariant="normal">=</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi mathvariant="bold">I</mml:mi><mml:mi mathvariant="normal">-</mml:mi><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">A</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>+</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msubsup><mml:msup><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">A</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>+</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">A</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>+</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">A</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>+</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>+</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msubsup></mml:math><graphic xlink:href="41467_2018_3933_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par51">Finally, we construct matrix <inline-formula id="IEq21"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf{A}}_ + ^ \bot$$\end{document}</tex-math><mml:math id="M50"><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">A</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow><mml:mrow><mml:mo>⊥</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="41467_2018_3933_Article_IEq21.gif"/></alternatives></inline-formula> where each column is <inline-formula id="IEq22"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf{a}}_i^ \bot$$\end{document}</tex-math><mml:math id="M52"><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>⊥</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="41467_2018_3933_Article_IEq22.gif"/></alternatives></inline-formula>. Terms in this matrix are called residual expressions and help identify distinguishing marker genes for each archetype.</p>
      <p id="Par52">Those genes with high residual expression in each archetype are controlled through regulatory networks within the cell. To uncover these relationships, we identify TFs that are significantly associated with the expression of marker genes, which we will refer to as functionally active TFs. Functional activity of TFs is inferred directly from the expression of their TGs; thus, these TF activities can be controlled at different stages, ranging from transcriptional to post-translation regulations. To infer these activities, we first need to classify their TGs as either active or inactive in a given context (archetype). We partition genes according to their residual expression and declare top-ranked genes as active. We use the minimum hypergeometric (mHG) method<sup><xref ref-type="bibr" rid="CR36">36</xref></sup> to find the optimal partition of genes and assign a <italic>p</italic>-value to it. The main step of this algorithm is similar to classic enrichment analysis: for a fixed size <italic>l</italic>, we use the hypergeometric <italic>p</italic>-value to assess the over-representation of TGs for a given TF among top-<italic>l</italic> markers for an archetype. Then, we compute the same statistic for all 1 ≤ <italic>l</italic> ≤ <italic>m</italic>, where <italic>m</italic> is the total number of genes. The mHG tail that is obtained, referred to as the mHG score, specifies the best cut, <italic>l</italic><sup>(<italic>best</italic>)</sup>, and all TGs that are ranked higher than <italic>l</italic><sup>(<italic>best</italic>)</sup> among marker genes are selected as regulated targets for that TF. Finally, we use the obtained mHG score to assess the significance of the TF itself. This can be accomplished using a dynamic programming algorithm that assesses the probability of observing the same or more significant mHG score within the population of all binary vectors of size <italic>m</italic> with exactly <italic>r</italic> nonzeros, where <italic>r</italic> is the number of targets for the current TF. The set of all significant TFs, together with their TGs that fall above the cut that results in the mHG score, are used to construct the final TRN.</p>
    </sec>
    <sec id="Sec12">
      <title>Code availability</title>
      <p id="Par53">All codes are available in C/C++ with R/Matlab interfaces from <ext-link ext-link-type="uri" xlink:href="http://compbio.mit.edu/ACTION">http://compbio.mit.edu/ACTION</ext-link>.</p>
    </sec>
    <sec id="Sec13">
      <title>Data availability</title>
      <p id="Par54">The data that support the findings of this study are available from the corresponding author upon reasonable request.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Electronic supplementary material</title>
    <sec id="Sec14">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="41467_2018_3933_MOESM1_ESM.pdf">
            <caption>
              <p>Supplementary Information</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p>
        <bold>Electronic supplementary material</bold>
      </p>
      <p><bold>Supplementary Information</bold> accompanies this paper at 10.1038/s41467-018-03933-2.</p>
    </fn>
    <fn>
      <p><bold>Publisher's note:</bold> Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>This work is supported by the NSF Center for Science of Information STC (CCF-0939370), NSF Grants BIO 1124962, NSF IIS-1546488, NSF CCF-1149756, IIS-1422918, the DARPA SIMPLEX program, the Sloan Foundation, and NIH Grants 5R01AI114814-02 and 5U01CA198941-03.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author contributions</title>
    <p>S.M. conceived the idea, designed and implemented the method, ran the experiments, analyzed the results, and drafted the manuscript. V.R. performed initial experiments that led to the final method. D.G. and A.G. helped design the method, analyzed results, and assisted with the writing. All authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="COI-statement">
    <sec id="FPar1">
      <title>Competing interests</title>
      <p id="Par55">The authors declare no competing interests.</p>
    </sec>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Trapnell</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Defining cell types and states with single-cell genomics</article-title>
        <source>Genome Res.</source>
        <year>2015</year>
        <volume>25</volume>
        <fpage>1491</fpage>
        <lpage>1498</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.190595.115</pub-id>
        <?supplied-pmid 26430159?>
        <pub-id pub-id-type="pmid">26430159</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jamal-Hanjani</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Quezada</surname>
            <given-names>SA</given-names>
          </name>
          <name>
            <surname>Larkin</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Swanton</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Translational implications of tumor heterogeneity</article-title>
        <source>Clin. Cancer Res.</source>
        <year>2015</year>
        <volume>21</volume>
        <fpage>1258</fpage>
        <lpage>1266</lpage>
        <pub-id pub-id-type="doi">10.1158/1078-0432.CCR-14-1429</pub-id>
        <?supplied-pmid 25770293?>
        <pub-id pub-id-type="pmid">25770293</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wagner</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Regev</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Yosef</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>Revealing the vectors of cellular identity with single-cell genomics</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2016</year>
        <volume>34</volume>
        <fpage>1145</fpage>
        <lpage>1160</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.3711</pub-id>
        <?supplied-pmid 27824854?>
        <pub-id pub-id-type="pmid">27824854</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Qiu</surname>
            <given-names>P</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Extracting a cellular hierarchy from high-dimensional cytometry data with SPADE</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2011</year>
        <volume>29</volume>
        <fpage>886</fpage>
        <lpage>891</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.1991</pub-id>
        <?supplied-pmid 21964415?>
        <pub-id pub-id-type="pmid">21964415</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Marco</surname>
            <given-names>E</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Bifurcation analysis of single-cell gene expression data reveals epigenetic landscape</article-title>
        <source>Proc. Natl Acad. Sci. USA</source>
        <year>2014</year>
        <volume>111</volume>
        <fpage>E5643</fpage>
        <lpage>E5650</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.1408993111</pub-id>
        <?supplied-pmid 25512504?>
        <pub-id pub-id-type="pmid">25512504</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Grün</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell messenger RNA sequencing reveals rare intestinal cell types</article-title>
        <source>Nature</source>
        <year>2015</year>
        <volume>525</volume>
        <fpage>251</fpage>
        <lpage>5</lpage>
        <pub-id pub-id-type="doi">10.1038/nature14966</pub-id>
        <?supplied-pmid 26287467?>
        <pub-id pub-id-type="pmid">26287467</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Xu</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Su</surname>
            <given-names>Z</given-names>
          </name>
        </person-group>
        <article-title>Identification of cell types from single-cell transcriptomes using a novel clustering method</article-title>
        <source>Bioinformatics</source>
        <year>2015</year>
        <volume>31</volume>
        <fpage>1974</fpage>
        <lpage>1980</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btv088</pub-id>
        <?supplied-pmid 25805722?>
        <pub-id pub-id-type="pmid">25805722</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Korem</surname>
            <given-names>Y</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Geometry of the gene expression space of individual cells</article-title>
        <source>PLOS Comput. Biol.</source>
        <year>2015</year>
        <volume>11</volume>
        <fpage>e1004224</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1004224</pub-id>
        <?supplied-pmid 26161936?>
        <pub-id pub-id-type="pmid">26161936</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ji</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Ji</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>TSCAN: Pseudo-time reconstruction and evaluation in single-cell RNA-seq analysis</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2016</year>
        <volume>44</volume>
        <fpage>e117</fpage>
        <lpage>e117</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkw430</pub-id>
        <?supplied-pmid 27179027?>
        <pub-id pub-id-type="pmid">27179027</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <mixed-citation publication-type="other">Mohammadi, S. &amp; Grama, A. De novo identification of cell type hierarchy with application to compound marker detection. In <italic>Proc. of the 7th ACM International Conference on Bioinformatics, Computational Biology, and Health Informatics—BCB ’16</italic>, 251–260 (ACM Press, New York, 2016).</mixed-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shoval</surname>
            <given-names>O</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Evolutionary trade-offs, pareto optimality, and the geometry of phenotype space</article-title>
        <source>Science</source>
        <year>2012</year>
        <volume>336</volume>
        <fpage>1157</fpage>
        <lpage>1160</lpage>
        <pub-id pub-id-type="doi">10.1126/science.1217405</pub-id>
        <?supplied-pmid 22539553?>
        <pub-id pub-id-type="pmid">22539553</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tirosh</surname>
            <given-names>I</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Dissecting the multicellular ecosystem of metastatic melanoma by single-cell RNA-seq</article-title>
        <source>Science</source>
        <year>2016</year>
        <volume>352</volume>
        <fpage>189</fpage>
        <lpage>196</lpage>
        <pub-id pub-id-type="doi">10.1126/science.aad0501</pub-id>
        <?supplied-pmid 27124452?>
        <pub-id pub-id-type="pmid">27124452</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Zhu</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Pierson</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Ramazzotti</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Batzoglou</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Visualization and analysis of single-cell RNA-seq data by kernel-based similarity learning</article-title>
        <source>Nat. Methods</source>
        <year>2017</year>
        <volume>14</volume>
        <fpage>414</fpage>
        <lpage>416</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.4207</pub-id>
        <?supplied-pmid 28263960?>
        <pub-id pub-id-type="pmid">28263960</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lim</surname>
            <given-names>CY</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>BTR: training asynchronous Boolean models using single-cell expression data</article-title>
        <source>BMC bioinformatics</source>
        <year>2016</year>
        <volume>17</volume>
        <fpage>355</fpage>
        <pub-id pub-id-type="doi">10.1186/s12859-016-1235-y</pub-id>
        <?supplied-pmid 27600248?>
        <pub-id pub-id-type="pmid">27600248</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Satija</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Farrell</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Gennert</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Schier</surname>
            <given-names>AF</given-names>
          </name>
          <name>
            <surname>Regev</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Spatial reconstruction of single-cell gene expression data</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2015</year>
        <volume>33</volume>
        <fpage>495</fpage>
        <lpage>502</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.3192</pub-id>
        <?supplied-pmid 25867923?>
        <pub-id pub-id-type="pmid">25867923</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zeisel</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Cell types in the mouse cortex and hippocampus revealed by single-cell RNA-seq</article-title>
        <source>Science</source>
        <year>2015</year>
        <volume>347</volume>
        <fpage>1138</fpage>
        <lpage>42</lpage>
        <pub-id pub-id-type="doi">10.1126/science.aaa1934</pub-id>
        <?supplied-pmid 25700174?>
        <pub-id pub-id-type="pmid">25700174</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hart</surname>
            <given-names>Y</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Inferring biological tasks using Pareto analysis of high-dimensional data</article-title>
        <source>Nat. Methods</source>
        <year>2015</year>
        <volume>12</volume>
        <fpage>233</fpage>
        <lpage>235</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.3254</pub-id>
        <?supplied-pmid 25622107?>
        <pub-id pub-id-type="pmid">25622107</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Newman</surname>
            <given-names>AM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Robust enumeration of cell subsets from tissue expression profiles</article-title>
        <source>Nat. Methods</source>
        <year>2015</year>
        <volume>12</volume>
        <fpage>1</fpage>
        <lpage>10</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.3337</pub-id>
        <pub-id pub-id-type="pmid">25699311</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Antebi</surname>
            <given-names>YE</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Mapping differentiation under mixed culture conditions reveals a tunable continuum of T cell fates</article-title>
        <source>PLoS Biol.</source>
        <year>2013</year>
        <volume>11</volume>
        <fpage>e1001616</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pbio.1001616</pub-id>
        <?supplied-pmid 23935451?>
        <pub-id pub-id-type="pmid">23935451</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Verfaillie</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Decoding the regulatory landscape of melanoma reveals TEADS as regulators of the invasive cell state</article-title>
        <source>Nat. Commun.</source>
        <year>2015</year>
        <volume>6</volume>
        <fpage>6683</fpage>
        <pub-id pub-id-type="doi">10.1038/ncomms7683</pub-id>
        <?supplied-pmid 25865119?>
        <pub-id pub-id-type="pmid">25865119</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <mixed-citation publication-type="other">Laurette, P. et al. Transcription factor MITF and remodeller BRG1 define chromatin organisation at regulatory elements in melanoma cells. <italic>eLife</italic> 4, (2015).</mixed-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Anaya</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>OncoLnc: linking TCGA survival data to mRNAs, miRNAs, and lncRNAs</article-title>
        <source>PeerJ Comput. Sci.</source>
        <year>2016</year>
        <volume>2</volume>
        <fpage>e67</fpage>
        <pub-id pub-id-type="doi">10.7717/peerj-cs.67</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <mixed-citation publication-type="other">Kraehn, G. M. et al. Extra c-myc oncogene copies in high risk cutaneous malignant melanoma and melanoma metastases. <italic>British journal of cancer</italic><bold>84</bold>, 72–9.</mixed-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Alla</surname>
            <given-names>V</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>E2F1 in melanoma progression and metastasis</article-title>
        <source>J. Natl. Cancer Inst.</source>
        <year>2010</year>
        <volume>102</volume>
        <fpage>127</fpage>
        <lpage>33</lpage>
        <pub-id pub-id-type="doi">10.1093/jnci/djp458</pub-id>
        <?supplied-pmid 20026813?>
        <pub-id pub-id-type="pmid">20026813</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Eichhoff</surname>
            <given-names>OM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Differential LEF1 and TCF4 expression is involved in melanoma cell phenotype switching</article-title>
        <source>Pigment Cell Melanoma Res.</source>
        <year>2011</year>
        <volume>24</volume>
        <fpage>631</fpage>
        <lpage>42</lpage>
        <pub-id pub-id-type="doi">10.1111/j.1755-148X.2011.00871.x</pub-id>
        <?supplied-pmid 21599871?>
        <pub-id pub-id-type="pmid">21599871</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhou</surname>
            <given-names>F</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>LEF-1 activates the transcription of E2F1</article-title>
        <source>Biochem. Biophys. Res. Commun.</source>
        <year>2008</year>
        <volume>365</volume>
        <fpage>149</fpage>
        <lpage>53</lpage>
        <pub-id pub-id-type="doi">10.1016/j.bbrc.2007.10.138</pub-id>
        <?supplied-pmid 17980157?>
        <pub-id pub-id-type="pmid">17980157</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Haverty</surname>
            <given-names>PM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Reproducible pharmacogenomic profiling of cancer cell line panels</article-title>
        <source>Nature</source>
        <year>2016</year>
        <volume>533</volume>
        <fpage>333</fpage>
        <lpage>7</lpage>
        <pub-id pub-id-type="doi">10.1038/nature17987</pub-id>
        <?supplied-pmid 27193678?>
        <pub-id pub-id-type="pmid">27193678</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Darmanis</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A survey of human brain transcriptome diversity at the single cell level</article-title>
        <source>Proc. Natl Acad. Sci. USA</source>
        <year>2015</year>
        <volume>112</volume>
        <fpage>7285</fpage>
        <lpage>7290</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.1507125112</pub-id>
        <?supplied-pmid 26060301?>
        <pub-id pub-id-type="pmid">26060301</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Reference component analysis of single-cell transcriptomes elucidates cellular heterogeneity in human colorectal tumors</article-title>
        <source>Nat. Genet.</source>
        <year>2017</year>
        <volume>49</volume>
        <fpage>708</fpage>
        <lpage>718</lpage>
        <pub-id pub-id-type="doi">10.1038/ng.3818</pub-id>
        <?supplied-pmid 28319088?>
        <pub-id pub-id-type="pmid">28319088</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Han</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>TRRUST: a reference database of human transcriptional regulatory interactions</article-title>
        <source>Sci. Rep.</source>
        <year>2015</year>
        <volume>5</volume>
        <fpage>11432</fpage>
        <pub-id pub-id-type="doi">10.1038/srep11432</pub-id>
        <?supplied-pmid 26066708?>
        <pub-id pub-id-type="pmid">26066708</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Eisenberg</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Levanon</surname>
            <given-names>EY</given-names>
          </name>
        </person-group>
        <article-title>Human housekeeping genes, revisited</article-title>
        <source>Trends Genet.</source>
        <year>2013</year>
        <volume>29</volume>
        <fpage>569</fpage>
        <lpage>574</lpage>
        <pub-id pub-id-type="doi">10.1016/j.tig.2013.05.010</pub-id>
        <?supplied-pmid 23810203?>
        <pub-id pub-id-type="pmid">23810203</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>McCarthy</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Smyth</surname>
            <given-names>GK</given-names>
          </name>
        </person-group>
        <article-title>Differential expression analysis of multifactor RNA-Seq experiments with respect to biological variation</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2012</year>
        <volume>40</volume>
        <fpage>4288</fpage>
        <lpage>4297</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gks042</pub-id>
        <?supplied-pmid 22287627?>
        <pub-id pub-id-type="pmid">22287627</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schug</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Promoter features related to tissue specificity as measured by Shannon entropy</article-title>
        <source>Genome Biol.</source>
        <year>2005</year>
        <volume>6</volume>
        <fpage>R33</fpage>
        <pub-id pub-id-type="doi">10.1186/gb-2005-6-4-r33</pub-id>
        <?supplied-pmid 15833120?>
        <pub-id pub-id-type="pmid">15833120</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Koyutürk</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Szpankowski</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Grama</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Assessing significance of connectivity and conservation in protein interaction networks</article-title>
        <source>J. Comput. Biol.</source>
        <year>2007</year>
        <volume>14</volume>
        <fpage>747</fpage>
        <lpage>764</lpage>
        <pub-id pub-id-type="doi">10.1089/cmb.2007.R014</pub-id>
        <?supplied-pmid 17691892?>
        <pub-id pub-id-type="pmid">17691892</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cutler</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Breiman</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>Archetypal Analysis</article-title>
        <source>Technometrics</source>
        <year>1994</year>
        <volume>36</volume>
        <fpage>338</fpage>
        <pub-id pub-id-type="doi">10.1080/00401706.1994.10485840</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <mixed-citation publication-type="other">Eden, E., Lipson, D., Yogev, S. &amp; Yakhini, Z. Discovering motifs in ranked lists of DNA sequences. <italic>PLoS Comput. Biol.</italic><bold>3</bold>, 0508–0522 (2007).</mixed-citation>
    </ref>
  </ref-list>
</back>
