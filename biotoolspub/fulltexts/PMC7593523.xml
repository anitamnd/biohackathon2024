<?DTDIdentifier.IdentifierValue -//ES//DTD journal article DTD version 5.6.0//EN//XML?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName art560.dtd?>
<?SourceDTD.Version 5.6.0?>
<?ConverterInfo.XSLTName elsevier2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<?origin publisher?>
<?FILEmeta_CSBJ672 xml ?>
<?FILEmain xml ?>
<?FILEmain pdf ?>
<?FILEgr1 jpg ?>
<?FILEgr2 jpg ?>
<?FILEgr3 jpg ?>
<?FILEgr4 jpg ?>
<?FILEgr5 jpg ?>
<?FILEgr6 jpg ?>
<?FILEgr7 jpg ?>
<?FILEga1 jpg ?>
<?FILEmmc1 docx ?>
<?FILEmmc2 xlsx ?>
<?FILEsi1 svg ?>
<?FILEsi2 svg ?>
<?FILEsi3 svg ?>
<?FILEsi4 svg ?>
<?FILEsi5 svg ?>
<?FILEsi6 svg ?>
<?FILEsi7 svg ?>
<?FILEsi8 svg ?>
<?properties open_access?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Comput Struct Biotechnol J</journal-id>
    <journal-id journal-id-type="iso-abbrev">Comput Struct Biotechnol J</journal-id>
    <journal-title-group>
      <journal-title>Computational and Structural Biotechnology Journal</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2001-0370</issn>
    <publisher>
      <publisher-name>Research Network of Computational and Structural Biotechnology</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7593523</article-id>
    <article-id pub-id-type="pii">S2001-0370(20)30423-2</article-id>
    <article-id pub-id-type="doi">10.1016/j.csbj.2020.09.038</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>HMST-Seq-Analyzer: A new python tool for differential methylation and hydroxymethylation analysis in various DNA methylation sequencing data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" id="au005">
        <name>
          <surname>Farooq</surname>
          <given-names>Amna</given-names>
        </name>
        <xref rid="af005" ref-type="aff">a</xref>
      </contrib>
      <contrib contrib-type="author" id="au010">
        <name>
          <surname>Grønmyr</surname>
          <given-names>Sindre</given-names>
        </name>
        <xref rid="af005" ref-type="aff">a</xref>
        <xref rid="af010" ref-type="aff">b</xref>
      </contrib>
      <contrib contrib-type="author" id="au015">
        <name>
          <surname>Ali</surname>
          <given-names>Omer</given-names>
        </name>
        <xref rid="af005" ref-type="aff">a</xref>
      </contrib>
      <contrib contrib-type="author" id="au020">
        <name>
          <surname>Rognes</surname>
          <given-names>Torbjørn</given-names>
        </name>
        <xref rid="af010" ref-type="aff">b</xref>
        <xref rid="af020" ref-type="aff">d</xref>
      </contrib>
      <contrib contrib-type="author" id="au025">
        <name>
          <surname>Scheffler</surname>
          <given-names>Katja</given-names>
        </name>
        <xref rid="af030" ref-type="aff">f</xref>
        <xref rid="af035" ref-type="aff">g</xref>
      </contrib>
      <contrib contrib-type="author" id="au030">
        <name>
          <surname>Bjørås</surname>
          <given-names>Magnar</given-names>
        </name>
        <xref rid="af015" ref-type="aff">c</xref>
        <xref rid="af020" ref-type="aff">d</xref>
        <xref rid="af025" ref-type="aff">e</xref>
      </contrib>
      <contrib contrib-type="author" id="au035">
        <name>
          <surname>Wang</surname>
          <given-names>Junbai</given-names>
        </name>
        <email>junbai.wang@rr-research.no</email>
        <xref rid="af005" ref-type="aff">a</xref>
        <xref rid="cor1" ref-type="corresp">⁎</xref>
      </contrib>
      <aff id="af005"><label>a</label>Department of Pathology, Oslo University Hospital – Norwegian Radium Hospital, Oslo, Norway</aff>
      <aff id="af010"><label>b</label>Department of Informatics, University of Oslo, Oslo, Norway</aff>
      <aff id="af015"><label>c</label>Institute for Clinical and Molecular Medicine, Norwegian University of Science and Technology, Trondheim, Norway</aff>
      <aff id="af020"><label>d</label>Department of Microbiology, Oslo University Hospital, Oslo, Norway</aff>
      <aff id="af025"><label>e</label>Department of Microbiology, University of Oslo, Oslo, Norway</aff>
      <aff id="af030"><label>f</label>Department of Neuromedicine and Movement Science and Department of Clinical and Molecular Medicine, Norwegian University of Science and Technology, Trondheim, Norway</aff>
      <aff id="af035"><label>g</label>Department of Neurology and Department of Laboratory Medicine, St. Olavs Hospital, Trondheim, Norway</aff>
    </contrib-group>
    <author-notes>
      <corresp id="cor1"><label>⁎</label>Corresponding author. <email>junbai.wang@rr-research.no</email></corresp>
    </author-notes>
    <pub-date pub-type="pmc-release">
      <day>10</day>
      <month>10</month>
      <year>2020</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on <pub-date
						pub-type="epub">.-->
    <pub-date pub-type="collection">
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>10</day>
      <month>10</month>
      <year>2020</year>
    </pub-date>
    <volume>18</volume>
    <fpage>2877</fpage>
    <lpage>2889</lpage>
    <history>
      <date date-type="received">
        <day>16</day>
        <month>7</month>
        <year>2020</year>
      </date>
      <date date-type="rev-recd">
        <day>26</day>
        <month>9</month>
        <year>2020</year>
      </date>
      <date date-type="accepted">
        <day>27</day>
        <month>9</month>
        <year>2020</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2020 The Author(s)</copyright-statement>
      <copyright-year>2020</copyright-year>
      <license license-type="CC BY" xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article under the CC BY license (http://creativecommons.org/licenses/by/4.0/).</license-p>
      </license>
    </permissions>
    <abstract abstract-type="graphical" id="ab005">
      <title>Graphical abstract</title>
      <fig id="f0040" position="anchor">
        <graphic xlink:href="ga1"/>
      </fig>
    </abstract>
    <abstract id="ab010">
      <p>DNA methylation (5mC) and hydroxymethylation (5hmC) are chemical modifications of cytosine bases which play a crucial role in epigenetic gene regulation. However, cost, data complexity and unavailability of comprehensive analytical tools is one of the major challenges in exploring these epigenetic marks. Hydroxymethylation-and Methylation-Sensitive Tag sequencing (HMST-seq) is one of the most cost-effective techniques that enables simultaneous detection of 5mC and 5hmC at single base pair resolution. We present HMST-Seq-Analyzer as a comprehensive and robust method for performing simultaneous differential methylation analysis on 5mC and 5hmC data sets. HMST-Seq-Analyzer can detect Differentially Methylated Regions (DMRs), annotate them, give a visual overview of methylation status and also perform preliminary quality check on the data. In addition to HMST-Seq, our tool can be used on whole-genome bisulfite sequencing (WGBS) and reduced representation bisulfite sequencing (RRBS) data sets as well. The tool is written in Python with capacity to process data in parallel and is available at (<ext-link ext-link-type="uri" xlink:href="https://hmst-seq.github.io/hmst/" id="ir005">https://hmst-seq.github.io/hmst/</ext-link>).</p>
    </abstract>
    <kwd-group id="kg005">
      <title>Keywords</title>
      <kwd>Methylation analysis</kwd>
      <kwd>Hydroxy methylation</kwd>
      <kwd>Differential methylation</kwd>
      <kwd>Hydroxymethylation-and methylation-sensitive tag sequencing</kwd>
      <kwd>Whole genome bisulfite sequencing</kwd>
    </kwd-group>
  </article-meta>
</front>
<body>
  <sec id="s0005">
    <label>1</label>
    <title>Introduction</title>
    <p id="p0035">Epigenetic DNA methylation provides an additional layer for controlling cellular processes. It is the most stable epigenetic mark that plays a significant role in gene regulation with impact on health and disease <xref rid="b0005" ref-type="bibr">[1]</xref>. Nevertheless, DNA methylation varies in response to cell differentiation, disease, and environmental factors. In vertebrates, 5-methylcytosine (5mC) is the most abundant epigenetic mark. It is usually found in CpG context, where 5mC can be iteratively oxidized by TET proteins to 5-hydroxymethylcytocine (5hmC), the second most abundant epigenetic mark in vertebrates <xref rid="b0010" ref-type="bibr">[2]</xref>. The aforementioned two methylation marks have essential roles in the development and regulation of cellular processes <xref rid="b0015" ref-type="bibr">[3]</xref>. Especially, abnormal methylation patterns have been observed in many human diseases and can be used in clinical outcome predictions <xref rid="b0020" ref-type="bibr">[4]</xref>. Hence, correct profiling of DNA methylation in a genome is key to understand the contribution of epigenetics in gene regulation.</p>
    <p id="p0040">Nowadays, bisulfite treatment is considered as the most effective way of targeting DNA methylation <xref rid="b0025" ref-type="bibr">[5]</xref>. Whole-genome bisulfite sequencing (WGBS) is the most comprehensive protocol for measuring genome-wide single-base-pair resolution methylation, hence making it the golden standard technique <xref rid="b0030" ref-type="bibr">[6]</xref> for studying genomic DNA methylation. Some studies in vertebrate genomes (e.g., birds and fishes) recommend 15X of sequencing depth for WGBS experiments <xref rid="b0035" ref-type="bibr">[7]</xref>, <xref rid="b0040" ref-type="bibr">[8]</xref>. Others such as the NIH Roadmap Epigenomics Projects advise coverage of 30X (combined coverage of 2 replicates). Similarly, the ENCODE project and the International Human Epigenome Consortium (IHEC) recommend users to submit experimental data with sequencing depth of 30X for WGBS <xref rid="b0045" ref-type="bibr">[9]</xref>, <xref rid="b0050" ref-type="bibr">[10]</xref>. To achieve 30X sequencing depth of human sized genome, ~180 GB of sequencing data is produced in WGBS experiments <xref rid="b0055" ref-type="bibr">[11]</xref>. The data size will be reduced in case of organisms with a smaller genome size <xref rid="b0040" ref-type="bibr">[8]</xref>. Alternatively, an enhanced protocol (HiSeq X Ten) offers improved cost effectiveness and coverage <xref rid="b0060" ref-type="bibr">[12]</xref> for WGBS experiments. However, to achieve the claimed low cost, all the HiSeq X Ten machines are required to be run on full capacity. In addition to this fact, the total price of the system makes it suitable for larger institutes only <xref rid="b0065" ref-type="bibr">[13]</xref> Nevertheless, WGBS remains an expensive experiment with huge data handling and processing requirements for downstream analysis. This highlights the need of enrichment-based techniques, which offer a fair trade between coverage and cost.</p>
    <p id="p0045">Reduced representation bisulfite sequencing (RRBS) is a cost-effective enrichment-based sequencing method to target DNA methylation. RRBS reduces sequencing requirements by targeting CpG rich genomic regions only <xref rid="b0070" ref-type="bibr">[14]</xref>. RRBS produces much less data and reduces the experimental cost significantly. Unfortunately, both WGBS and RRBS are unable to distinguish between 5mC and 5hmC on DNA. Therefore, hydroxymethylation and methylation-sensitive tag sequencing (HMST-seq) was proposed to detect both 5mC and 5hmC on DNA sequences simultaneously <xref rid="b0055" ref-type="bibr">[11]</xref>. HMST-seq takes advantage of sequence specific DNA restriction endonucleases: for example, HpaII can cleave unmodified cytosine only while MspI cleaves at both 5mC and 5hmC. Moreover, β-glucosyltransferase (β-GT) can transfer glucose to 5hmC which will block MspI digestion. By combining these enzymatic reactions, HMST-seq generates three tag libraries, which can be used to determine methylation and hydroxymethylation abundance in a sample. The first library contains information of unmodified, methylated and hydroxymethylated cytosines, generated by MspI digestion only. The second library refers to unmodified and methylated cytosines generated by glucosylation of 5hmC and subsequent MspI digestion. The third library contains only unmodified cytosines generated by HpaII digestion. HMST-seq not only targets both 5mC and 5hmC in Msp1 sites (5′-CCGG-3′) at single base resolution but also generates only ~5 GB data to achieve a 30X sequencing depth. Since HMST-seq relies on specific restriction enzymes, it is limited to regions with CCGG sites, thus covering approximately 4–7% CpG dinucleotides distributed throughout the vertebrate genome. However, it has recently been demonstrated that locations of CCGGs largely reflects those of all CpGs in the genome <xref rid="b0075" ref-type="bibr">[15]</xref> and that epigenetic profiling by using methylation- and hydroxymethylation-sensitive restriction enzymes can successfully address fundamental biological questions <xref rid="b0080" ref-type="bibr">[16]</xref>, <xref rid="b0085" ref-type="bibr">[17]</xref>, <xref rid="b0090" ref-type="bibr">[18]</xref>, <xref rid="b0095" ref-type="bibr">[19]</xref>. In contrast to WGBS sequencing, HMST-seq is distinguishing between 5mC and 5hmC providing additional information about the dynamics of oxidative demethylation. The cost, coverage and detection of both 5mC and 5hmC on DNA sequences make HMST-seq an attractive tool for biologists to perform whole-genome methylation studies with large sample sizes.</p>
    <p id="p0050">With the advancement of high throughput sequencing technologies, data generation rate has outpaced the Moore’s law <xref rid="b0100" ref-type="bibr">[20]</xref> while data analysis still remains a challenge. There are, however, several tools available for differential methylation analysis (e.g., MethylKit, MethylSig, and BSmooth <xref rid="b0105" ref-type="bibr">[21]</xref>, <xref rid="b0110" ref-type="bibr">[22]</xref>, <xref rid="b0115" ref-type="bibr">[23]</xref>). While the majority of tools are tailored towards 5mC only a few of them focus on 5hmC. Especially, none of the publicly available tools for differential methylation analysis focuses on both 5mC and 5hmC that are generated by the HMST-seq. Though the methylation data analysis pipeline MINT integrates several tools to process both methylation and hydroxymethylation data, it cannot be applied on HMST-seq library tag data <xref rid="b0120" ref-type="bibr">[24]</xref>. As mentioned earlier, HMST-seq outputs tag counts for three libraries separately and requires processing to methylation and hydroxymethylation levels after wards, this facility is not available in previous tools like MethylKit, BSmooth or MINT pipleine. Thus, we have developed a new differential methylation analysis pipeline called HMST-Seq-Analyzer, which is a user-friendly command line Python package. Though the differential methylation analysis is similar between 5mC and 5hmC at the genome-wide scale, the pre-processing of HMST-Seq data for 5mC and 5hmC is quite different. For example, the methylation and hydroxymethylation levels are calculated by taking ratio of tag counts from three libraries. Such difference in the low-level methylation analysis is taken care by HMST-Seq-Analyzer automatically. Especially, the methylation analysis of both 5mC and 5hmC is done in a single run in the package, which simplifies the illustration and interpretation of results. The package is optimized to process huge data sets from either HMST-seq or WGBS by using parallel computation, as well as data from RRBS. HMST-Seq-Analyzer implements a methylated region (MR) search method similar to one that has been previously published in <xref rid="b0055" ref-type="bibr">[11]</xref> to detect differentially MRs (DMRs) from HMST-seq data. Two slightly modified search methods to define MRs are available to suite the nature of different data sets. For instance, for larger data sets coming from WGBS experiments, pipeline allows tiling window analysis to efficiently deal will large number of methylated sites. Multiple statistics test are also available to search DMRs to accommodate differences in nature of data generated by different methylation detection platforms. All detected DMRs are automatically annotated to the reference genome based on the refFlat file from UCSC Genome Browser <xref rid="b0125" ref-type="bibr">[25]</xref>. Moreover, the package provides a simple statistical summary of the distribution of methylation in various genomic regions (e.g., transcription start site (TSS), transcription end site (TES), gene body, intergenic, 5′ distance region, and other regions like enhancers). Finally, it also provides lists of hyper- and hypo-DMRs annotated to different genomic regions.</p>
  </sec>
  <sec id="s0010">
    <label>2</label>
    <title>Material and methods</title>
    <p id="p0055">HMST-Seq-Analyzer is a new Python package, that employs robust statistical methods for differential methylation analysis in whole-genome DNA sequencing data such as HMST-Seq, WGBS, or RRBS. Although the pipeline is optimized for HMST-seq data, it can be easily applied on either WGBS or RRBS data by simply adjusting the default MR search parameters and the DMR search method. HMST-Seq-Analyzer conducts differential methylation analysis using three steps. Generally, differential methylation detection can be done at multiple genomic resolutions like non-CpG (CHG/CHH), CpG, genome wide tiles or at annotated regions. However, in case of single base pair resolution data coming from techniques like HMST, WGBS and RRBS, differential methylation detection at base pair level becomes a computationally exhaustive task. For two reasons, the best approach is to perform annotated genome analysis; first, use of external genome annotation data focuses the analysis on those methylated regions which can possibly act as epigenetic regulatory switches and second, it reduces the search space, which is otherwise extremely dense. Hence, HMST-Seq-Analyzer tries to minimize the computational burden, by first extracting methylation regions (MR) from predefined genomic areas (e.g., TSS, TES, enhancer, gene body, 5′ distance region and intergenic regions) that may act as epigenetic regulatory switches. In the second step, it filters MRs in parallel, which further narrows down the total search space and computational cost. Finally, differentially methylated regions (DMRs) in predefined genomic areas are predicted by robust statistical tests (e.g., Wilcoxon rank-sum test) between the control and the reference samples. <xref rid="f0005" ref-type="fig">Fig. 1</xref> summarizes the workflow of HMST-Seq-Analyzer. It is divided into eight discrete modules, where the default settings for the parameters are aimed for HMST-seq data but parameters are flexible to accommodate RRBS and WGBS data in the package. A more detailed description of HMST-Seq-Analyzer can be found in the following subsections.<fig id="f0005"><label>Fig. 1</label><caption><p>Detailed scheme of flow of HMST-Seq-Analyzer pipeline. HMST-Seq-Analyzer detects differential methylation in three major phases: 1) preprocessing of data where it performs annotation and extracts methylated regions from predefined regions (e.g., TSS, TES, enhancer, gene body, 5′ distance region and intergenic regions); 2) searches for MRs with same locus in the case and control samples, finds DMRs (e.g. using Wilcoxon Ranksum, Kolmogorov–Smirnov test or T-test), and categorizes them into Hyper/Hypo-methylated DMRs; 3) visualizes graphical summary of analysis results, exports the results in form of list of Hyper/Hypo DMRs and gene annotation.</p></caption><graphic xlink:href="gr1"/></fig></p>
    <sec id="s0015">
      <label>2.1</label>
      <title>Quality control</title>
      <p id="p0060">Before running the pipeline, users can check input data quality by calculating the average of read count distribution among the samples. It is preferable to have majority of the reads distribution above 15X coverage in a sample to ensure reliable prediction of DMR <xref rid="b0035" ref-type="bibr">[7]</xref> as recommended by the ENCODE project <xref rid="b0045" ref-type="bibr">[9]</xref>. This facility is provided as an additional script in the toolbox in the demo data set. Apart from the average read count, the toolbox also offers preliminary cleaning and processing of input files.</p>
    </sec>
    <sec id="s0020">
      <label>2.2</label>
      <title>Pre-processing</title>
      <p id="p0065">By default setting HMST-Seq-Analyzer extracts five types of regions from a given reference genome refFlat file: TSS, gene body, TES, intergenic, and 5′ distance region of each gene. A detailed illustration of these five regions is shown in <xref rid="s0120" ref-type="sec">SFig. 1</xref>, where Gene body is defined between TSS and TES. TSS and TES are ± 1 kb (default) from the original TSS and TES, respectively. The 5′distance is from 10 kb to 100 kb upstream (default) of the TSS. The intergenic regions consider the whole genome except for TSS, TES and gene body. In this way, the pipeline includes whole genome in differential methylation analysis. The lengths of TSS, TES, 5′distance and intergenic regions can be adjusted by the user in the pipeline. An additional enhancer option can also be used by any other regions of choice, provided that chromosomal coordinates are given in simple bed format. The gene annotation task is required only once if the same genomic regions will be used across multiple experiments. Predicting DMRs from aforementioned five types of genomic regions may help us to identify putative functional DMRs in downstream analysis. For HMST-Seq data, if input tag counts are not normalized across sample, then a quantile normalization method can be applied. Subsequently, an abundance of 5mC/5hmC level from HMST-seq can be determined by the ratio between the normalized tag counts of two libraries (e.g, between BGT (β–glucosyltransferase – to detect 5hmC) and HpaII for 5mC; between MspI and BGT for 5hmC). For RRBS and WGBS, a direct input of methylation levels and the corresponding chromosome positions from a bed formatted file is requested. The pipeline offers to switch between the two major types of data sets: methylation level based, i.e. WGBS/RRBS, and library tag count based, i.e. HMST-Seq.</p>
    </sec>
    <sec id="s0025">
      <label>2.3</label>
      <title>Differential methylation analysis</title>
      <p id="p0070">In HMST-Seq-Analyzer, there are two major steps to identify DMRs from genome-wide DNA methylation sequencing data: 1) Searching for candidate methylation regions (MR); 2) Identifying significantly differentially methylated regions (DMRs) with robust statistical tests.</p>
      <sec id="s0030">
        <label>2.3.1</label>
        <title>Searching for methylated regions</title>
        <p id="p0075">Methylated and hydroxymethylated regions can vary in size from a single methylated base pair to an entire gene locus, depending on the biological question of interest. Although single methylated CpG is reported to affect gene expression regulation <xref rid="b0130" ref-type="bibr">[26]</xref> and disease risk <xref rid="b0135" ref-type="bibr">[27]</xref>, the majority of DMRs are reported to range from a few hundred bases to a few kilobases which may be biologically more interesting <xref rid="b0140" ref-type="bibr">[28]</xref>. Especially, DMRs are known to regulate cell-type specific transcriptional repression of genes <xref rid="b0145" ref-type="bibr">[29]</xref>, and this size range complements with the size of other gene regulatory regions such as enhancers. Though HMST-seq data are limited to HpaII restriction sites, it has recently been shown that locations of CCGGs are evenly distributed comparable to those of all CpGs in the genome, and methylation level determined in specific genomic regions (e.g. promoter) highly correlate with gene expression <xref rid="b0075" ref-type="bibr">[15]</xref>. Thus, searching for methylated regions (MR) makes sense for HMST-seq data. Moreover, epigenetic profiling by using methylation- and hydroxymethylation-sensitive restriction enzymes successfully addresses fundamental biological questions <xref rid="b0085" ref-type="bibr">[17]</xref>, <xref rid="b0090" ref-type="bibr">[18]</xref>, <xref rid="b0095" ref-type="bibr">[19]</xref>.</p>
        <p id="p0080">In HMST-Seq-Analyzer, an MR is defined as a cluster of 5mC or 5hmC sites at a locus. The search for MRs is only carried out in certain defined genomic regions (e.g., gene body, TSS, or enhancer etc). There are two major stringency parameters in the MR search method: the number of consecutive sites and the distance of adjacent methylated sites. For HMST-Seq data, this is similar to the previous publication <xref rid="b0055" ref-type="bibr">[11]</xref>, where any clusters of methylated sites would be classified as MR: (1) if there are at least <italic>N</italic> (the default is 5 for gene body/intergenic/5′Distance and 3 for TSS/TES) 5mC/5hmC sites in the region, and (2) the distance between two consecutive methylated sites is not greater than <italic>a</italic> bp (the default is 2000 bp). CpGs in an MR can have increasing or decreasing trend of methylation and this trend can be similar or mixed in the case and control samples. HMST-Seq-Analyzer allows restricting the DMR search to same methylation trend by using an additional parameter in the DMR search function (−isST = 1 or 0 will force all CpG sites in the same MR shall have the same or mixed changing trend, respectively) <xref rid="b0055" ref-type="bibr">[11]</xref>. These parameters can be easily changed by command line options. For WGBS and RRBS data, slightly modified parameters can be used to search MRs (e.g., N = 3 and a = 2000 bp for WGBS; N = 2 and a = 200 bp for RRBS). Alternatively, the package also provides an equal sized sliding window bin approach which can be applied on the data to search for MRs. This option is suggested for large and dense data set such as WGBS.</p>
      </sec>
      <sec id="s0035">
        <label>2.3.2</label>
        <title>Identification of differentially methylated regions</title>
        <p id="p0085">The current package performs pair-wise or multiple samples comparison for differential methylation analysis (e.g., one control versus one case, or one/multiple controls versus one/multiple cases). Therefore, MRs or methylation sites need to be available in both conditions before performing a significant differential methylation analysis. Unfortunately, due to DNA sequencing variation and many other uncontrollable reasons in methylation experiments, some methylation signals may be missing in one of the conditions, even if from technical replicates. This is a missing value problem in sequencing data analysis, which is the first challenge in differential methylation analysis. A missing value indicates that methylation level at a position is not recorded as an experimental error or it was an unmethylated state and a methylation level was recorded as zero. There are three possible ways to deal with the missing value: ignoring, deletion, or imputation. The first two options cannot be good options because they can result in loss of an important DMR. Therefore, all missing values are imputed in the current pipeline before identifying DMRs. For less computational cost, the missing values can simply be replaced by the median of methylations in an MR or by zeros (default, because it resembles a possible real unmethylated state). Alternatively, a nearest neighbour data imputation method can be applied on an MR with missing values, but this method will have heavy computational burden. After finding MRs sharing the same locus in both conditions and imputing the missing values, the pipeline applies the Wilcoxon Rank-sum test to evaluate the significance of differentially methylated MRs as used by many similar studies <xref rid="b0055" ref-type="bibr">[11]</xref>, <xref rid="b0090" ref-type="bibr">[18]</xref>, <xref rid="b0150" ref-type="bibr">[30]</xref>. There are three versions of the Wilcoxon Rank-sum test available in the pipeline: Pranksum, Mranksum, and Rranksum. Pranksum is a Python implementation of the <italic>P-value</italic> computation for the Wilcoxon rank-sum test:<disp-formula id="e0005"><mml:math id="M1" altimg="si1.svg"><mml:mrow><mml:mi>p</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mfenced open="{"><mml:mtable><mml:mtr><mml:mtd><mml:mi>e</mml:mi><mml:mi>x</mml:mi><mml:mi>a</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi><mml:mspace width="0.25em"/><mml:mspace width="0.25em"/><mml:mspace width="0.25em"/><mml:mspace width="0.25em"/><mml:mspace width="0.25em"/><mml:mspace width="0.25em"/><mml:mspace width="0.25em"/><mml:mspace width="0.25em"/><mml:mspace width="0.25em"/><mml:mspace width="0.25em"/><mml:mspace width="0.25em"/><mml:mspace width="0.25em"/><mml:mspace width="0.25em"/><mml:mspace width="0.25em"/><mml:mspace width="0.25em"/><mml:mspace width="0.25em"/><mml:mspace width="0.25em"/><mml:mspace width="0.25em"/><mml:mspace width="0.25em"/><mml:mspace width="0.25em"/><mml:mspace width="0.25em"/><mml:mspace width="0.25em"/><mml:mspace width="0.25em"/><mml:mspace width="0.25em"/><mml:mspace width="10.0pt"/><mml:mi>i</mml:mi><mml:mi>f</mml:mi><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:mn>10</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>n</mml:mi><mml:mi>w</mml:mi><mml:mi>h</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi><mml:mi>n</mml:mi><mml:mi>e</mml:mi><mml:mi>y</mml:mi><mml:mi>u</mml:mi><mml:mspace width="0.25em"/><mml:mspace width="0.25em"/><mml:mspace width="0.25em"/><mml:mspace width="0.25em"/><mml:mspace width="0.25em"/><mml:mspace width="0.25em"/><mml:mspace width="0.25em"/><mml:mspace width="0.25em"/><mml:mspace width="10.0pt"/><mml:mi>o</mml:mi><mml:mi>t</mml:mi><mml:mi>h</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>w</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mi>e</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:mfenced></mml:mrow></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="M2" altimg="si2.svg"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>x</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> is the number of 5mC/5hmC sites in an MR, <inline-formula><mml:math id="M3" altimg="si3.svg"><mml:mrow><mml:mi mathvariant="italic">exact</mml:mi></mml:mrow></mml:math></inline-formula> is a Python implementation of the exact enumeration of P-value <xref rid="b0155" ref-type="bibr">[31]</xref> when the sample size is small (this is a contribution of this research work in the pipeline), and <inline-formula><mml:math id="M4" altimg="si4.svg"><mml:mrow><mml:mi mathvariant="italic">mannwhitneyu</mml:mi></mml:mrow></mml:math></inline-formula> is a function from Python library scipy.stats that performs a two-sided Mann-Whitney <italic>U</italic> test or Wilcoxon rank-sum test. The exact calculation of P-value is recommended when there are less than 10 methylation sites in a MR. For a large sample size, an approximation of P-value can be obtained from Python’s Mann-Whitney <italic>U</italic> test function. Mranksum is a Matlab version of rank-sum test, which is computed as following:<disp-formula id="e0010"><mml:math id="M5" altimg="si5.svg"><mml:mrow><mml:mi>p</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mfenced open="{"><mml:mtable><mml:mtr><mml:mtd><mml:mi mathvariant="italic">exact</mml:mi><mml:mspace width="0.25em"/><mml:mspace width="0.25em"/><mml:mspace width="0.25em"/><mml:mspace width="0.25em"/><mml:mspace width="0.25em"/><mml:mspace width="0.25em"/><mml:mspace width="0.25em"/><mml:mspace width="0.25em"/><mml:mspace width="0.25em"/><mml:mspace width="0.25em"/><mml:mspace width="0.25em"/><mml:mspace width="10.0pt"/><mml:mi>i</mml:mi><mml:mi>f</mml:mi><mml:mspace width="10.0pt"/><mml:mi>min</mml:mi><mml:mrow><mml:mfenced><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mo>&lt;</mml:mo><mml:mn>10</mml:mn><mml:mspace width="0.25em"/><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>d</mml:mi><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:mn>20</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>a</mml:mi><mml:mi>p</mml:mi><mml:mi>p</mml:mi><mml:mi>r</mml:mi><mml:mi>o</mml:mi><mml:mi>x</mml:mi><mml:mi>i</mml:mi><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mspace width="0.25em"/><mml:mspace width="0.25em"/><mml:mspace width="0.25em"/><mml:mspace width="0.25em"/><mml:mspace width="0.25em"/><mml:mspace width="0.25em"/><mml:mspace width="0.25em"/><mml:mspace width="0.25em"/><mml:mspace width="0.25em"/><mml:mspace width="0.25em"/><mml:mspace width="0.25em"/><mml:mspace width="0.25em"/><mml:mspace width="0.25em"/><mml:mspace width="0.25em"/><mml:mspace width="0.25em"/><mml:mspace width="0.25em"/><mml:mspace width="0.25em"/><mml:mspace width="0.25em"/><mml:mspace width="0.25em"/><mml:mspace width="0.25em"/><mml:mspace width="0.25em"/><mml:mspace width="0.25em"/><mml:mspace width="0.25em"/><mml:mspace width="0.25em"/><mml:mspace width="0.25em"/><mml:mspace width="0.25em"/><mml:mspace width="0.25em"/><mml:mspace width="0.25em"/><mml:mspace width="0.25em"/><mml:mspace width="0.25em"/><mml:mspace width="0.25em"/><mml:mspace width="0.25em"/><mml:mspace width="0.25em"/><mml:mspace width="0.25em"/><mml:mspace width="0.25em"/><mml:mspace width="0.25em"/><mml:mspace width="0.25em"/><mml:mspace width="0.25em"/><mml:mspace width="0.25em"/><mml:mspace width="0.25em"/><mml:mspace width="0.25em"/><mml:mspace width="0.25em"/><mml:mspace width="0.25em"/><mml:mspace width="10.0pt"/><mml:mi>o</mml:mi><mml:mi>t</mml:mi><mml:mi>h</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>w</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mi>e</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:mfenced></mml:mrow></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="M6" altimg="si3.svg"><mml:mrow><mml:mi mathvariant="italic">exact</mml:mi></mml:mrow></mml:math></inline-formula> is the exact computation of the P-value when sample size is small, and <italic>approximate</italic> is the Matlab function of the two-sided Wilcoxon rank-sum test. Hence, the pipeline also offers Rranksum, which is the wilcox.test function of R. It computes P-values as follows:<disp-formula id="e0015"><mml:math id="M7" altimg="si6.svg"><mml:mrow><mml:mi>p</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mfenced open="{"><mml:mtable><mml:mtr><mml:mtd><mml:mi mathvariant="italic">exact</mml:mi><mml:mspace width="0.25em"/><mml:mspace width="0.25em"/><mml:mspace width="0.25em"/><mml:mspace width="0.25em"/><mml:mspace width="0.25em"/><mml:mspace width="0.25em"/><mml:mspace width="0.25em"/><mml:mspace width="0.25em"/><mml:mspace width="0.25em"/><mml:mspace width="0.25em"/><mml:mspace width="0.25em"/><mml:mspace width="0.25em"/><mml:mspace width="0.25em"/><mml:mspace width="10.0pt"/><mml:mi>i</mml:mi><mml:mi>f</mml:mi><mml:mspace width="10.0pt"/><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:mn>50</mml:mn><mml:mspace width="0.25em"/><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>d</mml:mi><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:mn>20</mml:mn><mml:mspace width="0.25em"/><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>d</mml:mi><mml:mspace width="0.25em"/><mml:mi>n</mml:mi><mml:mi>o</mml:mi><mml:mspace width="0.25em"/><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>e</mml:mi><mml:mi>s</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>a</mml:mi><mml:mi>p</mml:mi><mml:mi>p</mml:mi><mml:mi>r</mml:mi><mml:mi>o</mml:mi><mml:mi>x</mml:mi><mml:mi>i</mml:mi><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mspace width="0.25em"/><mml:mspace width="0.25em"/><mml:mspace width="0.25em"/><mml:mspace width="0.25em"/><mml:mspace width="0.25em"/><mml:mspace width="0.25em"/><mml:mspace width="0.25em"/><mml:mspace width="0.25em"/><mml:mspace width="0.25em"/><mml:mspace width="0.25em"/><mml:mspace width="0.25em"/><mml:mspace width="0.25em"/><mml:mspace width="0.25em"/><mml:mspace width="0.25em"/><mml:mspace width="0.25em"/><mml:mspace width="0.25em"/><mml:mspace width="0.25em"/><mml:mspace width="0.25em"/><mml:mspace width="0.25em"/><mml:mspace width="0.25em"/><mml:mspace width="0.25em"/><mml:mspace width="0.25em"/><mml:mspace width="0.25em"/><mml:mspace width="0.25em"/><mml:mspace width="0.25em"/><mml:mspace width="0.25em"/><mml:mspace width="0.25em"/><mml:mspace width="0.25em"/><mml:mspace width="0.25em"/><mml:mspace width="0.25em"/><mml:mspace width="0.25em"/><mml:mspace width="0.25em"/><mml:mspace width="0.25em"/><mml:mspace width="0.25em"/><mml:mspace width="0.25em"/><mml:mspace width="0.25em"/><mml:mspace width="0.25em"/><mml:mspace width="0.25em"/><mml:mspace width="0.25em"/><mml:mspace width="0.25em"/><mml:mspace width="0.25em"/><mml:mspace width="0.25em"/><mml:mspace width="10.0pt"/><mml:mi>o</mml:mi><mml:mi>t</mml:mi><mml:mi>h</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>w</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mi>e</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:mfenced></mml:mrow></mml:mrow></mml:math></disp-formula></p>
        <p id="p0090">However, the R version of the rank-sum test does not have tie correction and is much slower than both Matlab and Python implementation. MATLAB is a commercial license software that users might not have access to. A performance comparison of the three methods for DMR detection is provided in <xref rid="s0120" ref-type="sec">SFigs. 2 and 3</xref>. One of these three methods should be chosen based on the resources available. Alternative statistic test methods are also implemented in the HMST-Seq-Analyzer for identifying DMRs such as two sampled T-test <xref rid="b0110" ref-type="bibr">[22]</xref> and Kolmogorov-Smirnov test <xref rid="b0160" ref-type="bibr">[32]</xref>. In the future, more advanced methods (e.g. the Beta-binomial method <xref rid="b0115" ref-type="bibr">[23]</xref>) will be considered in the pipeline. Pranksum is the default setting in HMST-Seq-Analyzer.</p>
        <p id="p0095">For each MR, the significance of differential methylation between the two conditions is evaluated by a <italic>P-value</italic>. Correction of the <italic>P-value</italic> by either without (default) or with Benjamini-Hochberg false discovery rate <xref rid="b0165" ref-type="bibr">[33]</xref> is implemented in the package. MRs with P-values crossing the predefined threshold (e.g., p &lt; 0.05 by default) are considered as DMRs. Here, an identified DMR can either exhibit an increase or a decrease in methylation levels between the two conditions, termed as hyper or hypomethylation, respectively. For that reason, a relative ratio (<italic>rratio</italic>) approach <xref rid="b0170" ref-type="bibr">[34]</xref> is used to distinguish between the Hyper-DMRs and the Hypo-DMRs. It is given by the following formula:<disp-formula id="e0020"><mml:math id="M8" altimg="si7.svg"><mml:mrow><mml:mi mathvariant="italic">rratio</mml:mi><mml:mo linebreak="goodbreak">=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mi mathvariant="italic">KO</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mi mathvariant="italic">WT</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mi mathvariant="italic">KO</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mi mathvariant="italic">WT</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mn>2</mml:mn></mml:mfrac><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula>where µ<sub>KO</sub> is the median of the original methylated levels in the case (KO) data, and µ<sub>WT</sub> is the median of the original methylated levels in the control (WT) data. A DMR is considered as hypermethylated or hypomethylated when the <italic>rratio</italic> is greater than or smaller than zero, respectively. As an option, users can also plot all DMRs to investigate their quality or may run the DMR search function again by using new parameters (e.g., a new P-value threshold or a new P-value correction method).</p>
      </sec>
    </sec>
    <sec id="s0040">
      <label>2.4</label>
      <title>Annotation of DMRs</title>
      <p id="p0100">The pipeline also annotates all the hypo/hyper-DMRs to the genomic regions (TSS, TES, gene body, intergenic, 5′ distance and any given region like enhancers). As a result, lists of DMRs are categorically exported for each region with a corresponding P-value for each DMR. Moreover, a list of gene names having DMRs associated to their TSS, TES or gene body is also exported.</p>
    </sec>
    <sec id="s0045">
      <label>2.5</label>
      <title>Visualization and statistical summary of results</title>
      <p id="p0105">Three main figures in the results provide a statistical summary of the genome-wide methylation status: 1) relative density of 5mC/5hmC (e.g., methylation levels &gt;1 and &gt;0.5 for HMST-Seq <xref rid="b0055" ref-type="bibr">[11]</xref> and WGBS/RRBS data, respectively) in defined genomic regions (e.g, TSS, TES, gene body, enhancer, 5′ distance, and intergenic regions) or genome-wide; 2) percentage of hyper-/hypomethylated DMRs in TSS, TES, gene body, 5′ distance, and intergenic regions; 3) a genomic average of 5mC/5hmC levels in TSS-Gene-TES regions or enhancer regions. To plot the genomic average of 5mC and 5hmC levels in TSS, TES, gene body or enhancer regions, the package maps MRs of these regions to a new uniform range that equalizes all genes' length <xref rid="b0155" ref-type="bibr">[31]</xref>. Here, one-dimensional nearest-neighbour algorithm was used to interpolate methylation data when mapping the original data to a new range. Subsequently, the mean of methylation levels of all genes was calculated in the new equalized range, where a centred moving average method is used to smooth the data as follows:<disp-formula id="e0025"><mml:math id="M9" altimg="si8.svg"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="italic">MA</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msub><mml:mo linebreak="goodbreak">=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>n</mml:mi></mml:mfrac><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:msub><mml:mi>A</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></disp-formula></p>
      <p id="p0110">Here, <italic>n</italic> is the window size, and A<italic><sub>i</sub></italic> is the data point at the <italic>i</italic>th position. The window size is the number of observations used for calculating the statistic. In order to reduce noise when plotting the genome-wide average of methylation profiles, a one-dimensional Gaussian filter <xref rid="b0175" ref-type="bibr">[35]</xref> is applied to further smooth the mean data before plotting them in TSS, gene body and TES regions in a single plot. The effect of the data smoothing is illustrated in <xref rid="s0120" ref-type="sec">SFig. 4</xref>. The genome-wide average methylation level of enhancers can be plotted in a similar way. The pipeline also exports the plot data for external visualization and analysis by users. For more information of implementation, package comparison and performance (e.g., CPU hours and memory consumption) please refer to (<ext-link ext-link-type="uri" xlink:href="http://urn.nb.no/URN%3aNBN%3ano-76419" id="ir010">http://urn.nb.no/URN:NBN:no-76419</ext-link>).</p>
    </sec>
    <sec id="s0050">
      <label>2.6</label>
      <title>Methylation data</title>
      <p id="p0115">HMST-Seq-Analyzer can handle two types of data: methylation and hydroxymethylation, from three different DNA sequencing approaches (e.g., HMST-Seq, WGBS, and RRBS). There are two types of methylation input data: 1) a bed formatted file containing methylation percentage per base, used for WGBS or RRBS data. 2) a TSV file containing normalized tag count per base from 3 libraries of HMST-seq data. The pipeline has been tested successfully in CpG, CHG, and CHH methylation from WGBS, RRBS, and HMST-seq. For WGBS, Human lymphoblastoid cell line (GM12878) and human embryonic stem cell line (H1) from ENCODE data sets are used as test and control set, respectively <xref rid="b0045" ref-type="bibr">[9]</xref>. For RRBS, TET knockout mice data was used <xref rid="b0180" ref-type="bibr">[36]</xref>. HMST-seq data was acquired from a study conducted on two hepato cellular carcinoma (HCC) cell lines (97L and LM6 cells), and a non-HCC sample <xref rid="b0090" ref-type="bibr">[18]</xref>.</p>
    </sec>
    <sec id="s0055">
      <label>2.7</label>
      <title>Gene annotation</title>
      <p id="p0120">As DMR detection will be spanned around annotated genomic regions, gene annotation information is needed. The reference genome file is a simple tab separated text file containing the chromosome number and the size of respective chromosome, which were prepared according to assembly and species of the input samples (e.g., hg19 and mm10 chromosome size information <xref rid="b0125" ref-type="bibr">[25]</xref>). If a bed formatted enhancer position file is available, then the pipeline can map DMRs to enhancer regions. This enhancer option can be used to map DMRs across any other regions as well e.g. CpG islands.</p>
    </sec>
    <sec id="s0060">
      <label>2.8</label>
      <title>Computational efficiency of HMST-Seq-Analyzer</title>
      <p id="p0125">In order to make the pipeline suitable for large data sets, HMST-Seq-Analyzer modules <italic>Find MRs, Preparation for DMR Search,</italic> and <italic>DMR Search</italic> are optimized for parallel computation specifically. The input argument <italic>-p</italic> is used to define the number of CPUs a user wants to use. As a result, the corresponding task is automatically parallelized either on a single multi-core machine, or on a high-performance computer. HMST-Seq-Analyzer was tested on both a small and a large dataset to evaluate the efficiency. For small data set (~4.5 MB), chromosome 1 from a HMST-Seq mouse data was used with 70,201 and 71,646 tag counts for the KO and WT samples, respectively. For a large data set (~66 MB), the whole HMST-Seq mouse (20 chromosome) data set was used with KO (1037346 tag counts) and WT (1054613 tag counts) condition sample, respectively. The test was run on 5 CPUs with 4G memory on SAGA computer cluster at Norwegian University of Science and Technology.</p>
    </sec>
  </sec>
  <sec id="s0065">
    <label>3</label>
    <title>Results and discussion</title>
    <sec id="s0070">
      <label>3.1</label>
      <title>Differential methylation analysis of HMST-Seq data</title>
      <p id="p0130">Numerous studies have reported a role of altered methylation of tumor suppressor genes in the pathogenesis of human hepatocellular carcinoma (HCC) <xref rid="b0185" ref-type="bibr">[37]</xref>. In addition, 5-hmC levels are reported to be lower in HCC tissues in comparison to non-tumor tissues <xref rid="b0190" ref-type="bibr">[38]</xref>. Simultaneous inspection of 5mC and 5hmC levels in HCC can reveal important characteristics of epigenetic alterations in HCC. In a study by F. Gao <italic>et al.</italic>, HMST-seq was performed on two HCC cell lines (97L and LM6 cells), and a non-HCC sample <xref rid="b0090" ref-type="bibr">[18]</xref>. In this work, HMST-Seq-Analyzer with default parameters on chromosome 1 of this dataset was run and tag counts were aligned to the same human reference genome (hg19). All results and figures were generated by a single run of HMST-Seq-Analyzer on both 5mC and 5hmC data simultaneously. <xref rid="f0010" ref-type="fig">Fig. 2</xref> shows that there is not a strong difference between hyper-DMRs and hypo-DMRs distributions in different genomic regions. However, a lower number of hyper-DhMRs but higher number of hypo-DhMRs in HCC cell lines as compared to the non-HCC cell line (lower panel of <xref rid="f0010" ref-type="fig">Fig. 2</xref>), especially in TSS regions are clearly seen. <xref rid="f0015" ref-type="fig">Fig. 3</xref> suggests that the number of significantly modified 5mC and 5hmC sites are lower and higher for the non-HCC sample in all genomic regions (especially in TSS) than that of HCC samples, respectively. In <xref rid="f0020" ref-type="fig">Fig. 4</xref>, the 5mC levels around TSS seem to be slightly higher in the HCC samples than in the non-HCC sample. In contrast, 5hmC levels are increased more than twofold around TSS in non-HCC compared to HCC samples. Another study also found uneven distribution of 5mC and 5hmC in TSS regions of tumor samples as compared to non-tumor samples <xref rid="b0195" ref-type="bibr">[39]</xref>. They observed overall high 5mC levels and lower 5hmC levels in tumor tissues. These results are also in agreement with the results predicted by HMST-Seq-Analyzer as shown in <xref rid="f0010" ref-type="fig">Fig. 2</xref>, where ~70% of MRs in the TSS region are DhMRs while only ~10% are DMRs. Thus, our new pipeline reproduces the results of the original publication in a single run, which simplifies the data interpretation. More interesting results can be found if the pipeline is run on the complete data set. For example, significantly differentially methylated genes for hepatocellular carcinoma can be drawn out from the gene list exported by the proposed tool.<fig id="f0010"><label>Fig. 2</label><caption><p>Distribution of differentially methylated (or hydromethylated) regions (DMRs/DhMRs) between the two HCC cell lines (97L and LM6) and a non-HCC sample (NO45268) in five types of genomic regions. HMST-Seq-Analyzer was applied on publicly available HMST-Seq data of three samples (two liver cancer cell lines and one normal liver sample) simultaneously. Hyper/Hypo DMRs/DhMRs between the two liver cancer samples and one normal sample were identified by the pipeline automatically. The distribution of these DMRs/DhMRs were mapped to five types of genomic regions (gene body, 5′ distance region, intergenic region, TSS, and TES) by the HMST-Seq-Analyzer. Here, the 5′ distance region is defined as the upstream of TSS from 10 Kb to 100 Kb, and the intergenic regions are genomic regions excluding gene body, TSS and TES which with the minimum and maximum length 2 Kb and 100 Kb, respectively. There is the same changing trend in each MR before using Kolmogorov-Smirnov test to predict the DMRs/DhMRs.</p></caption><graphic xlink:href="gr2"/></fig><fig id="f0015"><label>Fig. 3</label><caption><p>The relative density of significantly modified 5mC (or 5hmC) sites in the two HCC cell lines (97L and LM6) and one non-HCC sample, within the five types of genomic regions. HMST-Seq-Analyzer was applied on public available HMST-Seq data of three samples (two liver cancer cell lines and one normal liver sample) simultaneously. Significantly modified (methylation/hydromethylation levels &gt; 1) 5mC/5hmC sites in the three samples were identified and their relative density in five types of genomic regions (gene body, 5′ distance region, intergenic region, TSS, and TES) was calculated by the pipeline automatically. The 5′ distance region is defined as the upstream of TSS from 10 Kb to 100 Kb. The intergenic regions are regions excluding gene body, TSS and TES, which with the minimum and maximum length 2 Kb and 100 Kb, respectively.</p></caption><graphic xlink:href="gr3"/></fig><fig id="f0020"><label>Fig. 4</label><caption><p>The distribution of genome-wide average of 5mC <italic>(or 5hmC)</italic> levels in TSS-Gene-TES regions for both HCC cell lines (97L and LM6) and non-HCC sample. HMST-Seq-Analyzer was applied on publicly available HMST-Seq data of three samples (two liver cancer cell lines and one normal liver sample) simultaneously. Methylated regions (MRs) of 5mC and 5hmC in three different samples are identified by the pipeline in TSS, TES, and gene body regions, respectively. A genomic average of 5mC/5hmC levels in all TSS-Gene-TES regions are calculated, where a centred moving average method is applied to smooth the data. Subsequently, one-dimensional Gaussian filter is used to reduce noise in smoothed mean data before plotting the genome-wide average of methylation levels in TSS-Gene-TES region.</p></caption><graphic xlink:href="gr4"/></fig></p>
    </sec>
    <sec id="s0075">
      <label>3.2</label>
      <title>A comparison of HMST-Seq-Analyzer and MethylKit in analysing differentially methylated CpG sites</title>
      <p id="p0135">Currently, there is lack of publicly available tools for analysing HMST-Seq data. To evaluate the robustness of differential methylation analysis in HMST-Seq-Analyzer, results are compared to a popular tool - MethylKit, which uses Fisher’s Exact Test (FET) to identify differentially methylated CpG sites (DMCs) <xref rid="b0105" ref-type="bibr">[21]</xref> in WGBS or RRBS data.</p>
      <sec id="s0080">
        <label>3.2.1</label>
        <title>HMST-Seq Analyzer recovers MethylKit DMCs in WGBS</title>
        <p id="p0140">Here, a WGBS data set for human genome was gathered from the ENCODE project. Human lymphoblastoid cell line (GM12878) and human embryonic stem cell line (H1) are used as test and control set, respectively <xref rid="b0045" ref-type="bibr">[9]</xref>. Raw sequencing data set was mapped to hg38. Due to enormity of WGBS data, it was split chromosome wise for analysis on both tools. Results were later combined for whole-genome level analysis. The default parameters of HMST-Seq-Analyzer were used, except for shortening the 5′-Distance regions between 10 kbp to 50 kbp from TSS, in order to reduce the computation time. For MethylKit, a q-value &lt; 0.05 with minimum percent methylation difference cut-off of 25% are used to identify differentially methylated cytosines (DMCs). For HMST-Seq-Analyzer, we extracted DMCs from our predicted DMRs before comparing them to those provided by MethylKit. In total, HMST-Seq-Analyzer and MethylKit reported 47 million and 11 million DMCs sites, respectively. HMST-Seq-Analyzer recovered 97.6% of the mCs reported by MethylKit (<xref rid="f0025" ref-type="fig">Fig. 5</xref>). While MethylKit reports only individual DMCs, HMST-Seq-Analyzer gives much more information along recovering almost all the DMCs reported by MethylKit.<fig id="f0025"><label>Fig. 5</label><caption><p>Whole-genome DMC comparison for WGBS (HMST-Seq-Analyzer VS MethylKit). Number of genome-wide DMCs predicted by HMST-Seq and MethylKit are shown in figure. Unique DMCs predicted by HMST-Seq-Analyzer are represented in Pink, by MethylKit in green and overlapping in brown, respectively. Both HMST-Seq-Analyzer and MethylKit were run in default parameters. Here, ~98% of the DMCs identified by MethylKit are overlapping with DMCs predicted by HMST-Seq-Analyzer. (For interpretation of the references to colour in this figure legend, the reader is referred to the web version of this article.)</p></caption><graphic xlink:href="gr5"/></fig></p>
      </sec>
      <sec id="s0085">
        <label>3.2.2</label>
        <title>A comparison of HMST-Seq-Analyzer and MethylKit in RRBS</title>
        <p id="p0145">In this comparison, RRBS data was obtained from experiments with TET knockout mice <xref rid="b0180" ref-type="bibr">[36]</xref>. Both HMST-Seq-Analyzer and MethylKit were applied on the same data, to detect differential methylation events between TET1 and TET2 double knockout and wild type mice. In terms of the number of CpGs per kb, RRBS has much sparse methylation sites than that in WGBS, hence we performed whole-genome differential methylation detection in a single batch. For MethylKit, the default parameters were used for detecting genome-wide DMCs. For example, a q-value &lt; 0.05 with minimum percent methylation difference cut-off of 25% was used to identify DMCs as used in the source publication <xref rid="b0180" ref-type="bibr">[36]</xref>. For HMST-Seq-Analyzer, genome-wide DMCs were extracted from DMRs reported by the package before comparing with the MethylKit results, where the number of minimum consecutive sites is 2, adjacency is 200 bp, the same methylation changing trend, and T-test were used in DMR analysis. HMST-Seq-Analyzer reported 4242 DMCs in its DMRs, while MethylKit reported 15,756 DMCs in total, in which ~48% of the DMCs obtained from HMST-Seq-Analyzer overlap with MethylKit DMCs (<xref rid="s0120" ref-type="sec">SFig. 5</xref>). If the same methylation changing trend is disabled in HMST-Seq-Analyzer, then the percentage of overlapping DMCs drops slightly to 46% (<xref rid="s0120" ref-type="sec">SFig. 6</xref>). Though half of the predicted DMCs by HMST-Seq-Analyzer are recovered by MethylKit, HMST-Seq-Analyzer gives much fewer DMCs than MethylKit. This is mainly caused by the two packages using entirely different methods to predict DMCs. HMST-Seq-Analyzer has a restriction of adjacency in nearby CpGs and of minimum number of CpGs in MR. Moreover, DMCs are extracted from the predicted DMRs by using T-test. On the contrary, MethylKit is designed to report DMCs only but does not consider the spatial distribution of CpGs in a MR, and the significance of DMCs is tested on individual CpG directly based on Fishers’ exact test.</p>
        <p id="p0150">In further analysis, a correlation between the percentage of overlapping DMCs and the change of adjacency in HMST-Seq-Analyzer is studied. DMCs predicted by HMST-Seq-Analyzer with different adjacencies are compared against to the prediction of MethylKit with default parameters. The result in <xref rid="s0120" ref-type="sec">SFig. 7</xref> suggests that a smaller adjacency in HMST-Seq-Analyzer gives a higher percentage of overlap between the two methods. For example, the percentage of overlapping DMCs is increased from about 41% to 51%, when the CpG adjacency is reduced from 3000 bp to 100 bp. Therefore, the discrepancy of predictions between the two packages is expected, which is mainly due to the difference in prediction method such as the restriction of spatial distribution for nearby CpGs in HMST-Seq-Analyzer. A list of optimal parameters for HMST-Seq-Analyzer is provided in the package. For RRBS data analysis, it is recommended to use adjacency of 200 bp (<italic>−a</italic> = 200), the same methylation changing trend (−<italic>isST = 1</italic>), a minimum number of 2 consecutive sites (<italic>−mc1</italic> = 2, −<italic>mc2</italic> = 2, −mc3 = 2) and T-test for DMR prediction. For WGBS data, we suggest to use window bin size 200 bp (−W = yes, −a = 200), a minimum of 3 consecutive sites (<italic>−mc1</italic> = 3, −<italic>mc2</italic> = 5, −<italic>mc3</italic> = 3) and T-test for detecting DMRs. In case of HMST-seq, the default parameters are adjacency 2 kb, a minimum of 3 consecutive sites (<italic>−mc1</italic> = 3, <italic>mc3</italic> = 3) and 5 (<italic>−mc2</italic> = 5) for TSS/TES/enhancer and gene body/5′ distance/intergenic regions, respectively. More information of optimal parameter selection for HMST-Seq-Analyzer is included in the package.</p>
      </sec>
      <sec id="s0090">
        <label>3.2.3</label>
        <title>HMST-Seq Analyzer captures important information that is missed by MethylKit</title>
        <p id="p0155">To further evaluate the results between the two tools, we focus on the promoter regions (±1 Kb to TSS) from the first round of RRBS analysis with default parameters. HMST-Seq-Analyzer reported 291 genes having more than two DMCs in the promoter regions (<xref rid="s0120" ref-type="sec">STable 1</xref>). For MethylKit, it reported a total of 3938 genes with DMCs in the promoters but the majority (61%) of them had only one DMC (<xref rid="s0120" ref-type="sec">SFig. 8</xref>). There are 91 genes overlapping between the MethylKit and HMST-Seq-Analyzer results (<xref rid="s0120" ref-type="sec">STable 2</xref>). For instance, Atf4 which is a transcription factor, was reported as having DMCs occurring at the promoter region by both tools (<xref rid="f0030" ref-type="fig">Fig. 6</xref>a). Because of the wide difference in results from the two tools, it is interesting to perform functional gene annotation on the two gene lists. DAVID tools was used for this analysis <xref rid="b0200" ref-type="bibr">[40]</xref>. GO results (P-value &lt; 0.05) of the genes predicted exclusively by HMST-Seq-Analyzer (~200) and MethylKit (e.g., the top 200) are presented in <xref rid="s0120" ref-type="sec">STables 3 and 4</xref>, respectively. The highest number of genes (20) predicted by HMST-Seq-Analyzer are involved in organismal development (<xref rid="s0120" ref-type="sec">STable 3</xref>). This was also reported in the original study that deletion of TET proteins impairs differentiation in embryonic stem cells, which is clearly linked to organismal development <xref rid="b0180" ref-type="bibr">[36]</xref>. Since there were too many MethylKit predicted genes (&gt;3800) with DMCs in promoters to give a meaningful gene enrichment test, the top 200 differentially methylated genes (on the basis of the P-value from MethylKit) were selected for functional gene annotation (<xref rid="s0120" ref-type="sec">STable 4</xref>). Here, genes were reported to be involved in 15 different processes, with the highest number of them being linked to transcription (GO:0006351, 23 genes) and negative regulation of transcription (GO:0000122, 14 genes). However, the original study reports <xref rid="b0180" ref-type="bibr">[36]</xref> that while the TET protein deletion did alter the DNA methylation at some promoters, it did not correlate with the corresponding gene expression changes. Moreover, percentage of genes with only 1 DMC in the promoter further increases to ~70% in the top 200 results of MethylKit (<xref rid="s0120" ref-type="sec">SFig. 9</xref>). A similar result (<xref rid="s0120" ref-type="sec">STable 5</xref>) was obtained when the same analysis was repeated with the top 500 genes from the MethylKit prediction.<fig id="f0030"><label>Fig. 6</label><caption><p>HMST-Seq-Analyzer predicted DMR at TSS of multiple genes. Panels a and b are for genes Atf4 and Hoxd12 respectively. The first track represents the methylation level at mCs from wild type (WT) by orange bars, with the height of each vertical bar representing percentage of methylation. The second track represents the methylation level at mCs from TET1, TET2 double knock out (DKO) in green. The third track represents DMRs detected by HMST-Seq-Analyzer in red. The fourth track presents DMCs predicted by MethylKit in blue. The fifth track depicts the gene in dark blue. No DMCs were predicted by MethylKit for Hoxd12, hence, the track for methylkit is not included in pancel b. (For interpretation of the references to colour in this figure legend, the reader is referred to the web version of this article.)</p></caption><graphic xlink:href="gr6"/></fig></p>
        <p id="p0160">Literature evidences of a few genes predicted by HMST-Seq-Analyzer but missed by MethylKit are provided in <xref rid="t0005" ref-type="table">Table 1</xref>, where the gene Hoxd12 is particularly interesting because it is directly targeted by TET1 <xref rid="b0205" ref-type="bibr">[41]</xref>. TET1 is involved in active demethylation and decreased recruitment of TET1 to the HOXD12 gene results in increased methylation of HOXD12. HOXD12 is also reported to have hypermethylated CpG as a potential marker for stage 1 lung squamous cell carcinoma <xref rid="b0210" ref-type="bibr">[42]</xref>. Hence, HOXD12 must specifically be reported as differentially methylated in the TET knockout data. While MethylKit failed to identify HOXD12 as differentially methylated, HMST-Seq-Analyzer not only reported it as differentially methylated but also correctly categorized it as hypermethylated as expected in absence of TET proteins (<xref rid="f0030" ref-type="fig">Fig. 6</xref>b). In <xref rid="f0035" ref-type="fig">Fig. 7</xref>, the distribution of mCs in this DMR was plotted by HMST-Seq-Analyzer, where the methylation levels from TET knock out and wild type are different. For the sites 2–4 in <xref rid="f0035" ref-type="fig">Fig. 7</xref>, the WT sample provided no methylation information for the highly methylated sites in KO. MethylKit relies on single base pair differential methylation analysis that discards such sites with missing values, which failed to capture the DMCs in promoter of HOXD12. It is reasonable to assume that WT mCs at sites 2–4 experienced demethylation in presence of TET proteins and consider them in analysis, instead of assuming that the three consecutive sites experienced experimental error and ignoring them. This argument is more plausible especially when mCs sites 2–4 are not partially but fully methylated in the KO sample.<table-wrap position="float" id="t0005"><label>Table 1</label><caption><p>Literature evidence for genes predicted by HMST-Seq-Analyzer but missed by MethylKit in differentially methylated CpG sites analysis.</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Gene Name</th><th>Comments</th><th>References</th></tr></thead><tbody><tr><td>Mael</td><td><list list-type="simple" id="l0005"><list-item id="o0005"><label>1)</label><p id="p0005">hypomethylated in colorectal cancer.</p></list-item><list-item id="o0010"><label>2)</label><p id="p0010">Hypermethylation of MAEL promoter in infertile men.</p></list-item><list-item id="o0015"><label>3)</label><p id="p0015">Mael promoter methylation levels are all increased in tet1 tet2 mutants.</p></list-item></list></td><td><xref rid="b0240" ref-type="bibr">[48]</xref>, <xref rid="b0245" ref-type="bibr">[49]</xref></td></tr><tr><td>Hoxd12</td><td><list list-type="simple" id="l0010"><list-item id="o0020"><label>1)</label><p id="p0020">recovered as differentially methylated by swDMR (another tool).</p></list-item><list-item id="o0025"><label>2)</label><p id="p0025">Hoxd12 is targeted by TET1 and decreased recruitment of Tet1 on HOXD12 gene results in increased methylation.</p></list-item><list-item id="o0030"><label>3)</label><p id="p0030">hypermethylated CpGs in HOXD12 gene reported as potential marker for stage 1 lung squamous cell carcinoma.</p></list-item></list></td><td><xref rid="b0150" ref-type="bibr">[30]</xref>, <xref rid="b0205" ref-type="bibr">[41]</xref>, <xref rid="b0210" ref-type="bibr">[42]</xref>, <xref rid="b0150" ref-type="bibr">[30]</xref>, <xref rid="b0210" ref-type="bibr">[42]</xref>, <xref rid="b0250" ref-type="bibr">[50]</xref></td></tr><tr><td>Dazl</td><td><list list-type="simple" id="l0015"><list-item id="o0035"><label>1)</label><p id="p7035">promoter is usually methylated (it’s usually expressed in germ cells, so unmethylated in germ cells only)</p></list-item></list></td><td><xref rid="b0255" ref-type="bibr">[51]</xref></td></tr><tr><td>Shank2</td><td><list list-type="simple" id="l0020"><list-item id="o0040"><label>1)</label><p id="p8040">hyper methylated in prostate cancer</p></list-item></list></td><td><xref rid="b0260" ref-type="bibr">[52]</xref></td></tr><tr><td>Rn45s</td><td><list list-type="simple" id="l0025"><list-item id="o0045"><label>1)</label><p id="p8545">hypo methylated in mice with high maternal folic acid.</p></list-item></list></td><td><xref rid="b0265" ref-type="bibr">[53]</xref></td></tr></tbody></table><table-wrap-foot><fn><p>To identify differentially methylated CpG sites (DMCs), HMST-Seq-Analyzer and MethhylKit were applied on the same RRBS data of TET knockout mice experiments. There are 291 and 3938 genes that contain DMCs in the promoters (+/−1Kb) based on the prediction of HMST-Seq-Analyzer and MethylKit, respectively. Selected genes with literature support are listed here.</p></fn></table-wrap-foot></table-wrap><fig id="f0035"><label>Fig. 7</label><caption><p>Distribution of Methylated Cytosines in HOXD12 DMR predicted by HMST-Seq-Analyzer. The heading of the figure provides information about the DMR in format “chromosome number:start position:end position:strand:gene identifier” followed by the p-values. Circles represent imputed methylation values at each methylated site (blue for wild type/control and green for knockout/case). Diamonds represent original methylation value (orange for wildtype/control and red for knockout/case). (For interpretation of the references to colour in this figure legend, the reader is referred to the web version of this article.)</p></caption><graphic xlink:href="gr7"/></fig></p>
        <p id="p0165">Because relatively low coverage per site increases the sampling variation <xref rid="b0215" ref-type="bibr">[43]</xref>, variation at single sites is usually greater than that of a region. Translating variation on a single CpG site to a differential methylation event can thus be misleading. By imputing the missing values and considering the overall methylation pattern of adjacent CpG sites, HMST-Seq-Analyzer discovers important differentially methylated genes that are completely missed by MethylKit. Therefore, there are two main reasons to the large difference in the number of genes with DMCs in promoters reported by the two tools. MethylKit predicts individual DMCs and then reports the nearest feature (a gene's promoter), hence it reports a huge number of promoters where majority of them (~61%; <xref rid="s0120" ref-type="sec">SFig. 8</xref>) have only one DMC. Labelling whole promoter to be differentially methylated on basis of one DMC can be misleading. On the other hand, HMST-Seq-Analyzer has stringency parameters (e.g., ≥2 DMC at a promoter), which filter out multiple standalone methylated sites. This reduces the total number of promoters reported at the end of analysis, but provides significant results as every DMR would have at least two DMCs. In summary, DMCs predicted by HMST-Seq-Analyzer capture more significant biological events than MethylKit.</p>
      </sec>
    </sec>
    <sec id="s0095">
      <label>3.3</label>
      <title>A comparison of HMST-Seq-Analyzer with more packages for analysing differentially methylated regions</title>
      <p id="p0170">Though no public standalone tool is available for HMST-Seq data analysis, there are several R packages (e.g., BSmooth <xref rid="b0110" ref-type="bibr">[22]</xref>, MethylSig <xref rid="b0115" ref-type="bibr">[23]</xref>, and MethylKit <xref rid="b0105" ref-type="bibr">[21]</xref>) that can be used to detect DMR in WGBS experiments. We used WGBS data for two human cell lines (H1 and IMR90; each cell line with replicate) that included in BSmooth package, to evaluate the performance of DMR prediction in HMST-Seq-Analyzer and three R packages (BSmooth, MethylSig, MethylKit). First, WGBS datasets of the two human cells of the original publication <xref rid="b0220" ref-type="bibr">[44]</xref> were downloaded using R scripts in BSmooth. CpG sites with coverage less than 4 are removed. Then, default settings of each program were used in computation. For example, smoothed methylation levels by the BSmooth function were used in both BSmooth and MethylSig, but raw methylation levels were inputted into MethylKit and HMST-Seq-Analyzer. In each program, missing value imputation and data interpretation were based on the default settings. All calculations were performed on a computer node of the Sigma2 Saga computer cluster at the Norwegian University of Science and Technology.</p>
      <p id="p0175">In selected four packages, the definition of MR is different. Both MethylKit and MethylSig consider MR as either tiling windows (25 bp or default 200 bp) or a set of predefined regions (e.g., promoters). BSmooth defines MR by a maximum gap (default is 300 bp) between adjacent CpG sites and a minimum number (default is 3) of CpG sites in a MR. This is similar to the MR search strategy in HMST-Seq-Analyzer (e.g., default maximum distance between adjacent CpG sites is 2000 bp and minimum 3 CpG sites in a MR). To identify DMRs between the two human cell lines (e.g., H1 versus IMR90), MethylKit, MethylSig, BSmooth and HMST-Seq-Analyzer apply logistic regression test, Beta-binomial test, T-statistics and T-test on MRs with the same changing trend, respectively. Since only HMST-Seq-Analyzer considers both DMR finding and gene annotation simultaneously when searching for DMRs, the time usage for DMR finding and gene annotation was separated in the evaluation. Results of the performance comparison on human chromosome 22 are shown in <xref rid="t0010" ref-type="table">Table 2</xref>, where the detected DMRs from each method were sorted and merged by BEDTools <xref rid="b0225" ref-type="bibr">[45]</xref> before counting their overlap to the predictions from HMST-Seq-Analyzer. In summary, ~80% of DMRs detected in each R package are recovered by HMST-Seq-Analyzer, regardless of the tiling window size (e.g., either 25 bp or 200 bp) that was used in MethylKit and MethylSig. BSmooth has the highest percentage (~86%) of overlapping DMRs with HMST-Seq-Analyzer. A median size of the predicted DMRs from HMST-Seq-Analyzer (~10 Kb) is much longer than that of the other packages (e.g., ~200 to 400 bp). Though HMST-Seq-Analyzer used more running time (~400 s) than most of R packages (e.g., ~60 to 533 s), around 75% of its wall time were used in the gene annotation. Similar results were also obtained from both a median size human chromosome (chr17; <xref rid="s0120" ref-type="sec">STable 6</xref>) and a large human chromosome (chr1; <xref rid="s0120" ref-type="sec">STable 7</xref>), when the same evaluation was performed. Overall, the predicted DMRs from HMST-Seq-Analyzer is robust against those from the three R packages in WGBS data analysis (e.g overlap to ~80% of BSmooth and ~70% of MethylSig/MethylKit predictions). However, the computational efficiency of HMST-Seq-Analyzer needs further improvement by optimizing the gene annotation step during the DMR finding. One advantage of HMST-Seq-Analyzer over the other tools is that it saves time for post processing. A user already knows that every DMR will contain a minimum number of methylated sites and will be annotated to a genomic feature.<table-wrap position="float" id="t0010"><label>Table 2</label><caption><p>A comparison of HMST-Seq-Analyzer and three other packages in differentially methylated region analysis (chr22).</p></caption><table frame="hsides" rules="groups"><thead><tr><th/><th>DMRs</th><th>Overlapping</th><th>Percentage (%)</th><th>Length (bp)</th><th>Gene annotation (second)</th><th>DMR finding (second)</th><th>Total (second)</th></tr></thead><tbody><tr><td>HMST-Seq-Analyzer</td><td>1107</td><td>1107</td><td>100</td><td>9768</td><td>308</td><td>86</td><td>394</td></tr><tr><td>BSmooth</td><td>1105</td><td>953</td><td>86</td><td>379</td><td>NA</td><td>60</td><td>60</td></tr><tr><td>MethylSig</td><td>34,347</td><td>27,816</td><td>81</td><td>200</td><td>NA</td><td>168</td><td>168</td></tr><tr><td>MethylKit</td><td>12,460</td><td>9865</td><td>79</td><td>200</td><td>NA</td><td>87</td><td>87</td></tr><tr><td>MethylSig</td><td>50,597</td><td>41,182</td><td>81</td><td>25</td><td>NA</td><td>533</td><td>533</td></tr><tr><td>MethylKit</td><td>16,683</td><td>13,371</td><td>80</td><td>25</td><td>NA</td><td>115</td><td>115</td></tr></tbody></table><table-wrap-foot><fn><p>HMST-Seq-Analyzer, BSmooth, MethylSig, and MethylKit were applied on the same WGBS data to identify differentially methylated regions (DMRs) between human H1 and IMR90 cells, respectively. Here, each cell line has replicated experiments and only chromosome 22 is used in the evaluation for all programs. MethylKit and MethylSig are tested in two different lengths of window size (25 bp and 200 bp). In the table, DMRs represents the number of DMRs detected by the package. Overlapping and Percentage are the number of and the percentage of DMRs that are overlapping with the DMRs from HMST-Seq-Analyzer, respectively. Length is the median length of DMRs. DMR finding, Gene annotation and Total are wall time (seconds) used in each step, respectively.</p></fn></table-wrap-foot></table-wrap></p>
    </sec>
  </sec>
  <sec id="s0100">
    <label>4</label>
    <title>Conclusion</title>
    <p id="p0180">We present a new Python package called HMST-Seq-Analyzer for differential methylation and hydroxymethylation analysis, that identifies and annotates genome-wide differentially methylated regions (DMRs) by using DNA sequencing data. Though it is optimized for HMST-Seq data, the tool is highly flexible and is able to analyse other popular types of DNA methylation sequencing data such as WGBS and RRBS. HMST-Seq-Analyzer takes as an input either library tag counts of HMST-Seq or methylation percentage per base in the case of WGBS/RRBS for DMR detection. Regardless of pre- and postprocessing steps, this pipeline can be used independently to detect DMRs. Gene annotation of discovered DMRs is performed automatically at the end of the pipeline, summary statistics of methylation distributions in various genomic regions (e.g., TSS, TES, gene body, and 5′ distance region) are illustrated in graphs, and the average of methylation levels spanning gene regions such as TSS-gene-TES or enhancer regions are also provided. The package is able to deal with very huge data sets such as genome-wide methylation profiles of CpG, CHG, or CHH methylation from WGBS data, because of the parallel implementation of the MR/DMR search algorithms. The final results exported by the pipeline (e.g. gene annotated hyper/hypo DMRs) are ready for biologists to be used for further detailed investigation.</p>
    <p id="p0185">HMST-Seq-Analyzer is written in Python and is publicly available. It is a command line tool and tested on both macOS and Linux operating systems. For small or medium sized data sets (e.g., RRBS/HMST-Seq), it can be run on desktop PCs. However, for big data (e.g., genome-wide CpG/CHG/CHH from WGBS), it is preferable to run the pipeline on high performance computers with parallel computation. The package is able to process both human and mouse data, as well as to the other species if the corresponding reference genomes are available and with the same format as our provided human/mouse genome. For convenience, human (hg 19, hg38) and mouse (mm10) genome annotation and chromosome size files are also included in the package. Though the current pipeline is robust in differential methylation analysis when compared to three popular R packages (overlapping with ~80% BSmooth and ~70% MethylKit/MethylSig predicted DMRs), it is slow in processing of gene annotation during the DMR finding. Especially, when multiple groups, conditions or replicates are considered in DMR prediction. In future, we aim to overcome this limitation by developing new methods suitable for fast gene annotation and further optimize its speed for very large data such as genome-wide non-CpG methylation. We will also consider adapting the software for integration into Galaxy <xref rid="b0230" ref-type="bibr">[46]</xref>, CyVerse Discovery Environment <xref rid="b0235" ref-type="bibr">[47]</xref>, or similar platforms, as well as enabling export of results for visualization with the UCSC Genome browser <xref rid="b0125" ref-type="bibr">[25]</xref> or other tools.</p>
  </sec>
  <sec id="s0105">
    <title>CRediT authorship contribution statement</title>
    <p id="p0190"><bold>Amna Farooq:</bold> Software, Validation, Formal analysis, Visualization, Writing - original draft. <bold>Sindre Grønmyr:</bold> Software, Visualization, Validation, Formal analysis. <bold>Omer Ali:</bold> Validation, Formal analysis, Writing - review &amp; editing. <bold>Torbjørn Rognes:</bold> Validation, Writing - review &amp; editing. <bold>Katja Scheffler:</bold> Validation, Writing - review &amp; editing. <bold>Magnar Bjørås:</bold> Validation, Writing - review &amp; editing. <bold>Junbai Wang:</bold> Conceptualization, Methodology, Software, Data curation, Writing - review &amp; editing, Visualization, Investigation, Formal analysis, Supervision, Validation, Project administration, Funding acquisition.</p>
  </sec>
  <sec sec-type="COI-statement">
    <title>Declaration of Competing Interest</title>
    <p id="p0195">The authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper.</p>
  </sec>
</body>
<back>
  <ref-list id="bi005">
    <title>References</title>
    <ref id="b0005">
      <label>1</label>
      <element-citation publication-type="journal" id="h0005">
        <person-group person-group-type="author">
          <name>
            <surname>Greenberg</surname>
            <given-names>M.V.</given-names>
          </name>
          <name>
            <surname>Bourc’his</surname>
            <given-names>D.</given-names>
          </name>
        </person-group>
        <article-title>The diverse roles of DNA methylation in mammalian development and disease</article-title>
        <source>Nature Rev Mol Cell Biol</source>
        <year>2019</year>
        <fpage>1</fpage>
        <lpage>18</lpage>
      </element-citation>
    </ref>
    <ref id="b0010">
      <label>2</label>
      <element-citation publication-type="journal" id="h0010">
        <person-group person-group-type="author">
          <name>
            <surname>Shi</surname>
            <given-names>D.-Q.</given-names>
          </name>
        </person-group>
        <article-title>New insights into 5hmC DNA modification: generation, distribution and function</article-title>
        <source>Front Genet</source>
        <volume>8</volume>
        <issue>100</issue>
        <year>2017</year>
      </element-citation>
    </ref>
    <ref id="b0015">
      <label>3</label>
      <element-citation publication-type="journal" id="h0015">
        <person-group person-group-type="author">
          <name>
            <surname>Luo</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Hajkova</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Ecker</surname>
            <given-names>J.R.</given-names>
          </name>
        </person-group>
        <article-title>Dynamic DNA methylation: In the right place at the right time</article-title>
        <source>Science</source>
        <volume>361</volume>
        <issue>6409</issue>
        <year>2018</year>
        <fpage>1336</fpage>
        <lpage>1340</lpage>
        <pub-id pub-id-type="pmid">30262495</pub-id>
      </element-citation>
    </ref>
    <ref id="b0020">
      <label>4</label>
      <element-citation publication-type="journal" id="h0020">
        <person-group person-group-type="author">
          <name>
            <surname>Bullinger</surname>
            <given-names>L.</given-names>
          </name>
        </person-group>
        <article-title>Quantitative DNA methylation predicts survival in adult acute myeloid leukemia</article-title>
        <source>Blood, J Am Soc Hematol</source>
        <volume>115</volume>
        <issue>3</issue>
        <year>2010</year>
        <fpage>636</fpage>
        <lpage>642</lpage>
      </element-citation>
    </ref>
    <ref id="b0025">
      <label>5</label>
      <element-citation publication-type="journal" id="h0025">
        <person-group person-group-type="author">
          <name>
            <surname>Frommer</surname>
            <given-names>M.</given-names>
          </name>
        </person-group>
        <article-title>A genomic sequencing protocol that yields a positive display of 5-methylcytosine residues in individual DNA strands</article-title>
        <source>Proc Natl Acad Sci</source>
        <volume>89</volume>
        <issue>5</issue>
        <year>1992</year>
        <fpage>1827</fpage>
        <lpage>1831</lpage>
        <pub-id pub-id-type="pmid">1542678</pub-id>
      </element-citation>
    </ref>
    <ref id="b0030">
      <label>6</label>
      <element-citation publication-type="journal" id="h0030">
        <person-group person-group-type="author">
          <name>
            <surname>Cokus</surname>
            <given-names>S.J.</given-names>
          </name>
        </person-group>
        <article-title>Shotgun bisulphite sequencing of the Arabidopsis genome reveals DNA methylation patterning</article-title>
        <source>Nature</source>
        <volume>452</volume>
        <issue>7184</issue>
        <year>2008</year>
        <fpage>215</fpage>
        <lpage>219</lpage>
        <pub-id pub-id-type="pmid">18278030</pub-id>
      </element-citation>
    </ref>
    <ref id="b0035">
      <label>7</label>
      <element-citation publication-type="journal" id="h0035">
        <person-group person-group-type="author">
          <name>
            <surname>Ziller</surname>
            <given-names>M.J.</given-names>
          </name>
        </person-group>
        <article-title>Coverage recommendations for methylation analysis by whole-genome bisulfite sequencing</article-title>
        <source>Nat Methods</source>
        <volume>12</volume>
        <issue>3</issue>
        <year>2015</year>
        <fpage>230</fpage>
        <pub-id pub-id-type="pmid">25362363</pub-id>
      </element-citation>
    </ref>
    <ref id="b0040">
      <label>8</label>
      <element-citation publication-type="journal" id="h0040">
        <person-group person-group-type="author">
          <name>
            <surname>Lee</surname>
            <given-names>I.</given-names>
          </name>
        </person-group>
        <article-title>Whole genome DNA methylation sequencing of the chicken retina, cornea and brain</article-title>
        <source>Sci Data</source>
        <volume>4</volume>
        <year>2017</year>
        <object-id pub-id-type="publisher-id">170148</object-id>
      </element-citation>
    </ref>
    <ref id="b0045">
      <label>9</label>
      <element-citation publication-type="journal" id="h0045">
        <person-group person-group-type="author">
          <name>
            <surname>Davis</surname>
            <given-names>C.A.</given-names>
          </name>
        </person-group>
        <article-title>The Encyclopedia of DNA elements (ENCODE): data portal update</article-title>
        <source>Nucl Acids Res</source>
        <volume>46</volume>
        <issue>D1</issue>
        <year>2018</year>
        <fpage>D794</fpage>
        <lpage>D801</lpage>
        <pub-id pub-id-type="pmid">29126249</pub-id>
      </element-citation>
    </ref>
    <ref id="b0050">
      <label>10</label>
      <element-citation publication-type="journal" id="h0050">
        <person-group person-group-type="author">
          <name>
            <surname>Bujold</surname>
            <given-names>D.</given-names>
          </name>
        </person-group>
        <article-title>The international human epigenome consortium data portal</article-title>
        <source>Cell Syst</source>
        <volume>3</volume>
        <issue>5</issue>
        <year>2016</year>
        <fpage>496</fpage>
        <lpage>499</lpage>
        <comment>e2</comment>
        <pub-id pub-id-type="pmid">27863956</pub-id>
      </element-citation>
    </ref>
    <ref id="b0055">
      <label>11</label>
      <element-citation publication-type="journal" id="h0055">
        <person-group person-group-type="author">
          <name>
            <surname>Gao</surname>
            <given-names>F.</given-names>
          </name>
        </person-group>
        <article-title>Integrated detection of both 5-mC and 5-hmC by high-throughput tag sequencing technology highlights methylation reprogramming of bivalent genes during cellular differentiation</article-title>
        <source>Epigenetics</source>
        <volume>8</volume>
        <issue>4</issue>
        <year>2013</year>
        <fpage>421</fpage>
        <lpage>430</lpage>
        <pub-id pub-id-type="pmid">23502161</pub-id>
      </element-citation>
    </ref>
    <ref id="b0060">
      <label>12</label>
      <element-citation publication-type="journal" id="h0060">
        <person-group person-group-type="author">
          <name>
            <surname>Nair</surname>
            <given-names>S.S.</given-names>
          </name>
        </person-group>
        <article-title>Guidelines for whole genome bisulphite sequencing of intact and FFPET DNA on the Illumina HiSeq X Ten</article-title>
        <source>Epigenet Chromatin</source>
        <volume>11</volume>
        <issue>1</issue>
        <year>2018</year>
        <fpage>24</fpage>
      </element-citation>
    </ref>
    <ref id="b0065">
      <label>13</label>
      <element-citation publication-type="journal" id="h0065">
        <person-group person-group-type="author">
          <name>
            <surname>Van Dijk</surname>
            <given-names>E.L.</given-names>
          </name>
        </person-group>
        <article-title>Ten years of next-generation sequencing technology</article-title>
        <source>Trends Genet</source>
        <volume>30</volume>
        <issue>9</issue>
        <year>2014</year>
        <fpage>418</fpage>
        <lpage>426</lpage>
        <pub-id pub-id-type="pmid">25108476</pub-id>
      </element-citation>
    </ref>
    <ref id="b0070">
      <label>14</label>
      <element-citation publication-type="journal" id="h0070">
        <person-group person-group-type="author">
          <name>
            <surname>Meissner</surname>
            <given-names>A.</given-names>
          </name>
        </person-group>
        <article-title>Reduced representation bisulfite sequencing for comparative high-resolution DNA methylation analysis</article-title>
        <source>Nucl Acids Res</source>
        <volume>33</volume>
        <issue>18</issue>
        <year>2005</year>
        <fpage>5868</fpage>
        <lpage>5877</lpage>
        <pub-id pub-id-type="pmid">16224102</pub-id>
      </element-citation>
    </ref>
    <ref id="b0075">
      <label>15</label>
      <element-citation publication-type="journal" id="h0075">
        <person-group person-group-type="author">
          <name>
            <surname>Ball</surname>
            <given-names>M.P.</given-names>
          </name>
        </person-group>
        <article-title>Targeted and genome-scale strategies reveal gene-body methylation signatures in human cells</article-title>
        <source>Nat Biotechnol</source>
        <volume>27</volume>
        <issue>4</issue>
        <year>2009</year>
        <fpage>361</fpage>
        <lpage>368</lpage>
        <pub-id pub-id-type="pmid">19329998</pub-id>
      </element-citation>
    </ref>
    <ref id="b0080">
      <label>16</label>
      <element-citation publication-type="journal" id="h0080">
        <person-group person-group-type="author">
          <name>
            <surname>Maunakea</surname>
            <given-names>A.K.</given-names>
          </name>
        </person-group>
        <article-title>Conserved role of intragenic DNA methylation in regulating alternative promoters</article-title>
        <source>Nature</source>
        <volume>466</volume>
        <issue>7303</issue>
        <year>2010</year>
        <fpage>253</fpage>
        <lpage>257</lpage>
        <pub-id pub-id-type="pmid">20613842</pub-id>
      </element-citation>
    </ref>
    <ref id="b0085">
      <label>17</label>
      <element-citation publication-type="journal" id="h0085">
        <person-group person-group-type="author">
          <name>
            <surname>Guo</surname>
            <given-names>J.U.</given-names>
          </name>
        </person-group>
        <article-title>Neuronal activity modifies the DNA methylation landscape in the adult brain</article-title>
        <source>Nat Neurosci</source>
        <volume>14</volume>
        <issue>10</issue>
        <year>2011</year>
        <fpage>1345</fpage>
        <lpage>1351</lpage>
        <pub-id pub-id-type="pmid">21874013</pub-id>
      </element-citation>
    </ref>
    <ref id="b0090">
      <label>18</label>
      <element-citation publication-type="journal" id="h0090">
        <person-group person-group-type="author">
          <name>
            <surname>Gao</surname>
            <given-names>F.</given-names>
          </name>
        </person-group>
        <article-title>Integrated analyses of DNA methylation and hydroxymethylation reveal tumor suppressive roles of ECM1, ATF5, and EOMESin human hepatocellular carcinoma</article-title>
        <source>Genome Biol</source>
        <volume>15</volume>
        <issue>12</issue>
        <year>2014</year>
        <fpage>533</fpage>
        <pub-id pub-id-type="pmid">25517360</pub-id>
      </element-citation>
    </ref>
    <ref id="b0095">
      <label>19</label>
      <element-citation publication-type="journal" id="h0095">
        <person-group person-group-type="author">
          <name>
            <surname>Olsen</surname>
            <given-names>M.B.</given-names>
          </name>
        </person-group>
        <article-title>NEIL3-dependent regulation of cardiac fibroblast proliferation prevents myocardial rupture</article-title>
        <source>Cell Rep</source>
        <volume>18</volume>
        <issue>1</issue>
        <year>2017</year>
        <fpage>82</fpage>
        <lpage>92</lpage>
        <pub-id pub-id-type="pmid">28052262</pub-id>
      </element-citation>
    </ref>
    <ref id="b0100">
      <label>20</label>
      <mixed-citation publication-type="other" id="h0100">Metagenomics versus Moore's law. Nature Methods, 2009. 6(9): p. 623-623.</mixed-citation>
    </ref>
    <ref id="b0105">
      <label>21</label>
      <element-citation publication-type="journal" id="h0105">
        <person-group person-group-type="author">
          <name>
            <surname>Akalin</surname>
            <given-names>A.</given-names>
          </name>
        </person-group>
        <article-title>methylKit: a comprehensive R package for the analysis of genome-wide DNA methylation profiles</article-title>
        <source>Genome Biol</source>
        <volume>13</volume>
        <issue>10</issue>
        <year>2012</year>
        <fpage>R87</fpage>
        <pub-id pub-id-type="pmid">23034086</pub-id>
      </element-citation>
    </ref>
    <ref id="b0110">
      <label>22</label>
      <element-citation publication-type="journal" id="h0110">
        <person-group person-group-type="author">
          <name>
            <surname>Hansen</surname>
            <given-names>K.D.</given-names>
          </name>
          <name>
            <surname>Langmead</surname>
            <given-names>B.</given-names>
          </name>
          <name>
            <surname>Irizarry</surname>
            <given-names>R.A.</given-names>
          </name>
        </person-group>
        <article-title>BSmooth: from whole genome bisulfite sequencing reads to differentially methylated regions</article-title>
        <source>Genome Biol</source>
        <volume>13</volume>
        <issue>10</issue>
        <year>2012</year>
        <fpage>R83</fpage>
        <pub-id pub-id-type="pmid">23034175</pub-id>
      </element-citation>
    </ref>
    <ref id="b0115">
      <label>23</label>
      <element-citation publication-type="journal" id="h0115">
        <person-group person-group-type="author">
          <name>
            <surname>Park</surname>
            <given-names>Y.</given-names>
          </name>
        </person-group>
        <article-title>MethylSig: a whole genome DNA methylation analysis pipeline</article-title>
        <source>Bioinformatics</source>
        <volume>30</volume>
        <issue>17</issue>
        <year>2014</year>
        <fpage>2414</fpage>
        <lpage>2422</lpage>
        <pub-id pub-id-type="pmid">24836530</pub-id>
      </element-citation>
    </ref>
    <ref id="b0120">
      <label>24</label>
      <element-citation publication-type="journal" id="h0120">
        <person-group person-group-type="author">
          <name>
            <surname>Cavalcante</surname>
            <given-names>R.G.</given-names>
          </name>
        </person-group>
        <article-title>Integrating DNA methylation and hydroxymethylation data with the mint pipeline</article-title>
        <source>Cancer Res</source>
        <volume>77</volume>
        <issue>21</issue>
        <year>2017</year>
        <fpage>e27</fpage>
        <lpage>e30</lpage>
        <pub-id pub-id-type="pmid">29092933</pub-id>
      </element-citation>
    </ref>
    <ref id="b0125">
      <label>25</label>
      <element-citation publication-type="journal" id="h0125">
        <person-group person-group-type="author">
          <name>
            <surname>Haeussler</surname>
            <given-names>M.</given-names>
          </name>
        </person-group>
        <article-title>The UCSC genome browser database: 2019 update</article-title>
        <source>Nucl Acids Res</source>
        <volume>47</volume>
        <issue>D1</issue>
        <year>2019</year>
        <fpage>D853</fpage>
        <lpage>D858</lpage>
        <pub-id pub-id-type="pmid">30407534</pub-id>
      </element-citation>
    </ref>
    <ref id="b0130">
      <label>26</label>
      <element-citation publication-type="journal" id="h0130">
        <person-group person-group-type="author">
          <name>
            <surname>Xu</surname>
            <given-names>J.</given-names>
          </name>
        </person-group>
        <article-title>Pioneer factor interactions and unmethylated CpG dinucleotides mark silent tissue-specific enhancers in embryonic stem cells</article-title>
        <source>Proc Natl Acad Sci</source>
        <volume>104</volume>
        <issue>30</issue>
        <year>2007</year>
        <fpage>12377</fpage>
        <lpage>12382</lpage>
        <pub-id pub-id-type="pmid">17640912</pub-id>
      </element-citation>
    </ref>
    <ref id="b0135">
      <label>27</label>
      <element-citation publication-type="journal" id="h0135">
        <person-group person-group-type="author">
          <name>
            <surname>Raval</surname>
            <given-names>A.</given-names>
          </name>
        </person-group>
        <article-title>Downregulation of death-associated protein kinase 1 (DAPK1) in chronic lymphocytic leukemia</article-title>
        <source>Cell</source>
        <volume>129</volume>
        <issue>5</issue>
        <year>2007</year>
        <fpage>879</fpage>
        <lpage>890</lpage>
        <pub-id pub-id-type="pmid">17540169</pub-id>
      </element-citation>
    </ref>
    <ref id="b0140">
      <label>28</label>
      <element-citation publication-type="journal" id="h0140">
        <person-group person-group-type="author">
          <name>
            <surname>Sparago</surname>
            <given-names>A.</given-names>
          </name>
        </person-group>
        <article-title>Microdeletions in the human H19 DMR result in loss of IGF2 imprinting and Beckwith-Wiedemann syndrome</article-title>
        <source>Nat Genet</source>
        <volume>36</volume>
        <issue>9</issue>
        <year>2004</year>
        <fpage>958</fpage>
        <lpage>960</lpage>
        <pub-id pub-id-type="pmid">15314640</pub-id>
      </element-citation>
    </ref>
    <ref id="b0145">
      <label>29</label>
      <element-citation publication-type="journal" id="h0145">
        <person-group person-group-type="author">
          <name>
            <surname>Avrahami</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Kaestner</surname>
            <given-names>K.H.</given-names>
          </name>
        </person-group>
        <article-title>The dynamic methylome of islets in health and disease</article-title>
        <source>Mol Metab</source>
        <volume>27</volume>
        <year>2019</year>
        <fpage>S25</fpage>
        <lpage>S32</lpage>
      </element-citation>
    </ref>
    <ref id="b0150">
      <label>30</label>
      <element-citation publication-type="journal" id="h0150">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>Z.</given-names>
          </name>
        </person-group>
        <article-title>swDMR: a sliding window approach to identify differentially methylated regions based on whole genome bisulfite sequencing</article-title>
        <source>PLoS One</source>
        <volume>10</volume>
        <issue>7</issue>
        <year>2015</year>
        <object-id pub-id-type="publisher-id">e0132866</object-id>
      </element-citation>
    </ref>
    <ref id="b0155">
      <label>31</label>
      <element-citation publication-type="journal" id="h0155">
        <person-group person-group-type="author">
          <name>
            <surname>Günther</surname>
            <given-names>C.-C.</given-names>
          </name>
        </person-group>
        <article-title>Statistical hypothesis testing for categorical data using enumeration in the presence of nuisance parameters</article-title>
        <source>Preprint Statistics</source>
        <volume>4</volume>
        <year>2009</year>
      </element-citation>
    </ref>
    <ref id="b0160">
      <label>32</label>
      <element-citation publication-type="journal" id="h0160">
        <person-group person-group-type="author">
          <name>
            <surname>Tang</surname>
            <given-names>B.</given-names>
          </name>
        </person-group>
        <article-title>Integration of DNA methylation and gene transcription across nineteen cell types reveals cell type-specific and genomic region-dependent regulatory patterns</article-title>
        <source>Sci Rep</source>
        <volume>7</volume>
        <issue>1</issue>
        <year>2017</year>
        <fpage>3626</fpage>
        <pub-id pub-id-type="pmid">28620196</pub-id>
      </element-citation>
    </ref>
    <ref id="b0165">
      <label>33</label>
      <element-citation publication-type="journal" id="h0165">
        <person-group person-group-type="author">
          <name>
            <surname>Benjamini</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Hochberg</surname>
            <given-names>Y.</given-names>
          </name>
        </person-group>
        <article-title>Controlling the false discovery rate: a practical and powerful approach to multiple testing</article-title>
        <source>J Roy Stat Soc: Ser B (Methodol)</source>
        <volume>57</volume>
        <issue>1</issue>
        <year>1995</year>
        <fpage>289</fpage>
        <lpage>300</lpage>
      </element-citation>
    </ref>
    <ref id="b0170">
      <label>34</label>
      <element-citation publication-type="journal" id="h0170">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>J.</given-names>
          </name>
        </person-group>
        <article-title>Genome-wide analysis uncovers high frequency, strong differential chromosomal interactions and their associated epigenetic patterns in E2-mediated gene regulation</article-title>
        <source>BMC Genomics</source>
        <volume>14</volume>
        <year>2013</year>
        <fpage>70</fpage>
        <pub-id pub-id-type="pmid">23368971</pub-id>
      </element-citation>
    </ref>
    <ref id="b0175">
      <label>35</label>
      <element-citation publication-type="journal" id="h0175">
        <person-group person-group-type="author">
          <name>
            <surname>Haddad</surname>
            <given-names>R.A.</given-names>
          </name>
          <name>
            <surname>Akansu</surname>
            <given-names>A.N.</given-names>
          </name>
        </person-group>
        <article-title>A class of fast Gaussian binomial filters for speech and image processing</article-title>
        <source>IEEE Trans Signal Process</source>
        <volume>39</volume>
        <issue>3</issue>
        <year>1991</year>
        <fpage>723</fpage>
        <lpage>727</lpage>
      </element-citation>
    </ref>
    <ref id="b0180">
      <label>36</label>
      <element-citation publication-type="journal" id="h0180">
        <person-group person-group-type="author">
          <name>
            <surname>Reimer</surname>
            <given-names>M.</given-names>
          </name>
        </person-group>
        <article-title>Deletion of Tet proteins results in quantitative disparities during ESC differentiation partially attributable to alterations in gene expression</article-title>
        <source>BMC Dev Biol</source>
        <volume>19</volume>
        <issue>1</issue>
        <year>2019</year>
        <fpage>16</fpage>
        <pub-id pub-id-type="pmid">31286885</pub-id>
      </element-citation>
    </ref>
    <ref id="b0185">
      <label>37</label>
      <element-citation publication-type="journal" id="h0185">
        <person-group person-group-type="author">
          <name>
            <surname>Umer</surname>
            <given-names>M.</given-names>
          </name>
        </person-group>
        <article-title>Promoter hypermethylation of Wnt pathway inhibitors in hepatitis C virus-induced multistep hepatocarcinogenesis</article-title>
        <source>Virol J</source>
        <volume>11</volume>
        <issue>1</issue>
        <year>2014</year>
        <fpage>117</fpage>
        <pub-id pub-id-type="pmid">24947038</pub-id>
      </element-citation>
    </ref>
    <ref id="b0190">
      <label>38</label>
      <element-citation publication-type="journal" id="h0190">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>C.</given-names>
          </name>
        </person-group>
        <article-title>Decrease of 5-hydroxymethylcytosine is associated with progression of hepatocellular carcinoma through downregulation of TET1</article-title>
        <source>PLoS One</source>
        <volume>8</volume>
        <issue>5</issue>
        <year>2013</year>
      </element-citation>
    </ref>
    <ref id="b0195">
      <label>39</label>
      <element-citation publication-type="journal" id="h0195">
        <person-group person-group-type="author">
          <name>
            <surname>Zhu</surname>
            <given-names>Y.</given-names>
          </name>
        </person-group>
        <article-title>Integrated analyses of multi-omics reveal global patterns of methylation and hydroxymethylation and screen the tumor suppressive roles of HADHB in colorectal cancer</article-title>
        <source>Clin Epigenet</source>
        <volume>10</volume>
        <issue>1</issue>
        <year>2018</year>
        <fpage>30</fpage>
      </element-citation>
    </ref>
    <ref id="b0200">
      <label>40</label>
      <element-citation publication-type="journal" id="h0200">
        <person-group person-group-type="author">
          <name>
            <surname>Huang</surname>
            <given-names>D.W.</given-names>
          </name>
          <name>
            <surname>Sherman</surname>
            <given-names>B.T.</given-names>
          </name>
          <name>
            <surname>Lempicki</surname>
            <given-names>R.A.</given-names>
          </name>
        </person-group>
        <article-title>Bioinformatics enrichment tools: paths toward the comprehensive functional analysis of large gene lists</article-title>
        <source>Nucl Acids Res</source>
        <volume>37</volume>
        <issue>1</issue>
        <year>2009</year>
        <fpage>1</fpage>
        <lpage>13</lpage>
        <pub-id pub-id-type="pmid">19033363</pub-id>
      </element-citation>
    </ref>
    <ref id="b0205">
      <label>41</label>
      <element-citation publication-type="journal" id="h0205">
        <person-group person-group-type="author">
          <name>
            <surname>Cartron</surname>
            <given-names>P.-F.</given-names>
          </name>
        </person-group>
        <article-title>Identification of TET1 partners that control its DNA-demethylating function</article-title>
        <source>Genes Cancer</source>
        <volume>4</volume>
        <issue>5–6</issue>
        <year>2013</year>
        <fpage>235</fpage>
        <lpage>241</lpage>
        <pub-id pub-id-type="pmid">24069510</pub-id>
      </element-citation>
    </ref>
    <ref id="b0210">
      <label>42</label>
      <element-citation publication-type="journal" id="h0210">
        <person-group person-group-type="author">
          <name>
            <surname>Rauch</surname>
            <given-names>T.A.</given-names>
          </name>
        </person-group>
        <article-title>DNA methylation biomarkers for lung cancer</article-title>
        <source>Tumor Biol</source>
        <volume>33</volume>
        <issue>2</issue>
        <year>2012</year>
        <fpage>287</fpage>
        <lpage>296</lpage>
      </element-citation>
    </ref>
    <ref id="b0215">
      <label>43</label>
      <element-citation publication-type="journal" id="h0215">
        <person-group person-group-type="author">
          <name>
            <surname>Smith</surname>
            <given-names>A.K.</given-names>
          </name>
        </person-group>
        <article-title>Differential immune system DNA methylation and cytokine regulation in post-traumatic stress disorder</article-title>
        <source>Am J Med Genet Part B: Neuropsychiatric Genet</source>
        <volume>156</volume>
        <issue>6</issue>
        <year>2011</year>
        <fpage>700</fpage>
        <lpage>708</lpage>
      </element-citation>
    </ref>
    <ref id="b0220">
      <label>44</label>
      <element-citation publication-type="journal" id="h0220">
        <person-group person-group-type="author">
          <name>
            <surname>Lister</surname>
            <given-names>R.</given-names>
          </name>
        </person-group>
        <article-title>Human DNA methylomes at base resolution show widespread epigenomic differences</article-title>
        <source>Nature</source>
        <volume>462</volume>
        <issue>7271</issue>
        <year>2009</year>
        <fpage>315</fpage>
        <lpage>322</lpage>
        <pub-id pub-id-type="pmid">19829295</pub-id>
      </element-citation>
    </ref>
    <ref id="b0225">
      <label>45</label>
      <mixed-citation publication-type="other" id="h0225">Quinlan AR. BEDTools: The Swiss-Army Tool for Genome Feature Analysis. Curr Protoc Bioinformatics, 2014. 47: p. 11 12 1-34.</mixed-citation>
    </ref>
    <ref id="b0230">
      <label>46</label>
      <element-citation publication-type="journal" id="h0230">
        <person-group person-group-type="author">
          <name>
            <surname>Giardine</surname>
            <given-names>B.</given-names>
          </name>
        </person-group>
        <article-title>Galaxy: a platform for interactive large-scale genome analysis</article-title>
        <source>Genome Res</source>
        <volume>15</volume>
        <issue>10</issue>
        <year>2005</year>
        <fpage>1451</fpage>
        <lpage>1455</lpage>
        <pub-id pub-id-type="pmid">16169926</pub-id>
      </element-citation>
    </ref>
    <ref id="b0235">
      <label>47</label>
      <element-citation publication-type="journal" id="h0235">
        <person-group person-group-type="author">
          <name>
            <surname>Koltes</surname>
            <given-names>J.E.</given-names>
          </name>
        </person-group>
        <article-title>Bioinformatics resources for animal genomics using CyVerse cyberinfrastructure</article-title>
        <source>J Anim Sci</source>
        <volume>94</volume>
        <year>2016</year>
        <fpage>33</fpage>
        <lpage>34</lpage>
      </element-citation>
    </ref>
    <ref id="b0240">
      <label>48</label>
      <element-citation publication-type="journal" id="h0240">
        <person-group person-group-type="author">
          <name>
            <surname>Cheng</surname>
            <given-names>Y.-S.</given-names>
          </name>
        </person-group>
        <article-title>MAEL promoter hypermethylation is associated with de-repression of LINE-1 in human hypospermatogenesis</article-title>
        <source>Hum Reprod</source>
        <volume>32</volume>
        <issue>12</issue>
        <year>2017</year>
        <fpage>2373</fpage>
        <lpage>2381</lpage>
        <pub-id pub-id-type="pmid">29095993</pub-id>
      </element-citation>
    </ref>
    <ref id="b0245">
      <label>49</label>
      <element-citation publication-type="journal" id="h0245">
        <person-group person-group-type="author">
          <name>
            <surname>Vincent</surname>
            <given-names>J.J.</given-names>
          </name>
        </person-group>
        <article-title>Stage-specific roles for tet1 and tet2 in DNA demethylation in primordial germ cells</article-title>
        <source>Cell Stem Cell</source>
        <volume>12</volume>
        <issue>4</issue>
        <year>2013</year>
        <fpage>470</fpage>
        <lpage>478</lpage>
        <pub-id pub-id-type="pmid">23415914</pub-id>
      </element-citation>
    </ref>
    <ref id="b0250">
      <label>50</label>
      <element-citation publication-type="journal" id="h0250">
        <person-group person-group-type="author">
          <name>
            <surname>Worm</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Guldberg</surname>
            <given-names>P.</given-names>
          </name>
        </person-group>
        <article-title>DNA methylation: an epigenetic pathway to cancer and a promising target for anticancer therapy</article-title>
        <source>J Oral Pathol Med</source>
        <volume>31</volume>
        <issue>8</issue>
        <year>2002</year>
        <fpage>443</fpage>
        <lpage>449</lpage>
        <pub-id pub-id-type="pmid">12220350</pub-id>
      </element-citation>
    </ref>
    <ref id="b0255">
      <label>51</label>
      <element-citation publication-type="journal" id="h0255">
        <person-group person-group-type="author">
          <name>
            <surname>Linher</surname>
            <given-names>K.</given-names>
          </name>
        </person-group>
        <article-title>An epigenetic mechanism regulates germ cell-specific expression of the porcine Deleted in Azoospermia-Like (DAZL) gene</article-title>
        <source>Differentiation</source>
        <volume>77</volume>
        <issue>4</issue>
        <year>2009</year>
        <fpage>335</fpage>
        <lpage>349</lpage>
        <pub-id pub-id-type="pmid">19281782</pub-id>
      </element-citation>
    </ref>
    <ref id="b0260">
      <label>52</label>
      <element-citation publication-type="journal" id="h0260">
        <person-group person-group-type="author">
          <name>
            <surname>Devaney</surname>
            <given-names>J.M.</given-names>
          </name>
        </person-group>
        <article-title>Genome-wide differentially methylated genes in prostate cancer tissues from African-American and Caucasian men</article-title>
        <source>Epigenetics</source>
        <volume>10</volume>
        <issue>4</issue>
        <year>2015</year>
        <fpage>319</fpage>
        <lpage>328</lpage>
        <pub-id pub-id-type="pmid">25864488</pub-id>
      </element-citation>
    </ref>
    <ref id="b0265">
      <label>53</label>
      <element-citation publication-type="journal" id="h0265">
        <person-group person-group-type="author">
          <name>
            <surname>Barua</surname>
            <given-names>S.</given-names>
          </name>
        </person-group>
        <article-title>DNA methylation profiling at single-base resolution reveals gestational folic acid supplementation influences the epigenome of mouse offspring cerebellum</article-title>
        <source>Front Neurosci</source>
        <volume>10</volume>
        <year>2016</year>
        <fpage>168</fpage>
        <pub-id pub-id-type="pmid">27199632</pub-id>
      </element-citation>
    </ref>
  </ref-list>
  <sec id="s0120" sec-type="supplementary-material">
    <label>Appendix A</label>
    <title>Supplementary data</title>
    <p id="p0210">The following are the Supplementary data to this article:<supplementary-material content-type="local-data" id="m0010"><caption><title>Supplementary data 1</title></caption><media xlink:href="mmc1.docx"/></supplementary-material></p>
    <p id="p0215">
      <supplementary-material content-type="local-data" id="m0005">
        <caption>
          <title>Supplementary data 2</title>
        </caption>
        <media xlink:href="mmc2.xlsx"/>
      </supplementary-material>
    </p>
  </sec>
  <ack id="ak005">
    <sec id="s0110">
      <title>Acknowledgments</title>
      <p id="p0200">This work was supported by the South-Eastern Norway Regional Health Authority (HSØ 2017061 and HSØ 2018107), and the <funding-source id="gp005">Norwegian Research Council NOTUR</funding-source> project (nn4605k). We thank the four reviewers for their comments and suggestions that helped us to improve the manuscript.</p>
    </sec>
  </ack>
  <fn-group>
    <fn id="s0115" fn-type="supplementary-material">
      <label>Appendix A</label>
      <p id="p0205">Supplementary data to this article can be found online at <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.csbj.2020.09.038" id="ir015">https://doi.org/10.1016/j.csbj.2020.09.038</ext-link>.</p>
    </fn>
  </fn-group>
</back>
