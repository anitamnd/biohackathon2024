<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6588853</article-id>
    <article-id pub-id-type="publisher-id">2901</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-019-2901-7</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>PaSS: a sequencing simulator for PacBio sequencing</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Zhang</surname>
          <given-names>Wenmin</given-names>
        </name>
        <address>
          <email>melody091835@163.com</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Jia</surname>
          <given-names>Ben</given-names>
        </name>
        <address>
          <email>chenmodexiaoxi@126.com</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-1031-034X</contrib-id>
        <name>
          <surname>Wei</surname>
          <given-names>Chaochun</given-names>
        </name>
        <address>
          <phone>(+86)21-34204348</phone>
          <email>ccwei@sjtu.edu.cn</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 0368 8293</institution-id><institution-id institution-id-type="GRID">grid.16821.3c</institution-id><institution>Department of Bioinformatics and Biostatistics, </institution><institution>School of Life Sciences and Biotechnology, Shanghai Jiao Tong University, </institution></institution-wrap>Shanghai, 200240 China </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 0368 8293</institution-id><institution-id institution-id-type="GRID">grid.16821.3c</institution-id><institution>Shanghai Center for Systems Biomedicine, </institution><institution>Shanghai Jiao Tong University, </institution></institution-wrap>800 Dongchuan Road, Shanghai, 200240 China </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>21</day>
      <month>6</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>21</day>
      <month>6</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2019</year>
    </pub-date>
    <volume>20</volume>
    <elocation-id>352</elocation-id>
    <history>
      <date date-type="received">
        <day>11</day>
        <month>4</month>
        <year>2019</year>
      </date>
      <date date-type="accepted">
        <day>13</day>
        <month>5</month>
        <year>2019</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s). 2019</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold>This article is distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">Third-generation sequencing platforms, such as PacBio sequencing, have been developed rapidly in recent years. PacBio sequencing generates much longer reads than the second-generation sequencing (or the next generation sequencing, NGS) technologies and it has unique sequencing error patterns. An effective read simulator is essential to evaluate and promote the development of new bioinformatics tools for PacBio sequencing data analysis.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">We developed a new <underline>Pa</underline>cBio <underline>S</underline>equencing <underline>S</underline>imulator (PaSS). It can learn sequence patterns from PacBio sequencing data currently available. In addition to the distribution of read lengths and error rates, we included a context-specific sequencing error model. Compared to existing PacBio sequencing simulators such as PBSIM, LongISLND and NPBSS, PaSS performed better in many aspects. Assembly tests also suggest that reads simulated by PaSS are the most similar to experimental sequencing data.</p>
      </sec>
      <sec>
        <title>Conclusion</title>
        <p id="Par3">PaSS is an effective sequence simulator for PacBio sequencing. It will facilitate the evaluation and development of new analysis tools for the third-generation sequencing data.</p>
      </sec>
      <sec>
        <title>Electronic supplementary material</title>
        <p>The online version of this article (10.1186/s12859-019-2901-7) contains supplementary material, which is available to authorized users.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Third generation sequencing</kwd>
      <kwd>Next generation sequencing</kwd>
      <kwd>PacBio sequencing</kwd>
      <kwd>Sequencing simulator</kwd>
      <kwd>Sequencing error</kwd>
      <kwd>Sequence pattern</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100001809</institution-id>
            <institution>National Natural Science Foundation of China</institution>
          </institution-wrap>
        </funding-source>
        <award-id>61472246</award-id>
        <principal-award-recipient>
          <name>
            <surname>Wei</surname>
            <given-names>Chaochun</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>National Basic Research Program of China</institution>
        </funding-source>
        <award-id>2013CB956103</award-id>
        <principal-award-recipient>
          <name>
            <surname>Wei</surname>
            <given-names>Chaochun</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>National High-tech Research and Development Program (CN)</institution>
        </funding-source>
        <award-id>2014AA021502</award-id>
        <principal-award-recipient>
          <name>
            <surname>Wei</surname>
            <given-names>Chaochun</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>Cross-Institute Research Fund of Shanghai Jiao Tong University</institution>
        </funding-source>
        <award-id>YG2017ZD01</award-id>
        <principal-award-recipient>
          <name>
            <surname>Wei</surname>
            <given-names>Chaochun</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2019</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background </title>
    <p id="Par4">Third-generation sequencing technologies including the PacBio or SMRT (single-molecule real-time) sequencing and nanopore sequencing are causing a revolution in genomics study as they provide researchers to study genomes at an unprecedented sequencing read length [<xref ref-type="bibr" rid="CR1">1</xref>]. SMRT sequencing developed by Pacific BioSciences is among the most widely used third-generation sequencing technologies [<xref ref-type="bibr" rid="CR2">2</xref>].</p>
    <p id="Par5">More and more bioinformatics tools and algorithms, such as sequence alignment program BLASR [<xref ref-type="bibr" rid="CR3">3</xref>] and GraphMap [<xref ref-type="bibr" rid="CR4">4</xref>], genome assembly program canu [<xref ref-type="bibr" rid="CR5">5</xref>] and miniasm [<xref ref-type="bibr" rid="CR6">6</xref>] and structural variant callers PBHoney [<xref ref-type="bibr" rid="CR7">7</xref>] and Sniffles [<xref ref-type="bibr" rid="CR8">8</xref>] have been emerging for SMRT data analysis. Besides, PacBio sequencing has been developed quickly with multiple versions. It’s essential that these tools are benchmarked and assessed using reads simulated by sequencing simulators targeting on a specific version of PacBio technology. The simulation of PacBio data can be useful to guide users to choose the most appropriate analytical tool or approach for their own research projects [<xref ref-type="bibr" rid="CR9">9</xref>]. In addition, generating in silico data can significantly reduce the cost and time required for improving the downstream analysis tools [<xref ref-type="bibr" rid="CR10">10</xref>].</p>
    <p id="Par6">The characteristics of PacBio reads is quite different from that of the second-generation sequencing reads’. It is capable of producing reads about 10-15 kb, which is much longer than existing second-generation sequencing methods’. Long reads can be useful for spanning repetitive or complex regions such as large structural variations since the mapping position of a read in a genome can be determined more precisely. Therefore, long reads show superiority in the analysis of repetitive regions and large structural variations. In contrast, it is difficult for the second-generation sequencing that may lead to misassembles and gaps. However, the per-base error rate can be about 15% compared to less than 1% in the second-generation sequencing technology and the errors are dominated by indels [<xref ref-type="bibr" rid="CR11">11</xref>]. Nevertheless, the high error rate can be alleviated by the single-molecule circular sequencing or multi-pass sequencing. In the sequencing process, the forward and reverse strands of the target molecule can be sequenced multiple times using the circular template [<xref ref-type="bibr" rid="CR12">12</xref>]. The output sequence termed as a polymerase read can be split into multiple reads called subreads. The final output sequencing read quality can be improved by generating consensus of these subreads. Although the throughput is still low, the latest sequencer Sequel can generate seven-fold to ten-fold more sequences than the older sequencer PacBio RSII. It can produce 5-10Gb bases with about 365 k~ 500 k reads per run [<xref ref-type="bibr" rid="CR13">13</xref>]. Furthermore, compared to the NGS methods, PacBio sequencing is faster and has no GC bias [<xref ref-type="bibr" rid="CR14">14</xref>].</p>
    <p id="Par7">Currently, there are several tools to simulate PacBio reads, such as PBSIM [<xref ref-type="bibr" rid="CR15">15</xref>], LongISLND [<xref ref-type="bibr" rid="CR16">16</xref>], and NPBSS [<xref ref-type="bibr" rid="CR17">17</xref>]. All these simulators can estimate the read length distribution but only the LongISLND considers multi-pass sequencing of PacBio platform. PBSIM can simulate reads using either a model-based or sampling-based method. But the read length distribution of PBSIM does not match current data well. LongISLND employs a sequence context sensitive method called extended-kmer to deal with the homopolymer-dependent bias and it can output in multiple file formats. NPBSS can use the relationship between the real error rate and quality values (QVs) while it takes a long time in simulating. For the sequences from the latest sequencer Sequel, a fixed quality value (QV) was used so the QVs do not represent the actual error rates whereas the methods of PBSIM and NPBSS simulating sequencing errors are based on QVs. In addition, LongISLND cannot process the file format of Sequel data. Most of all, these three simulators built their sequencing error models based only on the aligned regions from alignment results, thus some information about the sequencing error, especially those regions with low qualities, were missing.</p>
    <p id="Par8">In order to catch the innovation of sequencing technology and improve existing methods, we propose a new PacBio sequence simulator PaSS. PaSS can generate customized sequencing pattern models from real PacBio data and use a sequencing model, either customized or empirical, to generate subreads for an input reference genome. Finally, PaSS and some popular existing simulators are compared. The results and the assembly tests show that PaSS can simulate PacBio reads with high fidelity.</p>
  </sec>
  <sec id="Sec2">
    <title>Implementation</title>
    <p id="Par9">In general, PaSS can produce in silico reads using sequencing error models built previously for some given reference genomes. Sequencing error models can also be re-estimated from a real PacBio sequencing data. The methods involved are introduced as follows.</p>
    <sec id="Sec3">
      <title>Estimating sequencing error models from real sequencing data</title>
      <p id="Par10">In order to simulate PacBio sequencing better, the multi-pass sequencing of PacBio sequencer was investigated. We noticed that there is a trade off between target read length and the number of passes that longer template will be cycled less. PaSS can learn the read sequence patterns from real sequencing data. The distributions of pass-numbers and their corresponding read length distributions are recorded in the model for sequence generation.</p>
      <p id="Par11">In order to learn how the errors were distributed across a read, we aligned PacBio reads to the reference sequences. After we tried multiple alignment tools for long reads, we adopted BLASR [<xref ref-type="bibr" rid="CR3">3</xref>] to align sequencing reads to a reference genome or a high-quality de-novo assembly. The alignment results of real sequencing data are analyzed to extract sequencing error models which can be served as the input at the simulation stage. The head and tail regions of some reads may not be aligned back to the reference sequences because of the high error rates on these regions. A ratio of the unaligned part of a whole polymerase read is estimated to get a more integral model (see Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S1). The average sequencing quality over the whole read varies from reads to reads. PaSS learns the ratio of different error types (match/insertion/deletion/substitution), and their corresponding sequence context patterns by kmer-based analysis. Table S1 shows the 64 k-mers (k = 3) frequencies in different error events for real sequencing data. Every event is recorded with its corresponding 3-base sequence in reference and the continuous error is regarded as one event. Error rates are relatively high on some k-mers especially those k-mers whose first two bases are the same. The tendencies (Fig. <xref rid="Fig1" ref-type="fig">1</xref> and Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S2) in datasets <italic>E. coli</italic> and <italic>C. elegans</italic> seem close and it’s reasonable because these two datasets are from the same sequencer RSII P6-C4. The error size distribution is also derived from alignment results. Although we observed sequencing error bias across the relative locations in the reads, we did not include this pattern in the current version of PaSS.<fig id="Fig1"><label>Fig. 1</label><caption><p>The distribution of sequencing error rates based on the context of 64 k-mers (k = 3) in real sequencing datasets of <italic>E. coli K12</italic>, <italic>C. elegans</italic> and <italic>A. thaliana</italic></p></caption><graphic xlink:href="12859_2019_2901_Fig1_HTML" id="MO1"/></fig></p>
    </sec>
    <sec id="Sec4">
      <title>Simulation of PacBio multi-pass sequencing reads</title>
      <p id="Par12">Figure <xref rid="Fig2" ref-type="fig">2</xref> illustrates the simulation process. First, the number of forward-reverse cycles is estimated from the distribution of pass-number and the read length is determined by the corresponding length distribution of this pass-number. PaSS then randomly samples one error-free read from a user-specified reference genomic sequence. If the selected sequence contains Ns, those Ns are replaced randomly with ACGTs in the read. The collected read is treated as a sequence template, and the subreads of it alternate between the forward and reverse strands. Finally, errors are introduced to get the output read. The reads that are marked to come from the same template are divided into presumed unaligned part and aligned part according to the relative position inside the polymerase read. For the presumed unaligned sections, we use a preset high error rate. According to the comparison between different preset error rates (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S2), we chose 0.4 as the default value. As for the aligned regions, an event type is randomly drawn based on the context-specific bin recorded in the model. When an error occurs, the length of the error is then drawn from the model. From the real PacBio data, we found that the inserted nucleotides depend on the sequence context. Hence, if the error is an insertion, the inserted nucleotides are also decided by the context. If the error is a substitution, the substitution pattern is introduced according to the distribution of twelve substitution types.<fig id="Fig2"><label>Fig. 2</label><caption><p>System diagram of PaSS. The sequencing profile (or sequencing error model) can be generated from real sequencing data and  its alignment to a reference genome. Reads can be simulated based on the reference genome and the sequencing profile (or error model). For each read, a fragment of sequence from the reference genome is selected first then the sequencing errors will be added according to the profile, which includes preset error rates for two ends of the read, the number of passes, read length distribution, context based error model and error size</p></caption><graphic xlink:href="12859_2019_2901_Fig2_HTML" id="MO2"/></fig></p>
    </sec>
    <sec id="Sec5">
      <title>Real PacBio sequencing datasets</title>
      <p id="Par13">In order to assess the performance of PaSS, three real PacBio sequencing datasets for <italic>E. coli</italic>, <italic>C. elegans</italic>, and <italic>A. thaliana</italic> were chosen for benchmarking. Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S3 shows brief statistics of these datasets and they can be downloaded freely from the websites listed in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S3. In order to have a comprehensive assessment of the performance of sequencing simulators, we included real sequencing data from two different platforms, RSII and Sequel. The sequencing data for <italic>E. coli</italic> and <italic>C. elegans</italic> were from RSII sequencing platform while <italic>A. thaliana</italic> sequencing data was from the latest Sequel platform.</p>
    </sec>
    <sec id="Sec6">
      <title>Simulation method comparison</title>
      <p id="Par14">In order to do a fair comparison, we tried to estimate the sequencing models for all methods from the real sequencing data first and reads were simulated using the sequencing models generated for the same genome. Since the NPBSS program can only simulate single chromosome, we simulated a chromosome each time and mixed the reads for <italic>C.elegans</italic> and <italic>A. thaliana</italic>. LongISLND couldn’t generate profile from Sequel data and we did not simulate reads for <italic>A. thaliana</italic> using LongISLND.</p>
    </sec>
  </sec>
  <sec id="Sec7">
    <title>Results and discussion</title>
    <p id="Par15">A new sequencing simulator for PacBio sequencing called PaSS was implemented. We compared PaSS with three existing popular methods, PBSIM, LongISLND and NPBSS, using three sequence datasets (see Methods for more details).</p>
    <sec id="Sec8">
      <title>Simulation results and comparisons</title>
      <p id="Par16">The length distribution of simulated reads and that of the real sequencing data were compared and results were shown in Fig. <xref rid="Fig3" ref-type="fig">3</xref> (A). All simulators get length distribution similar to that of real sequencing data. The default value of maximum read length defined in PBSIM was outdated and could not be reconfigured.<fig id="Fig3"><label>Fig. 3</label><caption><p>Comparison of simulated data with the real sequencing data. (<bold>a</bold>) Comparison of read length distributions. Subfigure a, b and c showed the read length distribution collected for three organisms, <italic>E. coli</italic>
<italic>K12</italic>, <italic>C. elegans</italic> and <italic>A. thaliana</italic> respectively. (<bold>b</bold>) Comparison of error size distribution. Simulated reads from different methods were compared with real sequencing data on error size distribution for organism <italic>E. coli</italic>
<italic>K12</italic>. Three subfigures showed the probability density bar plot for insertion, deletion and substitution respectively</p></caption><graphic xlink:href="12859_2019_2901_Fig3_HTML" id="MO3"/></fig></p>
      <p id="Par17">We then assessed the length distribution of the error bases. Figure <xref rid="Fig3" ref-type="fig">3</xref> (B) shows the length distribution of the error bases for <italic>E. coli</italic> (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S3. for <italic>C. elegans</italic> and <italic>A. thaliana</italic>). Although most lengths of indels are one base long, there are about 15–20% of insertions and 7–10% of deletions contain multiple bases. Unlike the indels, the length for vast majority of the substitutions is one base. PBSIM and NPBSS reads are more distinct from the real sequencing data at this aspect because they only include single base error in their models.</p>
      <p id="Par18">Next, we used the Kolmogorov–Smirnov test (K-S test) to decide whether two probability distributions of real sequencing data and simulated data are different. The null hypothesis of this test is that the two sets of data are drawn from the same distribution. K-S test was performed for the read length distribution and the distribution of error bases. The resulted <italic>p</italic>-values in Table S4 and S5 (see Additional file <xref rid="MOESM1" ref-type="media">1</xref>) reject the null hypothesis, which indicate the two distributions between all the simulated data and real sequencing data are distinguishable. Nevertheless, the test statistics D between real sequencing data and simulated data of PaSS is the minimum among the several simulators in most cases. Test statistics D is the maximum value of the difference between two distributions. Therefore, it shows that the distance between the distributions of simulated data from PaSS and real data is the closest. Moreover, it is consistent with what is shown in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S4 and S5.</p>
      <p id="Par19">Table <xref rid="Tab1" ref-type="table">1</xref> (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Tables S6-S7) shows the statistics of alignment results, from which we can see that the alignment rates and the error rates in terms of insertion, deletion and substitution from PaSS are more consistent with the real sequencing data than existing methods. More than 99% bases of the simulated reads by PBSIM, LongISLND and NPBSS can be aligned to the reference, while the alignment rates of real sequencing reads and PaSS reads are more consistent to each other, ranging from 89 to 94% for the three datasets. Because only the aligned regions were analyzed and included in the estimated profile, the unaligned regionswere ignored by these three simulators. As mentioned before, the quality values (QVs) in Sequel sequenced data did not represent the actual error rates. Therefore, PBSIM was not able to get reasonable parameters from real sequencing data from the Sequel platform. If we did use PBSIM to re-estimate sequencing error models from real Sequel sequencing data, the error rate may be less than 1%, which was much lower than it should be. Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S6 showed the distribution of the average accuracy (1-error rate) over the whole polymerase read. The quality of sequencing reads is not uniform and PaSS provides a more realistic simulation result than other tools. In general, PaSS can simulate PacBio data reasonably better than other simulators especially for the new Sequel data.<table-wrap id="Tab1"><label>Table 1</label><caption><p>Statistics about the simulated reads by PBSIM, LongISLND, NPBSS, PaSS and real sequencing data for <italic>E. coli K12</italic> genome. Reads were aligned back to <italic>E. coli</italic>
<italic>K12</italic> genome</p></caption><table frame="hsides" rules="groups"><thead><tr><th>methods</th><th>aligned rate(read)</th><th>aligned rate(base)</th><th>error rate</th><th>insertion</th><th>deletion</th><th>substitution</th></tr></thead><tbody><tr><td>real data</td><td>96.71%</td><td>91.74%</td><td>14.54%</td><td>9.42%</td><td>3.86%</td><td>1.27%</td></tr><tr><td>PBSIM</td><td>99.99%</td><td>99.73%</td><td>12.27%</td><td>7.22%</td><td>3.16%</td><td>1.89%</td></tr><tr><td>LongISLND</td><td>99.90%</td><td>99.92%</td><td>11.07%</td><td>7.09%</td><td>2.77%</td><td>1.20%</td></tr><tr><td>NPBSS</td><td>100.00%</td><td>99.93%</td><td>11.48%</td><td>2.67%</td><td>6.05%</td><td>2.76%</td></tr><tr><td>PaSS</td><td>95.84%</td><td>92.53%</td><td>14.39%</td><td>8.97%</td><td>3.80%</td><td>1.62%</td></tr></tbody></table></table-wrap></p>
      <p id="Par20">We further investigated the correlation between the error rates and the relative positions of bases in a read. We divided each polymerase read into ten fragments equally, then calculated the average error rate of each fragment. As shown in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S7, the error rate from the real sequencing data decreases quickly at the first one or two fragments and then increases slightly at the end fragment of a read. We have tried to divide the reads into 10 evenly divided intervals, and one interval, and found that the simulation results for the 10 interval model and the one-interval model were similar. Therefore, we adopted one interval model in the end.</p>
    </sec>
    <sec id="Sec9">
      <title>Speed comparison</title>
      <p id="Par21">In order to compare the speed of the four simulators, we simulated reads for genome <italic>E. coli K12</italic> and <italic>C. elegans</italic> with sequencing depth 170 and 50 respectively. We report the computational time for all simulators in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S8. PaSS can be run in parallel with multi-thread. Therefore, different running time for PaSS was listed with various numbers of threads. PBSIM is the fastest tool while NPBSS is the slowest one. PaSS is faster than PBSIM and LongILSND if more than 4 threads are used for PaSS.</p>
    </sec>
    <sec id="Sec10">
      <title>Assessment of simulation with assembly results</title>
      <p id="Par22">We conducted assembly on reads simulated by PBSIM, NPBSS, LongISLND and PaSS and real sequencing data. Each genome was simulated with sequencing depths of 5, 10, 15, 20, 25, 30, 35, and 40. <italic>C. elegans</italic> was simulated additionally for sequencing depth of 45 and <italic>E. coli</italic> was simulated additionally for sequencing depth 45 and 50. We conducted de novo assemblies using canu, an assembler designed for noisy long length read sequencers [<xref ref-type="bibr" rid="CR18">18</xref>]. Quast [<xref ref-type="bibr" rid="CR19">19</xref>] was utilized to compare the assemblies with the reference genome and evaluate the simulators in terms of some features. The number of contigs, genome fraction, indels per 100 kb, mismatches per 100kbp, N50 and indel length of the contigs were compared for assemblies derived from simulated datasets and the real sequencing data. The assembly results shown in Fig. <xref rid="Fig4" ref-type="fig">4</xref>, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S8 and S9 are for <italic>E. coli K12</italic>, <italic>C. elegans</italic> and <italic>A. thaliana</italic> respectively. Assembly result evaluation is an indirect comparison between the simulators. The results of PaSS show more similar patterns to the results of real sequencing data than other simulators. In terms of the number of contigs in the assembly and genome fraction being assembled, the curve tends to be stable at 25× for organism <italic> E. coli</italic> and 35× for organism <italic>C. elegans</italic>. It indicates that these sequencing depths can be adopted in real experiments. From the proportion that the reference covered by the number of aligned contigs, the assembly result of PaSS is much closer to real sequencing data than the other simulators. What’s more, the indicators about the average number of indels and mismatches per 100kbp aligned bases also show that PaSS simulated reads are more similar to the real data than other simulators. Although the contigs assembled from high sequencing depth (&gt;30X) simulated data could cover most of the reference genomes for all simulators, the results from lower sequencing depth (5-30X) did show the gap between the real data and simulated data, and the simulated reads from PaSS were more similar to the real data than the other simulators.<fig id="Fig4"><label>Fig. 4</label><caption><p>Comparison of the assembly results for real reads and simulated by different methods. The six subfigures show the relationships between sequencing depth and the resulted (<bold>a</bold>) number of contigs, (<bold>b</bold>) genome fraction, (<bold>c</bold>) number of indels per 100kbp, (<bold>d</bold>) number of mismatches per 100kbp, (<bold>e</bold>) N50, and (<bold>f</bold>) the length of indels of contigs in the assembly results for organism <italic>E. coli K12</italic> . X-axis stands for the sequencing depth</p></caption><graphic xlink:href="12859_2019_2901_Fig4_HTML" id="MO4"/></fig></p>
    </sec>
  </sec>
  <sec id="Sec11">
    <title>Conclusions</title>
    <p id="Par23">In this paper, we propose PaSS to simulate PacBio sequencing reads to keep up with the latest sequencing technology. We incorporated sequence context into the sequencing model of PaSS. Comparing to existing methods, the part of the sequence that cannot be aligned back to reference due to the high error rate is also considered in PaSS. To our evaluation, PaSS can simulate PacBio sequencing reads more similar to real PacBio data than the existing simulation systems. Overall, PaSS is an effective sequence simulator to generate benchmark datasets with the known ground truth so that it can be beneficial to evaluate the latest bioinformatics tools. Besides, it can be used as guidance for researchers since no gold standard is available for data analysis. The simulation of PaSS could serve as a reference to determine some critical parameters for a specific project.</p>
    <p id="Par24">However, PaSS can still be improved on various aspects. First,the length of kmer is limited. Second, the method to estimate error models based on alignment results is not perfect. The algorithm and performance of the alignment tool will affect the estimated error models and may bring additional bias. Third, the sequencing simulator cannot be customized or updated easily for different species.</p>
  </sec>
  <sec id="Sec12">
    <title>Availability and requirements</title>
    <p id="Par25"><bold>Project name:</bold> PaSS.</p>
    <p id="Par26">
      <bold>Project home page:</bold>
      <ext-link ext-link-type="uri" xlink:href="http://cgm.sjtu.edu.cn/PaSS">http://cgm.sjtu.edu.cn/PaSS</ext-link>
    </p>
    <p id="Par27"><bold>Operating system(s):</bold> Linux.</p>
    <p id="Par28"><bold>Programming language:</bold> Perl and C.</p>
    <p id="Par29"><bold>Other requirements:</bold> Perl(5.10.1 or above), gcc (4.8.0 or above).</p>
    <p id="Par30"><bold>License:</bold> GNU GPL.</p>
    <p id="Par31"><bold>Any restrictions to use by non-academics:</bold> None.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Additional file</title>
    <sec id="Sec13">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="12859_2019_2901_MOESM1_ESM.docx">
            <label>Additional file 1:</label>
            <caption>
              <p>Supplementary Material (including supplementary figures and tables) for PaSS. (DOCX 4780 kb)</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <ack>
    <title>Acknowledgements</title>
    <p>We thank the High Performance Computing Center (HPCC) at Shanghai Jiao Tong University for the computation.</p>
    <sec id="FPar1">
      <title>Funding</title>
      <p id="Par32">This work was supported by grants from the National Natural Science Foundation of China (61472246), the National Basic Research Program of China (2013CB956103), the National High-Tech R&amp;D Program (863) (2014AA021502) and the Cross-Institute Research Fund of Shanghai Jiao Tong University (YG2017ZD01). The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</p>
    </sec>
    <sec id="FPar2" sec-type="data-availability">
      <title>Availability of data and materials</title>
      <p id="Par33">All data in this paper is available in <ext-link ext-link-type="uri" xlink:href="http://cgm.sjtu.edu.cn/PaSS">http://cgm.sjtu.edu.cn/PaSS</ext-link>.</p>
    </sec>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>CW conceived and designed the study. WZ and BJ implemented the pipeline, WZ tested the pipeline. WZ, BJ and CW wrote the manuscript.</p>
  </notes>
  <notes>
    <title>Ethics approval and consent to participate</title>
    <p id="Par34">Not applicable.</p>
  </notes>
  <notes notes-type="COI-statement">
    <title>Competing interests</title>
    <p id="Par35">The authors declare that they have no competing interest.</p>
  </notes>
  <notes>
    <title>Publisher’s Note</title>
    <p id="Par36">Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>van Dijk</surname>
            <given-names>EL</given-names>
          </name>
          <name>
            <surname>Jaszczyszyn</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Naquin</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The third revolution in sequencing technology</article-title>
        <source>Trends Genet</source>
        <year>2018</year>
        <volume>34</volume>
        <issue>9</issue>
        <fpage>666</fpage>
        <lpage>81</lpage>
        <pub-id pub-id-type="doi">10.1016/j.tig.2018.05.008</pub-id>
        <pub-id pub-id-type="pmid">29941292</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Eid</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Fehr</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Gray</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Real-time DNA sequencing from single polymerase molecules</article-title>
        <source>Science</source>
        <year>2009</year>
        <volume>323</volume>
        <issue>5910</issue>
        <fpage>133</fpage>
        <lpage>8</lpage>
        <pub-id pub-id-type="doi">10.1126/science.1162986</pub-id>
        <pub-id pub-id-type="pmid">19023044</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <mixed-citation publication-type="other">Chaisson MJ, Tesler G. Mapping single molecule sequencing reads using basic local alignment with successive refinement (BLASR): application and theory. BMC Bioinformatics. 2012;13(1):238.</mixed-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <mixed-citation publication-type="other">Sović I, Šikić M, Wilm A, et al. Fast and sensitive mapping of nanopore sequencing reads with GraphMap. Nat Commun. 2016;7:11307.</mixed-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Koren</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Walenz</surname>
            <given-names>BP</given-names>
          </name>
          <name>
            <surname>Berlin</surname>
            <given-names>K</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Canu: scalable and accurate long-read assembly via adaptive k-mer weighting and repeat separation</article-title>
        <source>Genome Res</source>
        <year>2017</year>
        <volume>27</volume>
        <issue>5</issue>
        <fpage>722</fpage>
        <lpage>36</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.215087.116</pub-id>
        <pub-id pub-id-type="pmid">28298431</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Minimap and miniasm: fast mapping and de novo assembly for noisy long sequences</article-title>
        <source>Bioinformatics</source>
        <year>2016</year>
        <volume>32</volume>
        <issue>14</issue>
        <fpage>2103</fpage>
        <lpage>10</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btw152</pub-id>
        <pub-id pub-id-type="pmid">27153593</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <mixed-citation publication-type="other">English AC, Salerno WJ, Reid JG. PBHoney: identifying genomic variants via long-read discordance and interrupted mapping. BMC Bioinf. 2014;15(1):180.</mixed-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sedlazeck</surname>
            <given-names>FJ</given-names>
          </name>
          <name>
            <surname>Rescheneder</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Smolka</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Accurate detection of complex structural variations using single-molecule sequencing</article-title>
        <source>Nat Methods</source>
        <year>2018</year>
        <volume>15</volume>
        <issue>6</issue>
        <fpage>461</fpage>
        <lpage>8</lpage>
        <pub-id pub-id-type="doi">10.1038/s41592-018-0001-7</pub-id>
        <pub-id pub-id-type="pmid">29713083</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Escalona</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Rocha</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Posada</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>A comparison of tools for the simulation of genomic next-generation sequencing data</article-title>
        <source>Nat Rev Genet</source>
        <year>2016</year>
        <volume>17</volume>
        <issue>8</issue>
        <fpage>459</fpage>
        <lpage>69</lpage>
        <pub-id pub-id-type="doi">10.1038/nrg.2016.57</pub-id>
        <pub-id pub-id-type="pmid">27320129</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhao</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Qu</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Systematic review of next-generation sequencing simulators: computational tools, features and perspectives</article-title>
        <source>Brief Funct Genomics</source>
        <year>2017</year>
        <volume>16</volume>
        <issue>3</issue>
        <fpage>121</fpage>
        <lpage>8</lpage>
        <?supplied-pmid 27069250?>
        <pub-id pub-id-type="pmid">27069250</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Goodwin</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>McPherson</surname>
            <given-names>JD</given-names>
          </name>
          <name>
            <surname>McCombie</surname>
            <given-names>WR</given-names>
          </name>
        </person-group>
        <article-title>Coming of age: ten years of next-generation sequencing technologies</article-title>
        <source>Nat Rev Genet</source>
        <year>2016</year>
        <volume>17</volume>
        <issue>6</issue>
        <fpage>333</fpage>
        <lpage>51</lpage>
        <pub-id pub-id-type="doi">10.1038/nrg.2016.49</pub-id>
        <pub-id pub-id-type="pmid">27184599</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <mixed-citation publication-type="other">Cao Y, Fanning S, Proos S, et al. A review on the applications of next generation sequencing technologies as applied to food-related microbiome studies. Front Microbiol. 2017;8:1829.</mixed-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ardui</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Ameur</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Vermeesch</surname>
            <given-names>JR</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single molecule real-time (SMRT) sequencing comes of age: applications and utilities for medical diagnostics</article-title>
        <source>Nucleic Acids Res</source>
        <year>2018</year>
        <volume>46</volume>
        <issue>5</issue>
        <fpage>2159</fpage>
        <lpage>68</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gky066</pub-id>
        <pub-id pub-id-type="pmid">29401301</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rhoads</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Au</surname>
            <given-names>KF</given-names>
          </name>
        </person-group>
        <article-title>PacBio sequencing and its applications</article-title>
        <source>Genomics Proteomics Bioinformatics</source>
        <year>2015</year>
        <volume>13</volume>
        <issue>5</issue>
        <fpage>278</fpage>
        <lpage>89</lpage>
        <pub-id pub-id-type="doi">10.1016/j.gpb.2015.08.002</pub-id>
        <pub-id pub-id-type="pmid">26542840</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ono</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Asai</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Hamada</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>PBSIM: PacBio reads simulator—toward accurate genome assembly</article-title>
        <source>Bioinformatics</source>
        <year>2012</year>
        <volume>29</volume>
        <issue>1</issue>
        <fpage>119</fpage>
        <lpage>21</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bts649</pub-id>
        <pub-id pub-id-type="pmid">23129296</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lau</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Mohiyuddin</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Mu</surname>
            <given-names>JC</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>LongISLND: in silico sequencing of lengthy and noisy datatypes</article-title>
        <source>Bioinformatics</source>
        <year>2016</year>
        <volume>32</volume>
        <issue>24</issue>
        <fpage>3829</fpage>
        <lpage>32</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btw602</pub-id>
        <pub-id pub-id-type="pmid">27667791</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <mixed-citation publication-type="other">Wei Z-G, Zhang S-W. NPBSS: a new PacBio sequencing simulator for generating the continuous long reads with an empirical model. BMC Bioinformatics. 2018;19(1):177.</mixed-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jayakumar</surname>
            <given-names>Vasanthan</given-names>
          </name>
          <name>
            <surname>Sakakibara</surname>
            <given-names>Yasubumi</given-names>
          </name>
        </person-group>
        <article-title>Comprehensive evaluation of non-hybrid genome assembly tools for third-generation PacBio long-read sequence data</article-title>
        <source>Briefings in Bioinformatics</source>
        <year>2017</year>
        <volume>20</volume>
        <issue>3</issue>
        <fpage>866</fpage>
        <lpage>876</lpage>
        <pub-id pub-id-type="doi">10.1093/bib/bbx147</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gurevich</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Saveliev</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Vyahhi</surname>
            <given-names>N</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>QUAST: quality assessment tool for genome assemblies</article-title>
        <source>Bioinformatics</source>
        <year>2013</year>
        <volume>29</volume>
        <issue>8</issue>
        <fpage>1072</fpage>
        <lpage>75</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btt086</pub-id>
        <pub-id pub-id-type="pmid">23422339</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
