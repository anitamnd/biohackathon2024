<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Sci Rep</journal-id>
    <journal-id journal-id-type="iso-abbrev">Sci Rep</journal-id>
    <journal-title-group>
      <journal-title>Scientific Reports</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2045-2322</issn>
    <publisher>
      <publisher-name>Nature Publishing Group UK</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8683425</article-id>
    <article-id pub-id-type="publisher-id">2265</article-id>
    <article-id pub-id-type="doi">10.1038/s41598-021-02265-4</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Functional random forests for curve response</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Fu</surname>
          <given-names>Guifang</given-names>
        </name>
        <address>
          <email>gfu@binghamton.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Dai</surname>
          <given-names>Xiaotian</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Liang</surname>
          <given-names>Yeheng</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <aff id="Aff1"><institution-wrap><institution-id institution-id-type="GRID">grid.264260.4</institution-id><institution-id institution-id-type="ISNI">0000 0001 2164 4508</institution-id><institution>Department of Mathematical Sciences, </institution><institution>SUNY Binghamton University, </institution></institution-wrap>Vestal, NY 13850 USA </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>17</day>
      <month>12</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>17</day>
      <month>12</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2021</year>
    </pub-date>
    <volume>11</volume>
    <elocation-id>24159</elocation-id>
    <history>
      <date date-type="received">
        <day>4</day>
        <month>2</month>
        <year>2021</year>
      </date>
      <date date-type="accepted">
        <day>20</day>
        <month>8</month>
        <year>2021</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2021</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold>This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1">The rapid advancement of functional data in various application fields has increased the demand for advanced statistical approaches that can incorporate complex structures and nonlinear associations. In this article, we propose a novel functional random forests (FunFor) approach to model the functional data response that is densely and regularly measured, as an extension of the landmark work of Breiman, who introduced traditional random forests for a univariate response. The FunFor approach is able to predict curve responses for new observations and selects important variables from a large set of scalar predictors. The FunFor approach inherits the efficiency of the traditional random forest approach in detecting complex relationships, including nonlinear and high-order interactions. Additionally, it is a non-parametric approach without the imposition of parametric and distributional assumptions. Eight simulation settings and one real-data analysis consistently demonstrate the excellent performance of the FunFor approach in various scenarios. In particular, FunFor successfully ranks the true predictors as the most important variables, while achieving the most robust variable sections and the smallest prediction errors when comparing it with three other relevant approaches. Although motivated by a biological leaf shape data analysis, the proposed FunFor approach has great potential to be widely applied in various fields due to its minimal requirement on tuning parameters and its distribution-free and model-free nature. An R package named ’FunFor’, implementing the FunFor approach, is available at GitHub.</p>
    </abstract>
    <kwd-group kwd-group-type="npg-subject">
      <title>Subject terms</title>
      <kwd>Genetics</kwd>
      <kwd>Genetic association study</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000001</institution-id>
            <institution>National Science Foundation</institution>
          </institution-wrap>
        </funding-source>
        <award-id>DMS-1413366</award-id>
        <principal-award-recipient>
          <name>
            <surname>Fu</surname>
            <given-names>Guifang</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2021</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Introduction</title>
    <p id="Par2">Functional data analysis has become an active research topic as technological measurement devices become more sophisticated (e.g., new sensors and electrodes). Its far-reaching applications include biological shape and contour studies, global climate change, drug sensitivity curve for cancerous cell lines, functional near infrared spectroscopy (fNIRS), functional magnetic resonance imaging (fMRI), electroencephalography (EEG), population kinetics of plasma folate, and more<sup><xref ref-type="bibr" rid="CR1">1</xref>–<xref ref-type="bibr" rid="CR3">3</xref></sup>. Our work is driven by a leaf morphology (shape) trait that possesses tremendous variability in nature<sup><xref ref-type="bibr" rid="CR4">4</xref>,<xref ref-type="bibr" rid="CR5">5</xref></sup>, reflecting ecological and evolutionary drivers<sup><xref ref-type="bibr" rid="CR6">6</xref>,<xref ref-type="bibr" rid="CR7">7</xref></sup>. Each leaf shape is described as a 910-dimensional functional data object with regular and dense grids. Scientists are particularly interested in exploring which genes truly regulate the variation of the dynamic trajectory of biological shape phenotypes and in predicting shape for future observations. Shape has been found to be affected by gene–gene interactions<sup><xref ref-type="bibr" rid="CR8">8</xref>,<xref ref-type="bibr" rid="CR9">9</xref></sup>; however, interactive variables are hard to detect because they may have very small marginal/main effects. Manolio et al. summarized a few difficulties in modeling complex traits, including the low power to detect gene-gene interactions<sup><xref ref-type="bibr" rid="CR10">10</xref></sup>.</p>
    <p id="Par3">A typical definition of functional data is to collect data by machines over a dense and regular grid of time/location points, as our motivated leaf shape data does. Despite the fact that the data is measured in the form of multiple discrete points in various aforementioned applications, an underlying trajectory is clearly manifested as a smooth random function. Therefore, modeling the response as a single entry and capturing its dynamic trajectory reflects the true need. Challenges come from the potentially hidden structure and that the data’s distribution is messier than any assumptions. Nonlinear and non-additive relations, which truly reflect the characteristics of the real world’s messy dataset in practice, have been neglected by many existing approaches.</p>
    <p id="Par4">In this article, we propose a new approach named Functional Random Forests (FunFor), which facilitates an extension from the traditional random forests methodology (RF for short; designed for a univariate response) to a functional or curve response setting. The inputs of the FunFor method will be a curve response along with a set of scalar predictors for each observation. FunFor outputs the predicted curve response for each observation along with the importance rank of each predictor according to its association strength with the curve response. The FunFor approach has many beneficial properties: effectively accommodating both the linear and nonlinear associations; jointly modeling multiple predictors instead of isolating them; capturing the intricate higher-order interactions without the need of specifying the order or structure of interactions; being flexible for various predictor types, such as binary, categorical, and/or continuous predictors; demonstrating feasibility for high dimensionality when the number of predictors is larger than the number of observations; embracing a nonparametric approach without assuming any specific model structure or certain distribution; and requiring few tuning parameters. We demonstrate that the FunFor approach performs well through eight simulation settings under various difficulty levels and also one real data analysis. Although the proposed FunFor approach was driven by a genetic leaf shape problem, it has far-reaching potential to be applied widely in various fields that have functional traits<sup><xref ref-type="bibr" rid="CR2">2</xref>,<xref ref-type="bibr" rid="CR3">3</xref>,<xref ref-type="bibr" rid="CR11">11</xref></sup>, as the traditional random forest approach does for univariate traits. An R package named ’FunFor’, implementing the FunFor approach, is available at GitHub (<ext-link ext-link-type="uri" xlink:href="https://github.com/xiaotiand/FunFor">https://github.com/xiaotiand/FunFor</ext-link>). It can be installed by running devtools::install_github (“xiaotiand/FunFor”).</p>
    <p id="Par5">While the literature based on the functional linear regression model is vast<sup><xref ref-type="bibr" rid="CR12">12</xref>–<xref ref-type="bibr" rid="CR20">20</xref></sup>, we want to emphasize that they propose a parametric model structure and assume a linear relationship without focusing on interactions or complex structures. As commented by Chen et al., few methods for simultaneous variable selection and prediction exist in the functional/curve data literature<sup><xref ref-type="bibr" rid="CR16">16</xref></sup>. Additionally, functional analyses exploring higher-order interactions and nonlinear associations without any model structure or distribution assumptions are even rarer, despite the fact that such scenarios widely exist in practice. In general, nonparametric data-driven tree-based approaches have been found to frequently outperform the classic regression approaches when the datasets have more complex structures than general assumptions<sup><xref ref-type="bibr" rid="CR21">21</xref></sup>.</p>
    <p id="Par6">A few attempts have been made to extend the tree-based models from a univariate response to a curve response. Segal assumed three well-known covariance structures<sup><xref ref-type="bibr" rid="CR22">22</xref></sup>: independence, compound symmetry, and a first-order autoregressive model. As pointed out by Zhang and Singer<sup><xref ref-type="bibr" rid="CR23">23</xref></sup>, Segal’s studies were restricted to longitudinal data having a given auto-covariance structure. Abdolell et al. extended the regression tree from a univariate response to a longitudinal response, but they only considered a prognostic predictor<sup><xref ref-type="bibr" rid="CR24">24</xref></sup>. In summary, these early works represented breakthroughs in extending standard regression tree models from one univariate response to a curve response. However, they either mainly focused on the longitudinal data instead of functional data or built only one single tree. The restriction of using one single tree has been already observed<sup><xref ref-type="bibr" rid="CR25">25</xref></sup>. Fu et al. built multiple individual models by applying the traditional random forests approach to fit each individual principal component score of the curve separately without truly incorporating the functional nature of the curve response as a whole unit<sup><xref ref-type="bibr" rid="CR8">8</xref></sup>. Moller et al. used a functional random forests approach to model functional predictors but a scalar response<sup><xref ref-type="bibr" rid="CR26">26</xref></sup>, the opposite of the setting we consider.</p>
    <p id="Par7">In this article, we compare the proposed FunFor approach with three other directly comparable works: the ‘refund’ R package implementing the function-on-scalar regression model with LASSO penalty proposed by Reiss et al.<sup><xref ref-type="bibr" rid="CR13">13</xref>,<xref ref-type="bibr" rid="CR27">27</xref></sup>, the ‘splinetree’ R package that was built based on the work of Yu and Lambert<sup><xref ref-type="bibr" rid="CR11">11</xref>,<xref ref-type="bibr" rid="CR28">28</xref></sup>, and the functional random forests (FRF) approach proposed by Rahman et al.<sup><xref ref-type="bibr" rid="CR3">3</xref></sup>. See Scheipl for a comprehensive CRAN task view: functional data analysis<sup><xref ref-type="bibr" rid="CR29">29</xref></sup>. As demonstrated in the “<xref rid="Sec9" ref-type="sec">Simulation studies</xref>” section, the FunFor approach achieves the most effective and robust performance among the four approaches in the three simulation examples. In addition to the empirical comparisons, we also comment on the common and different technique points of these four approaches. The four approaches can all be utilized for not only detecting important associations between scalar predictors and the curve response but also predicting dynamic trajectory of the curve response.</p>
    <p id="Par8">The differences are as follows: The function-on-scalar regression model shrinks unimportant predictors to zero and is feasible for variable selection in the case of <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p&gt;n$$\end{document}</tex-math><mml:math id="M2"><mml:mrow><mml:mi>p</mml:mi><mml:mo>&gt;</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="41598_2021_2265_Article_IEq1.gif"/></alternatives></inline-formula> when incorporating the LASSO penalty. However, it relies on a parametric model structure and linear relationship assumptions<sup><xref ref-type="bibr" rid="CR13">13</xref></sup>, without focusing on nonlinear associations and complex structures. Yu and Lambert realized the advantage of functional trees to cope with complex and nonlinear relationships. However, they proposed a multivariate regression tree to fit the coefficients of the spline basis functions or the first few principal component scores of the curve response. Actually, the multivariate modeling does not utilize the time course of the functional data and therefore cannot describe the overall time trajectory of the response in the functional sense. Yu and Lambert gave an example in which applying a multivariate regression tree model to a curve response was not successful<sup><xref ref-type="bibr" rid="CR11">11</xref></sup>. Rahman et al. also proposed a functional random forests approach and obtained good results when applying it to predict the dose-response curve for cancerous lines<sup><xref ref-type="bibr" rid="CR3">3</xref></sup>. There exists multiple detailed technique differences between the two methods: Rahman et al. divided the entire curve into several regions and computed the overall error by summing up several individual errors (i.e. node costs) obtained from each of the regions. The node cost computation at each region is very close to that of the traditional random forest model by using one point (mean or medium of multiple points) per region. However, this region-wise approach may not truly incorporate the functional nature of the response during the tree construction process. Additionally, they did not provide a well-justified rule for how to determine the number of regions. After investigating multiple options, we noticed that the choice of the number of regions greatly affected the results. The characteristics of the function were reflected in their last step by adopting a linear combination of B-spline functions at the leaf nodes to predict the curve response<sup><xref ref-type="bibr" rid="CR3">3</xref></sup>, but they neglected the roles of the covariance structure, which were found to produce incorrect variance estimates<sup><xref ref-type="bibr" rid="CR30">30</xref>,<xref ref-type="bibr" rid="CR31">31</xref></sup>. Conversely, the FunFor approach integrates the functional nature of the response everywhere into an indispensable system. In addition, the FunFor approach continues to update curve estimates by computing both the mean and the complex covariance structure after the observations are recursively divided into two child nodes. Truly integrating the functional process during both the tree building-up process and leaf node prediction process is not only important but is more accurate.</p>
  </sec>
  <sec id="Sec2">
    <title>Methodology</title>
    <p id="Par9">Let <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Y_{ik}, i=1,\ldots ,n;\,k=1,\ldots ,K$$\end{document}</tex-math><mml:math id="M4"><mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi mathvariant="italic">ik</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mo>;</mml:mo><mml:mspace width="0.166667em"/><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="41598_2021_2265_Article_IEq2.gif"/></alternatives></inline-formula> denote the dense but discretely recorded curve response for the <inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i\text{{th}}$$\end{document}</tex-math><mml:math id="M6"><mml:mrow><mml:mi>i</mml:mi><mml:mtext>th</mml:mtext></mml:mrow></mml:math><inline-graphic xlink:href="41598_2021_2265_Article_IEq3.gif"/></alternatives></inline-formula> observation, measured at the <inline-formula id="IEq4"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k\text{{th}}$$\end{document}</tex-math><mml:math id="M8"><mml:mrow><mml:mi>k</mml:mi><mml:mtext>th</mml:mtext></mml:mrow></mml:math><inline-graphic xlink:href="41598_2021_2265_Article_IEq4.gif"/></alternatives></inline-formula> time (or location) point. Here, <italic>K</italic> is the number of time points, which is set to be the same for each observation; <italic>n</italic> is the number of observations, and <italic>p</italic> is the number of predictors. Let <inline-formula id="IEq5"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{X}}_i \in {\mathbb {R}} ^ {1 \times p}$$\end{document}</tex-math><mml:math id="M10"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>×</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="41598_2021_2265_Article_IEq5.gif"/></alternatives></inline-formula> be the <inline-formula id="IEq6"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i\text{{th}}$$\end{document}</tex-math><mml:math id="M12"><mml:mrow><mml:mi>i</mml:mi><mml:mtext>th</mml:mtext></mml:mrow></mml:math><inline-graphic xlink:href="41598_2021_2265_Article_IEq6.gif"/></alternatives></inline-formula> row of the design matrix, and <inline-formula id="IEq7"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$X_j, j=1,\ldots ,p$$\end{document}</tex-math><mml:math id="M14"><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="41598_2021_2265_Article_IEq7.gif"/></alternatives></inline-formula> be the <inline-formula id="IEq8"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$j\text{{th}}$$\end{document}</tex-math><mml:math id="M16"><mml:mrow><mml:mi>j</mml:mi><mml:mtext>th</mml:mtext></mml:mrow></mml:math><inline-graphic xlink:href="41598_2021_2265_Article_IEq8.gif"/></alternatives></inline-formula> predictor.</p>
    <p id="Par10">Technically speaking, the FunFor approach incorporates the following multiple steps: it utilizes the nonparametric functional principal component analysis (FPCA) skills to estimate the underlying random function for each subject; adopts smoothing techniques to approximate the infinite-dimensional mean functions and auto-covariance functions; incorporates the estimated and smoothed function of each observation into a regression tree framework in order to build a functional regression tree; grows an ensemble of functional regression trees; finally, outputs the variable importance measure for each predictor and the predicted curve response for each subject.</p>
    <sec id="Sec3">
      <title>Functional principal component analysis</title>
      <p id="Par11">The observed response data can be modeled as an underlying function plus noise,<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} Y_{ik}=f_{i}(t_k)+\varepsilon _{ik},\,i=1,\ldots ,n;\,t\in [0,1], \end{aligned}$$\end{document}</tex-math><mml:math id="M18" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi mathvariant="italic">ik</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>ε</mml:mi><mml:mrow><mml:mi mathvariant="italic">ik</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mo>;</mml:mo><mml:mspace width="0.166667em"/><mml:mi>t</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="41598_2021_2265_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq9"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$f_{1}(t),\ldots ,f_{n}(t)$$\end{document}</tex-math><mml:math id="M20"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="41598_2021_2265_Article_IEq9.gif"/></alternatives></inline-formula> are a collection of independent realizations of a random functional process <italic>f</italic>(<italic>t</italic>) and are defined on <inline-formula id="IEq10"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L^2([0,1])$$\end{document}</tex-math><mml:math id="M22"><mml:mrow><mml:msup><mml:mi>L</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="41598_2021_2265_Article_IEq10.gif"/></alternatives></inline-formula>. The <inline-formula id="IEq11"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varepsilon _{ik}$$\end{document}</tex-math><mml:math id="M24"><mml:msub><mml:mi>ε</mml:mi><mml:mrow><mml:mi mathvariant="italic">ik</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41598_2021_2265_Article_IEq11.gif"/></alternatives></inline-formula> are the independent experimental errors with <inline-formula id="IEq12"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$E(\varepsilon _{ik})=0$$\end{document}</tex-math><mml:math id="M26"><mml:mrow><mml:mi>E</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>ε</mml:mi><mml:mrow><mml:mi mathvariant="italic">ik</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="41598_2021_2265_Article_IEq12.gif"/></alternatives></inline-formula> and <inline-formula id="IEq13"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Var(\varepsilon _{ik})=\sigma ^2_{k}$$\end{document}</tex-math><mml:math id="M28"><mml:mrow><mml:mi>V</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>ε</mml:mi><mml:mrow><mml:mi mathvariant="italic">ik</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>k</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math><inline-graphic xlink:href="41598_2021_2265_Article_IEq13.gif"/></alternatives></inline-formula>, k=1,...,K. The mean function of <italic>f</italic>(<italic>t</italic>) is <inline-formula id="IEq14"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$E(f(t))=\mu (t)$$\end{document}</tex-math><mml:math id="M30"><mml:mrow><mml:mi>E</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>μ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41598_2021_2265_Article_IEq14.gif"/></alternatives></inline-formula>, a smooth function of <inline-formula id="IEq15"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t\in [0,1]$$\end{document}</tex-math><mml:math id="M32"><mml:mrow><mml:mi>t</mml:mi><mml:mo>∈</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41598_2021_2265_Article_IEq15.gif"/></alternatives></inline-formula> and the auto-covariance function of <italic>f</italic>(<italic>t</italic>) is <inline-formula id="IEq16"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$G(t',t)$$\end{document}</tex-math><mml:math id="M34"><mml:mrow><mml:mi>G</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41598_2021_2265_Article_IEq16.gif"/></alternatives></inline-formula>, a bivariate positive definite smooth function of <inline-formula id="IEq17"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t',t\in [0,1]$$\end{document}</tex-math><mml:math id="M36"><mml:mrow><mml:msup><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="41598_2021_2265_Article_IEq17.gif"/></alternatives></inline-formula>. In order to model the auto-covariance function, FPCA interprets <inline-formula id="IEq18"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$G(t',t)$$\end{document}</tex-math><mml:math id="M38"><mml:mrow><mml:mi>G</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41598_2021_2265_Article_IEq18.gif"/></alternatives></inline-formula> as the kernel of a linear integral operator on the space of square-integrable functions on [0, 1], mapping <inline-formula id="IEq19"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$f\in L^2([0,1])$$\end{document}</tex-math><mml:math id="M40"><mml:mrow><mml:mi>f</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mi>L</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="41598_2021_2265_Article_IEq19.gif"/></alternatives></inline-formula> to <inline-formula id="IEq20"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$A_{G} f \in L^2([0,1])$$\end{document}</tex-math><mml:math id="M42"><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mi>G</mml:mi></mml:msub><mml:mi>f</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mi>L</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="41598_2021_2265_Article_IEq20.gif"/></alternatives></inline-formula>, defined by <inline-formula id="IEq21"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(A_{G} f)(t)=\int _0^1 f(s)G(s,t)ds.$$\end{document}</tex-math><mml:math id="M44"><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mi>G</mml:mi></mml:msub><mml:mi>f</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msubsup><mml:mo>∫</mml:mo><mml:mn>0</mml:mn><mml:mn>1</mml:mn></mml:msubsup><mml:mi>f</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>G</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>d</mml:mi><mml:mi>s</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41598_2021_2265_Article_IEq21.gif"/></alternatives></inline-formula> We assume that the operator <inline-formula id="IEq22"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$A_{G}$$\end{document}</tex-math><mml:math id="M46"><mml:msub><mml:mi>A</mml:mi><mml:mi>G</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="41598_2021_2265_Article_IEq22.gif"/></alternatives></inline-formula> has a sequence of smooth orthonormal eigenfunctions <inline-formula id="IEq23"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$v_{l}(t)\in L^2([0,1])$$\end{document}</tex-math><mml:math id="M48"><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>∈</mml:mo><mml:msup><mml:mi>L</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="41598_2021_2265_Article_IEq23.gif"/></alternatives></inline-formula> satisfying <inline-formula id="IEq24"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\int _0^1 v_{k}(t)v_{l}(t)dt=\delta _{kl}$$\end{document}</tex-math><mml:math id="M50"><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo><mml:mn>0</mml:mn><mml:mn>1</mml:mn></mml:msubsup><mml:msub><mml:mi>v</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mi mathvariant="italic">kl</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="41598_2021_2265_Article_IEq24.gif"/></alternatives></inline-formula> (here <inline-formula id="IEq25"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\delta _{kl}$$\end{document}</tex-math><mml:math id="M52"><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mi mathvariant="italic">kl</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41598_2021_2265_Article_IEq25.gif"/></alternatives></inline-formula> is the Kronecker symbol), with ordered eigenvalues <inline-formula id="IEq26"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda _{1}\ge \lambda _{2}\ge \ldots \ge 0$$\end{document}</tex-math><mml:math id="M54"><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>≥</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>≥</mml:mo><mml:mo>…</mml:mo><mml:mo>≥</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="41598_2021_2265_Article_IEq26.gif"/></alternatives></inline-formula>.</p>
      <p id="Par12">The functional principal component expansion decomposes the random functions <inline-formula id="IEq27"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\{f_i(t)\}$$\end{document}</tex-math><mml:math id="M56"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41598_2021_2265_Article_IEq27.gif"/></alternatives></inline-formula> as<sup><xref ref-type="bibr" rid="CR31">31</xref>,<xref ref-type="bibr" rid="CR32">32</xref></sup><disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} f_{i}(t)=\mu (t)+\sum _{l=1}^{\infty }\zeta _{il}v_{l}(t), \end{aligned}$$\end{document}</tex-math><mml:math id="M58" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>μ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>∞</mml:mi></mml:munderover><mml:msub><mml:mi>ζ</mml:mi><mml:mrow><mml:mi mathvariant="italic">il</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>v</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="41598_2021_2265_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula>where the sum is defined in the sense of <inline-formula id="IEq28"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L^2$$\end{document}</tex-math><mml:math id="M60"><mml:msup><mml:mi>L</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="41598_2021_2265_Article_IEq28.gif"/></alternatives></inline-formula> convergence and <inline-formula id="IEq29"><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\zeta _{il}=\int _0^1 (f_{i}(t)-\mu (t))v_{l}(t)dt$$\end{document}</tex-math><mml:math id="M62"><mml:mrow><mml:msub><mml:mi>ζ</mml:mi><mml:mrow><mml:mi mathvariant="italic">il</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mo>∫</mml:mo><mml:mn>0</mml:mn><mml:mn>1</mml:mn></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:mi>μ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="41598_2021_2265_Article_IEq29.gif"/></alternatives></inline-formula> are uncorrelated random variables with <inline-formula id="IEq30"><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$E(\zeta _{l})=0$$\end{document}</tex-math><mml:math id="M64"><mml:mrow><mml:mi>E</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>ζ</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="41598_2021_2265_Article_IEq30.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq31"><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$var(\zeta _{l})=\lambda _{l}$$\end{document}</tex-math><mml:math id="M66"><mml:mrow><mml:mi>v</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>ζ</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mi>l</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="41598_2021_2265_Article_IEq31.gif"/></alternatives></inline-formula>. Here, <inline-formula id="IEq32"><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\zeta _{l}$$\end{document}</tex-math><mml:math id="M68"><mml:msub><mml:mi>ζ</mml:mi><mml:mi>l</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="41598_2021_2265_Article_IEq32.gif"/></alternatives></inline-formula> is frequently referred to as the <inline-formula id="IEq33"><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$l\text{{th}}$$\end{document}</tex-math><mml:math id="M70"><mml:mrow><mml:mi>l</mml:mi><mml:mtext>th</mml:mtext></mml:mrow></mml:math><inline-graphic xlink:href="41598_2021_2265_Article_IEq33.gif"/></alternatives></inline-formula> functional principal component score (PC). The curve response can be estimated as<sup><xref ref-type="bibr" rid="CR17">17</xref>,<xref ref-type="bibr" rid="CR33">33</xref>,<xref ref-type="bibr" rid="CR34">34</xref></sup><disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} {\tilde{f}}_i(t)={\hat{\mu }}(t)+\sum _{l=1}^{L}{\hat{\zeta }}_{il}{\hat{v}}_{l}(t), \,i=1,\ldots ,n; \,t \in [0,1]. \end{aligned}$$\end{document}</tex-math><mml:math id="M72" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mover accent="true"><mml:mi>μ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>L</mml:mi></mml:munderover><mml:msub><mml:mover accent="true"><mml:mi>ζ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mi mathvariant="italic">il</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mover accent="true"><mml:mi>v</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>l</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mo>;</mml:mo><mml:mspace width="0.166667em"/><mml:mi>t</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="41598_2021_2265_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par13">Here, <inline-formula id="IEq34"><alternatives><tex-math id="M73">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\hat{\mu }}(t)$$\end{document}</tex-math><mml:math id="M74"><mml:mrow><mml:mover accent="true"><mml:mi>μ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="41598_2021_2265_Article_IEq34.gif"/></alternatives></inline-formula> is the estimated overall mean function and <inline-formula id="IEq35"><alternatives><tex-math id="M75">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\hat{v}}_{l}(t)$$\end{document}</tex-math><mml:math id="M76"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>v</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>l</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="41598_2021_2265_Article_IEq35.gif"/></alternatives></inline-formula> and <inline-formula id="IEq36"><alternatives><tex-math id="M77">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\hat{\zeta }}_{il}$$\end{document}</tex-math><mml:math id="M78"><mml:msub><mml:mover accent="true"><mml:mi>ζ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mi mathvariant="italic">il</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41598_2021_2265_Article_IEq36.gif"/></alternatives></inline-formula> are the estimated eigenfunctions and estimated functional PCs of the estimated auto-covariance function <inline-formula id="IEq37"><alternatives><tex-math id="M79">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\hat{G}}(t',t)$$\end{document}</tex-math><mml:math id="M80"><mml:mrow><mml:mover accent="true"><mml:mi>G</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="41598_2021_2265_Article_IEq37.gif"/></alternatives></inline-formula>, respectively. <italic>L</italic> is the number of PCs to be retained, which is pre-specified according to the proportion of total variation of the curve response explained by the first few PCs. The <inline-formula id="IEq38"><alternatives><tex-math id="M81">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\tilde{f}}_i(t)$$\end{document}</tex-math><mml:math id="M82"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="41598_2021_2265_Article_IEq38.gif"/></alternatives></inline-formula> obtained from Eq. (<xref rid="Equ3" ref-type="">3</xref>) is an estimate of the random function <inline-formula id="IEq39"><alternatives><tex-math id="M83">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$f_i(t)$$\end{document}</tex-math><mml:math id="M84"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="41598_2021_2265_Article_IEq39.gif"/></alternatives></inline-formula>.</p>
    </sec>
    <sec id="Sec4">
      <title>Smoothing and estimating</title>
      <p id="Par14">Since the real data are contaminated with measurement errors, the sample mean vector <inline-formula id="IEq40"><alternatives><tex-math id="M85">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\bar{{\varvec{Y}}}$$\end{document}</tex-math><mml:math id="M86"><mml:mover accent="true"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">Y</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mrow></mml:mover></mml:math><inline-graphic xlink:href="41598_2021_2265_Article_IEq40.gif"/></alternatives></inline-formula> and eigenvectors of the sample covariance matrix <inline-formula id="IEq41"><alternatives><tex-math id="M87">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\bar{{\varvec{G}}}$$\end{document}</tex-math><mml:math id="M88"><mml:mover accent="true"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">G</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mrow></mml:mover></mml:math><inline-graphic xlink:href="41598_2021_2265_Article_IEq41.gif"/></alternatives></inline-formula> (a <inline-formula id="IEq42"><alternatives><tex-math id="M89">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$K\times K$$\end{document}</tex-math><mml:math id="M90"><mml:mrow><mml:mi>K</mml:mi><mml:mo>×</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="41598_2021_2265_Article_IEq42.gif"/></alternatives></inline-formula> matrix) of the raw data tend to be noisy, affecting the accuracy of the results. Therefore, we need to perform smoothing processes to obtain the estimates <inline-formula id="IEq43"><alternatives><tex-math id="M91">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\hat{\mu }}(t)$$\end{document}</tex-math><mml:math id="M92"><mml:mrow><mml:mover accent="true"><mml:mi>μ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="41598_2021_2265_Article_IEq43.gif"/></alternatives></inline-formula> and <inline-formula id="IEq44"><alternatives><tex-math id="M93">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\hat{G}}(t',t)$$\end{document}</tex-math><mml:math id="M94"><mml:mrow><mml:mover accent="true"><mml:mi>G</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="41598_2021_2265_Article_IEq44.gif"/></alternatives></inline-formula>, all of which are contained in Eq. (<xref rid="Equ3" ref-type="">3</xref>). Specifically, we applied the univariate P-spline smoother approach to get an estimate of the mean function <inline-formula id="IEq45"><alternatives><tex-math id="M95">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\hat{\mu }}(t)$$\end{document}</tex-math><mml:math id="M96"><mml:mrow><mml:mover accent="true"><mml:mi>μ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="41598_2021_2265_Article_IEq45.gif"/></alternatives></inline-formula>. To obtain an estimate of the covariance function, <inline-formula id="IEq46"><alternatives><tex-math id="M97">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\hat{G}}(t',t)$$\end{document}</tex-math><mml:math id="M98"><mml:mrow><mml:mover accent="true"><mml:mi>G</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="41598_2021_2265_Article_IEq46.gif"/></alternatives></inline-formula>, we applied the sandwich smoother and the fast covariance estimation (FACE) algorithm<sup><xref ref-type="bibr" rid="CR35">35</xref>,<xref ref-type="bibr" rid="CR36">36</xref></sup>. The sandwich smoother is a bivariate smoothing approach that employs a tensor product structure to simplify asymptotic analysis and speed up computation. It applies univariate P-spline smoothers simultaneously to both the row and column coordinates of the sample covariance matrix. Situations where <inline-formula id="IEq47"><alternatives><tex-math id="M99">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$K&gt;500$$\end{document}</tex-math><mml:math id="M100"><mml:mrow><mml:mi>K</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>500</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="41598_2021_2265_Article_IEq47.gif"/></alternatives></inline-formula> raise challenges for covariance matrix smoothing in terms of vast computational and storage burdens for high-dimensional matrices. Therefore, FACE, a fast implementation of the sandwich smoother<sup><xref ref-type="bibr" rid="CR36">36</xref></sup>, was developed for high-dimensional covariance function smoothing used in functional data analysis.</p>
    </sec>
    <sec id="Sec5">
      <title>Functional regression tree</title>
      <p id="Par15">In this step, we input the estimated smooth function <inline-formula id="IEq48"><alternatives><tex-math id="M101">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\tilde{f}}_i(t)$$\end{document}</tex-math><mml:math id="M102"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="41598_2021_2265_Article_IEq48.gif"/></alternatives></inline-formula> obtained from Eq. (<xref rid="Equ3" ref-type="">3</xref>) described in <xref rid="Sec3" ref-type="sec">“Functional principal component analysis</xref>” and “<xref rid="Sec4" ref-type="sec">Smoothing and estimating</xref>” sections into the functional regression tree. A functional regression tree is constructed by successively splitting the predictor space into mutually exclusive subregions and then repeatedly partitioning observations into those subregions<sup><xref ref-type="bibr" rid="CR37">37</xref></sup>. Let <italic>s</italic> denote a possible split-point value of a given predictor, <inline-formula id="IEq49"><alternatives><tex-math id="M103">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$X_j$$\end{document}</tex-math><mml:math id="M104"><mml:msub><mml:mi>X</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="41598_2021_2265_Article_IEq49.gif"/></alternatives></inline-formula>. Let <italic>R</italic> denote a parent node under consideration. For each <italic>j</italic> and each <italic>s</italic> combination, a pair of left and right descendent child nodes are defined as, <inline-formula id="IEq50"><alternatives><tex-math id="M105">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R_L(j,s)=\{({\varvec{X}}_i, {\tilde{f}}_i(t))|X_{ij}&lt;s\} \,\,\text {and} \,\,R_R(j,s)=\{({\varvec{X}}_i, {\tilde{f}}_i(t))|X_{ij}\ge s\}.$$\end{document}</tex-math><mml:math id="M106"><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow><mml:mspace width="0.166667em"/><mml:mspace width="0.166667em"/><mml:mtext>and</mml:mtext><mml:mspace width="0.166667em"/><mml:mspace width="0.166667em"/><mml:msub><mml:mi>R</mml:mi><mml:mi>R</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>≥</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41598_2021_2265_Article_IEq50.gif"/></alternatives></inline-formula></p>
      <p id="Par16">Inspired by the univariate splitting criterion, we designed a new splitting function for a curve response. We first define the average function of all smooth functions that are divided into the node <italic>R</italic> as <inline-formula id="IEq51"><alternatives><tex-math id="M107">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\hat{f}}_R(t) = \sum _{i \in R} {\tilde{f}}_i(t)/n_R$$\end{document}</tex-math><mml:math id="M108"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>R</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">/</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>R</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="41598_2021_2265_Article_IEq51.gif"/></alternatives></inline-formula>. Here, <inline-formula id="IEq52"><alternatives><tex-math id="M109">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n_R$$\end{document}</tex-math><mml:math id="M110"><mml:msub><mml:mi>n</mml:mi><mml:mi>R</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="41598_2021_2265_Article_IEq52.gif"/></alternatives></inline-formula> is the number of observations divided into the node <italic>R</italic>. Accordingly, the new residual sum of squares (RSS), defined for the functional curve at a node <italic>R</italic>, will be computed based on the integrated squared error (ISE)<sup><xref ref-type="bibr" rid="CR38">38</xref></sup><disp-formula id="Equ4"><label>4</label><alternatives><tex-math id="M111">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} RSS_f(R) = \sum _{i \in R} \int _{0}^{1} [{\tilde{f}}_i(t) - {\hat{f}}_R(t)]^2 dt. \end{aligned}$$\end{document}</tex-math><mml:math id="M112" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>R</mml:mi><mml:mi>S</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mi>f</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>R</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mi>R</mml:mi></mml:mrow></mml:munder><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mn>1</mml:mn></mml:msubsup><mml:msup><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>R</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mi>d</mml:mi><mml:mi>t</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="41598_2021_2265_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula>The new splitting criteria, measuring the between-node separation, can be defined as<disp-formula id="Equ5"><label>5</label><alternatives><tex-math id="M113">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \phi (j,s,R) = \int _{0}^{1} [{\hat{f}}_{R_L(j,s)}(t)-{\hat{f}}_{R_R(j,s)}(t)]^2 dt. \end{aligned}$$\end{document}</tex-math><mml:math id="M114" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>ϕ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>R</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mn>1</mml:mn></mml:msubsup><mml:msup><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mi>R</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mi>d</mml:mi><mml:mi>t</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="41598_2021_2265_Article_Equ5.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par17">A fixed number of split-points are scanned for each predictor under consideration, and the top split-point (the one that maximizes <inline-formula id="IEq53"><alternatives><tex-math id="M115">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\phi (j,s, R)$$\end{document}</tex-math><mml:math id="M116"><mml:mrow><mml:mi>ϕ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>R</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41598_2021_2265_Article_IEq53.gif"/></alternatives></inline-formula>) is ultimately chosen to produce a split. Specifically, we scan all possible combinations of split-points for each categorical predictor and scan ten equally spaced split-points for each continuous predictor.</p>
      <p id="Par18">During the tree-growing process, the estimated curve response <inline-formula id="IEq54"><alternatives><tex-math id="M117">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\tilde{f}}_i(t)$$\end{document}</tex-math><mml:math id="M118"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="41598_2021_2265_Article_IEq54.gif"/></alternatives></inline-formula> in Eq. (<xref rid="Equ3" ref-type="">3</xref>) for each observation will keep updating at each candidate split of each node. This is because a split causes a regrouping, so the observation pool (and also the mean and covariance functions) in the parent node differs from those of its descendant nodes. When a tree grows deeper, the homogeneity of the curve response in each leaf node will increase. A fully-grown functional regression tree may be too complex, likely overfitting the data and leading to poor prediction accuracy. We first grow the tree to the maximum depth and record the sequence of splits. We then prune the tree back in reverse order<sup><xref ref-type="bibr" rid="CR37">37</xref></sup>. When a tree is pruned, we calculate the average integrated squared error of the corresponding subtree through fivefold cross-validation. Finally, we determine the optimal functional regression tree by using the subtree with the lowest prediction ISE.</p>
    </sec>
    <sec id="Sec6">
      <title>Randomness</title>
      <p id="Par19">Similar to the traditional RF approach, the FunFor approach introduces two instances of randomness and also grows an ensemble of functional regression trees to yield a consensus vote. First, instead of using all original observations, the data used to grow each tree is from one bootstrap sample of the original observations. Aggregating predictions over hundreds of trees can significantly reduce variance and increase both prediction accuracy and stability, when compared to a single tree. Secondly, the method gains additional prediction accuracy by randomly drawing only a subset of predictors to determine the best split for each parent node of each tree; hence the predictors which have strong main effects or strong correlations do not always dominate. In addition, when the number of predictors is very large, the consideration of only a randomly-selected subset of variables for each split greatly improves computational efficiency. In the end, we predict the curve response of the <inline-formula id="IEq55"><alternatives><tex-math id="M119">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i\text{{{th}}}$$\end{document}</tex-math><mml:math id="M120"><mml:mrow><mml:mi>i</mml:mi><mml:mtext>th</mml:mtext></mml:mrow></mml:math><inline-graphic xlink:href="41598_2021_2265_Article_IEq55.gif"/></alternatives></inline-formula> observation as <inline-formula id="IEq56"><alternatives><tex-math id="M121">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\hat{f}}_i(t)=\bar{{\hat{f}}}_R(t)$$\end{document}</tex-math><mml:math id="M122"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mover accent="true"><mml:mrow><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mrow></mml:mover><mml:mi>R</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="41598_2021_2265_Article_IEq56.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq57"><alternatives><tex-math id="M123">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\bar{{\hat{f}}}_R(t)$$\end{document}</tex-math><mml:math id="M124"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mrow><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mrow></mml:mover><mml:mi>R</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="41598_2021_2265_Article_IEq57.gif"/></alternatives></inline-formula> is the average of <inline-formula id="IEq58"><alternatives><tex-math id="M125">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\hat{f}}_R(t)$$\end{document}</tex-math><mml:math id="M126"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>R</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="41598_2021_2265_Article_IEq58.gif"/></alternatives></inline-formula> predicted at the leaf nodes across multiple trees that contain the <inline-formula id="IEq59"><alternatives><tex-math id="M127">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i\text{{{th}}}$$\end{document}</tex-math><mml:math id="M128"><mml:mrow><mml:mi>i</mml:mi><mml:mtext>th</mml:mtext></mml:mrow></mml:math><inline-graphic xlink:href="41598_2021_2265_Article_IEq59.gif"/></alternatives></inline-formula> observation through bootstrap sampling.</p>
    </sec>
    <sec id="Sec7">
      <title>Permutation variable importance measure</title>
      <p id="Par20">The output of the FunFor is the predicted curve response for each observation, <inline-formula id="IEq60"><alternatives><tex-math id="M129">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\hat{f}}_i(t)$$\end{document}</tex-math><mml:math id="M130"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="41598_2021_2265_Article_IEq60.gif"/></alternatives></inline-formula>, along with the permutation variable importance measure (PVIM) for each predictor based on its association strength with the curve response. The PVIM of each predictor <inline-formula id="IEq61"><alternatives><tex-math id="M131">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$X_j$$\end{document}</tex-math><mml:math id="M132"><mml:msub><mml:mi>X</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="41598_2021_2265_Article_IEq61.gif"/></alternatives></inline-formula> is obtained via the difference in average prediction error before and after randomly permuting <inline-formula id="IEq62"><alternatives><tex-math id="M133">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$X_j$$\end{document}</tex-math><mml:math id="M134"><mml:msub><mml:mi>X</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="41598_2021_2265_Article_IEq62.gif"/></alternatives></inline-formula> while keeping other predictors untouched<sup><xref ref-type="bibr" rid="CR39">39</xref></sup>. Let <inline-formula id="IEq63"><alternatives><tex-math id="M135">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$B_q$$\end{document}</tex-math><mml:math id="M136"><mml:msub><mml:mi>B</mml:mi><mml:mi>q</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="41598_2021_2265_Article_IEq63.gif"/></alternatives></inline-formula> denote the set of out of bag (OOB) samples of the <inline-formula id="IEq64"><alternatives><tex-math id="M137">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$q\text{{{th}}}$$\end{document}</tex-math><mml:math id="M138"><mml:mrow><mml:mi>q</mml:mi><mml:mtext>th</mml:mtext></mml:mrow></mml:math><inline-graphic xlink:href="41598_2021_2265_Article_IEq64.gif"/></alternatives></inline-formula> tree and ‘ntree’ denote the total number of trees, then the PVIM of predictor <inline-formula id="IEq65"><alternatives><tex-math id="M139">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$X_j$$\end{document}</tex-math><mml:math id="M140"><mml:msub><mml:mi>X</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="41598_2021_2265_Article_IEq65.gif"/></alternatives></inline-formula> is defined as<disp-formula id="Equ6"><label>6</label><alternatives><tex-math id="M141">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} PVIM(X_j)= \frac{1}{ntree}\Bigg (\sum _{q=1}^{ntree} \frac{1}{|B_q|} \sum _{i\in B_q} \left[\int _{0}^{1} [{\tilde{f}}_i(t) - {\hat{f}}_i^p(t)]^2 dt - \int _{0}^{1} [{\tilde{f}}_i(t) - {\hat{f}}_i(t)]^2 dt \right]\Bigg ), \end{aligned}$$\end{document}</tex-math><mml:math id="M142" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>P</mml:mi><mml:mi>V</mml:mi><mml:mi>I</mml:mi><mml:mi>M</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi mathvariant="italic">ntree</mml:mi></mml:mrow></mml:mfrac><mml:mrow><mml:mo maxsize="2.470em" minsize="2.470em" stretchy="true">(</mml:mo></mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>q</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ntree</mml:mi></mml:mrow></mml:munderover><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>B</mml:mi><mml:mi>q</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mi>q</mml:mi></mml:msub></mml:mrow></mml:munder><mml:mfenced close="]" open="["><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mn>1</mml:mn></mml:msubsup><mml:msup><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>i</mml:mi><mml:mi>p</mml:mi></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mi>d</mml:mi><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mn>1</mml:mn></mml:msubsup><mml:msup><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mfenced><mml:mrow><mml:mo maxsize="2.470em" minsize="2.470em" stretchy="true">)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="41598_2021_2265_Article_Equ6.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq66"><alternatives><tex-math id="M143">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\hat{f}}_i(t)$$\end{document}</tex-math><mml:math id="M144"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="41598_2021_2265_Article_IEq66.gif"/></alternatives></inline-formula> is still the predicted curve response obtained from the FunFor approach without permuting <inline-formula id="IEq67"><alternatives><tex-math id="M145">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$X_j$$\end{document}</tex-math><mml:math id="M146"><mml:msub><mml:mi>X</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="41598_2021_2265_Article_IEq67.gif"/></alternatives></inline-formula>, <inline-formula id="IEq68"><alternatives><tex-math id="M147">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\hat{f}}_i^p(t)$$\end{document}</tex-math><mml:math id="M148"><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>i</mml:mi><mml:mi>p</mml:mi></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="41598_2021_2265_Article_IEq68.gif"/></alternatives></inline-formula> is the predicted curve response after permuting <inline-formula id="IEq69"><alternatives><tex-math id="M149">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$X_j$$\end{document}</tex-math><mml:math id="M150"><mml:msub><mml:mi>X</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="41598_2021_2265_Article_IEq69.gif"/></alternatives></inline-formula> and <inline-formula id="IEq70"><alternatives><tex-math id="M151">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$|B_q|$$\end{document}</tex-math><mml:math id="M152"><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>B</mml:mi><mml:mi>q</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="41598_2021_2265_Article_IEq70.gif"/></alternatives></inline-formula> denotes the size of the set. The larger a PVIM is, the more important the corresponding predictor is in predicting the curve response. A predictor with a negative or close-to-zero PVIM value is interpreted as unimportant<sup><xref ref-type="bibr" rid="CR39">39</xref></sup>. The PVIM assesses each predictor’s impact without isolating all other predictors nor requiring interactive terms to be explicitly added into the model.</p>
    </sec>
    <sec id="Sec8">
      <title>Tuning parameters</title>
      <p id="Par21">There are two tuning parameters involved in the FunFor approach. The first tuning parameter is the size of the subset of the predictors that are considered at each split, designated ‘mtry’. For a univariate response, it has been suggested that ‘mtry’ should be approximately one third of the total number of predictors<sup><xref ref-type="bibr" rid="CR40">40</xref></sup>. We use a ‘mtry’ value of 40% (close to <italic>p</italic>/3) and it works well for all of the eight simulation settings and the real data analysis. Another tuning parameter is the value of <italic>L</italic> described in Eq. (<xref rid="Equ3" ref-type="">3</xref>). We adopt two options to determine the value of <italic>L</italic>. Option 1: We apply the most standard rule in the functional data analysis literature and use all of the observations at the root node. Then we fix this value of <italic>L</italic> at all splits during the tree growth process. As claimed by Di et al.<sup><xref ref-type="bibr" rid="CR41">41</xref></sup>, this rule simultaneously satisfies two criteria: the proportion of total variation explained by the first <italic>L</italic> principal components is larger than a predetermined threshold (e.g., 90%) and the proportion of variation explained by any additional principal component is less than another predetermined threshold (e.g., 1%). This rule works well in their simulation studies and practical analyses as demonstrated by Di et al.<sup><xref ref-type="bibr" rid="CR41">41</xref></sup>. Option 2: Specify the minimum percentage of total variation explained by the data (e.g., 90%). We then adaptively and flexibly determine and update the value of <italic>L</italic> at each split according to different observations obtained at each child node.</p>
    </sec>
  </sec>
  <sec id="Sec9">
    <title>Simulation studies</title>
    <p id="Par22">We experiment with eight simulation settings to explore the performance of the FunFor approach in detecting the true predictors under various levels of difficulty. Each simulation design is performed with 100 replications. The details of Simulation Examples 1–5 are elaborated in the following subsections, and Simulation Examples 6–8 can be found in the Supplementary <xref rid="MOESM1" ref-type="media">Appendix</xref>. The tuning parameters are set as <inline-formula id="IEq71"><alternatives><tex-math id="M153">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L=3, mtry = 0.4 p$$\end{document}</tex-math><mml:math id="M154"><mml:mrow><mml:mi>L</mml:mi><mml:mo>=</mml:mo><mml:mn>3</mml:mn><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>y</mml:mi><mml:mo>=</mml:mo><mml:mn>0.4</mml:mn><mml:mi>p</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="41598_2021_2265_Article_IEq71.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq72"><alternatives><tex-math id="M155">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ntree = 100$$\end{document}</tex-math><mml:math id="M156"><mml:mrow><mml:mi>n</mml:mi><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>e</mml:mi><mml:mo>=</mml:mo><mml:mn>100</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="41598_2021_2265_Article_IEq72.gif"/></alternatives></inline-formula> when applying the FunFor approach to fit each of the eight simulation examples. The FunFor approach is compared with three other relevant approaches. We choose their default settings for the tuning parameters when applying the ‘refund’ and ‘splinetree’ packages and divide the <italic>K</italic> time points into 10 regions when implementing the FRF Matlab code provided in the github. Three criteria are used to assess not only the variable selection but also the prediction accuracy of the four approaches under comparison. <list list-type="order"><list-item><p id="Par23"><italic>M</italic> is defined as the minimum selection size that is required to detect all of the true predictors in each replication. We calculate multiple quantiles and also the average of <italic>M</italic> across the 100 replications. The closer the different quantiles are to the total number of true predictors, the robuster the approach is in variable selection.</p></list-item><list-item><p id="Par24"><italic>Rk</italic> is defined as the average rank of each true predictor across 100 replications. The smaller the <italic>Rk</italic> and the average <italic>M</italic> values are, the more effective the approach is in variable selection.</p></list-item><list-item><p id="Par25">MAE is defined as the mean absolute error<sup><xref ref-type="bibr" rid="CR42">42</xref></sup>, which is the same rule used to assess the prediction performance as Rahman et al. did<sup><xref ref-type="bibr" rid="CR3">3</xref></sup>. The smaller the MAE is, the more accurately the approach predicts.</p></list-item></list></p>
    <sec id="Sec10">
      <title>Simulation Example 1: a single-true-predictor design</title>
      <p id="Par26">In this design, we consider a scenario in which only one true predictor is associated with the response and mimic the motivated real dataset, i.e., the gene-shape association. Please see the Supplementary <xref rid="MOESM1" ref-type="media">Appendix</xref> for three extra simulation examples that also mimic the real dataset but with increasing difficulty levels. The genetic marker data is coded as 0 for aa, 1 for Aa, and 2 for AA. As a categorical variable, each genetic marker is generated using a binomial distribution with a random minor allele frequency (<inline-formula id="IEq73"><alternatives><tex-math id="M157">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text {MAF} \sim \text {Uniform}(0.1, 0.5)$$\end{document}</tex-math><mml:math id="M158"><mml:mrow><mml:mtext>MAF</mml:mtext><mml:mo>∼</mml:mo><mml:mtext>Uniform</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mn>0.1</mml:mn><mml:mo>,</mml:mo><mml:mn>0.5</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41598_2021_2265_Article_IEq73.gif"/></alternatives></inline-formula>). Among all generated genetic markers, we randomly choose one marker to truly connect with the response (call it <inline-formula id="IEq74"><alternatives><tex-math id="M159">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$X_1^*$$\end{document}</tex-math><mml:math id="M160"><mml:msubsup><mml:mi>X</mml:mi><mml:mn>1</mml:mn><mml:mo>∗</mml:mo></mml:msubsup></mml:math><inline-graphic xlink:href="41598_2021_2265_Article_IEq74.gif"/></alternatives></inline-formula>) and set all the rest to be noise. We set three 360-dimensional curves as the mean responses, <inline-formula id="IEq75"><alternatives><tex-math id="M161">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{\mu _{1}}$$\end{document}</tex-math><mml:math id="M162"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mn mathvariant="bold">1</mml:mn></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="41598_2021_2265_Article_IEq75.gif"/></alternatives></inline-formula>, <inline-formula id="IEq76"><alternatives><tex-math id="M163">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{\mu _{2}}$$\end{document}</tex-math><mml:math id="M164"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mn mathvariant="bold">2</mml:mn></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="41598_2021_2265_Article_IEq76.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq77"><alternatives><tex-math id="M165">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{\mu _{3}}$$\end{document}</tex-math><mml:math id="M166"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mn mathvariant="bold">3</mml:mn></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="41598_2021_2265_Article_IEq77.gif"/></alternatives></inline-formula>, under each of the three genotype categories of the true genetic marker. These three mean curves are used to describe three true poplar leaves with varying shapes. See Fu et al. for the shape analysis details used to transform an image to a curve<sup><xref ref-type="bibr" rid="CR43">43</xref></sup>.</p>
      <p id="Par27">Then the shape curve samples for each replication are generated based on the genotype of this true genetic marker and the three true leaf shape curves as<disp-formula id="Equ7"><label>7</label><alternatives><tex-math id="M167">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} {\varvec{Y}}^T_i= [\varvec{\mu _{1}}^T, \varvec{\mu _{2}}^T, \varvec{\mu _{3}}^T]\cdot I_{X_1^*} + \varepsilon _{360 \times 1}, \,\,i=1,\ldots ,100, \end{aligned}$$\end{document}</tex-math><mml:math id="M168" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">Y</mml:mi></mml:mrow></mml:mrow><mml:mi>i</mml:mi><mml:mi>T</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msup><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mn mathvariant="bold">1</mml:mn></mml:msub></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mn mathvariant="bold">2</mml:mn></mml:msub></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mn mathvariant="bold">3</mml:mn></mml:msub></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>·</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:msubsup><mml:mi>X</mml:mi><mml:mn>1</mml:mn><mml:mo>∗</mml:mo></mml:msubsup></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>ε</mml:mi><mml:mrow><mml:mn>360</mml:mn><mml:mo>×</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:mspace width="0.166667em"/><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mn>100</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="41598_2021_2265_Article_Equ7.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq78"><alternatives><tex-math id="M169">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varepsilon _{360 \times 1} \sim {\mathcal {N}}({\varvec{0}}_{360 \times 1}, \Sigma _{360\times 360})$$\end{document}</tex-math><mml:math id="M170"><mml:mrow><mml:msub><mml:mi>ε</mml:mi><mml:mrow><mml:mn>360</mml:mn><mml:mo>×</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mi mathvariant="script">N</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mn mathvariant="bold">0</mml:mn></mml:mrow><mml:mrow><mml:mn>360</mml:mn><mml:mo>×</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="normal">Σ</mml:mi><mml:mrow><mml:mn>360</mml:mn><mml:mo>×</mml:mo><mml:mn>360</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="41598_2021_2265_Article_IEq78.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq79"><alternatives><tex-math id="M171">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Sigma _{360\times 360}$$\end{document}</tex-math><mml:math id="M172"><mml:msub><mml:mi mathvariant="normal">Σ</mml:mi><mml:mrow><mml:mn>360</mml:mn><mml:mo>×</mml:mo><mml:mn>360</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41598_2021_2265_Article_IEq79.gif"/></alternatives></inline-formula> is the empirical sample covariance matrix of the three true leaf shapes. Here, <inline-formula id="IEq80"><alternatives><tex-math id="M173">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I_{X_1^*}$$\end{document}</tex-math><mml:math id="M174"><mml:msub><mml:mi>I</mml:mi><mml:msubsup><mml:mi>X</mml:mi><mml:mn>1</mml:mn><mml:mo>∗</mml:mo></mml:msubsup></mml:msub></mml:math><inline-graphic xlink:href="41598_2021_2265_Article_IEq80.gif"/></alternatives></inline-formula> is an indicator function that is defined as</p>
      <p id="Par28">
        <inline-formula id="IEq81">
          <alternatives>
            <tex-math id="M175">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I_{X_1^*} = {\left\{ \begin{array}{ll} (1,0,0)^T, &amp;{} \text{ if } \text{ the } \text{ genotype } \text{ of } X_1^* \text{ is } \text{ AA, } \\ (0,1,0)^T, &amp;{} \text{ if } \text{ the } \text{ genotype } \text{ of } X_1^* \text{ is } \text{ Aa, } \\ (0,0,1)^T, &amp;{} \text{ if } \text{ the } \text{ genotype } \text{ of } X_1^* \text{ is } \text{ aa. } \end{array}\right. }$$\end{document}</tex-math>
            <mml:math id="M176">
              <mml:mrow>
                <mml:msub>
                  <mml:mi>I</mml:mi>
                  <mml:msubsup>
                    <mml:mi>X</mml:mi>
                    <mml:mn>1</mml:mn>
                    <mml:mo>∗</mml:mo>
                  </mml:msubsup>
                </mml:msub>
                <mml:mo>=</mml:mo>
                <mml:mfenced open="{">
                  <mml:mrow>
                    <mml:mtable>
                      <mml:mtr>
                        <mml:mtd columnalign="left">
                          <mml:mrow>
                            <mml:msup>
                              <mml:mrow>
                                <mml:mo stretchy="false">(</mml:mo>
                                <mml:mn>1</mml:mn>
                                <mml:mo>,</mml:mo>
                                <mml:mn>0</mml:mn>
                                <mml:mo>,</mml:mo>
                                <mml:mn>0</mml:mn>
                                <mml:mo stretchy="false">)</mml:mo>
                              </mml:mrow>
                              <mml:mi>T</mml:mi>
                            </mml:msup>
                            <mml:mo>,</mml:mo>
                          </mml:mrow>
                        </mml:mtd>
                        <mml:mtd columnalign="left">
                          <mml:mrow>
                            <mml:mrow/>
                            <mml:mspace width="0.333333em"/>
                            <mml:mtext>if</mml:mtext>
                            <mml:mspace width="0.333333em"/>
                            <mml:mspace width="0.333333em"/>
                            <mml:mtext>the</mml:mtext>
                            <mml:mspace width="0.333333em"/>
                            <mml:mspace width="0.333333em"/>
                            <mml:mtext>genotype</mml:mtext>
                            <mml:mspace width="0.333333em"/>
                            <mml:mspace width="0.333333em"/>
                            <mml:mtext>of</mml:mtext>
                            <mml:mspace width="0.333333em"/>
                            <mml:msubsup>
                              <mml:mi>X</mml:mi>
                              <mml:mn>1</mml:mn>
                              <mml:mo>∗</mml:mo>
                            </mml:msubsup>
                            <mml:mspace width="0.333333em"/>
                            <mml:mtext>is</mml:mtext>
                            <mml:mspace width="0.333333em"/>
                            <mml:mspace width="0.333333em"/>
                            <mml:mtext>AA,</mml:mtext>
                            <mml:mspace width="0.333333em"/>
                          </mml:mrow>
                        </mml:mtd>
                      </mml:mtr>
                      <mml:mtr>
                        <mml:mtd columnalign="left">
                          <mml:mrow>
                            <mml:mrow/>
                            <mml:msup>
                              <mml:mrow>
                                <mml:mo stretchy="false">(</mml:mo>
                                <mml:mn>0</mml:mn>
                                <mml:mo>,</mml:mo>
                                <mml:mn>1</mml:mn>
                                <mml:mo>,</mml:mo>
                                <mml:mn>0</mml:mn>
                                <mml:mo stretchy="false">)</mml:mo>
                              </mml:mrow>
                              <mml:mi>T</mml:mi>
                            </mml:msup>
                            <mml:mo>,</mml:mo>
                          </mml:mrow>
                        </mml:mtd>
                        <mml:mtd columnalign="left">
                          <mml:mrow>
                            <mml:mrow/>
                            <mml:mspace width="0.333333em"/>
                            <mml:mtext>if</mml:mtext>
                            <mml:mspace width="0.333333em"/>
                            <mml:mspace width="0.333333em"/>
                            <mml:mtext>the</mml:mtext>
                            <mml:mspace width="0.333333em"/>
                            <mml:mspace width="0.333333em"/>
                            <mml:mtext>genotype</mml:mtext>
                            <mml:mspace width="0.333333em"/>
                            <mml:mspace width="0.333333em"/>
                            <mml:mtext>of</mml:mtext>
                            <mml:mspace width="0.333333em"/>
                            <mml:msubsup>
                              <mml:mi>X</mml:mi>
                              <mml:mn>1</mml:mn>
                              <mml:mo>∗</mml:mo>
                            </mml:msubsup>
                            <mml:mspace width="0.333333em"/>
                            <mml:mtext>is</mml:mtext>
                            <mml:mspace width="0.333333em"/>
                            <mml:mspace width="0.333333em"/>
                            <mml:mtext>Aa,</mml:mtext>
                            <mml:mspace width="0.333333em"/>
                          </mml:mrow>
                        </mml:mtd>
                      </mml:mtr>
                      <mml:mtr>
                        <mml:mtd columnalign="left">
                          <mml:mrow>
                            <mml:mrow/>
                            <mml:msup>
                              <mml:mrow>
                                <mml:mo stretchy="false">(</mml:mo>
                                <mml:mn>0</mml:mn>
                                <mml:mo>,</mml:mo>
                                <mml:mn>0</mml:mn>
                                <mml:mo>,</mml:mo>
                                <mml:mn>1</mml:mn>
                                <mml:mo stretchy="false">)</mml:mo>
                              </mml:mrow>
                              <mml:mi>T</mml:mi>
                            </mml:msup>
                            <mml:mo>,</mml:mo>
                          </mml:mrow>
                        </mml:mtd>
                        <mml:mtd columnalign="left">
                          <mml:mrow>
                            <mml:mrow/>
                            <mml:mspace width="0.333333em"/>
                            <mml:mtext>if</mml:mtext>
                            <mml:mspace width="0.333333em"/>
                            <mml:mspace width="0.333333em"/>
                            <mml:mtext>the</mml:mtext>
                            <mml:mspace width="0.333333em"/>
                            <mml:mspace width="0.333333em"/>
                            <mml:mtext>genotype</mml:mtext>
                            <mml:mspace width="0.333333em"/>
                            <mml:mspace width="0.333333em"/>
                            <mml:mtext>of</mml:mtext>
                            <mml:mspace width="0.333333em"/>
                            <mml:msubsup>
                              <mml:mi>X</mml:mi>
                              <mml:mn>1</mml:mn>
                              <mml:mo>∗</mml:mo>
                            </mml:msubsup>
                            <mml:mspace width="0.333333em"/>
                            <mml:mtext>is</mml:mtext>
                            <mml:mspace width="0.333333em"/>
                            <mml:mspace width="0.333333em"/>
                            <mml:mtext>aa.</mml:mtext>
                            <mml:mspace width="0.333333em"/>
                          </mml:mrow>
                        </mml:mtd>
                      </mml:mtr>
                    </mml:mtable>
                  </mml:mrow>
                </mml:mfenced>
              </mml:mrow>
            </mml:math>
            <inline-graphic xlink:href="41598_2021_2265_Article_IEq81.gif"/>
          </alternatives>
        </inline-formula>
      </p>
      <p id="Par29">In this simulation, we set <inline-formula id="IEq82"><alternatives><tex-math id="M177">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n = 100, p = 100,$$\end{document}</tex-math><mml:math id="M178"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>100</mml:mn><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mo>=</mml:mo><mml:mn>100</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41598_2021_2265_Article_IEq82.gif"/></alternatives></inline-formula> and <inline-formula id="IEq83"><alternatives><tex-math id="M179">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$K= 360$$\end{document}</tex-math><mml:math id="M180"><mml:mrow><mml:mi>K</mml:mi><mml:mo>=</mml:mo><mml:mn>360</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="41598_2021_2265_Article_IEq83.gif"/></alternatives></inline-formula>. As shown in Table <xref rid="Tab1" ref-type="table">1</xref>, the results of Simulation Example 1 achieve a level of perfection because it ranks the true predictor as 1.01 on average; additionally, there is no diversity or mistakes among the 100 replications judging from its various quantiles of <italic>M</italic>.<table-wrap id="Tab1"><label>Table 1</label><caption><p>Results of the Simulation 1.</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Simulation 1</th><th align="left"><inline-formula id="IEq84"><alternatives><tex-math id="M181">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Rk ^\text{{{a}}}$$\end{document}</tex-math><mml:math id="M182"><mml:mrow><mml:mi>R</mml:mi><mml:msup><mml:mi>k</mml:mi><mml:mtext>a</mml:mtext></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="41598_2021_2265_Article_IEq84.gif"/></alternatives></inline-formula></th><th align="left"><inline-formula id="IEq85"><alternatives><tex-math id="M183">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$M_{5\%} ^\text{{{b}}}$$\end{document}</tex-math><mml:math id="M184"><mml:msubsup><mml:mi>M</mml:mi><mml:mrow><mml:mn>5</mml:mn><mml:mo>%</mml:mo></mml:mrow><mml:mtext>b</mml:mtext></mml:msubsup></mml:math><inline-graphic xlink:href="41598_2021_2265_Article_IEq85.gif"/></alternatives></inline-formula></th><th align="left"><inline-formula id="IEq86"><alternatives><tex-math id="M185">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$M_{25\%}$$\end{document}</tex-math><mml:math id="M186"><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mn>25</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41598_2021_2265_Article_IEq86.gif"/></alternatives></inline-formula></th><th align="left"><inline-formula id="IEq87"><alternatives><tex-math id="M187">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$M_{50\%}$$\end{document}</tex-math><mml:math id="M188"><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mn>50</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41598_2021_2265_Article_IEq87.gif"/></alternatives></inline-formula></th><th align="left"><inline-formula id="IEq88"><alternatives><tex-math id="M189">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$M_{75\%}$$\end{document}</tex-math><mml:math id="M190"><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mn>75</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41598_2021_2265_Article_IEq88.gif"/></alternatives></inline-formula></th><th align="left"><inline-formula id="IEq89"><alternatives><tex-math id="M191">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$M_{95\%}$$\end{document}</tex-math><mml:math id="M192"><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mn>95</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41598_2021_2265_Article_IEq89.gif"/></alternatives></inline-formula></th></tr></thead><tbody><tr><td align="left"><inline-formula id="IEq90"><alternatives><tex-math id="M193">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$X^*_{1}$$\end{document}</tex-math><mml:math id="M194"><mml:msubsup><mml:mi>X</mml:mi><mml:mn>1</mml:mn><mml:mo>∗</mml:mo></mml:msubsup></mml:math><inline-graphic xlink:href="41598_2021_2265_Article_IEq90.gif"/></alternatives></inline-formula></td><td align="left">1.01</td><td align="left">1</td><td align="left">1</td><td align="left">1</td><td align="left">1</td><td align="left">1</td></tr></tbody></table><table-wrap-foot><p><inline-formula id="IEq91"><alternatives><tex-math id="M195">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$^\text{{{a}}}$$\end{document}</tex-math><mml:math id="M196"><mml:msup><mml:mrow/><mml:mtext>a</mml:mtext></mml:msup></mml:math><inline-graphic xlink:href="41598_2021_2265_Article_IEq91.gif"/></alternatives></inline-formula><italic>Rk</italic> stands for the average rank of the single true predictor across 100 replications. The smaller the <italic>Rk</italic> value is, the more effective the approach performs in variable selection.</p><p><inline-formula id="IEq92"><alternatives><tex-math id="M197">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$^\text{{{b}}}$$\end{document}</tex-math><mml:math id="M198"><mml:msup><mml:mrow/><mml:mtext>b</mml:mtext></mml:msup></mml:math><inline-graphic xlink:href="41598_2021_2265_Article_IEq92.gif"/></alternatives></inline-formula><italic>M</italic> stands for the minimum selection size that is required to obtain the single true predictor in each replication. The closer the different quantiles is to the total number of the true predictors, the robuster the approach is in variable selection.</p></table-wrap-foot></table-wrap></p>
      <p id="Par31">In addition to the variable selection results, we also demonstrate the prediction performance of the FunFor approach by visualizing one replication that is randomly chosen from Simulation 1 (see Figs.  <xref rid="Fig1" ref-type="fig">1</xref>, <xref rid="Fig2" ref-type="fig">2</xref>). Figure <xref rid="Fig2" ref-type="fig">2</xref> displays information that is similar to that in Fig. <xref rid="Fig1" ref-type="fig">1</xref>, but converts the curves back to shapes. The 100 simulated samples are divided into three categories based on the genotype information of the single true genetic marker <inline-formula id="IEq93"><alternatives><tex-math id="M199">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$X_1^*$$\end{document}</tex-math><mml:math id="M200"><mml:msubsup><mml:mi>X</mml:mi><mml:mn>1</mml:mn><mml:mo>∗</mml:mo></mml:msubsup></mml:math><inline-graphic xlink:href="41598_2021_2265_Article_IEq93.gif"/></alternatives></inline-formula>. Each separate column of Figs.  <xref rid="Fig1" ref-type="fig">1</xref> and <xref rid="Fig2" ref-type="fig">2</xref> represents a different genotype. The top panel of Figs. <xref rid="Fig1" ref-type="fig">1</xref> and <xref rid="Fig2" ref-type="fig">2</xref> stands for the original simulated response samples <inline-formula id="IEq94"><alternatives><tex-math id="M201">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Y_{ik}$$\end{document}</tex-math><mml:math id="M202"><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi mathvariant="italic">ik</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41598_2021_2265_Article_IEq94.gif"/></alternatives></inline-formula> and the second row is the predicted response curve output from the FunFor model, i.e., <inline-formula id="IEq95"><alternatives><tex-math id="M203">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\hat{f}}_i(t)$$\end{document}</tex-math><mml:math id="M204"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="41598_2021_2265_Article_IEq95.gif"/></alternatives></inline-formula>. The true leaf used to generate data is visualized by a solid black line and the samples are demonstrated by transparent green lines. As shown in Figs. <xref rid="Fig1" ref-type="fig">1</xref> and <xref rid="Fig2" ref-type="fig">2</xref>, the predicted curve responses are very close to the truth, with predictions capturing not only global trajectories but also subtle local details of the shape. Despite the fact that the simulated response samples are noisy (see the first rows of Figs.  <xref rid="Fig1" ref-type="fig">1</xref>, <xref rid="Fig2" ref-type="fig">2</xref>) and the 99/100 predictors are generated to be confounding noise, the prediction results visually look great. In the following simulations, we will formally investigate the prediction accuracy using the MAE value.</p>
      <p id="Par30">
        <fig id="Fig1">
          <label>Figure 1</label>
          <caption>
            <p>Visualization of the prediction performance of the FunFor approach for one replication in the Simulation 1: The top panel illustrates the simulated response samples (transparent green lines on the first row) and the bottom panel demonstrates the predicted curve response (transparent green lines on the the second row) output from the FunFor approach. Each column corresponds to a different genotype category. The black lines demonstrate the three true shapes used for generating data.</p>
          </caption>
          <graphic xlink:href="41598_2021_2265_Fig1_HTML" id="MO8"/>
        </fig>
        <fig id="Fig2">
          <label>Figure 2</label>
          <caption>
            <p>Same information as the Fig. <xref rid="Fig1" ref-type="fig">1</xref>, but converting curves into shapes.</p>
          </caption>
          <graphic xlink:href="41598_2021_2265_Fig2_HTML" id="MO9"/>
        </fig>
      </p>
    </sec>
    <sec id="Sec11">
      <title>Simulation Examples 2–4: a statistical model design</title>
      <p id="Par32">In this design, we simulate data through statistical models so that we can easily control the parameter values, difficulty levels, association structures, and also compare with other relevant approaches. The time points <inline-formula id="IEq96"><alternatives><tex-math id="M205">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t_{k}$$\end{document}</tex-math><mml:math id="M206"><mml:msub><mml:mi>t</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="41598_2021_2265_Article_IEq96.gif"/></alternatives></inline-formula> for each observation are scheduled to be <inline-formula id="IEq97"><alternatives><tex-math id="M207">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\{1,\ldots , K\}$$\end{document}</tex-math><mml:math id="M208"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>K</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41598_2021_2265_Article_IEq97.gif"/></alternatives></inline-formula>, which is consistent with the focused regular and dense setting. The predictor variables, <italic>X</italic>s, are generated from <inline-formula id="IEq98"><alternatives><tex-math id="M209">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N({\varvec{0}}, \Sigma _X)$$\end{document}</tex-math><mml:math id="M210"><mml:mrow><mml:mi>N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn mathvariant="bold">0</mml:mn></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="normal">Σ</mml:mi><mml:mi>X</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41598_2021_2265_Article_IEq98.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq99"><alternatives><tex-math id="M211">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Sigma _X$$\end{document}</tex-math><mml:math id="M212"><mml:msub><mml:mi mathvariant="normal">Σ</mml:mi><mml:mi>X</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="41598_2021_2265_Article_IEq99.gif"/></alternatives></inline-formula> follows an <italic>AR</italic>(1) design (<inline-formula id="IEq100"><alternatives><tex-math id="M213">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sigma =1, \rho = 0.6)$$\end{document}</tex-math><mml:math id="M214"><mml:mrow><mml:mi>σ</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>ρ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.6</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41598_2021_2265_Article_IEq100.gif"/></alternatives></inline-formula> so that the joint effects and correlations between predictors (as those exist in the practices) can be incorporated. The coefficient functions are set to be<disp-formula id="Equ8"><alternatives><tex-math id="M215">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \beta _1 (t) = \text {sin}(20 \pi t), \,\, \beta _2 (t) = \text {cos}(20 \pi t),\,\, \beta _3 (t) = \text {cos}(20 \pi t) + \text {sin}(20 \pi t). \end{aligned}$$\end{document}</tex-math><mml:math id="M216" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mtext>sin</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>20</mml:mn><mml:mi>π</mml:mi><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:mspace width="0.166667em"/><mml:msub><mml:mi>β</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mtext>cos</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>20</mml:mn><mml:mi>π</mml:mi><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:mspace width="0.166667em"/><mml:msub><mml:mi>β</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mtext>cos</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>20</mml:mn><mml:mi>π</mml:mi><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mtext>sin</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>20</mml:mn><mml:mi>π</mml:mi><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="41598_2021_2265_Article_Equ8.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par33">The random error <inline-formula id="IEq101"><alternatives><tex-math id="M217">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{\varepsilon }_i=\{\varepsilon _{i1},\ldots ,\varepsilon _{ik},\ldots ,\varepsilon _{iK}\}$$\end{document}</tex-math><mml:math id="M218"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">ε</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>ε</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>ε</mml:mi><mml:mrow><mml:mi mathvariant="italic">ik</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>ε</mml:mi><mml:mrow><mml:mi mathvariant="italic">iK</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="41598_2021_2265_Article_IEq101.gif"/></alternatives></inline-formula> is generated from <inline-formula id="IEq102"><alternatives><tex-math id="M219">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N({\varvec{0}}, \Sigma _\varepsilon )$$\end{document}</tex-math><mml:math id="M220"><mml:mrow><mml:mi>N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn mathvariant="bold">0</mml:mn></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="normal">Σ</mml:mi><mml:mi>ε</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41598_2021_2265_Article_IEq102.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq103"><alternatives><tex-math id="M221">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Sigma _\varepsilon $$\end{document}</tex-math><mml:math id="M222"><mml:msub><mml:mi mathvariant="normal">Σ</mml:mi><mml:mi>ε</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="41598_2021_2265_Article_IEq103.gif"/></alternatives></inline-formula> follows <italic>AR</italic>(1) design with <inline-formula id="IEq104"><alternatives><tex-math id="M223">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(\sigma _k=(5 \cos (k) + rnorm(K, 0, 1)) / 10, \rho = 0.01)$$\end{document}</tex-math><mml:math id="M224"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>5</mml:mn><mml:mo>cos</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>r</mml:mi><mml:mi>n</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>m</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>K</mml:mi><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">/</mml:mo><mml:mn>10</mml:mn><mml:mo>,</mml:mo><mml:mi>ρ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.01</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41598_2021_2265_Article_IEq104.gif"/></alternatives></inline-formula> to take their auto-correlation into account.</p>
      <sec id="Sec12">
        <title>Simulation Example 2</title>
        <p id="Par34">The response curve and the two true predictors (<inline-formula id="IEq105"><alternatives><tex-math id="M225">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$X_2, X_3$$\end{document}</tex-math><mml:math id="M226"><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="41598_2021_2265_Article_IEq105.gif"/></alternatives></inline-formula>) and their interactive terms (<inline-formula id="IEq106"><alternatives><tex-math id="M227">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$X_2X_3$$\end{document}</tex-math><mml:math id="M228"><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>X</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="41598_2021_2265_Article_IEq106.gif"/></alternatives></inline-formula>) are connected as<disp-formula id="Equ9"><alternatives><tex-math id="M229">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} Y_{ik} = X_{i2} \beta _1(t_{k})+ X_{i3}\beta _2(t_{k}) + X_{i2}X_{i3}\beta _3(t_{k}) + \varepsilon _{ik}. \end{aligned}$$\end{document}</tex-math><mml:math id="M230" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi mathvariant="italic">ik</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mi>β</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mi>β</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mi>β</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>ε</mml:mi><mml:mrow><mml:mi mathvariant="italic">ik</mml:mi></mml:mrow></mml:msub><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="41598_2021_2265_Article_Equ9.gif" position="anchor"/></alternatives></disp-formula></p>
        <p id="Par35">In this simulation, we set <inline-formula id="IEq107"><alternatives><tex-math id="M231">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n = 100, p = 100,$$\end{document}</tex-math><mml:math id="M232"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>100</mml:mn><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mo>=</mml:mo><mml:mn>100</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41598_2021_2265_Article_IEq107.gif"/></alternatives></inline-formula> and <inline-formula id="IEq108"><alternatives><tex-math id="M233">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$K= 500$$\end{document}</tex-math><mml:math id="M234"><mml:mrow><mml:mi>K</mml:mi><mml:mo>=</mml:mo><mml:mn>500</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="41598_2021_2265_Article_IEq108.gif"/></alternatives></inline-formula>.</p>
      </sec>
      <sec id="Sec13">
        <title>Simulation Example 3</title>
        <p id="Par36">This Simulation Example 3 has the same design and model as the Simulation Example 2, except we change the parameters to <inline-formula id="IEq109"><alternatives><tex-math id="M235">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n = 200, p = 500,$$\end{document}</tex-math><mml:math id="M236"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>200</mml:mn><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mo>=</mml:mo><mml:mn>500</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41598_2021_2265_Article_IEq109.gif"/></alternatives></inline-formula> and <inline-formula id="IEq110"><alternatives><tex-math id="M237">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$K= 100$$\end{document}</tex-math><mml:math id="M238"><mml:mrow><mml:mi>K</mml:mi><mml:mo>=</mml:mo><mml:mn>100</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="41598_2021_2265_Article_IEq110.gif"/></alternatives></inline-formula> to explore the robustness of the approach under a different parameter setting.</p>
      </sec>
      <sec id="Sec14">
        <title>Simulation Example 4</title>
        <p id="Par37">The response curve and the true predictors are connected as<disp-formula id="Equ10"><alternatives><tex-math id="M239">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} Y_{ik} = X_{i2} X_{i3} \beta _1 (t_{k})/3 + \varepsilon _{ik}. \end{aligned}$$\end{document}</tex-math><mml:math id="M240" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi mathvariant="italic">ik</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mi>β</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">/</mml:mo><mml:mn>3</mml:mn><mml:mo>+</mml:mo><mml:msub><mml:mi>ε</mml:mi><mml:mrow><mml:mi mathvariant="italic">ik</mml:mi></mml:mrow></mml:msub><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="41598_2021_2265_Article_Equ10.gif" position="anchor"/></alternatives></disp-formula></p>
        <p id="Par38">In this simulation, we remove the main/individual effects and keep only one interactive term, thus increasing the difficulty level. In this simulation, we set <inline-formula id="IEq111"><alternatives><tex-math id="M241">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n = 100, p = 100,$$\end{document}</tex-math><mml:math id="M242"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>100</mml:mn><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mo>=</mml:mo><mml:mn>100</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41598_2021_2265_Article_IEq111.gif"/></alternatives></inline-formula> and <inline-formula id="IEq112"><alternatives><tex-math id="M243">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$K= 100$$\end{document}</tex-math><mml:math id="M244"><mml:mrow><mml:mi>K</mml:mi><mml:mo>=</mml:mo><mml:mn>100</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="41598_2021_2265_Article_IEq112.gif"/></alternatives></inline-formula>.
</p>
        <p id="Par39">The results of Simulation Examples 2–4 for the four approaches under comparison are demonstrated in Tables <xref rid="Tab2" ref-type="table">2</xref> and <xref rid="Tab3" ref-type="table">3</xref>. The FunFor approach performs the best in most of the cases among the four approaches in terms of both variable selection and prediction accuracy. As one can see from Table <xref rid="Tab2" ref-type="table">2</xref>, the FunFor approach consistently ranks the two true predictors among the top three ones on average no matter if main effects exist (Simulation 2) or not (Simulation 4). When the <italic>p</italic>/<italic>n</italic> ratio increases to be 2.5 times higher, it still effectively ranks the two true predictors among the top five ones on average (Simulation 3). For Simulations 3, the ranks of the FunFor approach are slightly worse than those of the refund and FRF. However, these two approaches perform much worse in Simulation 4 when there are no main/individual terms included in the model. Additionally, their ranks in Simulation 4 are more than five times higher than those in Simulations 2–3. We are not surprised at this gap because lack of strong main/individual effects or lack of ability in detecting complex structures has been a common challenge for many approaches. In addition, the prediction accuracies (i.e., MAEs) of the FunFor approach are consistently the smallest among the four approaches in all of the three simulation settings. Table <xref rid="Tab3" ref-type="table">3</xref> demonstrates the quantiles of the minimum selection size for the four approaches in order to simultaneously detect all of the true predictors. We can see that the FunFor approach is the most robust approach no matter if the main/individual effects exist or not. The <italic>M</italic> values of the FunFor approach do not show much variation from 5 to 95%, which further indicates that the majority of replications effectively achieve the best results under various settings. The FRF and refund also perform great under Simulation 3 without being affected by the <italic>p</italic>/<italic>n</italic> ratio, but their performances greatly decrease under the more complex scenario in Simulation 4.<table-wrap id="Tab2"><label>Table 2</label><caption><p>The variable selection and prediction performances of the four approaches for the Simulation Examples 2–4.</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Simulation</th><th align="left">Method</th><th align="left">Average of <inline-formula id="IEq113"><alternatives><tex-math id="M245">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$M^\text{{{a}}}$$\end{document}</tex-math><mml:math id="M246"><mml:msup><mml:mi>M</mml:mi><mml:mtext>a</mml:mtext></mml:msup></mml:math><inline-graphic xlink:href="41598_2021_2265_Article_IEq113.gif"/></alternatives></inline-formula></th><th align="left"><inline-formula id="IEq114"><alternatives><tex-math id="M247">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Rk_{X_2^*}}^\text{{{b}}}$$\end{document}</tex-math><mml:math id="M248"><mml:msup><mml:mrow><mml:mi>R</mml:mi><mml:msub><mml:mi>k</mml:mi><mml:msubsup><mml:mi>X</mml:mi><mml:mn>2</mml:mn><mml:mo>∗</mml:mo></mml:msubsup></mml:msub></mml:mrow><mml:mtext>b</mml:mtext></mml:msup></mml:math><inline-graphic xlink:href="41598_2021_2265_Article_IEq114.gif"/></alternatives></inline-formula></th><th align="left"><inline-formula id="IEq115"><alternatives><tex-math id="M249">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Rk_{X_3^*}$$\end{document}</tex-math><mml:math id="M250"><mml:mrow><mml:mi>R</mml:mi><mml:msub><mml:mi>k</mml:mi><mml:msubsup><mml:mi>X</mml:mi><mml:mn>3</mml:mn><mml:mo>∗</mml:mo></mml:msubsup></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="41598_2021_2265_Article_IEq115.gif"/></alternatives></inline-formula></th><th align="left"><inline-formula id="IEq116"><alternatives><tex-math id="M251">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hbox {MAE}^\text{{{c}}}$$\end{document}</tex-math><mml:math id="M252"><mml:msup><mml:mtext>MAE</mml:mtext><mml:mtext>c</mml:mtext></mml:msup></mml:math><inline-graphic xlink:href="41598_2021_2265_Article_IEq116.gif"/></alternatives></inline-formula></th></tr></thead><tbody><tr><td align="left" rowspan="4">Simulation 2</td><td align="left">FunFor</td><td char="." align="char">2.58</td><td char="." align="char">2.01</td><td char="." align="char">2.12</td><td align="left">1.48</td></tr><tr><td align="left">FRF</td><td char="." align="char">6.70</td><td char="." align="char">4.37</td><td char="." align="char">4.08</td><td align="left">2.29</td></tr><tr><td align="left">Splinetree</td><td char="." align="char">21.91</td><td char="." align="char">20.88</td><td char="." align="char">21.91</td><td align="left">2.30</td></tr><tr><td align="left">Refund</td><td char="." align="char">2.00</td><td char="." align="char">1.18</td><td char="." align="char">1.82</td><td align="left">2.23</td></tr><tr><td align="left" rowspan="4">Simulation 3</td><td align="left">FunFor</td><td char="." align="char">5.17</td><td char="." align="char">4.66</td><td char="." align="char">4.68</td><td align="left">1.50</td></tr><tr><td align="left">FRF</td><td char="." align="char">2.83</td><td char="." align="char">2.40</td><td char="." align="char">1.51</td><td align="left">2.28</td></tr><tr><td align="left">Splinetree</td><td char="." align="char">38.58</td><td char="." align="char">37.40</td><td char="." align="char">38.42</td><td align="left">2.28</td></tr><tr><td align="left">Refund</td><td char="." align="char">2.00</td><td char="." align="char">1.58</td><td char="." align="char">1.43</td><td align="left">2.31</td></tr><tr><td align="left" rowspan="4">Simulation 4</td><td align="left">FunFor</td><td char="." align="char">3.74</td><td char="." align="char">2.25</td><td char="." align="char">3.06</td><td align="left">0.58</td></tr><tr><td align="left">FRF</td><td char="." align="char">25.35</td><td char="." align="char">15.02</td><td char="." align="char">17.65</td><td align="left">0.62</td></tr><tr><td align="left">Splinetree</td><td char="." align="char">56.99</td><td char="." align="char">43.49</td><td char="." align="char">40.35</td><td align="left">0.62</td></tr><tr><td align="left">Refund</td><td char="." align="char">28.40</td><td char="." align="char">16.26</td><td char="." align="char">18.10</td><td align="left">0.62</td></tr></tbody></table><table-wrap-foot><p><sup>a</sup>The average of <italic>M</italic> is the average of the minimum selection size that requires to obtain all of the true predictors across 100 replications. The smaller, the better.</p><p><inline-formula id="IEq118"><alternatives><tex-math id="M253">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$^\text{{{b}}}$$\end{document}</tex-math><mml:math id="M254"><mml:msup><mml:mrow/><mml:mtext>b</mml:mtext></mml:msup></mml:math><inline-graphic xlink:href="41598_2021_2265_Article_IEq118.gif"/></alternatives></inline-formula><italic>Rk</italic> stands for the average rank of each true predictor across 100 replications. The smaller, the better.</p><p><inline-formula id="IEq119"><alternatives><tex-math id="M255">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$^\text{{{c}}}$$\end{document}</tex-math><mml:math id="M256"><mml:msup><mml:mrow/><mml:mtext>c</mml:mtext></mml:msup></mml:math><inline-graphic xlink:href="41598_2021_2265_Article_IEq119.gif"/></alternatives></inline-formula>MAE is the prediction error. The smaller, the better.</p></table-wrap-foot></table-wrap><table-wrap id="Tab3"><label>Table 3</label><caption><p>The quantiles of the minimum selection sizes of the four approaches for the Simulation Examples 2–4.</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Quantiles of <inline-formula id="IEq120"><alternatives><tex-math id="M257">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$M^\text{{{a}}} $$\end{document}</tex-math><mml:math id="M258"><mml:msup><mml:mi>M</mml:mi><mml:mtext>a</mml:mtext></mml:msup></mml:math><inline-graphic xlink:href="41598_2021_2265_Article_IEq120.gif"/></alternatives></inline-formula></th><th align="left">Method</th><th align="left"><inline-formula id="IEq121"><alternatives><tex-math id="M259">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$5\%$$\end{document}</tex-math><mml:math id="M260"><mml:mrow><mml:mn>5</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41598_2021_2265_Article_IEq121.gif"/></alternatives></inline-formula></th><th align="left"><inline-formula id="IEq122"><alternatives><tex-math id="M261">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$25\%$$\end{document}</tex-math><mml:math id="M262"><mml:mrow><mml:mn>25</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41598_2021_2265_Article_IEq122.gif"/></alternatives></inline-formula></th><th align="left"><inline-formula id="IEq123"><alternatives><tex-math id="M263">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$50\%$$\end{document}</tex-math><mml:math id="M264"><mml:mrow><mml:mn>50</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41598_2021_2265_Article_IEq123.gif"/></alternatives></inline-formula></th><th align="left"><inline-formula id="IEq124"><alternatives><tex-math id="M265">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$75\%$$\end{document}</tex-math><mml:math id="M266"><mml:mrow><mml:mn>75</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41598_2021_2265_Article_IEq124.gif"/></alternatives></inline-formula></th><th align="left"><inline-formula id="IEq125"><alternatives><tex-math id="M267">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$95\%$$\end{document}</tex-math><mml:math id="M268"><mml:mrow><mml:mn>95</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41598_2021_2265_Article_IEq125.gif"/></alternatives></inline-formula></th></tr></thead><tbody><tr><td align="left" rowspan="4">Simulation 2</td><td align="left">FunFor</td><td char="." align="char">2.00</td><td char="." align="char">2.00</td><td char="." align="char">2.00</td><td char="." align="char">3.00</td><td char="." align="char">4.00</td></tr><tr><td align="left">FRF</td><td char="." align="char">2.00</td><td char="." align="char">2.00</td><td char="." align="char">4.00</td><td char="." align="char">9.00</td><td char="." align="char">18.00</td></tr><tr><td align="left">Splinetree</td><td char="." align="char">16.00</td><td char="." align="char">19.00</td><td char="." align="char">22.00</td><td char="." align="char">24.00</td><td char="." align="char">28.00</td></tr><tr><td align="left">Refund</td><td char="." align="char">2.00</td><td char="." align="char">2.00</td><td char="." align="char">2.00</td><td char="." align="char">2.00</td><td char="." align="char">2.00</td></tr><tr><td align="left" rowspan="4">Simulation 3</td><td align="left">FunFor</td><td char="." align="char">3.00</td><td char="." align="char">4.00</td><td char="." align="char">5.00</td><td char="." align="char">6.00</td><td char="." align="char">7.05</td></tr><tr><td align="left">FRF</td><td char="." align="char">2.0</td><td char="." align="char">2.0</td><td char="." align="char">2.0</td><td char="." align="char">3.0</td><td char="." align="char">5.1</td></tr><tr><td align="left">Splinetree</td><td char="." align="char">32.00</td><td char="." align="char">35.00</td><td char="." align="char">38.00</td><td char="." align="char">41.00</td><td char="." align="char">46.05</td></tr><tr><td align="left">Refund</td><td char="." align="char">2.00</td><td char="." align="char">2.00</td><td char="." align="char">2.00</td><td char="." align="char">2.00</td><td char="." align="char">2.00</td></tr><tr><td align="left" rowspan="4">Simulation 4</td><td align="left">FunFor</td><td char="." align="char">2.00</td><td char="." align="char">2.00</td><td char="." align="char">3.00</td><td char="." align="char">3.00</td><td char="." align="char">5.05</td></tr><tr><td align="left">FRF</td><td char="." align="char">3.00</td><td char="." align="char">12.00</td><td char="." align="char">22.50</td><td char="." align="char">36.25</td><td char="." align="char">62.05</td></tr><tr><td align="left">Splinetree</td><td char="." align="char">16.00</td><td char="." align="char">38.00</td><td char="." align="char">58.00</td><td char="." align="char">81.00</td><td char="." align="char">94.00</td></tr><tr><td align="left">Refund</td><td char="." align="char">2.00</td><td char="." align="char">2.00</td><td char="." align="char">2.00</td><td char="." align="char">98.00</td><td char="." align="char">100.00</td></tr></tbody></table><table-wrap-foot><p><inline-formula id="IEq126"><alternatives><tex-math id="M269">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$^\text{{{a}}}$$\end{document}</tex-math><mml:math id="M270"><mml:msup><mml:mrow/><mml:mtext>a</mml:mtext></mml:msup></mml:math><inline-graphic xlink:href="41598_2021_2265_Article_IEq126.gif"/></alternatives></inline-formula><italic>M</italic> stands for the minimum selection size that is required to include all of the true predictors in each replication. The closer of different quantiles, the robuster.</p></table-wrap-foot></table-wrap></p>
      </sec>
    </sec>
    <sec id="Sec15">
      <title>Simulation Example 5: a null model</title>
      <p id="Par40">To fully verify that the good performances of the FunFor approach are not caused by chance, we generate data from a null model, under which there is no association existing between the curve response and any of the predictors. That is, the <inline-formula id="IEq127"><alternatives><tex-math id="M271">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$X\hbox {s}$$\end{document}</tex-math><mml:math id="M272"><mml:mrow><mml:mi>X</mml:mi><mml:mtext>s</mml:mtext></mml:mrow></mml:math><inline-graphic xlink:href="41598_2021_2265_Article_IEq127.gif"/></alternatives></inline-formula>, random errors, and <inline-formula id="IEq128"><alternatives><tex-math id="M273">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta _1(t)$$\end{document}</tex-math><mml:math id="M274"><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="41598_2021_2265_Article_IEq128.gif"/></alternatives></inline-formula> are all set as above, but we do not connect <italic>Y</italic> with any of the predictors. Specifically, the response is generated as<disp-formula id="Equ11"><alternatives><tex-math id="M275">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} Y_{ik} = \beta _1 (t_k) + \varepsilon _{ik}. \end{aligned}$$\end{document}</tex-math><mml:math id="M276" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi mathvariant="italic">ik</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>ε</mml:mi><mml:mrow><mml:mi mathvariant="italic">ik</mml:mi></mml:mrow></mml:msub><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="41598_2021_2265_Article_Equ11.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par41">In this simulation, we set <inline-formula id="IEq129"><alternatives><tex-math id="M277">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n = 100, p = 100$$\end{document}</tex-math><mml:math id="M278"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>100</mml:mn><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mo>=</mml:mo><mml:mn>100</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="41598_2021_2265_Article_IEq129.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq130"><alternatives><tex-math id="M279">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$K = 100$$\end{document}</tex-math><mml:math id="M280"><mml:mrow><mml:mi>K</mml:mi><mml:mo>=</mml:mo><mml:mn>100</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="41598_2021_2265_Article_IEq130.gif"/></alternatives></inline-formula>. As demonstrated in Fig. <xref rid="Fig3" ref-type="fig">3</xref>, the average PVIM scores across 100 replications for all of the predictors output from the FunFor approach are close to zero, locating within a very small range of [− 0.0025, 0.0025]. It’s good to see that no predictor stands out, which is well aligned with the true situation.<fig id="Fig3"><label>Figure 3</label><caption><p>Average prediction variable importance scores across 100 replications for all of the predictors output from the FunFor approach in Simulation 5.</p></caption><graphic xlink:href="41598_2021_2265_Fig3_HTML" id="MO14"/></fig></p>
    </sec>
  </sec>
  <sec id="Sec16">
    <title>Real data analysis</title>
    <p id="Par42">In this section, we analyze the leaf shapes of a natural population of 421 <italic>Populus euphratica</italic> (also named <italic>Euphrates Poplar</italic> or <italic>Desert Poplar</italic>) trees, which naturally grow along river valleys in arid regions of the Xin Jiang province of China. Twenty-five leaves were randomly collected from each tree. The leaf shapes of <italic>Populus euphratica</italic> are polymorphic with complex subtle details on their boundaries, so a small set of loose landmark points will be incapable of accurately describing them. Therefore, we use a <inline-formula id="IEq131"><alternatives><tex-math id="M281">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$910 \times 1$$\end{document}</tex-math><mml:math id="M282"><mml:mrow><mml:mn>910</mml:mn><mml:mo>×</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="41598_2021_2265_Article_IEq131.gif"/></alternatives></inline-formula> dimensional curve to describe each shape based on the directional radii method<sup><xref ref-type="bibr" rid="CR44">44</xref></sup>. As observed in Fig. <xref rid="Fig4" ref-type="fig">4</xref>, the one-to-one mapping between the shape and the 910-dimensional curve is accurate, with sharp and complex teeth on the boundary also being well-maintained. Then we perform the alignment to filter out the variations caused by pose (translation, size, and rotation) before performing the analysis<sup><xref ref-type="bibr" rid="CR43">43</xref>,<xref ref-type="bibr" rid="CR44">44</xref></sup>. The directional radii curve then becomes standard functional data measured on dense and regular grids. The scientific interest is to detect which genes are truly associated with the variation of the trajectories of biological leaf shape traits, and to predict morphology for future observations. Since the twenty-five leaves collected from the same tree are correlated and share the same genetic information, we use the average of the twenty-five shape curves as the curve response of each observation. For each of the 421 trees, 104 markers were also genotyped.<fig id="Fig4"><label>Figure 4</label><caption><p>The shape curve generation process: recognize a shape outline demonstrated from (<bold>A,B</bold>); and transform a shape to a curve demonstrated from (<bold>B,C</bold>).</p></caption><graphic xlink:href="41598_2021_2265_Fig4_HTML" id="MO15"/></fig></p>
    <p id="Par44">We empirically explore whether the FunFor approach is robust over a few different choices of tuning parameters. Since ‘mtry’ is suggested to be <inline-formula id="IEq137"><alternatives><tex-math id="M283">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p/3\approx 35$$\end{document}</tex-math><mml:math id="M284"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:mn>3</mml:mn><mml:mo>≈</mml:mo><mml:mn>35</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="41598_2021_2265_Article_IEq137.gif"/></alternatives></inline-formula>, we employ three <italic>mtry</italic> values: 10, 20, and 35. In addition, we also try the two options, the fixed version and the adaptive version, for choosing <italic>L</italic>. For the fixed setting, we choose <inline-formula id="IEq138"><alternatives><tex-math id="M285">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L=4$$\end{document}</tex-math><mml:math id="M286"><mml:mrow><mml:mi>L</mml:mi><mml:mo>=</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="41598_2021_2265_Article_IEq138.gif"/></alternatives></inline-formula> because the first four PCs can explain about 90% of the total variation in the curve response using all of the observations at the root node. The performance of FunFor approach is assessed by evaluating the average prediction integrated squared error between the observed and the predicted curve response using five-fold cross-validation. Judging from the results demonstrated in Table <xref rid="Tab4" ref-type="table">4</xref>, the prediction ISE does not differ much among the six different combinations, which empirically verifies the robustness of the FunFor method over reasonable choices of the two tuning parameters. In the following, we interpret the results obtained from the adaptive <italic>L</italic> setting and <inline-formula id="IEq139"><alternatives><tex-math id="M287">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$mtry = 20$$\end{document}</tex-math><mml:math id="M288"><mml:mrow><mml:mi>m</mml:mi><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>y</mml:mi><mml:mo>=</mml:mo><mml:mn>20</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="41598_2021_2265_Article_IEq139.gif"/></alternatives></inline-formula> for the real data analysis because it achieves a relatively optimal prediction ISE.</p>
    <p id="Par43">
      <table-wrap id="Tab4">
        <label>Table 4</label>
        <caption>
          <p>The prediction error obtained from the fivefold cross-validation under six combinations of the two tuning parameters.</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <th align="left" rowspan="2">
                <inline-formula id="IEq132">
                  <alternatives>
                    <tex-math id="M289">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L^\text{{{a}}}$$\end{document}</tex-math>
                    <mml:math id="M290">
                      <mml:msup>
                        <mml:mi>L</mml:mi>
                        <mml:mtext>a</mml:mtext>
                      </mml:msup>
                    </mml:math>
                    <inline-graphic xlink:href="41598_2021_2265_Article_IEq132.gif"/>
                  </alternatives>
                </inline-formula>
              </th>
              <th align="left" colspan="3">
                <inline-formula id="IEq133">
                  <alternatives>
                    <tex-math id="M291">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$mtry^\text{{{b}}}$$\end{document}</tex-math>
                    <mml:math id="M292">
                      <mml:mrow>
                        <mml:mi>m</mml:mi>
                        <mml:mi>t</mml:mi>
                        <mml:mi>r</mml:mi>
                        <mml:msup>
                          <mml:mi>y</mml:mi>
                          <mml:mtext>b</mml:mtext>
                        </mml:msup>
                      </mml:mrow>
                    </mml:math>
                    <inline-graphic xlink:href="41598_2021_2265_Article_IEq133.gif"/>
                  </alternatives>
                </inline-formula>
              </th>
            </tr>
            <tr>
              <th align="left">10</th>
              <th align="left">20</th>
              <th align="left">35</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left">Adaptive <italic>L</italic></td>
              <td align="left">119.5</td>
              <td align="left">118.9</td>
              <td align="left">119.4</td>
            </tr>
            <tr>
              <td align="left">Fixed <inline-formula id="IEq134"><alternatives><tex-math id="M293">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L = 4$$\end{document}</tex-math><mml:math id="M294"><mml:mrow><mml:mi>L</mml:mi><mml:mo>=</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="41598_2021_2265_Article_IEq134.gif"/></alternatives></inline-formula></td>
              <td align="left">119.7</td>
              <td align="left">119.3</td>
              <td align="left">118.9</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <p><inline-formula id="IEq135"><alternatives><tex-math id="M295">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$^\text{{{a}}}$$\end{document}</tex-math><mml:math id="M296"><mml:msup><mml:mrow/><mml:mtext>a</mml:mtext></mml:msup></mml:math><inline-graphic xlink:href="41598_2021_2265_Article_IEq135.gif"/></alternatives></inline-formula><italic>L</italic> is the number of functional PCs to be retained in Eq. (<xref rid="Equ3" ref-type="">3</xref>).</p>
          <p><inline-formula id="IEq136"><alternatives><tex-math id="M297">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$^\text{{{b}}}$$\end{document}</tex-math><mml:math id="M298"><mml:msup><mml:mrow/><mml:mtext>b</mml:mtext></mml:msup></mml:math><inline-graphic xlink:href="41598_2021_2265_Article_IEq136.gif"/></alternatives></inline-formula><italic>mtry</italic> is the size of the subset of the predictors that are considered at each split.</p>
        </table-wrap-foot>
      </table-wrap>
    </p>
    <p id="Par45">Figure <xref rid="Fig5" ref-type="fig">5</xref> demonstrates the PVIMs of all of the genetic markers. The majority of markers have PVIMs close to zero, which reflects the sparsity phenomenon of the genetic dataset. The three markers strikingly standing out with the highest PVIMs (<inline-formula id="IEq142"><alternatives><tex-math id="M299">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$&gt;200$$\end{document}</tex-math><mml:math id="M300"><mml:mrow><mml:mo>&gt;</mml:mo><mml:mn>200</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="41598_2021_2265_Article_IEq142.gif"/></alternatives></inline-formula>) are <italic>ORPM</italic><inline-formula id="IEq143"><alternatives><tex-math id="M301">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\_$$\end{document}</tex-math><mml:math id="M302"><mml:mi>_</mml:mi></mml:math><inline-graphic xlink:href="41598_2021_2265_Article_IEq143.gif"/></alternatives></inline-formula><italic>190</italic>, <italic>GCPM</italic><inline-formula id="IEq144"><alternatives><tex-math id="M303">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\_$$\end{document}</tex-math><mml:math id="M304"><mml:mi>_</mml:mi></mml:math><inline-graphic xlink:href="41598_2021_2265_Article_IEq144.gif"/></alternatives></inline-formula><italic>1812</italic>, and <italic>U50206</italic>, highlighted by red dots. In order to demonstrate the genetic effects of these three important markers, Fig. <xref rid="Fig6" ref-type="fig">6</xref> visualizes the average of the predicted shape curves (i.e., <inline-formula id="IEq145"><alternatives><tex-math id="M305">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\bar{{\hat{f}}}_i(t)$$\end{document}</tex-math><mml:math id="M306"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mrow><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mrow></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="41598_2021_2265_Article_IEq145.gif"/></alternatives></inline-formula>) that FunFor outputs across the observations of each genotype category. The three genotype categories exhibit quite different curve trajectories, which indicate the non-negligible association existing between these three genetic markers and the shape curve. Specifically, the marker <italic>ORPM_190</italic> has only two genotypes (<italic>AA</italic> &amp; <italic>aa</italic>) and its red line (corresponding to Aa) does not show up. For marker <italic>GCPM_1812</italic>, the entire trajectories of aa (blue line) and Aa (red line) are very similar, but they are dramatically different from the curve of AA (black line), which represents a recessive genetic effect. For marker <italic>U50206</italic>, the entire trajectories of AA (black line) and Aa (red line) are very similar, but they are different from the curve of aa (blue line), which represents a dominant genetic effect. As a comparison, the results of the three genetic markers (<italic>Pe_5</italic>, <italic>Pe_8</italic>, <italic>GCPM_1941</italic>) with the minimum PVIMs are also visualized in Fig. <xref rid="Fig7" ref-type="fig">7</xref>. Opposed to Fig. <xref rid="Fig6" ref-type="fig">6</xref>, the three average shape curves corresponding to the three different genotype categories for each of the three markers with minimum PVIMs almost overlap each other. Figure <xref rid="Fig7" ref-type="fig">7</xref> visually reconfirms that the markers with low PVIMs are unlikely to be associated with the responses curve. In addition to the mean shape curve, we also demonstrate the first two eigenfunctions for the three most important markers (see Fig. <xref rid="Fig8" ref-type="fig">8</xref>). The first mode accounts for around 41% of the total variation of all shape observations in this data. We noticed that the <inline-formula id="IEq146"><alternatives><tex-math id="M307">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\hat{v}}_1(t)$$\end{document}</tex-math><mml:math id="M308"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>v</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mn>1</mml:mn></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="41598_2021_2265_Article_IEq146.gif"/></alternatives></inline-formula> for aa (the solid blue line) is completely negative for <italic>ORPM_190</italic>, but completely positive for <italic>U50206</italic>, throughout the entire range. This demonstrates that the same genotype aa of different genetic markers can have opposite contributions to the biggest variability mode among all leaf shapes. The second mode accounts for around 32% of the total variation of all shape observations in this data. We also notice that the signs of the <inline-formula id="IEq147"><alternatives><tex-math id="M309">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\hat{v}}_2(t)$$\end{document}</tex-math><mml:math id="M310"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>v</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mn>2</mml:mn></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="41598_2021_2265_Article_IEq147.gif"/></alternatives></inline-formula> for aa (dash blue lines) are almost exactly the opposite to those of <inline-formula id="IEq148"><alternatives><tex-math id="M311">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\hat{v}}_2(t)$$\end{document}</tex-math><mml:math id="M312"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>v</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mn>2</mml:mn></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="41598_2021_2265_Article_IEq148.gif"/></alternatives></inline-formula> for AA (dashed black lines) everywhere among each of the three subplots demonstrated in Fig. <xref rid="Fig8" ref-type="fig">8</xref>. This demonstrates that the genotypes aa and AA of the same marker can have opposite contributions to the second mode variation, which corresponds to a measure of uniformity for genotypes of each marker contributing to the shape variation. Actually, Fig. <xref rid="Fig8" ref-type="fig">8</xref> visually confirms that information is lost when independence is assumed or the auto-covariance structure is neglected.<fig id="Fig5"><label>Figure 5</label><caption><p>Prediction variable importance measures of 104 genetic markers. The highest PVIMs are highlighted with red dots.</p></caption><graphic xlink:href="41598_2021_2265_Fig5_HTML" id="MO16"/></fig><fig id="Fig6"><label>Figure 6</label><caption><p>The average of the predicted shape curves output from the FunFor approach across all observations belong to each genotype category for the top three most important markers <italic>ORPM_190</italic>, <italic>GCPM_1812</italic>, and <italic>U50206</italic>. The black curve for AA, the red curve for Aa, and the blue curve for aa.</p></caption><graphic xlink:href="41598_2021_2265_Fig6_HTML" id="MO17"/></fig><fig id="Fig7"><label>Figure 7</label><caption><p>The average of the predicted shape curves output from the FunFor approach across all observations belong to each genotype category for the three least important markers <italic>Pe_5</italic>, <italic>Pe_8</italic>, and <italic>GCPM_1941</italic>. The black curve for AA, the red curve for Aa, and the blue curve for aa.</p></caption><graphic xlink:href="41598_2021_2265_Fig7_HTML" id="MO18"/></fig><fig id="Fig8"><label>Figure 8</label><caption><p>The first two Eigenfunctions output from the FunFor approach across all observations belong to each genotype of the top three most important markers <italic>ORPM_190</italic>, <italic>GCPM_1812</italic>, and <italic>U50206</italic>. The black curve for AA, the red curve for Aa, and the blue curve for aa. Solid line for the first Eigenfunction <inline-formula id="IEq140"><alternatives><tex-math id="M313">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\hat{v}}_{1}(t)$$\end{document}</tex-math><mml:math id="M314"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>v</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mn>1</mml:mn></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="41598_2021_2265_Article_IEq140.gif"/></alternatives></inline-formula> and the dash line for the second Eigenfunction <inline-formula id="IEq141"><alternatives><tex-math id="M315">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\hat{v}}_{2}(t)$$\end{document}</tex-math><mml:math id="M316"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>v</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mn>2</mml:mn></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="41598_2021_2265_Article_IEq141.gif"/></alternatives></inline-formula>.</p></caption><graphic xlink:href="41598_2021_2265_Fig8_HTML" id="MO19"/></fig><fig id="Fig9"><label>Figure 9</label><caption><p>Visualization of the predicted and observed shapes for four observations. The solid lines are the original observed shape (averaging the twenty-five shapes for each observation), and the dot lines are the predicted shape output from the FunFor approach by fivefold cross-validation.</p></caption><graphic xlink:href="41598_2021_2265_Fig9_HTML" id="MO20"/></fig></p>
    <p id="Par46">The FunFor can predict the curve response for new observations by following the same tree building and ensemble process if the predictors of new observations are given. To visualize the prediction capability of FunFor approach, we divide our data into training and test sets by fivefold cross-validation. Figure <xref rid="Fig9" ref-type="fig">9</xref> demonstrates that the predicted shapes (dotted lines) and the observed shapes match with great consistency. Note that the observed shape is the one after averaging the twenty-five leaves for each observation, which is the <inline-formula id="IEq149"><alternatives><tex-math id="M317">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Y_{ik}$$\end{document}</tex-math><mml:math id="M318"><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi mathvariant="italic">ik</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41598_2021_2265_Article_IEq149.gif"/></alternatives></inline-formula> specified in the model (<xref rid="Equ1" ref-type="">1</xref>).</p>
  </sec>
  <sec id="Sec17">
    <title>Discussion</title>
    <p id="Par47">The FunFor approach extends the well-established traditional random forests approach from a univariate response to a functional curve response, while empowering the traditional functional data analysis approaches with more capabilities to cope with complex structures and nonlinear associations. Most important of all, the proposed FunFor approach has far-reaching applications due to its model-free and distribution-free nature. The real data analysis of this article was performed on a small dataset with a limited number of genetic markers because of the difficulty and cost of collecting the whole genome data for a natural population of trees. These markers did not provide full genome coverage or the concomitant ability to pinpoint specific loci that affect leaf shape traits. However, the proposed FunFor approach is ready to be applied to large datasets. It can be flexibly applied to various fields where the functional data is collected. For example, fMRI, EEG, drug sensitivity curves, climate change, growth curves, and risk prediction in population genetics are possible application directions.</p>
    <p id="Par48">In addition to its aforementioned advantages that are the focus of this article, we now comment on some of the limitations of the FunFor approach as future work directions. This article mainly focused on functional data that is collected at regular and dense time/location points. In future work, we will extend it to be feasible for longitudinal data, i.e., when the data is measured on an irregular grid with various time or location points in the response curve<sup><xref ref-type="bibr" rid="CR45">45</xref>–<xref ref-type="bibr" rid="CR47">47</xref></sup>. In addition, the FunFor approach adopted the most standard techniques in the forest building process. With the rapid advancement of the forest building process and machine learning skills for the univariate response, the FunFor approach can be improved accordingly in its splitting criteria, variable importance measures, p-values, theoretical inferences, etc.</p>
    <p id="Par49">Specifically, the splitting criterion proposed in Eq. (<xref rid="Equ5" ref-type="">5</xref>) works well in this article; however, alternative splitting criteria can also be tried in the FunFor approach. For example, the splitting function used to measure the within-node homogeneity, defined by <inline-formula id="IEq150"><alternatives><tex-math id="M319">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\phi _1(j,s,R)=RSS_f(R)-RSS_f(R_L(j,s))-RSS_f(R_R(j,s))$$\end{document}</tex-math><mml:math id="M320"><mml:mrow><mml:msub><mml:mi>ϕ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>R</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>R</mml:mi><mml:mi>S</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mi>f</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>R</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:mi>R</mml:mi><mml:mi>S</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mi>f</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:mi>R</mml:mi><mml:mi>S</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mi>f</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mi>R</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="41598_2021_2265_Article_IEq150.gif"/></alternatives></inline-formula><sup><xref ref-type="bibr" rid="CR22">22</xref></sup>, or the weighted variance splitting approach that enables a tree to recover from a bad split<sup><xref ref-type="bibr" rid="CR48">48</xref></sup>. The semi-metric proposed by Ferraty and vieu (2006) is an alternative option to replace the <inline-formula id="IEq151"><alternatives><tex-math id="M321">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L^2$$\end{document}</tex-math><mml:math id="M322"><mml:msup><mml:mi>L</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="41598_2021_2265_Article_IEq151.gif"/></alternatives></inline-formula>-metric when we define the proximities between two functional objects<sup><xref ref-type="bibr" rid="CR18">18</xref></sup>. In addition, the permutation variable importance measure that we proposed in Equation (<xref rid="Equ6" ref-type="">6</xref>) may inherit the shortcomings of the traditional random forest and hence yield biased variable selection results or may perturb individual predictors and cause predictions that extrapolate to areas of the predictor space with low density when predictors are dependent<sup><xref ref-type="bibr" rid="CR49">49</xref>,<xref ref-type="bibr" rid="CR50">50</xref></sup>. Therefore, we will consider incorporating the conditional variable importance measures into the FunFor framework. For example, the conditional predictive impact (CPI) proposed by Watson and Wright was theoretically proven to be a consistent and unbiased estimator<sup><xref ref-type="bibr" rid="CR51">51</xref></sup>; or the model-agnostic variants of the conditional PVIM performed subgroup permutation by constructing subgroups in which the predictor distribution within a group is more homogeneous and between the groups is more heterogeneous<sup><xref ref-type="bibr" rid="CR50">50</xref></sup>. See Degenhardt et al. for a comprehensive review of the several variable selection procedures that have been invented for the traditional random forests for the univariate response<sup><xref ref-type="bibr" rid="CR52">52</xref></sup>. Finally, hypothesis testing has also received great attention in the traditional random forest approach because there is a high need in obtaining p-values to assess the significance levels in biomedical applications. To obtain the p-value for each predictor from the FunFor approach, the nonparametric permutation skill is feasible if the number of predictors is small, as Chen et al. and Hapfelmeier and Ulm did for the traditional random forests approach<sup><xref ref-type="bibr" rid="CR53">53</xref>–<xref ref-type="bibr" rid="CR56">56</xref></sup>. If the number of predictors is large with sparse structures, we suggest incorporating the FunFor approach with heuristic variable importance test designed for high-dimensional data, which constructs the null distribution based on the non-positive importance scores corresponding to those predictors that are likely non-relevant to the response<sup><xref ref-type="bibr" rid="CR57">57</xref></sup>.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Information</title>
    <sec id="Sec18">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="41598_2021_2265_MOESM1_ESM.pdf">
            <caption>
              <p>Supplementary Information.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher's note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <sec>
    <title>Supplementary Information</title>
    <p>The online version contains supplementary material available at 10.1038/s41598-021-02265-4.</p>
  </sec>
  <ack>
    <title>Acknowledgements</title>
    <p>This work was supported by a grant from the National Science Foundation (DMS-1413366) to GF. We thank Dr. Rongling Wu’s group for designing, collecting, and providing the dataset. We thank Dr. David Renfrew, Grant Holyoak, David Collins, and Michael Bubniak for English language revisions. We are indebted to the editors and the seven anonymous reviewers whose substantial comments on the manuscript greatly improved the quality.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author contributions</title>
    <p>G.F. conceived the research. G.F. and X.D. developed the ideas. G.F. wrote the manuscript. X.D. wrote the programming code. X.D. and Y.L. performed the simulation and real data analysis.</p>
  </notes>
  <notes id="FPar1" notes-type="COI-statement">
    <title>Competing interests</title>
    <p id="Par51">The authors declare no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Müller</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Functional modelling and classification of longitudinal data</article-title>
        <source>Scand. J. Stat.</source>
        <year>2005</year>
        <volume>32</volume>
        <fpage>223</fpage>
        <lpage>240</lpage>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fu</surname>
            <given-names>G</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A proof of concept study of function-based statistical analysis of fnirs data: Syntax comprehension in children with specific language impairment compared to typically-developing controls</article-title>
        <source>Front. Behav. Neurosci.</source>
        <year>2016</year>
        <volume>10</volume>
        <fpage>108</fpage>
        <?supplied-pmid 27375448?>
        <pub-id pub-id-type="pmid">27375448</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rahman</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Dhruba</surname>
            <given-names>SR</given-names>
          </name>
          <name>
            <surname>Ghosh</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Pal</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Functional random forest with applications in dose-response predictions</article-title>
        <source>Sci. Rep.</source>
        <year>2019</year>
        <volume>9</volume>
        <fpage>1</fpage>
        <lpage>14</lpage>
        <pub-id pub-id-type="pmid">30626917</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nicotra</surname>
            <given-names>AB</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The evolution and functional significance of leaf shape in the angiosperms</article-title>
        <source>Funct. Plant Biol.</source>
        <year>2011</year>
        <volume>38</volume>
        <fpage>535</fpage>
        <lpage>552</lpage>
        <?supplied-pmid 32480907?>
        <pub-id pub-id-type="pmid">32480907</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chitwood</surname>
            <given-names>DH</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Leaf asymmetry as a developmental constraint imposed by auxin-dependent phyllotactic patterning</article-title>
        <source>Plant Cell</source>
        <year>2012</year>
        <volume>24</volume>
        <fpage>2318</fpage>
        <lpage>2327</lpage>
        <?supplied-pmid 22722959?>
        <pub-id pub-id-type="pmid">22722959</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Myers</surname>
            <given-names>EM</given-names>
          </name>
          <name>
            <surname>Janzen</surname>
            <given-names>FJ</given-names>
          </name>
          <name>
            <surname>Adams</surname>
            <given-names>DC</given-names>
          </name>
          <name>
            <surname>Tucker</surname>
            <given-names>JK</given-names>
          </name>
        </person-group>
        <article-title>Quantitative genetics of plastron shape in slider turtles (<italic>Trachemys scripta</italic>)</article-title>
        <source>Evolution</source>
        <year>2006</year>
        <volume>60</volume>
        <fpage>563</fpage>
        <lpage>572</lpage>
        <?supplied-pmid 16637501?>
        <pub-id pub-id-type="pmid">16637501</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Klingenberg</surname>
            <given-names>CP</given-names>
          </name>
        </person-group>
        <article-title>Evolution and development of shape: Integrating quantitative approaches</article-title>
        <source>Nat. Rev. Genet.</source>
        <year>2010</year>
        <volume>11</volume>
        <fpage>623</fpage>
        <lpage>635</lpage>
        <?supplied-pmid 20697423?>
        <pub-id pub-id-type="pmid">20697423</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fu</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Dai</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Symanzik</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Bushman</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Quantitative gene–gene and gene–environment mapping for leaf shape variation using tree-based models</article-title>
        <source>New Phytol.</source>
        <year>2017</year>
        <volume>213</volume>
        <fpage>455</fpage>
        <lpage>469</lpage>
        <?supplied-pmid 27650962?>
        <pub-id pub-id-type="pmid">27650962</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chitwood</surname>
            <given-names>DH</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A modern ampelography: A genetic basis for leaf shape and venation patterning in grape</article-title>
        <source>Plant Physiol.</source>
        <year>2014</year>
        <volume>164</volume>
        <fpage>259</fpage>
        <lpage>272</lpage>
        <?supplied-pmid 24285849?>
        <pub-id pub-id-type="pmid">24285849</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Manolio</surname>
            <given-names>TA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Finding the missing heritability of complex diseases</article-title>
        <source>Nature</source>
        <year>2009</year>
        <volume>461</volume>
        <fpage>747</fpage>
        <lpage>753</lpage>
        <?supplied-pmid 19812666?>
        <pub-id pub-id-type="pmid">19812666</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Lambert</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Fitting trees to functional data, with an application to time-of-day patterns</article-title>
        <source>J. Comput. Graph. Stat.</source>
        <year>1999</year>
        <volume>8</volume>
        <fpage>749</fpage>
        <lpage>762</lpage>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Barber</surname>
            <given-names>RF</given-names>
          </name>
          <name>
            <surname>Reimherr</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Schill</surname>
            <given-names>T</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The function-on-scalar lasso with applications to longitudinal gwas</article-title>
        <source>Electron. J. Stat.</source>
        <year>2017</year>
        <volume>11</volume>
        <fpage>1351</fpage>
        <lpage>1389</lpage>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Reiss</surname>
            <given-names>PT</given-names>
          </name>
          <name>
            <surname>Huang</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Mennes</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Fast function-on-scalar regression with penalized basis expansions</article-title>
        <source>Int. J. Biostat.</source>
        <year>2010</year>
        <volume>6</volume>
        <fpage>28</fpage>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Reimherr</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Nicolae</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A functional data analysis approach for genetic association studies</article-title>
        <source>Ann. Appl. Stat.</source>
        <year>2014</year>
        <volume>8</volume>
        <fpage>406</fpage>
        <lpage>429</lpage>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Goldsmith</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Kitago</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Assessing systematic effects of stroke on motor control by using hierarchical function-on-scalar regression</article-title>
        <source>J. R. Stat. Soc. Ser. C</source>
        <year>2016</year>
        <volume>65</volume>
        <fpage>215</fpage>
        <lpage>236</lpage>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Goldsmith</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Ogden</surname>
            <given-names>RT</given-names>
          </name>
        </person-group>
        <article-title>Variable selection in function-on-scalar regression</article-title>
        <source>Statistic</source>
        <year>2016</year>
        <volume>5</volume>
        <fpage>88</fpage>
        <lpage>101</lpage>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Ramsay</surname>
            <given-names>JO</given-names>
          </name>
          <name>
            <surname>Silverman</surname>
            <given-names>BW</given-names>
          </name>
        </person-group>
        <source>Functional Data Analysis</source>
        <year>2005</year>
        <edition>2</edition>
        <publisher-name>Springer</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Ferraty</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Vieu</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <source>Nonparametric Functional Data Analysis: Theory and Practice</source>
        <year>2006</year>
        <publisher-name>Springer</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Aguilera</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Acal</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Aguilera-Morillo</surname>
            <given-names>MC</given-names>
          </name>
          <name>
            <surname>Jiménez-Molinos</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Roldán</surname>
            <given-names>JB</given-names>
          </name>
        </person-group>
        <article-title>Homogeneity problem for basis expansion of functional data with applications to resistive memories</article-title>
        <source>Math. Comput. Simul.</source>
        <year>2021</year>
        <volume>186</volume>
        <fpage>41</fpage>
        <lpage>51</lpage>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <source>Analysis of Variance for Functional Data</source>
        <year>2014</year>
        <publisher-name>CRC Press</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>De’Ath</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Boosted trees for ecological modeling and prediction</article-title>
        <source>Ecology</source>
        <year>2007</year>
        <volume>88</volume>
        <fpage>243</fpage>
        <lpage>251</lpage>
        <?supplied-pmid 17489472?>
        <pub-id pub-id-type="pmid">17489472</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Segal</surname>
            <given-names>MR</given-names>
          </name>
        </person-group>
        <article-title>Tree-structured methods for longitudinal data</article-title>
        <source>J. Am. Stat. Assoc.</source>
        <year>1992</year>
        <volume>87</volume>
        <fpage>407</fpage>
        <lpage>418</lpage>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Singer</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <source>Recursive partitioning in the health sciences</source>
        <year>2013</year>
        <publisher-name>Springer</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Abdolell</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>LeBlanc</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Stephens</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Harrison</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Binary partitioning for continuous longitudinal data: Categorizing a prognostic variable</article-title>
        <source>Stat. Med.</source>
        <year>2002</year>
        <volume>21</volume>
        <fpage>3395</fpage>
        <lpage>3409</lpage>
        <?supplied-pmid 12407680?>
        <pub-id pub-id-type="pmid">12407680</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Loh</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Zheng</surname>
            <given-names>W</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Regression trees for longitudinal and multiresponse data</article-title>
        <source>Ann. Appl. Stat.</source>
        <year>2013</year>
        <volume>7</volume>
        <fpage>495</fpage>
        <lpage>522</lpage>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Möller</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Tutz</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Gertheiss</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Random forests for functional covariates</article-title>
        <source>J. Chemom.</source>
        <year>2016</year>
        <volume>30</volume>
        <fpage>715</fpage>
        <lpage>725</lpage>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <mixed-citation publication-type="other">Goldsmith, J. <italic>et al.</italic><italic>refund: Regression with Functional Data. R Package Version 0.1-23</italic> (2020).</mixed-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <mixed-citation publication-type="other">Neufeld, A. &amp; Heggeseth, B. <italic>splinetree: Longitudinal Regression Trees and Forests. R Package Version 0.2.0</italic> (2019).</mixed-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <mixed-citation publication-type="other">Scheipl, F. <italic>Cran Task View: Functional Data Analysis</italic> (2020).</mixed-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Müller</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Stadtmüller</surname>
            <given-names>U</given-names>
          </name>
        </person-group>
        <article-title>Generalized functional linear models</article-title>
        <source>Ann. Stat.</source>
        <year>2005</year>
        <volume>33</volume>
        <fpage>774</fpage>
        <lpage>805</lpage>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Müller</surname>
            <given-names>H-G</given-names>
          </name>
          <name>
            <surname>Yao</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>Functional additive models</article-title>
        <source>J. Am. Stat. Assoc.</source>
        <year>2008</year>
        <volume>103</volume>
        <fpage>1534</fpage>
        <lpage>1544</lpage>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Müller</surname>
            <given-names>H-G</given-names>
          </name>
          <name>
            <surname>Yao</surname>
            <given-names>F</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Empirical dynamics for longitudinal data</article-title>
        <source>Ann. Stat.</source>
        <year>2010</year>
        <volume>38</volume>
        <fpage>3458</fpage>
        <lpage>3486</lpage>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yao</surname>
            <given-names>F</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Shrinkage estimation for functional principal component scores with application to the population kinetics of plasma folate</article-title>
        <source>Biometrics</source>
        <year>2003</year>
        <volume>59</volume>
        <fpage>676</fpage>
        <lpage>685</lpage>
        <?supplied-pmid 14601769?>
        <pub-id pub-id-type="pmid">14601769</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Horváth</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Kokoszka</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <source>Inference for Functional Data with Applications</source>
        <year>2012</year>
        <publisher-name>Springer</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Xiao</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Ruppert</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Fast bivariate p-splines: The sandwich smoother</article-title>
        <source>J. R. Stat. Soc. B</source>
        <year>2013</year>
        <volume>75</volume>
        <fpage>577</fpage>
        <lpage>599</lpage>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <mixed-citation publication-type="other">Xiao, L., Zipunnikov, V., Ruppert, D. &amp; Crainiceanu, C. Fast covariance estimation for high-dimensional functional data. <italic>Statistics and Computing</italic>, 1–13 (2013).</mixed-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Breiman</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Friedman</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Stone</surname>
            <given-names>CJ</given-names>
          </name>
          <name>
            <surname>Olshen</surname>
            <given-names>RA</given-names>
          </name>
        </person-group>
        <source>Classification and Regression Trees</source>
        <year>1984</year>
        <publisher-name>CRC Press</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shang</surname>
            <given-names>HL</given-names>
          </name>
        </person-group>
        <article-title>Bayesian bandwidth estimation for a nonparametric functional regression model with unknown error density</article-title>
        <source>Comput. Stat. Data Anal.</source>
        <year>2013</year>
        <volume>67</volume>
        <fpage>185</fpage>
        <lpage>198</lpage>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Breiman</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>Random forests</article-title>
        <source>Mach. Learn.</source>
        <year>2001</year>
        <volume>45</volume>
        <fpage>5</fpage>
        <lpage>32</lpage>
      </element-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Hastie</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Tibshirani</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Friedman</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <source>The Elements of Statistical Learning: Data Mining, Inference, and Prediction</source>
        <year>2009</year>
        <publisher-name>Springer</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR41">
      <label>41.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Di</surname>
            <given-names>C-Z</given-names>
          </name>
          <name>
            <surname>Crainiceanu</surname>
            <given-names>CM</given-names>
          </name>
          <name>
            <surname>Caffo</surname>
            <given-names>BS</given-names>
          </name>
          <name>
            <surname>Punjabi</surname>
            <given-names>NM</given-names>
          </name>
        </person-group>
        <article-title>Multilevel functional principal component analysis</article-title>
        <source>Ann. Appl. Stat.</source>
        <year>2009</year>
        <volume>3</volume>
        <fpage>458</fpage>
        <?supplied-pmid 20221415?>
        <pub-id pub-id-type="pmid">20221415</pub-id>
      </element-citation>
    </ref>
    <ref id="CR42">
      <label>42.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Willmott</surname>
            <given-names>CJ</given-names>
          </name>
          <name>
            <surname>Matsuura</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>Advantages of the mean absolute error (MAE) over the root mean square error (RMSE) in assessing average model performance</article-title>
        <source>Clim. Res.</source>
        <year>2005</year>
        <volume>30</volume>
        <fpage>79</fpage>
        <lpage>82</lpage>
      </element-citation>
    </ref>
    <ref id="CR43">
      <label>43.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fu</surname>
            <given-names>G</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Mapping shape quantitative trait loci using a radius-centroid-contour model</article-title>
        <source>Heredity</source>
        <year>2013</year>
        <volume>110</volume>
        <fpage>511</fpage>
        <lpage>519</lpage>
        <?supplied-pmid 23572125?>
        <pub-id pub-id-type="pmid">23572125</pub-id>
      </element-citation>
    </ref>
    <ref id="CR44">
      <label>44.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kong</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Luo</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Zeng</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>MH</given-names>
          </name>
        </person-group>
        <article-title>A new shape descriptor based on centroid-radii model and wavelet transform</article-title>
        <source>Opt. Commun.</source>
        <year>2007</year>
        <volume>273</volume>
        <fpage>362</fpage>
        <lpage>366</lpage>
      </element-citation>
    </ref>
    <ref id="CR45">
      <label>45.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Eilers</surname>
            <given-names>PH</given-names>
          </name>
          <name>
            <surname>Marx</surname>
            <given-names>BD</given-names>
          </name>
        </person-group>
        <article-title>Splines, knots, and penalties</article-title>
        <source>Wiley Interdiscipl. Rev. Comput. Stat.</source>
        <year>2010</year>
        <volume>2</volume>
        <fpage>637</fpage>
        <lpage>653</lpage>
      </element-citation>
    </ref>
    <ref id="CR46">
      <label>46.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yao</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Müller</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Functional data analysis for sparse longitudinal data</article-title>
        <source>J. Am. Stat. Assoc.</source>
        <year>2005</year>
        <volume>100</volume>
        <fpage>577</fpage>
        <lpage>590</lpage>
      </element-citation>
    </ref>
    <ref id="CR47">
      <label>47.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Müller</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Yao</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <source>Regressing Longitudinal Response Trajectories on a Covariate. Frontiers in Statistics</source>
        <year>2006</year>
        <publisher-name>Festschrift for Peter Bickel Imperial College Press</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR48">
      <label>48.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ishwaran</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>The effect of splitting on random forests</article-title>
        <source>Mach. Learn.</source>
        <year>2015</year>
        <volume>99</volume>
        <fpage>75</fpage>
        <lpage>118</lpage>
        <?supplied-pmid 28919667?>
        <pub-id pub-id-type="pmid">28919667</pub-id>
      </element-citation>
    </ref>
    <ref id="CR49">
      <label>49.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Strobl</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Boulesteix</surname>
            <given-names>A-L</given-names>
          </name>
          <name>
            <surname>Kneib</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Augustin</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Zeileis</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Conditional variable importance for random forests</article-title>
        <source>BMC Bioinform.</source>
        <year>2008</year>
        <volume>9</volume>
        <fpage>1</fpage>
        <lpage>11</lpage>
      </element-citation>
    </ref>
    <ref id="CR50">
      <label>50.</label>
      <mixed-citation publication-type="other">Molnar, C., König, G., Bischl, B. &amp; Casalicchio, G. Model-agnostic feature importance and effects with dependent features—A conditional subgroup approach. Preprint at <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/2006.04628">http://arxiv.org/abs/2006.04628</ext-link> (2020).</mixed-citation>
    </ref>
    <ref id="CR51">
      <label>51.</label>
      <mixed-citation publication-type="other">Watson, D. S. &amp; Wright, M. N. Testing conditional independence in supervised learning algorithms. Preprint at <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/1901.09917">http://arxiv.org/abs/1901.09917</ext-link> (2019).</mixed-citation>
    </ref>
    <ref id="CR52">
      <label>52.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Degenhardt</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Seifert</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Szymczak</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Evaluation of variable selection methods for random forests and omics data sets</article-title>
        <source>Brief. Bioinform.</source>
        <year>2019</year>
        <volume>20</volume>
        <fpage>492</fpage>
        <lpage>503</lpage>
        <?supplied-pmid 29045534?>
        <pub-id pub-id-type="pmid">29045534</pub-id>
      </element-citation>
    </ref>
    <ref id="CR53">
      <label>53.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>C-T</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>A forest-based approach to identifying gene and gene–gene interactions</article-title>
        <source>Proc. Natl. Acad. Sci.</source>
        <year>2007</year>
        <volume>104</volume>
        <fpage>19199</fpage>
        <lpage>19203</lpage>
        <?supplied-pmid 18048322?>
        <pub-id pub-id-type="pmid">18048322</pub-id>
      </element-citation>
    </ref>
    <ref id="CR54">
      <label>54.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hapfelmeier</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Ulm</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>A new variable selection approach using random forests</article-title>
        <source>Comput. Stat. Data Anal.</source>
        <year>2013</year>
        <volume>60</volume>
        <fpage>50</fpage>
        <lpage>69</lpage>
      </element-citation>
    </ref>
    <ref id="CR55">
      <label>55.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ojala</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Garriga</surname>
            <given-names>GC</given-names>
          </name>
        </person-group>
        <article-title>Permutation tests for studying classifier performance</article-title>
        <source>J. Mach. Learn. Res.</source>
        <year>2010</year>
        <volume>11</volume>
        <fpage>1833</fpage>
      </element-citation>
    </ref>
    <ref id="CR56">
      <label>56.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Good</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <source>Permutation Tests: A Practical Guide to Resampling Methods for Testing Hypotheses</source>
        <year>2013</year>
        <publisher-name>Springer</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR57">
      <label>57.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Janitza</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Celik</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Boulesteix</surname>
            <given-names>A-L</given-names>
          </name>
        </person-group>
        <article-title>A computationally fast variable importance test for random forests for high-dimensional data</article-title>
        <source>Adv. Data Anal. Classif.</source>
        <year>2018</year>
        <volume>12</volume>
        <fpage>885</fpage>
        <lpage>915</lpage>
      </element-citation>
    </ref>
  </ref-list>
</back>
