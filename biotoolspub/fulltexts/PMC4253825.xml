<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20070202//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing.dtd?>
<?SourceDTD.Version 2.3?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-id journal-id-type="hwp">bioinfo</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">4253825</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btu436</article-id>
    <article-id pub-id-type="publisher-id">btu436</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Hitseq Papers</subject>
        <subj-group subj-group-type="heading">
          <subject>Genome Analysis</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Multi-factor data normalization enables the detection of copy number aberrations in amplicon sequencing data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Boeva</surname>
          <given-names>Valentina</given-names>
        </name>
        <xref ref-type="aff" rid="btu436-AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="btu436-AFF1">
          <sup>2</sup>
        </xref>
        <xref ref-type="aff" rid="btu436-AFF1">
          <sup>3</sup>
        </xref>
        <xref ref-type="corresp" rid="btu436-COR1">*</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Popova</surname>
          <given-names>Tatiana</given-names>
        </name>
        <xref ref-type="aff" rid="btu436-AFF1">
          <sup>2</sup>
        </xref>
        <xref ref-type="aff" rid="btu436-AFF1">
          <sup>4</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Lienard</surname>
          <given-names>Maxime</given-names>
        </name>
        <xref ref-type="aff" rid="btu436-AFF1">
          <sup>5</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Toffoli</surname>
          <given-names>Sebastien</given-names>
        </name>
        <xref ref-type="aff" rid="btu436-AFF1">
          <sup>5</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Kamal</surname>
          <given-names>Maud</given-names>
        </name>
        <xref ref-type="aff" rid="btu436-AFF1">
          <sup>6</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Le Tourneau</surname>
          <given-names>Christophe</given-names>
        </name>
        <xref ref-type="aff" rid="btu436-AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="btu436-AFF1">
          <sup>7</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Gentien</surname>
          <given-names>David</given-names>
        </name>
        <xref ref-type="aff" rid="btu436-AFF1">
          <sup>8</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Servant</surname>
          <given-names>Nicolas</given-names>
        </name>
        <xref ref-type="aff" rid="btu436-AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="btu436-AFF1">
          <sup>2</sup>
        </xref>
        <xref ref-type="aff" rid="btu436-AFF1">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Gestraud</surname>
          <given-names>Pierre</given-names>
        </name>
        <xref ref-type="aff" rid="btu436-AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="btu436-AFF1">
          <sup>2</sup>
        </xref>
        <xref ref-type="aff" rid="btu436-AFF1">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Rio Frio</surname>
          <given-names>Thomas</given-names>
        </name>
        <xref ref-type="aff" rid="btu436-AFF1">
          <sup>9</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Hupé</surname>
          <given-names>Philippe</given-names>
        </name>
        <xref ref-type="aff" rid="btu436-AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="btu436-AFF1">
          <sup>2</sup>
        </xref>
        <xref ref-type="aff" rid="btu436-AFF1">
          <sup>3</sup>
        </xref>
        <xref ref-type="aff" rid="btu436-AFF1">
          <sup>10</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Barillot</surname>
          <given-names>Emmanuel</given-names>
        </name>
        <xref ref-type="aff" rid="btu436-AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="btu436-AFF1">
          <sup>2</sup>
        </xref>
        <xref ref-type="aff" rid="btu436-AFF1">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Laes</surname>
          <given-names>Jean-François</given-names>
        </name>
        <xref ref-type="aff" rid="btu436-AFF1">
          <sup>11</sup>
        </xref>
      </contrib>
      <aff id="btu436-AFF1"><sup>1</sup>Inserm, U900, Bioinformatics, Biostatistics, Epidemiology and Computational Systems Biology of Cancer, <sup>2</sup>Institut Curie, Centre de Recherche, 26 rue d’Ulm, Paris 75248, <sup>3</sup>Mines ParisTech, Fontainebleau 77300, <sup>4</sup>Inserm, U830, Genetics and Biology of Cancers, Paris 75248, France, <sup>5</sup>Institut de Pathologie et de Génétique, Gosselies 6041, Belgium, <sup>6</sup>Clinical Research Department, <sup>7</sup>Department of Medical Oncology, <sup>8</sup>Plateforme de Génomique, Département de recherche translationnelle, Centre de recherche, <sup>9</sup>Next-generation sequencing platform, Institut Curie, <sup>10</sup>CNRS, UMR144, Subcellular Structure and cellular Dynamics, Paris 75248, France and <sup>11</sup>OncoDNA, Gosselies 6041, Belgium</aff>
    </contrib-group>
    <author-notes>
      <corresp id="btu436-COR1">*To whom correspondence should be addressed.</corresp>
      <fn id="FN1">
        <p>Associate Editor: Michael Brudno</p>
      </fn>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>15</day>
      <month>12</month>
      <year>2014</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>12</day>
      <month>7</month>
      <year>2014</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>12</day>
      <month>7</month>
      <year>2014</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the
							<pub-date pub-type="epub"/>. -->
    <volume>30</volume>
    <issue>24</issue>
    <fpage>3443</fpage>
    <lpage>3450</lpage>
    <history>
      <date date-type="received">
        <day>5</day>
        <month>3</month>
        <year>2014</year>
      </date>
      <date date-type="rev-recd">
        <day>17</day>
        <month>6</month>
        <year>2014</year>
      </date>
      <date date-type="accepted">
        <day>2</day>
        <month>7</month>
        <year>2014</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author 2014. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2014</copyright-year>
      <license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by/3.0/">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/3.0/">http://creativecommons.org/licenses/by/3.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <abstract>
      <p><bold>Motivation:</bold> Because of its low cost, amplicon sequencing, also known as ultra-deep targeted sequencing, is now becoming widely used in oncology for detection of actionable mutations, i.e. mutations influencing cell sensitivity to targeted therapies. Amplicon sequencing is based on the polymerase chain reaction amplification of the regions of interest, a process that considerably distorts the information on copy numbers initially present in the tumor DNA. Therefore, additional experiments such as single nucleotide polymorphism (SNP) or comparative genomic hybridization (CGH) arrays often complement amplicon sequencing in clinics to identify copy number status of genes whose amplification or deletion has direct consequences on the efficacy of a particular cancer treatment. So far, there has been no proven method to extract the information on gene copy number aberrations based solely on amplicon sequencing.</p>
      <p><bold>Results:</bold> Here we present ONCOCNV, a method that includes a multifactor normalization and annotation technique enabling the detection of large copy number changes from amplicon sequencing data. We validated our approach on high and low amplicon density datasets and demonstrated that ONCOCNV can achieve a precision comparable with that of array CGH techniques in detecting copy number aberrations. Thus, ONCOCNV applied on amplicon sequencing data would make the use of additional array CGH or SNP array experiments unnecessary.</p>
      <p>
        <bold>Availability and implementation:</bold>
        <ext-link ext-link-type="uri" xlink:href="http://oncocnv.curie.fr/">http://oncocnv.curie.fr/</ext-link>
      </p>
      <p>
        <bold>Contact:</bold>
        <email>valentina.boeva@curie.fr</email>
      </p>
      <p><bold>Supplementary information:</bold><ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu436/-/DC1">Supplementary data</ext-link> are available at <italic>Bioinformatics</italic> online.</p>
    </abstract>
    <counts>
      <page-count count="8"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 INTRODUCTION</title>
    <p>The emergence of the amplicon sequencing technique, which followed whole-exome sequencing (WES), promises a revolution in cancer diagnostics and treatment. Amplicon sequencing consists of the polymerase chain reaction (PCR) amplification of a limited number of the genomic regions of interest (amplicons) followed by high-throughput sequencing (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu436/-/DC1">Supplementary Fig. S1A</ext-link>) (<xref rid="btu436-B2" ref-type="bibr">Beadling <italic>et al.</italic>, 2013</xref>). Each amplicon often coincides with an exon; exons longer than the typical length of PCR reaction products may be covered by two or more amplicons (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu436/-/DC1">Supplementary Fig. S1B</ext-link>).</p>
    <p>Although relatively expensive exome sequencing consists of in-depth sequencing of nearly all the coding exons, the amplicon sequencing technique aims at sequencing a limited number of genes (from several dozen to several thousand exons) at an extremely low cost. The genes included in a panel of amplicon sequencing (actionable genes) are genes that are often altered in different cancer types, and for whose alterations targeted therapies have been established or are in clinical development. For instance, the TargetRich™ CRX kit from Kailos Genetics assays such cancer-related genes as <italic>BRAF</italic>, <italic>EGFR</italic>, <italic>FLT3</italic>, <italic>JAK2</italic>, <italic>KIT</italic>, <italic>KRAS</italic>, <italic>PIK3CA</italic>, <italic>PTEN</italic>, <italic>TP53</italic> and <italic>VEGFA</italic>; the AmpliSeq™ Cancer Panel from Life Technologies targets 190 regions of interest in 46 well-characterized oncogenes and tumor suppressors.</p>
    <p>Some actionable genes often undergo point mutation or exon deletions (e.g. <italic>ALK, BRAF</italic>), whereas others undergo amplification in copy number (e.g. <italic>MYCN</italic>, <italic>ERBB2</italic>) (<xref rid="btu436-B9" ref-type="bibr">Garraway and Lander, 2013</xref>; <xref rid="btu436-B18" ref-type="bibr">Small <italic>et al.</italic>, 1987</xref>). Because of the exceedingly high read coverage of amplicon sequencing data, there is no methodological issue in the identification of point mutations and small insertions or deletions (indels). However, how to reliably detect copy number changes, in particular gene deletions and amplifications, in amplicon sequencing data is still open to discussion.</p>
    <p>Here, we focus on the identification of copy number alterations (CNAs) also known as large copy number changes (CNVs) of the actionable genes targeted by amplicon sequencing. Although there are several algorithms to detect CNAs in exome sequencing data (<xref rid="btu436-B1" ref-type="bibr">Amarasinghe <italic>et al.</italic>, 2013</xref>; <xref rid="btu436-B4" ref-type="bibr">Boeva <italic>et al.</italic>, 2011</xref>; <xref rid="btu436-B12" ref-type="bibr">Li <italic>et al.</italic>, 2012</xref>), it is questionable as to whether the same approaches can be efficient when applied to amplicon sequencing data. First, amplicon sequencing targets fewer regions and thus provides less information than exome sequencing datasets (&lt;10 000 exons versus &gt;200 000 exons); consequently, data normalization can be less effective on amplicon sequencing data. Second, because of the different protocols used for library preparation, amplicon sequencing data can have various biases. Importantly, while for exome sequencing experiments an effort has been made to uniform exon coverage, amplicon sequencing technology emphasizes extremely high depth of coverage with less regard to coverage homogeneity.</p>
    <p>Here we provide a solution to the challenging question of extracting CNAs from amplicon sequencing data by (i) defining a method to normalize read coverage with a small set of normal control samples and (ii) assigning statistical significance to putative CNAs resulting from the segmentation of normalized profiles. We validated the proposed method on (A) a high amplicon density dataset of eight tumor samples for which array comparative genomic hybridization (array CGH) profiles were available, (B) a high amplicon density dataset of 30 ErbB2-positive ovarian cancer samples and (C) a low amplicon density dataset of 30 tumors, coupled with single nucleotide polymorphism (SNP) array data. We show that the results obtained from the ONCOCNV method compare favorably with the results obtained from ADTEx (<xref rid="btu436-B1" ref-type="bibr">Amarasinghe <italic>et al.</italic>, 2013</xref>) and NextGENe (<ext-link ext-link-type="uri" xlink:href="http://www.softgenetics.com/NextGENe_013.html">http://www.softgenetics.com/NextGENe_013.html</ext-link>), which are respectively public-domain and commercial software designed to detect CNVs in whole exome sequencing data.</p>
  </sec>
  <sec>
    <title>2 MATERIALS AND METHODS</title>
    <p>In this article, we present a method for detecting copy number changes in sequencing data generated for a relatively small panel of genes. We first apply several normalization steps: library-specific (normalization for library size, GC content and amplicon length) and technology-specific normalization (normalization with a control baseline); the next steps are segmentation and gene-aware correction of the predicted CNAs (<xref ref-type="fig" rid="btu436-F1">Fig. 1</xref>). The only requirement for the selection of diploid control samples is that they should be processed using the same target selection kit as the tumor samples.
<fig id="btu436-F1" position="float"><label>Fig. 1.</label><caption><p>Workflow of ONCOCNV. Control samples may be processed separately from tumor samples. As ONCOCNV performs normalization by GC content and amplicon length, it is not critical for the control samples to be sequenced jointly</p></caption><graphic xlink:href="btu436f1p"/></fig></p>
    <sec id="SEC2.1">
      <title>2.1 Datasets</title>
      <p>To validate our method, we used three experimental amplicon sequencing datasets: A, B and C. The high amplicon density tumor DNA for datasets A and B was subjected to amplicon sequencing with target selection using the Ion Xpress™ Plus Fragment Library Kit by Life Technologies (panel of 406 genes including &gt;6500 exons covered by &gt;15 000 amplicons). Dataset C is a part of the SHIVA clinical trial (<xref rid="btu436-B20" ref-type="bibr">Le Tourneau <italic>et al.</italic>, 2012</xref>). This dataset was generated using the Ion AmpliSeq™ Cancer Panel V1 in combination with the Ion AmpliSeq™ Library Kit 2.0 by Life Technologies; for our analysis, we used 11 genes covered by 96 amplicons. We used 15 diploid samples (high amplicon density, control dataset X) and 6 diploid samples (low amplicon density, control dataset Y) to create the baseline for the normalization of datasets A/B and C, respectively.</p>
      <p>In addition to amplicon sequencing, the tumor samples from dataset A were analyzed using an array CGH technique. Tumor samples from dataset C were processed with SNP arrays. The details of the processing of array CGH and SNP array data are provided in the <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu436/-/DC1">Supplementary Materials</ext-link>.</p>
    </sec>
    <sec id="SEC2.2">
      <title>2.2 Read counting</title>
      <p>In the analysis of high-throughput sequencing data, an appropriate definition of read counts (RCs) is of high importance. In whole-genome sequencing data, RC refers to the number of reads starting in a given window (<xref rid="btu436-B4" ref-type="bibr">Boeva <italic>et al.</italic>, 2011</xref>). In WES and RNA sequencing data analysis, RC corresponds to the number of read mappings overlapping each exon (<xref rid="btu436-B1" ref-type="bibr">Amarasinghe <italic>et al.</italic>, 2013</xref>). When dealing with amplicon sequencing data, one could apply a similar approach and reasoning in terms of exons. However, this may lead to a loss of information. In amplicon sequencing, one exon can be targeted using two or more closely located or overlapping amplicons; averaging this information will decrease the sensitivity of CNA detection. In ONCOCNV, we therefore implemented an intuitive procedure to calculate RCs: each read is assigned to only one amplicon region, the one with which the read alignment has the maximum overlap. In the case of highly overlapping amplicons, it can be unclear which amplicon generated the read. We therefore merge amplicons when two of them overlap each other by &gt;75% of their lengths.</p>
      <p>Given that the amplicon sequencing reads are single ended and sequencing depth is extremely high, we do not discard duplicate reads to avoid distorting the RC disproportionately (<xref rid="btu436-B22" ref-type="bibr">Zhou <italic>et al.</italic>, 2014</xref>).</p>
    </sec>
    <sec id="SEC2.3">
      <title>2.3 Normalization of RCs per target</title>
      <p>The RC processing method implemented in ONCOCNV includes normalization for library size, GC content of each amplicon region and amplicon length. We call these kinds of biases ‘library specific’. The exact shape of the functional dependency of the RC on the GC content and amplicon length may be different in each library (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu436/-/DC1">Supplementary Figs S2A, B</ext-link> and <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu436/-/DC1">S3A, B</ext-link>).</p>
      <sec id="SEC2.3.1">
        <title>2.3.1 Normalization with respect to library size</title>
        <p>The average number of reads from a library mapped to an amplicon is Avg = N/R, where N is the total number of reads and R is the total number of amplicons. We normalize the raw read count (RRC) by the library size: <inline-formula><mml:math id="I1"><mml:mrow><mml:mi>N</mml:mi><mml:mi>R</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>L</mml:mi><mml:mi>i</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>R</mml:mi><mml:mi>R</mml:mi><mml:mi>C</mml:mi><mml:mo>/</mml:mo><mml:mi>A</mml:mi><mml:mi>v</mml:mi><mml:mi>g</mml:mi></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="I2"><mml:mrow><mml:mi>N</mml:mi><mml:mi>R</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>L</mml:mi><mml:mi>i</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> stands for the RC normalized with library size. Under the assumption of comparable efficiency of PCR amplification for all regions targeted, the RRC values would be similar for different amplicons, and thus, the normalized read count (NRC) values would typically be close to 1 (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu436/-/DC1">Supplementary Fig. S4</ext-link>).</p>
      </sec>
      <sec id="SEC2.3.2">
        <title>2.3.2 Normalization with respect to CG-content</title>
        <p>For target sequencing data, as for whole-genome sequencing data (<xref rid="btu436-B4" ref-type="bibr">Boeva <italic>et al.</italic>, 2011</xref>), we observe a significant GC-content bias (<xref ref-type="fig" rid="btu436-F2">Fig. 2</xref>A and <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu436/-/DC1">Supplementary Fig. S2A</ext-link>). The shape of the GC-content dependency may vary even between datasets generated within the same laboratory (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu436/-/DC1">Supplementary Fig. S2B</ext-link>). We correct for the GC-content bias by using local polynomial regression fitting [LOESS (<xref rid="btu436-B6" ref-type="bibr">Cleveland <italic>et al.</italic>, 1992</xref>), R package stats, degree = 2]. The resulting values <inline-formula><mml:math id="I3"><mml:mrow><mml:mi>N</mml:mi><mml:mi>R</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>G</mml:mi><mml:mi>C</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> do not depend on the GC content of the amplicon sequences (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu436/-/DC1">Supplementary Fig. S2C</ext-link>).
<fig id="btu436-F2" position="float"><label>Fig. 2.</label><caption><p>Normalization of RC data improves correlation with array CGH measurements. (<bold>A</bold>) GC-content bias. The <italic>y</italic>-axis shows the RC normalized with respect to library size (Sample X1). (<bold>B</bold>) Amplicon length bias. The <italic>y</italic>-axis shows the RC normalized with respect to GC-content and library size (Sample X10). (<bold>C</bold>) Correlation between RRCs and log-ratio values of array CGH (Sample A1). (<bold>D</bold>) Correlation between NRCs and log-ratio values of array CGH (Sample A1). In (C) and (D), mean value per gene is shown</p></caption><graphic xlink:href="btu436f2p"/></fig></p>
      </sec>
      <sec id="SEC2.3.3">
        <title>2.3.3 Normalization with respect to target length</title>
        <p>We observed that smaller amplicons usually generate more RCs than larger ones, probably owing to more efficient PCR amplification for smaller DNA fragments (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu436/-/DC1">Supplementary Fig. S2B</ext-link> and <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu436/-/DC1">S3A</ext-link>). Similar to the GC content, this bias can be more or less pronounced in different samples (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu436/-/DC1">Supplementary Fig. S3B</ext-link>). We correct for the amplicon length bias by using the same technique as for the GC-content correction, i.e. LOESS (<xref rid="btu436-B6" ref-type="bibr">Cleveland <italic>et al.</italic>, 1992</xref>). The resulting values <inline-formula><mml:math id="I4"><mml:mrow><mml:mi>N</mml:mi><mml:mi>R</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>L</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> do not depend on the GC content (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu436/-/DC1">Supplementary Fig. S3C</ext-link>) or on the length (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu436/-/DC1">Supplementary Fig. S3D</ext-link>) of the amplicon sequence.</p>
      </sec>
    </sec>
    <sec id="SEC2.4">
      <title>2.4 Establishment of baseline</title>
      <p>In addition to the library-specific bias, there is a technology-specific bias. This bias, even after normalization for the library-specific bias, is present to a different extent in the RCs (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu436/-/DC1">Supplementary Fig. S5A</ext-link> and <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu436/-/DC1">B</ext-link>). Therefore, for each technological platform, we construct a baseline that reflects the technological bias in the diploid control samples and use it for the normalization of test samples.</p>
      <p>To construct the baseline, we apply principal component analysis (PCA) to the NRCs <inline-formula><mml:math id="I5"><mml:mrow><mml:mi>N</mml:mi><mml:mi>R</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>L</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> from the diploid samples. The first principal component (PC1) captures the most variation in <italic>NRC<sub>Len</sub></italic> and highly correlates with the average value of <italic>NRC<sub>Len</sub></italic> over the control samples (Pearson correlation 0.99, <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu436/-/DC1">Supplementary Fig. S6</ext-link>). We observed that it was important to keep the second and third PCs, as they capture additional biases (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu436/-/DC1">Supplementary Fig. S5C</ext-link>). In our example (datasets A and B), the first three components account for 90.5% of the total variance in the NRCs of the diploid control samples, whereas the first component explains only 79% of the variance (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu436/-/DC1">Supplementary Fig. S6A</ext-link>). Thus, by default, we keep the first three PCs as baseline. This parameter may, however, be changed by the user after examination of the explained variance in the output of ONCOCNV. Also, if the number of control samples (<italic>n</italic>) is less than four, only (<italic>n </italic><italic>−</italic> 1) PCs will be kept. At least two control samples are necessary to run ONCOCNV. When several tumor/matched normal datasets are present, the baseline should be created using all the control samples available.</p>
      <p>For the final normalization of the sample RCs, we use a linear regression over the baseline. The resulting profile, <italic>NRC<sub>Final</sub></italic>, shows lower variance than <italic>NRC<sub>Len</sub></italic> and no directional bias (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu436/-/DC1">Supplementary Fig. S5D</ext-link>).</p>
      <p>It should be noted that independent component analysis (ICA) could seem more appropriate than PCA to deal with the technology-specific bias. Each independent component could represent an independent source of noise in the experiment. The use of ICA instead of PCA will not, however, lead to different results in normalization based on the regression over the first components, as the first independent components are linear combinations of the first PCs (<xref rid="btu436-B11" ref-type="bibr">Hyvärinen and Oja, 2000</xref>).</p>
    </sec>
    <sec id="SEC2.5">
      <title>2.5 Correction of control sample RCs for gender</title>
      <p>A control dataset is often generated from a mixture of male and female samples. To correct the RCs in the control samples for gender, we apply the following strategy. After the first normalization step (normalization with respect to library size), we calculate <inline-formula><mml:math id="I6"><mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>m</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mi>R</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>L</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mspace width="0.2em"/><mml:mtext>
</mml:mtext><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:mspace width="0.2em"/><mml:mtext>
</mml:mtext><mml:mi>c</mml:mi><mml:mi>h</mml:mi><mml:mi>r</mml:mi><mml:mi>X</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>/</mml:mo><mml:mi>m</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mi>R</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>L</mml:mi><mml:mi>i</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> for each control sample <italic>i</italic>. Then we choose the optimal model with one or two components for <italic>M<sub>i</sub></italic>, according to the Bayesian information criterion for expectation–maximization initialized by hierarchical clustering for parameterized Gaussian mixture models (<xref rid="btu436-B8" ref-type="bibr">Fraley and Raftery, 2002</xref>). If the best model includes two components, we can conclude that our dataset represents a mixture of male and female samples: samples falling in a cluster with smaller <italic>M<sub>i</sub></italic> are male and samples falling in a cluster with higher <italic>M<sub>i</sub></italic> are female. If the best model contains only one cluster, we can conclude that all samples have the same gender and we assign male gender to them if the <italic>M</italic> value for all samples is &lt;0.9. For all control samples annotated as male, we multiply the RCs on chrX by two to make them comparable with female control samples.</p>
    </sec>
    <sec id="SEC2.6">
      <title>2.6 Assessment of standard deviation for NRCs</title>
      <p>Although we know how to normalize sample RCs, we do not know which deviation from zero level should be called significant to call a copy number change. To solve this issue, we need to evaluate the standard deviation of <italic>NRC<sub>final</sub></italic> for each amplicon region. We notice that different amplicon regions tend to have different standard deviations (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu436/-/DC1">Supplementary Fig. S7A</ext-link>). Generally, the higher the NRC (i.e. PC1), the lower the variance (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu436/-/DC1">Supplementary Fig. S7B</ext-link>). Further, we assume that <italic>NRC<sub>final</sub></italic> follows a normal distribution, with the mean value depending on the copy number status (<inline-formula><mml:math id="I7"><mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> in the case of copy number neutral), and the standard deviation depending on the first PC of our baseline (<inline-formula><mml:math id="I8"><mml:mrow><mml:mi>σ</mml:mi><mml:mo>=</mml:mo><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>P</mml:mi><mml:mi>C</mml:mi><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>) (<xref rid="btu436-B12" ref-type="bibr">Li <italic>et al.</italic>, 2012</xref>). To model <inline-formula><mml:math id="I9"><mml:mrow><mml:mi>σ</mml:mi><mml:mo>=</mml:mo><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>P</mml:mi><mml:mi>C</mml:mi><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, we use all control samples. However, the overall variance can be higher in some samples than in others (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu436/-/DC1">Supplementary Fig. S7</ext-link>). Thus, before the evaluation of <inline-formula><mml:math id="I10"><mml:mrow><mml:mi>σ</mml:mi><mml:mo>=</mml:mo><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>P</mml:mi><mml:mi>C</mml:mi><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, we rescale the control samples so that they have the same overall variance of 1. We model function <inline-formula><mml:math id="I11"><mml:mrow><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>P</mml:mi><mml:mi>C</mml:mi><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> using LOESS (degree = 2) (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu436/-/DC1">Supplementary Fig. S8</ext-link>) (<xref rid="btu436-B6" ref-type="bibr">Cleveland <italic>et al.</italic>, 1992</xref>). At the end of this step, each amplicon <italic>i</italic> is assigned standard deviation <inline-formula><mml:math id="I12"><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, which shows how the NRC for this amplicon varies in comparison with NRCs of other amplicon regions.</p>
    </sec>
    <sec id="SEC2.7">
      <title>2.7 Processing of tumor sample RCs</title>
      <p>Logarithmic values of the tumor sample RCs are normalized by library size, GC content and amplicon length. For further analysis, we keep residuals of the linear regression of the tumor NRCs over the baseline calculated for the control samples.</p>
      <p>The resulting profiles are segmented using the circular binary segmentation (CBS) method [R packages PSCBS and DNAcopy (<xref rid="btu436-B13" ref-type="bibr">Olshen <italic>et al.</italic>, 2004</xref>; <xref rid="btu436-B21" ref-type="bibr">Venkatraman and Olshen, 2007</xref>)]. To avoid breakpoints at outlier values, for each amplicon <italic>i</italic>, we give the segmentation algorithm weightings <italic>w</italic>, which are inversely proportional to the variances <inline-formula><mml:math id="I15"><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></inline-formula>. Generally, all NRC values within a segment resulting from the CBS correspond to a particular copy number status.</p>
      <p>To annotate a segment as a gain, loss or neutral copy number, we define a segmentation and clustering approach. This is based on the idea that the mean values of NRCs of segments (segment mean values) should roughly correspond to integer copy number changes (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu436/-/DC1">Supplementary Fig. S9</ext-link>). In other words, the segment mean values corresponding to the same number of copies should cluster together. A similar approach was used by <xref rid="btu436-B10" ref-type="bibr">Gusnanto <italic>et al.</italic> (2012)</xref> to detect CNAs in whole-genome sequencing data.</p>
      <p>Using R package mclust (<xref rid="btu436-B7" ref-type="bibr">Fraley <italic>et al.</italic>, 2012</xref>), we cluster weighted means of segment log ratio values. To prevent clustering errors, we add Gaussian noise to the data (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu436/-/DC1">Supplementary Fig. S9B</ext-link> and <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu436/-/DC1">C</ext-link>). For each segment, the standard deviation of the added random variable is equal to the standard error of the mean, and thus depends on the length of the segment. Our approach is nearly identical to the classic non-parametric density estimation using the Parzen window method (<xref rid="btu436-B14" ref-type="bibr">Parzen, 1962</xref>). Here, to be able to apply the existing clustering tool mclust, we perform sampling from normal distribution instead of kernel density smoothing.</p>
      <p>We select the level with the maximum density to be the neutral copy number level (zero level in <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu436/-/DC1">Supplementary Fig. S9C</ext-link>). We center the ratio values on the zero level. All segments with mean values clustered with zero are further considered copy neutral. We evaluate the overall standard deviation <inline-formula><mml:math id="I16"><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow/><mml:mrow><mml:mi>s</mml:mi><mml:mi>a</mml:mi><mml:mi>m</mml:mi><mml:mi>p</mml:mi><mml:mi>l</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> of the sample using the copy-neutral regions. We rescale the standard deviation <inline-formula><mml:math id="I17"><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>a</mml:mi><mml:mi>m</mml:mi><mml:mi>p</mml:mi><mml:mi>l</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>a</mml:mi><mml:mi>m</mml:mi><mml:mi>p</mml:mi><mml:mi>l</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:msup><mml:mo>∗</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="I18"><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>a</mml:mi><mml:mi>m</mml:mi><mml:mi>p</mml:mi><mml:mi>l</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> is the standard variation for amplicon <italic>i</italic> in a given tumor sample.</p>
    </sec>
    <sec id="SEC2.8">
      <title>2.8 Statistical validation of candidate CNAs</title>
      <p>For each segment annotated as a putative CNA at the previous step, we perform two tests to ensure that the observed deviation from the normal cannot be because of mere chance. We calculate the <italic>P</italic>-values of the fixed variance test and the <italic>t</italic>-test under the null hypothesis that <inline-formula><mml:math id="I20"><mml:mrow><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo mathsize="12pt">(</mml:mo><mml:mrow><mml:mi>N</mml:mi><mml:mi>R</mml:mi><mml:msubsup><mml:mi>C</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msubsup></mml:mrow><mml:mo mathsize="12pt">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> are generated by a normal distribution with mean value zero and standard deviation <inline-formula><mml:math id="I21"><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>a</mml:mi><mml:mi>m</mml:mi><mml:mi>p</mml:mi><mml:mi>l</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula>.</p>
      <sec id="SEC2.8.1">
        <title>2.8.1 Fixed variance test</title>
        <p>If, for a copy-neutral amplicon <italic>i</italic> values, 
<disp-formula><mml:math id="UM1"><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mi>N</mml:mi><mml:mi>R</mml:mi><mml:msubsup><mml:mi>C</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msubsup></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo>/</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>a</mml:mi><mml:mi>m</mml:mi><mml:mi>p</mml:mi><mml:mi>l</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math></disp-formula>
follows a normal distribution <inline-formula><mml:math id="I23"><mml:mrow><mml:mi>N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, then the arithmetic mean of a sample <inline-formula><mml:math id="I24"><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>∼</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is also normally distributed: <inline-formula><mml:math id="I25"><mml:mrow><mml:mover accent="true"><mml:mi>X</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mo>∼</mml:mo><mml:mi>N</mml:mi><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mfrac bevelled="true"><mml:mn>1</mml:mn><mml:mi>n</mml:mi></mml:mfrac><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>. To test the significance of a deviation from neutrality for a consecutive set of target regions <inline-formula><mml:math id="I26"><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math></inline-formula>, we use the following statistics formula:
<disp-formula><mml:math id="UM2"><mml:mrow><mml:mi>a</mml:mi><mml:mi>b</mml:mi><mml:mi>s</mml:mi><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mstyle displaystyle="true"><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mi>N</mml:mi><mml:mi>R</mml:mi><mml:msubsup><mml:mi>C</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msubsup></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo>/</mml:mo></mml:mrow></mml:mstyle><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>a</mml:mi><mml:mi>m</mml:mi><mml:mi>p</mml:mi><mml:mi>l</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo>/</mml:mo><mml:mi>n</mml:mi></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
which should follow half-normal distribution with <inline-formula><mml:math id="I27"><mml:mrow><mml:mi>θ</mml:mi><mml:mo>=</mml:mo><mml:msqrt><mml:mrow><mml:mi>π</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msqrt><mml:mo>/</mml:mo><mml:msqrt><mml:mn>2</mml:mn></mml:msqrt></mml:mrow></mml:math></inline-formula>.</p>
      </sec>
      <sec id="SEC2.8.2">
        <title>2.8.2 T-test</title>
        <p>Under the hypothesis that target regions <inline-formula><mml:math id="I28"><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math></inline-formula> are copy-neutral random variables, <inline-formula><mml:math id="I29"><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> are normally distributed with expectation 0. Thus, we can apply a <italic>t</italic>-test to test the hypothesis about the mean value of <inline-formula><mml:math id="I30"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mo stretchy="true">{</mml:mo><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="true">}</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>. It should be noted that, as the standard deviation is not fixed but evaluated via the sample standard deviation, the <italic>t</italic>-test usually produces higher <italic>P</italic>-values than the fixed variance test.</p>
      </sec>
      <sec id="SEC2.8.3">
        <title>2.8.3 Filtering of candidate CNAs</title>
        <p>We keep only those candidate CNAs for which the fixed variance test and <italic>t</italic>-test <italic>P</italic>-values are &lt;0.01. This allows us to be extremely stringent in filtering false-positive CNAs (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu436/-/DC1">Supplementary Fig. S10</ext-link>).</p>
        <p>Contamination by normal cells, tumor hyper-ploidy and presence of subclones deteriorates the copy number ratios and impede the accuracy of CNA detection. Unfortunately, it is impossible to get reliable information about these factors from amplicon sequencing data. Thus, we imposed a detection threshold on the number of cells with a given CNA. The expected NRC value in a region of a gain or loss of <italic>l</italic> copies can be calculated as <inline-formula><mml:math id="I31"><mml:mrow><mml:mi>E</mml:mi><mml:mi>x</mml:mi><mml:mi>p</mml:mi><mml:mi>e</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mi>d</mml:mi><mml:mi>N</mml:mi><mml:mi>R</mml:mi><mml:mi>C</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>·</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>c</mml:mi><mml:mo>·</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>±</mml:mo><mml:mi>l</mml:mi><mml:mo>/</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, where <italic>c</italic> is the fraction of all cells in the sample containing the CNA and <italic>P</italic> is the tumor ploidy. The higher the tumor ploidy and contamination by normal cells and the lower the fraction of tumor cells containing each CNA, the closer the expected NRC will be to 1, and the more difficult it will be to discriminate between true and false calls (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu436/-/DC1">Supplementary Fig. S11A</ext-link>). To avoid false-positive predictions, ONCOCNV filters out all candidate CNAs whose weighted geometric mean of NRCs varies within the range (0.875 to 1.125). This filter is likely to remove all CNAs present in fewer than 25, 33 and 50% of cells in diploid, triploid and tetraploid tumors, respectively (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu436/-/DC1">Supplementary Fig. S11B</ext-link>).</p>
      </sec>
    </sec>
    <sec id="SEC2.9">
      <title>2.9 Detection of one-point copy number changes</title>
      <p>Our method does not focus on the identification of one-point copy number changes (gain or loss of one exon/amplicon region). Nevertheless, we provide a functionality to output <italic>P</italic>-values and outlier statuses for each target region <italic>i</italic> based on a normal distribution <inline-formula><mml:math id="I32"><mml:mrow><mml:mi>N</mml:mi><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mi>w</mml:mi><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>e</mml:mi><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>o</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> of ratio values, where <inline-formula><mml:math id="I33"><mml:mrow><mml:mi>w</mml:mi><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>e</mml:mi><mml:mi>g</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is the weighted mean of the large segment including <italic>i</italic>, and <inline-formula><mml:math id="I35"><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>o</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> is the evaluated standard deviation. Similar to CONTRA (<xref rid="btu436-B12" ref-type="bibr">Li <italic>et al.</italic>, 2012</xref>), we adjust these <italic>P</italic>-values for multiple testing using the Benjamini and Hochberg correction (<xref rid="btu436-B3" ref-type="bibr">Benjamini and Hochberg, 1995</xref>).</p>
    </sec>
    <sec id="SEC2.10">
      <title>2.10 Readjustment of segmentation with a gene-aware model</title>
      <p>The segmentation procedure described above is performed in a gene-unaware way. Although segmentation usually places a breakpoint between two genes, in some cases, the breakpoint is positioned within a gene (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu436/-/DC1">Supplementary Fig. S12</ext-link>). In this case, there are two possible scenarios: (i) the chromosomal break occurs within the gene or (ii) because of noise, the predicted breakpoint was mis-positioned several probes left or right of the real breakpoint. We developed a readjustment strategy to account for the second scenario. When a breakpoint falls within the gene and breaks it into several (usually two) segments, we test whether the mean value of one of the segments could explain all the observed log(NRC) values of the gene (<italic>t</italic>-test). A gene with more amplicon regions is more likely to be correctly annotated with respect to the copy number status than a gene with fewer amplicon regions.</p>
    </sec>
  </sec>
  <sec>
    <title>3 RESULTS</title>
    <sec id="SEC3.1">
      <title>3.1 Comparison with WES-specific methods: NextGENe and ADTEx</title>
      <p>We decided to compare our CNA calling method in ultra-deep targeted sequencing data with two WES-specific tools: ADTEx (<xref rid="btu436-B1" ref-type="bibr">Amarasinghe <italic>et al.</italic>, 2013</xref>), a method based on hidden Markov models (HMMs) for CNA calling in targeted (exome) sequencing data, and NextGENe, commercial software designed by SoftGenetics. Although both ADTEx and NextGENe were tested on WES data only, conceptually there is no reason why these methods should not be applied to a smaller panel of targeted genes (∼400 in our case). We applied ONCOCNV, ADTEx and NextGENe to a high amplicon depth sequencing dataset of eight tumor samples. The array CGHs performed for these samples showed different CNA complexity levels (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu436/-/DC1">Supplementary Fig. S13</ext-link>). Although we also compared our method with CONTRA (<xref rid="btu436-B12" ref-type="bibr">Li <italic>et al.</italic>, 2012</xref>)—a method to detect one-exon copy number changes as well as large CNAs in targeted sequencing data—we do not report the results of this comparison in this article as, in our data, CONTRA identified &lt;10% of the true CNAs (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu436/-/DC1">Supplementary Fig. S14</ext-link>).</p>
      <p>Until now, ADTEx has not allowed the creation of a baseline using several control files. We therefore applied two possible strategies: (i) we selected 1 of 15 control samples and used it as a matched normal control and (ii) we merged the 13 control samples in 1.AM file and used it a matched control. In the ADTEx manual, it is advised to discard duplicate reads before running the analysis. In our case, duplicate reads constitute ∼95% of all reads (because of the high depth of coverage of our data). We therefore applied two independent strategies to call CNAs with ADTEx: with and without duplicate filtering.</p>
      <p>For the four output files (single and merged controls; with and without duplicates), we checked the correlation between the NRCs and log ratio values calculated during CGH experiments. The correlation values were similar for all four types of output file (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu436/-/DC1">Supplementary Table S1</ext-link>). Following recommendations from the authors of the ADTEx manual, we decided to use the ADTEx analysis based on one control sample including duplicate filtering (single control, no duplicates) for further comparison.</p>
      <sec id="SEC3.1.1">
        <title>3.1.1 Comparison of normalization results</title>
        <p>The values resulting from the ONCOCNV normalization procedure correlate highly with the log ratio values of the array CGH experiments performed on the same samples (<xref ref-type="fig" rid="btu436-F2">Figs 2</xref>C, D and <xref ref-type="fig" rid="btu436-F3">3</xref>A, <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu436/-/DC1">Supplementary Table S1</ext-link>). The correlation was higher for ONCOCNV NRCs than for RCs normalized by ADTEx and NextGENe. For example, for sample A1, the linear correlation between CGH log ratio values and ONCOCNV NRCs was 0.83, compared with 0.65 and 0.62 for ADTEx and NextGENe, respectively (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu436/-/DC1">Supplementary Fig. S15</ext-link>). This demonstrates that the normalization procedure used in ONCOCNV has clear advantages over those used in CNA calling methods developed for exome sequencing data analysis.
<fig id="btu436-F3" position="float"><label>Fig. 3.</label><caption><p> Comparison of RC normalization and accuracy of CNV calls achieved by ONCOCNV, ADTEx and NextGENe for samples from dataset A. (<bold>A</bold>) Correlation between NRCs and log ratio values of array CGH. (<bold>B</bold>) Prediction accuracy. Accuracy = (#True predictions)/(#All predictions), where each prediction corresponds to a gene copy number status (gain, neutral or loss). (<bold>C</bold>) True-positive rate. (<bold>D</bold>) False-positive rate</p></caption><graphic xlink:href="btu436f3p"/></fig></p>
        <p>We confirmed that correction for the GC content plays a key role in amplicon data normalization (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu436/-/DC1">Supplementary Fig. S16</ext-link>). Correction for the technology-specific bias using the first PCs of PCA is also important to decrease the variance and correct for outliers in NRCs (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu436/-/DC1">Supplementary Figs S5</ext-link> and <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu436/-/DC1">S16C, D, G</ext-link> and <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu436/-/DC1">H</ext-link>).</p>
      </sec>
      <sec id="SEC3.1.2">
        <title>3.1.2 Comparison of prediction accuracies</title>
        <p>For all samples, ONCOCNV achieved much higher prediction accuracy than the other two tools (<xref ref-type="fig" rid="btu436-F3">Figs 3</xref>B–D and 4 and <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu436/-/DC1">Supplementary Table S2</ext-link>). Here, accuracy measures the proportion of genes with correctly annotated copy number status: neutral, gain or loss. The overall prediction accuracy varied from 0.74 to 0.99 for ONCOCNV, while it was significantly lower for the other two tools: 0.56–0.92 for ADTEx and 0.44–0.85 for NextGENe (<xref ref-type="fig" rid="btu436-F3">Fig. 3</xref>B). For all methods, samples with a high number of genomic rearrangements were more challenging to analyze correctly than samples with less complex profiles (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu436/-/DC1">Supplementary Figs S17</ext-link> and <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu436/-/DC1">S18</ext-link>).</p>
      </sec>
    </sec>
    <sec id="SEC3.2">
      <title>3.2 Validation on 30 ErbB2-positive tumor samples</title>
      <p>To validate our method further, we applied ONCOCNV to analyze amplicon sequencing data generated for 30 ErbB2-positive ovarian cancer samples. The copy number status of the <italic>ErbB2</italic> gene was assessed via fluorescence <italic>in situ</italic> hybridization using FFPE tissue sections. The gene <italic>ErbB2</italic> (also known as <italic>HER2</italic>) encodes a receptor tyrosine kinase whose activation plays an important role in cell survival and drives cell proliferation (<xref rid="btu436-B19" ref-type="bibr">Tai <italic>et al.</italic>, 2010</xref>). <italic>ErbB2</italic> is frequently overexpressed in breast, gastric, ovarian and prostate cancer. <italic>ErbB2</italic> overexpression most often occurs because of a gene amplification (<xref rid="btu436-B15" ref-type="bibr">Pauletti <italic>et al.</italic>, 1996</xref>). Several drug compounds are used in clinics to block ErbB2 signaling in the case of overexpression of <italic>ErbB2</italic>. Thus, a personalized treatment is available for patients with amplification of the <italic>ErbB2</italic> gene (approved in clinical practice for breast and gastric cancer patients).</p>
      <p>In 29 of the 30 ErbB2-positive samples, ONCOCNV predicted a gain in the genomic region containing the <italic>ErbB2</italic> gene (<xref ref-type="fig" rid="btu436-F5">Fig. 5</xref>). Twenty-eight samples carry more than one additional copy of <italic>ErbB2</italic> (orange points in <xref ref-type="fig" rid="btu436-F5">Fig. 5</xref>). The high true-positive rate (&gt;96%) demonstrates the validity of our approach for the detection of amplification of actionable genes.</p>
      <p>Intriguingly, in 1 sample of the 30, ONCOCNV did not detect any gain on chromosome 17 containing the <italic>ErbB2</italic> gene (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu436/-/DC1">Supplementary Fig. S19</ext-link>). The high quality of the corresponding NRC profile suggests to us that the duplication of ErbB2 may have happened in a subclonal population of cells that, for some reason, was not present in the tissue section subjected to amplicon sequencing. Unfortunately, no more of this sample was available and no further investigation was possible.</p>
    </sec>
    <sec id="SEC3.3">
      <title>3.3 Validation on the SHIVA clinical trial dataset</title>
      <p>We applied ONCOCNV to a low amplicon density dataset of tumors sequenced in the SHIVA clinical trial (<xref rid="btu436-B20" ref-type="bibr">Le Tourneau <italic>et al.</italic>, 2012</xref>). The data corresponded to a targeted sequencing of 190 amplicons covering the exons of 46 actionable genes. The number of amplicons varied from 1 to 17 per gene. As our algorithm was designed to deal with data containing multiple amplicon regions per gene, for our analysis, we kept 11 genes. Each of them contained at least seven amplicon regions. The 11 genes selected were located on 10 different chromosomes. In the SHIVA trial, a dual approach is used: amplicon sequencing is used to detect single nucleotide variants and indels, whereas SNP arrays provide information about the copy number status of the genes and contamination by normal cells. We wanted to test whether amplicon sequencing-based detection of CNAs could replace currently used SNP arrays.</p>
      <p>As when using only 11 genes, it is often impossible to assess the correct zero level, we considered relative gains and losses in the calculation of CNA prediction accuracy (see Discussion). For example, if the SNP array technique detected a one copy loss of the first five genes whereas ONCOCNV predicted a one copy gain of the last six genes, we considered that the latter prediction was correct (the absolute prediction accuracy is shown in <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu436/-/DC1">Supplementary Fig. S20</ext-link>).
<fig id="btu436-F4" position="float"><label>Fig. 4.</label><caption><p>Example of CNVs called by ONCOCNV, ADTEx and NextGENe (Sample A1). (<bold>A)</bold> Array CGH profile for sample A1, segmented using cghseg: purple (loss), orange (gain). <italic>x</italic>-axis corresponds to probe indexes. (<bold>B)</bold> Copy number profile calculated by ONCOCNV. <italic>x</italic>-axis corresponds to amplicon indexes. (<bold>C)</bold> Agreement between CNVs predicted from array CGHs and amplicon sequencing. Each vertical bar denotes a gene copy number status: white (neutral), purple (loss) and orange (gain)</p></caption><graphic xlink:href="btu436f4p"/></fig>
<fig id="btu436-F5" position="float"><label>Fig. 5.</label><caption><p>Accuracy of the detection of the <italic>ErbB2</italic> amplification. Normalized read count (NRC) and copy number prediction for the <italic>ErbB2</italic> gene and six adjacent genes in 30 Erbb2-positive ovarian cancer samples (dataset B). The Y-axis shows the average log(NRC) per gene. The color corresponds to the predicted copy number status: purple (loss), white (neutral), orange (gain). The darker orange color shows a gain of two and more copies of the gene</p></caption><graphic xlink:href="btu436f5p"/></fig>
</p>
      <p>We observed a high accuracy of CNA detection for samples with low contamination by normal cells: for all but one sample with &lt;18% contamination, the CNA detection accuracy was at least 90% (<xref ref-type="fig" rid="btu436-F6">Fig. 6</xref>). As we expected, our ability to detect CNAs in low amplicon density datasets strongly depends on the normal contamination (Pearson correlation coefficient 0.64, <italic>P</italic>-value 10<sup>−</sup><sup>4</sup>).
<fig id="btu436-F6" position="float"><label>Fig. 6.</label><caption><p>CNA detection accuracy in 30 samples from the SHIVA clinical trial (dataset C). The accuracy of CNA detection is negatively correlated with the percentage of normal cell contamination (Pearson <italic>r</italic> = −0.64, <italic>P</italic>-value = 10<sup>−4</sup>)</p></caption><graphic xlink:href="btu436f6p"/></fig></p>
    </sec>
    <sec id="SEC3.4">
      <title>3.4 Data and software availability</title>
      <p>Amplicon sequencing and CGH data and the ONCOCNV source code are available at <ext-link ext-link-type="uri" xlink:href="http://oncocnv.curie.fr/">http://oncocnv.curie.fr/</ext-link></p>
    </sec>
  </sec>
  <sec>
    <title>4 DISCUSSION</title>
    <p>We proposed a method to analyze amplicon sequencing data to be used to detect CNAs involving at least several exons. Our method, ONCOCNV, demonstrated a high accuracy of CNA predictions for the samples for which we had the results of array CGH analysis as gold standard. ONCOCNV significantly outperformed methods developed for exome sequencing data analysis. This is because of the extensive normalization strategy, which includes normalization for the GC content, amplicon length (via LOESS correction) and other technology-specific biases (via PCA of the control samples).</p>
    <p>An important advantage of ONCOCNV is the refinement of breakpoints falling initially within a gene (i.e. after the segmentation of NRC profiles). ONCOCNV reanalyzes the NRCs upstream and downstream of the putative breakpoint and decides whether intragenic breakpoint has indeed taken place and that it is not the result of inaccurate segmentation (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu436/-/DC1">Supplementary Fig. S12</ext-link>).</p>
    <p>In our dataset, we observed samples (e.g. controls 3 and 9, <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu436/-/DC1">Supplementary Fig. S2A</ext-link>) where a large fraction of amplicons (26% for both) have zero or extremely low RCs. We would like to point out that ONCOCNV is able to detect such artifacts and analyze CNAs correctly in the corresponding samples.</p>
    <p>The prediction of gains and losses by ONCOCNV includes information on average <inline-formula><mml:math id="I36"><mml:mrow><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mi>R</mml:mi><mml:mi>C</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. In addition, it estimates possible copy numbers. This estimate is based on the assumption that the tumor sample genome is diploid and that the sample is not contaminated by normal cells. We are aware that this assumption might be far from being true. However, we prefer to provide an estimate of the probable copy number to allow the user to distinguish between gains and amplifications, and between one and two allele losses. The question of predicting the exact copy number cannot be solved by using copy number profiles alone. The assessment of B allele frequencies provides a possible solution (<xref rid="btu436-B16" ref-type="bibr">Popova <italic>et al.</italic>, 2009</xref>). We did not use this solution in ONCOCNV because of the high dispersion of B allele frequencies in the amplicon sequencing data (data not shown).</p>
    <p>CNAs detected by ONCOCNV (and by other software whose algorithm is based only on the analysis of copy number profile) are relative to the evaluated zero level. For instance, if we measure the copy numbers of only a pair of genes, we will not be able to see a gain or loss if this happens simultaneously in both genes. Thus, to properly estimate the zero level, many genes should be included in the targeted gene panel.</p>
    <p>As we expected, we detected a fall in the CNA detection accuracy for samples that were highly contaminated by normal cells. In this situation, the noise in measurements is comparable with the expected difference between measurements in the case of one copy gain or loss. As our approach does not use information about B allele frequencies, certain combinations of normal contamination and tumor ploidy significantly impair the efficiency of the technique. This is especially true when there are a small number of measurements (amplicons) per gene.</p>
    <p>We would like to point out that ONCOCNV does not detect one-amplicon amplifications/deletions. We believe the noise in current amplicon-based technologies does not allow detection of such CNVs with high certainty. However, there are methods, such as CONTRA (<xref rid="btu436-B12" ref-type="bibr">Li <italic>et al.</italic>, 2012</xref>), which predict the CNVs of single amplicon regions.</p>
    <p>We do not position ONCOCNV as a tool for exome sequencing data analysis. Unlike many exome sequencing data analysis tools, ONCOCNV does not take into account B allele frequencies. Because of this limitation, ONCOCNV is not able to evaluate the level of the contamination by normal cells or improve the accuracy of CNA calling by simultaneously processing copy number and B allele frequency profiles (<xref rid="btu436-B5" ref-type="bibr">Boeva <italic>et al.</italic>, 2012</xref>; <xref rid="btu436-B17" ref-type="bibr">Sathirapongsasuti <italic>et al.</italic>, 2011</xref>).</p>
    <p>Our analysis of biases intrinsic to amplicon sequencing revealed two factors influencing the RCs: amplicon length and GC content. As LOESS correction is possible only for the amplicon sizes frequently present in the dataset (from 70 to 140 bp in our case), we advise using as narrow a range of amplicon lengths as possible in the future design of amplicon regions. Similarly, for the GC-content normalization, the CNA prediction may be inaccurate for amplicons with extremely high or low GC content. This is especially true in the case when all amplicon regions within a gene (usually overlapping with exons) have an extremely high or low GC content. For such genes, we advise designing additional amplicons in the intronic regions with moderate GC content if it is planned to completely bypass array CGH or a similar technique to predict the copy number status of the targeted regions.</p>
  </sec>
  <sec>
    <title>5 CONCLUSIONS</title>
    <p>We present ONCOCNV, a computational method and software tool to detect CNAs in tumor amplicon sequencing data. Our method includes normalization of RCs for library-specific biases (library size, GC content and amplicon length) and for technology-specific bias. To normalize for the latter, we use a set of control samples. We demonstrate that ONCOCNV significantly outperforms methods such as ADTEx (<xref rid="btu436-B1" ref-type="bibr">Amarasinghe <italic>et al.</italic>, 2013</xref>) and NextGENe developed for the analysis of exome sequencing data. To make ONCOCNV useful for both bioinformaticians and clinicians, we output both detailed and summarized results, as well as a visualization of the annotated copy number profile (<xref ref-type="fig" rid="btu436-F4">Fig. 4</xref>B). We believe that the use of our method on large panels of targeted genes could potentially replace CGH or SNP arrays in the future.</p>
    <p><italic>Funding</italic>: The SHIVA trial is supported by the grant <award-id>ANR-10-EQPX-03</award-id> from the <funding-source>Agence Nationale de le Recherche (Investissements d’avenir)</funding-source> and <funding-source>SiRIC (Site de Recherche Intégré sur le Cancer)</funding-source>. High-throughput sequencing was performed by the NGS platform of the Institut Curie, supported by grants <award-id>ANR-10-EQPX-03</award-id> and <award-id>ANR10-INBS-09-08</award-id> from the <funding-source>Agence Nationale de la Recherche (Investissements d’avenir)</funding-source> and by the <funding-source>Canceropôle Ile-de-France</funding-source>.</p>
    <p><italic>Conflict of Interest</italic>: none declared.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="PMC_1" content-type="local-data">
      <caption>
        <title>Supplementary Data</title>
      </caption>
      <media mimetype="text" mime-subtype="html" xlink:href="supp_30_24_3443__index.html"/>
      <media xlink:role="associated-file" mimetype="application" mime-subtype="pdf" xlink:href="supp_btu436_boeva_Supplementary_Materials.pdf"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <ref-list>
    <title>REFERENCES</title>
    <ref id="btu436-B1">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Amarasinghe</surname>
            <given-names>KC</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>CoNVEX: copy number variation estimation in exome sequencing data using HMM</article-title>
        <source>BMC Bioinformatics</source>
        <year>2013</year>
        <volume>14</volume>
        <fpage>S2</fpage>
        <pub-id pub-id-type="pmid">23368785</pub-id>
      </element-citation>
    </ref>
    <ref id="btu436-B2">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Beadling</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Combining highly multiplexed PCR with semiconductor-based sequencing for rapid cancer genotyping</article-title>
        <source>J. Mol. Diagn.</source>
        <year>2013</year>
        <volume>15</volume>
        <fpage>171</fpage>
        <lpage>176</lpage>
        <pub-id pub-id-type="pmid">23274167</pub-id>
      </element-citation>
    </ref>
    <ref id="btu436-B3">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Benjamini</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Hochberg</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>Controlling the false discovery rate: a practical and powerful approach to multiple testing</article-title>
        <source>J. R. Stat. Soc. Ser. B Methodol.</source>
        <year>1995</year>
        <volume>57</volume>
        <fpage>289</fpage>
        <lpage>300</lpage>
      </element-citation>
    </ref>
    <ref id="btu436-B4">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Boeva</surname>
            <given-names>V</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Control-free calling of copy number alterations in deep-sequencing data using GC-content normalization</article-title>
        <source>Bioinformatics</source>
        <year>2011</year>
        <volume>27</volume>
        <fpage>268</fpage>
        <lpage>269</lpage>
        <pub-id pub-id-type="pmid">21081509</pub-id>
      </element-citation>
    </ref>
    <ref id="btu436-B5">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Boeva</surname>
            <given-names>V</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Control-FREEC: a tool for assessing copy number and allelic content using next-generation sequencing data</article-title>
        <source>Bioinformatics</source>
        <year>2012</year>
        <volume>28</volume>
        <fpage>423</fpage>
        <lpage>425</lpage>
        <pub-id pub-id-type="pmid">22155870</pub-id>
      </element-citation>
    </ref>
    <ref id="btu436-B6">
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Cleveland</surname>
            <given-names>WS</given-names>
          </name>
          <etal/>
        </person-group>
        <person-group person-group-type="editor">
          <name>
            <surname>Chambers</surname>
            <given-names>SJM</given-names>
          </name>
          <name>
            <surname>Hastie</surname>
            <given-names>TJ</given-names>
          </name>
        </person-group>
        <article-title>Local regression models</article-title>
        <source>Statistical Models</source>
        <year>1992</year>
        <comment>Wadsworth &amp; Brooks/Cole, Pacific Grove, CA, pp. 309–376</comment>
      </element-citation>
    </ref>
    <ref id="btu436-B7">
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Fraley</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <year>2012</year>
        <comment>MCLUST Version 4 for R: <italic>Normal Mixture Modeling for Model-Based Clustering, Classification, and Density Estimation</italic>. Department of Statistics, University of Washington, Seattle, WA</comment>
      </element-citation>
    </ref>
    <ref id="btu436-B8">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fraley</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Raftery</surname>
            <given-names>AE</given-names>
          </name>
        </person-group>
        <article-title>Model-based clustering, discriminant analysis, and density estimation</article-title>
        <source>J. Am. Stat. Assoc.</source>
        <year>2002</year>
        <volume>97</volume>
        <fpage>611</fpage>
        <lpage>631</lpage>
      </element-citation>
    </ref>
    <ref id="btu436-B9">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Garraway</surname>
            <given-names>LA</given-names>
          </name>
          <name>
            <surname>Lander</surname>
            <given-names>ES</given-names>
          </name>
        </person-group>
        <article-title>Lessons from the cancer genome</article-title>
        <source>Cell</source>
        <year>2013</year>
        <volume>153</volume>
        <fpage>17</fpage>
        <lpage>37</lpage>
        <pub-id pub-id-type="pmid">23540688</pub-id>
      </element-citation>
    </ref>
    <ref id="btu436-B10">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gusnanto</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Correcting for cancer genome size and tumour cell content enables better estimation of copy number alterations from next-generation sequence data</article-title>
        <source>Bioinformatics</source>
        <year>2012</year>
        <volume>28</volume>
        <fpage>40</fpage>
        <lpage>47</lpage>
        <pub-id pub-id-type="pmid">22039209</pub-id>
      </element-citation>
    </ref>
    <ref id="btu436-B11">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hyvärinen</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Oja</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>Independent component analysis: algorithms and applications</article-title>
        <source>Neural Netw. Off. J. Int. Neural Netw. Soc.</source>
        <year>2000</year>
        <volume>13</volume>
        <fpage>411</fpage>
        <lpage>430</lpage>
      </element-citation>
    </ref>
    <ref id="btu436-B12">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>CONTRA: copy number analysis for targeted resequencing</article-title>
        <source>Bioinformatics</source>
        <year>2012</year>
        <volume>28</volume>
        <fpage>1307</fpage>
        <lpage>1313</lpage>
        <pub-id pub-id-type="pmid">22474122</pub-id>
      </element-citation>
    </ref>
    <ref id="btu436-B13">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Olshen</surname>
            <given-names>AB</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Circular binary segmentation for the analysis of array-based DNA copy number data</article-title>
        <source>Biostatistics</source>
        <year>2004</year>
        <volume>5</volume>
        <fpage>557</fpage>
        <lpage>572</lpage>
        <pub-id pub-id-type="pmid">15475419</pub-id>
      </element-citation>
    </ref>
    <ref id="btu436-B14">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Parzen</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>On estimation of a probability density function and mode</article-title>
        <source>Ann. Math. Stat.</source>
        <year>1962</year>
        <volume>33</volume>
        <fpage>1065</fpage>
        <lpage>1076</lpage>
      </element-citation>
    </ref>
    <ref id="btu436-B15">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pauletti</surname>
            <given-names>G</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Detection and quantitation of HER-2/neu gene amplification in human breast cancer archival material using fluorescence in situ hybridization</article-title>
        <source>Oncogene</source>
        <year>1996</year>
        <volume>13</volume>
        <fpage>63</fpage>
        <lpage>72</lpage>
        <pub-id pub-id-type="pmid">8700555</pub-id>
      </element-citation>
    </ref>
    <ref id="btu436-B16">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Popova</surname>
            <given-names>T</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Genome alteration print (GAP): a tool to visualize and mine complex cancer genomic profiles obtained by SNP arrays</article-title>
        <source>Genome Biol.</source>
        <year>2009</year>
        <volume>10</volume>
        <fpage>R128</fpage>
        <pub-id pub-id-type="pmid">19903341</pub-id>
      </element-citation>
    </ref>
    <ref id="btu436-B17">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sathirapongsasuti</surname>
            <given-names>JF</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Exome sequencing-based copy-number variation and loss of heterozygosity detection: ExomeCNV</article-title>
        <source>Bioinformatics</source>
        <year>2011</year>
        <volume>27</volume>
        <fpage>2648</fpage>
        <lpage>2654</lpage>
        <pub-id pub-id-type="pmid">21828086</pub-id>
      </element-citation>
    </ref>
    <ref id="btu436-B18">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Small</surname>
            <given-names>MB</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Neoplastic transformation by the human gene N-myc</article-title>
        <source>Mol. Cell. Biol.</source>
        <year>1987</year>
        <volume>7</volume>
        <fpage>1638</fpage>
        <lpage>1645</lpage>
        <pub-id pub-id-type="pmid">3299052</pub-id>
      </element-citation>
    </ref>
    <ref id="btu436-B19">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tai</surname>
            <given-names>W</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The role of HER2 in cancer therapy and targeted drug delivery</article-title>
        <source>J. Control. Release</source>
        <year>2010</year>
        <volume>146</volume>
        <fpage>264</fpage>
        <lpage>275</lpage>
        <pub-id pub-id-type="pmid">20385184</pub-id>
      </element-citation>
    </ref>
    <ref id="btu436-B20">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Le Tourneau</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Designs and challenges for personalized medicine studies in oncology: focus on the SHIVA trial</article-title>
        <source>Target. Oncol.</source>
        <year>2012</year>
        <volume>7</volume>
        <fpage>253</fpage>
        <lpage>265</lpage>
        <pub-id pub-id-type="pmid">23161020</pub-id>
      </element-citation>
    </ref>
    <ref id="btu436-B21">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Venkatraman</surname>
            <given-names>ES</given-names>
          </name>
          <name>
            <surname>Olshen</surname>
            <given-names>AB</given-names>
          </name>
        </person-group>
        <article-title>A faster circular binary segmentation algorithm for the analysis of array CGH data</article-title>
        <source>Bioinformatics</source>
        <year>2007</year>
        <volume>23</volume>
        <fpage>657</fpage>
        <lpage>663</lpage>
        <pub-id pub-id-type="pmid">17234643</pub-id>
      </element-citation>
    </ref>
    <ref id="btu436-B22">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhou</surname>
            <given-names>W</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Bias from removing read duplication in ultra-deep sequencing experiments</article-title>
        <source>Bioinformatics</source>
        <year>2014</year>
        <volume>30</volume>
        <fpage>1073</fpage>
        <lpage>1080</lpage>
      </element-citation>
    </ref>
  </ref-list>
</back>
