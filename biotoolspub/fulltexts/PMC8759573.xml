<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">NAR Genom Bioinform</journal-id>
    <journal-id journal-id-type="iso-abbrev">NAR Genom Bioinform</journal-id>
    <journal-id journal-id-type="publisher-id">nargab</journal-id>
    <journal-title-group>
      <journal-title>NAR Genomics and Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2631-9268</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8759573</article-id>
    <article-id pub-id-type="doi">10.1093/nargab/lqab120</article-id>
    <article-id pub-id-type="publisher-id">lqab120</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Methods Article</subject>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI00030</subject>
        <subject>AcademicSubjects/SCI00980</subject>
        <subject>AcademicSubjects/SCI01060</subject>
        <subject>AcademicSubjects/SCI01140</subject>
        <subject>AcademicSubjects/SCI01180</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Adaptive and powerful microbiome multivariate association analysis via feature selection</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-4314-5114</contrib-id>
        <name>
          <surname>Banerjee</surname>
          <given-names>Kalins</given-names>
        </name>
        <!--kbanerjee@pennstatehealth.psu.edu-->
        <xref rid="COR2" ref-type="corresp"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Chen</surname>
          <given-names>Jun</given-names>
        </name>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-9650-143X</contrib-id>
        <name>
          <surname>Zhan</surname>
          <given-names>Xiang</given-names>
        </name>
        <!--zhanx@bjmu.edu.cn-->
        <xref rid="COR1" ref-type="corresp"/>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="COR1">To whom correspondence should be addressed. Tel: +86 10 62744132; Fax: +86 10 62744134; Email: <email>zhanx@bjmu.edu.cn</email></corresp>
      <corresp id="COR2">Correspondence may also be addressed to Kalins Banerjee. Email: <email>kbanerjee@pennstatehealth.psu.edu</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>3</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2022-01-14">
      <day>14</day>
      <month>1</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>14</day>
      <month>1</month>
      <year>2022</year>
    </pub-date>
    <volume>4</volume>
    <issue>1</issue>
    <elocation-id>lqab120</elocation-id>
    <history>
      <date date-type="received">
        <day>30</day>
        <month>5</month>
        <year>2021</year>
      </date>
      <date date-type="rev-recd">
        <day>13</day>
        <month>11</month>
        <year>2021</year>
      </date>
      <date date-type="accepted">
        <day>24</day>
        <month>12</month>
        <year>2021</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2022. Published by Oxford University Press on behalf of NAR Genomics and Bioinformatics.</copyright-statement>
      <copyright-year>2022</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbynclicense">https://creativecommons.org/licenses/by-nc/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution-NonCommercial License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by-nc/4.0/">https://creativecommons.org/licenses/by-nc/4.0/</ext-link>), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact <email>journals.permissions@oup.com</email></license-p>
      </license>
    </permissions>
    <self-uri xlink:href="lqab120.pdf"/>
    <abstract>
      <title>ABSTRACT</title>
      <p>The important role of human microbiome is being increasingly recognized in health and disease conditions. Since microbiome data is typically high dimensional, one popular mode of statistical association analysis for microbiome data is to pool individual microbial features into a group, and then conduct group-based multivariate association analysis. A corresponding challenge within this approach is to achieve adequate power to detect an association signal between a group of microbial features and the outcome of interest across a wide range of scenarios. Recognizing some existing methods’ susceptibility to the adverse effects of noise accumulation, we introduce the Adaptive Microbiome Association Test (AMAT), a novel and powerful tool for multivariate microbiome association analysis, which unifies both blessings of feature selection in high-dimensional inference and robustness of adaptive statistical association testing. AMAT first alleviates the burden of noise accumulation via distance correlation learning, and then conducts a data-adaptive association test under the flexible generalized linear model framework. Extensive simulation studies and real data applications demonstrate that AMAT is highly robust and often more powerful than several existing methods, while preserving the correct type I error rate. A free implementation of AMAT in R computing environment is available at <ext-link xlink:href="https://github.com/kzb193/AMAT" ext-link-type="uri">https://github.com/kzb193/AMAT</ext-link>.</p>
    </abstract>
    <counts>
      <page-count count="10"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec sec-type="intro" id="SEC1">
    <title>INTRODUCTION</title>
    <p>Many microbiome studies often aim to investigate the statistical association between human microbiome compositions and an outcome of interest, such as a disease status. These studies can not only improve our understanding of the non-genetic components of complex traits and diseases, but also lead to potential development of preventive or therapeutic strategies targeted at the disease-associated microbial taxa (<xref rid="B1" ref-type="bibr">1–3</xref>). Next generation sequencing technology, with its recent progress, has increasingly begun to distinguish among strains or exact sequence variants during taxonomic profiling (<xref rid="B4" ref-type="bibr">4</xref>), which provides researchers the possibilities to answer clinical and biological questions that have eluded scientific efforts for decades. On the other hand, these research opportunities on new organisms of higher resolution have brought in new statistical challenges in microbiome association analysis. The first challenge is data sparsity or zero inflation. The higher the taxonomic resolution (e.g. low taxonomic ranks such as species or strain), the sparser the data, which makes it more difficult to detect association signals. The second challenge in the analysis is the curse of dimensionality. At a higher taxonomic resolution, there are more taxa available for association analysis, which usually indicates a heavier multiple testing correction burden. Consequently, it becomes more difficult to identify associations under family-wise statistical significance level. A naive approach would be to aggregate low-rank taxa belonging to the same high-rank category, and then perform a univariate association analysis between the high-rank taxon and the outcome. This approach can both address the sparsity issue and reduce the number of tests. However, it suffers from substantial power loss when low-rank taxa have opposite directions of effects, which get cancelled out during aggregation. Thus, new powerful and robust statistical association analysis methods are desired.</p>
    <p>Researchers have frequently encountered a similar scenario (of variables with high dimensionality and low frequency) in genetic association analysis, where millions of rare variants have been genotyped in a typical whole genome sequencing study. A consensus among statistical geneticists is to group multiple rare genetic variants by genes or genomic regions to perform a set-based multivariate association analysis (<xref rid="B5" ref-type="bibr">5–7</xref>). In comparison to univariate association analyses, multivariate approaches considering multiple variants simultaneously, in general, enjoy higher statistical powers by combining weak association signals and by reducing multiple testing burden. Following the same spirit, several multivariate microbiome association analysis methods and tools have been proposed recently (<xref rid="B8" ref-type="bibr">8–14</xref>). In this paper, we follow the multivariate association analysis research line to investigate new robust and powerful statistical methods for testing association between a microbial community/clade of multiple taxa and an outcome of interest.</p>
    <p>Microbial epidemiologists have increasingly recognized that not all taxa within a clade are equally functional, where functional can be understood as outcome-associated within the context of microbiome association analysis considered in this paper. In fact, it is likely that most microbial taxa within a clade are not associated with the outcome of interest (<xref rid="B9" ref-type="bibr">9</xref>,<xref rid="B13" ref-type="bibr">13</xref>). Hence, a big challenge in multivariate microbiome association analysis is to achieve enough power to detect the association signal amid noises. One possible approach to achieve more powerful results within the context of multivariate association analysis is to assign larger weights to more important taxa. The weighting idea in multivariate association analysis first stems from rare-variant genetic association analysis (<xref rid="B5" ref-type="bibr">5</xref>), where each rare variant is weighted based on its minor allele frequency under the assumption that rarer variants, in general, have larger impacts on the phenotype. The resulting test might not be optimal if the underlying true association patterns are against this assumption. Therefore, an assumption-free and data-adaptive weighting strategy would be preferred for more robust multivariate statistical association analysis (<xref rid="B9" ref-type="bibr">9</xref>,<xref rid="B13" ref-type="bibr">13</xref>,<xref rid="B15" ref-type="bibr">15</xref>). One such example is to assign weights to each variant according to the score statistics between the outcome and each individual variant (<xref rid="B9" ref-type="bibr">9</xref>,<xref rid="B16" ref-type="bibr">16</xref>,<xref rid="B17" ref-type="bibr">17</xref>). By doing this, the problem can be alleviated to some extent, but cannot be fully addressed as there still exist small non-zero weights to potential noises (i.e., taxa with smaller score statistics). The accumulation of such small noises can deteriorate the performance of the multivariate association test, especially when the number of taxa being tested is moderate or relatively large (<xref rid="B18" ref-type="bibr">18</xref>), a widely-observed phenomenon that has been termed as ‘curse of dimensionality’ in high-dimensional statistical literature (<xref rid="B19" ref-type="bibr">19</xref>).</p>
    <p>The technique of shrinkage can be used to improve estimation of microbial associations (<xref rid="B20" ref-type="bibr">20</xref>). In the specific context of multivariate microbiome association analysis considered in this paper, the aforementioned problem of noise accumulation can also be mitigated by shrinkage. Specifically, we want to shrink the weights of potential noises to exactly zeroes, which can be achieved via statistical variable/feature selection. That is, we first select a subset of taxa and then construct a multivariate association testing statistic only using those selected taxa, which is equivalent to assigning a zero weight to each taxon that has not been selected. The selected subset of features is often referred to as the testing subset (<xref rid="B21" ref-type="bibr">21</xref>). Incorporation of feature selection can not only boost the power of the association test by mitigating the burden of accumulated noise features, but also increase the interpretability of the result in the sense that the testing subset can provide insight on the taxa that are more likely to drive the overall association. Feature selection has been extensively studied in the high dimensional statistical literature (<xref rid="B19" ref-type="bibr">19</xref>,<xref rid="B22" ref-type="bibr">22–27</xref>), and recently has been extended for microbiome data analysis (<xref rid="B28" ref-type="bibr">28–31</xref>). Such successful attempts in microbiome research further motivate us to incorporate feature selection into the framework of multivariate microbiome association analysis in order to develop a more powerful and robust analysis framework than existing ones.</p>
  </sec>
  <sec sec-type="materials|methods" id="SEC2">
    <title>MATERIALS AND METHODS</title>
    <sec id="SEC2-1">
      <title>Notation and model</title>
      <p>Suppose the data include <italic toggle="yes">n</italic> subjects, an outcome of interest, <italic toggle="yes">p</italic> microbiome features (e.g. abundances of <italic toggle="yes">p</italic> operational taxonomic units/OTUs), and <italic toggle="yes">q</italic> covariates that are potential confounders, such as age and gender. For the <italic toggle="yes">i</italic>th subject, let <italic toggle="yes">Y<sub>i</sub></italic> be the outcome, <inline-formula><tex-math id="TM0001" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\boldsymbol{Z}_{i \boldsymbol{\cdot }}= (Z_{i1},\ldots ,Z_{ip})^{^{\prime }}$\end{document}</tex-math></inline-formula> be the vector of OTU abundances, and <inline-formula><tex-math id="TM0002" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\boldsymbol{X}_{i \boldsymbol{\cdot }}= (X_{i1}, \ldots ,X_{iq} )^{^{\prime }}$\end{document}</tex-math></inline-formula> be the vector of covariates. Correspondingly, we define <inline-formula><tex-math id="TM0003" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\boldsymbol{Y}_{n\times 1}= (Y_1,\ldots ,Y_n)^{^{\prime }}$\end{document}</tex-math></inline-formula>, <inline-formula><tex-math id="TM0004" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$Z_{n\times p}=(\boldsymbol{Z}_{1 \boldsymbol{\cdot }}, \ldots , \boldsymbol{Z}_{n \boldsymbol{\cdot }})^{^{\prime }}$\end{document}</tex-math></inline-formula>, and <inline-formula><tex-math id="TM0005" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$X_{n\times q}=(\boldsymbol{X}_{1 \boldsymbol{\cdot }},\ldots ,\boldsymbol{X}_{n \boldsymbol{\cdot }})^{^{\prime }}$\end{document}</tex-math></inline-formula>. Additionally, let <inline-formula><tex-math id="TM0006" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$(\boldsymbol{Z}_{\boldsymbol{\cdot } 1}, \ldots , \boldsymbol{Z}_{ \boldsymbol{\cdot } p})$\end{document}</tex-math></inline-formula> be the columns of <italic toggle="yes">Z</italic>. To link the outcome of interest with microbial features and clinical coviariates, we consider a linear model (Equation <xref rid="M1" ref-type="disp-formula">1</xref>) for a continuous outcome, and a logistic model (Equation <xref rid="M2" ref-type="disp-formula">2</xref>) for a binary outcome:<disp-formula id="M1"><label>(1)</label><tex-math id="TM0007" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}\begin{eqnarray*} Y_i = \beta _0 + \sum _{j=1}^p Z_{ij}\beta _j+ \sum _{k=1}^q X_{ik}\alpha _k + \epsilon _i, \end{eqnarray*}\end{document}</tex-math></disp-formula><disp-formula id="M2"><label>(2)</label><tex-math id="TM0008" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}\begin{eqnarray*} \text{logit P}(Y_i =1) = \beta _0 + \sum _{j=1}^p Z_{ij}\beta _j+ \sum _{k=1}^q X_{ik}\alpha _k , \end{eqnarray*}\end{document}</tex-math></disp-formula>where β<sub>0</sub> is the intercept, <inline-formula><tex-math id="TM0009" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\boldsymbol{\beta }=(\beta _1,\ldots ,\beta _p)^{^{\prime }}$\end{document}</tex-math></inline-formula> and <inline-formula><tex-math id="TM0010" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\boldsymbol{\alpha }=(\alpha _1,\ldots ,\alpha _q)^{^{\prime }}$\end{document}</tex-math></inline-formula> are regression coefficients and ε<sub><italic toggle="yes">i</italic></sub>’s are random errors that independently follow a Normal distribution with mean 0 and variance σ<sup>2</sup>. Our goal is to test for possible association between OTUs and the outcome, i.e. to test <inline-formula><tex-math id="TM0011" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$H_0:\boldsymbol{\beta }=\boldsymbol{0}$\end{document}</tex-math></inline-formula> against <italic toggle="yes">H</italic><sub>1</sub>: atleastone β<sub><italic toggle="yes">j</italic></sub> ≠ 0, (<italic toggle="yes">j</italic> = 1, …, <italic toggle="yes">p</italic>), which has been extensively studied in literature (<xref rid="B8" ref-type="bibr">8–14</xref>).</p>
    </sec>
    <sec id="SEC2-2">
      <title>Adaptive multivariate association analysis</title>
      <p>A major challenge in achieving adequate statistical power to test the multivariate null hypothesis <inline-formula><tex-math id="TM0012" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$H_0:\boldsymbol{\beta }=\boldsymbol{0}$\end{document}</tex-math></inline-formula> is that, many underlying features are truly null (i.e., β<sub><italic toggle="yes">j</italic></sub> = 0 for many <italic toggle="yes">Z<sub>j</sub></italic>’s). The increased degrees of freedom paid to these noise variables <italic toggle="yes">Z<sub>j</sub></italic>’s can deteriorate the power of the multivariate association test of <italic toggle="yes">H</italic><sub>0</sub>: β<sub>1</sub> = ⋅⋅⋅ = β<sub><italic toggle="yes">p</italic></sub> = 0, especially when the number of variables <italic toggle="yes">p</italic> is relatively large. To alleviate the accumulated noise effects, one feasible approach is the sum of powered score (SPU) test, which weights each variable differently according to the score vector (<xref rid="B9" ref-type="bibr">9</xref>,<xref rid="B12" ref-type="bibr">12</xref>,<xref rid="B16" ref-type="bibr">16</xref>). Let <inline-formula><tex-math id="TM0013" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\boldsymbol{U}= (U_1,\ldots ,U_p)^{^{\prime }}$\end{document}</tex-math></inline-formula> be the score vector of <inline-formula><tex-math id="TM0014" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\boldsymbol{\beta }$\end{document}</tex-math></inline-formula> evaluated under the null model. Then, the SPU statistic (characterized by a tuning parameter γ) is defined as:<disp-formula><tex-math id="TM0015" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}\begin{eqnarray*} T_{\text{SPU}(\gamma )}= \left\lbrace \begin{array}{@{}l@{\quad }l@{}}\sum _{j=1}^{p} U_j^ \gamma &amp; \text{, if} \ \gamma =1,2,3,\ldots , \\ Max \ \lbrace |U_j |: j=1,\ldots ,p \rbrace &amp; \text{, if} \ \gamma = \infty . \end{array}\right. \end{eqnarray*}\end{document}</tex-math></disp-formula>The SPU test can be viewed as a weighted multivariate score test, which assigns a weight of <inline-formula><tex-math id="TM0016" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$U_j^ {\gamma - 1}$\end{document}</tex-math></inline-formula> to score <italic toggle="yes">U<sub>j</sub></italic>. One potential limitation of the SPU test is that, its power largely depends on the choice of γ. However, the optimal choice of γ relies on the true underlying outcome-microbiome association pattern, which stays largely unknown (<xref rid="B9" ref-type="bibr">9</xref>,<xref rid="B12" ref-type="bibr">12</xref>,<xref rid="B13" ref-type="bibr">13</xref>). Consequently, the adaptive SPU (aSPU) test, which combines multiple SPU tests, has been developed (<xref rid="B16" ref-type="bibr">16</xref>,<xref rid="B17" ref-type="bibr">17</xref>), and the corresponding test statistic is given as <italic toggle="yes">T</italic><sub>aSPU</sub> = <italic toggle="yes">Min</italic>{<italic toggle="yes">P</italic><sub>SPU(γ)</sub>: γ ∈ Γ}, where <italic toggle="yes">P</italic><sub>SPU(γ)</sub> denotes the <italic toggle="yes">P</italic>-value of <italic toggle="yes">T</italic><sub>SPU(γ)</sub>. In practice, researchers have observed that Γ = {1, 2, …, 8, ∞} often suffices, with γ = 1 usually producing low powers when directions of individual effects are opposite, and γ = 8 often providing almost identical results as those with γ = ∞ (<xref rid="B9" ref-type="bibr">9</xref>). The unification of a wide range of SPU tests by taking the minimum allows the aSPU test to be data-adaptive and robust in terms of maintaining relatively high power across a wide range of scenarios, since at least one SPU test is likely to be powerful for the true association mechanism underlying the data.</p>
    </sec>
    <sec id="SEC2-3">
      <title>A new powerful and adaptive multivariate association analysis via feature selection</title>
      <p>We observe that the weighted sum <inline-formula><tex-math id="TM0017" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\sum _{j=1}^{p} U_j^ \gamma$\end{document}</tex-math></inline-formula> of all <italic toggle="yes">p</italic> variables in <italic toggle="yes">T</italic><sub>SPU(γ)</sub> may suffer from low power due to the high degrees of freedom paid to all variables, especially when most variables are not associated with the outcome. One way to circumvent this scenario of low statistical power is to reduce the degrees of freedom by constraining the potential noise variables to have zero weights. In other words, we will use a new multivariate association test statistic of the form <inline-formula><tex-math id="TM0018" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\sum _{j \in S} U_j^\gamma$\end{document}</tex-math></inline-formula>, where <italic toggle="yes">S</italic>⊂{1, 2, …, <italic toggle="yes">p</italic>} is a collection of taxa that are more likely to be outcome-associated. In this paper, we have determined the testing subset <italic toggle="yes">S</italic> using statistical feature selection methods. Specifically, motivated by a previous publication (<xref rid="B32" ref-type="bibr">32</xref>) in mediation analysis involving high-dimensional microbial features, we have utilized the statistical framework of distance correlation (DC) learning (<xref rid="B26" ref-type="bibr">26</xref>,<xref rid="B33" ref-type="bibr">33</xref>) to determine <italic toggle="yes">S</italic> in the multivariate microbiome association analysis considered here.</p>
      <p>We first present a synopsis of DC, which quantifies the degree of dependence between two random variables (<xref rid="B33" ref-type="bibr">33</xref>). Let {(<italic toggle="yes">V<sub>i</sub></italic>, <italic toggle="yes">W<sub>i</sub></italic>): <italic toggle="yes">i</italic> = 1, …, <italic toggle="yes">n</italic>} be a random sample of size <italic toggle="yes">n</italic> from the population (<italic toggle="yes">V, W</italic>), with <inline-formula><tex-math id="TM0019" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$V \in \mathcal {R}$\end{document}</tex-math></inline-formula>, and <inline-formula><tex-math id="TM0020" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$W \in \mathcal {R}$\end{document}</tex-math></inline-formula>. We define, <inline-formula><tex-math id="TM0021" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\hat{S_1} = \frac{1}{n^2}\sum _{i=1}^n \sum _{j=1}^n |V_i- V_j| \ |W_i- W_j|$\end{document}</tex-math></inline-formula>, <inline-formula><tex-math id="TM0022" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\hat{S_2} = \frac{1}{n^2}\sum _{i=1}^n \sum _{j=1}^n |V_i- V_j| \frac{1}{n^2}\sum _{i=1}^n \sum _{j=1}^n |W_i- W_j|$\end{document}</tex-math></inline-formula>, and <inline-formula><tex-math id="TM0023" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\hat{S_3} = \frac{1}{n^3}\sum _{i=1}^n \sum _{j=1}^n \sum _{l=1}^n |V_i- V_l| |W_j- W_l|$\end{document}</tex-math></inline-formula>. Then, <inline-formula><tex-math id="TM0024" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\widehat{\text{dcov}}(V,W)= \sqrt{\hat{S_1}+\hat{S_2}-2\hat{S_3}}$\end{document}</tex-math></inline-formula> is an estimate of the distance covariance between <italic toggle="yes">V</italic> and <italic toggle="yes">W</italic>, and <inline-formula><tex-math id="TM0025" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\widehat{\text{dcorr}}(V,W)= \frac{ \widehat{\text{dcov}}(V,W)}{\sqrt{ \widehat{\text{dcov}}(V,V) \ \widehat{\text{dcov}}(W,W)}}$\end{document}</tex-math></inline-formula> is defined as the corresponding sample DC, which is bounded within [0,1]. A remarkable property of DC is that it is zero, if and only if the two underlying variables are independent.</p>
      <p>One important application of DC is for feature screening. Distance correlation based sure independence screening or DC-SIS (<xref rid="B26" ref-type="bibr">26</xref>), is a highly robust and attractive feature selection procedure due to its following two characteristics. First, it is completely model-free in the sense that it allows for arbitrary regression relationship between the predictors and the outcome/ response (continuous/discrete/categorical), regardless of whether it is linear or non linear. Second, it possesses the sure screening property which ensures that, all active features can be selected with probability approaching one as the sample size increases (<xref rid="B26" ref-type="bibr">26</xref>). Both properties guarantee that association signals between the microbial features and the outcome would be amplified after screening. As a result, it would be easier to detect the signals for the new method to be proposed in this paper. To this end, our new statistical association analysis strategy proceeds by first screening and then association testing.</p>
      <p>We defer the details of our two-stage procedure and focus on the screening stage first. The fundamental idea of DC-SIS is that, given a response and a set of predictors, at first the DCs between each predictor and the response are computed, and then predictors with DCs above a threshold are selected. Even though there exist few proposals regarding the choice of this threshold (<xref rid="B26" ref-type="bibr">26</xref>), we have implemented a new data-driven thresholding strategy for selecting a testing subset <italic toggle="yes">S</italic>. Since the data involve potential confounders, at first we obtain the adjusted response <inline-formula><tex-math id="TM0026" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\boldsymbol{r}= (r_1,\ldots ,r_n)^{^{\prime }}$\end{document}</tex-math></inline-formula> as the residuals of regressing the outcome <inline-formula><tex-math id="TM0027" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\boldsymbol{Y}$\end{document}</tex-math></inline-formula> on covariates <italic toggle="yes">X</italic>. Let the sample DC between <inline-formula><tex-math id="TM0028" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\boldsymbol{r}$\end{document}</tex-math></inline-formula> and the <italic toggle="yes">j</italic>th column of <italic toggle="yes">Z</italic> be denoted as <italic toggle="yes">dc<sub>j</sub></italic>. We now present in Algorithm 1, a DC-based data-adaptive procedure for feature selection:</p>
      <p><bold>Algorithm 1:</bold> Data-adaptive feature selection via distance correlation learning</p>
      <p><bold>Input:</bold> Response (adjusted for additional covariates) <inline-formula><tex-math id="TM0029" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\boldsymbol{r}_{n \times 1}$\end{document}</tex-math></inline-formula>, and predictors <italic toggle="yes">Z</italic><sub><italic toggle="yes">n</italic> × <italic toggle="yes">p</italic></sub>.</p>
      <p><bold>Output:</bold> Set of indices <italic toggle="yes">S</italic>⊂{1, …, <italic toggle="yes">p</italic>} denoting selected features.</p>
      <p>
        <bold>Procedure:</bold>
      </p>
      <list list-type="order">
        <list-item>
          <p>Compute {<italic toggle="yes">dc<sub>j</sub></italic>: <italic toggle="yes">j</italic> = 1, …, <italic toggle="yes">p</italic>}.</p>
        </list-item>
        <list-item>
          <p>Randomly permute the elements in <inline-formula><tex-math id="TM0030" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\boldsymbol{r}$\end{document}</tex-math></inline-formula>  <italic toggle="yes">B</italic>-times to obtain <inline-formula><tex-math id="TM0031" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\lbrace \boldsymbol{r}^{(b)} : b=1,\ldots ,B \rbrace$\end{document}</tex-math></inline-formula>.</p>
        </list-item>
        <list-item>
          <p>For each <italic toggle="yes">b</italic>, compute DCs between <inline-formula><tex-math id="TM0032" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\boldsymbol{r}^{(b)}$\end{document}</tex-math></inline-formula> and columns of <italic toggle="yes">Z</italic> to get <inline-formula><tex-math id="TM0033" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\lbrace dc^{(b)}_j : j= 1, \ldots , p\rbrace$\end{document}</tex-math></inline-formula>; <italic toggle="yes">b</italic> = 1, …, <italic toggle="yes">B</italic>.</p>
        </list-item>
        <list-item>
          <p>For <italic toggle="yes">j</italic> = 1, …, <italic toggle="yes">p</italic>, if <inline-formula><tex-math id="TM0034" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$dc_j &gt;Mean\lbrace dc^{(b)}_j : b=1,\ldots , B \rbrace$\end{document}</tex-math></inline-formula>, then <italic toggle="yes">j</italic> ∈ <italic toggle="yes">S</italic>.</p>
        </list-item>
        <list-item>
          <p>If none of the columns of <italic toggle="yes">Z</italic> are selected in step 4, select the feature having maximum DC with <inline-formula><tex-math id="TM0035" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\boldsymbol{r}$\end{document}</tex-math></inline-formula>.</p>
        </list-item>
      </list>
      <p>In Algorithm 1, we have used the mean of <inline-formula><tex-math id="TM0036" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\lbrace dc^{(b)}_j : b=1,\ldots , B \rbrace$\end{document}</tex-math></inline-formula> as threshold for the <italic toggle="yes">j</italic>th feature. It is an estimate of the average distance correlation value between the <italic toggle="yes">j</italic>th feature and the adjusted response when the former truly has no prediction power over the latter (i.e. under the null model). Thus, if the <italic toggle="yes">j</italic>th feature is a signal, we can expect <italic toggle="yes">dc<sub>j</sub></italic> to exceed this threshold most of the times. It is of note that Algorithm 1 is not the only method to obtain a testing subset. In fact, many classic statistical feature selection methods can achieve the same goal. To this end, we have conducted comprehensive numerical studies comparing Algorithm 1 with other existing methods from two aspects. One is the accuracy of selection in terms of precision and recall rates. The other is how the selection results would affect the performance of the statistical association testing procedure introduced in the next paragraph. The corresponding results (<xref rid="sup1" ref-type="supplementary-material">Supplementary Tables S1–S2 and Supplementary Figures S1–S2</xref>), presented in Section 1 of the <xref rid="sup1" ref-type="supplementary-material">online Supplementary Data</xref>, have clearly demonstrated superiority of the proposed strategy described in Algorithm 1. We now introduce our new feature selection infused adaptive microbiome association testing (AMAT) procedure for more powerful multivariate association analysis in Algorithm 2.</p>
      <p><bold>Algorithm 2:</bold> Adaptive Microbiome Association Test (AMAT)</p>
      <p><bold>Input:</bold> A vector of continuous or binary outcome <inline-formula><tex-math id="TM0037" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\boldsymbol{Y}_{n \times 1}$\end{document}</tex-math></inline-formula>, OTU abundance matrix <italic toggle="yes">Z</italic><sub><italic toggle="yes">n</italic> × <italic toggle="yes">p</italic></sub>, and a matrix of additional covariates <italic toggle="yes">X</italic><sub><italic toggle="yes">n</italic> × <italic toggle="yes">q</italic></sub>.</p>
      <p><bold>Output:</bold> A <italic toggle="yes">P</italic>-value for testing <inline-formula><tex-math id="TM0038" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$H_0:\boldsymbol{\beta }=\boldsymbol{0}$\end{document}</tex-math></inline-formula> versus <italic toggle="yes">H</italic><sub>1</sub>:  at least one β<sub><italic toggle="yes">j</italic></sub> ≠ 0, (<italic toggle="yes">j</italic> = 1, …, <italic toggle="yes">p</italic>).</p>
      <p>
        <bold>Procedure:</bold>
      </p>
      <list list-type="order">
        <list-item>
          <p>Obtain the normalized OTU matrix <italic toggle="yes">Z</italic>* and the adjusted response <inline-formula><tex-math id="TM0039" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\boldsymbol{r}$\end{document}</tex-math></inline-formula>.</p>
        </list-item>
        <list-item>
          <p>Use Algorithm 1 with <inline-formula><tex-math id="TM0040" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\boldsymbol{r}$\end{document}</tex-math></inline-formula> and <italic toggle="yes">Z</italic> as inputs to obtain <italic toggle="yes">S</italic>.</p>
        </list-item>
        <list-item>
          <p>Compute the aSPU statistic based on <inline-formula><tex-math id="TM0041" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$Z^{*}_{S}$\end{document}</tex-math></inline-formula>. Denote this statistic as <italic toggle="yes">T</italic><sub>AMAT</sub>.</p>
        </list-item>
        <list-item>
          <p>For each <italic toggle="yes">b</italic> = 1, …, <italic toggle="yes">B</italic>, permute the elements of <inline-formula><tex-math id="TM0042" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\boldsymbol{r}$\end{document}</tex-math></inline-formula> to get <inline-formula><tex-math id="TM0043" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\boldsymbol{r}^{(b)}$\end{document}</tex-math></inline-formula>, and repeat steps 2-3 (use <inline-formula><tex-math id="TM0044" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\boldsymbol{r}^{(b)}$\end{document}</tex-math></inline-formula> and <italic toggle="yes">Z</italic> as inputs in step 2). Denote the resulting aSPU statistics as <inline-formula><tex-math id="TM0045" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$T_{\text{AMAT}}^{(b)}; b= 1\ldots , B.$\end{document}</tex-math></inline-formula></p>
        </list-item>
        <list-item>
          <p>The <italic toggle="yes">P</italic>-value is estimated as <inline-formula><tex-math id="TM0046" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$P_{\text{AMAT}}=\frac{1}{B} \sum _{b=1}^B I[T_{\text{AMAT}}^{(b)} \le T_{\text{AMAT}}]$\end{document}</tex-math></inline-formula>, where <italic toggle="yes">I</italic>[ · ] is the indicator function.</p>
        </list-item>
      </list>
      <p>Note that, we first follow the same normalization technique used in a previous SPU-based approach (<xref rid="B12" ref-type="bibr">12</xref>). Specifically, we transform the OTU abundance matrix <italic toggle="yes">Z</italic> into a compositional matrix (if <italic toggle="yes">Z</italic> contains counts), and then the OTU-wise proportions are standardized to have zero mean and unit variance (<italic toggle="yes">Z</italic>* matrix as described in Algorithm 2). Let <italic toggle="yes">S</italic> ≔ {<italic toggle="yes">j</italic><sub>1</sub>, …, <italic toggle="yes">j</italic><sub>|<italic toggle="yes">S</italic>|</sub>}⊂{1, …, <italic toggle="yes">p</italic>} denote a collection of |<italic toggle="yes">S</italic>| OTUs that are obtained via the aforementioned feature selection procedure described in Algorithm 1. Then, the microbial design matrix used to examine the multivariate null hypothesis <inline-formula><tex-math id="TM0047" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$H_0: \boldsymbol{\beta }=\boldsymbol{0}$\end{document}</tex-math></inline-formula> is <inline-formula><tex-math id="TM0048" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$Z^{*}_S=( \boldsymbol{Z}^{*}_{\boldsymbol{\cdot } j_1},\ldots ,\boldsymbol{Z}^{*}_{\boldsymbol{\cdot } j_{|S|}} )$\end{document}</tex-math></inline-formula>, which is very different from existing similar approaches (<xref rid="B9" ref-type="bibr">9</xref>,<xref rid="B12" ref-type="bibr">12</xref>) that consider all <italic toggle="yes">p</italic> variables in the test statistic. Since we are conducting the test with microbial features that are more likely to be outcome-associated, permutations are used to control the type I error. One can also view AMAT as a weighted multivariate association test, which assigns zero weights to all variables that are not selected. Although we use permutations in AMAT for calculating both the <italic toggle="yes">P</italic>-values of inherent SPU statistics (i.e., <italic toggle="yes">P</italic><sub>SPU(γ)</sub>’s) and the final <italic toggle="yes">P</italic>-value <italic toggle="yes">P</italic><sub>AMAT</sub>, the computational cost is greatly reduced as the same set of null statistics are used to serve both purposes (<xref rid="B12" ref-type="bibr">12</xref>). The computational details are provided in Section 2 of the <xref rid="sup1" ref-type="supplementary-material">online Supplementary Data</xref>.</p>
    </sec>
  </sec>
  <sec sec-type="results" id="SEC3">
    <title>RESULTS</title>
    <p>We have used both numerical simulation studies and applications to multiple real data sets to illustrate the performance of the proposed method AMAT. We demonstrate the usefulness of our new approach by comparing it to other well-established methods in the literature.</p>
    <sec id="SEC3-1">
      <title>Simulation design</title>
      <p>A comprehensive simulation study has been conducted to compare AMAT with five existing multivariate microbiome association tests: adaptive microbiome-based sum of powered score test or aMiSPU (<xref rid="B9" ref-type="bibr">9</xref>), the optimal microbiome regression-based kernel association test or OMiRKAT (<xref rid="B8" ref-type="bibr">8</xref>), optimal microbiome-based association test or OMiAT (<xref rid="B12" ref-type="bibr">12</xref>), linear decomposition model or LDM (<xref rid="B14" ref-type="bibr">14</xref>), and microbiome higher criticism analysis or MiHC (<xref rid="B13" ref-type="bibr">13</xref>). The aMiSPU test first uses OTU abundances and branch lengths of a phylogentic tree to compute a separate variable called generalized taxon proportions, and then uses those to conduct a set of SPU tests which are finally combined via the minimum <italic toggle="yes">P</italic>-value approach (<xref rid="B9" ref-type="bibr">9</xref>). Unlike the SPU framework, which combines multiple taxa via weighted linear combination of individual score statistics, the MiRKAT combines taxa via beta-diversity induced kernel metrics (e.g., Bray-Curtis kernel, weighted UniFrac kernel, unweighted UniFrac kernel, and generalized UniFrac kernel with parameter 0.5) (<xref rid="B8" ref-type="bibr">8</xref>). Then, OMiRKAT takes the minimum of these MiRKAT <italic toggle="yes">P</italic>-values as its test statistic (<xref rid="B8" ref-type="bibr">8</xref>). The OMiAT further merges a set of MiRKATs and SPU tests by using the minimum of their <italic toggle="yes">P</italic>-values as its test statistic (<xref rid="B12" ref-type="bibr">12</xref>). The LDM method examines microbiome associations using decomposition of linear models. Finally, the MiHC method uses the same minimum <italic toggle="yes">P</italic>-value approach to combine the Simes test and two modified versions of the higher criticism test (<xref rid="B13" ref-type="bibr">13</xref>). The default settings in the corresponding software packages were used to implement these aforementioned competing methods. Note that, all of these tests (AMAT, aMiSPU, LDM, MiHC, OMiAT, and OMiRKAT) use permutations to establish statistical significance. Particularly in our simulations, we used <italic toggle="yes">B</italic> = 500 permutations and set Γ = {2, 3, 4, 8} for AMAT. It is of note that aMiSPU examines a slightly different hypothesis (association between the outcome and generalized taxon proportions computed at <italic toggle="yes">p</italic> leaf nodes as well as at the internal nodes) from the other tests, which only test for association between <italic toggle="yes">p</italic> OTUs and the outcome.</p>
      <p>We followed simulation settings used in prior microbiome association analyses (<xref rid="B8" ref-type="bibr">8</xref>,<xref rid="B9" ref-type="bibr">9</xref>,<xref rid="B12" ref-type="bibr">12</xref>) to first generate the OTU table that mimicked a real throat microbiome data set with 856 OTUs (<xref rid="B34" ref-type="bibr">34</xref>), which is also analyzed later in this paper. The procedure is described in the following steps:</p>
      <list list-type="bullet">
        <list-item>
          <p>Based on the throat microbiome data set (<xref rid="B34" ref-type="bibr">34</xref>), the estimated OTU proportions <inline-formula><tex-math id="TM0049" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$(\hat{\pi }_1, \hat{\pi }_2, \ldots , \hat{\pi }_{856})$\end{document}</tex-math></inline-formula> as well as the estimated over dispersion parameter <inline-formula><tex-math id="TM0050" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\hat{\theta }$\end{document}</tex-math></inline-formula> were obtained via the method of maximum likelihood (<xref rid="B35" ref-type="bibr">35</xref>).</p>
        </list-item>
        <list-item>
          <p>For sample <italic toggle="yes">i</italic>, the observed OTU proportions were randomly generated from a Dirichlet distribution: <inline-formula><tex-math id="TM0051" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$(p_{1i}, p_{2i},\ldots , p_{856 i}) \sim \text{Dirichlet}(\hat{\pi }_1, \hat{\pi }_2, \ldots , \hat{\pi }_{856}, \hat{\theta }).$\end{document}</tex-math></inline-formula></p>
        </list-item>
        <list-item>
          <p>The total count of OTUs for sample <italic toggle="yes">i</italic>, say <italic toggle="yes">n<sub>i</sub></italic>, was randomly drawn from a negative binomial distribution with mean 1000 and size 25.</p>
        </list-item>
        <list-item>
          <p>For sample <italic toggle="yes">i</italic>, the observed OTU counts were randomly generated from a multinomial distribution: (<italic toggle="yes">Z</italic><sub><italic toggle="yes">i</italic>1</sub>, <italic toggle="yes">Z</italic><sub><italic toggle="yes">i</italic>2</sub>, …, <italic toggle="yes">Z</italic><sub><italic toggle="yes">i</italic>856</sub>) ∼ Multinomial(<italic toggle="yes">n<sub>i</sub></italic>; <italic toggle="yes">p</italic><sub>1<italic toggle="yes">i</italic></sub>, <italic toggle="yes">p</italic><sub>2<italic toggle="yes">i</italic></sub>, …, <italic toggle="yes">p</italic><sub>856<italic toggle="yes">i</italic></sub>).</p>
        </list-item>
      </list>
      <p>Then, continuous and binary outcomes were generated under the linear model (Equation <xref rid="M3" ref-type="disp-formula">3</xref>) and the logistic model (Equation <xref rid="M4" ref-type="disp-formula">4</xref>) respectively as,<disp-formula id="M3"><label>(3)</label><tex-math id="TM0052" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}\begin{eqnarray*} Y_i = 0.5\text{ scale}(X_{1i}+ X_{2i}) +\sum _{j \in \mathcal {A}} \beta _j \text{ scale}(Z_{ij}) + \epsilon _i, \end{eqnarray*}\end{document}</tex-math></disp-formula><disp-formula id="M4"><label>(4)</label><tex-math id="TM0053" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}\begin{eqnarray*} \text{logit P}(Y_i =1) = 0.5\text{ scale}(X_{1i}+ X_{2i}) +\sum _{j \in \mathcal {A}} \beta _j \text{ scale}(Z_{ij}), \\ \end{eqnarray*}\end{document}</tex-math></disp-formula>where <italic toggle="yes">X</italic><sub>1<italic toggle="yes">i</italic></sub> and <italic toggle="yes">X</italic><sub>2<italic toggle="yes">i</italic></sub> were the covariates to be adjusted for, the error ε<sub><italic toggle="yes">i</italic></sub> ∼ N(0, 1) independently, <inline-formula><tex-math id="TM0054" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\mathcal {A}$\end{document}</tex-math></inline-formula> was the set of indices for outcome-associated OTUs, and the ‘scale’ function was used for standardization (mean 0 and standard deviation 1) across different samples. <italic toggle="yes">X</italic><sub>1<italic toggle="yes">i</italic></sub>’s were generated from a Bernoulli distribution with success probability 0.5, and <italic toggle="yes">X</italic><sub>2<italic toggle="yes">i</italic></sub>’s were generated to be correlated with the OTUs as, <inline-formula><tex-math id="TM0055" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$X_{2i} = \sum _{j \in \mathcal {A}}\text{scale}(Z_{ij}) + \text{N}(0, 1)$\end{document}</tex-math></inline-formula>.</p>
      <p>Under the null model we set β<sub><italic toggle="yes">j</italic></sub> = 0, for all <inline-formula><tex-math id="TM0056" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$j \in \mathcal {A}$\end{document}</tex-math></inline-formula>, and under the alternative model we studied three different scenarios: (I) the outcome was associated with a randomly selected set of OTUs, (II) the set of associated OTUs were phylogenetically related, (III) the outcome was associated with some abundant OTUs: Under the first scenario, we considered four different signal density (say <italic toggle="yes">D</italic>) levels: <inline-formula><tex-math id="TM0057" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$3 \%,\ 10 \% ,\ 20 \%$\end{document}</tex-math></inline-formula> and <inline-formula><tex-math id="TM0058" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$30\%$\end{document}</tex-math></inline-formula>. Under the second scenario, the OTUs were partitioned into a number of clusters based on the cophenetic distances in the real phylogenetic tree (<xref rid="B36" ref-type="bibr">36</xref>). For this purpose, we used the Partitioning Around Medoids (PAM) algorithm based on the optimal number of clusters, which maximized the average silhouette width in a search up to 30 clusters (<xref rid="B13" ref-type="bibr">13</xref>,<xref rid="B37" ref-type="bibr">37</xref>). Then, we randomly assigned the clusters into each iteration of the simulations as the signal-set. This was done to overcome the bias of specifying arbitrary cluster(s) as the signal-set throughout (<xref rid="B12" ref-type="bibr">12</xref>). Under the third scenario, we randomly picked 10 OTUs from the top 100 most abundant OTUs as the association signals. Additional simulations studies that include generating data under different schemes, with different library sizes, and from a different distribution such as negative binomial are presented in Section 3.1– Section 3.3 of the <xref rid="sup1" ref-type="supplementary-material">online Supplementary Data</xref> (<xref rid="sup1" ref-type="supplementary-material">Supplementary Tables S3– S6 and Supplementary Figures S3–S9</xref>). The regression coefficients {<inline-formula><tex-math id="TM0059" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\beta _j: j \in \mathcal {A}$\end{document}</tex-math></inline-formula>} were simulated from Uniform(−1, 1) distribution to represent mixed effect directions. We used 5000 replicates to evaluate the empirical type I error rate and 1000 replicates to evaluate the empirical power. For each of the 1000 replicates under the alternative model, the set of causal OTUs were randomly selected. We considered <italic toggle="yes">n</italic> = 100, 200 as sample sizes, and set the nominal level of significance α = 0.05 throughout this simulation.</p>
    </sec>
    <sec id="SEC3-2">
      <title>Simulation results</title>
      <p>The empirical type I error rates with a continuous outcome are reported in Table <xref rid="tbl1" ref-type="table">1</xref>, and those with a binary outcome are reported in Table <xref rid="tbl2" ref-type="table">2</xref>. All tests seem to have well controlled type I error rates across all configurations, except for MiHC, which tends to be conservative especially when the outcome is binary.</p>
      <table-wrap position="float" id="tbl1">
        <label>Table 1.</label>
        <caption>
          <p>Empirical type I error rates with a continuous outcome. Under the null model of scenario I, covariate <italic toggle="yes">X</italic><sub>2</sub> is associated with a randomly selected set of OTUs, and <italic toggle="yes">D</italic> denotes the corresponding signal density. Under the null model of scenario II, covariate <italic toggle="yes">X</italic><sub>2</sub> is associated with a set of OTUs that are phylogenetically related, and under the null model of scenario III, covariate <italic toggle="yes">X</italic><sub>2</sub> is associated with a set of abundant OTUs. <italic toggle="yes">n</italic> denotes the sample size</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <th rowspan="1" colspan="1">
                <italic toggle="yes">n</italic>
              </th>
              <th rowspan="1" colspan="1">Scenario</th>
              <th rowspan="1" colspan="1">AMAT</th>
              <th rowspan="1" colspan="1">aMiSPU</th>
              <th rowspan="1" colspan="1">LDM</th>
              <th rowspan="1" colspan="1">MiHC</th>
              <th rowspan="1" colspan="1">OMiAT</th>
              <th rowspan="1" colspan="1">OMiRKAT</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">I, D=3%</td>
              <td rowspan="1" colspan="1">0.0488</td>
              <td rowspan="1" colspan="1">0.0456</td>
              <td rowspan="1" colspan="1">0.0508</td>
              <td rowspan="1" colspan="1">0.0442</td>
              <td rowspan="1" colspan="1">0.0464</td>
              <td rowspan="1" colspan="1">0.0470</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">I, D=10%</td>
              <td rowspan="1" colspan="1">0.0476</td>
              <td rowspan="1" colspan="1">0.0504</td>
              <td rowspan="1" colspan="1">0.0464</td>
              <td rowspan="1" colspan="1">0.0444</td>
              <td rowspan="1" colspan="1">0.0460</td>
              <td rowspan="1" colspan="1">0.0452</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">100</td>
              <td rowspan="1" colspan="1">I, D=20%</td>
              <td rowspan="1" colspan="1">0.0434</td>
              <td rowspan="1" colspan="1">0.0516</td>
              <td rowspan="1" colspan="1">0.0474</td>
              <td rowspan="1" colspan="1">0.0458</td>
              <td rowspan="1" colspan="1">0.0494</td>
              <td rowspan="1" colspan="1">0.0502</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">I, D=30%</td>
              <td rowspan="1" colspan="1">0.0484</td>
              <td rowspan="1" colspan="1">0.0498</td>
              <td rowspan="1" colspan="1">0.0474</td>
              <td rowspan="1" colspan="1">0.0414</td>
              <td rowspan="1" colspan="1">0.0464</td>
              <td rowspan="1" colspan="1">0.0484</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">II</td>
              <td rowspan="1" colspan="1">0.0476</td>
              <td rowspan="1" colspan="1">0.0474</td>
              <td rowspan="1" colspan="1">0.0442</td>
              <td rowspan="1" colspan="1">0.0468</td>
              <td rowspan="1" colspan="1">0.0426</td>
              <td rowspan="1" colspan="1">0.0422</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">III</td>
              <td rowspan="1" colspan="1">0.0518</td>
              <td rowspan="1" colspan="1">0.0490</td>
              <td rowspan="1" colspan="1">0.0462</td>
              <td rowspan="1" colspan="1">0.0390</td>
              <td rowspan="1" colspan="1">0.0536</td>
              <td rowspan="1" colspan="1">0.0470</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">I, D=3%</td>
              <td rowspan="1" colspan="1">0.0490</td>
              <td rowspan="1" colspan="1">0.0496</td>
              <td rowspan="1" colspan="1">0.0540</td>
              <td rowspan="1" colspan="1">0.0542</td>
              <td rowspan="1" colspan="1">0.0506</td>
              <td rowspan="1" colspan="1">0.0510</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">I, D=10%</td>
              <td rowspan="1" colspan="1">0.0524</td>
              <td rowspan="1" colspan="1">0.0532</td>
              <td rowspan="1" colspan="1">0.0484</td>
              <td rowspan="1" colspan="1">0.0546</td>
              <td rowspan="1" colspan="1">0.0544</td>
              <td rowspan="1" colspan="1">0.0466</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">200</td>
              <td rowspan="1" colspan="1">I, D=20%</td>
              <td rowspan="1" colspan="1">0.0496</td>
              <td rowspan="1" colspan="1">0.0510</td>
              <td rowspan="1" colspan="1">0.0460</td>
              <td rowspan="1" colspan="1">0.0506</td>
              <td rowspan="1" colspan="1">0.0446</td>
              <td rowspan="1" colspan="1">0.0502</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">I, D=30%</td>
              <td rowspan="1" colspan="1">0.0452</td>
              <td rowspan="1" colspan="1">0.0464</td>
              <td rowspan="1" colspan="1">0.0448</td>
              <td rowspan="1" colspan="1">0.0542</td>
              <td rowspan="1" colspan="1">0.0450</td>
              <td rowspan="1" colspan="1">0.0498</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">II</td>
              <td rowspan="1" colspan="1">0.0470</td>
              <td rowspan="1" colspan="1">0.0504</td>
              <td rowspan="1" colspan="1">0.0462</td>
              <td rowspan="1" colspan="1">0.0532</td>
              <td rowspan="1" colspan="1">0.0456</td>
              <td rowspan="1" colspan="1">0.0486</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">III</td>
              <td rowspan="1" colspan="1">0.0522</td>
              <td rowspan="1" colspan="1">0.0480</td>
              <td rowspan="1" colspan="1">0.0466</td>
              <td rowspan="1" colspan="1">0.0532</td>
              <td rowspan="1" colspan="1">0.0522</td>
              <td rowspan="1" colspan="1">0.0472</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
      <table-wrap position="float" id="tbl2">
        <label>Table 2.</label>
        <caption>
          <p>Empirical type I error rates with a binary outcome. Under the null model of scenario I, covariate <italic toggle="yes">X</italic><sub>2</sub> is associated with a randomly selected set of OTUs, and <italic toggle="yes">D</italic> denotes the corresponding signal density. Under the null model of scenario II, covariate <italic toggle="yes">X</italic><sub>2</sub> is associated with a set of OTUs that are phylogenetically related, and under the null model of scenario III, covariate <italic toggle="yes">X</italic><sub>2</sub> is associated with a set of abundant OTUs. <italic toggle="yes">n</italic> denotes the sample size</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <th rowspan="1" colspan="1">
                <italic toggle="yes">n</italic>
              </th>
              <th rowspan="1" colspan="1">Scenario</th>
              <th rowspan="1" colspan="1">AMAT</th>
              <th rowspan="1" colspan="1">aMiSPU</th>
              <th rowspan="1" colspan="1">LDM</th>
              <th rowspan="1" colspan="1">MiHC</th>
              <th rowspan="1" colspan="1">OMiAT</th>
              <th rowspan="1" colspan="1">OMiRKAT</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">I, D=3%</td>
              <td rowspan="1" colspan="1">0.0482</td>
              <td rowspan="1" colspan="1">0.0498</td>
              <td rowspan="1" colspan="1">0.0446</td>
              <td rowspan="1" colspan="1">0.0210</td>
              <td rowspan="1" colspan="1">0.0486</td>
              <td rowspan="1" colspan="1">0.0462</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">I, D=10%</td>
              <td rowspan="1" colspan="1">0.0496</td>
              <td rowspan="1" colspan="1">0.0502</td>
              <td rowspan="1" colspan="1">0.0468</td>
              <td rowspan="1" colspan="1">0.0224</td>
              <td rowspan="1" colspan="1">0.0510</td>
              <td rowspan="1" colspan="1">0.0478</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">100</td>
              <td rowspan="1" colspan="1">I, D=20%</td>
              <td rowspan="1" colspan="1">0.0514</td>
              <td rowspan="1" colspan="1">0.0486</td>
              <td rowspan="1" colspan="1">0.0492</td>
              <td rowspan="1" colspan="1">0.0252</td>
              <td rowspan="1" colspan="1">0.0512</td>
              <td rowspan="1" colspan="1">0.0474</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">I, D=30%</td>
              <td rowspan="1" colspan="1">0.0518</td>
              <td rowspan="1" colspan="1">0.0478</td>
              <td rowspan="1" colspan="1">0.0468</td>
              <td rowspan="1" colspan="1">0.0250</td>
              <td rowspan="1" colspan="1">0.0552</td>
              <td rowspan="1" colspan="1">0.0496</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">II</td>
              <td rowspan="1" colspan="1">0.0538</td>
              <td rowspan="1" colspan="1">0.0534</td>
              <td rowspan="1" colspan="1">0.0494</td>
              <td rowspan="1" colspan="1">0.0284</td>
              <td rowspan="1" colspan="1">0.0534</td>
              <td rowspan="1" colspan="1">0.0430</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">III</td>
              <td rowspan="1" colspan="1">0.0530</td>
              <td rowspan="1" colspan="1">0.0500</td>
              <td rowspan="1" colspan="1">0.0498</td>
              <td rowspan="1" colspan="1">0.0364</td>
              <td rowspan="1" colspan="1">0.0488</td>
              <td rowspan="1" colspan="1">0.0532</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">I, D=3%</td>
              <td rowspan="1" colspan="1">0.0514</td>
              <td rowspan="1" colspan="1">0.0484</td>
              <td rowspan="1" colspan="1">0.0484</td>
              <td rowspan="1" colspan="1">0.0196</td>
              <td rowspan="1" colspan="1">0.0516</td>
              <td rowspan="1" colspan="1">0.0446</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">I, D=10%</td>
              <td rowspan="1" colspan="1">0.0502</td>
              <td rowspan="1" colspan="1">0.0494</td>
              <td rowspan="1" colspan="1">0.0496</td>
              <td rowspan="1" colspan="1">0.0176</td>
              <td rowspan="1" colspan="1">0.0490</td>
              <td rowspan="1" colspan="1">0.0430</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">200</td>
              <td rowspan="1" colspan="1">I, D=20%</td>
              <td rowspan="1" colspan="1">0.0518</td>
              <td rowspan="1" colspan="1">0.0492</td>
              <td rowspan="1" colspan="1">0.0538</td>
              <td rowspan="1" colspan="1">0.0216</td>
              <td rowspan="1" colspan="1">0.0496</td>
              <td rowspan="1" colspan="1">0.0480</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">I, D=30%</td>
              <td rowspan="1" colspan="1">0.0516</td>
              <td rowspan="1" colspan="1">0.0474</td>
              <td rowspan="1" colspan="1">0.0518</td>
              <td rowspan="1" colspan="1">0.0200</td>
              <td rowspan="1" colspan="1">0.0500</td>
              <td rowspan="1" colspan="1">0.0470</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">II</td>
              <td rowspan="1" colspan="1">0.0506</td>
              <td rowspan="1" colspan="1">0.0488</td>
              <td rowspan="1" colspan="1">0.0470</td>
              <td rowspan="1" colspan="1">0.0206</td>
              <td rowspan="1" colspan="1">0.0470</td>
              <td rowspan="1" colspan="1">0.0426</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">III</td>
              <td rowspan="1" colspan="1">0.0544</td>
              <td rowspan="1" colspan="1">0.0522</td>
              <td rowspan="1" colspan="1">0.0488</td>
              <td rowspan="1" colspan="1">0.0354</td>
              <td rowspan="1" colspan="1">0.0454</td>
              <td rowspan="1" colspan="1">0.0454</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
      <p>The empirical powers with a continuous outcome are presented in Figure <xref rid="F1" ref-type="fig">1</xref> (Scenario I), Figure <xref rid="F2" ref-type="fig">2</xref> (Scenario II), and Figure <xref rid="F3" ref-type="fig">3</xref> (Scenario III). We observe that AMAT has the best performance in most cases. Under Scenario I, only MiHC was able to outperform AMAT in the sole setting where the density of association signals was extremely sparse (i.e. 3%). MiHC quickly lost its superiority as the signal density increased, and AMAT was the most powerful test thereafter. Considering sample size <italic toggle="yes">n</italic> = 100 with scenario I, where the signal-set consisted of a randomly selected set of OTUs, as an example, AMAT had powers of 44.7%, 49.8% and 52.5% under signal densities 10%, 20% and 30%, respectively, while the corresponding powers of the first runner-ups were only 33.6%, 35.4% and 38.3%. Under Scenario II, where the signal-set was characterized by phylogenetic relationships, the power of AMAT under sample size <italic toggle="yes">n</italic> = 100 was 50.1%, which was 34.3% higher than that of the first runner-up. Under Scenario III, i.e. when association signals were abundant OTUs, most tests were powerful, and MiHC was slightly better than the rest given the fact that association signals were relatively sparse (10 abundant OTUs out of 856 OTUs).</p>
      <fig position="float" id="F1">
        <label>Figure 1.</label>
        <caption>
          <p>Empirical powers and the corresponding 95% confidence intervals obtained with a continuous outcome under scenario I.</p>
        </caption>
        <graphic xlink:href="lqab120fig1" position="float"/>
      </fig>
      <fig position="float" id="F2">
        <label>Figure 2.</label>
        <caption>
          <p>Empirical powers and the corresponding 95% confidence intervals obtained with a continuous outcome under scenario II.</p>
        </caption>
        <graphic xlink:href="lqab120fig2" position="float"/>
      </fig>
      <fig position="float" id="F3">
        <label>Figure 3.</label>
        <caption>
          <p>Empirical powers and the corresponding 95% confidence intervals obtained with a continuous outcome under scenario III.</p>
        </caption>
        <graphic xlink:href="lqab120fig3" position="float"/>
      </fig>
      <p>The empirical powers with a binary outcome are presented in Figure <xref rid="F4" ref-type="fig">4</xref> (Scenario I), Figure <xref rid="F5" ref-type="fig">5</xref> (Scenario II), and Figure <xref rid="F6" ref-type="fig">6</xref> (Scenario III). In this case, AMAT had the best performance throughout all scenarios being considered. Under Scenario I and II, OMiAT was the second most powerful test, and under Scenario III, LDM became powerful and had powers similar to AMAT. As observed in Table <xref rid="tbl2" ref-type="table">2</xref>, MiHC tends to be conservative when the outcome variable is binary. Correspondingly, MiHC tends to less powerful with a binary outcome even when the signal density is low in Figures <xref rid="F4" ref-type="fig">4</xref> and <xref rid="F6" ref-type="fig">6</xref>.</p>
      <fig position="float" id="F4">
        <label>Figure 4.</label>
        <caption>
          <p>Empirical powers and the corresponding 95% confidence intervals obtained with a binary outcome under scenario I.</p>
        </caption>
        <graphic xlink:href="lqab120fig4" position="float"/>
      </fig>
      <fig position="float" id="F5">
        <label>Figure 5.</label>
        <caption>
          <p>Empirical powers and the corresponding 95% confidence intervals obtained with a binary outcome under scenario II.</p>
        </caption>
        <graphic xlink:href="lqab120fig5" position="float"/>
      </fig>
      <fig position="float" id="F6">
        <label>Figure 6.</label>
        <caption>
          <p>Empirical powers and the corresponding 95% confidence intervals obtained with a binary outcome under scenario III.</p>
        </caption>
        <graphic xlink:href="lqab120fig6" position="float"/>
      </fig>
      <p>To summarize, the proposed method AMAT tends to be the most powerful statistical association analysis method than many existing methods under most scenarios considered in our comprehensive numerical studies, except for the only scenario where the association signal density is extremely sparse (e.g. 3%). The MiHC test is specifically designed to tackle this scenario of very sparse signal densities. However, the performance of MiHC with a binary outcome variable often is inadequate. Overall, the simulation results clearly depict the highly robust and powerful performance of AMAT, and thus it can be considered as an efficient tool for microbiome association analysis.</p>
    </sec>
    <sec id="SEC3-3">
      <title>Application to throat microbiome study on smoking</title>
      <p>Cigarette smoking is associated with an increased risk of acute respiratory tract infections. In a study (<xref rid="B34" ref-type="bibr">34</xref>) investigating the effect of cigarette smoking on the upper airway bacterial communities, swab samples were collected from the right and left nasopharynx and oropharynx of 29 smoking and 33 non-smoking healthy asymptomatic adults. Denoised 16S rRNA gene sequences (region V1−V2) were analysed using the QIIME pipeline (<xref rid="B38" ref-type="bibr">38</xref>) to construct the OTUs. Further details on data collection and processing can be found in the original paper (<xref rid="B34" ref-type="bibr">34</xref>). We used the left oropharyngeal samples to test the association between smoking status and microbial community composition. Potential confounders, which included gender and antibiotic usage within last 3 months, were adjusted for in our analysis. Quality control and data filtering steps resulted in an OTU table with 856 OTUs from 60 samples of which 28 were smokers. These 856 OTUs were further classified into different taxonomic levels (115 genera, 57 families, 27 orders, 16 classes and 11 phyla).</p>
      <p>We first examined whether there was an overall shift in the composition of oropharyngeal microbiome community, consisting of the 856 taxa, between the smokers and the non-smokers. We used 10 000 permutations for all tests, and the corresponding <italic toggle="yes">P</italic>-values of AMAT, aMiSPU, LDM, MiHC, OMiAT and OMiRKAT were 0.0038, 0.0050, 0.0023, 0.4984, 0.0144 and 0.0070, respectively. Thus, all tests except MiHC showed that the association between microbiome profiles and smoking status was significant after adjusting for the potential confounders, which was consistent with the previous results (<xref rid="B8" ref-type="bibr">8</xref>,<xref rid="B9" ref-type="bibr">9</xref>). As mentioned earlier, besides being a powerful global test, AMAT can provide useful information on identifying taxa that are likely to be outcome-associated. The importance of members in the testing subset can be ranked based on the corresponding sample DCs. In this case, AMAT generated a testing subset of 317 OTUs, which was almost 63% reduction in the dimension of the feature space. Interestingly, almost 76% of OTUs from the testing subset belonged to only three phyla: <italic toggle="yes">Firmicutes, Bacteroidetes</italic> and <italic toggle="yes">Proteobacteria</italic>, which indicated that the overall community-level significant association with smoking might had been primarily driven by changes in these phyla.</p>
      <p>Changes in the structure of the microbiota that are associated with the outcome of interest can occur at any taxonomic rank, or along any relevant branch of the phylogenetic tree. For example, it is well known that changes at the phylum level (e.g. <italic toggle="yes">Firmicutes</italic> and <italic toggle="yes">Bacteroidetes</italic>) are reported to be associated with obesity (<xref rid="B39" ref-type="bibr">39</xref>). On the other hand, strain level associations with the metabolism of drugs in human have been reported (<xref rid="B40" ref-type="bibr">40</xref>). Hence, it was also of interest to conduct a comprehensive association analysis among all taxonomic ranks to elucidate the relationship between smoking status and the oropharyngeal microbiota under consideration. Specifically, we conducted association analysis at the levels of genus, family, order, class and phylum with taxa-sets that contain at least five taxa. Consequently, 35 genera, 29 families, 17 orders, 14 classes and 9 phyla were subjected to association analysis. The family wise error rate (FWER) was controlled at 0.05 within each taxonomic rank via the Bonferroni correction. The results indicated that AMAT and OMiAT had a clear advantage in terms of identifying significant differences with AMAT providing maximum number of discoveries (see Figure <xref rid="F7" ref-type="fig">7</xref>). Overall, AMAT made eight discoveries of which four were unique to it (<italic toggle="yes">Veillonella</italic> genus, <italic toggle="yes">Coriobacteriales</italic> order, <italic toggle="yes">Coriobacteriia</italic> class and <italic toggle="yes">Firmicutes</italic> phylum), while four were also discovered by OMiAT. Several microbiome studies found <italic toggle="yes">Firmicutes</italic> to be associated with smoking (<xref rid="B41" ref-type="bibr">41</xref>,<xref rid="B42" ref-type="bibr">42</xref>). The discoveries made by LDM did not coincide with those of any other tests except for a case at the genus level. The original study (<xref rid="B34" ref-type="bibr">34</xref>), which conducted univariate association testing at both family level and genus level, found <italic toggle="yes">Veillonellaceae</italic> family along with <italic toggle="yes">Megasphaera</italic> and <italic toggle="yes">Veillonella</italic> genera from the <italic toggle="yes">Firmicutes</italic> phylum, to be included in the set of taxa that distinguished the left oropharyngeal microbial communities of smokers from nonsmokers (see Table 3 and Table S3 of (<xref rid="B34" ref-type="bibr">34</xref>)). Our multivariate analysis revealed <italic toggle="yes">Veillonellaceae</italic> as a significant family, which was identified only by AMAT and OMiAT. Besides, AMAT identified both <italic toggle="yes">Veillonella</italic> and <italic toggle="yes">Megasphaera</italic> genera, whereas only the latter was identified by OMiAT. No other findings from the competing tests matched with the discoveries of the original study. These results were consistent with our simulation studies in the sense that AMAT and OMiAT tend to be the two most powerful tests in most of the simulation settings. On the other hand, MiHC and aMiSPU failed to identify even a single significant taxon across all taxonomic ranks being considered, possibly due to power loss from a smaller sample size of this data set.</p>
      <fig position="float" id="F7">
        <label>Figure 7.</label>
        <caption>
          <p>Venn diagram of detected associations between smoking status and oropharyngeal microbiota at different taxonomic ranks. Methods omitted at a rank indicates that no significance are detected at that rank.</p>
        </caption>
        <graphic xlink:href="lqab120fig7" position="float"/>
      </fig>
    </sec>
    <sec id="SEC3-4">
      <title>Application to gut microbiome study on body mass index</title>
      <p>The human health is strongly affected by one’s diet, which is known to partly modulate the gut microbial community. For instance, dysbiosis of the gut microbiome has been shown to be associated with obesity (<xref rid="B39" ref-type="bibr">39</xref>). In a previous research examining the relationship between dietary patterns and gut microbiome composition (<xref rid="B43" ref-type="bibr">43</xref>), fecal samples from 98 healthy volunteers were collected, the V1–V2 region of the 16S rRNA genes were sequenced, and the QIIME pipeline (<xref rid="B38" ref-type="bibr">38</xref>) was used to obtain the OTUs. We refer to the original paper (<xref rid="B43" ref-type="bibr">43</xref>) for further details. Here, our objective is to test for a possible association between the gut microbiota and body mass index (BMI). A filtering to include OTUs with counts of more than three in more than three samples resulted in a community of 557 OTUs, which were further taxonomically classified into 31 genera, 17 families, 7 orders, 8 classes and 6 phyla.</p>
      <p>At the community-level association testing, which involved all 557 OTUs, all tests except aMiSPU and LDM were able to detect a significant association between BMI and the gut microbial community (<italic toggle="yes">P</italic>-values of AMAT, aMiSPU, LDM, MiHC, OMiAT and OMiRKAT were 0.0293, 0.0976, 0.1370, 0.0241, 0.0471 and 0.0345 respectively). The original study (<xref rid="B43" ref-type="bibr">43</xref>) also identified BMI to be significantly associated with the microbiome composition (see Table S1 of (<xref rid="B43" ref-type="bibr">43</xref>)). Next, we conducted association analysis at different taxonomic ranks with taxa-sets that contain at least five taxa. As before, the Bonferroni correction was used to control the FWER. The results showed that no test uniformly outperformed others across all taxonomic ranks. At the family level, both MiHC and OMiAT identified <italic toggle="yes">Veillonellaceae</italic>, whereas aMiSPU, LDM, and OMiRKAT identified <italic toggle="yes">Lachnospiraceae</italic>. But, AMAT showed superiority by identifying both <italic toggle="yes">Veillonellaceae</italic> and <italic toggle="yes">Lachnospiraceae</italic>, which had been found to be associated with BMI in other studies as well (<xref rid="B44" ref-type="bibr">44</xref>,<xref rid="B45" ref-type="bibr">45</xref>). On the other hand, AMAT did not detect any significant genera, while <italic toggle="yes">Ruminococcaceae Incertae Sedis</italic> was identified by MiHC, and <italic toggle="yes">Lachnospiraceae Incertae Sedis</italic> was identified by aMiSPU, LDM, and OMiRKAT . Furthermore, LDM, which failed to detect the community-level association, identified three additional taxa-sets (<italic toggle="yes">Firmicutes</italic> phylum, <italic toggle="yes">Clostridia class</italic> and <italic toggle="yes">Clostridiales</italic> order). But these findings were not consistent with the corresponding results from any of the other tests considered.</p>
    </sec>
  </sec>
  <sec sec-type="conclusions" id="SEC4">
    <title>DISCUSSION AND CONCLUSION</title>
    <p>In this paper, we have focused on the problem of statistical multivariate association analysis within the context of microbiome studies and proposed the AMAT method, a new testing strategy that instills the benefits of feature selection into the multivariate association testing framework, which has not been attempted in many popular existing association analysis methods such as OMiRKAT (<xref rid="B8" ref-type="bibr">8</xref>), aMiSPU (<xref rid="B9" ref-type="bibr">9</xref>) and OMiAT (<xref rid="B12" ref-type="bibr">12</xref>). One major contribution of AMAT is that, by recognizing the existing multivariate tests’ vulnerability to the adverse effects of accumulated noise features, AMAT introduces a novel perspective of utilizing dimension reduction techniques under the multivariate microbiome association analysis framework to achieve extremely robust and powerful results across a wide range of scenarios. The recently developed MiHC method has recognized the same phenomenon, but it only provides solution to scenarios with very sparse association signals (<xref rid="B13" ref-type="bibr">13</xref>). On the other hand, data-adaptive feature selection embedded in AMAT makes it more flexible and robust to different levels of association signal densities, and has been shown in our numerical studies to be much more powerful than MiHC except for few extremely sparse scenarios. Moreover, results of two real data application examples indicate that AMAT serves as a highly robust and powerful test for microbiome association analysis. A third example presented in Section 3.4 of the <xref rid="sup1" ref-type="supplementary-material">online Supplementary Data</xref> also supports this conclusion. Therefore, our new AMAT method fills an important gap in multivariate microbiome association analysis, and will be an extremely appealing tool for association analysis when the underlying signal density is neither too sparse nor too dense.</p>
    <p>The performance of AMAT also depends on the efficiency of the intermediate feature selection procedure. We have utilized the distance correlation based sure independence screening framework which not only possesses the sure screening property, but also is highly robust to model misspecification (<xref rid="B26" ref-type="bibr">26</xref>). Additionally, we have implemented a new thresholding strategy that determines the dimension of the reduced feature space (say <italic toggle="yes">d</italic>) in a data-driven manner. Researchers often prefix <italic toggle="yes">d</italic> as [<italic toggle="yes">n</italic>/<italic toggle="yes">log</italic>(<italic toggle="yes">n</italic>)] ([.] denotes the floor function) or <italic toggle="yes">n</italic> − 1 (<xref rid="B19" ref-type="bibr">19</xref>,<xref rid="B26" ref-type="bibr">26</xref>), which have been shown to be versatile in classic high-dimensional inference. Such choices, however, may not be appropriate for the relatively small sample sizes frequently encountered in most current microbiome association analyses. Among some popular feature selection tools (<xref rid="B19" ref-type="bibr">19</xref>,<xref rid="B26" ref-type="bibr">26</xref>,<xref rid="B27" ref-type="bibr">27</xref>,<xref rid="B46" ref-type="bibr">46</xref>) evaluated in our numerical studies, the feature selection strategy outlined in Algorithm 1 had the optimum performance within the context of the current paper (see details in Section 1 of the <xref rid="sup1" ref-type="supplementary-material">online Supplementary Data</xref>). It is of future research interest to further boost the power of AMAT by sharping the intermediate feature selection tool embedded in it.</p>
    <p>Unlike many previous microbiome community level association analysis tools, which have incorporated the microbial phylogenetic tree into association analysis (<xref rid="B8" ref-type="bibr">8</xref>,<xref rid="B9" ref-type="bibr">9</xref>,<xref rid="B12" ref-type="bibr">12</xref>,<xref rid="B13" ref-type="bibr">13</xref>), the role of phylogenetic tree has been downplayed in the current paper. One major concern against this idea is due to computational reasons. The intermediate feature selection step in each of the different permutations (used for establishing significance) results in different subsets of OTUs kept for association testing. This causes different pruning of the phylogenetic tree in the testing stage (if phylogenetic information is accommodated in association testing), which can be computationally expensive when either the number of OTUs or the number of permutations is large. Moreover, outcome-associated microbial changes can occur at any taxonomic ranks and/or along any relevant branch of the phylogenetic tree (<xref rid="B2" ref-type="bibr">2</xref>). When the analysis unit of AMAT is a group of OTUs belonging to some particular relatively low taxonomic rank (e.g. genus or family), all OTUs in the group being tested share relatively homologous phylogeny, and the phylogenetic tree is expected to play a less important role in this type of association analysis. Even when the tree plays an active role in microbiome-outcome association (e.g. simulation scenario II), our numerical studies have demonstrated the robustness of AMAT under such scenarios.</p>
    <p>The size of data sets is exploding as metagenomic sequencing technologies keep evolving, and there is an even more pressing need to perform a more powerful microbiome association analysis so that true association signals can be detected amid a huge amount of background noises. Our research demonstrates that implementation of feature selection can improve the performance of microbiome association analysis, and correspondingly AMAT serves as a highly robust and powerful taxa-set based multivariate association testing tool. Furthermore, its testing subset can provide insights on the taxa that are more likely to drive the detected overall association, and thus can lead to cost effective downstream validation and functional studies. Finally, the good performance of AMAT comes at a price. Since the feature selection algorithm is implemented in each permutation used for <italic toggle="yes">P</italic>-value calculation, the computational cost of AMAT is typically larger than its competitors. Taking a simulation under Scenario II with <italic toggle="yes">n</italic> = 100 as an example, the average computation time of AMAT over 1000 replicates is around 100 s, while that of LDM and MiHC is around 70 s. OMiRKAT, the fastest among the tests considered, takes only a few seconds. Fortunately, the relatively small sample size of microbiome data makes AMAT still feasible from a computational perspective.</p>
  </sec>
  <sec sec-type="data-availability" id="SEC5">
    <title>DATA AVAILABILITY</title>
    <p>The R code to implement the proposed AMAT method is available at <ext-link xlink:href="https://github.com/kzb193/AMAT" ext-link-type="uri">https://github.com/kzb193/AMAT</ext-link>. The throat microbiome data set and gut microbiome data set used to demonstrate AMAT in this study were accessed from previous publications (<xref rid="B34" ref-type="bibr">34</xref>) and (<xref rid="B43" ref-type="bibr">43</xref>), respectively.</p>
  </sec>
  <sec sec-type="supplementary-material" id="SEC6">
    <title>SUPPLEMENTARY DATA</title>
    <p><ext-link xlink:href="https://academic.oup.com/nargab/article-lookup/doi/10.1093/nargab/lqab120#supplementary-data" ext-link-type="uri">Supplementary data</ext-link> are available at NARGAB online.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>lqab120_Supplemental_File</label>
      <media xlink:href="lqab120_supplemental_file.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ACK1">
    <title>ACKNOWLEDGEMENTS</title>
    <p>The authors acknowledge comments and suggestions from the Editor, the Associate Editor and two anonymous reviewers.</p>
  </ack>
  <sec id="SEC7">
    <title>FUNDING</title>
    <p>No external funding.</p>
    <p><italic toggle="yes">Conflict of interest statement</italic>. None declared.</p>
  </sec>
  <ref-list id="REF1">
    <title>REFERENCES</title>
    <ref id="B1">
      <label>1.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Virgin</surname><given-names>H.W.</given-names></string-name>, <string-name><surname>Todd</surname><given-names>J.A.</given-names></string-name></person-group>  <article-title>Metagenomics and personalized medicine</article-title>. <source>Cell</source>. <year>2011</year>; <volume>147</volume>:<fpage>44</fpage>–<lpage>56</lpage>.<pub-id pub-id-type="pmid">21962506</pub-id></mixed-citation>
    </ref>
    <ref id="B2">
      <label>2.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gilbert</surname><given-names>J.A.</given-names></string-name>, <string-name><surname>Quinn</surname><given-names>R.A.</given-names></string-name>, <string-name><surname>Debelius</surname><given-names>J.</given-names></string-name>, <string-name><surname>Xu</surname><given-names>Z.Z.</given-names></string-name>, <string-name><surname>Morton</surname><given-names>J.</given-names></string-name>, <string-name><surname>Garg</surname><given-names>N.</given-names></string-name>, <string-name><surname>Jansson</surname><given-names>J.K.</given-names></string-name>, <string-name><surname>Dorrestein</surname><given-names>P.C.</given-names></string-name>, <string-name><surname>Knight</surname><given-names>R.</given-names></string-name></person-group>  <article-title>Microbiome-wide association studies link dynamic microbial consortia to disease</article-title>. <source>Nature</source>. <year>2016</year>; <volume>535</volume>:<fpage>94</fpage>–<lpage>103</lpage>.<pub-id pub-id-type="pmid">27383984</pub-id></mixed-citation>
    </ref>
    <ref id="B3">
      <label>3.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Surana</surname><given-names>N.K.</given-names></string-name>, <string-name><surname>Kasper</surname><given-names>D.L.</given-names></string-name></person-group>  <article-title>Moving beyond microbiome-wide associations to causal microbe identification</article-title>. <source>Nature</source>. <year>2017</year>; <volume>552</volume>:<fpage>244</fpage>–<lpage>247</lpage>.<pub-id pub-id-type="pmid">29211710</pub-id></mixed-citation>
    </ref>
    <ref id="B4">
      <label>4.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Callahan</surname><given-names>B.J.</given-names></string-name>, <string-name><surname>McMurdie</surname><given-names>P.J.</given-names></string-name>, <string-name><surname>Holmes</surname><given-names>S.P.</given-names></string-name></person-group>  <article-title>Exact sequence variants should replace operational taxonomic units in marker-gene data analysis</article-title>. <source>ISME J.</source>  <year>2017</year>; <volume>11</volume>:<fpage>2639</fpage>–<lpage>2643</lpage>.<pub-id pub-id-type="pmid">28731476</pub-id></mixed-citation>
    </ref>
    <ref id="B5">
      <label>5.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wu</surname><given-names>M.C.</given-names></string-name>, <string-name><surname>Lee</surname><given-names>S.</given-names></string-name>, <string-name><surname>Cai</surname><given-names>T.</given-names></string-name>, <string-name><surname>Li</surname><given-names>Y.</given-names></string-name>, <string-name><surname>Boehnke</surname><given-names>M.</given-names></string-name>, <string-name><surname>Lin</surname><given-names>X.</given-names></string-name></person-group>  <article-title>Rare-variant association testing for sequencing data with the sequence kernel association test</article-title>. <source>Am. J. Hum. Genet.</source>  <year>2011</year>; <volume>89</volume>:<fpage>82</fpage>–<lpage>93</lpage>.<pub-id pub-id-type="pmid">21737059</pub-id></mixed-citation>
    </ref>
    <ref id="B6">
      <label>6.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lee</surname><given-names>S.</given-names></string-name>, <string-name><surname>Abecasis</surname><given-names>G.R.</given-names></string-name>, <string-name><surname>Boehnke</surname><given-names>M.</given-names></string-name>, <string-name><surname>Lin</surname><given-names>X.</given-names></string-name></person-group>  <article-title>Rare-variant association analysis: study designs and statistical tests</article-title>. <source>Am. J. Hum. Genet.</source>  <year>2014</year>; <volume>95</volume>:<fpage>5</fpage>–<lpage>23</lpage>.<pub-id pub-id-type="pmid">24995866</pub-id></mixed-citation>
    </ref>
    <ref id="B7">
      <label>7.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhan</surname><given-names>X.</given-names></string-name>, <string-name><surname>Zhao</surname><given-names>N.</given-names></string-name>, <string-name><surname>Plantinga</surname><given-names>A.</given-names></string-name>, <string-name><surname>Thornton</surname><given-names>T.A.</given-names></string-name>, <string-name><surname>Conneely</surname><given-names>K.N.</given-names></string-name>, <string-name><surname>Epstein</surname><given-names>M.P.</given-names></string-name>, <string-name><surname>Wu</surname><given-names>M.C.</given-names></string-name></person-group>  <article-title>Powerful genetic association analysis for common or rare variants with high-dimensional structured traits</article-title>. <source>Genetics</source>. <year>2017</year>; <volume>206</volume>:<fpage>1779</fpage>–<lpage>1790</lpage>.<pub-id pub-id-type="pmid">28642271</pub-id></mixed-citation>
    </ref>
    <ref id="B8">
      <label>8.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhao</surname><given-names>N.</given-names></string-name>, <string-name><surname>Chen</surname><given-names>J.</given-names></string-name>, <string-name><surname>Carroll</surname><given-names>I.M.</given-names></string-name>, <string-name><surname>Ringel-Kulka</surname><given-names>T.</given-names></string-name>, <string-name><surname>Epstein</surname><given-names>M.P.</given-names></string-name>, <string-name><surname>Zhou</surname><given-names>H.</given-names></string-name>, <string-name><surname>Zhou</surname><given-names>J.J.</given-names></string-name>, <string-name><surname>Ringel</surname><given-names>Y.</given-names></string-name>, <string-name><surname>Li</surname><given-names>H.</given-names></string-name>, <string-name><surname>Wu</surname><given-names>M.C.</given-names></string-name></person-group>  <article-title>Testing in microbiome-profiling studies with MiRKAT, the microbiome regression-based kernel association test</article-title>. <source>Am. J. Hum. Genet.</source>  <year>2015</year>; <volume>96</volume>:<fpage>797</fpage>–<lpage>807</lpage>.<pub-id pub-id-type="pmid">25957468</pub-id></mixed-citation>
    </ref>
    <ref id="B9">
      <label>9.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wu</surname><given-names>C.</given-names></string-name>, <string-name><surname>Chen</surname><given-names>J.</given-names></string-name>, <string-name><surname>Kim</surname><given-names>J.</given-names></string-name>, <string-name><surname>Pan</surname><given-names>W.</given-names></string-name></person-group>  <article-title>An adaptive association test for microbiome data</article-title>. <source>Genome Med.</source>  <year>2016</year>; <volume>8</volume>:<fpage>56</fpage><pub-id pub-id-type="pmid">27198579</pub-id></mixed-citation>
    </ref>
    <ref id="B10">
      <label>10.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tang</surname><given-names>Z.-Z.</given-names></string-name>, <string-name><surname>Chen</surname><given-names>G.</given-names></string-name>, <string-name><surname>Alekseyenko</surname><given-names>A.V.</given-names></string-name></person-group>  <article-title>PERMANOVA-S: association test for microbial community composition that accommodates confounders and multiple distances</article-title>. <source>Bioinformatics</source>. <year>2016</year>; <volume>32</volume>:<fpage>2618</fpage>–<lpage>2625</lpage>.<pub-id pub-id-type="pmid">27197815</pub-id></mixed-citation>
    </ref>
    <ref id="B11">
      <label>11.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Plantinga</surname><given-names>A.</given-names></string-name>, <string-name><surname>Zhan</surname><given-names>X.</given-names></string-name>, <string-name><surname>Zhao</surname><given-names>N.</given-names></string-name>, <string-name><surname>Chen</surname><given-names>J.</given-names></string-name>, <string-name><surname>Jenq</surname><given-names>R.R.</given-names></string-name>, <string-name><surname>Wu</surname><given-names>M.C.</given-names></string-name></person-group>  <article-title>MiRKAT-S: a community-level test of association between the microbiota and survival times</article-title>. <source>Microbiome</source>. <year>2017</year>; <volume>5</volume>:<fpage>17</fpage><pub-id pub-id-type="pmid">28179014</pub-id></mixed-citation>
    </ref>
    <ref id="B12">
      <label>12.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Koh</surname><given-names>H.</given-names></string-name>, <string-name><surname>Blaser</surname><given-names>M.J.</given-names></string-name>, <string-name><surname>Li</surname><given-names>H.</given-names></string-name></person-group>  <article-title>A powerful microbiome-based association test and a microbial taxa discovery framework for comprehensive association mapping</article-title>. <source>Microbiome</source>. <year>2017</year>; <volume>5</volume>:<fpage>45</fpage><pub-id pub-id-type="pmid">28438217</pub-id></mixed-citation>
    </ref>
    <ref id="B13">
      <label>13.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Koh</surname><given-names>H.</given-names></string-name>, <string-name><surname>Zhao</surname><given-names>N.</given-names></string-name></person-group>  <article-title>A powerful microbial group association test based on the higher criticism analysis for sparse microbial association signals</article-title>. <source>Microbiome</source>. <year>2020</year>; <volume>8</volume>:<fpage>63</fpage><pub-id pub-id-type="pmid">32393397</pub-id></mixed-citation>
    </ref>
    <ref id="B14">
      <label>14.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hu</surname><given-names>Y.-J.</given-names></string-name>, <string-name><surname>Satten</surname><given-names>G.A.</given-names></string-name></person-group>  <article-title>Testing hypotheses about the microbiome using the linear decomposition model (LDM)</article-title>. <source>Bioinformatics</source>. <year>2020</year>; <volume>36</volume>:<fpage>4106</fpage>–<lpage>4115</lpage>.<pub-id pub-id-type="pmid">32315393</pub-id></mixed-citation>
    </ref>
    <ref id="B15">
      <label>15.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Song</surname><given-names>Y.</given-names></string-name>, <string-name><surname>Zhao</surname><given-names>H.</given-names></string-name>, <string-name><surname>Wang</surname><given-names>T.</given-names></string-name></person-group>  <article-title>An adaptive independence test for microbiome community data</article-title>. <source>Biometrics</source>. <year>2020</year>; <volume>76</volume>:<fpage>414</fpage>–<lpage>426</lpage>.<pub-id pub-id-type="pmid">31538660</pub-id></mixed-citation>
    </ref>
    <ref id="B16">
      <label>16.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pan</surname><given-names>W.</given-names></string-name>, <string-name><surname>Kim</surname><given-names>J.</given-names></string-name>, <string-name><surname>Zhang</surname><given-names>Y.</given-names></string-name>, <string-name><surname>Shen</surname><given-names>X.</given-names></string-name>, <string-name><surname>Wei</surname><given-names>P.</given-names></string-name></person-group>  <article-title>A powerful and adaptive association test for rare variants</article-title>. <source>Genetics</source>. <year>2014</year>; <volume>197</volume>:<fpage>1081</fpage>–<lpage>1095</lpage>.<pub-id pub-id-type="pmid">24831820</pub-id></mixed-citation>
    </ref>
    <ref id="B17">
      <label>17.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pan</surname><given-names>W.</given-names></string-name>, <string-name><surname>Kwak</surname><given-names>I.-Y.</given-names></string-name>, <string-name><surname>Wei</surname><given-names>P.</given-names></string-name></person-group>  <article-title>A powerful pathway-based adaptive test for genetic association with common or rare variants</article-title>. <source>Am. J. Hum. Genet.</source>  <year>2015</year>; <volume>97</volume>:<fpage>86</fpage>–<lpage>98</lpage>.<pub-id pub-id-type="pmid">26119817</pub-id></mixed-citation>
    </ref>
    <ref id="B18">
      <label>18.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Banerjee</surname><given-names>K.</given-names></string-name>, <string-name><surname>Zhao</surname><given-names>N.</given-names></string-name>, <string-name><surname>Srinivasan</surname><given-names>A.</given-names></string-name>, <string-name><surname>Xue</surname><given-names>L.</given-names></string-name>, <string-name><surname>Hicks</surname><given-names>S.D.</given-names></string-name>, <string-name><surname>Middleton</surname><given-names>F.A.</given-names></string-name>, <string-name><surname>Wu</surname><given-names>R.</given-names></string-name>, <string-name><surname>Zhan</surname><given-names>X.</given-names></string-name></person-group>  <article-title>An adaptive multivariate two-sample test with application to microbiome differential abundance analysis</article-title>. <source>Front. Genet.</source>  <year>2019</year>; <volume>10</volume>:<fpage>350</fpage><pub-id pub-id-type="pmid">31068967</pub-id></mixed-citation>
    </ref>
    <ref id="B19">
      <label>19.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Fan</surname><given-names>J.</given-names></string-name>, <string-name><surname>Lv</surname><given-names>J.</given-names></string-name></person-group>  <article-title>Sure independence screening for ultrahigh dimensional feature space</article-title>. <source>J. R. Stat. Soc. B</source>. <year>2008</year>; <volume>70</volume>:<fpage>849</fpage>–<lpage>911</lpage>.</mixed-citation>
    </ref>
    <ref id="B20">
      <label>20.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Badri</surname><given-names>M.</given-names></string-name>, <string-name><surname>Kurtz</surname><given-names>Z.D.</given-names></string-name>, <string-name><surname>Bonneau</surname><given-names>R.</given-names></string-name>, <string-name><surname>Müller</surname><given-names>C.L.</given-names></string-name></person-group>  <article-title>Shrinkage improves estimation of microbial associations under different normalization methods</article-title>. <source>NAR Genomics Bioinformatics</source>. <year>2020</year>; <volume>2</volume>:<fpage>lqaa100</fpage><pub-id pub-id-type="pmid">33575644</pub-id></mixed-citation>
    </ref>
    <ref id="B21">
      <label>21.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Fan</surname><given-names>J.</given-names></string-name></person-group>  <article-title>Test of significance based on wavelet thresholding and Neyman’s truncation</article-title>. <source>J. Am. Stat. Assoc.</source>  <year>1996</year>; <volume>91</volume>:<fpage>674</fpage>–<lpage>688</lpage>.</mixed-citation>
    </ref>
    <ref id="B22">
      <label>22.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tibshirani</surname><given-names>R.</given-names></string-name></person-group>  <article-title>Regression shrinkage and selection via the lasso</article-title>. <source>J. R. Stat. Soc. B Met.</source>  <year>1996</year>; <volume>00</volume>:<fpage>267</fpage>–<lpage>288</lpage>.</mixed-citation>
    </ref>
    <ref id="B23">
      <label>23.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Fan</surname><given-names>J.</given-names></string-name>, <string-name><surname>Li</surname><given-names>R.</given-names></string-name></person-group>  <article-title>Variable selection via nonconcave penalized likelihood and its oracle properties</article-title>. <source>J. Am. Stat. Assoc.</source>  <year>2001</year>; <volume>96</volume>:<fpage>1348</fpage>–<lpage>1360</lpage>.</mixed-citation>
    </ref>
    <ref id="B24">
      <label>24.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Fan</surname><given-names>J.</given-names></string-name>, <string-name><surname>Samworth</surname><given-names>R.</given-names></string-name>, <string-name><surname>Wu</surname><given-names>Y.</given-names></string-name></person-group>  <article-title>Ultrahigh dimensional feature selection: beyond the linear model</article-title>. <source>J. Mach. Learn. Res.</source>  <year>2009</year>; <volume>10</volume>:<fpage>2013</fpage>–<lpage>2038</lpage>.<pub-id pub-id-type="pmid">21603590</pub-id></mixed-citation>
    </ref>
    <ref id="B25">
      <label>25.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zou</surname><given-names>H.</given-names></string-name>, <string-name><surname>Hastie</surname><given-names>T.</given-names></string-name></person-group>  <article-title>Regularization and variable selection via the elastic net</article-title>. <source>J. R. Stat. Soc. B</source>. <year>2005</year>; <volume>67</volume>:<fpage>301</fpage>–<lpage>320</lpage>.</mixed-citation>
    </ref>
    <ref id="B26">
      <label>26.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Li</surname><given-names>R.</given-names></string-name>, <string-name><surname>Zhong</surname><given-names>W.</given-names></string-name>, <string-name><surname>Zhu</surname><given-names>L.</given-names></string-name></person-group>  <article-title>Feature screening via distance correlation learning</article-title>. <source>J. Am. Stat. Assoc.</source>  <year>2012</year>; <volume>107</volume>:<fpage>1129</fpage>–<lpage>1139</lpage>.<pub-id pub-id-type="pmid">25249709</pub-id></mixed-citation>
    </ref>
    <ref id="B27">
      <label>27.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yang</surname><given-names>S.</given-names></string-name>, <string-name><surname>Wen</surname><given-names>J.</given-names></string-name>, <string-name><surname>Eckert</surname><given-names>S.T.</given-names></string-name>, <string-name><surname>Wang</surname><given-names>Y.</given-names></string-name>, <string-name><surname>Liu</surname><given-names>D.J.</given-names></string-name>, <string-name><surname>Wu</surname><given-names>R.</given-names></string-name>, <string-name><surname>Li</surname><given-names>R.</given-names></string-name>, <string-name><surname>Zhan</surname><given-names>X.</given-names></string-name></person-group>  <article-title>Prioritizing genetic variants in GWAS with lasso using permutation-assisted tuning</article-title>. <source>Bioinformatics</source>. <year>2020</year>; <volume>36</volume>:<fpage>3811</fpage>–<lpage>3817</lpage>.<pub-id pub-id-type="pmid">32246825</pub-id></mixed-citation>
    </ref>
    <ref id="B28">
      <label>28.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lin</surname><given-names>W.</given-names></string-name>, <string-name><surname>Shi</surname><given-names>P.</given-names></string-name>, <string-name><surname>Feng</surname><given-names>R.</given-names></string-name>, <string-name><surname>Li</surname><given-names>H.</given-names></string-name></person-group>  <article-title>Variable selection in regression with compositional covariates</article-title>. <source>Biometrika</source>. <year>2014</year>; <volume>101</volume>:<fpage>785</fpage>–<lpage>797</lpage>.</mixed-citation>
    </ref>
    <ref id="B29">
      <label>29.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wang</surname><given-names>T.</given-names></string-name>, <string-name><surname>Zhao</surname><given-names>H.</given-names></string-name>  <etal>et al</etal>.</person-group>  <article-title>Structured subcomposition selection in regression and its application to microbiome data analysis</article-title>. <source>Ann. Appl. Stat.</source>  <year>2017</year>; <volume>11</volume>:<fpage>771</fpage>–<lpage>791</lpage>.</mixed-citation>
    </ref>
    <ref id="B30">
      <label>30.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Srinivasan</surname><given-names>A.</given-names></string-name>, <string-name><surname>Xue</surname><given-names>L.</given-names></string-name>, <string-name><surname>Zhan</surname><given-names>X.</given-names></string-name></person-group>  <article-title>Compositional knockoff filter for high-dimensional regression analysis of microbiome data</article-title>. <source>Biometrics</source>. <year>2021</year>; <volume>77</volume>:<fpage>984</fpage>–<lpage>995</lpage>.<pub-id pub-id-type="pmid">32683674</pub-id></mixed-citation>
    </ref>
    <ref id="B31">
      <label>31.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Susin</surname><given-names>A.</given-names></string-name>, <string-name><surname>Wang</surname><given-names>Y.</given-names></string-name>, <string-name><surname>Lê Cao</surname><given-names>K.-A.</given-names></string-name>, <string-name><surname>Calle</surname><given-names>M.L.</given-names></string-name></person-group>  <article-title>Variable selection in microbiome compositional data analysis</article-title>. <source>NAR Genomics Bioinformatics</source>. <year>2020</year>; <volume>2</volume>:<fpage>lqaa029</fpage><pub-id pub-id-type="pmid">33575585</pub-id></mixed-citation>
    </ref>
    <ref id="B32">
      <label>32.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hamidi</surname><given-names>B.</given-names></string-name>, <string-name><surname>Wallace</surname><given-names>K.</given-names></string-name>, <string-name><surname>Alekseyenko</surname><given-names>A.V.</given-names></string-name></person-group>  <article-title>MODIMA, a method for multivariate omnibus distance mediation analysis, allows for integration of multivariate exposure–mediator–response r</article-title>. <source>Genes</source>. <year>2019</year>; <volume>10</volume>:<fpage>524</fpage></mixed-citation>
    </ref>
    <ref id="B33">
      <label>33.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Székely</surname><given-names>G.J.</given-names></string-name>, <string-name><surname>Rizzo</surname><given-names>M.L.</given-names></string-name>, <string-name><surname>Bakirov</surname><given-names>N.K.</given-names></string-name>  <etal>et al</etal>.</person-group>  <article-title>Measuring and testing dependence by correlation of distances</article-title>. <source>Ann. Stat.</source>  <year>2007</year>; <volume>35</volume>:<fpage>2769</fpage>–<lpage>2794</lpage>.</mixed-citation>
    </ref>
    <ref id="B34">
      <label>34.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Charlson</surname><given-names>E.S.</given-names></string-name>, <string-name><surname>Chen</surname><given-names>J.</given-names></string-name>, <string-name><surname>Custers-Allen</surname><given-names>R.</given-names></string-name>, <string-name><surname>Bittinger</surname><given-names>K.</given-names></string-name>, <string-name><surname>Li</surname><given-names>H.</given-names></string-name>, <string-name><surname>Sinha</surname><given-names>R.</given-names></string-name>, <string-name><surname>Hwang</surname><given-names>J.</given-names></string-name>, <string-name><surname>Bushman</surname><given-names>F.D.</given-names></string-name>, <string-name><surname>Collman</surname><given-names>R.G.</given-names></string-name></person-group>  <article-title>Disordered microbial communities in the upper respiratory tract of cigarette smokers</article-title>. <source>PLoS One</source>. <year>2010</year>; <volume>5</volume>:<fpage>e15216</fpage><pub-id pub-id-type="pmid">21188149</pub-id></mixed-citation>
    </ref>
    <ref id="B35">
      <label>35.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Chen</surname><given-names>J.</given-names></string-name>, <string-name><surname>Bittinger</surname><given-names>K.</given-names></string-name>, <string-name><surname>Charlson</surname><given-names>E.S.</given-names></string-name>, <string-name><surname>Hoffmann</surname><given-names>C.</given-names></string-name>, <string-name><surname>Lewis</surname><given-names>J.</given-names></string-name>, <string-name><surname>Wu</surname><given-names>G.D.</given-names></string-name>, <string-name><surname>Collman</surname><given-names>R.G.</given-names></string-name>, <string-name><surname>Bushman</surname><given-names>F.D.</given-names></string-name>, <string-name><surname>Li</surname><given-names>H.</given-names></string-name></person-group>  <article-title>Associating microbiome composition with environmental covariates using generalized UniFrac distances</article-title>. <source>Bioinformatics</source>. <year>2012</year>; <volume>28</volume>:<fpage>2106</fpage>–<lpage>2113</lpage>.<pub-id pub-id-type="pmid">22711789</pub-id></mixed-citation>
    </ref>
    <ref id="B36">
      <label>36.</label>
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Sneath</surname><given-names>P.H.</given-names></string-name>, <string-name><surname>Sokal</surname><given-names>R.R.</given-names></string-name></person-group>  <source>Numerical Taxonomy. The Principles and Practice of Numerical Classification</source>. <year>1973</year>; <publisher-loc>San Francisco, CA</publisher-loc><publisher-name>Freeman</publisher-name></mixed-citation>
    </ref>
    <ref id="B37">
      <label>37.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Reynolds</surname><given-names>A.P.</given-names></string-name>, <string-name><surname>Richards</surname><given-names>G.</given-names></string-name>, <string-name><surname>de la Iglesia</surname><given-names>B.</given-names></string-name>, <string-name><surname>Rayward-Smith</surname><given-names>V.J.</given-names></string-name></person-group>  <article-title>Clustering rules: a comparison of partitioning and hierarchical clustering algorithms</article-title>. <source>J. Math. Model. Algorithms</source>. <year>2006</year>; <volume>5</volume>:<fpage>475</fpage>–<lpage>504</lpage>.</mixed-citation>
    </ref>
    <ref id="B38">
      <label>38.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Caporaso</surname><given-names>J.G.</given-names></string-name>, <string-name><surname>Kuczynski</surname><given-names>J.</given-names></string-name>, <string-name><surname>Stombaugh</surname><given-names>J.</given-names></string-name>, <string-name><surname>Bittinger</surname><given-names>K.</given-names></string-name>, <string-name><surname>Bushman</surname><given-names>F.D.</given-names></string-name>, <string-name><surname>Costello</surname><given-names>E.K.</given-names></string-name>, <string-name><surname>Fierer</surname><given-names>N.</given-names></string-name>, <string-name><surname>Pena</surname><given-names>A.G.</given-names></string-name>, <string-name><surname>Goodrich</surname><given-names>J.K.</given-names></string-name>, <string-name><surname>Gordon</surname><given-names>J.I.</given-names></string-name>, <string-name><surname>et</surname><given-names>al.</given-names></string-name></person-group>  <article-title>QIIME allows analysis of high-throughput community sequencing data</article-title>. <source>Nat. Methods</source>. <year>2010</year>; <volume>7</volume>:<fpage>335</fpage><pub-id pub-id-type="pmid">20383131</pub-id></mixed-citation>
    </ref>
    <ref id="B39">
      <label>39.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ley</surname><given-names>R.E.</given-names></string-name>, <string-name><surname>Turnbaugh</surname><given-names>P.J.</given-names></string-name>, <string-name><surname>Klein</surname><given-names>S.</given-names></string-name>, <string-name><surname>Gordon</surname><given-names>J.I.</given-names></string-name></person-group>  <article-title>Human gut microbes associated with obesity</article-title>. <source>Nature</source>. <year>2006</year>; <volume>444</volume>:<fpage>1022</fpage>–<lpage>1023</lpage>.<pub-id pub-id-type="pmid">17183309</pub-id></mixed-citation>
    </ref>
    <ref id="B40">
      <label>40.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Haiser</surname><given-names>H.J.</given-names></string-name>, <string-name><surname>Gootenberg</surname><given-names>D.B.</given-names></string-name>, <string-name><surname>Chatman</surname><given-names>K.</given-names></string-name>, <string-name><surname>Sirasani</surname><given-names>G.</given-names></string-name>, <string-name><surname>Balskus</surname><given-names>E.P.</given-names></string-name>, <string-name><surname>Turnbaugh</surname><given-names>P.J.</given-names></string-name></person-group>  <article-title>Predicting and manipulating cardiac drug inactivation by the human gut bacterium Eggerthella lenta</article-title>. <source>Science</source>. <year>2013</year>; <volume>341</volume>:<fpage>295</fpage>–<lpage>298</lpage>.<pub-id pub-id-type="pmid">23869020</pub-id></mixed-citation>
    </ref>
    <ref id="B41">
      <label>41.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wu</surname><given-names>J.</given-names></string-name>, <string-name><surname>Peters</surname><given-names>B.A.</given-names></string-name>, <string-name><surname>Dominianni</surname><given-names>C.</given-names></string-name>, <string-name><surname>Zhang</surname><given-names>Y.</given-names></string-name>, <string-name><surname>Pei</surname><given-names>Z.</given-names></string-name>, <string-name><surname>Yang</surname><given-names>L.</given-names></string-name>, <string-name><surname>Ma</surname><given-names>Y.</given-names></string-name>, <string-name><surname>Purdue</surname><given-names>M.P.</given-names></string-name>, <string-name><surname>Jacobs</surname><given-names>E.J.</given-names></string-name>, <string-name><surname>Gapstur</surname><given-names>S.M.</given-names></string-name>  <etal>et al</etal>.</person-group>  <article-title>Cigarette smoking and the oral microbiome in a large study of American adults</article-title>. <source>ISME J.</source>  <year>2016</year>; <volume>10</volume>:<fpage>2435</fpage>–<lpage>2446</lpage>.<pub-id pub-id-type="pmid">27015003</pub-id></mixed-citation>
    </ref>
    <ref id="B42">
      <label>42.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lee</surname><given-names>S.H.</given-names></string-name>, <string-name><surname>Yun</surname><given-names>Y.</given-names></string-name>, <string-name><surname>Kim</surname><given-names>S.J.</given-names></string-name>, <string-name><surname>Lee</surname><given-names>E.-J.</given-names></string-name>, <string-name><surname>Chang</surname><given-names>Y.</given-names></string-name>, <string-name><surname>Ryu</surname><given-names>S.</given-names></string-name>, <string-name><surname>Shin</surname><given-names>H.</given-names></string-name>, <string-name><surname>Kim</surname><given-names>H.-L.</given-names></string-name>, <string-name><surname>Kim</surname><given-names>H.-N.</given-names></string-name>, <string-name><surname>Lee</surname><given-names>J.H.</given-names></string-name></person-group>  <article-title>Association between cigarette smoking status and composition of gut microbiota: population-based cross-sectional study</article-title>. <source>J. Clin. Med.</source>  <year>2018</year>; <volume>7</volume>:<fpage>282</fpage></mixed-citation>
    </ref>
    <ref id="B43">
      <label>43.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wu</surname><given-names>G.D.</given-names></string-name>, <string-name><surname>Chen</surname><given-names>J.</given-names></string-name>, <string-name><surname>Hoffmann</surname><given-names>C.</given-names></string-name>, <string-name><surname>Bittinger</surname><given-names>K.</given-names></string-name>, <string-name><surname>Chen</surname><given-names>Y.-Y.</given-names></string-name>, <string-name><surname>Keilbaugh</surname><given-names>S.A.</given-names></string-name>, <string-name><surname>Bewtra</surname><given-names>M.</given-names></string-name>, <string-name><surname>Knights</surname><given-names>D.</given-names></string-name>, <string-name><surname>Walters</surname><given-names>W.A.</given-names></string-name>, <string-name><surname>Knight</surname><given-names>R.</given-names></string-name>  <etal>et al</etal>.</person-group>  <article-title>Linking long-term dietary patterns with gut microbial enterotypes</article-title>. <source>Science</source>. <year>2011</year>; <volume>334</volume>:<fpage>105</fpage>–<lpage>108</lpage>.<pub-id pub-id-type="pmid">21885731</pub-id></mixed-citation>
    </ref>
    <ref id="B44">
      <label>44.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Duan</surname><given-names>M.</given-names></string-name>, <string-name><surname>Wang</surname><given-names>Y.</given-names></string-name>, <string-name><surname>Zhang</surname><given-names>Q.</given-names></string-name>, <string-name><surname>Zou</surname><given-names>R.</given-names></string-name>, <string-name><surname>Guo</surname><given-names>M.</given-names></string-name>, <string-name><surname>Zheng</surname><given-names>H.</given-names></string-name></person-group>  <article-title>Characteristics of gut microbiota in people with obesity</article-title>. <source>Plos one</source>. <year>2021</year>; <volume>16</volume>:<fpage>e0255446</fpage><pub-id pub-id-type="pmid">34375351</pub-id></mixed-citation>
    </ref>
    <ref id="B45">
      <label>45.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Peters</surname><given-names>B.A.</given-names></string-name>, <string-name><surname>Shapiro</surname><given-names>J.A.</given-names></string-name>, <string-name><surname>Church</surname><given-names>T.R.</given-names></string-name>, <string-name><surname>Miller</surname><given-names>G.</given-names></string-name>, <string-name><surname>Trinh-Shevrin</surname><given-names>C.</given-names></string-name>, <string-name><surname>Yuen</surname><given-names>E.</given-names></string-name>, <string-name><surname>Friedlander</surname><given-names>C.</given-names></string-name>, <string-name><surname>Hayes</surname><given-names>R.B.</given-names></string-name>, <string-name><surname>Ahn</surname><given-names>J.</given-names></string-name></person-group>  <article-title>A taxonomic signature of obesity in a large study of American adults</article-title>. <source>Sci. Rep.-UK</source>. <year>2018</year>; <volume>8</volume>:<fpage>9749</fpage></mixed-citation>
    </ref>
    <ref id="B46">
      <label>46.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Saldana</surname><given-names>D.F.</given-names></string-name>, <string-name><surname>Feng</surname><given-names>Y.</given-names></string-name></person-group>  <article-title>SIS: an R package for sure independence screening in ultrahigh dimensional statistical models</article-title>. <source>J. Stat. Softw.</source>  <year>2018</year>; <volume>83</volume>:<fpage>1</fpage>–<lpage>25</lpage>.</mixed-citation>
    </ref>
  </ref-list>
</back>
