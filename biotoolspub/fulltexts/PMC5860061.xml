<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">5860061</article-id>
    <article-id pub-id-type="pmid">28475666</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btx281</article-id>
    <article-id pub-id-type="publisher-id">btx281</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Notes</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Genome Analysis</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Assembling draft genomes using contiBAIT</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>O’Neill</surname>
          <given-names>Kieran</given-names>
        </name>
        <xref ref-type="aff" rid="btx281-aff1">1</xref>
        <xref ref-type="aff" rid="btx281-aff2">2</xref>
        <xref ref-type="corresp" rid="btx281-cor1"/>
        <xref ref-type="author-notes" rid="btx281-FM1"/>
        <!--<email>koneill@bcgsc.ca</email>-->
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Hills</surname>
          <given-names>Mark</given-names>
        </name>
        <xref ref-type="aff" rid="btx281-aff3">3</xref>
        <xref ref-type="corresp" rid="btx281-cor1"/>
        <xref ref-type="author-notes" rid="btx281-FM1"/>
        <!--<email>mark.hills@stemcell.com</email>-->
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Gottlieb</surname>
          <given-names>Mike</given-names>
        </name>
        <xref ref-type="aff" rid="btx281-aff1">1</xref>
        <xref ref-type="aff" rid="btx281-aff4">4</xref>
        <xref ref-type="author-notes" rid="btx281-FM1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Borkowski</surname>
          <given-names>Matthew</given-names>
        </name>
        <xref ref-type="aff" rid="btx281-aff5">5</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Karsan</surname>
          <given-names>Aly</given-names>
        </name>
        <xref ref-type="aff" rid="btx281-aff1">1</xref>
        <xref ref-type="aff" rid="btx281-aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Lansdorp</surname>
          <given-names>Peter M</given-names>
        </name>
        <xref ref-type="aff" rid="btx281-aff1">1</xref>
        <xref ref-type="aff" rid="btx281-aff6">6</xref>
        <xref ref-type="aff" rid="btx281-aff7">7</xref>
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Berger</surname>
          <given-names>Bonnie</given-names>
          <prefix>Prof.</prefix>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <aff id="btx281-aff1"><label>1</label>Michael Smith Genome Sciences Centre, BC Cancer Agency, University of British Columbia, Vancouver, BC, Canada</aff>
    <aff id="btx281-aff2"><label>2</label>Department of Pathology and Laboratory Medicine, Faculty of Medicine, University of British Columbia, Vancouver, BC, Canada</aff>
    <aff id="btx281-aff3"><label>3</label>Terry Fox Laboratory, BC Cancer Agency, University of British Columbia, Vancouver, BC, Canada</aff>
    <aff id="btx281-aff4"><label>4</label>Bioinformatics Training Program, Faculty of Medicine, University of British Columbia, Vancouver, BC, Canada</aff>
    <aff id="btx281-aff5"><label>5</label>Independent Researcher, University of British Columbia, Vancouver, BC, Canada</aff>
    <aff id="btx281-aff6"><label>6</label>Hematology Division, Faculty of Medicine, University of British Columbia, Vancouver, BC, Canada</aff>
    <aff id="btx281-aff7"><label>7</label>European Research Institute for the Biology of Ageing, University Medical Centre Groningen, Groningen, The Netherlands</aff>
    <author-notes>
      <corresp id="btx281-cor1">To whom correspondence should be addressed. Email: <email>koneill@bcgsc.ca</email> or <email>mark.hills@stemcell.com</email></corresp>
      <fn id="btx281-FM1">
        <p>The authors wish it to be known that, in their opinion, the first three authors should be regarded as Joint First Authors.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>01</day>
      <month>9</month>
      <year>2017</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2017-05-05">
      <day>05</day>
      <month>5</month>
      <year>2017</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>05</day>
      <month>5</month>
      <year>2017</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. -->
    <volume>33</volume>
    <issue>17</issue>
    <fpage>2737</fpage>
    <lpage>2739</lpage>
    <history>
      <date date-type="received">
        <day>09</day>
        <month>9</month>
        <year>2016</year>
      </date>
      <date date-type="rev-recd">
        <day>28</day>
        <month>2</month>
        <year>2017</year>
      </date>
      <date date-type="accepted">
        <day>3</day>
        <month>5</month>
        <year>2017</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author 2017. Published by Oxford University Press. </copyright-statement>
      <copyright-year>2017</copyright-year>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/" license-type="cc-by">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btx281.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="SA1">
        <title>Summary</title>
        <p>Massively parallel sequencing is now widely used, but data interpretation is only as good as the reference assembly to which it is aligned. While the number of reference assemblies has rapidly expanded, most of these remain at intermediate stages of completion, either as scaffold builds, or as chromosome builds (consisting of correctly ordered, but not necessarily correctly oriented scaffolds separated by gaps). Completion of <italic>de novo</italic> assemblies remains difficult, as regions that are repetitive or hard to sequence prevent the accumulation of larger scaffolds, and create errors such as misorientations and mislocalizations. Thus, complementary methods for determining the orientation and positioning of fragments are important for finishing assemblies. Strand-seq is a method for determining template strand inheritance in single cells, information that can be used to determine relative genomic distance and orientation between scaffolds, and find errors within them. We present contiBAIT, an R/Bioconductor package which uses Strand-seq data to repair and improve existing assemblies.</p>
      </sec>
      <sec id="SA2">
        <title>Availability and Implementation</title>
        <p>contiBAIT is available on Bioconductor. Source files available from GitHub.</p>
      </sec>
      <sec id="SA3">
        <title>Supplementary information</title>
        <p><xref ref-type="supplementary-material" rid="sup2">Supplementary data</xref> are available at <italic>Bioinformatics</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">National Institutes of Health</named-content>
          <named-content content-type="funder-identifier">10.13039/100000002</named-content>
        </funding-source>
        <award-id>R01GM094146</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">Canadian Cancer Society</named-content>
          <named-content content-type="funder-identifier">10.13039/501100000521</named-content>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">Michael Smith Foundation for Health Research</named-content>
          <named-content content-type="funder-identifier">10.13039/501100000245</named-content>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">Terry Fox Research Institute</named-content>
          <named-content content-type="funder-identifier">10.13039/501100004376</named-content>
        </funding-source>
        <award-id>TFF-122869</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="3"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>High-quality genome assemblies have revolutionized the analysis of mutations, structural variation, gene expression and evolution. However, many organisms do not have finished assemblies, posing challenges to researchers as regions cannot be located to chromosomes and errors may be construed as biological effects. Genome assembly typically relies on overlapping sequences to increase the size of contiguous sequences (contigs). Biases in genomic representation from hard-to-sequence and repetitive regions can hide overlaps, resulting in assembly gaps that are difficult to span. Therefore, other methods are essential to connect adjacent contigs into larger scaffolds and ultimately help finish assemblies.</p>
    <p>We previously developed Strand-seq, a single cell sequencing technique that sequences only template strands (<xref rid="btx281-B1" ref-type="bibr">Falconer <italic>et al.</italic>, 2012</xref>), allowing us to identify multiple misorientations within the mouse assembly (GRCm37). Using just the contig sequences from the mouse, MGSCv3, we were further able to show that we could cluster contigs into the chromosome to which they belong (<xref rid="btx281-B2" ref-type="bibr">Hills <italic>et al.</italic>, 2013</xref>). To aid in this task, we developed <italic>Bioinformatics Analysis of Inherited Templates</italic> (BAIT) (<xref rid="btx281-B2" ref-type="bibr">Hills <italic>et al.</italic>, 2013</xref>). Strand-seq also has the ability to identify sister chromatid exchanges (SCEs) at unprecedented resolution by detecting changes in template strand sequences (<xref rid="btx281-B1" ref-type="bibr">Falconer <italic>et al.</italic>, 2012</xref>), which we used as a linkage metric to order fragments within each chromosome (<xref rid="btx281-B2" ref-type="bibr">Hills <italic>et al.</italic>, 2013</xref>).</p>
    <p>Here, we present contiBAIT, a multi-platform R/Bioconductor toolkit for genome finishing using Strand-seq. Like BAIT, contiBAIT identifies SCEs in order to cluster fragments into chromosomes and order fragments within chromosomes. contiBAIT extends BAIT’s functionality by detecting misassembled and misoriented contigs within an assembly, while also improving upon BAIT’s accuracy and run time.</p>
  </sec>
  <sec>
    <title>2 Detection of missassembly</title>
    <p>Misassemblies can be defined as errors in orientation or localization of sequences. Orientation errors occur when a fragment is correctly placed but has the opposite orientation of its neighbours (although a homozygous polymorphic inversion may have the same appearance). Mislocalizations occur when low level component sequences from non-adjacent locations, such as different chromosomes, are fused together. These errors, respectively, known as misorientations and chimeras, affect the strand-state patterns in detectable ways (see <xref ref-type="fig" rid="btx281-F1">Fig. 1a</xref>): Misorientations present as a complementary switch in template strand directionality. Chimeras have independent template strand directionalities on either side of the fusion.
</p>
    <fig id="btx281-F1" orientation="portrait" position="float">
      <label>Fig. 1</label>
      <caption>
        <p>(<bold>a</bold>) Misorientation and chimera detection. Eight libraries with read directions artificially changed to model misorientations and chimeras. contiBAIT merges libraries and correctly identifies features, represented by the black histogram (<bold>b</bold>). Clustering on 120 GRCh38scaf aligned human samples. Proportion of LGs (largest LG in black, subsequent LGs in grey, gaps in white) representing each chromosome (x axis). The majority of chromosomes are represented by only a single LG, and no LG contains substantial numbers of fragments from any but the primary chromosome. (<bold>c</bold>) Ordering by Monte Carlo method on human chromosome 4 aligned to GRCh38scaf. The location predicted by contiBAIT showed high correlation with the actual order of fragments. (<bold>d</bold>) Comparison of TSP and Monte Carlo algorithm on GRCh38scaf chromosome 4, showing distributions and quartiles for sets of 100 random samplings. The Monte Carlo method showed a marked improvement over the TSP formulation, especially with more libraries</p>
      </caption>
      <graphic xlink:href="btx281f1"/>
    </fig>
    <p>contiBAIT uses a circular binary segmentation algorithm (<xref rid="btx281-B3" ref-type="bibr">Olshen <italic>et al.</italic>, 2004</xref>) to find these changes in template strands and uses them to reorient or split fragments for downstream clustering. On eight test libraries harbouring an artificial misorientation and chimera, contiBAIT merged similar libraries together, and accurately identified features to within a 1562 bp interval on average (<xref ref-type="fig" rid="btx281-F1">Fig. 1a</xref>). These data suggest that contiBAIT is uniquely effective at identifying and correcting errors within a given assembly.</p>
  </sec>
  <sec>
    <title>3 Clustering fragments into linkage groups</title>
    <p>contiBAIT takes a set of unlinked fragments and clusters them into putative chromosomes in two passes. In the first pass, these fragments are clustered based on heterozygous or homozygous strand-state patterns across libraries without taking orientation into consideration. This creates a cluster of fragments for each chromosome, called a linkage group (LG). In the second pass, contiBAIT reorients fragments within each LG so that all are in the same direction.</p>
    <p>Genome assemblies may have hundreds of thousands of contigs, which presents a challenge for clustering. This challenge is compounded by the sparsity of Strand-seq data. We were unable to find a clustering method that handles large, sparse, categorical datasets. Consequently, we developed a memory efficient clustering algorithm based on the ‘Chinese restaurant’ process, described in detail in <xref ref-type="supplementary-material" rid="sup1">Supplementary Figure S1</xref>.</p>
    <p>We tested the clustering ability of contiBAIT by aligning 120 human Strand-seq libraries from (<xref rid="btx281-B4" ref-type="bibr">Sanders <italic>et al.</italic>, 2016</xref>) to an artificial assembly, which we created by splitting the human GRCh38 into 500 kbp ’scaffolds’ (subsequently referred to as GRCh38scaf). contiBAIT clustered 98.5% of the mappable genome into LGs, with 99.5% of that clustering into the largest 24 LGs, representing one LG for each chromosome in the (male) human sample. These LGs were both sensitive and specific for the true chromosomes (<xref ref-type="fig" rid="btx281-F1">Fig. 1b</xref>).</p>
    <p>Only six fragments (0.1%) misclustered into an LG which they did not belong, while the remaining 5600 fragments clustered correctly. The 0.5% of the assembly that did not cluster into the first 24 LGs represented a heterozygous inversion (on chr7q11.22) present in the human sample relative to the GRCh38 reference, and the pseudoautosomal regions of the sex chromosomes (present on both chrX and chrY, but only represented on chrX in GRCh38) (<xref rid="btx281-B4" ref-type="bibr">Sanders <italic>et al.</italic>, 2016</xref>).</p>
  </sec>
  <sec>
    <title>4 Ordering fragments within linkage groups</title>
    <p>SCEs within libraries allow fragments to be localized within chromosomes (<xref rid="btx281-B2" ref-type="bibr">Hills <italic>et al.</italic>, 2013</xref>). In BAIT, we modelled fragment order as a travelling salesman problem (TSP) (<xref rid="btx281-B2" ref-type="bibr">Hills <italic>et al.</italic>, 2013</xref>). However, this approach did not account for biologically unlikely strand-state changes or the rarity of SCEs per cell, and had NP-hard time complexity. contiBAIT employs a Monte Carlo method to quickly order fragments within each LG, while penalizing excessive SCEs and unlikely strand-state changes (see <xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S2</xref>).</p>
    <p>We compared the fragment ordering algorithms from BAIT and contiBAIT on 120 libraries aligned to GRCh38scaf. contiBAIT’s predicted order of contigs within chromosomes showed a strong correlation with the actual order of these fragments (<xref ref-type="fig" rid="btx281-F1">Fig. 1c</xref>). This correlation was better than using the TSP formulation, even when relatively few libraries were tested (<xref ref-type="fig" rid="btx281-F1">Fig. 1d</xref>). Moreover, clustering and ordering of GRCh38scaf was 938× faster for contiBAIT than BAIT (52 versus 48, 735 minutes on a 2.93GHz i7 CPU).</p>
  </sec>
  <sec>
    <title>5 Conclusion</title>
    <p>contiBAIT is a platform-independent analysis tool for finishing assemblies using Strand-seq data. Compared with BAIT, contiBAIT is almost three orders of magnitude faster and more accurate at clustering and ordering fragments into chromosomes. Moreover, contiBAIT has the unique ability to accurately detect misorientations and assembly chimeras within fragments. With these capabilities, contiBAIT is poised to be a valuable addition to the toolkit for constructing and finishing reference genome assemblies, augmenting standard sequencing methodologies and increasing efficiency for directed resequencing efforts.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>This work was supported by the Canadian Institutes of Health Research [RMF-92093, CGS-M, CIHR BTP fellowship]; U.S. National Institutes of Health [R01GM094146]; Canadian Cancer Society; Michael Smith Foundation for Health Research; Terry Fox Foundation [018006 and 150265]; and Terry Fox Research Institute (TFF-122869).</p>
    <p><italic>Conflict of Interest</italic>: none declared.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="sup1">
      <label>Supplementary Information</label>
      <media xlink:href="btx281_supplementary_information.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="sup2">
      <label>Supplementary Data</label>
      <media xlink:href="btx281_supplementary_thesis_chaper_7.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ref-list>
    <title>References</title>
    <ref id="btx281-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Falconer</surname><given-names>E.</given-names></name></person-group><etal>et al</etal> (<year>2012</year>) 
<article-title>DNA template strand sequencing of single-cells maps genomic rearrangements at high resolution</article-title>. <source>Nat. Methods</source>, <volume>9</volume>, <fpage>1107</fpage>–<lpage>1112</lpage>.<pub-id pub-id-type="pmid">23042453</pub-id></mixed-citation>
    </ref>
    <ref id="btx281-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Hills</surname><given-names>M.</given-names></name></person-group><etal>et al</etal> (<year>2013</year>) 
<article-title>BAIT: organizing genomes and mapping rearrangements in single cells</article-title>. <source>Genome Med</source>., <volume>5</volume>, <fpage>82.</fpage><pub-id pub-id-type="pmid">24028793</pub-id></mixed-citation>
    </ref>
    <ref id="btx281-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Olshen</surname><given-names>A.B.</given-names></name></person-group><etal>et al</etal> (<year>2004</year>) 
<article-title>Circular binary segmentation for the analysis of array-based DNA copy number data</article-title>. <source>Biostatistics</source>, <volume>5</volume>, <fpage>557</fpage>–<lpage>572</lpage>.<pub-id pub-id-type="pmid">15475419</pub-id></mixed-citation>
    </ref>
    <ref id="btx281-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Sanders</surname><given-names>A.D.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>Characterizing polymorphic inversions in human genomes by single cell sequencing</article-title>. <source>Genome Res</source>., <volume>26</volume>, <fpage>1565</fpage>–<lpage>1574</lpage>.<pub-id pub-id-type="pmid">27646535</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
