<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 39.96?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?subarticle pcbi.1010137.r001?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS Comput Biol</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-title-group>
      <journal-title>PLOS Computational Biology</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1553-734X</issn>
    <issn pub-type="epub">1553-7358</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, CA USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10138271</article-id>
    <article-id pub-id-type="pmid">37068103</article-id>
    <article-id pub-id-type="publisher-id">PCOMPBIOL-D-22-00648</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1010137</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Genomics</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Genomics</subject>
            <subj-group>
              <subject>Human Genomics</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Computer and Information Sciences</subject>
        <subj-group>
          <subject>Artificial Intelligence</subject>
          <subj-group>
            <subject>Machine Learning</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Computational Techniques</subject>
          <subj-group>
            <subject>Computational Pipelines</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Molecular Biology</subject>
          <subj-group>
            <subject>Molecular Biology Techniques</subject>
            <subj-group>
              <subject>Sequencing Techniques</subject>
              <subj-group>
                <subject>Genome Sequencing</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Molecular Biology Techniques</subject>
          <subj-group>
            <subject>Sequencing Techniques</subject>
            <subj-group>
              <subject>Genome Sequencing</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Organisms</subject>
          <subj-group>
            <subject>Bacteria</subject>
            <subj-group>
              <subject>Actinobacteria</subject>
              <subj-group>
                <subject>Mycobacterium Tuberculosis</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Engineering and Technology</subject>
        <subj-group>
          <subject>Signal Processing</subject>
          <subj-group>
            <subject>Signal Amplification</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Physical Sciences</subject>
        <subj-group>
          <subject>Physics</subject>
          <subj-group>
            <subject>Condensed Matter Physics</subject>
            <subj-group>
              <subject>Phase Transitions</subject>
              <subj-group>
                <subject>Melting</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>A fast machine-learning-guided primer design pipeline for selective whole genome amplification</article-title>
      <alt-title alt-title-type="running-head">Selective whole genome amplification protocol design pipeline</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Dwivedi-Yu</surname>
          <given-names>Jane A.</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/conceptualization/">Conceptualization</role>
        <role content-type="http://credit.niso.org/contributor-roles/formal-analysis/">Formal analysis</role>
        <role content-type="http://credit.niso.org/contributor-roles/investigation/">Investigation</role>
        <role content-type="http://credit.niso.org/contributor-roles/software/">Software</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-original-draft/">Writing – original draft</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-review-editing/">Writing – review &amp; editing</role>
        <xref rid="aff001" ref-type="aff">
          <sup>1</sup>
        </xref>
        <xref rid="aff002" ref-type="aff">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Oppler</surname>
          <given-names>Zachary J.</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/data-curation/">Data curation</role>
        <role content-type="http://credit.niso.org/contributor-roles/investigation/">Investigation</role>
        <role content-type="http://credit.niso.org/contributor-roles/methodology/">Methodology</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-original-draft/">Writing – original draft</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-review-editing/">Writing – review &amp; editing</role>
        <xref rid="aff003" ref-type="aff">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-6947-0495</contrib-id>
        <name>
          <surname>Mitchell</surname>
          <given-names>Matthew W.</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/conceptualization/">Conceptualization</role>
        <role content-type="http://credit.niso.org/contributor-roles/investigation/">Investigation</role>
        <role content-type="http://credit.niso.org/contributor-roles/methodology/">Methodology</role>
        <role content-type="http://credit.niso.org/contributor-roles/resources/">Resources</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-original-draft/">Writing – original draft</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-review-editing/">Writing – review &amp; editing</role>
        <xref rid="aff003" ref-type="aff">
          <sup>3</sup>
        </xref>
        <xref rid="aff004" ref-type="aff">
          <sup>4</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-0734-9868</contrib-id>
        <name>
          <surname>Song</surname>
          <given-names>Yun S.</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/formal-analysis/">Formal analysis</role>
        <role content-type="http://credit.niso.org/contributor-roles/funding-acquisition/">Funding acquisition</role>
        <role content-type="http://credit.niso.org/contributor-roles/investigation/">Investigation</role>
        <role content-type="http://credit.niso.org/contributor-roles/methodology/">Methodology</role>
        <role content-type="http://credit.niso.org/contributor-roles/supervision/">Supervision</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-original-draft/">Writing – original draft</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-review-editing/">Writing – review &amp; editing</role>
        <xref rid="aff001" ref-type="aff">
          <sup>1</sup>
        </xref>
        <xref rid="aff005" ref-type="aff">
          <sup>5</sup>
        </xref>
        <xref rid="cor001" ref-type="corresp">*</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-9493-7579</contrib-id>
        <name>
          <surname>Brisson</surname>
          <given-names>Dustin</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/conceptualization/">Conceptualization</role>
        <role content-type="http://credit.niso.org/contributor-roles/funding-acquisition/">Funding acquisition</role>
        <role content-type="http://credit.niso.org/contributor-roles/investigation/">Investigation</role>
        <role content-type="http://credit.niso.org/contributor-roles/project-administration/">Project administration</role>
        <role content-type="http://credit.niso.org/contributor-roles/supervision/">Supervision</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-original-draft/">Writing – original draft</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-review-editing/">Writing – review &amp; editing</role>
        <xref rid="aff003" ref-type="aff">
          <sup>3</sup>
        </xref>
        <xref rid="cor001" ref-type="corresp">*</xref>
      </contrib>
    </contrib-group>
    <aff id="aff001">
      <label>1</label>
      <addr-line>Computer Science Division, University of California, Berkeley, Berkeley, California, United States of America</addr-line>
    </aff>
    <aff id="aff002">
      <label>2</label>
      <addr-line>Facebook AI Research, 1 Rathbone Square, London, England</addr-line>
    </aff>
    <aff id="aff003">
      <label>3</label>
      <addr-line>Department of Biology, University of Pennsylvania, Philadelphia, Pennsylvania, United States of America</addr-line>
    </aff>
    <aff id="aff004">
      <label>4</label>
      <addr-line>Coriell Institute for Medical Research, Camden, New Jersey, United States of America</addr-line>
    </aff>
    <aff id="aff005">
      <label>5</label>
      <addr-line>Department of Statistics, University of California, Berkeley, Berkeley, California, United States of America</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Marz</surname>
          <given-names>Manja</given-names>
        </name>
        <role>Editor</role>
        <xref rid="edit1" ref-type="aff"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">
      <addr-line>bioinformatics, GERMANY</addr-line>
    </aff>
    <author-notes>
      <fn fn-type="COI-statement" id="coi001">
        <p>The authors have declared that no competing interests exist.</p>
      </fn>
      <corresp id="cor001">* E-mail: <email>yss@berkeley.edu</email> (YSS); <email>dbrisson@upenn.edu</email> (DB)</corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>4</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>17</day>
      <month>4</month>
      <year>2023</year>
    </pub-date>
    <volume>19</volume>
    <issue>4</issue>
    <elocation-id>e1010137</elocation-id>
    <history>
      <date date-type="received">
        <day>26</day>
        <month>4</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>23</day>
        <month>3</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2023 Dwivedi-Yu et al</copyright-statement>
      <copyright-year>2023</copyright-year>
      <copyright-holder>Dwivedi-Yu et al</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:href="pcbi.1010137.pdf"/>
    <abstract>
      <p>Addressing many of the major outstanding questions in the fields of microbial evolution and pathogenesis will require analyses of populations of microbial genomes. Although population genomic studies provide the analytical resolution to investigate evolutionary and mechanistic processes at fine spatial and temporal scales—precisely the scales at which these processes occur—microbial population genomic research is currently hindered by the practicalities of obtaining sufficient quantities of the relatively pure microbial genomic DNA necessary for next-generation sequencing. Here we present <monospace specific-use="no-wrap">swga2.0</monospace>, an optimized and parallelized pipeline to design selective whole genome amplification (SWGA) primer sets. Unlike previous methods, <monospace specific-use="no-wrap">swga2.0</monospace> incorporates active and machine learning methods to evaluate the amplification efficacy of individual primers and primer sets. Additionally, <monospace specific-use="no-wrap">swga2.0</monospace> optimizes primer set search and evaluation strategies, including parallelization at each stage of the pipeline, to dramatically decrease program runtime. Here we describe the <monospace specific-use="no-wrap">swga2.0</monospace> pipeline, including the empirical data used to identify primer and primer set characteristics, that improve amplification performance. Additionally, we evaluate the novel <monospace specific-use="no-wrap">swga2.0</monospace> pipeline by designing primer sets that successfully amplify <italic toggle="yes">Prevotella melaninogenica</italic>, an important component of the lung microbiome in cystic fibrosis patients, from samples dominated by human DNA.</p>
    </abstract>
    <abstract abstract-type="summary">
      <title>Author summary</title>
      <p>Population genomics enables the inference of evolutionary and ecological processes that are critical to understanding and eventually controlling many infectious diseases. The promise of microbial population genomics is tempered, however, by difficulties in isolating and preparing pathogens for next-generation sequencing. Here we present <monospace specific-use="no-wrap">swga2.0</monospace>, an optimized pipeline that designs the selective whole genome amplification (SWGA) primer sets needed to amplify and sequence microbial genomic DNA from complex biological specimens.</p>
    </abstract>
    <funding-group>
      <award-group id="award001">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100006492</institution-id>
            <institution>Division of Intramural Research, National Institute of Allergy and Infectious Diseases</institution>
          </institution-wrap>
        </funding-source>
        <award-id>R21-AI137433</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-9493-7579</contrib-id>
          <name>
            <surname>Brisson</surname>
            <given-names>Dustin</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award002">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000057</institution-id>
            <institution>National Institute of General Medical Sciences</institution>
          </institution-wrap>
        </funding-source>
        <award-id>R35-GM134922</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-0734-9868</contrib-id>
          <name>
            <surname>Song</surname>
            <given-names>Yun S.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award003">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100006492</institution-id>
            <institution>Division of Intramural Research, National Institute of Allergy and Infectious Diseases</institution>
          </institution-wrap>
        </funding-source>
        <award-id>R01- AI142572</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-9493-7579</contrib-id>
          <name>
            <surname>Brisson</surname>
            <given-names>Dustin</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award004">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000861</institution-id>
            <institution>Burroughs Wellcome Fund</institution>
          </institution-wrap>
        </funding-source>
        <award-id>1012376</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-9493-7579</contrib-id>
          <name>
            <surname>Brisson</surname>
            <given-names>Dustin</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <funding-statement>This research is supported in part by the National Institutes of Health (R21-AI137433 (DB,YSS), R35-GM134922 (YSS), and R01- AI142572 (DB)), and the Burroughs Wellcome Fund (1012376 (DB)). The funding agencies had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
    </funding-group>
    <counts>
      <fig-count count="6"/>
      <table-count count="5"/>
      <page-count count="20"/>
    </counts>
    <custom-meta-group>
      <custom-meta>
        <meta-name>PLOS Publication Stage</meta-name>
        <meta-value>vor-update-to-uncorrected-proof</meta-value>
      </custom-meta>
      <custom-meta>
        <meta-name>Publication Update</meta-name>
        <meta-value>2023-04-27</meta-value>
      </custom-meta>
      <custom-meta id="data-availability">
        <meta-name>Data Availability</meta-name>
        <meta-value>The swga2.0 program and all dependencies can be downloaded into a conda environment from <ext-link xlink:href="https://anaconda.org/janedwivedi/swga2" ext-link-type="uri">https://anaconda.org/janedwivedi/swga2</ext-link>. The source repository, tutorials, and documentation can be found at <ext-link xlink:href="https://github.com/songlab-cal/swga2" ext-link-type="uri">https://github.com/songlab-cal/swga2</ext-link>. All amplification and sequencing data presented can be found in the supplemental materials or in the Dryad data repository <ext-link xlink:href="https://doi.org/10.5061/dryad.3n5tb2rm2" ext-link-type="uri">https://doi.org/10.5061/dryad.3n5tb2rm2</ext-link>.</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
  <notes>
    <title>Data Availability</title>
    <p>The swga2.0 program and all dependencies can be downloaded into a conda environment from <ext-link xlink:href="https://anaconda.org/janedwivedi/swga2" ext-link-type="uri">https://anaconda.org/janedwivedi/swga2</ext-link>. The source repository, tutorials, and documentation can be found at <ext-link xlink:href="https://github.com/songlab-cal/swga2" ext-link-type="uri">https://github.com/songlab-cal/swga2</ext-link>. All amplification and sequencing data presented can be found in the supplemental materials or in the Dryad data repository <ext-link xlink:href="https://doi.org/10.5061/dryad.3n5tb2rm2" ext-link-type="uri">https://doi.org/10.5061/dryad.3n5tb2rm2</ext-link>.</p>
  </notes>
</front>
<body>
  <sec sec-type="intro" id="sec001">
    <title>Introduction</title>
    <p>The rapidly expanding field of population genomics is transforming our understanding of the evolutionary forces shaping genomic diversity within and among species [<xref rid="pcbi.1010137.ref001" ref-type="bibr">1</xref>]. In microbial systems in particular, population genomic studies are increasingly feasible due to the minimal cost of sequencing small genomes [<xref rid="pcbi.1010137.ref002" ref-type="bibr">2</xref>–<xref rid="pcbi.1010137.ref005" ref-type="bibr">5</xref>]. These studies can identify the origins of adaptive traits, map range expansions and migration patterns, and clarify epidemiological processes. A principal obstacle to sequencing specific microbial genomes from natural samples is isolating the target microbial DNA from the DNA of contaminating organisms [<xref rid="pcbi.1010137.ref006" ref-type="bibr">6</xref>]. Although laboratory culture is the standard practice, the overwhelming majority of microbes cannot be cultured, and direct sequencing is problematic as the microbial genome constitutes only a minuscule fraction of the total DNA [<xref rid="pcbi.1010137.ref007" ref-type="bibr">7</xref>–<xref rid="pcbi.1010137.ref009" ref-type="bibr">9</xref>]. Thus, a primary hindrance to collecting populations of microbial genomes is the lack of innovative, cost-effective, and practical methods to collect sufficient amounts of target microbial genomic DNA with limited contaminating DNA.</p>
    <p>Several technologies have been developed and utilized to overcome this obstacle including genome capture, single-cell sequencing, and selective whole genome amplification (SWGA) [<xref rid="pcbi.1010137.ref010" ref-type="bibr">10</xref>–<xref rid="pcbi.1010137.ref012" ref-type="bibr">12</xref>]. Of these, SWGA is the most inexpensive, flexible, and shareable culture-free technology [<xref rid="pcbi.1010137.ref013" ref-type="bibr">13</xref>]. SWGA takes advantage of the inherent differences in the frequencies of sequence motifs (<italic toggle="yes">k</italic>-mers) among species in order to build primer sets that bind often in the target genome but rarely in the contaminating genomes. These selective primer sets are used to selectively amplify the target microbial genomes using Φ29 multi-displacement amplification technology [<xref rid="pcbi.1010137.ref012" ref-type="bibr">12</xref>, <xref rid="pcbi.1010137.ref014" ref-type="bibr">14</xref>]. The Φ29 DNA polymerase amplifies DNA from primers with high processivity (up to 70-kbp fragments) and is 100 times less error-prone than Taq, making it the standard for genome amplification prior to sequencing [<xref rid="pcbi.1010137.ref014" ref-type="bibr">14</xref>–<xref rid="pcbi.1010137.ref016" ref-type="bibr">16</xref>]. By coupling Φ29 amplification with selective priming, researchers can selectively amplify a target microbial genome, thus separating the metaphorical baby (target microbial genomes) from the bathwater (off-target DNA from vectors, hosts, or other microbes). SWGA is a powerful and cost-effective tool for researchers looking to generate genomic data for microbial systems. Effective SWGA protocols have resulted in next-generation sequencing (NGS)-ready samples that are enriched for specific target microbial genomes and have been used to address biologically important questions in several microorganisms, including <italic toggle="yes">Mycobacterium tuberculosis</italic>, <italic toggle="yes">Wolbachia spp</italic>, <italic toggle="yes">Plasmodium spp</italic>, <italic toggle="yes">Neisseria meningitidis</italic>, <italic toggle="yes">Coxiella burnetii</italic>, <italic toggle="yes">Wuchereria bancrofti</italic>, and <italic toggle="yes">Treponema pallidum</italic> [<xref rid="pcbi.1010137.ref012" ref-type="bibr">12</xref>, <xref rid="pcbi.1010137.ref017" ref-type="bibr">17</xref>–<xref rid="pcbi.1010137.ref030" ref-type="bibr">30</xref>].</p>
    <p>The most recent SWGA development pipeline (<monospace specific-use="no-wrap">swga1.0</monospace>) improved on the concept and existing tools available for SWGA primer selection [<xref rid="pcbi.1010137.ref017" ref-type="bibr">17</xref>]. Whereas the first SWGA tool used only differential binding ratios of <italic toggle="yes">k</italic>-mers and melting temperature to build primer sets [<xref rid="pcbi.1010137.ref012" ref-type="bibr">12</xref>], <monospace specific-use="no-wrap">swga1.0</monospace> incorporated a larger <italic toggle="yes">a priori</italic> set of optimality criteria when selecting both individual primers (<italic toggle="yes">i.e</italic>., primer binding frequency, improved melting temperature, evenness) and potential primer sets (<italic toggle="yes">i.e</italic>., evenness, primer binding site density on the target genome) [<xref rid="pcbi.1010137.ref017" ref-type="bibr">17</xref>]. Evaluation of the amplification and sequencing data from this study revealed that primer sets that prioritized binding site density on the target genome, along with binding site evenness as a secondary factor, yielded the most consistent amplification success.</p>
    <p>The <monospace specific-use="no-wrap">swga1.0</monospace> pipeline substantially improved the available SWGA development tools and identified several potential enhancements for future studies [<xref rid="pcbi.1010137.ref017" ref-type="bibr">17</xref>]. First, <monospace specific-use="no-wrap">swga1.0</monospace> uses only marginally-effective optimality criteria to evaluate individual primers and primer sets due to a lack of empirical data of the characteristics that result in effective SWGA. While primer binding site density and evenness appear broadly important, the majority of primer sets chosen using these criteria resulted in limited amplification success. Thus, additional primer characteristics correlated with efficient selective amplification were not included in the primer selection process. Second, <monospace specific-use="no-wrap">swga1.0</monospace> uses a computationally-expensive algorithm to search for primer sets. <monospace specific-use="no-wrap">swga1.0</monospace> evaluated 1–5 million primer sets, which is only a very limited proportion of all potential primer sets, yet still required more time than is available for research projects. Evaluating primer sets could be vastly improved by an informed objective function and by pruning unpromising search paths.</p>
    <p>The computational time and experimental cost and effort needed to develop an effective protocol to amplify a target microbial genome has hindered the broad adoption of SWGA for microbial population genomic studies. Here we present the next generation pipeline for SWGA protocol development, <monospace specific-use="no-wrap">swga2.0</monospace>, that improves the state-of-the-art methods in three areas. First, active learning and machine learning are incorporated into the pipeline to predict the effectiveness of primers and primer sets. Second, novel features including thermodynamically-principled binding affinities are included in primer and primer set evaluation models. Lastly, the computational efficiency of the primer set search algorithm is improved by multiprocessing and caching computationally expensive information. <monospace specific-use="no-wrap">swga2.0</monospace> is a fast SWGA optimization software that allows researchers to rapidly identify primer sets that are likely to amplify a specific microbial genome from a complex, heterogeneous sample. We test the novel pipeline by designing and evaluating primer sets to selectively amplify <italic toggle="yes">Prevotella melaninogenica</italic>, an important pathogen in cystic fibrosis patients.</p>
  </sec>
  <sec sec-type="materials|methods" id="sec002">
    <title>Methods</title>
    <sec id="sec003">
      <title><monospace specific-use="no-wrap">swga2.0</monospace> pipeline</title>
      <p>The <monospace specific-use="no-wrap">swga2.0</monospace> pipeline incorporates metrics on the efficacy of individual primers and a computationally efficient, multiprocessing algorithm to identify sets of primers to selectively amplify a target microbial genome from samples dominated by background DNA (<ext-link xlink:href="https://anaconda.org/janedwivedi/swga2" ext-link-type="uri">https://anaconda.org/janedwivedi/swga2</ext-link>). The <monospace specific-use="no-wrap">swga2.0</monospace> pipeline consists of four major stages, illustrated in <xref rid="pcbi.1010137.g001" ref-type="fig">Fig 1</xref>: (1) cataloging DNA sequence motifs in the target genome and identifying the locations of each motif in both the target genome and background DNA, (2) removing DNA sequence motifs that are either too rare or too unevenly distributed in the target genome, are too common in the background DNA, or have calculated melting temperatures that are outside the acceptable range, (3) predicting the amplification efficacy of the remaining primers (see <bold>Amplification efficacy</bold> section below), and (4) searching and evaluating aggregations of primers as candidate primer sets. A summary of similarities and differences between the <monospace specific-use="no-wrap">swga2.0</monospace> pipeline and prior published methods is presented in <xref rid="pcbi.1010137.t001" ref-type="table">Table 1</xref>.</p>
      <fig position="float" id="pcbi.1010137.g001">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1010137.g001</object-id>
        <label>Fig 1</label>
        <caption>
          <title>Overview of the <monospace specific-use="no-wrap">swga2.0</monospace> pipeline.</title>
          <p>The process is broken into four stages: 1) preprocessing of locations in the target and off-target genomes, 2) filtering motifs in the target genome based on individual primer properties and frequencies in the genomes, 3) scoring the remaining primers for amplification efficacy using a machine learning model, and 4) searching and evaluating aggregations of primers as candidate primer sets.</p>
        </caption>
        <graphic xlink:href="pcbi.1010137.g001" position="float"/>
      </fig>
      <table-wrap position="float" id="pcbi.1010137.t001">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1010137.t001</object-id>
        <label>Table 1</label>
        <caption>
          <title>Differences between <monospace specific-use="no-wrap">swga1.0</monospace> and <monospace specific-use="no-wrap">swga2.0</monospace>.</title>
        </caption>
        <alternatives>
          <graphic xlink:href="pcbi.1010137.t001" id="pcbi.1010137.t001g" position="float"/>
          <table frame="box" rules="all" border="0">
            <colgroup span="1">
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th align="center" rowspan="1" colspan="1"/>
                <th align="left" rowspan="1" colspan="1">Feature</th>
                <th align="right" rowspan="1" colspan="1">
                  <monospace specific-use="no-wrap">swga1.0</monospace>
                </th>
                <th align="right" rowspan="1" colspan="1">
                  <monospace specific-use="no-wrap">swga2.0</monospace>
                </th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="center" rowspan="4" colspan="1">All stages</td>
                <td align="left" rowspan="1" colspan="1">Time to complete (minutes)<xref rid="t001fn001" ref-type="table-fn">*</xref></td>
                <td align="right" rowspan="1" colspan="1">1176</td>
                <td align="right" rowspan="1" colspan="1">93</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Multiprocessing</td>
                <td align="right" rowspan="1" colspan="1"/>
                <td align="right" rowspan="1" colspan="1">✓</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Incorporates forward strand</td>
                <td align="right" rowspan="1" colspan="1">✓</td>
                <td align="right" rowspan="1" colspan="1">✓</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Incorporates reverse strand</td>
                <td align="right" rowspan="1" colspan="1"/>
                <td align="right" rowspan="1" colspan="1">✓</td>
              </tr>
              <tr>
                <td align="center" rowspan="3" colspan="1">Stage 1 (<italic toggle="yes">k</italic>-mer preprocessing)</td>
                <td align="left" rowspan="1" colspan="1">Time to complete (minutes)<xref rid="t001fn001" ref-type="table-fn">*</xref></td>
                <td align="right" rowspan="1" colspan="1">100</td>
                <td align="right" rowspan="1" colspan="1">20</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Process <italic toggle="yes">k</italic>-mers that exact-match the target</td>
                <td align="right" rowspan="1" colspan="1">✓</td>
                <td align="right" rowspan="1" colspan="1">✓</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Process all <italic toggle="yes">k</italic>-mers in the target</td>
                <td align="right" rowspan="1" colspan="1"/>
                <td align="right" rowspan="1" colspan="1">✓</td>
              </tr>
              <tr>
                <td align="center" rowspan="7" colspan="1">Stage 2 (Candidate primer filtering)</td>
                <td align="left" rowspan="1" colspan="1">Time to complete (minutes)<xref rid="t001fn001" ref-type="table-fn">*</xref></td>
                <td align="right" rowspan="1" colspan="1">0.1</td>
                <td align="right" rowspan="1" colspan="1">37.5</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Filter by melting temp</td>
                <td align="right" rowspan="1" colspan="1">✓</td>
                <td align="right" rowspan="1" colspan="1">✓</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Filter by self-dimerization</td>
                <td align="right" rowspan="1" colspan="1">✓</td>
                <td align="right" rowspan="1" colspan="1">✓</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Filter by target binding count</td>
                <td align="right" rowspan="1" colspan="1">✓</td>
                <td align="right" rowspan="1" colspan="1">✓</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Filter by background binding count</td>
                <td align="right" rowspan="1" colspan="1">✓</td>
                <td align="right" rowspan="1" colspan="1">✓</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Filter by target Gini index</td>
                <td align="right" rowspan="1" colspan="1">✓</td>
                <td align="right" rowspan="1" colspan="1">✓</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Filter by target to background freq. binding ratio</td>
                <td align="right" rowspan="1" colspan="1">✓</td>
                <td align="right" rowspan="1" colspan="1">✓</td>
              </tr>
              <tr>
                <td align="center" rowspan="2" colspan="1">Stage 3 (Primer efficacy filtering)</td>
                <td align="left" rowspan="1" colspan="1">Time to complete (minutes)<xref rid="t001fn001" ref-type="table-fn">*</xref></td>
                <td align="right" rowspan="1" colspan="1">NA</td>
                <td align="right" rowspan="1" colspan="1">5</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Filter by predicted amplification using a trained model</td>
                <td align="right" rowspan="1" colspan="1"/>
                <td align="right" rowspan="1" colspan="1">✓</td>
              </tr>
              <tr>
                <td align="center" rowspan="13" colspan="1">Stage 4 (Primer set search and eval.)</td>
                <td align="left" rowspan="1" colspan="1">Time to complete (minutes)<xref rid="t001fn001" ref-type="table-fn">*</xref></td>
                <td align="right" rowspan="1" colspan="1">1076</td>
                <td align="right" rowspan="1" colspan="1">31</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Filters based on heterodimer formation</td>
                <td align="right" rowspan="1" colspan="1">✓</td>
                <td align="right" rowspan="1" colspan="1">✓</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Score sets using heuristic function</td>
                <td align="right" rowspan="1" colspan="1">✓</td>
                <td align="right" rowspan="1" colspan="1"/>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Score sets using fitted regression model</td>
                <td align="right" rowspan="1" colspan="1"/>
                <td align="right" rowspan="1" colspan="1">✓</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Uses min distance between binding sites in the background</td>
                <td align="right" rowspan="1" colspan="1">✓</td>
                <td align="right" rowspan="1" colspan="1"/>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Uses max distance between binding sites on the target</td>
                <td align="right" rowspan="1" colspan="1">✓</td>
                <td align="right" rowspan="1" colspan="1"/>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Uses min ratio (target:off) of mean binding site distances</td>
                <td align="right" rowspan="1" colspan="1"/>
                <td align="right" rowspan="1" colspan="1">✓</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Uses max ratio (target:off) of binding site frequency</td>
                <td align="right" rowspan="1" colspan="1"/>
                <td align="right" rowspan="1" colspan="1">✓</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Uses min ratio (target:off) of coverage approximation</td>
                <td align="right" rowspan="1" colspan="1"/>
                <td align="right" rowspan="1" colspan="1">✓</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Uses min mean Gini index of target binding</td>
                <td align="right" rowspan="1" colspan="1"/>
                <td align="right" rowspan="1" colspan="1">✓</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Uses max mean Gini index of background binding</td>
                <td align="right" rowspan="1" colspan="1"/>
                <td align="right" rowspan="1" colspan="1">✓</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Branch-and-bound search based on heterodimer cliques</td>
                <td align="right" rowspan="1" colspan="1">✓</td>
                <td align="right" rowspan="1" colspan="1">✓</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Branch-and-bound based on predict set score</td>
                <td align="right" rowspan="1" colspan="1"/>
                <td align="right" rowspan="1" colspan="1">✓</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
        <table-wrap-foot>
          <fn id="t001fn001">
            <p>*Primer sets designed to selectively amplify <italic toggle="yes">P. melaninogenica</italic> (<italic toggle="yes">H. sapiens</italic> background) were built on a MacBookPro14,1 (using all 4 threads: 2.5GHz Dual-Core Intel Core i7, 2 threads per core; Memory 16GB 2133MHz LPDDR3).</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
      <sec id="sec004">
        <title>Stage 1 (<italic toggle="yes">k</italic>-mer preprocessing)</title>
        <p><monospace specific-use="no-wrap">swga2.0</monospace> first identifies all 6 bp to 12 bp <italic toggle="yes">k</italic>-mers in the target genome that serve as candidate SWGA primers. The number and location of each <italic toggle="yes">k</italic>-mer in the target genome and background DNA are computed using <monospace specific-use="no-wrap">jellyfish</monospace> [<xref rid="pcbi.1010137.ref031" ref-type="bibr">31</xref>]—a fast, parallel <italic toggle="yes">k</italic>-mer counter—and stored in <monospace specific-use="no-wrap">h5py</monospace> files. This stage of the pipeline is parallelized and does not need to be re-run when modifying parameters or generating new primer sets (Stage 4).</p>
      </sec>
      <sec id="sec005">
        <title>Stage 2 (Candidate primer filtering)</title>
        <p>The <italic toggle="yes">k</italic>-mer motifs in the <monospace specific-use="no-wrap">h5py</monospace> files are sorted according to their binding frequency in the target genome and background DNA, the evenness of their distribution in the target genome, their calculated melting temperatures, GC content, homodimerization probability, and number of single and di-nucleotide repeats. These motif characteristics were used previously to identify candidate SWGA primers [<xref rid="pcbi.1010137.ref017" ref-type="bibr">17</xref>]. Briefly, binding frequency is the number of exact matches of a primer in the genome normalized by the total genome length; motifs that occur too rarely in the target genome (&lt; <monospace specific-use="no-wrap">min_fg_freq</monospace>) or too frequently in the background DNA (&gt; <monospace specific-use="no-wrap">max_bg_freq</monospace>) are removed. Primers that bind unevenly across the target genome (&gt; <monospace specific-use="no-wrap">max_gini</monospace>), calculated using the Gini index of the distances between motifs are removed. The melting temperature of potential primers [<xref rid="pcbi.1010137.ref032" ref-type="bibr">32</xref>] must be within <monospace specific-use="no-wrap">min_tm</monospace> (default 15°C) and <monospace specific-use="no-wrap">max_tm</monospace> (default 45°C) as established in [<xref rid="pcbi.1010137.ref012" ref-type="bibr">12</xref>]. Motifs with GC content less than <monospace specific-use="no-wrap">min_GC</monospace> or greater than <monospace specific-use="no-wrap">max_GC</monospace> (default 0.375 and 0.625, respectively), as well as motifs with three or more G/C in the last five base pairs of the 3′-end, are eliminated. Candidate primers that could self-dimerize, estimated as subsequences that have a reverse complement (≥ <monospace specific-use="no-wrap">default_max_self_dimer_bp</monospace>, default = 4), are eliminated. Finally, motifs with runs of single and di-nucleotide repeats are eliminated. The ratio of the binding frequency in the target genome to that in the background DNA is computed for the candidate primers that remain after the filtering steps above. The primers are sorted by the target-to-background ratio and the primers with the largest ratios are retained for downstream evaluation (<monospace specific-use="no-wrap">max_primers</monospace>; default 500 primers). Multi-processed tasks use the user-specified number of CPUs (default = all).</p>
      </sec>
      <sec id="sec006">
        <title>Stage 3 (Primer efficacy filter)</title>
        <p>Decreasing the number of candidate primers reduces the computational effort necessary to search and evaluate primer sets in Stage 4. Thus, the motifs retained from Stage 2 are individually evaluated for their potential to bind and amplify the target genome, using the random forest regressor model trained on the experimental data described in the <bold>Amplification efficacy</bold> section below. Briefly, this non-linear regression model predicts amplification efficacy from experimentally-identified primer properties including thermodynamically-principled features that correlate with binding affinity. Candidate primers are selected according to the minimum predicted on-target amplification threshold parameter (<monospace specific-use="no-wrap">min_amp_pred</monospace>, default = 5) in this regression model.</p>
      </sec>
      <sec id="sec007">
        <title>Stage 4 (Primer set search and evaluation)</title>
        <p><monospace specific-use="no-wrap">swga2.0</monospace> searches for and evaluates primer sets using a machine-learning guided scoring function that incorporates a breadth first, greedy approach. The number of desired primer sets (<monospace specific-use="no-wrap">max_sets</monospace>) are built in parallel, primer by primer, by adding primers that cause the greatest increase in evaluation scores (see <xref rid="pcbi.1010137.s001" ref-type="supplementary-material">S1 Appendix</xref>). Briefly, the first primer in each of the <monospace specific-use="no-wrap">max_sets</monospace> sets is chosen at random from the candidate primer list allowing for broad exploration of the search space (<xref rid="pcbi.1010137.g002" ref-type="fig">Fig 2</xref>). Primers that are not expected to dimerize with any primer already in the set are added, one at a time, to each set and the primer set is evaluated as: score = <italic toggle="yes">β</italic><sub>0</sub> + <italic toggle="yes">β</italic><sub>1</sub>
<monospace specific-use="no-wrap">freq_ratio</monospace> + <italic toggle="yes">β</italic><sub>2</sub>
<monospace specific-use="no-wrap">mean_gap_ratio</monospace> + <italic toggle="yes">β</italic><sub>3</sub>
<monospace specific-use="no-wrap">coverage_ratio</monospace> + <italic toggle="yes">β</italic><sub>4</sub>
<monospace specific-use="no-wrap">on_gap_gini</monospace> + <italic toggle="yes">β</italic><sub>5</sub>
<monospace specific-use="no-wrap">off_gap_gini</monospace> where the score predicts the percent of target genome coverage at 1×. The features for this regression are described in <xref rid="pcbi.1010137.t002" ref-type="table">Table 2</xref> and explained further in the section <bold>Primer set search and scoring function</bold>. New candidate primers are added sequentially to primer sets and retained if the addition improves the computed score. This process iterates until primer sets of a desired size are generated or the maximum number of iterations is reached. The primer set search process also utilizes a drop-out step where a set of size <italic toggle="yes">n</italic> reduces to the subset of size <italic toggle="yes">n</italic> − 1 with the highest computed score. “Dropping” the weakest primer also provides the possibility of adding a primer that would otherwise be excluded due to the risk of dimerizing with the dropped primer. The drop-out step can be re-run multiple times and includes the option of temporarily withholding frequently-used primers until after the drop-out layer.</p>
        <fig position="float" id="pcbi.1010137.g002">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1010137.g002</object-id>
          <label>Fig 2</label>
          <caption>
            <title>Summary schematic of Stage 4 (Primer set search and evaluation) of the <monospace specific-use="no-wrap">swga2.0</monospace> pipeline.</title>
            <p>Stage 4 begins with one randomly selected primer for each primer set. Each primer set is built in parallel until the improvements in evaluation score no longer exceed a user-defined parameter (<italic toggle="yes">ϵ</italic>) or until the maximum number of iterations is reached. A drop-out iteration forces each of the highest-scoring primer sets of size <italic toggle="yes">n</italic> to reduce to the subset of size <italic toggle="yes">n</italic> − 1 with the highest computed score.</p>
          </caption>
          <graphic xlink:href="pcbi.1010137.g002" position="float"/>
        </fig>
        <table-wrap position="float" id="pcbi.1010137.t002">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1010137.t002</object-id>
          <label>Table 2</label>
          <caption>
            <title>Ridge regression variable descriptions and coefficient values for primer set evaluation.</title>
          </caption>
          <alternatives>
            <graphic xlink:href="pcbi.1010137.t002" id="pcbi.1010137.t002g" position="float"/>
            <table frame="box" rules="all" border="0">
              <colgroup span="1">
                <col align="left" valign="middle" span="1"/>
                <col align="left" valign="middle" span="1"/>
                <col align="left" valign="middle" span="1"/>
                <col align="left" valign="middle" span="1"/>
              </colgroup>
              <thead>
                <tr>
                  <th align="left" rowspan="1" colspan="1">Variable name</th>
                  <th align="left" rowspan="1" colspan="1">Variable description</th>
                  <th align="center" rowspan="1" colspan="1">Coef.</th>
                  <th align="center" rowspan="1" colspan="1">Coef. value</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td align="left" rowspan="1" colspan="1">intercept</td>
                  <td align="left" rowspan="1" colspan="1">Intercept</td>
                  <td align="center" rowspan="1" colspan="1">
                    <inline-formula id="pcbi.1010137.e001">
                      <alternatives>
                        <graphic xlink:href="pcbi.1010137.e001" id="pcbi.1010137.e001g" position="anchor"/>
                        <mml:math id="M1" display="inline" overflow="scroll">
                          <mml:msub>
                            <mml:mover accent="true">
                              <mml:mi>β</mml:mi>
                              <mml:mo>^</mml:mo>
                            </mml:mover>
                            <mml:mn>0</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="center" rowspan="1" colspan="1">−3.14 × 10<sup>−15</sup></td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">
                    <monospace specific-use="no-wrap">freq_ratio</monospace>
                  </td>
                  <td align="left" rowspan="1" colspan="1">Ratio of the binding site rate in the on-target to off-target genome.</td>
                  <td align="center" rowspan="1" colspan="1">
                    <inline-formula id="pcbi.1010137.e002">
                      <alternatives>
                        <graphic xlink:href="pcbi.1010137.e002" id="pcbi.1010137.e002g" position="anchor"/>
                        <mml:math id="M2" display="inline" overflow="scroll">
                          <mml:msub>
                            <mml:mover accent="true">
                              <mml:mi>β</mml:mi>
                              <mml:mo>^</mml:mo>
                            </mml:mover>
                            <mml:mn>1</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="center" rowspan="1" colspan="1">0.321</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">
                    <monospace specific-use="no-wrap">mean_gap_ratio</monospace>
                  </td>
                  <td align="left" rowspan="1" colspan="1">Ratio of the mean distance between binding sites of the on-target to off-target genome, aggregating across strands.</td>
                  <td align="center" rowspan="1" colspan="1">
                    <inline-formula id="pcbi.1010137.e003">
                      <alternatives>
                        <graphic xlink:href="pcbi.1010137.e003" id="pcbi.1010137.e003g" position="anchor"/>
                        <mml:math id="M3" display="inline" overflow="scroll">
                          <mml:msub>
                            <mml:mover accent="true">
                              <mml:mi>β</mml:mi>
                              <mml:mo>^</mml:mo>
                            </mml:mover>
                            <mml:mn>2</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="center" rowspan="1" colspan="1">−0.0368</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">
                    <monospace specific-use="no-wrap">coverage_ratio</monospace>
                  </td>
                  <td align="left" rowspan="1" colspan="1">Ratio of the coverage approximation of the on-target to that of the off-target.</td>
                  <td align="center" rowspan="1" colspan="1">
                    <inline-formula id="pcbi.1010137.e004">
                      <alternatives>
                        <graphic xlink:href="pcbi.1010137.e004" id="pcbi.1010137.e004g" position="anchor"/>
                        <mml:math id="M4" display="inline" overflow="scroll">
                          <mml:msub>
                            <mml:mover accent="true">
                              <mml:mi>β</mml:mi>
                              <mml:mo>^</mml:mo>
                            </mml:mover>
                            <mml:mn>3</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="center" rowspan="1" colspan="1">−0.0318</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">
                    <monospace specific-use="no-wrap">on_gap_gini</monospace>
                  </td>
                  <td align="left" rowspan="1" colspan="1">Mean gini index of on-target binding site gap sizes, averaging across strands.</td>
                  <td align="center" rowspan="1" colspan="1">
                    <inline-formula id="pcbi.1010137.e005">
                      <alternatives>
                        <graphic xlink:href="pcbi.1010137.e005" id="pcbi.1010137.e005g" position="anchor"/>
                        <mml:math id="M5" display="inline" overflow="scroll">
                          <mml:msub>
                            <mml:mover accent="true">
                              <mml:mi>β</mml:mi>
                              <mml:mo>^</mml:mo>
                            </mml:mover>
                            <mml:mn>4</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="center" rowspan="1" colspan="1">−0.0131</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">
                    <monospace specific-use="no-wrap">off_gap_gini</monospace>
                  </td>
                  <td align="left" rowspan="1" colspan="1">Mean gini index of off-target binding site gap sizes, averaging across strands.</td>
                  <td align="center" rowspan="1" colspan="1">
                    <inline-formula id="pcbi.1010137.e006">
                      <alternatives>
                        <graphic xlink:href="pcbi.1010137.e006" id="pcbi.1010137.e006g" position="anchor"/>
                        <mml:math id="M6" display="inline" overflow="scroll">
                          <mml:msub>
                            <mml:mover accent="true">
                              <mml:mi>β</mml:mi>
                              <mml:mo>^</mml:mo>
                            </mml:mover>
                            <mml:mn>5</mml:mn>
                          </mml:msub>
                        </mml:math>
                      </alternatives>
                    </inline-formula>
                  </td>
                  <td align="center" rowspan="1" colspan="1">0.281</td>
                </tr>
              </tbody>
            </table>
          </alternatives>
        </table-wrap>
      </sec>
    </sec>
    <sec id="sec008">
      <title>Amplification efficacy</title>
      <p>The amplification efficacy of individual primers (Stage 3) is predicted using a regression model built from a series of rolling circle amplification (RCA) [<xref rid="pcbi.1010137.ref014" ref-type="bibr">14</xref>, <xref rid="pcbi.1010137.ref033" ref-type="bibr">33</xref>] experiments in which plasmids were amplified with individual primers. SWGA typically utilizes multiple primers, each with multiple priming sites, making it challenging to isolate the impact of individual primers. Single-primer amplification reactions assess amplification efficacy of individual primers binding from plasmids with or without an exact-match binding site.</p>
      <p>The model of primer amplification efficacy included the features delineated in <xref rid="pcbi.1010137.t003" ref-type="table">Table 3</xref> as parameters. Some of these attributes include properties such as the number of base pair repeats, melting temperature and G/C proportion, all of which are thought to impact the efficacy of accurate primer binding and amplification in PCR and Φ29 reactions [<xref rid="pcbi.1010137.ref034" ref-type="bibr">34</xref>]. <monospace specific-use="no-wrap">swga2.0</monospace> includes additional features that estimate the likelihood of the primer binding to the target using a unified thermodynamic nearest-neighbor DNA model [<xref rid="pcbi.1010137.ref035" ref-type="bibr">35</xref>, <xref rid="pcbi.1010137.ref036" ref-type="bibr">36</xref>]. Empirical thermodynamic parameters (<inline-formula id="pcbi.1010137.e007"><alternatives><graphic xlink:href="pcbi.1010137.e007.jpg" id="pcbi.1010137.e007g" position="anchor"/><mml:math id="M7" display="inline" overflow="scroll"><mml:mrow><mml:mo>Δ</mml:mo><mml:msubsup><mml:mi>G</mml:mi><mml:mi>T</mml:mi><mml:mo>∘</mml:mo></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>) are available for most primer exact-match and single-mismatch scenarios. Empirical thermodynamic data for terminal mismatches are not publicly available [<xref rid="pcbi.1010137.ref035" ref-type="bibr">35</xref>, <xref rid="pcbi.1010137.ref036" ref-type="bibr">36</xref>] and were not captured in our predictive model. This thermodynamic nearest-neighbor model was incorporated by computing <inline-formula id="pcbi.1010137.e008"><alternatives><graphic xlink:href="pcbi.1010137.e008.jpg" id="pcbi.1010137.e008g" position="anchor"/><mml:math id="M8" display="inline" overflow="scroll"><mml:mrow><mml:mo>Δ</mml:mo><mml:msubsup><mml:mi>G</mml:mi><mml:mi>T</mml:mi><mml:mo>∘</mml:mo></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> values for each primer at each genome position—a smoother metric for primer binding propensity than the number of exact match binding sites. The <inline-formula id="pcbi.1010137.e009"><alternatives><graphic xlink:href="pcbi.1010137.e009.jpg" id="pcbi.1010137.e009g" position="anchor"/><mml:math id="M9" display="inline" overflow="scroll"><mml:mrow><mml:mo>Δ</mml:mo><mml:msubsup><mml:mi>G</mml:mi><mml:mi>T</mml:mi><mml:mo>∘</mml:mo></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> values were binned within the range of −20 and 3, and the resulting histogram normalized by genome length. The normalized <inline-formula id="pcbi.1010137.e010"><alternatives><graphic xlink:href="pcbi.1010137.e010.jpg" id="pcbi.1010137.e010g" position="anchor"/><mml:math id="M10" display="inline" overflow="scroll"><mml:mrow><mml:mo>Δ</mml:mo><mml:msubsup><mml:mi>G</mml:mi><mml:mi>T</mml:mi><mml:mo>∘</mml:mo></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> frequency values are used as features in the primer amplification efficacy regression model.</p>
      <table-wrap position="float" id="pcbi.1010137.t003">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1010137.t003</object-id>
        <label>Table 3</label>
        <caption>
          <title>Feature importances based on the random forest regressor model.</title>
        </caption>
        <alternatives>
          <graphic xlink:href="pcbi.1010137.t003" id="pcbi.1010137.t003g" position="float"/>
          <table frame="box" rules="all" border="0">
            <colgroup span="1">
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th align="left" rowspan="1" colspan="1">Subset Description</th>
                <th align="center" rowspan="1" colspan="1">Feature Description</th>
                <th align="center" rowspan="1" colspan="1">Feature Importance (%)</th>
                <th align="center" rowspan="1" colspan="1">Subset Feature Importance (%)</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" rowspan="3" colspan="1">G/C content features</td>
                <td align="center" rowspan="1" colspan="1">number/proportion of G’s</td>
                <td align="center" rowspan="1" colspan="1">11.8/2.68</td>
                <td align="char" char="." rowspan="3" colspan="1">27.9</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">number/proportion of C’s</td>
                <td align="center" rowspan="1" colspan="1">2.76/6.54</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">GC content</td>
                <td align="center" rowspan="1" colspan="1">4.08</td>
              </tr>
              <tr>
                <td align="left" rowspan="8" colspan="1">repeat features</td>
                <td align="center" rowspan="1" colspan="1">GG repeat number</td>
                <td align="center" rowspan="1" colspan="1">7.30</td>
                <td align="char" char="." rowspan="8" colspan="1">19.2</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">longest G repeat</td>
                <td align="center" rowspan="1" colspan="1">4.10</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">CC repeat number</td>
                <td align="center" rowspan="1" colspan="1">2.37</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">longest C repeat</td>
                <td align="center" rowspan="1" colspan="1">3.51</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">TT repeat number</td>
                <td align="center" rowspan="1" colspan="1">0.458</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">longest T repeat</td>
                <td align="center" rowspan="1" colspan="1">0.613</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">AA repeat number</td>
                <td align="center" rowspan="1" colspan="1">0.333</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">longest A repeat</td>
                <td align="center" rowspan="1" colspan="1">0.431</td>
              </tr>
              <tr>
                <td align="left" rowspan="27" colspan="1">Binding affinity features</td>
                <td align="center" rowspan="1" colspan="1">3</td>
                <td align="center" rowspan="1" colspan="1">1.42</td>
                <td align="char" char="." rowspan="27" colspan="1">18.1</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">2.5</td>
                <td align="center" rowspan="1" colspan="1">1.70</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">2</td>
                <td align="center" rowspan="1" colspan="1">0.942</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">1.5</td>
                <td align="center" rowspan="1" colspan="1">1.84</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">1</td>
                <td align="center" rowspan="1" colspan="1">2.07</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">0.5</td>
                <td align="center" rowspan="1" colspan="1">1.21</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">0</td>
                <td align="center" rowspan="1" colspan="1">1.27</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">−0.5</td>
                <td align="center" rowspan="1" colspan="1">0.778</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">−1</td>
                <td align="center" rowspan="1" colspan="1">0.616</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">−1.5</td>
                <td align="center" rowspan="1" colspan="1">0.532</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">−2</td>
                <td align="center" rowspan="1" colspan="1">0.368</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">−2.5</td>
                <td align="center" rowspan="1" colspan="1">0.413</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">−3</td>
                <td align="center" rowspan="1" colspan="1">1.25</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">−3.5</td>
                <td align="center" rowspan="1" colspan="1">0.633</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">−4</td>
                <td align="center" rowspan="1" colspan="1">0.611</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">−4.5</td>
                <td align="center" rowspan="1" colspan="1">0.105</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">−5</td>
                <td align="center" rowspan="1" colspan="1">0.0120</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">−5.5</td>
                <td align="center" rowspan="1" colspan="1">0.0143</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">−6</td>
                <td align="center" rowspan="1" colspan="1">0.134</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">−7</td>
                <td align="center" rowspan="1" colspan="1">0.0768</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">−8</td>
                <td align="center" rowspan="1" colspan="1">0.259</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">−9</td>
                <td align="center" rowspan="1" colspan="1">0.0799</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">−10</td>
                <td align="center" rowspan="1" colspan="1">0.215</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">−12</td>
                <td align="center" rowspan="1" colspan="1">0.531</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">−14</td>
                <td align="center" rowspan="1" colspan="1">0.667</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">−16</td>
                <td align="center" rowspan="1" colspan="1">0.199</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">−18</td>
                <td align="center" rowspan="1" colspan="1">0.0802</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">molarity</td>
                <td align="center" rowspan="1" colspan="1">molarity</td>
                <td align="center" rowspan="1" colspan="1">10.2</td>
                <td align="char" char="." rowspan="1" colspan="1">10.2</td>
              </tr>
              <tr>
                <td align="left" rowspan="6" colspan="1">last 5 bases near 3′-end</td>
                <td align="center" rowspan="1" colspan="1">GC-clamp</td>
                <td align="center" rowspan="1" colspan="1">1.92</td>
                <td align="char" char="." rowspan="6" colspan="1">10.2</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">first base from 3’ end</td>
                <td align="center" rowspan="1" colspan="1">1.08</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">second base from 3’ end</td>
                <td align="center" rowspan="1" colspan="1">2.48</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">third base from 3’ end</td>
                <td align="center" rowspan="1" colspan="1">1.32</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">fourth base from 3’ end</td>
                <td align="center" rowspan="1" colspan="1">1.41</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">fifth base from 3’ end</td>
                <td align="center" rowspan="1" colspan="1">1.96</td>
              </tr>
              <tr>
                <td align="left" rowspan="2" colspan="1">A/T content features</td>
                <td align="center" rowspan="1" colspan="1">number/proportion of A’s</td>
                <td align="center" rowspan="1" colspan="1">1.16/1.25</td>
                <td align="char" char="." rowspan="2" colspan="1">6.42</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">number/proportion of T’s</td>
                <td align="center" rowspan="1" colspan="1">1.03/2.98</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">melting temperature</td>
                <td align="center" rowspan="1" colspan="1">melting temperature</td>
                <td align="center" rowspan="1" colspan="1">6.33</td>
                <td align="char" char="." rowspan="1" colspan="1">6.33</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">sequence length</td>
                <td align="center" rowspan="1" colspan="1">sequence length</td>
                <td align="center" rowspan="1" colspan="1">2.56</td>
                <td align="char" char="." rowspan="1" colspan="1">2.56</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
      </table-wrap>
      <sec id="sec009">
        <title>An active learning approach</title>
        <p>Active learning, a type of iterative supervised machine learning, was used to maximize information gain in three rounds of single primer amplification experimentation. The previously published SWGA Perl script [<xref rid="pcbi.1010137.ref012" ref-type="bibr">12</xref>] was used to generate a list of all primers with one exact-match binding site on one of the plasmids and no exact-match binding site on the other plasmid (pcDNA3-EGFP and pLTR-RD114A from Addgene). The first round of experimental amplification used 204 primers from this list that maximized the variability in the 22 primer attributes in <xref rid="pcbi.1010137.t003" ref-type="table">Table 3</xref>, excluding the thermodynamic binding affinity features. A random forest regressor model was built using the target and off-target amplification data from the first round of experimental amplifications as it had the best performance of the tested models (linear, logistic, random forest, gradient boosting, and support vector machine). The optimal parameters according to a hyperparameter search were <monospace specific-use="no-wrap">n_estimators</monospace>=1500, <monospace specific-use="no-wrap">min_samples_split</monospace>=10, <monospace specific-use="no-wrap">min_samples_leaf</monospace>=4, <monospace specific-use="no-wrap">max_depth</monospace>=50, <monospace specific-use="no-wrap">bootstrap</monospace>=False.</p>
        <p>The random forest regression model was used to predict the amplification efficacy of all primers in the original list. The 96 primers predicted to have the greatest amplification efficacy were chosen for the second round of experimental assessment. The experimental amplification data from round 2 were used to update the random forest regression model. An additional 96 primers predicted to have the greatest amplification efficacy were chosen for a third round of experimental evaluation. The final random forest regression model, built on the experimental results from three rounds of single-primer amplification experiments, is included in the <monospace specific-use="no-wrap">swga2.0</monospace> primer design pipeline (Stage 3).</p>
      </sec>
    </sec>
    <sec id="sec010">
      <title>Primer set scoring function</title>
      <p>Multiple analytical frameworks were explored to construct a primer set scoring function that would accurately predict amplification efficacy and evenness from an individual primer set, determined by the proportion of the target genome with at least 1× sequencing coverage. Multiple primer set scoring functions were trained on data from 46 sets of published SWGA and sequencing data from <italic toggle="yes">Mycobacterium tuberculosis</italic> and <italic toggle="yes">Homo sapiens</italic> [<xref rid="pcbi.1010137.ref017" ref-type="bibr">17</xref>]. Model features were selected from a set of variables thought to influence amplification of the target genome (Gini index, nucleotide distance between target binding sites, entropy and generalized entropy of the binding site distribution), amplification of background DNA (kurtosis, skewness, bimodality, and variance among binding sites), and combinations of target to background amplification (the frequency of binding sites, average distance between binding sites on the same strand, average distance between binding sites on the opposite strands). The best model was selected using 10-fold cross-validation error among ridge regression candidate models. Ridge regression, which uses regularization to reduce model variance, was favored in order to reduce the risk of overfitting given the limited data.</p>
    </sec>
    <sec id="sec011">
      <title>Empirical evaluation of primer sets</title>
      <p>Primer sets designed to amplify <italic toggle="yes">Prevotella melaninogenica</italic> from samples dominated by human DNA were empirically tested to evaluate the efficacy of <monospace specific-use="no-wrap">swga2.0</monospace>. Six primer sets were created using <italic toggle="yes">P. melaninogenica</italic> strain ATCC 25845 (GCF_000144405.1) as the target genome and the human genome (GRCh38.p13) as the background DNA. The six primer sets were evaluated in duplicate on purified <italic toggle="yes">P. melaninogenica</italic> DNA (strain ATCC 25845), diluted to 1% in purified human genomic DNA (Promega, female, catalog No. G1521). Briefly, the 1:99 target:background sample was digested with FspEI (New England Biolabs) according to the manufacturers protocol (incubation at 37°C for 90 minutes, 20 minute heat inactivation at 80°C). Although digestion has reduced mitochondrial DNA amplification or increased target amplification in some prior studies [<xref rid="pcbi.1010137.ref012" ref-type="bibr">12</xref>, <xref rid="pcbi.1010137.ref020" ref-type="bibr">20</xref>, <xref rid="pcbi.1010137.ref037" ref-type="bibr">37</xref>], experiments amplifying non-digested DNA using two of the <italic toggle="yes">Prevotella</italic> primer sets resulted in comparable amplification success with the digested samples. The digested sample was purified using AmpureXP beads (Beckman Coulter) prior to performing selective whole-genome amplification as previously described [<xref rid="pcbi.1010137.ref018" ref-type="bibr">18</xref>] with slight modifications. Reactions were performed in a volume of 50 uL using 50 ng of digested DNA, SWGA primers (total concentration of all primers together = 3.5mM), 1× Φ29 buffer (New England Biolabs), 1 mM dNTPs, and 30 units Φ29 polymerase (New England Biolabs). Amplification conditions included a ramp-down from 35 to 31°C (5 min at 35°C, 10 min at 34°C, 15 min at 33°C, 20 min at 32°C, 25 min at 31°C), followed by a 16h amplification step at 30°C. The polymerase was then denatured for 15 min at 65°C. Amplified samples were purified using AmpureXP beads, prepared for Illumina sequencing [<xref rid="pcbi.1010137.ref038" ref-type="bibr">38</xref>], and sequenced on an Illumina MiSeq (150 bp, paired end). The unamplified sample was also sequenced to assess changes in sequencing coverage due to SWGA. Illumina-specific adapter and primer sequences were removed from the reads using <monospace specific-use="no-wrap">Cutadapt</monospace> (Martin, 2011) and reads aligned to the target genome using <monospace specific-use="no-wrap">BWA mem</monospace> (v0.7.1). Analysis of sequence coverage of the target genome was performed using <monospace specific-use="no-wrap">samtools</monospace> (v1.9) [<xref rid="pcbi.1010137.ref039" ref-type="bibr">39</xref>].</p>
    </sec>
  </sec>
  <sec sec-type="results" id="sec012">
    <title>Results</title>
    <sec id="sec013">
      <title>Primer amplification efficacy</title>
      <p>Individual primers were evaluated in amplification experiments using plasmids that either did or did not have exact-match binding sites. The active learning approach, in which data were collected to train a random forest regression model that was then used to choose additional primers, maximized the information gained from each of the three rounds of amplification experiments. The goal of the first round of experiments was to maximize the exploration of the feature space across 22 primer characteristics (<xref rid="pcbi.1010137.t003" ref-type="table">Table 3</xref>, excluding binding affinity features). Only a few of the 204 tested primers resulted in strong amplification of the target plasmid and weak amplification of the off-target plasmid (<xref rid="pcbi.1010137.g003" ref-type="fig">Fig 3</xref>; <xref rid="pcbi.1010137.s002" ref-type="supplementary-material">S1 Table</xref>).</p>
      <fig position="float" id="pcbi.1010137.g003">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1010137.g003</object-id>
        <label>Fig 3</label>
        <caption>
          <title>The accuracy of amplification efficacy predictions increased after three iterations of the active learning approach designed to identify primer characteristics associated with effective priming.</title>
          <p>Amplification of the target plasmid was weak in the majority of the randomly selected primers experimentally investigated in Round 1 (blue points represent the 204 primers evaluated). Target plasmid amplification was equally poor for the primers selected for Round 2 experimentation (96 orange points) by the random forest regressor model trained on the data from Round 1. The majority of primers selected for Round 3 experimentation (96 green points) by the updated random forest regressor model trained on the data from Rounds 1 and 2 resulted in moderate and high amplification of the target plasmid. Points are adjusted along the <italic toggle="yes">x</italic>-axis so that they do not overlap.</p>
        </caption>
        <graphic xlink:href="pcbi.1010137.g003" position="float"/>
      </fig>
      <p>The data collected from the first round of amplification experiments were used to build a random forest regression model and predict the amplification potential of an additional 96 primers (<xref rid="pcbi.1010137.s002" ref-type="supplementary-material">S1 Table</xref>). Although a greater proportion of the primers utilized in the second experimental round resulted in strong amplification of the target plasmid, the majority still performed poorly (<xref rid="pcbi.1010137.g003" ref-type="fig">Fig 3</xref>), likely due to training the initial model with few high-performing primers from the initial round which limited extrapolation to the high-amplification regime. Training the random forest regression model with data from rounds 1 and 2 resulted in a model that predicted primarily high-amplification primers.</p>
      <p>The high variance in the amplification efficacy of primers selected by the final random forest model iteration makes accurate prediction of high-amplification primers difficult. Fortunately, however, this model accurately predicts poor amplification (amplification scores &lt; 10; <xref rid="pcbi.1010137.g004" ref-type="fig">Fig 4</xref>). As the utility of this model is to exclude low-amplification primers from SWGA primer sets, the <monospace specific-use="no-wrap">swga2.0</monospace> pipeline uses the random forest regressor to filter low-amplification primers in Stage 3 (Primer efficacy filter). The random forest regressor excludes a high proportion of low-performing primers and rarely excludes higher-performing primers as determined by testing the model predictions on out-of-sample data (<xref rid="pcbi.1010137.t004" ref-type="table">Table 4</xref>). The minimum predicted amplification parameter (<monospace specific-use="no-wrap">min_amp_pred</monospace>, default threshold value = 5) can be modified to exclude a greater proportion of poor-performing primers. Excluding greater numbers of poor-performing primers will reduce the computational complexity of finding primer sets and reduce the probability of experimentally evaluating poor primer sets.</p>
      <fig position="float" id="pcbi.1010137.g004">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1010137.g004</object-id>
        <label>Fig 4</label>
        <caption>
          <title>The final random forest regression model reliably predicts the amplification efficacy of individual primers.</title>
          <p>The amplification predicted for Round 2 amplification was accurate only for low-performing primers (orange). Updating the model with Round 2 amplification data resulted in a model that predicted highly effective primers (green). The amplification efficacy of the primers selected for Round 3 were highly variable despite similar predictions. Nevertheless, the final random forest regression model did not select any poor performing primers. The model was not used to predict the primers used in Round 1.</p>
        </caption>
        <graphic xlink:href="pcbi.1010137.g004" position="float"/>
      </fig>
      <table-wrap position="float" id="pcbi.1010137.t004">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1010137.t004</object-id>
        <label>Table 4</label>
        <caption>
          <title>Poor performing primers are filtered out in Stage 3 of <monospace specific-use="no-wrap">swga2.0</monospace>.</title>
          <p>Higher threshold values in the random forest regression model filter greater proportions of lower-amplification primers but few moderate or efficient primers.</p>
        </caption>
        <alternatives>
          <graphic xlink:href="pcbi.1010137.t004" id="pcbi.1010137.t004g" position="float"/>
          <table frame="box" rules="all" border="0">
            <colgroup span="1">
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th align="center" rowspan="1" colspan="1">Threshold parameter</th>
                <th align="center" rowspan="1" colspan="1">Total primers filtered</th>
                <th align="center" rowspan="1" colspan="1">High-amplification primers filtered</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="center" rowspan="1" colspan="1">2</td>
                <td align="char" char="." rowspan="1" colspan="1">6.5%</td>
                <td align="char" char="." rowspan="1" colspan="1">0.04%</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">5</td>
                <td align="char" char="." rowspan="1" colspan="1">26.5%</td>
                <td align="char" char="." rowspan="1" colspan="1">1.6%</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">10</td>
                <td align="char" char="." rowspan="1" colspan="1">47.1%</td>
                <td align="char" char="." rowspan="1" colspan="1">3.8%</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">15</td>
                <td align="char" char="." rowspan="1" colspan="1">58.9%</td>
                <td align="char" char="." rowspan="1" colspan="1">4.4%</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">20</td>
                <td align="char" char="." rowspan="1" colspan="1">66.6%</td>
                <td align="char" char="." rowspan="1" colspan="1">5.4%</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
      </table-wrap>
      <sec id="sec014">
        <title>Feature importance in the random forest regression model</title>
        <p>Feature importance, computed from the variance reduction at each split in each tree, identifies the impact of each variable on primer performance predictions (<xref rid="pcbi.1010137.t003" ref-type="table">Table 3</xref>). Features involving GC content are the most important subset of features (27.9%) followed by binding affinities calculated from the thermodynamic binding model (18.1%). The features involving GC-content and the thermodynamic binding affinity features are in agreement, as expected, as these sets of features are correlated. For example, primers with greater GC tend to have more negative <inline-formula id="pcbi.1010137.e011"><alternatives><graphic xlink:href="pcbi.1010137.e011.jpg" id="pcbi.1010137.e011g" position="anchor"/><mml:math id="M11" display="inline" overflow="scroll"><mml:mrow><mml:mo>Δ</mml:mo><mml:msubsup><mml:mi>G</mml:mi><mml:mi>T</mml:mi><mml:mo>∘</mml:mo></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> values calculated in the thermodynamic model [<xref rid="pcbi.1010137.ref035" ref-type="bibr">35</xref>].</p>
      </sec>
    </sec>
    <sec id="sec015">
      <title>Primer set search and scoring function</title>
      <p>The optimal primer set scoring function selected uses five variables (<monospace specific-use="no-wrap">freq_ratio</monospace>, <monospace specific-use="no-wrap">mean_gap_ratio</monospace>, <monospace specific-use="no-wrap">coverage_ratio</monospace>, <monospace specific-use="no-wrap">on_gap_gini</monospace> and <monospace specific-use="no-wrap">off_gap_gini</monospace>) within a ridge regression framework (<xref rid="pcbi.1010137.t002" ref-type="table">Table 2</xref>). The variables <monospace specific-use="no-wrap">freq_ratio</monospace> and <monospace specific-use="no-wrap">mean_gap_ratio</monospace> are summary statistics previously found to correlate with SWGA success [<xref rid="pcbi.1010137.ref017" ref-type="bibr">17</xref>]. The <monospace specific-use="no-wrap">freq_ratio</monospace> variable is a simple measure of binding site frequency between the on-target and off-target genomes. The <monospace specific-use="no-wrap">mean_gap_ratio</monospace> variable measures the average distance in base pairs between primer positions on both the forward and reverse strands where the computation is indifferent to the strand on which a binding position lies. <monospace specific-use="no-wrap">coverage_ratio</monospace> is computed by first identifying the number of binding sites on the opposite strand that are within 70 kbp of an exact primer binding site (70 kbp is the maximum length of the synthesized DNA by Φ29 [<xref rid="pcbi.1010137.ref040" ref-type="bibr">40</xref>]). Exponential amplification using Φ29 requires priming positions in the opposite direction within 70 kbp of each other. The number of binding sites within 70 kbp of each binding site on the opposite strand is then normalized by the total genome length as a proxy for primer ‘coverage’. The <monospace specific-use="no-wrap">coverage_ratio</monospace> is the ratio of the coverage in the target genome to the coverage in the background DNA, which is minimized in the ridge regression model (negative regression coefficient value). Primer evenness is represented in the model for each strand of the target and off-target genomes by <monospace specific-use="no-wrap">on_gap_gini</monospace> and <monospace specific-use="no-wrap">off_gap_gini</monospace>, respectively, and is computed using the Gini index of distances between binding sites.</p>
      <sec id="sec016">
        <title>Computational costs are reduced more than ten-fold</title>
        <p>The computational time needed to build primer sets using <monospace specific-use="no-wrap">swga2.0</monospace> is significantly lower than for the original <monospace specific-use="no-wrap">swga1.0</monospace> program (<xref rid="pcbi.1010137.t001" ref-type="table">Table 1</xref>). Both programs use the same base framework to create files to store the catalog of 6–12-mers found in the target and background genomes. In <monospace specific-use="no-wrap">swga2.0</monospace>, however, these files are stored efficiently for future use and need not be re-created if additional primer sets are desired. Using a 2013 MacBook Pro (2 GHz Intel Core i7 with 16 GB of memory; <monospace specific-use="no-wrap">max_sets</monospace> = 5; <monospace specific-use="no-wrap">max_primers</monospace> = 200), the <monospace specific-use="no-wrap">swga2.0</monospace> pipeline completes its primer set design for <italic toggle="yes">P. melaninogenica</italic> and <italic toggle="yes">H. sapiens</italic> in 93 minutes, a process that requires more than ten times as long using <monospace specific-use="no-wrap">swga1.0</monospace> (<xref rid="pcbi.1010137.t001" ref-type="table">Table 1</xref>). The increase in computational efficiency is the result of multi-processing in many aspects of the pipeline and utilization of an efficient rather than exhaustive search algorithm. Additionally, file formats like <monospace specific-use="no-wrap">h5py</monospace> allow for O(1) read access to primer binding positions and data structures that cache primer set scores which eliminates unnecessary recalculations for future iterations. Lastly, <monospace specific-use="no-wrap">swga2.0</monospace> uses an efficient expression to calculate the exact Gini score and takes advantage of efficiencies in array computations in the Python library <monospace specific-use="no-wrap">numpy</monospace>.</p>
      </sec>
    </sec>
    <sec id="sec017">
      <title>Evaluation of primer sets to selectively amplify <italic toggle="yes">Prevotella melaninogenica</italic></title>
      <p><italic toggle="yes">Prevotella melaninogenica</italic> is an important pathogen in cystic fibrosis patients that is difficult to culture from human-derived samples [<xref rid="pcbi.1010137.ref041" ref-type="bibr">41</xref>, <xref rid="pcbi.1010137.ref042" ref-type="bibr">42</xref>]. <italic toggle="yes">P. melaninogenica</italic> was chosen to evaluate the improvements in the <monospace specific-use="no-wrap">swga2.0</monospace> primer design pipeline as it was expected to be more challenging to selectively amplify for several reasons. For example, both the human genome and <italic toggle="yes">P. melaninogenica</italic> have a GC-content of 41% while the GC-content in the <italic toggle="yes">M. tuberculosis</italic> genome is 65.6% [<xref rid="pcbi.1010137.ref043" ref-type="bibr">43</xref>, <xref rid="pcbi.1010137.ref044" ref-type="bibr">44</xref>]. Due to the similarities between <italic toggle="yes">P. melaninogenica</italic> and the human genome, only 14 candidate primers passed the most restrictive filters in Stage 2 (<monospace specific-use="no-wrap">min_fg_freq</monospace> = 1/33,333; <monospace specific-use="no-wrap">max_bg_freq</monospace> = 1/500,000). By contrast, 114 primers passed the same set of filters for <italic toggle="yes">M. tuberculosis</italic> (<xref rid="pcbi.1010137.t005" ref-type="table">Table 5</xref>). The number and quality of primers retained in Stages 1–3 of the <monospace specific-use="no-wrap">swga2.0</monospace> pipeline is critical to building effective primer sets to selectively amplify a target genome in Stage 4. We built three primer sets for <italic toggle="yes">P. melaninogenica</italic> from the 19 primers retained using a less restrictive background DNA filter (Primer sets 1–3; <monospace specific-use="no-wrap">min_fg_freq</monospace> = 1/33,333 bp; <monospace specific-use="no-wrap">max_bg_freq</monospace> = 1/333,333 bp) and three primer sets from the 48 primers retained using a less restrictive target genome filter (Primer sets 4–6; <monospace specific-use="no-wrap">min_fg_freq</monospace> = 1/40,000 bp; <monospace specific-use="no-wrap">max_bg_freq</monospace> = 1/500,000 bp; <xref rid="pcbi.1010137.t005" ref-type="table">Table 5</xref>). The primer sets and their associated statistics are presented in <xref rid="pcbi.1010137.s003" ref-type="supplementary-material">S2 Table</xref>.</p>
      <table-wrap position="float" id="pcbi.1010137.t005">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1010137.t005</object-id>
        <label>Table 5</label>
        <caption>
          <title><italic toggle="yes">P. melaninogenica</italic> is a more difficult genome to design primers for than <italic toggle="yes">M. tuberculosis</italic>.</title>
          <p>Searching the two genomes with the same parameters during Stages 2 and 3 produces much larger lists of candidate primers for <italic toggle="yes">M. tuberculosis</italic> than for <italic toggle="yes">P. melaninogenica</italic>. Values are the number of candidate primers remaining after Stage 3 (parenthetical numbers are the candidate primers remaining after Stage 2).</p>
        </caption>
        <alternatives>
          <graphic xlink:href="pcbi.1010137.t005" id="pcbi.1010137.t005g" position="float"/>
          <table frame="box" rules="all" border="0">
            <colgroup span="1">
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th align="center" rowspan="1" colspan="1">Mean Target Frequency</th>
                <th align="center" rowspan="1" colspan="1">Mean Background Frequency</th>
                <th align="center" rowspan="1" colspan="1">
                  <italic toggle="yes">Prevotella melaninogenica</italic>
                </th>
                <th align="center" rowspan="1" colspan="1">
                  <italic toggle="yes">Mycobacterium tuberculosis</italic>
                </th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="center" rowspan="1" colspan="1">&lt; 1/33.3 kbp</td>
                <td align="center" rowspan="1" colspan="1">&gt; 1/500.0 kbp</td>
                <td align="center" rowspan="1" colspan="1">14 (84)</td>
                <td align="center" rowspan="1" colspan="1">114 (676)</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">&lt; 1/33.3 kbp</td>
                <td align="center" rowspan="1" colspan="1">&gt; 1/333.3 kbp</td>
                <td align="center" rowspan="1" colspan="1">19 (143)</td>
                <td align="center" rowspan="1" colspan="1">162 (884)</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">&lt; 1/33.3 kbp</td>
                <td align="center" rowspan="1" colspan="1">&gt; 1/300.0 kbp</td>
                <td align="center" rowspan="1" colspan="1">22 (174)</td>
                <td align="center" rowspan="1" colspan="1">169 (939)</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">&lt; 1/40.0 kbp</td>
                <td align="center" rowspan="1" colspan="1">&gt; 1/500.0 kbp</td>
                <td align="center" rowspan="1" colspan="1">48 (217)</td>
                <td align="center" rowspan="1" colspan="1">168 (920)</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">&lt; 1/40.0 kbp</td>
                <td align="center" rowspan="1" colspan="1">&gt; 1/333.3 kbp</td>
                <td align="center" rowspan="1" colspan="1">93 (396)</td>
                <td align="center" rowspan="1" colspan="1">250 (1238)</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">&lt; 1/40.0 kbp</td>
                <td align="center" rowspan="1" colspan="1">&gt; 1/300.0 kbp</td>
                <td align="center" rowspan="1" colspan="1">103 (448)</td>
                <td align="center" rowspan="1" colspan="1">260 (1308)</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
      </table-wrap>
      <p>Although the sequence motif similarities between <italic toggle="yes">P. melaninogenica</italic> and the human genome made primer set design more difficult, three of the six primer sets built by <monospace specific-use="no-wrap">swga2.0</monospace> were highly effective at selectively amplifying <italic toggle="yes">P. melaninogenica</italic> from a sample dominated by human DNA (99%) (<xref rid="pcbi.1010137.s004" ref-type="supplementary-material">S3 Table</xref>; <ext-link xlink:href="https://doi.org/10.5061/dryad.3n5tb2rm2" ext-link-type="uri">https://doi.org/10.5061/dryad.3n5tb2rm2</ext-link>). By comparison, 40% of the primer sets designed to amplify <italic toggle="yes">M. tuberculosis</italic> using the prior <monospace specific-use="no-wrap">swga1.0</monospace> pipeline performed much better than the unamplified controls [<xref rid="pcbi.1010137.ref017" ref-type="bibr">17</xref>]. High-throughput sequencing of the amplification products from the three effective <italic toggle="yes">P. melaninogenica</italic> primer sets reached 1× coverage across 25–64% the target genome with 50 Mbp sequencing effort (<xref rid="pcbi.1010137.g005" ref-type="fig">Fig 5</xref>). The most effective primer set designed by <monospace specific-use="no-wrap">swga1.0</monospace> in a prior study reached 1× coverage across only 27% of the <italic toggle="yes">M. tuberculosis</italic> with 50 Mbp sequencing effort [<xref rid="pcbi.1010137.ref017" ref-type="bibr">17</xref>]. Similarly, deeper sequencing of the amplification products of the effective primer sets reached 10× coverage at 33–82% of the the <italic toggle="yes">P. melaninogenica</italic> genome after 700 Mbp of sequencing effort, compared with just 0.2% for the unamplified control (<xref rid="pcbi.1010137.g006" ref-type="fig">Fig 6</xref>). The most effective <italic toggle="yes">M. tuberculosis</italic> primers reached 10× coverage at less than 30% of the target genome at similar sequencing effort [<xref rid="pcbi.1010137.ref017" ref-type="bibr">17</xref>].</p>
      <fig position="float" id="pcbi.1010137.g005">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1010137.g005</object-id>
        <label>Fig 5</label>
        <caption>
          <title>Selective amplification of <italic toggle="yes">P. melanogenica</italic> using six <monospace specific-use="no-wrap">swga2.0</monospace>-designed primer sets (Prev01-Prev06) identified three primer sets (Prev03, Prev06, and Prev04) that can amplify the target genome but not the background DNA.</title>
          <p>Red and yellow lines indicate the percent of the target genome covered at 1× depth from sequencing each of the two replicate amplification experiments. The black dashed lines represent sequencing coverage of the unamplified samples. While five of the six sets resulted in greater sequencing coverage of the target genome compared to unamplified controls, two were only marginally better. By contrast, sequencing coverage of the amplicons from three of the sets was substantially better than the coverage of the unamplified samples.</p>
        </caption>
        <graphic xlink:href="pcbi.1010137.g005" position="float"/>
      </fig>
      <fig position="float" id="pcbi.1010137.g006">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1010137.g006</object-id>
        <label>Fig 6</label>
        <caption>
          <title>Deeper sequencing of the three successful primer sets—Prev03, Prev06, and Prev04—confirms the efficient and even selective amplification of <italic toggle="yes">P. melaninogenica</italic>.</title>
          <p>The solid colored lines indicate individual replicates and the green dashed line represents the pooled total. Each of the three primer sets yield dramatic increases in sequencing depth compared to the unamplified samples (black dashed line). Each primer set reached 10× coverage across 23–74% of the target genome, while the unamplified samples reached 10× coverage at &lt;1% of the target genome, with 500 Mbp of sequencing effort.</p>
        </caption>
        <graphic xlink:href="pcbi.1010137.g006" position="float"/>
      </fig>
    </sec>
  </sec>
  <sec sec-type="conclusions" id="sec018">
    <title>Discussion</title>
    <p>Analyses of populations of microbial genomes has the power to address many major outstanding questions in evolution and pathogenesis. Obtaining populations of genome sequence data has been aided by practical and cost-effective method advancements like Selective Whole Genome Amplification (SWGA). However, developing and verifying an effective SWGA primer set to selectively amplify a target genome from a heterogeneous sample has been both computationally and experimentally challenging. Prior applications of SWGA required considerable computational investment followed by experimental assessments of numerous primer sets, of which only a few worked sufficiently well. The <monospace specific-use="no-wrap">swga2.0</monospace> pipeline efficiently identifies primer sets, of which half are highly effective. These improvements were achieved by experimentally identifying characteristics of individual primers that result in effective amplification and limit mispriming and by using efficient data structures and search algorithms to identify primer set characteristics that are correlated with strong and even amplification. The resulting <monospace specific-use="no-wrap">swga2.0</monospace> program reduces both the computational and experimental investment necessary to design and subsequently utilize protocols to effectively transform a complex sample containing mostly DNA from nontarget species to a sample dominated by the genomic DNA of the target species.</p>
    <p>Computational identification of SWGA primer sets is a highly complex optimization problem involving scalability challenges and limited, noisy prior data. The previously published <monospace specific-use="no-wrap">swga1.0</monospace> program identified over five million candidate primers that needed to be filtered into a reasonable working catalog prior to designing primer sets to selectively amplify <italic toggle="yes">M. tuberculosis</italic>. The computational effort needed to assess each primer set combination requires data structures that efficiently store the information needed for evaluation without repeated searches across multiple genomes for potential binding locations. Further, identifying search and evaluation strategies to identify primer sets demands combinatorial optimization techniques that could be aided through analyses of prior SWGA data. However, learning from prior data has its own challenges due to both limited data availability and experimental noise associated with short-read sequencing data. Despite these challenges, the <monospace specific-use="no-wrap">swga2.0</monospace> program provides the necessary pipeline to rapidly identify primer sets that have a high probability of selectively amplifying any target genome from any background DNA sample [<xref rid="pcbi.1010137.ref045" ref-type="bibr">45</xref>].</p>
    <p>The <monospace specific-use="no-wrap">swga2.0</monospace> program offers a number of improvements including dramatically reduced computation time due to the implementation of parallelization, caching, branch-and-bound searching, and efficient data storage formats (<xref rid="pcbi.1010137.t001" ref-type="table">Table 1</xref>). Each of the four stages of the computational pipeline improves speed and accuracy. For example, the <monospace specific-use="no-wrap">jellyfish</monospace> program [<xref rid="pcbi.1010137.ref031" ref-type="bibr">31</xref>] used in <italic toggle="yes">k</italic>-mer preprocessing (Stage 1) is much faster than the DSK program [<xref rid="pcbi.1010137.ref046" ref-type="bibr">46</xref>] used in <monospace specific-use="no-wrap">swga1.0</monospace>; novel filters improve primer identification and prevent self-dimerization in filtering candidate primers (Stage 2); a novel machine-learning model for scoring individual primers based on amplification efficacy, which includes thermodynamically-principled binding affinities, improves primer efficacy estimation and reduces the candidate primer list (Stage 3); and the implementation of branch-and-bound techniques with randomized starting locations, drop-out techniques, and additional primer set evaluation functions learned from prior data improve both speed and accuracy of primer set searches and evaluation (Stage 4). Most importantly, optimization is no longer done by hand or via exhaustive search [<xref rid="pcbi.1010137.ref012" ref-type="bibr">12</xref>, <xref rid="pcbi.1010137.ref017" ref-type="bibr">17</xref>].</p>
    <p>Amplification from 6 to 12 bp primers is prone to mispriming. The random forest model presented here, built on iteratively collected experimental data, accurately identifies low-amplification primers with very few false positive identifications. Applying this filter to the candidate primers from <monospace specific-use="no-wrap">swga1.0</monospace> identifies more than 85% as having low-amplification potential. Further, all of ten top-rated primer sets designed by <monospace specific-use="no-wrap">swga1.0</monospace> are made exclusively of primers with low-amplification potential. The random forest model is generalizable to all SWGA projects as it identifies amplification efficacy from primer sequence properties such as GC content and thermodynamically-principled binding affinities [<xref rid="pcbi.1010137.ref035" ref-type="bibr">35</xref>, <xref rid="pcbi.1010137.ref036" ref-type="bibr">36</xref>]. Thus, we expect that this model can be used to predict effective primers when using alternative polymerases such as <italic toggle="yes">EquiPhi29</italic> or <italic toggle="yes">Bst</italic>. However, empirical validation of the primer efficacy model using alternative polymerases would be prudent. Regardless, this novel model allows researchers to remove low-amplification primers from the primer set search and evaluation (Stage 4), resulting in a considerable reduction in computational time complexity and reducing the number of experimentally-tested primer sets that perform poorly.</p>
    <p>The primer sets designed by <monospace specific-use="no-wrap">swga2.0</monospace> to selectively amplify <italic toggle="yes">P. melaninogenica</italic> from a sample dominated by human DNA were highly successful. Out of the six primer sets tested, three sets amplified the target genome significantly more than the negative controls. Similar to the conclusion from prior primer set design algorithms [<xref rid="pcbi.1010137.ref012" ref-type="bibr">12</xref>, <xref rid="pcbi.1010137.ref017" ref-type="bibr">17</xref>], the primer sets with lower mean binding distance in the target genome (Prev03—1/4.1 kbp, Prev04—1/2.0 kbp, Prev06—1/4.9 kbp) generally outperformed the other sets (Prev01—1/7.4 kbp, Prev02—1/5.0 kbp, Prev05—1/2.8 kbp). However, all of the sets have similar mean binding distances suggesting that other primer or set attributes that have not been identified likely account for much of the observed variation in amplification success (<xref rid="pcbi.1010137.s003" ref-type="supplementary-material">S2 Table</xref>). Nevertheless, it is expected that approximately half of all designed sets are likely to give strong and even selective amplification results such that few sets need to be experimentally evaluated by researchers. Also similar to prior results [<xref rid="pcbi.1010137.ref020" ref-type="bibr">20</xref>], protocols developed with <monospace specific-use="no-wrap">swga2.0</monospace> are expected to retain the ability to investigate within-host microbial diversity using SWGA enrichment [<xref rid="pcbi.1010137.ref045" ref-type="bibr">45</xref>], without introducing errors, as the SWGA biochemistry remains identical (<xref rid="pcbi.1010137.s005" ref-type="supplementary-material">S4 Table</xref>). These advances reduce the up-front cost of developing the SWGA primer sets necessary for population genomic studies.</p>
    <p>The data and analyses from this and prior SWGA projects suggest the following as a general primer identification and primer set design workflow for future projects:</p>
    <list list-type="bullet">
      <list-item>
        <p><underline>Stage 2 (Candidate primer filtering)</underline>: Set the <monospace specific-use="no-wrap">min_fg_freq</monospace> parameter as high as possible, and the <monospace specific-use="no-wrap">max_bg_freq</monospace> parameter as low as possible but not below 3 × 10<sup>6</sup>, while retaining approximately 100 primers.</p>
      </list-item>
      <list-item>
        <p><underline>Stage 3 (Primer efficacy filter)</underline>: Set the <monospace specific-use="no-wrap">min_amp_pred</monospace> to 10 or higher to eliminate low-efficiency primers. If too few candidate primers are retained (&lt; 20), increase the number of primers that pass Stage 2 filtration by reducing <monospace specific-use="no-wrap">min_fg_freq</monospace> as opposed to reducing the <monospace specific-use="no-wrap">min_amp_pred</monospace> parameter value.</p>
      </list-item>
      <list-item>
        <p><underline>Stage 4 (Primer set search and evaluation)</underline>: Select 5–10 primer sets with the highest scores for experimental evaluation. However, it is not recommended to choose the top 5–10 sets as they often differ by only one or two primers. It is prudent to choose three of the top-scoring sets and several others with high scores that share few primers with the top-scoring sets. Experimentally amplify the target genome from a mixed sample (≈ 1% target DNA), barcode amplicons from each primer set separately, then pool and sequence at low depth to assess performance. Sequence amplicons from high-performing sets to ensure quality and evenness.</p>
      </list-item>
    </list>
    <p>Best practices are likely to evolve as SWGA is used more frequently. To facilitate this, the project source repository web page contains on a tutorial on the program’s operation and more extensive documentation on each parameter and module as well as a link to a user mailing list (<ext-link xlink:href="https://github.com/songlab-cal/swga2" ext-link-type="uri">https://github.com/songlab-cal/swga2</ext-link>).</p>
  </sec>
  <sec id="sec019">
    <title>Dryad DOI</title>
    <p><ext-link xlink:href="https://doi.org/10.5061/dryad.3n5tb2rm2" ext-link-type="uri">https://doi.org/10.5061/dryad.3n5tb2rm2</ext-link>.</p>
  </sec>
  <sec id="sec020" sec-type="supplementary-material">
    <title>Supporting information</title>
    <supplementary-material id="pcbi.1010137.s001" position="float" content-type="local-data">
      <label>S1 Appendix</label>
      <caption>
        <title>Primer set search algorithm.</title>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pcbi.1010137.s001.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1010137.s002" position="float" content-type="local-data">
      <label>S1 Table</label>
      <caption>
        <title>Primer amplification data.</title>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pcbi.1010137.s002.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1010137.s003" position="float" content-type="local-data">
      <label>S2 Table</label>
      <caption>
        <title>Primer set statistics and sequences.</title>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pcbi.1010137.s003.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1010137.s004" position="float" content-type="local-data">
      <label>S3 Table</label>
      <caption>
        <title>Percent of reads mapping to <italic toggle="yes">Prevotella</italic> and Human (background) sequences (15 Mbp sequenced).</title>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pcbi.1010137.s004.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1010137.s005" position="float" content-type="local-data">
      <label>S4 Table</label>
      <caption>
        <title>Proportion of called bases matching the <italic toggle="yes">Prevotella</italic> reference genome demonstrates that SWGA does not introduce sequencing errors.</title>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pcbi.1010137.s005.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <p>We are grateful to Paul Planet and Prioty Sarwar for providing genomic DNA.</p>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="pcbi.1010137.ref001">
      <label>1</label>
      <mixed-citation publication-type="journal"><name><surname>Nosil</surname><given-names>P</given-names></name>, <name><surname>Buerkle</surname><given-names>A</given-names></name>. <article-title>Population Genomics</article-title>. <source>Nature Education Knowledge</source>. <year>2010</year>;<volume>3</volume>(<issue>10</issue>):<fpage>8</fpage>.</mixed-citation>
    </ref>
    <ref id="pcbi.1010137.ref002">
      <label>2</label>
      <mixed-citation publication-type="journal"><name><surname>Lasken</surname><given-names>RS</given-names></name>, <name><surname>McLean</surname><given-names>JS</given-names></name>. <article-title>Recent advances in genomic DNA sequencing of microbial species from single cells</article-title>. <source>Nature Reviews Genetics</source>. <year>2014</year>;<volume>15</volume>:<fpage>577</fpage>–<lpage>584</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/nrg3785</pub-id><?supplied-pmid 25091868?><pub-id pub-id-type="pmid">25091868</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010137.ref003">
      <label>3</label>
      <mixed-citation publication-type="journal"><name><surname>Seth-Smith</surname><given-names>HMB</given-names></name>, <name><surname>Harris</surname><given-names>SR</given-names></name>, <name><surname>Skilton</surname><given-names>RJ</given-names></name>, <name><surname>Radebe</surname><given-names>FM</given-names></name>, <name><surname>Golparian</surname><given-names>D</given-names></name>, <name><surname>Shipitsyna</surname><given-names>E</given-names></name>, <etal>et al</etal>. <article-title>Whole-genome sequences of <italic toggle="yes">Chlamydia trachomatis</italic> directly from clinical samples without culture</article-title>. <source>Genome Research</source>. <year>2013</year>;<volume>23</volume>(<issue>5</issue>):<fpage>855</fpage>–<lpage>866</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1101/gr.150037.112</pub-id><?supplied-pmid 23525359?><pub-id pub-id-type="pmid">23525359</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010137.ref004">
      <label>4</label>
      <mixed-citation publication-type="journal"><name><surname>Richardson</surname><given-names>MF</given-names></name>, <name><surname>Weinert</surname><given-names>LA</given-names></name>, <name><surname>Welch</surname><given-names>JJ</given-names></name>, <name><surname>Linheiro</surname><given-names>RS</given-names></name>, <name><surname>Magwire</surname><given-names>MM</given-names></name>, <name><surname>Jiggins</surname><given-names>FM</given-names></name>, <etal>et al</etal>. <article-title>Population genomics of the <italic toggle="yes">Wolbachia</italic> endosymbiont in <italic toggle="yes">Drosophila melanogaster</italic></article-title>. <source>PLOS Genetics</source>. <year>2012</year>;<volume>8</volume>(<issue>12</issue>):<fpage>e1003129</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1371/journal.pgen.1003129</pub-id><?supplied-pmid 23284297?><pub-id pub-id-type="pmid">23284297</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010137.ref005">
      <label>5</label>
      <mixed-citation publication-type="journal"><name><surname>Pain</surname><given-names>A</given-names></name>, <name><surname>Böhme</surname><given-names>U</given-names></name>, <name><surname>Berry</surname><given-names>AE</given-names></name>, <name><surname>Mungall</surname><given-names>K</given-names></name>, <name><surname>Finn</surname><given-names>RD</given-names></name>, <name><surname>Jackson</surname><given-names>AP</given-names></name>, <etal>et al</etal>. <article-title>The genome of the simian and human malaria parasite <italic toggle="yes">Plasmodium knowlesi</italic></article-title>. <source>Nature</source>. <year>2008</year>;<volume>455</volume>:<fpage>799</fpage>–<lpage>803</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/nature07306</pub-id><?supplied-pmid 18843368?><pub-id pub-id-type="pmid">18843368</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010137.ref006">
      <label>6</label>
      <mixed-citation publication-type="journal"><name><surname>Mardis</surname><given-names>ER</given-names></name>. <article-title>Next-Generation DNA Sequencing Methods</article-title>. <source>Annual Review of Genomics and Human Genetics</source>. <year>2008</year>;<volume>9</volume>(<issue>1</issue>):<fpage>387</fpage>–<lpage>402</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1146/annurev.genom.9.081307.164359</pub-id><?supplied-pmid 18576944?><pub-id pub-id-type="pmid">18576944</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010137.ref007">
      <label>7</label>
      <mixed-citation publication-type="journal"><name><surname>Schmeisser</surname><given-names>C</given-names></name>, <name><surname>Steele</surname><given-names>H</given-names></name>, <name><surname>Streit</surname><given-names>WR</given-names></name>. <article-title>Metagenomics, biotechnology with non-culturable microbes</article-title>. <source>Applied Microbiology and Biotechnology</source>. <year>2007</year>;<volume>75</volume>(<issue>5</issue>):<fpage>955</fpage>–<lpage>962</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1007/s00253-007-0945-5</pub-id><?supplied-pmid 17396253?><pub-id pub-id-type="pmid">17396253</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010137.ref008">
      <label>8</label>
      <mixed-citation publication-type="journal"><name><surname>Kunin</surname><given-names>V</given-names></name>, <name><surname>Copeland</surname><given-names>A</given-names></name>, <name><surname>Lapidus</surname><given-names>A</given-names></name>, <name><surname>Mavromatis</surname><given-names>K</given-names></name>, <name><surname>Hugenholtz</surname><given-names>P</given-names></name>. <article-title>A Bioinformatician’s Guide to Metagenomics</article-title>. <source>Microbiology and Molecular Biology Reviews</source>. <year>2008</year>;<volume>72</volume>(<issue>4</issue>):<fpage>557</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1128/MMBR.00009-08</pub-id><?supplied-pmid 19052320?><pub-id pub-id-type="pmid">19052320</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010137.ref009">
      <label>9</label>
      <mixed-citation publication-type="journal"><name><surname>Eisen</surname><given-names>JA</given-names></name>. <article-title>Environmental Shotgun Sequencing: Its Potential and Challenges for Studying the Hidden World of Microbes</article-title>. <source>PLOS Biology</source>. <year>2007</year>;<volume>5</volume>(<issue>3</issue>):<fpage>e82</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1371/journal.pbio.0050082</pub-id><?supplied-pmid 17355177?><pub-id pub-id-type="pmid">17355177</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010137.ref010">
      <label>10</label>
      <mixed-citation publication-type="journal"><name><surname>Mamanova</surname><given-names>L</given-names></name>, <name><surname>Coffey</surname><given-names>AJ</given-names></name>, <name><surname>Scott</surname><given-names>CE</given-names></name>, <name><surname>Kozarewa</surname><given-names>I</given-names></name>, <name><surname>Turner</surname><given-names>EH</given-names></name>, <name><surname>Kumar</surname><given-names>A</given-names></name>, <etal>et al</etal>. <article-title>Target-enrichment strategies for next-generation sequencing</article-title>. <source>Nature Methods</source>. <year>2010</year>;<volume>7</volume>:<fpage>111</fpage>–<lpage>118</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/nmeth0610-479c</pub-id><?supplied-pmid 20111037?><pub-id pub-id-type="pmid">20111037</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010137.ref011">
      <label>11</label>
      <mixed-citation publication-type="journal"><name><surname>Blainey</surname><given-names>PC</given-names></name>. <article-title>The future is now: single-cell genomics of bacteria and archaea</article-title>. <source>FEMS Microbiology Reviews</source>. <year>2013</year>;<volume>37</volume>(<issue>3</issue>):<fpage>407</fpage>–<lpage>427</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1111/1574-6976.12015</pub-id><?supplied-pmid 23298390?><pub-id pub-id-type="pmid">23298390</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010137.ref012">
      <label>12</label>
      <mixed-citation publication-type="journal"><name><surname>Leichty</surname><given-names>AR</given-names></name>, <name><surname>Brisson</surname><given-names>D</given-names></name>. <article-title>Selective Whole Genome Amplification for Resequencing Target Microbial Species from Complex Natural Samples</article-title>. <source>Genetics</source>. <year>2014</year>;<volume>198</volume>(<issue>2</issue>):<fpage>473</fpage>–<lpage>481</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1534/genetics.114.165498</pub-id><?supplied-pmid 25096321?><pub-id pub-id-type="pmid">25096321</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010137.ref013">
      <label>13</label>
      <mixed-citation publication-type="journal"><name><surname>Rutledge</surname><given-names>GG</given-names></name>, <name><surname>Ariani</surname><given-names>CV</given-names></name>. <article-title>Finding the needle in the haystack</article-title>. <source>Nature Reviews Microbiology</source>. <year>2017</year>;<volume>15</volume>:<fpage>136</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/nrmicro.2017.7</pub-id><?supplied-pmid 28190880?><pub-id pub-id-type="pmid">28190880</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010137.ref014">
      <label>14</label>
      <mixed-citation publication-type="journal"><name><surname>Dean</surname><given-names>FB</given-names></name>, <name><surname>Nelson</surname><given-names>JR</given-names></name>, <name><surname>Giesler</surname><given-names>TL</given-names></name>, <name><surname>Lasken</surname><given-names>RS</given-names></name>. <source>Rapid Amplification of Plasmid and Phage DNA Using Phi29 DNA Polymerase and Multiply-Primed Rolling Circle Amplification</source>. <year>2001</year>;<volume>11</volume>(<issue>6</issue>):<fpage>1095</fpage>–<lpage>1099</lpage>.</mixed-citation>
    </ref>
    <ref id="pcbi.1010137.ref015">
      <label>15</label>
      <mixed-citation publication-type="journal"><name><surname>Pinard</surname><given-names>R</given-names></name>, <name><surname>de Winter</surname><given-names>A</given-names></name>, <name><surname>Sarkis</surname><given-names>GJ</given-names></name>, <name><surname>Gerstein</surname><given-names>MB</given-names></name>, <name><surname>Tartaro</surname><given-names>KR</given-names></name>, <name><surname>Plant</surname><given-names>RN</given-names></name>, <etal>et al</etal>. <article-title>Assessment of whole genome amplification-induced bias through high-throughput, massively parallel whole genome sequencing</article-title>. <source>BMC Genomics</source>. <year>2006</year>;<volume>7</volume>(<issue>1</issue>):<fpage>216</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1186/1471-2164-7-216</pub-id><?supplied-pmid 16928277?><pub-id pub-id-type="pmid">16928277</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010137.ref016">
      <label>16</label>
      <mixed-citation publication-type="journal"><name><surname>Banér</surname><given-names>J</given-names></name>, <name><surname>Mendel-Hartvig</surname><given-names>M</given-names></name>, <name><surname>Nilsson</surname><given-names>M</given-names></name>, <name><surname>Landegren</surname><given-names>U</given-names></name>. <article-title>Signal amplification of padlock probes by rolling circle replication</article-title>. <source>Nucleic Acids Research</source>. <year>1998</year>;<volume>26</volume>(<issue>22</issue>):<fpage>5073</fpage>–<lpage>5078</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/nar/26.22.5073</pub-id><?supplied-pmid 9801302?><pub-id pub-id-type="pmid">9801302</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010137.ref017">
      <label>17</label>
      <mixed-citation publication-type="journal"><name><surname>Clarke</surname><given-names>EL</given-names></name>, <name><surname>Sundararaman</surname><given-names>SA</given-names></name>, <name><surname>Seifert</surname><given-names>SN</given-names></name>, <name><surname>Bushman</surname><given-names>FD</given-names></name>, <name><surname>Hahn</surname><given-names>BH</given-names></name>, <name><surname>Brisson</surname><given-names>D</given-names></name>. <article-title>swga: a primer design toolkit for selective whole genome amplification</article-title>. <source>Bioinformatics</source>. <year>2017</year>;<volume>33</volume>(<issue>14</issue>):<fpage>2071</fpage>–<lpage>2077</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bioinformatics/btx118</pub-id><?supplied-pmid 28334194?><pub-id pub-id-type="pmid">28334194</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010137.ref018">
      <label>18</label>
      <mixed-citation publication-type="journal"><name><surname>Sundararaman</surname><given-names>SA</given-names></name>, <name><surname>Plenderleith</surname><given-names>LJ</given-names></name>, <name><surname>Liu</surname><given-names>W</given-names></name>, <name><surname>Loy</surname><given-names>DE</given-names></name>, <name><surname>Learn</surname><given-names>GH</given-names></name>, <name><surname>Li</surname><given-names>Y</given-names></name>, <etal>et al</etal>. <article-title>Genomes of cryptic chimpanzee <italic toggle="yes">Plasmodium</italic> species reveal key evolutionary events leading to human malaria</article-title>. <source>Nature Communications</source>. <year>2016</year>;<volume>7</volume>(<issue>7</issue>):<fpage>11078</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/ncomms11078</pub-id><?supplied-pmid 27002652?><pub-id pub-id-type="pmid">27002652</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010137.ref019">
      <label>19</label>
      <mixed-citation publication-type="journal"><name><surname>Guggisberg</surname><given-names>AM</given-names></name>, <name><surname>Sundararaman</surname><given-names>SA</given-names></name>, <name><surname>Lanaspa</surname><given-names>M</given-names></name>, <name><surname>Moraleda</surname><given-names>C</given-names></name>, <name><surname>González</surname><given-names>R</given-names></name>, <name><surname>Mayor</surname><given-names>A</given-names></name>, <etal>et al</etal>. <article-title>Whole-Genome Sequencing to Evaluate the Resistance Landscape Following Antimalarial Treatment Failure With Fosmidomycin-Clindamycin</article-title>. <source>The Journal of Infectious Diseases</source>. <year>2016</year>;<volume>214</volume>(<issue>7</issue>):<fpage>1085</fpage>–<lpage>1091</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/infdis/jiw304</pub-id><?supplied-pmid 27443612?><pub-id pub-id-type="pmid">27443612</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010137.ref020">
      <label>20</label>
      <mixed-citation publication-type="journal"><name><surname>Oyola</surname><given-names>SO</given-names></name>, <name><surname>Ariani</surname><given-names>CV</given-names></name>, <name><surname>Hamilton</surname><given-names>WL</given-names></name>, <name><surname>Kekre</surname><given-names>M</given-names></name>, <name><surname>Amenga-Etego</surname><given-names>LN</given-names></name>, <name><surname>Ghansah</surname><given-names>A</given-names></name>, <etal>et al</etal>. <article-title>Whole genome sequencing of <italic toggle="yes">Plasmodium falciparum</italic> from dried blood spots using selective whole genome amplification</article-title>. <source>Malaria Journal</source>. <year>2016</year>;<volume>15</volume>(<issue>1</issue>):<fpage>597</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1186/s12936-016-1641-7</pub-id><?supplied-pmid 27998271?><pub-id pub-id-type="pmid">27998271</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010137.ref021">
      <label>21</label>
      <mixed-citation publication-type="journal"><name><surname>Cowell</surname><given-names>AN</given-names></name>, <name><surname>Loy</surname><given-names>DE</given-names></name>, <name><surname>Sundararaman</surname><given-names>SA</given-names></name>, <name><surname>Valdivia</surname><given-names>H</given-names></name>, <name><surname>Fisch</surname><given-names>K</given-names></name>, <name><surname>Lescano</surname><given-names>AG</given-names></name>, <etal>et al</etal>. <article-title>Selective Whole-Genome Amplification Is a Robust Method That Enables Scalable Whole-Genome Sequencing of <italic toggle="yes">Plasmodium vivax</italic> from Unprocessed Clinical Samples</article-title>. <source>mBio</source>. <year>2017</year>;<volume>8</volume>(<issue>1</issue>):<fpage>e02257</fpage>–<lpage>16</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1128/mBio.02257-16</pub-id><?supplied-pmid 28174312?><pub-id pub-id-type="pmid">28174312</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010137.ref022">
      <label>22</label>
      <mixed-citation publication-type="journal"><name><surname>Loy</surname><given-names>DE</given-names></name>, <name><surname>Plenderleith</surname><given-names>LJ</given-names></name>, <name><surname>Sundararaman</surname><given-names>SA</given-names></name>, <name><surname>Liu</surname><given-names>W</given-names></name>, <name><surname>Gruszczyk</surname><given-names>J</given-names></name>, <name><surname>Chen</surname><given-names>YJ</given-names></name>, <etal>et al</etal>. <article-title>Evolutionary history of human <italic toggle="yes">Plasmodium vivax</italic> revealed by genome-wide analyses of related ape parasites</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>2018</year>;<volume>115</volume>(<issue>36</issue>):<fpage>8450</fpage>–<lpage>8459</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1073/pnas.1810053115</pub-id><?supplied-pmid 30127015?><pub-id pub-id-type="pmid">30127015</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010137.ref023">
      <label>23</label>
      <mixed-citation publication-type="journal"><name><surname>Small</surname><given-names>ST</given-names></name>, <name><surname>Labbé</surname><given-names>F</given-names></name>, <name><surname>Coulibaly</surname><given-names>YI</given-names></name>, <name><surname>Nutman</surname><given-names>TB</given-names></name>, <name><surname>King</surname><given-names>CL</given-names></name>, <name><surname>Serre</surname><given-names>D</given-names></name>, <etal>et al</etal>. <article-title>Human Migration and the Spread of the Nematode Parasite <italic toggle="yes">Wuchereria bancrofti</italic></article-title>. <source>Molecular Biology and Evolution</source>. <year>2013</year>;<volume>36</volume>(<issue>9</issue>):<fpage>1931</fpage>–<lpage>1941</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/molbev/msz116</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010137.ref024">
      <label>24</label>
      <mixed-citation publication-type="journal"><name><surname>Morgan</surname><given-names>AP</given-names></name>, <name><surname>Brazeau</surname><given-names>NF</given-names></name>, <name><surname>Ngasala</surname><given-names>B</given-names></name>, <name><surname>Mhamilawa</surname><given-names>LE</given-names></name>, <name><surname>Denton</surname><given-names>M</given-names></name>, <name><surname>Msellem</surname><given-names>M</given-names></name>, <etal>et al</etal>. <article-title>Falciparum malaria from coastal Tanzania and Zanzibar remains highly connected despite effective control efforts on the archipelago</article-title>. <source>Malaria Journal</source>. <year>2020</year>;<volume>19</volume>(<issue>1</issue>):<fpage>47</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1186/s12936-020-3137-8</pub-id><?supplied-pmid 31992305?><pub-id pub-id-type="pmid">31992305</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010137.ref025">
      <label>25</label>
      <mixed-citation publication-type="journal"><name><surname>Cocking</surname><given-names>JH</given-names></name>, <name><surname>Deberg</surname><given-names>M</given-names></name>, <name><surname>Schupp</surname><given-names>J</given-names></name>, <name><surname>Sahl</surname><given-names>J</given-names></name>, <name><surname>Wiggins</surname><given-names>K</given-names></name>, <name><surname>Porty</surname><given-names>A</given-names></name>, <etal>et al</etal>. <article-title>Selective whole genome amplification and sequencing of <italic toggle="yes">Coxiella burnetii</italic> directly from environmental samples</article-title>. <source>Genomics</source>. <year>2020</year>;<volume>112</volume>(<issue>2</issue>):<fpage>1872</fpage>–<lpage>1878</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.ygeno.2019.10.022</pub-id><?supplied-pmid 31678592?><pub-id pub-id-type="pmid">31678592</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010137.ref026">
      <label>26</label>
      <mixed-citation publication-type="journal"><name><surname>Itsko</surname><given-names>M</given-names></name>, <name><surname>Retchless</surname><given-names>AC</given-names></name>, <name><surname>Joseph</surname><given-names>SJ</given-names></name>, <name><surname>Turner</surname><given-names>AN</given-names></name>, <name><surname>Bazan</surname><given-names>JA</given-names></name>, <name><surname>Sadji</surname><given-names>AY</given-names></name>, <etal>et al</etal>. <article-title>Full molecular typing of <italic toggle="yes">Neisseria meningitidis</italic> directly from clinical specimens for outbreak investigation</article-title>. <source>Journal of Clinical Microbiology</source>. <year>2020</year>;<volume>58</volume>(<issue>12</issue>). <comment>doi: </comment><pub-id pub-id-type="doi">10.1128/JCM.01780-20</pub-id><?supplied-pmid 32938738?><pub-id pub-id-type="pmid">32938738</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010137.ref027">
      <label>27</label>
      <mixed-citation publication-type="journal"><name><surname>Osborne</surname><given-names>A</given-names></name>, <name><surname>Manko</surname><given-names>E</given-names></name>, <name><surname>Takeda</surname><given-names>M</given-names></name>, <name><surname>Kaneko</surname><given-names>A</given-names></name>, <name><surname>Kagaya</surname><given-names>W</given-names></name>, <name><surname>Chan</surname><given-names>C</given-names></name>, <etal>et al</etal>. <article-title>Characterizing the genomic variation and population dynamics of <italic toggle="yes">Plasmodium falciparum</italic> malaria parasites in and around Lake Victoria, Kenya</article-title>. <source>Scientific Reports</source>. <year>2021</year>;<volume>11</volume>(<issue>1</issue>):<fpage>19809</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/s41598-021-99192-1</pub-id><?supplied-pmid 34615917?><pub-id pub-id-type="pmid">34615917</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010137.ref028">
      <label>28</label>
      <mixed-citation publication-type="journal"><name><surname>Ibrahim</surname><given-names>A</given-names></name>, <name><surname>Benavente</surname><given-names>ED</given-names></name>, <name><surname>Nolder</surname><given-names>D</given-names></name>, <name><surname>Proux</surname><given-names>S</given-names></name>, <name><surname>Higgins</surname><given-names>M</given-names></name>, <name><surname>Muwanguzi</surname><given-names>J</given-names></name>, <etal>et al</etal>. <article-title>Selective whole genome amplification of <italic toggle="yes">Plasmodium malariae</italic> DNA from clinical samples reveals insights into population structure</article-title>. <source>Scientific Reports</source>. <year>2020</year>;<volume>10</volume>(<issue>1</issue>). <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/s41598-020-67568-4</pub-id><?supplied-pmid 32616738?><pub-id pub-id-type="pmid">32616738</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010137.ref029">
      <label>29</label>
      <mixed-citation publication-type="journal"><name><surname>Benavente</surname><given-names>ED</given-names></name>, <name><surname>Gomes</surname><given-names>AR</given-names></name>, <name><surname>Silva</surname><given-names>JRD</given-names></name>, <name><surname>Grigg</surname><given-names>M</given-names></name>, <name><surname>Walker</surname><given-names>H</given-names></name>, <name><surname>Barber</surname><given-names>BE</given-names></name>, <etal>et al</etal>. <article-title>Whole genome sequencing of amplified <italic toggle="yes">Plasmodium knowlesi</italic> DNA from unprocessed blood reveals genetic exchange events between Malaysian Peninsular and Borneo subpopulations</article-title>. <source>Scientific Reports</source>. <year>2019</year>;<volume>9</volume>(<issue>1</issue>):<fpage>9873</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/s41598-019-46398-z</pub-id><?supplied-pmid 31285495?><pub-id pub-id-type="pmid">31285495</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010137.ref030">
      <label>30</label>
      <mixed-citation publication-type="journal"><name><surname>Thurlow</surname><given-names>CM</given-names></name>, <name><surname>Joseph</surname><given-names>SJ</given-names></name>, <name><surname>Ganova-Raeva</surname><given-names>L</given-names></name>, <name><surname>Katz</surname><given-names>SS</given-names></name>, <name><surname>Pereira</surname><given-names>L</given-names></name>, <name><surname>Chen</surname><given-names>C</given-names></name>, <etal>et al</etal>. <article-title>Selective Whole-Genome Amplification as a Tool to Enrich Specimens with Low Treponema pallidum Genomic DNA Copies for Whole-Genome Sequencing</article-title>. <source>mSphere</source>. <year>2022</year>;<volume>7</volume>(<issue>3</issue>):<fpage>e0000922</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1128/msphere.00009-22</pub-id><?supplied-pmid 35491834?><pub-id pub-id-type="pmid">35491834</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010137.ref031">
      <label>31</label>
      <mixed-citation publication-type="journal"><name><surname>Marçais</surname><given-names>G</given-names></name>, <name><surname>Kingsford</surname><given-names>C</given-names></name>. <article-title>A fast, lock-free approach for efficient parallel counting of occurrences of k-mers</article-title>. <source>Bioinformatics</source>. <year>2011</year>;<volume>27</volume>(<issue>6</issue>):<fpage>764</fpage>–<lpage>770</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bioinformatics/btr011</pub-id><?supplied-pmid 21217122?><pub-id pub-id-type="pmid">21217122</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010137.ref032">
      <label>32</label>
      <mixed-citation publication-type="journal"><name><surname>Allawi</surname><given-names>HT</given-names></name>, <name><surname>SantaLucia</surname><given-names>J</given-names></name>. <article-title>Thermodynamics and NMR of internal G.T mismatches in DNA</article-title>. <source>Biochemistry</source>. <year>1997</year>;<volume>36</volume>(<issue>34</issue>):<fpage>10581</fpage>–<lpage>10594</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1021/bi962590c</pub-id><?supplied-pmid 9265640?><pub-id pub-id-type="pmid">9265640</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010137.ref033">
      <label>33</label>
      <mixed-citation publication-type="journal"><name><surname>Ali</surname><given-names>MM</given-names></name>, <name><surname>Li</surname><given-names>F</given-names></name>, <name><surname>Zhang</surname><given-names>Z</given-names></name>, <name><surname>Zhang</surname><given-names>K</given-names></name>, <name><surname>Kang</surname><given-names>DK</given-names></name>, <name><surname>Ankrum</surname><given-names>JA</given-names></name>, <etal>et al</etal>. <article-title>Rolling circle amplification: a versatile tool for chemical biology, materials science and medicine</article-title>. <source>Chemical Society Reviews</source>. <year>2014</year>;<volume>43</volume>(<issue>10</issue>):<fpage>3324</fpage>–<lpage>3341</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1039/c3cs60439j</pub-id><?supplied-pmid 24643375?><pub-id pub-id-type="pmid">24643375</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010137.ref034">
      <label>34</label>
      <mixed-citation publication-type="journal"><name><surname>Dieffenbach</surname><given-names>CW</given-names></name>, <name><surname>Lowe</surname><given-names>TM</given-names></name>, <name><surname>Dveksler</surname><given-names>GS</given-names></name>. <article-title>General concepts for PCR primer design</article-title>. <source>Genome Research</source>. <year>1993</year>;<volume>3</volume>(<issue>3</issue>):<fpage>S30</fpage>–<lpage>S37</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1101/gr.3.3.S30</pub-id><?supplied-pmid 8118394?><pub-id pub-id-type="pmid">8118394</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010137.ref035">
      <label>35</label>
      <mixed-citation publication-type="journal"><name><surname>SantaLucia</surname><given-names>J</given-names><suffix>Jr</suffix></name>, <name><surname>Hicks</surname><given-names>D</given-names></name>. <article-title>The Thermodynamics of DNA Structural Motifs</article-title>. <source>Annual Review of Biophysics and Biomolecular Structure</source>. <year>2004</year>;<volume>33</volume>(<issue>1</issue>):<fpage>415</fpage>–<lpage>440</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1146/annurev.biophys.32.110601.141800</pub-id><?supplied-pmid 15139820?><pub-id pub-id-type="pmid">15139820</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010137.ref036">
      <label>36</label>
      <mixed-citation publication-type="book"><name><surname>SantaLucia</surname><given-names>J</given-names><suffix>Jr</suffix></name>. <part-title>Physical Principles and Visual-OMP Software for Optimal PCR Design</part-title>. In: <name><surname>Yuryev</surname><given-names>A</given-names></name>, editor. <source>PCR Primer Design</source>. <publisher-loc>Totowa, NJ</publisher-loc>: <publisher-name>Humana Press</publisher-name>; <year>2007</year>. p. <fpage>3</fpage>–<lpage>33</lpage>.</mixed-citation>
    </ref>
    <ref id="pcbi.1010137.ref037">
      <label>37</label>
      <mixed-citation publication-type="journal"><name><surname>Teyssier</surname><given-names>NB</given-names></name>, <name><surname>Chen</surname><given-names>A</given-names></name>, <name><surname>Duarte</surname><given-names>EM</given-names></name>, <name><surname>Sit</surname><given-names>R</given-names></name>, <name><surname>Greenhouse</surname><given-names>B</given-names></name>, <name><surname>Tessema</surname><given-names>SK</given-names></name>. <article-title>Optimization of whole-genome sequencing of <italic toggle="yes">Plasmodium falciparum</italic> from low-density dried blood spot samples</article-title>. <source>Malaria journal</source>. <year>2021</year>;<volume>20</volume>:<fpage>116</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1186/s12936-021-03630-4</pub-id><?supplied-pmid 33637093?><pub-id pub-id-type="pmid">33637093</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010137.ref038">
      <label>38</label>
      <mixed-citation publication-type="journal"><name><surname>Kryazhimskiy</surname><given-names>S</given-names></name>, <name><surname>Rice</surname><given-names>DP</given-names></name>, <name><surname>Jerison</surname><given-names>ER</given-names></name>, <name><surname>Desai</surname><given-names>MM</given-names></name>. <article-title>Global epistasis makes adaptation predictable despite sequence-level stochasticity</article-title>. <source>Science</source>. <year>2014</year>;<volume>344</volume>(<issue>6191</issue>):<fpage>1519</fpage>–<lpage>1522</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1126/science.1250939</pub-id><?supplied-pmid 24970088?><pub-id pub-id-type="pmid">24970088</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010137.ref039">
      <label>39</label>
      <mixed-citation publication-type="journal"><name><surname>Li</surname><given-names>H</given-names></name>, <name><surname>Handsaker</surname><given-names>B</given-names></name>, <name><surname>Wysoker</surname><given-names>A</given-names></name>, <name><surname>Fennell</surname><given-names>T</given-names></name>, <name><surname>Ruan</surname><given-names>J</given-names></name>, <name><surname>Homer</surname><given-names>N</given-names></name>, <etal>et al</etal>. <article-title>The sequence alignment/map format and SAMtools</article-title>. <source>Bioinformatics</source>. <year>2009</year>;<volume>25</volume>(<issue>16</issue>):<fpage>2078</fpage>–<lpage>2079</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bioinformatics/btp352</pub-id><?supplied-pmid 19505943?><pub-id pub-id-type="pmid">19505943</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010137.ref040">
      <label>40</label>
      <mixed-citation publication-type="other">Blanco L, Bernad A, Salas M. Phi29 DNA Polymerase; 1993.</mixed-citation>
    </ref>
    <ref id="pcbi.1010137.ref041">
      <label>41</label>
      <mixed-citation publication-type="journal"><name><surname>Field</surname><given-names>TR</given-names></name>, <name><surname>Sibley</surname><given-names>CD</given-names></name>, <name><surname>Parkins</surname><given-names>MD</given-names></name>, <name><surname>Rabin</surname><given-names>HR</given-names></name>, <name><surname>Surette</surname><given-names>MG</given-names></name>. <article-title>The genus <italic toggle="yes">Prevotella</italic> in cystic fibrosis airways</article-title>. <source>Anaerobe</source>. <year>2010</year>;<volume>16</volume>(<issue>4</issue>):<fpage>337</fpage>–<lpage>344</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.anaerobe.2010.04.002</pub-id><?supplied-pmid 20412865?><pub-id pub-id-type="pmid">20412865</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010137.ref042">
      <label>42</label>
      <mixed-citation publication-type="journal"><name><surname>Rogers</surname><given-names>GB</given-names></name>, <name><surname>Carroll</surname><given-names>MP</given-names></name>, <name><surname>Serisier</surname><given-names>DJ</given-names></name>, <name><surname>Hockey</surname><given-names>PM</given-names></name>, <name><surname>Jones</surname><given-names>G</given-names></name>, <name><surname>Bruce</surname><given-names>KD</given-names></name>. <article-title>Characterization of bacterial community diversity in cystic fibrosis lung infections by use of 16S ribosomal DNA terminal restriction fragment length polymorphism profiling</article-title>. <source>Journal of Clinical Microbiology</source>. <year>2004</year>;<volume>42</volume>(<issue>11</issue>):<fpage>5176</fpage>–<lpage>5183</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1128/JCM.42.11.5176-5183.2004</pub-id><?supplied-pmid 15528712?><pub-id pub-id-type="pmid">15528712</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010137.ref043">
      <label>43</label>
      <mixed-citation publication-type="journal"><name><surname>Ibrahim</surname><given-names>M</given-names></name>, <name><surname>Subramanian</surname><given-names>A</given-names></name>, <name><surname>Anishetty</surname><given-names>S</given-names></name>. <article-title>Comparative pan genome analysis of oral <italic toggle="yes">Prevotella</italic> species implicated in periodontitis</article-title>. <source>Functional and Integrative Genomics</source>. <year>2017</year>;<volume>17</volume>(<issue>5</issue>). <comment>doi: </comment><pub-id pub-id-type="doi">10.1007/s10142-017-0550-3</pub-id><?supplied-pmid 28236274?><pub-id pub-id-type="pmid">28236274</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010137.ref044">
      <label>44</label>
      <mixed-citation publication-type="journal"><name><surname>Fleischmann</surname><given-names>RD</given-names></name>, <name><surname>Alland</surname><given-names>D</given-names></name>, <name><surname>Eisen</surname><given-names>JA</given-names></name>, <name><surname>Carpenter</surname><given-names>L</given-names></name>, <name><surname>White</surname><given-names>O</given-names></name>, <name><surname>Peterson</surname><given-names>J</given-names></name>, <etal>et al</etal>. <article-title>Whole-genome comparison of <italic toggle="yes">Mycobacterium tuberculosis</italic> clinical and laboratory strains</article-title>. <source>Journal of Bacteriology</source>. <year>2002</year>;<volume>184</volume>(<issue>19</issue>). <comment>doi: </comment><pub-id pub-id-type="doi">10.1128/JB.184.19.5479-5490.2002</pub-id><?supplied-pmid 12218036?><pub-id pub-id-type="pmid">12218036</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010137.ref045">
      <label>45</label>
      <mixed-citation publication-type="journal"><name><surname>Pilling</surname><given-names>OA</given-names></name>, <name><surname>Grace</surname><given-names>CA</given-names></name>, <name><surname>Reis-Cunha</surname><given-names>JL</given-names></name>, <name><surname>Berry</surname><given-names>AS</given-names></name>, <name><surname>Mitchell</surname><given-names>MW</given-names></name>, <name><surname>Yu</surname><given-names>JA</given-names></name>, <etal>et al</etal>. <article-title>Selective whole-genome amplification reveals population genetics of Leishmania braziliensis directly from patient skin biopsies</article-title>. <source>medRxiv</source>. <year>2022</year>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1101/2022.09.06.22279552</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010137.ref046">
      <label>46</label>
      <mixed-citation publication-type="journal"><name><surname>Rizk</surname><given-names>G</given-names></name>, <name><surname>Lavenier</surname><given-names>D</given-names></name>, <name><surname>Chikhi</surname><given-names>R</given-names></name>. <article-title>DSK: k-mer counting with very low memory usage</article-title>. <source>Bioinformatics</source>. <year>2013</year>;<volume>29</volume>(<issue>5</issue>):<fpage>652</fpage>–<lpage>653</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bioinformatics/btt020</pub-id><?supplied-pmid 23325618?><pub-id pub-id-type="pmid">23325618</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
<sub-article article-type="aggregated-review-documents" id="pcbi.1010137.r001" specific-use="decision-letter">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1010137.r001</article-id>
    <title-group>
      <article-title>Decision Letter 0</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Marz</surname>
          <given-names>Manja</given-names>
        </name>
        <role>Software Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2023 Manja Marz</copyright-statement>
      <copyright-year>2023</copyright-year>
      <copyright-holder>Manja Marz</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1010137" id="rel-obj001" related-article-type="reviewed-article"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>0</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">18 Jul 2022</named-content>
    </p>
    <p>Dear Dr. Brisson,</p>
    <p>Thank you very much for submitting your manuscript "A fast machine-learning-guided primer design pipeline for selective whole genome amplification" for consideration at PLOS Computational Biology.</p>
    <p>As with all papers reviewed by the journal, your manuscript was reviewed by members of the editorial board and by several independent reviewers. In light of the reviews (below this email), we would like to invite the resubmission of a significantly-revised version that takes into account the reviewers' comments.</p>
    <p>We cannot make any decision about publication until we have seen the revised manuscript and your response to the reviewers' comments. Your revised manuscript is also likely to be sent to reviewers for further evaluation.</p>
    <p>When you are ready to resubmit, please upload the following:</p>
    <p>[1] A letter containing a detailed list of your responses to the review comments and a description of the changes you have made in the manuscript. Please note while forming your response, if your article is accepted, you may have the opportunity to make the peer review history publicly available. The record will include editor decision letters (with reviews) and your responses to reviewer comments. If eligible, we will contact you to opt in or out.</p>
    <p>[2] Two versions of the revised manuscript: one with either highlights or tracked changes denoting where the text has been changed; the other a clean version (uploaded as the manuscript file).</p>
    <p>Important additional instructions are given below your reviewer comments.</p>
    <p>Please prepare and submit your revised manuscript within 60 days. If you anticipate any delay, please let us know the expected resubmission date by replying to this email. Please note that revised manuscripts received after the 60-day due date may require evaluation and peer review similar to newly submitted manuscripts.</p>
    <p>Thank you again for your submission. We hope that our editorial process has been constructive so far, and we welcome your feedback at any time. Please don't hesitate to contact us if you have any questions or comments.</p>
    <p>Sincerely,</p>
    <p>Manja Marz</p>
    <p>Software Editor</p>
    <p>PLOS Computational Biology</p>
    <p>Manja Marz</p>
    <p>Software Editor</p>
    <p>PLOS Computational Biology</p>
    <p>***********************</p>
    <p>Reviewer's Responses to Questions</p>
    <p>
      <bold>Comments to the Authors:</bold>
    </p>
    <p>
      <bold>Please note here if the review is uploaded as an attachment.</bold>
    </p>
    <p>Reviewer #1: In this manuscript the authors introduce version 2 of the SWGA pipeline which optimizes primer design for selective whole genome amplification. This is a very valuable tool for enriching target DNA for sequencing in cases where samples would typically be dominated by background or host DNA. In the new version, the authors have added several speed ups to the original algorithm and used a machine learning approach to identify efficient primers features. The new additions to the pipeline are substantial and warrant a second paper to introduce these enhancements. The authors demonstrate the performance of swga2.0 by designing and testing 6 primer sets for amplifying Prevotella melaninogenica within a human background. The manuscript is well organized and clearly written in a way that is understandable to a non-computational audience and the best practices section at the end is very helpful.</p>
    <p>The authors provide publicly available, version-controlled, and well documented code with appropriate documentation on installation and workflow. A local copy of the codebase can easily be installed using pip however it would be assessable to a wider audience if it could be installed using Conda (or similar) with all dependencies. The name of the software is different than what is reported in the paper which may be confusing. There does not appear to be any unit tests.</p>
    <p>The sequencing and raw data was not provided with the manuscript and would be required to reproduce the results. The primer sequences were also not provided as far as I can tell.</p>
    <p>There are not many other tools to directly compare to, so the authors mostly refer to previous results of swga1.0 but they did not do a direct comparison. Because the focus of this paper is on improvements from version 1.0, it would be helpful if the authors provide a summary table that compares the features between the old and new versions. To drive home the benefit of the newly added primer efficacy filter, it would be good to build sets using swga1.0 and evaluate how often the “best” sets contain primers that are predicted to be low efficiency and at what proportion. This would lend support the claims in the paper and would be fairly quick to run without requiring any additional sequencing.</p>
    <p>Furthermore, given that the multiprocessing speedups are another focus of the paper, I recommend that a more rigorous comparison is performed between the two versions. A time was provided for a single run of v2.0 and the time for v1.0 was given as over two weeks. The number of processors and the memory requirements were not provided. It would be good to know how many processors were used and if there are diminishing returns. Was swga1.0 able to find a result after running for 2 weeks or did it get stuck? I believe that I have been able to design SWGA primers in less than two weeks using swga1.0, so it is unclear why it took so long. Perhaps it would be good to try a less complicated design to compare the efficiency between the two versions so that we can better evaluate the improvement of each of the speedups. It would be great to see a breakdown of the estimated time saved due to each of the improvements listed in the section titled: “Computational costs are reduced from weeks to minutes”</p>
    <p>About half of the primer sets failed using swga2.0. There was some mention in the discussion about a relationship between the successful sets and lower mean binding distance in the target genome, but it would be nice to have a table of all the observed stats for the sets in addition to the parameter settings.</p>
    <p>The discussion mentions that this approach would work on metagenomic samples (last paragraph). Has this been done and how would swga2.0 be able to design primer sets for such complex backgrounds? How many background genomes could reasonably be added? How would you handle all the potential plasmids in such a sample?</p>
    <p>The last paragraph of the discussion abruptly introduces a number of new ideas that are difficult to follow. These should be expanded on to provide clarity if they are important or eliminated.</p>
    <p>The EquiPhi29 enzyme is more thermally stable and produces higher yield than Phi29. Using this enzyme may allow longer primers with higher Tm. Could the authors provide some discussion about whether swga2.0 can design appropriate primer sets for use with this enzyme and some recommended parameter adjustments.</p>
    <p>Mispriming in the rolling circle plasmid amplification experiment was mentioned but there were no results, and it was unclear if that was incorporated into the model.</p>
    <p>It would be good to have the number of reads that aligned to the background genome.</p>
    <p>The methods do not describe exactly how the target amplification efficiency was calculated.</p>
    <p>Minor</p>
    <p>Line 10 Abstract: Change “Evaluate” to “evaluates”</p>
    <p>Page 3 line 5 and 6: Change “ie” to “i.e.,”</p>
    <p>Page 3 second paragraph: change “as well as identifying” to “and identified”</p>
    <p>Page 3, 4th line of last paragraph in introduction beginning with “First, active learning” this sentence should be reworded. Something like “First, active machine learning was used to identify features that predict primer and primer set efficiency”</p>
    <p>Figure 3 caption, last line: change “axis” to “x-axis”</p>
    <p>Page 8 Section “Empirical evaluation of primer sets”: Can you clarify that the FspE1 digestion was to suppress mitochondrial amplification and note whether or not swga2.0 has the option to omit mitochondrial sequences?</p>
    <p>Page 9 first line: Missing reference and version for samtools.</p>
    <p>Page 9, second paragraph, last line: Change “data from the rounds” to “data from rounds”</p>
    <p>The text references Figure 3A but there is only a single for Figure 3.</p>
    <p>The variables described in Stage 4 of the methods are not described until much later in the paper. I would move them up to where they are first mentioned.</p>
    <p>Page 13, line 8: Change “eliminate” to “eliminating”</p>
    <p>Page 14: Sentence “Highthroughput sequencing of the amplification products from the three effective P. melaninogenica primer sets reached 1× coverage across 25–64% the target genome with 50Mbp sequencing effort while only 27% of the M. tuberculosis was covered at 1× at similar sequencing effort after amplification with the most effective primer set (Figure 5)” is confusing. Figure 5 does not contain data about M. tuberculosis so I would move the figure reference closer to the actual result and clarify again that you are referring to M. tuberculosis results from the previous version of swga.</p>
    <p>Pg 17 line 9: Change “utilizing using” with “using”</p>
    <p>Reviewer #2: Yu et al. describe swga2.0, a pipeline that improves upon the original swga program described by Clarke et al. to identify, screen, and choose primers for use in selective whole-genome amplification. The authors apply swga2.0 to identify candidate sWGA primer sets for enrichment of P. melaninogenica and then test the best performing primer sets experimentally.</p>
    <p>The manuscript is well-written and easy to follow. Major advances of the new pipeline are greatly reduced computational time (the prior version required weeks on a high-powered computing cluster, the current version purports to requires hours on a personal laptop) and use of machine-learning methods to select primers that are likely to perform well. The model used to predict amplification efficiency (or more accurately, probability of poor amplification) could be very useful for a variety of applications, though experimental data for enzymes other than phi29 would be required. Several companies offer services for highly multiplexed primer design but do not make their code publicly available. The approaches described here could be useful not only for sWGA primer design but for other applications as well, including design of highly multiplexed amplicon panels. The manuscript could be improved in several ways as outlined below – namely application to more than one pathogen and explicit comparison of swga2.0 to the original swga program.</p>
    <p>MAJOR</p>
    <p>1. Table 2: It is important to emphasize clearly that these features are specific for phi29. Some groups have begun using Equiphi29 to achieve higher reaction temperatures (enabling longer/more specific primers). Others may want to adapt these methods for other enzymes such as Bst. If the features employed by the program are phi29-specific, then the model will probably not perform well for these applications.</p>
    <p>2. Page 4: It would be useful to delineate more clearly how swga2.0 differs from the original swga program published by Clarke et al., both in terms of the approach and empirical differences in output. As for approach, in the figure on page 4, there appear to be new steps in boxes 1 (jellyfish), 2 (homodimerization probability, runs of repeats), and most importantly in boxes 3 (random forest model) and 4 (coverage ratio). Some of these differences are covered on page 17 in the Discussion, but a table highlighting differences/improvements would be helpful. As for empirical differences in output, the authors include some discussion of differences on page 18 but are not comparing apples-to-apples. Differences between P. melaninogenica swga2.0 output and M. tuberculosis swga output are interesting, but direct comparison of swga vs swga2.0 for the same organism is needed to delineate their differences clearly. Did the authors run the original sWGA program on P. melaninogenica? If so, how did the output compare? If not, can they run it using similar parameters and comment on differences?</p>
    <p>3. How did variant calls in the P. melaninogenica sequencing data compare to reference and to the non-sWGA sample? Phi29 is reported to have a very low error rate, but it is important to confirm with their own data if possible. Another issue of relevance in some cases is the ability to investigate within-host diversity after sWGA – specifically whether allele frequencies can still be estimated with confidence after sWGA enrichment (ex: Oyola et al. PMID 27998271). Though it is probably out of the scope of this manuscript to test experimentally, commenting on these effects in the discussion is probably worthwhile.</p>
    <p>4. Confidence in the program’s ability to produce effective sWGA primer sets would be increased if more than one pathogen were tested experimentally. In the original swga publication, Clarke et al. reported differences in sWGA performance across several different organisms. I wonder if the new swga2.0 algorithm might overcome some of these differences, or if they will persist?</p>
    <p>MINOR</p>
    <p>Page 2: sWGA has now been used successfully for Treponema pallidum subs pallidum (causative agent of syphilis) – see Thurlow CM et al. mSphere 2022, PMID 35491834.</p>
    <p>Page 3: Unclear why ‘SWG amplification’ is used instead of ‘sWGA’.</p>
    <p>Page 5: Please define each of the ratios included in the score equation listed at the bottom of the page.</p>
    <p>Pages 6-7 and Table 2: The included explicit discussion of thermodynamically-principled included in the model is helpful.</p>
    <p>Page 8: Why was the sample digested? I assume this is to linearize circular bacterial DNA. Has this been shown to improve the efficiency of MDA/phi29 reactions? In this paper, DNA was digested with FspEI while the previous study using NarI (Clarke et al., 2017). Methylation digestion with different enzymes and experimental process can vary the swga results, such as the proportion of reads mapping to the target organism and genome coverage (see Teyssier NB et al. PMID 33637093).</p>
    <p>Page 8: For clarity, please specify exactly what 3.5mM total of sWGA primers means so that there is no ambiguity. Ex: “…(e.g. in a set of 10 primers, each primer was added at 0.35mM so that the total molarity of primers was 3.5mM)” if that is the case, or other wording depending on the actual conditions. There has been variability in published sWGA methods on this topic, due in part to ambiguity in the description of the exact conditions used during sWGA in some past publications.</p>
    <p>Page 18: The general suggestions provided are very helpful for scientists looking to use this methodology to design and test their own custom sets.</p>
    <p>Page 19: Mention of CRISPR and gRNA design in the concluding sentence doesn’t follow from the manuscript and was surprising. Consider removing, or moving up into the discussion.</p>
    <p>Methods: In swga2.0, is it possible to visualize/export exact locations of primer binding sites?</p>
    <p>Methods: Is it possible to set the number of mismatched bases permitted in the primers themselves? Can the allowable length of mononucleotide repeats be modified?</p>
    <p>**********</p>
    <p>
      <bold>Have the authors made all data and (if applicable) computational code underlying the findings in their manuscript fully available?</bold>
    </p>
    <p>The <ext-link xlink:href="https://journals.plos.org/ploscompbiol/s/materials-and-software-sharing" ext-link-type="uri">PLOS Data policy</ext-link> requires authors to make all data and code underlying the findings described in their manuscript fully available without restriction, with rare exception (please refer to the Data Availability Statement in the manuscript PDF file). The data and code should be provided as part of the manuscript or its supporting information, or deposited to a public repository. For example, in addition to summary statistics, the data points behind means, medians and variance measures should be available. If there are restrictions on publicly sharing data or code —e.g. participant privacy or use of data from a third party—those must be specified.</p>
    <p>Reviewer #1: <bold>No: </bold>The code is available and well documented but I do not see the sequencing reads, the raw data, or the primer sequences.</p>
    <p>Reviewer #2: Yes</p>
    <p>**********</p>
    <p>PLOS authors have the option to publish the peer review history of their article (<ext-link xlink:href="https://journals.plos.org/ploscompbiol/s/editorial-and-peer-review-process#loc-peer-review-history" ext-link-type="uri">what does this mean?</ext-link>). If published, this will include your full peer review and any attached files.</p>
    <p>If you choose “no”, your identity will remain anonymous but your review may still be made public.</p>
    <p><bold>Do you want your identity to be public for this peer review?</bold> For information about this choice, including consent withdrawal, please see our <ext-link xlink:href="https://www.plos.org/privacy-policy" ext-link-type="uri">Privacy Policy</ext-link>.</p>
    <p>Reviewer #1: No</p>
    <p>Reviewer #2: <bold>Yes: </bold>Jonathan B. Parr</p>
    <p>
      <underline>Figure Files:</underline>
    </p>
    <p>While revising your submission, please upload your figure files to the Preflight Analysis and Conversion Engine (PACE) digital diagnostic tool, <underline><ext-link xlink:href="https://pacev2.apexcovantage.com/" ext-link-type="uri">https://pacev2.apexcovantage.com</ext-link></underline>. PACE helps ensure that figures meet PLOS requirements. To use PACE, you must first register as a user. Then, login and navigate to the UPLOAD tab, where you will find detailed instructions on how to use the tool. If you encounter any issues or have any questions when using PACE, please email us at <underline><email>figures@plos.org</email></underline>.</p>
    <p>
      <underline>Data Requirements:</underline>
    </p>
    <p>Please note that, as a condition of publication, PLOS' data policy requires that you make available all data used to draw the conclusions outlined in your manuscript. Data must be deposited in an appropriate repository, included within the body of the manuscript, or uploaded as supporting information. This includes all numerical values that were used to generate graphs, histograms etc.. For an example in PLOS Biology see here: <ext-link xlink:href="http://www.plosbiology.org/article/info%3Adoi%2F10.1371%2Fjournal.pbio.1001908#s5" ext-link-type="uri">http://www.plosbiology.org/article/info%3Adoi%2F10.1371%2Fjournal.pbio.1001908#s5</ext-link>.</p>
    <p>
      <underline>Reproducibility:</underline>
    </p>
    <p>To enhance the reproducibility of your results, we recommend that you deposit your laboratory protocols in protocols.io, where a protocol can be assigned its own identifier (DOI) such that it can be cited independently in the future. Additionally, PLOS ONE offers an option to publish peer-reviewed clinical study protocols. Read more information on sharing protocols at <ext-link xlink:href="https://plos.org/protocols?utm_medium=editorial-email&amp;utm_source=authorletters&amp;utm_campaign=protocols" ext-link-type="uri">https://plos.org/protocols?utm_medium=editorial-email&amp;utm_source=authorletters&amp;utm_campaign=protocols</ext-link></p>
  </body>
</sub-article>
<sub-article article-type="author-comment" id="pcbi.1010137.r002">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1010137.r002</article-id>
    <title-group>
      <article-title>Author response to Decision Letter 0</article-title>
    </title-group>
    <related-article ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1010137" id="rel-obj002" related-article-type="editor-report"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>1</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="author-response-date">13 Sep 2022</named-content>
    </p>
    <supplementary-material id="pcbi.1010137.s006" position="float" content-type="local-data">
      <label>Attachment</label>
      <caption>
        <p>Submitted filename: <named-content content-type="submitted-filename">ReviewerComments.pdf</named-content></p>
      </caption>
      <media xlink:href="pcbi.1010137.s006.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </body>
</sub-article>
<sub-article article-type="aggregated-review-documents" id="pcbi.1010137.r003" specific-use="decision-letter">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1010137.r003</article-id>
    <title-group>
      <article-title>Decision Letter 1</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Marz</surname>
          <given-names>Manja</given-names>
        </name>
        <role>Software Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2023 Manja Marz</copyright-statement>
      <copyright-year>2023</copyright-year>
      <copyright-holder>Manja Marz</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1010137" id="rel-obj003" related-article-type="reviewed-article"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>1</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">9 Feb 2023</named-content>
    </p>
    <p>Dear Dr. Brisson,</p>
    <p>Thank you very much for submitting your manuscript "A fast machine-learning-guided primer design pipeline for selective whole genome amplification" for consideration at PLOS Computational Biology. As with all papers reviewed by the journal, your manuscript was reviewed by members of the editorial board and by several independent reviewers. The reviewers appreciated the attention to an important topic. Based on the reviews, we are likely to accept this manuscript for publication, providing that you modify the manuscript according to the review recommendations.</p>
    <p>Please prepare and submit your revised manuscript within 30 days. If you anticipate any delay, please let us know the expected resubmission date by replying to this email.</p>
    <p>When you are ready to resubmit, please upload the following:</p>
    <p>[1] A letter containing a detailed list of your responses to all review comments, and a description of the changes you have made in the manuscript. Please note while forming your response, if your article is accepted, you may have the opportunity to make the peer review history publicly available. The record will include editor decision letters (with reviews) and your responses to reviewer comments. If eligible, we will contact you to opt in or out</p>
    <p>[2] Two versions of the revised manuscript: one with either highlights or tracked changes denoting where the text has been changed; the other a clean version (uploaded as the manuscript file).</p>
    <p>Important additional instructions are given below your reviewer comments.</p>
    <p>Thank you again for your submission to our journal. We hope that our editorial process has been constructive so far, and we welcome your feedback at any time. Please don't hesitate to contact us if you have any questions or comments.</p>
    <p>Sincerely,</p>
    <p>Manja Marz</p>
    <p>Software Editor</p>
    <p>PLOS Computational Biology</p>
    <p>Manja Marz</p>
    <p>Software Editor</p>
    <p>PLOS Computational Biology</p>
    <p>***********************</p>
    <p>A link appears below if there are any accompanying review attachments. If you believe any reviews to be missing, please contact <email>ploscompbiol@plos.org</email> immediately:</p>
    <p>Reviewer's Responses to Questions</p>
    <p>
      <bold>Comments to the Authors:</bold>
    </p>
    <p>
      <bold>Please note here if the review is uploaded as an attachment.</bold>
    </p>
    <p>Reviewer #1: This resubmission is much improved, and the authors have addressed my major concerns. I have a few minor comments.</p>
    <p>The authors added Table 1 which helpfully summarizes the improvements in swga2.0 compared to swga1.0 and breaks down the performance improvements for all stages. However, the benchmarking details could be a bit more explicit in a computational biology article. For example, I had to go to the Github page to find swga2.0’s default setting for number of CPUs (which I assume is what was used). After finding out that it defaults to “all” I then needed to look up what that might be on the specific model of MacBook Pro that was used (4 maybe)? I think that this is important information to have in the article to evaluate the 10-fold improvement in speed. Another minor point on Table 1, the first column could include a short name/description of each of the stages in addition to just the stage number so that the reader does not have to refer to the text to understand the table.</p>
    <p>My previous comment about the method for calculating amplification efficiency was referring to the empirical values, not the predictions using the model. Some detail about the method used to measured primer amplification of the plasmids would be helpful, even if it is only included in the caption for Supplemental Table 1.</p>
    <p>All other issues that I have raised have been addressed by the authors.</p>
    <p>Reviewer #2: I appreciate the authors’ responses to my comments and the associated manuscript changes. One minor comment as below:</p>
    <p>Discussion: The authors include the following statement: “Also similar to prior results (Oyola et al., 2016), protocols developed with swga2.0 retain the ability to investigate within-host microbial diversity using SWGA enrichment (Pilling et al., 2022), without introducing errors, as the SWGA biochemistry remains identical (Table S4).”</p>
    <p>We have found that reliable estimation of allele frequencies after sWGA is not straightforward, due in part to exceptionally high depth of coverage in some regions (“jackpotting”) but not others. If the authors do not have empirical data to support the statement above, I would suggest softening the language to indicate that this is their expectation but not an observation (i.e. replace “retain” and with “are expected” or similar).</p>
    <p>**********</p>
    <p>
      <bold>Have the authors made all data and (if applicable) computational code underlying the findings in their manuscript fully available?</bold>
    </p>
    <p>The <ext-link xlink:href="https://journals.plos.org/ploscompbiol/s/materials-and-software-sharing" ext-link-type="uri">PLOS Data policy</ext-link> requires authors to make all data and code underlying the findings described in their manuscript fully available without restriction, with rare exception (please refer to the Data Availability Statement in the manuscript PDF file). The data and code should be provided as part of the manuscript or its supporting information, or deposited to a public repository. For example, in addition to summary statistics, the data points behind means, medians and variance measures should be available. If there are restrictions on publicly sharing data or code —e.g. participant privacy or use of data from a third party—those must be specified.</p>
    <p>Reviewer #1: Yes</p>
    <p>Reviewer #2: Yes</p>
    <p>**********</p>
    <p>PLOS authors have the option to publish the peer review history of their article (<ext-link xlink:href="https://journals.plos.org/ploscompbiol/s/editorial-and-peer-review-process#loc-peer-review-history" ext-link-type="uri">what does this mean?</ext-link>). If published, this will include your full peer review and any attached files.</p>
    <p>If you choose “no”, your identity will remain anonymous but your review may still be made public.</p>
    <p><bold>Do you want your identity to be public for this peer review?</bold> For information about this choice, including consent withdrawal, please see our <ext-link xlink:href="https://www.plos.org/privacy-policy" ext-link-type="uri">Privacy Policy</ext-link>.</p>
    <p>Reviewer #1: No</p>
    <p>Reviewer #2: <bold>Yes: </bold>Jonathan Parr</p>
    <p>Figure Files:</p>
    <p>While revising your submission, please upload your figure files to the Preflight Analysis and Conversion Engine (PACE) digital diagnostic tool, <ext-link xlink:href="https://pacev2.apexcovantage.com" ext-link-type="uri">https://pacev2.apexcovantage.com</ext-link>. PACE helps ensure that figures meet PLOS requirements. To use PACE, you must first register as a user. Then, login and navigate to the UPLOAD tab, where you will find detailed instructions on how to use the tool. If you encounter any issues or have any questions when using PACE, please email us at <email>figures@plos.org</email>.</p>
    <p>Data Requirements:</p>
    <p>Please note that, as a condition of publication, PLOS' data policy requires that you make available all data used to draw the conclusions outlined in your manuscript. Data must be deposited in an appropriate repository, included within the body of the manuscript, or uploaded as supporting information. This includes all numerical values that were used to generate graphs, histograms etc.. For an example in PLOS Biology see here: <ext-link xlink:href="http://www.plosbiology.org/article/info%3Adoi%2F10.1371%2Fjournal.pbio.1001908#s5" ext-link-type="uri">http://www.plosbiology.org/article/info%3Adoi%2F10.1371%2Fjournal.pbio.1001908#s5</ext-link>.</p>
    <p>Reproducibility:</p>
    <p>To enhance the reproducibility of your results, we recommend that you deposit your laboratory protocols in protocols.io, where a protocol can be assigned its own identifier (DOI) such that it can be cited independently in the future. Additionally, PLOS ONE offers an option to publish peer-reviewed clinical study protocols. Read more information on sharing protocols at <ext-link xlink:href="https://plos.org/protocols?utm_medium=editorial-email&amp;utm_source=authorletters&amp;utm_campaign=protocols" ext-link-type="uri">https://plos.org/protocols?utm_medium=editorial-email&amp;utm_source=authorletters&amp;utm_campaign=protocols</ext-link></p>
    <p>References:</p>
    <p>Review your reference list to ensure that it is complete and correct. If you have cited papers that have been retracted, please include the rationale for doing so in the manuscript text, or remove these references and replace them with relevant current references. Any changes to the reference list should be mentioned in the rebuttal letter that accompanies your revised manuscript.</p>
    <p>
      <italic toggle="yes">If you need to cite a retracted article, indicate the article’s retracted status in the References list and also include a citation and full reference for the retraction notice.</italic>
    </p>
  </body>
</sub-article>
<sub-article article-type="author-comment" id="pcbi.1010137.r004">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1010137.r004</article-id>
    <title-group>
      <article-title>Author response to Decision Letter 1</article-title>
    </title-group>
    <related-article ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1010137" id="rel-obj004" related-article-type="editor-report"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>2</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="author-response-date">16 Feb 2023</named-content>
    </p>
    <supplementary-material id="pcbi.1010137.s007" position="float" content-type="local-data">
      <label>Attachment</label>
      <caption>
        <p>Submitted filename: <named-content content-type="submitted-filename">Response_To_Reviewers.pdf</named-content></p>
      </caption>
      <media xlink:href="pcbi.1010137.s007.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </body>
</sub-article>
<sub-article article-type="editor-report" id="pcbi.1010137.r005" specific-use="decision-letter">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1010137.r005</article-id>
    <title-group>
      <article-title>Decision Letter 2</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Marz</surname>
          <given-names>Manja</given-names>
        </name>
        <role>Software Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2023 Manja Marz</copyright-statement>
      <copyright-year>2023</copyright-year>
      <copyright-holder>Manja Marz</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1010137" id="rel-obj005" related-article-type="reviewed-article"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>2</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">23 Mar 2023</named-content>
    </p>
    <p>Dear Dr. Brisson,</p>
    <p>We are pleased to inform you that your manuscript 'A fast machine-learning-guided primer design pipeline for selective whole genome amplification' has been provisionally accepted for publication in PLOS Computational Biology.</p>
    <p>Before your manuscript can be formally accepted you will need to complete some formatting changes, which you will receive in a follow up email. A member of our team will be in touch with a set of requests.</p>
    <p>Please note that your manuscript will not be scheduled for publication until you have made the required changes, so a swift response is appreciated.</p>
    <p>IMPORTANT: The editorial review process is now complete. PLOS will only permit corrections to spelling, formatting or significant scientific errors from this point onwards. Requests for major changes, or any which affect the scientific understanding of your work, will cause delays to the publication date of your manuscript.</p>
    <p>Should you, your institution's press office or the journal office choose to press release your paper, you will automatically be opted out of early publication. We ask that you notify us now if you or your institution is planning to press release the article. All press must be co-ordinated with PLOS.</p>
    <p>Thank you again for supporting Open Access publishing; we are looking forward to publishing your work in PLOS Computational Biology. </p>
    <p>Best regards,</p>
    <p>Manja Marz</p>
    <p>Software Editor</p>
    <p>PLOS Computational Biology</p>
    <p>Manja Marz</p>
    <p>Software Editor</p>
    <p>PLOS Computational Biology</p>
    <p>***********************************************************</p>
  </body>
</sub-article>
<sub-article article-type="editor-report" id="pcbi.1010137.r006" specific-use="acceptance-letter">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1010137.r006</article-id>
    <title-group>
      <article-title>Acceptance letter</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Marz</surname>
          <given-names>Manja</given-names>
        </name>
        <role>Software Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2023 Manja Marz</copyright-statement>
      <copyright-year>2023</copyright-year>
      <copyright-holder>Manja Marz</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1010137" id="rel-obj006" related-article-type="reviewed-article"/>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">3 Apr 2023</named-content>
    </p>
    <p>PCOMPBIOL-D-22-00648R2 </p>
    <p>A fast machine-learning-guided primer design pipeline for selective whole genome amplification</p>
    <p>Dear Dr Brisson,</p>
    <p>I am pleased to inform you that your manuscript has been formally accepted for publication in PLOS Computational Biology. Your manuscript is now with our production department and you will be notified of the publication date in due course.</p>
    <p>The corresponding author will soon be receiving a typeset proof for review, to ensure errors have not been introduced during production. Please review the PDF proof of your manuscript carefully, as this is the last chance to correct any errors. Please note that major changes, or those which affect the scientific understanding of the work, will likely cause delays to the publication date of your manuscript. </p>
    <p>Soon after your final files are uploaded, unless you have opted out, the early version of your manuscript will be published online. The date of the early version will be your article's publication date. The final article will be published to the same URL, and all versions of the paper will be accessible to readers.</p>
    <p>Thank you again for supporting PLOS Computational Biology and open-access publishing. We are looking forward to publishing your work! </p>
    <p>With kind regards,</p>
    <p>Timea Kemeri-Szekernyes</p>
    <p>PLOS Computational Biology | Carlyle House, Carlyle Road, Cambridge CB4 3DN | United Kingdom <email>ploscompbiol@plos.org</email> | Phone +44 (0) 1223-442824 | <ext-link xlink:href="http://ploscompbiol.org" ext-link-type="uri">ploscompbiol.org</ext-link> | @PLOSCompBiol</p>
  </body>
</sub-article>
