<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">9942549</article-id>
    <article-id pub-id-type="pmid">36786403</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btad088</article-id>
    <article-id pub-id-type="publisher-id">btad088</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Note</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Systems Biology</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>DBDIpy: a Python library for processing of untargeted datasets from real-time plasma ionization mass spectrometry</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-6801-3647</contrib-id>
        <name>
          <surname>Weidner</surname>
          <given-names>Leopold</given-names>
        </name>
        <aff><institution>Comprehensive Foodomics Platform, TUM School of Life Sciences, Technical University of Munich</institution>, Freising 85354, <country country="DE">Germany</country></aff>
        <aff><institution>Analytical BioGeoChemistry, Helmholtz Zentrum Muenchen</institution>, Neuherberg 85764, <country country="DE">Germany</country></aff>
        <xref rid="btad088-cor1" ref-type="corresp"/>
        <!--leopold.weidner@tum.de-->
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Hemmler</surname>
          <given-names>Daniel</given-names>
        </name>
        <aff><institution>Comprehensive Foodomics Platform, TUM School of Life Sciences, Technical University of Munich</institution>, Freising 85354, <country country="DE">Germany</country></aff>
        <aff><institution>Analytical BioGeoChemistry, Helmholtz Zentrum Muenchen</institution>, Neuherberg 85764, <country country="DE">Germany</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-5826-6288</contrib-id>
        <name>
          <surname>Rychlik</surname>
          <given-names>Michael</given-names>
        </name>
        <aff><institution>Comprehensive Foodomics Platform, TUM School of Life Sciences, Technical University of Munich</institution>, Freising 85354, <country country="DE">Germany</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Schmitt-Kopplin</surname>
          <given-names>Philippe</given-names>
        </name>
        <aff><institution>Comprehensive Foodomics Platform, TUM School of Life Sciences, Technical University of Munich</institution>, Freising 85354, <country country="DE">Germany</country></aff>
        <aff><institution>Analytical BioGeoChemistry, Helmholtz Zentrum Muenchen</institution>, Neuherberg 85764, <country country="DE">Germany</country></aff>
        <xref rid="btad088-cor1" ref-type="corresp"/>
        <!--schmitt-kopplin@tum.de-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Kelso</surname>
          <given-names>Janet</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btad088-cor1">To whom correspondence should be addressed. <email>leopold.weidner@tum.de</email> or <email>schmitt-kopplin@tum.de</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>2</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2023-02-14">
      <day>14</day>
      <month>2</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>14</day>
      <month>2</month>
      <year>2023</year>
    </pub-date>
    <volume>39</volume>
    <issue>2</issue>
    <elocation-id>btad088</elocation-id>
    <history>
      <date date-type="received">
        <day>28</day>
        <month>11</month>
        <year>2022</year>
      </date>
      <date date-type="rev-recd">
        <day>27</day>
        <month>1</month>
        <year>2023</year>
      </date>
      <date date-type="editorial-decision">
        <day>09</day>
        <month>2</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>10</day>
        <month>2</month>
        <year>2023</year>
      </date>
      <date date-type="corrected-typeset">
        <day>21</day>
        <month>2</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2023</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btad088.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>Plasma ionization is rapidly gaining popularity for mass spectrometry (MS)-based studies of volatiles and aerosols. However, data from plasma ionization are delicate to interpret as competing ionization pathways in the plasma create numerous ion species. There is no tool for detection of adducts and in-source fragments from plasma ionization data yet, which makes data evaluation ambiguous.</p>
      </sec>
      <sec id="s2">
        <title>Summary</title>
        <p>We developed DBDIpy, a Python library for processing and formal analysis of untargeted, time-sensitive plasma ionization MS datasets. Its core functionality lies in the identification of in-source fragments and identification of rivaling ionization pathways of the same analytes in time-sensitive datasets. It further contains elementary functions for processing of untargeted metabolomics data and interfaces to an established ecosystem for analysis of MS data in Python.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>DBDIpy is implemented in Python (Version ≥ 3.7) and can be downloaded from PyPI the Python package repository (<ext-link xlink:href="https://pypi.org/project/DBDIpy" ext-link-type="uri">https://pypi.org/project/DBDIpy</ext-link>) or from GitHub (<ext-link xlink:href="https://github.com/leopold-weidner/DBDIpy" ext-link-type="uri">https://github.com/leopold-weidner/DBDIpy</ext-link>).</p>
      </sec>
      <sec id="s5">
        <title>Supplementary information</title>
        <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Bavarian Ministry of Economic Affairs</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="2"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Application of plasma-based ion sources for real-time mass spectrometry (MS) shows exponential growth over the last years. This is because plasma ionization comes with relatively low instrumental cost, is simple to operate, very sensitive to a wide range of volatile analytes and is used in various fields like food processing-, environmental- or clinical breath research (<xref rid="btad088-B2" ref-type="bibr">Ayala-Cabrera <italic toggle="yes">et al.</italic>, 2022</xref>). Naturally, vendors of ion sources thrive to construct robust setups which reduce artifacts and maximize the generation of [M + H]<sup>+</sup> pseudo-molecular ions in comparison to competing, undesirable adduct ions. However, the chemical composition of plasma is non-trivial (<xref rid="btad088-B1" ref-type="bibr">Adamovich <italic toggle="yes">et al.</italic>, 2017</xref>), highly dependent of surrounding atmospheric gases and the design of the ion source. These factors account for miscellaneous ionization and fragmentation pathways in plasma ion sources (<xref rid="btad088-B3" ref-type="bibr">Gyr <italic toggle="yes">et al.</italic>, 2019</xref>; <xref rid="btad088-B8" ref-type="bibr">Wolf <italic toggle="yes">et al.</italic>, 2016</xref>). Exemplarily, saturated analytes are prone to in-source oxygenation reactions or hydride abstractions. Some alternating ionization pathways still are even not understood up to date (<xref rid="btad088-B2" ref-type="bibr">Ayala-Cabrera <italic toggle="yes">et al.</italic>, 2022</xref>). Consecutively, the user is tempted to mistake multiple ion species of the same analytes as unrelated compounds, leading to ambiguous conclusions during the evaluation of untargeted datasets. In related analytical disciplines, the community developed tools to simplify complex data structures. Exemplarily, the CAMERA algorithm annotates adduct peaks in LC-MS data to form compound spectra for a better annotation of features (<xref rid="btad088-B5" ref-type="bibr">Kuhl <italic toggle="yes">et al.</italic>, 2012</xref>). Currently, there is no computational tool to process data from direct infusion plasma-based ionization available; even though the growing community is in need for harmonized data processing pipelines to handle the challenges of miscellaneous plasma ionization pathways. Therefore, we developed the open-source Python package DBDIpy. Inspired by data from dielectric barrier discharge ionization (DBDI), we provide a novel computational algorithm, to automate the interpretation and to reduce the size of datasets generated by plasma ionization. DBDIpy groups multiple ion species of the same analyte, removes spectral artifacts and facilitates the evaluation of convoluted data to the user.</p>
  </sec>
  <sec>
    <title>2 Implementation</title>
    <p>DBDIpy is designed to handle and process data obtained from untargeted high-resolution real-time plasma ionization MS. It has interfaces to the matchms-ecosystem; a popular Python package for processing of MS data (<xref rid="btad088-B4" ref-type="bibr">Huber <italic toggle="yes">et al.</italic>, 2020</xref>). Data loaded and preprocessed by matchms can be imported by DBDIpy for further analysis. The central algorithm of DBDIpy performs the grouping of systematically occurring ion species from the same.</p>
    <sec>
      <title>2.1 Core functionality</title>
      <p>The grouping of non-[M + H]<sup>+</sup>-ions with the pseudo-molecular ion is performed by a computational two-step open-search approach using the DBDIpy.identify_adducts() function: first, extracted ion chromatogram (XIC) shape similarities are calculated by computing pointwise Pearson correlation coefficient across all XIC pairs in the dataset. Second, highly correlated XICs are refined by mass difference analysis. Adducts and in-source fragments are identified from a set of pre-defined rules, which the user can flexibly customize. Exemplarily, the presence of two highly correlated XICs with a mass difference of 18.010565 ± the error of the mass spectrometer implicates an in-source water loss. The output of DBDIpy.identify_adducts() is a dictionary holding one data frame for each defined adduct type. The data frames contain information on the corresponding XICs matches such as correlation coefficient or mass difference. A comprehensive description of DBDIpy’s functions, the source code and an exemplary data-analysis workflow can be found on the GitHub repository and in the <xref rid="sup1" ref-type="supplementary-material">Supplementary Information</xref>. In brief, data are loaded and aligned by DBDIpy.import_spectra() via the matchms interface from matchms processing pipelines or from open file formats like .mgf. Followingly, missing values in the dataset are imputed by DBDIpy.impute_intensities() in preparation for adduct detection. This step consists of interpolating missing intensities within the signal region of the feature and of adding a noisy baseline to form uniform-length XICs. After this pre-treatment, adduct detection is performed as described above. The results of the adduct search can be visually inspected by calling DBDIpy.plot_adducts(): the temporal course of selected XICs, their correlation coefficients, mass differences and optionally supplied metadata will be shown to the user. This serves for validation of results and to investigate the grouped adduct systems. Finally, the DBDIpy.export_to_spectra() function permits data to be submitted to successive matchms data-handling or to be exported to open file formats.</p>
    </sec>
    <sec>
      <title>2.2 Application</title>
      <p>To showcase the utility of DBDIpy, we performed a demonstrational data analysis. The demo data are from a foodomics study where wheat bread was roasted and thermal reaction products were monitored by DBDI-MS (<xref rid="btad088-B7" ref-type="bibr">Weidner <italic toggle="yes">et al.</italic>, 2023</xref>). It consists of 4196 features. After importing and preparing the data, DBDIpy.identify_adducts() was used to search for in-source water losses and for one to four oxygen adducts (correlation of <italic toggle="yes">r</italic> &gt; 0.95). <xref rid="btad088-F1" ref-type="fig">Figure 1a</xref> gives an overview of the quantity of identified adducts. In total, 710 potential adducts were identified, which corresponds to 17% of all features. This finding emphasizes the importance to perform adduct detection on untargeted plasma ionization datasets. Exemplarily, the temporal profile of an in-source oxidation series of one single compound annotated as [C<sub>15</sub>H<sub>17</sub>O<sub>2</sub>N+H]<sup>+</sup> is shown in <xref rid="btad088-F1" ref-type="fig">Figure 1b</xref>. An independent, network-based annotation workflow (<xref rid="btad088-B6" ref-type="bibr">Moritz <italic toggle="yes">et al.</italic>, 2017</xref>) was used to validate the finding. It confirmed the four mass signals to form a cluster of systematically oxidized and structurally related features.</p>
      <fig position="float" id="btad088-F1">
        <label>Fig. 1.</label>
        <caption>
          <p>(<bold>a</bold>) Total number of in-source fragments and oxygen adducts detected by DBDIpy.identify_adducts() in an untargeted foodomics dataset of 4196 features (<italic toggle="yes">r</italic> &gt; 0.95). (<bold>b</bold>) Temporal course of oxygen adducts generated during ionization of feature [C<sub>15</sub>H<sub>17</sub>O<sub>2</sub>N+H]<sup>+</sup></p>
        </caption>
        <graphic xlink:href="btad088f1" position="float"/>
      </fig>
    </sec>
  </sec>
  <sec>
    <title>3 Conclusion</title>
    <p>We introduced DBDIpy as the first software tool for the identification and curation of in-source fragment ions and non-pseudomolecular ions from time-sensitive plasma ionization MS data. By uniting tied features to groups of adducts, DBDIpy reduces the data size of extensive untargeted datasets and facilitates their interpretation. Analytical chemists from various disciplines can integrate DBDIpy to their workflows as a key processing step to ameliorate their knowledge about convoluted spectra.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btad088_Supplementary_Data</label>
      <media xlink:href="btad088_supplementary_data.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <sec>
    <title>Funding</title>
    <p>This work was supported by the Bavarian Ministry of Economic Affairs, Regional Development and Energy as a part of the BayVFP funding program—funding line digitalization—funding section information and communication technology.</p>
    <p><italic toggle="yes">Conflict of Interest</italic>: none declared.</p>
  </sec>
  <sec sec-type="data-availability">
    <title>Data availability</title>
    <p>DBDIpy is an open-source package and publicly available on GitHub <ext-link xlink:href="https://github.com/leopold-weidner/DBDIpy" ext-link-type="uri">https://github.com/leopold-weidner/DBDIpy</ext-link>. A demo dataset can be downloaded on Zendo under doi.org/10.5281/zenodo.7221088.</p>
  </sec>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btad088-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Adamovich</surname><given-names>I.</given-names></string-name></person-group><etal>et al</etal> (<year>2017</year>) <article-title>The 2017 plasma roadmap: low temperature plasma science and technology</article-title>. <source>J. Phys. D: Appl. Phys</source>., <volume>50</volume>, <fpage>323001</fpage>.</mixed-citation>
    </ref>
    <ref id="btad088-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ayala-Cabrera</surname><given-names>J.F.</given-names></string-name></person-group><etal>et al</etal> (<year>2022</year>) <article-title>Review on atmospheric pressure ionization sources for gas chromatography-mass spectrometry. Part I: Current ion source developments and improvements in ionization strategies</article-title>. <source>Anal. Chim. Acta</source>, <bold>1238</bold>, <fpage>340353</fpage>.<pub-id pub-id-type="pmid">36464440</pub-id></mixed-citation>
    </ref>
    <ref id="btad088-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gyr</surname><given-names>L.</given-names></string-name></person-group><etal>et al</etal> (<year>2019</year>) <article-title>Characterization of a nitrogen-based dielectric barrier discharge ionization source for mass spectrometry reveals factors important for soft ionization</article-title>. <source>Anal. Chem</source>., <volume>91</volume>, <fpage>6865</fpage>–<lpage>6871</lpage>.<pub-id pub-id-type="pmid">31035763</pub-id></mixed-citation>
    </ref>
    <ref id="btad088-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Huber</surname><given-names>F.</given-names></string-name></person-group><etal>et al</etal> (<year>2020</year>) <article-title>matchms - processing and similarity evaluation of mass spectrometry data</article-title>. <source>J. Open Source Softw</source>., <volume>5</volume>, <fpage>2411</fpage>.</mixed-citation>
    </ref>
    <ref id="btad088-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kuhl</surname><given-names>C.</given-names></string-name></person-group><etal>et al</etal> (<year>2012</year>) <article-title>CAMERA: an integrated strategy for compound spectra extraction and annotation of liquid chromatography/mass spectrometry data sets</article-title>. <source>Anal. Chem</source>., <volume>84</volume>, <fpage>283</fpage>–<lpage>289</lpage>.<pub-id pub-id-type="pmid">22111785</pub-id></mixed-citation>
    </ref>
    <ref id="btad088-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Moritz</surname><given-names>F.</given-names></string-name></person-group><etal>et al</etal> (<year>2017</year>) <article-title>Characterization of poplar metabotypes via mass difference enrichment analysis</article-title>. <source>Plant Cell Environ</source>., <volume>40</volume>, <fpage>1057</fpage>–<lpage>1073</lpage>.<pub-id pub-id-type="pmid">27943315</pub-id></mixed-citation>
    </ref>
    <ref id="btad088-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Weidner</surname><given-names>L.</given-names></string-name></person-group><etal>et al</etal> (<year>2023</year>) <article-title>Real-time monitoring of miniaturized thermal food processing by advanced mass spectrometric techniques</article-title>. <source>Anal. Chem</source>., <volume>95</volume>, <fpage>1694</fpage>–<lpage>1702</lpage>.<pub-id pub-id-type="pmid">36602426</pub-id></mixed-citation>
    </ref>
    <ref id="btad088-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wolf</surname><given-names>J.C.</given-names></string-name></person-group><etal>et al</etal> (<year>2016</year>) <article-title>A radical-mediated pathway for the formation of [M + H]+ in dielectric barrier discharge ionization</article-title>. <source>J. Am. Soc. Mass Spectrom</source>., <volume>27</volume>, <fpage>1468</fpage>–<lpage>1475</lpage>.<pub-id pub-id-type="pmid">27380388</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
