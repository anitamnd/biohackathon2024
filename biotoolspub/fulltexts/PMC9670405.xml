<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">9670405</article-id>
    <article-id pub-id-type="publisher-id">5018</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-022-05018-w</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>INFLECT: an R-package for cytometry cluster evaluation using marker modality</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-0648-0642</contrib-id>
        <name>
          <surname>Verhoeff</surname>
          <given-names>Jan</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Abeln</surname>
          <given-names>Sanne</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-6238-7069</contrib-id>
        <name>
          <surname>Garcia-Vallejo</surname>
          <given-names>Juan J.</given-names>
        </name>
        <address>
          <email>jj.garciavallejo@amsterdamumc.nl</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.12380.38</institution-id><institution-id institution-id-type="ISNI">0000 0004 1754 9227</institution-id><institution>Department of Molecular Cell Biology &amp; Immunology, Amsterdam Infection &amp; Immunity Institute and Cancer Center Amsterdam, </institution><institution>Amsterdam UMC, Vrije Universiteit Amsterdam, </institution></institution-wrap>De Boelelaan 1108, 1081 HZ Amsterdam, The Netherlands </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.12380.38</institution-id><institution-id institution-id-type="ISNI">0000 0004 1754 9227</institution-id><institution>Department of Computer Sciences, Center for Integrative Bioinformatics (IBIVU), </institution><institution>Vrije Universiteit Amsterdam, </institution></institution-wrap>De Boelelaan 1105, 1081 HV Amsterdam, the Netherlands </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>16</day>
      <month>11</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>16</day>
      <month>11</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2022</year>
    </pub-date>
    <volume>23</volume>
    <elocation-id>487</elocation-id>
    <history>
      <date date-type="received">
        <day>21</day>
        <month>4</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>28</day>
        <month>10</month>
        <year>2022</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2022</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold>This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">Current methods of high-dimensional unsupervised clustering of mass cytometry data lack means to monitor and evaluate clustering results. Whether unsupervised clustering is correct is typically evaluated by agreement with dimensionality reduction techniques or based on benchmarking with manually classified cells. The ambiguity and lack of reproducibility of sequential gating has been replaced with ambiguity in interpretation of clustering results. On the other hand, spurious overclustering of data leads to loss of statistical power. We have developed INFLECT, an R-package designed to give insight in clustering results and provide an optimal number of clusters. In our approach, a mass cytometry dataset is overclustered intentionally to ensure the smallest phenotypically different subsets are captured using FlowSOM. A range of metacluster number endpoints are generated and evaluated using marker interquartile range and distribution unimodality checks. The fraction of marker distributions that pass these checks is taken as a measure of clustering success. The fraction of unimodal distributions within metaclusters is plotted against the number of generated metaclusters and reaches a plateau of diminishing returns. The inflection point at which this occurs gives an optimal point of capturing cellular heterogeneity versus statistical power.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">We applied INFLECT to four publically available mass cytometry datasets of different size and number of markers. The unimodality score consistently reached a plateau, with an inflection point dependent on dataset size and number of dimensions. We tested both ConsenusClusterPlus metaclustering and hierarchical clustering. While hierarchical clustering is less computationally expensive and thus faster, it achieved similar results to ConsensusClusterPlus. The four datasets consisted of labeled data and we compared INFLECT metaclustering to published results. INFLECT identified a higher optimal number of metaclusters for all datasets. We illustrated the underlying heterogeneity within labels, showing that these labels encompass distinct types of cells.</p>
      </sec>
      <sec>
        <title>Conclusion</title>
        <p id="Par3">INFLECT addresses a knowledge gap in high-dimensional cytometry analysis, namely assessing clustering results. This is done through monitoring marker distributions for interquartile range and unimodality across a range of metacluster numbers. The inflection point is the optimal trade-off between cellular heterogeneity and statistical power, applied in this work for FlowSOM clustering on mass cytometry datasets.</p>
      </sec>
      <sec>
        <title>Supplementary Information</title>
        <p>The online version contains supplementary material available at 10.1186/s12859-022-05018-w.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Mass cytometry</kwd>
      <kwd>Data analysis</kwd>
      <kwd>Clustering results</kwd>
      <kwd>Clustering evaluation</kwd>
      <kwd>Unimodality</kwd>
      <kwd>Software</kwd>
      <kwd>Phenotyping</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100019573</institution-id>
            <institution>Amsterdam University Medical Centers</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2022</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par13">It has been widely accepted in (mass) cytometry that high-dimensional datasets are best approached through unsupervised clustering algorithms [<xref ref-type="bibr" rid="CR1">1</xref>, <xref ref-type="bibr" rid="CR2">2</xref>], revealing structure in high-dimensional space that is not well identified through bivariate sequential gating. Prior to the introduction of unsupervised clustering into flow cytometry, the gold standard in cell classification of conventional flow cytometry data involved manual gating. In this approach, researchers use manually defined coordinates (gates) to group cells in bivariate plots. This process is repeated in a sequential manner until all desired populations have been defined. Manual gating requires a priori knowledge, it is not easily scalable, it is susceptible to the observer’s experience and personal bias, and it misses on untargeted populations. Therefore, there has been a keen interest in the cytometry community to develop automated data analysis methods, such as unsupervised clustering. Opposite to manual gating, unsupervised clustering algorithms do not prioritize any of the given input parameters. Interpretation and visualization of the clustering results is often aided by dimensionality reduction. Additionally, these data-driven algorithms provide more reproducible results, removing researcher bias that comes with manually setting gates in bivariate plots. Since the publication of the first clustering method for cytometry data in 2007, many clustering algorithms have been published and their performance thoroughly compared [<xref ref-type="bibr" rid="CR3">3</xref>–<xref ref-type="bibr" rid="CR7">7</xref>]. However, every high-dimensional analysis method makes assumptions on the underlying data that need to be understood by the researcher implementing these methods [<xref ref-type="bibr" rid="CR8">8</xref>, <xref ref-type="bibr" rid="CR9">9</xref>]. The added complexity of clustering algorithms has led to shifting of ambiguity from gating to ambiguity surrounding clustering results. The question of how many meaningful clusters exist in a high-dimensional dataset has proven to be very difficult to answer. Methods such as FlowGrid [<xref ref-type="bibr" rid="CR7">7</xref>] or Phenograph [<xref ref-type="bibr" rid="CR10">10</xref>] have automated cluster detection relying on intra-cluster (dis)similarity. However, subsets of rare cells often have high clinical relevance with little phenotypic distance to other subsets. Clustering algorithms specifically designed to capture rare subsets [<xref ref-type="bibr" rid="CR11">11</xref>, <xref ref-type="bibr" rid="CR12">12</xref>] or relying on over-clustering [<xref ref-type="bibr" rid="CR9">9</xref>] present other limitations: a large number of (small) clusters leads to a loss of statistical power due to corrections for multiple testing. Automated metaclustering, the grouping of phenotypically similar clusters, is a solution to over-clustering, but it is in turn susceptible to the same challenges as one-step clustering methods. ConcensusClusterPlus, the default metaclustering method implemented in FlowSOM, often has a very conservative result, leading to broad clusters encompassing multiple cell types.
</p>
    <p id="Par14">Manual identification and optional supervised metaclustering is a laborious process but currently unavoidable when analyzing over-clustered high-dimensional data. It has become common for mass cytometry data to be presented in a way that classifies multiple found clusters as a single phenotype. Clusters identified in an unsupervised manner are grouped together, implying that these (sub-)clusters represent different states of the given phenotype [<xref ref-type="bibr" rid="CR13">13</xref>–<xref ref-type="bibr" rid="CR17">17</xref>]. If combined into a larger single cluster, few methods exist to evaluate the results that come from any given clustering algorithm [<xref ref-type="bibr" rid="CR18">18</xref>, <xref ref-type="bibr" rid="CR19">19</xref>], meaning researchers visually inspect heatmaps of median cluster expressions or assess concordance of unsupervised clustering results to dimensionality reduction techniques such as t-SNE or UMAP. Furthermore, none of these approaches address the question of how to set the limit to the number of clusters (or metaclusters) that is adequate for each dataset.</p>
    <p id="Par15">Here, we aim to address this question by a computational method, INFLECT, that iteratively evaluates metaclustering performance to find the highest level of parameter unimodality, and lowest expression spread per metacluster. Evaluating clustering results using these 2 characteristics is based on the assumptions that a multi-modal univariate distribution contains multiple, possibly overlapping, cell populations. A wide marker spread similarly indicates poor clustering. These multiple cell populations can be related, but represent different activation states of a large cell phenotype, or transitional cells differentiating. In turn this means that if a clustering process results in narrow unimodal marker distributions across all generated clusters, it has successfully captured the full cellular heterogeneity in the dataset. INFLECT uses FlowSOM [<xref ref-type="bibr" rid="CR20">20</xref>, <xref ref-type="bibr" rid="CR21">21</xref>] for upstream clustering because of fast runtimes and widespread use. In concordance with the FlowSOM workflow, datasets are overclustered in initial SOM-clustering, and the subsequent metaclustering steps are investigated. Results of the metaclustering are evaluated based on the marker expression distributions within formed metaclusters. For each marker, INFLECT tests for unimodality and assesses marker expression spread. Unimodality is determined through the dip test [<xref ref-type="bibr" rid="CR22">22</xref>], a statistical test. Marker distribution spread is evaluated through the interquartile range and fails if this range is too high.</p>
  </sec>
  <sec id="Sec2">
    <title>Implementation</title>
    <p id="Par16">The aim of INFLECT is to provide a data-driven evaluation of metaclustering results and calculate the optimal metacluster number where marker distribution quality is balanced with the number of identified clusters. It is written in R and made available here: <ext-link ext-link-type="uri" xlink:href="http://www.github.com/jnverhoeff/GarciaVallejoLab/INFLECT">www.github.com/jnverhoeff/GarciaVallejoLab/INFLECT</ext-link>. The process of INFLECT is illustrated in Fig. <xref rid="Fig1" ref-type="fig">1</xref>. In summary, the method takes as input a high-dimensional dataset clustered using the FlowSOM wrapper function, and a set of metacluster targets to be evaluated. The output consist of diagnostic graphs and a determined optimal metacluster number. In the following sections we describe the steps implemented in the R package.<fig id="Fig1"><label>Fig. 1</label><caption><p>Illustrated representation of the algorithms workflow. <bold>A</bold> A simple 2-dimensional example, based on a dataset containing two markers with 4 populations, 2 of which are connected, is clustered in 2 &lt; <italic>m</italic> &lt; <italic>k</italic> populations. Each clustering result is inspected by assessment of marker distribution through the dip test and marker spread test. <bold>B</bold> Result of metaclustering of the example dataset, split in 2, 4 or 8 populations. <bold>C</bold> Marker distributions in the formed metaclusters. Green density plots pass the dip test and marker spread test, red distributions denote failed markers due to non-unimodal distribution. <bold>D</bold> For every metaclustering result (denoted with <italic>i</italic>), all marker distributions for the <italic>m</italic> number of metaclusters are taken together and the fraction of passed distributions is taken. <bold>E</bold> Representative diagnostic plot for a larger dataset. The values of the Unimodality set <inline-formula id="IEq30"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${U}_{i}$$\end{document}</tex-math><mml:math id="M2"><mml:msub><mml:mi>U</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_5018_Article_IEq30.gif"/></alternatives></inline-formula> are plotted on the <italic>y</italic>-axis versus the number of metaclusters assessed on the <italic>x-</italic>axis in red. A sigmoidal curve (blue) is fitted to this data. A plateau is reached where the fraction of unimodal distributions scarcely increases with increasing numbers of metaclusters</p></caption><graphic xlink:href="12859_2022_5018_Fig1_HTML" id="MO1"/></fig></p>
    <sec id="Sec3">
      <title>Iterative metaclustering automation</title>
      <p id="Par17">The process starts with calculating the metaclustering of clusters formed by self-organizing maps of FlowSOM. To ensure capture of the smallest subset of interest, we recommend an initial number of SOM-clusters of at least 200. The subsequent maximum number of metaclusters <italic>k</italic> cannot exceed 90% of the number of SOM-clusters due to resampling within ConsensusClusterPlus. This is done according to either ConsensusClusterPlus[<xref ref-type="bibr" rid="CR23">23</xref>] or hierarchical clustering based on Minkowski distance and Ward’s linkage. To limit the computation time not every possible metacluster number is evaluated. Using the default settings, INFLECT increases the metacluster targets number by 5 from 50 metaclusters on, and by 10 from 150 metaclusters on. Target numbers are sparser at higher metacluster numbers, due to increased computational load. In our experience the changes between metaclustering results at higher target numbers vary less and thus contribute less information. However, users can specify the amount of metacluster numbers to evaluate using the input vector <inline-formula id="IEq1"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$set\_i$$\end{document}</tex-math><mml:math id="M4"><mml:mrow><mml:mi>s</mml:mi><mml:mi>e</mml:mi><mml:mi>t</mml:mi><mml:mi>_</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_5018_Article_IEq1.gif"/></alternatives></inline-formula>. This step can be multithreaded to expedite calculations.</p>
    </sec>
    <sec id="Sec4">
      <title>Metaclustering evaluation step</title>
      <p id="Par18">Each <italic>metaclustering result</italic> is evaluated separately, again enabling multithreading. For each metacluster per <italic>metaclustering result</italic>, all relevant marker distributions are evaluated for inter-quartile range and unimodality through the dip test. Results are collected in a matrix of <italic>m</italic> (= the amount of metaclusters) by <italic>n</italic> (= the amount of markers) on a pass/fail basis. A marker distribution fails if the inter-quartile range exceeds a given threshold or has a non-unimodal distribution. Default inter-quartile range threshold is set at a value of 2 after hyperbolic arcsine transformation of raw data (the standard transformation for mass cytometry data). The fraction of distributions that passed this quality control (QC) across all clusters is calculated and given as output <italic>U</italic>. Taken together the outputs form the set <inline-formula id="IEq2"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${U}_{i}$$\end{document}</tex-math><mml:math id="M6"><mml:msub><mml:mi>U</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_5018_Article_IEq2.gif"/></alternatives></inline-formula>, called the Unimodality set.</p>
    </sec>
    <sec id="Sec5">
      <title>Diagnostic plotting</title>
      <p id="Par19">The values within the Unimodality set <inline-formula id="IEq3"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${U}_{i}$$\end{document}</tex-math><mml:math id="M8"><mml:msub><mml:mi>U</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_5018_Article_IEq3.gif"/></alternatives></inline-formula>, are plotted against the number of metaclusters. Subsequently, an L-function is applied to find the inflection point, where dividing the graph in two halves using straight fitted lines results in the least error. This can be done on the Unimodality set itself, or a sigmoidal curve fitted to the data. This implementation of the L-method is based on work by Salvador and Chan [<xref ref-type="bibr" rid="CR24">24</xref>]. The horizontal coordinate of this inflection point is the optimal metacluster number for this dataset.</p>
    </sec>
  </sec>
  <sec id="Sec6">
    <title>Application to public datasets</title>
    <p id="Par20">We implemented INFLECT on multiple publicly available datasets to assess robustness and applicability. Characteristics of the datasets used are summarized in Table <xref rid="Tab1" ref-type="table">1</xref>. Labels for the events are taken from the datasets directly. In direct comparison of labels and INFLECT metaclusters only labeled data is considered.<table-wrap id="Tab1"><label>Table 1</label><caption><p>Dataset characteristics</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Dataset</th><th align="left">Type of samples</th><th align="left">Number of cells</th><th align="left">Number of labeled cells</th><th align="left">Clustering method</th><th align="left">Number of labels</th><th align="left">Number of markers used in clustering</th></tr></thead><tbody><tr><td align="left">Levine32 [<xref ref-type="bibr" rid="CR10">10</xref>]</td><td align="left">BMMC<sup>a</sup></td><td align="left">161,443</td><td align="left">104,184</td><td align="left">Phenograph</td><td align="left">14</td><td align="left">32</td></tr><tr><td align="left">Bagwell [<xref ref-type="bibr" rid="CR26">26</xref>]</td><td align="left">PBMC<sup>b</sup></td><td align="left">101,963</td><td align="left">901,559</td><td align="left">Manual gating</td><td align="left">26</td><td align="left">29</td></tr><tr><td align="left">KimmeyBM [<xref ref-type="bibr" rid="CR25">25</xref>]</td><td align="left">BMMC</td><td align="left">994,897</td><td align="left">994,897</td><td align="left">SPADE<sup>c</sup></td><td align="left">33</td><td align="left">32</td></tr><tr><td align="left">KimmeyPBMC [<xref ref-type="bibr" rid="CR25">25</xref>]</td><td align="left">PBMC</td><td align="left">795,428</td><td align="left">795,428</td><td align="left">SPADE</td><td align="left">9</td><td align="left">12</td></tr></tbody></table><table-wrap-foot><p><sup>a</sup>Bone marrow mononuclear cells</p><p><sup>b</sup>Peripheral blood mononuclear cells</p><p><sup>c</sup>Spanning-tree progression analysis of density-normalized events</p></table-wrap-foot></table-wrap></p>
    <p id="Par21">INFLECT requires a single input-parameter, <inline-formula id="IEq4"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k$$\end{document}</tex-math><mml:math id="M10"><mml:mi>k</mml:mi></mml:math><inline-graphic xlink:href="12859_2022_5018_Article_IEq4.gif"/></alternatives></inline-formula>, for the amount of clusters generated in the initial SOM-clustering. In the 4 datasets included in this study, the plateau in unimodal marker distributions was consistently reached before <inline-formula id="IEq5"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k=100$$\end{document}</tex-math><mml:math id="M12"><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>100</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_5018_Article_IEq5.gif"/></alternatives></inline-formula>. For statistical power in the plateau we recommend a value of <inline-formula id="IEq6"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k$$\end{document}</tex-math><mml:math id="M14"><mml:mi>k</mml:mi></mml:math><inline-graphic xlink:href="12859_2022_5018_Article_IEq6.gif"/></alternatives></inline-formula> of circa 200. In our experiments, to ensure we reached the point of spurious over-clustering, we applied INFLECT to the datasets with <inline-formula id="IEq7"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k&gt;350$$\end{document}</tex-math><mml:math id="M16"><mml:mrow><mml:mi>k</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>350</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_5018_Article_IEq7.gif"/></alternatives></inline-formula>.</p>
    <p id="Par22">All computations in this work were carried out using a 2X Intel® E5-2660 v3 computing cluster, clocked at 2.60 GHz and 128 GB of RAM. Where possible, processes were run in parallel in 10 threads.</p>
  </sec>
  <sec id="Sec7">
    <title>Validation</title>
    <p id="Par23">KimmeyPBMC used 12 markers for clustering into 9 major phenotypes, whereas the panel by Bagwell uses 29 out of 30 markers for manual gating into 26 phenotypes. This variability revealed the broad applicability of INFLECT, where a broad range of mass cytometry datasets show formation of a stable plateau in metacluster unimodality.</p>
    <p id="Par24">The labeled data allowed for comparison of the inflection point metacluster number to the labeled populations. The number of labels was treated as a measure of dataset heterogeneity. Deviations between INFLECT and the number of labels were further investigated for causes and possible cellular heterogeneity within labels.</p>
  </sec>
  <sec id="Sec8">
    <title>Results</title>
    <sec id="Sec9">
      <title>Unimodal marker distribution of FlowSOM clusters reaches a plateau (for both methods of metaclustering)</title>
      <p id="Par25">Firstly, we investigated how the number of metaclusters related to cluster unimodality and if this could lead to an optimal metacluster number. To assess this we applied INFLECT to 4 publically available datasets. Because FlowSOM requires an input parameter defining the number of resulting clusters, we could iteratively increase the number of generated metaclusters in repeated runs.</p>
      <p id="Par26">By evaluating cluster uniformity as a fraction of unimodal markers across clusters, using the dip test for unimodality, we monitored clustering success. In the four labeled datasets we encountered a consistent formation of a plateau. At these plateaus, a (further) increase of metaclusters yielded only a small improvement in cluster unimodality. The Unimodality set <inline-formula id="IEq8"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${U}_{i}$$\end{document}</tex-math><mml:math id="M18"><mml:msub><mml:mi>U</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_5018_Article_IEq8.gif"/></alternatives></inline-formula> is the combined set of cluster unimodality fractions for every metaclustering <italic>i</italic>. After fitting a sigmoidal curve we implemented the L-function [<xref ref-type="bibr" rid="CR24">24</xref>] method to calculate the inflection point of the curve. To assess the effects of dataset size and different methods of metaclustering, we applied INFLECT with different combinations of subsamplings of the Levine32 dataset and metaclustering methods as shown in Fig. <xref rid="Fig2" ref-type="fig">2</xref>. Different methods of metaclustering yield slightly different sets of <inline-formula id="IEq9"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${U}_{i}$$\end{document}</tex-math><mml:math id="M20"><mml:msub><mml:mi>U</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_5018_Article_IEq9.gif"/></alternatives></inline-formula> for the same dataset (Hierarchical clustering in Fig. <xref rid="Fig2" ref-type="fig">2</xref>A and ConsensusClusterPlus in 2C). The resampling processes in ConsensusClusterPlus [<xref ref-type="bibr" rid="CR23">23</xref>] are a computationally expensive step, leading to high runtimes for higher values of <inline-formula id="IEq10"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i$$\end{document}</tex-math><mml:math id="M22"><mml:mi>i</mml:mi></mml:math><inline-graphic xlink:href="12859_2022_5018_Article_IEq10.gif"/></alternatives></inline-formula>. Run times are summarized in Table <xref rid="Tab2" ref-type="table">2</xref>.<fig id="Fig2"><label>Fig. 2</label><caption><p>Resulting diagnostic graphs of INFLECT on the Levine32 benchmark dataset. The Unimodality set (<inline-formula id="IEq31"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${U}_{i}$$\end{document}</tex-math><mml:math id="M24"><mml:msub><mml:mi>U</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_5018_Article_IEq31.gif"/></alternatives></inline-formula>) is plotted versus the number of metaclusters generated through metaclustering of SOM-clusters. Applying the L-function returns the inflection point where fraction of unimodal distribution plateaus for increasing numbers of metaclusters. <bold>A</bold> Diagnostic graph using hierarchical clustering for metaclustering. The L-function is applied to the fitted curve, resulting in an inflection point of 41 metaclusters. Value for <inline-formula id="IEq32"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${U}_{41}$$\end{document}</tex-math><mml:math id="M26"><mml:msub><mml:mi>U</mml:mi><mml:mn>41</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_5018_Article_IEq32.gif"/></alternatives></inline-formula> is determined at 98.17%. <bold>B</bold> Diagnostic graph comparing results for the entire Levine32 dataset using hierarchical clustering to five smaller subsampled datasets, 75%, 50%, 25%, 10% and 5% of events. Unimodality plateaus and inflection points for dataset sizes of 25–100% are consistent. 10% and 5% sizes display a lower plateau and lower inflection point. Of note is that for these smaller datasets, the fraction of unimodal distributions at higher metacluster numbers is less stable. <bold>C</bold> Diagnostic graph using ConsensusClusterPlus metaclustering and L-function on the fitted curve. Due to the longer runtimes of ConsensusClusterPlus fewer <inline-formula id="IEq33"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${U}_{i}$$\end{document}</tex-math><mml:math id="M28"><mml:msub><mml:mi>U</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_5018_Article_IEq33.gif"/></alternatives></inline-formula> were calculated. Resulting inflection point is 33 metaclusters with <inline-formula id="IEq34"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${U}_{33}$$\end{document}</tex-math><mml:math id="M30"><mml:msub><mml:mi>U</mml:mi><mml:mn>33</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_5018_Article_IEq34.gif"/></alternatives></inline-formula> at 98.76%. <bold>D</bold> Marker performance diagnostic plot. For 5 selected markers the fraction of metaclusters which passed the dip test and marker spread test is collected per number of metaclusters. Data is shown in a scatterplot, amount of FlowSOM-metaclusters on the <italic>x</italic>-axis and percentage of metaclusters that passed the unimodality and interquartile range checks. Some (CD8, CD123, CD16) fail the unimodality tests at lower metacluster numbers, while reaching 100% at a higher metacluster numbers. CD13 and CD47 prove very stable at 100%. CD8 displays the highest variability and does not reach 100%, indicating poorer clustering performance for this marker</p></caption><graphic xlink:href="12859_2022_5018_Fig2_HTML" id="MO2"/></fig><table-wrap id="Tab2"><label>Table 2</label><caption><p>Runtime in seconds of metaclustering methods of FlowSOM. k = 375 SOMclusters</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" rowspan="2">Time in seconds</th><th align="left" colspan="2">Total <inline-formula id="IEq37"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${U}_{i}$$\end{document}</tex-math><mml:math id="M32"><mml:msub><mml:mi>U</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_5018_Article_IEq37.gif"/></alternatives></inline-formula></th><th align="left" colspan="2"><inline-formula id="IEq38"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${U}_{325}$$\end{document}</tex-math><mml:math id="M34"><mml:msub><mml:mi>U</mml:mi><mml:mn>325</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_5018_Article_IEq38.gif"/></alternatives></inline-formula></th></tr><tr><th align="left">Processor time</th><th align="left">Elapsed time</th><th align="left">Processor time</th><th align="left">Elapsed time</th></tr></thead><tbody><tr><td align="left">Consensus cluster plus, 10 core multithreaded</td><td char="." align="char">8853.69</td><td char="." align="char">2865.79</td><td char="." align="char">2559.75</td><td char="." align="char">2582.52</td></tr><tr><td align="left">Hierarchical clustering</td><td char="." align="char">5.75</td><td char="." align="char">5.79</td><td char="." align="char">0.05</td><td char="." align="char">0.10</td></tr></tbody></table></table-wrap></p>
      <p id="Par27">For hierarchical clustering <inline-formula id="IEq11"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i=(\mathrm{5,6},7\dots 150, 155, 160\dots 200, 210, 220\dots 320)$$\end{document}</tex-math><mml:math id="M36"><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>5</mml:mn><mml:mo>,</mml:mo><mml:mn>6</mml:mn></mml:mrow><mml:mo>,</mml:mo><mml:mn>7</mml:mn><mml:mo>⋯</mml:mo><mml:mn>150</mml:mn><mml:mo>,</mml:mo><mml:mn>155</mml:mn><mml:mo>,</mml:mo><mml:mn>160</mml:mn><mml:mo>⋯</mml:mo><mml:mn>200</mml:mn><mml:mo>,</mml:mo><mml:mn>210</mml:mn><mml:mo>,</mml:mo><mml:mn>220</mml:mn><mml:mo>⋯</mml:mo><mml:mn>320</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_5018_Article_IEq11.gif"/></alternatives></inline-formula> were calculated in sequence. ConsensusClusterPlus was calculated for <inline-formula id="IEq12"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i = (5, 6, 7\dots 50, 55, 60\dots 100, 120, 140\dots 200, 225, 250, 275, 300)$$\end{document}</tex-math><mml:math id="M38"><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>5</mml:mn><mml:mo>,</mml:mo><mml:mn>6</mml:mn><mml:mo>,</mml:mo><mml:mn>7</mml:mn><mml:mo>⋯</mml:mo><mml:mn>50</mml:mn><mml:mo>,</mml:mo><mml:mn>55</mml:mn><mml:mo>,</mml:mo><mml:mn>60</mml:mn><mml:mo>⋯</mml:mo><mml:mn>100</mml:mn><mml:mo>,</mml:mo><mml:mn>120</mml:mn><mml:mo>,</mml:mo><mml:mn>140</mml:mn><mml:mo>⋯</mml:mo><mml:mn>200</mml:mn><mml:mo>,</mml:mo><mml:mn>225</mml:mn><mml:mo>,</mml:mo><mml:mn>250</mml:mn><mml:mo>,</mml:mo><mml:mn>275</mml:mn><mml:mo>,</mml:mo><mml:mn>300</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_5018_Article_IEq12.gif"/></alternatives></inline-formula>. Therefore, we applied the much faster hierarchical clustering in all subsequent analysis.</p>
    </sec>
    <sec id="Sec10">
      <title>The metacluster unimodality results <inline-formula id="IEq13"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\varvec{U}}}_{{\varvec{i}}}$$\end{document}</tex-math><mml:math id="M40"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">U</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_5018_Article_IEq13.gif"/></alternatives></inline-formula> are dependent on dataset size</title>
      <p id="Par28">To investigate the effect of the size of the data set, we generated smaller datasets by subsampling Levine32 (Fig. <xref rid="Fig2" ref-type="fig">2</xref>B). For the full size dataset down to 25% size, the inflection points and unimodality score plots are very similar, ranging from 36 metaclusters for the full dataset to 34 for the 25% sample. At 10% size, which is 60,000 cells for this dataset, the inflection point shifts to 19 metaclusters, and to 26 metaclusters for 5% size. Of note is that the cluster unimodality fraction of the plateau for higher metacluster numbers seems to drop for the smaller dataset sizes.</p>
      <p id="Par29">In Fig. <xref rid="Fig2" ref-type="fig">2</xref>D we display the marker performance in the dataset across all the metacluster numbers. Several markers pass the unimodality and marker spread checks for all metacluster numbers, such as CD13 or CD47. Other markers show a greater spread, having multi-modal distributions for lower metacluster numbers but rising to 100% for very high metacluster numbers (CD123 and CD16) or never reaching 100% (CD8). This graph can inform researchers on the clustering power of different markers in the dataset. In Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S1, the performance of the remaining clustering markers is shown.</p>
    </sec>
    <sec id="Sec11">
      <title>The L-function provides a data-driven Inflect point for unimodality scores and fitted curves</title>
      <p id="Par30">To investigate the robustness of INFLECT cluster unimodality and the implementation of the L-function, we subsampled 90% of the Levine32 dataset 15 times. INFLECT was applied on the 15 replicates. Resulting unimodality sets (Fig. <xref rid="Fig3" ref-type="fig">3</xref>A) exhibit little variation. In four out of the 85 metacluster numbers evaluated, all 15 replicates yielded the same cluster accuracy. Greatest variability between replicates was 0.69%, which occurred at <italic>m</italic> = 9 metaclusters. Applying the L-function on fitted curves (Fig. <xref rid="Fig3" ref-type="fig">3</xref>B) vary between 36 and 42, with a mean of 38.90 and a SEM of 0.62. When applying the L-function directly on the Unimodality set <inline-formula id="IEq14"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${U}_{i}$$\end{document}</tex-math><mml:math id="M42"><mml:msub><mml:mi>U</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_5018_Article_IEq14.gif"/></alternatives></inline-formula> (Fig. <xref rid="Fig3" ref-type="fig">3</xref>C) data points, the position of the inflection point is more vulnerable to noise, with a lower mean of 28 but a higher SEM of 0.90. Repeats shown in Fig. <xref rid="Fig3" ref-type="fig">3</xref> represent the greatest variability between the in total 15 replicates. Remaining repeats are shown in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S2. In addition to lower variability, fitting a sigmoidal curve to the data lowers the amount of metaclusters that need to be evaluated, further speeding up calculations. In Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S3 we show that even with lower amount of data points in the Unimodality set, the fitted curve provides a stable inflection point. Hence, applying the L-function to fitted curves gives more robust results.<fig id="Fig3"><label>Fig. 3</label><caption><p>Diagnostic plots of INFLECT generated on 15 independent 90% subsamples of the Levine32 benchmark dataset. <bold>A</bold> Overlaid INFLECT diagnostic plots for each 90% subsample. Unimodality set <inline-formula id="IEq35"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${U}_{i}$$\end{document}</tex-math><mml:math id="M44"><mml:msub><mml:mi>U</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_5018_Article_IEq35.gif"/></alternatives></inline-formula> points are connected with colored lines. <bold>B</bold> Four selected INFLECT diagnostic plots for 90% subsamples with the greatest range. Shown are the fitted curves and the L-function inflection points generated from the curves. Inflection point indicated with vertical line. <bold>C</bold> Four selected INFLECT diagnostic plots for 90% subsamples with the greatest range. Here, the L-function is applied directly to the data (the Unimodality set <inline-formula id="IEq36"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${U}_{i}$$\end{document}</tex-math><mml:math id="M46"><mml:msub><mml:mi>U</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_5018_Article_IEq36.gif"/></alternatives></inline-formula>), without fitting a sigmoidal curve. All determined inflection points are indicated with a dashed vertical line</p></caption><graphic xlink:href="12859_2022_5018_Fig3_HTML" id="MO3"/></fig></p>
    </sec>
    <sec id="Sec12">
      <title>INFLECT captures underlying heterogeneity in labeled clusters of Levine32</title>
      <p id="Par31">For visualization purposes we sampled 40,000 events from Levine32 and performed a tSNE embedding (Fig. <xref rid="Fig4" ref-type="fig">4</xref>A). As can be expected, INFLECT splits several of the more abundant populations into smaller metaclusters, while matching smaller distinct cell types such as CD16- natural killer (NK) cells and Plasma B cells to one metacluster each. In this case INFLECT was run only on labeled data, which was 65% of total events. The optimal metacluster number for this data was higher, at 61 metaclusters, shown in Fig. <xref rid="Fig4" ref-type="fig">4</xref>B. In Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S4, we compare INFLECT to two common clustering evaluation tools [<xref ref-type="bibr" rid="CR27">27</xref>], and the default method of metaclustering in FlowSOM. The 2 metaclusters most closely matching CD16 + NK cells were investigated (metacluster 60 and 61) through visual inspection of marker histograms (Fig. <xref rid="Fig4" ref-type="fig">4</xref>C and <xref rid="Fig4" ref-type="fig">D</xref>). 3 markers were selected for illustrating the greatest variability between the metaclusters. CD16 + NK cells show no multi-modality as a total population, passing the dip test for each marker distribution, however in Fig. <xref rid="Fig4" ref-type="fig">4</xref>D it is shown that metaclusters 60 and 61 have distinct levels of CD16 expression. This seems to correspond well to the tSNE mapping in 4A, where the light blue CD16 + NK cell population consists of two connected populations. Full concordance between labeled data and INFLECT metaclusters is summarized in Additional file <xref rid="MOESM2" ref-type="media">2</xref>.<fig id="Fig4"><label>Fig. 4</label><caption><p>INFLECT identifies additional heterogeneity present within labeled data. <bold>A-B</bold> tSNE embedding of 40,000 events from Levine32, in <bold>A</bold> colored for the 14 phenotypes as identified by Phenograph in the original paper. In <bold>B</bold>, 61 metaclusters identified through INFLECT. <bold>C</bold> Density plots of selected markers for CD16 + NK cells. <italic>X</italic>-axis denote Arcsinh(x/5) transformed expression values. <bold>D</bold> Density plots of selected markers highlighting heterogeneity within CD16 + NK cells, which was split into metaclusters 60 and 61. <italic>X</italic>-axis denote Arcsinh(x/5) transformed expression values. Metacluster 60 has a CD16-dim phenotype, whereas metacluster 61 has high CD16 expression</p></caption><graphic xlink:href="12859_2022_5018_Fig4_HTML" id="MO4"/></fig></p>
    </sec>
    <sec id="Sec13">
      <title>The inflection point is consistent across mass cytometry datasets</title>
      <p id="Par32">Wider applicability of INFLECT was investigated by applying the method to 3 other datasets (Fig. <xref rid="Fig5" ref-type="fig">5</xref>). In the Bagwell PBMC dataset (Fig. <xref rid="Fig5" ref-type="fig">5</xref>A) all 5 samples (which are technical replicates acquired at different sites) showed a similar pattern of cluster unimodality. The fraction of unimodal distributions rose rapidly to 95% for all 5 samples. The fraction of unimodal distributions increased at a lower rate for increasing numbers of clusters, reaching 99.02% unimodality for 300 FlowSOM metaclusters. Applying the L-function output a median of 53 metaclusters as the optimal number of metaclusters for this dataset with a fraction of unimodal distributions <inline-formula id="IEq15"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${U}_{53}= 95.61\%$$\end{document}</tex-math><mml:math id="M48"><mml:mrow><mml:msub><mml:mi>U</mml:mi><mml:mn>53</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>95.61</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_5018_Article_IEq15.gif"/></alternatives></inline-formula>. Diagnostic curve for KimmeyBM (Fig. <xref rid="Fig5" ref-type="fig">5</xref>B) showed a similar pattern, <inline-formula id="IEq16"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${U}_{5\dots 73}$$\end{document}</tex-math><mml:math id="M50"><mml:msub><mml:mi>U</mml:mi><mml:mrow><mml:mn>5</mml:mn><mml:mo>⋯</mml:mo><mml:mn>73</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_5018_Article_IEq16.gif"/></alternatives></inline-formula> rising to 95.60% unimodality, then yielded diminishing returns up to 99.70% fraction of unimodal distributions. Inflection point, resulting from the L-function was at 74 metaclusters.. The KimmeyPBMC dataset had fewer markers used for phenotyping than the bone marrow dataset. This resulted in a lower optimal cluster number, determined at 41 metaclusters with a fraction of unimodal distributions of 98.89%. For higher numbers of metaclusters, the diagnostic curve had a nearly level unimodality plateau starting at inflection point = 42. Unimodality increases up to 98.37% at <inline-formula id="IEq17"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${U}_{42}$$\end{document}</tex-math><mml:math id="M52"><mml:msub><mml:mi>U</mml:mi><mml:mn>42</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_5018_Article_IEq17.gif"/></alternatives></inline-formula>, ultimately reaching 99.70% at <inline-formula id="IEq18"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${U}_{350}$$\end{document}</tex-math><mml:math id="M54"><mml:msub><mml:mi>U</mml:mi><mml:mn>350</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_5018_Article_IEq18.gif"/></alternatives></inline-formula>.<fig id="Fig5"><label>Fig. 5</label><caption><p>INFLECT Unimodality plateaus are reached across mass cytometry data sets. <bold>A</bold> INFLECT Diagnostic curve for five replicate PBMC samples from Bagwell et al. Samples were clustered and evaluated separately and inflection points were determined. <bold>B</bold> KimmeyBM INFLECT diagnostic curve. Inflection point (= 74) is calculated on the fitted sigmoidal curve. <bold>C</bold> KimmeyPBMC INFLECT diagnostic curve. Inflection point (= 41) is calculated on the fitted sigmoidal curve</p></caption><graphic xlink:href="12859_2022_5018_Fig5_HTML" id="MO5"/></fig></p>
      <p id="Par33">Similar to the Levine32 dataset, the Bagwell and Kimmey datasets are labeled by the original authors. Comparisons between the original labels and INFLECT-informed FlowSOM metaclusters were made using tSNE embeddings, marker histograms, and concordance between original labels and INFLECT metaclusters are shown via matching matrixes (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figs. S5–S7, Additional file <xref rid="MOESM3" ref-type="media">3</xref>–5).</p>
      <p id="Par34">For the Bagwell dataset labels were determined by a published sequential gating strategy, though overlapping gates lead to events receiving multiple labels. INFLECT was able to identify a small population of CD16<sup>low</sup> and CD56<sup>high</sup> NK cells within the Early NK cell label (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S5C-D). Concordance between event labels and INFLECT metaclusters is summarized in Additional file <xref rid="MOESM3" ref-type="media">3</xref>.</p>
      <p id="Par35">Both datasets in the paper by Kimmey et al. were labeled by manually annotating a large number of SPADE clusters, 175 clusters for the bone marrow dataset and 150 clusters for the PBMC dataset. Concordance between event labels and INFLECT metaclusters are displayed in Additional file <xref rid="MOESM4" ref-type="media">4</xref> and 5, and visualized in Figs. S6 and S7 (Additional file <xref rid="MOESM1" ref-type="media">1</xref>). In both datasets INFLECT was again able to identify phenotypically distinct populations within labels.</p>
      <p id="Par36">Across all datasets considered in this work, the fraction of unimodal distributions reaches a plateau of diminishing returns. The start of this plateau can be determined by the L-function, providing an optimal metacluster number for the particular dataset.</p>
    </sec>
  </sec>
  <sec id="Sec14">
    <title>Discussion</title>
    <p id="Par37">In this work we outline the use of overall cluster unimodality as a quality control measurement for FlowSOM clustering results. The goal of clustering is to determine and enumerate unique cellular subsets, or in other words grouping cells with unimodal distributions in all markers. By using cluster unimodality this clustering process can be condensed to a single score for each set of FlowSOM results, collected in the Unimodality set <inline-formula id="IEq19"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${U}_{i}$$\end{document}</tex-math><mml:math id="M56"><mml:msub><mml:mi>U</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_5018_Article_IEq19.gif"/></alternatives></inline-formula>. The chosen datasets contain labels for known cell phenotypes through different analysis methods, each with its own advantages and assumptions. The datasets also vary in dimensionality and depth of phenotyping. This underscores the flexibility of INFLECT. The fraction of unimodal distributions for a dataset reaches a plateau, at an inflection point that is dependent on dataset size, number of markers, and expression patterns of markers. While use of marker unimodality has been described before in high-dimensional analysis [<xref ref-type="bibr" rid="CR11">11</xref>], many rely on Gaussian mixture modeling or expectation maximization [<xref ref-type="bibr" rid="CR28">28</xref>–<xref ref-type="bibr" rid="CR31">31</xref>]. These processes are computationally expensive, making them impractical for use in a quality control setting where we would want to evaluate iterative clustering runs. Moreover, unimodality testing through the dip test has been described as more stable and less prone to errors in literature [<xref ref-type="bibr" rid="CR19">19</xref>].</p>
    <p id="Par38">This work is inspired by quality control functions that are part of SPADEVizR [<xref ref-type="bibr" rid="CR18">18</xref>] and work on the L-function [<xref ref-type="bibr" rid="CR24">24</xref>]. The hyperparameters used in INFLECT, the threshold for interquartile range (set at <inline-formula id="IEq20"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$arcsinh(X/5)= 2$$\end{document}</tex-math><mml:math id="M58"><mml:mrow><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mi>c</mml:mi><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>h</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>X</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:mn>5</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_5018_Article_IEq20.gif"/></alternatives></inline-formula>) and the dip test (<inline-formula id="IEq21"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha = 0.05$$\end{document}</tex-math><mml:math id="M60"><mml:mrow><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mn>0.05</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_5018_Article_IEq21.gif"/></alternatives></inline-formula>) are the same as in SPADEVizR. When combined into INFLECT we show that they provide a data-driven metaclustering endpoint for FlowSOM. Though not investigated in this study, the application of INFLECT should work for any clustering method where the user can determine the number of resulting clusters. This can be either in cases where the number of clusters is used as input, such as SCAFFoLD [<xref ref-type="bibr" rid="CR32">32</xref>] or where the smallest acceptable cluster is determined as in Citrus [<xref ref-type="bibr" rid="CR12">12</xref>]. Additionally, there are methods where input from the user more indirectly affects cluster composition and total number of clusters, such as bandwidth selection in density-based clustering (ACCENSE [<xref ref-type="bibr" rid="CR33">33</xref>] or Gaussian mean shift-based clustering [<xref ref-type="bibr" rid="CR34">34</xref>]). INFLECT can be utilized to iteratively evaluate these input parameters aside from visual inspection of tSNE embeddings. These approaches come with the caveat that they likely require take a longer time to compute. The design of FlowSOM allows for low runtimes also for larger datasets [<xref ref-type="bibr" rid="CR21">21</xref>], making it very suitable for testing many iterations to determine the best clustering. Applying INFLECT to clustering algorithms other than FlowSOM was outside of the scope of this work and would have to be validated before implementation.</p>
    <p id="Par39">While INFLECT was developed for use in mass cytometry, the principle behind cluster unimodality would still hold true for high-dimensional cytometry techniques like spectral cytometry [<xref ref-type="bibr" rid="CR35">35</xref>] or high-parameter flow cytometry. However, extra care should be taken in pre-processing of the data regarding distributions around zero (and lower). Since mass cytometry has no negative values, the unimodality test is performed on positive distributions only. Unexpected minor cross-talk between markers in conventional flow cytometry could result in multi-modal negative peaks and will likely lead INFLECT to recommend an optimal cluster number that is too high [<xref ref-type="bibr" rid="CR36">36</xref>, <xref ref-type="bibr" rid="CR37">37</xref>]. The distributions of gene expressions in scRNA-seq data are not comparable to protein expression in mass cytometry. Therefore we do not expect INFLECT to provide a benefit when assessing the clustering results of single cell RNA sequencing (scRNA-seq) data.</p>
    <p id="Par40">When comparing INFLECT clustering with the cluster definitions as originally published for the dataset, the inflection point was consistently higher than the number of phenotypes determined by the authors. By visually inspecting histograms for representative INFLECT-metaclusters, we show that the clusters have distinct marker expression patterns. While it is unlikely that a wholly novel cell type is discovered, by splitting cell types into distinct sub-clusters INFLECT enumerates possible differentiation states or activation states. INFLECT thereby allows for differential abundance testing on these sub-clusters. However, it is still up to the researcher to determine if this cluster of events represents a biologically meaningful subset. For example the CD56<sup>bright</sup> population of NK cells identified within the BMMC dataset of Levine et al., while small, is an important subset with a distinct function in the immune system [<xref ref-type="bibr" rid="CR38">38</xref>]. The rationale for finding the data-driven endpoint of clustering is to limit the number of clusters, in turn to limit the number of statistical tests that will be performed and reduce occurrence of type 1 errors. Therefore, manually merging clusters that were found in an unsupervised manner is a valid strategy. The diagnostic curves provided by INFLECT can aid in this process, showing at what number of metaclusters cluster unimodality will drop dramatically.</p>
  </sec>
  <sec id="Sec15">
    <title>Conclusion</title>
    <p id="Par41">INFLECT addresses a knowledge gap in high-dimensional cytometry analysis, namely assessing clustering results. This is done through monitoring marker distributions for interquartile range and unimodality across a range of metacluster numbers. The fraction of unimodal distributions within metaclusters, collected in the Unimodality set <inline-formula id="IEq22"><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${U}_{i}$$\end{document}</tex-math><mml:math id="M62"><mml:msub><mml:mi>U</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_5018_Article_IEq22.gif"/></alternatives></inline-formula>, plotted versus the number of clusters consistently reaches a plateau, providing a data-driven endpoint for metacluster number. The inflection point is the optimal trade-off between cellular heterogeneity and statistical power, applied in this work for FlowSOM clustering on mass cytometry datasets.</p>
    <sec id="Sec16">
      <title>Availability and requirements</title>
      <p id="Par42">The computational method proposed in this work is collected in the R package “INFLECT” and made available on github at <ext-link ext-link-type="uri" xlink:href="http://www.github.com/jnverhoeff/GarciaVallejoLab">www.github.com/jnverhoeff/GarciaVallejoLab</ext-link>. Project name: INFLECT. Project home page: <ext-link ext-link-type="uri" xlink:href="https://www.github.com/jnverhoeff/GarciaVallejoLab">https://www.github.com/jnverhoeff/GarciaVallejoLab</ext-link>. Operating system(s): Platform independent. Programming language: R. Other requirements: R4.1.2. License: GNU GPLv3. Any restrictions to use by non-academics: license needed for commercial use.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Information</title>
    <sec id="Sec17">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="12859_2022_5018_MOESM1_ESM.pdf">
            <caption>
              <p><bold>Additional file 1: Supplementary Fig. S1:</bold> Marker performance for Levine32 INFLECT. Marker performance diagnostic plots for remaining markers of Levine32. On the <italic>x</italic>-axis the amount of FlowSOM-metaclusters, and on the <italic>y</italic>-axis the amount of metaclusters that pass the unimodality and interquartile range checks as a percentage of total metaclusters for the listed marker; <bold>Supplementary Fig. S2:</bold> All 15 repeats of 90% subsamples of Levine32. <bold>A</bold> L-function applied to the sigmoidal curve fitted to set<inline-formula id="IEq23"><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${U}_{i}$$\end{document}</tex-math><mml:math id="M64"><mml:msub><mml:mi>U</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_5018_Article_IEq23.gif"/></alternatives></inline-formula>. <bold>B</bold> L-function applied to the set <inline-formula id="IEq24"><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${U}_{i}$$\end{document}</tex-math><mml:math id="M66"><mml:msub><mml:mi>U</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_5018_Article_IEq24.gif"/></alternatives></inline-formula> itself. Resulting inflection points for both panels denoted with vertical dotted line; <bold>Supplementary Fig. S3:</bold> With fewer datapoints in Unimodality set <inline-formula id="IEq25"><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${U}_{i}$$\end{document}</tex-math><mml:math id="M68"><mml:msub><mml:mi>U</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_5018_Article_IEq25.gif"/></alternatives></inline-formula> INFLECT still produces a stable fitted sigmoidal curve. INFLECT diagnostic plots with different sizes of set <inline-formula id="IEq26"><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${U}_{i}$$\end{document}</tex-math><mml:math id="M70"><mml:msub><mml:mi>U</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_5018_Article_IEq26.gif"/></alternatives></inline-formula>, from 81 calculations down to 9 datapoints. Resulting inflection point is stable around 40 metaclusters. The values of the Unimodality set <inline-formula id="IEq27"><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${U}_{i}$$\end{document}</tex-math><mml:math id="M72"><mml:msub><mml:mi>U</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_5018_Article_IEq27.gif"/></alternatives></inline-formula> are plotted on the <italic>y</italic>-axis versus the number of metaclusters assessed on the <italic>x-</italic>axis; <bold>Supplementary Fig. S4:</bold> Traditional (meta)clustering evaluations perform poorly on Levine32 dataset. <bold>A</bold> Davies Bouldin (DB) Index on the <italic>y</italic>-axis versus the amount of FlowSOM-metaclusters. A lower score indicates better clustering. In this case the DB index does not form a plateau, making interpretation difficult. <bold>B</bold> Calinski-Harabasz (CH) Index on the <italic>y</italic>-axis versus the amount of FlowSOM-metaclusters. A higher score indicates better clustering. CH index drops with increasing FlowSOM-metaclusters, making CH index less suitable for evaluation. <bold>C</bold> Diagnostic plot of ConsensusClusterPlus on Levine32 dataset. Relative change in area under cumulative distribution function (CDF) curve compared to <inline-formula id="IEq28"><alternatives><tex-math id="M73">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k-1$$\end{document}</tex-math><mml:math id="M74"><mml:mrow><mml:mi>k</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_5018_Article_IEq28.gif"/></alternatives></inline-formula> clusters. FlowSOM implementation of ConsensusClusterPlus indicates 14 metaclusters as optimal<inline-formula id="IEq29"><alternatives><tex-math id="M75">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k$$\end{document}</tex-math><mml:math id="M76"><mml:mi>k</mml:mi></mml:math><inline-graphic xlink:href="12859_2022_5018_Article_IEq29.gif"/></alternatives></inline-formula>. <bold>D</bold> tSNE embedding of Levine32, colored for the 14 ConsensusClusterPlus metaclusters. Multiple islands (CD4 T cells, CD8 T cells and monocytes) are grouped into 1 large metacluster; <bold>Supplementary Fig. S5:</bold> INFLECT reveals heterogeneity within labeled phenotypes of the replicate PBMC dataset from Bagwell et al. <bold>A</bold> tSNE embedding of 10,000 events from Bagwell dataset. Colored for the 26 manually gated phenotypes, plus light-pink for unlabeled cells and yellow for events with 2 or more labels. <bold>B</bold> Histograms of selected markers highlighting heterogeneity within the Early NK cells. <italic>X</italic>-axis denote Arcsinh(x/5) transformed expression values. <bold>C</bold> Same tSNE embedding of 10,000 events as in <bold>A</bold>, here colored for the 52 INFLECT metaclusters. <bold>D</bold> Histograms of selected markers highlighting the difference between metacluster 24 and 29, which correspond to the 2 different cell populations within the Early NK label. <italic>X</italic>-axis denote Arcsinh(x/5) transformed expression values. Metacluster 29 is a smaller CD56<sup>bright</sup> CD16<sup>dim</sup> population, whereas metacluster 24 has high levels of CD16 and intermediate CD56 expression; <bold>Supplementary Fig. S6:</bold> INFLECT applied to bone marrow dataset from Kimmey et al. reveals high degree of heterogeneity. <bold>A</bold> tSNE embedding of 10,000 events from KimmeyBM dataset. Colors denote the labels identified by the authors. Immature B cells are highlighted in rectangle. <bold>B</bold> Histograms of selected markers highlighting heterogeneity within Immature B cells. <italic>X</italic>-axis denote Arcsinh(x/5) transformed expression values. <bold>C</bold> Same tSNE embedding as in <bold>A</bold>, now colored for the 74 INFLECT metaclusters. Highlighted in the rectangle are the 4 different metaclusters of the Immature B cells, which were separated into metaclusters 38, 41, 49, and 71. <bold>D</bold> Histograms of selected markers highlighting heterogeneity between the 4 metaclusters corresponding to the Immature B cell label. <italic>X</italic>-axis denote Arcsinh(x/5) transformed expression values. Metacluster 71 has a CD38<sup>+</sup> phenotype, metacluster 41 has a IgM<sup>dim</sup> phenotype and metaclusters 38 and 49 are differentiated in expression levels of CD24 and to a lesser extent CD45RA; <bold>Supplementary Fig. S7:</bold> INFLECT algorithm applied to PBMC dataset from Kimmey et al. captures underlying heterogeneity of labeled populations.<bold> A</bold> tSNE embedding of 10,000 events from KimmeyPBMC dataset. Colors denote the labels identified by the authors. Rectangle highlights the cDCs label. <bold>B</bold> Histograms of selected markers highlighting heterogeneity within the cDCs label. <italic>X</italic>-axis denote Arcsinh(x/5) transformed expression values. <bold>C</bold> Same tSNE embedding as in <bold>A</bold>, here colored for the 41 INFLECT metaclusters. In the rectangle the metaclusters 7 and 15 are highlighted, which correspond to the cDCs label. <bold>D</bold> Histograms of selected markers highlighting heterogeneity between metaclusters 7 and 15. Main difference between metaclusters 7 and 15 is the level of CD11c expression.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="12859_2022_5018_MOESM2_ESM.csv">
            <caption>
              <p><bold>Additional file 2:</bold> Matching matrix of Levine32 dataset.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM3">
          <media xlink:href="12859_2022_5018_MOESM3_ESM.csv">
            <caption>
              <p><bold>Additional file 3:</bold> Matching matrix of Bagwell dataset.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM4">
          <media xlink:href="12859_2022_5018_MOESM4_ESM.csv">
            <caption>
              <p><bold>Additional file 4:</bold> Matching matrix of Kimmey-BM dataset.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM5">
          <media xlink:href="12859_2022_5018_MOESM5_ESM.csv">
            <caption>
              <p><bold>Additional file 5:</bold> Matching matrix of Kimmey-PBMC dataset.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>QC</term>
        <def>
          <p id="Par4">Quality control</p>
        </def>
      </def-item>
      <def-item>
        <term>BMMC</term>
        <def>
          <p id="Par5">Bone marrow mononuclear cells</p>
        </def>
      </def-item>
      <def-item>
        <term>PBMC</term>
        <def>
          <p id="Par6">Peripheral blood mononuclear cell</p>
        </def>
      </def-item>
      <def-item>
        <term>NK</term>
        <def>
          <p id="Par7">Natural killer</p>
        </def>
      </def-item>
      <def-item>
        <term>SPADE</term>
        <def>
          <p id="Par8">Spanning-tree progression analysis of density-normalized events</p>
        </def>
      </def-item>
      <def-item>
        <term>scRNA-seq</term>
        <def>
          <p id="Par9">Cells, single cell RNA sequencing</p>
        </def>
      </def-item>
      <def-item>
        <term>tSNE</term>
        <def>
          <p id="Par10">T-distributed stochastic neighbor embedding</p>
        </def>
      </def-item>
      <def-item>
        <term>UMAP</term>
        <def>
          <p id="Par11">Uniform manifold approximation projection</p>
        </def>
      </def-item>
      <def-item>
        <term>SOM</term>
        <def>
          <p id="Par12">Self-organizing maps</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher's Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>We would like to thank Sofie van Gassen for fruitful discussions.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author contributions</title>
    <p>JV, and JJGV designed research; JV performed research; JV analysed data; JV, SA, and JJGV wrote the paper. All authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>This work was funded by the Cancer Center Amsterdam—Amsterdam UMC. The funding body had no influence the design of the study and collection, analysis, and interpretation of data and in writing the manuscript.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>The datasets supporting the conclusions of this article are available in the Flowrepository, Levine32 under FR-FCM-ZZPH at <ext-link ext-link-type="uri" xlink:href="http://flowrepository.org/id/FR-FCM-ZZPH">http://flowrepository.org/id/FR-FCM-ZZPH</ext-link>, both Kimmey et al<italic>.</italic> datasets under FR-FCM-ZYR5 at <ext-link ext-link-type="uri" xlink:href="http://flowrepository.org/id/FR-FCM-ZYR5">http://flowrepository.org/id/FR-FCM-ZYR5</ext-link>. The Bagwell et al<italic>.</italic> dataset is available on Cytobank, under Bagwell et al. at <ext-link ext-link-type="uri" xlink:href="http://premium.cytobank.org/cytobank/experiments/221569">http://premium.cytobank.org/cytobank/experiments/221569</ext-link>.</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar1">
      <title>Ethics approval and consent to participate</title>
      <p id="Par43">Not applicable.</p>
    </notes>
    <notes id="FPar2">
      <title>Consent for publication</title>
      <p id="Par44">Not applicable.</p>
    </notes>
    <notes id="FPar3" notes-type="COI-statement">
      <title>Competing interests</title>
      <p id="Par45">The authors declare that they have no competing interests.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mair</surname>
            <given-names>F</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The end of gating? An introduction to automated analysis of high dimensional cytometry data</article-title>
        <source>Eur J Immunol</source>
        <year>2016</year>
        <volume>46</volume>
        <issue>1</issue>
        <fpage>34</fpage>
        <lpage>43</lpage>
        <pub-id pub-id-type="doi">10.1002/eji.201545774</pub-id>
        <?supplied-pmid 26548301?>
        <pub-id pub-id-type="pmid">26548301</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Saeys</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Van Gassen</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Lambrecht</surname>
            <given-names>BN</given-names>
          </name>
        </person-group>
        <article-title>Computational flow cytometry: helping to make sense of high-dimensional immunology data</article-title>
        <source>Nat Rev Immunol</source>
        <year>2016</year>
        <volume>16</volume>
        <issue>7</issue>
        <fpage>449</fpage>
        <lpage>462</lpage>
        <pub-id pub-id-type="doi">10.1038/nri.2016.56</pub-id>
        <?supplied-pmid 27320317?>
        <pub-id pub-id-type="pmid">27320317</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <mixed-citation publication-type="other">Kaushik A et al. A novel workflow for semi-supervised annotation of cell-type clusters in mass cytometry data. In: Proceedings of the 10th ACM International Conference on Bioinformatics, Computational Biology and Health Informatics. 2019.</mixed-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ludwig</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>flowEMMi: an automated model-based clustering tool for microbial cytometric data</article-title>
        <source>BMC Bioinform</source>
        <year>2019</year>
        <volume>20</volume>
        <issue>1</issue>
        <fpage>643</fpage>
        <pub-id pub-id-type="doi">10.1186/s12859-019-3152-3</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Minoura</surname>
            <given-names>K</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Model-based cell clustering and population tracking for time-series flow cytometry data</article-title>
        <source>BMC Bioinform</source>
        <year>2019</year>
        <volume>20</volume>
        <issue>23</issue>
        <fpage>633</fpage>
        <pub-id pub-id-type="doi">10.1186/s12859-019-3294-3</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Weber</surname>
            <given-names>LM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>diffcyt: Differential discovery in high-dimensional cytometry via high-resolution clustering</article-title>
        <source>Commun Biol</source>
        <year>2019</year>
        <volume>2</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>11</lpage>
        <pub-id pub-id-type="doi">10.1038/s42003-019-0415-5</pub-id>
        <pub-id pub-id-type="pmid">30740537</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ye</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Ho</surname>
            <given-names>JWK</given-names>
          </name>
        </person-group>
        <article-title>Ultrafast clustering of single-cell flow cytometry data using FlowGrid</article-title>
        <source>BMC Syst Biol</source>
        <year>2019</year>
        <volume>13</volume>
        <issue>Suppl 2</issue>
        <fpage>35</fpage>
        <lpage>35</lpage>
        <pub-id pub-id-type="doi">10.1186/s12918-019-0690-2</pub-id>
        <?supplied-pmid 30953498?>
        <pub-id pub-id-type="pmid">30953498</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Orlova</surname>
            <given-names>DY</given-names>
          </name>
          <name>
            <surname>Herzenberg</surname>
            <given-names>LA</given-names>
          </name>
          <name>
            <surname>Walther</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Science not art: statistically sound methods for identifying subsets in multi-dimensional flow and mass cytometry data sets</article-title>
        <source>Nat Rev Immunol</source>
        <year>2018</year>
        <volume>18</volume>
        <issue>1</issue>
        <fpage>77</fpage>
        <lpage>77</lpage>
        <pub-id pub-id-type="doi">10.1038/nri.2017.150</pub-id>
        <pub-id pub-id-type="pmid">29379190</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Saeys</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Van Gassen</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Lambrecht</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Response to Orlova et al. “Science not art: Statistically sound methods for identifying subsets in multi-dimensional flow and mass cytometry data sets”</article-title>
        <source>Nat Rev Immunol</source>
        <year>2018</year>
        <volume>18</volume>
        <issue>1</issue>
        <fpage>78</fpage>
        <pub-id pub-id-type="doi">10.1038/nri.2017.151</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Levine</surname>
            <given-names>JH</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Data-driven phenotypic dissection of AML reveals progenitor-like cells that correlate with prognosis</article-title>
        <source>Cell</source>
        <year>2015</year>
        <volume>162</volume>
        <issue>1</issue>
        <fpage>184</fpage>
        <lpage>197</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2015.05.047</pub-id>
        <?supplied-pmid 26095251?>
        <pub-id pub-id-type="pmid">26095251</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Naim</surname>
            <given-names>I</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>SWIFT—scalable clustering for automated identification of rare cell populations in large, high-dimensional flow cytometry datasets, Part 1: Algorithm design</article-title>
        <source>Cytometry A</source>
        <year>2014</year>
        <volume>85</volume>
        <issue>5</issue>
        <fpage>408</fpage>
        <lpage>421</lpage>
        <pub-id pub-id-type="doi">10.1002/cyto.a.22446</pub-id>
        <?supplied-pmid 24677621?>
        <pub-id pub-id-type="pmid">24677621</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bruggner</surname>
            <given-names>RV</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Automated identification of stratifying signatures in cellular subpopulations</article-title>
        <source>Proc Natl Acad Sci</source>
        <year>2014</year>
        <volume>111</volume>
        <issue>26</issue>
        <fpage>E2770</fpage>
        <lpage>E2777</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.1408792111</pub-id>
        <?supplied-pmid 24979804?>
        <pub-id pub-id-type="pmid">24979804</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Guo</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Mass cytometry analysis reveals a distinct immune environment in peritoneal fluid in endometriosis: a characterisation study</article-title>
        <source>BMC Med</source>
        <year>2020</year>
        <volume>18</volume>
        <issue>1</issue>
        <fpage>3</fpage>
        <pub-id pub-id-type="doi">10.1186/s12916-019-1470-y</pub-id>
        <?supplied-pmid 31907005?>
        <pub-id pub-id-type="pmid">31907005</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kothari</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Identification of human immune cell subtypes most responsive to IL-1beta-induced inflammatory signaling using mass cytometry</article-title>
        <source>Sci Signal</source>
        <year>2021</year>
        <volume>14</volume>
        <issue>673</issue>
        <fpage>5763</fpage>
        <pub-id pub-id-type="doi">10.1126/scisignal.abc5763</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wong</surname>
            <given-names>MT</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Mapping the diversity of follicular helper T cells in human blood and tonsils using high-dimensional mass cytometry analysis</article-title>
        <source>Cell Rep</source>
        <year>2015</year>
        <volume>11</volume>
        <issue>11</issue>
        <fpage>1822</fpage>
        <lpage>1833</lpage>
        <pub-id pub-id-type="doi">10.1016/j.celrep.2015.05.022</pub-id>
        <?supplied-pmid 26074076?>
        <pub-id pub-id-type="pmid">26074076</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bengsch</surname>
            <given-names>B</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Epigenomic-guided mass cytometry profiling reveals disease-specific features of exhausted CD8 T cells</article-title>
        <source>Immunity</source>
        <year>2018</year>
        <volume>48</volume>
        <issue>5</issue>
        <fpage>1029</fpage>
        <lpage>1045.e5</lpage>
        <pub-id pub-id-type="doi">10.1016/j.immuni.2018.04.026</pub-id>
        <?supplied-pmid 29768164?>
        <pub-id pub-id-type="pmid">29768164</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Patel</surname>
            <given-names>AJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Regulatory B cell repertoire defects predispose lung cancer patients to immune-related toxicity following checkpoint blockade</article-title>
        <source>Nat Commun</source>
        <year>2022</year>
        <volume>13</volume>
        <issue>1</issue>
        <fpage>3148</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-022-30863-x</pub-id>
        <?supplied-pmid 35672305?>
        <pub-id pub-id-type="pmid">35672305</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gautreau</surname>
            <given-names>G</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>SPADEVizR: an R package for visualization, analysis and integration of SPADE results</article-title>
        <source>Bioinformatics</source>
        <year>2016</year>
        <volume>33</volume>
        <issue>5</issue>
        <fpage>779</fpage>
        <lpage>781</lpage>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Johnsson</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Linderoth</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Fontes</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>What is a "unimodal" cell population? Using statistical tests as criteria for unimodality in automated gating and quality control</article-title>
        <source>Cytometry A</source>
        <year>2017</year>
        <volume>91</volume>
        <issue>9</issue>
        <fpage>908</fpage>
        <lpage>916</lpage>
        <pub-id pub-id-type="doi">10.1002/cyto.a.23173</pub-id>
        <?supplied-pmid 28759711?>
        <pub-id pub-id-type="pmid">28759711</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Van Gassen</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>FlowSOM: Using self-organizing maps for visualization and interpretation of cytometry data</article-title>
        <source>Cytometry A</source>
        <year>2015</year>
        <volume>87</volume>
        <issue>7</issue>
        <fpage>636</fpage>
        <lpage>645</lpage>
        <pub-id pub-id-type="doi">10.1002/cyto.a.22625</pub-id>
        <?supplied-pmid 25573116?>
        <pub-id pub-id-type="pmid">25573116</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Weber</surname>
            <given-names>LM</given-names>
          </name>
          <name>
            <surname>Robinson</surname>
            <given-names>MD</given-names>
          </name>
        </person-group>
        <article-title>Comparison of clustering methods for high-dimensional single-cell flow and mass cytometry data</article-title>
        <source>Cytometry A</source>
        <year>2016</year>
        <volume>89</volume>
        <issue>12</issue>
        <fpage>1084</fpage>
        <lpage>1096</lpage>
        <pub-id pub-id-type="doi">10.1002/cyto.a.23030</pub-id>
        <?supplied-pmid 27992111?>
        <pub-id pub-id-type="pmid">27992111</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hartigan</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Hartigan</surname>
            <given-names>PM</given-names>
          </name>
        </person-group>
        <article-title>The dip test of unimodality</article-title>
        <source>Ann Stat</source>
        <year>1985</year>
        <volume>13</volume>
        <issue>1</issue>
        <fpage>70</fpage>
        <lpage>84</lpage>
        <pub-id pub-id-type="doi">10.1214/aos/1176346577</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wilkerson</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>Hayes</surname>
            <given-names>DN</given-names>
          </name>
        </person-group>
        <article-title>ConsensusClusterPlus: a class discovery tool with confidence assessments and item tracking</article-title>
        <source>Bioinformatics (Oxford, England)</source>
        <year>2010</year>
        <volume>26</volume>
        <issue>12</issue>
        <fpage>1572</fpage>
        <lpage>1573</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btq170</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <mixed-citation publication-type="other">Salvador SC, Philip. Determining the number of clusters/segments in hierarchical clustering/segmentation algorithms.</mixed-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kimmey</surname>
            <given-names>SC</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Parallel analysis of tri-molecular biosynthesis with cell identity and function in single cells</article-title>
        <source>Nat Commun</source>
        <year>2019</year>
        <volume>10</volume>
        <issue>1</issue>
        <fpage>1185</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-019-09128-7</pub-id>
        <?supplied-pmid 30862852?>
        <pub-id pub-id-type="pmid">30862852</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bagwell</surname>
            <given-names>CB</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Multi-site reproducibility of a human immunophenotyping assay in whole blood and peripheral blood mononuclear cells preparations using CyTOF technology coupled with Maxpar Pathsetter, an automated data analysis system</article-title>
        <source>Cytometry B Clin Cytom.</source>
        <year>2020</year>
        <volume>98</volume>
        <issue>2</issue>
        <fpage>146</fpage>
        <lpage>160</lpage>
        <pub-id pub-id-type="doi">10.1002/cyto.b.21858</pub-id>
        <?supplied-pmid 31758746?>
        <pub-id pub-id-type="pmid">31758746</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>X</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A comparison framework and guideline of clustering methods for mass cytometry data</article-title>
        <source>Genome Biol</source>
        <year>2019</year>
        <volume>20</volume>
        <issue>1</issue>
        <fpage>297</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-019-1917-7</pub-id>
        <?supplied-pmid 31870419?>
        <pub-id pub-id-type="pmid">31870419</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sörensen</surname>
            <given-names>T</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>immunoClust—an automated analysis pipeline for the identification of immunophenotypic signatures in high-dimensional cytometric datasets</article-title>
        <source>Cytometry A</source>
        <year>2015</year>
        <volume>87</volume>
        <issue>7</issue>
        <fpage>603</fpage>
        <lpage>615</lpage>
        <pub-id pub-id-type="doi">10.1002/cyto.a.22626</pub-id>
        <?supplied-pmid 25850678?>
        <pub-id pub-id-type="pmid">25850678</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Boedigheimer</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Ferbas</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Mixture modeling approach to flow cytometry data</article-title>
        <source>Cytometry A</source>
        <year>2008</year>
        <volume>73A</volume>
        <issue>5</issue>
        <fpage>421</fpage>
        <lpage>429</lpage>
        <pub-id pub-id-type="doi">10.1002/cyto.a.20553</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chan</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Statistical mixture modeling for cell subtype identification in flow cytometry</article-title>
        <source>Cytometry A</source>
        <year>2008</year>
        <volume>73A</volume>
        <issue>8</issue>
        <fpage>693</fpage>
        <lpage>701</lpage>
        <pub-id pub-id-type="doi">10.1002/cyto.a.20583</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ge</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Sealfon</surname>
            <given-names>SC</given-names>
          </name>
        </person-group>
        <article-title>flowPeaks: a fast unsupervised clustering for flow cytometry data via K-means and density peak finding</article-title>
        <source>Bioinformatics (Oxford, England)</source>
        <year>2012</year>
        <volume>28</volume>
        <issue>15</issue>
        <fpage>2052</fpage>
        <lpage>2058</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bts300</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Spitzer</surname>
            <given-names>MH</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>An interactive reference framework for modeling a dynamic immune system</article-title>
        <source>Science</source>
        <year>2015</year>
        <volume>349</volume>
        <issue>6244</issue>
        <fpage>1259425</fpage>
        <pub-id pub-id-type="doi">10.1126/science.1259425</pub-id>
        <?supplied-pmid 26160952?>
        <pub-id pub-id-type="pmid">26160952</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shekhar</surname>
            <given-names>K</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Automatic classification of cellular expression by nonlinear stochastic embedding (ACCENSE)</article-title>
        <source>Proc Natl Acad Sci</source>
        <year>2014</year>
        <volume>111</volume>
        <issue>1</issue>
        <fpage>202</fpage>
        <lpage>207</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.1321405111</pub-id>
        <?supplied-pmid 24344260?>
        <pub-id pub-id-type="pmid">24344260</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>van Unen</surname>
            <given-names>V</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Visual analysis of mass cytometry data by hierarchical stochastic neighbour embedding reveals rare cell types</article-title>
        <source>Nat Commun</source>
        <year>2017</year>
        <volume>8</volume>
        <issue>1</issue>
        <fpage>1740</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-017-01689-9</pub-id>
        <?supplied-pmid 29170529?>
        <pub-id pub-id-type="pmid">29170529</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Robinson</surname>
            <given-names>JP</given-names>
          </name>
        </person-group>
        <article-title>Multispectral cytometry: the next generation</article-title>
        <source>Biophoton Int</source>
        <year>2004</year>
        <volume>2004</volume>
        <fpage>36</fpage>
        <lpage>40</lpage>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Folcarelli</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Transformation of multicolour flow cytometry data with OTflow prevents misleading multivariate analysis results and incorrect immunological conclusions</article-title>
        <source>Cytometry A</source>
        <year>2022</year>
        <volume>101</volume>
        <issue>1</issue>
        <fpage>72</fpage>
        <lpage>85</lpage>
        <pub-id pub-id-type="doi">10.1002/cyto.a.24491</pub-id>
        <?supplied-pmid 34327803?>
        <pub-id pub-id-type="pmid">34327803</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Azad</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Rajwa</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Pothen</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>flowVS: channel-specific variance stabilization in flow cytometry</article-title>
        <source>BMC Bioinform</source>
        <year>2016</year>
        <volume>17</volume>
        <issue>1</issue>
        <fpage>291</fpage>
        <pub-id pub-id-type="doi">10.1186/s12859-016-1083-9</pub-id>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Poli</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>CD56bright natural killer (NK) cells: an important NK cell subset</article-title>
        <source>Immunology</source>
        <year>2009</year>
        <volume>126</volume>
        <issue>4</issue>
        <fpage>458</fpage>
        <lpage>465</lpage>
        <pub-id pub-id-type="doi">10.1111/j.1365-2567.2008.03027.x</pub-id>
        <?supplied-pmid 19278419?>
        <pub-id pub-id-type="pmid">19278419</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
