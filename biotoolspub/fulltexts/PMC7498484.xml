<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Neuroinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Neuroinformatics</journal-id>
    <journal-title-group>
      <journal-title>Neuroinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1539-2791</issn>
    <issn pub-type="epub">1559-0089</issn>
    <publisher>
      <publisher-name>Springer US</publisher-name>
      <publisher-loc>New York</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7498484</article-id>
    <article-id pub-id-type="publisher-id">9456</article-id>
    <article-id pub-id-type="doi">10.1007/s12021-020-09456-w</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>NeAT: a Nonlinear Analysis Toolbox for Neuroimaging</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Casamitjana</surname>
          <given-names>Adrià</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Vilaplana</surname>
          <given-names>Verónica</given-names>
        </name>
        <address>
          <email>veronica.vilaplana@upc.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Puch</surname>
          <given-names>Santi</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Aduriz</surname>
          <given-names>Asier</given-names>
        </name>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>López</surname>
          <given-names>Carlos</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Operto</surname>
          <given-names>Grégory</given-names>
        </name>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Cacciaglia</surname>
          <given-names>Raffaele</given-names>
        </name>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Falcón</surname>
          <given-names>Carles</given-names>
        </name>
        <xref ref-type="aff" rid="Aff4">4</xref>
        <xref ref-type="aff" rid="Aff5">5</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Molinuevo</surname>
          <given-names>José Luis</given-names>
        </name>
        <xref ref-type="aff" rid="Aff4">4</xref>
        <xref ref-type="aff" rid="Aff6">6</xref>
        <xref ref-type="aff" rid="Aff7">7</xref>
        <xref ref-type="aff" rid="Aff8">8</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Gispert</surname>
          <given-names>Juan Domingo</given-names>
        </name>
        <address>
          <email>jdgispert@barcelonabeta.org</email>
        </address>
        <xref ref-type="aff" rid="Aff4">4</xref>
        <xref ref-type="aff" rid="Aff7">7</xref>
        <xref ref-type="aff" rid="Aff8">8</xref>
        <xref ref-type="aff" rid="Aff9">9</xref>
      </contrib>
      <contrib contrib-type="author">
        <collab>for the Alzheimer’s Disease Neuroimaging Initiative</collab>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.6835.8</institution-id><institution>Department of Signal Theory and Communications, </institution><institution>Universitat Politècnica de Catalunya (UPC), </institution></institution-wrap>Barcelona, Spain </aff>
      <aff id="Aff2"><label>2</label>QMENTA, Barcelona, Spain </aff>
      <aff id="Aff3"><label>3</label>Vilynx, Barcelona, Spain </aff>
      <aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="GRID">grid.430077.7</institution-id><institution>BarcelonaBeta Brain Research Center (BBRC), </institution><institution>Pasqual Maragall Foundation, </institution></institution-wrap>Barcelona, Spain </aff>
      <aff id="Aff5"><label>5</label><institution-wrap><institution-id institution-id-type="GRID">grid.10403.36</institution-id><institution>Alzheimer’s Disease and Other Cognitive Disorders Unit, Hospital Clínic, </institution><institution>Institut d’Investigacions Biomèdiques August Pi i Sunyer (IDIBAPS), </institution></institution-wrap>Barcelona, Spain </aff>
      <aff id="Aff6"><label>6</label>CIBER Fragilidad y Envejecimiento Saludable (CIBERFES), Madrid, Spain </aff>
      <aff id="Aff7"><label>7</label><institution-wrap><institution-id institution-id-type="GRID">grid.5612.0</institution-id><institution-id institution-id-type="ISNI">0000 0001 2172 2676</institution-id><institution>Universitat Pompeu Fabra, </institution></institution-wrap>Barcelona, Spain </aff>
      <aff id="Aff8"><label>8</label><institution-wrap><institution-id institution-id-type="GRID">grid.411142.3</institution-id><institution-id institution-id-type="ISNI">0000 0004 1767 8811</institution-id><institution>IMIM (Hospital del Mar Medical Research Institute), </institution></institution-wrap>Barcelona, Spain </aff>
      <aff id="Aff9"><label>9</label><institution-wrap><institution-id institution-id-type="GRID">grid.413448.e</institution-id><institution-id institution-id-type="ISNI">0000 0000 9314 1427</institution-id><institution>Centro de Investigación Biomédica en Red de Bioingeniería, </institution><institution>Biomateriales y Nanomedicina (CIBER-BBN), </institution></institution-wrap>Madrid, Spain </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>24</day>
      <month>3</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>24</day>
      <month>3</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="ppub">
      <year>2020</year>
    </pub-date>
    <volume>18</volume>
    <issue>4</issue>
    <fpage>517</fpage>
    <lpage>530</lpage>
    <permissions>
      <copyright-statement>© The Author(s) 2020</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1">NeAT is a modular, flexible and user-friendly neuroimaging analysis toolbox for modeling linear and nonlinear effects overcoming the limitations of the standard neuroimaging methods which are solely based on linear models. NeAT provides a wide range of statistical and machine learning non-linear methods for model estimation, several metrics based on curve fitting and complexity for model inference and a graphical user interface (GUI) for visualization of results. We illustrate its usefulness on two study cases where non-linear effects have been previously established. Firstly, we study the nonlinear effects of Alzheimer’s disease on brain morphology (volume and cortical thickness). Secondly, we analyze the effect of the apolipoprotein APOE-ε4 genotype on brain aging and its interaction with age. NeAT is fully documented and publicly distributed at <ext-link ext-link-type="uri" xlink:href="https://imatge-upc.github.io/neat-tool/"><underline>https://imatge-upc.github.io/neat-tool/</underline></ext-link>.</p>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>nonlinear</kwd>
      <kwd>neuroimaging</kwd>
      <kwd>GLM</kwd>
      <kwd>GAM</kwd>
      <kwd>SVR</kwd>
      <kwd>Alzheimer's disease</kwd>
      <kwd>inference</kwd>
      <kwd>APOE</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100011033</institution-id>
            <institution>Agencia Estatal de Investigación</institution>
          </institution-wrap>
        </funding-source>
        <award-id>TEC2016- 75976-R</award-id>
        <principal-award-recipient>
          <name>
            <surname>Vilaplana</surname>
            <given-names>Verónica</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100003176</institution-id>
            <institution>Ministerio de Educación, Cultura y Deporte</institution>
          </institution-wrap>
        </funding-source>
        <award-id>FPU014/05988</award-id>
        <principal-award-recipient>
          <name>
            <surname>Casamitjana</surname>
            <given-names>Adrià</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100007136</institution-id>
            <institution>Secretaría de Estado de Investigación, Desarrollo e Innovación</institution>
          </institution-wrap>
        </funding-source>
        <award-id>RYC-2013-13054</award-id>
        <principal-award-recipient>
          <name>
            <surname>Gispert</surname>
            <given-names>Juan Domingo</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© Springer Science+Business Media, LLC, part of Springer Nature 2020</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Introduction</title>
    <p id="Par2">The increase of computational power and advances in neuroimaging acquisition that enable faster scans and provide multiple image contrasts and modalities has motivated the development of complex modeling techniques for imaging data. An armoury of neuroimaging analysis tools is available to the neuroscientific community, whose ultimate goal is to conduct statistical tests to identify significant effects in the images without any a priori hypothesis on the location or extent of these effects. In the literature, analysis at different levels of brain morphometry are found, involving voxel-based (Penny et al. <xref ref-type="bibr" rid="CR32">2011</xref>), surface-based (Fischl <xref ref-type="bibr" rid="CR11">2012</xref>) or boundary-based analysis (Freeborough and Fox <xref ref-type="bibr" rid="CR15">1997</xref>).</p>
    <p id="Par3">Irrespective of their particular characteristics, the vast majority of them perform statistical inference upon different implementations of the General Linear Model (GLM). GLM has been shown to be flexible enough for conducting most of the typical statistical analysis (Friston et al. <xref ref-type="bibr" rid="CR16">1994</xref>). However, it has a rather limited capability to model nonlinear effects. In this regard, it is worth noting that linear models have been reported not to be sufficient to fully describe cerebral structural variation with cognitive decline (Samtani et al. <xref ref-type="bibr" rid="CR36">2012</xref>; Mendiondo et al. <xref ref-type="bibr" rid="CR27">2000</xref>) or associated to pathological progression in neurodegenerative disease (Villemagne et al. <xref ref-type="bibr" rid="CR39">2013</xref>; Insel et al. <xref ref-type="bibr" rid="CR22">2017</xref>; Insel et al. <xref ref-type="bibr" rid="CR21">2015</xref>; Sabuncu et al. <xref ref-type="bibr" rid="CR34">2011</xref>; Schuff et al. <xref ref-type="bibr" rid="CR37">2012</xref>; Bateman et al. <xref ref-type="bibr" rid="CR2">2012</xref>; Gispert et al. <xref ref-type="bibr" rid="CR17">2015</xref>). Moreover, many relevant confounders in neuroimaging are shown to be better described by nonlinear processes, such as the impact of aging on cognitive decline (Kornak et al. <xref ref-type="bibr" rid="CR26">2018</xref>) or gray-matter volume (Fjell et al. <xref ref-type="bibr" rid="CR13">2013</xref>). Under the GLM, the modeling of non-linear effects is limited to using polynomial expansion or transforming the variables of interest to linearize their effects. However, such approximations are suboptimal (Fjell et al. <xref ref-type="bibr" rid="CR12">2010</xref>; Vinke et al. <xref ref-type="bibr" rid="CR40">2018</xref>; Ziegler et al. <xref ref-type="bibr" rid="CR41">2012</xref>). On the other hand, a wide range of non-linear modeling methods have been developed but specific implementations that enable the unbiased analysis of neuroimaging data are lacking (Breeze et al. <xref ref-type="bibr" rid="CR3">2012</xref>).</p>
    <p id="Par4">In this work, we describe a new analytic toolbox which is able to model nonlinear effects on brain scansat the voxel-wise level as well as for surface data. We pool together several nonlinear parametric models, provide different model comparison strategies and implement a graphical user interface (GUI) for visualization purposes. In the following sections we briefly describe the main functionalities of the toolbox and illustrate its features with two studies: (i) nonlinear atrophy patterns across the Alzheimer’s disease continuum defined as a function of cerebrospinal fluid (CSF) biomarkers (Gispert et al. <xref ref-type="bibr" rid="CR17">2015</xref>) and (ii) the effects of apolipoprotein E4 genotype on brain aging, a risk factor to develop sporadic Alzheimer’s disease (AD) (Cacciaglia et al. <xref ref-type="bibr" rid="CR6">2018</xref>).</p>
  </sec>
  <sec id="Sec2">
    <title>Material and Methods</title>
    <p id="Par5">A general overview of the tool operatibility and its options and functionalities are introduced in this section. A detailed mathematical description of the curve fitting methods and statistical inference metrics is provided, even though the reader is encouraged to read the original sources for a more deep understanding of such methods. More instructions on how to download and use the tool can be found in <ext-link ext-link-type="uri" xlink:href="https://imatge-upc.github.io/neat-tool/">https://imatge-upc.github.io/neat-tool/</ext-link>.</p>
    <sec id="Sec3">
      <title>NeAT Overview</title>
      <p id="Par6">The NeAT toolbox is a modular and easy-to-use toolbox for the analysis of non-linear effects on medical brain images. Several curve fitting methods are used to model the relationship between certain factors (e.g: age, disease phenotype, genotype) and pre-processed scans. Any image modality that has been spatially normalized and is ready for voxelwise analysis can be submitted to NeAT (e.g: Normalized VBM modulated images (Ashburner and Friston <xref ref-type="bibr" rid="CR1">2000</xref>) or FDG PET scans (Frackowiak et al. <xref ref-type="bibr" rid="CR14">1980</xref>)), as well as cortical thickness data resulting from Freesurfer processing (Fischl <xref ref-type="bibr" rid="CR11">2012</xref>). Those methods may include multiple covariates (factors) that can be split into confounder factors and variables of interest by using contrasts. A simple preprocessing step allows to orthogonalize, orthonormalize or simply normalize all covariates. A wide range of metrics can be used to assess the goodness of fit of each model. Statistical inference also allows the use of contrasts on modeling factors. The embedded 3D visualization GUI provides a unified and interactive environment to visualize both 3D statistical inference maps and the estimated curve at each voxel.</p>
      <p id="Par7">A high-level overview of the toolbox pipeline is provided in Fig. <xref rid="Fig1" ref-type="fig">1</xref>. It consists of several interdependent modules connected through a Processing library that performs serialization between functionalities. Each other module (Curve Fitting, Fit Evaluation and Visualization) is designed separately using abstract classes that facilitate both continuous adaptation and possible extensions of the toolbox. A description of each module/ functionality is detailed in the following sections.<fig id="Fig1"><label>Fig. 1</label><caption><p>Toolbox pipeline. The <italic>Processing</italic> module govern the interaction between all other libraries that will be explained through the manuscript</p></caption><graphic xlink:href="12021_2020_9456_Fig1_HTML" id="MO1"/></fig></p>
    </sec>
    <sec id="Sec4">
      <title>Model Estimation</title>
      <p id="Par8">The model estimation step (Curve Fitting module) is in charge of finding a parametric function of several explanatory variables that best fits the observations in terms of maximizing a quality metric or minimizing a loss function. Different specification of the latter two give rise to different models or fitters. To analyze the basics of each fitter, we consider the regression model<disp-formula id="Equa"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ Y=f(X)+E $$\end{document}</tex-math><mml:math id="M2" display="block"><mml:mi>Y</mml:mi><mml:mo>=</mml:mo><mml:mi>f</mml:mi><mml:mfenced close=")" open="("><mml:mi>X</mml:mi></mml:mfenced><mml:mo>+</mml:mo><mml:mi>E</mml:mi></mml:math><graphic xlink:href="12021_2020_9456_Article_Equa.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq1"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ Y=\left[{y}^1,{y}^2,\dots, {y}^N\ \right]\in {\mathfrak{R}}^{LxN} $$\end{document}</tex-math><mml:math id="M4" display="inline"><mml:mi>Y</mml:mi><mml:mo>=</mml:mo><mml:mfenced close="]" open="[" separators=",,,"><mml:msup><mml:mi>y</mml:mi><mml:mn>1</mml:mn></mml:msup><mml:msup><mml:mi>y</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>…</mml:mo><mml:mrow><mml:msup><mml:mi>y</mml:mi><mml:mi>N</mml:mi></mml:msup><mml:mspace width="0.25em"/></mml:mrow></mml:mfenced><mml:mo>∈</mml:mo><mml:msup><mml:mi mathvariant="fraktur">R</mml:mi><mml:mi mathvariant="italic">LxN</mml:mi></mml:msup><mml:mspace width="0.25em"/></mml:math><inline-graphic xlink:href="12021_2020_9456_Article_IEq1.gif"/></alternatives></inline-formula> are the N dependent observations (e.g. number of voxels), <inline-formula id="IEq2"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ X=\left[{x}_1,{x}_2,\dots, {x}_M\ \right]\in {\mathfrak{R}}^{LxM} $$\end{document}</tex-math><mml:math id="M6" display="inline"><mml:mi>X</mml:mi><mml:mo>=</mml:mo><mml:mfenced close="]" open="[" separators=",,,"><mml:msub><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>…</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>M</mml:mi></mml:msub><mml:mspace width="0.25em"/></mml:mrow></mml:mfenced><mml:mo>∈</mml:mo><mml:msup><mml:mi mathvariant="fraktur">R</mml:mi><mml:mi mathvariant="italic">LxM</mml:mi></mml:msup></mml:math><inline-graphic xlink:href="12021_2020_9456_Article_IEq2.gif"/></alternatives></inline-formula> are the M independent factors constant for all observations, <inline-formula id="IEq3"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ f(X)\in {\mathfrak{R}}^{LxN} $$\end{document}</tex-math><mml:math id="M8" display="inline"><mml:mi>f</mml:mi><mml:mfenced close=")" open="("><mml:mi>X</mml:mi></mml:mfenced><mml:mo>∈</mml:mo><mml:msup><mml:mi mathvariant="fraktur">R</mml:mi><mml:mi mathvariant="italic">LxN</mml:mi></mml:msup></mml:math><inline-graphic xlink:href="12021_2020_9456_Article_IEq3.gif"/></alternatives></inline-formula> is the fitted curve and <inline-formula id="IEq4"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ E=\left[{e}^1,{e}^2,\dots, {e}^N\ \right]\in {\mathfrak{R}}^{LxN} $$\end{document}</tex-math><mml:math id="M10" display="inline"><mml:mi>E</mml:mi><mml:mo>=</mml:mo><mml:mfenced close="]" open="[" separators=",,,"><mml:msup><mml:mi>e</mml:mi><mml:mn>1</mml:mn></mml:msup><mml:msup><mml:mi>e</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>…</mml:mo><mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mi>N</mml:mi></mml:msup><mml:mspace width="0.25em"/></mml:mrow></mml:mfenced><mml:mo>∈</mml:mo><mml:msup><mml:mi mathvariant="fraktur">R</mml:mi><mml:mi mathvariant="italic">LxN</mml:mi></mml:msup></mml:math><inline-graphic xlink:href="12021_2020_9456_Article_IEq4.gif"/></alternatives></inline-formula> is the estimation noise. Each input variable (<italic>y</italic><sup><italic>i</italic></sup>, <italic>x</italic><sub>1</sub>, …, <italic>x</italic><sub><italic>M</italic></sub>) is an L-dimensional vector corresponding to different measures (e.g. different subjects) of the same magnitude. Each covariate can be independently entered and the overall estimated model is found by adding up the contribution of each one:<disp-formula id="Equb"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \hat{y}={\sum}_{m=1}^M{f}_m\left({x}_m\right) $$\end{document}</tex-math><mml:math id="M12" display="block"><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>M</mml:mi></mml:msubsup><mml:msub><mml:mi>f</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:msub><mml:mi>x</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mfenced></mml:math><graphic xlink:href="12021_2020_9456_Article_Equb.gif" position="anchor"/></alternatives></disp-formula>being f<sub>m</sub>(x<sub>m</sub>) the associated curve fitting method for each covariate. The available methods.</p>
      <p id="Par9">are detailed below. All observations are processed in chunks and fitted independently.</p>
      <p id="Par10">(<italic>y</italic><sup><italic>i</italic></sup> = <italic>f</italic><sup><italic>i</italic></sup>(<italic>X</italic>) + <italic>e</italic><sup><italic>i</italic></sup>, where <italic>i</italic> represents each observation). Data processing (normalization and orthogonalization) techniques are optionally prepended to the overall analysis.</p>
      <p id="Par11">In this toolbox we consider the general framework that splits explanatory variables into.</p>
      <p id="Par12">variables of interest (predictor variables) and confounder factors (corrector variables) as explained in Henson and Penny (<xref ref-type="bibr" rid="CR19">2003</xref>). The goal of this scheme is to deduct confounder effects on the dependent variables to isolate the main effects of the variables of interest we want to analyze. This paradigm is widely used in neuroimaging: for example, using age (corrector).</p>
      <p id="Par13">as confounder variable when analyzing the effect of Alzheimer’s disease (predictor).</p>
      <p id="Par14">on hippocampus volume (observation or dependent variable). Concretely, we split the initial space <italic>S</italic>, defined by all explanatory variables <italic>X</italic>, into two subspaces: predictor (<italic>S</italic><sub><italic>P</italic></sub>) and corrector (<italic>S</italic><sub><italic>C</italic></sub>) subspaces of dimensions <italic>M</italic><sub><italic>C</italic></sub> and <italic>M</italic><sub><italic>P</italic></sub>, respectively (<italic>M</italic> = <italic>M</italic><sub><italic>C</italic></sub> + <italic>M</italic><sub><italic>P</italic></sub>). The predictor subspace is defined using a contrast matrix <italic>C</italic>, described by <italic>X</italic><sub><italic>P</italic></sub> = <italic>X</italic> · <italic>C</italic>, and its model is defined as <inline-formula id="IEq5"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\hat{Y}}_P={f}_P\left({X}_P\right) $$\end{document}</tex-math><mml:math id="M14" display="inline"><mml:msub><mml:mover accent="true"><mml:mi>Y</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mi>P</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>P</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:msub><mml:mi>X</mml:mi><mml:mi>P</mml:mi></mml:msub></mml:mfenced></mml:math><inline-graphic xlink:href="12021_2020_9456_Article_IEq5.gif"/></alternatives></inline-formula>. On the other hand, the corrector subspace is built using a null-contrast matrix (orthogonal to the contrast matrix), <italic>C</italic><sub>0</sub> = <italic>I</italic> − <italic>C</italic> · <italic>C</italic><sup>#</sup>, where <italic>C</italic><sup>#</sup> is the pseudoinverse of <italic>C</italic>. Hence, the corrector subspace is described by <italic>X</italic><sub><italic>C</italic></sub> = <italic>XC</italic><sub>0</sub>, and its model is defined as <inline-formula id="IEq6"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\hat{Y}}_C={f}_C\left({X}_C\right) $$\end{document}</tex-math><mml:math id="M16" display="inline"><mml:msub><mml:mover accent="true"><mml:mi>Y</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mi>C</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>C</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:msub><mml:mi>X</mml:mi><mml:mi>C</mml:mi></mml:msub></mml:mfenced></mml:math><inline-graphic xlink:href="12021_2020_9456_Article_IEq6.gif"/></alternatives></inline-formula>. Even though C and C<sub>0</sub> are orthogonal, both subspaces are orthogonal only if the columns of X are orthogonal.</p>
      <p id="Par15">We model the contribution of each subspace on the overall effect using an additive model <inline-formula id="IEq7"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ Y={\hat{Y}}_P+{\hat{Y}}_C+E $$\end{document}</tex-math><mml:math id="M18" display="inline"><mml:mi>Y</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>Y</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mi>P</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>Y</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mi>C</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>E</mml:mi><mml:mspace width="0.25em"/></mml:math><inline-graphic xlink:href="12021_2020_9456_Article_IEq7.gif"/></alternatives></inline-formula>, fitting first the corrector model (<italic>Y</italic> = <italic>f</italic><sub><italic>C</italic></sub>(<italic>X</italic><sub><italic>C</italic></sub>) + <italic>E</italic><sub><italic>C</italic></sub> ) on the observations and then the predictor model (<italic>E</italic><sub><italic>C</italic></sub> = <italic>f</italic><sub><italic>P</italic></sub>(<italic>X</italic><sub><italic>P</italic></sub>) + <italic>E</italic>) on the residuals. Since the fitting is done separately, both corrector and predictor functions, <italic>f</italic><sub><italic>C</italic></sub> and <italic>f</italic><sub><italic>P</italic></sub> can be any nonlinear model implemented in the toolbox. Note that each corrector and predictor variables can be modeled using different curve fitting methods:</p>
      <p id="Par16">
        <disp-formula id="Equc">
          <alternatives>
            <tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \hat{Y}={\hat{Y}}_C+{\hat{Y}}_P={f}_C\left({X}_C\right)+{f}_P\left({X}_P\right)={\sum}_{c=1}^{M_C}{f}_c\left({x}_c\right)+{\sum}_{p=1}^{M_P}{f}_p\left({x}_p\right) $$\end{document}</tex-math>
            <mml:math id="M20" display="block">
              <mml:mover accent="true">
                <mml:mi>Y</mml:mi>
                <mml:mo stretchy="true">^</mml:mo>
              </mml:mover>
              <mml:mo>=</mml:mo>
              <mml:msub>
                <mml:mover accent="true">
                  <mml:mi>Y</mml:mi>
                  <mml:mo stretchy="true">^</mml:mo>
                </mml:mover>
                <mml:mi>C</mml:mi>
              </mml:msub>
              <mml:mo>+</mml:mo>
              <mml:msub>
                <mml:mover accent="true">
                  <mml:mi>Y</mml:mi>
                  <mml:mo stretchy="true">^</mml:mo>
                </mml:mover>
                <mml:mi>P</mml:mi>
              </mml:msub>
              <mml:mo>=</mml:mo>
              <mml:msub>
                <mml:mi>f</mml:mi>
                <mml:mi>C</mml:mi>
              </mml:msub>
              <mml:mfenced close=")" open="(">
                <mml:msub>
                  <mml:mi>X</mml:mi>
                  <mml:mi>C</mml:mi>
                </mml:msub>
              </mml:mfenced>
              <mml:mo>+</mml:mo>
              <mml:msub>
                <mml:mi>f</mml:mi>
                <mml:mi>P</mml:mi>
              </mml:msub>
              <mml:mfenced close=")" open="(">
                <mml:msub>
                  <mml:mi>X</mml:mi>
                  <mml:mi>P</mml:mi>
                </mml:msub>
              </mml:mfenced>
              <mml:mo>=</mml:mo>
              <mml:msubsup>
                <mml:mo>∑</mml:mo>
                <mml:mrow>
                  <mml:mi>c</mml:mi>
                  <mml:mo>=</mml:mo>
                  <mml:mn>1</mml:mn>
                </mml:mrow>
                <mml:msub>
                  <mml:mi>M</mml:mi>
                  <mml:mi>C</mml:mi>
                </mml:msub>
              </mml:msubsup>
              <mml:msub>
                <mml:mi>f</mml:mi>
                <mml:mi>c</mml:mi>
              </mml:msub>
              <mml:mfenced close=")" open="(">
                <mml:msub>
                  <mml:mi>x</mml:mi>
                  <mml:mi>c</mml:mi>
                </mml:msub>
              </mml:mfenced>
              <mml:mo>+</mml:mo>
              <mml:msubsup>
                <mml:mo>∑</mml:mo>
                <mml:mrow>
                  <mml:mi>p</mml:mi>
                  <mml:mo>=</mml:mo>
                  <mml:mn>1</mml:mn>
                </mml:mrow>
                <mml:msub>
                  <mml:mi>M</mml:mi>
                  <mml:mi>P</mml:mi>
                </mml:msub>
              </mml:msubsup>
              <mml:msub>
                <mml:mi>f</mml:mi>
                <mml:mi>p</mml:mi>
              </mml:msub>
              <mml:mfenced close=")" open="(">
                <mml:msub>
                  <mml:mi>x</mml:mi>
                  <mml:mi>p</mml:mi>
                </mml:msub>
              </mml:mfenced>
            </mml:math>
            <graphic xlink:href="12021_2020_9456_Article_Equc.gif" position="anchor"/>
          </alternatives>
        </disp-formula>
      </p>
      <p id="Par17">Baseline curve fitting methods implemented in the toolbox are: (i) GLM, (ii) GAM and (iii) SVR. Each subspace (predictor and corrector) can be modeled by any of these techniques. While the first two methods model each dimension independently, the third allows for interactions between different dimensions.</p>
      <sec id="Sec5">
        <title>General Linear Model: GLM</title>
        <p id="Par18">The General Linear Model (Christensen <xref ref-type="bibr" rid="CR7">2011</xref>) is the extension of multiple regression models to the case of multiple observations. The effect of each factor is independently analyzed without accounting for interactions between them. The model reads as follows:<disp-formula id="Equd"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ y=f(X)+e= X\beta +e, $$\end{document}</tex-math><mml:math id="M22" display="block"><mml:mi>y</mml:mi><mml:mo>=</mml:mo><mml:mi>f</mml:mi><mml:mfenced close=")" open="("><mml:mi>X</mml:mi></mml:mfenced><mml:mo>+</mml:mo><mml:mi>e</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="italic">Xβ</mml:mi><mml:mo>+</mml:mo><mml:mi>e</mml:mi><mml:mo>,</mml:mo></mml:math><graphic xlink:href="12021_2020_9456_Article_Equd.gif" position="anchor"/></alternatives></disp-formula>where <italic>β</italic> are the model parameters and <italic>e</italic> is the error of the model. GLM optimization involves minimizing the mean squared error <inline-formula id="IEq8"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\left\Vert\ e\ \right\Vert}_2^2 $$\end{document}</tex-math><mml:math id="M24" display="inline"><mml:msubsup><mml:mfenced close="‖" open="‖"><mml:mrow><mml:mspace width="0.25em"/><mml:mi>e</mml:mi><mml:mspace width="0.25em"/></mml:mrow></mml:mfenced><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:math><inline-graphic xlink:href="12021_2020_9456_Article_IEq8.gif"/></alternatives></inline-formula> between data points and the fitted curve. Nonlinear relationships can be modeled in the GLM framework by using a polynomial basis expansion of each regressor. The total number of degrees of freedom is the number of covariates in the analysis (df = M), including each basis expansion if used.</p>
      </sec>
      <sec id="Sec6">
        <title>Generalized Additive Model: GAM</title>
        <p id="Par19">A Generalized Additive Model (Hastie <xref ref-type="bibr" rid="CR18">2017</xref>) is an extension of additive models (AM) to the case of multiple observations. In GAM, each observation depends on unknown smooth functions of each covariate:<disp-formula id="Eque"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ y=f(X)+e={f}_1\left({x}_1\right)+{f}_2\left({x}_2\right)+\dots +{f}_M\left({x}_M\right)+e. $$\end{document}</tex-math><mml:math id="M26" display="block"><mml:mi>y</mml:mi><mml:mo>=</mml:mo><mml:mi>f</mml:mi><mml:mfenced close=")" open="("><mml:mi>X</mml:mi></mml:mfenced><mml:mo>+</mml:mo><mml:mi>e</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mfenced close=")" open="("><mml:msub><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mfenced><mml:mo>+</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mfenced close=")" open="("><mml:msub><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mfenced><mml:mo>+</mml:mo><mml:mo>…</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>M</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:msub><mml:mi>x</mml:mi><mml:mi>M</mml:mi></mml:msub></mml:mfenced><mml:mo>+</mml:mo><mml:mi>e</mml:mi><mml:mo>.</mml:mo></mml:math><graphic xlink:href="12021_2020_9456_Article_Eque.gif" position="anchor"/></alternatives></disp-formula></p>
        <p id="Par20">In the context of this toolbox, <italic>f</italic><sub><italic>i</italic></sub> refer to parametric smooth functions, called smoothers, that are iteratively estimated using the backfitting algorithm (Breiman and Friedman <xref ref-type="bibr" rid="CR4">1985</xref>) to minimize the mean squared error <inline-formula id="IEq9"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\left\Vert\ e\ \right\Vert}_2^2 $$\end{document}</tex-math><mml:math id="M28" display="inline"><mml:msubsup><mml:mfenced close="‖" open="‖"><mml:mrow><mml:mspace width="0.25em"/><mml:mi>e</mml:mi><mml:mspace width="0.25em"/></mml:mrow></mml:mfenced><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:math><inline-graphic xlink:href="12021_2020_9456_Article_IEq9.gif"/></alternatives></inline-formula>. If linear or polynomial smoothers are used, GAM is equivalent to GLM. Other smoothers available are B-splines or natural splines, implemented using the Patsy library (<ext-link ext-link-type="uri" xlink:href="https://patsy.readthedocs.io/en/latest/">https://patsy.readthedocs.io/en/latest/</ext-link>). The total number of degrees of freedom is the sum of degrees of freedom of each smoother <italic>df</italic> = <italic>df</italic><sub>1</sub> + <italic>df</italic><sub>2</sub> + … + <italic>df</italic><sub><italic>M</italic></sub>. For a linear smoother, the number of degrees of freedom is one (<italic>df</italic><sub><italic>i</italic></sub> = 1), for polynomial smoother, the number of degrees of freedom is the polynomial order (<italic>df</italic><sub><italic>i</italic></sub> = <italic>d</italic>) and for splines-based smoothers, the number of degrees of freedom is an input parameter set by the user.</p>
      </sec>
      <sec id="Sec7">
        <title>Support Vector Regression: SVR</title>
        <p id="Par21">Support Vector Regression (Drucker et al. <xref ref-type="bibr" rid="CR10">1997</xref>) is a multivariate method that inherently accounts for interactions between covariates unlike GLM or GAM, that only account for the additive effect between covariates. In SVR the goal is to find a function <italic>f</italic>(<italic>X</italic>) that has at most <italic>ε</italic>-deviation from the observations and is as smooth as possible. However, since the <italic>ε</italic>-deviation constraint might not be feasible, a hyperparameter C controls the balance between smoothness and errors greater than <italic>ε</italic>. SVR is a linear method in the parameters with a closed form solution. To introduce nonlinearities, SVR uses the <italic>kernel trick</italic> which implicitly transforms the inputs to a higher dimensional feature space by only specifying their inner product, i.e. the kernel function <italic>k</italic>(<italic>x</italic><sup><italic>i</italic></sup>, <italic>x</italic><sup><italic>j</italic></sup>) =  &lt; <italic>φ</italic>(<italic>x</italic><sup><italic>i</italic></sup>), <italic>φ</italic>(<italic>x</italic><sup><italic>j</italic></sup>)&gt;, where <italic>x</italic><sup><italic>i</italic></sup> and <italic>x</italic><sup><italic>j</italic></sup> are two feature vectors from different observations. Once estimated, the overall model is parameterized using parameters <italic>β</italic> as follows<disp-formula id="Equf"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ y=f(X)+e={\sum}_{l=0}^{L-1}k\left({x}^l,x\right){\beta}_l+e, $$\end{document}</tex-math><mml:math id="M30" display="block"><mml:mi>y</mml:mi><mml:mo>=</mml:mo><mml:mi>f</mml:mi><mml:mfenced close=")" open="("><mml:mi>X</mml:mi></mml:mfenced><mml:mo>+</mml:mo><mml:mi>e</mml:mi><mml:mo>=</mml:mo><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>L</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mi>k</mml:mi><mml:mfenced close=")" open="(" separators=","><mml:msup><mml:mi>x</mml:mi><mml:mi>l</mml:mi></mml:msup><mml:mi>x</mml:mi></mml:mfenced><mml:msub><mml:mi>β</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>e</mml:mi><mml:mo>,</mml:mo></mml:math><graphic xlink:href="12021_2020_9456_Article_Equf.gif" position="anchor"/></alternatives></disp-formula>where <italic>x</italic><sup><italic>l</italic></sup> are all data points used to fit the model and <italic>x</italic> is any feature vector. Two kernel functions are implemented in this toolbox using the scikit-learn library (Pedregosa, 2011): polynomial and the radial basis function (RBF) defined as <italic>k</italic>(<italic>x</italic><sup><italic>l</italic></sup>, <italic>x</italic>) =  <italic>exp</italic> ( − <italic>γ</italic>‖ <italic>x</italic><sup><italic>l</italic></sup> − <italic>x</italic>‖<sup>2</sup>, where <italic>γ</italic> is a hyperparameter defining the width of the kernel. The total number of degrees of freedom depends on the kernel used and it is based on the solution proposed in Dinuzzo et al. (<xref ref-type="bibr" rid="CR9">2007</xref>).</p>
        <sec id="FPar1">
          <title>Hyperparameter Search</title>
          <p id="Par22">SVR relies on the election of several hyperparameters: <italic>ε</italic>and <italic>C</italic> for the general solution and kernel related hyperparameters, such as <italic>γ</italic>in RBF kernels. The hyperparameter values can be automatically determined by a grid search on the hyperparameter space (Hsu et al. <xref ref-type="bibr" rid="CR20">2003</xref>). This method consists of several steps: (i) sample H different value combinations from the hyperparameter space using one of the sampling strategies provided in this toolbox: random or deterministic sampling with linear or logarithmic scale, (ii) fit a subset <italic>G</italic>of the observations on all H hyperparameter combinations and (iii) select the hyperparameter combination that minimizes the metric of interest, <italic>t</italic><sub><italic>i</italic></sub>, on the subset <italic>G</italic> (<italic>T</italic> = ∑<sub><italic>i</italic> ∈ <italic>G</italic></sub><italic>t</italic><sub><italic>i</italic></sub>). The available metrics are: (i) minimum squared error, (ii) F-test goodness of fit and (iii) Mallows’s C<sub>p</sub> statistic (James et al. <xref ref-type="bibr" rid="CR24">2013</xref>). To avoid selection bias, this procedure is iterated varying the selected subset <italic>G</italic> of observations. Larger subset sizes provide better hyperparameter estimations but increasing time and memory requirements, due to the intensive search performed. However, we allow parallelization of the second step and further iterations of the algorithm. To account for the great between subject variability of medical images the voxelwise metric values are weighted by the inverse of the variance (1/<italic>σ</italic><sub><italic>i</italic></sub>) of each observation <inline-formula id="IEq10"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \left(\hat{t_i}={t}_i/{\sigma}_i,\kern0.75em \hat{T}={\sum}_{i\in G}\hat{t_i}\right) $$\end{document}</tex-math><mml:math id="M32" display="inline"><mml:mfenced close=")" open="(" separators=","><mml:mrow><mml:mover accent="true"><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mspace width="0.75em"/><mml:mover accent="true"><mml:mi>T</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mi>G</mml:mi></mml:mrow></mml:msub><mml:mover accent="true"><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="12021_2020_9456_Article_IEq10.gif"/></alternatives></inline-formula>. Moreover, due to the vast amount of background voxels, only those with minimum variance (<italic>σ</italic><sub><italic>min</italic></sub>) can be included in the subset of observations.</p>
        </sec>
      </sec>
    </sec>
    <sec id="Sec8">
      <title>Statistical Inference</title>
      <p id="Par23">Statistical maps evaluating the goodness of fit and penalizing by the complexity of the model can be computed for each of the fitting methods presented in section 2.2. To this purpose, several metrics are available in the tool:<list list-type="bullet"><list-item><p id="Par24"><bold>Minimum squared error (MSE) and Coefficient of determination (</bold><bold><italic>R</italic></bold><sup><bold>2</bold></sup><bold>)</bold>: these two metrics evaluate the predictive power of the model without penalizing for its complexity.<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ MSE={\left\Vert\ y-f(X)\ \right\Vert}_2^2 $$\end{document}</tex-math><mml:math id="M34" display="block"><mml:mi mathvariant="italic">MSE</mml:mi><mml:mo>=</mml:mo><mml:msubsup><mml:mfenced close="‖" open="‖"><mml:mrow><mml:mspace width="0.25em"/><mml:mi>y</mml:mi><mml:mo>−</mml:mo><mml:mi>f</mml:mi><mml:mfenced close=")" open="("><mml:mi>X</mml:mi></mml:mfenced><mml:mspace width="0.25em"/></mml:mrow></mml:mfenced><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:math><graphic xlink:href="12021_2020_9456_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {R}^2=1-\frac{SS_{res}}{SS_y},\kern1.25em {SS}_{res}={\left\Vert\ y-f(X)\ \right\Vert}_2^2,\kern1.25em {SS}_y={\left\Vert\ y-\underset{\_}{y}\right\Vert}_2^2 $$\end{document}</tex-math><mml:math id="M36" display="block"><mml:msup><mml:mi>R</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mfrac><mml:msub><mml:mi mathvariant="italic">SS</mml:mi><mml:mi mathvariant="italic">res</mml:mi></mml:msub><mml:msub><mml:mi mathvariant="italic">SS</mml:mi><mml:mi>y</mml:mi></mml:msub></mml:mfrac><mml:mo>,</mml:mo><mml:mspace width="1.25em"/><mml:msub><mml:mi mathvariant="italic">SS</mml:mi><mml:mi mathvariant="italic">res</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mfenced close="‖" open="‖"><mml:mrow><mml:mspace width="0.25em"/><mml:mi>y</mml:mi><mml:mo>−</mml:mo><mml:mi>f</mml:mi><mml:mfenced close=")" open="("><mml:mi>X</mml:mi></mml:mfenced><mml:mspace width="0.25em"/></mml:mrow></mml:mfenced><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mo>,</mml:mo><mml:mspace width="1.25em"/><mml:msub><mml:mi mathvariant="italic">SS</mml:mi><mml:mi>y</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mfenced close="‖" open="‖"><mml:mrow><mml:mspace width="0.25em"/><mml:mi>y</mml:mi><mml:mo>−</mml:mo><mml:munder accentunder="false"><mml:mi>y</mml:mi><mml:mo>_</mml:mo></mml:munder></mml:mrow></mml:mfenced><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:math><graphic xlink:href="12021_2020_9456_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula></p></list-item></list>where <inline-formula id="IEq11"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \underset{\_}{y}=\frac{1}{N}{\sum}_{i=0}^{N-1}{y}^i $$\end{document}</tex-math><mml:math id="M38" display="inline"><mml:mspace width="0.25em"/><mml:munder accentunder="false"><mml:mi>y</mml:mi><mml:mo>_</mml:mo></mml:munder><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>N</mml:mi></mml:mfrac><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:msup><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msup></mml:math><inline-graphic xlink:href="12021_2020_9456_Article_IEq11.gif"/></alternatives></inline-formula> is the mean of the observations.<list list-type="bullet"><list-item><p id="Par25"><bold>Akaike Information Criterion (AIC):</bold> the AIC criteria (Sakamoto et al. <xref ref-type="bibr" rid="CR35">1986</xref>) is founded on information theory. It is useful for model comparison as it provides a trade-off between the quality or goodness of fit and the complexity of the model, which is proportional to the number of parameters.<disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ AIC=2k-2 LLR,\kern1.25em LLR=-\frac{N}{2}\left(\mathit{\log}\left(2\pi \cdotp MSE\right)+1\right) $$\end{document}</tex-math><mml:math id="M40" display="block"><mml:mi mathvariant="italic">AIC</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:mi mathvariant="italic">LLR</mml:mi><mml:mo>,</mml:mo><mml:mspace width="1.25em"/><mml:mi mathvariant="italic">LLR</mml:mi><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mfrac><mml:mi>N</mml:mi><mml:mn>2</mml:mn></mml:mfrac><mml:mfenced close=")" open="("><mml:mrow><mml:mo mathvariant="italic">log</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mo>·</mml:mo><mml:mi mathvariant="italic">MSE</mml:mi></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="12021_2020_9456_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula></p></list-item></list>where <italic>k</italic> is the total number of parameters and LLR is the log likelihood ratio.<list list-type="bullet"><list-item><p id="Par26"><bold>F-test:</bold> the F-test is a statistical test following an F-distribution under its null-hypothesis. In the context of this toolbox, it evaluates whether the variance of the full model (correctors and predictors) is significantly lower than the variance of the restricted model (only correctors). Under the null-hypothesis, the full-model does not provide any significantly better fit than the restricted model, resulting an F-statistic with (df<sub>full</sub>, df<sub>restricted</sub>) degrees of freedom and the corresponding <italic>p</italic> value. Rejection of the null hypothesis is based upon the p value.<disp-formula id="Equg"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {f}_{score}=\frac{SS_{res}-{SS}_{full}}{SS_{full}}\frac{N-{df}_{full}}{df_{full}-{df}_{res tricted}} $$\end{document}</tex-math><mml:math id="M42" display="block"><mml:msub><mml:mi>f</mml:mi><mml:mtext mathvariant="italic">score</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi mathvariant="italic">SS</mml:mi><mml:mi mathvariant="italic">res</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi mathvariant="italic">SS</mml:mi><mml:mtext mathvariant="italic">full</mml:mtext></mml:msub></mml:mrow><mml:msub><mml:mi mathvariant="italic">SS</mml:mi><mml:mtext mathvariant="italic">full</mml:mtext></mml:msub></mml:mfrac><mml:mfrac><mml:mrow><mml:mi>N</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi mathvariant="italic">df</mml:mi><mml:mtext mathvariant="italic">full</mml:mtext></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="italic">df</mml:mi><mml:mtext mathvariant="italic">full</mml:mtext></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi mathvariant="italic">df</mml:mi><mml:mtext mathvariant="italic">restricted</mml:mtext></mml:msub></mml:mrow></mml:mfrac></mml:math><graphic xlink:href="12021_2020_9456_Article_Equg.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equh"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {p}_{value}=1-F\left({f}_{score},{df}_{res},{df}_{full}\right) $$\end{document}</tex-math><mml:math id="M44" display="block"><mml:msub><mml:mi>p</mml:mi><mml:mtext mathvariant="italic">value</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>F</mml:mi><mml:mfenced close=")" open="(" separators=",,"><mml:msub><mml:mi>f</mml:mi><mml:mtext mathvariant="italic">score</mml:mtext></mml:msub><mml:msub><mml:mi mathvariant="italic">df</mml:mi><mml:mi mathvariant="italic">res</mml:mi></mml:msub><mml:msub><mml:mi mathvariant="italic">df</mml:mi><mml:mtext mathvariant="italic">full</mml:mtext></mml:msub></mml:mfenced></mml:math><graphic xlink:href="12021_2020_9456_Article_Equh.gif" position="anchor"/></alternatives></disp-formula></p></list-item></list>where <inline-formula id="IEq12"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {SS}_{res}={\left\Vert y-{f}_c\left({X}_c\right)\right\Vert}_2^2 $$\end{document}</tex-math><mml:math id="M46" display="inline"><mml:msub><mml:mi mathvariant="italic">SS</mml:mi><mml:mi mathvariant="italic">res</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mfenced close="‖" open="‖"><mml:mrow><mml:mi>y</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:msub><mml:mi>X</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mfenced></mml:mrow></mml:mfenced><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:math><inline-graphic xlink:href="12021_2020_9456_Article_IEq12.gif"/></alternatives></inline-formula>, <inline-formula id="IEq13"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {SS}_{full}={\left\Vert y-{f}_C\left({X}_C\right)-{f}_P\left({X}_P\right)\right\Vert}_2^2 $$\end{document}</tex-math><mml:math id="M48" display="inline"><mml:msub><mml:mi mathvariant="italic">SS</mml:mi><mml:mtext mathvariant="italic">full</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mfenced close="‖" open="‖"><mml:mrow><mml:mi>y</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>C</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:msub><mml:mi>X</mml:mi><mml:mi>C</mml:mi></mml:msub></mml:mfenced><mml:mo>−</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>P</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:msub><mml:mi>X</mml:mi><mml:mi>P</mml:mi></mml:msub></mml:mfenced></mml:mrow></mml:mfenced><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:math><inline-graphic xlink:href="12021_2020_9456_Article_IEq13.gif"/></alternatives></inline-formula>, and <italic>F</italic>(<italic>x</italic>, <italic>d</italic><sub>1</sub>, <italic>d</italic><sub>2</sub>)is the F-distribution.<list list-type="bullet"><list-item><p id="Par27"><bold>Penalized Residual Sum of Squares (PRSS), Variance-Normalized PRSS (VNPRSS)</bold>: PRSS is introduced in this toolbox as another evaluation metric that accounts for the goodness of fit and penalizes the model complexity. However, differently from other metrics, complexity is not computed with the degrees of freedom but using the curve shape itself. Hence, a complex model such as SVR with Gaussian kernel that provides a linear curve will penalize as much as the GLM. VNPRSS is an adaptation of PRSS for data with high-variability, like medical images, and penalizes each error term by the inverse of the observations variance.<disp-formula id="Equ4"><label>4</label><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ PRSS= MSE+\gamma \cdotp {c}_{abruptness},\kern1.25em {c}_{abruptness}=\int f^{\prime\prime }(X)\  dx\kern0.5em $$\end{document}</tex-math><mml:math id="M50" display="block"><mml:mtext mathvariant="italic">PRSS</mml:mtext><mml:mo>=</mml:mo><mml:mi mathvariant="italic">MSE</mml:mi><mml:mo>+</mml:mo><mml:mi>γ</mml:mi><mml:mo>·</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mtext mathvariant="italic">abruptness</mml:mtext></mml:msub><mml:mo>,</mml:mo><mml:mspace width="1.25em"/><mml:msub><mml:mi>c</mml:mi><mml:mtext mathvariant="italic">abruptness</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mo>∫</mml:mo><mml:mi>f</mml:mi><mml:mo>′</mml:mo><mml:mo>′</mml:mo><mml:mfenced close=")" open="("><mml:mi>X</mml:mi></mml:mfenced><mml:mspace width="0.25em"/><mml:mi mathvariant="italic">dx</mml:mi><mml:mspace width="0.5em"/></mml:math><graphic xlink:href="12021_2020_9456_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ5"><label>5</label><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ VNPRSS=\frac{PRSS}{c_{variance}},\kern1.25em {c}_{variance}={\left\Vert \kern0.5em f(X)-\underset{\_}{y}\ \right\Vert}_2^2 $$\end{document}</tex-math><mml:math id="M52" display="block"><mml:mtext mathvariant="italic">VNPRSS</mml:mtext><mml:mo>=</mml:mo><mml:mfrac><mml:mtext mathvariant="italic">PRSS</mml:mtext><mml:msub><mml:mi>c</mml:mi><mml:mtext mathvariant="italic">variance</mml:mtext></mml:msub></mml:mfrac><mml:mo>,</mml:mo><mml:mspace width="1.25em"/><mml:msub><mml:mi>c</mml:mi><mml:mtext mathvariant="italic">variance</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mfenced close="‖" open="‖"><mml:mrow><mml:mspace width="0.5em"/><mml:mi>f</mml:mi><mml:mfenced close=")" open="("><mml:mi>X</mml:mi></mml:mfenced><mml:mo>−</mml:mo><mml:munder accentunder="false"><mml:mi>y</mml:mi><mml:mo>_</mml:mo></mml:munder><mml:mspace width="0.25em"/></mml:mrow></mml:mfenced><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:math><graphic xlink:href="12021_2020_9456_Article_Equ5.gif" position="anchor"/></alternatives></disp-formula></p></list-item></list></p>
    </sec>
    <sec id="Sec9">
      <title>Post-hoc Analysis</title>
      <p id="Par28">The NeAT toolbox provides several functionalities for post-hoc analysis of the generated curves and statistical maps. Different model comparison strategies and a curve clustering algorithm are presented in what follows.</p>
      <sec id="Sec10">
        <title>Model Comparison</title>
        <p id="Par29">In order to compare L statistical maps generated using different fitting models we combine them into a single statistical map providing different information:<list list-type="bullet"><list-item><p id="Par30"><bold>Diff-map</bold> (L = 2): it provides the difference between maps, being useful for quantitative detection of differences between L = 2 fitting models.</p></list-item><list-item><p id="Par31"><bold>ABSdiff-map</bold> (L = 2): it provides the absolute difference between maps, being useful for quantitative detection of differences between L = 2 fitting models.</p></list-item><list-item><p id="Par32"><bold>SE-map</bold> (L = 2): it provides the squared difference between maps, being useful for quantitative detection of differences between L = 2 fitting models.</p></list-item><list-item><p id="Par33"><bold>RGB-map</bold> (L = 3): it places each map in a different color channel. It might be useful to compare the intersection of several fitting models showing agreement and disagreement among them.</p></list-item><list-item><p id="Par34"><bold>Best-map</bold> (L &gt; 1): it computes the best fitting model at each voxel. It might be useful for model localization in the brain.</p></list-item></list></p>
      </sec>
      <sec id="Sec11">
        <title>Clustering</title>
        <p id="Par35">We incorporate a curve clustering functionality (Jacques and Preda <xref ref-type="bibr" rid="CR23">2014</xref>) for extracting distinct pattens of brain data variation with respect covariates of interest. In that sense, we provide a scalable and non-parametric algorithm that is able to explore similarities and dissimilarities of the fitted curves across the brain and group them in a total of <italic>N</italic><sub><italic>C</italic></sub> clusters.</p>
        <p id="Par36">We adopted the hierarchical clustering framework (Murtagh and Legendre <xref ref-type="bibr" rid="CR30">2014</xref>) implemented in scikit-learn (Pedregosa et al. <xref ref-type="bibr" rid="CR31">2011</xref>). It is a bottom-up approach where initially each curve defines its own cluster. Next, pairs of clusters are successively merged according to a certain similarity metric and a linkage criterion. As a similarity metric, we use a weighted sum of distances:<disp-formula id="Equ6"><label>6</label><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ SD\left(x,y\right)={\sum}_{i=0}^{N_D-1}{w}_n{d}_n\left(x,y\right) $$\end{document}</tex-math><mml:math id="M54" display="block"><mml:mi mathvariant="italic">SD</mml:mi><mml:mfenced close=")" open="(" separators=","><mml:mi>x</mml:mi><mml:mi>y</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>D</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:msub><mml:mi>w</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:msub><mml:mi>d</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mfenced close=")" open="(" separators=","><mml:mi>x</mml:mi><mml:mi>y</mml:mi></mml:mfenced></mml:math><graphic xlink:href="12021_2020_9456_Article_Equ6.gif" position="anchor"/></alternatives></disp-formula>where (<italic>x</italic>, <italic>y</italic>)are two different curves, <italic>d</italic><sub><italic>n</italic></sub> is the Euclidean distance between the <italic>n</italic><sup><italic>th</italic></sup> discrete derivative of each curve, <italic>w</italic><sub><italic>n</italic></sub> is the weight of each derivative to the total similarity metric and <italic>N</italic><sub><italic>D</italic></sub> is the total number of derivatives used. In our implementation, we fix <italic>N</italic><sub><italic>D</italic></sub> = 3 and <bold><italic>w</italic></bold><sup><bold><italic>T</italic></bold></sup> <bold><italic>=</italic></bold> [<bold>0.2</bold>, <bold>0.8</bold>, <bold>0.2</bold>]. As a linkage criterion, we use the average distance between all possible pairs of elements of both clusters<disp-formula id="Equ7"><label>7</label><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ L\left(A,B\right)=\frac{1}{\mid A\mid \cdotp \mid B\mid }{\sum}_{a\in A}{\sum}_{b\in B} SD\left(a,b\right) $$\end{document}</tex-math><mml:math id="M56" display="block"><mml:mi>L</mml:mi><mml:mfenced close=")" open="(" separators=","><mml:mi>A</mml:mi><mml:mi>B</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mo>∣</mml:mo><mml:mi>A</mml:mi><mml:mo>∣</mml:mo><mml:mo>·</mml:mo><mml:mo>∣</mml:mo><mml:mi>B</mml:mi><mml:mo>∣</mml:mo></mml:mrow></mml:mfrac><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mi>a</mml:mi><mml:mo>∈</mml:mo><mml:mi>A</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mi>b</mml:mi><mml:mo>∈</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:msub><mml:mi mathvariant="italic">SD</mml:mi><mml:mfenced close=")" open="(" separators=","><mml:mi>a</mml:mi><mml:mi>b</mml:mi></mml:mfenced></mml:math><graphic xlink:href="12021_2020_9456_Article_Equ7.gif" position="anchor"/></alternatives></disp-formula>where (<italic>A</italic>, <italic>B</italic>) are two different clusters, (| <italic>A</italic>| , | <italic>B</italic>| ) are the cardinalities of the clusters and (<italic>a</italic>, <italic>b</italic>) represent a curve from each cluster. Hence, at each step of the hierarchy, the two clusters that minimize the linkage criterion are combined. The algorithm stops when it reaches <italic>N</italic><sub><italic>C</italic></sub>clusters (a parameter predefined by the user).</p>
        <p id="Par37">Please note that there is not a single optimal value for the number of clusters (N<sub>c</sub>). Hence, we include a functionality to plot the variance between and within clusters as well as the silhouette coefficient (SC) metric (Rousseeuw <xref ref-type="bibr" rid="CR33">1987</xref>) that can be used to assess the optimal number of clusters for the analysis as a trade-off between within and between cluster distance.</p>
      </sec>
    </sec>
    <sec id="Sec12">
      <title>Visualization</title>
      <p id="Par38">This toolbox provides <italic>show-curves</italic> and <italic>show-data-distribution</italic> functionalities and a graphical user interface (GUI) for visualization purposes. The <italic>show-curves</italic> is a command line functionality that reads either the voxel coordinates in mm (x,y,z) for voxel-based morphometry (VBM) analysis, or the vertex number (x) for surface-based morphometry (SBM) analysis, both referenced to the template specified in the configuration file. The <italic>show-data-distribution</italic> functionality allows the user to visualize the input data distribution (observations, residuals, covariates) using different types of plots: univariate and bivariate densities, boxplots and a categorical boxplots.</p>
      <sec id="Sec13">
        <title>Graphical User Interface (GUI)</title>
        <p id="Par39">An interactive visualization GUI for 3D volumes (VBM) is provided for further analysis of the results. It allows to load 3D overlays over a template and visualize the generated curves for one or several fitting models of interest. Overlays must have the same extension as specified in the configuration file and can be either generated by the tool (e.g: statistical maps, model comparison maps or clustering maps) or external (e.g: brain structure atlases). Simultaneously, it shows the three orthogonal planes (axial, coronal and sagittal) and the curve of the corresponding voxel. Inspection of the overall brain and associated curves can be done online using the cursor in an interactive way.</p>
        <p id="Par40">Due to long rendering times, for visualization of 2D surfaces (2D) we recommend using other visualization software (e.g: FreeSurfer) in parallel with the <italic>show-curves</italic> functionality.</p>
      </sec>
    </sec>
    <sec id="Sec14">
      <title>NeAT Specifications</title>
      <p id="Par41">NeAT toolbox uses a configuration file to specify experiment related options such as input/output files or experiment parameters. The overall analysis pipeline (<italic>model estimation, statistical inference, visualization</italic>) is split into smaller steps using different scripts. A command line interface (CLI) is used for communication between the toolbox and the user, allowing to run the scripts and set specific parameters for the analysis (e.g. which fitting module to use as model estimator).</p>
      <p id="Par42">The toolbox input files consist of covariates and images. Input covariates need to be stored in a spreadsheet either <italic>.csv</italic> or <italic>.xls</italic> extension. Input images can be either preprocessed using voxel-based morphometry (VBM) or surface-based morphometry (SBM): nifti formats (<italic>.nii/.nii.gz</italic>), the Massachusetts General Hospital formats (<italic>.mgh/.mgz</italic>) and measurements of cortical thickness (<italic>.thickness</italic>) and surface area (<italic>.area</italic>) can be used in the tool.</p>
      <p id="Par43">Each analysis step of the global pipeline generates different output files saved under the directory specified in the configuration file. Statistical maps are saved using the same extension as input files allowing compatibility with other neuroimaging packages (e.g: visualization software). As a programming language, Python (version 3.6) is used due to its object-oriented programming paradigm that provides flexibility in toolboxes with increasing size and complexity. Moreover, Python is becoming progressively popular in the neuroimaging field with growing scientific libraries (e.g: scipy (Jones et al. <xref ref-type="bibr" rid="CR25">2014</xref>)), neuroimaging (e.g: nibabel (Brett et al. <xref ref-type="bibr" rid="CR5">2016</xref>)) or machine learning toolkits (e.g: scikit-learn (Pedregosa et al. <xref ref-type="bibr" rid="CR31">2011</xref>)).</p>
    </sec>
  </sec>
  <sec id="Sec15">
    <title>Validation Results and Discussion</title>
    <p id="Par44">To exemplify NeAT’s main functionality, it has been applied to three case studies where non-linear behaviour of neuroimaging data has been described previously.</p>
    <sec id="Sec16">
      <title>Case Study 1: Atrophy Patterns across the Alzheimer’s Disease Continuum</title>
      <sec id="Sec17">
        <title>Voxelwise Volumetric Analysis</title>
        <p id="Par45">Nonlinear volumetric changes in gray matter across the Alzheimer’s disease (AD) continuum have been described (Gispert et al. <xref ref-type="bibr" rid="CR17">2015</xref>). In this report, nonlinearity is modeled using GLM with a 3rd-order polynomial basis expansion, and the relevance of linear against higher-order predictors was compared. Here, we use NeAT to fit several nonlinear models to the same dataset in order to statistically compare them.</p>
        <p id="Par46">In brief, study participants were enrolled in a single-cohort study from the Alzheimer’s Disease and Other Cognitive Disorders Unit in Hospital Clinic of Barcelona (HCB). The cohort comprises 129 subjects (62 controls, 18 preclinical AD, 28 mild cognitive impairment (MCI) due to AD and 21 diagnosed AD) that underwent an MRI scan, registered to a common space, and a CSF lumbar puncture. The AD continuum is defined biologically by the AD-CSF index (Molinuevo et al. <xref ref-type="bibr" rid="CR28">2013</xref>) which combines CSF biomarkers into a single indicator that determines the position of each subject along the AD continuum. For further details on both MRI processing and CSF acquisition, refer to Gispert et al. (<xref ref-type="bibr" rid="CR17">2015</xref>).</p>
        <p id="Par47">Following the standard procedure of splitting covariates into confounding factors and predictors, we fit a corrector GLM model using sex and a second order polynomial expansion of age. We use AD-CSF index as the predictor variable fitting several models to the GMv corrected observations: (i) GLM with third order polynomial expansion, (ii) GAM using b-splines as smoothing function (iii) SVR using third order polynomial kernel and (iv) SVR using Gaussian kernel. We use an F-test to statistically compare all predictor models. Statistical significance was set to <italic>p</italic> &lt; 0.001 uncorrected for multiple comparisons with a cluster-extent threshold of 100 voxels.</p>
        <p id="Par48">Figure <xref rid="Fig2" ref-type="fig">2</xref> shows a few examples of the visualization GUI using the <italic>best-map</italic> option to compare the aforementioned fitting methods. Results using GLM with polynomial basis expansion are coherent with the ones found in Gispert et al. (<xref ref-type="bibr" rid="CR17">2015</xref>). However, better goodness-of-fit can be achieved using nonlinear models in NeAT and, in particular, GAM seems to better fit extreme values. There is a high overlap between second order polynomial expansion of GLM, GAM with b-splines and SVR with polynomial and Gaussian kernels. Due to the low numbers of degrees of freedom used, GLM and GAM appear to be the most relevant models across the brain. On the other hand, using a Gaussian kernel on SVR employ higher number of degrees of freedom and its relevance is restricted at the center of typical AD subcortical regions (e.g: hippocampus and amygdala).<fig id="Fig2"><label>Fig. 2</label><caption><p>Comparison between different curve fitting models: third order polynomial expansion of GLM (blue), B-splines GAM (green), SVR with polynomial kernel (yellow) and SVR with Gaussian kernel (red). The best-map is used for statistical comparison, showing the best (in terms of F-test) model among all four models with statistical significance using uncorrected <italic>p</italic> &lt; 0.001 separately for each model. Estimated curves show the variation of gray matter volume (y-axis) and AD-CSF index (x-axis). Based on CSF amyloid-beta and tau levels, the AD-CSF index measures biomarker progression using a single index normalized between 0 (no altered biomarkers) and 2 (full AD-like alteration) (Molinuevo, 2013). The figure on (A) corresponds to the left hippocampus and the figure on (B) corresponds to the right precuneus</p></caption><graphic xlink:href="12021_2020_9456_Fig2_HTML" id="MO2"/></fig></p>
        <p id="Par49">Further analysis of the results can be done using the clustering functionality of the tool. Using the GAM model, we look for regions with similar atrophy patterns along the AD continuum. We compute the silhouette for a large number of clusters and end up with an optimal number of <italic>N</italic><sub><italic>C</italic></sub> = 2 clusters, with a silhouette average value of <italic>S</italic> = 0.32. In fig. <xref rid="Fig3" ref-type="fig">3</xref> we show the results with the curves for each cluster and their associated brain regions. We can clearly distinguish two different patterns: a linear pattern involving region such as the precuneus or the cingulate cortex while another non-linear pattern group other regions such as the middle temporal or hippocampus.<fig id="Fig3"><label>Fig. 3</label><caption><p>Curve clustering algorithm run on relevant atrophy patterns along the AD-CSF index using GAM fitting. The number of clusters is set to N<sub>C</sub> = 6. On the left, we show the relevant voxels color-coded to describe the association of each voxel with each cluster. On the right, we show all curves associated to each cluster (red) and their respective centroid (black)</p></caption><graphic xlink:href="12021_2020_9456_Fig3_HTML" id="MO3"/></fig></p>
      </sec>
      <sec id="Sec18">
        <title>ROI Cortical Thickness Analysis</title>
        <p id="Par50">To further validate the toolbox we perform a cortical thickness analysis along the Alzheimer’s continuum. Global cortical thinning is known for Alzheimer’s disease patients even though the evolution may vary temporally along the continuum and spatially across the brain. Hence, nonlinear models are flexible to model such variability.</p>
        <p id="Par51">In this analysis we use publicly available data from the Alzheimer’s Disease Neuroimaging Initiative (ADNI, <ext-link ext-link-type="uri" xlink:href="http://adni.loni.usc.edu/">http://adni.loni.usc.edu/</ext-link>). We use baseline average cortical thickness for each of the K<sub>ROI</sub> = 68 ROIs using the Desikan-Killiany atlas (Desikan et al. <xref ref-type="bibr" rid="CR8">2006</xref>) and CSF biomarkers measurements from a total of 610 subjects. We use a sex and a second order polynomial expansion of age as correctors. From CSF biomarkers we use Aβ and tau values to construct the AD-CSF index (Molinuevo et al. <xref ref-type="bibr" rid="CR28">2013</xref>) as the predictor. In fig. <xref rid="Fig4" ref-type="fig">4</xref> we show the distribution of subjects and its related age along the AD-CSF index. Following ADNI guidelines, 191 subjects labeled as cognitively unimpaired, 284 subjects were labeled as having mild cognitive impairment and 135 subjects were diagnosed with dementia.<fig id="Fig4"><label>Fig. 4</label><caption><p>Subject distribution (left) and age distribution (right) along the AD-CSF index of the subset of ADNI used in the analysis. For the subject distribution we compute the histogram while for the age distribution we show a boxplot splitting the AD-CSF index into deciles</p></caption><graphic xlink:href="12021_2020_9456_Fig4_HTML" id="MO4"/></fig></p>
        <p id="Par52">We compare linear and non-linear models, being the latter more statistically significant across the brain (figs. <xref rid="Fig5" ref-type="fig">5</xref>, <xref rid="Fig6" ref-type="fig">6</xref>). In fig. <xref rid="Fig5" ref-type="fig">5</xref> we show statistical inference maps comparing three different fitting methods: (a) GLM, (b) GAM and (c) SVR with polynomial kernel. For each method we compute and F-test with statistical significance <italic>p</italic> &lt; 0.001 uncorrected. Using a best map we see that GAM method has generally better inference metrics while using the RGB map we see that the linear method missed many regions outside the temporal lobe. Finally, Fig. <xref rid="Fig6" ref-type="fig">6</xref> shows the fitted curves for the left entorhinal and the right hippocampus. Similar effects on the extreme values as the ones described in the previous dataset can be observed in Fig. <xref rid="Fig6" ref-type="fig">6</xref> with parametric fitting, which are much alleviated with other non-linear fitting methods.<fig id="Fig5"><label>Fig. 5</label><caption><p>Statistical comparison maps between three different curve fitting methods (GLM, GAM and SVR with polynomial kernel). We use an RGB map (A) to show regions relevant for each method with the following legend: yellow (only GAM) green (only SVR), light blue (GAM and SVR) and dark blue (GLM, GAM, SVR). We use the best map (B) to show the method with best statistical inference metrics with the following legend: red (GLM), green (GAM), blue (SVR)</p></caption><graphic xlink:href="12021_2020_9456_Fig5_HTML" id="MO5"/></fig><fig id="Fig6"><label>Fig. 6</label><caption><p>Generated curves for the evolution of cortical thickness of the left entorhinal (left) and the right parahippocampal (right) regions. For each ROI we use a linear (GLM) and two nonlinear (GAM and SVR with polynomial kernel) models. All three are statistically relevant for the left entorhinal while only the two nonlinear models appear to be relevant for the right hippocampal</p></caption><graphic xlink:href="12021_2020_9456_Fig6_HTML" id="MO6"/></fig></p>
      </sec>
    </sec>
    <sec id="Sec19">
      <title>Case Study 2: Effects of <italic>APOE</italic>-ε4 in Brain Aging</title>
      <p id="Par53">The ε4 allele of the apolipoprotein E (<italic>APOE</italic>) gene is the strongest genetic risk factor for AD. <italic>APOE</italic> is polymorphic and contains three different alleles referred as <italic>APOE</italic>-ε2, −ε3 and -ε4 coding three different isoforms and six different genotypes. Here, we apply NeAT to analyze the interaction between <italic>APOE</italic>-ε4 allele load and age on the brain morphology of middle-aged cognitively unimpaired individuals, thus expanding previously published results in Cacciaglia et al. (<xref ref-type="bibr" rid="CR6">2018</xref>). The ALFA (ALzheimer’s and FAmilies) cohort presented in Molinuevo et al. (<xref ref-type="bibr" rid="CR29">2016</xref>) was used for this purpose, involving 533 subjects that underwent <italic>APOE</italic> genotyping and an MRI scan. For statistical analysis, participants were pooled according to the <italic>APOE</italic>-ε4 allele load: 65 homozygotes (HO) that have <italic>APOE</italic>-genotype with 2 copies of the <italic>APOE</italic>-ε4 allele, 207 heterozygotes (HE) with a single copy of the <italic>APOE</italic>-ε4 allele and 261 non-carriers (NC).</p>
      <sec id="Sec20">
        <title><italic>APOE</italic> Genotype Effects on Brain Morphology in Normal Aging</title>
        <p id="Par54">In this case study, we replicate the results of Cacciaglia et al. (<xref ref-type="bibr" rid="CR6">2018</xref>) with respect to the <italic>APOE</italic> genotype effects on brain morphology with NeAT and use it to expand previously described non-linear effects. The baseline model consists of three dummy variables characterizing each genotype (NC, HE, HO) defining the number of ε4 alleles. Sex, years of education, total intracranial volume and linear and quadratic expansions of age were included as covariates. Due to the reported interactions (ten Kate et al. <xref ref-type="bibr" rid="CR38">2016</xref>) of <italic>APOE</italic> status and age, we fit the model with the interaction terms <italic>APOE</italic>x <italic>age</italic> and <italic>APOE</italic>x <italic>age</italic><sup>2</sup>. We apply the contrast [−1,0,1] on dummy variables indicating <italic>APOE-ε4</italic> allele load, defining an additive model that predicts incremental/decremental effects of <italic>APOE-ε4</italic> homozygotes. Results using the linear model are shown in fig. <xref rid="Fig7" ref-type="fig">7(A)</xref>, replicating the findings in Cacciaglia et al. (<xref ref-type="bibr" rid="CR6">2018</xref>). The use of the tool allowed us to study non-linear effects of the genotype. Concretely, in fig. <xref rid="Fig7" ref-type="fig">7b and c</xref> we show results using GAM and SVR with polynomial kernel models, respectively. Smaller effects are observed and only relevant effects are found in regions such as bilateral thalamus, right hippocampus, right superior frontal and small cluster around the right caudate and the left middle occipital. Nonlinear modeling fail behind linear modeling of <italic>APOE-ε4</italic> count, probably because it is a categorical (C = 3) predictor. Hence, due to higher degrees of freedom used in GAM and SVR, only larger significant values survive the used threshold.<fig id="Fig7"><label>Fig. 7</label><caption><p>Statistical inference using volumetric data and different curve fitting modules: using GLM (A), using GAM (B) and using SVR with a polynomial kernel (C). For visualization purposes, statistical significance threshold is set to <italic>p</italic> &lt; 0.05 uncorrected</p></caption><graphic xlink:href="12021_2020_9456_Fig7_HTML" id="MO7"/></fig></p>
        <p id="Par55">Using the tool, we could also study the <italic>APOE</italic> genotype effects in cortical thickness data. In fig. <xref rid="Fig8" ref-type="fig">8</xref>, we show the results on different surface views using the GLM model. In this case, even smaller effects are found being statistically relevant (<italic>p</italic> &lt; 0.05) in small clusters across the brain, specially in regions such as the insular cortex and fusiform.<fig id="Fig8"><label>Fig. 8</label><caption><p>Statistical inference using cortical thickness data and GLM. For visualization purposes, statistical significance threshold is set to <italic>p</italic> &lt; 0.05 uncorrected</p></caption><graphic xlink:href="12021_2020_9456_Fig8_HTML" id="MO8"/></fig></p>
      </sec>
      <sec id="Sec21">
        <title>Interaction between <italic>APOE</italic> Genotype and Age in Normal Aging Population</title>
        <p id="Par56">In this second part, we investigate the interaction between <italic>APOE</italic> genotype and age on brain morphology. For this purpose, we model each <italic>APOE</italic> genotype separately to find their associated curves and generate a goodness-of-fit metric using the F-test. Statistical inference threshold is set to <italic>p</italic> &lt; 0.001. We perform post-hoc analysis combining statistical maps into an RGB-map that sums up the results of all three <italic>APOE</italic>-genotype models: we place each model (NC, HE, HO) in each R, G, B channel, respectively. Volumetric and cortical thickness analyses were performed but no significant results were found with the later.</p>
        <p id="Par57">In fig. <xref rid="Fig9" ref-type="fig">9</xref>, we show the RGB-map and the associated curves of regions corresponding to significant effect of age on brain morphology of homozygotes <italic>APOE</italic>-e4 carriers (see section 3.2.1): right hippocampus, right caudate and right cerebellar crus. We present two different curve fitting models: using polynomial expansion of second order of the GLM on the left and B-splines GAM on the right.<fig id="Fig9"><label>Fig. 9</label><caption><p>Interaction between age and the APOE-ε4 genotype using second order polynomial expansion of GLM (left) and B-splines GAM (right). Three different regions are shown at each row: (A) right hippocampus, (B) right caudate and (C) right cerebellar crus. Statistical analysis using F-test and uncorrected <italic>p</italic> &lt; 0.001 threshold with cluster size of 100 voxels. Statistical comparison using the RGB map, where R corresponds to 0 copies of the allele, G to 1 copy and B to 2 copies. Other colors are any possible combination of them, meaning that are relevant for more than one APOE genotype</p></caption><graphic xlink:href="12021_2020_9456_Fig9_HTML" id="MO9"/></fig></p>
        <p id="Par58">Clearly, relevant regions for the HO group show nonlinear relationship between age and voxel intensities. Statistical and <italic>RGB-maps</italic> present analogous results on polynomial expansion of GLM and GAM analysis. The right hippocampus and the right cerebellar crus follow a quadratic curve with age similar to GLM fitting. HO subjects show an earlier decreasing of GMv in both regions compared to NC and HE around their fifties with an initial volumetric increase in middle-aged individuals, more pronounced in the cerebellum, again replicating the results in Cacciaglia et al. (<xref ref-type="bibr" rid="CR6">2018</xref>). On the other hand, GMv volume on the right caudate appears to decrease at the sixth decade for all <italic>APOE</italic> genotypes but decaying faster for HO subjects. Due to the non-quadratic behaviour of the right caudate, it appears to be better modeled with GAM, as shown in fig. <xref rid="Fig10" ref-type="fig">10</xref>.<fig id="Fig10"><label>Fig. 10</label><caption><p>Differences between statistical maps of the HE model using GLM and GAM at different brain ROIs: right hippocampus (A), right caudate (B) and right cerebellar crus (C). A positive (negative) value indicates that GAM (GLM) is statistically better using the f-test metric</p></caption><graphic xlink:href="12021_2020_9456_Fig10_HTML" id="MO10"/></fig></p>
      </sec>
    </sec>
  </sec>
  <sec id="Sec22">
    <title>Conclusions</title>
    <p id="Par59">In this paper, we present NeAT; a tool for non-linear analysis of neuroimaging data at the voxel or surface levels and illustrate its functionality in three case studies where a nonlinear behavior of brain morphology was previously described. NeAT is a modular, flexible and user-friendly toolbox that provides advanced curve fitting methods for voxelwise and surface-based modeling and different metrics for statistical inference of the results. Visualization features are available, such as an interactive GUI that shows statistical maps together with the resulting fitted curves. Finally, post-hoc analysis functionalities such as model comparison (e.g: linear vs. non-linear) or a curve clustering algorithm that show similar fittings across the brain are available. Altogether, NeAT constitutes a complementary tool for the standard processing of non-linear associations between neuroimaging data and a set of factors (e.g: age, environmental factors, disease, genetics or demographics) at the voxel and surface levels.</p>
    <sec id="FPar2">
      <title>Future Work</title>
      <p id="Par60">the potential of NeAT is expected to expand as it will grow. At the short term, the expansion of the tool to ROI-based analysis is granted. Moreover, a longitudinal analysis module might be interesting due to the increasing number of cohorts with longitudinal follow-up visits. Seemingly, the integration of fMRI modality should be considered in future revisions of the toolbox. Other statistical methods, such as Partial Least Squares (PLS) or Canonical Correlation Analysis (CCA) can be incorporated for multivariate effects modeling. Finally, other curve fitting models (e.g: based on neural networks) can be designed and implemented.</p>
    </sec>
  </sec>
  <sec id="Sec23">
    <title>Information Sharing Statement</title>
    <p id="Par61">The source code of the presented method is freely available for non-commercial use from <ext-link ext-link-type="uri" xlink:href="https://imatge-upc.github.io/neat-tool/">https://imatge-upc.github.io/neat-tool/</ext-link>.</p>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p>Alzheimer’s Disease Neuroimaging Initiative (ADNI) is a Group/Institutional Author.</p>
      <p>Data used in preparation of this article were obtained from the Alzheimer’s Disease Neuroimaging Initiative (ADNI) database (adni.loni.ucla.edu). As such, the investigators within the ADNI contributed to the design and implementation of ADNI and/or provided data but did not participate in analysis or writing of this report. A complete listing of ADNI investigators can be found at: <ext-link ext-link-type="uri" xlink:href="http://adni.loni.ucla.edu/wpcontent/uploads/how_to_apply/ADN">http://adni.loni.ucla.edu/wpcontent/uploads/how_to_apply/ADN</ext-link> I_Acknowledgement_List.pdf</p>
    </fn>
    <fn>
      <p>
        <bold>Publisher’s Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>This work has been partially supported by the project MALEGRA TEC2016-75976-R financed by the Spanish Ministerio de Economía y Competitividad and the European Regional Development Fund (ERDF). Adrià Casamitjana is supported by the Spanish “Ministerio de Educación, Cultura y Deporte” FPU Research Fellowship. Juan D. Gispert holds a “‘Ramón y Cajal’” fellowship (RYC-2013-13054).</p>
    <p>Data used in preparation of this article were obtained from the Alzheimer’s Disease Neuroimaging Initiative (ADNI) database (<ext-link ext-link-type="uri" xlink:href="http://adni.loni.usc.edu">adni.loni.usc.edu</ext-link>). As such, the investigators within the ADNI contributed to the design and implementation of ADNI and/or provided data but did not participate in analysis or writing of this report. A complete listing of ADNI investigators can be found at: <ext-link ext-link-type="uri" xlink:href="http://adni.loni.usc.edu/wpcontent/uploads/how">http://adni.loni.usc.edu/wpcontent/uploads/how</ext-link> to apply/ADNI Acknowledgement List.pdf.</p>
  </ack>
  <notes>
    <title>Compliance with Ethical Standards</title>
    <notes id="FPar3" notes-type="COI-statement">
      <title>Conflict of Interest</title>
      <p id="Par62">Author Santi Puch is employed by company QMENTA and author Asier Aduriz is employed by company VILYNX. All other authors declare no competing interests.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ashburner</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Friston</surname>
            <given-names>KJ</given-names>
          </name>
        </person-group>
        <article-title>Voxel-based morphometry—The methods</article-title>
        <source>Neuroimage</source>
        <year>2000</year>
        <volume>11</volume>
        <issue>6</issue>
        <fpage>805</fpage>
        <lpage>821</lpage>
        <pub-id pub-id-type="doi">10.1006/nimg.2000.0582</pub-id>
        <pub-id pub-id-type="pmid">10860804</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bateman</surname>
            <given-names>RJ</given-names>
          </name>
          <name>
            <surname>Xiong</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Benzinger</surname>
            <given-names>TL</given-names>
          </name>
          <name>
            <surname>Fagan</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Goate</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Fox</surname>
            <given-names>NC</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Clinical and biomarker changes in dominantly inherited Alzheimer's disease</article-title>
        <source>N Engl J Med</source>
        <year>2012</year>
        <volume>367</volume>
        <issue>9</issue>
        <fpage>795</fpage>
        <lpage>804</lpage>
        <pub-id pub-id-type="doi">10.1056/NEJMoa1202753</pub-id>
        <pub-id pub-id-type="pmid">22784036</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Breeze</surname>
            <given-names>JL</given-names>
          </name>
          <name>
            <surname>Poline</surname>
            <given-names>JB</given-names>
          </name>
          <name>
            <surname>Kennedy</surname>
            <given-names>DN</given-names>
          </name>
        </person-group>
        <article-title>Data sharing and publishing in the field of neuroimaging</article-title>
        <source>GigaScience</source>
        <year>2012</year>
        <volume>1</volume>
        <issue>1</issue>
        <fpage>9</fpage>
        <pub-id pub-id-type="doi">10.1186/2047-217X-1-9</pub-id>
        <pub-id pub-id-type="pmid">23587272</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Breiman</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Friedman</surname>
            <given-names>JH</given-names>
          </name>
        </person-group>
        <article-title>Estimating optimal transformations for multiple regression and correlation</article-title>
        <source>J Am Stat Assoc</source>
        <year>1985</year>
        <volume>80</volume>
        <issue>391</issue>
        <fpage>580</fpage>
        <lpage>598</lpage>
        <pub-id pub-id-type="doi">10.1080/01621459.1985.10478157</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <mixed-citation publication-type="other">Brett, M., Hanke, M., Cipollini, B., Côté, M. A., Markiewicz, C., Gerhard, S., Larson, E., Lee, G. R., Halchenko, Y., Kastman, E., Morency, F. C., Millman, J., Rokem, A., Gramfort, A., van den Bosch, J. J. F., Subramaniam, K., Nichols, N., Oosterhof, N. N., St-Jean, S., Amirbekian, B., Nimmo-Smith, I., Ghosh, S., Varoquaux, G., Garyfallidis, E. (2016). nibabel: 2.1. 0.</mixed-citation>
    </ref>
    <ref id="CR6">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cacciaglia</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Molinuevo</surname>
            <given-names>JL</given-names>
          </name>
          <name>
            <surname>Falcón</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Brugulat-Serrat</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Sánchez-Benavides</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Gramunt</surname>
            <given-names>N</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Effects of APOE-ε4 allele load on brain morphology in a cohort of middle-aged healthy individuals with enriched genetic risk for Alzheimer's disease</article-title>
        <source>Alzheimers Dement</source>
        <year>2018</year>
        <volume>14</volume>
        <issue>7</issue>
        <fpage>902</fpage>
        <lpage>912</lpage>
        <pub-id pub-id-type="doi">10.1016/j.jalz.2018.01.016</pub-id>
        <pub-id pub-id-type="pmid">29605385</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <mixed-citation publication-type="other">Christensen, R. (2011). Plane answers to complex questions: The theory of linear models<bold>.</bold><italic>Springer Science &amp; Business Media</italic>.</mixed-citation>
    </ref>
    <ref id="CR8">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Desikan</surname>
            <given-names>RS</given-names>
          </name>
          <name>
            <surname>Ségonne</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Fischl</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Quinn</surname>
            <given-names>BT</given-names>
          </name>
          <name>
            <surname>Dickerson</surname>
            <given-names>BC</given-names>
          </name>
          <name>
            <surname>Blacker</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>An automated labeling system for subdividing the human cerebral cortex on MRI scans into gyral based regions of interest</article-title>
        <source>Neuroimage</source>
        <year>2006</year>
        <volume>31</volume>
        <issue>3</issue>
        <fpage>968</fpage>
        <lpage>980</lpage>
        <pub-id pub-id-type="doi">10.1016/j.neuroimage.2006.01.021</pub-id>
        <pub-id pub-id-type="pmid">16530430</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dinuzzo</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Neve</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Nicolao</surname>
            <given-names>GD</given-names>
          </name>
          <name>
            <surname>Gianazza</surname>
            <given-names>UP</given-names>
          </name>
        </person-group>
        <article-title>On the representer theorem and equivalent degrees of freedom of SVR</article-title>
        <source>J Mach Learn Res</source>
        <year>2007</year>
        <volume>8</volume>
        <issue>Oct</issue>
        <fpage>2467</fpage>
        <lpage>2495</lpage>
      </element-citation>
    </ref>
    <ref id="CR10">
      <mixed-citation publication-type="other">Drucker, H., Burges, C. J., Kaufman, L., Smola, A. J., &amp; Vapnik, V. (1997). Support vector regression machines. <italic>Advances in neural information processing systems, 9</italic>, 155–161.</mixed-citation>
    </ref>
    <ref id="CR11">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fischl</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>FreeSurfer</article-title>
        <source>Neuroimage</source>
        <year>2012</year>
        <volume>62</volume>
        <issue>2</issue>
        <fpage>774</fpage>
        <lpage>781</lpage>
        <pub-id pub-id-type="doi">10.1016/j.neuroimage.2012.01.021</pub-id>
        <pub-id pub-id-type="pmid">22248573</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fjell</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Walhovd</surname>
            <given-names>KB</given-names>
          </name>
          <name>
            <surname>Westlye</surname>
            <given-names>LT</given-names>
          </name>
          <name>
            <surname>Østby</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Tamnes</surname>
            <given-names>CK</given-names>
          </name>
          <name>
            <surname>Jernigan</surname>
            <given-names>TL</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>When does brain aging accelerate? Dangers of quadratic fits in cross-sectional studies</article-title>
        <source>Neuroimage</source>
        <year>2010</year>
        <volume>50</volume>
        <issue>4</issue>
        <fpage>1376</fpage>
        <lpage>1383</lpage>
        <pub-id pub-id-type="doi">10.1016/j.neuroimage.2010.01.061</pub-id>
        <pub-id pub-id-type="pmid">20109562</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fjell</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Westlye</surname>
            <given-names>LT</given-names>
          </name>
          <name>
            <surname>Grydeland</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Amlien</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Espeseth</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Reinvang</surname>
            <given-names>I</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Critical ages in the life course of the adult brain: Nonlinear subcortical aging</article-title>
        <source>Neurobiol Aging</source>
        <year>2013</year>
        <volume>34</volume>
        <issue>10</issue>
        <fpage>2239</fpage>
        <lpage>2247</lpage>
        <pub-id pub-id-type="doi">10.1016/j.neurobiolaging.2013.04.006</pub-id>
        <pub-id pub-id-type="pmid">23643484</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Frackowiak</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Lenzi</surname>
            <given-names>GL</given-names>
          </name>
          <name>
            <surname>Jones</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Heather</surname>
            <given-names>JD</given-names>
          </name>
        </person-group>
        <article-title>Quantitative measurement of regional cerebral blood flow and oxygen metabolism in man using 15O and positron emission tomography: Theory, procedure, and normal values</article-title>
        <source>J Comput Assist Tomogr</source>
        <year>1980</year>
        <volume>4</volume>
        <issue>6</issue>
        <fpage>727</fpage>
        <lpage>736</lpage>
        <pub-id pub-id-type="doi">10.1097/00004728-198012000-00001</pub-id>
        <pub-id pub-id-type="pmid">6971299</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Freeborough</surname>
            <given-names>PA</given-names>
          </name>
          <name>
            <surname>Fox</surname>
            <given-names>NC</given-names>
          </name>
        </person-group>
        <article-title>The boundary shift integral: An accurate and robust measure of cerebral volume changes from registered repeat MRI</article-title>
        <source>IEEE Trans Med Imaging</source>
        <year>1997</year>
        <volume>16</volume>
        <issue>5</issue>
        <fpage>623</fpage>
        <lpage>629</lpage>
        <pub-id pub-id-type="doi">10.1109/42.640753</pub-id>
        <pub-id pub-id-type="pmid">9368118</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Friston</surname>
            <given-names>KJ</given-names>
          </name>
          <name>
            <surname>Holmes</surname>
            <given-names>AP</given-names>
          </name>
          <name>
            <surname>Worsley</surname>
            <given-names>KJ</given-names>
          </name>
          <name>
            <surname>Poline</surname>
            <given-names>JP</given-names>
          </name>
          <name>
            <surname>Frith</surname>
            <given-names>CD</given-names>
          </name>
          <name>
            <surname>Frackowiak</surname>
            <given-names>RS</given-names>
          </name>
        </person-group>
        <article-title>Statistical parametric maps in functional imaging: A general linear approach</article-title>
        <source>Hum Brain Mapp</source>
        <year>1994</year>
        <volume>2</volume>
        <issue>4</issue>
        <fpage>189</fpage>
        <lpage>210</lpage>
        <pub-id pub-id-type="doi">10.1002/hbm.460020402</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gispert</surname>
            <given-names>JD</given-names>
          </name>
          <name>
            <surname>Rami</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Sánchez-Benavides</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Falcon</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Tucholka</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Rojas</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Molinuevo</surname>
            <given-names>JL</given-names>
          </name>
        </person-group>
        <article-title>Nonlinear cerebral atrophy patterns across the Alzheimer's disease continuum: Impact of APOE4 genotype</article-title>
        <source>Neurobiol Aging</source>
        <year>2015</year>
        <volume>36</volume>
        <issue>10</issue>
        <fpage>2687</fpage>
        <lpage>2701</lpage>
        <pub-id pub-id-type="doi">10.1016/j.neurobiolaging.2015.06.027</pub-id>
        <pub-id pub-id-type="pmid">26239178</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <mixed-citation publication-type="other">Hastie, T., &amp; Tibshirani, R. (1987). Generalized additive models: some applications. <italic>Journal of the American Statistical Association, 82</italic>(398), 371–386. </mixed-citation>
    </ref>
    <ref id="CR19">
      <mixed-citation publication-type="other">Henson, R. N. A., &amp; Penny, W. D. (2003). ANOVAs and SPM. <italic>Technical Report </italic>Wellcome Department of Imaging Neuroscience, London.</mixed-citation>
    </ref>
    <ref id="CR20">
      <mixed-citation publication-type="other">Hsu, C. W., Chang, C. C., &amp; Lin, C. J. (2003). A practical guide to support vector classification<bold>. </bold><italic>Technical Report, Department of Computer Science, National Taiwan University</italic></mixed-citation>
    </ref>
    <ref id="CR21">
      <mixed-citation publication-type="other">Insel, P. S., Mattsson, N., Donohue, M. C., Mackin, R. S., Aisen, P. S., Jack Jr, C. R., Shaw, L. M., Trojanowski, J. Q., Weiner, M. W., Alzheimer's Disease Neuroimaging Initiative et al. (2015). The transitional association between β-amyloid pathology and regional brain atrophy. <italic>Alzheimer’s &amp; Dementia 11</italic>(10), 1171–1179.</mixed-citation>
    </ref>
    <ref id="CR22">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Insel</surname>
            <given-names>PS</given-names>
          </name>
          <name>
            <surname>Ossenkoppele</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Gessert</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Jagust</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Landau</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Hansson</surname>
            <given-names>O</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Time to amyloid positivity and preclinical changes in brain metabolism, atrophy, and cognition: Evidence for emerging amyloid pathology in Alzheimer's disease</article-title>
        <source>Front Neurosci</source>
        <year>2017</year>
        <volume>11</volume>
        <fpage>281</fpage>
        <pub-id pub-id-type="doi">10.3389/fnins.2017.00281</pub-id>
        <pub-id pub-id-type="pmid">28567001</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jacques</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Preda</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Functional data clustering: A survey</article-title>
        <source>ADAC</source>
        <year>2014</year>
        <volume>8</volume>
        <issue>3</issue>
        <fpage>231</fpage>
        <lpage>255</lpage>
        <pub-id pub-id-type="doi">10.1007/s11634-013-0158-y</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>James</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Witten</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Hastie</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Tibshirani</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <source>An introduction to statistical learning (Vol. 112, p. 18)</source>
        <year>2013</year>
        <publisher-loc>New York</publisher-loc>
        <publisher-name>Springer</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR25">
      <mixed-citation publication-type="other">Jones, E., Oliphant, T., &amp; Peterson, P. (2014). others.(2001). SciPy: Open source scientific tools for Python. Online at: http://www scipy org.</mixed-citation>
    </ref>
    <ref id="CR26">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kornak</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Fields</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Farmer</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Boeve</surname>
            <given-names>BF</given-names>
          </name>
          <name>
            <surname>Rosen</surname>
            <given-names>HJ</given-names>
          </name>
          <name>
            <surname>Boxer</surname>
            <given-names>AL</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Nonlinear N-score estimation for establishing cognitive norms from the National Alzheimer’s coordinating center (NACC) dataset</article-title>
        <source>Alzheimer's &amp; Dementia: The Journal of the Alzheimer's Association</source>
        <year>2018</year>
        <volume>14</volume>
        <issue>7</issue>
        <fpage>P390</fpage>
        <lpage>P391</lpage>
        <pub-id pub-id-type="doi">10.1016/j.jalz.2018.06.287</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mendiondo</surname>
            <given-names>MS</given-names>
          </name>
          <name>
            <surname>Ashford</surname>
            <given-names>JW</given-names>
          </name>
          <name>
            <surname>Kryscio</surname>
            <given-names>RJ</given-names>
          </name>
          <name>
            <surname>Schmitt</surname>
            <given-names>FA</given-names>
          </name>
        </person-group>
        <article-title>Modelling mini mental state examination changes in Alzheimer's disease</article-title>
        <source>Stat Med</source>
        <year>2000</year>
        <volume>19</volume>
        <issue>11–12</issue>
        <fpage>1607</fpage>
        <lpage>1616</lpage>
        <pub-id pub-id-type="doi">10.1002/(SICI)1097-0258(20000615/30)19:11/12&lt;1607::AID-SIM449&gt;3.0.CO;2-O</pub-id>
        <pub-id pub-id-type="pmid">10844722</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Molinuevo</surname>
            <given-names>JL</given-names>
          </name>
          <name>
            <surname>Gispert</surname>
            <given-names>JD</given-names>
          </name>
          <name>
            <surname>Dubois</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Heneka</surname>
            <given-names>MT</given-names>
          </name>
          <name>
            <surname>Lleo</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Engelborghs</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The AD-CSF-index discriminates Alzheimer's disease patients from healthy controls: A validation study</article-title>
        <source>J Alzheimers Dis</source>
        <year>2013</year>
        <volume>36</volume>
        <issue>1</issue>
        <fpage>67</fpage>
        <lpage>77</lpage>
        <pub-id pub-id-type="doi">10.3233/JAD-130203</pub-id>
        <pub-id pub-id-type="pmid">23524657</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Molinuevo</surname>
            <given-names>JL</given-names>
          </name>
          <name>
            <surname>Gramunt</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Gispert</surname>
            <given-names>JD</given-names>
          </name>
          <name>
            <surname>Fauria</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Esteller</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Minguillon</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Sánchez-Benavides</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Huesa</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Morán</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Dal-Ré</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Camí</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>The ALFA project: A research platform to identify early pathophysiological features of Alzheimer's disease</article-title>
        <source>Alzheimer's &amp; Dementia: Translational Research &amp; Clinical Interventions</source>
        <year>2016</year>
        <volume>2</volume>
        <issue>2</issue>
        <fpage>82</fpage>
        <lpage>92</lpage>
        <pub-id pub-id-type="doi">10.1016/j.trci.2016.02.003</pub-id>
        <pub-id pub-id-type="pmid">29067295</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Murtagh</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Legendre</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Ward’s hierarchical agglomerative clustering method: Which algorithms implement Ward’s criterion?</article-title>
        <source>J Classif</source>
        <year>2014</year>
        <volume>31</volume>
        <issue>3</issue>
        <fpage>274</fpage>
        <lpage>295</lpage>
        <pub-id pub-id-type="doi">10.1007/s00357-014-9161-z</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pedregosa</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Varoquaux</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Gramfort</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Michel</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Thirion</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Grisel</surname>
            <given-names>O</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Scikit-learn: Machine learning in Python</article-title>
        <source>J Mach Learn Res</source>
        <year>2011</year>
        <volume>12</volume>
        <issue>Oct</issue>
        <fpage>2825</fpage>
        <lpage>2830</lpage>
      </element-citation>
    </ref>
    <ref id="CR32">
      <mixed-citation publication-type="other">Penny, W. D., Friston, K. J., Ashburner, J. T., Kiebel, S. J., &amp; Nichols, T. E. (2011). Statistical parametric mapping: The analysis of functional brain images. <italic>Elsevier</italic>.</mixed-citation>
    </ref>
    <ref id="CR33">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rousseeuw</surname>
            <given-names>PJ</given-names>
          </name>
        </person-group>
        <article-title>Silhouettes: A graphical aid to the interpretation and validation of cluster analysis</article-title>
        <source>J Comput Appl Math</source>
        <year>1987</year>
        <volume>20</volume>
        <fpage>53</fpage>
        <lpage>65</lpage>
        <pub-id pub-id-type="doi">10.1016/0377-0427(87)90125-7</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sabuncu</surname>
            <given-names>MR</given-names>
          </name>
          <name>
            <surname>Desikan</surname>
            <given-names>RS</given-names>
          </name>
          <name>
            <surname>Sepulcre</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Yeo</surname>
            <given-names>BTT</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Schmansky</surname>
            <given-names>NJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The dynamics of cortical and hippocampal atrophy in Alzheimer’s disease</article-title>
        <source>Arch Neurol</source>
        <year>2011</year>
        <volume>68</volume>
        <issue>8</issue>
        <fpage>1040</fpage>
        <lpage>1048</lpage>
        <pub-id pub-id-type="doi">10.1001/archneurol.2011.167</pub-id>
        <pub-id pub-id-type="pmid">21825241</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Sakamoto</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Ishiguro</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Kitagawa</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <source>Akaike information criterion statistics</source>
        <year>1986</year>
        <publisher-loc>Dordrecht</publisher-loc>
        <publisher-name>D. Reidel</publisher-name>
        <fpage>81</fpage>
      </element-citation>
    </ref>
    <ref id="CR36">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Samtani</surname>
            <given-names>MN</given-names>
          </name>
          <name>
            <surname>Farnum</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Lobanov</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Raghavan</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>DiBernardo</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>An improved model for disease progression in patients from the Alzheimer's disease neuroimaging initiative</article-title>
        <source>J Clin Pharmacol</source>
        <year>2012</year>
        <volume>52</volume>
        <issue>5</issue>
        <fpage>629</fpage>
        <lpage>644</lpage>
        <pub-id pub-id-type="doi">10.1177/0091270011405497</pub-id>
        <pub-id pub-id-type="pmid">21659625</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schuff</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Tosun</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Insel</surname>
            <given-names>PS</given-names>
          </name>
          <name>
            <surname>Chiang</surname>
            <given-names>GC</given-names>
          </name>
          <name>
            <surname>Truran</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Aisen</surname>
            <given-names>PS</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Nonlinear time course of brain volume loss in cognitively normal and impaired elders</article-title>
        <source>Neurobiol Aging</source>
        <year>2012</year>
        <volume>33</volume>
        <issue>5</issue>
        <fpage>845</fpage>
        <lpage>855</lpage>
        <pub-id pub-id-type="doi">10.1016/j.neurobiolaging.2010.07.012</pub-id>
        <pub-id pub-id-type="pmid">20855131</pub-id>
      </element-citation>
    </ref>
    <ref id="CR38">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>ten Kate</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Sanz-Arigita</surname>
            <given-names>EJ</given-names>
          </name>
          <name>
            <surname>Tijms</surname>
            <given-names>BM</given-names>
          </name>
          <name>
            <surname>Wink</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Clerigue</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Garcia-Sebastian</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Impact of APOE-ɛ4 and family history of dementia on gray matter atrophy in cognitively healthy middle-aged adults</article-title>
        <source>Neurobiol Aging</source>
        <year>2016</year>
        <volume>38</volume>
        <fpage>14</fpage>
        <lpage>20</lpage>
        <pub-id pub-id-type="doi">10.1016/j.neurobiolaging.2015.10.018</pub-id>
        <pub-id pub-id-type="pmid">26827639</pub-id>
      </element-citation>
    </ref>
    <ref id="CR39">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Villemagne</surname>
            <given-names>VL</given-names>
          </name>
          <name>
            <surname>Burnham</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Bourgeat</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Brown</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Ellis</surname>
            <given-names>KA</given-names>
          </name>
          <name>
            <surname>Salvado</surname>
            <given-names>O</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Amyloid β deposition, neurodegeneration, and cognitive decline in sporadic Alzheimer's disease: A prospective cohort study</article-title>
        <source>The Lancet Neurology</source>
        <year>2013</year>
        <volume>12</volume>
        <issue>4</issue>
        <fpage>357</fpage>
        <lpage>367</lpage>
        <pub-id pub-id-type="doi">10.1016/S1474-4422(13)70044-9</pub-id>
        <pub-id pub-id-type="pmid">23477989</pub-id>
      </element-citation>
    </ref>
    <ref id="CR40">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Vinke</surname>
            <given-names>EJ</given-names>
          </name>
          <name>
            <surname>De Groot</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Venkatraghavan</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Klein</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Niessen</surname>
            <given-names>WJ</given-names>
          </name>
          <name>
            <surname>Ikram</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Vernooij</surname>
            <given-names>MW</given-names>
          </name>
        </person-group>
        <article-title>Trajectories of imaging markers in brain aging: The Rotterdam study</article-title>
        <source>Neurobiol Aging</source>
        <year>2018</year>
        <volume>71</volume>
        <fpage>32</fpage>
        <lpage>40</lpage>
        <pub-id pub-id-type="doi">10.1016/j.neurobiolaging.2018.07.001</pub-id>
        <pub-id pub-id-type="pmid">30077040</pub-id>
      </element-citation>
    </ref>
    <ref id="CR41">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ziegler</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Dahnke</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Gaser</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Models of the aging brain structure and individual decline</article-title>
        <source>Frontiers in neuroinformatics</source>
        <year>2012</year>
        <volume>6</volume>
        <fpage>3</fpage>
        <pub-id pub-id-type="doi">10.3389/fninf.2012.00003</pub-id>
        <pub-id pub-id-type="pmid">22435060</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
