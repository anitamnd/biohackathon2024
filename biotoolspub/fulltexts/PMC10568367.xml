<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10568367</article-id>
    <article-id pub-id-type="pmid">37774005</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btad588</article-id>
    <article-id pub-id-type="publisher-id">btad588</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Note</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Structural Bioinformatics</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>cudaMMC: GPU-enhanced multiscale Monte Carlo chromatin 3D modelling</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Wlasnowolski</surname>
          <given-names>Michal</given-names>
        </name>
        <aff>
          <institution>Laboratory of Bioinformatics and Computational Genomics, Faculty of Mathematics and Information Science, Warsaw University of Technology, Warsaw 00-662, Poland </institution>
        </aff>
        <aff>
          <institution>Laboratory of Functional and Structural Genomics, Centre of New Technologies, University of Warsaw, Warsaw 02-097, Poland</institution>
        </aff>
        <xref rid="btad588-FM1" ref-type="author-notes"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Grabowski</surname>
          <given-names>Pawel</given-names>
        </name>
        <aff>
          <institution>Department of Information Processing Systems, Faculty of Mathematics and Information Science, Warsaw University of Technology, Warsaw 00-662, Poland </institution>
        </aff>
        <xref rid="btad588-FM1" ref-type="author-notes"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Roszczyk</surname>
          <given-names>Damian</given-names>
        </name>
        <aff>
          <institution>Department of Information Processing Systems, Faculty of Mathematics and Information Science, Warsaw University of Technology, Warsaw 00-662, Poland </institution>
        </aff>
        <xref rid="btad588-FM1" ref-type="author-notes"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Kaczmarski</surname>
          <given-names>Krzysztof</given-names>
        </name>
        <aff>
          <institution>Department of Information Processing Systems, Faculty of Mathematics and Information Science, Warsaw University of Technology, Warsaw 00-662, Poland </institution>
        </aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-3840-7610</contrib-id>
        <name>
          <surname>Plewczynski</surname>
          <given-names>Dariusz</given-names>
        </name>
        <aff>
          <institution>Laboratory of Bioinformatics and Computational Genomics, Faculty of Mathematics and Information Science, Warsaw University of Technology, Warsaw 00-662, Poland </institution>
        </aff>
        <aff>
          <institution>Laboratory of Functional and Structural Genomics, Centre of New Technologies, University of Warsaw, Warsaw 02-097, Poland</institution>
        </aff>
        <xref rid="btad588-cor1" ref-type="corresp"/>
        <!--Dariusz.Plewczynski@pw.edu.pl-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Elofsson</surname>
          <given-names>Arne</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btad588-cor1">Corresponding author. Laboratory of Bioinformatics and Computational Genomics, Faculty of Mathematics and Information Science Warsaw University of Technology ul. Koszykowa 75, 00-662 Warsaw, Poland. Tel: +48 22 234 7219. E-mail: <email>Dariusz.Plewczynski@pw.edu.pl</email> (D.P.)</corresp>
      <fn id="btad588-FM1">
        <p>Michal Wlasnowolski, Pawel Grabowski and Damian Roszczyk Equal contribution.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="collection">
      <month>10</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2023-09-29">
      <day>29</day>
      <month>9</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>29</day>
      <month>9</month>
      <year>2023</year>
    </pub-date>
    <volume>39</volume>
    <issue>10</issue>
    <elocation-id>btad588</elocation-id>
    <history>
      <date date-type="received">
        <day>06</day>
        <month>4</month>
        <year>2023</year>
      </date>
      <date date-type="rev-recd">
        <day>14</day>
        <month>8</month>
        <year>2023</year>
      </date>
      <date date-type="editorial-decision">
        <day>09</day>
        <month>9</month>
        <year>2023</year>
      </date>
      <date date-type="corrected-typeset">
        <day>11</day>
        <month>10</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2023</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btad588.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>Investigating the 3D structure of chromatin provides new insights into transcriptional regulation. With the evolution of 3C next-generation sequencing methods like ChiA-PET and Hi-C, the surge in data volume has highlighted the need for more efficient chromatin spatial modelling algorithms. This study introduces the cudaMMC method, based on the Simulated Annealing Monte Carlo approach and enhanced by GPU-accelerated computing, to efficiently generate ensembles of chromatin 3D structures.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>The cudaMMC calculations demonstrate significantly faster performance with better stability compared to our previous method on the same workstation. cudaMMC also substantially reduces the computation time required for generating ensembles of large chromatin models, making it an invaluable tool for studying chromatin spatial conformation.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>Open-source software and manual and sample data are freely available on <ext-link xlink:href="https://github.com/SFGLab/cudaMMC" ext-link-type="uri">https://github.com/SFGLab/cudaMMC</ext-link>.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>European Commission Horizon 2020</institution>
          </institution-wrap>
        </funding-source>
        <award-id>2019/35/O/ST6/02484</award-id>
        <award-id>2020/37/B/NZ2/03757</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="4"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>In recent years, the development of high-throughput sequencing methods and chromosome conformation capture (3C) technology has shown the significant influence of chromatin spatial conformation on genetic expression. Dynamic changes in the 3D structure at various levels of DNA spatial organization: from the entire chromosomes, chromosomal territories, domains (TAD, CCDs), or single chromatin loops, affect the transcription level of individual genes [reviewed in <xref rid="btad588-B2" ref-type="bibr">Chiliński <italic toggle="yes">et al.</italic> (2022)</xref>]. There is plenty of evidence that rearrangements of the spatial chromatin structure could alter gene expression. These changes may occur dynamically in the cell environment induced by heat stress or cell differentiation (<xref rid="btad588-B11" ref-type="bibr">Ray <italic toggle="yes">et al.</italic> 2019</xref>, <xref rid="btad588-B9" ref-type="bibr">Pei <italic toggle="yes">et al.</italic> 2022</xref>), as well as caused by genetic mutations, viruses infections, Structural Variations, and DNA methylations (<xref rid="btad588-B4" ref-type="bibr">Heinz <italic toggle="yes">et al.</italic> 2018</xref>, <xref rid="btad588-B6" ref-type="bibr">Lazniewski <italic toggle="yes">et al.</italic> 2019</xref>, <xref rid="btad588-B12" ref-type="bibr">Sadowski <italic toggle="yes">et al.</italic> 2019</xref>, <xref rid="btad588-B15" ref-type="bibr">Wlasnowolski <italic toggle="yes">et al.</italic> 2020</xref>). To investigate these phenomena, various algorithms for generating chromatin 3D structures have been developed. Notable examples include the methods described in <xref rid="btad588-B5" ref-type="bibr">Kadlof <italic toggle="yes">et al.</italic> (2020)</xref> and <xref rid="btad588-B3" ref-type="bibr">Di Pierro <italic toggle="yes">et al.</italic> (2016)</xref>. For a broader overview, see reviews in <xref rid="btad588-B7" ref-type="bibr">Lin <italic toggle="yes">et al.</italic> (2019)</xref>, <xref rid="btad588-B1" ref-type="bibr">Belokopytova and Fishman (2020)</xref>, and <xref rid="btad588-B8" ref-type="bibr">Madsen-Østerbye <italic toggle="yes">et al.</italic> (2022)</xref>. Among other chromatin 3D structure modelling methods, one is the <italic toggle="yes">3D-GNOME</italic> approach (<xref rid="btad588-B13" ref-type="bibr">Szałaj <italic toggle="yes">et al.</italic> 2016</xref>). 3D-GNOME enables the generation of individual 3D chromatin models and ensembles of model sets using the simulated annealing Monte Carlo approach. Modelling is performed based on a map of chromatin contacts mediated by specific proteins such as CTCF or RNAPII, which play a significant role in chromatin spatial organization. This modelling technique takes into account the hierarchical organization of the chromatin structure, from chromosome positioning to chromatin domains (TADs, CCDs), and down to individual chromatin loop shapes. Due to the substantial development of 3C techniques, the data volumes of the chromatin contacts have increased significantly. This substantially increases the computation time needed to model the ensemble of large chromosomal structures, making it less useful for genome-wide modelling. To address this challenge, we developed cudaMMC, which extended 3D-GNOME by implementing parallel acceleration using GPUs, resulting in a significant speed-up of calculations while preserving modelling quality. This improvement was essential for the calculation of spatial distance distribution between specific genomic loci, for which purpose we applied cudaMMC recently in the 3D-GNOME web server update (<xref rid="btad588-B14" ref-type="bibr">Wlasnowolski <italic toggle="yes">et al.</italic> 2023</xref>) for statistical analysis of changes of distances between gene promoters and enhancers. In addition, we added a new option for the output file format, mmCIF, which enables the presentation and analysis of chromatin 3D models using commonly used molecular 3D viewers, such as UCSF Chimera (<xref rid="btad588-B10" ref-type="bibr">Pettersen <italic toggle="yes">et al.</italic> 2004</xref>).</p>
  </sec>
  <sec>
    <title>2 Materials and methods</title>
    <sec>
      <title>2.1 <italic toggle="yes">3D-GNOME—</italic>CPU-oriented approach</title>
      <p>The <italic toggle="yes">3D-GNOME</italic> method consists of two stages. In the first one, a chromosome is divided into several regions based on PET cluster interaction patterns so that each region can correspond to one topological domain. Next, Monte Carlo simulated annealing is used to position beads to minimize energy function, considering the distance between beads corresponding to different regions. The second stage models the position of chromatin anchors within each domain independently based on energy terms. Next, chromatin loops are modelled by inserting sub-anchor beads between adjacent anchors, wherefore their position and shape are set using minimized energy function again.</p>
    </sec>
    <sec>
      <title>2.2 cudaMMC approach GPU-extended</title>
      <p>The method speed-up comes from a massive parallel search in the configuration space. The ability to run thousands of independent threads effectively at the same time gives the GPU an advantage over CPU processors for tasks which can be divided into numerous smaller parts. Parallelization will be more productive if sequential parts of the algorithm and synchronization points are minimized or completely removed. In the case of simulated annealing, the balance between parallel and sequential computations is hard to achieve since global energy is calculated after local bead matching improvement. However, if we assume that local configuration changes have an impact only in a limited surrounding area, we can propose an algorithm which solves the problem in parallel sustaining the global fitting at a level not worse than the sequential algorithm.</p>
      <p>The main proposal is based on the idea that a parallel search for a better fitting is done within a so-called threads warp, a group of 32 cooperative threads, while energy function is evaluated globally using temporal results from other warps if only possible (<xref rid="btad588-F1" ref-type="fig">Fig. 1A</xref>). A single warp optimizes a single bead using 32 threads to try random moves of that bead iteratively an arbitrarily selected number of times. Each thread chooses its best solution through the entire process, and then the parallel reduction is used to choose the best solution from all the warp. The final improvement proposal is accepted globally if it gives global improvement calculated in a given time from currently available improvements in other beads. Local improvement may not be positive if we consider other beads being modified at the same time. The overall process avoids global synchronization points, and experiments proved that the numerical stability of the method is not worse than the sequential one. The parallel method stop condition depends on the energy calculated and the number of improvement trials. In case of no possibilities of improvement, the method will finish.</p>
      <fig position="float" id="btad588-F1">
        <label>Figure 1.</label>
        <caption>
          <p>(A) Pipeline of the CUDA-based parallel simulated annealing algorithm for chromatin 3D structure modelling. (B) Speedup of the parallel algorithm in relation to chromosome size. Results shown are averages from 10 modelling runs using both methods. (C) Performance comparison between the 3D-GNOME (old) and cudaMMC (new) algorithms, based on generating ensembles of 100 models for selected chromosomes. Results shown are averages from three modelling runs for each method. (D) Full chromosomal chromatin 3D structure of chr1, based on CTCF ChIA-PET chromatin interactions from the GM12878 cell line mapped to GRCh37.</p>
        </caption>
        <graphic xlink:href="btad588f1" position="float"/>
      </fig>
    </sec>
    <sec>
      <title>2.3 Chromatin interaction data</title>
      <p>We compared cudaMMC and <italic toggle="yes">3D-GNOME</italic> algorithms on <italic toggle="yes">long-read</italic> ChIA-PET CTCF chromatin interaction data for the GM12878 cell line mapped on GRCh37, for which data <italic toggle="yes">3D-GNOME</italic> was designed (ST1). We have also performed modelling tests using cudaMMC on <italic toggle="yes">in situ</italic> ChIA-PET data for the GM12878 cell line mapped on GRCh38 (ST2). We omitted the <italic toggle="yes">3D-GNOME</italic> performance testing on GRCh38 data because of the excessive computational time required caused by the massive increase of data gained by the new ChIA-PET method.</p>
    </sec>
  </sec>
  <sec>
    <title>3 Comparison of performance between cudaMMC and 3D-GNOME</title>
    <p>We compared the performance of the cudaMMC and 3D-GNOME methods on a workstation with a NVIDIA Pascal GPU architecture and an Intel Core i9-7920X CPU. The version of 3D-GNOME used for this benchmark was sourced directly from its official BitBucket repository (<ext-link xlink:href="https://bitbucket.org/3dome/3dgnome" ext-link-type="uri">https://bitbucket.org/3dome/3dgnome</ext-link>) and represents the latest available version. The comparison was conducted using datasets of varying sizes. The cudaMMC algorithm achieved a speed-up ranging from 3× to 25× for single chromosome modelling, with the speed-up dependent on the chromosome size (<xref rid="btad588-F1" ref-type="fig">Fig. 1B</xref>, <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S1</xref>, and <xref rid="sup1" ref-type="supplementary-material">Supplementary Table ST1</xref>). The benchmark consisted of 10 modelling runs for each chromosome using both methods, and the comparative analysis was based on average execution times. The biggest advantage of the algorithm speed-up was observed for generating ensembles of models. Using GRCh37 data, we performed ensembles of 100 models each using both methods. The cudaMMC algorithm decreased computation time from ∼85 to ∼10 min for chr21, from ∼9 h to 35 min for chr14, and from ∼3 days to 1.5 h for chr1 (<xref rid="btad588-F1" ref-type="fig">Fig. 1C</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Table ST3</xref>). Furthermore, we tested the performance of the cudaMMC algorithm for whole chromosomal modelling using in situ ChIA-PET data mapped to GRCh38 (ST4). On average, modelling chr1 took 50 min, chr14 took ∼17 min, and chr21 took 4.5 min. The benchmark consisted of three modelling runs. For the GRCh38 datasets, the 3D-GNOME algorithm was unable to complete the modelling process within a reasonable time frame. These results were obtained on Pascal architecture, but cudaMMC might also be configured on Turing or Amper NVIDIA devices perhaps with even better results.</p>
    <p>In evaluating the consistency of execution times across methods, we performed the coefficient of variation (CoV) analysis. For 3D-GNOME, the CoVs were 32.05% for chr1, 19.79% for chr14, and 6.45% for chr21. In contrast, cudaMMC displayed significantly more consistent results with CoVs of 2.48% for chr1, 1.24% for chr14, and 2.01% for chr21. This underscores cudaMMC’s enhanced stability across different chromosomes (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S2</xref>). Lastly, we assessed the quality of cudaMMC modelling by comparing the similarity matrices within an ensemble of 100 models of chr21 between both methods (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S3</xref>). The distributions displayed in the density plots for both methods are nearly identical, with a difference in median values of &lt;1%.</p>
    <p>We added a tool for converting output into mmCIF format to make it more accessible for common usage. We chose this format instead of PDB because it can represent a higher number of beads for one structure, which is necessary for high-resolution whole chromosome models (<xref rid="btad588-F1" ref-type="fig">Fig. 1D</xref>). Overall, our results show that the cudaMMC algorithm can significantly improve performance for 3D modelling of chromatin structures, making it a valuable tool for researchers in this field.</p>
  </sec>
  <sec>
    <title>4 Conclusions</title>
    <p>In the cudaMMC method, parallelizing calculations on the GPU enabled a massive reduction in computation time compared to the previous CPU-oriented approach of 3D-GNOME. This speed-up in calculations enables the generation of a high number of model ensembles in a reasonable time frame, thereby offering an opportunity for statistical analysis. For example, as part of the update to the 3D-GNOME web server, we have recently added a tool for statistical analysis of ensembles, which calculates changes in distances between gene promoters and enhancers of two model ensembles that differ in chromatin loop patterns caused by Structure Variants. To facilitate this, as a part of the 3D-GNOME 3.0 web server update (<xref rid="btad588-B14" ref-type="bibr">Wlasnowolski <italic toggle="yes">et al.</italic> 2023</xref>), we have set up the cudaMMC software on the NVIDIA DGX A100 cluster, enabling the running of multiple modelling tasks simultaneously on several GPU cards and facilitating analysis based on new, large datasets of spatial chromatin data. We believe that cudaMMC, the GPU-accelerated 3D-GNOME modelling engine, will significantly enhance scientists' investigations into various aspects of chromatin 3D structures.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btad588_Supplementary_Data</label>
      <media xlink:href="btad588_supplementary_data.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <sec>
    <title>Supplementary data</title>
    <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics</italic> online. </p>
  </sec>
  <sec sec-type="data-availability">
    <title>Data availability</title>
    <p>The data underlying this article used for benchmarking will be shared on reasonable request to the corresponding author.</p>
  </sec>
  <sec sec-type="COI-statement">
    <title>Conflict of interest</title>
    <p>None declared.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>This work was supported by National Science Centre, Poland [2019/35/O/ST6/02484 and 2020/37/B/NZ2/03757], and European Commission Horizon 2020 Marie Skłodowska-Curie ITN Enhpathy grant ‘Molecular Basis of Human enhanceropathies’. Research was co-funded by Warsaw University of Technology within the Excellence Initiative: Research University (IDUB) programme. Computations were performed thanks to the Laboratory of Bioinformatics and Computational Genomics, Faculty of Mathematics and Information Science, Warsaw University of Technology using Artificial Intelligence HPC platform financed by Polish Ministry of Science and Higher Education [decision no. 7054/IA/SP/2020 of 2020-08-28].</p>
  </sec>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btad588-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Belokopytova</surname><given-names>P</given-names></string-name>, <string-name><surname>Fishman</surname><given-names>V.</given-names></string-name></person-group><article-title>Predicting genome architecture: challenges and solutions</article-title>. <source>Front Genet</source><year>2020</year>;<volume>11</volume>:<fpage>617202</fpage>.<pub-id pub-id-type="pmid">33552135</pub-id></mixed-citation>
    </ref>
    <ref id="btad588-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Chiliński</surname><given-names>M</given-names></string-name>, <string-name><surname>Sengupta</surname><given-names>K</given-names></string-name>, <string-name><surname>Plewczynski</surname><given-names>D.</given-names></string-name></person-group><article-title>From DNA human sequence to the chromatin higher order organisation and its biological meaning: using biomolecular interaction networks to understand the influence of structural variation on spatial genome organisation and its functional effect</article-title>. <source>Semin Cell Dev Biol</source><year>2022</year>;<volume>121</volume>:<fpage>171</fpage>–<lpage>85</lpage>.<pub-id pub-id-type="pmid">34429265</pub-id></mixed-citation>
    </ref>
    <ref id="btad588-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Di Pierro</surname><given-names>M</given-names></string-name>, <string-name><surname>Zhang</surname><given-names>B</given-names></string-name>, <string-name><surname>Aiden</surname><given-names>EL</given-names></string-name></person-group><etal>et al</etal><article-title>Transferable model for chromosome architecture</article-title>. <source>Proc Natl Acad Sci USA</source><year>2016</year>;<volume>113</volume>:<fpage>12168</fpage>–<lpage>73</lpage>.<pub-id pub-id-type="pmid">27688758</pub-id></mixed-citation>
    </ref>
    <ref id="btad588-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Heinz</surname><given-names>S</given-names></string-name>, <string-name><surname>Texari</surname><given-names>L</given-names></string-name>, <string-name><surname>Hayes</surname><given-names>MG</given-names></string-name></person-group><etal>et al</etal><article-title>Transcription elongation can affect genome 3D structure</article-title>. <source>Cell</source><year>2018</year>;<volume>174</volume>:<fpage>1522</fpage>–<lpage>36.e22</lpage>.<pub-id pub-id-type="pmid">30146161</pub-id></mixed-citation>
    </ref>
    <ref id="btad588-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kadlof</surname><given-names>M</given-names></string-name>, <string-name><surname>Rozycka</surname><given-names>J</given-names></string-name>, <string-name><surname>Plewczynski</surname><given-names>D.</given-names></string-name></person-group><article-title>Spring model–chromatin modeling tool based on OpenMM</article-title>. <source>Methods</source><year>2020</year>;<volume>181–182</volume>:<fpage>62</fpage>–<lpage>9</lpage>.</mixed-citation>
    </ref>
    <ref id="btad588-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lazniewski</surname><given-names>M</given-names></string-name>, <string-name><surname>Dawson</surname><given-names>WK</given-names></string-name>, <string-name><surname>Rusek</surname><given-names>AM</given-names></string-name></person-group><etal>et al</etal><article-title>One protein to rule them all: the role of CCCTC-binding factor in shaping human genome in health and disease</article-title>. <source>Semin Cell Dev Biol</source><year>2019</year>;<volume>90</volume>:<fpage>114</fpage>–<lpage>27</lpage>.<pub-id pub-id-type="pmid">30096365</pub-id></mixed-citation>
    </ref>
    <ref id="btad588-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lin</surname><given-names>D</given-names></string-name>, <string-name><surname>Bonora</surname><given-names>G</given-names></string-name>, <string-name><surname>Yardımcı</surname><given-names>GG</given-names></string-name></person-group><etal>et al</etal><article-title>Computational methods for analyzing and modeling genome structure and organization</article-title>. <source>Wiley Interdiscipl Rev Syst Biol Med</source><year>2019</year>;<volume>11</volume>:<fpage>e1435</fpage>.</mixed-citation>
    </ref>
    <ref id="btad588-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Madsen-Østerbye</surname><given-names>J</given-names></string-name>, <string-name><surname>Bellanger</surname><given-names>A</given-names></string-name>, <string-name><surname>Galigniana</surname><given-names>NM</given-names></string-name></person-group><etal>et al</etal><article-title>Biology and model predictions of the dynamics and heterogeneity of chromatin–nuclear lamina interactions</article-title>. <source>Front Cell Dev Biol</source><year>2022</year>;<volume>10</volume>:<fpage>913458</fpage>.<pub-id pub-id-type="pmid">35693945</pub-id></mixed-citation>
    </ref>
    <ref id="btad588-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pei</surname><given-names>L</given-names></string-name>, <string-name><surname>Huang</surname><given-names>X</given-names></string-name>, <string-name><surname>Liu</surname><given-names>Z</given-names></string-name></person-group><etal>et al</etal><article-title>Dynamic 3D genome architecture of cotton fiber reveals subgenome-coordinated chromatin topology for 4-staged single-cell differentiation</article-title>. <source>Genome Biol</source><year>2022</year>;<volume>23</volume>:<fpage>45</fpage>.<pub-id pub-id-type="pmid">35115029</pub-id></mixed-citation>
    </ref>
    <ref id="btad588-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pettersen</surname><given-names>EF</given-names></string-name>, <string-name><surname>Goddard</surname><given-names>TD</given-names></string-name>, <string-name><surname>Huang</surname><given-names>CC</given-names></string-name></person-group><etal>et al</etal><article-title>UCSF chimera—a visualization system for exploratory research and analysis</article-title>. <source>J Comput Chem</source><year>2004</year>;<volume>25</volume>:<fpage>1605</fpage>–<lpage>12</lpage>.<pub-id pub-id-type="pmid">15264254</pub-id></mixed-citation>
    </ref>
    <ref id="btad588-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ray</surname><given-names>J</given-names></string-name>, <string-name><surname>Munn</surname><given-names>PR</given-names></string-name>, <string-name><surname>Vihervaara</surname><given-names>A</given-names></string-name></person-group><etal>et al</etal><article-title>Chromatin conformation remains stable upon extensive transcriptional changes driven by heat shock</article-title>. <source>Proc Natl Acad Sci USA</source><year>2019</year>;<volume>116</volume>:<fpage>19431</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">31506350</pub-id></mixed-citation>
    </ref>
    <ref id="btad588-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sadowski</surname><given-names>M</given-names></string-name>, <string-name><surname>Kraft</surname><given-names>A</given-names></string-name>, <string-name><surname>Szalaj</surname><given-names>P</given-names></string-name></person-group><etal>et al</etal><article-title>Spatial chromatin architecture alteration by structural variations in human genomes at the population scale</article-title>. <source>Genome Biol</source><year>2019</year>;<volume>20</volume>:<fpage>148</fpage>.<pub-id pub-id-type="pmid">31362752</pub-id></mixed-citation>
    </ref>
    <ref id="btad588-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Szałaj</surname><given-names>P</given-names></string-name>, <string-name><surname>Tang</surname><given-names>Z</given-names></string-name>, <string-name><surname>Michalski</surname><given-names>P</given-names></string-name></person-group><etal>et al</etal><article-title>An integrated 3-dimensional genome modeling engine for data-driven simulation of spatial genome organization</article-title>. <source>Genome Res</source><year>2016</year>;<volume>26</volume>:<fpage>1697</fpage>–<lpage>709</lpage>.<pub-id pub-id-type="pmid">27789526</pub-id></mixed-citation>
    </ref>
    <ref id="btad588-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wlasnowolski</surname><given-names>M</given-names></string-name>, <string-name><surname>Kadlof</surname><given-names>M</given-names></string-name>, <string-name><surname>Sengupta</surname><given-names>K</given-names></string-name></person-group><etal>et al</etal><article-title>3D-GNOME 3.0: a three-dimensional genome modelling engine for analysing changes of promoter–enhancer contacts in the human genome</article-title>. <source>Nucleic Acids Res</source><year>2023</year>;<volume>51</volume>:<fpage>W5</fpage>–<lpage>10</lpage>.<pub-id pub-id-type="pmid">37158257</pub-id></mixed-citation>
    </ref>
    <ref id="btad588-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wlasnowolski</surname><given-names>M</given-names></string-name>, <string-name><surname>Sadowski</surname><given-names>M</given-names></string-name>, <string-name><surname>Czarnota</surname><given-names>T</given-names></string-name></person-group><etal>et al</etal><article-title>3D-GNOME 2.0: a three-dimensional genome modeling engine for predicting structural variation-driven alterations of chromatin spatial structure in the human genome</article-title>. <source>Nucleic Acids Res</source><year>2020</year>;<volume>48</volume>:<fpage>W170</fpage>–<lpage>6</lpage>.<pub-id pub-id-type="pmid">32442297</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10568367</article-id>
    <article-id pub-id-type="pmid">37774005</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btad588</article-id>
    <article-id pub-id-type="publisher-id">btad588</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Note</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Structural Bioinformatics</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>cudaMMC: GPU-enhanced multiscale Monte Carlo chromatin 3D modelling</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Wlasnowolski</surname>
          <given-names>Michal</given-names>
        </name>
        <aff>
          <institution>Laboratory of Bioinformatics and Computational Genomics, Faculty of Mathematics and Information Science, Warsaw University of Technology, Warsaw 00-662, Poland </institution>
        </aff>
        <aff>
          <institution>Laboratory of Functional and Structural Genomics, Centre of New Technologies, University of Warsaw, Warsaw 02-097, Poland</institution>
        </aff>
        <xref rid="btad588-FM1" ref-type="author-notes"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Grabowski</surname>
          <given-names>Pawel</given-names>
        </name>
        <aff>
          <institution>Department of Information Processing Systems, Faculty of Mathematics and Information Science, Warsaw University of Technology, Warsaw 00-662, Poland </institution>
        </aff>
        <xref rid="btad588-FM1" ref-type="author-notes"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Roszczyk</surname>
          <given-names>Damian</given-names>
        </name>
        <aff>
          <institution>Department of Information Processing Systems, Faculty of Mathematics and Information Science, Warsaw University of Technology, Warsaw 00-662, Poland </institution>
        </aff>
        <xref rid="btad588-FM1" ref-type="author-notes"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Kaczmarski</surname>
          <given-names>Krzysztof</given-names>
        </name>
        <aff>
          <institution>Department of Information Processing Systems, Faculty of Mathematics and Information Science, Warsaw University of Technology, Warsaw 00-662, Poland </institution>
        </aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-3840-7610</contrib-id>
        <name>
          <surname>Plewczynski</surname>
          <given-names>Dariusz</given-names>
        </name>
        <aff>
          <institution>Laboratory of Bioinformatics and Computational Genomics, Faculty of Mathematics and Information Science, Warsaw University of Technology, Warsaw 00-662, Poland </institution>
        </aff>
        <aff>
          <institution>Laboratory of Functional and Structural Genomics, Centre of New Technologies, University of Warsaw, Warsaw 02-097, Poland</institution>
        </aff>
        <xref rid="btad588-cor1" ref-type="corresp"/>
        <!--Dariusz.Plewczynski@pw.edu.pl-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Elofsson</surname>
          <given-names>Arne</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btad588-cor1">Corresponding author. Laboratory of Bioinformatics and Computational Genomics, Faculty of Mathematics and Information Science Warsaw University of Technology ul. Koszykowa 75, 00-662 Warsaw, Poland. Tel: +48 22 234 7219. E-mail: <email>Dariusz.Plewczynski@pw.edu.pl</email> (D.P.)</corresp>
      <fn id="btad588-FM1">
        <p>Michal Wlasnowolski, Pawel Grabowski and Damian Roszczyk Equal contribution.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="collection">
      <month>10</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2023-09-29">
      <day>29</day>
      <month>9</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>29</day>
      <month>9</month>
      <year>2023</year>
    </pub-date>
    <volume>39</volume>
    <issue>10</issue>
    <elocation-id>btad588</elocation-id>
    <history>
      <date date-type="received">
        <day>06</day>
        <month>4</month>
        <year>2023</year>
      </date>
      <date date-type="rev-recd">
        <day>14</day>
        <month>8</month>
        <year>2023</year>
      </date>
      <date date-type="editorial-decision">
        <day>09</day>
        <month>9</month>
        <year>2023</year>
      </date>
      <date date-type="corrected-typeset">
        <day>11</day>
        <month>10</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2023</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btad588.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>Investigating the 3D structure of chromatin provides new insights into transcriptional regulation. With the evolution of 3C next-generation sequencing methods like ChiA-PET and Hi-C, the surge in data volume has highlighted the need for more efficient chromatin spatial modelling algorithms. This study introduces the cudaMMC method, based on the Simulated Annealing Monte Carlo approach and enhanced by GPU-accelerated computing, to efficiently generate ensembles of chromatin 3D structures.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>The cudaMMC calculations demonstrate significantly faster performance with better stability compared to our previous method on the same workstation. cudaMMC also substantially reduces the computation time required for generating ensembles of large chromatin models, making it an invaluable tool for studying chromatin spatial conformation.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>Open-source software and manual and sample data are freely available on <ext-link xlink:href="https://github.com/SFGLab/cudaMMC" ext-link-type="uri">https://github.com/SFGLab/cudaMMC</ext-link>.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>European Commission Horizon 2020</institution>
          </institution-wrap>
        </funding-source>
        <award-id>2019/35/O/ST6/02484</award-id>
        <award-id>2020/37/B/NZ2/03757</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="4"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>In recent years, the development of high-throughput sequencing methods and chromosome conformation capture (3C) technology has shown the significant influence of chromatin spatial conformation on genetic expression. Dynamic changes in the 3D structure at various levels of DNA spatial organization: from the entire chromosomes, chromosomal territories, domains (TAD, CCDs), or single chromatin loops, affect the transcription level of individual genes [reviewed in <xref rid="btad588-B2" ref-type="bibr">Chiliński <italic toggle="yes">et al.</italic> (2022)</xref>]. There is plenty of evidence that rearrangements of the spatial chromatin structure could alter gene expression. These changes may occur dynamically in the cell environment induced by heat stress or cell differentiation (<xref rid="btad588-B11" ref-type="bibr">Ray <italic toggle="yes">et al.</italic> 2019</xref>, <xref rid="btad588-B9" ref-type="bibr">Pei <italic toggle="yes">et al.</italic> 2022</xref>), as well as caused by genetic mutations, viruses infections, Structural Variations, and DNA methylations (<xref rid="btad588-B4" ref-type="bibr">Heinz <italic toggle="yes">et al.</italic> 2018</xref>, <xref rid="btad588-B6" ref-type="bibr">Lazniewski <italic toggle="yes">et al.</italic> 2019</xref>, <xref rid="btad588-B12" ref-type="bibr">Sadowski <italic toggle="yes">et al.</italic> 2019</xref>, <xref rid="btad588-B15" ref-type="bibr">Wlasnowolski <italic toggle="yes">et al.</italic> 2020</xref>). To investigate these phenomena, various algorithms for generating chromatin 3D structures have been developed. Notable examples include the methods described in <xref rid="btad588-B5" ref-type="bibr">Kadlof <italic toggle="yes">et al.</italic> (2020)</xref> and <xref rid="btad588-B3" ref-type="bibr">Di Pierro <italic toggle="yes">et al.</italic> (2016)</xref>. For a broader overview, see reviews in <xref rid="btad588-B7" ref-type="bibr">Lin <italic toggle="yes">et al.</italic> (2019)</xref>, <xref rid="btad588-B1" ref-type="bibr">Belokopytova and Fishman (2020)</xref>, and <xref rid="btad588-B8" ref-type="bibr">Madsen-Østerbye <italic toggle="yes">et al.</italic> (2022)</xref>. Among other chromatin 3D structure modelling methods, one is the <italic toggle="yes">3D-GNOME</italic> approach (<xref rid="btad588-B13" ref-type="bibr">Szałaj <italic toggle="yes">et al.</italic> 2016</xref>). 3D-GNOME enables the generation of individual 3D chromatin models and ensembles of model sets using the simulated annealing Monte Carlo approach. Modelling is performed based on a map of chromatin contacts mediated by specific proteins such as CTCF or RNAPII, which play a significant role in chromatin spatial organization. This modelling technique takes into account the hierarchical organization of the chromatin structure, from chromosome positioning to chromatin domains (TADs, CCDs), and down to individual chromatin loop shapes. Due to the substantial development of 3C techniques, the data volumes of the chromatin contacts have increased significantly. This substantially increases the computation time needed to model the ensemble of large chromosomal structures, making it less useful for genome-wide modelling. To address this challenge, we developed cudaMMC, which extended 3D-GNOME by implementing parallel acceleration using GPUs, resulting in a significant speed-up of calculations while preserving modelling quality. This improvement was essential for the calculation of spatial distance distribution between specific genomic loci, for which purpose we applied cudaMMC recently in the 3D-GNOME web server update (<xref rid="btad588-B14" ref-type="bibr">Wlasnowolski <italic toggle="yes">et al.</italic> 2023</xref>) for statistical analysis of changes of distances between gene promoters and enhancers. In addition, we added a new option for the output file format, mmCIF, which enables the presentation and analysis of chromatin 3D models using commonly used molecular 3D viewers, such as UCSF Chimera (<xref rid="btad588-B10" ref-type="bibr">Pettersen <italic toggle="yes">et al.</italic> 2004</xref>).</p>
  </sec>
  <sec>
    <title>2 Materials and methods</title>
    <sec>
      <title>2.1 <italic toggle="yes">3D-GNOME—</italic>CPU-oriented approach</title>
      <p>The <italic toggle="yes">3D-GNOME</italic> method consists of two stages. In the first one, a chromosome is divided into several regions based on PET cluster interaction patterns so that each region can correspond to one topological domain. Next, Monte Carlo simulated annealing is used to position beads to minimize energy function, considering the distance between beads corresponding to different regions. The second stage models the position of chromatin anchors within each domain independently based on energy terms. Next, chromatin loops are modelled by inserting sub-anchor beads between adjacent anchors, wherefore their position and shape are set using minimized energy function again.</p>
    </sec>
    <sec>
      <title>2.2 cudaMMC approach GPU-extended</title>
      <p>The method speed-up comes from a massive parallel search in the configuration space. The ability to run thousands of independent threads effectively at the same time gives the GPU an advantage over CPU processors for tasks which can be divided into numerous smaller parts. Parallelization will be more productive if sequential parts of the algorithm and synchronization points are minimized or completely removed. In the case of simulated annealing, the balance between parallel and sequential computations is hard to achieve since global energy is calculated after local bead matching improvement. However, if we assume that local configuration changes have an impact only in a limited surrounding area, we can propose an algorithm which solves the problem in parallel sustaining the global fitting at a level not worse than the sequential algorithm.</p>
      <p>The main proposal is based on the idea that a parallel search for a better fitting is done within a so-called threads warp, a group of 32 cooperative threads, while energy function is evaluated globally using temporal results from other warps if only possible (<xref rid="btad588-F1" ref-type="fig">Fig. 1A</xref>). A single warp optimizes a single bead using 32 threads to try random moves of that bead iteratively an arbitrarily selected number of times. Each thread chooses its best solution through the entire process, and then the parallel reduction is used to choose the best solution from all the warp. The final improvement proposal is accepted globally if it gives global improvement calculated in a given time from currently available improvements in other beads. Local improvement may not be positive if we consider other beads being modified at the same time. The overall process avoids global synchronization points, and experiments proved that the numerical stability of the method is not worse than the sequential one. The parallel method stop condition depends on the energy calculated and the number of improvement trials. In case of no possibilities of improvement, the method will finish.</p>
      <fig position="float" id="btad588-F1">
        <label>Figure 1.</label>
        <caption>
          <p>(A) Pipeline of the CUDA-based parallel simulated annealing algorithm for chromatin 3D structure modelling. (B) Speedup of the parallel algorithm in relation to chromosome size. Results shown are averages from 10 modelling runs using both methods. (C) Performance comparison between the 3D-GNOME (old) and cudaMMC (new) algorithms, based on generating ensembles of 100 models for selected chromosomes. Results shown are averages from three modelling runs for each method. (D) Full chromosomal chromatin 3D structure of chr1, based on CTCF ChIA-PET chromatin interactions from the GM12878 cell line mapped to GRCh37.</p>
        </caption>
        <graphic xlink:href="btad588f1" position="float"/>
      </fig>
    </sec>
    <sec>
      <title>2.3 Chromatin interaction data</title>
      <p>We compared cudaMMC and <italic toggle="yes">3D-GNOME</italic> algorithms on <italic toggle="yes">long-read</italic> ChIA-PET CTCF chromatin interaction data for the GM12878 cell line mapped on GRCh37, for which data <italic toggle="yes">3D-GNOME</italic> was designed (ST1). We have also performed modelling tests using cudaMMC on <italic toggle="yes">in situ</italic> ChIA-PET data for the GM12878 cell line mapped on GRCh38 (ST2). We omitted the <italic toggle="yes">3D-GNOME</italic> performance testing on GRCh38 data because of the excessive computational time required caused by the massive increase of data gained by the new ChIA-PET method.</p>
    </sec>
  </sec>
  <sec>
    <title>3 Comparison of performance between cudaMMC and 3D-GNOME</title>
    <p>We compared the performance of the cudaMMC and 3D-GNOME methods on a workstation with a NVIDIA Pascal GPU architecture and an Intel Core i9-7920X CPU. The version of 3D-GNOME used for this benchmark was sourced directly from its official BitBucket repository (<ext-link xlink:href="https://bitbucket.org/3dome/3dgnome" ext-link-type="uri">https://bitbucket.org/3dome/3dgnome</ext-link>) and represents the latest available version. The comparison was conducted using datasets of varying sizes. The cudaMMC algorithm achieved a speed-up ranging from 3× to 25× for single chromosome modelling, with the speed-up dependent on the chromosome size (<xref rid="btad588-F1" ref-type="fig">Fig. 1B</xref>, <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S1</xref>, and <xref rid="sup1" ref-type="supplementary-material">Supplementary Table ST1</xref>). The benchmark consisted of 10 modelling runs for each chromosome using both methods, and the comparative analysis was based on average execution times. The biggest advantage of the algorithm speed-up was observed for generating ensembles of models. Using GRCh37 data, we performed ensembles of 100 models each using both methods. The cudaMMC algorithm decreased computation time from ∼85 to ∼10 min for chr21, from ∼9 h to 35 min for chr14, and from ∼3 days to 1.5 h for chr1 (<xref rid="btad588-F1" ref-type="fig">Fig. 1C</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Table ST3</xref>). Furthermore, we tested the performance of the cudaMMC algorithm for whole chromosomal modelling using in situ ChIA-PET data mapped to GRCh38 (ST4). On average, modelling chr1 took 50 min, chr14 took ∼17 min, and chr21 took 4.5 min. The benchmark consisted of three modelling runs. For the GRCh38 datasets, the 3D-GNOME algorithm was unable to complete the modelling process within a reasonable time frame. These results were obtained on Pascal architecture, but cudaMMC might also be configured on Turing or Amper NVIDIA devices perhaps with even better results.</p>
    <p>In evaluating the consistency of execution times across methods, we performed the coefficient of variation (CoV) analysis. For 3D-GNOME, the CoVs were 32.05% for chr1, 19.79% for chr14, and 6.45% for chr21. In contrast, cudaMMC displayed significantly more consistent results with CoVs of 2.48% for chr1, 1.24% for chr14, and 2.01% for chr21. This underscores cudaMMC’s enhanced stability across different chromosomes (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S2</xref>). Lastly, we assessed the quality of cudaMMC modelling by comparing the similarity matrices within an ensemble of 100 models of chr21 between both methods (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S3</xref>). The distributions displayed in the density plots for both methods are nearly identical, with a difference in median values of &lt;1%.</p>
    <p>We added a tool for converting output into mmCIF format to make it more accessible for common usage. We chose this format instead of PDB because it can represent a higher number of beads for one structure, which is necessary for high-resolution whole chromosome models (<xref rid="btad588-F1" ref-type="fig">Fig. 1D</xref>). Overall, our results show that the cudaMMC algorithm can significantly improve performance for 3D modelling of chromatin structures, making it a valuable tool for researchers in this field.</p>
  </sec>
  <sec>
    <title>4 Conclusions</title>
    <p>In the cudaMMC method, parallelizing calculations on the GPU enabled a massive reduction in computation time compared to the previous CPU-oriented approach of 3D-GNOME. This speed-up in calculations enables the generation of a high number of model ensembles in a reasonable time frame, thereby offering an opportunity for statistical analysis. For example, as part of the update to the 3D-GNOME web server, we have recently added a tool for statistical analysis of ensembles, which calculates changes in distances between gene promoters and enhancers of two model ensembles that differ in chromatin loop patterns caused by Structure Variants. To facilitate this, as a part of the 3D-GNOME 3.0 web server update (<xref rid="btad588-B14" ref-type="bibr">Wlasnowolski <italic toggle="yes">et al.</italic> 2023</xref>), we have set up the cudaMMC software on the NVIDIA DGX A100 cluster, enabling the running of multiple modelling tasks simultaneously on several GPU cards and facilitating analysis based on new, large datasets of spatial chromatin data. We believe that cudaMMC, the GPU-accelerated 3D-GNOME modelling engine, will significantly enhance scientists' investigations into various aspects of chromatin 3D structures.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btad588_Supplementary_Data</label>
      <media xlink:href="btad588_supplementary_data.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <sec>
    <title>Supplementary data</title>
    <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics</italic> online. </p>
  </sec>
  <sec sec-type="data-availability">
    <title>Data availability</title>
    <p>The data underlying this article used for benchmarking will be shared on reasonable request to the corresponding author.</p>
  </sec>
  <sec sec-type="COI-statement">
    <title>Conflict of interest</title>
    <p>None declared.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>This work was supported by National Science Centre, Poland [2019/35/O/ST6/02484 and 2020/37/B/NZ2/03757], and European Commission Horizon 2020 Marie Skłodowska-Curie ITN Enhpathy grant ‘Molecular Basis of Human enhanceropathies’. Research was co-funded by Warsaw University of Technology within the Excellence Initiative: Research University (IDUB) programme. Computations were performed thanks to the Laboratory of Bioinformatics and Computational Genomics, Faculty of Mathematics and Information Science, Warsaw University of Technology using Artificial Intelligence HPC platform financed by Polish Ministry of Science and Higher Education [decision no. 7054/IA/SP/2020 of 2020-08-28].</p>
  </sec>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btad588-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Belokopytova</surname><given-names>P</given-names></string-name>, <string-name><surname>Fishman</surname><given-names>V.</given-names></string-name></person-group><article-title>Predicting genome architecture: challenges and solutions</article-title>. <source>Front Genet</source><year>2020</year>;<volume>11</volume>:<fpage>617202</fpage>.<pub-id pub-id-type="pmid">33552135</pub-id></mixed-citation>
    </ref>
    <ref id="btad588-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Chiliński</surname><given-names>M</given-names></string-name>, <string-name><surname>Sengupta</surname><given-names>K</given-names></string-name>, <string-name><surname>Plewczynski</surname><given-names>D.</given-names></string-name></person-group><article-title>From DNA human sequence to the chromatin higher order organisation and its biological meaning: using biomolecular interaction networks to understand the influence of structural variation on spatial genome organisation and its functional effect</article-title>. <source>Semin Cell Dev Biol</source><year>2022</year>;<volume>121</volume>:<fpage>171</fpage>–<lpage>85</lpage>.<pub-id pub-id-type="pmid">34429265</pub-id></mixed-citation>
    </ref>
    <ref id="btad588-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Di Pierro</surname><given-names>M</given-names></string-name>, <string-name><surname>Zhang</surname><given-names>B</given-names></string-name>, <string-name><surname>Aiden</surname><given-names>EL</given-names></string-name></person-group><etal>et al</etal><article-title>Transferable model for chromosome architecture</article-title>. <source>Proc Natl Acad Sci USA</source><year>2016</year>;<volume>113</volume>:<fpage>12168</fpage>–<lpage>73</lpage>.<pub-id pub-id-type="pmid">27688758</pub-id></mixed-citation>
    </ref>
    <ref id="btad588-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Heinz</surname><given-names>S</given-names></string-name>, <string-name><surname>Texari</surname><given-names>L</given-names></string-name>, <string-name><surname>Hayes</surname><given-names>MG</given-names></string-name></person-group><etal>et al</etal><article-title>Transcription elongation can affect genome 3D structure</article-title>. <source>Cell</source><year>2018</year>;<volume>174</volume>:<fpage>1522</fpage>–<lpage>36.e22</lpage>.<pub-id pub-id-type="pmid">30146161</pub-id></mixed-citation>
    </ref>
    <ref id="btad588-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kadlof</surname><given-names>M</given-names></string-name>, <string-name><surname>Rozycka</surname><given-names>J</given-names></string-name>, <string-name><surname>Plewczynski</surname><given-names>D.</given-names></string-name></person-group><article-title>Spring model–chromatin modeling tool based on OpenMM</article-title>. <source>Methods</source><year>2020</year>;<volume>181–182</volume>:<fpage>62</fpage>–<lpage>9</lpage>.</mixed-citation>
    </ref>
    <ref id="btad588-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lazniewski</surname><given-names>M</given-names></string-name>, <string-name><surname>Dawson</surname><given-names>WK</given-names></string-name>, <string-name><surname>Rusek</surname><given-names>AM</given-names></string-name></person-group><etal>et al</etal><article-title>One protein to rule them all: the role of CCCTC-binding factor in shaping human genome in health and disease</article-title>. <source>Semin Cell Dev Biol</source><year>2019</year>;<volume>90</volume>:<fpage>114</fpage>–<lpage>27</lpage>.<pub-id pub-id-type="pmid">30096365</pub-id></mixed-citation>
    </ref>
    <ref id="btad588-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lin</surname><given-names>D</given-names></string-name>, <string-name><surname>Bonora</surname><given-names>G</given-names></string-name>, <string-name><surname>Yardımcı</surname><given-names>GG</given-names></string-name></person-group><etal>et al</etal><article-title>Computational methods for analyzing and modeling genome structure and organization</article-title>. <source>Wiley Interdiscipl Rev Syst Biol Med</source><year>2019</year>;<volume>11</volume>:<fpage>e1435</fpage>.</mixed-citation>
    </ref>
    <ref id="btad588-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Madsen-Østerbye</surname><given-names>J</given-names></string-name>, <string-name><surname>Bellanger</surname><given-names>A</given-names></string-name>, <string-name><surname>Galigniana</surname><given-names>NM</given-names></string-name></person-group><etal>et al</etal><article-title>Biology and model predictions of the dynamics and heterogeneity of chromatin–nuclear lamina interactions</article-title>. <source>Front Cell Dev Biol</source><year>2022</year>;<volume>10</volume>:<fpage>913458</fpage>.<pub-id pub-id-type="pmid">35693945</pub-id></mixed-citation>
    </ref>
    <ref id="btad588-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pei</surname><given-names>L</given-names></string-name>, <string-name><surname>Huang</surname><given-names>X</given-names></string-name>, <string-name><surname>Liu</surname><given-names>Z</given-names></string-name></person-group><etal>et al</etal><article-title>Dynamic 3D genome architecture of cotton fiber reveals subgenome-coordinated chromatin topology for 4-staged single-cell differentiation</article-title>. <source>Genome Biol</source><year>2022</year>;<volume>23</volume>:<fpage>45</fpage>.<pub-id pub-id-type="pmid">35115029</pub-id></mixed-citation>
    </ref>
    <ref id="btad588-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pettersen</surname><given-names>EF</given-names></string-name>, <string-name><surname>Goddard</surname><given-names>TD</given-names></string-name>, <string-name><surname>Huang</surname><given-names>CC</given-names></string-name></person-group><etal>et al</etal><article-title>UCSF chimera—a visualization system for exploratory research and analysis</article-title>. <source>J Comput Chem</source><year>2004</year>;<volume>25</volume>:<fpage>1605</fpage>–<lpage>12</lpage>.<pub-id pub-id-type="pmid">15264254</pub-id></mixed-citation>
    </ref>
    <ref id="btad588-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ray</surname><given-names>J</given-names></string-name>, <string-name><surname>Munn</surname><given-names>PR</given-names></string-name>, <string-name><surname>Vihervaara</surname><given-names>A</given-names></string-name></person-group><etal>et al</etal><article-title>Chromatin conformation remains stable upon extensive transcriptional changes driven by heat shock</article-title>. <source>Proc Natl Acad Sci USA</source><year>2019</year>;<volume>116</volume>:<fpage>19431</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">31506350</pub-id></mixed-citation>
    </ref>
    <ref id="btad588-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sadowski</surname><given-names>M</given-names></string-name>, <string-name><surname>Kraft</surname><given-names>A</given-names></string-name>, <string-name><surname>Szalaj</surname><given-names>P</given-names></string-name></person-group><etal>et al</etal><article-title>Spatial chromatin architecture alteration by structural variations in human genomes at the population scale</article-title>. <source>Genome Biol</source><year>2019</year>;<volume>20</volume>:<fpage>148</fpage>.<pub-id pub-id-type="pmid">31362752</pub-id></mixed-citation>
    </ref>
    <ref id="btad588-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Szałaj</surname><given-names>P</given-names></string-name>, <string-name><surname>Tang</surname><given-names>Z</given-names></string-name>, <string-name><surname>Michalski</surname><given-names>P</given-names></string-name></person-group><etal>et al</etal><article-title>An integrated 3-dimensional genome modeling engine for data-driven simulation of spatial genome organization</article-title>. <source>Genome Res</source><year>2016</year>;<volume>26</volume>:<fpage>1697</fpage>–<lpage>709</lpage>.<pub-id pub-id-type="pmid">27789526</pub-id></mixed-citation>
    </ref>
    <ref id="btad588-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wlasnowolski</surname><given-names>M</given-names></string-name>, <string-name><surname>Kadlof</surname><given-names>M</given-names></string-name>, <string-name><surname>Sengupta</surname><given-names>K</given-names></string-name></person-group><etal>et al</etal><article-title>3D-GNOME 3.0: a three-dimensional genome modelling engine for analysing changes of promoter–enhancer contacts in the human genome</article-title>. <source>Nucleic Acids Res</source><year>2023</year>;<volume>51</volume>:<fpage>W5</fpage>–<lpage>10</lpage>.<pub-id pub-id-type="pmid">37158257</pub-id></mixed-citation>
    </ref>
    <ref id="btad588-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wlasnowolski</surname><given-names>M</given-names></string-name>, <string-name><surname>Sadowski</surname><given-names>M</given-names></string-name>, <string-name><surname>Czarnota</surname><given-names>T</given-names></string-name></person-group><etal>et al</etal><article-title>3D-GNOME 2.0: a three-dimensional genome modeling engine for predicting structural variation-driven alterations of chromatin spatial structure in the human genome</article-title>. <source>Nucleic Acids Res</source><year>2020</year>;<volume>48</volume>:<fpage>W170</fpage>–<lpage>6</lpage>.<pub-id pub-id-type="pmid">32442297</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
