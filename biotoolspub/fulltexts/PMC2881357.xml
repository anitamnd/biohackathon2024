<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20070202//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing.dtd?>
<?SourceDTD.Version 2.3?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-id journal-id-type="hwp">bioinfo</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">2881357</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btq172</article-id>
    <article-id pub-id-type="publisher-id">btq172</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Ismb 2010 Conference Proceedings July 11 to July 13, 2010, Boston, Ma, Usa</subject>
        <subj-group>
          <subject>Original Papers</subject>
          <subj-group>
            <subject>Bioimaging</subject>
          </subj-group>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>SPEX<sup>2</sup>: automated concise extraction of spatial gene expression patterns from Fly embryo ISH images</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Puniyani</surname>
          <given-names>Kriti</given-names>
        </name>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Faloutsos</surname>
          <given-names>Christos</given-names>
        </name>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Xing</surname>
          <given-names>Eric P.</given-names>
        </name>
        <xref ref-type="corresp" rid="COR1">*</xref>
      </contrib>
    </contrib-group>
    <aff>School of Computer Science, Carnegie Mellon Unversity, Pittsburgh, PA, USA</aff>
    <author-notes>
      <corresp id="COR1">* To whom correspondence should be addressed.</corresp>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>15</day>
      <month>6</month>
      <year>2010</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>1</day>
      <month>6</month>
      <year>2010</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>1</day>
      <month>6</month>
      <year>2010</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the
							<pub-date pub-type="epub"/>. -->
    <volume>26</volume>
    <issue>12</issue>
    <fpage>i47</fpage>
    <lpage>i56</lpage>
    <permissions>
      <copyright-statement>© The Author(s) 2010. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2010</copyright-year>
      <license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by-nc/2.0/uk/">
        <license-p><!--CREATIVE COMMONS-->This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/2.5">http://creativecommons.org/licenses/by-nc/2.5</ext-link>), which permits unrestricted non-commercial use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <abstract>
      <p><bold>Motivation:</bold> Microarray profiling of mRNA abundance is often ill suited for temporal–spatial analysis of gene expressions in multicellular organisms such as <italic>Drosophila</italic>. Recent progress in image-based genome-scale profiling of whole-body mRNA patterns via <italic>in situ hybridization</italic> (ISH) calls for development of accurate and automatic image analysis systems to facilitate efficient mining of complex temporal–spatial mRNA patterns, which will be essential for functional genomics and network inference in higher organisms.</p>
      <p><bold>Results:</bold> We present SPEX<sup>2</sup>, an automatic system for embryonic ISH image processing, which can extract, transform, compare, classify and cluster spatial gene expression patterns in <italic>Drosophila</italic> embryos. Our pipeline for gene expression pattern extraction outputs the precise spatial locations and strengths of the gene expression. We performed experiments on the <italic>largest publicly available</italic> collection of <italic>Drosophila</italic> ISH images, and show that our method achieves excellent performance in automatic image annotation, and also finds clusters that are significantly enriched, both for gene ontology functional annotations, and for annotation terms from a controlled vocabulary used by human curators to describe these images.</p>
      <p><bold>Availability:</bold> Software will be available at <ext-link ext-link-type="uri" xlink:href="http://www.sailing.cs.cmu.edu/">http://www.sailing.cs.cmu.edu/</ext-link></p>
      <p>
        <bold>Contact:</bold>
        <email>epxing@cs.cmu.edu</email>
      </p>
      <p><bold>Supplementary information:</bold><ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btq172/DC1">Supplementary data</ext-link> are avilable at <italic>Bioinformatics</italic> online.</p>
    </abstract>
  </article-meta>
</front>
<body>
  <sec sec-type="intro" id="SEC1">
    <title>1 INTRODUCTION</title>
    <p>In multicellular organisms such as the metazoans, many important biological processes such as development and differentiation depend fundamentally on the spatial and temporal control of gene expression (Davidson, <xref ref-type="bibr" rid="B9">2001</xref>; Gilbert, <xref ref-type="bibr" rid="B13">2003</xref>). To date, the molecular basis and regulatory circuitry underlying metazoan gene regulation remains largely unknown. Numerous algorithmic approaches have been attempted to infer ‘networks’ of regulatory elements from high-throughput experimental data, such as microarray profiles (Dobra <italic>et al.</italic>, <xref ref-type="bibr" rid="B10">2004</xref>; Ong, <xref ref-type="bibr" rid="B24">2002</xref>; Segal <italic>et al.</italic>, <xref ref-type="bibr" rid="B29">2003</xref>), ChIP-chip genome localization data (Bar-Joseph <italic>et al.</italic>, <xref ref-type="bibr" rid="B3">2003</xref>; Harbison <italic>et al.</italic>, <xref ref-type="bibr" rid="B16">2004</xref>) and protein-protein interaction data (Causier, <xref ref-type="bibr" rid="B5">2004</xref>; Giot <italic>et al.</italic>, <xref ref-type="bibr" rid="B14">2003</xref>; Kelley <italic>et al.</italic>, <xref ref-type="bibr" rid="B19">2004</xref>), based on formalisms such as Bayesian networks (Cowell <italic>et al.</italic>, <xref ref-type="bibr" rid="B8">1999</xref>) or graph mining (Tanay <italic>et al.</italic>, <xref ref-type="bibr" rid="B31">2004</xref>). However, a key deficiency of these approaches is that they rely heavily on high-throughput biological data like microarrays that only capture average behaviour of the genes and proteins in a large cell population from, e.g. a cell culture, a dissected tissue or even a homogenized whole animal. For multicellular organisms such as <italic>Drosophila</italic> and human, gene expressions must be described in a spatiotemporal context, which reveals the histological specificities and temporal dynamics of the activities of the gene. Such information is not available from the standard whole-animal microarray data which record only the average expression of each gene over all cells in the body, nor is it easily obtainable from ‘tissue-specific’ microarray assays using advanced micro-dissection and cell-sorting techniques (<xref ref-type="fig" rid="F1">Fig. 1</xref>).
<fig id="F1" position="float"><label>Fig. 1.</label><caption><p>Microarray time series versus ISH time series. Top: CG9373 (RNA binding protein). Bottom: CG16738 (RNA polymerase II TF). Although the two time courses of whole-body mRNA ambulance measured by microarray are nearly indistinguishable, the ISH data reveals distinctive spatio-temporal patterns. (Courtesy of Dr Hanchuan Peng who pointed these genes to us.)</p></caption><graphic xlink:href="btq172f1"/></fig></p>
    <p><italic>In situ</italic> hybridization (ISH) assay is an imaging method to visualize mRNA expression in tissues and cells without homogenizing the specimens to be analyzed and therefore retains the original histological context of gene expression. Such information is indispensable for in-depth analysis of gene regulation networks, developmental mechanisms and oncogenic processes in higher eukaryotic organisms (Montalta-He and Reichert, <xref ref-type="bibr" rid="B23">2003</xref>). Systematic profiling of ISH images capturing gene expressions over the entire span of <italic>Drosophila</italic> embryogenesis are now being undertaken at a whole-genome scale, offering an unprecedented opportunity for investigators to compare the spatio-temporal behavior of genes and begin assembling realistic pictures of gene regulatory networks underlying the developmental process (Tomancak <italic>et al.</italic>, <xref ref-type="bibr" rid="B32">2002</xref>). The fast growing ‘Expression Pattern’ database under the Berkeley Drosophila Genome Project (BDGP, <xref ref-type="bibr" rid="B4">2005</xref>) now contains around 75 000 digital images of expression patterns of over 3400 genes.</p>
    <p>As of now, the only mining approach offered by the BDGP to search for, for example, co-expressed genes, or anatomical and histological annotations of the gene expressions, is based on manual-labeling of the images by a domain expert using a controlled vocabulary. However, with the rapid growth of data volume, manual analysis is no longer feasible, and automatic analysis techniques are sorely needed, which require the development of new systems capable of noise removal, pattern extraction, feature description and similarity measures.</p>
    <sec id="SEC1.1">
      <title>1.1 Highlights of this article</title>
      <p>In this article, we present SPEX<sup>2</sup> (SPatial gene EXpression pattern EXtractor), a highly effective and reliable image processing pipeline for automated and concise extraction of bona fide gene expression patterns (rather than generic <italic>shaded areas</italic> as usually recognized by naive pattern extracting procedures), from <italic>Drosophila</italic> embryonic ISH results imaged from the lateral view. Such patterns offer a high-fidelity surrogate of the spatial patterns of gene expression in a developing embryo or if necessary other subjects in question (<xref ref-type="fig" rid="F2">Fig. 2</xref>c), nearly free of misleading non-expression patterns due to poor quality staining/washing, body texture, color condensation caused by body anatomy, embryo shape and contour, etc., which often fool standard pattern extracting procedures, as endogenous gene expression patterns (<xref ref-type="fig" rid="F2">Fig. 2</xref>b). These patterns allow highly informative and specific feature representations of each gene to be generated, which can be used in a variety of downstream analysis like functional clustering, gene annotation and network inference.
<fig id="F2" position="float"><label>Fig. 2.</label><caption><p>(<bold>a</bold>) Original image; (<bold>b</bold>) pattern extracted by standard procedures; (<bold>c</bold>) standardized gene expression pattern extracted by SPEX<sup>2</sup>.</p></caption><graphic xlink:href="btq172f2"/></fig></p>
      <p>Specifically, we address the following questions in this article:
<list list-type="order"><list-item><p>Given an ISH image of a <italic>Drosophila</italic> embryo, how to find the pixels that correspond specifically to the spatial expression pattern, rather than other non-expressional entities such as body anatomies and textures, in the embryo?</p></list-item><list-item><p>How should a good representation of the gene expression pattern be constructed?</p></list-item><list-item><p>How should this representation be used for further clustering and classification tasks?</p></list-item></list>
</p>
      <p>Comparisons of gene expression patterns from different ISH images must be performed with respect to the embryo, and not the image. The position, orientation, size, shape contour, lighting condition and texture of the embryo within the image do not matter, as long as the comparison is dependent on the location and strength of the gene expression within the embryo. This requires automated detection of the embryo in an image. Additionally, the orientation of the embryo needs to be identified and standardized, and the embryo must be registered to a standard shape. Furthermore, the ISH image contains noise in addition to the gene expression itself, due to staining artifacts. The correct expression pattern must be extracted from the registered image before conducting further analysis.</p>
      <p>SPEX<sup>2</sup> converts every raw ISH image of <italic>Drosophila</italic> embryo into a feature representation of the spatial gene expression pattern thereof suitable for downstream quantitative analysis, based on the following three steps : (i) embryo standardization, via embryo extraction, orientation correction and registration, (ii) gene expression extraction via stain extraction and pattern segmentation and (iii) feature extraction. Each step in the pipeline uses image processing and machine-learning algorithms to extract the correct output. Automated error control methods detect and reject images if they are not being correctly analyzed, or if they are unsuitable for analysis due to imaging artifacts.</p>
      <p>The resultant feature representation can be directly used for tasks like classification, clustering, standard correlation analysis and network inference of <italic>Drosophila</italic> genes in a metric space. Our techniques are automatic, and are not specific to any data set. Our pipeline also outputs spatial patterns of gene expression, that are amenable to easy interpretation by biologists.</p>
      <p>As proof of concept, we demonstrate our technique on lateral view images from the Berkeley Drosophila Genome Project (BDGP) gene expression pattern database, from the time stage 13–16. To evaluate our pipeline, we cluster the genes based on the features extracted by SPEX<sup>2</sup>, and report enrichment analysis, conducted using gene ontology (GO) functional annotations, as well as enrichment of manual annotations describing the spatial expression localization using a controlled vocabulary. We also learn a classifier to annotate gene expression patterns during embryogenesis using a controlled vocabulary, and report classification accuracy. We find that we significantly outperform other standard feature extraction techniques from the computer vision community, as well as the techniques reported in previous work.</p>
    </sec>
    <sec id="SEC1.2">
      <title>1.2 Related work</title>
      <p>We build upon the first steps taken by earlier work to construct our analysis pipeline for <italic>Drosophila</italic> ISH images. The system <italic>BEST</italic>, developed by Kumar <italic>et al.</italic> (<xref ref-type="bibr" rid="B20">2002</xref>), performs a direct pixel-level comparison of binarized images, using the intersection of the foreground regions as a similarity measure for gene expression patterns. They develop an embryo enclosing algorithm to find the embryo outline, and extract the binary expression pattern via adaptive thresholding.</p>
      <p>Li <italic>et al.</italic> (<xref ref-type="bibr" rid="B21">2009</xref>) propose multi-instance multi-label learning via appropriate kernels to improve performance specifically for annotating images using a controlled vocabulary. An extension was proposed by Ji <italic>et al.</italic>, (<xref ref-type="bibr" rid="B18">2009</xref>) to model term–term interactions in a regression framework that has improved performance for this task. They extract position invariant features using a sparse codebook on aligned images, and apply a local regularization framework on these features for automatic image annotation.</p>
      <p>Peng and Myers (<xref ref-type="bibr" rid="B26">2004</xref>), and Zhou and Peng (<xref ref-type="bibr" rid="B35">2007</xref>) developed techniques to represent ISH images, based on Gaussian mixture models, principal component analysis and wavelet functions. They use the wavelet features, with min-redundancy max-relevance feature selection, to automatically annotate images. Heffel <italic>et al.</italic> (<xref ref-type="bibr" rid="B17">2008</xref>) have also proposed a pipeline for this task, using embryo outline extraction, transformation of the embryo into a circular outline and conversion to fourier-coefficients-based feature representation. They report a visual clustering of seven images using their pipeline.</p>
      <p>Tomancak <italic>et al.</italic> (<xref ref-type="bibr" rid="B33">2007</xref>) analyzed the global gene expression patterns in the BDGP data set, using only the manual annotations available for each gene from a controlled vocabulary. They reported clustering results on joint clustering of microarray data and annotation terms, and found interesting clusters that could not be found using microarray data alone.</p>
      <p>Thus, these advances have offered important new insights and computational tools for mining image-based gene expression patterns captured by ISH, which we extend by conducting a detailed analysis of the information contained in ISH images, and how it can be captured in a good feature representation format.</p>
    </sec>
  </sec>
  <sec sec-type="methods" id="SEC2">
    <title>2 METHODS</title>
    <p>The SPEX<sup>2</sup> system consists of three major components: (i) embryo standardization, (ii) gene expression pattern extraction and (iii) feature representation. An illustration of the pipeline is given in <xref ref-type="fig" rid="F3">Figure 3</xref>. Below, we describe each component in detail.
<fig id="F3" position="float"><label>Fig. 3.</label><caption><p>A schematic illustration of the SPEX<sup>2</sup> pipeline.</p></caption><graphic xlink:href="btq172f3"/></fig>
</p>
    <sec id="SEC2.1">
      <title>2.1 Embryo standardization</title>
      <p>Given a raw ISH image, SPEX<sup>2</sup> uses an embryo standardization process to convert it into a standardized form suitable for subsequent expression extraction and pattern comparison. The embryo is extracted from the ISH image, and aligned along its anteria/posterior (A/P) and dorsal/ventral (D/V) axis correcting for the orientation, thereby ensuring the anterior (of the embryo) is to the left and the dorsal surface is to the top of the image. Finally, the embryo is registered to a standard shape and size.</p>
      <sec id="SEC2.1.1">
        <title>2.1.1 Embryo outline extraction</title>
        <p>Our embryo extraction procedure works in two steps. First, a foreground object extractor is used to extract potential embryos in the image. Second, a series of increasingly complex tests filter out foreground objects that are not embryos, or are embryos not suitable for analysis.</p>
        <p>The object extractor uses the Canny edge operator to identify regions with fast-changing color and high variance. A series of morphological operations (dilations and erosions) are used to smooth out the edges and close holes to find the foreground objects.</p>
        <p>A sequence of tests are then applied to each foreground object to test whether it's an embryo suitable for further analysis; rejected items include erroneous outlines, partial embryos, multiple embryos physically touching or overlapping with each other, and excessively dried or otherwise mishandled embryos.
<list list-type="order"><list-item><p>Objects touching the image boundary are rejected, since these may be partially imaged embryos.</p></list-item><list-item><p>Objects that are too small or too large are rejected. Small objects imply that a part of the actual embryo was potentially missed by the object extractor. Large objects are either partial embryos imaged using a large magnification, or incorrect outlines that include a portion of the background in the foreground object.</p></list-item><list-item><p>If the maximum distance between the object outline and the convex outline of the object is large, the image is rejected; ensuring that the embryo outline is almost convex.</p></list-item><list-item><p>Scale-independent shape features of the object outline are extracted and compared with expected shape features of a standard embryo. Scale independence is required since the size of the embryo varies across images. Examples of shape features include : (i) the ratio between the major and minor axes of the object must match the expected ratio for a <italic>Drosophila</italic> embryo. This ensures that the object is not too thin and narrow, nor is it too circular. (ii) the centroid of the foreground object must be close to the centroid of its outlining rectangle (ensures symmetry). (iii) the maximum (and mean) curvature of the object outline must be similar to the values expected for an embryo (filters out deformed embryos). If the value of any of the above features is &gt;20% away from the feature value computed from a single correctly identified embryo, then the image is rejected.</p></list-item></list>
</p>
        <p>Some examples of embryo outlines extracted by our algorithm are shown in <xref ref-type="fig" rid="F4">Figure 4</xref>. Embryo extraction works well in presence of varying illumination (<xref ref-type="fig" rid="F4">Fig. 4</xref>a), when the background is lighter than the foreground (<xref ref-type="fig" rid="F4">Fig. 4</xref>b), in the absence of stain in the embryo (<xref ref-type="fig" rid="F4">Fig. 4</xref>c), and when there are multiple embryos touching each other (<xref ref-type="fig" rid="F4">Fig. 4</xref>d).
<fig id="F4" position="float"><label>Fig. 4.</label><caption><p>The top image shows the original image, and the bottom image shows the extracted embryo.</p></caption><graphic xlink:href="btq172f4"/></fig>
</p>
      </sec>
      <sec id="SEC2.1.2">
        <title>2.1.2 Alignment, orientation detection and registration</title>
        <p>To align all embryos for later comparisons, we assume the camera angle is perpendicular to the surface of the embryo, which is the case with most imaging technologies with zoom-in. An ellipse is fitted to the detected embryo outline, with the major axis of the ellipse assumed to be the A/P axis, and minor axis the D/V axis of the embryo; and the embryo is rotated so that the A/P axis is horizontal.</p>
        <p>Next, the correct orientation of the aligned embryo is identified and standardized so that the head is to the left, tail to the right, dorsal part of the embryo at the top, and ventral part at the base. This is akin to a binary classification task, for which we need to determine whether to flip the embryo horizontally to correctly position the anterior part of the embryo to the left, and vertically to position the dorsal side to top. Gargesha <italic>et al.</italic> (<xref ref-type="bibr" rid="B12">2005</xref>) proposed a technique to automatically annotate the A/P sides of the embryo. However, their technique is supervised, requiring a large amount of pre-labeled data, which is tedious and expensive to generate. Additionally, their technique is based on a heuristic that does not utilize the knowledge of the expected gene expression patterns. As for finding the D/V sides of the embryo, to our knowledge, no reported result is available so far.</p>
        <p>We propose an algorithm for unsupervised embryo orientation detection, based on the insight that images of the same gene at the same time stage must have similar expression patterns. We start with a heuristic assignment to each embryo, and change the assignment of a particular embryo if it increases its similarity with other embryos stained with the same gene, in a greedy manner. The algorithm for A/P orientation detection for all embryos stained for a single gene is outlined in <xref ref-type="fig" rid="F5">Figure 5</xref>, and is run for all genes being analyzed. A similar algorithm is used for D/V orientation, based on the heuristic that the dorsal side is less curved than the ventral side of the embryo. Though this is a greedy algorithm that assumes that the first embryo assignment is always correct, we found that it works well in practice. Some examples of orientation detection and correction of embryos is shown in <xref ref-type="fig" rid="F6">Figure 6</xref>.
<fig id="F5" position="float"><label>Fig. 5.</label><caption><p>Algorithm for A/P orientation detection.</p></caption><graphic xlink:href="btq172f5"/></fig>
<fig id="F6" position="float"><label>Fig. 6.</label><caption><p>Orientation detection: Flip (<bold>a</bold>) A/P, (<bold>b</bold>) both A/P and D/V, (<bold>c</bold>) D/V, (<bold>d</bold>) D/V assignments of the embryo in the image. The top image shows the original image, and the bottom image shows the embryo outline after alignment, orientation detection and correction and registration.</p></caption><graphic xlink:href="btq172f6"/></fig>
</p>
        <p>Finally, a registration algorithm using point-wise affine stretching is used to register the embryo to a standard ellipse shape. This enables us to obtain an exact map from pixel space to body part of the embryo. At the end of the standardization process, for all the processed images, there is a fixed correspondence between the image pixels and the various embryonic structures, enabling comparison of the spatial patterns of gene expression in different images by comparing the pixel-level expression values.</p>
      </sec>
    </sec>
    <sec id="SEC2.2">
      <title>2.2 Concise Gene Expression Pattern Extraction</title>
      <p>Given a standardized embryonic image, SPEX<sup>2</sup> extracts concise spatial gene expression patterns therein via a two-step procedure. First, standardized embryonic images are pre-processed to extract ISH stains. Then, noise in the stains are removed using a Markov Random Field (MRF) model-based image segmentation. Our algorithm constructs the MRF graph structure and finds image-specific parameters for the image segmentation in a completely unsupervised way.</p>
      <sec id="SEC2.2.1">
        <title>2.2.1 Stain extraction</title>
        <p>The BDGP data set used digoxigenin-labeled RNA probes, that were visualized by using color substrates NBT/BCIP, giving blue-colored gene expression stains to the embryo. Accordingly, blue information present in the RGB image is extracted to quantify the amount of gene expression.</p>
        <p>The image has <italic>R</italic>, <italic>B</italic> and <italic>G</italic> channels for red, blue and green, respectively, scaled to lie between 0 and 1. Using the gray scale image (<inline-formula><inline-graphic xlink:href="btq172i1.jpg"/></inline-formula>) as the amount of stain captures the stain correctly, but noise due to illumination and texture variance is considerable. In images where the stain is present in small regions of the embryo, it is unable to identify a good contrast between the presence and absence of stain. Another possible technique to extract blue information is to subtract the gray scale color of the pixels from the blue channel (referred to as blue–gray in <xref ref-type="fig" rid="F7">Fig. 7</xref>). Thus, the stain is <italic>s</italic> = <italic>max</italic>(0, <italic>B</italic>−<italic>y</italic>) where <italic>y</italic> is the gray scale image as defined earlier. Though the illumination effects are reduced by this technique, this approach is unable to extract highly stained portions of the image because dark blue stains have small (and equal) values for all three components of RGB.
<fig id="F7" position="float"><label>Fig. 7.</label><caption><p>Gene expression extraction: for images (1) and (2), gray scale does not extract good results, while blue–gray gives good output. For images (3) and (4), gray scale does well, while blue–gray misses highly stained regions. In all images, our method performs at least as good as the best of the other two methods.</p></caption><graphic xlink:href="btq172f7"/></fig>
</p>
        <p>Since the above solutions seem inadequate, we propose an approach that captures the correct staining in images with ubiquitous staining, and correctly identify the contrast between stain and no-stain in images where small regions of the embryo are stained:
<disp-formula><graphic xlink:href="btq172um1"/></disp-formula></p>
        <p>It can be seen that <italic>geneExpression</italic> is always positive, bounded between 0 and 1, and captures the amount of stain present (the higher the amount of stain, the higher the value of <italic>geneExpression</italic>). For visualizations in this article, we use (1−<italic>geneExpression</italic>) (no longer mentioned explicitly later) so that darker regions have more stain. Sample results of extracting gene expression stain using various techniques are shown in <xref ref-type="fig" rid="F7">Figure 7</xref>.</p>
      </sec>
      <sec id="SEC2.2.2">
        <title>2.2.2 Gene expression segmentation with MRF</title>
        <p>The expression stain found by pre-processing the image is a noisy measurement of the true expression value, distorted due to poor quality staining/washing, body texture, color condensation caused by body anatomy, embryo shape and contour, etc. Since the expression patterns are noisy with no sharp edges, standard edge-based segmentation algorithms are unable to find the correct stain pattern; adaptive thresholding methods also fail due to the presence of a large variance in the amount of staining in different images. Hence, we correct these issues by using a MRF-based segmentation algorithm to remove noise from the expression pattern. Furthermore, given wide differences of expression patterns in different images, using a standard MRF with fixed parameters across images is hardly adaptive; therefore we fit image-specific MRFs in an unsupervised manner.</p>
      </sec>
      <sec id="SEC2.2.3">
        <title>2.2.3 Building MRF structure</title>
        <p>Naively, for any image, each pixel can be treated as a single node in the MRF, and therefore the MRF naturally follows a grid structure. However, for large images, this technique generates very large graphical models, which are computationally infeasible. We define our image-specific MRF on ‘super-pixels’ (Ren and Malik, <xref ref-type="bibr" rid="B28">2003</xref>) instead, by first ‘over-segmenting’ the image. A super-pixel is a collection of close-by pixels that have similar gray scale levels, and the same foreground/background label because our MRF assigns labels on super-pixels. Adjacent pixels whose values lie within <italic>k</italic> * <italic>i</italic> and <italic>k</italic> *(<italic>i</italic>+1) for some integer <italic>i</italic>, are put in the same super-pixel. <italic>k</italic> is a thresholding parameter, which we set to 0.05. The MRF graph has each super-pixel corresponding to a nodal variable, and is connected to all its adjacent super-pixels, using 4-adjacency.</p>
        <p>Let <italic>X</italic> ≡ {<italic>x</italic><sub><italic>i</italic></sub>}<sub><italic>i</italic>=1</sub><sup><italic>S</italic></sup> denote the set of (binary) random variables representing class labels of super-pixels, and <italic>Y</italic> ≡ {<italic>y</italic><sub><italic>i</italic></sub>}<sub><italic>i</italic>=1</sub><sup><italic>S</italic></sup> be the mean color values of super-pixels, where <italic>S</italic> is the total number of super-pixels in the image. The MRF defines the following distribution:
<disp-formula id="M1"><label>(1)</label><graphic xlink:href="btq172m1"/></disp-formula>
where Φ is the node potential, which captures the effect that pixel <italic>y</italic><sub><italic>i</italic></sub> has on the label of <italic>x</italic><sub><italic>i</italic></sub>; Ψ is the edge potential, which captures how the label of <italic>x</italic><sub><italic>i</italic></sub> is influenced by the labels of its neighbors, and <italic>E</italic> is the set of edges we found over the super-pixels.</p>
        <p>The node potential Φ(<italic>x</italic><sub><italic>i</italic></sub>, <italic>y</italic><sub><italic>i</italic></sub>) is assumed to be Gaussian with parameters (μ<sub><italic>f</italic></sub>, σ<sub><italic>f</italic></sub>) if <italic>x</italic><sub><italic>i</italic></sub> is foreground, and (μ<sub><italic>b</italic></sub>, σ<sub><italic>b</italic></sub>) if <italic>x</italic><sub><italic>i</italic></sub> is background. The edge potential is defined as
<disp-formula id="M2"><label>(2)</label><graphic xlink:href="btq172m2"/></disp-formula>
where <italic>I</italic> is an indicator function. Ψ defines the penalty given for neighboring pixels to disagree, i.e. one of the pixels is foreground and the other is background, and there is an edge connecting them. β captures the strength of the penalty, as β increases, we encourage smoother foreground assignments. We used β = 2, and found that it gave reasonably good performance.</p>
      </sec>
      <sec id="SEC2.2.4">
        <title>2.2.4 Learning MRF parameters</title>
        <p>For the MRF defined above, the parameters (μ<sub><italic>f</italic></sub>, σ<sub><italic>f</italic></sub>, μ<sub><italic>b</italic></sub>, σ<sub><italic>b</italic></sub>) must be defined for each image. Learning the MRF parameters for every image, by using classical unsupervised MRF learning techniques, is usually slow and inconvenient to process thousands of images.</p>
        <p>We propose a simple heuristic to determine the graph parameters. If the penalty parameter β is zero, then the edge potentials are constant. The MRF then reduces to a mixture of Gaussians, where every super-pixel value is generated from one of two Gaussians, corresponding to the foreground and background, respectively. The Gaussian parameters can then be learnt efficiently by computing the histogram of the image, and fitting a mixture of two Gaussians to the histogram using EM. To improve the smoothness of the estimates, we add a small uniform prior (1% of the mass of the histogram) to the image histogram before running EM. The parameters of the two Gaussians are then treated as approximations to the MRF parameters, i.e. μ<sub><italic>f</italic></sub>, μ<sub><italic>b</italic></sub>, σ<sub><italic>f</italic></sub>, σ<sub><italic>b</italic></sub>.</p>
      </sec>
      <sec id="SEC2.2.5">
        <title>2.2.5 Loopy belief propagation for inference</title>
        <p>A standard approximate inference technique, loopy belief propagation (LBP), is used to find the maximum <italic>a posteriori</italic> (MAP) assignment to each <italic>x</italic><sub><italic>i</italic></sub> as foreground or background. Although LBP is not always guaranteed to converge, in our experiments, a small number (3–10) of iterations were sufficient for convergence, for all input images. At the end of this inference procedure, all background nodes are set to zero, and the foreground expression value is used as the final gene expression pattern obtained at the end of our image analysis pipeline. A small flowchart of our gene expression pattern extraction process is shown in <xref ref-type="fig" rid="F8">Figure 8</xref>. Some examples of the gene expression patterns found by our MRF image segmentation algorithm are shown in <xref ref-type="fig" rid="F9">Figure 9</xref>.
<fig id="F8" position="float"><label>Fig. 8.</label><caption><p>The gene expression pattern extraction process. The input image is first over-segmented and the segments are converted into the MRF graph. The histogram of the image is analyzed using EM to find the MRF parameters. Loopy Belief Propagation is used for approximate inference to find the background pixels. Background pixels are noise, and their expression values are removed to get the gene expression pattern.</p></caption><graphic xlink:href="btq172f8"/></fig>
<fig id="F9" position="float"><label>Fig. 9.</label><caption><p>Gene expression pattern extraction: the top row shows the original image, and the bottom row shows the extracted gene expression pattern at the end of our analysis. Note that, the embryo has been aligned to a standard shape before pattern extraction, and it may have been flipped by the orientation correction process.</p></caption><graphic xlink:href="btq172f9"/></fig>
</p>
      </sec>
    </sec>
    <sec id="SEC2.3">
      <title>2.3 Feature Extraction</title>
      <p>Since all ISH images have been standardized to a standard shape, size, orientation and position; and the gene expression pattern has been extracted, removing noise effects along the way, the feature representation needs to be position, orientation and scale dependent. The SIFT feature descriptor (Lowe, <xref ref-type="bibr" rid="B22">1999</xref>) is used to derive a dense set of local visual features, using patches spaced regularly through the image, with a radius of 12 pixels (images are standardized to 128 × 320 pixels). Since the SIFT interest point detector is not used for finding features, the features found by this process are dependent on position, scale and orientation. Since this feature representation is high dimensional, we reduce dimensionality by using singular value decomposition (SVD). A projection in 50-dimensional space was sufficient to capture most of the relevant information in these images, and gave good results.</p>
    </sec>
  </sec>
  <sec sec-type="results" id="SEC3">
    <title>3 RESULTS</title>
    <p>We apply SPEX<sup>2</sup> to the ISH images from the BDGP (<xref ref-type="bibr" rid="B4">2005</xref>). Since our system performs automatic analysis for images in the lateral position, we picked 2689 images from the 13–16 time stage of the data set, which represent the expression patterns of 1432 genes. After automatic filtering of unqualified images in the standardization phase, 1904 images of 1011 genes entered the pattern extraction phase. We analyzed these expression patterns and report results on two exemplary tasks: automatic annotation of images, and image clustering.</p>
    <sec id="SEC3.1">
      <title>3.1 Image annotation</title>
      <p>The expression patterns in BDGP <italic>Drosophila</italic> ISH images were annotated with anatomical and development ontology terms from a controlled vocabulary by human curators. Automatic annotation of images with terms from a controlled vocabulary represents a unique challenge itself. Since the main goal of SPEX<sup>2</sup> is to extract concise spatial expression patterns from ISH images for generic downstream applications of any user, rather than offering a perfect annotator, we will demonstrate the quality of the SPEX<sup>2</sup> output (e.g. expression features) using standard off-the-shelf annotation classifiers.</p>
      <p>We focus on the 10 most frequent annotation terms in BDGP, and treat every term as an independent binary classification task. Each binary classifier is a standard SVM with a Gaussian kernel (we used libsvm (Chang and Lin, <xref ref-type="bibr" rid="B6">2001</xref>) for our experiments). We use 10-fold cross-validation over a small set of values to pick the tuning parameter of SVMs—the cost of misclassification <italic>C</italic>.</p>
      <p>We compare our results with two benchmark systems representing the state-of-the-art. In <bold>System I</bold>, we implement the feature extraction and classification procedure proposed by Zhou and Peng (<xref ref-type="bibr" rid="B35">2007</xref>). Their system extracts the embryo outline by using an adaptive thresholding method (Peng and Myers, <xref ref-type="bibr" rid="B26">2004</xref>), and registers the embryo using affine transformation and intensity scaling. The A/P orientation is determined by maximizing total gene similarity across all images. Subsequently, 2D wavelet embryo features are used, with min-redundancy max-relevance feature selection to pick the best features. Finally, binary classification on each annotation term is obtained via LDA (linear discriminant analysis). In <bold>System II</bold>, Ji <italic>et al.</italic> (<xref ref-type="bibr" rid="B18">2009</xref>) used dense SIFT feature descriptors that are converted into sparse codes to form a codebook to represent their aligned images, and proposed an elegant local regularization (LR) procedure for multi-label learning. Details on how to obtain well-aligned images were not given, but the work by the same group in Ye <italic>et al.</italic> (<xref ref-type="bibr" rid="B34">2006</xref>) used a image standardization procedure outlined in Kumar <italic>et al.</italic> (<xref ref-type="bibr" rid="B20">2002</xref>), followed by histogram equalization for improved contrast in images. Hence, we use the above procedure when implementing this system, using the LR code from that group.</p>
      <p>We evaluate the performance using accuracy and <italic>F</italic><sub>1</sub> score (Goutte and Gaussier, <xref ref-type="bibr" rid="B15">2005</xref>). The <italic>F</italic><sub>1</sub> score is the harmonic mean between the precision and recall of the results, and lies between 0 and 1, with higher <italic>F</italic><sub>1</sub> representing better performance. <xref ref-type="fig" rid="F10">Figure 10</xref> shows the classification accuracy based on the SPEX<sup>2</sup> features, in comparison with the benchmarks. In terms of mean accuracy, SPEX<sup>2</sup> outperforms both the systems, while maintaining the same <italic>F</italic><sub>1</sub> score. It is noteworthy that our result is obtained with a standard SVM, because our goal here is to demonstrate the quality of the SPEX<sup>2</sup> features, not that of the annotation algorithm. Indeed, we observe that using the sophisticated LR annotation algorithm of <bold>System II</bold> with our SPEX<sup>2</sup> features, increases our <italic>F</italic><sub>1</sub> score, at the cost of a very small reduction in accuracy. Using the paired <italic>t</italic> test, the difference in accuracy between SPEX<sup>2</sup> with LR and <bold>System II</bold> was found significant with <italic>P</italic> = 6.33e − 6 and the difference in <italic>F</italic><sub>1</sub> scores was significant with <italic>P</italic> = 9.51e − 5.
<fig id="F10" position="float"><label>Fig. 10.</label><caption><p>Mean accuracy and F<sub>1</sub> using macro-averaging, for predicting annotation terms.</p></caption><graphic xlink:href="btq172f10"/></fig>
</p>
      <p>In addition, we visualize the information captured in the extracted expression patterns from SPEX<sup>2</sup> and the two systems we compare with, by computing the SVD of the expression patterns (Pan <italic>et al.</italic>, <xref ref-type="bibr" rid="B25">2006</xref>). The set of eigen vectors can then be represented as images. We call these images eigen-expression patterns, like eigenfaces used in facial recognition (Pentland and Turk, <xref ref-type="bibr" rid="B27">1991</xref>). The top 25 eigen-expression patterns are shown in <xref ref-type="fig" rid="F11">Figure 11</xref>. Even though SVD performs global analysis of the feature space, the eigen-expression patterns produced by SPEX<sup>2</sup> seem to find localized regions of expression that correspond well to known gene expression patterns.
<fig id="F11" position="float"><label>Fig. 11.</label><caption><p>Eigen-expression patterns used for low dimensional feature representation. The eigen-expression patterns produced by <italic>SPEX</italic><sup>2</sup> show local pattern coherence and better capture spatial patterns observed in the data, which the other two methods are unable to capture.</p></caption><graphic xlink:href="btq172f11"/></fig>
</p>
    </sec>
    <sec id="SEC3.2">
      <title>3.2 Gene expression clustering</title>
      <p>Next, we evaluate the SPEX<sup>2</sup> features on clustering, using a popular (but not necessarily optimal) clustering algorithm, the spectral clustering (SC). To avoid tuning parameters, we used self-tuning SC (Chen <italic>et al.</italic>, <xref ref-type="bibr" rid="B7">2010</xref>). Since the number of clusters must be specified in advance, and is hard to estimate for biological gene data, we tried different numbers of clusters from 5 to 100 (in steps of 5). We do most of our analysis on 15 clusters, the mean image of each cluster is shown in <xref ref-type="fig" rid="F12">Figure 12</xref>. Visual inspection shows that the mean of each cluster has a distinctive pattern, each image looks salient enough to be a potential ISH image, even though it is the mean of tens to hundreds of images. This suggests that we have obtained high purity clusters. Details of the content of each cluster (i.e. represented by 10 images therein) are available in the <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btq172/DC1">Supplemental Material</ext-link>, which substantiate the above assessment.
<fig id="F12" position="float"><label>Fig. 12.</label><caption><p>Each image is the mean of a single cluster found by using processed images from different systems. The intensity of any pixel in the mean image is the average intensity of that pixel in all images assigned to this cluster. As can be seen, clustering using unprocessed images only finds clusters based on embryo position and illumination. The clusters produced by <italic>SPEX</italic><sup>2</sup> have very low noise, and visually look pure in terms of patterns clustered.</p></caption><graphic xlink:href="btq172f12"/></fig>
</p>
      <p>The literature on clustering specifies a variety of evaluation measures, however all of them are distance-based and not biologically intuitive. In this specific data set, we observe that we have two external sources of information associated with each image (that are not used by the clustering algorithm), which can help build an intuition of what good clusters should look like. The first source of information is the manual curation of these images, which has annotated each gene pattern with terms from a controlled vocabulary describing the localization of the expression pattern. The second source is the GO functional annotations, associated with the gene. We conduct enrichment analysis using both sets of information.</p>
      <sec id="SEC3.2.1">
        <title>3.2.1 Hypothesis test for enrichment</title>
        <p>Given a single cluster, and a single annotation term (from controlled vocabulary or GO ontology), a <italic>P</italic>-value can be obtained by using an exact hypergeometric test. However, since we test each cluster for multiple annotations, a correction for multiple hypothesis is needed. Standard corrections for multiple hypothesis testing are usually found to be either very conservative, or having low power. We instead convert the <italic>P</italic>-values into <italic>q</italic>-values, that control the positive false discovery rate (pFDR), by using the procedure described by Storey (<xref ref-type="bibr" rid="B30">2002</xref>). The pFDR is the expected proportion of erroneous rejections among all rejections, thus a pFDR value of 5% means that 5% of predicted significant features will be truly null. The <italic>q</italic>-value measures the strength of the observed statistic, with respect to pFDR, and automatically corrects for multiple hypothesis testing, it is therefore a much more powerful test scheme.</p>
        <p>We conduct enrichment analysis using the procedure outlined by Arava <italic>et al.</italic> (<xref ref-type="bibr" rid="B2">2003</xref>), which allows us to estimate <italic>q</italic>-values for multiple hypothesis tests, even when the statistics being measured are correlated (as is the case for GO and pattern annotations).</p>
      </sec>
      <sec id="SEC3.2.2">
        <title>3.2.2 Annotation terms enrichment</title>
        <p>If the data is well clustered, then a single cluster of images must be enriched for specific annotation terms that the images have been annotated with. <xref ref-type="table" rid="T1">Table 1</xref> shows a partial enrichment analysis for 15 clusters. All clusters were significantly enriched for at least one term, with a total of 90 enriched terms. Since the number of terms is higher than the number of clusters, each cluster is enriched for a combination of multiple terms. For example, cluster one with 149 images is enriched for images that have been annotated with embryonic brain and central nervous system, while cluster three with 100 images is enriched for a combination of embryonic brain with embryonic midgut and ventral nerve cord. Images annotated with only ventral nerve cord have been clustered into a separate cluster (having 139 images).
<table-wrap id="T1" position="float"><label>Table 1.</label><caption><p>Enrichment analysis for 15 clusters, using terms from the controlled vocabulary</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th align="left" rowspan="1" colspan="1">Cluster size</th><th align="left" rowspan="1" colspan="1">Term annotation</th><th align="left" rowspan="1" colspan="1">Annotation probability</th><th align="left" rowspan="1" colspan="1">Overlap</th><th align="left" rowspan="1" colspan="1"><italic>q</italic>-value</th></tr></thead><tbody align="left"><tr><td align="left" rowspan="1" colspan="1">149</td><td align="left" rowspan="1" colspan="1">Embryonic brain</td><td align="left" rowspan="1" colspan="1">0.298</td><td align="left" rowspan="1" colspan="1">133</td><td align="left" rowspan="1" colspan="1">5.14e-17</td></tr><tr><td rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1">Embryonic central nervous system</td><td align="left" rowspan="1" colspan="1">0.117</td><td align="left" rowspan="1" colspan="1">49</td><td align="left" rowspan="1" colspan="1">9.27e-30</td></tr><tr><td align="left" rowspan="1" colspan="1">194</td><td align="left" rowspan="1" colspan="1">Embryonic midgut</td><td align="left" rowspan="1" colspan="1">0.282</td><td align="left" rowspan="1" colspan="1">109</td><td align="left" rowspan="1" colspan="1">1.84e-20</td></tr><tr><td rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1">Embryonic/larval muscle system</td><td align="left" rowspan="1" colspan="1">0.150</td><td align="left" rowspan="1" colspan="1">67</td><td align="left" rowspan="1" colspan="1">3.27e-13</td></tr><tr><td rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1">Embryonic Malpighian tubule</td><td align="left" rowspan="1" colspan="1">0.074</td><td align="left" rowspan="1" colspan="1">41</td><td align="left" rowspan="1" colspan="1">6.59e-12</td></tr><tr><td rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1">Embryonic anal pad</td><td align="left" rowspan="1" colspan="1">0.122</td><td align="left" rowspan="1" colspan="1">49</td><td align="left" rowspan="1" colspan="1">1.30e-5</td></tr><tr><td rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1">Embryonic gastric caecum</td><td align="left" rowspan="1" colspan="1">0.028</td><td align="left" rowspan="1" colspan="1">23</td><td align="left" rowspan="1" colspan="1">5.61e-7</td></tr><tr><td rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1">Dorsal prothoracic pharyngeal muscle</td><td align="left" rowspan="1" colspan="1">0.103</td><td align="left" rowspan="1" colspan="1">47</td><td align="left" rowspan="1" colspan="1">2.72e-15</td></tr><tr><td align="left" rowspan="1" colspan="1">100</td><td align="left" rowspan="1" colspan="1">Embryonic midgut</td><td align="left" rowspan="1" colspan="1">0.282</td><td align="left" rowspan="1" colspan="1">56</td><td align="left" rowspan="1" colspan="1">1.03e-6</td></tr><tr><td rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1">Embryonic brain</td><td align="left" rowspan="1" colspan="1">0.298</td><td align="left" rowspan="1" colspan="1">67</td><td align="left" rowspan="1" colspan="1">3.98e-13</td></tr><tr><td rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1">Ventral nerve cord</td><td align="left" rowspan="1" colspan="1">0.327</td><td align="left" rowspan="1" colspan="1">68</td><td align="left" rowspan="1" colspan="1">6.64e-11</td></tr><tr><td rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1">Ventral sensory complex primordium</td><td align="left" rowspan="1" colspan="1">0.084</td><td align="left" rowspan="1" colspan="1">23</td><td align="left" rowspan="1" colspan="1">3.95e-4</td></tr><tr><td align="left" rowspan="1" colspan="1">139</td><td align="left" rowspan="1" colspan="1">Ventral nerve cord</td><td align="left" rowspan="1" colspan="1">0.327</td><td align="left" rowspan="1" colspan="1">75</td><td align="left" rowspan="1" colspan="1">5.80e-6</td></tr><tr><td align="left" rowspan="1" colspan="1">39</td><td align="left" rowspan="1" colspan="1">Embryonic central brain pars intercerebralis</td><td align="left" rowspan="1" colspan="1">0.0094</td><td align="left" rowspan="1" colspan="1">5</td><td align="left" rowspan="1" colspan="1">6.94e-3</td></tr><tr><td align="left" rowspan="1" colspan="1">110</td><td align="left" rowspan="1" colspan="1">Amnioserosa</td><td align="left" rowspan="1" colspan="1">0.01577</td><td align="left" rowspan="1" colspan="1">13</td><td align="left" rowspan="1" colspan="1">1.12e-6</td></tr><tr><td align="left" rowspan="1" colspan="1">140</td><td align="left" rowspan="1" colspan="1">Embryonic esophagus</td><td align="left" rowspan="1" colspan="1">0.0678</td><td align="left" rowspan="1" colspan="1">27</td><td align="left" rowspan="1" colspan="1">4.11e-5</td></tr><tr><td rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1">Embryonic hypopharynx</td><td align="left" rowspan="1" colspan="1">0.168</td><td align="left" rowspan="1" colspan="1">51</td><td align="left" rowspan="1" colspan="1">5.07e-6</td></tr><tr><td rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1">Embryonic proventriculus</td><td align="left" rowspan="1" colspan="1">0.121</td><td align="left" rowspan="1" colspan="1">40</td><td align="left" rowspan="1" colspan="1">1.50e-5</td></tr><tr><td align="left" rowspan="1" colspan="1">165</td><td align="left" rowspan="1" colspan="1">Embryonic/larval muscle system</td><td align="left" rowspan="1" colspan="1">0.15</td><td align="left" rowspan="1" colspan="1">74</td><td align="left" rowspan="1" colspan="1">3.27e-12</td></tr><tr><td rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1">Dorsal prothoracic pharyngeal muscle</td><td align="left" rowspan="1" colspan="1">0.103</td><td align="left" rowspan="1" colspan="1">53</td><td align="left" rowspan="1" colspan="1">1.65e-17</td></tr><tr><td align="left" rowspan="1" colspan="1">168</td><td align="left" rowspan="1" colspan="1">Yolk nuclei</td><td align="left" rowspan="1" colspan="1">0.073</td><td align="left" rowspan="1" colspan="1">64</td><td align="left" rowspan="1" colspan="1">2.78e-31</td></tr><tr><td rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1">Gonadal sheath</td><td align="left" rowspan="1" colspan="1">0.0007</td><td align="left" rowspan="1" colspan="1">7</td><td align="left" rowspan="1" colspan="1">2.43e-2</td></tr><tr><td align="left" rowspan="1" colspan="1">78</td><td align="left" rowspan="1" colspan="1">Embryonic brain</td><td align="left" rowspan="1" colspan="1">0.298</td><td align="left" rowspan="1" colspan="1">47</td><td align="left" rowspan="1" colspan="1">5.11e-6</td></tr><tr><td rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1">Ventral nerve cord</td><td align="left" rowspan="1" colspan="1">0.327</td><td align="left" rowspan="1" colspan="1">56</td><td align="left" rowspan="1" colspan="1">7.31e-8</td></tr><tr><td align="left" rowspan="1" colspan="1">70</td><td align="left" rowspan="1" colspan="1">Embryonic hypopharynx</td><td align="left" rowspan="1" colspan="1">0.168</td><td align="left" rowspan="1" colspan="1">28</td><td align="left" rowspan="1" colspan="1">2.77e-4</td></tr><tr><td rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1">Labral sensory complex</td><td align="left" rowspan="1" colspan="1">0.009</td><td align="left" rowspan="1" colspan="1">7</td><td align="left" rowspan="1" colspan="1">2.77e-4</td></tr><tr><td rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1">Embryonic maxillary sensory complex</td><td align="left" rowspan="1" colspan="1">0.0205</td><td align="left" rowspan="1" colspan="1">10</td><td align="left" rowspan="1" colspan="1">2.68e-4</td></tr><tr><td align="left" rowspan="1" colspan="1">128</td><td align="left" rowspan="1" colspan="1">Embryonic salivary gland body</td><td align="left" rowspan="1" colspan="1">0.021</td><td align="left" rowspan="1" colspan="1">12</td><td align="left" rowspan="1" colspan="1">2.482e-3</td></tr><tr><td align="left" rowspan="1" colspan="1">96</td><td align="left" rowspan="1" colspan="1">Embryonic large intestine</td><td align="left" rowspan="1" colspan="1">0.035</td><td align="left" rowspan="1" colspan="1">13</td><td align="left" rowspan="1" colspan="1">7.120e-3</td></tr><tr><td align="left" rowspan="1" colspan="1">163</td><td align="left" rowspan="1" colspan="1">Embryonic/larval somatic muscle</td><td align="left" rowspan="1" colspan="1">0.070</td><td align="left" rowspan="1" colspan="1">31</td><td align="left" rowspan="1" colspan="1">6.06e-5</td></tr><tr><td rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1">Dorsal prothoracic pharyngeal muscle</td><td align="left" rowspan="1" colspan="1">0.103</td><td align="left" rowspan="1" colspan="1">37</td><td align="left" rowspan="1" colspan="1">3.43e-4</td></tr><tr><td align="left" rowspan="1" colspan="1">93</td><td align="left" rowspan="1" colspan="1">Ventral nerve cord</td><td align="left" rowspan="1" colspan="1">0.327</td><td align="left" rowspan="1" colspan="1">51</td><td align="left" rowspan="1" colspan="1">5.491e-3</td></tr></tbody></table><table-wrap-foot><fn><p>The first column shows the size of the cluster, the next two columns show the term annotation, and the probability that a given gene will be annotated with this term. The fourth column gives the number of images in this cluster annotated with this term, with the last column giving the <italic>q</italic>-value of the overlap.</p></fn></table-wrap-foot></table-wrap>
</p>
        <p>To assess the advantage of concise expression information extracted by SPEX<sup>2</sup> over benchmark systems, we performed the same clustering analysis based on features generated by the two systems discussed above. We counted the number of clusters from there that have at least one significant annotation at <italic>q</italic> = 0.05. <xref ref-type="fig" rid="F13">Figure 13</xref> shows the number of significant clusters found by the three methods, as we vary the number of clusters from 5 to 100. We observe that SPEX<sup>2</sup> works better than the other two methods, with an average of 18.39% more significant clusters obtained than its closest competitor <bold>System I</bold>.
<fig id="F13" position="float"><label>Fig. 13.</label><caption><p>Significantly enriched clusters versus total number of clusters (<italic>q</italic> = 0.05)</p></caption><graphic xlink:href="btq172f13"/></fig>
</p>
      </sec>
      <sec id="SEC3.2.3">
        <title>3.2.3 GO functional enrichment</title>
        <p>It is believed that similar spatial–temporal patterns of gene expression are related to similar functionality. Hence, we might expect that a good clustering will be enriched for gene functions, as defined by the GO ontology. Since we are analyzing data from stage 13–16 of <italic>Drosophila</italic> embryonic development, its not clear that the spatial expression information in this brief period is enough for gene functionality enrichment. Hence, we do a limited functional enrichment analysis of our cluster results, and leave extended analysis across time stages for future work.</p>
        <p>Since we are analyzing spatial patterns of genes that are differentially expressed in the embryonic stage, without any analysis across time, we expect to find enrichment of smaller, more precise functional annotations that are related to specific areas of embryonic development, and GO Slim is not appropriate. For our enrichment analysis, we used GO annotations that are present in at least five genes in our data set.</p>
        <p><xref ref-type="table" rid="T2">Table 2</xref> shows a part of the enrichment analysis performed on 15 clusters. We observe that 9 out of the 15 clusters are significantly enriched (<italic>q</italic> = 0.05) for various GO ontology functions, many of which are known to be explicitly relevant to <italic>Drosophila</italic> development. For example, 8 of the 12 genes related to myoblast fusion are found in a single cluster. Genes for the myoblast fusion are known to be expressed early in development, in embryos 0–4h after egg laying, and remain high during embryogenesis (but not in the larval stage; (Dworak and Sink, <xref ref-type="bibr" rid="B11">2002</xref>). Additionally, it is known that during <italic>Drosophila</italic> embryogenesis, the development of the open tracheal system can be observed on the dorsal side; 18 of the 43 genes related to open tracheal system development are found in a single cluster.
<table-wrap id="T2" position="float"><label>Table 2.</label><caption><p>Enrichment analysis for 15 clusters, using GO functional annotations</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th align="left" rowspan="1" colspan="1">Cluster size</th><th align="left" rowspan="1" colspan="1">GO category</th><th align="left" rowspan="1" colspan="1">GO function</th><th align="left" rowspan="1" colspan="1">GO category size</th><th align="left" rowspan="1" colspan="1">Overlap</th><th align="left" rowspan="1" colspan="1"><italic>q</italic>-value</th></tr></thead><tbody align="left"><tr><td align="left" rowspan="1" colspan="1">149</td><td align="left" rowspan="1" colspan="1">GO:0007520</td><td align="left" rowspan="1" colspan="1">Myoblast fusion</td><td align="left" rowspan="1" colspan="1">12</td><td align="left" rowspan="1" colspan="1">8</td><td align="left" rowspan="1" colspan="1">0.00 539</td></tr><tr><td align="left" rowspan="1" colspan="1">187</td><td align="left" rowspan="1" colspan="1">GO:0007424</td><td align="left" rowspan="1" colspan="1">Open tracheal system development</td><td align="left" rowspan="1" colspan="1">43</td><td align="left" rowspan="1" colspan="1">18</td><td align="left" rowspan="1" colspan="1">0.011 601</td></tr><tr><td rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1">GO:0008354</td><td align="left" rowspan="1" colspan="1">Germ cell migration</td><td align="left" rowspan="1" colspan="1">8</td><td align="left" rowspan="1" colspan="1">5</td><td align="left" rowspan="1" colspan="1">0.081 374</td></tr><tr><td rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1">GO:0035017</td><td align="left" rowspan="1" colspan="1">Cuticle pattern formation</td><td align="left" rowspan="1" colspan="1">8</td><td align="left" rowspan="1" colspan="1">5</td><td align="left" rowspan="1" colspan="1">0.081 374</td></tr><tr><td align="left" rowspan="1" colspan="1">126</td><td align="left" rowspan="1" colspan="1">GO:0008407</td><td align="left" rowspan="1" colspan="1">Bristle morphogenesis</td><td align="left" rowspan="1" colspan="1">6</td><td align="left" rowspan="1" colspan="1">5</td><td align="left" rowspan="1" colspan="1">0.005 878</td></tr><tr><td align="left" rowspan="1" colspan="1">102</td><td align="left" rowspan="1" colspan="1">GO:0035193</td><td align="left" rowspan="1" colspan="1">Larval central nervous system remodeling</td><td align="left" rowspan="1" colspan="1">10</td><td align="left" rowspan="1" colspan="1">10</td><td align="left" rowspan="1" colspan="1">0.0010 015</td></tr><tr><td rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1">GO:0006914</td><td align="left" rowspan="1" colspan="1">Autophagy</td><td align="left" rowspan="1" colspan="1">10</td><td align="left" rowspan="1" colspan="1">10</td><td align="left" rowspan="1" colspan="1">0.0010 015</td></tr><tr><td rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1">GO:0007350</td><td align="left" rowspan="1" colspan="1">Blastoderm segmentation</td><td align="left" rowspan="1" colspan="1">9</td><td align="left" rowspan="1" colspan="1">5</td><td align="left" rowspan="1" colspan="1">0.046 871</td></tr><tr><td rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1">GO:0007379</td><td align="left" rowspan="1" colspan="1">Segment specification</td><td align="left" rowspan="1" colspan="1">9</td><td align="left" rowspan="1" colspan="1">5</td><td align="left" rowspan="1" colspan="1">0.046 871</td></tr><tr><td rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1">GO:0007458</td><td align="left" rowspan="1" colspan="1">Progression of morphogenetic furrow during compound eye morphogenesis</td><td align="left" rowspan="1" colspan="1">10</td><td align="left" rowspan="1" colspan="1">10</td><td align="left" rowspan="1" colspan="1">0.0010 015</td></tr><tr><td rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1">GO:0007552</td><td align="left" rowspan="1" colspan="1">Metamorphosis</td><td align="left" rowspan="1" colspan="1">17</td><td align="left" rowspan="1" colspan="1">10</td><td align="left" rowspan="1" colspan="1">0.068 039</td></tr><tr><td rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1">GO:0007562</td><td align="left" rowspan="1" colspan="1">Eclosion</td><td align="left" rowspan="1" colspan="1">10</td><td align="left" rowspan="1" colspan="1">10</td><td align="left" rowspan="1" colspan="1">0.0010 015</td></tr><tr><td rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1">GO:0048808</td><td align="left" rowspan="1" colspan="1">Male genitalia morphogenesis</td><td align="left" rowspan="1" colspan="1">10</td><td align="left" rowspan="1" colspan="1">10</td><td align="left" rowspan="1" colspan="1">0.0010 015</td></tr><tr><td align="left" rowspan="1" colspan="1">174</td><td align="left" rowspan="1" colspan="1">GO:0005730</td><td align="left" rowspan="1" colspan="1">Nucleolus</td><td align="left" rowspan="1" colspan="1">11</td><td align="left" rowspan="1" colspan="1">8</td><td align="left" rowspan="1" colspan="1">0.00 961</td></tr><tr><td align="left" rowspan="1" colspan="1">116</td><td align="left" rowspan="1" colspan="1">GO:0017150</td><td align="left" rowspan="1" colspan="1">tRNA dihydrouridine synthase activity</td><td align="left" rowspan="1" colspan="1">5</td><td align="left" rowspan="1" colspan="1">4</td><td align="left" rowspan="1" colspan="1">0.021 049</td></tr><tr><td rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1">GO:0003725</td><td align="left" rowspan="1" colspan="1">Double-stranded RNA binding</td><td align="left" rowspan="1" colspan="1">5</td><td align="left" rowspan="1" colspan="1">4</td><td align="left" rowspan="1" colspan="1">0.021 049</td></tr><tr><td rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1">GO:0003777</td><td align="left" rowspan="1" colspan="1">Microtubule motor activity</td><td align="left" rowspan="1" colspan="1">9</td><td align="left" rowspan="1" colspan="1">6</td><td align="left" rowspan="1" colspan="1">0.006 836</td></tr><tr><td rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1">GO:0005873</td><td align="left" rowspan="1" colspan="1">Plus-end kinesin complex</td><td align="left" rowspan="1" colspan="1">5</td><td align="left" rowspan="1" colspan="1">4</td><td align="left" rowspan="1" colspan="1">0.021 049</td></tr><tr><td rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1">GO:0016323</td><td align="left" rowspan="1" colspan="1">Basolateral plasma membrane</td><td align="left" rowspan="1" colspan="1">8</td><td align="left" rowspan="1" colspan="1">8</td><td align="left" rowspan="1" colspan="1">0.044 737</td></tr><tr><td align="left" rowspan="1" colspan="1">94</td><td align="left" rowspan="1" colspan="1">GO:0004866</td><td align="left" rowspan="1" colspan="1">Endopeptidase inhibitor activity</td><td align="left" rowspan="1" colspan="1">5</td><td align="left" rowspan="1" colspan="1">4</td><td align="left" rowspan="1" colspan="1">0.021 049</td></tr><tr><td align="left" rowspan="1" colspan="1">68</td><td align="left" rowspan="1" colspan="1">GO:0004497</td><td align="left" rowspan="1" colspan="1">Monooxygenase activity</td><td align="left" rowspan="1" colspan="1">12</td><td align="left" rowspan="1" colspan="1">6</td><td align="left" rowspan="1" colspan="1">0.028 244</td></tr><tr><td align="left" rowspan="1" colspan="1">44</td><td align="left" rowspan="1" colspan="1">GO:0006508</td><td align="left" rowspan="1" colspan="1">Proteolysis</td><td align="left" rowspan="1" colspan="1">48</td><td align="left" rowspan="1" colspan="1">8</td><td align="left" rowspan="1" colspan="1">0.009 222</td></tr></tbody></table><table-wrap-foot><fn><p>The first column shows the size of each cluster, the next three columns show the GO category, function, and number of genes in the dataset having that GO function. The fifth column gives the number of genes with the particular GO function present in this cluster, and the last column gives the <italic>q</italic>-value of the overlap.</p></fn></table-wrap-foot></table-wrap>
</p>
        <p>All 10 genes related to ‘progression of morphogenetic furrow during compound eye morphogenesis’ are found in the same cluster, and five of the nine genes related to segment specification, are also clustered together. Additionally, all genes related to ‘larval central nervous system remodeling’ are found in a single cluster, and five of the six genes related to ‘bristle morphegenesis’ are also co-clustered. This seems to imply that genes involved in larval stage development are already showing spatial coherence in the embryonic stage.</p>
        <p>Thus, the SPEX<sup>2</sup> clusters are able to capture fine-grained GO functional annotations. In contrast, clustering using features extracted by <bold>System I</bold> found only six significant clusters out of 15. Our method thus improves the number of significantly enriched clusters by 50%. <bold>System II</bold> returned only one significantly enriched cluster out of 15, at <italic>q</italic> = 0.05.</p>
      </sec>
    </sec>
  </sec>
  <sec sec-type="discussion" id="SEC4">
    <title>4 DISCUSSION</title>
    <p>SPEX<sup>2</sup> represents the first step towards automatic functional analysis of ISH images of <italic>Drosophila</italic> embryos, namely concise extraction of spatial gene expression patterns. Our extraction system employs a pipeline of analytical techniques to first standardize the embryo via embryo outline extraction, orientation detection and correction, and registration; and then extracts spatial expression signal via filters and probabilistic segmenters. Finally, it converts the spatial signals into a low-dimensional feature representation, suitable for advanced analysis. We evaluated our system by using the resultant features for automatic pattern annotation and clustering. Using simple classification techniques and our sophisticated feature extraction pipeline, we achieved a significant improvement in annotation accuracy over existing systems. We also clustered the Drosophila ISH images, and conducted enrichment analysis on both pattern term annotations, and GO functional annotations. We found significant enrichment in both scenarios.</p>
    <p>The next step is a more detailed analysis of ISH images using this feature representation. The current work has focused on clustering images from a single time step—in the future, we plan to study image analysis across time. Another important question to be addressed is how to combine microarray data with ISH image data to be able to be able to leverage two independent sources for joint analysis.</p>
    <p>The concise spatial pattern of genes extracted from ISH images by SPEX<sup>2</sup> can also be used as a token of gene expression and applied to infer a gene regulation network, as with microarray data. A detailed study along this direction involves some additional technicalities, and is therefore beyond the scope of this paper.</p>
    <p>Finally, another direction of future research would be to find time-varying gene regulatory networks using this data. Such analysis would allow us to capture spatial variations at a single time stage, as well as varying relationships between genes across time. A first step in this direction has been taken for microarray data by Ahmed and Xing (<xref ref-type="bibr" rid="B1">2009</xref>). We intend to develop extensions of this model for Drosophila ISH images, thus enabling us to discover spatial–temporal gene regulation networks.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="PMC_1" content-type="local-data">
      <caption>
        <title>[Supplementary Data]</title>
      </caption>
      <media mimetype="text" mime-subtype="html" xlink:href="btq172_index.html"/>
      <media xlink:role="associated-file" mimetype="application" mime-subtype="pdf" xlink:href="btq172_1.pdf"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <title>ACKNOWLEDGEMENTS</title>
    <p>We thank Fan Guo and Lei Li for assistance and helpful discussions during initial processing of the BDGP images.</p>
    <p><italic>Funding</italic>: National Science Foundation DBI (0640543, 0546594); Alfred P. Sloan Fellowship (to E.P.X).</p>
    <p><italic>Conflict of Interest</italic>: none declared.</p>
  </ack>
  <ref-list>
    <title>REFERENCES</title>
    <ref id="B1">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ahmed</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Xing</surname>
            <given-names>EP</given-names>
          </name>
        </person-group>
        <article-title>Tesla: recovering time-varying networks of dependencies in social and biological studie</article-title>
        <source>Proc. Natl Acad. Sci.</source>
        <year>2009</year>
        <volume>106</volume>
        <fpage>11878</fpage>
        <lpage>11883</lpage>
        <pub-id pub-id-type="pmid">19570995</pub-id>
      </element-citation>
    </ref>
    <ref id="B2">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Arava</surname>
            <given-names>Y</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Genome-wide analysis of mrna translation profiles in saccharomyces cerevisiae</article-title>
        <source>Proce. Natl Acad. Sci.</source>
        <year>2003</year>
        <volume>100</volume>
        <fpage>3889</fpage>
        <lpage>3894</lpage>
      </element-citation>
    </ref>
    <ref id="B3">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bar-Joseph</surname>
            <given-names>Z</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Computational discovery of gene module and regulatory networks</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2003</year>
        <volume>21</volume>
        <fpage>1337</fpage>
        <lpage>1342</lpage>
        <pub-id pub-id-type="pmid">14555958</pub-id>
      </element-citation>
    </ref>
    <ref id="B4">
      <element-citation publication-type="journal">
        <collab>BDGP</collab>
        <source>Patterns of gene expression in drosophila embryogenesis</source>
        <year>2005</year>
      </element-citation>
    </ref>
    <ref id="B5">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Causier</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Studying the interactome with the yeast two-hybrid system and mass spectrometry</article-title>
        <source>Mass Spectrom. Rev.</source>
        <year>2004</year>
        <volume>23</volume>
        <fpage>350</fpage>
        <lpage>367</lpage>
        <pub-id pub-id-type="pmid">15264234</pub-id>
      </element-citation>
    </ref>
    <ref id="B6">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chang</surname>
            <given-names>C.-C</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>C.-J</given-names>
          </name>
        </person-group>
        <source>LIBSVM: a Library for Support Vector Machines.</source>
        <year>2001</year>
        <comment>Available at <ext-link ext-link-type="uri" xlink:href="http://www.csie.ntu.edu.tw/∼cjlin/libsvm">http://www.csie.ntu.edu.tw/∼cjlin/libsvm</ext-link></comment>
      </element-citation>
    </ref>
    <ref id="B7">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>W.-Y</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Parallel Spectral Clustering in Distributed Systems</article-title>
        <source>IEEE transactions on Pattern Analysis and Machine Intelligence (PAMI)</source>
        <year>2010</year>
      </element-citation>
    </ref>
    <ref id="B8">
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Cowell</surname>
            <given-names>RG</given-names>
          </name>
          <etal/>
        </person-group>
        <source>Probabilistic Networks and Expert Systems.</source>
        <year>1999</year>
        <publisher-loc>New York</publisher-loc>
        <publisher-name>Springer</publisher-name>
      </element-citation>
    </ref>
    <ref id="B9">
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Davidson</surname>
            <given-names>EH</given-names>
          </name>
        </person-group>
        <source>Genomic Regulatory Systems</source>
        <year>2001</year>
        <publisher-loc>San Diego, CA, US</publisher-loc>
        <publisher-name>Academic Press</publisher-name>
      </element-citation>
    </ref>
    <ref id="B10">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dobra</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Sparse graphical models for exploring gene expression data</article-title>
        <source>J. Mult. Analysis</source>
        <year>2004</year>
        <volume>90</volume>
        <fpage>196</fpage>
        <lpage>212</lpage>
      </element-citation>
    </ref>
    <ref id="B11">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dworak</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Sink</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Myoblast fusion in drosophila</article-title>
        <source>BioEssays</source>
        <year>2002</year>
        <volume>24</volume>
        <fpage>591</fpage>
        <lpage>601</lpage>
        <pub-id pub-id-type="pmid">12111720</pub-id>
      </element-citation>
    </ref>
    <ref id="B12">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gargesha</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Automatic annotation techniques for gene expression images of the fruit fly embryo</article-title>
        <source>Society of Photo-Optical Instrumentation Engineers (SPIE) Conference Series</source>
        <year>2005</year>
        <volume>5960</volume>
        <fpage>576</fpage>
        <lpage>583</lpage>
      </element-citation>
    </ref>
    <ref id="B13">
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Gilbert</surname>
            <given-names>SF</given-names>
          </name>
        </person-group>
        <source>Developmental Biology</source>
        <year>2003</year>
        <edition>7th</edition>
        <publisher-loc>Sunderland, MA</publisher-loc>
        <publisher-name>Sinauer Associates</publisher-name>
      </element-citation>
    </ref>
    <ref id="B14">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Giot</surname>
            <given-names>L</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A protein interaction map of Drosophila melanogaster</article-title>
        <source>Science</source>
        <year>2003</year>
        <volume>302</volume>
        <fpage>1727</fpage>
        <lpage>1736</lpage>
        <pub-id pub-id-type="pmid">14605208</pub-id>
      </element-citation>
    </ref>
    <ref id="B15">
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Goutte</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Gaussier</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <person-group person-group-type="editor">
          <name>
            <surname>Losada</surname>
            <given-names>DE</given-names>
          </name>
          <name>
            <surname>Fernandez-Luna</surname>
            <given-names>JM</given-names>
          </name>
        </person-group>
        <article-title>A Probabilistic Interpretation of Precision, Recall and F-Score, with Implication for Evaluation</article-title>
        <source>Advances in Information Retrieval - 27th European Conference on IR Research (ECIR'05)</source>
        <year>2005</year>
        <volume>3408</volume>
        <publisher-name>Springer</publisher-name>
        <fpage>345</fpage>
        <lpage>359</lpage>
        <comment>of <italic>Lecture Notes in Computer Science</italic></comment>
      </element-citation>
    </ref>
    <ref id="B16">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Harbison</surname>
            <given-names>CT</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Transcriptional regulatory code of a eukaryotic genome</article-title>
        <source>Nature</source>
        <year>2004</year>
        <volume>431</volume>
        <fpage>99</fpage>
        <lpage>104</lpage>
        <pub-id pub-id-type="pmid">15343339</pub-id>
      </element-citation>
    </ref>
    <ref id="B17">
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Heffel</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Process flow for classification and clustering of fruit fly gene expression patterns</article-title>
        <source>15th IEEE International Conference on Image Processing</source>
        <year>2008</year>
        <publisher-loc>San Diego, USA</publisher-loc>
        <publisher-name>IEEE Signal Processing Society</publisher-name>
        <fpage>721</fpage>
        <lpage>724</lpage>
      </element-citation>
    </ref>
    <ref id="B18">
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Ji</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Drosophila gene expression pattern annotation using sparse features and term-term interactions</article-title>
        <source>ACM SIGKDD conference on Knowledge Discovery and Data Mining</source>
        <year>2009</year>
        <publisher-loc>Paris, France</publisher-loc>
        <publisher-name>ACM</publisher-name>
        <fpage>407</fpage>
        <lpage>416</lpage>
      </element-citation>
    </ref>
    <ref id="B19">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kelley</surname>
            <given-names>BP</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>PathBLAST: a tool for alignment of protein interaction networks</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2004</year>
        <volume>32</volume>
        <issue>Web Server</issue>
        <fpage>83</fpage>
        <lpage>88</lpage>
      </element-citation>
    </ref>
    <ref id="B20">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kumar</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>BEST: a novel computational approach for comparing gene expression patterns from early stages of Drosophila melanogaster development</article-title>
        <source>Genetics</source>
        <year>2002</year>
        <volume>162</volume>
        <fpage>2037</fpage>
        <lpage>2047</lpage>
        <pub-id pub-id-type="pmid">12524369</pub-id>
      </element-citation>
    </ref>
    <ref id="B21">
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>Y.-X</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Drosophila gene expression pattern annotation through multi-instance multi-label learning</article-title>
        <source>The Twenty-first International Joint Conference on Artificial Intelligence</source>
        <year>2009</year>
        <publisher-loc>Pasadena, USA</publisher-loc>
        <publisher-name>The Association for the Advancement of Artificial Intelligence</publisher-name>
        <fpage>1445</fpage>
        <lpage>1450</lpage>
      </element-citation>
    </ref>
    <ref id="B22">
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Lowe</surname>
            <given-names>DG</given-names>
          </name>
        </person-group>
        <article-title>Object recognition from local scale-invariant features</article-title>
        <source>Seventh International Conference on Computer Vision</source>
        <year>1999</year>
        <publisher-loc>Corfu, Greece</publisher-loc>
        <publisher-name>IEEE</publisher-name>
        <fpage>1150</fpage>
        <lpage>1157</lpage>
      </element-citation>
    </ref>
    <ref id="B23">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Montalta-He</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Reichert</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Impressive expressions: developing a systematic database of gene-expression patterns in Drosophila embryogenesis</article-title>
        <source>Genome Biol.</source>
        <year>2003</year>
        <volume>4</volume>
        <fpage>205</fpage>
        <pub-id pub-id-type="pmid">12620112</pub-id>
      </element-citation>
    </ref>
    <ref id="B24">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ong</surname>
            <given-names>IM</given-names>
          </name>
        </person-group>
        <article-title>Modelling regulatory pathways in E.coli from time series expression profiles</article-title>
        <source>Bioinformatics</source>
        <year>2002</year>
        <volume>18</volume>
        <fpage>241S</fpage>
        <lpage>248S</lpage>
      </element-citation>
    </ref>
    <ref id="B25">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pan</surname>
            <given-names>J.-Y</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Automatic mining of fruit fly embryo images</article-title>
        <source>In ACM SIGKDD conference on Knowledge Discovery and Data Mining</source>
        <year>2006</year>
      </element-citation>
    </ref>
    <ref id="B26">
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Peng</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Myers</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>Comparing in situ mrna expressions of Drosophila embryos</article-title>
        <source>Proceedings 8th Annual International Conference on Research in Computational Molecular Biology (RECOMB 2004)</source>
        <year>2004</year>
        <publisher-loc>San Diego</publisher-loc>
        <publisher-name>ACM</publisher-name>
        <fpage>157</fpage>
        <lpage>166</lpage>
      </element-citation>
    </ref>
    <ref id="B27">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pentland</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Turk</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Eigenfaces for recognition</article-title>
        <source>J. Cogn. Neurosci.</source>
        <year>1991</year>
        <volume>3</volume>
        <fpage>71</fpage>
        <lpage>86</lpage>
      </element-citation>
    </ref>
    <ref id="B28">
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Ren</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Malik</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Learning a classification model for segmentation</article-title>
        <source>the Ninth IEEE International Conference on Computer Vision</source>
        <year>2003</year>
        <publisher-loc>Nice, France</publisher-loc>
        <publisher-name>IEEE</publisher-name>
        <fpage>10</fpage>
        <lpage>17</lpage>
      </element-citation>
    </ref>
    <ref id="B29">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Segal</surname>
            <given-names>E</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Module networks: identifying regulatory modules and their condition-specific regulators from gene expression data</article-title>
        <source>Nat. Genet.</source>
        <year>2003</year>
        <volume>34</volume>
        <fpage>166</fpage>
        <lpage>176</lpage>
        <pub-id pub-id-type="pmid">12740579</pub-id>
      </element-citation>
    </ref>
    <ref id="B30">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Storey</surname>
            <given-names>JD</given-names>
          </name>
        </person-group>
        <article-title>A direct approach to false discovery rates</article-title>
        <source>J. Roy. Stat. Soc., B</source>
        <year>2002</year>
        <volume>64</volume>
        <fpage>479</fpage>
        <lpage>498</lpage>
      </element-citation>
    </ref>
    <ref id="B31">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tanay</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Revealing modularity and organization in the yeast molecular network by integrated analysis of highly heterogeneous genomewide data</article-title>
        <source>Proc. Natl Acad. Sci. USA</source>
        <year>2004</year>
        <volume>101</volume>
        <fpage>2981</fpage>
        <lpage>2986</lpage>
        <pub-id pub-id-type="pmid">14973197</pub-id>
      </element-citation>
    </ref>
    <ref id="B32">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tomancak</surname>
            <given-names>P</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Systematic determination of patterns of gene expression during drosophila embryogenesis</article-title>
        <source>Genome Biol.</source>
        <year>2002</year>
        <volume>3</volume>
      </element-citation>
    </ref>
    <ref id="B33">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tomancak</surname>
            <given-names>P</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Global analysis of patterns of gene expression during drosophila embryogenesis</article-title>
        <source>Genome Biol.</source>
        <year>2007</year>
        <volume>8</volume>
      </element-citation>
    </ref>
    <ref id="B34">
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Ye</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Classification of Drosophila embryonic developmental stage range based on gene expression pattern images</article-title>
        <source>Computational Systems Bioinformatics conference</source>
        <year>2006</year>
        <publisher-loc>California, USA</publisher-loc>
        <publisher-name>IEEE</publisher-name>
        <fpage>293</fpage>
        <lpage>298</lpage>
      </element-citation>
    </ref>
    <ref id="B35">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhou</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Peng</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Automatic recognition and annotation of gene expression patterns of fly embryos</article-title>
        <source>Bioinformatics</source>
        <year>2007</year>
        <volume>23</volume>
        <fpage>589</fpage>
        <lpage>596</lpage>
        <pub-id pub-id-type="pmid">17237064</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
