<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Nat Methods</journal-id>
    <journal-id journal-id-type="iso-abbrev">Nat Methods</journal-id>
    <journal-title-group>
      <journal-title>Nature Methods</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1548-7091</issn>
    <issn pub-type="epub">1548-7105</issn>
    <publisher>
      <publisher-name>Nature Publishing Group US</publisher-name>
      <publisher-loc>New York</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8648559</article-id>
    <article-id pub-id-type="pmid">34845388</article-id>
    <article-id pub-id-type="publisher-id">1326</article-id>
    <article-id pub-id-type="doi">10.1038/s41592-021-01326-w</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Brief Communication</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>OME-NGFF: a next-generation file format for expanding bioimaging data-access strategies</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-4028-811X</contrib-id>
        <name>
          <surname>Moore</surname>
          <given-names>Josh</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Allan</surname>
          <given-names>Chris</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-8783-1429</contrib-id>
        <name>
          <surname>Besson</surname>
          <given-names>Sébastien</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Burel</surname>
          <given-names>Jean-Marie</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-2526-3512</contrib-id>
        <name>
          <surname>Diel</surname>
          <given-names>Erin</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Gault</surname>
          <given-names>David</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Kozlowski</surname>
          <given-names>Kevin</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Lindner</surname>
          <given-names>Dominik</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Linkert</surname>
          <given-names>Melissa</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-7694-5164</contrib-id>
        <name>
          <surname>Manz</surname>
          <given-names>Trevor</given-names>
        </name>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-7264-8338</contrib-id>
        <name>
          <surname>Moore</surname>
          <given-names>Will</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-6562-7187</contrib-id>
        <name>
          <surname>Pape</surname>
          <given-names>Constantin</given-names>
        </name>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Tischer</surname>
          <given-names>Christian</given-names>
        </name>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-2198-1958</contrib-id>
        <name>
          <surname>Swedlow</surname>
          <given-names>Jason R.</given-names>
        </name>
        <address>
          <email>j.r.swedlow@dundee.ac.uk</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.8241.f</institution-id><institution-id institution-id-type="ISNI">0000 0004 0397 2876</institution-id><institution>University of Dundee, </institution></institution-wrap>Dundee, UK </aff>
      <aff id="Aff2"><label>2</label>Glencoe Software, Inc., Seattle, WA USA </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="GRID">grid.38142.3c</institution-id><institution-id institution-id-type="ISNI">000000041936754X</institution-id><institution>Harvard Medical School, </institution></institution-wrap>Boston, MA USA </aff>
      <aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="GRID">grid.4709.a</institution-id><institution-id institution-id-type="ISNI">0000 0004 0495 846X</institution-id><institution>European Molecular Biology Laboratory (EMBL), </institution></institution-wrap>Heidelberg, Germany </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>29</day>
      <month>11</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>29</day>
      <month>11</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="ppub">
      <year>2021</year>
    </pub-date>
    <volume>18</volume>
    <issue>12</issue>
    <fpage>1496</fpage>
    <lpage>1498</lpage>
    <history>
      <date date-type="received">
        <day>14</day>
        <month>4</month>
        <year>2021</year>
      </date>
      <date date-type="accepted">
        <day>19</day>
        <month>10</month>
        <year>2021</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2021</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The images or other third party material in this article are included in the article’s Creative Commons license, unless indicated otherwise in a credit line to the material. If material is not included in the article’s Creative Commons license and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this license, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1">The rapid pace of innovation in biological imaging and the diversity of its applications have prevented the establishment of a community-agreed standardized data format. We propose that complementing established open formats such as OME-TIFF and HDF5 with a next-generation file format such as Zarr will satisfy the majority of use cases in bioimaging. Critically, a common metadata format used in all these vessels can deliver truly findable, accessible, interoperable and reusable bioimaging data.</p>
    </abstract>
    <abstract id="Abs2" abstract-type="web-summary">
      <p id="Par2">OME’s next-generation file format (OME-NGFF) provides a cloud-native complement to OME-TIFF and HDF5 for storing and accessing bioimaging data at scale and works toward the goal of findable, accessible, interoperable and reusable bioimaging data.</p>
    </abstract>
    <kwd-group kwd-group-type="npg-subject">
      <title>Subject terms</title>
      <kwd>Data publication and archiving</kwd>
      <kwd>Computational platforms and environments</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">https://doi.org/10.13039/100004440</institution-id>
            <institution>Wellcome Trust (Wellcome)</institution>
          </institution-wrap>
        </funding-source>
        <award-id>212962/Z/18/Z</award-id>
        <principal-award-recipient>
          <name>
            <surname>Swedlow</surname>
            <given-names>Jason R.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>InnovateUK 104689 InnovateUK 104690 Chan Zuckerberg Initiative 2019-207272</institution>
        </funding-source>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s), under exclusive licence to Springer Nature America, Inc. 2021</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Main</title>
    <p id="Par3">Biological imaging is one of the most innovative fields in the modern biological sciences. New imaging modalities, probes and analysis tools appear every few months and often prove decisive for enabling new directions in scientific discovery. One feature of this dynamic field is the need to capture new types of data and data structures. While there is a strong drive to make scientific data findable, accessible, interoperable and reusable (FAIR<sup><xref ref-type="bibr" rid="CR1">1</xref></sup>), the rapid rate of innovation in imaging has resulted in the creation of hundreds of proprietary file formats (PFFs) and has prevented the unification and adoption of standardized data formats. Despite this, opportunities for sharing and integrating bioimaging data and, in particular, linking these data to other ‘omics’ datasets have never been greater. Therefore, to every extent possible, increasing ‘FAIRness’ of bioimaging data is critical for maximizing scientific value, as well as for promoting openness and integrity<sup><xref ref-type="bibr" rid="CR2">2</xref></sup>.</p>
    <p id="Par4">When working with a large number of PFFs, interoperability and accessibility are achieved using translation and conversion provided by open-source, community-maintained libraries that produce an open, common data representation. On-the-fly translation produces a transient representation of bioimage metadata and binary data in an open format but must be repeated on each use. In contrast, conversion produces a permanent copy of the data, again in an open format, bypassing bottlenecks in repeated data access. As workflows and data resources emerge that handle terabytes (TB) to petabytes (PB) of data, the costs of on-the-fly translation have become bottlenecks to scientific analysis and the sharing of results. Open formats like OME-TIFF<sup><xref ref-type="bibr" rid="CR3">3</xref></sup> and HDF5 (ref. <sup><xref ref-type="bibr" rid="CR4">4</xref></sup>) are often used for permanent conversion, but both have limitations that make them ill-suited for use cases that depend on very high and frequent levels of access, such as training of artificial intelligence models and publication of reference bioimage datasets in cloud-based resources. For these situations, the community is missing a multidimensional, multiresolution binary container that provides parallel read-and-write capability that is natively accessible from the cloud (without server infrastructure) and that has a flexible, comprehensive metadata structure (<xref rid="MOESM1" ref-type="media">Supplementary Note</xref>).</p>
    <p id="Par5">To this end, we have begun building OME’s next-generation file format (OME-NGFF) as a complement to OME-TIFF and HDF5. Together these formats provide a flexible set of choices for bioimaging data storage and access at scale over the next decade and, potentially, a common, FAIR solution for all members of the biological imaging community (academic and industrial researchers, imaging scientists, and academic and commercial technology developers).</p>
  </sec>
  <sec id="Sec2">
    <title>Next-generation file formats</title>
    <p id="Par6">We use the term next-generation file formats (NGFFs) to denote file formats that can be hosted natively in an object (or cloud) storage for direct access by a large number of users. Our current work, which we refer to as OME-NGFF, is built upon the Zarr format<sup><xref ref-type="bibr" rid="CR5">5</xref></sup> but heavily informed and connected to both TIFF and HDF5. We have compared the characteristics of these three open formats in Supplementary Table <xref rid="MOESM1" ref-type="media">1</xref>.</p>
    <p id="Par7">To date, the development of OME-NGFF has focused on pixel data and metadata specifications for multidimensional, multiscale images, high-content screening datasets and derived labeled images. These specifications include support for ‘chunking’ or storage of parts of the binary pixel data in smaller files that support rapid access to the data from orthogonal views or different resolution levels (also known as pyramidal data). Labeled images, such as segmentation or classification masks can now remain in a common data structure with the original pixel data and metadata, providing a single mechanism for tracking the provenance of original and derived data allowing programmatic rather than manual management.</p>
    <p id="Par8">We have also built multiple implementations of these specifications, demonstrating the usability and performance of these formats. bioformats2raw can be used for writing OME-NGFF from standalone Java applications and omero-cli-zarr is available for exporting from OMERO<sup><xref ref-type="bibr" rid="CR6">6</xref></sup>. Reading is implemented in ome-zarr-py, which has been integrated into the napari viewer<sup><xref ref-type="bibr" rid="CR7">7</xref></sup>, in Fiji via the MoBIE plugin<sup><xref ref-type="bibr" rid="CR8">8</xref></sup> and finally via Viv-based vizarr for access in the browser<sup><xref ref-type="bibr" rid="CR9">9</xref></sup>. Permissively licensed example datasets from the Image Data Resource (IDR)<sup><xref ref-type="bibr" rid="CR10">10</xref></sup> have been converted into Zarr and stored in an S3-object storage bucket for public consumption (Extended Data Fig. <xref rid="Fig2" ref-type="fig">1</xref>). Though OME-NGFF is still in development, each of these implementations is an example of how data access and application is simplified by having a universal data-storage pattern. Current and future specifications are published under <ext-link ext-link-type="uri" xlink:href="https://ngff.openmicroscopy.org/latest/">https://ngff.openmicroscopy.org/latest/</ext-link>.</p>
  </sec>
  <sec id="Sec3">
    <title>Bioimage latency benchmark</title>
    <p id="Par9">To demonstrate how NGFFs complement available, open formats, we have built and published a bioimage latency benchmark that compares random, serial-access speeds to uncompressed TIFF, HDF5 and Zarr files. These measurements provide an upper bound on the overhead that a user would experience accessing the formats using common libraries, tifffile, h5py and Zarr-Python, respectively. Though future extensions to the benchmark are intended, we have focused on a single, serverless Python environment because one library (fsspec) can be used to access all three data formats across multiple storage mechanisms without the need for any additional infrastructure.</p>
    <p id="Par10">The benchmark includes instructions for running on Docker or AWS EC2 and contains all necessary code to regenerate representative samples for two established imaging modalities: large multi-channel two-dimensional (2D) images such as the ones produced by cyclic immunofluorescence (CycIF)<sup><xref ref-type="bibr" rid="CR11">11</xref></sup> and time-lapse isotropic volumes typically generated by light-sheet microscopy (LSM)<sup><xref ref-type="bibr" rid="CR12">12</xref></sup>. Each synthetic HDF5, TIFF and Zarr dataset was generated by first invoking the ImarisWriter, then converting the HDF5-based Imaris files into Zarr with bioformats2raw and finally converting the Zarr to TIFF with raw2ometiff. All three datasets along with a 1byte dummy file for measuring overhead were placed in three types of storage: local disk, a remote server and object storage. We measured the reading time of individual chunks for all four file types across the three storage systems. Figure <xref rid="Fig1" ref-type="fig">1</xref> shows that as the latency of access grows, access times for monolithic formats such as TIFF and HDF5 increase because libraries must seek the appropriate data chunk, whereas NGFF formats such as Zarr provide direct access to individual chunks. In the three-dimensional (3D) case, the TIFF data were too large to fit into local memory and the benchmark errored.<fig id="Fig1"><label>Fig. 1</label><caption><title>Chunk retrieval time is less sensitive to data location with next-generation file formats.</title><p><bold>a</bold>,<bold>b</bold>, Random sampling of 100 chunks from synthetically generated, five-dimensional images measures access times for three different formats on the same file system (green), over HTTP using the nginx web server (orange) and using Amazon’s proprietary S3 object storage protocol (blue) under two scenarios: a whole-slide CycIF imaging dataset with many large planes of data (<italic>x</italic> = 64,000, <italic>y</italic> = 64,000, <italic>c</italic> = 8) and chunks of 256 × 256 pixels (128 KB) (<bold>a</bold>); and a time-lapse LSM dataset with isotropic dimensions (<italic>x</italic> = 1,024, <italic>y</italic> = 1,024, <italic>z</italic> = 1,024, <italic>t</italic> = 100) and chunks of 32 × 32 × 32 pixels (64 KB) (<bold>b</bold>) (<xref rid="Sec5" ref-type="sec">Methods</xref>).</p></caption><graphic xlink:href="41592_2021_1326_Fig1_HTML" id="d32e470"/></fig></p>
    <p id="Par11">On local storage, access speeds for NGFF files were similar to HDF5 and both substantially outperformed TIFF. This matches previous results showing that a number of factors must be taken into account to determine the relative performance of HDF5 and Zarr<sup><xref ref-type="bibr" rid="CR13">13</xref></sup>. Together these results partially explain HDF5’s popularity for desktop analysis and visualization of LSM datasets.</p>
    <p id="Par12">However, on cloud storage, access speeds for NGFF files are at least an order of magnitude faster than HDF5. Parallel reads<sup><xref ref-type="bibr" rid="CR14">14</xref></sup>, supporting streaming of image data files from remote http-based or cloud-based servers give performance similar to local disk access. Data streaming obviates the need for wholesale data download and is especially important for providing performant access to multi-TB datasets.</p>
    <p id="Par13">We note that our benchmark measures direct access to underlying storage. Additional applications, such as HSDS for HDF5 or OMERO for TIFF, may improve the performance of specific use cases, but add complexity to any deployment and make direct comparisons between the different data-access regimes in Fig. <xref rid="Fig1" ref-type="fig">1</xref> difficult. Additionally, a key parameter in overall access times is the size of individual chunks. As chunk sizes decrease, the number of individual chunk files increases rapidly (Extended Data Fig. <xref rid="Fig3" ref-type="fig">2</xref>). In this benchmark, we have chosen a compromise between chunk size and number of individual files. This illustrates a primary downside of NGFF formats; as the number of files increases, the time required for copying data between locations increases. Users will need to understand and balance these trade-offs when choosing between open, bioimaging file formats.</p>
  </sec>
  <sec id="Sec4">
    <title>Outlook: community adoption</title>
    <p id="Par14">We assert that together low-latency, cloud-capable NGFF, TIFF and HDF5 can provide a balanced set of options that the community can converge upon and slow the development of ever more file formats. To this end, OME is committed to building an interoperable metadata representation across all three file formats to ensure ease of adoption and data exchange (<xref rid="MOESM1" ref-type="media">Supplementary Note</xref>).</p>
    <p id="Par15">When data are frequently accessed, for example, as a public resource or a training dataset, upfront conversion will lead to overall time savings. In situations where object storage is mandated, as in large-scale public repositories, we encourage the use of OME-NGFF today. Alternatively, users needing to transfer their images may choose to store their data in a large single file such as HDF5. OME-TIFF remains a safe option for those who rely on proprietary software for visualization and analysis, especially in digital pathology and other whole-slide image applications, as many have been extended to both read and write this open standard. Each choice comes with benefits and costs and individual scientists, institutions, global collaborations and public data resources need the flexibility to decide which approach is suitable. We encourage the community to choose from the most appropriate of the formats described above, secure in the knowledge that conversion is possible if it becomes necessary.</p>
    <p id="Par16">We foresee this being a critical strategy where data generated in advanced bioimaging applications is converted into an optimized format for downstream processing, analysis, visualization and sharing. All subsequent data access occurs via open data formats without the need for repeated, on-the-fly translation. We have begun implementing this workflow in the IDR (Extended Data Fig. <xref rid="Fig2" ref-type="fig">1</xref>), alleviating the need for time-consuming downloads and cross-referencing metadata and resulting in substantially more accessible and interoperable data. We look forward to working with other resources to further develop this policy. Further, as adoption of public image data resources increases, commercial vendors will hopefully engage with these efforts to support their customers, who are increasingly required to publish datasets as supplementary material. Moreover, some commercial imaging companies are themselves building cloud-based data handling and analysis solutions (for example, <ext-link ext-link-type="uri" xlink:href="https://www.apeer.com">https://www.apeer.com</ext-link>), thus broadening the community of users who need cloud-competent file formats.</p>
    <p id="Par17">Ultimately, we hope to see digital imaging systems producing open, transparent (in other words FAIR), data without the need for further conversion. Until that time, we are committed to providing the data conversion needs of the community. Following the same pattern established by bioformats2raw and raw2ometiff, we propose to meet this challenge via a set of migration tools allowing efficient data transformations between all data formats contained in this suite of interoperable formats. Additionally, as the specification evolves based on community feedback, the same migration tools will allow upgrading the scientific data generated by the bioimaging community to prevent the need for long-term maintenance of older data. Upcoming specifications include geometric descriptions of regions of interest, meshes and transformations for correlative microscopy.</p>
    <p id="Par18">To provide the best chance of wide adoption and engagement, we are developing the formats in the open, with frequent public announcements of progress and releases of reference software and examples (<ext-link ext-link-type="uri" xlink:href="https://forum.image.sc/tag/ome-ngff">https://forum.image.sc/tag/ome-ngff</ext-link>) and regular community meetings where we present work, source feedback and encourage community members, including vendors, to participate in the specification and implementation. The community process is being developed and we welcome contributions from all interested parties on <ext-link ext-link-type="uri" xlink:href="https://github.com/ome/ngff">https://github.com/ome/ngff</ext-link>.</p>
  </sec>
  <sec id="Sec5">
    <title>Methods</title>
    <sec id="Sec6">
      <title>Bioimage latency benchmark: synthetic data generation</title>
      <sec id="Sec7">
        <title>Imaging modality and dataset sizes</title>
        <p id="Par19">Synthetic datasets were generated for two established imaging modalities: a large multi-channel two-dimensional image typical of CycIF<sup><xref ref-type="bibr" rid="CR11">11</xref></sup> of <italic>xyzct</italic> dimensions 64,000 × 64,000 × 1 × 8 × 1 and a time-lapse isotropic volume typical of LSM<sup><xref ref-type="bibr" rid="CR12">12</xref></sup> of <italic>xyzct</italic> dimensions 1,024 × 1,024 × 1,024 × 1 × 100.</p>
        <p id="Par20">For each modality, the chunk size of the benchmark dataset was chosen as a compromise between the size of individual chunks and the total number of chunks in the Zarr dataset. To make this decision, the individual chunk size was computed against the total number of chunks for typical sizes ranging from 16 up to 1,024 (chunks.py<sup><xref ref-type="bibr" rid="CR15">15</xref></sup> and Extended Data Fig. <xref rid="Fig3" ref-type="fig">2</xref>). Based on this, we chose a 2D chunk size of 256 × 256 for the CycIF-like dataset and a 3D chunk size of 32 × 32 × 32 for the LSM-like dataset. Note that owing to the planar limitation of TIFF, the LSM dataset was stored as 2D TIFF tiles of size 32 × 32 but the benchmark loaded 32 tiles to measure the total access time. All data was stored uncompressed to keep chunk sizes consistent for the random generated data. Note that with the default aws s3 cp command, data upload decreased from over 100 MiB s<sup>−1</sup> for the single HDF5 file to under 20 MiB s<sup>−1</sup> for the Zarr dataset.</p>
      </sec>
      <sec id="Sec8">
        <title>Dataset generation</title>
        <p id="Par21">The HDF5 version of each synthetic dataset was first generated by using the ImarisWriter library<sup><xref ref-type="bibr" rid="CR16">16</xref></sup> (v.2021-04-07) with a version of the ImarisWriterTest example<sup><xref ref-type="bibr" rid="CR16">16</xref>,<xref ref-type="bibr" rid="CR17">17</xref></sup> modified to allow setting the desired chunk size and generate gradient images rather than random data. This HDF5-based Imaris file was converted into Zarr using a modified version of bioformats2raw v.0.2.6 with support for chunks using a / dimension separator<sup><xref ref-type="bibr" rid="CR18">18</xref></sup>. Finally, the Zarr was converted into TIFF with a modified version of raw2ometiff v.0.2.6, allowing it to consume Zarr filesets with a / dimension separator<sup><xref ref-type="bibr" rid="CR19">19</xref></sup>. Both modifications have been released since in bioformats2raw v.0.3.0 and raw2ometiff v.0.3.0.</p>
        <p id="Par22">For the CycIF-like dataset, this conversion generated a single 86 GB TIFF file, a single 86 GB HDF5 file and a Zarr dataset composed of 700,000 files of 86 GB in total. For the LSM-like dataset, the conversion generated a single 300 GB TIFF file, a single 229 GB HDF5 file and a Zarr dataset of 4.3 million files of 264 GB in total.</p>
      </sec>
    </sec>
    <sec id="Sec9">
      <title>Bioimage latency benchmark: measurements and results</title>
      <sec id="Sec10">
        <title>Measurements</title>
        <p id="Par23">All three datasets along with a 1 byte dummy file for measuring overhead were placed in three types of storage: local disk, a remote server and object storage. We measured the reading time of individual chunks for all four file types across the three storage systems.</p>
        <p id="Par24">A random sequence of 100 chunk locations was chosen for the benchmark. All 100 chunks were loaded from each file in the same order. The time taken to retrieve the chunk, independent of the time taken to open a file or prepare the remote connection, was recorded.</p>
      </sec>
      <sec id="Sec11">
        <title>Raincloud plots</title>
        <p id="Par25">Raincloud plots<sup><xref ref-type="bibr" rid="CR20">20</xref></sup> combine three representations (split-half violin plots, box plots, raw data points) so that the true distribution and the statistical parameters can be compared. Split-half violin plots show a smoothed version of a histogram with a kernel density estimate. This type of plot is useful to determine, at a glance, if the mean is lower or higher than the median depending on the skewness of the curve. Box plots show the median and the boundaries of quartiles on either side of the median of the distribution to determine statistical differences at a glance. Below each box plot, the raw data points are additionally plotted with slight vertical jittering to avoid overlaps.</p>
        <p id="Par26">All code for reproducing the plots and the runs both locally with Docker or Amazon EC2 instances are available under a BSD-2 license on Zenodo<sup><xref ref-type="bibr" rid="CR15">15</xref></sup>.</p>
      </sec>
    </sec>
    <sec id="Sec12">
      <title>Reporting Summary</title>
      <p id="Par27">Further information on research design is available in the <xref rid="MOESM2" ref-type="media">Nature Research Reporting Summary</xref> linked to this article.</p>
    </sec>
  </sec>
  <sec id="Sec13" sec-type="materials|methods">
    <title>Online content</title>
    <p id="Par28">Any methods, additional references, Nature Research reporting summaries, source data, extended data, supplementary information, acknowledgements, peer review information; details of author contributions and competing interests; and statements of data and code availability are available at 10.1038/s41592-021-01326-w.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary information</title>
    <p>
      <supplementary-material content-type="local-data" id="MOESM1">
        <media xlink:href="41592_2021_1326_MOESM1_ESM.pdf">
          <label>Supplementary Information</label>
          <caption>
            <p>Supplementary Table 1 and Supplementary Note.</p>
          </caption>
        </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM2">
        <media xlink:href="41592_2021_1326_MOESM2_ESM.pdf">
          <caption>
            <p>Reporting Summary</p>
          </caption>
        </media>
      </supplementary-material>
    </p>
  </sec>
</body>
<back>
  <app-group>
    <app id="App1">
      <sec id="Sec14">
        <title>Extended data</title>
        <p id="Par32">
          <fig id="Fig2">
            <label>Extended Data Fig. 1</label>
            <caption>
              <title>Maximizing re-use by allowing popular tools to access bioimaging data in the cloud.</title>
              <p>An example of using NGFFs for promoting the distribution of public image datasets. Selection of current tools streaming different portions of the same SARS-CoV-2 virus image at various resolutions directly from S3 storage at the European Bioinformatics Institute (EBI). Original data from Lamers et al. is available in IDR while the converted data is available on Zenodo.21–23.</p>
            </caption>
            <graphic position="anchor" xlink:href="41592_2021_1326_Fig2_ESM" id="d32e740"/>
          </fig>
        </p>
        <p id="Par33">
          <fig id="Fig3">
            <label>Extended Data Fig. 2</label>
            <caption>
              <title>Effect of Chunk Size on Chunk Number.</title>
              <p>For each modality, the chunk size of the benchmark dataset was chosen as a compromise between the size of individual chunks and the total number of chunks in the Zarr dataset. The plots above show typical power of 2 chunk sizes: between 32 and 1024 for the 2D data and between 16 and 128 for the 3D data. We chose a 2D chunk size of 256×256 for the CyIF-like dataset and a 3D chunk size of 32x32x32 for the LSM-like dataset. Note that due to the planar limitation of TIFF, the LSM dataset was stored as 2D TIFF tiles of size 32×32 but the benchmark looped over 32 tiles to measure the access time of the same chunk size.</p>
            </caption>
            <graphic position="anchor" xlink:href="41592_2021_1326_Fig3_ESM" id="d32e754"/>
          </fig>
        </p>
        <p id="Par34">
          <fig id="Fig4">
            <label>Extended Data Fig. 3</label>
            <caption>
              <title>Conversion tools provide an alternative to continual, on-the-fly translation of PFFs.</title>
              <p>Figure shows workflows for file format access. (<bold>a</bold>) The classical approach to access images produced by an acquisition system is to use a library like Bio-Formats to translate the proprietary file format (PFF) and produce an in-memory copy of the imaging data on-the-fly. This translation needs to be repeated on every use. (<bold>b</bold>) With the existence of open, community-supported formats, converting PFFs becomes the most cost-efficient method for long-term storage and sharing of microscopy data. bioformats2raw and raw2ometiff (<xref rid="MOESM1" ref-type="media">Supplementary Note</xref>) parallelize the creation of an open format, OME-TIFF, by using an intermediate NGFF format consisting of many, individual files each with one chunk of the original image data.</p>
            </caption>
            <graphic position="anchor" xlink:href="41592_2021_1326_Fig4_ESM" id="d32e777"/>
          </fig>
        </p>
        <p id="Par35">
          <fig id="Fig5">
            <label>Extended Data Fig. 4</label>
            <caption>
              <title>Unification of metadata specifications will allow interoperability between TIFF, HDF5, and Zarr.</title>
              <p>Each proposed container (TIFF, Zarr, HDF5) can be used interchangeably to store pixel data, but trade-offs described in this manuscript can be used to determine what is the best target. TIFF is ideal for interoperability in digital pathology and other 2-dimensional domains since the format is widely accessible by established open source and proprietary software. In higher-dimensional domains, HDF5 and Zarr are better suited. HDF5 will likely be preferred for local access. If data is intended for sharing in the cloud, Zarr will likely be preferred. High throughput image analysis will benefit from the lower-latency access to data in HDF5 and Zarr. If original image data is paired with derived representations like pixel or object classification, a shared structure in HDF5 or Zarr is likely the best choice.</p>
            </caption>
            <graphic position="anchor" xlink:href="41592_2021_1326_Fig5_ESM" id="d32e791"/>
          </fig>
        </p>
      </sec>
    </app>
  </app-group>
  <fn-group>
    <fn>
      <p><bold>Peer review information</bold><italic>Nature Methods</italic> thanks Albert Cardona and the other, anonymous, reviewer(s) for their contribution to the peer review of this work. Rita Strack was the primary editor on this article and managed its editorial process and peer review in collaboration with the rest of the editorial team</p>
    </fn>
    <fn>
      <p><bold>Publisher’s note</bold> Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <sec>
    <sec id="FPar1">
      <title>Extended data</title>
      <p id="Par29">is available for this paper at 10.1038/s41592-021-01326-w.</p>
    </sec>
    <sec id="FPar2" sec-type="supplementary-material">
      <title>Supplementary information</title>
      <p id="Par30">The online version contains supplementary material available at 10.1038/s41592-021-01326-w.</p>
    </sec>
  </sec>
  <ack>
    <title>Acknowledgements</title>
    <p>Work on the bioformats2raw and raw2ometiff converters was funded by awards from InnovateUK to Glencoe Software (PathLAKE, ref. 104689 and iCAIRD ref. 104690). Work on OME-NGFF by J.M., J.-M.B., S.B., D.G., D.L. and W.M. was funded by grant no. 2019-207272 from the Chan Zuckerberg Initiative DAF, an advised fund of Silicon Valley Community Foundation, the Wellcome Trust (ref. 212962/Z/18/Z) and BBSRC (ref. BB/R015384/1). Work by C.T. has been made possible in part by grant number 2020-225265 from the Chan Zuckerberg Initiative DAF, an advised fund of Silicon Valley Community Foundation. C.P. has received funding from the European Union’s Horizon 2020 research and innovation programme under grant agreement no. 824087. T.M. has received funding from the National Science Foundation Graduate Research Fellowship under grant no. DGE1745303. The authors thank the originators of the Zarr and N5 formats, A. Miles and S. Saalfeld and the vibrant communities they have built for working together to unify their formats. The development of OME-NGFF has been and will continue to be a community endeavor. Everyone who has participated in the format specification and/or an implementation is invited to request software authorship (<ext-link ext-link-type="uri" xlink:href="http://credit.niso.org/contributor-roles/software/">http://credit.niso.org/contributor-roles/software/</ext-link>) by contacting the corresponding author.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author contributions</title>
    <p>J.M., C.A., J.-M.B. and S.B. conceived the project; J.M. and S.B. wrote the specification; C.A., M.L. and E.D. wrote and tested the conversion software; D.G. wrote the data generation code; K.K. wrote the AWS-deployment scripts; J.M. performed the benchmark and created the figures; T.M, W.M., J.-M.B., C.P. and C.T. wrote and validated software tools to visualize data; D.L., S.B. and W.M. tested the formats for data publishing; J.-M.B. validated the formats using workflows with public data; J.R.S. acquired the funding; and J.M., S.B. and J.R.S. wrote the paper with input from all the authors.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Data availability</title>
    <p>The synthetic data generated for the benchmark are 1.05 TB. All code necessary to regenerate the data, including at different sizes, is available on Zenodo under a BSD-2 license<sup><xref ref-type="bibr" rid="CR15">15</xref></sup>. The SARS-CoV-2 EM dataset from Extended Data Fig. <xref rid="Fig2" ref-type="fig">1</xref>, originally from Lamers et al.<sup><xref ref-type="bibr" rid="CR21">21</xref></sup> and published in IDR<sup><xref ref-type="bibr" rid="CR22">22</xref></sup>, was converted into OME-NGFF and is available at Zenodo<sup><xref ref-type="bibr" rid="CR23">23</xref></sup> under a CC-BY 4.0 license.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Code availability</title>
    <p>Data generation and analysis code for file format benchmarking is available on Zenodo under a BSD-2 license<sup><xref ref-type="bibr" rid="CR15">15</xref></sup>.</p>
  </notes>
  <notes id="FPar3" notes-type="COI-statement">
    <title>Competing interests</title>
    <p id="Par31">C.A., E.D., K.K., M.L. and J.R.S. are affiliated with Glencoe Software, a commercial company that builds, delivers, supports and integrates image data management systems across academic, biotech and pharmaceutical industries. The remaining authors declare no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wilkinson</surname>
            <given-names>MD</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The FAIR guiding principles for scientific data management and stewardship</article-title>
        <source>Sci. Data</source>
        <year>2016</year>
        <volume>3</volume>
        <fpage>160018</fpage>
        <pub-id pub-id-type="doi">10.1038/sdata.2016.18</pub-id>
        <pub-id pub-id-type="pmid">26978244</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ellenberg</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A call for public archives for biological image data</article-title>
        <source>Nat. Methods</source>
        <year>2018</year>
        <volume>15</volume>
        <fpage>849</fpage>
        <lpage>854</lpage>
        <pub-id pub-id-type="doi">10.1038/s41592-018-0195-8</pub-id>
        <pub-id pub-id-type="pmid">30377375</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Linkert</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Metadata matters: access to image data in the real world</article-title>
        <source>J. Cell Biol.</source>
        <year>2010</year>
        <volume>189</volume>
        <fpage>777</fpage>
        <lpage>782</lpage>
        <pub-id pub-id-type="doi">10.1083/jcb.201004104</pub-id>
        <pub-id pub-id-type="pmid">20513764</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <mixed-citation publication-type="other"><italic>The HDF5 Library and File Format</italic> (The HDF Group, accessed 18 October 2021); <ext-link ext-link-type="uri" xlink:href="https://www.hdfgroup.org/solutions/hdf5/">https://www.hdfgroup.org/solutions/hdf5/</ext-link></mixed-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <mixed-citation publication-type="other">Miles, A. et al. zarr-developers/zarr-python: v.2.5.0 10.5281/zenodo.4069231 (2020).</mixed-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Allan</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>OMERO: flexible, model-driven data management for experimental biology</article-title>
        <source>Nat. Methods</source>
        <year>2012</year>
        <volume>9</volume>
        <fpage>245</fpage>
        <lpage>253</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.1896</pub-id>
        <pub-id pub-id-type="pmid">22373911</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <mixed-citation publication-type="other">Sofroniew, N. et al. napari/napari: 0.4.7rc1 10.5281/zenodo.3555620 (2021).</mixed-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <mixed-citation publication-type="other">Vergara, H. M. et al. Whole-body integration of gene expression and single-cell morphology. <italic>Cell</italic>10.1016/j.cell.2021.07.017 (2021).</mixed-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <mixed-citation publication-type="other">Manz, T. et al. Viv: multiscale visualization of high-resolution multiplexed bioimaging data on the web. <italic>OSF Preprints</italic>10.31219/osf.io/wd2gu (2020).</mixed-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Williams</surname>
            <given-names>E</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The Image Data Resource: a bioimage data integration and publication platform</article-title>
        <source>Nat. Methods</source>
        <year>2017</year>
        <volume>14</volume>
        <fpage>775</fpage>
        <lpage>781</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.4326</pub-id>
        <pub-id pub-id-type="pmid">28775673</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lin</surname>
            <given-names>J-R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Highly multiplexed immunofluorescence imaging of human tissues and tumors using t-CyCIF and conventional optical microscopes</article-title>
        <source>eLife</source>
        <year>2018</year>
        <volume>7</volume>
        <fpage>e31657</fpage>
        <pub-id pub-id-type="doi">10.7554/eLife.31657</pub-id>
        <pub-id pub-id-type="pmid">29993362</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wan</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>McDole</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Keller</surname>
            <given-names>PJ</given-names>
          </name>
        </person-group>
        <article-title>Light-sheet microscopy and its potential for understanding developmental processes</article-title>
        <source>Annu. Rev. Cell Dev. Biol.</source>
        <year>2019</year>
        <volume>35</volume>
        <fpage>655</fpage>
        <lpage>681</lpage>
        <pub-id pub-id-type="doi">10.1146/annurev-cellbio-100818-125311</pub-id>
        <pub-id pub-id-type="pmid">31299171</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <mixed-citation publication-type="other">Kang, D., Rübel, O., Byna, S. &amp; Blanas, S. Predicting and comparing the performance of array management libraries. In <italic>2020 IEEE International Parallel and Distributed Processing Symposium</italic>10.1109/IPDPS47924.2020.00097 (2020).</mixed-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <mixed-citation publication-type="other">Abernathey, R. et al. Cloud-native repositories for big scientific data. <italic>Comput. Sci. Eng.</italic>10.1109/MCSE.2021.3059437 (2021).</mixed-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <mixed-citation publication-type="other">Moore, J. et al. ome/bioimage-latency-benchmark: 2021-10-05. 10.5281/zenodo.4668606 (2021).</mixed-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <mixed-citation publication-type="other">Beati, I., Andreica, E. &amp; Majer, P. ImarisWriter: open source software for storage of large images in blockwise multi-resolution format. Preprint at <italic>arXiv</italic><ext-link ext-link-type="uri" xlink:href="https://arxiv.org/abs/2008.10311">https://arxiv.org/abs/2008.10311</ext-link> (2020).</mixed-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <mixed-citation publication-type="other">Gault, D. ome/ImarisWriterTest. 10.5281/zenodo.5547849 (2021).</mixed-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <mixed-citation publication-type="other">Allan, C. et al. ome/bioformats2raw. 10.5281/zenodo.5548102 (2021).</mixed-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <mixed-citation publication-type="other">Allan, C., Linkert, M. &amp; Moore, J. ome/raw2ometiff. 10.5281/zenodo.5548109 (2021).</mixed-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Allen</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Raincloud plots: a multi-platform tool for robust data visualization</article-title>
        <source>Wellcome Open Res</source>
        <year>2021</year>
        <volume>4</volume>
        <fpage>63</fpage>
        <pub-id pub-id-type="doi">10.12688/wellcomeopenres.15191.2</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lamers</surname>
            <given-names>MM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>SARS-CoV-2 productively infects human gut enterocytes</article-title>
        <source>Science</source>
        <year>2020</year>
        <volume>369</volume>
        <fpage>50</fpage>
        <lpage>54</lpage>
        <pub-id pub-id-type="doi">10.1126/science.abc1669</pub-id>
        <pub-id pub-id-type="pmid">32358202</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <mixed-citation publication-type="other">Lamers, M. M. et al. SARS-CoV-2 productively infects human gut enterocytes. <italic>Image Data Resource</italic>10.17867/10000135 (2020).</mixed-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <mixed-citation publication-type="other">Moore, J. &amp; Besson, S. OME-NGFF: EM image of SARS-CoV-2. 10.5281/zenodo.4668606 (2020).</mixed-citation>
    </ref>
  </ref-list>
</back>
