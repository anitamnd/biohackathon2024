<?properties open_access?>
<?subarticle pcbi.1007287.r001?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 39.96?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS Comput. Biol</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-id journal-id-type="pmc">ploscomp</journal-id>
    <journal-title-group>
      <journal-title>PLoS Computational Biology</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1553-734X</issn>
    <issn pub-type="epub">1553-7358</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, CA USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7055922</article-id>
    <article-id pub-id-type="pmid">32084131</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1007287</article-id>
    <article-id pub-id-type="publisher-id">PCOMPBIOL-D-19-01246</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Cell Biology</subject>
          <subj-group>
            <subject>Chromosome Biology</subject>
            <subj-group>
              <subject>Chromatin</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Epigenetics</subject>
            <subj-group>
              <subject>Chromatin</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Gene Expression</subject>
            <subj-group>
              <subject>Chromatin</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Computational Biology</subject>
          <subj-group>
            <subject>Comparative Genomics</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Genomics</subject>
            <subj-group>
              <subject>Comparative Genomics</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Genomics</subject>
            <subj-group>
              <subject>Animal Genomics</subject>
              <subj-group>
                <subject>Mammalian Genomics</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Computer and Information Sciences</subject>
        <subj-group>
          <subject>Artificial Intelligence</subject>
          <subj-group>
            <subject>Machine Learning</subject>
            <subj-group>
              <subject>Deep Learning</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Genomics</subject>
            <subj-group>
              <subject>Structural Genomics</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Computational Biology</subject>
          <subj-group>
            <subject>Genome Analysis</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Genomics</subject>
            <subj-group>
              <subject>Genome Analysis</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Genetic Loci</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Molecular Biology</subject>
          <subj-group>
            <subject>Molecular Biology Techniques</subject>
            <subj-group>
              <subject>Gene Mapping</subject>
              <subj-group>
                <subject>Chromosome Mapping</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Molecular Biology Techniques</subject>
          <subj-group>
            <subject>Gene Mapping</subject>
            <subj-group>
              <subject>Chromosome Mapping</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>DeepHiC: A generative adversarial network for enhancing Hi-C data resolution</article-title>
      <alt-title alt-title-type="running-head">A computational tool for enhancing Hi-C data resolution</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" equal-contrib="yes">
        <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-1653-4026</contrib-id>
        <name>
          <surname>Hong</surname>
          <given-names>Hao</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Formal analysis</role>
        <role content-type="http://credit.casrai.org/">Methodology</role>
        <role content-type="http://credit.casrai.org/">Software</role>
        <role content-type="http://credit.casrai.org/">Visualization</role>
        <role content-type="http://credit.casrai.org/">Writing – original draft</role>
        <role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-9737-9744</contrib-id>
        <name>
          <surname>Jiang</surname>
          <given-names>Shuai</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Formal analysis</role>
        <role content-type="http://credit.casrai.org/">Methodology</role>
        <role content-type="http://credit.casrai.org/">Software</role>
        <role content-type="http://credit.casrai.org/">Validation</role>
        <role content-type="http://credit.casrai.org/">Visualization</role>
        <role content-type="http://credit.casrai.org/">Writing – original draft</role>
        <role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Li</surname>
          <given-names>Hao</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Formal analysis</role>
        <role content-type="http://credit.casrai.org/">Methodology</role>
        <role content-type="http://credit.casrai.org/">Validation</role>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Du</surname>
          <given-names>Guifang</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Data curation</role>
        <role content-type="http://credit.casrai.org/">Validation</role>
        <role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0001-9182-0247</contrib-id>
        <name>
          <surname>Sun</surname>
          <given-names>Yu</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Validation</role>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0001-6279-9688</contrib-id>
        <name>
          <surname>Tao</surname>
          <given-names>Huan</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Validation</role>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-1859-9683</contrib-id>
        <name>
          <surname>Quan</surname>
          <given-names>Cheng</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Data curation</role>
        <role content-type="http://credit.casrai.org/">Software</role>
        <role content-type="http://credit.casrai.org/">Validation</role>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Zhao</surname>
          <given-names>Chenghui</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Data curation</role>
        <role content-type="http://credit.casrai.org/">Software</role>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Li</surname>
          <given-names>Ruijiang</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Data curation</role>
        <role content-type="http://credit.casrai.org/">Investigation</role>
        <role content-type="http://credit.casrai.org/">Software</role>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Li</surname>
          <given-names>Wanying</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Data curation</role>
        <role content-type="http://credit.casrai.org/">Validation</role>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-8207-2512</contrib-id>
        <name>
          <surname>Yin</surname>
          <given-names>Xiaoyao</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Resources</role>
        <role content-type="http://credit.casrai.org/">Software</role>
        <xref ref-type="aff" rid="aff002">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Huang</surname>
          <given-names>Yangchen</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Resources</role>
        <role content-type="http://credit.casrai.org/">Software</role>
        <xref ref-type="aff" rid="aff002">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Li</surname>
          <given-names>Cheng</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Conceptualization</role>
        <role content-type="http://credit.casrai.org/">Project administration</role>
        <role content-type="http://credit.casrai.org/">Supervision</role>
        <xref ref-type="aff" rid="aff003">
          <sup>3</sup>
        </xref>
        <xref ref-type="aff" rid="aff004">
          <sup>4</sup>
        </xref>
        <xref ref-type="corresp" rid="cor001">*</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-4102-356X</contrib-id>
        <name>
          <surname>Chen</surname>
          <given-names>Hebing</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Conceptualization</role>
        <role content-type="http://credit.casrai.org/">Data curation</role>
        <role content-type="http://credit.casrai.org/">Formal analysis</role>
        <role content-type="http://credit.casrai.org/">Supervision</role>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
        <xref ref-type="corresp" rid="cor001">*</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Bo</surname>
          <given-names>Xiaochen</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Conceptualization</role>
        <role content-type="http://credit.casrai.org/">Funding acquisition</role>
        <role content-type="http://credit.casrai.org/">Supervision</role>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
        <xref ref-type="corresp" rid="cor001">*</xref>
      </contrib>
    </contrib-group>
    <aff id="aff001">
      <label>1</label>
      <addr-line>Beijing Institute of Radiation Medicine, Beijing, China</addr-line>
    </aff>
    <aff id="aff002">
      <label>2</label>
      <addr-line>College of Computer, National University of Defence Technology, Changsha, China</addr-line>
    </aff>
    <aff id="aff003">
      <label>3</label>
      <addr-line>Peking-Tsinghua Center for Life Sciences, Academy for Advanced Interdisciplinary Studies; School of Life Sciences, Peking University, Bejing, China</addr-line>
    </aff>
    <aff id="aff004">
      <label>4</label>
      <addr-line>Center for Statistical Science, Center for Bioinformatics, Peking University, Beijing, China</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Ay</surname>
          <given-names>Ferhat</given-names>
        </name>
        <role>Editor</role>
        <xref ref-type="aff" rid="edit1"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">
      <addr-line>La Jolla Institute for Allergy and Immunology, UNITED STATES</addr-line>
    </aff>
    <author-notes>
      <fn fn-type="COI-statement" id="coi001">
        <p>The authors have declared that no competing interests exist.</p>
      </fn>
      <corresp id="cor001">* E-mail: <email>cheng_li@pku.edu.cn</email> (CL); <email>chb-1012@163.com</email> (HC); <email>boxc@bmi.ac.cn</email> (XB)</corresp>
    </author-notes>
    <pub-date pub-type="epub">
      <day>21</day>
      <month>2</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="collection">
      <month>2</month>
      <year>2020</year>
    </pub-date>
    <volume>16</volume>
    <issue>2</issue>
    <elocation-id>e1007287</elocation-id>
    <history>
      <date date-type="received">
        <day>24</day>
        <month>7</month>
        <year>2019</year>
      </date>
      <date date-type="accepted">
        <day>14</day>
        <month>1</month>
        <year>2020</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2020 Hong et al</copyright-statement>
      <copyright-year>2020</copyright-year>
      <copyright-holder>Hong et al</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:href="pcbi.1007287.pdf"/>
    <abstract>
      <p>Hi-C is commonly used to study three-dimensional genome organization. However, due to the high sequencing cost and technical constraints, the resolution of most Hi-C datasets is coarse, resulting in a loss of information and biological interpretability. Here we develop DeepHiC, a generative adversarial network, to predict high-resolution Hi-C contact maps from low-coverage sequencing data. We demonstrated that DeepHiC is capable of reproducing high-resolution Hi-C data from as few as 1% downsampled reads. Empowered by adversarial training, our method can restore fine-grained details similar to those in high-resolution Hi-C matrices, boosting accuracy in chromatin loops identification and TADs detection, and outperforms the state-of-the-art methods in accuracy of prediction. Finally, application of DeepHiC to Hi-C data on mouse embryonic development can facilitate chromatin loop detection. We develop a web-based tool (DeepHiC, <ext-link ext-link-type="uri" xlink:href="http://sysomics.com/deephic">http://sysomics.com/deephic</ext-link>) that allows researchers to enhance their own Hi-C data with just a few clicks.</p>
    </abstract>
    <abstract abstract-type="summary">
      <title>Author summary</title>
      <p>We developed a novel method, DeepHiC, for enhancing Hi-C data resolution from low-coverage sequencing data using generative adversarial network. DeepHiC is capable of reproducing high-resolution (10-kb) Hi-C data with high quality even using 1/100 downsampled reads. Our method outperforms the previous methods in Hi-C data resolution enhancement, boosting accuracy in chromatin loops identification and TADs detection. Application of DeepHiC on mouse embryonic development data shows that enhancements afforded by DeepHiC facilitates the chromatin loops prediction of these data, yielding significant interactions more enriched in open chromatin regions and gene promoters. We also developed a user-friendly web server (<ext-link ext-link-type="uri" xlink:href="http://sysomics.com/deephic">http://sysomics.com/deephic</ext-link>) that allows researchers to enhance their own low-coverage Hi-C data with just few clicks.</p>
    </abstract>
    <funding-group>
      <award-group id="award001">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100010905</institution-id>
            <institution>Major Research Plan</institution>
          </institution-wrap>
        </funding-source>
        <award-id>U1435222</award-id>
        <principal-award-recipient>
          <name>
            <surname>Bo</surname>
            <given-names>Xiaochen</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award002">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100001809</institution-id>
            <institution>National Natural Science Foundation of China</institution>
          </institution-wrap>
        </funding-source>
        <award-id>31801112</award-id>
        <principal-award-recipient>
          <name>
            <surname>Bo</surname>
            <given-names>Xiaochen</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award003">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100001809</institution-id>
            <institution>National Natural Science Foundation of China</institution>
          </institution-wrap>
        </funding-source>
        <award-id>61873276</award-id>
        <principal-award-recipient>
          <name>
            <surname>Bo</surname>
            <given-names>Xiaochen</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <funding-statement>This work was funded by rewards including the National Natural Science Foundation of China (No. 31801112), the Beijing Nova Program of Science and Technology (NO. Z191100001119064), URL: <ext-link ext-link-type="uri" xlink:href="http://www.nsfc.gov.cn">http://www.nsfc.gov.cn</ext-link> and <ext-link ext-link-type="uri" xlink:href="https://mis.kw.beijing.gov.cn">https://mis.kw.beijing.gov.cn</ext-link>, to HC and the National Natural Science Foundation of China (No. 61873276), URL: <ext-link ext-link-type="uri" xlink:href="http://www.nsfc.gov.cn">http://www.nsfc.gov.cn</ext-link>, to XB. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
    </funding-group>
    <counts>
      <fig-count count="6"/>
      <table-count count="0"/>
      <page-count count="25"/>
    </counts>
    <custom-meta-group>
      <custom-meta>
        <meta-name>PLOS Publication Stage</meta-name>
        <meta-value>vor-update-to-uncorrected-proof</meta-value>
      </custom-meta>
      <custom-meta>
        <meta-name>Publication Update</meta-name>
        <meta-value>2020-03-04</meta-value>
      </custom-meta>
      <custom-meta id="data-availability">
        <meta-name>Data Availability</meta-name>
        <meta-value>All Hi-C data are available from the GEO database (accession numbers GSE63525, GSE82185). ChIA-PET data are available from the ENCODE (accession number ENCSR000CAC). DNase-seq data are available from the ENCODE (accession number ENCSR000EMT). ATAC-seq data are available from the GEO database (accession number GSE66390).</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
  <notes>
    <title>Data Availability</title>
    <p>All Hi-C data are available from the GEO database (accession numbers GSE63525, GSE82185). ChIA-PET data are available from the ENCODE (accession number ENCSR000CAC). DNase-seq data are available from the ENCODE (accession number ENCSR000EMT). ATAC-seq data are available from the GEO database (accession number GSE66390).</p>
  </notes>
</front>
<body>
  <sec sec-type="intro" id="sec001">
    <title>Introduction</title>
    <p>The high-throughput chromosome conformation capture (Hi-C) technique [<xref rid="pcbi.1007287.ref001" ref-type="bibr">1</xref>] is a genome-wide technique used to investigate three-dimensional (3D) chromatin conformation inside the nucleus. It has facilitated the identification and characterization of multiple structural elements, such as the A/B compartments [<xref rid="pcbi.1007287.ref001" ref-type="bibr">1</xref>], topological associating domains (TADs) [<xref rid="pcbi.1007287.ref002" ref-type="bibr">2</xref>, <xref rid="pcbi.1007287.ref003" ref-type="bibr">3</xref>], enhancer-promoter interactions [<xref rid="pcbi.1007287.ref004" ref-type="bibr">4</xref>] and stripes [<xref rid="pcbi.1007287.ref005" ref-type="bibr">5</xref>] over recent decades. In practice, Hi-C data is conventionally stored as a pairwise read count matrix <italic>M</italic><sub><italic>n</italic>×<italic>n</italic></sub>, where <italic>M</italic><sub><italic>ij</italic></sub> is the number of observed interactions (read-pair count) between genomic regions <italic>i</italic> and <italic>j</italic>, and the genome is partitioned into <italic>n</italic> fixed-size bins (e.g., 25 kb). Bin size (i.e., resolution), is a crucial parameter for Hi-C data analysis, as it directly affects the results of downstream analysis, such as predictions of enhancer-promoter interactions [<xref rid="pcbi.1007287.ref006" ref-type="bibr">6</xref>–<xref rid="pcbi.1007287.ref011" ref-type="bibr">11</xref>] or identification of TAD boundaries [<xref rid="pcbi.1007287.ref006" ref-type="bibr">6</xref>, <xref rid="pcbi.1007287.ref012" ref-type="bibr">12</xref>–<xref rid="pcbi.1007287.ref016" ref-type="bibr">16</xref>]. Depending on sequencing depths, the size of commonly used bins ranges from 1 kb to 1 Mb.</p>
    <p>Because of the high cost of sequencing, most available Hi-C datasets have relatively low resolution, such as 25 kb or 40 kb [<xref rid="pcbi.1007287.ref017" ref-type="bibr">17</xref>]. Sequencing high-resolution Hi-C matrices demands sufficient sequencing coverage; otherwise, the contact matrix would be extremely sparse and contain excessive stochastic noise. When sequencing Hi-C data, billions of read-pairs are typically necessary to achieve truly genome-scale coverage at kilobase-pair resolution [<xref rid="pcbi.1007287.ref018" ref-type="bibr">18</xref>], and the cost of Hi-C experiments generally scales quadratically with the desired level of resolution [<xref rid="pcbi.1007287.ref019" ref-type="bibr">19</xref>]. Low-resolution data may be sufficient for detecting large-scale genomic patterns such as A/B compartments, but the decrease in resolution when analyzing Hi-C data may prevent identification of fine-scale genomic elements such as sub-TADs [<xref rid="pcbi.1007287.ref020" ref-type="bibr">20</xref>, <xref rid="pcbi.1007287.ref021" ref-type="bibr">21</xref>] and enhancer-promoter interactions, and even lead to inconsistent results when detecting interactions and TADs in replicated samples [<xref rid="pcbi.1007287.ref022" ref-type="bibr">22</xref>]. Therefore, developing a computational model to impute a higher-resolution Hi-C contact matrix from currently available Hi-C datasets show its potency and usefulness.</p>
    <p>Several pioneering works on solving problems related to low-resolution Hi-C data have recently emerged. Li <italic>et al</italic>. proposed deDoc for detecting megabase-size TAD-like domains in ultra-low resolution Hi-C data [<xref rid="pcbi.1007287.ref023" ref-type="bibr">23</xref>]. Zhang <italic>et al</italic>. proposed a deep learning model called HiCPlus to enhance Hi-C matrices from low-resolution Hi-C data [<xref rid="pcbi.1007287.ref017" ref-type="bibr">17</xref>]. HiCPlus showed that chromatin interactions can be predicted from their neighboring regions, by using the convolutional neural network (CNN) [<xref rid="pcbi.1007287.ref024" ref-type="bibr">24</xref>]. Carron <italic>et al</italic>. proposed a computational method called Boost-HiC for boosting reads counts of long-range contacts [<xref rid="pcbi.1007287.ref025" ref-type="bibr">25</xref>]. And Liu <italic>et al</italic>. proposed HiCNN [<xref rid="pcbi.1007287.ref026" ref-type="bibr">26</xref>] which is a 54-layer CNN and achieved better performance than HiCPlus. While these results were encouraging, three problems still exist in Hi-C data resolution enhancement algorithms. First, Hi-C data contain numerous high-frequency details (<italic>M</italic><sub><italic>ij</italic></sub> and its nearby values are very large, while values in neighboring regions are small) and sharp edges, which are usually considered to indicate the presence of enhancer-promoter loops, stripes, and TAD boundaries. Models that rely on regression and mean squared error (MSE) loss, which is thought to yield solutions with overly smooth textures [<xref rid="pcbi.1007287.ref027" ref-type="bibr">27</xref>], are likely to smooth these features. Thus, we seek to develop a model which is capable of predicting data with a sharp or degenerated distribution. Second, the structural patterns and textures of Hi-C data are abundant. The hypothesis space, which is controlled by the number of parameters, should be able to capture richer structures as it grows [<xref rid="pcbi.1007287.ref028" ref-type="bibr">28</xref>]. It is possible that increasing the depth of network would increase accuracy [<xref rid="pcbi.1007287.ref029" ref-type="bibr">29</xref>], while ensuring the model’s generalizability and restraining the overfitting problem. The final critical problem is the stochastic noise in Hi-C data. An effective model should be able to predict solutions resides on the manifold of target data and thus diminish stochastic noise (i.e., capability for denoising) [<xref rid="pcbi.1007287.ref030" ref-type="bibr">30</xref>, <xref rid="pcbi.1007287.ref031" ref-type="bibr">31</xref>].</p>
    <p>In order to make accurate prediction of high-resolution Hi-C data from low-coverage sequencing samples against these three problems. We developed a deep learning model which employed the state-of-the-art generative adversarial network (GAN), in combination with some advanced techniques in deep learning field. Goodfellow <italic>et al</italic>. first introduced the GAN model for estimating generative models with an adversarial process [<xref rid="pcbi.1007287.ref032" ref-type="bibr">32</xref>]. The GAN architecture allows the generative net to easily learn target data distribution, even sharp or degenerated distribution. GAN has been used for various applications and is showing its huge potency. For instance, Mirza <italic>et al</italic>. proposed the conditional GAN (cGAN) of which the generator learns the data distribution upon conditional inputs [<xref rid="pcbi.1007287.ref033" ref-type="bibr">33</xref>]. Li and Wand described the usage of GANs to learn a mapping from one manifold to another [<xref rid="pcbi.1007287.ref034" ref-type="bibr">34</xref>]. Another inspiring work for us was described by Ledig <italic>et al</italic>. [<xref rid="pcbi.1007287.ref035" ref-type="bibr">35</xref>], who proposed SRGAN to generate photo-realistic super-resolution images. Besides, He <italic>et al</italic>. introduced the concept of residual learning and proved that an ultra-deep neural network could be easily trained via residual learning and achieve superior performance [<xref rid="pcbi.1007287.ref036" ref-type="bibr">36</xref>]. Also, researchers started to design task-specified loss functions, using not only MSE loss (i.e., L2 loss) but other losses like perceptual loss [<xref rid="pcbi.1007287.ref037" ref-type="bibr">37</xref>] as well, and gain surprising advancements [<xref rid="pcbi.1007287.ref038" ref-type="bibr">38</xref>].</p>
    <p>In this paper, we propose a GAN-based method DeepHiC to enhance the resolution of Hi-C data. Using low-coverage Hi-C matrices (obtained by downsampling original Hi-C reads) as input, we demonstrate that DeepHiC is capable of reproducing high-resolution Hi-C matrices. DeepHiC-enhanced data achieve high correlation and structure similarity index (SSIM) compared with original high-resolution Hi-C matrices. And even using as few as 1% original reads, while no previous methods enhancing data of this depth, DeepHiC is still capable of inferring high-resolution data and achieves the correlation and SSIM score as good as the real high-resolution replicated assay. Compared with previous methods, our method is more accurate in predicting high-resolution Hi-C data, even in fine-grained details, and performed better when applied to different cell lines. Enhancements of DeepHiC improve the accuracy of downstream analysis such as identification of chromatin loops and detection of TADs. In this study, we applied DeepHiC to Hi-C data in mouse embryonic development and demonstrated that, compared with the original low-coverage Hi-C data, DeepHiC-enhanced Hi-C data enables the identification for chromatin loops that are similar to those identified in deeply sequenced Hi-C data. Besides, we also develop a web-based tool (DeepHiC, <ext-link ext-link-type="uri" xlink:href="http://sysomics.com/deephic">http://sysomics.com/deephic</ext-link>) that allows researchers to enhance their own Hi-C data with just a few clicks. In summary, this work introduces an effective model for enhancing Hi-C data resolution and establishes a new framework for prediction of a high-resolution Hi-C matrix from low-coverage data.</p>
  </sec>
  <sec sec-type="results" id="sec002">
    <title>Results</title>
    <sec id="sec003">
      <title>Parameters training of DeepHiC model</title>
      <p>In the current study, we propose a conditional generative adversarial network (cGAN), DeepHiC, for enhancing Hi-C data from low-resolution samples. It contains a generative network <italic>G</italic> and a discriminative network <italic>D</italic>. The former takes low-resolution data as input and imputes the enhanced output, while the latter is only employed during training process as a discriminator for reporting the differences between enhanced outputs and real high-resolution Hi-C data to the network <italic>G</italic>, which form the adversarial training (<xref ref-type="fig" rid="pcbi.1007287.g001">Fig 1A</xref>). Also, in order to alleviate the overly-smooth problem caused by MSE loss, we utilized the perceptual loss to capture structure features in Hi-C contact maps and the total variation (TV) loss for suppressing artifacts [<xref rid="pcbi.1007287.ref039" ref-type="bibr">39</xref>]. The detailed architecture of DeepHiC is depicted in <xref ref-type="supplementary-material" rid="pcbi.1007287.s003">S1 Fig</xref>. The GAN framework benefits <italic>G</italic> network by efficiently capturing the distribution of target data (even very sharp or degenerate distributions) [<xref rid="pcbi.1007287.ref032" ref-type="bibr">32</xref>] and favors solutions residing on the manifold of target data.</p>
      <fig id="pcbi.1007287.g001" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1007287.g001</object-id>
        <label>Fig 1</label>
        <caption>
          <title>Overview of the DeepHiC.</title>
          <p><bold>(a)</bold> DeepHiC framework: low-resolution inputs are obtained by randomly downsampling original reads. It imputes enhanced contact maps using a 23-layer residual network called <italic>Generator</italic>. In the training process, the enhanced outputs are approaching real high-resolution matrices by minimizing mean square error (MSE) loss, perceptual loss (PPL), and total variation (TV) loss, meanwhile, a <italic>Discriminator</italic> network distinguishes enhanced outputs from the real ones and reports the probabilities of enhanced outputs to be real to the <italic>Generator</italic> through adversarial (AD) loss. The imputation and discrimination steps form the adversarial training process. <bold>(b)</bold> For prediction, a low-resolution Hi-C matrix is divided into small squares as inputs. Then enhanced small squares are predicted by the <italic>Generator</italic>. Finally, those squares are merged into a chromosome-wide contact map as the enhanced output. <bold>(c, d)</bold> We randomly downsampled the original reads (obtained from GEO GSE63525) to 1/10, 1/25, 1/50, and 1/100 reads to simulate low-resolution inputs. DeepHiC is trained on chromosomes 1–14 and tested on chromosomes 15–22 (i.e., test set), in GM12878 cell line. <bold>(c)</bold> The trained DeepHiC model can be used for enhancing low-coverage sequencing Hi-C data, as an example which shows a 1Mb-width sub-region on chromosome 22 and <bold>(d)</bold> obtain high correlations between DeepHiC-enhanced matrices and real high-resolution Hi-C at each genomic distance. Colorbar setting: see <xref ref-type="supplementary-material" rid="pcbi.1007287.s001">S1 Note</xref>.</p>
        </caption>
        <graphic xlink:href="pcbi.1007287.g001"/>
      </fig>
      <p>We trained DeepHiC on chromosomes 1–14 and tested on chromosomes 15–22 in the <italic>GM12878</italic> cell line dataset during the training process (see <xref ref-type="sec" rid="sec011">Materials and Methods</xref>: Implementation of DeepHiC and evaluation). For low-resolution (low-coverage) data with different downsampling ratios, we obtained their corresponding trained models separately. We evaluated the structure similarity index (SSIM) scores in the test set during training. Higher SSIM scores between enhanced output and real high-resolution Hi-C indicate greater structural similarity. For low-resolution data from different downsampling ratios, SSIM scores in the test set increased gradually and converged when DeepHiC was trained in 200 epochs (<xref ref-type="supplementary-material" rid="pcbi.1007287.s004">S2 Fig</xref>), as well as another metric related to MSE (<xref ref-type="supplementary-material" rid="pcbi.1007287.s005">S3 Fig</xref>). Generator loss in both the training and test sets decreased simultaneously during the training process (<xref ref-type="supplementary-material" rid="pcbi.1007287.s006">S4 Fig</xref>). These results indicate that the model converged successfully in training without overfitting. Furthermore, we tested various splits of training and test sets, like a 5-fold cross validation. Performances in the test set were consistent across different dataset splits, showing that our model is capable of capturing common information from the different training sets and its parameters could be stably derived with no relation to training/test set we used (<xref ref-type="supplementary-material" rid="pcbi.1007287.s007">S5 Fig</xref>). We also trained the <italic>generator</italic> net as a regression model without the adversarial part, but SSIM scores in the test set vibrated substantially (<xref ref-type="supplementary-material" rid="pcbi.1007287.s008">S6 Fig</xref>). These results suggest that the GAN-based framework efficiently restrains the over-fitting phenomenon and its necessity for prediction. Besides, DeepHiC is also could be trained in <italic>IMR90</italic> or <italic>K562</italic> dataset (<xref ref-type="supplementary-material" rid="pcbi.1007287.s009">S7 Fig</xref>).</p>
      <p>In the prediction step, we divided the large Hi-C matrix into small squares as model inputs. For a fair comparison in the following analysis, we divided the low-resolution Hi-C matrix into 0.4 Mb × 0.4 Mb sub-regions (40 × 40 bins in 10-kb resolution) same with what HiCPlus does. Then the completed enhanced Hi-C matrix could be obtained by reconstructing all enhanced sub-regions after prediction (<xref ref-type="fig" rid="pcbi.1007287.g001">Fig 1B</xref>) (see <xref ref-type="sec" rid="sec011">Methods</xref>: dividing and reconstructing matrices).</p>
    </sec>
    <sec id="sec004">
      <title>DeepHiC reproduces high-resolution Hi-C from as few as 1% downsampled reads</title>
      <p>We used the high-resolution Hi-C data in the GM12878, K562 and IMR90 cell lines from Rao’s Hi-C (access code GSE63525) in our experiments. Datasets pertaining to different cell types are denoted as <italic>GM12878</italic>, <italic>GM12878R</italic>, <italic>K562</italic>, and <italic>IMR90</italic> for convenience (<italic>GM12878R</italic> represents the replicated assay in the GM12878 cell line). First, we constructed high-resolution (10-kb) contact matrices using all the reads from the raw data. Then we downsampled the reads to different ratios (ranges from 1:10 to 1:100) of the original reads to simulate the low-resolution Hi-C data. We also constructed contact matrices at the same bin size. Therefore, we obtained paired high-resolution and low-coverage Hi-C data (both were binned at 10-kb). The original experimental high-resolution data were regarded as ground truth in the following analysis, while the low-coverage data were enhanced by DeepHiC using the trained model.</p>
      <p><xref ref-type="fig" rid="pcbi.1007287.g001">Fig 1C</xref> shows the model’s enhancements in a 1Mb sub-region (100 bins) on chromosome 22 in the test set (GM12878 cell line). Comparing with the real 10-kb Hi-C data, DeepHiC-enhanced matrices recover patterns such as chromatin loops and TADs successfully from low-coverage inputs. Quantitatively, DeepHiC-enhanced data achieve the correlations as good as the experimental replicate (i.e., <italic>GM12878R</italic>), even though they were predicted from 1% downsampled data (<xref ref-type="fig" rid="pcbi.1007287.g001">Fig 1D</xref>). It also shows the same result in SSIM measure (<xref ref-type="supplementary-material" rid="pcbi.1007287.s010">S8 Fig</xref>). These results indicate that the DeepHiC model is capable of reproducing high-resolution Hi-C data with high similarity even using 1% downsampled reads. Because the high-resolution data we used is at 10-kb resolution, it implies that our method could enhance 1Mb resolution Hi-C data to 10-kb resolution with high quality. And there is no available imputation algorithm for enhancing Hi-C data from such a sequencing depth before.</p>
      <p>In the following analyses, we trained DeepHiC in 1/16 downsampled data for fairly comparing with other baseline methods such as HiCPlus, Boost-HiC, and HiCNN (see <xref ref-type="sec" rid="sec011">Methods</xref>). The trained model we used was trained on data of chromosome 1–14 in <italic>GM12878</italic> dataset. SSIM scores converged at 0.9 in remaining chromosomes (<xref ref-type="supplementary-material" rid="pcbi.1007287.s011">S9 Fig</xref>). For remaining chromosomes’ data in <italic>GM12878</italic> dataset, as well as the whole <italic>GM12878R</italic>, <italic>K562</italic>, and <italic>IMR90</italic> datasets, we applied the trained model to their downsampled data, then evaluated the performance with taking the real high-resolution data as the ground truth.</p>
    </sec>
    <sec id="sec005">
      <title>Enhancements of low-resolution data</title>
      <p>We first investigate the enhancements afforded by DeepHiC by visualizing data in the form of heatmaps (see <xref ref-type="supplementary-material" rid="pcbi.1007287.s001">S1 Note</xref> for colorbar settings). <xref ref-type="fig" rid="pcbi.1007287.g002">Fig 2A</xref> shows three 1-Mb-width sub-regions (arranged by rows) on chromosomes 16, 17, and 22 which were extracted from the test set in the <italic>GM12878</italic> dataset. The real high-resolution examples marked as “Original” in the first column contain clear individual chromatin loops and TAD structures, while low-coverage examples marked as “Downsampled” (second column) have abundant noise and less clear TAD structures. We found that DeepHiC-enhanced data (last column) could accurately restore the patterns and textures which are exactly the same as those in real high-resolution data. Baseline models’ results are shown in the third to fifth columns. Noting that Boost-HiC was specifically developed for enhancing long-range contacts [<xref rid="pcbi.1007287.ref025" ref-type="bibr">25</xref>]. So, it makes sense that Boost-HiC has slight changes in short-range contacts (third column). The HiCPlus-enhanced data marked as “HiCPlus” (fifth column) contains much less noise and more visible TAD structures, but refined structures such as chromatin loops are replaced by smooth textures. So does the HiCNN (fifth column), which is a deeper CNN and relies on MSE loss as well. In terms of fine-grained details, we scrutinized smaller 0.3 Mb × 0.3 Mb (30 × 30 bins) sub-regions from these three examples in real high-resolution Hi-C and DeepHiC-enhanced Hi-C, as illustrated in <xref ref-type="fig" rid="pcbi.1007287.g002">Fig 2B</xref>. High similarity between experimental high-resolution data and DeepHiC-enhanced data was observed. Sharp edges in heatmaps, which are deemed difficult to recover in practice, were accurately recovered by DeepHiC. We also visualized three sub-regions from the <italic>GM12878R</italic> dataset (<xref ref-type="supplementary-material" rid="pcbi.1007287.s012">S10 Fig</xref>), three sub-regions from the <italic>K562</italic> dataset (<xref ref-type="supplementary-material" rid="pcbi.1007287.s013">S11 Fig</xref>), and three sub-regions from the <italic>IMR90</italic> dataset (<xref ref-type="supplementary-material" rid="pcbi.1007287.s014">S12 Fig</xref>). And DeepHiC outperforms baseline models in all four datasets. The SSIM scores for downsampled, HiCPlus-enhanced, HiCNN-enhanced, and DeepHiC-enhanced data, as compared with real high-resolution data for these three sub-regions were 0.20, 0.64, 0.59, and 0.89 on average, respectively.</p>
      <fig id="pcbi.1007287.g002" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1007287.g002</object-id>
        <label>Fig 2</label>
        <caption>
          <title>DeepHiC enhances the interaction matrix, even in fine-grained textures, with low-sequence depth.</title>
          <p><bold>(a)</bold> Shown in the figures are real (first column), 1/16 downsampled (second column), Boost-HiC/HiCPlus/HiCNN-enhanced (third-fifth columns) and DeepHiC-enhanced (sixth column) interaction matrices in three different 1-Mb-width sub-regions from the GM12878 cell line at 10-kb resolution. <bold>(b)</bold> Enlarged heatmaps of smaller sub-regions (0.3Mb×0.3Mb, extracted from the matching coloured frames in <bold>(a)</bold> obtained from real high-resolution and DeepHiC-enhanced matrices.</p>
        </caption>
        <graphic xlink:href="pcbi.1007287.g002"/>
      </fig>
    </sec>
    <sec id="sec006">
      <title>DeepHiC outperformed other methods in terms of genome-wide similarity to ground truth deeply sequenced data</title>
      <p>Furthermore, we quantitatively investigated genome-wide performance for all four datasets. We calculated SSIM scores for downsampled and various model-enhanced data, as compared with real high-resolution data for all 1 Mb × 1 Mb (100 × 100 bins) sub-regions with non-overlap at the diagonal across the entire genome (<xref ref-type="supplementary-material" rid="pcbi.1007287.s015">S13 Fig</xref>). <xref ref-type="fig" rid="pcbi.1007287.g003">Fig 3A</xref> shows that DeepHiC-enhanced matrices had the highest SSIM scores for all 23 chromosomes in the <italic>GM12878</italic> dataset. Average values for downsampled, HiCPlus-enhanced, HiCNN-enhanced, and DeepHiC-enhanced data were 0.15, 0.71, 0.66, and 0.89, respectively. SSIM scores derived from DeepHiC, HiCPlus, and HiCNN are denoted as <italic>SSIM</italic><sub><italic>deephic</italic></sub>, <italic>SSIM</italic><sub><italic>hicplus</italic></sub> and <italic>SSIM</italic><sub><italic>hicnn</italic></sub>, respectively. <xref ref-type="fig" rid="pcbi.1007287.g003">Fig 3B</xref> shows the differences between these scores for all 4 datasets covering all chromosomes. Their absolute values are shown in <xref ref-type="supplementary-material" rid="pcbi.1007287.s016">S14 Fig</xref>. The comparison results show that DeepHiC achieves greater similarity than HiCPlus and HiCNN.</p>
      <fig id="pcbi.1007287.g003" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1007287.g003</object-id>
        <label>Fig 3</label>
        <caption>
          <title>Genome-wide comparative analyses of similarity and correlation in various cell types.</title>
          <p><bold>(a)</bold> High SSIM scores between DeepHiC-enhanced and real high-resolution matrices for all chromosomes in the <italic>GM12878</italic> dataset. <bold>(b)</bold> In extending this analysis to other cell lines, we calculated the differences SSIM scores derived from DeepHiC and baseline models. Circle dots represent the Δ values on each chromosome. Dotted line represents the location of zero value. <bold>(c)</bold> Comparison of Pearson correlation coefficients between non-experimental data and real Hi-C data at each genomic distance of interest from 50kb to 1Mb. DeepHiC outperforms other methods at all genomic distances examined. <bold>(d)</bold> We calculated all differences (Δ) between correlations derived from DeepHiC and those derived from HiCPlus/HiCNN at each distance in four datasets. The results obtained are depicted with boxplots. All Δ values are significantly greater than zero (dotted line) (paired t-test, pair number = 96). The whiskers are 5 and 95 percentiles. ***: p-value &lt; 1x10<sup>-20</sup>.</p>
        </caption>
        <graphic xlink:href="pcbi.1007287.g003"/>
      </fig>
      <p>We also computed the Pearson correlation coefficients between the experimental high-resolution, downsampled, baselines-enhanced, and DeepHiC-enhanced matrices at each genomic distance, which also performed in previous studies. As shown in <xref ref-type="fig" rid="pcbi.1007287.g003">Fig 3C</xref>, the DeepHiC-enhanced matrices obtained higher correlation coefficients (~5%) than the HiCPlus-enhanced matrices at all genomic distances of interest from 50 kb to 1 Mb. This region included proximal and distal regions. We also computed the differences between correlations derived from DeepHiC with those derived from HiCPlus/HiCNN, which are denoted as <italic>r</italic><sub><italic>deephic</italic></sub> and <italic>r</italic><sub><italic>hicplus</italic></sub>/<italic>r</italic><sub><italic>hicnn</italic></sub>, respectively. Then we investigated the distribution of differences in all four datasets by boxplots, with extremely small p-values obtained for that <italic>r</italic><sub><italic>deephic</italic></sub> are significantly higher than <italic>r</italic><sub><italic>hicplus</italic></sub>/<italic>r</italic><sub><italic>hicnn</italic></sub> (paired t-test, pair number = 96), as shown in <xref ref-type="fig" rid="pcbi.1007287.g003">Fig 3D</xref>. Their absolute values are shown in <xref ref-type="supplementary-material" rid="pcbi.1007287.s017">S15 Fig</xref>. The results of similarity and correlation comparison revealed our model’s advantages in restoring high-resolution Hi-C. More importantly, advantages across various cell lines revealed that DeepHiC can be used to enhance the Hi-C matrix for other cell types.</p>
      <p>We omitted comparison with Boost-HiC considering that it aims to enhance long-range contacts. Evaluation of Boost-HiC is plotted in <xref ref-type="supplementary-material" rid="pcbi.1007287.s016">S14 Fig</xref> and <xref ref-type="supplementary-material" rid="pcbi.1007287.s017">S15 Fig</xref>. Besides, we also investigated the performance of detecting A/B compartments for DeepHiC and Boost-HiC, because the latter is reported for it. <xref ref-type="supplementary-material" rid="pcbi.1007287.s018">S16 Fig</xref> shows our model achieves comparative performance in detecting A/B compartments, considering our model is trained using short-range contacts.</p>
      <p>Besides, we applied DeepHiC to data from various downsampled ratios (e.g., 1/25, 1/36), while still using the trained model derived from 1/16 downsampled data. <xref ref-type="supplementary-material" rid="pcbi.1007287.s019">S17 Fig</xref> shows that DeepHiC still achieves greater correlation coefficients. These results suggest that DeepHiC could be employed to enhance low-coverage sequencing data, rather than just enhancing data with a particular ratio. Thus, we used the same downsampling and predicting procedure to make predict on more cell types’ data (including mouse cell line CH12-LX) from Rao et al [<xref rid="pcbi.1007287.ref004" ref-type="bibr">4</xref>], as shown in <xref ref-type="supplementary-material" rid="pcbi.1007287.s020">S18 Fig</xref>. And correlations across cell types suggest that our model also preserve the specificities between cell lines (<xref ref-type="supplementary-material" rid="pcbi.1007287.s020">S18D Fig</xref>). Further, performances on Hi-C data prepared using 6-cutter enzyme revealed that our model is also applicable to 6-cutter enzyme prepared Hi-C data (<xref ref-type="supplementary-material" rid="pcbi.1007287.s021">S19 Fig</xref>).</p>
    </sec>
    <sec id="sec007">
      <title>Significant interactions in high-resolution Hi-C were accurately recovered from DeepHiC-enhanced matrices</title>
      <p>After demonstrating that DeepHiC can restore high-resolution Hi-C from low-resolution data, we investigated whether these enhanced high-resolution matrices could facilitate the identification of significant chromatin interactions, which are usually considered to be chromatin loops. For this purpose, we used Fit-Hi-C software to obtain significant intra-chromosomal interactions. We applied Fit-Hi-C to Hi-C data present above, in four datasets, using the same parameters (Methods). Statistical confidence values (i.e., q-values) for all loci-pairs were acquired by Fit-Hi-C. We kept the predicted significant interactions (q-value &lt; 1 × 10<sup>−6</sup>) for genomic distances from 20 kb to 1 Mb for further comparative analysis. At first, we visualized three 1 Mb-wide sub-regions. Significant interactions are presented in yellow in the upper triangles of heatmaps (<xref ref-type="fig" rid="pcbi.1007287.g004">Fig 4A</xref>). Compared with the real high-resolution data, only DeepHiC-enhanced matrices yield consistent results in recognizing significant interactions. And the yellow-marked anchors are indeed significant interactions by observing the lower triangular parts of heatmaps. The numbers of interactions in these three sub-regions (denoted as I, II and III) derived from various contact matrices are presented in <xref ref-type="supplementary-material" rid="pcbi.1007287.s022">S20 Fig</xref>. HiCNN and HiCPlus-enhanced matrices identified few loci-pairs, while the experimental and DeepHiC-enhanced matrices identified about 40 loci-pairs, respectively. <xref ref-type="fig" rid="pcbi.1007287.g004">Fig 4A</xref> presents the significant interactions identified in real high-resolution Hi-C gathered in 8, 20, and 11 clusters, respectively. However, for low-resolution Hi-C, few interactions were identified. For HiCPlus-enhanced Hi-C, only six clusters were recovered. Surprisingly, DeepHiC-enhanced Hi-C recovered nearly all clusters (35 in total) and no false-positive cluster was added.</p>
      <fig id="pcbi.1007287.g004" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1007287.g004</object-id>
        <label>Fig 4</label>
        <caption>
          <title>Analyses of significant chromatin interactions identified by Fit-Hi-C software.</title>
          <p><bold>(a)</bold> Three representative sub-regions (1 Mb × 1 Mb) from chromosomes 17 and 22 (GM12878 cell line), with significant loci-pairs (cut-off is the 0.5 percentile of q-values) being marked with yellow points in the upper triangle of the heatmaps. <bold>(b)</bold> All q-values were treated as significance matrices. The Pearson correlations of q-values for non-experimental data vs. real Hi-C data at various genomic distances are presented. Missing values are <italic>NaN</italic> values derived by python (numpy). <bold>(c)</bold> We evaluated the overlap of significant loci-pair with real Hi-C data at each distance, using the preset cut-off. <bold>(d)</bold> We evaluated the overlap of all significant loci-pairs with various cut-off values, with respect to the false discovery rate which ranges from 0.001 to 0.05. <bold>(e)</bold> ROC analysis of overlap between interactions from CTCF ChIA-PET with identified interacting peaks from real high-resolution, downsampled, HiCPlus/HiCNN-enhanced, and DeepHiC-enhanced Hi-C matrices in the K562 cell line.</p>
        </caption>
        <graphic xlink:href="pcbi.1007287.g004"/>
      </fig>
      <p>Because Fit-Hi-C calculated the significance of all loci-pairs within the genomic distance of interest, we performed a genome-wide comparative analysis by analyzing the significance matrices formed with q-values. We calculated the similarity of significance matrices, as previously performed for Hi-C matrices. <xref ref-type="fig" rid="pcbi.1007287.g004">Fig 4B</xref> shows the Pearson correlation coefficients for significance matrices in the <italic>GM12878</italic> dataset at each genomic distance. Same results of comparisons between the other three datasets are presented in <xref ref-type="supplementary-material" rid="pcbi.1007287.s023">S21 Fig</xref>. We observed that q-values derived from DeepHiC-enhanced data were more similar to the real high-resolution data than any others for the entire dataset. We also compared the overlap of identified interactions with real high-resolution data at each genomic distance, as shown in <xref ref-type="fig" rid="pcbi.1007287.g004">Fig 4C</xref>. The Jaccard index (<italic>JI</italic>) of identified interactions between DeepHiC-enhanced data and real high-resolution data was higher at each genomic distance. In addition to using the aforementioned threshold for q-values, we tried more thresholds by scanning various false discovery rates (FDR), ranging from 0.001 to 0.05, with step size of 0.001. We evaluated the overlap of identified interactions according to FDR scanning. We found that DeepHiC outperformed others (<xref ref-type="fig" rid="pcbi.1007287.g004">Fig 4D</xref>). These results suggested that DeepHiC-enhanced Hi-C data are more accurate in predicting chromatin loops and yield less artifact noise.</p>
      <p>Next, we compared the significant interactions identified in these Hi-C matrices with the identified chromatin interactions by CTCF chromatin interaction analysis by paired-end tagging sequencing (ChIA-PET) in the K562 cell line, for which related data is available in the ENCODE project. ROC analysis was performed in the same way as is described in HiCPlus, using the identified CTCF-mediated chromatin interactions from ChIA-PET as true positives. As for negatives, we randomly selected the same number of loci pairs that were not predicted to be interacting pairs by ChIA-PET and that had the same distance distribution with positives (10 repeats). We then plotted the ROC (receiver operating characteristic) curve and calculated the area under the ROC curve (AUC) for each. As shown in <xref ref-type="fig" rid="pcbi.1007287.g004">Fig 4E</xref>, CTCF interacting pairs and non-interacting pairs were separated from the DeepHiC-enhanced matrix in the predicted results (average AUC = 0.825). We also observed that the AUC score for the DeepHiC-enhanced matrix was significantly higher than both the AUC derived from the HiCPlus/HiCNN-enhanced matrix (p-value = 0, paired t-test) as well as the AUC derived from the downsampled matrix (p-value = 0, paired t-test).</p>
    </sec>
    <sec id="sec008">
      <title>DeepHiC is more precise in detecting TAD boundaries</title>
      <p>The detection of TADs is not as sensitive to resolution decline as algorithms for detecting TADs, we obtained roughly the same results when using the Hi-C data with various downsampling ratios [<xref rid="pcbi.1007287.ref023" ref-type="bibr">23</xref>]. However, we found that some refined TAD structures were shifted-even wrongly detected-in low-resolution data. Therefore, we continually assessed the performance of DeepHiC in recovering TADs, especially in fine-scale TADs. We calculated the Δ score of insulation scores across the entire genome for all four datasets (Methods). The zero-points within monotonic rising intervals are considered to be TAD boundaries. <xref ref-type="fig" rid="pcbi.1007287.g005">Fig 5A</xref> illustrates the insulation Δ scores derived from experimental high-resolution, downsampled, HiCPlus/BoostHiC/HiCNN-enhanced, and DeepHiC-enhanced Hi-C matrices, on chromosome 22, in the region between 20–22.7 Mb, from the <italic>GM12878</italic> dataset. The trends seemed similar, but enlarged views around the zero-points revealed that DeepHiC obtained the closest location of zero-points, while downsampled Hi-C and HiCPlus-enhanced Hi-C had bias of 20–50 kb. The Pearson correlation coefficients between Δ scores derived from experimental Hi-C and those derived from non-experimental Hi-C were 0.937, 0.953, and 0.992 for downsampled, HiCPlus-enhanced, and DeepHiC-enhanced data, respectively.</p>
      <fig id="pcbi.1007287.g005" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1007287.g005</object-id>
        <label>Fig 5</label>
        <caption>
          <title>Enhancements of DeepHiC in detecting TAD boundaries, using insulation score algorithm.</title>
          <p><bold>(a)</bold> Graphs of insulation Δ scores derived from different Hi-C data. TAD boundaries are zero-points of insulation Δ scores in ascending intervals. Enlarged photos show that zero-points derived from DeepHiC-enhanced data are closest to those derived from real high-resolution data. <bold>(b)</bold> Distances from TAD boundaries obtained from downsampled/enhanced data to those obtained from real high-resolution data. Boxplots show that distances of DeepHiC-enhanced data are significantly smaller than others (***: p-value &lt; 1×10<sup>−20</sup>, *: p-value &lt; 0.05,Wilcoxon rank-sum test). The whiskers are 5 and 95 percentiles. <bold>(c)</bold> The distribution of the overlaps between TADs in downsampled/enhanced data and those in real high-resolution data. Higher proportion of high Jaccard indices (y-axis) was obtained with use of DeepHiC-enhanced data. ***: p-value &lt; 1×10<sup>−20</sup>, **: p-value &lt; 0.001, Mann Whitney U-test. Dash lines in violin plots are quantiles.</p>
        </caption>
        <graphic xlink:href="pcbi.1007287.g005"/>
      </fig>
      <p>As for the two segmentations formed by TAD boundaries, we calculated all split points’ distances and all intervals’ overlap with another segmentation (see <xref ref-type="sec" rid="sec011">Methods</xref>), then investigated the properties of the resulting arrays. As shown in <xref ref-type="fig" rid="pcbi.1007287.g005">Fig 5B</xref>, we illustrated the distribution of all boundaries’ distances from <italic>S</italic><sub><italic>down</italic></sub>, <italic>S</italic><sub><italic>boosthic</italic></sub>, <italic>S</italic><sub><italic>hicplus</italic></sub>, <italic>S</italic><sub><italic>hicnn</italic></sub>, and <italic>S</italic><sub><italic>deephic</italic></sub> to <italic>S</italic><sub><italic>origin</italic></sub> in the <italic>GM12878</italic> dataset via box plot. Boundary segmentations were derived from corresponding data. The distances of DeepHiC-enhanced data were significantly smaller than those of Boost-HiC-enhanced data (p-value = 1.4 × 10<sup>−40</sup>, Wilcoxon rank-sum test), those of HiCPlus-enhanced data (p-value = 7.1 × 10<sup>−14</sup>, Wilcoxon rank-sum test), those of HiCNN-enhanced data (p-value = 0.035, Wilcoxon rank-sum test) and those of downsampled data (p-value = 1.3 × 10<sup>−193</sup>, Wilcoxon rank-sum test). We also investigated the distribution of the overlap of segmentations vs. experimental high-resolution data (<xref ref-type="fig" rid="pcbi.1007287.g005">Fig 5C</xref>). The results showed that our model had a high proportion of high <italic>JI</italic> (p-value &lt; 1 × 10<sup>−20</sup> for downsampled/BoostHiC-enhanced/HiCPlus-enhanced data, &lt; 0.001 for HiCNN-enhanced data, Mann Whitney U-test), which indicates that more TADs are precisely matched with those in real Hi-C data. Same results of comparisons for other cell types are illustrated in <xref ref-type="supplementary-material" rid="pcbi.1007287.s024">S22 Fig</xref>.</p>
    </sec>
    <sec id="sec009">
      <title>DeepHiC enhances prediction of chromatin loops in mouse early embryonic developmental stages</title>
      <p>DeepHiC can be used to enhance the resolution of existing time-resolved Hi-C data obtained through early embryonic growth. These data are prone to low resolution due to limited cell population (40-kb in [<xref rid="pcbi.1007287.ref040" ref-type="bibr">40</xref>]). Therefore, algorithms for detecting significant interactions, when applied to these data, may produce results with a relatively high false positive rate. We demonstrate that DeepHiC can be applied to Hi-C data of mouse early embryonic development to enable identification of significant chromatin interactions with a considerably lower false positive rate. We applied Fit-Hi-C to both original low-resolution Hi-C contact matrices and DeepHiC-enhanced contact matrices (<xref ref-type="fig" rid="pcbi.1007287.g006">Fig 6A</xref>) and kept pairs of loci with q-values lower than a preset cut-off (0.5 percentile) as significant interactions (predicted loops). Chromatin loops regulate spatial enhancer-promoter contacts and are relevant to domain formation [<xref rid="pcbi.1007287.ref004" ref-type="bibr">4</xref>, <xref rid="pcbi.1007287.ref041" ref-type="bibr">41</xref>], and anchors of Fit-Hi-C predicted significant interactions co-localize with open chromatin regions including insulators, enhancers, and promoters. In deeply sequenced Hi-C data of GM12878 cell line, significant interactions identified by Fit-Hi-C are significantly enriched in gene promoter and open chromatin regions compared to shuffled control (<xref ref-type="supplementary-material" rid="pcbi.1007287.s025">S23 Fig</xref>). Therefore, we evaluate the similarity of Fit-Hi-C significant interactions identified on mouse embryonic development Hi-C data to those identified in high-resolution Hi-C data according to the fraction of all significant interactions that connect promoter regions, as well as by the fraction connecting two accessible chromatin regions marked by ATAC-seq peaks. As shown in <xref ref-type="fig" rid="pcbi.1007287.g006">Fig 6B</xref>, significant interactions identified using DeepHiC enhanced Hi-C data are more likely to anchor at gene promoters than those identified using original Hi-C data. They are also more likely to co-localize with open chromatin regions at both of their anchoring loci than those predicted with original Hi-C data (<xref ref-type="fig" rid="pcbi.1007287.g006">Fig 6C</xref>). We mainly focused on the 8-cell stage and beyond because Hi-C data from earlier stages only demonstrate weak TADs and depleted distal chromatin interactions [<xref rid="pcbi.1007287.ref040" ref-type="bibr">40</xref>]. To generate control datasets, we randomly repositioned all predicted significant interactions for original Hi-C data, while maintaining the distance between anchors of each significant interaction, using the “shuffle” command in Bedtools [<xref rid="pcbi.1007287.ref042" ref-type="bibr">42</xref>]. We repeated this process 20 times to generate 20 random significant interaction datasets. We found that the fraction of predicted significant interactions that connected accessible loci was significantly higher for DeepHiC-enhanced Hi-C data, compared with random control data. Using an example at chromosome 5, we showed that significant interactions predicted using original Hi-C data were highly separated (<xref ref-type="fig" rid="pcbi.1007287.g006">Fig 6D</xref>). This is inconsistent with the known characteristics of significant interactions, as they are mostly located within TADs and are frequently observed as strong apexes of TADs and sub-TADs [<xref rid="pcbi.1007287.ref004" ref-type="bibr">4</xref>, <xref rid="pcbi.1007287.ref043" ref-type="bibr">43</xref>]. <xref ref-type="fig" rid="pcbi.1007287.g006">Fig 6C</xref> shows that significant interactions as predicted using DeepHiC-enhanced Hi-C data are predominantly located within TADs, and at the apexes of TADs, where they co-localize with open chromatin regions. Therefore, DeepHiC is a powerful tool for studying chromatin structure during mammalian early embryonic development.</p>
      <fig id="pcbi.1007287.g006" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1007287.g006</object-id>
        <label>Fig 6</label>
        <caption>
          <title>Analysis of significant interactions identified using DeepHiC-enhanced Hi-C data of mouse early embryonic development.</title>
          <p><bold>(a)</bold> Heatmaps showing examples of original and DeepHiC enhanced contact matrices for various stage of embryonic development. <bold>(b)</bold> Fraction of significant interactions for which anchor loci intersected with gene promoters. Error bar: standard deviation. Significance: ***: p-value &lt; 1 × 10<sup>−20</sup> one-sample t-test. <bold>(c)</bold> Fraction of significant interactions for which both connected loci contain ATAC-seq signal peaks. Error bar: standard deviation. Significance: ***: p-value &lt; 1 × 10<sup>−20</sup>, one-sample t-test. <bold>(d)</bold> A representative Hi-C contact matrix, with significant interactions as depicted for the 8-cell stage. Left panel: Original Hi-C contact matrix and predicted significant interactions (bold pixels inside red circles). Right panel: DeepHiC enhanced contact matrix and predicted significant interactions (blue pixels).</p>
        </caption>
        <graphic xlink:href="pcbi.1007287.g006"/>
      </fig>
    </sec>
  </sec>
  <sec sec-type="conclusions" id="sec010">
    <title>Discussion</title>
    <p>Hi-C is commonly used to map 3D chromatin organization across the genome. Since its introduction in 2009, this method has been updated many times in order to improve its accuracy and resolution. However, owing to the high cost of sequencing, most available Hi-C datasets have relatively low resolution (40-kb to 1-Mb). The low-resolution representation of Hi-C data limits its application in studies of genomic regulatory networks or disease mechanisms, which require robust, high-resolution 3D genomic data.</p>
    <p>In this study, we proposed a deep learning method, DeepHiC, for predicting experimentally-realistic high-resolution data from low-resolution samples. Our approach can produce estimates of experimental high-resolution Hi-C data with high similarity, using 1% sequencing reads. DeepHiC is built on state-of-the-art techniques from the deep learning discipline, including the GAN framework, residual learning, and perceptual loss. With using of the GAN framework, carefully designed net architecture, and loss functions in DeepHiC, it becomes possible to predict high-resolution Hi-C with high structural similarity of 0.9 to real high-resolution Hi-C. This approach may be used to accurately predict chromatin interactions, even in fine detail. Because of the huge quantity of parameters (~121,000) included in the network, DeepHiC may be used to approximate the real data, and to make predictions in other cell or tissue types. More importantly, enhancements afforded by DeepHiC favor the identification of significant chromatin interactions and TADs in Hi-C data. Finally, we also applied DeepHiC to Hi-C data pertaining to mouse early embryonic developmental stages, for which only low-coverage sequencing data were available, and enhancements afforded by DeepHiC facilitated identification of significant chromatin contacts for these data.</p>
    <p>DeepHiC provides a GAN-based framework with which to enhance Hi-C data, and even other omics data. The GAN framework is a state-of-the-art technique in the deep learning field in recent years. The idea of adversarial training allows the deep model to capture learnable patterns efficiently and stably. DeepHiC is trained with real high-resolution data as target and is therefore a supervised learning paradigm. The quality of the target determines the upper-bound efficiency of the model. Here we used the most deeply sequenced GM12878 cell line data as a training set. It would be possible to retrain or fine-tune the model if more accurate Hi-C data were available, potentially reaching restriction-fragment resolution. Besides, we also performed a quasi-autoencoder training by taking low-coverage data to be both input and target, like an auto encoder, for ensuring that our model improves the sequencing depth rather than simply cleaning the data (<xref ref-type="supplementary-material" rid="pcbi.1007287.s026">S24 Fig</xref>). DeepHiC could be used not only to enhance existing low-resolution Hi-C data but also to reduce the experimental cost of sequencing in future Hi-C assays. As our method outperforms baseline methods, current low coverage Hi-C data could benefit from this improvement in performance. For example, Hi-C data imputed by our method can be used to identify significant interactions and TADs more similar to those identified with deeply sequenced Hi-C data. In some circumstances, in which the limitation on the number of cells stands in the way of producing high resolution Hi-C data, our method could provide an alternative solution to this problem. In addition, we develop a web-based tool (DeepHiC, <ext-link ext-link-type="uri" xlink:href="http://sysomics.com/deephic">http://sysomics.com/deephic</ext-link>) that allows researchers to enhance their own Hi-C data with just a few clicks. And the enhancement procedure runs in 3–5 minutes using single CPU (for example, enhancement on chromosome 1 of human will cost 4.7 minutes using a Xeon CPU E5-2682 v4 @ 2.5GHz). It will be faster when using a GPU (22s for Nvidia 1080ti). We trained several models based on various downsampled data. Translating the downsampling ratios to read coverage or data distribution is indispensable for users. We discuss the strategy of choosing between models in <xref ref-type="supplementary-material" rid="pcbi.1007287.s002">S2 Note</xref>. A caveat is that the low-coverage Hi-C data of input should have more than 10% non-zero entries.</p>
    <p>In conclusion, DeepHiC introduced the GAN framework for enhancing the resolution of Hi-C interaction matrices. By utilizing the GAN framework and other techniques such as residual learning, DeepHiC can generate high-resolution Hi-C data using a low fraction of the original number of sequencing reads. DeepHiC can easily be used in a number of Hi-C data analysis pipelines, and prediction could be executed quickly in minutes on the human genome.</p>
  </sec>
  <sec sec-type="materials|methods" id="sec011">
    <title>Materials and methods</title>
    <sec id="sec012">
      <title>Hi-C data sources and processing</title>
      <p>The high-resolution (10-kb) Hi-C data used for training and evaluating were obtained from GEO (<ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/">https://www.ncbi.nlm.nih.gov/geo/</ext-link>) under accession number GSE63525. The primary Hi-C data in GM12878 cell line (HIC001-018) is denoted as <italic>GM12878</italic> dataset in this paper, and the corresponding replicate (HIC019-029) is denoted as <italic>GM12878R</italic> dataset for convenience. The high-resolution Hi-C contact maps for each dataset were derived from reads with mapping quality &gt; 30. And we used the KR-normalization scheme [<xref rid="pcbi.1007287.ref044" ref-type="bibr">44</xref>] for normalized data.</p>
      <p>Corresponding low-resolution data were simulated by randomly downsampling the sequencing reads to different ratios range from 1:10 to 1:100 (i.e., 1% reads). Downsampled data would typically be processed at lower resolution because of the shallower sequencing depths. In our experiments, low-resolution contact maps were built using the same bin size as used for high-resolution Hi-C to fit the models’ requirement. All resolution enhancing methods compared in our study used this same procedure as reported in HiCPlus [<xref rid="pcbi.1007287.ref017" ref-type="bibr">17</xref>] to ensure fair comparisons.</p>
      <p>Hi-C data pertaining to mouse embryonic development were obtained from GEO under accession number GSE82185. Hi-C matrices of 10-kb bin size were created using the HOMER (<ext-link ext-link-type="uri" xlink:href="http://homer.ucsd.edu/homer/">http://homer.ucsd.edu/homer/</ext-link>) analyzeHiC command with the following parameters: -res 10000 –window 10000.</p>
      <p>ChIA-PET data for the CTCF target in the K562 cell line was obtained from ENCODE (<ext-link ext-link-type="uri" xlink:href="https://encodeproject.org/">https://encodeproject.org</ext-link>) under accession number ENCSR000CAC (file: ENCFF001THV.bed.gz). Chromosome regions were mapped to Hi-C bins with which they overlapped in ROC analysis. ATAC-seq data on mouse early embryonic development was obtained from GEO under accession number GSE66390. Data of DNase-seq peaks on GM12878 cell line was obtained from ENCODE under accession number ENCSR000EMT.</p>
      <p>For Hi-C matrices in training, outliers are set to the allowed maximum by setting the threshold be the 99.9-th percentile. For example, 255 is about the average of 99.9-th percentiles for 10-kb Hi-C data, so all values greater than 255 are set to 255 for 10-kb Hi-C data. Then all Hi-C matrices are rescaled to values ranging from 0 to 1 by min-max normalization [<xref rid="pcbi.1007287.ref045" ref-type="bibr">45</xref>] to ensure the training stability and efficiency. Besides, cutoff values for downsampled inputs of our model were 125, 100, 80, 50, and 25 for 1/10, 1/16, 1/25, 1/50, and 1/100 downsampled ratios.</p>
    </sec>
    <sec id="sec013">
      <title>DeepHiC architecture</title>
      <p>In general, DeepHiC is a GAN model that comprises a generative network called <italic>generator</italic> and a discriminative network called <italic>discriminator</italic>. The <italic>generator</italic> tries to generate enhanced outputs that approximate real high-resolution data from low-resolution data, while the <italic>discriminator</italic> tries to tell generated data apart from real high-resolution data and reports the difference to the <italic>generator</italic>. The contest (hence “adversarial”) between <italic>generator</italic> and <italic>discriminator</italic> promotes the <italic>generator</italic> learns to map from conditional input to a data distribution of interest.</p>
      <p>As depicted in <xref ref-type="supplementary-material" rid="pcbi.1007287.s003">S1 Fig</xref>, the <italic>generator</italic> net (<italic>G</italic>) is a convolutional residual network (first row), while the <italic>discriminator</italic> net (<italic>D</italic>) is a convolutional neural network (second row). The <italic>G</italic> net takes low-resolution matrices (<italic>X</italic>) as input and outputs enhanced matrices (<inline-formula id="pcbi.1007287.e001"><alternatives><graphic xlink:href="pcbi.1007287.e001.jpg" id="pcbi.1007287.e001g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M1"><mml:mover accent="true"><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula>) with identical size. The adversarial component, the <italic>D</italic> net, takes the enhanced output <inline-formula id="pcbi.1007287.e002"><alternatives><graphic xlink:href="pcbi.1007287.e002.jpg" id="pcbi.1007287.e002g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M2"><mml:mover accent="true"><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> and the real high-resolution data (<italic>Y</italic>) as input and outputs 0–1 labels. The green arrowed lines describe how data are processed in DeepHiC. The <italic>G</italic> net, employs two layers: the convolutional layer (blue block) and the batch normalization (BN) layer [<xref rid="pcbi.1007287.ref046" ref-type="bibr">46</xref>] (yellow block). Together with elementwise sum operation (green ball) and skip-connection operation (green polyline), some of these layers form the residual blocks (ResBlocks) [<xref rid="pcbi.1007287.ref047" ref-type="bibr">47</xref>]. There are five successive ResBlocks in <italic>G</italic>. As for the activation function (pink block), we elected to use the Swish function [<xref rid="pcbi.1007287.ref048" ref-type="bibr">48</xref>] instead of the Rectified Linear Unit (ReLU) for activating some layers. The Swish function is defined as:
<disp-formula id="pcbi.1007287.e003"><alternatives><graphic xlink:href="pcbi.1007287.e003.jpg" id="pcbi.1007287.e003g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M3"><mml:mi>f</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mi>x</mml:mi><mml:mo>⋅</mml:mo><mml:mi>σ</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi>β</mml:mi><mml:mi>x</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>,</mml:mo></mml:math></alternatives></disp-formula>
where <italic>β</italic> = 1 and <italic>σ</italic> is the sigmoid function. Swish has been shown to works better than ReLU in deep models [<xref rid="pcbi.1007287.ref049" ref-type="bibr">49</xref>]. Note that the final outputs of <italic>G</italic> are scaled by:
<disp-formula id="pcbi.1007287.e004"><alternatives><graphic xlink:href="pcbi.1007287.e004.jpg" id="pcbi.1007287.e004g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M4"><mml:mi>g</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">tanh</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:math></alternatives></disp-formula></p>
      <p>Thus, elements in output matrices range from 0 to 1. In general, the <italic>G</italic> net contains about 121,000 parameters. The <italic>D</italic> network is a convolutional network similar with the VGG network [<xref rid="pcbi.1007287.ref050" ref-type="bibr">50</xref>]. The number of kernels in a convolutional layer is depicted via block width: the more kernels, the wider the width of the block. The final output of <italic>D</italic> is a scalar value ranges from 0 to 1 by a sigmoid function. More details of the hyperparameters of network architectures, such as kernel size and filter numbers, are summarized in <xref ref-type="supplementary-material" rid="pcbi.1007287.s027">S1 Table</xref> and <xref ref-type="supplementary-material" rid="pcbi.1007287.s028">S2 Table</xref>.</p>
      <p>To establish the GAN paradigm for training (<xref ref-type="fig" rid="pcbi.1007287.g001">Fig 1A</xref>), we employed both the <italic>generator</italic> net <italic>G</italic> and the <italic>discriminator</italic> net <italic>D</italic>. The <italic>G</italic> net aims to generate enhanced outputs by approximating to the real high-resolution matrices <italic>Y</italic>, while the <italic>D</italic> net attempts to distinguish the real <italic>Y</italic> from the generated <inline-formula id="pcbi.1007287.e005"><alternatives><graphic xlink:href="pcbi.1007287.e005.jpg" id="pcbi.1007287.e005g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M5"><mml:mover accent="true"><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula>. In the <italic>D</italic> net, the value of output <inline-formula id="pcbi.1007287.e006"><alternatives><graphic xlink:href="pcbi.1007287.e006.jpg" id="pcbi.1007287.e006g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M6"><mml:mover accent="true"><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mi>D</mml:mi><mml:mo>(</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover><mml:mo>)</mml:mo></mml:math></alternatives></inline-formula> is considered to be the probability of <inline-formula id="pcbi.1007287.e007"><alternatives><graphic xlink:href="pcbi.1007287.e007.jpg" id="pcbi.1007287.e007g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M7"><mml:mover accent="true"><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> to be real data. Divergences between <inline-formula id="pcbi.1007287.e008"><alternatives><graphic xlink:href="pcbi.1007287.e008.jpg" id="pcbi.1007287.e008g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M8"><mml:mover accent="true"><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> and <italic>Y</italic>, as well as the probability of <inline-formula id="pcbi.1007287.e009"><alternatives><graphic xlink:href="pcbi.1007287.e009.jpg" id="pcbi.1007287.e009g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M9"><mml:mover accent="true"><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> to be real data, are minimized according to a carefully designed loss function. Besides, these two networks are trained alternatively by the backpropagation algorithm.</p>
    </sec>
    <sec id="sec014">
      <title>Loss functions in DeepHiC</title>
      <p>A critical point when designing a deep learning model is the definition of the loss function. Many methods have recently been proposed to stabilize training [<xref rid="pcbi.1007287.ref051" ref-type="bibr">51</xref>, <xref rid="pcbi.1007287.ref052" ref-type="bibr">52</xref>] and improve the quality of synthesized images [<xref rid="pcbi.1007287.ref037" ref-type="bibr">37</xref>] by the GAN model. For DeepHiC, the binary cross entropy loss function for the <italic>D</italic> network was used to measure the error of output, as compared with the assigned labels. Because real and generated high-resolution data are paired in practice, it can be described as:
<disp-formula id="pcbi.1007287.e010"><alternatives><graphic xlink:href="pcbi.1007287.e010.jpg" id="pcbi.1007287.e010g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M10"><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi>D</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:mfrac><mml:mrow><mml:munder><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">log</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="normal">log</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:math></alternatives></disp-formula>
where <italic>i</italic> is the index for pairs of real and generated data, and <italic>N</italic> is the number of pairs. Here we used <italic>y</italic> = <italic>D</italic>(<italic>Y</italic>) and <inline-formula id="pcbi.1007287.e011"><alternatives><graphic xlink:href="pcbi.1007287.e011.jpg" id="pcbi.1007287.e011g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M11"><mml:mover accent="true"><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mi>D</mml:mi><mml:mo>(</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover><mml:mo>)</mml:mo></mml:math></alternatives></inline-formula>.</p>
      <p>For <italic>generator</italic> loss, we used four loss functions, which were added to yield a final objective function. Firstly, we used MSE to measure the pixel-wise error between predicted Hi-C matrices and real high-resolution matrices, defined as:
<disp-formula id="pcbi.1007287.e012"><alternatives><graphic xlink:href="pcbi.1007287.e012.jpg" id="pcbi.1007287.e012g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M12"><mml:mi>M</mml:mi><mml:mi>S</mml:mi><mml:mi>E</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mi>Y</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:mfrac><mml:mrow><mml:munderover><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>,</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></disp-formula>
which is also called L2 loss. The <italic>MSE</italic> loss function is broadly used for regression problems, while the fact that <italic>MSE</italic> loss does not correlate well with the human perception of image quality [<xref rid="pcbi.1007287.ref053" ref-type="bibr">53</xref>] and overly smooths refined structures in images [<xref rid="pcbi.1007287.ref027" ref-type="bibr">27</xref>]. We also employ perceptual loss [<xref rid="pcbi.1007287.ref037" ref-type="bibr">37</xref>], however, based on the feature layers of the VGG16 network. We used total variation (TV) loss, derived from the total variation denoising technique, so as to suppress noise in images [<xref rid="pcbi.1007287.ref054" ref-type="bibr">54</xref>]. Final <italic>generator</italic> loss is yielded in combination with adversarial (AD) loss derived from <italic>D</italic> network and defined as:
<disp-formula id="pcbi.1007287.e013"><alternatives><graphic xlink:href="pcbi.1007287.e013.jpg" id="pcbi.1007287.e013g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M13"><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi>G</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mi>S</mml:mi><mml:mi>E</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>α</mml:mi><mml:mo>⋅</mml:mo><mml:msub><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mi>V</mml:mi><mml:mi>G</mml:mi><mml:mi>G</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>β</mml:mi><mml:mo>⋅</mml:mo><mml:msub><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>γ</mml:mi><mml:mo>⋅</mml:mo><mml:msub><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mo>.</mml:mo></mml:math></alternatives></disp-formula></p>
      <p>Note that <inline-formula id="pcbi.1007287.e014"><alternatives><graphic xlink:href="pcbi.1007287.e014.jpg" id="pcbi.1007287.e014g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M14"><mml:msub><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mo>)</mml:mo><mml:mo>/</mml:mo><mml:mi>N</mml:mi></mml:math></alternatives></inline-formula> without logarithmic transformation, which allows for fast and stable training of the <italic>G</italic> net [<xref rid="pcbi.1007287.ref051" ref-type="bibr">51</xref>]. Hyperparameters <italic>α</italic>,<italic>β</italic>,<italic>γ</italic> are scale weights that range from 0 to 1.</p>
    </sec>
    <sec id="sec015">
      <title>Implementation of DeepHiC and performance evaluation</title>
      <p>DeepHiC is implemented in Python scripts with PyTorch 1.0 [<xref rid="pcbi.1007287.ref055" ref-type="bibr">55</xref>]. After splitting <italic>GM12878</italic> dataset into a training set and a test set, the model was trained on the training set and tested on the test set during training process. The final model we used was trained on chromosomes 1–14. We divided contact matrices where the genomic distance between two loci is &lt;2 Mb, as the average size of TAD is &lt;1 Mb and there are few significance interactions outside TADs, thus could be omitted for training. The Adam optimizer [<xref rid="pcbi.1007287.ref056" ref-type="bibr">56</xref>] is used with a batch size of 64, and all networks are trained from scratch, with a learning rate of 0.0001. We trained the networks with 200 epochs. In order to yield loss terms on the same scale, the hyperparameters for <italic>generator</italic> loss were set as <italic>α</italic> = 0.006, <italic>β</italic> = 2 × 10<sup>−8</sup>, and <italic>γ</italic> = 0.001. All training process were performed using an NVIDIA 1080ti GPU. A python code for model training and prediction is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/omegahh/DeepHiC">https://github.com/omegahh/DeepHiC</ext-link>.</p>
      <p>In order to assess the efficiency of DeepHiC during training, we performed an improved measure called structure similarity index (SSIM) [<xref rid="pcbi.1007287.ref057" ref-type="bibr">57</xref>] to measure the structure similarity between different contact matrices. The SSIM score is calculated by sliding sub-windows between images. The measure for comparison of two identically sized sub-windows, <italic>x</italic> and <italic>y</italic> (from two images) is:
<disp-formula id="pcbi.1007287.e015"><alternatives><graphic xlink:href="pcbi.1007287.e015.jpg" id="pcbi.1007287.e015g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M15"><mml:mi>S</mml:mi><mml:mi>S</mml:mi><mml:mi>I</mml:mi><mml:mi>M</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo><mml:mo>⋅</mml:mo><mml:mo>(</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi><mml:mi>y</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo><mml:mo>⋅</mml:mo><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:math></alternatives></disp-formula>
where mean (<italic>μ</italic>), variance (<italic>σ</italic>), and covariance (<italic>σ</italic><sub><italic>xy</italic></sub>) are computed with a Gaussian filter. They measure the differences of luminance, contrast, and structure between two images, respectively. <italic>C</italic><sub>1</sub>, <italic>C</italic><sub>2</sub> are constants to stabilize the division with a weak denominator. In our experiments, the size of sub-windows and the variance value of Gaussian kernel are set as 11 and 3, respectively. And all compared matrices are rescaled by min-max normalization to same range to eliminate the differences of luminance in order to compare the contrast and structure differences.</p>
    </sec>
    <sec id="sec016">
      <title>Dividing and reconstructing matrices</title>
      <p>We divided the whole Hi-C contact maps into equal-sized square submatrices to be used as model inputs. It reduces the time and memory cost in batch training. The size of submatrices determines the features’ dimension of each sample. Here we used the same size of 0.4 Mb × 0.4 Mb as described in HiCPlus, note that other choices such as 0.3Mb or 0.5Mb is also applicable in our workflow. So, each submatrix contains 40 × 40 = 1600 pixels at 10 kb resolution. As shown in <xref ref-type="fig" rid="pcbi.1007287.g001">Fig 1B</xref>, the intact low-resolution Hi-C matrix was divided into non-overlapping sub-regions, then enhanced sub-regions were predicted from them (with outlier squashed and min-max normalization performed) by the <italic>generator</italic> network of DeepHiC. Finally, the high-resolution sub-matrices predicted were merged into a chromosome-wise Hi-C matrix, as the final enhanced output. Because our model is trained based on the contact maps where two bins &lt; 2Mb genomic distance, we made the genome-wide predictions also on data where two bins &lt; 2Mb.</p>
    </sec>
    <sec id="sec017">
      <title>Identifying chromatin interactions and detecting TAD boundaries</title>
      <p>Chromatin interactions [<xref rid="pcbi.1007287.ref007" ref-type="bibr">7</xref>] are identified using the commonly used software: Fit-Hi-C. We parallelized the software for faster running speed and suitable for our data. The modified code is available in <ext-link ext-link-type="uri" xlink:href="https://github.com/omegahh/pFitHiC">https://github.com/omegahh/pFitHiC</ext-link>. Fit-Hi-C parameters were set as follows: <italic>resolution</italic> = 10<italic>kb</italic>, <italic>lowerbound</italic> = 2, <italic>upperbound</italic> = 120, <italic>passes</italic> = 2, <italic>noOfBins</italic> = 100. Significance was calculated only for intra-chromosome interactions. Since our model’s output ranges from 0 to 1, we converted them to integer by multiplying 255 to be Fit-Hi-C inputs.</p>
      <p>TADs were detected using the insulation score algorithm [<xref rid="pcbi.1007287.ref014" ref-type="bibr">14</xref>] with minor modifications: the width of the window used when calculating insulation score was set to 5 times of Hi-C matrix resolution to better detect the boundaries of finer-domain structures. We computed the delta score using insulation score of 5 nearest loci upstream and of 5 nearest loci downstream. We identified TADs as the genome region between center of 2 adjacent boundaries and regions containing low-coverage bins were excluded.</p>
    </sec>
    <sec id="sec018">
      <title>Measurements for two TAD segmentations</title>
      <p>We investigated the consistency of segmentations formed by different TAD boundaries in the genome. Here we calculated the distance of two segmentations and the corresponding overlap, defined as follows. We denote the two segmentations as <italic>S</italic> and <italic>T</italic>, which are formulated in sets consisting of their split points:
<disp-formula id="pcbi.1007287.e016"><alternatives><graphic xlink:href="pcbi.1007287.e016.jpg" id="pcbi.1007287.e016g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M16"><mml:mtable><mml:mtr><mml:mtd><mml:mi>S</mml:mi><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>}</mml:mo><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>T</mml:mi><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>}</mml:mo><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
where <italic>m</italic>, <italic>n</italic> are numbers of split points. Thus, we could calculate the distance from one split point <italic>s</italic><sub><italic>i</italic></sub> ∈ <italic>S</italic> to segmentation <italic>T</italic>, as follows:
<disp-formula id="pcbi.1007287.e017"><alternatives><graphic xlink:href="pcbi.1007287.e017.jpg" id="pcbi.1007287.e017g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M17"><mml:mi>d</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>T</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="normal">min</mml:mi></mml:mrow><mml:mspace width="0.25em"/><mml:mrow><mml:mi>d</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo><mml:mo>,</mml:mo><mml:mspace width="0.75em"/><mml:mo>∀</mml:mo><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1,2</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></disp-formula></p>
      <p>The overlap of an interval <italic>I</italic><sub><italic>S</italic></sub> = (<italic>s</italic><sub><italic>i</italic></sub>,<italic>s</italic><sub><italic>i</italic>+1</sub>) from <italic>S</italic>, compared with T, could be measured as follows:
<disp-formula id="pcbi.1007287.e018"><alternatives><graphic xlink:href="pcbi.1007287.e018.jpg" id="pcbi.1007287.e018g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M18"><mml:mi>J</mml:mi><mml:mi>I</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>T</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="normal">max</mml:mi></mml:mrow><mml:mrow><mml:mi>J</mml:mi><mml:mi>I</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo><mml:mo>,</mml:mo><mml:mspace width="0.50em"/><mml:mi>w</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi><mml:mi>h</mml:mi><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo><mml:mo>,</mml:mo><mml:mspace width="0.50em"/><mml:mo>∀</mml:mo><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1,2</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></disp-formula></p>
    </sec>
    <sec id="sec019">
      <title>Implementation of baseline models</title>
      <p>For baseline models, we only performed comparisons on data downsampled to 1/16 reads as they commonly used in their study [<xref rid="pcbi.1007287.ref017" ref-type="bibr">17</xref>, <xref rid="pcbi.1007287.ref025" ref-type="bibr">25</xref>, <xref rid="pcbi.1007287.ref026" ref-type="bibr">26</xref>]. The python source code for HiCPlus was obtained from <ext-link ext-link-type="uri" xlink:href="https://github.com/zhangyan32/HiCPlus_pytorch">https://github.com/zhangyan32/HiCPlus_pytorch</ext-link>, together with the codes for data processing and pre-trained model parameter file. We obtained HiCPlus results using the downloaded source code and pre-trained model parameter file. The scheme of data downsampling and reconstructing were implemented according to the description in its paper [<xref rid="pcbi.1007287.ref017" ref-type="bibr">17</xref>]. For Boost-HiC, the python source code was obtained from <ext-link ext-link-type="uri" xlink:href="https://github.com/LeopoldC/Boost-HiC">https://github.com/LeopoldC/Boost-HiC</ext-link> and implemented with <italic>alpha</italic> = 0.2. For HiCNN, we obtained its implementation code from <ext-link ext-link-type="uri" xlink:href="http://dna.cs.miami.edu/HiCNN/">http://dna.cs.miami.edu/HiCNN/</ext-link> and pretrained model parameters from <ext-link ext-link-type="uri" xlink:href="http://dna.cs.miami.edu/HiCNN/checkpoint_files/">http://dna.cs.miami.edu/HiCNN/checkpoint_files/</ext-link>. We used the “HiCNN_16” for experiments for 1/16 downsampled data.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material" id="sec020">
    <title>Supporting information</title>
    <supplementary-material content-type="local-data" id="pcbi.1007287.s001">
      <label>S1 Note</label>
      <caption>
        <title>The setting of colorbar for heatmaps plotting.</title>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pcbi.1007287.s001.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007287.s002">
      <label>S2 Note</label>
      <caption>
        <title>A guide of choosing trained model of DeepHiC.</title>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pcbi.1007287.s002.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007287.s003">
      <label>S1 Fig</label>
      <caption>
        <title>Overview of the architecture of DeepHiC model.</title>
        <p>DeepHiC is a conditional generative adversarial network (cGAN) that contains two separated networks. The generator net (first row) takes low-resolution samples as input and generates the enhanced output. The discriminator net (second row), employed only during the training stage, discriminates real and generated high-resolution data. The objective function of the generator net is the sum of four loss functions: mean squared error (MSE) loss, perceptual loss, total variation (TV) loss, and adversarial (AD) loss, all of which are introduced according to the GAN paradigm. The settings used for convolution layers (blue blocks) are listed in detail in <xref ref-type="supplementary-material" rid="pcbi.1007287.s027">S1 Table</xref> and <xref ref-type="supplementary-material" rid="pcbi.1007287.s028">S2 Table</xref>.</p>
        <p>(TIFF)</p>
      </caption>
      <media xlink:href="pcbi.1007287.s003.tiff">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007287.s004">
      <label>S2 Fig</label>
      <caption>
        <title>SSIM scores in the training process of different downsampled data.</title>
        <p>the SSIM scores in test set increased gradually and converged during the training process.</p>
        <p>(TIFF)</p>
      </caption>
      <media xlink:href="pcbi.1007287.s004.tiff">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007287.s005">
      <label>S3 Fig</label>
      <caption>
        <title>The peak-signal-to-noise ratio (PSNR) score in test set in the training process of different downsampled data.</title>
        <p>The PSNR is derived from MSE, It equals 10 × log<sub>10</sub>(1/<italic>MSE</italic>) in our experiment.</p>
        <p>(TIFF)</p>
      </caption>
      <media xlink:href="pcbi.1007287.s005.tiff">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007287.s006">
      <label>S4 Fig</label>
      <caption>
        <title>Estimation of potential over-fitting in DeepHiC model.</title>
        <p>To study the possible over-fitting issue in our model, we calculated the <italic>generator loss</italic> (<italic>G</italic> loss) during the training process on the training sets (chromosome 1–14) and test sets (chromosome 15–22) in GM12878 cell type. We observe that the loss in training and test sets keep the same trend in the entire training process. (test perform on 1/25 downsampling data)</p>
        <p>(TIFF)</p>
      </caption>
      <media xlink:href="pcbi.1007287.s006.tiff">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007287.s007">
      <label>S5 Fig</label>
      <caption>
        <title>Cross validation of DeepHiC.</title>
        <p>Training on different chromosomes in the GM12878 dataset. SSIM scores are evaluated in remaining chromosomes in GM12878 dataset besides training set. (test perform on 1/25 downsampling data)</p>
        <p>(TIFF)</p>
      </caption>
      <media xlink:href="pcbi.1007287.s007.tiff">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007287.s008">
      <label>S6 Fig</label>
      <caption>
        <title>Training without GAN framework.</title>
        <p>The SSIM scores in test set did not converge when training the generator net without pitting against the discriminator net.</p>
        <p>(TIFF)</p>
      </caption>
      <media xlink:href="pcbi.1007287.s008.tiff">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007287.s009">
      <label>S7 Fig</label>
      <caption>
        <title>Training DeepHiC in IMR90 or K562 cell line data.</title>
        <p><bold>a</bold>) The SSIM scores in test set (chr15-chrX) are approaching nearly 0.9 when training DeepHiC on chr1-chr14 data in the K562 or IMR90 cell line. <bold>b</bold>) Pearson correlation in the same set (chr15-chrX in IMR90) when using trained model from different cell type.</p>
        <p>(TIFF)</p>
      </caption>
      <media xlink:href="pcbi.1007287.s009.tiff">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007287.s010">
      <label>S8 Fig</label>
      <caption>
        <title>Performance in SSIM scores when predict from various downsampled data.</title>
        <p>After training DeepHiC, we evaluate the performance of DeepHiC in enhancing low-resolution data derived from different downsampled ratios. Comparing with the replicated assay in GM12878 cell line, DeepHiC achieved comparative performance in SSIM scores in both training and test set at each downsampling ratio.</p>
        <p>(TIFF)</p>
      </caption>
      <media xlink:href="pcbi.1007287.s010.tiff">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007287.s011">
      <label>S9 Fig</label>
      <caption>
        <title>Performance evaluation in the test set when training 1/16 downsampled data.</title>
        <p>We randomly downsampled the original reads to a 1:16 ratio as low-resolution input, then trained DeepHiC on chromosomes 1–14 and tested it on chromosomes 15–22 (i.e., test set), in GM12878 cell line. As training progressed, the structure similarity index (SSIM) between predicted and real high-resolution data gradually increased and converged on the summit value of 0.9.</p>
        <p>(TIFF)</p>
      </caption>
      <media xlink:href="pcbi.1007287.s011.tiff">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007287.s012">
      <label>S10 Fig</label>
      <caption>
        <title>Enhancements of low-resolution data by DeepHiC in GM12878R.</title>
        <p>Here we present the heatmap of three 1 Mb × 1 Mb (100 bins) sub-regions extracted from chromosomes 16, 17, and 22 from the replicate assay of GM12878 cell line. Colorbar setting: <xref ref-type="supplementary-material" rid="pcbi.1007287.s001">S1 Note</xref>.</p>
        <p>(TIFF)</p>
      </caption>
      <media xlink:href="pcbi.1007287.s012.tiff">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007287.s013">
      <label>S11 Fig</label>
      <caption>
        <title>Enhancements of low-resolution data by DeepHiC in K562.</title>
        <p>Here we present the heatmap of three 1 Mb × 1 Mb (100 bins) sub-regions extracted from chromosomes 16, 17, and 22 from the K562 cell line. Colorbar setting: <xref ref-type="supplementary-material" rid="pcbi.1007287.s001">S1 Note</xref>.</p>
        <p>(TIFF)</p>
      </caption>
      <media xlink:href="pcbi.1007287.s013.tiff">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007287.s014">
      <label>S12 Fig</label>
      <caption>
        <title>Enhancements of low-resolution data by DeepHiC in IMR90.</title>
        <p>Here we present the heatmap of three 1 Mb × 1 Mb (100 bins) sub-regions extracted from chromosomes 16, 17, and 22 from the MR90 cell line. Colorbar setting: <xref ref-type="supplementary-material" rid="pcbi.1007287.s001">S1 Note</xref>.</p>
        <p>(TIFF)</p>
      </caption>
      <media xlink:href="pcbi.1007287.s014.tiff">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007287.s015">
      <label>S13 Fig</label>
      <caption>
        <title>Diagram of How SSIM score between two Hi-C matrices calculated.</title>
        <p>In our experiments, we calculated SSIM of the 1Mb x 1Mb (100 bins x 100 bins) sub-regions at the diagonal as those regions cover the genome distance of interest. We calculate the mean of SSIMs between all 1Mb x 1Mb sub-regions with non-overlap at the diagonal across the entire genome to be the final SSIM score between two large Hi-C contact maps.</p>
        <p>(TIFF)</p>
      </caption>
      <media xlink:href="pcbi.1007287.s015.tiff">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007287.s016">
      <label>S14 Fig</label>
      <caption>
        <title>Genome-wide comparative analysis in SSIM scores.</title>
        <p>Between three types of non-experimental data: 1/16 downsampled, HiCPlus/Boost-HiC/HiCNN-enhanced, and DeepHiC-enhanced data in various cell types. We calculated the SSIM scores of three non-experimental data, as compare to real high-resolution data for all chromosomes.</p>
        <p>(TIFF)</p>
      </caption>
      <media xlink:href="pcbi.1007287.s016.tiff">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007287.s017">
      <label>S15 Fig</label>
      <caption>
        <title>Genome-wide comparative analysis in correlation.</title>
        <p>Between three types of non-experimental data: 1/16 downsampled, HiCPlus/Boost-HiC/HiCNN-enhanced, and DeepHiC-enhanced data in various cell types. We calculated the correlation three non-experimental data, as compare to real high-resolution data for all chromosomes at each genome distance.</p>
        <p>(TIFF)</p>
      </caption>
      <media xlink:href="pcbi.1007287.s017.tiff">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007287.s018">
      <label>S16 Fig</label>
      <caption>
        <title>Profile along the genome of the first eigenvector of correlation maps derived from real high-resolution (experimental), DeepHiC-enhanced, and BoostHiC-enhanced matrices.</title>
        <p>Quantitatively, correlation of DeepHiC and BoostHiC versus experimental are 0.952 and 0.966. And Jaccard indices are 0.</p>
        <p>(TIFF)</p>
      </caption>
      <media xlink:href="pcbi.1007287.s018.tiff">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007287.s019">
      <label>S17 Fig</label>
      <caption>
        <title>Performance of DeepHiC in 1/25 and 1/36 downsampled data (trained in 1/16 downsampled data).</title>
        <p>Correlations in GM12878 cell line when prediction 1/25 (50kb) and 1/36 (60kb) sequencing reads by using the trained model based on 1/16 sequencing reads.</p>
        <p>(TIFF)</p>
      </caption>
      <media xlink:href="pcbi.1007287.s019.tiff">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007287.s020">
      <label>S18 Fig</label>
      <caption>
        <p><bold>Performance of DeepHiC in other cell lines’ data from Rao et al., 2014 a, b)</bold> The performances of DeepHiC in KBM7, NHEK, HUVEC, HMEC, and CH12-LX cell lines, downsampling ratio is 1/16. <bold>c)</bold> Total read counts of 9 datasets (include 8 cell lines, the data of HeLa cell line is not available) from Rao et al., 2014. <bold>d)</bold> Correlations between Hi-C data across different cell types, black numbers represent correlations between two real data. Magenta numbers represent correlations between real data and predicted data (1/16 downsampled). Median correlation: median value of Pearson correlations from 50 kb to 1 Mb genomic distance</p>
        <p>(TIFF)</p>
      </caption>
      <media xlink:href="pcbi.1007287.s020.tiff">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007287.s021">
      <label>S19 Fig</label>
      <caption>
        <title>Performance of DeepHiC in HI-C data prepared using 6-cutter enzyme.</title>
        <p>Performances of correlation and SSIM scores when apply DeepHiC to GM12878 HindIII(&amp;Ncol) Hi-C data (dilution Hi-C, HindIII&amp;NcoI, HIC034-037).</p>
        <p>(TIFF)</p>
      </caption>
      <media xlink:href="pcbi.1007287.s021.tiff">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007287.s022">
      <label>S20 Fig</label>
      <caption>
        <title>The number of significant loci-pairs in corresponding sub-regions in <xref ref-type="fig" rid="pcbi.1007287.g004">Fig 4A</xref> (denoted as I, II, and III).</title>
        <p>(TIFF)</p>
      </caption>
      <media xlink:href="pcbi.1007287.s022.tiff">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007287.s023">
      <label>S21 Fig</label>
      <caption>
        <title>Comparative analyses results of recovering loops in GM12878R/K562/IMR90 cell line data.</title>
        <p>We investigated the correlation of significance matrices (first column), overlap of identified interactions with 0.5 percentile as cutoff (second column) at 100kb to 1Mb genomic distance in the <italic>GM12878R</italic>, <italic>K562</italic>, <italic>IMR90</italic> datasets, together with overlap of identified interactions with different cutoff according to false discovery rate from 0.001 to 0.05 (third column) in those three datasets.</p>
        <p>(TIFF)</p>
      </caption>
      <media xlink:href="pcbi.1007287.s023.tiff">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007287.s024">
      <label>S22 Fig</label>
      <caption>
        <title>Comparative analyses results of recovering TADs in GM12878R/K562/IMR90 cell line data.</title>
        <p>We investigated the performance in detecting TAD boundaries in <italic>GM12878R</italic> (first row), <italic>K562</italic> (second row) and <italic>IMR90</italic> (third row) datasets. ***: p-value &lt; 1x10<sup>-20</sup>, **: p-value &lt; 0.001, Mann Whitney U-test.</p>
        <p>(TIFF)</p>
      </caption>
      <media xlink:href="pcbi.1007287.s024.tiff">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007287.s025">
      <label>S23 Fig</label>
      <caption>
        <title>Properties of Fit-Hi-C identified significant interaction in high-resolution Hi-C data of GM12878 cell line.</title>
        <p><bold>a)</bold> Fraction of significant interactions of which both connected loci contain DNase-seq signal peaks. Error bar: standard deviation. <bold>b)</bold> Fraction of significant interactions anchor loci which are interested with gene promoters. Error bar: standard deviation.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pcbi.1007287.s025.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007287.s026">
      <label>S24 Fig</label>
      <caption>
        <title>Training DeepHiC using low-coverage input as both input and target, similar to an autoencoder.</title>
        <p><bold>a)</bold> When training DeepHiC using a quasi-autoencoder scheme, the trends of SSIM score in test set. <bold>b)</bold> Using different trained manners, the performance of correlations between predicted-GM12878R versus original GM12878 dataset in various Hi-C data.</p>
        <p>(TIFF)</p>
      </caption>
      <media xlink:href="pcbi.1007287.s026.tiff">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007287.s027">
      <label>S1 Table</label>
      <caption>
        <title>Detailed settings for layers in generator network.</title>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pcbi.1007287.s027.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007287.s028">
      <label>S2 Table</label>
      <caption>
        <title>Detailed settings for layers in discriminator network.</title>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pcbi.1007287.s028.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <p>We thank the Aiden Lab, the Wei Xie lab, and ENCODE Consortium for high-quality data.</p>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="pcbi.1007287.ref001">
      <label>1</label>
      <mixed-citation publication-type="journal"><name><surname>Lieberman-Aiden</surname><given-names>E</given-names></name>, <name><surname>Van Berkum</surname><given-names>NL</given-names></name>, <name><surname>Williams</surname><given-names>L</given-names></name>, <name><surname>Imakaev</surname><given-names>M</given-names></name>, <name><surname>Ragoczy</surname><given-names>T</given-names></name>, <name><surname>Telling</surname><given-names>A</given-names></name>, <etal>et al</etal><article-title>Comprehensive mapping of long-range interactions reveals folding principles of the human genome</article-title>. <source>science</source>. <year>2009</year>;<volume>326</volume>(<issue>5950</issue>):<fpage>289</fpage>–<lpage>93</lpage>. <pub-id pub-id-type="doi">10.1126/science.1181369</pub-id><?supplied-pmid 19815776?><pub-id pub-id-type="pmid">19815776</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007287.ref002">
      <label>2</label>
      <mixed-citation publication-type="journal"><name><surname>Dixon</surname><given-names>JR</given-names></name>, <name><surname>Selvaraj</surname><given-names>S</given-names></name>, <name><surname>Yue</surname><given-names>F</given-names></name>, <name><surname>Kim</surname><given-names>A</given-names></name>, <name><surname>Li</surname><given-names>Y</given-names></name>, <name><surname>Shen</surname><given-names>Y</given-names></name>, <etal>et al</etal><article-title>Topological domains in mammalian genomes identified by analysis of chromatin interactions</article-title>. <source>Nature</source>. <year>2012</year>;<volume>485</volume>(<issue>7398</issue>):<fpage>376</fpage><pub-id pub-id-type="doi">10.1038/nature11082</pub-id><?supplied-pmid 22495300?><pub-id pub-id-type="pmid">22495300</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007287.ref003">
      <label>3</label>
      <mixed-citation publication-type="journal"><name><surname>Nora</surname><given-names>EP</given-names></name>, <name><surname>Lajoie</surname><given-names>BR</given-names></name>, <name><surname>Schulz</surname><given-names>EG</given-names></name>, <name><surname>Giorgetti</surname><given-names>L</given-names></name>, <name><surname>Okamoto</surname><given-names>I</given-names></name>, <name><surname>Servant</surname><given-names>N</given-names></name>, <etal>et al</etal><article-title>Spatial partitioning of the regulatory landscape of the X-inactivation centre</article-title>. <source>Nature</source>. <year>2012</year>;<volume>485</volume>(<issue>7398</issue>):<fpage>381</fpage><pub-id pub-id-type="doi">10.1038/nature11049</pub-id><?supplied-pmid 22495304?><pub-id pub-id-type="pmid">22495304</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007287.ref004">
      <label>4</label>
      <mixed-citation publication-type="journal"><name><surname>Rao</surname><given-names>SS</given-names></name>, <name><surname>Huntley</surname><given-names>MH</given-names></name>, <name><surname>Durand</surname><given-names>NC</given-names></name>, <name><surname>Stamenova</surname><given-names>EK</given-names></name>, <name><surname>Bochkov</surname><given-names>ID</given-names></name>, <name><surname>Robinson</surname><given-names>JT</given-names></name>, <etal>et al</etal><article-title>A 3D map of the human genome at kilobase resolution reveals principles of chromatin looping</article-title>. <source>Cell</source>. <year>2014</year>;<volume>159</volume>(<issue>7</issue>):<fpage>1665</fpage>–<lpage>80</lpage>. <pub-id pub-id-type="doi">10.1016/j.cell.2014.11.021</pub-id><?supplied-pmid 25497547?><pub-id pub-id-type="pmid">25497547</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007287.ref005">
      <label>5</label>
      <mixed-citation publication-type="journal"><name><surname>Vian</surname><given-names>L</given-names></name>, <name><surname>Pękowska</surname><given-names>A</given-names></name>, <name><surname>Rao</surname><given-names>SS</given-names></name>, <name><surname>Kieffer-Kwon</surname><given-names>K-R</given-names></name>, <name><surname>Jung</surname><given-names>S</given-names></name>, <name><surname>Baranello</surname><given-names>L</given-names></name>, <etal>et al</etal><article-title>The energetics and physiological impact of cohesin extrusion</article-title>. <source>Cell</source>. <year>2018</year>;<volume>173</volume>(<issue>5</issue>):<fpage>1165</fpage>–<lpage>78. e20</lpage>. <pub-id pub-id-type="doi">10.1016/j.cell.2018.03.072</pub-id><?supplied-pmid 29706548?><pub-id pub-id-type="pmid">29706548</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007287.ref006">
      <label>6</label>
      <mixed-citation publication-type="journal"><name><surname>Durand</surname><given-names>NC</given-names></name>, <name><surname>Shamim</surname><given-names>MS</given-names></name>, <name><surname>Machol</surname><given-names>I</given-names></name>, <name><surname>Rao</surname><given-names>SS</given-names></name>, <name><surname>Huntley</surname><given-names>MH</given-names></name>, <name><surname>Lander</surname><given-names>ES</given-names></name>, <etal>et al</etal><article-title>Juicer provides a one-click system for analyzing loop-resolution Hi-C experiments</article-title>. <source>Cell systems</source>. <year>2016</year>;<volume>3</volume>(<issue>1</issue>):<fpage>95</fpage>–<lpage>8</lpage>. <pub-id pub-id-type="doi">10.1016/j.cels.2016.07.002</pub-id><?supplied-pmid 27467249?><pub-id pub-id-type="pmid">27467249</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007287.ref007">
      <label>7</label>
      <mixed-citation publication-type="journal"><name><surname>Ay</surname><given-names>F</given-names></name>, <name><surname>Bailey</surname><given-names>TL</given-names></name>, <name><surname>Noble</surname><given-names>WS</given-names></name>. <article-title>Statistical confidence estimation for Hi-C data reveals regulatory chromatin contacts</article-title>. <source>Genome research</source>. <year>2014</year>.</mixed-citation>
    </ref>
    <ref id="pcbi.1007287.ref008">
      <label>8</label>
      <mixed-citation publication-type="journal"><name><surname>Mifsud</surname><given-names>B</given-names></name>, <name><surname>Tavares-Cadete</surname><given-names>F</given-names></name>, <name><surname>Young</surname><given-names>AN</given-names></name>, <name><surname>Sugar</surname><given-names>R</given-names></name>, <name><surname>Schoenfelder</surname><given-names>S</given-names></name>, <name><surname>Ferreira</surname><given-names>L</given-names></name>, <etal>et al</etal><article-title>Mapping long-range promoter contacts in human cells with high-resolution capture Hi-C</article-title>. <source>Nature genetics</source>. <year>2015</year>;<volume>47</volume>(<issue>6</issue>):<fpage>598</fpage><pub-id pub-id-type="doi">10.1038/ng.3286</pub-id><?supplied-pmid 25938943?><pub-id pub-id-type="pmid">25938943</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007287.ref009">
      <label>9</label>
      <mixed-citation publication-type="journal"><name><surname>Heinz</surname><given-names>S</given-names></name>, <name><surname>Benner</surname><given-names>C</given-names></name>, <name><surname>Spann</surname><given-names>N</given-names></name>, <name><surname>Bertolino</surname><given-names>E</given-names></name>, <name><surname>Lin</surname><given-names>YC</given-names></name>, <name><surname>Laslo</surname><given-names>P</given-names></name>, <etal>et al</etal><article-title>Simple combinations of lineage-determining transcription factors prime cis-regulatory elements required for macrophage and B cell identities</article-title>. <source>Molecular cell</source>. <year>2010</year>;<volume>38</volume>(<issue>4</issue>):<fpage>576</fpage>–<lpage>89</lpage>. <pub-id pub-id-type="doi">10.1016/j.molcel.2010.05.004</pub-id><?supplied-pmid 20513432?><pub-id pub-id-type="pmid">20513432</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007287.ref010">
      <label>10</label>
      <mixed-citation publication-type="journal"><name><surname>Hwang</surname><given-names>Y-C</given-names></name>, <name><surname>Lin</surname><given-names>C-F</given-names></name>, <name><surname>Valladares</surname><given-names>O</given-names></name>, <name><surname>Malamon</surname><given-names>J</given-names></name>, <name><surname>Kuksa</surname><given-names>PP</given-names></name>, <name><surname>Zheng</surname><given-names>Q</given-names></name>, <etal>et al</etal><article-title>HIPPIE: a high-throughput identification pipeline for promoter interacting enhancer elements</article-title>. <source>Bioinformatics</source>. <year>2014</year>;<volume>31</volume>(<issue>8</issue>):<fpage>1290</fpage>–<lpage>2</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btu801</pub-id><?supplied-pmid 25480377?><pub-id pub-id-type="pmid">25480377</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007287.ref011">
      <label>11</label>
      <mixed-citation publication-type="journal"><name><surname>Lun</surname><given-names>AT</given-names></name>, <name><surname>Smyth</surname><given-names>GK</given-names></name>. <article-title>diffHic: a Bioconductor package to detect differential genomic interactions in Hi-C data</article-title>. <source>BMC bioinformatics</source>. <year>2015</year>;<volume>16</volume>(<issue>1</issue>):<fpage>258</fpage>.<pub-id pub-id-type="pmid">26283514</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007287.ref012">
      <label>12</label>
      <mixed-citation publication-type="journal"><name><surname>Lévy-Leduc</surname><given-names>C</given-names></name>, <name><surname>Delattre</surname><given-names>M</given-names></name>, <name><surname>Mary-Huard</surname><given-names>T</given-names></name>, <name><surname>Robin</surname><given-names>S</given-names></name>. <article-title>Two-dimensional segmentation for analyzing Hi-C data</article-title>. <source>Bioinformatics</source>. <year>2014</year>;<volume>30</volume>(<issue>17</issue>):<fpage>i386</fpage>–<lpage>i92</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btu443</pub-id><?supplied-pmid 25161224?><pub-id pub-id-type="pmid">25161224</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007287.ref013">
      <label>13</label>
      <mixed-citation publication-type="journal"><name><surname>Serra</surname><given-names>F</given-names></name>, <name><surname>Baù</surname><given-names>D</given-names></name>, <name><surname>Filion</surname><given-names>G</given-names></name>, <name><surname>Marti-Renom</surname><given-names>MA</given-names></name>. <article-title>Structural features of the fly chromatin colors revealed by automatic three-dimensional modeling</article-title>. <source>bioRxiv</source>. <year>2016</year>:<fpage>036764</fpage>.</mixed-citation>
    </ref>
    <ref id="pcbi.1007287.ref014">
      <label>14</label>
      <mixed-citation publication-type="journal"><name><surname>Crane</surname><given-names>E</given-names></name>, <name><surname>Bian</surname><given-names>Q</given-names></name>, <name><surname>McCord</surname><given-names>RP</given-names></name>, <name><surname>Lajoie</surname><given-names>BR</given-names></name>, <name><surname>Wheeler</surname><given-names>BS</given-names></name>, <name><surname>Ralston</surname><given-names>EJ</given-names></name>, <etal>et al</etal><article-title>Condensin-driven remodelling of X chromosome topology during dosage compensation</article-title>. <source>Nature</source>. <year>2015</year>;<volume>523</volume>(<issue>7559</issue>):<fpage>240</fpage><pub-id pub-id-type="doi">10.1038/nature14450</pub-id><?supplied-pmid 26030525?><pub-id pub-id-type="pmid">26030525</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007287.ref015">
      <label>15</label>
      <mixed-citation publication-type="journal"><name><surname>Filippova</surname><given-names>D</given-names></name>, <name><surname>Patro</surname><given-names>R</given-names></name>, <name><surname>Duggal</surname><given-names>G</given-names></name>, <name><surname>Kingsford</surname><given-names>C</given-names></name>. <article-title>Identification of alternative topological domains in chromatin</article-title>. <source>Algorithms for Molecular Biology</source>. <year>2014</year>;<volume>9</volume>(<issue>1</issue>):<fpage>14</fpage>.<pub-id pub-id-type="pmid">24868242</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007287.ref016">
      <label>16</label>
      <mixed-citation publication-type="journal"><name><surname>Dixon</surname><given-names>JR</given-names></name>, <name><surname>Jung</surname><given-names>I</given-names></name>, <name><surname>Selvaraj</surname><given-names>S</given-names></name>, <name><surname>Shen</surname><given-names>Y</given-names></name>, <name><surname>Antosiewicz-Bourget</surname><given-names>JE</given-names></name>, <name><surname>Lee</surname><given-names>AY</given-names></name>, <etal>et al</etal><article-title>Chromatin architecture reorganization during stem cell differentiation</article-title>. <source>Nature</source>. <year>2015</year>;<volume>518</volume>(<issue>7539</issue>):<fpage>331</fpage><pub-id pub-id-type="doi">10.1038/nature14222</pub-id><?supplied-pmid 25693564?><pub-id pub-id-type="pmid">25693564</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007287.ref017">
      <label>17</label>
      <mixed-citation publication-type="journal"><name><surname>Zhang</surname><given-names>Y</given-names></name>, <name><surname>An</surname><given-names>L</given-names></name>, <name><surname>Xu</surname><given-names>J</given-names></name>, <name><surname>Zhang</surname><given-names>B</given-names></name>, <name><surname>Zheng</surname><given-names>WJ</given-names></name>, <name><surname>Hu</surname><given-names>M</given-names></name>, <etal>et al</etal><article-title>Enhancing Hi-C data resolution with deep convolutional neural network HiCPlus</article-title>. <source>Nature communications</source>. <year>2018</year>;<volume>9</volume>(<issue>1</issue>):<fpage>750</fpage><pub-id pub-id-type="doi">10.1038/s41467-018-03113-2</pub-id><?supplied-pmid 29467363?><pub-id pub-id-type="pmid">29467363</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007287.ref018">
      <label>18</label>
      <mixed-citation publication-type="journal"><name><surname>Jin</surname><given-names>F</given-names></name>, <name><surname>Li</surname><given-names>Y</given-names></name>, <name><surname>Dixon</surname><given-names>JR</given-names></name>, <name><surname>Selvaraj</surname><given-names>S</given-names></name>, <name><surname>Ye</surname><given-names>Z</given-names></name>, <name><surname>Lee</surname><given-names>AY</given-names></name>, <etal>et al</etal><article-title>A high-resolution map of the three-dimensional chromatin interactome in human cells</article-title>. <source>Nature</source>. <year>2013</year>;<volume>503</volume>(<issue>7475</issue>):<fpage>290</fpage><pub-id pub-id-type="doi">10.1038/nature12644</pub-id><?supplied-pmid 24141950?><pub-id pub-id-type="pmid">24141950</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007287.ref019">
      <label>19</label>
      <mixed-citation publication-type="journal"><name><surname>Schmitt</surname><given-names>AD</given-names></name>, <name><surname>Hu</surname><given-names>M</given-names></name>, <name><surname>Ren</surname><given-names>B</given-names></name>. <article-title>Genome-wide mapping and analysis of chromosome architecture</article-title>. <source>Nature reviews Molecular cell biology</source>. <year>2016</year>;<volume>17</volume>(<issue>12</issue>):<fpage>743</fpage><pub-id pub-id-type="doi">10.1038/nrm.2016.104</pub-id><?supplied-pmid 27580841?><pub-id pub-id-type="pmid">27580841</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007287.ref020">
      <label>20</label>
      <mixed-citation publication-type="journal"><name><surname>Berlivet</surname><given-names>S</given-names></name>, <name><surname>Paquette</surname><given-names>D</given-names></name>, <name><surname>Dumouchel</surname><given-names>A</given-names></name>, <name><surname>Langlais</surname><given-names>D</given-names></name>, <name><surname>Dostie</surname><given-names>J</given-names></name>, <source>Kmita MJPg.</source><article-title>Clustering of tissue-specific sub-TADs accompanies the regulation of HoxA genes in developing limbs</article-title>. <source>PLoS genetics</source>. <year>2013</year>;<volume>9</volume>(<issue>12</issue>):<fpage>e1004018</fpage>.</mixed-citation>
    </ref>
    <ref id="pcbi.1007287.ref021">
      <label>21</label>
      <mixed-citation publication-type="journal"><name><surname>Phillips-Cremins</surname><given-names>JE</given-names></name>, <name><surname>Sauria</surname><given-names>ME</given-names></name>, <name><surname>Sanyal</surname><given-names>A</given-names></name>, <name><surname>Gerasimova</surname><given-names>TI</given-names></name>, <name><surname>Lajoie</surname><given-names>BR</given-names></name>, <name><surname>Bell</surname><given-names>JS</given-names></name>, <etal>et al</etal><article-title>Architectural protein subclasses shape 3D organization of genomes during lineage commitment</article-title>. <source>Cell</source>. <year>2013</year>;<volume>153</volume>(<issue>6</issue>):<fpage>1281</fpage>–<lpage>95</lpage>. <pub-id pub-id-type="doi">10.1016/j.cell.2013.04.053</pub-id><?supplied-pmid 23706625?><pub-id pub-id-type="pmid">23706625</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007287.ref022">
      <label>22</label>
      <mixed-citation publication-type="journal"><name><surname>Forcato</surname><given-names>M</given-names></name>, <name><surname>Nicoletti</surname><given-names>C</given-names></name>, <name><surname>Pal</surname><given-names>K</given-names></name>, <name><surname>Livi</surname><given-names>CM</given-names></name>, <name><surname>Ferrari</surname><given-names>F</given-names></name>, <name><surname>Bicciato</surname><given-names>S</given-names></name>. <article-title>Comparison of computational methods for Hi-C data analysis</article-title>. <source>Nature methods</source>. <year>2017</year>;<volume>14</volume>(<issue>7</issue>):<fpage>679</fpage><pub-id pub-id-type="doi">10.1038/nmeth.4325</pub-id><?supplied-pmid 28604721?><pub-id pub-id-type="pmid">28604721</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007287.ref023">
      <label>23</label>
      <mixed-citation publication-type="journal"><name><surname>Wang</surname><given-names>M</given-names></name>, <name><surname>Tai</surname><given-names>C</given-names></name>, <name><surname>E</surname><given-names>W</given-names></name>, <name><surname>Wei</surname><given-names>L</given-names></name>. <article-title>DeFine: deep convolutional neural networks accurately quantify intensities of transcription factor-DNA binding and facilitate evaluation of functional non-coding variants</article-title>. <source>Nucleic acids research</source>. <year>2018</year>;<volume>46</volume>(<issue>11</issue>):<fpage>e69</fpage>–<lpage>e</lpage>. <pub-id pub-id-type="doi">10.1093/nar/gky215</pub-id><?supplied-pmid 29617928?><pub-id pub-id-type="pmid">29617928</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007287.ref024">
      <label>24</label>
      <mixed-citation publication-type="journal"><name><surname>Dong</surname><given-names>C</given-names></name>, <name><surname>Loy</surname><given-names>CC</given-names></name>, <name><surname>He</surname><given-names>K</given-names></name>, <name><surname>Tang</surname><given-names>X</given-names></name>, editors. <article-title>Learning a deep convolutional network for image super-resolution</article-title>. <source>European conference on computer vision</source>; <year>2014</year>: <collab>Springer</collab>.</mixed-citation>
    </ref>
    <ref id="pcbi.1007287.ref025">
      <label>25</label>
      <mixed-citation publication-type="journal"><name><surname>Carron</surname><given-names>L</given-names></name>, <name><surname>Morlot</surname><given-names>J</given-names></name>, <name><surname>Matthys</surname><given-names>V</given-names></name>, <name><surname>Lesne</surname><given-names>A</given-names></name>, <name><surname>Mozziconacci</surname><given-names>J</given-names></name>. <article-title>Boost-HiC: Computational enhancement of long-range contacts in chromosomal contact maps</article-title>. <source>Bioinformatics (Oxford, England)</source>. <year>2019</year>.</mixed-citation>
    </ref>
    <ref id="pcbi.1007287.ref026">
      <label>26</label>
      <mixed-citation publication-type="journal"><name><surname>Liu</surname><given-names>T</given-names></name>, <name><surname>Wang</surname><given-names>Z</given-names></name>. <article-title>HiCNN: a very deep convolutional neural network to better enhance the resolution of Hi-C data</article-title>. <source>Bioinformatics</source>. <year>2019</year>.</mixed-citation>
    </ref>
    <ref id="pcbi.1007287.ref027">
      <label>27</label>
      <mixed-citation publication-type="journal"><name><surname>Mathieu</surname><given-names>M</given-names></name>, <name><surname>Couprie</surname><given-names>C</given-names></name>, <name><surname>LeCun</surname><given-names>Y</given-names></name>. <source>Deep multi-scale video prediction beyond mean square error</source>. arXiv preprint arXiv:151105440. <year>2015</year>.</mixed-citation>
    </ref>
    <ref id="pcbi.1007287.ref028">
      <label>28</label>
      <mixed-citation publication-type="journal"><name><surname>Eldan</surname><given-names>R</given-names></name>, <name><surname>Shamir</surname><given-names>O</given-names></name>, editors. <article-title>The power of depth for feedforward neural networks</article-title>. <source>Conference on learning theory</source>; <year>2016</year>.</mixed-citation>
    </ref>
    <ref id="pcbi.1007287.ref029">
      <label>29</label>
      <mixed-citation publication-type="journal"><name><surname>LeCun</surname><given-names>Y</given-names></name>, <name><surname>Bengio</surname><given-names>Y</given-names></name>, <name><surname>Hinton</surname><given-names>G</given-names></name>. <source>Deep learning. nature</source>. <year>2015</year>;<volume>521</volume>(<issue>7553</issue>):<fpage>436</fpage><pub-id pub-id-type="doi">10.1038/nature14539</pub-id><?supplied-pmid 26017442?><pub-id pub-id-type="pmid">26017442</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007287.ref030">
      <label>30</label>
      <mixed-citation publication-type="journal"><name><surname>Hein</surname><given-names>M</given-names></name>, <name><surname>Maier</surname><given-names>M</given-names></name>, <article-title>editors. Manifold denoising</article-title>. <source>Advances in neural information processing systems</source>; <year>2007</year>.</mixed-citation>
    </ref>
    <ref id="pcbi.1007287.ref031">
      <label>31</label>
      <mixed-citation publication-type="journal"><name><surname>Gong</surname><given-names>D</given-names></name>, <name><surname>Sha</surname><given-names>F</given-names></name>, <name><surname>Medioni</surname><given-names>G</given-names></name>, <article-title>editors. Locally linear denoising on image manifolds</article-title>. <source>Proceedings of the Thirteenth International Conference on Artificial Intelligence and Statistics</source>; <year>2010</year>.</mixed-citation>
    </ref>
    <ref id="pcbi.1007287.ref032">
      <label>32</label>
      <mixed-citation publication-type="journal"><name><surname>Goodfellow</surname><given-names>I</given-names></name>, <name><surname>Pouget-Abadie</surname><given-names>J</given-names></name>, <name><surname>Mirza</surname><given-names>M</given-names></name>, <name><surname>Xu</surname><given-names>B</given-names></name>, <name><surname>Warde-Farley</surname><given-names>D</given-names></name>, <name><surname>Ozair</surname><given-names>S</given-names></name>, <etal>et al</etal>, <article-title>editors. Generative adversarial nets</article-title>. <source>Advances in neural information processing systems</source>; <year>2014</year>.</mixed-citation>
    </ref>
    <ref id="pcbi.1007287.ref033">
      <label>33</label>
      <mixed-citation publication-type="journal"><name><surname>Mirza</surname><given-names>M</given-names></name>, <name><surname>Osindero</surname><given-names>S</given-names></name>. <source>Conditional generative adversarial nets</source>. arXiv preprint arXiv:14111784. <year>2014</year>.</mixed-citation>
    </ref>
    <ref id="pcbi.1007287.ref034">
      <label>34</label>
      <mixed-citation publication-type="journal"><name><surname>Li</surname><given-names>C</given-names></name>, <name><surname>Wand</surname><given-names>M</given-names></name>, <article-title>editors. Combining markov random fields and convolutional neural networks for image synthesis</article-title>. <source>Proceedings of the IEEE Conference on Computer Vision and Pattern Recognition</source>; <year>2016</year>.</mixed-citation>
    </ref>
    <ref id="pcbi.1007287.ref035">
      <label>35</label>
      <mixed-citation publication-type="book"><name><surname>Ledig</surname><given-names>C</given-names></name>, <name><surname>Theis</surname><given-names>L</given-names></name>, <name><surname>Huszár</surname><given-names>F</given-names></name>, <name><surname>Caballero</surname><given-names>J</given-names></name>, <name><surname>Cunningham</surname><given-names>A</given-names></name>, <name><surname>Acosta</surname><given-names>A</given-names></name>, <etal>et al</etal>, editors. <chapter-title>Photo-realistic single image super-resolution using a generative adversarial network</chapter-title><source>2017 IEEE Conference on Computer Vision and Pattern Recognition (CVPR)</source>; <year>2017</year>: <collab>IEEE</collab>.</mixed-citation>
    </ref>
    <ref id="pcbi.1007287.ref036">
      <label>36</label>
      <mixed-citation publication-type="journal"><name><surname>He</surname><given-names>K</given-names></name>, <name><surname>Zhang</surname><given-names>X</given-names></name>, <name><surname>Ren</surname><given-names>S</given-names></name>, <name><surname>Sun</surname><given-names>J</given-names></name>, <article-title>editors. Deep residual learning for image recognition</article-title>. <source>Proceedings of the IEEE conference on computer vision and pattern recognition</source>; <year>2016</year>.</mixed-citation>
    </ref>
    <ref id="pcbi.1007287.ref037">
      <label>37</label>
      <mixed-citation publication-type="book"><name><surname>Johnson</surname><given-names>J</given-names></name>, <name><surname>Alahi</surname><given-names>A</given-names></name>, <name><surname>Fei-Fei</surname><given-names>L</given-names></name>, editors. <chapter-title>Perceptual losses for real-time style transfer and super-resolution</chapter-title><source>European Conference on Computer Vision</source>; <year>2016</year>: <collab>Springer</collab>.</mixed-citation>
    </ref>
    <ref id="pcbi.1007287.ref038">
      <label>38</label>
      <mixed-citation publication-type="journal"><name><surname>Zhao</surname><given-names>H</given-names></name>, <name><surname>Gallo</surname><given-names>O</given-names></name>, <name><surname>Frosio</surname><given-names>I</given-names></name>, <name><surname>Kautz</surname><given-names>J</given-names></name>. <article-title>Loss functions for image restoration with neural networks</article-title>. <source>IEEE Transactions on Computational Imaging</source>. <year>2017</year>;<volume>3</volume>(<issue>1</issue>):<fpage>47</fpage>–<lpage>57</lpage>.</mixed-citation>
    </ref>
    <ref id="pcbi.1007287.ref039">
      <label>39</label>
      <mixed-citation publication-type="journal"><name><surname>Mahendran</surname><given-names>A</given-names></name>, <name><surname>Vedaldi</surname><given-names>A</given-names></name>. <article-title>Visualizing deep convolutional neural networks using natural pre-images</article-title>. <source>International Journal of Computer Vision</source>. <year>2016</year>;<volume>120</volume>(<issue>3</issue>):<fpage>233</fpage>–<lpage>55</lpage>.</mixed-citation>
    </ref>
    <ref id="pcbi.1007287.ref040">
      <label>40</label>
      <mixed-citation publication-type="journal"><name><surname>Du</surname><given-names>Z</given-names></name>, <name><surname>Zheng</surname><given-names>H</given-names></name>, <name><surname>Huang</surname><given-names>B</given-names></name>, <name><surname>Ma</surname><given-names>R</given-names></name>, <name><surname>Wu</surname><given-names>J</given-names></name>, <name><surname>Zhang</surname><given-names>X</given-names></name>, <etal>et al</etal><article-title>Allelic reprogramming of 3D chromatin architecture during early mammalian development</article-title>. <source>Nature</source>. <year>2017</year>;<volume>547</volume>(<issue>7662</issue>):<fpage>232</fpage><pub-id pub-id-type="doi">10.1038/nature23263</pub-id><?supplied-pmid 28703188?><pub-id pub-id-type="pmid">28703188</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007287.ref041">
      <label>41</label>
      <mixed-citation publication-type="journal"><name><surname>Weintraub</surname><given-names>AS</given-names></name>, <name><surname>Li</surname><given-names>CH</given-names></name>, <name><surname>Zamudio</surname><given-names>AV</given-names></name>, <name><surname>Sigova</surname><given-names>AA</given-names></name>, <name><surname>Hannett</surname><given-names>NM</given-names></name>, <name><surname>Day</surname><given-names>DS</given-names></name>, <etal>et al</etal><article-title>YY1 is a structural regulator of enhancer-promoter loops</article-title>. <source>Cell</source>. <year>2017</year>;<volume>171</volume>(<issue>7</issue>):<fpage>1573</fpage>–<lpage>88. e28</lpage>. <pub-id pub-id-type="doi">10.1016/j.cell.2017.11.008</pub-id><?supplied-pmid 29224777?><pub-id pub-id-type="pmid">29224777</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007287.ref042">
      <label>42</label>
      <mixed-citation publication-type="journal"><name><surname>Quinlan</surname><given-names>AR</given-names></name>, <name><surname>Hall</surname><given-names>IM</given-names></name>. <article-title>BEDTools: a flexible suite of utilities for comparing genomic features</article-title>. <source>Bioinformatics</source>. <year>2010</year>;<volume>26</volume>(<issue>6</issue>):<fpage>841</fpage>–<lpage>2</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btq033</pub-id><?supplied-pmid 20110278?><pub-id pub-id-type="pmid">20110278</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007287.ref043">
      <label>43</label>
      <mixed-citation publication-type="journal"><name><surname>Rowley</surname><given-names>MJ</given-names></name>, <name><surname>Corces</surname><given-names>VG</given-names></name>. <article-title>Organizational principles of 3D genome architecture</article-title>. <source>Nature Reviews Genetics</source>. <year>2018</year>:<fpage>1</fpage>.</mixed-citation>
    </ref>
    <ref id="pcbi.1007287.ref044">
      <label>44</label>
      <mixed-citation publication-type="journal"><name><surname>Knight</surname><given-names>PA</given-names></name>, <name><surname>Ruiz</surname><given-names>D</given-names></name>. <article-title>A fast algorithm for matrix balancing</article-title>. <source>IMA Journal of Numerical Analysis</source>. <year>2013</year>;<volume>33</volume>(<issue>3</issue>):<fpage>1029</fpage>–<lpage>47</lpage>.</mixed-citation>
    </ref>
    <ref id="pcbi.1007287.ref045">
      <label>45</label>
      <mixed-citation publication-type="journal"><name><surname>Al Shalabi</surname><given-names>L</given-names></name>, <name><surname>Shaaban</surname><given-names>Z</given-names></name>, editors. <article-title>Normalization as a preprocessing engine for data mining and the approach of preference matrix. 2006</article-title><source>International Conference on Dependability of Computer Systems</source>; <year>2006</year>: <collab>IEEE</collab>.</mixed-citation>
    </ref>
    <ref id="pcbi.1007287.ref046">
      <label>46</label>
      <mixed-citation publication-type="journal"><name><surname>Ioffe</surname><given-names>S</given-names></name>, <name><surname>Szegedy</surname><given-names>C</given-names></name>. <article-title>Batch normalization: Accelerating deep network training by reducing internal covariate shift.</article-title> arXiv preprint arXiv:150203167. <year>2015</year>.</mixed-citation>
    </ref>
    <ref id="pcbi.1007287.ref047">
      <label>47</label>
      <mixed-citation publication-type="journal"><name><surname>Gross</surname><given-names>S</given-names></name>, <name><surname>Wilber</surname><given-names>MJFAR</given-names></name>. <article-title>Training and investigating residual nets</article-title>. <source>Facebook AI Research</source>. <year>2016</year>.</mixed-citation>
    </ref>
    <ref id="pcbi.1007287.ref048">
      <label>48</label>
      <mixed-citation publication-type="journal"><name><surname>Ramachandran</surname><given-names>P</given-names></name>, <name><surname>Zoph</surname><given-names>B</given-names></name>, <name><surname>Le</surname><given-names>QV</given-names></name>. <article-title>Searching for activation functions</article-title>. arXiv preprint arXiv:171005941. <year>2017</year>.</mixed-citation>
    </ref>
    <ref id="pcbi.1007287.ref049">
      <label>49</label>
      <mixed-citation publication-type="journal"><name><surname>Ramachandran</surname><given-names>P</given-names></name>, <name><surname>Zoph</surname><given-names>B</given-names></name>, <name><surname>Le</surname><given-names>QV</given-names></name>. <article-title>Swish: a self-gated activation function</article-title>. arXiv preprint arXiv:171005941. <year>2017</year>.</mixed-citation>
    </ref>
    <ref id="pcbi.1007287.ref050">
      <label>50</label>
      <mixed-citation publication-type="journal"><name><surname>Simonyan</surname><given-names>K</given-names></name>, <name><surname>Zisserman</surname><given-names>A</given-names></name>. <article-title>Very deep convolutional networks for large-scale image recognition</article-title>. arXiv preprint arXiv:14091556. <year>2014</year>.</mixed-citation>
    </ref>
    <ref id="pcbi.1007287.ref051">
      <label>51</label>
      <mixed-citation publication-type="journal"><name><surname>Arjovsky</surname><given-names>M</given-names></name>, <name><surname>Chintala</surname><given-names>S</given-names></name>, <name><surname>Bottou</surname><given-names>L</given-names></name>. <article-title>Wasserstein gan</article-title>. arXiv preprint arXiv:170107875. <year>2017</year>.</mixed-citation>
    </ref>
    <ref id="pcbi.1007287.ref052">
      <label>52</label>
      <mixed-citation publication-type="journal"><name><surname>Gulrajani</surname><given-names>I</given-names></name>, <name><surname>Ahmed</surname><given-names>F</given-names></name>, <name><surname>Arjovsky</surname><given-names>M</given-names></name>, <name><surname>Dumoulin</surname><given-names>V</given-names></name>, <name><surname>Courville</surname><given-names>AC</given-names></name>, editors. <article-title>Improved training of wasserstein gans</article-title>. <source>Advances in Neural Information Processing Systems</source>; <year>2017</year>.</mixed-citation>
    </ref>
    <ref id="pcbi.1007287.ref053">
      <label>53</label>
      <mixed-citation publication-type="other">Zhang L, Zhang L, Mou X, Zhang D, editors. A comprehensive evaluation of full reference image quality assessment algorithms. Image Processing (ICIP), 2012 19th IEEE International Conference on; 2012: IEEE.</mixed-citation>
    </ref>
    <ref id="pcbi.1007287.ref054">
      <label>54</label>
      <mixed-citation publication-type="journal"><name><surname>Gatys</surname><given-names>LA</given-names></name>, <name><surname>Ecker</surname><given-names>AS</given-names></name>, <name><surname>Bethge</surname><given-names>M</given-names></name>. <source>A neural algorithm of artistic style</source>. arXiv preprint arXiv:150806576. <year>2015</year>.</mixed-citation>
    </ref>
    <ref id="pcbi.1007287.ref055">
      <label>55</label>
      <mixed-citation publication-type="journal"><name><surname>Paszke</surname><given-names>A</given-names></name>, <name><surname>Gross</surname><given-names>S</given-names></name>, <name><surname>Chintala</surname><given-names>S</given-names></name>, <name><surname>Chanan</surname><given-names>G</given-names></name>, <name><surname>Yang</surname><given-names>E</given-names></name>, <name><surname>DeVito</surname><given-names>Z</given-names></name>, <etal>et al</etal><article-title>Automatic differentiation in pytorch</article-title>. <source>NIPS Autodiff Workshop</source>. <year>2017</year>.</mixed-citation>
    </ref>
    <ref id="pcbi.1007287.ref056">
      <label>56</label>
      <mixed-citation publication-type="journal"><name><surname>Kingma</surname><given-names>DP</given-names></name>, <name><surname>Ba</surname><given-names>J</given-names></name>. <source>Adam: A method for stochastic optimization</source>. arXiv preprint arXiv:14126980. <year>2014</year>.</mixed-citation>
    </ref>
    <ref id="pcbi.1007287.ref057">
      <label>57</label>
      <mixed-citation publication-type="journal"><name><surname>Wang</surname><given-names>Z</given-names></name>, <name><surname>Bovik</surname><given-names>AC</given-names></name>, <name><surname>Sheikh</surname><given-names>HR</given-names></name>, <name><surname>Simoncelli</surname><given-names>EP</given-names></name>. <article-title>Image quality assessment: from error visibility to structural similarity</article-title>. <source>IEEE transactions on image processing</source>. <year>2004</year>;<volume>13</volume>(<issue>4</issue>):<fpage>600</fpage>–<lpage>12</lpage>. <pub-id pub-id-type="doi">10.1109/tip.2003.819861</pub-id><?supplied-pmid 15376593?><pub-id pub-id-type="pmid">15376593</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
<sub-article id="pcbi.1007287.r001" article-type="aggregated-review-documents">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1007287.r001</article-id>
    <title-group>
      <article-title>Decision Letter 0</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Zhang</surname>
          <given-names>Weixiong</given-names>
        </name>
        <role>Deputy Editor</role>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ay</surname>
          <given-names>Ferhat</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2020 Zhang, Ay</copyright-statement>
      <copyright-year>2020</copyright-year>
      <copyright-holder>Zhang, Ay</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article id="rel-obj001" ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1007287" related-article-type="reviewed-article"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>0</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">29 Sep 2019</named-content>
    </p>
    <p>Dear Dr Bo,</p>
    <p>Thank you very much for submitting your manuscript 'DeepHiC: A Generative Adversarial Network for Enhancing Hi-C Data Resolution' for review by PLOS Computational Biology. Your manuscript has been fully evaluated by the PLOS Computational Biology editorial team and in this case also by independent peer reviewers. The reviewers appreciated the attention to an important problem, but raised some substantial concerns about the manuscript as it currently stands. While your manuscript cannot be accepted in its present form, we are willing to consider a revised version in which the issues raised by the reviewers have been adequately addressed. We cannot, of course, promise publication at that time.</p>
    <p>Please note while forming your response, if your article is accepted, you may have the opportunity to make the peer review history publicly available. The record will include editor decision letters (with reviews) and your responses to reviewer comments. If eligible, we will contact you to opt in or out.</p>
    <p>Your revisions should address the specific points made by each reviewer. Please return the revised version within the next 60 days. If you anticipate any delay in its return, we ask that you let us know the expected resubmission date by email at <email>ploscompbiol@plos.org</email>. Revised manuscripts received beyond 60 days may require evaluation and peer review similar to that applied to newly submitted manuscripts.</p>
    <p>In addition, when you are ready to resubmit, please be prepared to provide the following:</p>
    <p>(1) A detailed list of your responses to the review comments and the changes you have made in the manuscript. We require a file of this nature before your manuscript is passed back to the editors.</p>
    <p>(2) A copy of your manuscript with the changes highlighted (encouraged). We encourage authors, if possible to show clearly where changes have been made to their manuscript e.g. by highlighting text.</p>
    <p>(3) A striking still image to accompany your article (optional). If the image is judged to be suitable by the editors, it may be featured on our website and might be chosen as the issue image for that month. These square, high-quality images should be accompanied by a short caption. Please note as well that there should be no copyright restrictions on the use of the image, so that it can be published under the Open-Access license and be subject only to appropriate attribution.</p>
    <p>Before you resubmit your manuscript, please consult our Submission Checklist to ensure your manuscript is formatted correctly for PLOS Computational Biology: <ext-link ext-link-type="uri" xlink:href="http://www.ploscompbiol.org/static/checklist.action">http://www.ploscompbiol.org/static/checklist.action</ext-link>. Some key points to remember are:</p>
    <p>- Figures uploaded separately as TIFF or EPS files (if you wish, your figures may remain in your main manuscript file in addition).</p>
    <p>- Supporting Information uploaded as separate files, titled Dataset, Figure, Table, Text, Protocol, Audio, or Video.</p>
    <p>- Funding information in the 'Financial Disclosure' box in the online system.</p>
    <p>While revising your submission, please upload your figure files to the Preflight Analysis and Conversion Engine (PACE) digital diagnostic tool, <ext-link ext-link-type="uri" xlink:href="https://pacev2.apexcovantage.com">https://pacev2.apexcovantage.com</ext-link> PACE helps ensure that figures meet PLOS requirements. To use PACE, you must first register as a user. Then, login and navigate to the UPLOAD tab, where you will find detailed instructions on how to use the tool. If you encounter any issues or have any questions when using PACE, please email us at <email>figures@plos.org</email>.</p>
    <p>To enhance the reproducibility of your results, we recommend that you deposit your laboratory protocols in protocols.io, where a protocol can be assigned its own identifier (DOI) such that it can be cited independently in the future. For instructions see <ext-link ext-link-type="uri" xlink:href="http://journals.plos.org/ploscompbiol/s/submission-guidelines#loc-materials-and-methods">here</ext-link>. </p>
    <p>We are sorry that we cannot be more positive about your manuscript at this stage, but if you have any concerns or questions, please do not hesitate to contact us.</p>
    <p>Sincerely,</p>
    <p>Ferhat Ay, Ph.D</p>
    <p>Associate Editor</p>
    <p>PLOS Computational Biology</p>
    <p>Weixiong Zhang</p>
    <p>Deputy Editor</p>
    <p>PLOS Computational Biology</p>
    <p>A link appears below if there are any accompanying review attachments. If you believe any reviews to be missing, please contact <email>ploscompbiol@plos.org</email> immediately:</p>
    <p>[LINK]</p>
    <p>Reviewer's Responses to Questions</p>
    <p>
      <bold>Comments to the Authors:</bold>
    </p>
    <p>
      <bold>Please note here if the review is uploaded as an attachment.</bold>
    </p>
    <p>Reviewer #1: The authors present a method, named DeepHiC, that aims to increase the effective sequencing depth of Hi-C experiments. The method relies on a pair of neural networks that are trained in an adversarial manner similar to image super-resolution. While the paper is very clearly written and easy to follow, there are several critical issues that should be addressed. Further, while the authors demonstrate in several contexts that DeepHiCs outperforms previous work, the manuscript may benefit from a further discussion of the ramifications of these improvements.</p>
    <p>Major</p>
    <p>- While the general problem of increasing the effective sequencing depth of Hi-C experiments is important, the specific formulation considered by the authors is problematic. Specifically, it will never be the case that one has high resolution data for a few chromosomes and needs to improve the quality of the remainder (the cross-chromosomal setting). Rather, a user would like a model that had been trained on high quality data from one cell type and could then be used to improve the quality of other cell types (the cross-cell type setting). This distinction is important because, in the cross-cell type setting, a strong baseline is simply using the high resolution contact map from the cell type used to train the model. The Hi-C+ paper addresses this setting explicitly.</p>
    <p>- The authors should clarify what precisely constituted the ground truth labels. Specifically, was the Hi-C data that had outliers removed and then min-max scaled used solely for training, or was it also considered to be the ground truth? Considering these transformed values to be the ground truth would be unfair to the competing models that had been pre-trained on data sets which were processed in a different manner. Supplementary Note 1 suggests that the output from the models are not converted back to the original space because their ranges differ, with DeepHiC ranging from 0-1, and other methods ranging from 0-100. Further, the output from the webserver is between 0 and 1. It is okay for DeepHiC to be trained using data processed in a different manner than other approaches, but all approaches should be evaluated on the original Hi-C counts to ensure fairness. Additionally, because most outliers tend to occur on at low genomic distances, squashing these outliers only for DeepHiC may help explain why it outperforms the other models by so much at low genomic distances.</p>
    <p>- It is unclear that performing better than an experimental replicate by such a large margin across all genomic distances is a reasonable result. The authors should comment on what such a result means and why there is such large variance between replicates. Generally one would think of an experimental replicate as almost an upper bound of performance. This result suggests that it is significantly better to use DeepHiC on a HiC map with low sequencing depth than to perform the actual high sequencing depth experiment. This may be the actual result, but it is a significant claim and should have more supporting evidence.</p>
    <p>- When a researcher has a Hi-C map with moderate coverage, they will likely want to know by what factor they should improve the effective coverage of that map in order to discover various features of chromatin architecture. For example, should they use a model that improves coverage by 100x (by training using 1% of the reads) or only by 16x (by training using ~6% of the reads)? Is it always better to use a model that improves coverage the most, or does improvement plateau after a certain amount of boost? It would be useful to readers if the authors could provide guidance on which model is appropriate in which setting, preferably by showing the performance on downstream tasks of models trained to boost coverage by different amounts.</p>
    <p>Minor</p>
    <p>- The webserver did not work when tried</p>
    <p>- An important distinction that should be investigated is whether the contact maps yielded by DeepHiC are better because they are effectively higher sequencing depth or because the generative network simply cleans the data. This question could be answered by training a model in the same manner as DeepHiC, but having the target be the same as the input, similar to an autoencoder. This model would demonstrate the performance one gets from cleaning the data. Thus, any improvement that DeepHiC has over it could reasonably be attributed to the importance of a higher sequencing depth.</p>
    <p>- The authors clearly describe the architecture, hyperparameters, and composition of loss functions of the models that compose DeepHiC. However, this naturally leads to the question of how such were determined. While it is not necessary for the authors to perform grid-search using a validation set, they should at least comment on how such were determined and clarify that they were not determined based on performance on the test set.</p>
    <p>- The SSIM score is difficult to interpret as the primary evaluation metric. While the authors soundly reason that using MSE as the objective function during training may yield overly smooth predictions, there is no reason not to use it to evaluate trained models, particularly because it is much more interpretable to most readers.</p>
    <p>- It is unclear how predictions were made in a genome-wide fashion. Was a cross-validation approach used, as alluded to in the methods? This should be explicitly stated in the text and include the number of folds. Similarly, in the final results section, the data set used to train the DeepHiC model should be briefly described.</p>
    <p>- The term "(q-value &lt; 0.5-percentile)" is difficult to parse. Was it a q-value &lt; 0.5 that was used, or were the bottom 0.5% of q-values used?</p>
    <p>Reviewer #2: Review is uploaded as an attachment.</p>
    <p>Reviewer #3: Hong, Jiang et al in the manuscript "DeepHiC: A Generative Adversarial Network for Enhancing Hi-C Data Resolution" implement a generative adversarial network that interpolates low resolution HiC maps to produce higher-resolution maps. Their implementation offers some quantitative improvements over previously published methods. Unfortunately the manuscript does not offer sufficient biological or methodological insight to justify publication in this journal. Their success in interpolating the data confirm the low amount of information entropy present in large HiC data sets, as it was previously shown. As a consequence, the manuscript does not seem of high importance to researchers in the field. I suggest submitting the manuscript to some more technical journal.</p>
    <p>**********</p>
    <p>
      <bold>Have all data underlying the figures and results presented in the manuscript been provided?</bold>
    </p>
    <p>Large-scale datasets should be made available via a public repository as described in the <italic>PLOS Computational Biology</italic>
<ext-link ext-link-type="uri" xlink:href="http://journals.plos.org/ploscompbiol/s/data-availability">data availability policy</ext-link>, and numerical data that underlies graphs or summary statistics should be provided in spreadsheet form as supporting information.</p>
    <p>Reviewer #1: Yes</p>
    <p>Reviewer #2: Yes</p>
    <p>Reviewer #3: Yes</p>
    <p>**********</p>
    <p>PLOS authors have the option to publish the peer review history of their article (<ext-link ext-link-type="uri" xlink:href="https://journals.plos.org/ploscompbiol/s/editorial-and-peer-review-process#loc-peer-review-history">what does this mean?</ext-link>). If published, this will include your full peer review and any attached files.</p>
    <p>If you choose “no”, your identity will remain anonymous but your review may still be made public.</p>
    <p><bold>Do you want your identity to be public for this peer review?</bold> For information about this choice, including consent withdrawal, please see our <ext-link ext-link-type="uri" xlink:href="https://www.plos.org/privacy-policy">Privacy Policy</ext-link>.</p>
    <p>Reviewer #1: No</p>
    <p>Reviewer #2: Yes: Oana Ursu</p>
    <p>Reviewer #3: No</p>
    <supplementary-material content-type="local-data" id="pcbi.1007287.s029">
      <label>Attachment</label>
      <caption>
        <p>Submitted filename: <named-content content-type="submitted-filename">2019DeepHiCReview.pdf</named-content></p>
      </caption>
      <media xlink:href="pcbi.1007287.s029.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </body>
</sub-article>
<sub-article id="pcbi.1007287.r002" article-type="author-comment">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1007287.r002</article-id>
    <title-group>
      <article-title>Author response to Decision Letter 0</article-title>
    </title-group>
    <related-article id="rel-obj002" ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1007287" related-article-type="editor-report"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>1</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="author-response-date">15 Nov 2019</named-content>
    </p>
    <supplementary-material content-type="local-data" id="pcbi.1007287.s030">
      <label>Attachment</label>
      <caption>
        <p>Submitted filename: <named-content content-type="submitted-filename">Response_to_Reviewers.docx</named-content></p>
      </caption>
      <media xlink:href="pcbi.1007287.s030.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </body>
</sub-article>
<sub-article id="pcbi.1007287.r003" article-type="aggregated-review-documents">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1007287.r003</article-id>
    <title-group>
      <article-title>Decision Letter 1</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Noble</surname>
          <given-names>William Stafford</given-names>
        </name>
        <role>Deputy Editor</role>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ay</surname>
          <given-names>Ferhat</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2020 Noble, Ay</copyright-statement>
      <copyright-year>2020</copyright-year>
      <copyright-holder>Noble, Ay</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article id="rel-obj003" ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1007287" related-article-type="reviewed-article"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>1</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">14 Jan 2020</named-content>
    </p>
    <p>Dear Dr Bo,</p>
    <p>We are pleased to inform you that your manuscript 'DeepHiC: A Generative Adversarial Network for Enhancing Hi-C Data Resolution' has been provisionally accepted for publication in PLOS Computational Biology.</p>
    <p>Before your manuscript can be formally accepted you will need to complete some formatting changes, which you will receive in a follow up email. Please be aware that it may take several days for you to receive this email; during this time no action is required by you. Once you have received these formatting requests, please note that your manuscript will not be scheduled for publication until you have made the required changes. Also you still need to address the minor suggestions from one of the reviewers and do a thorough grammatical check. </p>
    <p>In the meantime, please log into Editorial Manager at <ext-link ext-link-type="uri" xlink:href="https://www.editorialmanager.com/pcompbiol/">https://www.editorialmanager.com/pcompbiol/</ext-link>, click the "Update My Information" link at the top of the page, and update your user information to ensure an efficient production and billing process.</p>
    <p>One of the goals of PLOS is to make science accessible to educators and the public. PLOS staff issue occasional press releases and make early versions of PLOS Computational Biology articles available to science writers and journalists. PLOS staff also collaborate with Communication and Public Information Offices and would be happy to work with the relevant people at your institution or funding agency. If your institution or funding agency is interested in promoting your findings, please ask them to coordinate their releases with PLOS (contact <email>ploscompbiol@plos.org</email>).</p>
    <p>Thank you again for supporting Open Access publishing. We look forward to publishing your paper in PLOS Computational Biology.</p>
    <p>Sincerely,</p>
    <p>Ferhat Ay, Ph.D</p>
    <p>Associate Editor</p>
    <p>PLOS Computational Biology</p>
    <p>Weixiong Zhang</p>
    <p>Deputy Editor</p>
    <p>PLOS Computational Biology</p>
    <p>Reviewer's Responses to Questions</p>
    <p>
      <bold>Comments to the Authors:</bold>
    </p>
    <p>
      <bold>Please note here if the review is uploaded as an attachment.</bold>
    </p>
    <p>Reviewer #1: I am happy to report that the authors appear to have put a great deal of effort into their revision and have addressed all of my concerns. I would also like to apologize to the authors for my comment that their webserver did not work. The webserver did indeed work but took some time to run and I had forgotten to remove the comment after the webserver finished running.</p>
    <p>Reviewer #2: Review is uploaded as an attachment.</p>
    <p>**********</p>
    <p>
      <bold>Have all data underlying the figures and results presented in the manuscript been provided?</bold>
    </p>
    <p>Large-scale datasets should be made available via a public repository as described in the <italic>PLOS Computational Biology</italic>
<ext-link ext-link-type="uri" xlink:href="http://journals.plos.org/ploscompbiol/s/data-availability">data availability policy</ext-link>, and numerical data that underlies graphs or summary statistics should be provided in spreadsheet form as supporting information.</p>
    <p>Reviewer #1: Yes</p>
    <p>Reviewer #2: Yes</p>
    <p>**********</p>
    <p>PLOS authors have the option to publish the peer review history of their article (<ext-link ext-link-type="uri" xlink:href="https://journals.plos.org/ploscompbiol/s/editorial-and-peer-review-process#loc-peer-review-history">what does this mean?</ext-link>). If published, this will include your full peer review and any attached files.</p>
    <p>If you choose “no”, your identity will remain anonymous but your review may still be made public.</p>
    <p><bold>Do you want your identity to be public for this peer review?</bold> For information about this choice, including consent withdrawal, please see our <ext-link ext-link-type="uri" xlink:href="https://www.plos.org/privacy-policy">Privacy Policy</ext-link>.</p>
    <p>Reviewer #1: Yes: Jacob Schreiber</p>
    <p>Reviewer #2: Yes: Oana Ursu</p>
    <supplementary-material content-type="local-data" id="pcbi.1007287.s031">
      <label>Attachment</label>
      <caption>
        <p>Submitted filename: <named-content content-type="submitted-filename">2019-12-17_re-review.pdf</named-content></p>
      </caption>
      <media xlink:href="pcbi.1007287.s031.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </body>
</sub-article>
<sub-article id="pcbi.1007287.r004" article-type="editor-report">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1007287.r004</article-id>
    <title-group>
      <article-title>Acceptance letter</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Noble</surname>
          <given-names>William Stafford</given-names>
        </name>
        <role>Deputy Editor</role>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ay</surname>
          <given-names>Ferhat</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2020 Noble, Ay</copyright-statement>
      <copyright-year>2020</copyright-year>
      <copyright-holder>Noble, Ay</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article id="rel-obj004" ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1007287" related-article-type="reviewed-article"/>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">13 Feb 2020</named-content>
    </p>
    <p>PCOMPBIOL-D-19-01246R1 </p>
    <p>DeepHiC: A Generative Adversarial Network for Enhancing Hi-C Data Resolution</p>
    <p>Dear Dr Bo,</p>
    <p>I am pleased to inform you that your manuscript has been formally accepted for publication in PLOS Computational Biology. Your manuscript is now with our production department and you will be notified of the publication date in due course.</p>
    <p>The corresponding author will soon be receiving a typeset proof for review, to ensure errors have not been introduced during production. Please review the PDF proof of your manuscript carefully, as this is the last chance to correct any errors. Please note that major changes, or those which affect the scientific understanding of the work, will likely cause delays to the publication date of your manuscript. </p>
    <p>Soon after your final files are uploaded, unless you have opted out, the early version of your manuscript will be published online. The date of the early version will be your article's publication date. The final article will be published to the same URL, and all versions of the paper will be accessible to readers.</p>
    <p>Thank you again for supporting PLOS Computational Biology and open-access publishing. We are looking forward to publishing your work! </p>
    <p>With kind regards,</p>
    <p>Laura Mallard</p>
    <p>PLOS Computational Biology | Carlyle House, Carlyle Road, Cambridge CB4 3DN | United Kingdom <email>ploscompbiol@plos.org</email> | Phone +44 (0) 1223-442824 | <ext-link ext-link-type="uri" xlink:href="http://ploscompbiol.org">ploscompbiol.org</ext-link> | @PLOSCompBiol</p>
  </body>
</sub-article>
