<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">9883605</article-id>
    <article-id pub-id-type="publisher-id">5151</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-023-05151-0</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>DeepSelectNet: deep neural network based selective sequencing for oxford nanopore sequencing</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Senanayake</surname>
          <given-names>Anjana</given-names>
        </name>
        <address>
          <email>anjana.senanayake@eng.pdn.ac.lk</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Gamaarachchi</surname>
          <given-names>Hasindu</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Herath</surname>
          <given-names>Damayanthi</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ragel</surname>
          <given-names>Roshan</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.11139.3b</institution-id><institution-id institution-id-type="ISNI">0000 0000 9816 8637</institution-id><institution>Department of Computer Engineering, </institution><institution>University of Peradeniya, </institution></institution-wrap>Peradeniya, Sri Lanka </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.415306.5</institution-id><institution-id institution-id-type="ISNI">0000 0000 9983 6924</institution-id><institution>Kinghorn Centre for Clinical Genomics, </institution><institution>Garvan Institute of Medical Research, </institution></institution-wrap>Darlinghurst, Australia </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="GRID">grid.1005.4</institution-id><institution-id institution-id-type="ISNI">0000 0004 4902 0432</institution-id><institution>School of Computer Science and Engineering, </institution><institution>University of New South Wales, </institution></institution-wrap>Sydney, Australia </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>28</day>
      <month>1</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>28</day>
      <month>1</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2023</year>
    </pub-date>
    <volume>24</volume>
    <elocation-id>31</elocation-id>
    <history>
      <date date-type="received">
        <day>24</day>
        <month>10</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>17</day>
        <month>1</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold>This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">Nanopore sequencing allows selective sequencing, the ability to programmatically reject unwanted reads in a sample. Selective sequencing has many present and future applications in genomics research and the classification of species from a pool of species is an example. Existing methods for selective sequencing for species classification are still immature and the accuracy highly varies depending on the datasets. For the five datasets we tested, the accuracy of existing methods varied in the range of <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sim$$\end{document}</tex-math><mml:math id="M2"><mml:mo>∼</mml:mo></mml:math><inline-graphic xlink:href="12859_2023_5151_Article_IEq1.gif"/></alternatives></inline-formula> 77 to 97% (average accuracy &lt; 89%). Here we present DeepSelectNet, an accurate deep-learning-based method that can directly classify nanopore current signals belonging to a particular species. DeepSelectNet utilizes novel data preprocessing techniques and improved neural network architecture for regularization.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">For the five datasets tested, DeepSelectNet’s accuracy varied between <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sim$$\end{document}</tex-math><mml:math id="M4"><mml:mo>∼</mml:mo></mml:math><inline-graphic xlink:href="12859_2023_5151_Article_IEq2.gif"/></alternatives></inline-formula> 91 and 99% (average accuracy <inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sim$$\end{document}</tex-math><mml:math id="M6"><mml:mo>∼</mml:mo></mml:math><inline-graphic xlink:href="12859_2023_5151_Article_IEq3.gif"/></alternatives></inline-formula> 95%). At its best performance, DeepSelectNet achieved a nearly 12% accuracy increase compared to its deep learning-based predecessor SquiggleNet. Furthermore, precision and recall evaluated for DeepSelectNet on average were always &gt; 89% (average <inline-formula id="IEq4"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sim$$\end{document}</tex-math><mml:math id="M8"><mml:mo>∼</mml:mo></mml:math><inline-graphic xlink:href="12859_2023_5151_Article_IEq4.gif"/></alternatives></inline-formula> 95%). In terms of execution performance, DeepSelectNet outperformed SquiggleNet by <inline-formula id="IEq5"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sim$$\end{document}</tex-math><mml:math id="M10"><mml:mo>∼</mml:mo></mml:math><inline-graphic xlink:href="12859_2023_5151_Article_IEq5.gif"/></alternatives></inline-formula> 13% on average. Thus, DeepSelectNet is a practically viable method to improve the effectiveness of selective sequencing.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p id="Par3">Compared to base alignment and deep learning predecessors, DeepSelectNet can significantly improve the accuracy to enable real-time species classification using selective sequencing. The source code of DeepSelectNet is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/AnjanaSenanayake/DeepSelectNet">https://github.com/AnjanaSenanayake/DeepSelectNet</ext-link>.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Selective sequencing</kwd>
      <kwd>Deep learning</kwd>
      <kwd>Nanopore</kwd>
    </kwd-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2023</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <sec id="Sec2">
      <title>Problem</title>
      <p id="Par4">Oxford Nanopore Technologies (ONT) introduced <italic>MinION</italic>, the first portable commercial sequencer of its kind in 2014 [<xref ref-type="bibr" rid="CR1">1</xref>–<xref ref-type="bibr" rid="CR3">3</xref>]. <italic>MinION</italic>, being a small handheld device, revolutionized genomics research through its superiority in portability [<xref ref-type="bibr" rid="CR4">4</xref>–<xref ref-type="bibr" rid="CR7">7</xref>]. The capability of nanopore sequencers to produce ultra-long reads is another advantage, especially in achieving better genome assemblies [<xref ref-type="bibr" rid="CR8">8</xref>–<xref ref-type="bibr" rid="CR11">11</xref>]. Nanopore sequencers provide access to real-time current signals when a DNA strand traverses through the pore [<xref ref-type="bibr" rid="CR12">12</xref>]. This real-time streaming capability foster an exciting opportunity called selective sequencing [<xref ref-type="bibr" rid="CR13">13</xref>] (also known as targeted sequencing, adaptive sampling), which has many current and promising future applications [<xref ref-type="bibr" rid="CR14">14</xref>–<xref ref-type="bibr" rid="CR19">19</xref>].</p>
      <p id="Par5">ONT’s <italic>ReadUntil</italic> API enables real-time bi-directional communication with an ONT sequencer: to obtain the current signals of the DNA strands being sequenced and to send back signals such as accept/reject. A rejection signal reverses the voltage difference across the pore so that the DNA strand is ejected from the pore. This can be used to quickly free a pore from sequencing an unwanted DNA strand and allow a new DNA strand to be sequenced. This can also be used to sequence selected DNA strands from a pool of different DNA species.</p>
      <p id="Par6">Successful selective sequencing is in many ways beneficial given its effective flow-cell utilization and reduced cost for sequencing. Efficient and accurate real-time analysis of the current signals streamed from the nanopore sequencer is the key to successful selective sequencing. However, existing methods used in selective sequencing to accurately compare the current signal to a target reference genome are still computationally expensive. They hence would negate the true real-time sequencing capability. Selective sequencing being relatively new, potential improvements to the performance of selective sequencing in many areas are yet to be discovered. In this paper, we investigate methods to improve the accuracy and speed of selective sequencing compared to current methodologies and present a deep neural network-based method called <italic>DeepSelectNet</italic>.</p>
    </sec>
    <sec id="Sec3">
      <title>Related works</title>
      <p id="Par7">The very first attempt to realize the concept of selective sequencing used the Dynamic Time Warping (DTW) algorithm to align the raw current signal directly to a synthetic signal generated from the reference sequence [<xref ref-type="bibr" rid="CR13">13</xref>]. However, due to the high computational complexity of DTW, this method could not scale beyond references that are longer than a few mega bases. Then, a method called RUBRIC was introduced by Edwards et al. [<xref ref-type="bibr" rid="CR20">20</xref>], which performed real-time basecalling using Nanonet basecaller, followed by read alignment to the conventional nucleic acid references. RUBRIC delivered significant benefits in speed, scalability, and flexibility over the DTW [<xref ref-type="bibr" rid="CR13">13</xref>] approach. Similar to RUBRIC, Readfish [<xref ref-type="bibr" rid="CR21">21</xref>] is another basecalling based approach for selective sequencing. Readfish [<xref ref-type="bibr" rid="CR21">21</xref>] utilizes the GPU-accelerated Guppy basecaller from ONT and Minimap2 mapper [<xref ref-type="bibr" rid="CR22">22</xref>]. Readfish [<xref ref-type="bibr" rid="CR21">21</xref>] is flexible and scales well to larger genomes when a powerful GPU is available.</p>
      <p id="Par8">UNCALLED [<xref ref-type="bibr" rid="CR23">23</xref>] is a recent method that revitalises the raw signal alignment in the signal space for selective sequencing. UNCALLED probabilistically derive k-mers that can be presented in a signal and performs a comparison with a reference encoded using a FM-index [<xref ref-type="bibr" rid="CR24">24</xref>]. Raw signals are first converted to events and the probability of each event is matched with a possible k-mer in a probabilistic k-mer model provided by ONT. UNCALLED [<xref ref-type="bibr" rid="CR23">23</xref>] scaled much better than the DTW-based method [<xref ref-type="bibr" rid="CR13">13</xref>], however, does not support large (&gt; 1 Gbase) or highly repetitive references.</p>
      <p id="Par9">In recent years, researchers increasingly turned their direction to deep learning approaches to improve basecalling accuracy. DeepNano [<xref ref-type="bibr" rid="CR25">25</xref>], Chiron [<xref ref-type="bibr" rid="CR26">26</xref>], BasecRAWller [<xref ref-type="bibr" rid="CR27">27</xref>], Nanonet, RODAN [<xref ref-type="bibr" rid="CR28">28</xref>], Radian [<xref ref-type="bibr" rid="CR29">29</xref>], Albacore, Guppy, Bonito and Dorado are such examples. According to Wick et al. [<xref ref-type="bibr" rid="CR30">30</xref>], modern basecalling tools were able to achieve a significant improvement in basecalling with the introduction of deep learning approaches (from <inline-formula id="IEq6"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sim$$\end{document}</tex-math><mml:math id="M12"><mml:mo>∼</mml:mo></mml:math><inline-graphic xlink:href="12859_2023_5151_Article_IEq6.gif"/></alternatives></inline-formula> 85 to 90%). Deep Neural Networks based methods are also now being increasingly used for improved variant calling [<xref ref-type="bibr" rid="CR31">31</xref>, <xref ref-type="bibr" rid="CR32">32</xref>].</p>
      <p id="Par10">Recently, deep learning-based methods for selective sequencing started to emerge. SquiggleNet [<xref ref-type="bibr" rid="CR33">33</xref>] is the first deep learning-based tool to classify reads based on electrical signals to perform selective sequencing. SquiggleNet adopts the convolution architecture from ResNet [<xref ref-type="bibr" rid="CR34">34</xref>], modified to perform convolution in one dimension. It claims 90% accuracy in classifying human DNA over bacterial DNA. Also, considering the computational resources, SquiggleNet outperforms alignment-based approaches with much lesser memory consumption. However, when we benchmarked SquiggleNet across several viral and bacterial datasets, we observed that on some dataset combinations, SquiggleNet performed worse than base alignment-based methods. For instance, on datasets comprised of Corona Virus &amp; Zymo metagenome and Corona Virus &amp; Yeast, SquiggleNet classification accuracy could not go beyond 79%, where alignment-based approaches reached 90% (discussed under <xref rid="Sec5" ref-type="sec">Results</xref>).</p>
      <p id="Par11">Another deep learning-based approach for selective sequencing is discussed in Danilevsky et al. [<xref ref-type="bibr" rid="CR35">35</xref>]. The mentioned work applies deep learning models to classify mitochondrial DNA against human genomic DNA, with no reliance on labelled data to classify between the two DNA groups. However, the applicability of the mentioned method for complex inter-species classification is yet to be explored. The recent work named <italic>baseLess</italic> is also a deep learning approach that relies on features of salient k-mers rather than reads as a whole, explicitly designed to work with MinION [<xref ref-type="bibr" rid="CR36">36</xref>]. The authors have reported a performance similar to SquiggleNet, which does not surpass the performance of Guppy+Minimap2. Another very recent work is RISER [<xref ref-type="bibr" rid="CR37">37</xref>], a deep learning-based adaptive sampling method for nanopore direct RNA.</p>
    </sec>
    <sec id="Sec4">
      <title>Our contribution</title>
      <p id="Par12">The existing techniques for selective sequencing have room to improve effectiveness and efficiency. We introduce DeepSelectNet, a far superior deep learning-based method, which utilizes an improved deep neural network. Also, improved techniques of raw data preprocessing enable better feature extraction with limited training data. DeepSelectNet was able to achieve over 90%(on average <inline-formula id="IEq7"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sim$$\end{document}</tex-math><mml:math id="M14"><mml:mo>∼</mml:mo></mml:math><inline-graphic xlink:href="12859_2023_5151_Article_IEq7.gif"/></alternatives></inline-formula> 95%) classification accuracy for five datasets that we tested.</p>
    </sec>
  </sec>
  <sec id="Sec5">
    <title>Results</title>
    <p id="Par13">DeepSelectNet is a deep neural network-based method capable of classifying species DNA directly using nanopore current signals with superior classification accuracy. DeepSelectNet is built on a convolutional architecture based on ResNet’s residual blocks [<xref ref-type="bibr" rid="CR34">34</xref>]. The ResNet neural network architecture has been shown to perform better in feature extraction and semantic segmentation compared to Multilayer Perceptions (MLP), Fully Convolutional Networks (FCN), and Recurrent Neural Networks (RNN) [<xref ref-type="bibr" rid="CR38">38</xref>]. ResNet-based neural networks are efficient and address the degradation problem by maintaining a low error rate in much deeper layers in the network [<xref ref-type="bibr" rid="CR34">34</xref>]. Furthermore, SquiggleNet’s exploratory work in different neural network architectures has demonstrated that ResNet is higher in accuracy and faster in training compared to other architectures such as RNN [<xref ref-type="bibr" rid="CR34">34</xref>]. Similar to SquiggleNet, DeepSelectNet also utilizes one-dimensional convolutional layers to perform 1D convolution over nanopore current signals in the time domain. Additionally, DeepSelectNet relies on neural net regularization to minimise model complexity thereby reducing the overfitting of data (see <xref rid="Sec12" ref-type="sec">Methods and Materials</xref>).</p>
    <sec id="Sec6">
      <title>Experiments details</title>
      <p id="Par14">Four publicly available datasets sequenced on ONT MinION/GridION, namely, SARS-CoV-2 virus (<italic>Cov</italic>), Zymo bacterial mixture (<italic>Zymo</italic>), Saccharomyces cerevisiae (<italic>Yeast</italic>), and Chlamydomonas algae (<italic>Chlamy</italic>) were used for evaluation. We prepared five combinations out of these datasets to measure the performance of DeepSelectNet: <italic>Cov</italic> &amp;<italic>Zymo</italic>, <italic>Cov</italic> &amp;<italic>Yeast</italic>, <italic>Cov</italic> &amp;<italic>Chlamy</italic>, <italic>Zymo</italic> &amp;<italic>Chlamy</italic>, and <italic>Yeast</italic> &amp;<italic>Chlamy</italic> (detailed in Materials and methods). For each combination, training of DeepSelectNet was done using 20000 reads from each species (thus a balanced dataset). Before training, reads were preprocessed by trimming each read’s first 1500 signal samples to eliminate the adaptor sequence (also, stall and barcodes if present; Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S1). This 1500 value that corresponds to <inline-formula id="IEq8"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sim$$\end{document}</tex-math><mml:math id="M16"><mml:mo>∼</mml:mo></mml:math><inline-graphic xlink:href="12859_2023_5151_Article_IEq8.gif"/></alternatives></inline-formula> 160 bases is an overestimation for certain reads, however, it is a safe approach to eliminate unwanted portions from most of the reads [<xref ref-type="bibr" rid="CR33">33</xref>]. Out of the remaining signal, 3000 signal samples were normalized and taken for the training. Therefore, a read to qualify for the training should have at least 4500 signal samples. The labels of the reads—from which species a given signal segment is from—were fed to the training algorithm.</p>
    </sec>
    <sec id="Sec7">
      <title>Accuracy comparison of DeepSelectNet against existing methods</title>
      <p id="Par15">DeepSelectNet outperformed SquiggleNet in terms of test accuracy (defined in Materials and methods) for all the dataset combinations (Fig. <xref rid="Fig1" ref-type="fig">1</xref>, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S1). The best accuracy for DeepSelectNet was observed for <italic>Cov</italic> &amp;<italic>Chlamy</italic> (98.65%), while the best improvement compared to SquiggleNet was observed for <italic>Cov</italic> &amp;<italic>Zymo</italic> (accuracy improvement by <inline-formula id="IEq9"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sim$$\end{document}</tex-math><mml:math id="M18"><mml:mo>∼</mml:mo></mml:math><inline-graphic xlink:href="12859_2023_5151_Article_IEq9.gif"/></alternatives></inline-formula> 12%) as depicted in Fig. <xref rid="Fig1" ref-type="fig">1</xref>A. For all dataset combinations, DeepSelectNet achieved a test accuracy above 90%.</p>
      <p id="Par16">Similar to Accuracy, DeepSelectNet shows scores &gt; 89% on other performance metrics: precision, recall, and F1 as depicted in Fig. <xref rid="Fig1" ref-type="fig">1</xref>B (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S4, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S4). Given all the datasets used for training and testing are balanced as explained earlier, being able to observe both high precision and recall demonstrates that the classification is not biased<xref ref-type="fn" rid="Fn1">1</xref> towards a certain species in a dataset combination while also having a low variance<xref ref-type="fn" rid="Fn2">2</xref> of predictions (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S4).<fig id="Fig1"><label>Fig. 1</label><caption><p><bold>A</bold> Test Accuracy comparison of SquiggleNet vs DeepSelectNet across five dataset combinations. <bold>B</bold> DeepSelectNet’s performance metrics across five dataset combinations</p></caption><graphic xlink:href="12859_2023_5151_Fig1_HTML" id="MO1"/></fig></p>
      <p id="Par17">In addition to the comparison with SquiggleNet, DeepSelectNet’s performance was then compared against: Guppy super accuracy basecalling on complete reads followed by Minimap2 [<xref ref-type="bibr" rid="CR22">22</xref>] mapping (<italic>baseline</italic>); Guppy high accuracy basecalling on the first 4500 signal samples of each read<xref ref-type="fn" rid="Fn3">3</xref> followed by Minimap2 mapping (<italic>Guppy_hac+Minimap2</italic>); and, Guppy fast basecalling on the first 4500 signal samples of each read followed by Minimap2 mapping (<italic>Guppy_fast+Minimap2</italic>). Accuracy results are shown in Fig. <xref rid="Fig2" ref-type="fig">2</xref>. The <italic>baseline</italic> (Fig. <xref rid="Fig2" ref-type="fig">2</xref>) that uses the complete read (impractical for selective sequencing) was to get an estimate of the upper margin accuracy a certain computational method could potentially achieve. <italic>Guppy_hac+Minimap2</italic> mirrors a real-time scenario as in DeepSelectNet’s intended use, where the whole read is not available for classification. <italic>Guppy_fast+Minimap2</italic> follows the approach used in Readfish [<xref ref-type="bibr" rid="CR21">21</xref>]. While we expected the accuracy of DeepSelectNet to be lower than the baseline, interestingly, DeepSelectNet outperformed the baseline method in three (<italic>Zymo</italic> &amp;<italic>Chlamy</italic>, <italic>Cov</italic> &amp;<italic>Chlamy</italic> and <italic>Yeast</italic> &amp;<italic>Chlamy</italic>) out of five dataset combinations (Fig. <xref rid="Fig2" ref-type="fig">2</xref>, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S2). Compared to <italic>Guppy_hac+Minimap2</italic> that considers the realtime scenario (unlike the baseline method that uses complete reads), DeepSelectNet was performing better in four out of five dataset combinations (except <italic>Cov</italic> &amp;<italic>Zymo</italic>; Fig. <xref rid="Fig2" ref-type="fig">2</xref>). <italic>Guppy_fast+Minimap2</italic> accuracy was somewhat in close proximity to <italic>Guppy_hac+Minimap2</italic>, yet lower than DeepSelectNet in all dataset combinations. Also, it was observed that <italic>Guppy_fast+Minimap2</italic> has the worst performance in three out of five dataset combinations. As the predecessor of DeepSelectNet, the SquiggleNet performed as the second-best method in three out of five dataset combinations, when considering real-time scenarios.<fig id="Fig2"><label>Fig. 2</label><caption><p>Test Accuracy comparison of DeepSelectNet against existing alignment methods across five dataset combinations</p></caption><graphic xlink:href="12859_2023_5151_Fig2_HTML" id="MO2"/></fig></p>
    </sec>
    <sec id="Sec8">
      <title>Runtime performance comparison</title>
      <p id="Par18">In addition to accuracy benchmarking, we also benchmarked the execution time for inference (see Fig. <xref rid="Fig3" ref-type="fig">3</xref> where the per-read execution time is plotted, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S3). A setup similar to that discussed earlier (previous subsection) was used for these experiments. Among the methods experimented with, <italic>Guppy_fast+Minimap2</italic> had the best execution time throughout all datasets. <italic>Guppy_hac+Minimap2</italic> was the slowest (Fig. <xref rid="Fig3" ref-type="fig">3</xref>). This drastic difference can be accounted for by the guppy configuration of the model being used in the two methods. Compared to SquiggleNet, DeepSelectNet has the best runtime performance in four out of five datasets, except <italic>Cov</italic> &amp;<italic>Zymo</italic> where SquiggleNet was faster compared to DeepSelectNet. Even though DeepSelectNet is not as fast as <italic>Guppy_fast+Minimap2</italic>, DeepSelectNet’s superior accuracy must be noted (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S7). Also, note that Guppy which is the ONT’s production basecaller written in C/C++ is likely to be well-optimised for execution performance, unlike DeepSelectNet which was a prototype developed using Python. While it is not in the scope of this work to optimise DeepSelectNet for execution performance, it is logical to believe that reimplementing using C/C++ and performing optimisations could lead to improved execution time.<fig id="Fig3"><label>Fig. 3</label><caption><p>Inference runtime comparison of DeepSelectNet against other methods across five dataset combinations</p></caption><graphic xlink:href="12859_2023_5151_Fig3_HTML" id="MO3"/></fig></p>
      <p id="Par19">Additionally, we also benchmarked against Guppy super accuracy base-calling on the first 4500 signal samples of each read followed by Minimap2 mapping (<italic>Guppy_sup+Minimap2</italic>; Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S6). The prediction time for super accuracy basecalling was impractical to be used in selective sampling (more then 4X slower than <italic>Guppy_hac+Minimap2</italic> that is already slow; Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S8). However, the accuracy was better when using Guppy_sup than Guppy_hac (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S5). DeepSelectNet was still performing better in three out of five dataset combinations (except <italic>Cov</italic> &amp;<italic>Zymo</italic> and <italic>Cov</italic> &amp;<italic>Yeast</italic>, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S6). These observations denote that, DeepSelectNet has performed closely equal or better, against the benchmark methods, irrespective of the basecaller types that were used.</p>
    </sec>
  </sec>
  <sec id="Sec9">
    <title>Discussion</title>
    <p id="Par20">DeepSelectNet shows promising improvements in accuracy compared to existing deep learning-based and alignment-based approaches for selective sequencing. DeepSelectNet is a result of observing that the existing deep learning-based methods, such as SquiggleNet, had room to improve further. The model’s ability to classify at higher accuracy, precision, and recall demonstrates that the classification is unbiased for a particular species. Table <xref rid="Tab1" ref-type="table">1</xref>, summarises the accuracy and inference time comparison of DeepSelectNet with existing methods. As it is evident, DeepSelectNet stands out to be the best in terms of accuracy. In contrast, the <italic>Guppy_fast+Minimap2</italic> (the approach used in Readfish [<xref ref-type="bibr" rid="CR21">21</xref>]) stands to be the best in speed. However, DeepSelectNet’s high accuracy could offer more benefits and the speed could be potentially improved through re-engineering (e.g., rewriting in C/C++), enabling a better realization of selective sequencing.<table-wrap id="Tab1"><label>Table 1</label><caption><p>Comparison of performance of DeepSelectNet against other methods in related works</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" rowspan="2">Dataset</th><th align="left" colspan="3">Accuracy (%)</th><th align="left" colspan="3">Inference Time (milliseconds)</th></tr><tr><th align="left">DeepSelect<break/>Net</th><th align="left">Squiggle<break/>Net</th><th align="left">Guppy_fast+<break/>Minimap2</th><th align="left">DeepSelect<break/>Net</th><th align="left">Squiggle<break/>Net</th><th align="left">Guppy_fast+<break/>Minimap2</th></tr></thead><tbody><tr><td align="left">Covid &amp; Zymo</td><td align="left">91.28</td><td align="left">79.69</td><td align="left">90.95</td><td align="left">1.75</td><td align="left">1.33</td><td align="left">0.38</td></tr><tr><td align="left">Covid &amp; Chlamy</td><td align="left">98.65</td><td align="left">96.82</td><td align="left">86.79</td><td align="left">3.00</td><td align="left">3.55</td><td align="left">0.20</td></tr><tr><td align="left">Covid &amp; Yeast</td><td align="left">90.90</td><td align="left">79.83</td><td align="left">77.83</td><td align="left">1.98</td><td align="left">4.03</td><td align="left">0.28</td></tr><tr><td align="left">Zymo &amp; Chlamy</td><td align="left">97.31</td><td align="left">94.81</td><td align="left">91.46</td><td align="left">3.18</td><td align="left">3.85</td><td align="left">0.37</td></tr><tr><td align="left">Yeast &amp; Chlamy</td><td align="left">96.93</td><td align="left">92.69</td><td align="left">78.49</td><td align="left">3.45</td><td align="left">3.95</td><td align="left">0.45</td></tr></tbody></table></table-wrap></p>
    <sec id="Sec10">
      <title>Impact of number of reads and segment size on accuracy</title>
      <p id="Par21">We measured the model accuracy while increasing the number of reads used for training. We observed that the number of reads used for training improves the classification accuracy (Fig. <xref rid="Fig4" ref-type="fig">4</xref>). It is likely that the increase in accuracy is due to the increased genome coverage when the number of reads is increased (coverage is defined in Methods and Materials). When the coverage of the genome by a dataset is high, the model will have more features to learn about the species (and also the effect due to noise is diminished) and classify them better against the other species.<fig id="Fig4"><label>Fig. 4</label><caption><p>Accuracy of DeepSelectNet against varying number of reads for Cov &amp;Zymo dataset. The segment size (excluding the 1500 samples trimmed at the beginning) was kept constant at 3000 samples. Refer Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S14 for details Genome Coverage in each case</p></caption><graphic xlink:href="12859_2023_5151_Fig4_HTML" id="MO4"/></fig></p>
      <p id="Par22">We also measured the model accuracy against different signal segment lengths (no. of signal samples in each read) and noticed that the accuracy improves with longer segments (Fig. <xref rid="Fig5" ref-type="fig">5</xref>). However, the improvement becomes less significant after <inline-formula id="IEq11"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sim$$\end{document}</tex-math><mml:math id="M20"><mml:mo>∼</mml:mo></mml:math><inline-graphic xlink:href="12859_2023_5151_Article_IEq11.gif"/></alternatives></inline-formula> 4000 signal samples (Fig. <xref rid="Fig5" ref-type="fig">5</xref>). We selected a segment size of 3000 signal samples for our experiments above (<inline-formula id="IEq12"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sim$$\end{document}</tex-math><mml:math id="M22"><mml:mo>∼</mml:mo></mml:math><inline-graphic xlink:href="12859_2023_5151_Article_IEq12.gif"/></alternatives></inline-formula> 330 bases), considering the time to train, real-time inference requirement and fair comparison with SquiggleNet [<xref ref-type="bibr" rid="CR33">33</xref>] (SquiggleNet also used 3000 as the segment length). A longer signal segment means having a larger k-mer size that allows distinguishing species better, thereby the model may classify better with longer segments. Having a longer segment increases the genome coverage, which also may improve the model performance as discussed before.<fig id="Fig5"><label>Fig. 5</label><caption><p>Accuracy of DeepSelectNet agianst the signal segment length for Cov &amp;Zymo dataset. The number of reads used for training was kept constant at 20,000. Note that the segment length excludes the first 1500 signal samples that are trimmed. Refer Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S13 for details Genome Coverage in each case</p></caption><graphic xlink:href="12859_2023_5151_Fig5_HTML" id="MO5"/></fig></p>
    </sec>
    <sec id="Sec11">
      <title>DeepSelectNet with human datasets</title>
      <p id="Par23">Inter-species experiments we performed with <italic>Human</italic> &amp;<italic>Zymo</italic> and <italic>Human</italic> &amp;<italic>Covid</italic>, produced 92.26% and 96.27% test accuracies, respectively (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S9). Human data were from the publicly available NA12878 reference Genome [<xref ref-type="bibr" rid="CR39">39</xref>]. For these experiments, 20,000 reads from each species were used (relates to 0.008<inline-formula id="IEq13"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\times$$\end{document}</tex-math><mml:math id="M24"><mml:mo>×</mml:mo></mml:math><inline-graphic xlink:href="12859_2023_5151_Article_IEq13.gif"/></alternatives></inline-formula>, 400<inline-formula id="IEq14"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\times$$\end{document}</tex-math><mml:math id="M26"><mml:mo>×</mml:mo></mml:math><inline-graphic xlink:href="12859_2023_5151_Article_IEq14.gif"/></alternatives></inline-formula>, and 0.4<inline-formula id="IEq15"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\times$$\end{document}</tex-math><mml:math id="M28"><mml:mo>×</mml:mo></mml:math><inline-graphic xlink:href="12859_2023_5151_Article_IEq15.gif"/></alternatives></inline-formula> genome coverage for human, covid and zymo respectively, Materials and methods, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S12). Interestingly, even without seeing the complete genome (coverage &lt; 0.008<inline-formula id="IEq16"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\times$$\end{document}</tex-math><mml:math id="M30"><mml:mo>×</mml:mo></mml:math><inline-graphic xlink:href="12859_2023_5151_Article_IEq16.gif"/></alternatives></inline-formula> for human), the model could classify accurately. This could be because, even though the coverage is less, still the features are sufficiently different (an analogy would be k-mers distribution between humans and bacteria/viruses being different). However, it also raised a concern if the model is picking some other difference amongst the datasets than the species (for instance, differences in library preparation method and/or minor differences in the flowcells in the publicly available datasets sequenced by different labs at different times). To eliminate this concern, we simulated synthetic nanopore raw signal data for the two species Yeast and Chlamydomonas using <italic>Squigulator</italic> [<xref ref-type="bibr" rid="CR40">40</xref>] that relies on a pore-model indicating the expected current level for each k-mer. When this simulated data was used for training and testing, DeepSelectNet could achieve a test accuracy of 97.10% (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S11). Therefore, this experiment demonstrates that DeepSelectNet actually classifies based on features of species, rather than being misled by any other non-species related difference. To support this further, an experiment against two species present in Zymo dataset, the <italic>Bacillus subtilis</italic> &amp; <italic>Saccharomyces cerevisiae</italic> was performed. The experiment achieved 82.51% of test accuracy (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S15), which is sufficient to demonstrate that DeepSelectNet can distinguish different species in the same sample. Note that we relied on Guppy+Minimap2 results to generate the truth set for DeepSelectNet (as there is no other way to isolate the reads from the zymo mix), which could have negatively affected the accuracy.</p>
      <p id="Par24">Though the DeepSelectNet performed great for inter-species classification as explained throughout the paper (accuracy <inline-formula id="IEq17"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sim$$\end{document}</tex-math><mml:math id="M32"><mml:mo>∼</mml:mo></mml:math><inline-graphic xlink:href="12859_2023_5151_Article_IEq17.gif"/></alternatives></inline-formula> 95% on average), its performance was not as great for intra-species classification (that is, classifying reads based on a genomic region of the same species). For example, when chromosome 21 and chromosome 22 from the human genome (publicly available NA12878 data available under [<xref ref-type="bibr" rid="CR41">41</xref>]) were used to train DeepSelectNet (chr21 as the positive dataset and chr22 as the negative dataset), the training accuracy was below 60% in all cross folds. Increasing the number of reads for each chromosome from 20,000 to 100,000 (signal segment length of 3000 samples), improved the training accuracy by a small margin up to 64%. With 35,000 reads from each chromosome at a signal segment length of 10,000 (<inline-formula id="IEq18"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sim$$\end{document}</tex-math><mml:math id="M34"><mml:mo>∼</mml:mo></mml:math><inline-graphic xlink:href="12859_2023_5151_Article_IEq18.gif"/></alternatives></inline-formula> 1100 bases), the training accuracy improved to 73%. It is possible that DeepSelectNet is reaching its performance limitations to learn fine features among different chromosomes or different regions of a species. Unfortunately, our computational infrastructure restricted us from exploring further on larger datasets than this.</p>
    </sec>
  </sec>
  <sec id="Sec12">
    <title>Materials and methods</title>
    <sec id="Sec13">
      <title>DeepSelectNet model architecture</title>
      <p id="Par25">The first layer in DeepSelectNet is a one-dimensional Convolutional Neural Network (CNN) with 20 channels. The rest of the residual blocks (Similar to ResNet) are implemented additionally with dropout layers [<xref ref-type="bibr" rid="CR42">42</xref>] to effectively regularize any over-fitting effects that the layer complexity might introduce. This helps to mitigate the effect of the model picking up on statistical noise in the training data, which could result in poor performance when the model is evaluated on unseen data. During training, 10% layer outputs are randomly ignored so that the layer will be treated like a layer with a different number of nodes and edges than the layer before. Therefore, each update to a layer during training is performed differently in comparison to the updated layer. The four residual layers, which include two bottleneck blocks, are stacked together following a mean pooling layer and lastly, a fully-connected layer activated with a sigmoid function that flattens the output for classification.</p>
    </sec>
    <sec id="Sec14">
      <title>DeepSelectNet implementation</title>
      <p id="Par26">DeepSelectNet was developed in Python programming language using the Keras framework.<xref ref-type="fn" rid="Fn4">4</xref> Core functionalities of DeepSelectNet are distributed among three scripts:<list list-type="bullet"><list-item><p id="Par27"><italic>preproccesor.py</italic> that pre-processes datasets prior to training (read filtering, signal trimming, signal segmentation, signal normalization and splitting to batches).</p></list-item><list-item><p id="Par28"><italic>trainer.py</italic> that trains the pre-processed data (change hyperparameters of the model including classifier network, loss function, train to validation split ratio, number of cross folds, epochs, data batch size, etc.).</p></list-item><list-item><p id="Par29"><italic>inference.py</italic> that inferences test data using a trained model (data preprocessing similar to <italic>preproccessor.py</italic> is done in this script before the inference).</p></list-item></list></p>
    </sec>
    <sec id="Sec15">
      <title>Data Pre-processing</title>
      <p id="Par30">Four publicly available datasets sequenced on ONT MinION/GridION were used for the experiments (Table <xref rid="Tab2" ref-type="table">2</xref>). These datasets contained raw signal data in single-FAST5 format (one file per each read), which we converted to SLOW5 format using slow5tools [<xref ref-type="bibr" rid="CR41">41</xref>] to enable convenient and efficient file manipulation. Then, 40,000 reads containing at least 4500 signal samples were extracted from each dataset. Using these extracted reads, five dataset combinations were created, namely <italic>Cov</italic> &amp;<italic>Zymo</italic>, <italic>Cov</italic> &amp;<italic>Chlamy</italic>, <italic>Cov</italic> &amp;<italic>Yeast</italic>, <italic>Yeast</italic> &amp;<italic>Chlamy</italic> and <italic>Zymo</italic> &amp;<italic>Chlamy</italic>. Each dataset combination was partitioned equally for training and testing. For instance, the <italic>Cov</italic> &amp;<italic>Yeast</italic> dataset combination which contains 40,000 from <italic>Cov</italic> and 40,000 from <italic>Yeast</italic> is partitioned such that 20,000 <italic>Cov</italic> reads and 20,000 <italic>Yeast</italic> reads are for training, and the rest for testing. Thus, the created datasets were balanced datasets where a species’ contribution to each dataset combination was equal. Note that this count of 20000 reads was a value that we empirically determined to adequately provide genome-wide coverage for these dataset combinations (See the <xref rid="Sec9" ref-type="sec">Discussion</xref> for more information).<table-wrap id="Tab2"><label>Table 2</label><caption><p>Datasets and their sources</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Species</th><th align="left">Dataset</th><th align="left">Source</th></tr></thead><tbody><tr><td align="left">SARS-CoV-2</td><td align="left">Cov</td><td align="left"><ext-link ext-link-type="uri" xlink:href="https://community.artic.network/t/links-to-raw-fast5-fastq-data-for-artic-protocol/17">https://community.artic.network/t/links-to-raw-fast5-fastq-data-for-artic-protocol/17</ext-link></td></tr><tr><td align="left">Zymo Metagenome</td><td align="left">Zymo</td><td align="left"><ext-link ext-link-type="uri" xlink:href="https://github.com/LomanLab/mockcommunity">https://github.com/LomanLab/mockcommunity</ext-link></td></tr><tr><td align="left">Chlamydomonas</td><td align="left">Chlamy</td><td align="left"><ext-link ext-link-type="uri" xlink:href="https://sra-download.ncbi.nlm.nih.gov/traces/era20/ERZ/003237/ERR3237140/Chlamydomonas_0.tar.gz">https://sra-download.ncbi.nlm.nih.gov/traces/era20/ERZ/003237/ERR3237140/Chlamydomonas_0.tar.gz</ext-link></td></tr><tr><td align="left">Saccharomyces cerevisiae</td><td align="left">Yeast</td><td align="left"><ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/bioproject/PRJNA510813">https://www.ncbi.nlm.nih.gov/bioproject/PRJNA510813</ext-link></td></tr></tbody></table></table-wrap></p>
      <p id="Par31">Each read from the dataset is first trimmed by removing the initial 1500 signal samples. As discussed earlier, trimming is essential to get rid of the read adaptor (and barcode if exists, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S1). Then, the raw signal samples (16-bit integers) are converted to pico-amperes using the equation: <inline-formula id="IEq19"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$pA\_signal = (\frac{range}{digitization}) \times (raw\_signal + offset)$$\end{document}</tex-math><mml:math id="M36"><mml:mrow><mml:mi>p</mml:mi><mml:mi>A</mml:mi><mml:mi>_</mml:mi><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>g</mml:mi><mml:mi>n</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="italic">range</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">digitization</mml:mi></mml:mrow></mml:mfrac><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>×</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>w</mml:mi><mml:mi>_</mml:mi><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>g</mml:mi><mml:mi>n</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mo>+</mml:mo><mml:mi>o</mml:mi><mml:mi>f</mml:mi><mml:mi>f</mml:mi><mml:mi>s</mml:mi><mml:mi>e</mml:mi><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5151_Article_IEq19.gif"/></alternatives></inline-formula>. Next, four random segments (where each segment is 3000 signal samples) are obtained from this converted pico-ampere signal.<xref ref-type="fn" rid="Fn5">5</xref> Taking multiple signal segments from a single long read provides more feature space than taking a single segment and directly affects on model performance. This technique helped DeepSelectNet to increase its accuracy to a great extent (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S10). Value four as the number of segments was derived empirically, considering the model accuracy, the average length of the reads and the time to train.</p>
      <p id="Par32">Each such segment is then normalized with modified version of z-score that uses median absolute deviation (MAD): <inline-formula id="IEq20"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Modified\_Z\_Score\ = \frac{0.6745 \times (X_i-{{\tilde{X}}})}{ MAD}$$\end{document}</tex-math><mml:math id="M38"><mml:mrow><mml:mi>M</mml:mi><mml:mi>o</mml:mi><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>f</mml:mi><mml:mi>i</mml:mi><mml:mi>e</mml:mi><mml:mi>d</mml:mi><mml:mi>_</mml:mi><mml:mi>Z</mml:mi><mml:mi>_</mml:mi><mml:mi>S</mml:mi><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mspace width="4pt"/><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>0.6745</mml:mn><mml:mo>×</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mover accent="true"><mml:mi>X</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="italic">MAD</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5151_Article_IEq20.gif"/></alternatives></inline-formula>; where <inline-formula id="IEq21"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$MAD\ = {median}(\Vert X_i - {{\tilde{X}}} \Vert )$$\end{document}</tex-math><mml:math id="M40"><mml:mrow><mml:mi>M</mml:mi><mml:mi>A</mml:mi><mml:mi>D</mml:mi><mml:mspace width="4pt"/><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="italic">median</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo stretchy="false">‖</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mover accent="true"><mml:mi>X</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mo stretchy="false">‖</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5151_Article_IEq21.gif"/></alternatives></inline-formula> and <inline-formula id="IEq22"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\tilde{X}}}={median} (X)$$\end{document}</tex-math><mml:math id="M42"><mml:mrow><mml:mover accent="true"><mml:mi>X</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="italic">median</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>X</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5151_Article_IEq22.gif"/></alternatives></inline-formula>. The median absolute deviation used in the modified z-score is tolerant to extreme outliers (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S2) present in the data. The threshold used for MAD in data preprocessing had an effect on model training (Fig. <xref rid="Fig6" ref-type="fig">6</xref>, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S7). The MAD threshold affects the number of outliers being filtered, producing a differently performing model. Therefore, the better the outliers are filtered, the better the model trains. The best MAD threshold could depend on many factors such as the species, sequencing device and sample purity and thus we determined this threshold empirically (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S3). For this, We conducted experiments with MAD = 3, 5, and 10 as the thresholds and picked the value that produced the best accuracy for a given dataset combination (Fig. <xref rid="Fig6" ref-type="fig">6</xref>).<fig id="Fig6"><label>Fig. 6</label><caption><p>Impact of Median Absolute Deviations(MAD) on DeepSelectNet’s Test Accuracy</p></caption><graphic xlink:href="12859_2023_5151_Fig6_HTML" id="MO6"/></fig></p>
    </sec>
    <sec id="Sec16">
      <title>Training</title>
      <p id="Par33">In a given dataset combination, the training data partition (explained above) was again partitioned in 7:3 ratio, where 70% of training data was used for training and the rest for validation. As an example, <italic>Cov</italic> &amp;<italic>Yeast</italic> dataset combination containing 20,000 training reads from <italic>Cov</italic> and 20,000 training reads from <italic>Yeast</italic> is partitioned such that 14,000 <italic>Cov</italic> reads and 14,000 <italic>Yeast</italic> reads are for training, and the rest for validation.</p>
      <p id="Par34">Additionally, cross-fold validation was used to generalise training to ensure a minimally biased model. The training accuracy of trained models in each of the 5 folds lies in close proximity (Fig. <xref rid="Fig7" ref-type="fig">7</xref>, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S8), demonstrating that training has generalised. The training data was fed to the model in batches of 1000 reads at a time. The full dataset was trained for a maximum of 200 epochs in one cross-fold. Learning Rate (LR) factor for the training was 0.5. The LR patience factor was 20 epochs and was monitored against the binary accuracy metric. To avoid over-fitting, an Early Stopping Monitor was used with an Early Stopping Patience of 30 epochs.<fig id="Fig7"><label>Fig. 7</label><caption><p>Training Accuracy of DeepSelectNet’s across five cross folds</p></caption><graphic xlink:href="12859_2023_5151_Fig7_HTML" id="MO7"/></fig></p>
    </sec>
    <sec id="Sec17">
      <title>Evaluation</title>
      <p id="Par35">The best performing model of the five training cross folds was selected for the evaluation. All evaluations were done with previously unseen test data created in the preprocessing step. The Test data is also first preprocessed: the first 1500 signal samples in each read are trimmed off; the next 3000 signal samples are taken (note that only the first segment that represents the beginning of the read is taken for testing; we do not take 4 segments as in training); converted to pA and normalized using the modified z-score as done for training.</p>
      <p id="Par36">The inference was performed in batches of 1000 reads to ensure higher GPU occupancy and also indicates a scenario where reads are being sequenced in parallel on a nanopore sequencer with 1000 channels. The model training and the accuracy-related benchmarks were conducted on a system powered by an Intel Xeon CPU E5-1630 v3 @ 3.70GHz CPU, 32 GB of RAM, 2TB of HDD storage, and an Nvidia Quadro K40 GPU. As this was a shared workstation unsuitable for reliable timing measurements, runtime benchmarks were performed on another dedicated workstation powered by an Intel Xeon Silver 4114 CPU @ 2.20GHz CPU, 384 GB RAM, 6TB NVME SSD storage and a Tesla V100-16 G GPU.</p>
    </sec>
    <sec id="Sec18">
      <title>Modifications to SquiggleNet for comparison against DeepSelectNet</title>
      <p id="Par37">We modified SquiggleNet to accept SLOW5 file format [<xref ref-type="bibr" rid="CR41">41</xref>] as an input (SquiggleNet only accepted single-FAST5 files and manipulation of those files is inefficient and inconvenient). This modification does not affect the model classification accuracy as the underlying raw signal data is identical despite the file format used. The modified source code of SquiggleNet is available in the link provided under Availability of data and materials.</p>
    </sec>
    <sec id="Sec19">
      <title>Baseline, <italic>Guppy_hac+Minimap2</italic> and <italic>Guppy_fast+Minimap2</italic></title>
      <p id="Par38">The <italic>baseline</italic> approach uses complete reads whereas <italic>Guppy_hac+Minimap2</italic> and <italic>Guppy_fast+Minimap2</italic> uses only the first 4500 signal samples in a read (see <xref rid="Sec5" ref-type="sec">Results</xref>). Guppy version 6.1.3 and Minimap2 version 2.20 were used for the experiments. For <italic>baseline</italic> and <italic>Guppy_hac+Minimap2</italic>, the high-accuracy basecalling mode <italic>dna_r9.4.1_450bps_hac</italic> was used for Guppy and Minimap2 was executed with base alignment enables (with -c option). For <italic>Guppy_fast+Minimap2</italic>, fast basecalling mode was used with Guppy and Minimap2 was executed without base alignment to mirror the approach used in Readfish [<xref ref-type="bibr" rid="CR21">21</xref>].</p>
    </sec>
    <sec id="Sec20">
      <title>Genome coverage computation</title>
      <p id="Par39">Genome Coverage denotes the ratio between the number of bases appearing in the given dataset to the actual number of bases in its reference genome. The formula we used to compute the genome coverage seen by the model during training for a given dataset is given below.<disp-formula id="Equ1"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} Genome\ Coverage = \frac{signal\ segment\ length \times No.\ of\ reads}{samples\ per\ base \times reference\ genome\ length} \end{aligned}$$\end{document}</tex-math><mml:math id="M44" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>G</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>o</mml:mi><mml:mi>m</mml:mi><mml:mi>e</mml:mi><mml:mspace width="4pt"/><mml:mi>C</mml:mi><mml:mi>o</mml:mi><mml:mi>v</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>g</mml:mi><mml:mi>e</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>g</mml:mi><mml:mi>n</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mspace width="4pt"/><mml:mi>s</mml:mi><mml:mi>e</mml:mi><mml:mi>g</mml:mi><mml:mi>m</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi><mml:mspace width="4pt"/><mml:mi>l</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>g</mml:mi><mml:mi>t</mml:mi><mml:mi>h</mml:mi><mml:mo>×</mml:mo><mml:mi>N</mml:mi><mml:mi>o</mml:mi><mml:mo>.</mml:mo><mml:mspace width="4pt"/><mml:mi>o</mml:mi><mml:mi>f</mml:mi><mml:mspace width="4pt"/><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mi>d</mml:mi><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>a</mml:mi><mml:mi>m</mml:mi><mml:mi>p</mml:mi><mml:mi>l</mml:mi><mml:mi>e</mml:mi><mml:mi>s</mml:mi><mml:mspace width="4pt"/><mml:mi>p</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mspace width="4pt"/><mml:mi>b</mml:mi><mml:mi>a</mml:mi><mml:mi>s</mml:mi><mml:mi>e</mml:mi><mml:mo>×</mml:mo><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>f</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>c</mml:mi><mml:mi>e</mml:mi><mml:mspace width="4pt"/><mml:mi>g</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>o</mml:mi><mml:mi>m</mml:mi><mml:mi>e</mml:mi><mml:mspace width="4pt"/><mml:mi>l</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>g</mml:mi><mml:mi>t</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2023_5151_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula>The signal segment length is the number of samples in each signal segment used for training (excluding the samples trimmed at the beginning of the read). Samples per base refer to the number of signal samples that correspond to a single base, which is determined by the translocation speed of the DNA strand through the pore and the sampling rate of data acquisition. For DNA on R9.4.1, 450 bases/s at 4000 Hz gives <inline-formula id="IEq23"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sim$$\end{document}</tex-math><mml:math id="M46"><mml:mo>∼</mml:mo></mml:math><inline-graphic xlink:href="12859_2023_5151_Article_IEq23.gif"/></alternatives></inline-formula> 8–10 Samples per base.</p>
    </sec>
    <sec id="Sec21">
      <title>Accuracy metrics</title>
      <p id="Par40">Accuracy metrics and related terms used for evaluating the classification performance of the models in this work are defined below.</p>
      <p id="Par41">An outcome where the model predicts a read as positive when the read is actually from the targeted (positive) dataset/species is considered a <italic>True Positive (TP)</italic>. An outcome where the model predicts a read as negative when the read is actually from the non-targeted (negative) dataset/species is considered a <italic>True Negative (TN)</italic>. An outcome where the model predicts a read as positive when the read is actually from the non-targeted (negative) dataset/species is considered a <italic>False Positive (FP)</italic>. An outcome where the model predicts read as negative when the read is actually from the targeted (positive) dataset/species is considered a <italic>False Negative (FN)</italic>. Accuracy that denotes the overall accuracy of the model with correct predictions over total predictions is computed as <inline-formula id="IEq24"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\frac{TP + TN}{TP + TN + FP + FN}$$\end{document}</tex-math><mml:math id="M48"><mml:mfrac><mml:mrow><mml:mi>T</mml:mi><mml:mi>P</mml:mi><mml:mo>+</mml:mo><mml:mi>T</mml:mi><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi><mml:mi>P</mml:mi><mml:mo>+</mml:mo><mml:mi>T</mml:mi><mml:mi>N</mml:mi><mml:mo>+</mml:mo><mml:mi>F</mml:mi><mml:mi>P</mml:mi><mml:mo>+</mml:mo><mml:mi>F</mml:mi><mml:mi>N</mml:mi></mml:mrow></mml:mfrac></mml:math><inline-graphic xlink:href="12859_2023_5151_Article_IEq24.gif"/></alternatives></inline-formula>; precision is computed as <inline-formula id="IEq25"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\frac{TP}{TP + FP}$$\end{document}</tex-math><mml:math id="M50"><mml:mfrac><mml:mrow><mml:mi mathvariant="italic">TP</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi><mml:mi>P</mml:mi><mml:mo>+</mml:mo><mml:mi>F</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:mfrac></mml:math><inline-graphic xlink:href="12859_2023_5151_Article_IEq25.gif"/></alternatives></inline-formula>; Recall is computed as <inline-formula id="IEq26"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\frac{TP}{TP + FN}$$\end{document}</tex-math><mml:math id="M52"><mml:mfrac><mml:mrow><mml:mi mathvariant="italic">TP</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi><mml:mi>P</mml:mi><mml:mo>+</mml:mo><mml:mi>F</mml:mi><mml:mi>N</mml:mi></mml:mrow></mml:mfrac></mml:math><inline-graphic xlink:href="12859_2023_5151_Article_IEq26.gif"/></alternatives></inline-formula>; and F1 score <inline-formula id="IEq27"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\frac{2 \times (Precision \times Recall)}{Precision + Recall}$$\end{document}</tex-math><mml:math id="M54"><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mo>×</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>P</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>c</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:mo>×</mml:mo><mml:mi>R</mml:mi><mml:mi>e</mml:mi><mml:mi>c</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mi>l</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>P</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>c</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mi>R</mml:mi><mml:mi>e</mml:mi><mml:mi>c</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:mfrac></mml:math><inline-graphic xlink:href="12859_2023_5151_Article_IEq27.gif"/></alternatives></inline-formula>. However, in experiments from baseline method, Guppy_hac+Minimap2 and Guppy_fast+Minimap2, the unmapped reads accounted neither as false positives nor false negatives. Therefore in such cases, Precision, Recall and F1 Score are approximations with available prediction statistics.</p>
    </sec>
  </sec>
  <sec id="Sec22">
    <title>Conclusion</title>
    <p id="Par42">Nanopore selective sequencing is an emerging area of genome sequencing that is gaining popularity due to its efficiency and low cost. There have been several attempts to realize selective sequencing with better accuracy and speed. In this paper, we presented DeepSelectNet, a deep learning-based approach for species classification using selective sequencing that outperforms existing methods. Amongst five inter-species datasets evaluated, DeepSelectNet achieved &gt; 90% accuracy (on average <inline-formula id="IEq28"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sim$$\end{document}</tex-math><mml:math id="M56"><mml:mo>∼</mml:mo></mml:math><inline-graphic xlink:href="12859_2023_5151_Article_IEq28.gif"/></alternatives></inline-formula> 95%) for all datasets. DeepSelectNet was bench-marked against existing methods (both deep-learning and non-deep-learning methods) and produced exceedingly top performances across the vast majority of the datasets. In some cases, DeepSelectNet on partial reads (4500 signal samples at the beginning of each read) outperformed the alignment-based approach (high accuracy basecalling + alignment) done on complete reads. DeepSelectNet also performed well in classifying human DNA from bacteria/viral data (&gt; 90% accuracy). However, DeepSelectNet could only achieve &lt; 70% for intra-species classification such as classifying based on different regions of the same species. Thus, the architecture of DeepSelectNet is more suitable for inter-species classification. In terms of execution time, DeepSelectNet outperformed the existing deep-learning-based method. However, DeepSelectNet being a Python-based prototype was several times slower than the C/C++-based Guppy (fast basecalling) + Minimap2 combination. Re-implementation of DeepSelectNet in C/C++ followed by performance tuning would potentially achieve comparable runtime performance.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Information</title>
    <sec id="Sec23">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="12859_2023_5151_MOESM1_ESM.pdf">
            <caption>
              <p><bold>Additional file 1.</bold> Supplementary Information.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn id="Fn1">
      <label>1</label>
      <p id="Par47">The difference between the average prediction of the model and the actual target—high bias means under-fitting.</p>
    </fn>
    <fn id="Fn2">
      <label>2</label>
      <p id="Par48">The variability between the actual target and predicted target—high variance means over-fitting.</p>
    </fn>
    <fn id="Fn3">
      <label>3</label>
      <p id="Par49">translates to <inline-formula id="IEq10"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sim$$\end{document}</tex-math><mml:math id="M58"><mml:mo>∼</mml:mo></mml:math><inline-graphic xlink:href="12859_2023_5151_Article_IEq10.gif"/></alternatives></inline-formula> 300 bases when the adaptor and barcode are removed.</p>
    </fn>
    <fn id="Fn4">
      <label>4</label>
      <p id="Par50">Keras is a high-level API built up on Tensorflow to develop deep neural networks.</p>
    </fn>
    <fn id="Fn5">
      <label>5</label>
      <p id="Par51">there could be overlaps when randomly taking these segments; if the remaining signal length is only 3000 samples, all the four segments will be identical.</p>
    </fn>
    <fn>
      <p>
        <bold>Publisher’s Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <sec>
    <title>Supplementary Information</title>
    <p>The online version contains supplementary material available at 10.1186/s12859-023-05151-0.</p>
  </sec>
  <ack>
    <title>Acknowledgements</title>
    <p>Not applicable</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author contributions</title>
    <p>HG and RR conceived the study. AS designed, developed and optimised the methods. AS, HG and DH planned the experiments. AS and HG conducted the experiments and benchmarks. AS and HG wrote the manuscript. DH and RR revised the manuscript. All authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>Not applicable.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>The source code for DeepSelectNet is available on Github at <ext-link ext-link-type="uri" xlink:href="https://github.com/AnjanaSenanayake/DeepSelectNet">https://github.com/AnjanaSenanayake/DeepSelectNet</ext-link>. The source code for modified SquiggleNet is available on Github at <ext-link ext-link-type="uri" xlink:href="https://github.com/AnjanaSenanayake/SquiggleNet/tree/slow5-support">https://github.com/AnjanaSenanayake/SquiggleNet/tree/slow5-support</ext-link>. All instructions for using the tool can be found in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Note 1. Datasets used are publicly available datasets and their links can be found in Table <xref rid="Tab2" ref-type="table">2</xref>. Additionally, a curated dataset used for DeepSelectNet experiments can be found at <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.5281/zenodo.7111366">https://doi.org/10.5281/zenodo.7111366</ext-link>.</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar1">
      <title>Ethics approval and consent to participate</title>
      <p id="Par43">Not applicable.</p>
    </notes>
    <notes id="FPar2">
      <title>Consent for publication</title>
      <p id="Par44">Not applicable.</p>
    </notes>
    <notes id="FPar3" notes-type="COI-statement">
      <title>Competing interests</title>
      <p id="Par45">H.G. has received travel and accommodation expenses to speak at Oxford Nanopore Technologies conferences. The authors declare that they have no other competing financial or nonfinancial interests.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jain</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Olsen</surname>
            <given-names>HE</given-names>
          </name>
          <name>
            <surname>Paten</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Akeson</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>The oxford nanopore minion: delivery of nanopore sequencing to the genomics community</article-title>
        <source>Genome Biol</source>
        <year>2016</year>
        <volume>17</volume>
        <issue>1</issue>
        <fpage>239</fpage>
        <lpage>239</lpage>
        <pub-id pub-id-type="doi">10.1186/s13059-016-1103-0</pub-id>
        <pub-id pub-id-type="pmid">27887629</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <mixed-citation publication-type="other">Lu H, Giordano F, Ning Z. Oxford nanopore minion sequencing and genome assembly. Genomics Proteomics Bioinform. 2016;14(5):265–279. 10.1016/j.gpb.2016.05.004. SI: Big Data and Precision Medicine</mixed-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mikheyev</surname>
            <given-names>AS</given-names>
          </name>
          <name>
            <surname>Tin</surname>
            <given-names>MM</given-names>
          </name>
        </person-group>
        <article-title>A first look at the oxford nanopore minion sequencer</article-title>
        <source>Mol Ecol Resour</source>
        <year>2014</year>
        <volume>14</volume>
        <issue>6</issue>
        <fpage>1097</fpage>
        <lpage>1102</lpage>
        <pub-id pub-id-type="doi">10.1111/1755-0998.12324</pub-id>
        <pub-id pub-id-type="pmid">25187008</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Castro-Wallace</surname>
            <given-names>SL</given-names>
          </name>
          <name>
            <surname>Chiu</surname>
            <given-names>CY</given-names>
          </name>
          <name>
            <surname>John</surname>
            <given-names>KK</given-names>
          </name>
          <name>
            <surname>Stahl</surname>
            <given-names>SE</given-names>
          </name>
          <name>
            <surname>Rubins</surname>
            <given-names>KH</given-names>
          </name>
          <name>
            <surname>McIntyre</surname>
            <given-names>AB</given-names>
          </name>
          <name>
            <surname>Dworkin</surname>
            <given-names>JP</given-names>
          </name>
          <name>
            <surname>Lupisella</surname>
            <given-names>ML</given-names>
          </name>
          <name>
            <surname>Smith</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>Botkin</surname>
            <given-names>DJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Nanopore DNA sequencing and genome assembly on the international space station</article-title>
        <source>Sci Rep</source>
        <year>2017</year>
        <volume>7</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>12</lpage>
        <pub-id pub-id-type="doi">10.1038/s41598-017-18364-0</pub-id>
        <pub-id pub-id-type="pmid">28127051</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hoenen</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Groseth</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Rosenke</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Fischer</surname>
            <given-names>RJ</given-names>
          </name>
          <name>
            <surname>Hoenen</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Judson</surname>
            <given-names>SD</given-names>
          </name>
          <name>
            <surname>Martellaro</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Falzarano</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Marzi</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Squires</surname>
            <given-names>RB</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Nanopore sequencing as a rapidly deployable ebola outbreak tool</article-title>
        <source>Emerg Infect Dis</source>
        <year>2016</year>
        <volume>22</volume>
        <issue>2</issue>
        <fpage>331</fpage>
        <pub-id pub-id-type="doi">10.3201/eid2202.151796</pub-id>
        <pub-id pub-id-type="pmid">26812583</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Xu</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Ge</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Luo</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Wiedmann</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Deng</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Stevenson</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Baker</surname>
            <given-names>RC</given-names>
          </name>
          <name>
            <surname>Tang</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Evaluation of real-time nanopore sequencing for salmonella serotype prediction</article-title>
        <source>Food Microbiol</source>
        <year>2020</year>
        <volume>89</volume>
        <fpage>103452</fpage>
        <pub-id pub-id-type="doi">10.1016/j.fm.2020.103452</pub-id>
        <pub-id pub-id-type="pmid">32138998</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gigante</surname>
            <given-names>CM</given-names>
          </name>
          <name>
            <surname>Yale</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Condori</surname>
            <given-names>RE</given-names>
          </name>
          <name>
            <surname>Costa</surname>
            <given-names>NC</given-names>
          </name>
          <name>
            <surname>Long</surname>
            <given-names>NV</given-names>
          </name>
          <name>
            <surname>Minh</surname>
            <given-names>PQ</given-names>
          </name>
          <name>
            <surname>Chuong</surname>
            <given-names>VD</given-names>
          </name>
          <name>
            <surname>Tho</surname>
            <given-names>ND</given-names>
          </name>
          <name>
            <surname>Thanh</surname>
            <given-names>NT</given-names>
          </name>
          <name>
            <surname>Thin</surname>
            <given-names>NX</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Portable rabies virus sequencing in canine rabies endemic countries using the oxford nanopore minion</article-title>
        <source>Viruses</source>
        <year>2020</year>
        <volume>12</volume>
        <issue>11</issue>
        <fpage>1255</fpage>
        <pub-id pub-id-type="doi">10.3390/v12111255</pub-id>
        <pub-id pub-id-type="pmid">33158200</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jain</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Koren</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Miga</surname>
            <given-names>KH</given-names>
          </name>
          <name>
            <surname>Quick</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Rand</surname>
            <given-names>AC</given-names>
          </name>
          <name>
            <surname>Sasani</surname>
            <given-names>TA</given-names>
          </name>
          <name>
            <surname>Tyson</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Beggs</surname>
            <given-names>AD</given-names>
          </name>
          <name>
            <surname>Dilthey</surname>
            <given-names>AT</given-names>
          </name>
          <name>
            <surname>Fiddes</surname>
            <given-names>IT</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Nanopore sequencing and assembly of a human genome with ultra-long reads</article-title>
        <source>Nat Biotechnol</source>
        <year>2018</year>
        <volume>36</volume>
        <issue>4</issue>
        <fpage>338</fpage>
        <lpage>345</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.4060</pub-id>
        <pub-id pub-id-type="pmid">29431738</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Miga</surname>
            <given-names>KH</given-names>
          </name>
          <name>
            <surname>Koren</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Rhie</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Vollger</surname>
            <given-names>MR</given-names>
          </name>
          <name>
            <surname>Gershman</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Bzikadze</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Brooks</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Howe</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Porubsky</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Logsdon</surname>
            <given-names>GA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Telomere-to-telomere assembly of a complete human x chromosome</article-title>
        <source>Nature</source>
        <year>2020</year>
        <volume>585</volume>
        <issue>7823</issue>
        <fpage>79</fpage>
        <lpage>84</lpage>
        <pub-id pub-id-type="doi">10.1038/s41586-020-2547-7</pub-id>
        <pub-id pub-id-type="pmid">32663838</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Song</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Hu</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Dong</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Song</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Huang</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>Assembly of a complete mitogenome of chrysanthemum nankingense using oxford nanopore long reads and the diversity and evolution of asteraceae mitogenomes</article-title>
        <source>Genes</source>
        <year>2018</year>
        <volume>9</volume>
        <issue>11</issue>
        <fpage>547</fpage>
        <pub-id pub-id-type="doi">10.3390/genes9110547</pub-id>
        <pub-id pub-id-type="pmid">30424578</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Frei</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Veekman</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Grogg</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Stoffel-Studer</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Morishima</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Shimizu-Inatsugi</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Yates</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Shimizu</surname>
            <given-names>KK</given-names>
          </name>
          <name>
            <surname>Frey</surname>
            <given-names>JE</given-names>
          </name>
          <name>
            <surname>Studer</surname>
            <given-names>B</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Ultralong oxford nanopore reads enable the development of a reference-grade perennial ryegrass genome assembly</article-title>
        <source>Genome Biol Evol</source>
        <year>2021</year>
        <volume>13</volume>
        <issue>8</issue>
        <fpage>159</fpage>
        <pub-id pub-id-type="doi">10.1093/gbe/evab159</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Zhao</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Bollas</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Au</surname>
            <given-names>KF</given-names>
          </name>
        </person-group>
        <article-title>Nanopore sequencing technology, bioinformatics and applications</article-title>
        <source>Nat Biotechnol</source>
        <year>2021</year>
        <volume>39</volume>
        <issue>11</issue>
        <fpage>1348</fpage>
        <lpage>1365</lpage>
        <pub-id pub-id-type="doi">10.1038/s41587-021-01108-x</pub-id>
        <pub-id pub-id-type="pmid">34750572</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <mixed-citation publication-type="other">Loose M, Malla SM. Real-time selective sequencing using nanopore technology. Nat Methods 2016;751–754.</mixed-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <mixed-citation publication-type="other">Ulrich J-U, Lutfi A, Rutzen K, Renard BY. Readbouncer: Precise and scalable adaptive sampling for nanopore sequencing. bioRxiv. 2022.</mixed-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stevanovski</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Chintalaphani</surname>
            <given-names>SR</given-names>
          </name>
          <name>
            <surname>Gamaarachchi</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Ferguson</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Pineda</surname>
            <given-names>SS</given-names>
          </name>
          <name>
            <surname>Scriba</surname>
            <given-names>CK</given-names>
          </name>
          <name>
            <surname>Tchan</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Fung</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Ng</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Cortese</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Comprehensive genetic diagnosis of tandem repeat expansion disorders with programmable targeted nanopore sequencing</article-title>
        <source>Sci Adv</source>
        <year>2022</year>
        <volume>8</volume>
        <issue>9</issue>
        <fpage>5386</fpage>
        <pub-id pub-id-type="doi">10.1126/sciadv.abm5386</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Martin</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Heavens</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Lan</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Horsfield</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Clark</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>Leggett</surname>
            <given-names>RM</given-names>
          </name>
        </person-group>
        <article-title>Nanopore adaptive sampling: a tool for enrichment of low abundance species in metagenomic samples</article-title>
        <source>Genome Biol</source>
        <year>2022</year>
        <volume>23</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>27</lpage>
        <pub-id pub-id-type="doi">10.1186/s13059-021-02582-x</pub-id>
        <pub-id pub-id-type="pmid">34980209</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <mixed-citation publication-type="other">Lin Y, Dai Y, Liu Y, Ren Z, Guo H, Li Z, Li J, Wang K, Yang L, Zhang S, et al. Rapid PCR-based nanopore adaptive sequencing improves sensitivity and timeliness of viral clinical detection and genome surveillance. Front Microbiol. 2022;13.</mixed-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mariya</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Kato</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Sugimoto</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Miyai</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Inagaki</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Ohye</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Sugihara</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Muramatsu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Mizuno</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Kurahashi</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Target enrichment long-read sequencing with adaptive sampling can determine the structure of the small supernumerary marker chromosomes</article-title>
        <source>J Hum Genet</source>
        <year>2022</year>
        <volume>67</volume>
        <issue>6</issue>
        <fpage>363</fpage>
        <lpage>368</lpage>
        <pub-id pub-id-type="doi">10.1038/s10038-021-01004-x</pub-id>
        <pub-id pub-id-type="pmid">35027654</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Marquet</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Zöllkau</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Pastuschek</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Viehweger</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Schleußner</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Makarewicz</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Pletz</surname>
            <given-names>MW</given-names>
          </name>
          <name>
            <surname>Ehricht</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Brandt</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Evaluation of microbiome enrichment and host DNA depletion in human vaginal samples using oxford nanopore’s adaptive sequencing</article-title>
        <source>Sci Rep</source>
        <year>2022</year>
        <volume>12</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>10</lpage>
        <pub-id pub-id-type="doi">10.1038/s41598-022-08003-8</pub-id>
        <pub-id pub-id-type="pmid">34992227</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Edwards</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Krishnakumar</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Sinha</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Bird</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Patel</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Bartsch</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Real-time selective sequencing with rubric: Read until with basecall and reference-informed criteria</article-title>
        <source>Sci Rep</source>
        <year>2019</year>
        <pub-id pub-id-type="doi">10.1038/s41598-019-47857-3</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Payne</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Readfish enables targeted nanopore sequencing of gigabase-sized genomes</article-title>
        <source>Nat Biotechnol</source>
        <year>2021</year>
        <pub-id pub-id-type="doi">10.1038/s41587-020-00746-x</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Minimap2: pairwise alignment for nucleotide sequences</article-title>
        <source>Bioinformatics</source>
        <year>2018</year>
        <volume>34</volume>
        <issue>18</issue>
        <fpage>3094</fpage>
        <lpage>100</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bty191</pub-id>
        <pub-id pub-id-type="pmid">29750242</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kovaka</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Fan</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Ni</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Timp</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Schatz</surname>
            <given-names>MC</given-names>
          </name>
        </person-group>
        <article-title>Targeted nanopore sequencing by real-time mapping of raw electrical signal with uncalled</article-title>
        <source>Nat Biotechnol</source>
        <year>2021</year>
        <volume>39</volume>
        <issue>4</issue>
        <fpage>431</fpage>
        <lpage>441</lpage>
        <pub-id pub-id-type="doi">10.1038/s41587-020-0731-9</pub-id>
        <pub-id pub-id-type="pmid">33257863</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cheng</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>FMtree: a fast locating algorithm of FM-indexes for genomic data</article-title>
        <source>Bioinformatics</source>
        <year>2017</year>
        <volume>34</volume>
        <issue>3</issue>
        <fpage>416</fpage>
        <lpage>24</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btx596</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Boža</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Brejová</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Vinař</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Deepnano: Deep recurrent neural networks for base calling in minion nanopore reads</article-title>
        <source>PLoS ONE</source>
        <year>2017</year>
        <volume>12</volume>
        <issue>6</issue>
        <fpage>1</fpage>
        <lpage>13</lpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0178751</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Teng</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Cao</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>Hall</surname>
            <given-names>MB</given-names>
          </name>
          <name>
            <surname>Duarte</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Coin</surname>
            <given-names>LJ</given-names>
          </name>
        </person-group>
        <article-title>Chiron: translating nanopore raw signal directly into nucleotide sequence using deep learning</article-title>
        <source>GigaScience</source>
        <year>2018</year>
        <volume>7</volume>
        <issue>5</issue>
        <fpage>037</fpage>
        <pub-id pub-id-type="doi">10.1093/gigascience/giy037</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <mixed-citation publication-type="other">Stoiber M, Brown J. Basecrawller: Streaming nanopore basecalling directly from raw signal. BioRxiv, 133058. 2017.</mixed-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Neumann</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Reddy</surname>
            <given-names>AS</given-names>
          </name>
          <name>
            <surname>Ben-Hur</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Rodan: a fully convolutional architecture for basecalling nanopore RNA sequencing data</article-title>
        <source>BMC Bioinform</source>
        <year>2022</year>
        <volume>23</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>9</lpage>
        <pub-id pub-id-type="doi">10.1186/s12859-022-04686-y</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <mixed-citation publication-type="other">Sneddon A, Shirokikh NE, Eyras E. Language-informed basecalling architecture for nanopore direct rna sequencing. bioRxiv. 2022.</mixed-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wick</surname>
            <given-names>RR</given-names>
          </name>
          <name>
            <surname>Judd</surname>
            <given-names>LM</given-names>
          </name>
          <name>
            <surname>Holt</surname>
            <given-names>KE</given-names>
          </name>
        </person-group>
        <article-title>Performance of neural network basecalling tools for oxford nanopore sequencing</article-title>
        <source>Genome Biol</source>
        <year>2019</year>
        <volume>20</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>10</lpage>
        <pub-id pub-id-type="doi">10.1186/s13059-019-1727-y</pub-id>
        <pub-id pub-id-type="pmid">30606230</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Luo</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Wong</surname>
            <given-names>C-L</given-names>
          </name>
          <name>
            <surname>Wong</surname>
            <given-names>Y-S</given-names>
          </name>
          <name>
            <surname>Tang</surname>
            <given-names>C-I</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>C-M</given-names>
          </name>
          <name>
            <surname>Leung</surname>
            <given-names>C-M</given-names>
          </name>
          <name>
            <surname>Lam</surname>
            <given-names>T-W</given-names>
          </name>
        </person-group>
        <article-title>Exploring the limit of using a deep neural network on pileup data for germline variant calling</article-title>
        <source>Nat Mach Intell</source>
        <year>2020</year>
        <volume>2</volume>
        <issue>4</issue>
        <fpage>220</fpage>
        <lpage>227</lpage>
        <pub-id pub-id-type="doi">10.1038/s42256-020-0167-4</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <mixed-citation publication-type="other">Su J, Zheng Z, Ahmed SS, Lam T-W, Luo R. Clair3-trio: high-performance nanopore long-read variant calling in family trios with trio-to-trio deep neural networks. bioRxiv. 2022.</mixed-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bao</surname>
            <given-names>Y</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Squigglenet: real-time, direct classification of nanopore signals</article-title>
        <source>Genome Biol.</source>
        <year>2021</year>
        <pub-id pub-id-type="doi">10.1186/s13059-021-02511-y</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <mixed-citation publication-type="other">He K, Zhang X, Ren S, Sun J. Deep residual learning for image recognition. CoRR <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/1512.03385">arXiv:1512.03385</ext-link> 2015.</mixed-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <mixed-citation publication-type="other">Danilevsky A, Polsky AL, Shomron N. Adaptive sequencing using nanopores and deep learning of mitochondrial DNA. Brief. Bioinform. 2022;23(4):bbac251. 10.1093/bib/bbac251.</mixed-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <mixed-citation publication-type="other">Noordijk B, Nijland R, Carrion VJ, Raaijmakers JM, de Ridder D, de Lannoy C. baseless: lightweight detection of sequences in raw minion data. bioRxiv. 2022. 10.1101/2022.07.10.499286.</mixed-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <mixed-citation publication-type="other">Sneddon A, Ravindran A, Hein N, Shirokikh NE, Eyras E. Real-time biochemical-free targeted sequencing of RNA species with riser. bioRxiv. 2022.</mixed-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <mixed-citation publication-type="other">Elharrouss O, Akbari Y, Almaadeed N, Al-Maadeed SA. Backbones-review: Feature extraction networks for deep learning and deep reinforcement learning approaches. ArXiv <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/2206.08016">arXiv:2206.08016</ext-link> 2022.</mixed-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <mixed-citation publication-type="other">Whole Human Genome Sequencing Project. <ext-link ext-link-type="uri" xlink:href="https://github.com/nanopore-wgs-consortium/NA12878/blob/master/Genome.md#rel6-data">https://github.com/nanopore-wgs-consortium/NA12878/blob/master/Genome.md#rel6-data</ext-link></mixed-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <mixed-citation publication-type="other">Gamaarachchi H. Squigulator. <ext-link ext-link-type="uri" xlink:href="https://github.com/hasindu2008/squigulator">https://github.com/hasindu2008/squigulator</ext-link></mixed-citation>
    </ref>
    <ref id="CR41">
      <label>41.</label>
      <mixed-citation publication-type="other">Gamaarachchi H, Samarakoon H, Jenner SP, Ferguson JM, Amos TG, Hammond JM, Saadat H, Smith MA, Parameswaran S, Deveson IW. Fast nanopore sequencing data analysis with slow5. Nat Biotechnol. 2022;1–4.</mixed-citation>
    </ref>
    <ref id="CR42">
      <label>42.</label>
      <mixed-citation publication-type="other">Hinton GE, Srivastava N, Krizhevsky A, Sutskever I, Salakhutdinov RR. Improving neural networks by preventing co-adaptation of feature detectors. 2012. 10.48550/ARXIV.1207.0580</mixed-citation>
    </ref>
  </ref-list>
</back>
