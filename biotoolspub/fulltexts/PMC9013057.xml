<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">9013057</article-id>
    <article-id pub-id-type="publisher-id">4621</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-022-04621-1</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title><italic>BreakAlign</italic>: a Perl program to align chimaeric (split) genomic NGS reads and allow visual confirmation of novel retroviral integrations</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Marchi</surname>
          <given-names>Emanuele</given-names>
        </name>
        <address>
          <email>emanuele.marchi@ndm.ox.ac.uk</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Jones</surname>
          <given-names>Mathew</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Klenerman</surname>
          <given-names>Paul</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Frater</surname>
          <given-names>John</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Magiorkinis</surname>
          <given-names>Gkikas</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-6234-3947</contrib-id>
        <name>
          <surname>Belshaw</surname>
          <given-names>Robert</given-names>
        </name>
        <address>
          <email>rbelshaw@kean.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.4991.5</institution-id><institution-id institution-id-type="ISNI">0000 0004 1936 8948</institution-id><institution>Nuffield Department of Medicine, </institution><institution>University of Oxford, </institution></institution-wrap>Oxford, UK </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.5216.0</institution-id><institution-id institution-id-type="ISNI">0000 0001 2155 0800</institution-id><institution>Department of Hygiene, Epidemiology and Medical Statistics, Medical School, </institution><institution>National and Kapodistrian University of Athens, </institution></institution-wrap>Athens, Greece </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="GRID">grid.507057.0</institution-id><institution-id institution-id-type="ISNI">0000 0004 1779 9453</institution-id><institution>Department of Biology, College of Science and Technology, </institution><institution>Wenzhou-Kean University, </institution></institution-wrap>Wenzhou, Zhejiang Province China </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>15</day>
      <month>4</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>15</day>
      <month>4</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2022</year>
    </pub-date>
    <volume>23</volume>
    <elocation-id>134</elocation-id>
    <history>
      <date date-type="received">
        <day>4</day>
        <month>2</month>
        <year>2021</year>
      </date>
      <date date-type="accepted">
        <day>28</day>
        <month>2</month>
        <year>2022</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2022</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold>This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">Retroviruses replicate by integrating a DNA copy into a host chromosome. Detecting novel retroviral integrations (ones not in the reference genome sequence of the host) from genomic NGS data is bioinformatically challenging and frequently produces many false positives. One common method of confirmation is visual inspection of an alignment of the chimaeric (split) reads that span a putative novel retroviral integration site. We perceived the need for a program that would facilitate this by producing a multiple alignment containing both the viral and host regions that flank an integration.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2"><italic>BreakAlign</italic> is a Perl program that uses <italic>blastn</italic> to produce such a multiple alignment. In addition to the NGS dataset and a reference viral sequence, the program requires either (a) the ~ 500nt host genome sequence that spans the putative integration or (b) coordinates of this putative integration in an installed copy of the reference human genome (multiple integrations can be processed automatically). <italic>BreakAlign</italic> is freely available from <ext-link ext-link-type="uri" xlink:href="https://github.com/marchiem/breakalign">https://github.com/marchiem/breakalign</ext-link> and is accompanied by example files allowing a test run.</p>
      </sec>
      <sec>
        <title>Conclusion</title>
        <p id="Par3"><italic>BreakAlign</italic> will confirm and facilitate characterisation of both (a) germline integrations of endogenous retroviruses and (b) somatic integrations of exogenous retroviruses such as HIV and HTLV. Although developed for use with genomic short-read NGS (second generation) data and retroviruses, it should also be useful for long-read (third generation) data and any mobile element with at least one conserved flanking region.</p>
      </sec>
      <sec>
        <title>Supplementary Information</title>
        <p>The online version contains supplementary material available at 10.1186/s12859-022-04621-1.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>NGS</kwd>
      <kwd>Retrovirus</kwd>
      <kwd>Provirus</kwd>
      <kwd>Integration</kwd>
      <kwd>Insertion</kwd>
      <kwd>Detection</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100004440</institution-id>
            <institution>Wellcome Trust</institution>
          </institution-wrap>
        </funding-source>
        <award-id>WT086173</award-id>
        <principal-award-recipient>
          <name>
            <surname>Belshaw</surname>
            <given-names>Robert</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100004440</institution-id>
            <institution>wellcome trust</institution>
          </institution-wrap>
        </funding-source>
        <award-id>WT109965MA</award-id>
        <principal-award-recipient>
          <name>
            <surname>Klenerman</surname>
            <given-names>Paul</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2022</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par14">Retroviruses replicate by integration of their genome into a host chromosome. Over millions of years, integration into germline cells has led to endogenous retroviruses (ERVs) making up 8% of our—and other mammal—genome sequences [<xref ref-type="bibr" rid="CR1">1</xref>], and exogenous retroviruses (XRVs) such as HIV and HTLV can persist in replicating somatic cells. Detecting the integration sites of XRVs and non-reference (not in the host reference genome) ERVs, and other transposable elements is hindered by (a) the sequence similarity of any one integrated element to many others and (b) approximately half the genome is composed of transposable elements so the flanking regions of many integrations are similar to other genomic regions. These problems have resulted in 20 programs designed to detect and report the genomic coordinates of integrations [<xref ref-type="bibr" rid="CR2">2</xref>]. A benchmarking study using non-reference transposable elements structurally similar to retroviruses [<xref ref-type="bibr" rid="CR3">3</xref>] showed marked differences in performance with common problems in precision (false positives). Vy-PER [<xref ref-type="bibr" rid="CR4">4</xref>] and STEAK [<xref ref-type="bibr" rid="CR5">5</xref>] are additional recent additions specifically for retroviral integrations. The gold-standard validation of non-reference integrations involves cloning [<xref ref-type="bibr" rid="CR6">6</xref>] but researchers often use visual inspection and present graphical images of the read alignment with the viral LTR (Long Terminal Repeat) and TSD (Target Site Duplication) [<xref ref-type="bibr" rid="CR7">7</xref>–<xref ref-type="bibr" rid="CR10">10</xref>]. The presence of a TSD is strong evidence of an integration. We perceived the need for a program to facilitate this visual validation and present <italic>BreakAlign</italic> as a stand-alone program, having written a prototype as the final confirmatory step in a pipeline to detect non-reference integrations in one lineage of ERVs—Human Endogenous Retrovirus type K (HERV-K) [<xref ref-type="bibr" rid="CR9">9</xref>]. We now also use <italic>BreakAlign</italic> to measure clonal expansion of somatic cells carrying HIV-1 integrations (unpublished data).</p>
    <p id="Par15"><italic>BreakAlign</italic> provides visual validation of novel retroviral integrations (i.e. ones not in the reference genome sequence), whose putative coordinates have been output from one of the many detection programs. The input is NGS (Next—or second—Generation Sequencing) reads from whole genome sequencing (WGS) with or without experimental [<xref ref-type="bibr" rid="CR11">11</xref>] or bioinformatic (in silico) enrichment procedures [<xref ref-type="bibr" rid="CR9">9</xref>]. Briefly, <italic>BreakAlign</italic> uses <italic>blastn</italic> to compare reads to the virus and host genome and extract those chimaeric ('split') reads that contain both viral and host DNA sequences (i.e. which span the input integration site). The program then presents these reads in a multiple alignment to the genomic region. (In addition to validating the integration, this file could for example also be used to measure clonal expansion.)</p>
  </sec>
  <sec id="Sec2">
    <title>Implementation</title>
    <sec id="Sec3">
      <title>Overview</title>
      <p id="Par16"><italic>BreakAlign</italic> is a Perl program intended to be run in UNIX (including Mac OSX—not Mac Desktop Cloud) that uses <italic>blastn</italic> to find chimaeric sequences within a FASTA NGS read file and align them to the host genome sequence (Fig. <xref rid="Fig1" ref-type="fig">1</xref>). In this alignment, the existence of a TSD (Target Site Duplication) and identity of host flanking and viral sequences confirms a true integration rather than a sequencing artefact or alignment error. <italic>BreakAlign</italic> is downloadable from <ext-link ext-link-type="uri" xlink:href="https://github.com/marchiem/breakalign">https://github.com/marchiem/breakalign</ext-link> together with the files necessary for a test run using the command line example below. Program options are summarised below (also in Additional file <xref rid="MOESM1" ref-type="media">1</xref>; '<xref rid="Sec7" ref-type="sec">Program Options</xref>') and can be shown with the -help switch.<fig id="Fig1"><label>Fig. 1</label><caption><p>Sample output from <italic>BreakAlign</italic> showing an illustrative HERV-K integration. The top line is the section of the host genome spanning the integration site. Numbered sequences below show individual NGS reads aligned to the host genome with viral DNA in lower case, red and underlined (viral sequences on the left are the 3′ end of the 3′ LTR; viral sequences on the right are the 5′ end of the 5′ LTR). Reads containing insertion/deletions (indels) are indicated, with insertions and substitutions shown in lower case and deletions shown as hyphens. The intervening 'TGGT' motif is the TSD—see Marchi et al. [<xref ref-type="bibr" rid="CR9">9</xref>] for a detailed explanation of how the TSD is formed and the adjacent HERV-K LTR sequences in both forward and reverse orientation integrations. Note, in this integration there is a known A to G substitution in the upstream TSD [<xref ref-type="bibr" rid="CR7">7</xref>, <xref ref-type="bibr" rid="CR8">8</xref>] which leads to the characteristic six nucleotide HERV-K TSD—in this case TGGTAA—appearing to be shortened to only four nucleotides. Image shown is the output HTML file, and a text version without colours or underlining is also output</p></caption><graphic xlink:href="12859_2022_4621_Fig1_HTML" id="MO1"/></fig></p>
    </sec>
    <sec id="Sec4">
      <title>Sample command line</title>
      <p id="Par17">$ perl breakalign.pl -f chr19_29855576_29856018.fa -r NGSreads.fa -vr LTR.fa</p>
      <p id="Par18">The above sample LTR, genome sequence and read files are with breakalign.pl on the GitHub site and will generate the alignment in Fig. <xref rid="Fig1" ref-type="fig">1</xref>. For a test run using HIV-1 instead of HERV-K, use the following command line (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S1; data from [<xref ref-type="bibr" rid="CR11">11</xref>]. The read file (NGSreads.fa) is a toy dataset: any real FASTA-format NGS file can be used here.</p>
      <p id="Par19">$ perl breakalign.pl -f chr21_14511311_14511999.fa -r NGSreads.fa -vr LTR-HIV.fa</p>
    </sec>
    <sec id="Sec5">
      <title>Executing the program</title>
      <sec id="Sec6">
        <title>Program details</title>
        <p id="Par20"><italic>BreakAlign</italic> runs from the command line in UNIX operating systems (including Mac OSX) with Perl 5. It was designed on a Linux machine (Ubuntu 16.04) with <italic>blastn</italic> version 2.2.31+, perl subversion v5.22.1. We have also tested it on <italic>blastn</italic> version 2.2.27+. <italic>BreakAlign</italic> generates a local database (using <italic>makeblastdb</italic>) of the read file to make a computationally more efficient alignment of reads (used as subjects) to the host reference region (used as query sequence). The BioPerl module <italic>SeqIO</italic> is required only if the human reference genome is to be used (we developed <italic>BreakAlign</italic> using BioPerl core modules v1.6.924-3). The steps in <italic>BreakAlign</italic> are illustrated in Fig. <xref rid="Fig2" ref-type="fig">2</xref>. The program requires four inputs listed below.<list list-type="order"><list-item><p id="Par21"><italic>BreakAlign</italic> runs <italic>blastn</italic> in NCBI's BLAST + package (the earlier <italic>blastall</italic> version will not work). <italic>BreakAlign</italic> will check for a system <italic>blastn</italic> installation or you can provide a directory path to a local <italic>blastn</italic> installation using either the -bp switch or writing the <italic>blastn</italic> directory into line 20 of the script (paths must end in /bin/).</p></list-item><list-item><p id="Par22">A FASTA file of the viral LTR sequence indicated by the -vr switch. An LTR sequence for HERV-K is provided on the GitHub site.</p></list-item><list-item><p id="Par23">An NGS read file in FASTA format indicated by the -r switch. <italic>BreakAlign</italic> can be used with WGS files but works best with pre-filtered read files from bioinformatic "enrichment"—filtering out reads that map well to the host reference. In Additional file <xref rid="MOESM1" ref-type="media">1</xref> ('NGS read preparation’), we provide guidance on how to reduce the size of WGS BAM files—taking advantage of the fact that the desired chimaeric reads will not map well to the reference genome. Smaller read files can also be generated using an enriched sequencing protocol, <italic>e.g.</italic> where the library is generated from DNA hybridizing to viral LTR probes. Building the initial <italic>blastn</italic> database is the only time-consuming part. Help to convert these files to FASTA format, and to combine paired-end FASTQ files into a single FASTA file, is also given in Additional file <xref rid="MOESM1" ref-type="media">1</xref>.</p></list-item><list-item><p id="Par24">The putative integration site can be input in one of two ways. (a) An approximately 500nt human genomic sequence in FASTA format that spans the putative integration site can be input using the -f switch (see sample command line). This length will allow all chimaeric NGS reads, both up- and downstream of the integration, to be arranged in a multiple alignment such as the one shown in Fig. <xref rid="Fig1" ref-type="fig">1</xref>. (b) <italic>BreakAlign</italic> can retrieve automatically the reference sequence spanning the putative integration site from an installed copy of the reference human genome. This genome must be downloaded from either the UCSC website (<ext-link ext-link-type="uri" xlink:href="http://hgdownload.soe.ucsc.edu/goldenPath/hg19/chromosomes/">http://hgdownload.soe.ucsc.edu/goldenPath/hg19/chromosomes/</ext-link>) or from the NCBI–NIH genomes FTP site (<ext-link ext-link-type="uri" xlink:href="ftp://ftp.ncbi.nih.gov/genomes">ftp://ftp.ncbi.nih.gov/genomes</ext-link>). The download will contain chromosomes as individual FASTA file within in a single folder (chr1.fa, chr2.fa, etc.). To use this option the following are also required.<list list-type="bullet"><list-item><label/><p id="Par26">The BioPerl module SeqIO must be installed (see Additional file <xref rid="MOESM1" ref-type="media">1</xref>, 'Program Requirements').</p></list-item><list-item><label/><p id="Par27">Indicate the directory path where the host reference genome sequence is stored using the -fr switch (/path/to/reference_folder/).</p></list-item><list-item><label/><p id="Par28">Either<list list-type="alpha-lower"><list-item><p id="Par29">a single coordinate range spanning the putative integration site can be provided as a string in the format ‘chrN:start–end’ using the -c switch (e.g. chr16:89,577,447–89,578,013). We suggest approximately 500nts.</p></list-item><list-item><p id="Par30">or a bed file with multiple coordinates can be provided using the -bf switch. The following sample command line will recover both the HERV-K chromosome 19 integration illustrated in Fig. <xref rid="Fig1" ref-type="fig">1</xref> plus another in chromosome 5 (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S2) using the toy chromosome sequences in the Human_ref folder in GitHib. By default <italic>BreakAlign</italic> will build a new <italic>blastn</italic> database for each coordinate, which can be time consuming, so the -kd switch will keep and reuse this database (you will need to delete this All_reads_db database manually at the end if you do not wish it to be reused in the next run).</p></list-item></list></p></list-item></list></p></list-item></list><fig id="Fig2"><label>Fig. 2</label><caption><p>Flow chart illustrating the basic steps within <italic>BreakAlign</italic>. Parts of chimaeric reads that align to the virus are shown in red. Generating the local <italic>blastn</italic> database can be time-consuming (see text). Other stages in <italic>Breakalign</italic> will typically take a minute or less</p></caption><graphic xlink:href="12859_2022_4621_Fig2_HTML" id="MO2"/></fig></p>
        <p id="Par31">$ perl breakalign.pl -bf coord.bed -r NGSreads.fa -vr LTR.fa -fr Human_ref/</p>
      </sec>
      <sec id="Sec7">
        <title>Program options</title>
        <p id="Par32">A full list is provided in Additional file <xref rid="MOESM1" ref-type="media">1</xref> ('<xref rid="Sec7" ref-type="sec">Program Options</xref>') and via the -help switch. The key ones are as follows.</p>
        <p id="Par33">The following two are necessary for all runs (plus paths if the file is not in the same directory as <italic>BreakAlign</italic>).<list list-type="simple"><list-item><label>-vr</label><p>File with the viral (LTR) sequence.</p></list-item><list-item><label>-r</label><p id="Par36">The NGS read file.</p></list-item></list></p>
        <p id="Par37">One (only) of the following is required.<list list-type="simple"><list-item><label>-f</label><p id="Par39">This is the file with the user-supplied reference sequence.</p></list-item><list-item><label>-fr</label><p id="Par40">Path to the reference folder containing a FASTA file for each chromosome.</p></list-item></list></p>
        <p id="Par41">One of the two following options is also required with the -fr switch.<list list-type="simple"><list-item><label>-c</label><p id="Par43">Text giving a single genome coordinate in the form &lt; Chr&gt; : &lt; Start&gt;- &lt;Stop&gt; (e.g. chr16:89577447–89578013).</p></list-item><list-item><label>-bf</label><p id="Par44">A file in bed format containing multiple coordinates to test.</p></list-item></list></p>
        <p id="Par45">If multiple integrations are being tested using the same NGS read file, either using the -bf switch or entering coordinates manually, then the -kd switch will allow the program to reuse the initial <italic>blastn</italic> database (from <italic>makeblastdb</italic>) in the subsequent run(s). The most time-consuming part of running <italic>BreakAlign</italic> is building this initial database of all reads against the genome sequence flanking the putative integration.</p>
      </sec>
    </sec>
  </sec>
  <sec id="Sec8">
    <title>Results and discussion</title>
    <p id="Par46">In addition to validating the integration, the aligned reads from <italic>BreakAlign</italic> can be further processed and counted, e.g. in analyses of enriched NGS sequencing (following sonication) of blood cell DNA to measure clonal expansion in relation to development of disease in HTLV-1 infection [<xref ref-type="bibr" rid="CR12">12</xref>] and persistence despite drug therapy in HIV-1 infection [<xref ref-type="bibr" rid="CR13">13</xref>]. We have used <italic>BreakAlign</italic> in the manner described above to confirm long-term persistence of specific HIV-1 integrations in patients (data not shown).</p>
    <p id="Par47">This output can also be used for distinguishing between the homozygous and heterozygous status of ERV integrations by searching for non-chimaeric reads spanning the integration site, which will be either absent or of similar abundance [<xref ref-type="bibr" rid="CR9">9</xref>].</p>
    <p id="Par48">The capture of chimaeric reads can be enriched through the employment of various laboratory protocols and/or by in silico enrichment from WGS libraries. Such target enrichment typically produces in the order of a million reads compared to &gt; 100 million in a typical TCGA (NCI's The Cancer Genome Atlas) library, which are very time-consuming to process. As suggested in “<xref rid="Sec6" ref-type="sec">Program details</xref>” above, removing all reads with a good match to the reference genome (which are therefore unlikely to be chimaeric) from whole genome BAM files will produce a much smaller FASTA read file (&lt; 40 GB) that <italic>BreakAlign</italic> will process in under 2 h on most LINUX or Mac computers. Most of this time is used creating the initial <italic>blastn</italic> database, and using the -kd switch to retain this database will allow rapid validation of multiple putative integrations.</p>
    <p id="Par49">The advantages of <italic>BreakAlign</italic> over standard read-mapping and visualisation software are that (a) we can for the first time readily inspect the contiguous nucleotide sequences of the TSD and LTRs and (b) <italic>BreakAlign</italic> recovers more chimaeric reads, e.g. the default setting requires only 10 nucleotides to match the human reference genome and 10 to match the viral reference sequence. In Additional file <xref rid="MOESM1" ref-type="media">1</xref> ('Comparison with existing software') we give examples of <italic>BreakAlign</italic> recovering over 50% more chimaeric reads than standard aligners<italic>.</italic></p>
    <p id="Par50"><italic>BreakAlign</italic> has been written to confirm retroviral integrations, and its requirement of an initial 10nt exact match to the LTR will prevent it working on extremely old or fragmentary integrations. It should, however, work with any transposable element that has conserved flanking regions, which could be used instead of an LTR file. Similarly, retroviral integrations in non-human genomes could be analysed (if coordinates and a reference genome are used, these will need to use our chromosome-based nomenclature).</p>
    <p id="Par51">Finally, we look forward to development of accurate long-read (third generation) technology, which will make working with retroviral integrations much easier because such reads are capable of spanning the full integration. <italic>BreakAlign</italic> should work with long-reads and, as with the other possible uses mentioned above, we welcome future collaboration. We anticipate that the mapping and base quality of individual reads will be more of an issue with long reads (<italic>BreakAlign</italic> does not at present consider these). Lowering the length of the starting exact match required against the genome reference and LTR (-ws and -ws2 respectively) may be necessary. Debladis et al. [<xref ref-type="bibr" rid="CR14">14</xref>] give an example of detecting novel integrations in <italic>Arabidopsis</italic> using MinIon reads, including what may be the first example of a complete LTR-retrotransposon (a selfish genetic element similar to an endogenous retrovirus) integration recovered in a single sequencing read.</p>
  </sec>
  <sec id="Sec9">
    <title>Conclusions</title>
    <p id="Par52">Confirmation of retroviral integrations that are not in the reference genome—both unfixed germline integrations of endogenous retroviruses or somatic integrations of exogenous retroviruses—require either individual PCR or observation of the resulting LTR ends with the characteristic TSD. We have created <italic>BreakAlign</italic> to allow the user to use the latter approach and confirm the presence of a novel retroviral integration in WGS NGS data.</p>
  </sec>
  <sec id="Sec10">
    <title>Availability and requirements</title>
    <p id="Par53"><bold>Project name:</bold> BreakAlign</p>
    <p id="Par54">
      <bold>Project home page:</bold>
      <ext-link ext-link-type="uri" xlink:href="https://github.com/marchiem/breakalign">https://github.com/marchiem/breakalign</ext-link>
    </p>
    <p id="Par55"><bold>Operating system(s):</bold> UNIX</p>
    <p id="Par56"><bold>Programming language:</bold> Perl</p>
    <p id="Par57"><bold>Other requirements:</bold> BLAST+</p>
    <p id="Par58"><bold>License:</bold> GNU GPL</p>
    <p id="Par59"><bold>Any restrictions to use by non-academics:</bold> No.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Information</title>
    <sec id="Sec11">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="12859_2022_4621_MOESM1_ESM.pdf">
            <caption>
              <p><bold>Additional file 1.</bold> Pdf format file with more detail on using <italic>BreakAlign</italic> plus <bold>Figs. S1.</bold> and <bold>S2.</bold></p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>ERV</term>
        <def>
          <p id="Par4">Endogenous Retrovirus</p>
        </def>
      </def-item>
      <def-item>
        <term>HERV-K</term>
        <def>
          <p id="Par5">Human Endogenous Retrovirus type K (HML2)</p>
        </def>
      </def-item>
      <def-item>
        <term>HIV</term>
        <def>
          <p id="Par6">Human Immunodeficiency Virus</p>
        </def>
      </def-item>
      <def-item>
        <term>HTLV</term>
        <def>
          <p id="Par7">Human T cell Lymphotrophic Virus</p>
        </def>
      </def-item>
      <def-item>
        <term>LTR</term>
        <def>
          <p id="Par8">Long Terminal Repeat</p>
        </def>
      </def-item>
      <def-item>
        <term>NGS</term>
        <def>
          <p id="Par9">Next Generation Sequencing</p>
        </def>
      </def-item>
      <def-item>
        <term>TCGA</term>
        <def>
          <p id="Par10">NCI's The Cancer Genome Atlas project</p>
        </def>
      </def-item>
      <def-item>
        <term>TSD</term>
        <def>
          <p id="Par11">Target Site Duplication</p>
        </def>
      </def-item>
      <def-item>
        <term>WGS</term>
        <def>
          <p id="Par12">Whole Genome Sequencing</p>
        </def>
      </def-item>
      <def-item>
        <term>XRV</term>
        <def>
          <p id="Par13">Exogenous Retrovirus (free-living, horizontally transmitted)</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher's Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>Not applicable.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors' contributions</title>
    <p>EM and RB wrote the article with help from PK and JF. EM designed and wrote the software with help from MJ, GM and RB. All authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>Initial work was supported by a Wellcome Trust grant to RB (grant number WT086173). PK and EM are funded by a Wellcome Trust grant (WT109965MA) and the NIHR Biomedical Research Centre, Oxford. The views expressed are those of the authors and not necessarily those of the NHS, the NIHR or the Department of Health. PK is an NIHR SF.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>All data generated or analysed during this study are included in this published article's online additional files.</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar1">
      <title>Ethics approval and consent to participate</title>
      <p id="Par60">Not applicable.</p>
    </notes>
    <notes id="FPar2">
      <title>Consent for publication</title>
      <p id="Par61">Not applicable.</p>
    </notes>
    <notes id="FPar3" notes-type="COI-statement">
      <title>Competing interests</title>
      <p id="Par62">The authors declare that they have no competing interests.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cordaux</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Batzer</surname>
            <given-names>MA</given-names>
          </name>
        </person-group>
        <article-title>The impact of retrotransposons on human genome evolution</article-title>
        <source>Nat Rev Genet</source>
        <year>2009</year>
        <volume>10</volume>
        <fpage>691</fpage>
        <lpage>703</lpage>
        <pub-id pub-id-type="doi">10.1038/nrg2640</pub-id>
        <pub-id pub-id-type="pmid">19763152</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ewing</surname>
            <given-names>AD</given-names>
          </name>
        </person-group>
        <article-title>Transposable element detection from whole genome sequence data</article-title>
        <source>Mob DNA</source>
        <year>2015</year>
        <volume>6</volume>
        <fpage>24</fpage>
        <pub-id pub-id-type="doi">10.1186/s13100-015-0055-3</pub-id>
        <pub-id pub-id-type="pmid">26719777</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Vendrell-Mir</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Barteri</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Merenciano</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>González</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Casacuberta</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Castanera</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>A benchmark of transposon insertion detection tools using real data</article-title>
        <source>Mob DNA</source>
        <year>2019</year>
        <volume>10</volume>
        <fpage>53</fpage>
        <pub-id pub-id-type="doi">10.1186/s13100-019-0197-9</pub-id>
        <pub-id pub-id-type="pmid">31892957</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Forster</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Szymczak</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Ellinghaus</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Hemmrich</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Rühlemann</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Kraemer</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Mucha</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Wienbrandt</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Stanulla</surname>
            <given-names>MA</given-names>
          </name>
          <collab>UFO Sequencing Consortium within the I-BFM Study Group</collab>
          <name>
            <surname>Franke</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Vy-PER: eliminating false positive detection of virus integration events in next generation sequencing data</article-title>
        <source>Sci Rep</source>
        <year>2015</year>
        <volume>5</volume>
        <fpage>11534</fpage>
        <pub-id pub-id-type="doi">10.1038/srep11534</pub-id>
        <pub-id pub-id-type="pmid">26166306</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Santander</surname>
            <given-names>CG</given-names>
          </name>
          <name>
            <surname>Gambron</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Marchi</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Karamitros</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Katzourakis</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Magiorkinis</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>STEAK: a specific tool for transposable elements and retrovirus detection in high-throughput sequencing data</article-title>
        <source>Virus Evol</source>
        <year>2017</year>
        <volume>3</volume>
        <fpage>vex023</fpage>
        <pub-id pub-id-type="doi">10.1093/ve/vex023</pub-id>
        <pub-id pub-id-type="pmid">28948042</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Evrony</surname>
            <given-names>GD</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Park</surname>
            <given-names>PJ</given-names>
          </name>
          <name>
            <surname>Walsh</surname>
            <given-names>CA</given-names>
          </name>
        </person-group>
        <article-title>Resolving rates of mutation in the brain using single-neuron genomics</article-title>
        <source>eLife</source>
        <year>2016</year>
        <volume>5</volume>
        <fpage>e12966</fpage>
        <pub-id pub-id-type="doi">10.7554/eLife.12966</pub-id>
        <pub-id pub-id-type="pmid">26901440</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Agoni</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Golden</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Guha</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Lenz</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Neandertal and Denisovan retroviruses</article-title>
        <source>Curr Biol</source>
        <year>2012</year>
        <volume>22</volume>
        <fpage>R437</fpage>
        <lpage>R438</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cub.2012.04.049</pub-id>
        <pub-id pub-id-type="pmid">22677281</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Marchi</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Kanapin</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Byott</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Magiorkinis</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Belshaw</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Neandertal and Denisovan retroviruses in modern humans</article-title>
        <source>Curr Biol</source>
        <year>2013</year>
        <volume>23</volume>
        <fpage>R994</fpage>
        <lpage>R995</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cub.2013.10.028</pub-id>
        <pub-id pub-id-type="pmid">24262833</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Marchi</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Kanapin</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Magiorkinis</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Belshaw</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Unfixed endogenous retroviral insertions in the human population</article-title>
        <source>J Virol</source>
        <year>2014</year>
        <volume>88</volume>
        <fpage>9529</fpage>
        <lpage>9537</lpage>
        <pub-id pub-id-type="doi">10.1128/JVI.00919-14</pub-id>
        <pub-id pub-id-type="pmid">24920817</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wildschutte</surname>
            <given-names>JH</given-names>
          </name>
          <name>
            <surname>Williams</surname>
            <given-names>ZH</given-names>
          </name>
          <name>
            <surname>Montesion</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Subramanian</surname>
            <given-names>RP</given-names>
          </name>
          <name>
            <surname>Kidd</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Coffin</surname>
            <given-names>JM</given-names>
          </name>
        </person-group>
        <article-title>Discovery of unfixed endogenous retrovirus insertions in diverse human populations</article-title>
        <source>Proc Natl Acad Sci USA</source>
        <year>2016</year>
        <volume>113</volume>
        <fpage>E2326</fpage>
        <lpage>E2334</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.1602336113</pub-id>
        <pub-id pub-id-type="pmid">27001843</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sunshine</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Kirchner</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Amr</surname>
            <given-names>SS</given-names>
          </name>
          <name>
            <surname>Mansur</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Shakhbatyan</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Bosque</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Siliciano</surname>
            <given-names>RF</given-names>
          </name>
          <name>
            <surname>Planelles</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Hofmann</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Ho Sui</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>JZ</given-names>
          </name>
        </person-group>
        <article-title>HIV integration site analysis of cellular models of HIV latency with a probe-enriched next-generation sequencing assay</article-title>
        <source>J Virol</source>
        <year>2016</year>
        <volume>90</volume>
        <fpage>4511</fpage>
        <lpage>4519</lpage>
        <pub-id pub-id-type="doi">10.1128/JVI.01617-15</pub-id>
        <pub-id pub-id-type="pmid">26912621</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gillet</surname>
            <given-names>NA</given-names>
          </name>
          <name>
            <surname>Malani</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Melamed</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Gormley</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Carter</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Bentley</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Berry</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Bushman</surname>
            <given-names>FD</given-names>
          </name>
          <name>
            <surname>Taylor</surname>
            <given-names>GP</given-names>
          </name>
          <name>
            <surname>Bangham</surname>
            <given-names>CRM</given-names>
          </name>
        </person-group>
        <article-title>The host genomic environment of the provirus determines the abundance of HTLV-1-infected T-cell clones</article-title>
        <source>Blood</source>
        <year>2011</year>
        <volume>117</volume>
        <fpage>3113</fpage>
        <lpage>3122</lpage>
        <pub-id pub-id-type="doi">10.1182/blood-2010-10-312926</pub-id>
        <pub-id pub-id-type="pmid">21228324</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Maldarelli</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Su</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Simonetti</surname>
            <given-names>FR</given-names>
          </name>
          <name>
            <surname>Shao</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Hill</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Spindler</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Ferris</surname>
            <given-names>AL</given-names>
          </name>
          <name>
            <surname>Mellors</surname>
            <given-names>JW</given-names>
          </name>
          <name>
            <surname>Kearney</surname>
            <given-names>MF</given-names>
          </name>
          <name>
            <surname>Coffin</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Hughes</surname>
            <given-names>SH</given-names>
          </name>
        </person-group>
        <article-title>Specific HIV integration sites are linked to clonal expansion and persistence of infected cells</article-title>
        <source>Science</source>
        <year>2014</year>
        <volume>345</volume>
        <fpage>179</fpage>
        <lpage>183</lpage>
        <pub-id pub-id-type="doi">10.1126/science.1254194</pub-id>
        <pub-id pub-id-type="pmid">24968937</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Debladis</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Llauro</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Carpentier</surname>
            <given-names>M-C</given-names>
          </name>
          <name>
            <surname>Mirouze</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Panaud</surname>
            <given-names>O</given-names>
          </name>
        </person-group>
        <article-title>Detection of active transposable elements in <italic>Arabidopsis thaliana</italic> using Oxford Nanopore Sequencing technology</article-title>
        <source>BMC Genom</source>
        <year>2017</year>
        <volume>18</volume>
        <fpage>537</fpage>
        <pub-id pub-id-type="doi">10.1186/s12864-017-3753-z</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
