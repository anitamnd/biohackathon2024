<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d1 20130915//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 39.96?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-id journal-id-type="hwp">bioinfo</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">4734042</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btv584</article-id>
    <article-id pub-id-type="publisher-id">btv584</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Papers</subject>
        <subj-group subj-group-type="heading">
          <subject>Sequence Analysis</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>SUPER-FOCUS: a tool for agile functional analysis of shotgun metagenomic data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Silva</surname>
          <given-names>Genivaldo Gueiros Z.</given-names>
        </name>
        <xref ref-type="aff" rid="btv584-AFF1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Green</surname>
          <given-names>Kevin T.</given-names>
        </name>
        <xref ref-type="aff" rid="btv584-AFF2">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Dutilh</surname>
          <given-names>Bas E.</given-names>
        </name>
        <xref ref-type="aff" rid="btv584-AFF3">
          <sup>3</sup>
        </xref>
        <xref ref-type="aff" rid="btv584-AFF4">
          <sup>4</sup>
        </xref>
        <xref ref-type="aff" rid="btv584-AFF5">
          <sup>5</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Edwards</surname>
          <given-names>Robert A.</given-names>
        </name>
        <xref ref-type="aff" rid="btv584-AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="btv584-AFF2">
          <sup>2</sup>
        </xref>
        <xref ref-type="aff" rid="btv584-AFF5">
          <sup>5</sup>
        </xref>
        <xref ref-type="aff" rid="btv584-AFF6">
          <sup>6</sup>
        </xref>
        <xref ref-type="aff" rid="btv584-AFF7">
          <sup>7</sup>
        </xref>
        <xref ref-type="corresp" rid="btv584-COR1">*</xref>
      </contrib>
      <aff id="btv584-AFF1"><sup>1</sup>Computational Science Research Center</aff>
      <aff id="btv584-AFF2"><sup>2</sup>Department of Biology, San Diego State University, San Diego, CA 92182, USA</aff>
      <aff id="btv584-AFF3"><sup>3</sup>Theoretical Biology and Bioinformatics, Utrecht University, 3584 CH, Utrecht, The Netherlands</aff>
      <aff id="btv584-AFF4"><sup>4</sup>Centre for Molecular and Biomolecular Informatics, Radboud Institute for Molecular Life Sciences, Radboud University Medical Centre, 6525 GA, Nijmegen, The Netherlands</aff>
      <aff id="btv584-AFF5"><sup>5</sup>Department of Marine Biology, Institute of Biology, Federal University of Rio de Janeiro, Brazil</aff>
      <aff id="btv584-AFF6"><sup>6</sup>Department of Computer Science, San Diego State University, San Diego, CA 92182, USA</aff>
      <aff id="btv584-AFF7"><sup>7</sup>Division of Mathematics and Computer Science, Argonne National Laboratory, Argonne, IL 60439, USA</aff>
    </contrib-group>
    <author-notes>
      <corresp id="btv584-COR1">*To whom correspondence should be addressed.</corresp>
      <fn id="FN100">
        <p>Associate Editor: Inanc Birol</p>
      </fn>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>01</day>
      <month>2</month>
      <year>2016</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>09</day>
      <month>10</month>
      <year>2015</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>09</day>
      <month>10</month>
      <year>2015</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the
							<pub-date pub-type="epub"/>. -->
    <volume>32</volume>
    <issue>3</issue>
    <fpage>354</fpage>
    <lpage>361</lpage>
    <history>
      <date date-type="received">
        <day>1</day>
        <month>6</month>
        <year>2015</year>
      </date>
      <date date-type="rev-recd">
        <day>3</day>
        <month>9</month>
        <year>2015</year>
      </date>
      <date date-type="accepted">
        <day>5</day>
        <month>10</month>
        <year>2015</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author 2015. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2015</copyright-year>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/" license-type="creative-commons">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <abstract>
      <p><bold>Summary:</bold> Analyzing the functional profile of a microbial community from unannotated shotgun sequencing reads is one of the important goals in metagenomics. Functional profiling has valuable applications in biological research because it identifies the abundances of the functional genes of the organisms present in the original sample, answering the question what they can do. Currently, available tools do not scale well with increasing data volumes, which is important because both the number and lengths of the reads produced by sequencing platforms keep increasing. Here, we introduce SUPER-FOCUS, SUbsystems Profile by databasE Reduction using FOCUS, an agile homology-based approach using a reduced reference database to report the subsystems present in metagenomic datasets and profile their abundances. SUPER-FOCUS was tested with over 70 real metagenomes, the results showing that it accurately predicts the subsystems present in the profiled microbial communities, and is up to 1000 times faster than other tools.</p>
      <p><bold>Availability and implementation:</bold> SUPER-FOCUS was implemented in Python, and its source code and the tool website are freely available at <ext-link ext-link-type="uri" xlink:href="https://edwards.sdsu.edu/SUPERFOCUS">https://edwards.sdsu.edu/SUPERFOCUS</ext-link>.</p>
      <p>
        <bold>Contact:</bold>
        <email>redwards@mail.sdsu.edu</email>
      </p>
      <p><bold>Supplementary information:</bold><ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btv584/-/DC1">Supplementary data</ext-link> are available at <italic>Bioinformatics</italic> online.</p>
    </abstract>
    <counts>
      <page-count count="8"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Prokaryotes and the viruses that infect them are the most abundant organisms on earth (<xref rid="btv584-B37" ref-type="bibr">Whitman <italic>et al.</italic>, 1998</xref>), and it is important to understand both who they are and what they are doing. In many environments, the majority of the microbes cannot be cultured by using standard laboratory techniques, and metagenomics is the preferred way to study them as a whole community (<xref rid="btv584-B14" ref-type="bibr">Handelsman, 2004</xref>). Next-generation DNA sequencing (NGS) technologies have sped up the sequencing process, reduced the cost, increased the sampling resolution and opened new horizons in the biological sciences (<xref rid="btv584-B39" ref-type="bibr">Zhang <italic>et al.</italic>, 2011</xref>).</p>
    <p>Understanding microbial communities is important in many areas of biology. For example, metagenomes can distinguish taxonomic and functional signatures of microbes associated with humans (<xref rid="btv584-B8" ref-type="bibr">Consortium, 2012</xref>), sponges (<xref rid="btv584-B34" ref-type="bibr">Trindade-Silva <italic>et al.</italic>, 2012</xref>, <xref rid="btv584-B35" ref-type="bibr">2013</xref>), red seaweed (<xref rid="btv584-B25" ref-type="bibr">Oliveira <italic>et al.</italic>, 2012</xref>) and diseased and healthy states of corals (<xref rid="btv584-B12" ref-type="bibr">Garcia <italic>et al.</italic>, 2013</xref>).</p>
    <p>Functional annotation of metagenomic reads normally requires the alignment of sequences to a large database of annotated sequences to identify homologs (<xref rid="btv584-B22" ref-type="bibr">Mendoza <italic>et al.</italic>, 2015</xref>). There are many databases for annotations at the functional system or pathway level, including the SEED (<xref rid="btv584-B28" ref-type="bibr">Overbeek <italic>et al.</italic>, 2005</xref>) which contains subsystems (sets of protein families with a similar function), and the large metabolic pathway databases KEGG (<xref rid="btv584-B18" ref-type="bibr">Kanehisa and Goto, 2000</xref>) and MetaCyc (<xref rid="btv584-B6" ref-type="bibr">Caspi <italic>et al.</italic>, 2010</xref>).</p>
    <p>Many of the tools for functional profiling are slow (<xref rid="btv584-B20" ref-type="bibr">Lindgreen <italic>et al.</italic>, 2015</xref>), suggesting that there is an opportunity for improvements of these tools. Currently, available tools generally use either homology, i.e. by aligning the metagenomic sequencing reads against an annotated reference database, or use exact matches (k-mers) to link metagenomic sequencing reads to the annotated sequences. Homology-based metagenome annotation tools programs are still frequently based on pre-NGS algorithms such as BLAST (<xref rid="btv584-B1" ref-type="bibr">Altschul <italic>et al.</italic>, 1997</xref>) or BLAT (<xref rid="btv584-B19" ref-type="bibr">Kent, 2002</xref>) to identify the best hit in a large database, although new homology search algorithms such RAPSearch2 (<xref rid="btv584-B40" ref-type="bibr">Zhao <italic>et al.</italic>, 2012</xref>) and DIAMOND (<xref rid="btv584-B5" ref-type="bibr">Buchfink <italic>et al.</italic>, 2015</xref>) have recently been developed to reduce the run time. MG-RAST (<xref rid="btv584-B23" ref-type="bibr">Meyer <italic>et al.</italic>, 2008</xref>) and MEGAN 5 (<xref rid="btv584-B24" ref-type="bibr">Mitra <italic>et al.</italic>, 2011</xref>) both align sequences to a reference database to profile the metagenomic sample. MG-RAST first predicts the open reading frames (ORFs) on the metagenomic sequence using FragGeneScan (<xref rid="btv584-B29" ref-type="bibr">Rho <italic>et al.</italic>, 2010</xref>) and then aligns the translated amino acid sequences to the M5NR database via BLAT. MEGAN accepts as input the tabular results files created from programs such as blastx/blastp, DIAMOND, or RAPSearch2 to the NR database, and creates taxonomic and/or functional profiles based on the search output.</p>
    <p>Exact match or k-mer based approaches use oligonucleotides to identify the hits in a metagenome. For example, real time metagenomics (RTMg) (<xref rid="btv584-B11" ref-type="bibr">Edwards <italic>et al.</italic>, 2012</xref>) identifies all words of length <italic>k</italic> (where <italic>k</italic> is typically between 7 and 12 amino acids) that are a unique signature for a set of functionally related proteins, and uses them to profile the functions present in the metagenomic sample. This approach has also been successfully applied to assign taxonomic labels to metagenomic sequences using a length of <italic>k</italic> of 31 nt (<xref rid="btv584-B38" ref-type="bibr">Wood and Salzberg, 2014</xref>; <xref rid="btv584-B26" ref-type="bibr">Ounit <italic>et al.</italic>, 2015</xref>).</p>
    <p>We developed a novel approach, named SUPER-FOCUS, which classifies each sequence in the metagenome into a subsystem. SUPER-FOCUS aligns all the input data against a reduced database with contains only the subsystems present in the organisms in that metagenome. The speed up derives from three improvements compared with the standard metagenome annotation pipelines. First, the SEED database was clustered using CD-HIT (<xref rid="btv584-B15" ref-type="bibr">Huang <italic>et al.</italic>, 2010</xref>) using a similar approach as previously discussed and applied to the Genbank NR database (<xref rid="btv584-B21" ref-type="bibr">Li <italic>et al.</italic>, 2012</xref>); second, the metagenomic query sequences are profiled using FOCUS (<xref rid="btv584-B33" ref-type="bibr">Silva <italic>et al.</italic>, 2014</xref>), an ultra-fast tool that identifies the organisms in the metagenome; and finally, comparisons are performed using RAPSearch2 which is ∼2–3 times faster than BLAT and 100 times faster than blastx, but has no reduction in sensitivity or specificity when compared with BLAST (<xref rid="btv584-B4" ref-type="bibr">Berendzen <italic>et al.</italic>, 2012</xref>). We compare the performance of SUPER-FOCUS to RTMg, MEGAN and MG-RAST using different reduced databases and over 70 metagenomic datasets of different sizes and from different environments. The results shows that SUPER-FOCUS speeds up the process of sequence functional annotation 37, 60 and 1000 times faster than RTMg, MEGAN and MG-RAST, respectively. We apply SUPER-FOCUS to a novel dataset from a coral reef environment and show that the taxonomy is conserved across islands while functions adapt to local conditions.</p>
  </sec>
  <sec>
    <title>2 Methods</title>
    <p>The SUPER-FOCUS workflow consists of one pre-processing step (step 0) and five processing computational stages which are represented in <xref ref-type="fig" rid="btv584-F1">Fig. 1</xref> and described below:
<list list-type="order"><list-item><p>Create reduced databases of subsystems using CD-HIT with different parameters.</p></list-item><list-item><p>Identify the genera present in the metagenomic sample using FOCUS.</p></list-item><list-item><p>Select subsystems present in the predicted organisms to create a new reduced database.</p></list-item><list-item><p>Align input data against the reduced database using RAPSearch2 (default aligner), DIAMOND, or blastx.</p></list-item><list-item><p>Parse the alignment output and keep best-hit(s) with, e.g. maximum E-value 1e<sup>−5</sup>, minimum 60% identity, and minimum alignment length 15 amino acids (these are all default values that can be changed). If more than one best hit is found per query sequence, the program keeps all the subsystems for all the best hits.</p></list-item><list-item><p>Write functional annotations for subsystems levels 1–3.</p></list-item></list>
<fig id="btv584-F1" orientation="portrait" position="float"><label>Fig. 1.</label><caption><p>Workflow of the SUPER-FOCUS program</p></caption><graphic xlink:href="btv584f1p"/></fig></p>
    <sec>
      <title>2.1 Reduced reference dataset</title>
      <p>The SEED database was developed by members of the Fellowship for Interpretation of Genomes (FIG) and Argonne National Laboratory starting in 2004 (<xref rid="btv584-B27" ref-type="bibr">Overbeek <italic>et al.</italic>, 2004</xref>) with the goal of clustering sets of proteins which implement a specific biological process or structural complex into subsystems.</p>
      <p>The database is composed of subsystems structured into three levels, the first level is the most general class and the third level is the more specific class, and one functional role (<xref ref-type="fig" rid="btv584-F2">Fig. 2</xref> for an example of one subsystem).
<fig id="btv584-F2" orientation="portrait" position="float"><label>Fig. 2.</label><caption><p>Representation of a subsystem structure (Levels 1–3 classifications and Function)</p></caption><graphic xlink:href="btv584f2p"/></fig></p>
      <p>SUPER-FOCUS requires a group of reference sequences to identify the subsystems present in a metagenome. The proteins annotated into 1290 subsystems (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btv584/-/DC1">Supplementary Table S1</ext-link>) were downloaded from the SEED servers (<xref rid="btv584-B3" ref-type="bibr">Aziz <italic>et al.</italic>, 2012</xref>) using the SEED API (<xref rid="btv584-B10" ref-type="bibr">Disz <italic>et al.</italic>, 2010</xref>) on December 12, 2014 and all identical proteins were removed. Next, the proteins within each subsystem were clustered separately using CD-HIT in order to cluster exact and nearly identical protein sequences (the clustering was repeated four times with sequence identity cut-off: 100, 98, 95 and 90%) reducing the total reference dataset, respectively, from 3.1 to 3 GB (100% identity clustering; ∼6% sequence reduction), 2.1 GB (98% identity clustering; ∼30% sequence reduction), 1.8 GB (95% identity clustering; ∼40% sequence reduction) and 1.6 GB (90% identity clustering; ∼52% sequence reduction).</p>
      <p>SUPER-FOCUS databases were named by the identity used in their clustering e.g: DB_100 used 100% sequence identity, DB_98 (default database) used 98% identity, DB_95 used 95% identity, and DB_90 used to 90% identity in clustering. Due to the reduction of the reference database into non-redundant clusters, a slight loss of functional resolution is lost. We recommend that the database choice should be made depending on how specific the functional profiling is needed. For example, if the function level is needed, DB_100 is the recommended. Otherwise, the other databases can be used with a little loss of sensitivity and high precision as shown later.</p>
    </sec>
    <sec>
      <title>2.2 Aligner choice</title>
      <p>RAPSearch2 is the default aligner for SUPER-FOCUS because it has a reduced memory requirement of ∼2 GB RAM when running in single threaded mode and around 3.5 GB when running in four-thread mode.</p>
      <p>DIAMOND (<xref rid="btv584-B5" ref-type="bibr">Buchfink <italic>et al.</italic>, 2015</xref>) has a large memory requirement of ∼100 GB RAM for these datasets. Any aligner that provides a tabular output can be easily integrated to the SUPER-FOCUS pipeline; e.g. BLAST, or DIAMOND which is ∼20 times faster than RAPSearch2 for large datasets but slower than blastx for small datasets. RAPSearch2 and DIAMOND have a fast version, which is less sensitive, but 900 and 20 000 times faster than blastx, respectively. SUPER-FOCUS was tested with both the fast and sensitive settings for these algorithms.</p>
    </sec>
    <sec>
      <title>2.3 The presence or absence of subsystems in complete genomes</title>
      <p>We downloaded all the encoded proteins in complete bacterial and archael genomes, including any integrated phophages or plasmids, from the Genbank database on March 12, 2015 (<ext-link ext-link-type="ftp" xlink:href="ftp://ftp.ncbi.nih.gov/genomes/Bacteria">ftp://ftp.ncbi.nih.gov/genomes/Bacteria</ext-link>). To identify the presence of SEED subsystems within these genomes, we aligned the proteins to the complete SEED database using blastp 2.2.25+ targeting the 250 top hits. Only the best hit(s), i.e. those with the lowest E-value, were kept and used to stipulate which subsystems were present in each genome (maximum E-value: 1e-5, minimum identity: 60%, minimum alignment length: 15 amino acids, and <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btv584/-/DC1">Supplementary Fig. S1</ext-link> shows that the used hits had 361.67 ± 248.14 of alignment length, which suggests that ORF’s were correctly assigned into a subsystem.</p>
      <p>The presence of subsystems in each genus was determined via the assignments of each subsystem at the species level (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btv584/-/DC1">Supplementary Table S2</ext-link>), and this presence/absence matrix is used to further reduce the database in step 2 of SUPER-FOCUS pipeline.</p>
      <p>We also annotated the same genomes using RAST (<xref rid="btv584-B2" ref-type="bibr">Aziz <italic>et al.</italic>, 2008</xref>), and on <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btv584/-/DC1">Supplementary Material</ext-link> we show the comparison between the presence/absence matrices from RAST and blastp generate a similar results.</p>
    </sec>
    <sec>
      <title>2.4 Testing set</title>
      <p>In order to evaluate SUPER-FOCUS performance, both public and private real metagenomic datasets were selected as test cases:
<list list-type="simple"><list-item><p><bold>Public data:</bold> Fifty datasets (2.2 GB) from six different human body sites sequenced by the Human Microbiome Project (HMP) (<xref rid="btv584-B8" ref-type="bibr">Consortium, 2012</xref>) were selected as a test case (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btv584/-/DC1">Supplementary Table S3</ext-link>) and three marine viral metagenomes (total of ∼500 MB) from the Moore Marine Phage/Virus Metagenomes project (CAM_PROJ_BroadPhage) (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btv584/-/DC1">Supplementary Table S4</ext-link>) were analyzed using SUPER-FOCUS. Human contamination was removed from all the testing sets using DeconSeq (<xref rid="btv584-B31" ref-type="bibr">Schmieder and Edwards, 2011</xref>).</p></list-item></list><bold>Private data:</bold><statement><title>Study sites</title><p>One big data metagenome was generated from a simulated colon bioreactor, totaling 7.7 GB. Twenty coral metagenomics samples were collected from February 2010 to September 2013 across the Central and Southern Pacific Ocean as part of the National Oceanic and Atmospheric Administration (NOAA) Coral Reef Ecosystem Division (CRED) monitoring program (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btv584/-/DC1">Supplementary Table S5</ext-link>).</p></statement><statement><title>Sample collection</title><p>Seawater was collected on coral reefs across the Pacific Oceans as described in <xref rid="btv584-B13" ref-type="bibr">Haas <italic>et al</italic><italic>.</italic> (2014)</xref>. Briefly, 2.2 l of water was collected in diver-deployed Niskin bottles at ∼10 m depth within 30 cm of the benthos at each site. Sample water was then flushed through a 0.22 μm Sterivex filter. After filtration, excess water was flushed out of the Sterivex using a clean 10 ml syringe filled with air. Sterivexes were then labeled and placed back into the original package, sealed with tape and stored at −20°C until extraction.</p></statement><statement><title>DNA extraction and sequencing</title><p>Total DNA was extracted from a 0.22 μm Sterivex filter using the Nucleospin Tissue Kit (Macherey-Nagel, Dueren, Germany) following manufacturer’s protocol. Briefly, filters were thawed and excess water was removed by flushing the water out with 10 ml Lure-Lok syringe. One end of the filters were sealed with Parafilm and 410 μl of T1 lysis buffer with 20 mg/ml Proteinase K was added into each filter from the other end. The end of the filters were sealed and placed into a 55°C oven on a rotating spit overnight. After incubation, 400 μl of Buffer B3 was added to each filter and placed back in the rotating oven at 70°C for 30 min. The lysate was retrieved from the filter using a 3 ml Lure-Lok syringe and placed into a new 1.5 ml microcentrifuge tube. Four hundred twenty micrometer liters of 100% ethanol was added into each tube containing the lysate and DNA was recovered described in the manufacture’s protocol. DNA concentration was measured using the Qubit High Sensitivity dsDNA kit (Life Technologies, NY) and DNA purity was evaluated using NanoDrop (Thermo Scientific). The Nextera XT DNA Library Prep Kit (Illumina, CA) was used for sequence library preparation and the manufactures protocol was followed. In short, samples were diluted to 0.2 ng/µl and a total of 1 ng of DNA from each sample was processed. DNA was amplified via a limited-cycle PCR program, AMPure XP beads (Beckman Coulter, CA) were used for purification and for size selection (&gt; 500 bp) of the DNA. 11 samples were tested using the 2100 Bioanalyzer (Agilent Technologies, CA) to ensure size selection was successful. The size-selected samples were then sequenced on the Illumina MiSeq platform (Illumina, CA) using the MiSeq Reagent Kit v3.</p></statement></p>
    </sec>
    <sec>
      <title>2.5 Sensitivity, precision and speed of SUPER-FOCUS analysis</title>
      <p>To benchmark our annotation pipeline with real metagenomes, we had to define a true annotation of the metagenomic sequencing reads. Because blastx searches the DNA sequences in protein space, we consider it to be the most sensitive search tool, and we defined the true annotation of a metagenomic sequencing read as the best hit(s) of a blastx search of the read against the complete database (DB_100), and if there is more than one best hit with an equally low E-value, all are used. Thus, for a given functional level (e.g. Subsystem level 1, 2 or 3), sensitivity is defined as the ratio between the number of correct assignments by SUPER-FOCUS and the total number of sequences annotated by a blastx search against DB_100 (‘true answer’), and precision is defined as the ratio between the number of correct assignments by SUPER-FOCUS and the total number of classified sequences by SUPER-FOCUS.</p>
      <p>The speed of SUPER-FOCUS analysis, measured in thousands of sequences analyzed per minute, was estimated by timing the run time in seconds for each metagenome using the python library time, and dividing the time by the total number of sequences in the metagenome; it estimates the number of seconds to align each sequence in the metagenome against the target database (e.g. SEED or NR).</p>
    </sec>
  </sec>
  <sec>
    <title>3 Results and discussion</title>
    <sec>
      <title>3.1 Validation of clustered database and SUPER-FOCUS evaluation</title>
      <p>Prior to testing SUPER-FOCUS we independently validated our database construction and size reduction. The HMP and viromes testing set metagenomes were aligned against the SUPER-FOCUS database DB_100 using blastx, as described in the methods, and each query sequence was assigned to a subsystem using the SUPER-FOCUS best-hit method. Next, DB_100 blastx's assignments were assumed to be the right answer, and same testing sets were aligned against DB_100, DB_98, DB_95 and DB_90, but now using RAPSearch2 as the aligner with the same parameters previously used with blastx. RAPSearch2 was run with 24 threads in the sensitive and fast modes using the SUPER-FOCUS workflow. RAPSearch2 without the SUPER-FOCUS workflow using database DB_100 represents how a regular user would profile a metagenomic dataset only using the complete SEED and a fast aligner. This analysis was added to show that part of the loss of sensitivity and precision from SUPER-FOCUS profiling comes from RAPSearch2.</p>
      <p>For the 50 HMP metagenomes with short reads, we measured both the sensitivity (<xref ref-type="fig" rid="btv584-F3">Fig. 3</xref>a for sensitivity using subsystem level 1 classification, <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btv584/-/DC1">Supplementary Fig. S2</ext-link> for level 2 and 3 classifications) and precision (<xref ref-type="fig" rid="btv584-F3">Fig. 3</xref>b) for precision using subsystem level 1 classifications, <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btv584/-/DC1">Supplementary Fig. S3</ext-link> for level 2 and 3 classifications.
<fig id="btv584-F3" orientation="portrait" position="float"><label>Fig. 3.</label><caption><p>Percent classification sensitivity (<bold>A</bold>) and precision (<bold>B</bold>) of level 1 subsystems and speed of RAPSearch2 and SUPER-FOCUS using different databases and parameter modes. This analysis was based on a comparison of 50 HMP metagenomes, where blastx assignments using DB_100 were considered to be the true answer</p></caption><graphic xlink:href="btv584f3p"/></fig></p>
      <p>We used blastx as our notion of ‘truth’ as it is the most widely used algorithm in metagenomics analysis. For the 50 HMP metagenomes the average processing time (sequences/minute) is compared with the sensitivity at each of the three subsystem levels. The more sensitive the profile, the longer it is going to take, and the more broader the categories (subsystems level 1), the more sensitive the results are.</p>
      <p><xref ref-type="fig" rid="btv584-F3">Figure 3</xref> also shows that the SUPER-FOCUS approach was slightly faster, but less sensitive when compared with RAPSearch2 without the SUPER-FOCUS workflow alignments; it was faster because on average 88.53 ± 5% of the 1290 subsystems in the SEED database were used to profile all the metagenomes in the testing set (<xref ref-type="fig" rid="btv584-F4">Fig. 4</xref>) in step 2 of the SUPER-FOCUS pipeline, and the misclassified sequences explain the loss of sensitivity as described later.
<fig id="btv584-F4" orientation="portrait" position="float"><label>Fig. 4.</label><caption><p>Percentage of level 3 subsystems present in all the testing set metagenomes predicted by SUPER-FOCUS</p></caption><graphic xlink:href="btv584f4p"/></fig></p>
      <p>Overall, there was &lt;1% loss of sensitivity (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btv584/-/DC1">Supplementary Fig. S4a</ext-link>) and precision (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btv584/-/DC1">Supplementary Fig. S4b</ext-link>) between all the levels, which shows the efficiency of using the clustered database presented in this paper and the SUPER-FOCUS approach compared with blastx searches.</p>
    </sec>
    <sec>
      <title>3.2 Understanding SUPER-FOCUS misclassifications</title>
      <p>In order to understand the SUPER-FOCUS misclassifications when compared with RAPSearch2 without the SUPER-FOCUS workflow, two confusion matrices were generated to compare predicted and real sequence annotations: <xref ref-type="fig" rid="btv584-F5">Figure 5</xref>a presents the RAPSearch2-Sensitive results using the DB_100, and the only significant loss of sensitivity was 6.45% of sequences that were supposed to be classified into the ‘Plant cell walls and outer surfaces’ subsystems but were not classified; this loss of sensitivity is explained because RAPSearch2 is based on a reduced amino acid alphabet of 10 symbols, which makes the tools less sensitive, while blastx uses a complete amino acid alphabet. <xref ref-type="fig" rid="btv584-F5">Figure 5</xref>b shows the results for SUPER-FOCUS-Sensitive using DB_100, and now 67.74% of the sequences that were supposed to be classified into the ‘Plant cell walls and outer surfaces’ subsystems and 6.03% of the sequences that were supposed to be classified into the ‘Photosynthesis’ subsystems were not classified.
<fig id="btv584-F5" orientation="portrait" position="float"><label>Fig. 5.</label><caption><p>Confusion matrix displaying the percentage of correct assignments in each level 1 subsystem for the 50 HMP metagenomes. (<bold>a</bold>) Shows the RAPSearch2 assignments in the sensitive mode to DB_100. (<bold>b</bold>) Shows the SUPER-FOCUS assignments in the sensitive mode to DB_100</p></caption><graphic xlink:href="btv584f5p"/></fig></p>
      <p>To investigate the SUPER-FOCUS misclassifications, those sequences were aligned against the NR-database using blastx and an E-value cutoff of 1 e<sup>−</sup><sup>5</sup>. The best-hit was selected for each sequence, and the taxonomic classification for each hit was recovered using Biopython (<xref rid="btv584-B7" ref-type="bibr">Cock <italic>et al.</italic>, 2009</xref>).</p>
      <p>The results show that ∼25% of the wrong assignments were from the Eukaryota and ∼1.3% of the wrong assignments were derived from viruses. The rest of the misclassified sequences were associated with Bacteria. Ninety-nine percentage of those were not identified by FOCUS and 78% were not identified by MetaPhlAn because neither FOCUS nor MetaPhlAn include those bacteria in their databases. Of the 22% that were identified by MetaPhlAn (used to analyzed the data in the HMP paper) (<xref rid="btv584-B32" ref-type="bibr">Segata <italic>et al.</italic>, 2012</xref>), just over half of those (57%) had &lt;2% relative abundance, suggesting that both FOCUS and MetaPhlAn are missing the rare species in the environment (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btv584/-/DC1">Supplementary Table S6</ext-link>).</p>
      <p>SUPER-FOCUS uses FOCUS in its pipeline, a tool that was developed to taxonomically profile microbial data. The FOCUS database only contains bacterial and archaeal genomes, which explains the misclassification of metagenomic reads from other microbial clades. We showed that the real metagenomes used herein contained viral and eukaryotic sequences, even after the sequences were filtered. For example, while human contamination from the HMP data was already removed using BMTagger (<xref rid="btv584-B30" ref-type="bibr">Rotmistrovsky and Agarwala, 2011</xref>), we were still able to identify human reads with the DeconSeq tool (<xref rid="btv584-B31" ref-type="bibr">Schmieder and Edwards, 2011</xref>). These contaminations affect biological conclusions (<xref rid="btv584-B36" ref-type="bibr">Weiss <italic>et al.</italic>, 2014</xref>) and lead to increased computing time.</p>
      <p>SUPER-FOCUS was designed to only classify microbial data. The SUPER-FOCUS pipeline guarantees a more accurate microbial functional analysis and does not classify eukaryotic or viral sequences. Thus, if hits to the Eukaryotic and Viral Kingdoms are ignored, the SUPER-FOCUS approach would present a better profile than the one present in <xref ref-type="fig" rid="btv584-F3">Fig. 3</xref>a as shown in <xref ref-type="fig" rid="btv584-F6">Fig. 6</xref> for sensitivity at level 1, <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btv584/-/DC1">Supplementary Fig. S5a</ext-link> for level 2 and 4 (b) for level 3.
<fig id="btv584-F6" orientation="portrait" position="float"><label>Fig. 6.</label><caption><p>Classification sensitivity using level 1 classifications and speed comparison of 50 HMP metagenomes using RAPSearch2 and SUPER-FOCUS using different databases and modes, but removing Eurkaryota and viral assignments. blastx assignments using DB_100 were considered to be the true answer</p></caption><graphic xlink:href="btv584f6p"/></fig></p>
    </sec>
    <sec>
      <title>3.3 Comparison of SUPER-FOCUS with other tools</title>
      <p>SUPER-FOCUS was compared with RTMg, MEGAN and MG-RAST, and all the four tools were tested using default parameters. MEGAN 5.10 and SUPER-FOCUS were run using default parameters and their default reference database, either online (MG-RAST and RTMg) or using one core on a server with 24 processors × 6 cores Intel(R) Xeon(R) CPU X5650 @ 2.67 GHz and 189 GB RAM. MEGAN uses the NR database, and it was downloaded on January 22, 2015. MG-RAST uses the M5NR as database, and its last update is not known because MG-RAST does not provide that information. RTMg is a web server which uses the SEED as database and was updated on November 8, 2013.</p>
      <p>For the three viromes that were sequenced using 454 technology and thus had longer reads, SUPER-FOCUS sensitivity and precision were evaluated against the annotations based on the blastx searches against DB_100 as the true assignments, and its runtime was compared with MEGAN, MG-RAST and RTMg. Here, RAPSearch2’s performance was tested using different numbers of threads (24, 18, 12 and 6) (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btv584/-/DC1">Supplementary Fig. S6</ext-link>), blastx was also used to align the sequences because RAPSearch2 is known to be less sensitive for 454 data (<xref rid="btv584-B5" ref-type="bibr">Buchfink <italic>et al.</italic>, 2015</xref>), and because DIAMOND was designed for large datasets, and it is slower than blastx for small datasets. RAPSearch2 is less sensitive for long sequences as shown in <xref ref-type="fig" rid="btv584-F7">Fig. 7</xref>a. SUPER-FOCUS had a high precision, using all the databases, of ∼98.4 ± 1% using blastx with level 1 classifications (<xref ref-type="fig" rid="btv584-F7">Fig. 7</xref>b). Subsystems sensitivity and precision measurements for level 2 and 3 subsystem classifications are shown, respectively, in <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btv584/-/DC1">Supplementary Figs S7</ext-link> and <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btv584/-/DC1">S8</ext-link>. BLAST is slow, thus the blastx results for <xref ref-type="fig" rid="btv584-F7">Fig. 7</xref> was generated in a cluster at the San Diego State University facilities, and the run time was approximated based on the knowledge that RAPSearch2 is ∼100 times faster than blastx.
<fig id="btv584-F7" orientation="portrait" position="float"><label>Fig. 7.</label><caption><p>Classification sensitivity (<bold>a</bold>) and precision (<bold>b</bold>) percent using level 1 and speed comparison of three viromes using RAPSearch2 and SUPER-FOCUS using different databases and modes. blastx assignments using DB_100 were considered to be the true answer</p></caption><graphic xlink:href="btv584f7p"/></fig></p>
      <p>In the timing tests, SUPER-FOCUS had the fastest profiling using RAPSearch2 in its fast mode. RTMg was faster than RAPSearch2 sensitive (<xref ref-type="fig" rid="btv584-F8">Fig. 8</xref>). MEGAN can be enhanced by using RAPSearch2, and the underlying framework hinders MG-RAST.
<fig id="btv584-F8" orientation="portrait" position="float"><label>Fig. 8.</label><caption><p>Run time comparison for the three marine viromes using SUPER-FOCUS, RTMg, MEGAN and MG-RAST</p></caption><graphic xlink:href="btv584f8p"/></fig></p>
      <p>Interestingly, despite the absence of phages in the FOCUS database, SUPER-FOCUS was able to predict correctly the subsystems in the viromes. We hypothesize that FOCUS predicted the microbial host for the phages, and from those genera that carry the subsystems present in the viral metagenomes. Phages are very diverse which means that the subsystems associated with phages (‘Phages, Prophages, Transposable elements, Plasmids’, ‘Virulence’ and ‘Virulence, Disease and Defense’), did not cluster well in the SUPER-FOCUS database creation. This lack of clustering explains why the sensitivity across different databases does not change much in <xref ref-type="fig" rid="btv584-F7">Fig. 7</xref>.</p>
      <p>For the one big data metagenome analyzed here, the runtime of SUPER-FOCUS was only compared with MEGAN, MG-RAST and RTMg, and due to the large number of sequences (30 917 457 reads), DIAMOND was used as default aligner for the SUPER-FOCUS and MEGAN tools. As shown in <xref ref-type="fig" rid="btv584-F9">Fig. 9</xref>, SUPER-FOCUS was the fastest tool followed by RTMg, MEGAN, and then MG-RAST. It is important to point out that SUPER-FOCUS (and MEGAN) used 24 threads, and even if the program had been set to use less threads, it would be still expected to be faster than RTMg because as shown in <xref ref-type="fig" rid="btv584-F8">Fig. 8</xref> SUPER-FOCUS is ∼4.4 (most sensitive) and 37.7 (fastest) times faster than RTMg. The SUPER-FOCUS profiling was compared with MEGAN, RTMg and MG-RAST as shown in <xref ref-type="fig" rid="btv584-F10">Fig. 10</xref>, and the results show that the three tools are comparable to each other, except to MG-RAST which apparently over predicted hits to the ‘Clustering-based subsystems’ and RTMg which did not report any hits this subsystem as they are ignored.
<fig id="btv584-F9" orientation="portrait" position="float"><label>Fig. 9.</label><caption><p>Run time comparison for the one big data metagenome using SUPER-FOCUS, RTMg, MEGAN and MG-RAST</p></caption><graphic xlink:href="btv584f9p"/></fig>
<fig id="btv584-F10" orientation="portrait" position="float"><label>Fig. 10.</label><caption><p>Comparison of level 1 subsystems profile of one big data metagenome using SUPER-FOCUS, RTMg, MEGAN, MG-RAST and blastx that are considered to be the true answer</p></caption><graphic xlink:href="btv584f10p"/></fig></p>
    </sec>
    <sec>
      <title>3.4 Coral metagenomes functional profiling</title>
      <p>Twenty coral metagenomes from four sites were also analysed to test the robustness of using SUPER-FOCUS in the marine environment. First, the coral sequences were profiled using FOCUS, which is part of SUPER-FOCUS, to understand the taxonomic profile among the sites; and second, the same sequences were classified into subsystems using SUPER-FOCUS with RAPSearch2 and DB_98 as database which we have already shown to be sensitive and precise. In addition to RAPSearch2, blastx was also added to the analysis because the sequenced reads average ∼218 ± 64.4 bp and RAPSearch2 is known to be less sensitive for reads longer than 100 bp (<xref rid="btv584-B5" ref-type="bibr">Buchfink <italic>et al.</italic>, 2015</xref>). The difference in sensitivity for the long reads coral data between blastx and RAPSearch2 is shown in <xref ref-type="fig" rid="btv584-F11">Fig. 11</xref>a. The median RAPSearch2 sensitivity was ∼83%, although it was still precise (∼99%; <xref ref-type="fig" rid="btv584-F11">Fig. 11</xref>b); in comparison, the median blastx sensitivity was (∼99.5%) and precision was (∼99.5%) as shown in <xref ref-type="fig" rid="btv584-F9">Fig. 9</xref>c and d.
<fig id="btv584-F11" orientation="portrait" position="float"><label>Fig. 11.</label><caption><p>Box plots displaying the percent sensitivity (<bold>A</bold> and <bold>C</bold>) and precision (<bold>B</bold> and <bold>D</bold>) of RAPSearch2 (<bold>A</bold> and <bold>B</bold>), blastx (<bold>C</bold> and <bold>D</bold>) annotation of the 20 coral metagenomes. RAPsearch2 was tested in the fast and sensitive modes</p></caption><graphic xlink:href="btv584f11p"/></fig></p>
      <p>For the taxonomic profiling, <xref ref-type="fig" rid="btv584-F12">Fig. 12</xref>a was generated using SciPy (<xref rid="btv584-B17" ref-type="bibr">Jones <italic>et al.</italic>, 2001</xref>) and matplotlib (<xref rid="btv584-B16" ref-type="bibr">Hunter, 2007</xref>) (both open source python programming language libraries), and it shows the hierarchical clustering based on the pairwise Euclidean distances of the relative genus abundance of the each coral metagenome. The clustering shows that the samples from the same site cluster together, which suggest they have a similar microbial community.
<fig id="btv584-F12" orientation="portrait" position="float"><label>Fig. 12.</label><caption><p>Hierarchical clustering of the taxonomic (<bold>A</bold>) and functional (<bold>B</bold>) annotations of 20 coral metagenomes. Genus level taxonomic annotation was performed using FOCUS. Functional annotation of level 3 subsystems was performed using SUPER-FOCUS using blastx and DB_98</p></caption><graphic xlink:href="btv584f12p"/></fig></p>
      <p>For the functional profiling, the same hierarchical clustering approach, using the distances between the relative abundances of the level 1, 2 and 3 subsystem classification were used. <xref ref-type="fig" rid="btv584-F12">Figure 12</xref>b also shows that samples from the same sites had similar subsystem level 3 profiles (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btv584/-/DC1">Supplementary Fig. S9</ext-link> for levels 1 and 2). Both figures show that there is a microbial core that is preserved on some of the reefs; however, the nature of that core differs between taxonomy and function, as we have shown before (<xref rid="btv584-B9" ref-type="bibr">Dinsdale <italic>et al.</italic>, 2008</xref>). This trend suggests that the organisms are quite stable at different sites while the functions change to allow adaptation to local environments.</p>
    </sec>
    <sec>
      <title>3.5 Final considerations</title>
      <p>FOCUS is integrated with a SUPER-FOCUS pipeline which permits the tool to also report the taxonomic profile for a given metagenomic dataset. Both functional and taxonomic profiles are also provided by MEGAN and MG-RAST; RTMg only reports the functional assignments. SUPER-FOCUS provides three advances in the functional profiling compared with other tools: (i) It uses a fast aligner; (ii) it uses clustered databases in order to obtain a fast profile with little loss of sensitivity and (iii) focuses on the microbes present in the input data to attain a more microbial profile. As a default the tool, uses three advances; however, the user can select any combination of options.</p>
    </sec>
  </sec>
  <sec>
    <title>4 Conclusions</title>
    <p>Here, we present SUPER-FOCUS, an agile solution to identify the subsystems present in metagenomic samples that first determines the taxonomic composition of the entire metagenome by using FOCUS, and uses this knowledge to create, on the fly, a reduced database only containing the subsystems present in the organisms found. This makes SUPER-FOCUS a faster and still accurate tool to profile the functional subsystems in metagenomes. SUPER-FOCUS reports very similar results to currently available tools, but does so faster and using less memory.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="PMC_1" content-type="local-data">
      <caption>
        <title>Supplementary Data</title>
      </caption>
      <media mimetype="text" mime-subtype="html" xlink:href="supp_32_3_354__index.html"/>
      <media xlink:role="associated-file" mimetype="application" mime-subtype="x-zip-compressed" xlink:href="supp_btv584_suppl_data.zip"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <title>Acknowledgements</title>
    <p>We thank the SEED curators Dr Ross Overbeek, Dr Veronika Vonstein and Dr Ramy Aziz for the incredible work on the annotation of subsystems over the years. Dr Barbara Bailey for the fruitful discussions, Danillo Alvarenga for the help with MEGAN, Daniel Cuevas, Fabyano Alvares and Pedro Meirelles for helpful with the figures and comments on the SUPER-FOCUS pipeline, and the reviewers for their useful comments.</p>
  </ack>
  <sec>
    <title>Funding</title>
    <p>G.G.Z.S. was supported by <funding-source>NSF</funding-source> Grants (<award-id>CNS-1305112</award-id>, <award-id>MCB-1330800</award-id>, and <award-id>DUE-132809</award-id> to RAE). B.E.D. was supported by CAPES/BRASIL.</p>
    <p><italic>Conflict of Interest</italic>: none declared.</p>
  </sec>
  <ref-list>
    <title>References</title>
    <ref id="btv584-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Altschul</surname><given-names>S.F.</given-names></name><etal/></person-group> (<year>1997</year>) <article-title>Gapped BLAST and PSI-BLAST: a new generation of protein database search programs</article-title>. <source>Nucleic Acids Res.</source>, <volume>25</volume>, <fpage>3389</fpage>–<lpage>3402</lpage>.<pub-id pub-id-type="pmid">9254694</pub-id></mixed-citation>
    </ref>
    <ref id="btv584-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Aziz</surname><given-names>R.K.</given-names></name><etal/></person-group> (<year>2008</year>) <article-title>The RAST server: rapid annotations using subsystems technology</article-title>. <source>BMC Genomics</source>, <volume>9</volume>, <fpage>75</fpage>.<pub-id pub-id-type="pmid">18261238</pub-id></mixed-citation>
    </ref>
    <ref id="btv584-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Aziz</surname><given-names>R.K.</given-names></name><etal/></person-group> (<year>2012</year>) <article-title>SEED servers: high-performance access to the SEED genomes, annotations, and metabolic models</article-title>. <source>PLoS One</source>, <volume>7</volume>, <fpage>e48053</fpage>.<pub-id pub-id-type="pmid">23110173</pub-id></mixed-citation>
    </ref>
    <ref id="btv584-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Berendzen</surname><given-names>J.</given-names></name><etal/></person-group> (<year>2012</year>) <article-title>Rapid phylogenetic and functional classification of short genomic fragments with signature peptides</article-title>. <source>BMC Res. Notes</source>, <volume>5</volume>, <fpage>460</fpage>.<pub-id pub-id-type="pmid">22925230</pub-id></mixed-citation>
    </ref>
    <ref id="btv584-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Buchfink</surname><given-names>B.</given-names></name><etal/></person-group> (<year>2015</year>) <article-title>Fast and sensitive protein alignment using DIAMOND</article-title>. <source>Nat. Methods</source>, <volume>12</volume>, <fpage>59</fpage>–<lpage>60</lpage>.<pub-id pub-id-type="pmid">25402007</pub-id></mixed-citation>
    </ref>
    <ref id="btv584-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Caspi</surname><given-names>R.</given-names></name><etal/></person-group> (<year>2010</year>) <article-title>The MetaCyc database of metabolic pathways and enzymes and the BioCyc collection of pathway/genome databases</article-title>. <source>Nucleic Acids Res.</source>, <volume>38</volume>, <fpage>D473</fpage>–<lpage>D479</lpage>.<pub-id pub-id-type="pmid">19850718</pub-id></mixed-citation>
    </ref>
    <ref id="btv584-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cock</surname><given-names>P.</given-names></name><etal/></person-group> (<year>2009</year>) <article-title>Biopython: freely available Python tools for computational molecular biology and bioinformatics</article-title>. <source>Bioinforma. Oxf. Engl.</source>, <volume>25</volume>, <fpage>1422</fpage>–<lpage>1423</lpage>.</mixed-citation>
    </ref>
    <ref id="btv584-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Consortium</surname><given-names>T.H.M.P.</given-names></name></person-group> (<year>2012</year>) <article-title>Structure, function and diversity of the healthy human microbiome</article-title>. <source>Nature</source>, <volume>486</volume>, <fpage>207</fpage>–<lpage>214</lpage>.<pub-id pub-id-type="pmid">22699609</pub-id></mixed-citation>
    </ref>
    <ref id="btv584-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dinsdale</surname><given-names>E.A.</given-names></name><etal/></person-group> (<year>2008</year>) <article-title>Microbial ecology of four coral atolls in the Northern line islands</article-title>. <source>PLoS One</source>, <volume>3</volume>, <fpage>e1584</fpage>.<pub-id pub-id-type="pmid">18301735</pub-id></mixed-citation>
    </ref>
    <ref id="btv584-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Disz</surname><given-names>T.</given-names></name><etal/></person-group> (<year>2010</year>) <article-title>Accessing the SEED genome databases via Web services API: tools for programmers</article-title>. <source>BMC Bioinformatics</source>, <volume>11</volume>, <fpage>319</fpage>.<pub-id pub-id-type="pmid">20546611</pub-id></mixed-citation>
    </ref>
    <ref id="btv584-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Edwards</surname><given-names>R.A.</given-names></name><etal/></person-group> (<year>2012</year>) <article-title>Real time metagenomics: using k-mers to annotate metagenomes</article-title>. <source>Bioinformatics</source>, <volume>28</volume>, <fpage>3316</fpage>–<lpage>3317</lpage>.<pub-id pub-id-type="pmid">23047562</pub-id></mixed-citation>
    </ref>
    <ref id="btv584-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Garcia</surname><given-names>G.D.</given-names></name><etal/></person-group> (<year>2013</year>) <article-title>Metagenomic analysis of healthy and white plague-affected Mussismilia braziliensis corals</article-title>. <source>Microb. Ecol.</source>, <volume>65</volume>, <fpage>1076</fpage>–<lpage>1086</lpage>.<pub-id pub-id-type="pmid">23314124</pub-id></mixed-citation>
    </ref>
    <ref id="btv584-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Haas</surname><given-names>A.F.</given-names></name><etal/></person-group> (<year>2014</year>) <article-title>Unraveling the unseen players in the ocean–a field guide to water chemistry and marine microbiology</article-title>. <source>JoVE J. Vis. Exp.</source>, <comment>e52131–e52131</comment>.</mixed-citation>
    </ref>
    <ref id="btv584-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Handelsman</surname><given-names>J.</given-names></name></person-group> (<year>2004</year>) <article-title>Metagenomics: application of genomics to uncultured microorganisms</article-title>. <source>Microbiol. Mol. Biol. Rev.</source>, <volume>68</volume>, <fpage>669</fpage>–<lpage>685</lpage>.<pub-id pub-id-type="pmid">15590779</pub-id></mixed-citation>
    </ref>
    <ref id="btv584-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Huang</surname><given-names>Y.</given-names></name><etal/></person-group> (<year>2010</year>) <article-title>CD-HIT suite: a web server for clustering and comparing biological sequences</article-title>. <source>Bioinformatics</source>, <volume>26</volume>, <fpage>680</fpage>–<lpage>682</lpage>.<pub-id pub-id-type="pmid">20053844</pub-id></mixed-citation>
    </ref>
    <ref id="btv584-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hunter</surname><given-names>J.D.</given-names></name></person-group> (<year>2007</year>) <article-title>Matplotlib: a 2D graphics environment</article-title>. <source>Comput. Sci. Eng.</source>, <volume>9</volume>, <fpage>90</fpage>–<lpage>95</lpage>.</mixed-citation>
    </ref>
    <ref id="btv584-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jones</surname><given-names>E.</given-names></name><etal/></person-group> (<year>2001</year>) <article-title>SciPy: Open source scientific tools for Python</article-title>. <comment><ext-link ext-link-type="uri" xlink:href="http://www.scipy.org/">http://www.scipy.org/</ext-link>, <ext-link ext-link-type="uri" xlink:href="http://www.scipy.org/Citing_SciPy">http://www.scipy.org/Citing_SciPy</ext-link> (20 October 2015, date last accessed)</comment>.</mixed-citation>
    </ref>
    <ref id="btv584-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kanehisa</surname><given-names>M.</given-names></name><name><surname>Goto</surname><given-names>S.</given-names></name></person-group> (<year>2000</year>) <article-title>KEGG: Kyoto encyclopedia of genes and genomes</article-title>. <source>Nucleic Acids Res.</source>, <volume>28</volume>, <fpage>27</fpage>–<lpage>30</lpage>.<pub-id pub-id-type="pmid">10592173</pub-id></mixed-citation>
    </ref>
    <ref id="btv584-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kent</surname><given-names>W.J.</given-names></name></person-group> (<year>2002</year>) <article-title>BLAT—The BLAST-like alignment tool</article-title>. <source>Genome Res.</source>, <volume>12</volume>, <fpage>656</fpage>–<lpage>664</lpage>.<pub-id pub-id-type="pmid">11932250</pub-id></mixed-citation>
    </ref>
    <ref id="btv584-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lindgreen</surname><given-names>S.</given-names></name><etal/></person-group> (<year>2015</year>) <article-title>An evaluation of the accuracy and speed of metagenome analysis tools</article-title>. <comment>017830, <ext-link ext-link-type="uri" xlink:href="http://biorxiv.org/content/early/2015/05/15/017830">http://biorxiv.org/content/early/2015/05/15/017830</ext-link>.</comment></mixed-citation>
    </ref>
    <ref id="btv584-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>W.</given-names></name><etal/></person-group> (<year>2012</year>) <article-title>Ultrafast clustering algorithms for metagenomic sequence analysis</article-title>. <source>Brief. Bioinform.</source>, <volume>13</volume>, <fpage>656</fpage>–<lpage>668</lpage>.<pub-id pub-id-type="pmid">22772836</pub-id></mixed-citation>
    </ref>
    <ref id="btv584-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mendoza</surname><given-names>M.L.Z.</given-names></name><etal/></person-group> (<year>2015</year>) <article-title>Environmental genes and genomes: understanding the differences and challenges in the approaches and software for their analyses</article-title>. <source>Brief. Bioinform.</source>, <volume>16</volume>, <fpage>745</fpage>–<lpage>758</lpage>.<pub-id pub-id-type="pmid">25673291</pub-id></mixed-citation>
    </ref>
    <ref id="btv584-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Meyer</surname><given-names>F.</given-names></name><etal/></person-group> (<year>2008</year>) <article-title>The metagenomics RAST server–a public resource for the automatic phylogenetic and functional analysis of metagenomes</article-title>. <source>BMC Bioinformatics</source>, <volume>9</volume>, <fpage>386</fpage>.<pub-id pub-id-type="pmid">18803844</pub-id></mixed-citation>
    </ref>
    <ref id="btv584-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mitra</surname><given-names>S.</given-names></name><etal/></person-group> (<year>2011</year>) <article-title>Functional analysis of metagenomes and metatranscriptomes using SEED and KEGG</article-title>. <source>BMC Bioinformatics</source>, <volume>12</volume>, <fpage>S21</fpage>.<pub-id pub-id-type="pmid">21342551</pub-id></mixed-citation>
    </ref>
    <ref id="btv584-B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>de Oliveira</surname><given-names>L.S.</given-names></name><etal/></person-group> (<year>2012</year>) <article-title>Transcriptomic analysis of the red seaweed <italic>Laurencia dendroidea</italic> (Florideophyceae, Rhodophyta) and its microbiome</article-title>. <source>BMC Genomics</source>, <volume>13</volume>, <fpage>487</fpage>.<pub-id pub-id-type="pmid">22985125</pub-id></mixed-citation>
    </ref>
    <ref id="btv584-B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ounit</surname><given-names>R.</given-names></name><etal/></person-group> (<year>2015</year>) <article-title>CLARK: fast and accurate classification of metagenomic and genomic sequences using discriminative k-mers</article-title>. <source>BMC Genomics</source>, <volume>16</volume>, <fpage>236</fpage>.<pub-id pub-id-type="pmid">25879410</pub-id></mixed-citation>
    </ref>
    <ref id="btv584-B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Overbeek</surname><given-names>R.</given-names></name><etal/></person-group> (<year>2004</year>) <article-title>The SEED: a peer-to-peer environment for genome annotation</article-title>. <source>Commun ACM</source>, <volume>47</volume>, <fpage>46</fpage>–<lpage>51</lpage>.</mixed-citation>
    </ref>
    <ref id="btv584-B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Overbeek</surname><given-names>R.</given-names></name><etal/></person-group> (<year>2005</year>) <article-title>The subsystems approach to genome annotation and its use in the project to annotate 1000 genomes</article-title>. <source>Nucleic Acids Res.</source>, <volume>33</volume>, <fpage>5691</fpage>–<lpage>5702</lpage>.<pub-id pub-id-type="pmid">16214803</pub-id></mixed-citation>
    </ref>
    <ref id="btv584-B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rho</surname><given-names>M.</given-names></name><etal/></person-group> (<year>2010</year>) <article-title>FragGeneScan: predicting genes in short and error-prone reads</article-title>. <source>Nucleic Acids Res.</source>, <volume>38</volume>, <fpage>e191</fpage>.<pub-id pub-id-type="pmid">20805240</pub-id></mixed-citation>
    </ref>
    <ref id="btv584-B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rotmistrovsky</surname><given-names>K.</given-names></name><name><surname>Agarwala</surname><given-names>R.</given-names></name></person-group> (<year>2011</year>) <article-title>BMTagger: best match tagger for removing human reads from metagenomics datasets</article-title>. <comment><ext-link ext-link-type="uri" xlink:href="http://www.mmnt.net/db/0/0/ftp.ncbi.nlm.nih.gov/pub/agarwala/bmtagger">http://www.mmnt.net/db/0/0/ftp.ncbi.nlm.nih.gov/pub/agarwala/bmtagger</ext-link> (20 October 2015, date last accessed).</comment></mixed-citation>
    </ref>
    <ref id="btv584-B31">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schmieder</surname><given-names>R.</given-names></name><name><surname>Edwards</surname><given-names>R.</given-names></name></person-group> (<year>2011</year>) <article-title>Fast identification and removal of sequence contamination from genomic and metagenomic datasets</article-title>. <source>PLoS One</source>, <volume>6</volume>, <fpage>e17288</fpage>.<pub-id pub-id-type="pmid">21408061</pub-id></mixed-citation>
    </ref>
    <ref id="btv584-B32">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Segata</surname><given-names>N.</given-names></name><etal/></person-group> (<year>2012</year>) <article-title>Metagenomic microbial community profiling using unique clade-specific marker genes</article-title>. <source>Nat. Methods</source>, <volume>9</volume>, <fpage>811</fpage>–<lpage>814</lpage>.<pub-id pub-id-type="pmid">22688413</pub-id></mixed-citation>
    </ref>
    <ref id="btv584-B33">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Silva</surname><given-names>G.G.Z.</given-names></name><etal/></person-group> (<year>2014</year>) <article-title>FOCUS: an alignment-free model to identify organisms in metagenomes using non-negative least squares</article-title>. <source>Peer J</source>, <volume>2</volume>, <fpage>e425</fpage>.<pub-id pub-id-type="pmid">24949242</pub-id></mixed-citation>
    </ref>
    <ref id="btv584-B34">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Trindade-Silva</surname><given-names>A.E.</given-names></name><etal/></person-group> (<year>2012</year>) <article-title>Taxonomic and functional microbial signatures of the endemic marine sponge arenosclera brasiliensis</article-title>. <source>PLoS One</source>, <volume>7</volume>, <fpage>e39905</fpage>.<pub-id pub-id-type="pmid">22768320</pub-id></mixed-citation>
    </ref>
    <ref id="btv584-B35">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Trindade-Silva</surname><given-names>A.E.</given-names></name><etal/></person-group> (<year>2013</year>) <article-title>Polyketide synthase gene diversity within the microbiome of the sponge arenosclera brasiliensis, endemic to the Southern Atlantic Ocean</article-title>. <source>Appl. Environ. Microbiol.</source>, <volume>79</volume>, <fpage>1598</fpage>–<lpage>1605</lpage>.<pub-id pub-id-type="pmid">23275501</pub-id></mixed-citation>
    </ref>
    <ref id="btv584-B36">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Weiss</surname><given-names>S.</given-names></name><etal/></person-group> (<year>2014</year>) <article-title>Tracking down the sources of experimental contamination in microbiome studies</article-title>. <source>Genome Biol.</source>, <volume>15</volume>, <fpage>564</fpage>.<pub-id pub-id-type="pmid">25608874</pub-id></mixed-citation>
    </ref>
    <ref id="btv584-B37">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Whitman</surname><given-names>W.B.</given-names></name><etal/></person-group> (<year>1998</year>) <article-title>Prokaryotes: the unseen majority</article-title>. <source>Proc. Natl. Acad. Sci. USA</source>, <volume>95</volume>, <fpage>6578</fpage>–<lpage>6583</lpage>.<pub-id pub-id-type="pmid">9618454</pub-id></mixed-citation>
    </ref>
    <ref id="btv584-B38">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wood</surname><given-names>D.E.</given-names></name><name><surname>Salzberg</surname><given-names>S.L.</given-names></name></person-group> (<year>2014</year>) <article-title>Kraken: ultrafast metagenomic sequence classification using exact alignments</article-title>. <source>Genome Biol.</source>, <volume>15</volume>, <fpage>R46</fpage>.<pub-id pub-id-type="pmid">24580807</pub-id></mixed-citation>
    </ref>
    <ref id="btv584-B39">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhang</surname><given-names>J.</given-names></name><etal/></person-group> (<year>2011</year>) <article-title>The impact of next-generation sequencing on genomics</article-title>. <source>J. Genet. Genomics</source>, <volume>38</volume>, <fpage>95</fpage>–<lpage>109</lpage>.<pub-id pub-id-type="pmid">21477781</pub-id></mixed-citation>
    </ref>
    <ref id="btv584-B40">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhao</surname><given-names>Y.</given-names></name><etal/></person-group> (<year>2012</year>) <article-title>RAPSearch2: a fast and memory-efficient protein similarity search tool for next-generation sequencing data</article-title>. <source>Bioinformatics</source>, <volume>28</volume>, <fpage>125</fpage>–<lpage>126</lpage>.<pub-id pub-id-type="pmid">22039206</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
