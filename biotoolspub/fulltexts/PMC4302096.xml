<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">4302096</article-id>
    <article-id pub-id-type="publisher-id">404</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-014-0404-0</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>ExpaRNA-P: simultaneous exact pattern matching and folding of RNAs</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Otto</surname>
          <given-names>Christina</given-names>
        </name>
        <address>
          <email>schmiedc@informatik.uni-freiburg.de</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Möhl</surname>
          <given-names>Mathias</given-names>
        </name>
        <address>
          <email>mamo181@googlemail.com</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Heyne</surname>
          <given-names>Steffen</given-names>
        </name>
        <address>
          <email>heyne@informatik.uni-freiburg.de</email>
        </address>
        <xref ref-type="aff" rid="Aff3"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Amit</surname>
          <given-names>Mika</given-names>
        </name>
        <address>
          <email>mika.amit2@gmail.com</email>
        </address>
        <xref ref-type="aff" rid="Aff4"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Landau</surname>
          <given-names>Gad M</given-names>
        </name>
        <address>
          <email>landau@univ.haifa.ac.il</email>
        </address>
        <xref ref-type="aff" rid="Aff4"/>
        <xref ref-type="aff" rid="Aff5"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Backofen</surname>
          <given-names>Rolf</given-names>
        </name>
        <address>
          <email>backofen@informatik.uni-freiburg.de</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
        <xref ref-type="aff" rid="Aff6"/>
        <xref ref-type="aff" rid="Aff7"/>
        <xref ref-type="aff" rid="Aff8"/>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Will</surname>
          <given-names>Sebastian</given-names>
        </name>
        <address>
          <email>swill@csail.mit.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
        <xref ref-type="aff" rid="Aff2"/>
      </contrib>
      <aff id="Aff1"><label/>Bioinformatics, Institute of Computer Science, University of Freiburg, Freiburg, Germany </aff>
      <aff id="Aff2"><label/>Bioinformatics, Department of Computer Science, University of Leipzig, Leipzig, Germany </aff>
      <aff id="Aff3"><label/>Max Planck Institute of Immunobiology and Epigenetics, Stuebeweg 51, Freiburg, 79108 Germany </aff>
      <aff id="Aff4"><label/>Department of Computer Science, University of Haifa, Mount Carmel, Haifa, Israel </aff>
      <aff id="Aff5"><label/>Department of Computer Science and Engineering, NYU-Poly, Brooklyn, NY USA </aff>
      <aff id="Aff6"><label/>Center for Biological Signaling Studies (BIOSS), University of Freiburg, Freiburg, Germany </aff>
      <aff id="Aff7"><label/>Centre for Biological Systems Analysis (ZBSA), University of Freiburg, Freiburg, Germany </aff>
      <aff id="Aff8"><label/>Center for non-coding RNA in Technology and Health, University of Copenhagen, Grønnegårdsvej 3, Frederiksberg C, DK-1870 Denmark </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>31</day>
      <month>12</month>
      <year>2014</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>31</day>
      <month>12</month>
      <year>2014</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2014</year>
    </pub-date>
    <volume>15</volume>
    <issue>1</issue>
    <elocation-id>404</elocation-id>
    <history>
      <date date-type="received">
        <day>4</day>
        <month>8</month>
        <year>2014</year>
      </date>
      <date date-type="accepted">
        <day>1</day>
        <month>12</month>
        <year>2014</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© Otto et al.; licensee BioMed Central. 2014</copyright-statement>
      <license license-type="open-access">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0">http://creativecommons.org/licenses/by/4.0</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly credited. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p>Identifying sequence-structure motifs common to two RNAs can speed up the comparison of structural RNAs substantially. The core algorithm of the existent approach ExpaRNA solves this problem for <italic>a priori known</italic> input structures. However, such structures are rarely known; moreover, predicting them computationally is no rescue, since single sequence structure prediction is highly unreliable.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p>The novel algorithm ExpaRNA-P computes exactly matching sequence-structure motifs in entire Boltzmann-distributed structure ensembles of two RNAs; thereby we match and fold RNAs simultaneously, analogous to the well-known “simultaneous alignment and folding” of RNAs. While this implies much higher flexibility compared to ExpaRNA, ExpaRNA-P has the same very low complexity (quadratic in time and space), which is enabled by its novel structure ensemble-based sparsification. Furthermore, we devise a generalized chaining algorithm to compute compatible subsets of ExpaRNA-P’s sequence-structure motifs. Resulting in the very fast RNA alignment approach ExpLoc-P, we utilize the best chain as anchor constraints for the sequence-structure alignment tool LocARNA. ExpLoc-P is benchmarked in several variants and versus state-of-the-art approaches. In particular, we formally introduce and evaluate strict and relaxed variants of the problem; the latter makes the approach sensitive to compensatory mutations. Across a benchmark set of typical non-coding RNAs, ExpLoc-P has similar accuracy to LocARNA but is four times faster (in both variants), while it achieves a speed-up over 30-fold for the longest benchmark sequences (≈400nt). Finally, different ExpLoc-P variants enable tailoring of the method to specific application scenarios. ExpaRNA-P and ExpLoc-P are distributed as part of the LocARNA package. The source code is freely available at http://www.bioinf.uni-freiburg.de/Software/ExpaRNA-P.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p>ExpaRNA-P’s novel ensemble-based sparsification reduces its complexity to quadratic time and space. Thereby, ExpaRNA-P significantly speeds up sequence-structure alignment while maintaining the alignment quality. Different ExpaRNA-P variants support a wide range of applications.</p>
      </sec>
      <sec>
        <title>Electronic supplementary material</title>
        <p>The online version of this article (doi:10.1186/s12859-014-0404-0) contains supplementary material, which is available to authorized users.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>RNA bioinformatics</kwd>
      <kwd>Structure-based comparison of RNA</kwd>
      <kwd>Sparsification</kwd>
    </kwd-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2014</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p>Genome-wide high-throughput transcriptomics has revealed evidence for massive transcription of eukaryotic genomes, vastly exceeding translation to proteins [<xref ref-type="bibr" rid="CR1">1</xref>-<xref ref-type="bibr" rid="CR3">3</xref>]. Ultimately, the ENCODE project [<xref ref-type="bibr" rid="CR4">4</xref>] has established pervasive transcription of most of both strands of the human genome. Remarkably, while only a minor fraction of the transcripts codes for proteins, the majority of the non-coding RNAs (ncRNAs) are associated with function [<xref ref-type="bibr" rid="CR5">5</xref>]. Nevertheless, the functional annotation is lagging behind strongly: reliable automated annotation pipelines exist only for subclasses of ncRNAs like tRNAs, microRNAs, or snoRNAs [<xref ref-type="bibr" rid="CR6">6</xref>].</p>
    <p>Recent computational screens, e.g. [<xref ref-type="bibr" rid="CR7">7</xref>], reveal stable, conserved structures in a large part of ncRNAs, again pointing to function. The <italic>de novo</italic> RNA-gene finders qrna [<xref ref-type="bibr" rid="CR8">8</xref>], MSARi [<xref ref-type="bibr" rid="CR9">9</xref>], EvoFold [<xref ref-type="bibr" rid="CR10">10</xref>], and RNAz [<xref ref-type="bibr" rid="CR11">11</xref>] identify conservation of stable RNA structures in whole genome alignments; this can be boosted by structure-based realignment (REAPR [<xref ref-type="bibr" rid="CR12">12</xref>]). Identifying RNAs with similar sequence and common secondary structure advances further towards the automatic annotation of non-coding RNAs. At genomic scale, clustering approaches like [<xref ref-type="bibr" rid="CR13">13</xref>-<xref ref-type="bibr" rid="CR15">15</xref>] identify remote members of RNA-<italic>families</italic> as defined in the Rfam database [<xref ref-type="bibr" rid="CR16">16</xref>], and determine new <italic>classes</italic> of structurally similar – hence, likely functionally related – ncRNAs. Thus, all such analysis of RNAs relies on comparing RNAs.</p>
    <sec id="Sec2">
      <title>Simultaneous alignment and folding (SA&amp;F)</title>
      <p>Aligning RNAs and, simultaneously, inferring their common structure is considered the gold standard for comparing RNAs. [<xref ref-type="bibr" rid="CR17">17</xref>] solves this problem in <italic>O</italic>(<italic>n</italic><sup>6</sup>) time and <italic>O</italic>(<italic>n</italic><sup>4</sup>) space (for RNAs of length <italic>n</italic>). In practice, e.g. for searching remote members of RNA-families, this complexity is strongly limiting. Even worse, identifying novel RNA-classes in the plethora of newly discovered RNA-transcripts (by all-against-all pairwise comparisons) is simply not feasible by Sankoff’s SA&amp;F method.</p>
      <p>Many Sankoff-implementations [<xref ref-type="bibr" rid="CR18">18</xref>-<xref ref-type="bibr" rid="CR24">24</xref>] reduce the high computational demands by sequence-based heuristics. A prominent line restricts the search space based on alignment probabilities that consider only sequence information. This idea was introduced by [<xref ref-type="bibr" rid="CR20">20</xref>], and later refined by [<xref ref-type="bibr" rid="CR22">22</xref>] and [<xref ref-type="bibr" rid="CR24">24</xref>].</p>
      <p>PMcomp [<xref ref-type="bibr" rid="CR25">25</xref>] introduced an orthogonal idea to gain speed up over Sankoff’s algorithm. Applying a lightweight energy model, which assigns energies to single base pairs, enables to lower computational costs significantly. For – at the same time – high accuracy, it scores structural matches by ensemble base pair probabilities, precomputed in a full-featured energy model [<xref ref-type="bibr" rid="CR26">26</xref>]. LocARNA [<xref ref-type="bibr" rid="CR13">13</xref>] implements the lightweight energy model of PMcomp, but gains further speed-up by introducing the structure-based heuristic <italic>ensemble-based sparsification</italic>. Employing the structural sparsity of RNA structure ensembles, LocARNA’s complexity is improved to only <italic>O</italic>(<italic>n</italic><sup>4</sup>) time and <italic>O</italic>(<italic>n</italic><sup>2</sup>) space.</p>
      <p>Subsequently, other Sankoff-like methods [<xref ref-type="bibr" rid="CR27">27</xref>-<xref ref-type="bibr" rid="CR29">29</xref>] apply similar ensemble-based sparsifications in lightweight models. RAF [<xref ref-type="bibr" rid="CR29">29</xref>] additionally inherits the sequence-based speed up of [<xref ref-type="bibr" rid="CR24">24</xref>].</p>
      <p>In [<xref ref-type="bibr" rid="CR30">30</xref>], we have proposed the lightweight SA&amp;F strategy ExpLoc; it cuts down the computational demands significantly beyond LocARNA’s sparsification, but unlike other heuristic improvements such as [<xref ref-type="bibr" rid="CR29">29</xref>], ExpLoc does not restrict the search space based on structure-ignorant sequence alignments. ExpLoc computes exactly conserved elements in pairs of <italic>fixed</italic> RNA secondary structures, based on an algorithm with quadratic time and space complexity [<xref ref-type="bibr" rid="CR31">31</xref>]; subsequently, these elements provide anchors for a LocARNA alignment. In hindsight, this strategy suffers from similar problems as the first generation of RNA alignment methods [<xref ref-type="bibr" rid="CR32">32</xref>,<xref ref-type="bibr" rid="CR33">33</xref>]: relying on a single predicted input structure for each sequence, this strategy fails frequently and causes severe misalignments, since predicting minimum free energy structures from single sequences is highly unreliable.</p>
    </sec>
    <sec id="Sec3">
      <title>Simultaneous matching and folding (SM&amp;F)</title>
      <p>Here, we present a novel algorithm that enables an ExpLoc-like speed-up while resolving its fundamental problem (of relying on fixed structures) by performing exact matching and RNA folding simultaneously. Studying exact matching in non-fixed structures with a very different focus, we have discussed heavy path decomposition for related problems [<xref ref-type="bibr" rid="CR34">34</xref>]; furthermore, we have presented preliminary work on ensemble-based exact matching in [<xref ref-type="bibr" rid="CR35">35</xref>]. The novel algorithm ExpaRNA-P computes exactly sequence-structure-conserved elements that form highly probable local substructures in the RNA structure ensembles of both input RNAs.</p>
      <p>Analogous to Sankoff’s SA&amp;F idea, the novel strategy performs “simultaneous matching and folding” (SM&amp;F) of RNA sequences. Thereby, it liberates exact pattern matching from its restriction to <italic>a priori</italic> fixed structure [<xref ref-type="bibr" rid="CR31">31</xref>]. We point out that a straight-forward extension of the fixed input structure matching to SM&amp;F, would require at least <italic>O</italic>(<italic>n</italic><sup>4</sup>) time and <italic>O</italic>(<italic>n</italic><sup>2</sup>) space, which is still as high as the complexity of LocARNA. However, to speed up RNA comparison significantly, reducing this complexity is fundamental.</p>
    </sec>
    <sec id="Sec4">
      <title>Sparsification of SM&amp;F</title>
      <p>Thus, our main technical contribution is to solve SM&amp;F in quadratic time and space — as efficiently as plain sequence alignment. This is enabled by a novel sparsification technique that substantially goes beyond prior approaches. Utilizing novel ensemble properties of the sequences, we identify sparse regions of each matrix such that, in total across all matrices, only quadratically many <italic>matrix entries</italic> have to be computed; each of them calculated in constant time. In contrast, LocARNA reduces only the number of computed <italic>DP-matrices</italic>, but requires quadratic time for each of them. This novel sparsification is based on limiting the joint probability of a sequence position or a base pair occurring as parts of particular loops in the ensembles of the single RNAs.</p>
      <p>Notably, other sparsification approaches [<xref ref-type="bibr" rid="CR36">36</xref>-<xref ref-type="bibr" rid="CR39">39</xref>] apply a different (not <italic>ensemble-based</italic>) form of sparsification. Generally, these methods rule out subsolutions, which are computed by the DP, that can not occur in the optimal solution. This allows deriving a provably optimal solution while reducing the number of required case distinctions. In contrast, the idea of our sparsification is to remove subsolutions that are unlikely in the solution ensemble. Consequently, ensemble-based sparsification does not only allow much stronger savings, but moreover is applicable even for computing partition functions of RNA alignments; this is realized in LocARNA-P [<xref ref-type="bibr" rid="CR40">40</xref>], which computes RNA alignment reliabilities from SA&amp;F partition functions.</p>
    </sec>
    <sec id="Sec5">
      <title>Overview of results</title>
      <p>To evaluate the practical benefits of our algorithmic innovations, we construct the pipeline ExpLoc-P for SA&amp;F (in the spirit of ExpLoc), which we sketch in Figure <xref rid="Fig1" ref-type="fig">1</xref>. In its first stage, it enumerates suboptimal exact matchings of local sequence-structure patterns due to the introduced algorithm ExpaRNA-P. In the second stage, the suboptimal matchings are chained to select an optimal subset of compatible matchings that can simultaneously occur in an alignment of RNAs. Finally, these matchings are heuristically utilized as anchor constraints in the subsequent LocARNA alignment.
<fig id="Fig1"><label>Figure 1</label><caption><p><bold>The </bold><bold>ExpLoc-P</bold><bold> pipeline.</bold> Using EPMs as anchor constraints to speed up RNA structure alignments.</p></caption><graphic xlink:href="12859_2014_404_Fig1_HTML" id="MO1"/></fig></p>
      <p>First, we study important design choices in the ExpLoc-P pipeline, which provides insights into practical implications of the developed concepts; in particular, we compare strict and relaxed matching in ExpaRNA-P. The latter allows mismatches at structural positions, which improves the coverage of low identity sequences. In extensive benchmarks, ExpLoc-P produces high-quality alignments. At the same time, due to its heuristic use of ExpaRNA-P anchors, it achieves a considerable speed-up (about four-fold) over the benchmark set of typical RNAs (BRAliBase 2.1). For long sequences (≈400 nt) of the benchmark set, the speed-up is more than 30-fold.</p>
    </sec>
  </sec>
  <sec id="Sec6" sec-type="methods">
    <title>Methods</title>
    <sec id="Sec7">
      <title>Preliminaries</title>
      <p>An <italic>RNA sequence A</italic> is a string over the alphabet {<italic>A</italic>,<italic>C</italic>,<italic>G</italic>,<italic>U</italic>}. <italic>A</italic><sub><italic>i</italic></sub> denotes the <italic>base at the i-th position of A</italic>; <italic>A</italic><sub><italic>i</italic>..<italic>j</italic></sub>, the <italic>substring of A from position i to j</italic>, which is called <italic>subsequence</italic> in this context; and |<italic>A</italic>|, the <italic>length of A</italic>. A <italic>structure</italic> of A is a set <italic>S</italic> of base pairs (<italic>i</italic>,<italic>j</italic>) such that 1≤<italic>i</italic>&lt;<italic>j</italic>≤|<italic>A</italic>|, where <italic>A</italic><sub><italic>i</italic></sub> and <italic>A</italic><sub><italic>j</italic></sub> are complementary (A-U, C-G, or G-U.) Furthermore, structures are <italic>non-crossing</italic>: in a structure <italic>S</italic>, each sequence position is involved in at most one base pair, i.e. for all (<italic>i</italic>,<italic>j</italic>),(<italic>i</italic><sup>′</sup>,<italic>j</italic><sup>′</sup>)∈<italic>S</italic>: (<italic>i</italic>=<italic>i</italic><sup>′</sup>⇔<italic>j</italic>=<italic>j</italic><sup>′</sup>) and <italic>i</italic>≠<italic>j</italic><sup>′</sup>, and base pairs do not <italic>cross</italic>, i.e. there are no base pairs (<italic>i</italic>,<italic>j</italic>),(<italic>i</italic><sup>′</sup>,<italic>j</italic><sup>′</sup>)∈<italic>S</italic> s.t. <italic>i</italic>&lt;<italic>i</italic><sup>′</sup>&lt;<italic>j</italic>&lt;<italic>j</italic><sup>′</sup>. The <italic>span</italic> of a base pair (<italic>i</italic>,<italic>j</italic>) is <italic>j</italic>−<italic>i</italic>.</p>
      <p>Let <italic>S</italic> be a structure of sequence <italic>A</italic>. We define the <italic>pseudo-base pair</italic><italic>ψ</italic><sub><italic>A</italic></sub>:=(0,|<italic>A</italic>|+1). The <italic>parent of position k in S</italic> is the base pair (<italic>i</italic>,<italic>j</italic>)∈<italic>S</italic>∪<italic>ψ</italic><sub><italic>A</italic></sub> with <italic>i</italic>&lt;<italic>k</italic>&lt;<italic>j</italic> such that there does not exist any (<italic>i</italic><sup>′</sup>,<italic>j</italic><sup>′</sup>)∈<italic>S</italic> with <italic>i</italic>&lt;<italic>i</italic><sup>′</sup>&lt;<italic>k</italic>&lt;<italic>j</italic><sup>′</sup>&lt;<italic>j</italic>. Analogously, the <italic>parent of a base pair (i,j)</italic> is the parent of <italic>i</italic> (which is the parent of <italic>j</italic> at the same time). Note that parents are unique, since non-crossing structures correspond to trees.</p>
      <p>Furthermore, we define loop<sub><italic>S</italic></sub>(<italic>i</italic>,<italic>j</italic>) as the set of positions of <italic>A</italic> and base pairs in <italic>S</italic>, whose parent in <italic>S</italic> is (<italic>i</italic>,<italic>j</italic>); note that loop<sub><italic>S</italic></sub>(<italic>i</italic>,<italic>j</italic>) is empty, if (<italic>i</italic>,<italic>j</italic>)∉<italic>S</italic>. Intuitively, if a base or base pair has the parent (<italic>i</italic>,<italic>j</italic>) in <italic>S</italic>, it belongs to the loop closed by (<italic>i</italic>,<italic>j</italic>) in <italic>S</italic>.</p>
      <p>For a sequence <italic>A</italic>, let Pr[<italic>S</italic>|<italic>A</italic>] denote the probability of the structure <italic>S</italic> in the Boltzmann ensemble of <italic>A</italic> [<xref ref-type="bibr" rid="CR26">26</xref>]. Pr[(<italic>i</italic>,<italic>j</italic>)|<italic>A</italic>] denotes the <italic>base pair probability of (i,j)</italic>, which is defined as <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$\sum _{S\ni (i,j)} \Pr \left [\vphantom {\Pr {\left [(i,j)|A\right ]}}S|A\right ]$
\end{document}</tex-math><mml:math id="M2"><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>S</mml:mi><mml:mo>∋</mml:mo><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:munder><mml:mo>Pr</mml:mo><mml:mfenced close="]" open="[" separators=""><mml:mrow><mml:mi>S</mml:mi><mml:mo>|</mml:mo><mml:mi>A</mml:mi></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2014_404_Article_IEq1.gif"/></alternatives></inline-formula>. Thus, Pr[(<italic>i</italic>,<italic>j</italic>)|<italic>A</italic>] is the probability that a random structure <italic>S</italic>, drawn from the Boltzmann ensemble of <italic>A</italic>, contains the base pair (<italic>i</italic>,<italic>j</italic>).</p>
    </sec>
    <sec id="Sec8">
      <title>Pattern matchings in RNA structure ensembles</title>
      <p>ExpaRNA-P identifies sequence-structure patterns that are shared by two input RNA sequences. We provide a general description of pattern matchings in RNA sequences and specialize to two different variants (for examples, see Figure <xref rid="Fig2" ref-type="fig">2</xref>). We fix sequences A and B with lengths |<italic>A</italic>|=<italic>n</italic> and |<italic>B</italic>|=<italic>m</italic>; for stating computational complexities, we assume <italic>m</italic>≤<italic>n</italic>. The sets of possible base pairs of respective sequences <italic>A</italic> and <italic>B</italic> are denoted by <italic>P</italic> and <italic>Q</italic>.
<fig id="Fig2"><label>Figure 2</label><caption><p><bold>Visualization of the pattern matching definition.</bold> Two different illustrations of the notion pattern matching are shown in <bold>(A)</bold> and <bold>(B)</bold>. For the light gray pattern matching, we have <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$\mathcal {M} = \{2\!\sim \!2,3\!\sim \!3,9\!\sim \!13,10\!\sim \!14,11\!\sim \!15\}$
\end{document}</tex-math><mml:math id="M4"><mml:mi mathvariant="script">ℳ</mml:mi><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:mn>2</mml:mn><mml:mspace width="0.3em"/><mml:mo>∼</mml:mo><mml:mspace width="0.3em"/><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>3</mml:mn><mml:mspace width="0.3em"/><mml:mo>∼</mml:mo><mml:mspace width="0.3em"/><mml:mn>3</mml:mn><mml:mo>,</mml:mo><mml:mn>9</mml:mn><mml:mspace width="0.3em"/><mml:mo>∼</mml:mo><mml:mspace width="0.3em"/><mml:mn>13</mml:mn><mml:mo>,</mml:mo><mml:mn>10</mml:mn><mml:mspace width="0.3em"/><mml:mo>∼</mml:mo><mml:mspace width="0.3em"/><mml:mn>14</mml:mn><mml:mo>,</mml:mo><mml:mn>11</mml:mn><mml:mspace width="0.3em"/><mml:mo>∼</mml:mo><mml:mspace width="0.3em"/><mml:mn>15</mml:mn><mml:mo>}</mml:mo></mml:math><inline-graphic xlink:href="12859_2014_404_Article_IEq2.gif"/></alternatives></inline-formula> and <inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$\mathcal {S} = \{(2,11\!\sim \!2,15), (3,10\!\sim \!3,14)\}$
\end{document}</tex-math><mml:math id="M6"><mml:mi mathvariant="script">S</mml:mi><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:mo>(</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>11</mml:mn><mml:mspace width="0.3em"/><mml:mo>∼</mml:mo><mml:mspace width="0.3em"/><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>15</mml:mn><mml:mo>)</mml:mo><mml:mo>,</mml:mo><mml:mo>(</mml:mo><mml:mn>3</mml:mn><mml:mo>,</mml:mo><mml:mn>10</mml:mn><mml:mspace width="0.3em"/><mml:mo>∼</mml:mo><mml:mspace width="0.3em"/><mml:mn>3</mml:mn><mml:mo>,</mml:mo><mml:mn>14</mml:mn><mml:mo>)</mml:mo><mml:mo>}</mml:mo></mml:math><inline-graphic xlink:href="12859_2014_404_Article_IEq3.gif"/></alternatives></inline-formula>. Note that the two separated regions in both sequences are connected through base pairs. Furthermore, the set of structure matches is <inline-formula id="IEq4"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$\mathcal {M}\vert _{\mathcal {S}}=\{2\!\sim \!2,3\!\sim \!3,10\!\sim \!14,11\!\sim \!15\}$
\end{document}</tex-math><mml:math id="M8"><mml:mi mathvariant="script">ℳ</mml:mi><mml:msub><mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="script">S</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:mn>2</mml:mn><mml:mspace width="0.3em"/><mml:mo>∼</mml:mo><mml:mspace width="0.3em"/><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>3</mml:mn><mml:mspace width="0.3em"/><mml:mo>∼</mml:mo><mml:mspace width="0.3em"/><mml:mn>3</mml:mn><mml:mo>,</mml:mo><mml:mn>10</mml:mn><mml:mspace width="0.3em"/><mml:mo>∼</mml:mo><mml:mspace width="0.3em"/><mml:mn>14</mml:mn><mml:mo>,</mml:mo><mml:mn>11</mml:mn><mml:mspace width="0.3em"/><mml:mo>∼</mml:mo><mml:mspace width="0.3em"/><mml:mn>15</mml:mn><mml:mo>}</mml:mo></mml:math><inline-graphic xlink:href="12859_2014_404_Article_IEq4.gif"/></alternatives></inline-formula> and the set of sequence matches is <inline-formula id="IEq5"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$\mathcal {M} \setminus \mathcal {M}\vert _{\mathcal {S}} =\{9\!\sim \!13\}$
\end{document}</tex-math><mml:math id="M10"><mml:mi mathvariant="script">ℳ</mml:mi><mml:mo>∖</mml:mo><mml:mi mathvariant="script">ℳ</mml:mi><mml:msub><mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="script">S</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:mn>9</mml:mn><mml:mspace width="0.3em"/><mml:mo>∼</mml:mo><mml:mspace width="0.3em"/><mml:mn>13</mml:mn><mml:mo>}</mml:mo></mml:math><inline-graphic xlink:href="12859_2014_404_Article_IEq5.gif"/></alternatives></inline-formula>. The pattern matching can be extended by the base pair match shown in dark gray, i.e., <inline-formula id="IEq6"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$\mathcal {M}' = \mathcal {M} \cup \{1\!\sim \!1,12\!\sim \!16\}$
\end{document}</tex-math><mml:math id="M12"><mml:msup><mml:mrow><mml:mi mathvariant="script">ℳ</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mi mathvariant="script">ℳ</mml:mi><mml:mo>∪</mml:mo><mml:mo>{</mml:mo><mml:mn>1</mml:mn><mml:mspace width="0.3em"/><mml:mo>∼</mml:mo><mml:mspace width="0.3em"/><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>12</mml:mn><mml:mspace width="0.3em"/><mml:mo>∼</mml:mo><mml:mspace width="0.3em"/><mml:mn>16</mml:mn><mml:mo>}</mml:mo></mml:math><inline-graphic xlink:href="12859_2014_404_Article_IEq6.gif"/></alternatives></inline-formula> and <inline-formula id="IEq7"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$\mathcal {S}' = \mathcal {S} \cup \{(1,12\!\sim \!1,16)\}$
\end{document}</tex-math><mml:math id="M14"><mml:msup><mml:mrow><mml:mi mathvariant="script">S</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo>∪</mml:mo><mml:mo>{</mml:mo><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>12</mml:mn><mml:mspace width="0.3em"/><mml:mo>∼</mml:mo><mml:mspace width="0.3em"/><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>16</mml:mn><mml:mo>)</mml:mo><mml:mo>}</mml:mo></mml:math><inline-graphic xlink:href="12859_2014_404_Article_IEq7.gif"/></alternatives></inline-formula>. <inline-formula id="IEq8"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$(\mathcal {M},\mathcal {S})$
\end{document}</tex-math><mml:math id="M16"><mml:mo>(</mml:mo><mml:mi mathvariant="script">ℳ</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2014_404_Article_IEq8.gif"/></alternatives></inline-formula>, the EPM shown in light gray, is a strict EPM, whereas <inline-formula id="IEq9"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$(\mathcal {M}',\mathcal {S}')$
\end{document}</tex-math><mml:math id="M18"><mml:mo>(</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="script">ℳ</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="script">S</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2014_404_Article_IEq9.gif"/></alternatives></inline-formula>, the EPM extended by the dark gray part, is a relaxed EPM as mismatches in structure matches occur. <bold>(C)</bold> shows an example of an invalid matching. Separately, both the small and the big matched gray parts are valid EPMs, but together they do not form a valid EPM as the two individual parts are not connected.</p></caption><graphic xlink:href="12859_2014_404_Fig2_HTML" id="MO2"/></fig></p>
      <sec id="d30e1615">
        <title><bold>Definition</bold><bold>1</bold> (connected, Pattern Matching).</title>
        <p>We denote the <italic>match of positions i and k</italic> by <italic>i</italic> ∼ <italic>k</italic> and the <italic>base pair match of base pairs (i,j) and (k,l)</italic> by <italic>i</italic><italic>j</italic> ∼ <italic>k</italic><italic>l</italic>. We consider pairs <inline-graphic xlink:href="12859_2014_404_Figa_HTML.gif" id="d30e1648"/> of arbitrary sets <inline-formula id="IEq10"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$\mathcal {M}\subseteq \{i\!\sim \!k \mid i\in [\!1..n],k\in [\!1..m]\!\}$
\end{document}</tex-math><mml:math id="M20"><mml:mi mathvariant="script">ℳ</mml:mi><mml:mo>⊆</mml:mo><mml:mo>{</mml:mo><mml:mi>i</mml:mi><mml:mspace width="0.3em"/><mml:mo>∼</mml:mo><mml:mspace width="0.3em"/><mml:mi>k</mml:mi><mml:mo>∣</mml:mo><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mo>[</mml:mo><mml:mspace width="0.3em"/><mml:mn>1</mml:mn><mml:mi>..n</mml:mi><mml:mo>]</mml:mo><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>∈</mml:mo><mml:mo>[</mml:mo><mml:mspace width="0.3em"/><mml:mn>1</mml:mn><mml:mi>..m</mml:mi><mml:mo>]</mml:mo><mml:mspace width="0.3em"/><mml:mo>}</mml:mo></mml:math><inline-graphic xlink:href="12859_2014_404_Article_IEq10.gif"/></alternatives></inline-formula> and <inline-formula id="IEq11"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$\mathcal {S}\subseteq \{ij\!\sim \!kl \mid (i,j)\in [\!1..n]^{2}, i&lt;j, (k,l)\in [\!1..m]^{2},k&lt;l\}$
\end{document}</tex-math><mml:math id="M22"><mml:mi mathvariant="script">S</mml:mi><mml:mo>⊆</mml:mo><mml:mo>{</mml:mo><mml:mtext mathvariant="italic">ij</mml:mtext><mml:mspace width="0.3em"/><mml:mo>∼</mml:mo><mml:mspace width="0.3em"/><mml:mtext mathvariant="italic">kl</mml:mtext><mml:mo>∣</mml:mo><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mo>[</mml:mo><mml:mspace width="0.3em"/><mml:mn>1</mml:mn><mml:mi>..n</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi><mml:mo>)</mml:mo><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mo>[</mml:mo><mml:mspace width="0.3em"/><mml:mn>1</mml:mn><mml:mi>..m</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>l</mml:mi><mml:mo>}</mml:mo></mml:math><inline-graphic xlink:href="12859_2014_404_Article_IEq11.gif"/></alternatives></inline-formula>. <inline-formula id="IEq12"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$\mathcal {P}=(\mathcal {M},\mathcal {S})$
\end{document}</tex-math><mml:math id="M24"><mml:mi mathvariant="script">P</mml:mi><mml:mo>=</mml:mo><mml:mo>(</mml:mo><mml:mi mathvariant="script">ℳ</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2014_404_Article_IEq12.gif"/></alternatives></inline-formula> is <italic>connected</italic>, iff the graph <inline-formula id="IEq13"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$\mathcal {G}_{\mathcal {P}}=(\mathcal {M},\mathcal {E})$
\end{document}</tex-math><mml:math id="M26"><mml:msub><mml:mrow><mml:mi mathvariant="script">G</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="script">P</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>(</mml:mo><mml:mi mathvariant="script">ℳ</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="script">E</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2014_404_Article_IEq13.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq14"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$\mathcal {E}=\{(i\!\sim \!k,j\!\sim \!l) \mid (\,j=i+1 \text {~and~} l=k+1) \text {~or~} ij\!\sim \!kl\in \mathcal {S}\}$
\end{document}</tex-math><mml:math id="M28"><mml:mi mathvariant="script">E</mml:mi><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mspace width="0.3em"/><mml:mo>∼</mml:mo><mml:mspace width="0.3em"/><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mspace width="0.3em"/><mml:mo>∼</mml:mo><mml:mspace width="0.3em"/><mml:mi>l</mml:mi><mml:mo>)</mml:mo><mml:mo>∣</mml:mo><mml:mo>(</mml:mo><mml:mspace width="0.3em"/><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mtext>and</mml:mtext><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo><mml:mtext>or</mml:mtext><mml:mtext mathvariant="italic">ij</mml:mtext><mml:mspace width="0.3em"/><mml:mo>∼</mml:mo><mml:mspace width="0.3em"/><mml:mtext mathvariant="italic">kl</mml:mtext><mml:mo>∈</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo>}</mml:mo></mml:math><inline-graphic xlink:href="12859_2014_404_Article_IEq14.gif"/></alternatives></inline-formula>, is (weakly) connected.</p>
        <p><inline-graphic xlink:href="12859_2014_404_Figa_HTML.gif" id="d30e1944"/> is called <italic>Pattern Matching</italic> iff 
<list list-type="bullet"><list-item><p><inline-graphic xlink:href="12859_2014_404_Figb_HTML.gif" id="d30e1953"/> is a matching,</p><p>i.e. <italic>i</italic>=<italic>j</italic>⇔<italic>k</italic>=<italic>l</italic> for all <inline-formula id="IEq15"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$i\!\sim \!k, j\!\sim \!l\in \mathcal {M}$
\end{document}</tex-math><mml:math id="M30"><mml:mi>i</mml:mi><mml:mspace width="0.3em"/><mml:mo>∼</mml:mo><mml:mspace width="0.3em"/><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mspace width="0.3em"/><mml:mo>∼</mml:mo><mml:mspace width="0.3em"/><mml:mi>l</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="script">ℳ</mml:mi></mml:math><inline-graphic xlink:href="12859_2014_404_Article_IEq15.gif"/></alternatives></inline-formula></p></list-item><list-item><p><inline-graphic xlink:href="12859_2014_404_Figb_HTML.gif" id="d30e2002"/> is non-crossing,</p><p>i.e. <italic>i</italic>&lt;<italic>j</italic>⇒<italic>k</italic>&lt;<italic>l</italic> for all <inline-formula id="IEq16"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$i\!\sim \!k,j\!\sim \!l\in \mathcal {M}$
\end{document}</tex-math><mml:math id="M32"><mml:mi>i</mml:mi><mml:mspace width="0.3em"/><mml:mo>∼</mml:mo><mml:mspace width="0.3em"/><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mspace width="0.3em"/><mml:mo>∼</mml:mo><mml:mspace width="0.3em"/><mml:mi>l</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="script">ℳ</mml:mi></mml:math><inline-graphic xlink:href="12859_2014_404_Article_IEq16.gif"/></alternatives></inline-formula></p></list-item><list-item><p><inline-graphic xlink:href="12859_2014_404_Figb_HTML.gif" id="d30e2051"/> ‘contains’ <inline-graphic xlink:href="12859_2014_404_Figc_HTML.gif" id="d30e2054"/>,</p><p>i.e. <inline-formula id="IEq17"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$ij\!\sim \!kl\in \mathcal {S}\Rightarrow \{i\!\sim \!k,j\!\sim \!l\}\subseteq \mathcal {M}$
\end{document}</tex-math><mml:math id="M34"><mml:mtext mathvariant="italic">ij</mml:mtext><mml:mspace width="0.3em"/><mml:mo>∼</mml:mo><mml:mspace width="0.3em"/><mml:mtext mathvariant="italic">kl</mml:mtext><mml:mo>∈</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo>⇒</mml:mo><mml:mo>{</mml:mo><mml:mi>i</mml:mi><mml:mspace width="0.3em"/><mml:mo>∼</mml:mo><mml:mspace width="0.3em"/><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mspace width="0.3em"/><mml:mo>∼</mml:mo><mml:mspace width="0.3em"/><mml:mi>l</mml:mi><mml:mo>}</mml:mo><mml:mo>⊆</mml:mo><mml:mi mathvariant="script">ℳ</mml:mi></mml:math><inline-graphic xlink:href="12859_2014_404_Article_IEq17.gif"/></alternatives></inline-formula></p></list-item><list-item><p>the structure <inline-formula id="IEq18"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$\{(i,j) \mid ij\!\sim \!kl\in {\mathcal S}\}$
\end{document}</tex-math><mml:math id="M36"><mml:mo>{</mml:mo><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo><mml:mo>∣</mml:mo><mml:mtext mathvariant="italic">ij</mml:mtext><mml:mspace width="0.3em"/><mml:mo>∼</mml:mo><mml:mspace width="0.3em"/><mml:mtext mathvariant="italic">kl</mml:mtext><mml:mo>∈</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo>}</mml:mo></mml:math><inline-graphic xlink:href="12859_2014_404_Article_IEq18.gif"/></alternatives></inline-formula> is non-crossing</p><p>(consequently, together with the previous condition, <inline-formula id="IEq19"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$\{(k,l) \mid ij\!\sim \!kl\in \mathcal {S}\}$
\end{document}</tex-math><mml:math id="M38"><mml:mo>{</mml:mo><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi><mml:mo>)</mml:mo><mml:mo>∣</mml:mo><mml:mtext mathvariant="italic">ij</mml:mtext><mml:mspace width="0.3em"/><mml:mo>∼</mml:mo><mml:mspace width="0.3em"/><mml:mtext mathvariant="italic">kl</mml:mtext><mml:mo>∈</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo>}</mml:mo></mml:math><inline-graphic xlink:href="12859_2014_404_Article_IEq19.gif"/></alternatives></inline-formula> is non-crossing as well).</p></list-item><list-item><p><inline-formula id="IEq20"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$(\mathcal {M},\mathcal {S})$
\end{document}</tex-math><mml:math id="M40"><mml:mo>(</mml:mo><mml:mi mathvariant="script">ℳ</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2014_404_Article_IEq20.gif"/></alternatives></inline-formula> is connected.</p></list-item></list></p>
        <p>A position <italic>i</italic> is <italic>matched by</italic><inline-graphic xlink:href="12859_2014_404_Figa_HTML.gif" id="d30e2214"/><italic>(in sequence A)</italic> iff there is a position <italic>k</italic>, s.t. <inline-formula id="IEq21"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$i\!\sim \!k\in \mathcal {M}.$
\end{document}</tex-math><mml:math id="M42"><mml:mi>i</mml:mi><mml:mspace width="0.3em"/><mml:mo>∼</mml:mo><mml:mspace width="0.3em"/><mml:mi>k</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="script">ℳ.</mml:mi></mml:math><inline-graphic xlink:href="12859_2014_404_Article_IEq21.gif"/></alternatives></inline-formula> This is symmetrically defined for positions <italic>j</italic> and sequence <italic>B</italic>.</p>
        <p>We are going to define strict and relaxed exact pattern matchings (cf. Figure <xref rid="Fig2" ref-type="fig">2</xref>AB). In the former, all matched nucleotides have to be identical. The latter relaxes this by allowing mismatched nucleotides at matched base pairs (taking compensatory mutations into account).</p>
        <p>For this purpose, we distinguish two kinds of matches in a pattern matching <inline-formula id="IEq22"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$({\mathcal M},{\mathcal S})$
\end{document}</tex-math><mml:math id="M44"><mml:mo>(</mml:mo><mml:mi mathvariant="script">ℳ</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2014_404_Article_IEq22.gif"/></alternatives></inline-formula>: define the set of structure matches as <inline-formula id="IEq23"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$\mathcal {M}\vert _{\mathcal {S}}:=\{i\!\sim \!k,j\!\sim \!l \mid ij\!\sim \!kl\in \mathcal {S}\}$
\end{document}</tex-math><mml:math id="M46"><mml:mi mathvariant="script">ℳ</mml:mi><mml:msub><mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="script">S</mml:mi></mml:mrow></mml:msub><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:mi>i</mml:mi><mml:mspace width="0.3em"/><mml:mo>∼</mml:mo><mml:mspace width="0.3em"/><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mspace width="0.3em"/><mml:mo>∼</mml:mo><mml:mspace width="0.3em"/><mml:mi>l</mml:mi><mml:mo>∣</mml:mo><mml:mtext mathvariant="italic">ij</mml:mtext><mml:mspace width="0.3em"/><mml:mo>∼</mml:mo><mml:mspace width="0.3em"/><mml:mtext mathvariant="italic">kl</mml:mtext><mml:mo>∈</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo>}</mml:mo></mml:math><inline-graphic xlink:href="12859_2014_404_Article_IEq23.gif"/></alternatives></inline-formula>; the set of sequence matches is 
<disp-formula id="Equa"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
 $$\mathcal{M} \setminus \mathcal{M}\vert_{\mathcal{S}} = \{i\!\sim\!k \in \mathcal{M} \mid i\!\sim\!k \notin \mathcal{M}\vert_{\mathcal{S}}\}, $$ 
\end{document}</tex-math><mml:math id="M48"><mml:mrow><mml:mi mathvariant="script">ℳ</mml:mi><mml:mo>∖</mml:mo><mml:mi mathvariant="script">ℳ</mml:mi><mml:msub><mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="script">S</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:mi>i</mml:mi><mml:mspace width="0.3em"/><mml:mo>∼</mml:mo><mml:mspace width="0.3em"/><mml:mi>k</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="script">ℳ</mml:mi><mml:mo>∣</mml:mo><mml:mi>i</mml:mi><mml:mspace width="0.3em"/><mml:mo>∼</mml:mo><mml:mspace width="0.3em"/><mml:mi>k</mml:mi><mml:mo>∉</mml:mo><mml:mi mathvariant="script">ℳ</mml:mi><mml:msub><mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="script">S</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:math><graphic xlink:href="12859_2014_404_Article_Equa.gif" position="anchor"/></alternatives></disp-formula> i.e. all matches that are not structural matches.</p>
      </sec>
      <sec id="d30e2397">
        <title><bold>Definition</bold><bold>2</bold> (Strict EPM).</title>
        <p>A <italic>strict Exact Pattern Matching (strict EPM)</italic> is a pattern matching (Def. 1) with the additional property: 
<disp-formula id="Equb"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
 $$\text{for all}~ i\!\sim\!k \in \mathcal{M}: A_{i}=B_{k}. $$ 
\end{document}</tex-math><mml:math id="M50"><mml:mrow><mml:mtext>for all</mml:mtext><mml:mspace width="1em"/><mml:mi>i</mml:mi><mml:mspace width="0.3em"/><mml:mo>∼</mml:mo><mml:mspace width="0.3em"/><mml:mi>k</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="script">ℳ</mml:mi><mml:mo>:</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mi>.</mml:mi></mml:mrow></mml:math><graphic xlink:href="12859_2014_404_Article_Equb.gif" position="anchor"/></alternatives></disp-formula></p>
      </sec>
      <sec id="d30e2453">
        <title><bold>Definition</bold><bold>3</bold> (Relaxed EPM).</title>
        <p>A <italic>relaxed Exact Pattern Matching (relaxed EPM)</italic> is a pattern matching with the additional property: 
<disp-formula id="Equc"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
 $$\text{for all}~ i\!\sim\!k \in \mathcal{M} \setminus \mathcal{M}\vert_{\mathcal{S}} : A_{i}=B_{k}. $$ 
\end{document}</tex-math><mml:math id="M52"><mml:mrow><mml:mtext>for all</mml:mtext><mml:mspace width="1em"/><mml:mi>i</mml:mi><mml:mspace width="0.3em"/><mml:mo>∼</mml:mo><mml:mspace width="0.3em"/><mml:mi>k</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="script">ℳ</mml:mi><mml:mo>∖</mml:mo><mml:mi mathvariant="script">ℳ</mml:mi><mml:msub><mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="script">S</mml:mi></mml:mrow></mml:msub><mml:mo>:</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mi>.</mml:mi></mml:mrow></mml:math><graphic xlink:href="12859_2014_404_Article_Equc.gif" position="anchor"/></alternatives></disp-formula></p>
        <p>We introduce the term EPM to refer to strict EPMs and relaxed EPMs generically. By Definition 1, a pattern matching, and therefore an EPM, does not necessarily match positions of contiguous subsequences, but it is required that the matched sequence-structure motifs are <italic>structure-local</italic> [<xref ref-type="bibr" rid="CR41">41</xref>,<xref ref-type="bibr" rid="CR42">42</xref>] in each sequence. For example, in Figure <xref rid="Fig2" ref-type="fig">2</xref>B, the sets of gray sequence positions in each RNA are <italic>structure-local</italic>, because these positions are (graph-theoretically) connected via edges formed by backbone or base pair bonds; in contrast gray motifs in Figure <xref rid="Fig2" ref-type="fig">2</xref>C are not structure-local, because they consist of two separated connected components.</p>
        <p>To characterize good EPMs, we define the <italic>score of an EPM </italic><inline-formula id="IEq24"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$(\mathcal {M},\mathcal {S})$
\end{document}</tex-math><mml:math id="M54"><mml:mo>(</mml:mo><mml:mi mathvariant="script">ℳ</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2014_404_Article_IEq24.gif"/></alternatives></inline-formula> by summing up single score contributions of base and base pair matches: 
<disp-formula id="Equ1"><label>(1)</label><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
 $$ \text{score}(\mathcal{M},\mathcal{S})=\!\!\sum_{i\sim k\in \mathcal{M} \setminus \mathcal{M}\vert_{\mathcal{S}}}\!\!\sigma(i,k)\ + \sum_{ij\sim kl \in \mathcal{S}}\!\!\tau(i,j,k,l),  $$ 
\end{document}</tex-math><mml:math id="M56"><mml:mtext>score</mml:mtext><mml:mo>(</mml:mo><mml:mi mathvariant="script">ℳ</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mspace width="0.3em"/><mml:mspace width="0.3em"/><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>∼</mml:mo><mml:mi>k</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="script">ℳ</mml:mi><mml:mo>∖</mml:mo><mml:mi mathvariant="script">ℳ</mml:mi><mml:msub><mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="script">S</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:mspace width="0.3em"/><mml:mspace width="0.3em"/><mml:mi>σ</mml:mi><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>)</mml:mo><mml:mspace width="1em"/><mml:mo>+</mml:mo><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext><mml:mo>∼</mml:mo><mml:mtext mathvariant="italic">kl</mml:mtext><mml:mo>∈</mml:mo><mml:mi mathvariant="script">S</mml:mi></mml:mrow></mml:munder><mml:mspace width="0.3em"/><mml:mspace width="0.3em"/><mml:mi>τ</mml:mi><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi><mml:mo>)</mml:mo><mml:mo>,</mml:mo></mml:math><graphic xlink:href="12859_2014_404_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula></p>
        <p>where <italic>σ</italic> and <italic>τ</italic> are scoring functions with properties <italic>σ</italic>(<italic>i</italic>,<italic>k</italic>)&gt;0 if <italic>A</italic><sub><italic>i</italic></sub>=<italic>B</italic><sub><italic>k</italic></sub> and <italic>τ</italic>(<italic>i</italic>,<italic>j</italic>,<italic>k</italic>,<italic>l</italic>)&gt;0 if <italic>A</italic><sub><italic>i</italic></sub>=<italic>B</italic><sub><italic>k</italic></sub> and <italic>A</italic><sub><italic>j</italic></sub>=<italic>B</italic><sub><italic>l</italic></sub>. In our studies, we set <italic>σ</italic>(<italic>i</italic>,<italic>k</italic>) to 1 if <italic>A</italic><sub><italic>i</italic></sub>=<italic>B</italic><sub><italic>k</italic></sub> (otherwise, −<italic>∞</italic>); furthermore, <italic>τ</italic> is parameterized by 
<disp-formula id="Equ2"><label>(2)</label><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
 $$ \begin{aligned} \tau(i,j,k,l)&amp;= \alpha_{1} \left(\text{c\_seq}(i,k) + \text{c\_seq}(j,l)\right) \\ &amp;\hspace*{12pt} + \alpha_{2} \text{c\_str}(i,j,k,l) \\ &amp;\hspace*{12pt}+ \alpha_{3} \text{c\_sta}(i,j,k,l) \\ \text{c\_seq}(i,k)&amp;= \begin{cases} 1 &amp; \text{if}~A_{i} = B_{k} \\ \text{str\_mm} &amp; A_{i} \neq B_{k} \end{cases}\\ \text{c\_str}(i,j,k,l)&amp;= \Pr\left[{(i,j)|A}\right]+\Pr\left[\vphantom{\Pr{\left[(i,j)|A\right]}}{(k,l)|B}\right]\\ \text{c\_sta}(i,j,k,l)&amp;= \Pr\left[{(i,j) \land (i+1,j-1)|A}\right]\\ &amp;\hspace*{12pt}+ \Pr\left[\vphantom{{(i,j) \land (i+1,j-1)|A}}{(k,l) \land (k+1,l-1)|B}\right] \end{aligned}  $$ 
\end{document}</tex-math><mml:math id="M58"><mml:mtable><mml:mtr><mml:mtd><mml:mi>τ</mml:mi><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi><mml:mo>)</mml:mo></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mtext>c_seq</mml:mtext><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:mtext>c_seq</mml:mtext><mml:mo>(</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mfenced></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mspace width="12.0pt"/><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mtext>c_str</mml:mtext><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi><mml:mo>)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mspace width="12.0pt"/><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mtext>c_sta</mml:mtext><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi><mml:mo>)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mtext>c_seq</mml:mtext><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>)</mml:mo></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mfenced close="" open="{" separators=""><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mn>1</mml:mn><mml:mspace width="1em"/></mml:mtd><mml:mtd><mml:mtext>if</mml:mtext><mml:mspace width="1em"/><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mtext>str_mm</mml:mtext><mml:mspace width="1em"/></mml:mtd><mml:mtd><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>≠</mml:mo><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mtext>c_str</mml:mtext><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi><mml:mo>)</mml:mo></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mo>Pr</mml:mo><mml:mfenced close="]" open="[" separators=""><mml:mrow><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo><mml:mo>|</mml:mo><mml:mi>A</mml:mi></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:mo>Pr</mml:mo><mml:mfenced close="]" open="[" separators=""><mml:mrow><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi><mml:mo>)</mml:mo><mml:mo>|</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:mfenced></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mtext>c_sta</mml:mtext><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi><mml:mo>)</mml:mo></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mo>Pr</mml:mo><mml:mfenced close="]" open="[" separators=""><mml:mrow><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo><mml:mo>∧</mml:mo><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo><mml:mo>|</mml:mo><mml:mi>A</mml:mi></mml:mrow></mml:mfenced></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mspace width="12.0pt"/><mml:mo>+</mml:mo><mml:mo>Pr</mml:mo><mml:mfenced close="]" open="[" separators=""><mml:mrow><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi><mml:mo>)</mml:mo><mml:mo>∧</mml:mo><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>l</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo><mml:mo>|</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:mfenced></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="12859_2014_404_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula></p>
        <p>The parameters <italic>α</italic><sub>1</sub>, <italic>α</italic><sub>2</sub>, and <italic>α</italic><sub>3</sub> weight respective contributions of sequence matches, structure matches, and stacking. The stacking contribution <italic>c_sta</italic> rewards stacked base pairs. Each mismatch at the left or right end of a base pair match is penalized by <italic>str_mm</italic>; for scoring strict EPMs, we set this penalty to −<italic>∞</italic>, which forbids all kinds of mismatches. In analogy to the notation Pr[(<italic>i</italic>,<italic>j</italic>)|<italic>A</italic>], Pr[(<italic>i</italic>,<italic>j</italic>)∧(<italic>i</italic>+1,<italic>j</italic>−1)|<italic>A</italic>] denotes the joint probability of the stacked base pairs (<italic>i</italic>,<italic>j</italic>) and (<italic>i</italic>+1,<italic>j</italic>−1). Such probabilities are computed in slight extension of McCaskill’s algorithm [<xref ref-type="bibr" rid="CR43">43</xref>].</p>
        <p>As in the case of RNA structures (of some sequence <italic>A</italic>), one can define parent relations in EPMs of sequences <italic>A</italic> and <italic>B</italic>. In analogy, we define the <italic>pseudo-base pair match</italic> to match the two pseudo base pairs, i.e. <italic>ψ</italic>:=<italic>ψ</italic><sub><italic>A</italic></sub> ∼ <italic>ψ</italic><sub><italic>B</italic></sub>. In the following, we consider the base pair matches <italic>i</italic><sup>′</sup><italic>j</italic><sup>′</sup> ∼ <italic>k</italic><sup>′</sup><italic>l</italic><sup>′</sup> to be order by their spans <italic>j</italic><sup>′</sup>−<italic>i</italic><sup>′</sup> (or <italic>k</italic><sup>′</sup>−<italic>l</italic><sup>′</sup>; the choice is arbitrary, since we consider only non-crossing structure.) According to this partial order, we define <inline-formula id="IEq25"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$\text {parent}_{\mathcal {S}}(i\!\sim \!k)$
\end{document}</tex-math><mml:math id="M60"><mml:msub><mml:mrow><mml:mtext>parent</mml:mtext></mml:mrow><mml:mrow><mml:mi mathvariant="script">S</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mspace width="0.3em"/><mml:mo>∼</mml:mo><mml:mspace width="0.3em"/><mml:mi>k</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2014_404_Article_IEq25.gif"/></alternatives></inline-formula> as the smallest <inline-formula id="IEq26"><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$i'j'\!\sim \!k'l'\in \mathcal {S}\cup \{\psi \}$
\end{document}</tex-math><mml:math id="M62"><mml:msup><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mspace width="0.3em"/><mml:mo>∼</mml:mo><mml:mspace width="0.3em"/><mml:msup><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>∈</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo>∪</mml:mo><mml:mo>{</mml:mo><mml:mi>ψ</mml:mi><mml:mo>}</mml:mo></mml:math><inline-graphic xlink:href="12859_2014_404_Article_IEq26.gif"/></alternatives></inline-formula> that satisfies <italic>i</italic><sup>′</sup>≤<italic>i</italic>≤<italic>j</italic><sup>′</sup>; <inline-formula id="IEq27"><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$\text {parent}_{\mathcal {S}}(ij\!\sim \!kl)$
\end{document}</tex-math><mml:math id="M64"><mml:msub><mml:mrow><mml:mtext>parent</mml:mtext></mml:mrow><mml:mrow><mml:mi mathvariant="script">S</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mtext mathvariant="italic">ij</mml:mtext><mml:mspace width="0.3em"/><mml:mo>∼</mml:mo><mml:mspace width="0.3em"/><mml:mtext mathvariant="italic">kl</mml:mtext><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2014_404_Article_IEq27.gif"/></alternatives></inline-formula> denotes the smallest base pair match that satisfies <italic>i</italic><sup>′</sup>&lt;<italic>i</italic>&lt;<italic>j</italic>&lt;<italic>j</italic><sup>′</sup>.</p>
        <p>We define additional joint probabilities to characterize the “interesting” EPMs.</p>
      </sec>
      <sec id="d30e3426">
        <title><bold>Definition</bold><bold>4</bold> (Joint probabilities).</title>
        <p>We define joint occurrence probabilities of elements in loops of structures in the Boltzmann ensemble of <italic>X</italic>, where <italic>X</italic> denotes either <italic>A</italic> or <italic>B</italic>. 
<list list-type="bullet"><list-item><p>Pr [<italic>k</italic> ∈ <italic>loop</italic>(<italic>i</italic>,<italic>j</italic>)|<italic>X</italic>] denotes for <italic>i</italic>&lt;<italic>k</italic>&lt;<italic>j</italic> the joint probability that a structure of <italic>X</italic> contains the base pair (<italic>i</italic>,<italic>j</italic>)<italic>and</italic> the unpaired base <italic>k</italic> such that (<italic>i</italic>,<italic>j</italic>) is the parent of <italic>k</italic>.</p></list-item><list-item><p>Pr [(<italic>i</italic><sup>′</sup>,<italic>j</italic><sup>′</sup>) ∈ <italic>loop</italic>(<italic>i</italic>,<italic>j</italic>)|<italic>X</italic>] denotes for <italic>i</italic>&lt;<italic>i</italic><sup>′</sup>&lt;<italic>j</italic><sup>′</sup>&lt;<italic>j</italic> the joint probability that a structure of <italic>X</italic> contains the base pairs (<italic>i</italic>,<italic>j</italic>)<italic>and</italic> (<italic>i</italic><sup>′</sup>,<italic>j</italic><sup>′</sup>) such that (<italic>i</italic>,<italic>j</italic>) is the parent of (<italic>i</italic><sup>′</sup>,<italic>j</italic><sup>′</sup>).</p></list-item></list></p>
        <p>For catchy notation, the expressions loop(<italic>i</italic>,<italic>j</italic>) in Def. 4 resemble loop<sub><italic>S</italic></sub>(<italic>i</italic>,<italic>j</italic>) – notationally omitting the structures <italic>S</italic> in the Boltzmann ensemble of <italic>A</italic> (analogously, <italic>B</italic>).</p>
        <p>We introduce an efficient algorithm to compute these probabilities in Section ‘<xref rid="Sec9" ref-type="sec">Precomputation: joint loop probabilities</xref>’. Since we want to match only structures that have high probability in the Boltzmann ensembles of the given sequences – as computed by McCaskill’s algorithm [<xref ref-type="bibr" rid="CR26">26</xref>] – we define the notion of significant EPMs. This constraint is crucial for both the quality of the results and the complexity of the algorithm. To define significance, we furthermore introduce three thresholds <italic>θ</italic><sub>1</sub>,<italic>θ</italic><sub>2</sub> and <italic>θ</italic><sub>3</sub>. We limit the probability of all matched base pairs by <italic>θ</italic><sub>1</sub>; furthermore, the joint probabilities of matched unpaired bases and base pairs, occurring as part of their enclosing loop, by <italic>θ</italic><sub>2</sub> and <italic>θ</italic><sub>3</sub>, respectively.</p>
      </sec>
      <sec id="d30e3651">
        <title><bold>Definition</bold><bold>5</bold> (Significant EPMs).</title>
        <p>Given thresholds <italic>θ</italic><sub>1</sub>,<italic>θ</italic><sub>2</sub>, and <italic>θ</italic><sub>3</sub>, an EPM is <italic>significant</italic> iff 
<list list-type="bullet"><list-item><p>for all <inline-formula id="IEq28"><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$ij\sim kl \in \mathcal {S}$
\end{document}</tex-math><mml:math id="M66"><mml:mtext mathvariant="italic">ij</mml:mtext><mml:mo>∼</mml:mo><mml:mtext mathvariant="italic">kl</mml:mtext><mml:mo>∈</mml:mo><mml:mi mathvariant="script">S</mml:mi></mml:math><inline-graphic xlink:href="12859_2014_404_Article_IEq28.gif"/></alternatives></inline-formula>:</p><p>Pr[(<italic>i</italic>,<italic>j</italic>)|<italic>A</italic>]≥<italic>θ</italic><sub>1</sub> and Pr[(<italic>k</italic>,<italic>l</italic>)|<italic>B</italic>]≥<italic>θ</italic><sub>1</sub></p></list-item><list-item><p>for all <inline-formula id="IEq29"><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$i \sim k \in \mathcal {M} \setminus \mathcal {M}\vert _{\mathcal {S}}$
\end{document}</tex-math><mml:math id="M68"><mml:mi>i</mml:mi><mml:mo>∼</mml:mo><mml:mi>k</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="script">ℳ</mml:mi><mml:mo>∖</mml:mo><mml:mi mathvariant="script">ℳ</mml:mi><mml:msub><mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="script">S</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2014_404_Article_IEq29.gif"/></alternatives></inline-formula>:</p><p>Pr[<italic>i</italic>∈loop(<italic>i</italic><sup>′</sup>,<italic>j</italic><sup>′</sup>)|<italic>A</italic>]≥<italic>θ</italic><sub>2</sub></p><p>and Pr[<italic>k</italic>∈loop(<italic>k</italic><sup>′</sup>,<italic>l</italic><sup>′</sup>)|<italic>B</italic>]≥<italic>θ</italic><sub>2</sub>,</p><p>where <inline-formula id="IEq30"><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$i'j' \sim k'l'=\text {parent}_{\mathcal {S}}(i \sim k) \neq \psi $
\end{document}</tex-math><mml:math id="M70"><mml:msup><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>∼</mml:mo><mml:msup><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mtext>parent</mml:mtext></mml:mrow><mml:mrow><mml:mi mathvariant="script">S</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>∼</mml:mo><mml:mi>k</mml:mi><mml:mo>)</mml:mo><mml:mo>≠</mml:mo><mml:mi>ψ</mml:mi></mml:math><inline-graphic xlink:href="12859_2014_404_Article_IEq30.gif"/></alternatives></inline-formula></p></list-item><list-item><p>for all <inline-formula id="IEq31"><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$ij \sim kl \in \mathcal {S}$
\end{document}</tex-math><mml:math id="M72"><mml:mtext mathvariant="italic">ij</mml:mtext><mml:mo>∼</mml:mo><mml:mtext mathvariant="italic">kl</mml:mtext><mml:mo>∈</mml:mo><mml:mi mathvariant="script">S</mml:mi></mml:math><inline-graphic xlink:href="12859_2014_404_Article_IEq31.gif"/></alternatives></inline-formula>:</p><p>Pr[(<italic>i</italic>,<italic>j</italic>)∈loop(<italic>i</italic><sup>′</sup>,<italic>j</italic><sup>′</sup>)|<italic>A</italic>]≥<italic>θ</italic><sub>3</sub></p><p>and Pr[(<italic>k</italic>,<italic>l</italic>)∈loop(<italic>k</italic><sup>′</sup>,<italic>l</italic><sup>′</sup>)|<italic>B</italic>]≥<italic>θ</italic><sub>3</sub>,</p><p>where <inline-formula id="IEq32"><alternatives><tex-math id="M73">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$i'j' \sim k'l'=\text {parent}_{\mathcal {S}}(ij \sim kl) \neq \psi $
\end{document}</tex-math><mml:math id="M74"><mml:msup><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>∼</mml:mo><mml:msup><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mtext>parent</mml:mtext></mml:mrow><mml:mrow><mml:mi mathvariant="script">S</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mtext mathvariant="italic">ij</mml:mtext><mml:mo>∼</mml:mo><mml:mtext mathvariant="italic">kl</mml:mtext><mml:mo>)</mml:mo><mml:mo>≠</mml:mo><mml:mi>ψ</mml:mi></mml:math><inline-graphic xlink:href="12859_2014_404_Article_IEq32.gif"/></alternatives></inline-formula></p></list-item></list></p>
        <p>We reduce the return set of our algorithm further by reporting only EPMs that are not included in better (reported) EPMs and that do not include better EPMs. The second condition is relevant only for relaxed EPMs, since this cannot occur for strict EPMs. In the case of strict EPMs, those EPMs are simply <italic>maximal</italic> w.r.t. the following inclusion order <inline-formula id="IEq33"><alternatives><tex-math id="M75">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$\sqsubseteq $
\end{document}</tex-math><mml:math id="M76"><mml:mo>⊑</mml:mo></mml:math><inline-graphic xlink:href="12859_2014_404_Article_IEq33.gif"/></alternatives></inline-formula> of pattern matchings. Hence, we call them <italic>maximal strict EPMs</italic>.</p>
      </sec>
      <sec id="d30e4028">
        <title><bold>Definition</bold><bold>6</bold> (Inclusion Order on EPMs).</title>
        <p>Let <inline-formula id="IEq34"><alternatives><tex-math id="M77">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$\mathcal {P} = (\mathcal {M},\mathcal {S})$
\end{document}</tex-math><mml:math id="M78"><mml:mi mathvariant="script">P</mml:mi><mml:mo>=</mml:mo><mml:mo>(</mml:mo><mml:mi mathvariant="script">ℳ</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2014_404_Article_IEq34.gif"/></alternatives></inline-formula> and <inline-formula id="IEq35"><alternatives><tex-math id="M79">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$\mathcal {P}' = \left (\mathcal {M}'\hspace *{.01pt},\mathcal {S}'\right)$
\end{document}</tex-math><mml:math id="M80"><mml:msup><mml:mrow><mml:mi mathvariant="script">P</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">ℳ</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mspace width="0.01pt"/><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="script">S</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2014_404_Article_IEq35.gif"/></alternatives></inline-formula> be EPMs. <inline-graphic xlink:href="12859_2014_404_Figa_HTML.gif" id="d30e4096"/> is included in <inline-formula id="IEq36"><alternatives><tex-math id="M81">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$\mathcal {P}'$
\end{document}</tex-math><mml:math id="M82"><mml:msup><mml:mrow><mml:mi mathvariant="script">P</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="12859_2014_404_Article_IEq36.gif"/></alternatives></inline-formula>, written <inline-formula id="IEq37"><alternatives><tex-math id="M83">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$\mathcal {P}\sqsubseteq \mathcal {P}'$
\end{document}</tex-math><mml:math id="M84"><mml:mi mathvariant="script">P</mml:mi><mml:mo>⊑</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="script">P</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="12859_2014_404_Article_IEq37.gif"/></alternatives></inline-formula> iff 
<list list-type="bullet"><list-item><p><inline-formula id="IEq38"><alternatives><tex-math id="M85">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$\mathcal {M} \subseteq \mathcal {M}'$
\end{document}</tex-math><mml:math id="M86"><mml:mi mathvariant="script">ℳ</mml:mi><mml:mo>⊆</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="script">ℳ</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="12859_2014_404_Article_IEq38.gif"/></alternatives></inline-formula></p></list-item><list-item><p>for all <inline-formula id="IEq39"><alternatives><tex-math id="M87">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$i\!\sim \!k\in \mathcal {M}$
\end{document}</tex-math><mml:math id="M88"><mml:mi>i</mml:mi><mml:mspace width="0.3em"/><mml:mo>∼</mml:mo><mml:mspace width="0.3em"/><mml:mi>k</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="script">ℳ</mml:mi></mml:math><inline-graphic xlink:href="12859_2014_404_Article_IEq39.gif"/></alternatives></inline-formula>:</p><p><inline-formula id="IEq40"><alternatives><tex-math id="M89">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$\text {parent}_{\mathcal {S}}(i\!\sim \!k)=\text {parent}_{\mathcal {S}'}(i\!\sim \!k)$
\end{document}</tex-math><mml:math id="M90"><mml:msub><mml:mrow><mml:mtext>parent</mml:mtext></mml:mrow><mml:mrow><mml:mi mathvariant="script">S</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mspace width="0.3em"/><mml:mo>∼</mml:mo><mml:mspace width="0.3em"/><mml:mi>k</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mtext>parent</mml:mtext></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">S</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mspace width="0.3em"/><mml:mo>∼</mml:mo><mml:mspace width="0.3em"/><mml:mi>k</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2014_404_Article_IEq40.gif"/></alternatives></inline-formula></p></list-item></list></p>
        <p>Notably, in the inclusion order of Def. 6, EPMs with different structures are not comparable. Consequently, two EPMs that match the same positions can be both maximal, if they match different structure. This is illustrated in Figure <xref rid="Fig3" ref-type="fig">3</xref> (A-C).
<fig id="Fig3"><label>Figure 3</label><caption><p><bold>Visualization of maximal EPMs.</bold> Matches of green bases refer to exact matches and red ones to inexact (structure) matches. <bold>(A-C)</bold> EPM A is not maximal since there exists a larger (strict) EPM <bold>(B or C)</bold>. EPMs <bold>B</bold> and <bold>C</bold> can be maximal simultaneously since in each case some base matches have different parents. <bold>(A and D-F)</bold> EPM D is generated from A by appending an inexact structure match and has a lower score than A. Further extending the EPM leads to higher scores again <bold>(E and F)</bold>. <bold>D</bold> is not maximal since A has the same parents and a higher score. <bold>A</bold> is not maximal because there exist (relaxed) EPMs <bold>E</bold> and <bold>F</bold> with the same parents and higher scores. Among <bold>A</bold>, <bold>D</bold>, <bold>E</bold>, and <bold>F</bold>, only <bold>F</bold> is maximal.</p></caption><graphic xlink:href="12859_2014_404_Fig3_HTML" id="MO3"/></fig></p>
        <p>In the case of strict EPMs, the highest scoring EPMs are always maximal EPMs w.r.t. the inclusion order, which allows us to select the “interesting” EPMs by this simple property. However, the same does not hold for relaxed EPMs: for example, typically the score of a relaxed EPM decreases if it is extended by a structure match with mismatching nucleotides; still, further extensions can increase the total score again. These dependencies are illustrated in Figure <xref rid="Fig3" ref-type="fig">3</xref> (A and D-F).</p>
        <p>Consequently, since we want to keep the highest scoring EPMs in the case of relaxed EPMs as well, we define a score-extended partial order.</p>
      </sec>
      <sec id="d30e4303">
        <title><bold>Definition</bold><bold>7</bold> (Score Inclusion Order).</title>
        <p>Let <inline-formula id="IEq41"><alternatives><tex-math id="M91">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$\mathcal {P} = (\mathcal {M},\mathcal {S})$
\end{document}</tex-math><mml:math id="M92"><mml:mi mathvariant="script">P</mml:mi><mml:mo>=</mml:mo><mml:mo>(</mml:mo><mml:mi mathvariant="script">ℳ</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2014_404_Article_IEq41.gif"/></alternatives></inline-formula> and <inline-formula id="IEq42"><alternatives><tex-math id="M93">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$\mathcal {P}' = (\mathcal {M}',\mathcal {S}')$
\end{document}</tex-math><mml:math id="M94"><mml:msup><mml:mrow><mml:mi mathvariant="script">P</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mo>(</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="script">ℳ</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="script">S</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2014_404_Article_IEq42.gif"/></alternatives></inline-formula> be EPMs. <inline-graphic xlink:href="12859_2014_404_Figa_HTML.gif" id="d30e4372"/> is smaller than <inline-formula id="IEq43"><alternatives><tex-math id="M95">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$\mathcal {P}'$
\end{document}</tex-math><mml:math id="M96"><mml:msup><mml:mrow><mml:mi mathvariant="script">P</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="12859_2014_404_Article_IEq43.gif"/></alternatives></inline-formula> in the score inclusion order, iff <inline-formula id="IEq44"><alternatives><tex-math id="M97">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$\text {score}(\mathcal {P}) &lt; \text {score}(\mathcal {P}')$
\end{document}</tex-math><mml:math id="M98"><mml:mtext>score</mml:mtext><mml:mo>(</mml:mo><mml:mi mathvariant="script">P</mml:mi><mml:mo>)</mml:mo><mml:mo>&lt;</mml:mo><mml:mtext>score</mml:mtext><mml:mo>(</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="script">P</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2014_404_Article_IEq44.gif"/></alternatives></inline-formula> and (<inline-formula id="IEq45"><alternatives><tex-math id="M99">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$\mathcal {P} \sqsubseteq \mathcal {P}'$
\end{document}</tex-math><mml:math id="M100"><mml:mi mathvariant="script">P</mml:mi><mml:mo>⊑</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="script">P</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="12859_2014_404_Article_IEq45.gif"/></alternatives></inline-formula> or <inline-formula id="IEq46"><alternatives><tex-math id="M101">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$\mathcal {P}' \sqsubseteq \mathcal {P}$
\end{document}</tex-math><mml:math id="M102"><mml:msup><mml:mrow><mml:mi mathvariant="script">P</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>⊑</mml:mo><mml:mi mathvariant="script">P</mml:mi></mml:math><inline-graphic xlink:href="12859_2014_404_Article_IEq46.gif"/></alternatives></inline-formula>).</p>
        <p>We call a relaxed EPM <italic>maximal</italic>, iff it is maximal w.r.t. this order among all relaxed EPMs. In other words, a relaxed EPM is maximal if and only if there is no second relaxed EPM with a higher score that is, by inclusion order, (a) smaller or (b) larger in the relaxed EPM (see Figure <xref rid="Fig3" ref-type="fig">3</xref> (A and D-F)). Note that different patterns with the same score are not comparable so that they cannot rule out each other.</p>
        <p>Both maximality definitions are canonically raised to <italic>maximal significant</italic> strict EPMs and relaxed EPMs.</p>
      </sec>
    </sec>
    <sec id="Sec9">
      <title>Precomputation: joint loop probabilities</title>
      <p>Fundamentally, our novel sparsification technique relies on the joint probabilities of Def. 4. For sequences <italic>X</italic>∈{<italic>A</italic>,<italic>B</italic>}, one efficiently computes base pair probabilities Pr[(<italic>i</italic>,<italic>j</italic>)|<italic>X</italic>] by McCaskill’s algorithm [<xref ref-type="bibr" rid="CR26">26</xref>]. In this work, we extend this algorithm to compute the probabilities Pr[<italic>k</italic> ∈ loop(<italic>i</italic>,<italic>j</italic>)|<italic>X</italic>] and Pr[(<italic>i</italic><sup>′</sup>,<italic>j</italic><sup>′</sup>) ∈ loop(<italic>i</italic>,<italic>j</italic>)|<italic>X</italic>] for <italic>X</italic>∈{<italic>A</italic>,<italic>B</italic>}. For this purpose, we introduce – on top of the McCaskill matrices – the auxiliary matrix <inline-formula id="IEq47"><alternatives><tex-math id="M103">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$Q_{\textit {ij}}^{m2}$
\end{document}</tex-math><mml:math id="M104"><mml:msubsup><mml:mrow><mml:mi>Q</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2014_404_Article_IEq47.gif"/></alternatives></inline-formula>, which represents parts of a multiloop with at least two outermost base pairs. This enables computing the additional joint probabilities efficiently in the complexity bounds of the McCaskill algorithm (Additional file <xref rid="MOESM1" ref-type="media">1</xref>).</p>
      <p>Importantly, all these probabilities are efficiently precomputed independently for each sequence. Hence, e.g. in clustering scenarios, where all pairs from a set of sequences need to be matched, this preprocessing needs to be done only once for each sequence and not for all quadratically many pairs.</p>
    </sec>
    <sec id="Sec10">
      <title>ExpaRNA-P: Optimizing over significant EPMs</title>
      <p>Figure <xref rid="Fig4" ref-type="fig">4</xref> provides formal recursion equations of the dynamic programming EPM optimization algorithm; the same recursions are presented graphically in Figure <xref rid="Fig5" ref-type="fig">5</xref>.
<fig id="Fig4"><label>Figure 4</label><caption><p><bold>Recursion equations.</bold> Recursions for computing the significant strict EPMs and relaxed EPMs, respectively. These equations are visualized in Figure <xref rid="Fig5" ref-type="fig">5</xref>.</p></caption><graphic xlink:href="12859_2014_404_Fig4_HTML" id="MO5"/></fig><fig id="Fig5"><label>Figure 5</label><caption><p><bold>Recursion visualization.</bold> Visualization of the recursions to compute the matrix entries <inline-formula id="IEq48"><alternatives><tex-math id="M105">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$L^{ijkl}(j',l'), G_{\!\text {A}}^{ijkl}(j',l'), G_{\!\text {AB}}^{ijkl}(j',l'), LR^{ijkl}(j',l'), D(ij,kl), F(j',l')$
\end{document}</tex-math><mml:math id="M106"><mml:msup><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ijkl</mml:mtext></mml:mrow></mml:msup><mml:mo>(</mml:mo><mml:msup><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>)</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mspace width="0.3em"/><mml:mtext>A</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ijkl</mml:mtext></mml:mrow></mml:msubsup><mml:mo>(</mml:mo><mml:msup><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>)</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mspace width="0.3em"/><mml:mtext>AB</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ijkl</mml:mtext></mml:mrow></mml:msubsup><mml:mo>(</mml:mo><mml:msup><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>)</mml:mo><mml:mo>,</mml:mo><mml:mi>L</mml:mi><mml:msup><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ijkl</mml:mtext></mml:mrow></mml:msup><mml:mo>(</mml:mo><mml:msup><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>)</mml:mo><mml:mo>,</mml:mo><mml:mi>D</mml:mi><mml:mo>(</mml:mo><mml:mtext mathvariant="italic">ij</mml:mtext><mml:mo>,</mml:mo><mml:mtext mathvariant="italic">kl</mml:mtext><mml:mo>)</mml:mo><mml:mo>,</mml:mo><mml:mi>F</mml:mi><mml:mo>(</mml:mo><mml:msup><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2014_404_Article_IEq48.gif"/></alternatives></inline-formula> and the auxiliary matrix <italic>H</italic>
<sup><italic>i</italic><italic>j</italic><italic>k</italic><italic>l</italic></sup>(<italic>j</italic>
<sup>′</sup>,<italic>l</italic>
<sup>′</sup>).</p></caption><graphic xlink:href="12859_2014_404_Fig5_HTML" id="MO4"/></fig></p>
      <p>Fundamental to our approach, all matrices and evaluations in the recursions are sparse, i.e. only entries and cases are considered where the probabilities of elements pass the respective probability thresholds (cf. Def. 5). Corresponding constraints are given in the recursion equations – this is also illustrated in Figure <xref rid="Fig5" ref-type="fig">5</xref>, using arrows. Otherwise, we can largely postpone this aspect until Section ‘<xref rid="Sec12" ref-type="sec">ExpaRNA-P: Sparsification</xref>’.</p>
      <p>The matrix entries <italic>D</italic>(<italic>i</italic><italic>j</italic>,<italic>k</italic><italic>l</italic>) score the best EPM enclosed by each base pair match <italic>i</italic><italic>j</italic> ∼ <italic>k</italic><italic>l</italic>, i.e. <italic>D</italic>(<italic>i</italic><italic>j</italic>,<italic>k</italic><italic>l</italic>) denotes the best score of a significant EPM <inline-formula id="IEq49"><alternatives><tex-math id="M107">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$(\mathcal {M},\mathcal {S})$
\end{document}</tex-math><mml:math id="M108"><mml:mo>(</mml:mo><mml:mi mathvariant="script">ℳ</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2014_404_Article_IEq49.gif"/></alternatives></inline-formula> of <italic>A</italic><sub><italic>i</italic>..<italic>j</italic></sub> and <italic>B</italic><sub><italic>k</italic>..<italic>l</italic></sub> with <inline-formula id="IEq50"><alternatives><tex-math id="M109">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$ij\!\sim \!kl\in \mathcal {S}$
\end{document}</tex-math><mml:math id="M110"><mml:mtext mathvariant="italic">ij</mml:mtext><mml:mspace width="0.3em"/><mml:mo>∼</mml:mo><mml:mspace width="0.3em"/><mml:mtext mathvariant="italic">kl</mml:mtext><mml:mo>∈</mml:mo><mml:mi mathvariant="script">S</mml:mi></mml:math><inline-graphic xlink:href="12859_2014_404_Article_IEq50.gif"/></alternatives></inline-formula>.</p>
      <p>Inside of the base pair match <italic>i</italic><italic>j</italic> ∼ <italic>k</italic><italic>l</italic>, we determine the (score of the) best <inline-formula id="IEq51"><alternatives><tex-math id="M111">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$(\mathcal {M},\mathcal {S})$
\end{document}</tex-math><mml:math id="M112"><mml:mo>(</mml:mo><mml:mi mathvariant="script">ℳ</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2014_404_Article_IEq51.gif"/></alternatives></inline-formula> that is either a significant EPM itself <italic>or</italic> forms a (connected) significant EPM only together with the closing base pair match <italic>i</italic><italic>j</italic> ∼ <italic>k</italic><italic>l</italic>. The first case is covered by the single matrix <italic>L</italic>, whereas the latter case requires three matrices <italic>G</italic><sub>A</sub>, <italic>G</italic><sub>AB</sub>, and <italic>LR</italic>. By and large, for deriving one <italic>D</italic>-entry one starts matching from the left using <italic>L</italic>. Potentially, one introduces a gap using matrices <italic>G</italic><sub>A</sub> and <italic>G</italic><sub>AB</sub> and continues using matrix <italic>LR</italic> to match the part that is only connected to the right end of <italic>i</italic><italic>j</italic> ∼ <italic>k</italic><italic>l</italic>.</p>
      <p>In more detail, first we determine the best score of a significant EPM <inline-formula id="IEq52"><alternatives><tex-math id="M113">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$\mathcal {P}=(\mathcal {M},\mathcal {S})$
\end{document}</tex-math><mml:math id="M114"><mml:mi mathvariant="script">P</mml:mi><mml:mo>=</mml:mo><mml:mo>(</mml:mo><mml:mi mathvariant="script">ℳ</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2014_404_Article_IEq52.gif"/></alternatives></inline-formula> that is connected to the left end <italic>i</italic> ∼ <italic>k</italic> of the base pair match, i.e. <inline-graphic xlink:href="12859_2014_404_Figb_HTML.gif" id="d30e5033"/> is empty or contains <italic>i</italic>+1 ∼ <italic>k</italic>+1. Concretely, <italic>L</italic><sup><italic>i</italic><italic>j</italic><italic>k</italic><italic>l</italic></sup>(<italic>j</italic><sup>′</sup>,<italic>l</italic><sup>′</sup>) is such a score, where <inline-formula id="IEq53"><alternatives><tex-math id="M115">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$\mathcal {M}\subseteq [i+1..j']\times [\!k+1..l']$
\end{document}</tex-math><mml:math id="M116"><mml:mi mathvariant="script">ℳ</mml:mi><mml:mo>⊆</mml:mo><mml:mo>[</mml:mo><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mi>..</mml:mi><mml:msup><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>]</mml:mo><mml:mo>×</mml:mo><mml:mo>[</mml:mo><mml:mspace width="0.3em"/><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mi>..</mml:mi><mml:msup><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>]</mml:mo></mml:math><inline-graphic xlink:href="12859_2014_404_Article_IEq53.gif"/></alternatives></inline-formula> and <inline-formula id="IEq54"><alternatives><tex-math id="M117">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$j'\!\sim \!l'\in \mathcal {M}$
\end{document}</tex-math><mml:math id="M118"><mml:msup><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mspace width="0.3em"/><mml:mo>∼</mml:mo><mml:mspace width="0.3em"/><mml:msup><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>∈</mml:mo><mml:mi mathvariant="script">ℳ</mml:mi></mml:math><inline-graphic xlink:href="12859_2014_404_Article_IEq54.gif"/></alternatives></inline-formula>. To introduce a gap, the latter condition is changed for <italic>G</italic><sub>A</sub> and <italic>G</italic><sub>AB</sub>. In the case of <inline-formula id="IEq55"><alternatives><tex-math id="M119">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$G_{\!\text {A}}^{ijkl}(j',l'), \mathcal {M}$
\end{document}</tex-math><mml:math id="M120"><mml:msubsup><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mspace width="0.3em"/><mml:mtext>A</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ijkl</mml:mtext></mml:mrow></mml:msubsup><mml:mo>(</mml:mo><mml:msup><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>)</mml:mo><mml:mo>,</mml:mo><mml:mi mathvariant="script">ℳ</mml:mi></mml:math><inline-graphic xlink:href="12859_2014_404_Article_IEq55.gif"/></alternatives></inline-formula> does not match <italic>j</italic><sup>′</sup> but matches <italic>l</italic><sup>′</sup>; for <inline-formula id="IEq56"><alternatives><tex-math id="M121">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$G_{\!\text {AB}}^{ijkl}(j',l'), \mathcal {M}$
\end{document}</tex-math><mml:math id="M122"><mml:msubsup><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mspace width="0.3em"/><mml:mtext>AB</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ijkl</mml:mtext></mml:mrow></mml:msubsup><mml:mo>(</mml:mo><mml:msup><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>)</mml:mo><mml:mo>,</mml:mo><mml:mi mathvariant="script">ℳ</mml:mi></mml:math><inline-graphic xlink:href="12859_2014_404_Article_IEq56.gif"/></alternatives></inline-formula> does not match <italic>l</italic><sup>′</sup> and potentially does not match <italic>j</italic><sup>′</sup>. Finally, <italic>L</italic><italic>R</italic><sup><italic>i</italic><italic>j</italic><italic>k</italic><italic>l</italic></sup>(<italic>j</italic><sup>′</sup>,<italic>l</italic><sup>′</sup>) is the best sum of scores of two significant EPMs <inline-formula id="IEq57"><alternatives><tex-math id="M123">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$\mathcal {P}_{1}=(\mathcal {M}_{1},\mathcal {S}_{1})$
\end{document}</tex-math><mml:math id="M124"><mml:msub><mml:mrow><mml:mi mathvariant="script">P</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script">ℳ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script">S</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2014_404_Article_IEq57.gif"/></alternatives></inline-formula> and <inline-formula id="IEq58"><alternatives><tex-math id="M125">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$\mathcal {P}_{2}=(\mathcal {M}_{2},\mathcal {S}_{2})$
\end{document}</tex-math><mml:math id="M126"><mml:msub><mml:mrow><mml:mi mathvariant="script">P</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script">ℳ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script">S</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2014_404_Article_IEq58.gif"/></alternatives></inline-formula> where the first is connected to the left base pair match end <italic>i</italic> ∼ <italic>k</italic> and the second contains <italic>j</italic><sup>′</sup> ∼ <italic>l</italic><sup>′</sup>. Intuitively, the two EPMs are separated by a gap; formally: (for all <inline-formula id="IEq59"><alternatives><tex-math id="M127">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$i_{1}\!\sim \!k_{1}\in \mathcal {M}_{1}$
\end{document}</tex-math><mml:math id="M128"><mml:msub><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mspace width="0.3em"/><mml:mo>∼</mml:mo><mml:mspace width="0.3em"/><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script">ℳ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2014_404_Article_IEq59.gif"/></alternatives></inline-formula> and <inline-formula id="IEq60"><alternatives><tex-math id="M129">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$i_{2}\!\sim \!k_{2}\in \mathcal {M}_{2}, i_{1}&lt;i_{2}-1$
\end{document}</tex-math><mml:math id="M130"><mml:msub><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mspace width="0.3em"/><mml:mo>∼</mml:mo><mml:mspace width="0.3em"/><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script">ℳ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:msub><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:math><inline-graphic xlink:href="12859_2014_404_Article_IEq60.gif"/></alternatives></inline-formula> and <italic>k</italic><sub>1</sub>&lt;<italic>k</italic><sub>2</sub>) or (for all <inline-formula id="IEq61"><alternatives><tex-math id="M131">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$i_{1}\!\sim \!k_{1}\in \mathcal {M}_{1}$
\end{document}</tex-math><mml:math id="M132"><mml:msub><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mspace width="0.3em"/><mml:mo>∼</mml:mo><mml:mspace width="0.3em"/><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script">ℳ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2014_404_Article_IEq61.gif"/></alternatives></inline-formula> and <inline-formula id="IEq62"><alternatives><tex-math id="M133">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$i_{2}\!\sim \!k_{2}\in \mathcal {M}_{2}, i_{1}&lt;i_{2}$
\end{document}</tex-math><mml:math id="M134"><mml:msub><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mspace width="0.3em"/><mml:mo>∼</mml:mo><mml:mspace width="0.3em"/><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script">ℳ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:msub><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2014_404_Article_IEq62.gif"/></alternatives></inline-formula> and <italic>k</italic><sub>1</sub>&lt;<italic>k</italic><sub>2</sub>−1).</p>
      <p>Our recursion equations (Figure <xref rid="Fig4" ref-type="fig">4</xref> and Figure <xref rid="Fig5" ref-type="fig">5</xref>) show the precise case distinctions and dependencies. In <italic>L</italic>, we check whether there is a sequence match (second case) or a structure match (third case); otherwise, we assign −<italic>∞</italic> (first case). <italic>LR</italic> is analogous to <italic>L</italic>, only allowing to close a gap left of the structure or sequence match. For this purpose, we introduce an auxiliary matrix <italic>H</italic>, which does not need to be stored. The gap itself, computed in <italic>G</italic><sub>A</sub> and <italic>G</italic><sub>AB</sub>, allows skipping an arbitrary number of positions in both sequences. The recursion structure ensures that such a gap is introduced at most once per loop match and sequence. To avoid ambiguity, the recursion enforces to first skip positions in <italic>A</italic> (using <italic>G</italic><sub>A</sub>) and after that positions in <italic>B</italic> (using <italic>G</italic><sub>AB</sub>); furthermore we enforce a gap in the matchings computed via <italic>LR</italic> by its initialization.</p>
      <p>We compute entries of <italic>D</italic> in increasing order with respect to their size so that when computing some <italic>D</italic>(<italic>i</italic><italic>j</italic>,<italic>k</italic><italic>l</italic>), any <italic>D</italic>(<italic>i</italic><sup>′</sup><italic>j</italic><sup>′</sup>,<italic>k</italic><sup>′</sup><italic>l</italic><sup>′</sup>) with <italic>i</italic>&lt;<italic>i</italic><sup>′</sup>&lt;<italic>j</italic><sup>′</sup>&lt;<italic>j</italic> and <italic>k</italic>&lt;<italic>k</italic><sup>′</sup>&lt;<italic>l</italic><sup>′</sup>&lt;<italic>l</italic> is already computed.</p>
      <p>Since EPMs are not necessarily closed by a base pair match (like the EPMs of <italic>D</italic>), we finally compute the matrix <italic>F</italic>. The entries <italic>F</italic>(<italic>j</italic><sup>′</sup>,<italic>l</italic><sup>′</sup>), for 0≤<italic>j</italic><sup>′</sup>≤<italic>n</italic> and 0≤<italic>l</italic><sup>′</sup>≤<italic>m</italic>, denote the maximum score of a significant EPM of <inline-formula id="IEq63"><alternatives><tex-math id="M135">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
${A}_{1..j^{\prime }}\phantom {\dot {i}\!}$
\end{document}</tex-math><mml:math id="M136"><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mi>..</mml:mi><mml:msup><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2014_404_Article_IEq63.gif"/></alternatives></inline-formula> and <inline-formula id="IEq64"><alternatives><tex-math id="M137">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
${B}_{1..l^{\prime }}\phantom {\dot {i}\!}$
\end{document}</tex-math><mml:math id="M138"><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mi>..</mml:mi><mml:msup><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2014_404_Article_IEq64.gif"/></alternatives></inline-formula>, which ends at (<italic>j</italic><sup>′</sup>,<italic>l</italic><sup>′</sup>), i.e. with <inline-formula id="IEq65"><alternatives><tex-math id="M139">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$j'\!\sim \!l'\in \mathcal {M}$
\end{document}</tex-math><mml:math id="M140"><mml:msup><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mspace width="0.3em"/><mml:mo>∼</mml:mo><mml:mspace width="0.3em"/><mml:msup><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>∈</mml:mo><mml:mi mathvariant="script">ℳ</mml:mi></mml:math><inline-graphic xlink:href="12859_2014_404_Article_IEq65.gif"/></alternatives></inline-formula>. The recursion for <italic>F</italic> is almost identical to the recursion for <italic>L</italic>, except for the first case, which is 0 instead of −<italic>∞</italic>, since the EPMs in <italic>F</italic> can start at any point (similar to local sequence alignments). Also, since the matched base pairs in EPMs of <italic>F</italic> are external (i.e. they are not enclosed by some other base pair of the EPM), we do not perform checks for the second and third condition of significant EPMs (Def. 5).</p>
      <p><bold>Matrix initialization</bold> Matrix entries corresponding to matches of empty subsequences are initialized. Here, we take special care to disallow such matches for certain matrices (by assigning −<italic>∞</italic>). 
<list list-type="bullet"><list-item><p><inline-formula id="IEq66"><alternatives><tex-math id="M141">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$L^{ijkl}(i,k)=G_{\!\text {A}}^{ijkl}(i,k)=G_{\!\text {AB}}^{ijkl}(i,k)=0$
\end{document}</tex-math><mml:math id="M142"><mml:msup><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ijkl</mml:mtext></mml:mrow></mml:msup><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mspace width="0.3em"/><mml:mtext>A</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ijkl</mml:mtext></mml:mrow></mml:msubsup><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mspace width="0.3em"/><mml:mtext>AB</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ijkl</mml:mtext></mml:mrow></mml:msubsup><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:math><inline-graphic xlink:href="12859_2014_404_Article_IEq66.gif"/></alternatives></inline-formula> and <italic>L</italic><italic>R</italic><sup><italic>i</italic><italic>j</italic><italic>k</italic><italic>l</italic></sup>(<italic>i</italic>,<italic>k</italic>)=−<italic>∞</italic> (first matrix entry)</p></list-item><list-item><p><inline-formula id="IEq67"><alternatives><tex-math id="M143">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$L^{ijkl}(i,l')=G_{\!\text {A}}^{ijkl}(i,l')=LR^{ijkl}(i,l')=-\infty $
\end{document}</tex-math><mml:math id="M144"><mml:msup><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ijkl</mml:mtext></mml:mrow></mml:msup><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mspace width="0.3em"/><mml:mtext>A</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ijkl</mml:mtext></mml:mrow></mml:msubsup><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mi>L</mml:mi><mml:msup><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ijkl</mml:mtext></mml:mrow></mml:msup><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mi>∞</mml:mi></mml:math><inline-graphic xlink:href="12859_2014_404_Article_IEq67.gif"/></alternatives></inline-formula> and <inline-formula id="IEq68"><alternatives><tex-math id="M145">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$G_{\!\text {AB}}^{ijkl}(i,l')=0$
\end{document}</tex-math><mml:math id="M146"><mml:msubsup><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mspace width="0.3em"/><mml:mtext>AB</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ijkl</mml:mtext></mml:mrow></mml:msubsup><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:math><inline-graphic xlink:href="12859_2014_404_Article_IEq68.gif"/></alternatives></inline-formula> for all <italic>l</italic><sup>′</sup>&gt;<italic>k</italic> (first matrix row)</p></list-item><list-item><p><inline-formula id="IEq69"><alternatives><tex-math id="M147">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$L^{ijkl}(j',k)=G_{\!\text {AB}}^{ijkl}(j',k)=LR^{ijkl}(j',k)=-\infty $
\end{document}</tex-math><mml:math id="M148"><mml:msup><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ijkl</mml:mtext></mml:mrow></mml:msup><mml:mo>(</mml:mo><mml:msup><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mspace width="0.3em"/><mml:mtext>AB</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ijkl</mml:mtext></mml:mrow></mml:msubsup><mml:mo>(</mml:mo><mml:msup><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mi>L</mml:mi><mml:msup><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ijkl</mml:mtext></mml:mrow></mml:msup><mml:mo>(</mml:mo><mml:msup><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mi>∞</mml:mi></mml:math><inline-graphic xlink:href="12859_2014_404_Article_IEq69.gif"/></alternatives></inline-formula> and <inline-formula id="IEq70"><alternatives><tex-math id="M149">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$G_{\!\text {A}}^{ijkl}(j',k)=0$
\end{document}</tex-math><mml:math id="M150"><mml:msubsup><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mspace width="0.3em"/><mml:mtext>A</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ijkl</mml:mtext></mml:mrow></mml:msubsup><mml:mo>(</mml:mo><mml:msup><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:math><inline-graphic xlink:href="12859_2014_404_Article_IEq70.gif"/></alternatives></inline-formula> for all <italic>j</italic><sup>′</sup>&gt;<italic>i</italic> (first matrix column)</p></list-item></list></p>
      <p>By initializing the <italic>LR</italic> matrix with −<italic>∞</italic>, we keep matchings represented by <italic>LR</italic> and <italic>L</italic> distinct (because in this way, finite <italic>LR</italic> entries have to be derived via <italic>G</italic><sub>A</sub> or <italic>G</italic><sub>AB</sub> entries, which enforces a gap).</p>
      <p>The final matrix <italic>F</italic> is initialized by <italic>F</italic>(<italic>j</italic><sup>′</sup>,0)=<italic>F</italic>(0,<italic>l</italic><sup>′</sup>)=0 for all <italic>j</italic><sup>′</sup>,<italic>l</italic><sup>′</sup>.</p>
    </sec>
    <sec id="Sec11">
      <title>ExpaRNA-P: suboptimal traceback &amp; enumerating maximal EPMs</title>
      <p>For enumerating only maximal EPMs during suboptimal traceback, we take special care that EPMs cannot be extended at the left or right end of gaps (<italic>G</italic><sub>A</sub> and <italic>G</italic><sub>AB</sub> matrices.) For strict EPMs this is decided independently of the other traced strict EPMs. It suffices to check whether the strict EPM can be extended into the gap matrices, i.e. whether a sequence or structure match is possible at the borders of the gap matrices.</p>
      <p>However, the same does not work for relaxed EPMs, since while extending a relaxed EPM, the score might first decrease and then increase again (Figure <xref rid="Fig3" ref-type="fig">3</xref>). Therefore, we filter relaxed EPMs in two steps. First, we discard EPMs due to the same criterion as in the case of strict EPMs, checking for <italic>exact</italic> sequence or structure matches at the borders of the gap matrices. If an EPM cannot be discarded in this way, it is stored until all relaxed EPMs in the same D matrix are traced back. Only then, we compare the withheld relaxed EPMs of the same D matrix according to Def. 7.</p>
      <p>Since we complete the whole traceback for a D matrix before tracing into its “enclosed” D matrices, we identify and remove all non-maximal relaxed EPMs in an early stage of the traceback.</p>
      <p>To enumerate all maximal EPMs, we start such tracebacks only from entries <italic>F</italic>(<italic>j</italic><sup>′</sup>,<italic>l</italic><sup>′</sup>) that satisfy <inline-formula id="IEq71"><alternatives><tex-math id="M151">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$A_{j^{\prime }+1} \neq B_{l^{\prime }+1}\phantom {\dot {i}\!}$
\end{document}</tex-math><mml:math id="M152"><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>≠</mml:mo><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2014_404_Article_IEq71.gif"/></alternatives></inline-formula>. Due to Lemma 1, this condition is necessary and sufficient for strict EPMs.</p>
      <sec id="d30e6391">
        <title><bold>Lemma</bold><bold>1</bold>.</title>
        <p>Let <inline-formula id="IEq72"><alternatives><tex-math id="M153">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$\mathcal {P}=(\mathcal {M},\mathcal {S})$
\end{document}</tex-math><mml:math id="M154"><mml:mi mathvariant="script">P</mml:mi><mml:mo>=</mml:mo><mml:mo>(</mml:mo><mml:mi mathvariant="script">ℳ</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2014_404_Article_IEq72.gif"/></alternatives></inline-formula> be a maximal strict EPM of <inline-formula id="IEq73"><alternatives><tex-math id="M155">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
${A}_{1..j^{\prime }}\phantom {\dot {i}\!}$
\end{document}</tex-math><mml:math id="M156"><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mi>..</mml:mi><mml:msup><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2014_404_Article_IEq73.gif"/></alternatives></inline-formula> and <inline-formula id="IEq74"><alternatives><tex-math id="M157">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
${B}_{1..l^{\prime }}\phantom {\dot {i}\!}$
\end{document}</tex-math><mml:math id="M158"><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mi>..</mml:mi><mml:msup><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2014_404_Article_IEq74.gif"/></alternatives></inline-formula> with <inline-formula id="IEq75"><alternatives><tex-math id="M159">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$j'\!\sim \!l'\in {\mathcal M}$
\end{document}</tex-math><mml:math id="M160"><mml:msup><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mspace width="0.3em"/><mml:mo>∼</mml:mo><mml:mspace width="0.3em"/><mml:msup><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>∈</mml:mo><mml:mi mathvariant="script">ℳ</mml:mi></mml:math><inline-graphic xlink:href="12859_2014_404_Article_IEq75.gif"/></alternatives></inline-formula>. <inline-graphic xlink:href="12859_2014_404_Figa_HTML.gif" id="d30e6501"/> is a maximal strict EPM of <italic>A</italic> and <italic>B</italic>, iff <inline-formula id="IEq76"><alternatives><tex-math id="M161">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$A_{j^{\prime }+1} \neq B_{l^{\prime }+1}\phantom {\dot {i}\!}$
\end{document}</tex-math><mml:math id="M162"><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>≠</mml:mo><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2014_404_Article_IEq76.gif"/></alternatives></inline-formula>.</p>
      </sec>
      <sec id="d30e6552">
        <title><italic>Proof</italic>.</title>
        <p>“ ⇒”: Let <inline-formula id="IEq77"><alternatives><tex-math id="M163">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$A_{j^{\prime }+1}=B_{l^{\prime }+1}\phantom {\dot {i}\!}$
\end{document}</tex-math><mml:math id="M164"><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2014_404_Article_IEq77.gif"/></alternatives></inline-formula>. Then <inline-formula id="IEq78"><alternatives><tex-math id="M165">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$\mathcal {P}':=(\mathcal { M}\cup \{j'+1\!\sim \!l'+1\},\mathcal {S})$
\end{document}</tex-math><mml:math id="M166"><mml:msup><mml:mrow><mml:mi mathvariant="script">P</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:mo>(</mml:mo><mml:mi mathvariant="script">ℳ</mml:mi><mml:mo>∪</mml:mo><mml:mo>{</mml:mo><mml:msup><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mspace width="0.3em"/><mml:mo>∼</mml:mo><mml:mspace width="0.3em"/><mml:msup><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>}</mml:mo><mml:mo>,</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2014_404_Article_IEq78.gif"/></alternatives></inline-formula> is a strict EPM with <inline-formula id="IEq79"><alternatives><tex-math id="M167">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$\mathcal {P}\sqsubseteq \mathcal {P}'$
\end{document}</tex-math><mml:math id="M168"><mml:mi mathvariant="script">P</mml:mi><mml:mo>⊑</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="script">P</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="12859_2014_404_Article_IEq79.gif"/></alternatives></inline-formula>; hence <inline-graphic xlink:href="12859_2014_404_Figa_HTML.gif" id="d30e6683"/> is not maximal for <italic>A</italic> and <italic>B</italic> (i.e. among all strict EPMs of <italic>A</italic> and <italic>B</italic>). “ ⇐”: Let <inline-formula id="IEq80"><alternatives><tex-math id="M169">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$A_{j^{\prime }+1} \neq B_{l^{\prime }+1}\phantom {\dot {i}\!}$
\end{document}</tex-math><mml:math id="M170"><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>≠</mml:mo><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2014_404_Article_IEq80.gif"/></alternatives></inline-formula>.</p>
        <p>Assume <inline-graphic xlink:href="12859_2014_404_Figa_HTML.gif" id="d30e6743"/> is not maximal for <italic>A</italic> and <italic>B</italic>. Then, there is a strict EPM <inline-formula id="IEq81"><alternatives><tex-math id="M171">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$\mathcal {P}'=(\mathcal {M}',\mathcal {S}')\neq \mathcal {P}$
\end{document}</tex-math><mml:math id="M172"><mml:msup><mml:mrow><mml:mi mathvariant="script">P</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mo>(</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="script">ℳ</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="script">S</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>)</mml:mo><mml:mo>≠</mml:mo><mml:mi mathvariant="script">P</mml:mi></mml:math><inline-graphic xlink:href="12859_2014_404_Article_IEq81.gif"/></alternatives></inline-formula> with <inline-formula id="IEq82"><alternatives><tex-math id="M173">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$\mathcal {P}\sqsubseteq \mathcal {P}'$
\end{document}</tex-math><mml:math id="M174"><mml:mi mathvariant="script">P</mml:mi><mml:mo>⊑</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="script">P</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="12859_2014_404_Article_IEq82.gif"/></alternatives></inline-formula> that is not a strict EPM of <inline-formula id="IEq83"><alternatives><tex-math id="M175">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
${A}_{1..j^{\prime }}\phantom {\dot {i}\!}$
\end{document}</tex-math><mml:math id="M176"><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mi>..</mml:mi><mml:msup><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2014_404_Article_IEq83.gif"/></alternatives></inline-formula> and <inline-formula id="IEq84"><alternatives><tex-math id="M177">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
${B}_{1..l^{\prime }}\phantom {\dot {i}\!}$
\end{document}</tex-math><mml:math id="M178"><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mi>..</mml:mi><mml:msup><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2014_404_Article_IEq84.gif"/></alternatives></inline-formula>.</p>
        <p>Consequently, to satisfy <inline-formula id="IEq85"><alternatives><tex-math id="M179">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$\mathcal {M}\subset \mathcal {M}'$
\end{document}</tex-math><mml:math id="M180"><mml:mi mathvariant="script">ℳ</mml:mi><mml:mo>⊂</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="script">ℳ</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="12859_2014_404_Article_IEq85.gif"/></alternatives></inline-formula>, there has to exist <inline-formula id="IEq86"><alternatives><tex-math id="M181">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$ij\!\sim \!kl\in \mathcal {S}'$
\end{document}</tex-math><mml:math id="M182"><mml:mtext mathvariant="italic">ij</mml:mtext><mml:mspace width="0.3em"/><mml:mo>∼</mml:mo><mml:mspace width="0.3em"/><mml:mtext mathvariant="italic">kl</mml:mtext><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="script">S</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="12859_2014_404_Article_IEq86.gif"/></alternatives></inline-formula> with <italic>i</italic>≤<italic>j</italic><sup>′</sup>&lt;<italic>j</italic> and <italic>k</italic>≤<italic>l</italic><sup>′</sup>&lt;<italic>l</italic>. However in this case, while clearly the parent of <italic>j</italic><sup>′</sup> ∼ <italic>l</italic><sup>′</sup> in <inline-graphic xlink:href="12859_2014_404_Figc_HTML.gif" id="d30e6941"/> is <italic>ψ</italic>, there is a parent of <italic>j</italic><sup>′</sup> ∼ <italic>l</italic><sup>′</sup> in <inline-formula id="IEq87"><alternatives><tex-math id="M183">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$\mathcal {S}'$
\end{document}</tex-math><mml:math id="M184"><mml:msup><mml:mrow><mml:mi mathvariant="script">S</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="12859_2014_404_Article_IEq87.gif"/></alternatives></inline-formula> different from <italic>ψ</italic> (i.e. either <italic>i</italic><italic>j</italic> ∼ <italic>k</italic><italic>l</italic> or some “smaller” base pair match). This contradicts <inline-formula id="IEq88"><alternatives><tex-math id="M185">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$\mathcal {P}\sqsubseteq \mathcal {P}'$
\end{document}</tex-math><mml:math id="M186"><mml:mi mathvariant="script">P</mml:mi><mml:mo>⊑</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="script">P</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="12859_2014_404_Article_IEq88.gif"/></alternatives></inline-formula>, because <inline-graphic xlink:href="12859_2014_404_Figa_HTML.gif" id="d30e7006"/> and <inline-formula id="IEq89"><alternatives><tex-math id="M187">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$\mathcal {P}'$
\end{document}</tex-math><mml:math id="M188"><mml:msup><mml:mrow><mml:mi mathvariant="script">P</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="12859_2014_404_Article_IEq89.gif"/></alternatives></inline-formula> are not comparable by inclusion order (Def 6).</p>
        <p>By the same argument, the forward direction holds for relaxed EPMs. Therefore, we enumerate all maximal relaxed EPMss by restricting the traceback in the same way. However, since the backward direction does not hold generally, this procedure can enumerate non-maximal relaxed EPMs. In practice, we observe this very rarely; consequently, while redundant relaxed EPMs could be removed explicitly, we let the chaining procedure handle those EPMs.</p>
      </sec>
    </sec>
    <sec id="Sec12">
      <title>ExpaRNA-P: Sparsification</title>
      <p>ExpaRNA-P’s efficiency depends fundamentally on the sparsity of the DP matrices, which we leverage through fixed thresholds <italic>θ</italic><sub>1</sub>,<italic>θ</italic><sub>2</sub>, and <italic>θ</italic><sub>3</sub>. Consequently, we compute all DP matrices in only <italic>O</italic>(<italic>n</italic><sup>2</sup>) time and space. We compute matrices <inline-formula id="IEq90"><alternatives><tex-math id="M189">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$L^{ijkl}, G_{\text {A}}^{ijkl}, G_{\text {AB}}^{ijkl}$
\end{document}</tex-math><mml:math id="M190"><mml:msup><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ijkl</mml:mtext></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mtext>A</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ijkl</mml:mtext></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mtext>AB</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ijkl</mml:mtext></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2014_404_Article_IEq90.gif"/></alternatives></inline-formula>, and <italic>L</italic><italic>R</italic><sup><italic>i</italic><italic>j</italic><italic>k</italic><italic>l</italic></sup> only for base pairs (<italic>i</italic>,<italic>j</italic>) and (<italic>k</italic>,<italic>l</italic>) that are significant (i.e. Pr[(<italic>i</italic>,<italic>j</italic>)|<italic>A</italic>]≥<italic>θ</italic><sub>1</sub> and Pr[(<italic>k</italic>,<italic>l</italic>)|<italic>B</italic>]≥<italic>θ</italic><sub>1</sub>). Furthermore, we compute only relevant entries of these matrices.</p>
      <p>This is best illustrated by the notion of candidates; each <italic>j</italic><sup>′</sup> is a <italic>candidate of (i,j) in sequence A</italic> if it is either a significant single-stranded position within (<italic>i</italic>,<italic>j</italic>), i.e. Pr[<italic>j</italic><sup>′</sup> ∈ loop(<italic>i</italic>,<italic>j</italic>)|<italic>A</italic>]≥<italic>θ</italic><sub>2</sub>, or contained in a significant helix of (<italic>i</italic>,<italic>j</italic>), i.e. Pr[(<italic>i</italic><sup>′</sup>,<italic>j</italic><sup>′</sup>) ∈ loop(<italic>i</italic>,<italic>j</italic>)|<italic>A</italic>]≥<italic>θ</italic><sub>3</sub> for some <italic>i</italic><sup>′</sup>. Analogously, we define <italic>candidates l</italic><sup>′</sup><italic> of (k,l) in sequence B</italic>. (For candidates <italic>l</italic><sup>′</sup> holds Pr[<italic>l</italic><sup>′</sup> ∈ loop(<italic>k</italic>,<italic>l</italic>)|<italic>B</italic>]≥<italic>θ</italic><sub>2</sub> or Pr[(<italic>k</italic><sup>′</sup>,<italic>l</italic><sup>′</sup>) ∈ loop(<italic>k</italic>,<italic>l</italic>)|<italic>B</italic>]≥<italic>θ</italic><sub>3</sub> for some <italic>k</italic><sup>′</sup>).</p>
      <sec id="d30e7291">
        <title><bold>Theorem</bold><bold>1</bold>.</title>
        <p>There are only <italic>O</italic>(<italic>n</italic><sup>2</sup>) entries <inline-formula id="IEq91"><alternatives><tex-math id="M191">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$L^{ijkl}(j',l'), G_{\text {A}}^{ijkl}(j',l')$
\end{document}</tex-math><mml:math id="M192"><mml:msup><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ijkl</mml:mtext></mml:mrow></mml:msup><mml:mo>(</mml:mo><mml:msup><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>)</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mtext>A</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ijkl</mml:mtext></mml:mrow></mml:msubsup><mml:mo>(</mml:mo><mml:msup><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2014_404_Article_IEq91.gif"/></alternatives></inline-formula>, <inline-formula id="IEq92"><alternatives><tex-math id="M193">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$G_{\text {AB}}^{ijkl}(j',l')$
\end{document}</tex-math><mml:math id="M194"><mml:msubsup><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mtext>AB</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ijkl</mml:mtext></mml:mrow></mml:msubsup><mml:mo>(</mml:mo><mml:msup><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2014_404_Article_IEq92.gif"/></alternatives></inline-formula>, and <italic>L</italic><italic>R</italic><sup><italic>i</italic><italic>j</italic><italic>k</italic><italic>l</italic></sup>(<italic>j</italic><sup>′</sup>,<italic>l</italic><sup>′</sup>) such that <italic>j</italic><sup>′</sup> is a candidate of (<italic>i</italic>,<italic>j</italic>) and <italic>l</italic><sup>′</sup> is a candidate of (<italic>k</italic>,<italic>l</italic>). Consequently, ExpaRNA-P has quadratic time and space complexity.</p>
        <p><bold><italic>Proof sketch:</italic></bold> By definition, only candidates <italic>j</italic><sup>′</sup> or <italic>l</italic><sup>′</sup> can be part of a significant EPM as defined in Def. 5; otherwise, we assign −<italic>∞</italic> to <italic>L</italic><sup><italic>i</italic><italic>j</italic><italic>k</italic><italic>l</italic></sup>(<italic>j</italic><sup>′</sup>,<italic>l</italic><sup>′</sup>) and <italic>L</italic><italic>R</italic><sup><italic>i</italic><italic>j</italic><italic>k</italic><italic>l</italic></sup>(<italic>j</italic><sup>′</sup>,<italic>l</italic><sup>′</sup>). Furthermore, in the latter case, we neither store nor compute the values for <inline-formula id="IEq93"><alternatives><tex-math id="M195">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$G_{\text {A}}^{ijkl}(j',l')$
\end{document}</tex-math><mml:math id="M196"><mml:msubsup><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mtext>A</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ijkl</mml:mtext></mml:mrow></mml:msubsup><mml:mo>(</mml:mo><mml:msup><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2014_404_Article_IEq93.gif"/></alternatives></inline-formula> and <inline-formula id="IEq94"><alternatives><tex-math id="M197">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$G_{\text {AB}}^{ijkl}(j',l')$
\end{document}</tex-math><mml:math id="M198"><mml:msubsup><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mtext>AB</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ijkl</mml:mtext></mml:mrow></mml:msubsup><mml:mo>(</mml:mo><mml:msup><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2014_404_Article_IEq94.gif"/></alternatives></inline-formula>. Due to these considerations, in the matrices <inline-formula id="IEq95"><alternatives><tex-math id="M199">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$L^{ijkl}, LR^{ijkl}, G_{\text {A}}^{ijkl}$
\end{document}</tex-math><mml:math id="M200"><mml:msup><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ijkl</mml:mtext></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mi>L</mml:mi><mml:msup><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ijkl</mml:mtext></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mtext>A</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ijkl</mml:mtext></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2014_404_Article_IEq95.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq96"><alternatives><tex-math id="M201">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$G_{\text {AB}}^{ijkl}$
\end{document}</tex-math><mml:math id="M202"><mml:msubsup><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mtext>AB</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ijkl</mml:mtext></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2014_404_Article_IEq96.gif"/></alternatives></inline-formula>, we skip each complete row or column whose index is no candidate. Consequently, after computing a mapping from candidate sequence positions to matrix positions — independently for each sequence and for all significant base pairs, the sparsified algorithm operates on “contracted” matrices that contain only the candidate rows and columns. The first threshold <italic>θ</italic><sub>1</sub> reduces the number of base pairs to a constant number of base pairs per sequence position; in total, quadratically many base pairs pass the filter. The thresholds on joint probabilities guarantee that each sequence position is candidate of only constantly many base pairs. In consequence, each position is considered only a constant number of times during the entire computation; this directly results in quadratic time complexity. (Full proof in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Sec. 2)</p>
      </sec>
    </sec>
    <sec id="Sec13">
      <title>Chaining</title>
      <p>Chaining selects a non-crossing and non-overlapping subset of EPMs. Our algorithm generalizes the chaining of ExpaRNA [<xref ref-type="bibr" rid="CR30">30</xref>]. The chaining algorithm recursively fills the holes of all EPMs with other EPMs. For this purpose, it fills one <italic>O</italic>(<italic>n</italic><sup>2</sup>) matrix for each hole and takes <italic>O</italic>(<italic>H</italic><italic>n</italic><sup>2</sup>) time, where <italic>H</italic> is total number of holes with <italic>H</italic>≪<italic>n</italic><sup>2</sup>. In contrast to ExpaRNA, there may exist more than one EPM ending at each sequence position pair, i.e. there is no one-to-one correspondence between EPMs and EPM’s end positions. This is why each matrix requires additional steps in the order of the number of input EPMs <italic>E</italic> in ExpaRNA-P’s chaining; the complexity of the generalized chaining algorithm is <italic>O</italic>(<italic>H</italic>·(<italic>n</italic><sup>2</sup>+<italic>E</italic>)). Since in the most general case, when we enumerate all suboptimal EPMs up to a maximal difference to the optimal score, <italic>E</italic>∈<italic>O</italic>(<italic>n</italic><sup>2</sup>) is not guaranteed, we implement in addition several ways to control the number of EPMs. For example, ExpaRNA-P allows setting an <italic>ad hoc</italic> limit on this number. Furthermore, we suggest a heuristic strategy: for each sequence position pair, keep only the best EPM ending there. Consequently, typical use cases of ExpaRNA-P maintain the chaining complexity of ExpaRNA, i.e. <italic>O</italic>(<italic>H</italic><italic>n</italic><sup>2</sup>).</p>
    </sec>
  </sec>
  <sec id="Sec14">
    <title>Results and discussion</title>
    <p>We implemented ExpaRNA-P and the chaining algorithm in C++. In particular, we implemented two versions of the traceback: the suboptimal traceback and a heuristic version that, for each match <italic>i</italic> ∼ <italic>k</italic>, considers only the optimal EPM ending at that match. Our tool supports two ways to control the EPM enumeration by the suboptimal traceback: either by defining the maximum score difference to the optimal score or the maximum number of EPMs.</p>
    <p>In order to assess the performance of ExpaRNA-P, we designed the following pipeline: In a first step we compute the significant EPMs with ExpaRNA-P and use the chaining algorithm to extract from these EPMs an optimal non-overlapping and non-crossing subset. Then we compute a sequence structure alignment that includes all matches of the chained EPMs. For this purpose, we utilize the EPMs as anchor constraints for LocARNA. Consequently, LocARNA runs much faster, since each anchor reduces the alignment space. In correspondence with the analogous idea ExpLoc [<xref ref-type="bibr" rid="CR30">30</xref>], which utilizes ExpaRNA anchors, we call our pipeline ExpLoc-P.</p>
    <p>We performed all benchmarks over the pairwise alignment instances of the BRAliBase 2.1 benchmark set [<xref ref-type="bibr" rid="CR44">44</xref>,<xref ref-type="bibr" rid="CR45">45</xref>]. To measure the quality of the calculated alignment in comparison to the (for each instance) known reference alignment, BRAliBase 2.1 [<xref ref-type="bibr" rid="CR44">44</xref>] provides the scoring tool compalignp. It computes the similarity between the two alignments as sum-of-pairs score (SPS). Identical alignments receive the SPS score 1; alignments without any correspondence, 0. In this way, we evaluated different variants of our method and later compare them to existing tools. At the same time, we opposed quality to runtime.</p>
    <sec id="Sec15">
      <title>Impact of EPM selection on the performance</title>
      <p>We study five ExpLoc-P variants, where we generate anchor constraints respectively by 
<list list-type="order"><list-item><p>heuristic traceback with exact matches</p></list-item><list-item><p>heuristic traceback with inexact structure matches</p></list-item><list-item><p>suboptimal traceback with exact matches</p></list-item><list-item><p>suboptimal traceback with inexact structure matches</p></list-item><list-item><p>suboptimal traceback with inexact structure matches and the additional second filter step</p></list-item></list></p>
      <p>In particular, we compare exact modes (1,3), which follow the strict EPM definition, and inexact modes (2,4,5), which allow mismatches at structure positions (relaxed EPMs.) The score parameters were selected ad-hoc without parameter learning; in particular, we set the cutoff probabilities to restrictive values <italic>θ</italic><sub>1</sub>=<italic>θ</italic><sub>2</sub>=<italic>θ</italic><sub>3</sub>=0.01 to predict less false positives. Furthermore, we enumerated EPMs that have a score of at least 90 and fix the maximal number of traced EPMs in the suboptimal traceback to 100. The scoring – as defined in Eq. <xref rid="Equ1" ref-type="">1</xref> and <xref rid="Equ2" ref-type="">2</xref> was instantiated by setting the structure mismatch score <italic>str_mm</italic> to −10 for structure mismatches in inexact modes. Furthermore we set <italic>α</italic><sub>1</sub>=1,<italic>α</italic><sub>2</sub>=5 and <italic>α</italic><sub>3</sub>=5 in order to favor structured regions. In addition to SPS and runtime, we computed the coverage for each benchmark instance – consisting of sequences <italic>A</italic> and <italic>B</italic>. For this purpose, we define <italic>coverage</italic> as the fraction of nucleotides that are matched by the best chain of EPMs <inline-formula id="IEq97"><alternatives><tex-math id="M203">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$\mathcal {C} = \bigcup (\mathcal {M},\mathcal {S})$
\end{document}</tex-math><mml:math id="M204"><mml:mi mathvariant="script">C</mml:mi><mml:mo>=</mml:mo><mml:mo>⋃</mml:mo><mml:mo>(</mml:mo><mml:mi mathvariant="script">ℳ</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2014_404_Article_IEq97.gif"/></alternatives></inline-formula>: 
<disp-formula id="Equ3"><label>(3)</label><alternatives><tex-math id="M205">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
 $$ \text{coverage} = \frac{\sum_{(\mathcal{M},\mathcal{S}) \in \mathcal{C}} |\mathcal{M}|}{\min(A,B)}  $$ 
\end{document}</tex-math><mml:math id="M206"><mml:mtext>coverage</mml:mtext><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="script">ℳ</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo>)</mml:mo><mml:mo>∈</mml:mo><mml:mi mathvariant="script">C</mml:mi></mml:mrow></mml:munder><mml:mo>|</mml:mo><mml:mi mathvariant="script">ℳ</mml:mi><mml:mo>|</mml:mo></mml:mrow><mml:mrow><mml:mo>min</mml:mo><mml:mo>(</mml:mo><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mfrac></mml:math><graphic xlink:href="12859_2014_404_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>Figure <xref rid="Fig6" ref-type="fig">6</xref>A shows the alignment quality (SPS) versus the sequence identity; we visualized the dependency by estimating a LOWESS curve [<xref ref-type="bibr" rid="CR46">46</xref>] for each series of benchmark evaluations. Overall, we observed that the difference between the suboptimal and heuristic traceback is not significant, solely for inexact modes, the suboptimal traceback leads to slightly better results. Furthermore, in inexact modes the additional second filter step did not change the quality significantly. Exact modes produced better alignments, however these modes generated much less anchor constraints for low sequence identity regions; in turn, the speedup decreases in these modes. This effect is visible in Figure <xref rid="Fig6" ref-type="fig">6</xref>B, which plots the estimated coverage vs. the sequence identity. The exact modes predict EPMs only for sequence identity values above 60%. For the inexact modes, we obtained much higher coverage; notably, we predicted many more relaxed EPMs than strict EPMs for the sequence identity interval from 40-60%.
<fig id="Fig6"><label>Figure 6</label><caption><p><bold>Comparison of </bold><bold>ExpLoc-P</bold><bold> variants.</bold><bold>(A)</bold> Alignment quality (SPS) vs. sequence identity. <bold>(B)</bold> Coverage vs. sequence identity. Dependencies are visualized as LOWESS curves.</p></caption><graphic xlink:href="12859_2014_404_Fig6_HTML" id="MO6"/></fig></p>
      <p>In Table <xref rid="Tab1" ref-type="table">1</xref>, we report total runtimes and average SPS scores of different ExpLoc-P variants over the entire benchmark set. Furthermore, we provide single timings for preprocessing (first value in brackets), computing and chaining the EPMs (second value), and subsequent LocARNA alignments (third value). The differences in coverage directly impact the runtimes of the different variants, but not as pronounced, since – like one would expect for many real world applications – the benchmark set contains many high identity sequences. Consequently, relaxed EPMs significantly reduced the runtime for instances with sequence identity between 50-80% (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S3A). Furthermore, the heuristic traceback was slightly faster than the suboptimal one for long RNA sequences (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S3B), while suboptimal traceback could not significantly improve the alignment quality in this setting. Consequently, for this specific benchmark, the two variants with heuristic traceback turned out to provide the best balance of quality and speedup.
<table-wrap id="Tab1"><label>Table 1</label><caption><p><bold>Comparison of </bold><bold>ExpLoc-P</bold><bold> variants</bold></p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"><bold>ExpLoc-P</bold><bold> variant</bold></th><th align="left"><bold>1</bold></th><th align="left"><bold>2</bold></th><th align="left"><bold>3</bold></th><th align="left"><bold>4</bold></th><th align="left"><bold>5</bold></th></tr></thead><tbody><tr><td align="left">Total time</td><td align="left">3.5 h</td><td align="left">3.0 h</td><td align="left">3.7 h</td><td align="left">3.1 h</td><td align="left">3.1 h</td></tr><tr><td align="left"/><td align="left">(0.6 h + 0.4 h + 2.6 h)</td><td align="left">(0.6 h + 0.5 h + 1.9 h)</td><td align="left">(0.6 h + 0.4 h + 2.7 h)</td><td align="left">(0.6 h + 0.5 h + 2.0 h)</td><td align="left">(0.6 h + 0.5 h + 2.0 h)</td></tr><tr><td align="left">Total SPS</td><td align="left">0.86</td><td align="left">0.84</td><td align="left">0.86</td><td align="left">0.84</td><td align="left">0.84</td></tr></tbody></table></table-wrap></p>
    </sec>
    <sec id="Sec16">
      <title>Comparison to other tools</title>
      <p>We benchmarked three existing approaches: LocARNA, ExpLoc [<xref ref-type="bibr" rid="CR30">30</xref>], and RAF [<xref ref-type="bibr" rid="CR29">29</xref>]. LocARNA without anchors serves as base line approach; in contrast to ExpLoc-P, ExpLoc identifies EPMs in a single predicted structure for each RNA (using ExpaRNA); and RAF is currently the fastest Sankoff-style alignment approach due to its heuristic filtering based on sequence alignments. We compared these approaches to ExpLoc-P variants 1 and 2, which performed best in the previous section.</p>
      <p>Table <xref rid="Tab2" ref-type="table">2</xref> summarizes the results; we report the speedup over LocARNA, total runtime, and average alignment quality (SPS) across the entire benchmark set (Opteron 2356, 2.3 GHz, single thread). Figure <xref rid="Fig7" ref-type="fig">7</xref>A shows the behavior of the compalignp score dependent on the sequence identity. LocARNA aligned with the best quality at the expense of the highest computation time. The best alignment quality that has been obtained with ExpLoc in [<xref ref-type="bibr" rid="CR30">30</xref>] has been achieved with parameter minsize=10. Even this quality is significantly lower than the one for the two variants of ExpLoc-P (0.81 vs. 0.84 and 0.86). Moreover, the overall speedup for this setting is not much higher than the speedups for ExpLoc-P. Although RAF achieved the best speedup of 14.4, the quality drops tremendously for sequence similarities below 50%.
<fig id="Fig7"><label>Figure 7</label><caption><p><bold>Comparison with sequence-structure alignment methods.</bold><bold>(A)</bold> Comparison of alignment quality vs. sequence identity. <bold>(B)</bold> Comparison of speedup over LocARNA vs. length (LOWESS).</p></caption><graphic xlink:href="12859_2014_404_Fig7_HTML" id="MO7"/></fig><table-wrap id="Tab2"><label>Table 2</label><caption><p><bold>Comparison of RNA alignment methods</bold></p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"/><th align="left"><bold>LocARNA</bold></th><th align="left"><bold>ExpLoc-P</bold></th><th align="left"><bold>ExpLoc-P</bold></th><th align="left"><bold>ExpLoc</bold></th><th align="left"><bold>RAF</bold></th></tr><tr><th align="left"/><th align="left"/><th align="left"><bold>(variant 1)</bold></th><th align="left"><bold>(variant 2)</bold></th><th align="left"><bold><italic>γ</italic></bold><bold>=10</bold></th><th align="left"/></tr></thead><tbody><tr><td align="left">Speedup</td><td align="left">1</td><td align="left">3.9</td><td align="left">4.6</td><td align="left">5.0</td><td align="left">14.4</td></tr><tr><td align="left">Runtime</td><td align="left">13.8 h</td><td align="left">3.5 h</td><td align="left">3.0 h</td><td align="left">2.8 h</td><td align="left">1.0 h</td></tr><tr><td align="left">SPS</td><td align="left">0.87</td><td align="left">0.86</td><td align="left">0.84</td><td align="left">0.81</td><td align="left">0.86</td></tr></tbody></table></table-wrap></p>
      <p>The quality drop of RAF alignments at low sequence identities is strongly reminiscent of pure sequence alignment methods. Thus, we conjecture that the specific use of sequence-based heuristics by RAF, while guaranteeing sequence alignment like run-time behavior, compromises RAF’s use for ‘hard’ RNA alignment instances that require structure-based alignment methods.</p>
      <p>Furthermore, we investigated the dependency of the lengths of the input sequences on the speedup (see Figure <xref rid="Fig7" ref-type="fig">7</xref>B). As expected, the speedup increased for longer input sequences. For RNA sequences longer than 150 bases, we obtained a significantly better speedup with both variants of ExpLoc-P compared to ExpLoc. Moreover, the speedup difference increases with the lengths of the input sequences (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S4 provides a detailed comparison of ExpLoc-P variants 1 and 2). For the longest input sequences, ExpLoc-P achieved respective speedups of 32 and 35 for variants 1 and 2, and RAF of almost 50.</p>
      <p>To summarize, ExpLoc-P provided the best trade-off between alignment quality and speedup in this setting; robustly, it maintained high alignment quality over the entire range of sequence identities; finally, it proofed to be particularly suited for long instances.</p>
    </sec>
  </sec>
  <sec id="Sec17" sec-type="conclusion">
    <title>Conclusion</title>
    <p>We have introduced the algorithm ExpaRNA-P that very efficiently identifies exact pattern matches in RNAs by matching and folding them simultaneously. The method is a major achievement over previous approaches (including the “predecessor” ExpaRNA) that – without being more efficient – are much less flexible, since they require a priori known or unreliably predicted structure.</p>
    <p>Due to its novel ensemble-based sparsification, the algorithm ExpaRNA-P has only a very low (quadratic) time and space complexity, equalling sequence alignment. This sparsification technique is particularly relevant, since similar techniques can likely be applied to other RNA analysis methods.</p>
    <p>We have developed two major variants of this method; one requires strict matches in all positions of an EPM (strict EPMs), the other relaxes this (therefore, relaxed EPMs) to allow mismatches at structural positions. The latter supports compensatory mutations, which are highly relevant in RNA structure analysis in general.</p>
    <p>Our benchmarks study EPMs as anchor constraints to speed up RNA structure alignments (in the form of simultaneous alignment and folding by LocARNA). EPMs from structure ensembles have turned out to be substantially more reliable than EPMs from fixed structures. At comparable speed ups, this results in increased quality. Most importantly, the novel approach keeps up the alignment quality even for sequences of low identity, which is ultimately decisive for structure alignment. In striking contrast, the alignment quality of the similarly fast alignment tool RAF breaks down – very much like pure sequence alignment.</p>
    <p>We have implemented rigorous suboptimal traceback, which provides extensive control of the set of enumerated EPMs. For example, this level of control is required in the analysis of structural variants common to the RNAs. In addition, we have developed a heuristic traceback, which performs almost indistinguishable in our benchmark. Being much faster than the rigorous method, it offers the best speed-quality balance in such settings.</p>
    <p>Finally, we conjecture that EPM-based anchor constraints can be combined advantageously with other RNA alignment tools such as RAF. While for LocARNA the constraints yield a considerable speedup, the combination with RAF has the potential to improve RAF’s poor alignment quality for low sequence similarity.</p>
  </sec>
</body>
<back>
  <app-group>
    <app id="App1">
      <sec id="Sec18">
        <title>Additional file</title>
        <p>
          <media position="anchor" xlink:href="12859_2014_404_MOESM1_ESM.pdf" id="MOESM1">
            <label>Additional file 1</label>
            <caption>
              <p><bold>Supporting Information.</bold> Supplementary document containing details about precomputing joint loop probabilities (including a complexity analysis), the proof of ExpaRNA-P’s complexity and supplementary results.</p>
            </caption>
          </media>
        </p>
      </sec>
    </app>
  </app-group>
  <fn-group>
    <fn>
      <p>
        <bold>Competing interests</bold>
      </p>
      <p>The authors declare that they have no competing interests.</p>
    </fn>
    <fn>
      <p>
        <bold>Authors’ contributions</bold>
      </p>
      <p>MM and SW initiated the project and developed the ExpaRNA-P core algorithm; CO, RB, SH, MA, and GML made various contributions to the final algorithm, the ExpLoc-P pipeline, and the presentation of algorithms. SH implemented the generalized chaining algorithm. CO implemented the other algorithms (making use of the LocARNA library by SW) and, in the course, identified and solved many detailed technical and algorithmic aspects. CO and SW wrote major parts of the manuscript, where RB significantly contributed to the introduction. CO, SH, RB, and SW designed experiments, which CO performed. RB and SW furthermore contributed with guidance and supervision. All authors read and approved the final manuscript.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>This work was partially supported by the German Research Foundation (BA 2168/3-3 and MO 2402/1-1), the German Federal Ministry of Education and Research (BMBF, grant 0316165A e:Bio RNAsys to RB), the National Science Foundation (Award 0904246 to GML), the Israel Science Foundation (grant 347/09 to GML), and the United States-Israel Binational Science Foundation (BSF) and DFG (grant 2008217 to GML). We thank the anonymous reviewers for their help to improve the paper. Finally, we acknowledge support from the German Research Foundation (DFG) and Leipzig University within the program of Open Access Publishing.</p>
  </ack>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <collab>The FANTOM Consortium</collab>
        </person-group>
        <article-title>
          <bold>The transcriptional landscape of the mammalian genome</bold>
        </article-title>
        <source>Science</source>
        <year>2005</year>
        <volume>309</volume>
        <issue>5740</issue>
        <fpage>1559</fpage>
        <lpage>63</lpage>
        <pub-id pub-id-type="doi">10.1126/science.1112014</pub-id>
        <pub-id pub-id-type="pmid">16141072</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cheng</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Kapranov</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Drenkow</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Dike</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Brubaker</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Patel</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Long</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Stern</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Tammana</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Helt</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Sementchenko</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Piccolboni</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Bekiranov</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Bailey</surname>
            <given-names>DK</given-names>
          </name>
          <name>
            <surname>Ganesh</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Ghosh</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Bell</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Gerhard</surname>
            <given-names>DS</given-names>
          </name>
          <name>
            <surname>Gingeras</surname>
            <given-names>TR</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Transcriptional maps of 10 human chromosomes at 5-nucleotide resolution</bold>
        </article-title>
        <source>Science</source>
        <year>2005</year>
        <volume>308</volume>
        <fpage>1149</fpage>
        <lpage>1154</lpage>
        <pub-id pub-id-type="doi">10.1126/science.1108625</pub-id>
        <?supplied-pmid 15790807?>
        <pub-id pub-id-type="pmid">15790807</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bertone</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Stoc</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Royce</surname>
            <given-names>TE</given-names>
          </name>
          <name>
            <surname>Rozowsky</surname>
            <given-names>JS</given-names>
          </name>
          <name>
            <surname>Urban</surname>
            <given-names>AE</given-names>
          </name>
          <name>
            <surname>Zhu</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Rinn</surname>
            <given-names>JL</given-names>
          </name>
          <name>
            <surname>Tongprasit</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Samanta</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Weissman</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Gerstein</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Snyder</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Global identification of human transcribed sequences with genome tiling arrays</bold>
        </article-title>
        <source>Science</source>
        <year>2004</year>
        <volume>306</volume>
        <fpage>2242</fpage>
        <lpage>2246</lpage>
        <pub-id pub-id-type="doi">10.1126/science.1103388</pub-id>
        <?supplied-pmid 15539566?>
        <pub-id pub-id-type="pmid">15539566</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <collab>The ENCODE Project Consortium</collab>
        </person-group>
        <article-title>
          <bold>An integrated encyclopedia of DNA elements in the human genome</bold>
        </article-title>
        <source>Nature</source>
        <year>2012</year>
        <volume>489</volume>
        <issue>7414</issue>
        <fpage>57</fpage>
        <lpage>74</lpage>
        <pub-id pub-id-type="doi">10.1038/nature11247</pub-id>
        <pub-id pub-id-type="pmid">22955616</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mattick</surname>
            <given-names>JS</given-names>
          </name>
          <name>
            <surname>Taft</surname>
            <given-names>RJ</given-names>
          </name>
          <name>
            <surname>Faulkner</surname>
            <given-names>GJ</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>A global view of genomic information - moving beyond the gene and the master regulator</bold>
        </article-title>
        <source>Trends Genet</source>
        <year>2010</year>
        <volume>26</volume>
        <issue>1</issue>
        <fpage>21</fpage>
        <lpage>8</lpage>
        <pub-id pub-id-type="doi">10.1016/j.tig.2009.11.002</pub-id>
        <?supplied-pmid 19944475?>
        <pub-id pub-id-type="pmid">19944475</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bompfünewerer Consortium</surname>
            <given-names>AF</given-names>
          </name>
          <name>
            <surname>Backofen</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Bernhart</surname>
            <given-names>SH</given-names>
          </name>
          <name>
            <surname>Flamm</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Fried</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Fritzsch</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Hackermüller</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Hertel</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Hofacker</surname>
            <given-names>IL</given-names>
          </name>
          <name>
            <surname>Missal</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Mosig</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Prohaska</surname>
            <given-names>SJ</given-names>
          </name>
          <name>
            <surname>Rose</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Stadler</surname>
            <given-names>PF</given-names>
          </name>
          <name>
            <surname>Tanzer</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Washietl</surname>
            <given-names>S</given-names>
          </name>
          <collab>Will S</collab>
        </person-group>
        <article-title>
          <bold>RNAs everywhere: genome-wide annotation of structured RNAs</bold>
        </article-title>
        <source>J Exp Zoolog B Mol Dev Evol</source>
        <year>2007</year>
        <volume>308</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>25</lpage>
        <pub-id pub-id-type="doi">10.1002/jez.b.21130</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Smith</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Gesell</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Stadler</surname>
            <given-names>PF</given-names>
          </name>
          <name>
            <surname>Mattick</surname>
            <given-names>JS</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Widespread purifying selection on RNA structure in mammals</bold>
        </article-title>
        <source>Nucleic Acids Res</source>
        <year>2013</year>
        <volume>41</volume>
        <issue>17</issue>
        <fpage>8220</fpage>
        <lpage>36</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkt596</pub-id>
        <?supplied-pmid 23847102?>
        <pub-id pub-id-type="pmid">23847102</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rivas</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Eddy</surname>
            <given-names>SR</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Noncoding RNA gene detection using comparative sequence analysis</bold>
        </article-title>
        <source>BMC Bioinformatics</source>
        <year>2001</year>
        <volume>2</volume>
        <issue>1</issue>
        <fpage>8</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-2-8</pub-id>
        <?supplied-pmid 11801179?>
        <pub-id pub-id-type="pmid">11801179</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Coventry</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Kleitman</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>Berger</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>MSARI: multiple sequence alignments for statistical detection of RNA secondary structure</bold>
        </article-title>
        <source>Proc Natl Acad Sci USA</source>
        <year>2004</year>
        <volume>101</volume>
        <issue>33</issue>
        <fpage>12102</fpage>
        <lpage>7</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.0404193101</pub-id>
        <?supplied-pmid 15304649?>
        <pub-id pub-id-type="pmid">15304649</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pedersen</surname>
            <given-names>JS</given-names>
          </name>
          <name>
            <surname>Bejerano</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Siepel</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Rosenbloom</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Lindblad-Toh</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Lander</surname>
            <given-names>ES</given-names>
          </name>
          <name>
            <surname>Kent</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Miller</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Haussler</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Identification and Classification of Conserved RNA Secondary Structures in the Human Genome</bold>
        </article-title>
        <source>PLoS Comput Biol</source>
        <year>2006</year>
        <volume>2</volume>
        <issue>4</issue>
        <fpage>33</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.0020033</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Washietl</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Hofacker</surname>
            <given-names>IL</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Identifying structural noncoding RNAs using RNAz</bold>
        </article-title>
        <source>Curr Protoc Bioinformatics</source>
        <year>2007</year>
        <volume>19</volume>
        <fpage>12.7.1</fpage>
        <lpage>12.7.18</lpage>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Will</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Yu</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Berger</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Structure-based whole-genome realignment reveals many novel noncoding RNAs</bold>
        </article-title>
        <source>Genome Res</source>
        <year>2013</year>
        <volume>23</volume>
        <issue>6</issue>
        <fpage>1018</fpage>
        <lpage>1027</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.137091.111</pub-id>
        <?supplied-pmid 23296921?>
        <pub-id pub-id-type="pmid">23296921</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Will</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Reiche</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Hofacker</surname>
            <given-names>IL</given-names>
          </name>
          <name>
            <surname>Stadler</surname>
            <given-names>PF</given-names>
          </name>
          <name>
            <surname>Backofen</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Inferring non-coding RNA families and classes by means of genome-scale structure-based clustering</bold>
        </article-title>
        <source>PLOS Comput Biol</source>
        <year>2007</year>
        <volume>3</volume>
        <issue>4</issue>
        <fpage>65</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.0030065</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kaczkowski</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Torarinsson</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Reiche</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Havgaard</surname>
            <given-names>JH</given-names>
          </name>
          <name>
            <surname>Stadler</surname>
            <given-names>PF</given-names>
          </name>
          <name>
            <surname>Gorodkin</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Structural profiles of human miRNA families from pairwise clustering</bold>
        </article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>25</volume>
        <issue>3</issue>
        <fpage>291</fpage>
        <lpage>4</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btn628</pub-id>
        <?supplied-pmid 19059941?>
        <pub-id pub-id-type="pmid">19059941</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Parker</surname>
            <given-names>BJ</given-names>
          </name>
          <name>
            <surname>Moltke</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Roth</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Washietl</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Wen</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Kellis</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Breaker</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Pedersen</surname>
            <given-names>JS</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>New families of human regulatory RNA structures identified by comparative analysis of vertebrate genomes</bold>
        </article-title>
        <source>Genome Res</source>
        <year>2011</year>
        <volume>21</volume>
        <issue>11</issue>
        <fpage>1929</fpage>
        <lpage>43</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.112516.110</pub-id>
        <?supplied-pmid 21994249?>
        <pub-id pub-id-type="pmid">21994249</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Burge</surname>
            <given-names>SW</given-names>
          </name>
          <name>
            <surname>Daub</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Eberhardt</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Tate</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Barquist</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Nawrocki</surname>
            <given-names>EP</given-names>
          </name>
          <name>
            <surname>Eddy</surname>
            <given-names>SR</given-names>
          </name>
          <name>
            <surname>Gardner</surname>
            <given-names>PP</given-names>
          </name>
          <name>
            <surname>Bateman</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Rfam 11.0: 10 years of RNA families</bold>
        </article-title>
        <source>Nucleic Acids Res</source>
        <year>2013</year>
        <volume>41</volume>
        <issue>Database issue</issue>
        <fpage>226</fpage>
        <lpage>32</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gks1005</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sankoff</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Simultaneous solution of the RNA folding, alignment and protosequence problems</bold>
        </article-title>
        <source>SIAM J Appl Math</source>
        <year>1985</year>
        <volume>45</volume>
        <issue>5</issue>
        <fpage>810</fpage>
        <lpage>825</lpage>
        <pub-id pub-id-type="doi">10.1137/0145048</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gorodkin</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Heyer</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Stormo</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Finding the most significant common sequence and structure motifs in a set of RNA sequences</bold>
        </article-title>
        <source>Nucleic Acids Res</source>
        <year>1997</year>
        <volume>25</volume>
        <issue>18</issue>
        <fpage>3724</fpage>
        <lpage>32</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/25.18.3724</pub-id>
        <?supplied-pmid 9278497?>
        <pub-id pub-id-type="pmid">9278497</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mathews</surname>
            <given-names>DH</given-names>
          </name>
          <name>
            <surname>Turner</surname>
            <given-names>DH</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Dynalign: an algorithm for finding the secondary structure common to two RNA sequences</bold>
        </article-title>
        <source>J Mol Biol</source>
        <year>2002</year>
        <volume>317</volume>
        <issue>2</issue>
        <fpage>191</fpage>
        <lpage>203</lpage>
        <pub-id pub-id-type="doi">10.1006/jmbi.2001.5351</pub-id>
        <?supplied-pmid 11902836?>
        <pub-id pub-id-type="pmid">11902836</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Holmes</surname>
            <given-names>I</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Accelerated probabilistic inference of RNA structure evolution</bold>
        </article-title>
        <source>BMC Bioinformatics</source>
        <year>2005</year>
        <volume>6</volume>
        <fpage>73</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-6-73</pub-id>
        <?supplied-pmid 15790387?>
        <pub-id pub-id-type="pmid">15790387</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Havgaard</surname>
            <given-names>JH</given-names>
          </name>
          <name>
            <surname>Lyngso</surname>
            <given-names>RB</given-names>
          </name>
          <name>
            <surname>Stormo</surname>
            <given-names>GD</given-names>
          </name>
          <name>
            <surname>Gorodkin</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Pairwise local structural alignment of RNA sequences with sequence similarity less than 40%</bold>
        </article-title>
        <source>Bioinformatics</source>
        <year>2005</year>
        <volume>21</volume>
        <issue>9</issue>
        <fpage>1815</fpage>
        <lpage>24</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bti279</pub-id>
        <?supplied-pmid 15657094?>
        <pub-id pub-id-type="pmid">15657094</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dowell</surname>
            <given-names>RD</given-names>
          </name>
          <name>
            <surname>Eddy</surname>
            <given-names>SR</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Efficient pairwise RNA structure prediction and alignment using sequence alignment constraints</bold>
        </article-title>
        <source>BMC Bioinformatics</source>
        <year>2006</year>
        <volume>7</volume>
        <fpage>400</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-7-400</pub-id>
        <?supplied-pmid 16952317?>
        <pub-id pub-id-type="pmid">16952317</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bradley</surname>
            <given-names>RK</given-names>
          </name>
          <name>
            <surname>Pachter</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Holmes</surname>
            <given-names>I</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Specific alignment of structured RNA: stochastic grammars and sequence annealing</bold>
        </article-title>
        <source>Bioinformatics</source>
        <year>2008</year>
        <volume>24</volume>
        <issue>23</issue>
        <fpage>2677</fpage>
        <lpage>83</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btn495</pub-id>
        <?supplied-pmid 18796475?>
        <pub-id pub-id-type="pmid">18796475</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Harmanci</surname>
            <given-names>AO</given-names>
          </name>
          <name>
            <surname>Sharma</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Mathews</surname>
            <given-names>DH</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Efficient pairwise RNA structure prediction using probabilistic alignment constraints in Dynalign</bold>
        </article-title>
        <source>BMC Bioinformatics</source>
        <year>2007</year>
        <volume>8</volume>
        <fpage>130</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-8-130</pub-id>
        <?supplied-pmid 17445273?>
        <pub-id pub-id-type="pmid">17445273</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hofacker</surname>
            <given-names>IL</given-names>
          </name>
          <name>
            <surname>Bernhart</surname>
            <given-names>SH</given-names>
          </name>
          <name>
            <surname>Stadler</surname>
            <given-names>PF</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Alignment of RNA base pairing probability matrices</bold>
        </article-title>
        <source>Bioinformatics</source>
        <year>2004</year>
        <volume>20</volume>
        <issue>14</issue>
        <fpage>2222</fpage>
        <lpage>7</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bth229</pub-id>
        <?supplied-pmid 15073017?>
        <pub-id pub-id-type="pmid">15073017</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>McCaskill</surname>
            <given-names>JS</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>The equilibrium partition function and base pair binding probabilities for RNA secondary structure</bold>
        </article-title>
        <source>Biopolymers</source>
        <year>1990</year>
        <volume>29</volume>
        <issue>6-7</issue>
        <fpage>1105</fpage>
        <lpage>19</lpage>
        <pub-id pub-id-type="doi">10.1002/bip.360290621</pub-id>
        <?supplied-pmid 1695107?>
        <pub-id pub-id-type="pmid">1695107</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Torarinsson</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Havgaard</surname>
            <given-names>JH</given-names>
          </name>
          <name>
            <surname>Gorodkin</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Multiple structural alignment and clustering of RNA sequences</bold>
        </article-title>
        <source>Bioinformatics</source>
        <year>2007</year>
        <volume>23</volume>
        <issue>8</issue>
        <fpage>926</fpage>
        <lpage>32</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btm049</pub-id>
        <?supplied-pmid 17324941?>
        <pub-id pub-id-type="pmid">17324941</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bauer</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Klau</surname>
            <given-names>GW</given-names>
          </name>
          <name>
            <surname>Reinert</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Accurate multiple sequence-structure alignment of RNA sequences using combinatorial optimization</bold>
        </article-title>
        <source>BMC Bioinformatics</source>
        <year>2007</year>
        <volume>8</volume>
        <fpage>271</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-8-271</pub-id>
        <?supplied-pmid 17662141?>
        <pub-id pub-id-type="pmid">17662141</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Do</surname>
            <given-names>CB</given-names>
          </name>
          <name>
            <surname>Foo</surname>
            <given-names>C-S</given-names>
          </name>
          <name>
            <surname>Batzoglou</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>A max-margin model for efficient simultaneous alignment and folding of RNA sequences</bold>
        </article-title>
        <source>Bioinformatics</source>
        <year>2008</year>
        <volume>24</volume>
        <issue>13</issue>
        <fpage>68</fpage>
        <lpage>76</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btn177</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Heyne</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Will</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Beckstette</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Backofen</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Lightweight comparison of RNAs based on exact sequence-structure matches</bold>
        </article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>25</volume>
        <issue>16</issue>
        <fpage>2095</fpage>
        <lpage>2102</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btp065</pub-id>
        <?supplied-pmid 19189979?>
        <pub-id pub-id-type="pmid">19189979</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Backofen</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Siebert</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Fast detection of common sequence structure patterns in RNAs</bold>
        </article-title>
        <source>J Discrete Algorithms</source>
        <year>2007</year>
        <volume>5</volume>
        <issue>2</issue>
        <fpage>212</fpage>
        <lpage>228</lpage>
        <pub-id pub-id-type="doi">10.1016/j.jda.2006.03.015</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Höchsmann</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Töller</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Giegerich</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Kurtz</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Local similarity in RNA secondary structures</bold>
        </article-title>
        <source>
          <italic>Proceedings of Computational Systems Bioinformatics (CSB 2003). Volume 2</italic>
        </source>
        <year>2003</year>
        <publisher-loc>Washington</publisher-loc>
        <publisher-name>IEEE Computer Society</publisher-name>
        <fpage>159</fpage>
        <lpage>168</lpage>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Siebert</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Backofen</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>MARNA: multiple alignment and consensus structure prediction of RNAs based on sequence structure comparisons</bold>
        </article-title>
        <source>Bioinformatics</source>
        <year>2005</year>
        <volume>21</volume>
        <issue>16</issue>
        <fpage>3352</fpage>
        <lpage>9</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bti550</pub-id>
        <?supplied-pmid 15972285?>
        <pub-id pub-id-type="pmid">15972285</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Amit</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Backofen</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Heyne</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Landau</surname>
            <given-names>G. M</given-names>
          </name>
          <name>
            <surname>Möhl</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Otto</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Will</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Local exact pattern matching for non-fixed RNA structures</bold>
        </article-title>
        <source>IEEE/ACM Trans Comput Biol Bioinformatics</source>
        <year>2014</year>
        <volume>11</volume>
        <fpage>1</fpage>
        <lpage>12</lpage>
        <pub-id pub-id-type="doi">10.1109/TCBB.2013.2297113</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Schmiedl</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Möhl</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Heyne</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Amit</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Landau</surname>
            <given-names>G. M</given-names>
          </name>
          <name>
            <surname>Will</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Backofen</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Exact pattern matching for RNA structure ensembles</bold>
        </article-title>
        <source>
          <italic>Proceedings of the 16th International Conference on Research in Computational Molecular Biology (RECOMB 2012). LNCS, Volume 7262</italic>
        </source>
        <year>2012</year>
        <publisher-loc>Berlin Heidelberg</publisher-loc>
        <publisher-name>Springer</publisher-name>
        <fpage>245</fpage>
        <lpage>260</lpage>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wexler</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Zilberstein</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Ziv-Ukelson</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>A study of accessible motifs and RNA folding complexity</bold>
        </article-title>
        <source>J Comput Biol</source>
        <year>2007</year>
        <volume>14</volume>
        <issue>6</issue>
        <fpage>856</fpage>
        <lpage>72</lpage>
        <pub-id pub-id-type="doi">10.1089/cmb.2007.R020</pub-id>
        <?supplied-pmid 17691898?>
        <pub-id pub-id-type="pmid">17691898</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Ziv-Ukelson</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Gat-Viks</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Wexler</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Shamir</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <person-group person-group-type="editor">
          <name>
            <surname>Crandall</surname>
            <given-names>KA</given-names>
          </name>
          <name>
            <surname>Lagergren</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>A faster algorithm for RNA co-folding</bold>
        </article-title>
        <source>
          <italic>WABI 2008. Lecture Notes in Computer Science. Volume 5251</italic>
        </source>
        <year>2008</year>
        <publisher-loc>Berlin Heidelberg</publisher-loc>
        <publisher-name>Springer</publisher-name>
        <fpage>174</fpage>
        <lpage>185</lpage>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Backofen</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Tsur</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Zakov</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Ziv-Ukelson</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <person-group person-group-type="editor">
          <name>
            <surname>Kucherov</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Ukkonen</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Sparse RNA folding: Time and space efficient algorithms</bold>
        </article-title>
        <source>
          <italic>Proc. 20th Symp. Combinatorial Pattern Matching. LNCS, Volume 5577</italic>
        </source>
        <year>2009</year>
        <publisher-loc>Berlin Heidelberg</publisher-loc>
        <publisher-name>Springer</publisher-name>
        <fpage>249</fpage>
        <lpage>262</lpage>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39</label>
      <element-citation publication-type="book">
        <person-group person-group-type="editor">
          <name>
            <surname>Berger</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <source>
          <italic>Time and space efficient RNA-RNA interaction prediction via sparse folding</italic>
        </source>
        <year>2010</year>
        <publisher-loc>Berlin Heidelberg</publisher-loc>
        <publisher-name>Springer</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR40">
      <label>40</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Will</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Joshi</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Hofacker</surname>
            <given-names>IL</given-names>
          </name>
          <name>
            <surname>Stadler</surname>
            <given-names>PF</given-names>
          </name>
          <name>
            <surname>Backofen</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>LocARNA-P: Accurate boundary prediction and improved detection of structural RNAs</bold>
        </article-title>
        <source>RNA</source>
        <year>2012</year>
        <volume>18</volume>
        <issue>5</issue>
        <fpage>900</fpage>
        <lpage>14</lpage>
        <pub-id pub-id-type="doi">10.1261/rna.029041.111</pub-id>
        <?supplied-pmid 22450757?>
        <pub-id pub-id-type="pmid">22450757</pub-id>
      </element-citation>
    </ref>
    <ref id="CR41">
      <label>41</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Backofen</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Will</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Local sequence-structure motifs in RNA</bold>
        </article-title>
        <source>J Bioinformatics Comput Biol (JBCB)</source>
        <year>2004</year>
        <volume>2</volume>
        <issue>4</issue>
        <fpage>681</fpage>
        <lpage>698</lpage>
        <pub-id pub-id-type="doi">10.1142/S0219720004000818</pub-id>
      </element-citation>
    </ref>
    <ref id="CR42">
      <label>42</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Otto</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Will</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Backofen</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Structure local multiple alignment of RNA</bold>
        </article-title>
        <source>
          <italic>Proceedings of German Conference on Bioinformatics (GCB’2008). Lecture Notes in Informatics (LNI), Volume P-136</italic>
        </source>
        <year>2008</year>
        <publisher-loc>Gesellschaft für Informatik (GI)</publisher-loc>
        <publisher-name>Bonn</publisher-name>
        <fpage>178</fpage>
        <lpage>188</lpage>
      </element-citation>
    </ref>
    <ref id="CR43">
      <label>43</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bompfünewerer</surname>
            <given-names>AF</given-names>
          </name>
          <name>
            <surname>Backofen</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Bernhart</surname>
            <given-names>SH</given-names>
          </name>
          <name>
            <surname>Hertel</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Hofacker</surname>
            <given-names>IL</given-names>
          </name>
          <name>
            <surname>Stadler</surname>
            <given-names>PF</given-names>
          </name>
          <name>
            <surname>Will</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Variations on RNA folding and alignment: lessons from Benasque</bold>
        </article-title>
        <source>J Math Biol</source>
        <year>2008</year>
        <volume>56</volume>
        <issue>1-2</issue>
        <fpage>129</fpage>
        <lpage>144</lpage>
        <pub-id pub-id-type="doi">10.1007/s00285-007-0107-5</pub-id>
        <?supplied-pmid 17611759?>
        <pub-id pub-id-type="pmid">17611759</pub-id>
      </element-citation>
    </ref>
    <ref id="CR44">
      <label>44</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wilm</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Mainz</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Steger</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>An enhanced RNA alignment benchmark for sequence alignment programs</bold>
        </article-title>
        <source>Algorithms Mol Biol</source>
        <year>2006</year>
        <volume>1</volume>
        <fpage>19</fpage>
        <pub-id pub-id-type="doi">10.1186/1748-7188-1-19</pub-id>
        <?supplied-pmid 17062125?>
        <pub-id pub-id-type="pmid">17062125</pub-id>
      </element-citation>
    </ref>
    <ref id="CR45">
      <label>45</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gardner</surname>
            <given-names>PP</given-names>
          </name>
          <name>
            <surname>Wilm</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Washietl</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>A benchmark of multiple sequence alignment programs upon structural RNAs</bold>
        </article-title>
        <source>Nucleic Acids Res</source>
        <year>2005</year>
        <volume>33</volume>
        <issue>8</issue>
        <fpage>2433</fpage>
        <lpage>9</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gki541</pub-id>
        <?supplied-pmid 15860779?>
        <pub-id pub-id-type="pmid">15860779</pub-id>
      </element-citation>
    </ref>
    <ref id="CR46">
      <label>46</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cleveland</surname>
            <given-names>WS</given-names>
          </name>
        </person-group>
        <article-title>
          <bold>Lowess: A program for smoothing scatterplots by robust locally weighted regression</bold>
        </article-title>
        <source>Am Stat</source>
        <year>1981</year>
        <volume>35</volume>
        <fpage>(54)</fpage>
        <pub-id pub-id-type="doi">10.2307/2683591</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
