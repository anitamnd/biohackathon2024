<?DTDIdentifier.IdentifierValue article.dtd?>
<?DTDIdentifier.IdentifierType system?>
<?SourceDTD.DTDName article.dtd?>
<?SourceDTD.Version 1.0?>
<?ConverterInfo.XSLTName bmc2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">3499158</article-id>
    <article-id pub-id-type="publisher-id">1471-2105-13-252</article-id>
    <article-id pub-id-type="pmid">23020243</article-id>
    <article-id pub-id-type="doi">10.1186/1471-2105-13-252</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>QUAliFiER: An automated pipeline for quality assessment of gated flow cytometry data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" equal-contrib="yes" id="A1">
        <name>
          <surname>Finak</surname>
          <given-names>Greg</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <email>gfinak@fhcrc.org</email>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes" id="A2">
        <name>
          <surname>Jiang</surname>
          <given-names>Wenxin</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <email>wjiang2@fhcrc.org</email>
      </contrib>
      <contrib contrib-type="author" id="A3">
        <name>
          <surname>Pardo</surname>
          <given-names>Jorge</given-names>
        </name>
        <xref ref-type="aff" rid="I2">2</xref>
        <email>jpardo@immunetolerance.org</email>
      </contrib>
      <contrib contrib-type="author" id="A4">
        <name>
          <surname>Asare</surname>
          <given-names>Adam</given-names>
        </name>
        <xref ref-type="aff" rid="I2">2</xref>
        <email>aasare@immunetolerance.org</email>
      </contrib>
      <contrib contrib-type="author" corresp="yes" id="A5">
        <name>
          <surname>Gottardo</surname>
          <given-names>Raphael</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <xref ref-type="aff" rid="I3">3</xref>
        <email>rgottard@fhcrc.org</email>
      </contrib>
    </contrib-group>
    <aff id="I1"><label>1</label>Fred Hutchinson Cancer Research Center, 1100 Fairview Avenue North, Seattle, WA 98109, USA</aff>
    <aff id="I2"><label>2</label>Tolerance Assays and Data Analysis, the Immune Tolerance Network, University of California, San Francisco, 3 Bethesda Metro Center, Bethesda, 20814, MD, USA</aff>
    <aff id="I3"><label>3</label>Department of Statistics, University of Washington, Box 354322, Seattle, 98195, WA, USA</aff>
    <pub-date pub-type="collection">
      <year>2012</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>28</day>
      <month>9</month>
      <year>2012</year>
    </pub-date>
    <volume>13</volume>
    <fpage>252</fpage>
    <lpage>252</lpage>
    <history>
      <date date-type="received">
        <day>12</day>
        <month>4</month>
        <year>2012</year>
      </date>
      <date date-type="accepted">
        <day>20</day>
        <month>9</month>
        <year>2012</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Copyright ©2012 Finak et al.; licensee BioMed Central Ltd.</copyright-statement>
      <copyright-year>2012</copyright-year>
      <copyright-holder>Finak et al.; licensee BioMed Central Ltd.</copyright-holder>
      <license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/2.0">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (
<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/2.0">http://creativecommons.org/licenses/by/2.0</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="http://www.biomedcentral.com/1471-2105/13/252"/>
    <abstract>
      <sec>
        <title>Background</title>
        <p>Effective quality assessment is an important part of any high-throughput flow cytometry data analysis pipeline, especially when considering the complex designs of the typical flow experiments applied in clinical trials. Technical issues like instrument variation, problematic antibody staining, or reagent lot changes can lead to biases in the extracted cell subpopulation statistics. These biases can manifest themselves in non–obvious ways that can be difficult to detect without leveraging information about the study design or other experimental metadata. Consequently, a systematic and integrated approach to quality assessment of flow cytometry data is necessary to effectively identify technical errors that impact multiple samples over time. Gated cell populations and their statistics must be monitored within the context of the experimental run, assay, and the overall study.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p>We have developed two new packages, <bold>flowWorkspace</bold> and <bold>QUAliFiER</bold> to construct a pipeline for quality assessment of gated flow cytometry data. <bold>flowWorkspace</bold> makes manually gated data accessible to BioConductor’s computational flow tools by importing pre–processed and gated data from the widely used manual gating tool, <bold>FlowJo</bold> (Tree Star Inc, Ashland OR). The <bold>QUAliFiER</bold> package takes advantage of the manual gates to perform an extensive series of statistical quality assessment checks on the gated cell sub–populations while taking into account the structure of the data and the study design to monitor the consistency of population statistics across staining panels, subject, aliquots, channels, or other experimental variables. <bold>QUAliFiER</bold> implements SVG–based interactive visualization methods, allowing investigators to examine quality assessment results across different views of the data, and it has a flexible interface allowing users to tailor quality checks and outlier detection routines to suit their data analysis needs.</p>
      </sec>
      <sec>
        <title>Conclusion</title>
        <p>We present a pipeline constructed from two new R packages for importing manually gated flow cytometry data and performing flexible and robust quality assessment checks. The pipeline addresses the increasing demand for tools capable of performing quality checks on large flow data sets generated in typical clinical trials. The <bold>QUAliFiER</bold> tool objectively, efficiently, and reproducibly identifies outlier samples in an automated manner by monitoring cell population statistics from gated or ungated flow data conditioned on experiment–level metadata.</p>
      </sec>
    </abstract>
    <kwd-group>
      <kwd>Flow cytometry</kwd>
      <kwd>Quality assessment</kwd>
      <kwd>BioConductor package</kwd>
    </kwd-group>
  </article-meta>
</front>
<body>
  <sec>
    <title>Background</title>
    <p>Flow cytometry (FCM) is a high-throughput technology that offers rapid quantification of a set of physical and chemical characteristics for a large number of cells in a sample. The technology is widely used in health research and treatment, including for monitoring of infection, diagnosis of cancers like lymphoma and leukaemia, and auto–immune diseases
[<xref ref-type="bibr" rid="B1">1</xref>-<xref ref-type="bibr" rid="B9">9</xref>]. It is also used for cross-matching organs for transplantation and in research involving stem cells, vaccine development, apoptosis, phagocytosis, and a wide range of cellular properties including phenotype, cytokine expression, and cell-cycle status
[<xref ref-type="bibr" rid="B10">10</xref>-<xref ref-type="bibr" rid="B15">15</xref>]. Importantly, clinical trials in these fields often use flow cytometry to monitor the immune system or the progression of a disease over time, generating large amounts of data in the process.</p>
    <p>Variation in instrumentation, antibody staining, reagent lots, and other technical problems can crop up over time and manifest themselves as biases in the extracted cell subpopulation statistics or fluorescence intensities. Such errors are neither obvious nor easy to detect via the examinations of dot plot outputs from individual FCS files that are performed as part of regular, daily quality control procedures in a flow cytometry core. Careful and systematic examination of gated populations over time and in the context of the larger study design together with follow–up analysis of experimental metadata is often necessary to identify the problematic samples as well as the underlying cause of the bias (i.e. a reagent change). There is currently a paucity of tools to help investigators effectively and systematically perform quality assessment on large and complex flow cyotmetry data sets
[<xref ref-type="bibr" rid="B16">16</xref>-<xref ref-type="bibr" rid="B18">18</xref>].</p>
    <sec>
      <title>Existing Tools</title>
      <p><bold>BioConductor</bold> provides a suite of open-source tools and software infrastructure to analyze FCM and other high–throughput data
[<xref ref-type="bibr" rid="B18">18</xref>,<xref ref-type="bibr" rid="B19">19</xref>]. The core of this tool set includes <bold>flowCore</bold>, <bold>flowViz</bold>, <bold>flowQ</bold>, and <bold>flowStats</bold>, which together provide functionality for basic data manipulation, visualization, automated gating, and some basic quality control
[<xref ref-type="bibr" rid="B18">18</xref>,<xref ref-type="bibr" rid="B20">20</xref>,<xref ref-type="bibr" rid="B21">21</xref>]. The <bold>flowQ</bold> package provides high–level quality control procedures for ungated FCM data using statistical approaches to detect disturbances or unusual patterns in the signals of each channel during acquisition
[<xref ref-type="bibr" rid="B9">9</xref>]. However, the package is restricted to global measures of quality, as it can only handle ungated data and cannot leverage the complex metadata associated with the larger structure of an FCM study (<italic>e.g.</italic> monitoring the stability of common fluorescence markers in different staining panels of a longitudinal study, or monitoring the variability of gated cell populations across aliquots of a sample).</p>
      <p>In order to perform quality assessment of manually gated data, the manual gates and gated data must be accessible to the computational framework for quality assessment. One of the most popular software packages for performing manual FCM gating is <bold>FlowJo</bold> (Tree Star Inc, Ashland, OR). This tool generates “workspace” files in XML format that define the preprocessing and gating applied to a set of FCS files. Currently, the <bold>flowFlowJo</bold> package provides some limited support for importing manually gated data into R from workspace files generated by older Windows–only versions of the software (i.e. FlowJo for Windows version 7.x). However, it does not support workspaces generated by newer versions of <bold>FlowJo</bold> (&gt; version 7), or workspaces generated by <bold>FlowJo</bold> for Mac OS X. Importantly, <bold>flowFlowJo</bold> does not correctly handle <bold>FlowJo</bold>’s specific biexponential data transformation and it is limited to manipulating small data sets that can fit in the available physical memory of the computer
[<xref ref-type="bibr" rid="B22">22</xref>]. Thus large, real–world FCM data sets generated in clinical studies and data sets analyzed using recent versions of the <bold>FlowJo</bold> or other manual gating tools remain inaccessible to users of BioConductor’s flow tools.</p>
      <p>To address these issues, we have developed two new BioConductor packages: <bold>flowWorkspace</bold> and <bold>QUAliFiER</bold> (QUality Assessent for Flow ExpeRiments). <bold>flowWorkspace</bold> makes manually gated data from large, arbitrarily complex FCM studies accessible in the R environment. It imports compensation matrices, data transformations, manual gates, and FCS files from analyses described in <bold>FlowJo</bold> workspaces (supports workspaces generated by <bold>FlowJo</bold> for Mac OS X and Windows), and reproduces them using the BioConductor flow toolset, thus making manually gated data accessible to the computational flow community. The tool has methods implemented for visualizing, summarizing, extracting and exporting population statistics for gated cell populations. Importantly, the tool can handle large FCM data sets through support of NetCDF via the <bold>ncdfFlow</bold> package
[<xref ref-type="bibr" rid="B23">23</xref>,<xref ref-type="bibr" rid="B24">24</xref>]. <bold>flowWorkspace</bold> can also be used to export data to the LabKey (Seattle, WA) tool, allowing one to use R as the engine for flow data analysis with a LabKey front end and data repository
[<xref ref-type="bibr" rid="B16">16</xref>,<xref ref-type="bibr" rid="B17">17</xref>]. The package is closely integrated with other BioConductor flow tools, including normalization via the <bold>flowStats</bold> package and quality control using <bold>QUAliFiER</bold>[<xref ref-type="bibr" rid="B20">20</xref>]. <bold>flowWorkspace</bold> makes manually gated flow cytometry data of arbitrarily large size (provided enough disk space is available) accessible for analysis using BioConductor’s flow tools, so that new or automated data analysis strategies can be rapidly compared against current best–practices manual gating methods.</p>
      <p>The <bold>QUAliFiER</bold> package uses <bold>flowWorkspace</bold> to import the manual gates defined in the <bold>FlowJo</bold> workspace and calculates summary statistics from each gated cell population. The tool also takes advantage of study metadata describing different samples, aliquots, staining panels and other experimental information to identify outlier samples and cell populations with respect to user–defined grouping variables. For example, the tool can be used to detect instrument variability or changes in reagent quality by monitoring the stability of fluorescence intensities across all samples over the time span of an entire study. These can be monitored in individual channels or in specific cell subpopulations. Another example is use of <bold>QUAliFiER</bold> to assess the consistency of gating specific cell populations in all samples in a study by monitoring the consistency of population statistics for samples derived from a common aliquot and performing outlier detection on cell population frequencies grouped by sample, conditional on the aliquot study metadata. The examples mentioned above are not exhaustive, and QUAliFiER is a general, flexible framework for performing quality assessment flow data that integrates gating information with study–level metadata for each sample. A comparison of the Quality Assurance features available in <bold>flowQ</bold>, <bold>FlowJo</bold>, and <bold>QUAliFiER</bold> is shown in Table
<xref ref-type="table" rid="T1">1</xref>.</p>
      <table-wrap position="float" id="T1">
        <label>Table 1</label>
        <caption>
          <p>Comparison of Quality Assurance Functions Available in FlowJo, flowQ, and QUAliFiER</p>
        </caption>
        <table frame="hsides" rules="groups" border="1">
          <colgroup>
            <col align="justify"/>
            <col align="center"/>
            <col align="center"/>
            <col align="right"/>
          </colgroup>
          <thead valign="top">
            <tr>
              <th align="left" valign="bottom"> <hr/></th>
              <th colspan="3" align="center" valign="bottom">
                <bold>Software package</bold>
                <hr/>
              </th>
            </tr>
            <tr>
              <th align="justify">
                <bold>Feature</bold>
              </th>
              <th align="center">
                <bold>FlowJo</bold>
                <sup>
                  <bold>1†</bold>
                </sup>
              </th>
              <th align="center">
                <bold>flowQ</bold>
              </th>
              <th align="right">
                <bold>QUAliFiER@</bold>
              </th>
            </tr>
          </thead>
          <tbody valign="top">
            <tr>
              <td align="justify" valign="bottom">QA Across Multiple Experiments<hr/></td>
              <td align="center" valign="bottom"> <hr/></td>
              <td align="center" valign="bottom"> <hr/></td>
              <td align="right" valign="bottom"><italic>✓</italic>@<hr/></td>
            </tr>
            <tr>
              <td align="justify" valign="bottom">QA Ungated Data<hr/></td>
              <td align="center" valign="bottom"> <hr/></td>
              <td align="center" valign="bottom">
                <italic>✓</italic>
                <hr/>
              </td>
              <td align="right" valign="bottom"><italic>✓</italic>@<hr/></td>
            </tr>
            <tr>
              <td align="justify" valign="bottom">QA Gated Data<hr/></td>
              <td align="center" valign="bottom"> <hr/></td>
              <td align="center" valign="bottom"> <hr/></td>
              <td align="right" valign="bottom"><italic>✓</italic>@<hr/></td>
            </tr>
            <tr>
              <td align="justify" valign="bottom">Interactive HTML QA Report<hr/></td>
              <td align="center" valign="bottom"> <hr/></td>
              <td align="center" valign="bottom">
                <italic>✓</italic>
                <hr/>
              </td>
              <td align="right" valign="bottom"><italic>✓</italic>@<hr/></td>
            </tr>
            <tr>
              <td align="justify" valign="bottom">Use Study Metadata as Grouping Variables for QA<hr/></td>
              <td align="center" valign="bottom"> <hr/></td>
              <td align="center" valign="bottom"> <hr/></td>
              <td align="right" valign="bottom"><italic>✓</italic>@<hr/></td>
            </tr>
            <tr>
              <td align="justify" valign="bottom">Customizable QA tasks<hr/></td>
              <td align="center" valign="bottom"> <hr/></td>
              <td align="center" valign="bottom"> <hr/></td>
              <td align="right" valign="bottom"><italic>✓</italic>@<hr/></td>
            </tr>
            <tr>
              <td align="justify" valign="bottom">Customizable outlier detection<hr/></td>
              <td align="center" valign="bottom"> <hr/></td>
              <td align="center" valign="bottom"> <hr/></td>
              <td align="right" valign="bottom"><italic>✓</italic>@<hr/></td>
            </tr>
            <tr>
              <td align="justify">Automated for pipelined analysis</td>
              <td align="center"> </td>
              <td align="center">
                <italic>✓</italic>
              </td>
              <td align="right"><italic>✓</italic>@</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <p><sup>†</sup>Although <bold>FlowJo</bold> does not have internal QA tools, it can export arbitrary population statistics in csv format that may be analyzed in other software.</p>
        </table-wrap-foot>
      </table-wrap>
    </sec>
    <sec>
      <title>Implementation</title>
      <sec>
        <title>Definitions</title>
        <p>In the remainder of the paper we use <bold>bold face</bold> type to refer to <bold>software packages</bold> and <monospace>teletype font</monospace> to refer to <monospace>object, classes, and functions</monospace> in the packages.</p>
      </sec>
      <sec>
        <title>Integration</title>
        <p>Both packages make use of R’s S4 programming system to define classes and methods, adopting a formal object-oriented paradigm in their implementations
[<xref ref-type="bibr" rid="B25">25</xref>]. The packages are integrated with the larger flow cytometry package infrastructure available through <bold>BioConductor</bold>. <bold>flowWorkspace</bold> is integrated with the <bold>BioConductor</bold> core flow packages, including <bold>flowCore</bold> for support of the full range of operations on flow data including compensation, transformation, and gating, large data set support through <bold>ncdfFlow</bold> and visualization and plotting through <bold>flowViz</bold>. The <bold>QUAliFiER</bold> package takes advantage of manual gates available through <bold>flowWorkspace</bold> to perform quality assessment of both the gated and ungated FCM data, and produces visualizations of samples flagged as outliers for the further investigation through the <bold>flowViz</bold> package.</p>
      </sec>
      <sec>
        <title>flowWorkspace</title>
        <p><bold>flowWorkspace</bold> makes use of R’s <bold>XML</bold> package and the <italic>xpath</italic> query language to parse and import <bold>FlowJo</bold> XML workspaces (FlowJo for Mac OS X, versions 7.0 and greater<sup>1</sup>)
[<xref ref-type="bibr" rid="B26">26</xref>,<xref ref-type="bibr" rid="B27">27</xref>]. The package reads in the list of samples, data transformations, compensation matrices, and gates associated with each sample in a workspace and constructs associated <bold>flowCore</bold> objects. The package implements two new data structures to represent this information: the <monospace>GatingHierarchy</monospace> and the <monospace>GatingSet</monospace>. As the name implies, the GatingHierarchy represents the set of hierarchical gates applied to an individual sample. The <monospace>GatingSet</monospace> represents a collection of gated samples from the workspace, analogous to grouped samples in <bold>FlowJo</bold><sup>2</sup>. However, the design is sufficiently flexible to represent manually gated data coming from any external tool. Each <monospace>GatingHierarchy</monospace> is formally a tree data structure associated with a single FCS file, a set of data transformations applied to the channels of the FCS file (these can differ between samples), a compensation matrix (another flow cytometry specific transformation), and a set of gates (boundaries defining distinct cell populations). Each node of the <monospace>GatingHierarchy</monospace> tree represents a cell subpopulation in the sample associated with a <bold>flowCore</bold> gate stored at that node. To save space, <bold>flowWorkspace</bold> stores only one copy of the data together with a bit mask representing the events in the sample that are included in each gate.</p>
        <p>The data import and gating steps are logically separated, allowing the user to import the workspace without necessarily performing the gating of the data. The package implements parallel import of workspaces using the <bold>parallel</bold> R package, and parallel gating over samples in a workspace using MPI (message passing interface) functionality from the <bold>Rmpi</bold> package
[<xref ref-type="bibr" rid="B28">28</xref>-<xref ref-type="bibr" rid="B30">30</xref>]. The package is available through <bold>BioConductor</bold><ext-link ext-link-type="uri" xlink:href="http://www.bioconductor.org/packages/2.10/bioc/html/flowWorkspace.html">http://www.bioconductor.org/packages/2.10/bioc/html/flowWorkspace.html</ext-link>.</p>
      </sec>
      <sec>
        <title>QUAliFiER</title>
        <p>The <bold>QUAliFiER</bold> tool makes use of a local database to store and access extracted cell population statistics from multiple experimental runs (<italic>i.e.</italic> imported <bold>FlowJo</bold> workspaces), as well as study metadata, and resulting outlier calls, allowing QA tasks to span multiple experiments performed in the course of a larger study. The <monospace>getQAStats</monospace> function extracts cell population statistics from each sample and gated population defined in a <monospace>GatingSet</monospace> and stores them in the local database. The basic quality assessment functionality is defined by the <monospace>qaTask</monospace> class, which is a general container that regroups all the information essential to perform a particular quality assessment task. The user pre–defines <monospace>qaTask</monospace>s via an external configuration file or directly in an R script that runs the quality assessment procedure, and these are evaluated using the core <monospace>qaCheck</monospace> method. This method performs the actual quality assessment for each QA task. Methods for outlier detection, and the specific details of each quality assessment task are all contained in the <monospace>qaTask</monospace> object and can be defined by the user or can use any of the pre–defined outlier detection functions or qaTask objects. To visualize the quality assessment results, several <monospace>plot</monospace> methods have been implemented including methods for generating dot plots or density plots of gates across samples, and scatterplots or boxplots of population statistics grouped by user–defined or experimental metadata grouping variables. Finally, <monospace>qa.report</monospace> collates the generated <monospace>qaTask</monospace>s and generates HTML reports with interactive SVG (support vector graphics) graphics and plots for all quality assessment tasks. The package is implemented entirely in <italic>R</italic>, is publicly available on Github as well as <bold>BioConductor</bold>. (
<ext-link ext-link-type="uri" xlink:href="http://mikejiang.github.com/QUALIFIER/">http://mikejiang.github.com/QUALIFIER/</ext-link>,
<ext-link ext-link-type="uri" xlink:href="http://bioconductor.org/packages/2.10/bioc/html/QUALIFIER.html">http://bioconductor.org/packages/2.10/bioc/html/QUALIFIER.html</ext-link>).</p>
      </sec>
    </sec>
  </sec>
  <sec>
    <title>Results and Discussion</title>
    <sec>
      <title/>
      <sec>
        <title>Dataset Description</title>
        <p>We present an application of our pipeline to a subset (3000 FCS files) of a large study from the ITN (Immune Tolerance Network) monitoring immunosuppression withdrawal in paediatric recipients of living donor liver transplants
[<xref ref-type="bibr" rid="B31">31</xref>].</p>
      </sec>
    </sec>
    <sec>
      <title>The QUAliFiER Workflow</title>
      <p>The workflow involved in using <bold>QUAliFiER</bold> is relatively straightforward. It involves importing the data, extracting cell population statistics, defining QA tasks, performing outlier calling, and then generating an quality assessment report. The first three steps are handled by the <monospace>QUALIFIER</monospace> function, which essentially combines the different pieces of information necessary to perform QA on a dataset. A more detailed description of these steps follows.</p>
      <sec>
        <title>Importing the QA gating template with flowWorkspace</title>
        <p>The code for running the following and other examples can be found in the package source at
<ext-link ext-link-type="uri" xlink:href="http://mikejiang.github.com/QUALIFIER">http://mikejiang.github.com/QUALIFIER</ext-link>.</p>
        <p>The <bold>flowWorkspace</bold> package is used to import the gating template from the <bold>FlowJo</bold> workspace for the ITN study dataset into R. Note that although the workflow presented here uses template gates, the approach can be applied without loss of generality to any set of samples that has been gated in the same manner (i.e. where corresponding populations can be identified across samples). This template includes the set of hierarchical manual gates that identify all the cell sub-poplulations of interest for QA (Figure
<xref ref-type="fig" rid="F1">1</xref>A). A call to <monospace>openWorkspace</monospace> creates a <monospace>flowJoWorkspace</monospace> object from the XML workspace file, then <monospace>parseWorkspace</monospace> reads the template and constructs the necessary R–level objects for the gates, compensation matrices, and data transformations, and optionally reads in the FCS files and performs the preprocessing and gating while calculating the population statistics for each gated cell population. The results for each FCS file are stored in an object of the <monospace>GatingHierarchy</monospace> class, with multiple files regrouped in a <monospace>GatingSet</monospace> object. This is the object which is ultimately passed on to the <bold>QUAliFiER</bold> package.</p>
        <fig id="F1" position="float">
          <label>Figure 1</label>
          <caption>
            <p><bold>Functionality of flowWorkspace applied to the QA template gating hierarchy of the test data in the QUAliFiER pipeline.</bold> Functionality of flowWorkspace applied to the QA template gating hierarchy of the test data in the <bold>QUAliFiER</bold> pipeline. <bold>A</bold>) The design of flowWorkspace and its interface with <bold>QUAliFiER</bold>, <bold>FlowJo</bold> and <bold>BioConductor</bold>. <bold>B</bold>) The gating hierarchy for the first sample in the test workspace imported by <bold>flowWorkspace</bold> and displayed via <monospace>plot</monospace>. The names of the QA gates defined in the <bold>FlowJo</bold> workspace for the gating template are displayed. This gating template was designed for performing quality assessment of flow data from the ITN (Immune Tolerance Network). MNC is a mononuclear cell gate. WBC_perct is a white blood cell gate. Gates on specific channels with MFI and margin are for detecting the positive populations and boundary events, respectively in each channel. <bold>C</bold>) Agreement between imported population statistics computed using <bold>flowWorkspace</bold> and statistics computed from <bold>FlowJo</bold>, measured via the coefficient of variation between the two values. Slight deviations are due to FlowJo’s discretization of the data transformation function, which must be interpolated by flowWorkspace. Overall the CV is fractions of a percent, indicating successful import. <bold>D</bold>) Example of the dot plots generated by flowWorkspace to visualize gated populations.</p>
          </caption>
          <graphic xlink:href="1471-2105-13-252-1"/>
        </fig>
        <p>The gating hierarchy for any sample can be inspected via <monospace>plot</monospace> (Figure
<xref ref-type="fig" rid="F1">1</xref>B) and the success of the import procedure verified via the concordance of the imported cell counts against FlowJo’s cell counts using <monospace>plotPopCV</monospace> (Figure
<xref ref-type="fig" rid="F1">1</xref>C). Slight discrepancies (a few fractions of a percent in the coefficient of variation) are due to FlowJo’s quantization of the data transformation function, which must be interpolated by <bold>flowWorkspace</bold>. Larger CVs may either indicate errors in the import process or small (containing few cells) populations where differences of two or three cells between the computed and imported counts result in a large coefficient of variation. Individual gates and samples can be visualized with the <monospace>plotGate</monospace> function (Figure
<xref ref-type="fig" rid="F1">1</xref>D) to inspect populations flagged with a large coefficient of variation. Importantly, these statistics and plots can be exported (via <monospace>ExportTSVAnalysis</monospace>) to the LabKey tool, which provides a web–based front–end for visualizing gated flow cytometry data
[<xref ref-type="bibr" rid="B16">16</xref>,<xref ref-type="bibr" rid="B17">17</xref>].</p>
      </sec>
      <sec>
        <title>Extracting population statistics</title>
        <p>After importing the data from <bold>FlowJo</bold>, <bold>QUAliFiER</bold> extracts population statistics from the <monospace>GatingSet</monospace> (internally via the <monospace>getQAStats</monospace> function), and stores them in a local database. Subsequent quality assessment makes use of this database to rapidly query and manipulate the data. <bold>QUAliFiER</bold> can apply filters to the population statistics and perform outlier calls based on grouping and conditioning variables defined in the associated study metadata. Each quality assessment task is defined in a <monospace>qaTask</monospace> object. The details for all the <monospace>qaTask</monospace>s are provided in a qaTask definition file (described below), whereas the study metadata is supplied as an associated comma separated value file. This file associates each FCS data file with study metadata (e.g. subject, date, dose, aliquot, and so forth). The <monospace>GatingSet</monospace>, qaTask definition file, study metadata file, and database connection are passed to the <monospace>qaPreprocess()</monospace> function, which does the work of extracting and combining the relevant information from each source into a coherent data structure. Importantly, the <bold>QUAliFiER</bold> package could be used to QA any manually gated data file format supported by <bold>flowWorkspace</bold> and is not limited to the template gating QA process highlighted here. Additionally, <bold>QUAliFiER</bold> could be used in a stand-alone fashion to perform QA on a set of extracted cell-population statistics and study metadata. <bold>flowWorkspace</bold> acts to simplify access to extracted statistics, but is not strictly required for use with <bold>QUAliFiER</bold>.</p>
      </sec>
      <sec>
        <title>Defining qaTasks</title>
        <p>A <monospace>qaTask</monospace> defines a specific quality assessment procedure and requires the following information: </p>
        <p>1. The specific cell population or gate for QA.</p>
        <p>2. The cell population statistic (i.e. counts or proportion) to QA.</p>
        <p>3. The metadata variables for stratification and outlier calling.</p>
        <p>4. How to present the data to the user (i.e. plot type).</p>
        <p>The <monospace>qaTask</monospace> class is a general container that allow users to define different <italic>quality assessment</italic> tasks using the information above. The class uses R’s familiar <italic>formula</italic> interface as a compact and flexible description of the QA task. Briefly, it is generally of the form
<inline-formula><mml:math id="M1" name="1471-2105-13-252-i1" overflow="scroll"><mml:mi>y</mml:mi><mml:mo>∼</mml:mo><mml:mi>x</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>∗</mml:mo><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>∗</mml:mo><mml:mo>…</mml:mo><mml:mspace width="0.3em"/></mml:math></inline-formula>, where <italic>y</italic> is the population statistic to monitor and takes four possible values: </p>
        <p>• <italic>MFI</italic>: Median or Mean Fluorescence Intensity of the cell population (the mean or median is user–defined).</p>
        <p>• <italic>proportion</italic>: The percent of the parent population represented by the population being QC’d.</p>
        <p>• <italic>count</italic>: The number of events in the cell population.</p>
        <p>• <italic>spike</italic>: Applicable to each channel of an FCS file measured over the acquisition time. A windowed, cumulative Z–score that quantifies spikes in the MFI of a channel over the acquisition time of the sample. In the absence of spikes, this is approximately zero.</p>
        <p>In the right hand side of the formula, <italic>x</italic> specifies the x–axis variable for plotting. It can be any variable defined in the associated study metadata such as date or sample id. Variables on the right of the vertical bar represent <italic>conditioning</italic> variables used to stratify the population statistics for outlier detection. These also must appear in the study metadata. Outlier detection is performed within each level of the cross product of the grouping variables. If these are omitted, then outlier detection is performed on the entire set of samples.</p>
        <p>The <monospace>qaTask</monospace> also requires a <italic>plot type</italic> to be specified. This can be any of the standard lattice plot types, such as <monospace>xyplot</monospace> or <monospace>bwplot</monospace>. The plot type defines how the data will be summarized and presented to the user. <bold>QUAliFiER</bold> defines some default <monospace>qaTasks</monospace> such as monitoring the stability of the MFI for a channel over time, or monitoring the variation in the percentage of a cell population within and across aliquots (Figures
<xref ref-type="fig" rid="F2">2</xref> and
<xref ref-type="fig" rid="F3">3</xref>).</p>
        <fig id="F2" position="float">
          <label>Figure 2</label>
          <caption>
            <p><bold>QA result of of MFI stability vs time for the FITC channel.</bold> We can see clear examples where the MFI is not stable over time, i.e. it is either increasing (HLADR, CD8, CD11c), or decreasing (LD). Some stains show residuals that are not normally distributed, suggesting non-linear trends (HLADR, CD8, CD57), while others are generally stable with the occasional sample outlier (CD1c, IgG1, 6B11). The formula used to generate the plot is: <italic>MFI</italic>∼<italic>RecdDt</italic>|<italic>channel</italic>∗<italic>stain</italic>, where the MFI is plotted against RecdDt, the date the sample was run, which is defined in the study metadata. Channel and stain are generated upon parsing the workspace. Outlier calls are done within each combination of channel and stain. An additional argument to <monospace>plot(..,subset=channel='FITC',..)</monospace> tells the function to plot only the output for the <italic>FITC</italic> channel. The population for this <monospace>qaTask</monospace> is the population, <italic>MFI</italic>, which selects all MFI gates.</p>
          </caption>
          <graphic xlink:href="1471-2105-13-252-2"/>
        </fig>
        <fig id="F3" position="float">
          <label>Figure 3</label>
          <caption>
            <p><bold>Consistency of the mononuclear cell gate across aliquots.</bold> The plot shows the consistency of the MNC population across aliquots (<italic>coresampleid</italic>). The plot type is <italic>bwplot</italic>, and the formula for generating this output is <italic>coresampleid</italic>∼<italic>proportion</italic>, while the <monospace>qaCheck</monospace> was generated with <italic>proportion</italic>∼<italic>coresampleid</italic>. Additional lattice plot arguments to generate a vertical boxplot layout are passed through the <monospace>@par</monospace> slot of the <monospace>qaTask</monospace> object. Note that there is no stratification variable. The <italic>bwplot</italic> plot type implies a grouping using the <italic>coresampleid</italic> variable (defined in the study metadata). Boxplots are generated for each level of <italic>coresampleid</italic> and outlier calls (red boxes and points) are made within each group as well as between groups (i.e., identifying groups with larger than expected variability). The population for this <monospace>qaTask</monospace> is <italic>MNC</italic>, the mononuclear cell gate.</p>
          </caption>
          <graphic xlink:href="1471-2105-13-252-3"/>
        </fig>
        <p>The cell population to be monitored by the <monospace>qaTask</monospace> is passed as a name to the <monospace>pop</monospace> argument of the <monospace>qaTask</monospace> constructor. All of this information (the formula, population name, plot type, and other details) can be provided for all the qaTasks to be performed on a data set via an external csv file passed to the <monospace>qaPreprocess</monospace> function. Internally, the <monospace>makeQaTask</monospace> function can read a set of these task definitions from the csv file and construct all the <monospace>qaTask</monospace> objects simultaneously. Users may also create individual <monospace>qaTask</monospace>s directly via the <monospace>new</monospace> method.</p>
      </sec>
      <sec>
        <title>Aggregate QA populations</title>
        <p>The population name defining a <monospace>qaTask</monospace> generally refers to a unique gated cell population, either via the terminal gate name (e.g. “WBC_perct”), or via a unique gating path (e.g. “/MNC/FITC-A MFI”) (Figure
<xref ref-type="fig" rid="F1">1</xref>B). <bold>QUAliFiER</bold> also supports aggregating populations using common portions of gate names (e.g. “MFI” or “margin”) (Figure
<xref ref-type="fig" rid="F1">1</xref>B). The tool supports regular expression and substring matching to select multiple, non–unique cell populations for QA assessment. In this way, the population “MFI” selects all five terminal populations matching the string “MFI”, which can then be visualized simultaneously in separate plot panels, with each panel representing a different <italic>channel</italic>, as defined in the formula (see Figure
<xref ref-type="fig" rid="F2">2</xref>). Aggregating multiple cell populations in this way for quality assessment provides further flexibility to tailor the quality checks to the needs of the user. This aggregate approach is used throughout the template gates applied to the sample data set in this paper.</p>
      </sec>
      <sec>
        <title>Outlier Detection and Visualization</title>
        <p>Once data is imported and quality assessment tasks are defined, the <monospace>qaCheck</monospace> and <monospace>plot</monospace> methods perform the quality assessment and visualization based on the definitions stored in each <monospace>qaTask</monospace> object.</p>
        <p>The actual outlier calls are performed by the <monospace>qaCheck</monospace> method. The method reads the population statistics from the database and performs outlier detection within the groups defined in the <italic>formula</italic>. The <monospace>qaCheck</monospace> method can accept a default or user–defined outlier detection function.</p>
        <p>The package defines several outlier functions for general use in common QA tasks. These are summarized in Table
<xref ref-type="table" rid="T2">2</xref>. Briefly, the <monospace>outlier.cutoff</monospace> function is used to call outliers based on a threshold value of the statistic. The <monospace>outlier.norm</monospace> function is used for outlier detection in most QA tasks. It models the data within each group using a normal distribution with a robust estimate of the mean and variance. Outlier calls are made based on a threshold, <italic>α </italic>(significance level) or a Z–score cutoff, either of which can be provided as an argument to the function, which also allows for one or two–sided tests. If the <italic>plot type</italic> is <monospace>bwplot</monospace> (box plot), then <monospace>outlier.norm</monospace> is used to call between–group outliers (i.e. boxes with a larger than expected variation) with a default Z–score cutoff of 3, based on the distribution of the log–transformed IQRs (Interquartile ranges) of the groups. If the <italic>plot type</italic> is <monospace>xyplot</monospace>, the user can add a regression line to the plot via <italic>rFunc</italic> argument (defaults to <italic>rlm</italic> robust regression). Individual observations are flagged as outliers based on the residuals. <monospace>qoutlier</monospace> implements the default box–plot outlier detection algorithm for outlier calls within groups for any observation beyond ± 1.5 × IQR for the group.</p>
        <table-wrap position="float" id="T2">
          <label>Table 2</label>
          <caption>
            <p>Summary of outlier detection methods in the QUAliFiER package</p>
          </caption>
          <table frame="hsides" rules="groups" border="1">
            <colgroup>
              <col align="left"/>
              <col align="center"/>
              <col align="left"/>
            </colgroup>
            <thead valign="top">
              <tr>
                <th align="left">
                  <bold>Outlier function</bold>
                </th>
                <th align="center">
                  <bold>Type</bold>
                </th>
                <th align="left">
                  <bold>Use case</bold>
                </th>
              </tr>
            </thead>
            <tbody valign="top">
              <tr>
                <td align="left" valign="bottom">outlier.cutoff<hr/></td>
                <td align="center" valign="bottom">threshold<hr/></td>
                <td align="justify" valign="bottom">1. % of cells in WBC gate for RBC Lysis<hr/></td>
              </tr>
              <tr>
                <td align="left" valign="bottom"> <hr/></td>
                <td align="center" valign="bottom"> <hr/></td>
                <td align="justify" valign="bottom">2. % of total events as boundary events<hr/></td>
              </tr>
              <tr>
                <td align="left" valign="bottom"> <hr/></td>
                <td align="center" valign="bottom"> <hr/></td>
                <td align="justify" valign="bottom">3. Minimum total event count<hr/></td>
              </tr>
              <tr>
                <td align="left" valign="bottom">outlier.norm<hr/></td>
                <td align="center" valign="bottom">robust normal<hr/></td>
                <td align="justify" valign="bottom">1. Stability of MFI of a population vs time<hr/></td>
              </tr>
              <tr>
                <td align="left" valign="bottom"> <hr/></td>
                <td align="center" valign="bottom"> <hr/></td>
                <td align="justify" valign="bottom">2. Consistency of gating (%) of a population<hr/></td>
              </tr>
              <tr>
                <td align="left" valign="bottom"> <hr/></td>
                <td align="center" valign="bottom"> <hr/></td>
                <td align="justify" valign="bottom">3. High variability groups when measuring between–group variation (i.e. log(IQR) for boxplots)<hr/></td>
              </tr>
              <tr>
                <td align="left" valign="bottom"> <hr/></td>
                <td align="center" valign="bottom"> <hr/></td>
                <td align="justify" valign="bottom">4. Individual outliers from residuals of robust regression (i.e. in xyplot)<hr/></td>
              </tr>
              <tr>
                <td align="left">qoutlier</td>
                <td align="center">1.5 × IQR</td>
                <td align="justify">1. Outliers within groups for boxplots</td>
              </tr>
            </tbody>
          </table>
          <table-wrap-foot>
            <p>Outlier detection methods provided by <bold>QUAliFiER</bold> include fixed threshold cutoffs (<monospace>outlier.cutoff</monospace>), outlier calls based on t–statistic or Z–score cutoffs or based on significance levels (<italic>α</italic>) (<monospace>outlier.norm</monospace>), or calls based on the interquartile range (IQR) of a set of statistics (<monospace>qoutlier</monospace>) like that typically used for highlighting outliers in box–plots. Use cases for each are shown in the table.</p>
          </table-wrap-foot>
        </table-wrap>
        <p>The <monospace>qaCheck</monospace> method will record the outlier calls in the database. Plots can be generated without outlier detection by simply omitting the call to <monospace>qaCheck</monospace>. In some applications it may be desirable to simply examine trends rather than make explicit outlier calls (e.g., for monitoring MFI stability over time, Figure
<xref ref-type="fig" rid="F2">2</xref>).</p>
        <p>We show an example for monitoring the efficiency of red blood cell lysis (Figure
<xref ref-type="fig" rid="F4">4</xref>) from the ITN data set. Efficiency of lysis is measured as the fraction of total cells collected in the WBC_perct (white blood cell) gate (Figure
<xref ref-type="fig" rid="F1">1</xref>B). The <monospace>qaTask</monospace> definition used to monitor this population statistic over time, conditioning on all staining panel (tubes) is: </p>
        <p>&gt; data(ITNQASTUDY)</p>
        <p>&gt; rbc.lysis&lt;-new(‘‘qaTask'',</p>
        <p>pop=‘‘WBC_perct''</p>
        <p>
          <monospace>,formula=proportion</monospace>
          <monospace>
            <sup>∼</sup>
          </monospace>
          <monospace>RecdDt|Tube, qaLevel=‘‘Tube'',</monospace>
        </p>
        <p>Description=‘‘Sufficient RBC lysis'',</p>
        <p>plotType=‘‘xyplot'', qaName=‘‘RBCLysis'', qaID=1L,db=db)</p>
        <p>&gt; show(rbc.lysis)</p>
        <p>qaTask: RBCLysis</p>
        <p>Level : Tube</p>
        <p>Description : Sufficient RBC lysis</p>
        <p>Plot type: xyplot</p>
        <p>Gated node: WBC_perct</p>
        <p>
          <monospace>Default formula :proportion </monospace>
          <monospace>
            <sup>∼</sup>
          </monospace>
          <monospace>RecdDt | Tube</monospace>
        </p>
        <fig id="F4" position="float">
          <label>Figure 4</label>
          <caption>
            <p><bold>Consistency of red blood cell lysis across staining panels.</bold> If red blood cells are not properly lysed, they will be detected as events in the FCM experiment. Under ideal conditions, only white blood cells would be detected. The outlier threshold is set such that at least 80% of events should be within the white blood cell gate. Between one and two samples within each staining panel were identified as having lower than expected red blood cell lysis efficiency. Closer inspection revealed these to be from the same <italic>coresampleid</italic>.</p>
          </caption>
          <graphic xlink:href="1471-2105-13-252-4"/>
        </fig>
        <p>The call to <monospace>data</monospace> loads the study data that has already been parsed and combined with metadata and quality assessment tasks as defined in the previous section. When constructing a <monospace>qaTask</monospace> via <monospace>new</monospace> it is also necessary to supply a unique <monospace>qaID</monospace>, and the database (an environment) holding the extracted statistics and metadata (this is initially passed to the <monospace>qaPreprocess()</monospace> function, where it is populated).</p>
        <p>To perform the outlier detection, the <monospace>qaCheck</monospace> function is called on the <italic>rbc.lysis</italic> task and the results are stored in the database. A call to the <monospace>plot</monospace> method will generate the summary plot in Figure
<xref ref-type="fig" rid="F4">4</xref>, passing additional plotting parameters via the <monospace>par</monospace> argument. </p>
        <p>&gt; qaCheck(rbc.lysis</p>
        <p>,outlierfunc=outlier.cutoff</p>
        <p>,lBound=0.8)</p>
        <p>&gt; plot(rbc.lysis,</p>
        <p>par=list(ylab="percent"))</p>
        <p>The <monospace>plot</monospace> method is used to generate figures summarizing the outlier detection and quality assessment checks. This function takes the <monospace>qaTask</monospace> as an argument, as well as options similar to the <bold>lattice</bold> package, such as <monospace>subset</monospace>, which allows a subset of the levels in the grouping variables to be plotted. For example, samples can be subset based on a range of dates, or the plot of the quality assessment task defined above could be restricted to samples within a single staining panel (Tube) by passing <monospace>subset=Tube%in%'CD8/CD25/CD4/CD3/CD62'</monospace> to the <monospace>plot</monospace> method. This allows for flexibility in visualizing or analyzing subsets of the data.</p>
      </sec>
      <sec>
        <title>Adding robust regression lines to scatterplots</title>
        <p>As data accumulates over the course of a study (e.g. a longitudinal study), <bold>QUAliFiER</bold> stores this data in the QA database, and it becomes trivial to monitor trends in data collected over longer periods of time. As an example, the QA task for monitoring fluorescence stability in the FITC channel over time benefits from the addition of a robust regression line to the output plots within each panel in order to identify groups of samples where there are either non–linear effects or where the MFI is not stable over time (i.e. the slope of the regression is significantly different from zero). The outlier detection task for this procedure is defined in the following way: </p>
        <p>&gt;MFIvsTime&lt;-new("qaTask",</p>
        <p>qaName="MFIvsTime",</p>
        <p>description=</p>
        <p>"Fluorescence stability vs time",</p>
        <p>db=db, qaID=2,</p>
        <p>qaLevel="Assay",</p>
        <p>pop="MFI",</p>
        <p>formula=MFI RecdDt|channel⋆stain,</p>
        <p>plotType="xyplot")</p>
        <p>&gt; qaCheck(MFIvsTime</p>
        <p>,outlierfunc=outlier.norm</p>
        <p>,rFunc=rlm</p>
        <p>,z.cutoff=3)</p>
        <p>&gt; plot(MFIvsTime,y=MFI RecdDt|stain</p>
        <p>,subset=channel%in%c('FITC-A')</p>
        <p>,rFunc=rlm</p>
        <p>)</p>
        <p>Note the <monospace>rFunc</monospace> argument to the <monospace>qaCheck</monospace> and <monospace>plot</monospace> functions. It allows us to fit a robust linear regression within each group in order to help visualize the changes in MFI over time. Outliers within each level of the <italic>stain</italic> grouping factor are detected based on the deviation of the residuals from the regression line. By default these are called at a threshold of the absolute Z–score of the standardized residuals (3 by default) (Figure
<xref ref-type="fig" rid="F2">2</xref> and Table
<xref ref-type="table" rid="T2">2</xref>). If the <monospace>qaCheck</monospace> call is omitted, but <monospace>rFunc</monospace> is passed to the <monospace>plot</monospace> function, the resulting plots will be generated without outlier detection, which may be desirable in some circumstances. Importantly, all the <monospace>qaTask</monospace> definitions can be pre–defined in a csv file read in by <monospace>qaPreprocess()</monospace>, with column names for each argument to the <monospace>qaTask</monospace> constructor.</p>
      </sec>
    </sec>
    <sec>
      <title>Creating a Quality Assessment Report</title>
      <p>The quality assessment tasks for a data set can be summarized via a quality assessment report. This is generated by the <monospace>qa.report</monospace> function, which creates an HTML report for all QA tasks defined in a list. The report organizes the results of the qaTasks into categories based on Assay, Tube, Channel, or other user–defined levels (defined by the <monospace>qaLevel</monospace> argument of each <monospace>qaTask</monospace>). Summary tables of the FCS files failing each <monospace>qaTask</monospace> are generated as well as summary plots of each QA task, and low–level, sample specific plots of individual cell populations that failed specific QA tasks (Figure
<xref ref-type="fig" rid="F5">5</xref>). The HTML report makes use of SVG (scalable vector graphics) which allow for user interaction with the data. Generated plots allow mouse–over events to highlight common samples across groups, and include links to more detailed dot plots of specific gates of interest, thus allowing the user to get a global overview of the quality of the data set, and to perform more detailed investigation to identify the root cause of outlier samples. The HTML report provides a convenient interactive mechanism to view and interact with the data in order to get a better understanding of problematic samples or files in the data set. Components of an example report generated from the ITN study data set are shown in Figure
<xref ref-type="fig" rid="F5">5</xref> and the complete report for the ITN study data set can be found online at
<ext-link ext-link-type="uri" xlink:href="http://mikejiang.github.com/QUALIFIER/">http://mikejiang.github.com/QUALIFIER/</ext-link>.</p>
      <fig id="F5" position="float">
        <label>Figure 5</label>
        <caption>
          <p><bold>An xample of the HTML Quality Assessment Report Generated by the QUAliFiER Package.</bold><bold>A</bold>) qaTasks are categorized by assay level, channel level, or tube level, depending on the grouping variables for outlier detection. Within each category, a summary of the number of FCS files failing that qaTask is visible. <bold>B</bold>) Clicking on the “+” signs expands a more detailed view of the qaTask, including summary plots and tables. The summary plots themselves are interactive through the use of SVG graphics. The consistency of redundant staining is shown as boxplots of the % of marker positive cells grouped by stain. <bold>C)</bold> Clicking on individual points in the summary plots opens more detailed plots of the cell populations for individual samples failing the qaTask. Densityplots of one of the outlier groups show two samples with inconsistent positive staining in the FITC channel.</p>
        </caption>
        <graphic xlink:href="1471-2105-13-252-5"/>
      </fig>
    </sec>
    <sec>
      <title>Summary of the Quality Assessment Report for an ITN Clinical Trial Dataset</title>
      <p>The <bold>flowWorkspace</bold> and <bold>QUAliFiER</bold> packages were applied to a dataset of 3000 FCS files from the Immune Tolerance Network. The QA report (
<ext-link ext-link-type="uri" xlink:href="http://mikejiang.github.com/QUALIFIER/">http://mikejiang.github.com/QUALIFIER/</ext-link>) identified instances where issues with sample quality merited further review by domain scientists. The stability of the MFI (Figure
<xref ref-type="fig" rid="F2">2</xref>) for each antibody stain showed non–linear effects and changes in stability in some instances, which may have been associated with experimental factors such as changes in the intensity of the staining antibody. The consistency of lymphocyte gating across sample aliquots identified several instances where an elevated amount of debris in the sample resulted in a lower proportion of lymphocytes and mononuclear cells in the MNC gate (Figures
<xref ref-type="fig" rid="F3">3</xref> and
<xref ref-type="fig" rid="F6">6</xref>). Evaluation of redundant staining (see QA report online, and Figure
<xref ref-type="fig" rid="F5">5</xref>B, C) across sample aliquots allowed for rapid identification of samples with inconsistent staining. The quality of individual aliquots was evaluated by looking at the number of events collected for each aliquot, and identifying those samples where fewer than the number of expected events were collected (see QA report online). Another approach to assess the quality of individual aliquots was to examine the consistency of lysis of red blood cells in each aliquot (Figure
<xref ref-type="fig" rid="F4">4</xref>). Aliquots with fewer than 80% of lysed red blood cells were flagged for further investigation. Instrument stability during sample acquisition was evaluated by monitoring spikes or drifts in each measured channel for each sample (see QA report online). Plots of cumulative Z–scores of those drifts or spikes allowed identification of samples which showed significant deviations.</p>
      <fig id="F6" position="float">
        <label>Figure 6</label>
        <caption>
          <p><bold>Dot plots of outlier MNC samples.</bold> Dot plots of the MNC gates for <italic>coresampleid</italic> 11732, one of the group outliers identified by the MNC stability qaTask. Samples with lower proportions of lymphocytes inside the gate are readily visible, caused by elevated debris in the sample.</p>
        </caption>
        <graphic xlink:href="1471-2105-13-252-6"/>
      </fig>
      <p>One of the key advantages of <bold>QUAliFiER</bold> is that it provides an integrated environment for review of quality assurance data by flow domain experts. In the past, the flow analyst would either spot check and manually review plots within flow gating software tools or have data exported from such tools into spreadsheets for sorting, plotting, and viewing of trends over time or across tubes. Should specific anomalies be found, the analyst would have to shuffle between applications, sort through files to review plots within the flow gating tool and return back to summary statistics or plots of trends for confirmation. The disjointed process was cumbersome.</p>
      <p>QUALiFiER takes a lot of this frustration out of the process so domain scientists can focus on the scientific questions of interest. It should be noted that the use of QUALiFiER, whether in a research or clinical trial setting is to have the flow cytometry domain expert always review trends and patterns and not simply rely on automatic exclusion of flagged samples. There may be instances where a trend may be due to administration of therapy or other clinical event of interest. In those instances, having the system within the R/BioConducotor framework allows us to easily overlay QA concerns with potentially biological events in an integrated, seamless fashion, further demonstrating the ease and utility of the tool. To our knowledge it is the first tool to integrate this level of extensive quality assessment for large scale gated FCM data in a cohesive pipeline.</p>
      <p>Ongoing improvements to the software include complete FlowJo support, as well as FACSDiva (BD Biosciences, San Jose, CA) experiment files, improvements to the HTML report formatting, and generation of PDF output for quality assessment reports. The tool will also be integrated into LabKey (Seattle, WA).</p>
      <p>The features and description of the software herein refer to <bold>flowWorkspace</bold> version 1.2 and <bold>QUAliFiER</bold> version 1.0.1 found at the BioConductor website (see Availability and Requirements). The development version of <bold>flowWorkspace</bold> supports Windows and Mac versions of <italic>FlowJo</italic>, including the latest version (version X, Chimera) which is Gating–ML compliant. Support for BD’s (Franklin Lakes, New Jersey) <italic>FACS DiVA</italic> is actively being developed and the next release of <italic>flowWorkspace</italic> will support some the most frequently used manual gating tools (<italic>DiVA</italic> and <italic>FlowJo</italic> reach approximately 50% of users). <bold>FlowWorkspace</bold> data import and gating has also been reimplemented in C++ in the development release, for a 100–fold speed up over the current R–only version of the package.</p>
    </sec>
  </sec>
  <sec sec-type="conclusions">
    <title>Conclusion</title>
    <p><bold>flowWorkspace</bold> is a BioConductor package that allows FCM data that has been preprocessed and manually gated using the <italic>FlowJo</italic> tool (and other tools in future releases) to be imported in the R statistical computing environment where the BioConductor suite of advanced FCM data analysis tools can be leveraged to further analyze the data. A good example of the utility of <bold>flowWorkspace</bold> is its integration with the <bold>QUAliFiER</bold> tool, performing flexible and robust quality assessment of gated and ungated FCM data. Together, the <bold>flowWorkspace</bold> and <bold>QUAliFiER</bold> tools address the increasing demand for tools capable of performing QA on large FCM data sets generated in typical clinical trials. <bold>flowWorkspace</bold> deals with the issue of working with more data than can be loaded into memory at once through its integration with <bold>ncdfFlow</bold> that stores data in netCDF files on disk. <bold>QUAliFiER</bold> provides an infrastructure for identifying outliers amongst the large number of samples collected in an experiment or clinical trial while taking into account the structure imposed by the trial metadata. It simplifies and summarizes the data and presents the results in an interactive way.</p>
    <p>The <bold>QUAliFiER</bold> tool automates what has been, for the most part, a manual QA process. Within the ITN, the template gates and subsequent QA are applied manually within flowJo, the resulting statistics extracted, and plots are generated and visualized by an analyst to identify possible problems. In addition, SAS, Excel, and other graphing tools made the process time consuming and disjointed. <bold>QUAliFiER</bold> automates this entire process. The ease of use and customizable nature of the analysis output mark the advantage of the <bold>QUAliFiER</bold> platform over the manual processes. Additionally, <bold>QUAliFiER</bold> brings all the steps of the QA procedure into one software tool. Importantly, <bold>QUAliFiER</bold> is not limited to the template gate-based QA process presented here, but can QA any set of manually gated data (either imported via <bold>flowWorkspace</bold> or otherwise), provided that the data set identifies common cell populations across multiple samples.</p>
    <p><bold>QUAliFiER</bold> objectively, efficiently, and reproducibly identifies outlier samples in an automated manner by monitoring cell population statistics from FCM data conditioned on study–level and experiment–level metadata for outlier detection. The tool has a flexible interface allowing users to define new QA checks and outlier detection routines that suit their data analysis needs. Importantly, interactive quality assessment reports are generated automatically by the tool to facilitate exploration of the data by domain scientists and help identify the underlying causes of potential QA issues flagged by the tool. <bold>QUAliFiER</bold> has uses beyond simple quality assessment. It can be used for exploratory data analysis, to look for correlations between gated populations and clinical covariates for biomarker discovery, and has been applied to evaluate datasets for the <italic>flowCAP</italic> projects (
<ext-link ext-link-type="uri" xlink:href="http://flowcap.flowsite.org/">http://flowcap.flowsite.org/</ext-link>).</p>
  </sec>
  <sec>
    <title>Availability and requirements</title>
    <p><bold>Project name:</bold> QUAliFiER</p>
    <p>
      <bold>Project homepage:</bold>
      <ext-link ext-link-type="uri" xlink:href="http://mikejiang.github.com/QUALIFIER/">http://mikejiang.github.com/QUALIFIER/</ext-link>
    </p>
    <p>
      <bold>BioConductor link:</bold>
      <ext-link ext-link-type="uri" xlink:href="http://bioconductor.org/packages/2.10/bioc/html/QUALIFIER.html">http://bioconductor.org/packages/2.10/bioc/html/QUALIFIER.html</ext-link>
    </p>
    <p><bold>Operating systems:</bold> Platform independent</p>
    <p><bold>Programming language:</bold> R</p>
    <p><bold>Version:</bold> 1.0.1</p>
    <p><bold>Other requirements:</bold> R, Bioconductor</p>
    <p><bold>License:</bold> Artistic 2.0</p>
    <p><bold>Project name:</bold> flowWorkspace</p>
    <p>
      <bold>Project homepage:</bold>
      <ext-link ext-link-type="uri" xlink:href="http://github.com/gfinak/flowWorkspace">http://github.com/gfinak/flowWorkspace</ext-link>
    </p>
    <p>
      <bold>BioConductor link:</bold>
      <ext-link ext-link-type="uri" xlink:href="http://bioconductor.org/packages/2.10/bioc/html/flowWorkspace.html">http://bioconductor.org/packages/2.10/bioc/html/flowWorkspace.html</ext-link>
    </p>
    <p><bold>Operating systems:</bold> Platform independent</p>
    <p><bold>Programming language:</bold> R and C++</p>
    <p><bold>Version:</bold> 1.2.0</p>
    <p><bold>Other requirements:</bold> R, Bioconductor</p>
    <p><bold>License:</bold> Artistic 2.0</p>
  </sec>
  <sec>
    <title>Abbreviations</title>
    <p>FCM: (flow cytometry); SVG: (scalable vector graphics); ITN: (Immune ToleranceNetwork).</p>
  </sec>
  <sec>
    <title>Competing interests</title>
    <p>The authors declare that they have no competing interests.</p>
  </sec>
  <sec>
    <title>Author’s contributions</title>
    <p>RG and GF and WJ developed the methodology and designed the software. WJ and GF developed the software, and performed the analyses. AA and JP participated in its design and coordination. WJ and GF drafted the manuscript. All authors read and approved the final manuscript.</p>
  </sec>
</body>
<back>
  <sec>
    <title>Acknowledgements</title>
    <p>This research was performed as a project of the Immune Tolerance Network (NIH Contract #N01 AI15416), an international clinical research consortium headquartered at the University of California San Francisco and supported by the National Institute of Allergy and Infectious Diseases and the Juvenile Diabetes Research Foundation. Development of these packages was also funded by NIH grant #R01 EB008400.</p>
  </sec>
  <ref-list>
    <ref id="B1">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Braylan</surname>
          <given-names>RC</given-names>
        </name>
        <article-title>Impact of flow cytometry on the diagnosis and characterization of lymphomas, chronic lymphoproliferative disorders and plasma cell neoplasias</article-title>
        <source>Cytometry A</source>
        <year>2004</year>
        <volume>58A</volume>
        <fpage>57</fpage>
        <lpage>61</lpage>
        <pub-id pub-id-type="doi">10.1002/cyto.a.10101</pub-id>
        <pub-id pub-id-type="pmid">14994222</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B2">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Hengel</surname>
          <given-names>RL</given-names>
        </name>
        <name>
          <surname>Nicholson</surname>
          <given-names>JK</given-names>
        </name>
        <article-title>An update on the use of flow cytometry in HIV infection and AIDS</article-title>
        <source>Clin Lab Med</source>
        <year>2001</year>
        <volume>21</volume>
        <issue>4</issue>
        <fpage>841</fpage>
        <lpage>856</lpage>
        <pub-id pub-id-type="pmid">11770291</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B3">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Illoh</surname>
          <given-names>OC</given-names>
        </name>
        <article-title>Current applications of flow cytometry in the diagnosis of primary immunodeficiency diseases</article-title>
        <source>Arch Pathol Lab Med</source>
        <year>2004</year>
        <volume>128</volume>
        <fpage>23</fpage>
        <lpage>31</lpage>
        <pub-id pub-id-type="pmid">14692816</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B4">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Kiechle</surname>
          <given-names>FL</given-names>
        </name>
        <name>
          <surname>Holland-Staley</surname>
          <given-names>CA</given-names>
        </name>
        <article-title>Genomics, transcriptomics, proteomics, and numbers</article-title>
        <source>Arch Pathol Lab Med</source>
        <year>2003</year>
        <volume>127</volume>
        <issue>9</issue>
        <fpage>1089</fpage>
        <lpage>1097</lpage>
        <pub-id pub-id-type="pmid">12946210</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B5">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Mandy</surname>
          <given-names>FF</given-names>
        </name>
        <article-title>Twenty-five years of clinical flow cytometry: AIDS, accelerated global instrument distribution</article-title>
        <source>Cytometry A</source>
        <year>2004</year>
        <volume>58A</volume>
        <fpage>55</fpage>
        <lpage>56</lpage>
        <pub-id pub-id-type="doi">10.1002/cyto.a.10102</pub-id>
        <pub-id pub-id-type="pmid">14994221</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B6">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Orfao</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Ortuno</surname>
          <given-names>F</given-names>
        </name>
        <name>
          <surname>de Santiago</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Lopez</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>San Miguel</surname>
          <given-names>J</given-names>
        </name>
        <article-title>Immunophenotyping of acute leukemias and myelodysplastic syndromes</article-title>
        <source>Cytometry A</source>
        <year>2004</year>
        <volume>58A</volume>
        <fpage>62</fpage>
        <lpage>71</lpage>
        <pub-id pub-id-type="doi">10.1002/cyto.a.10104</pub-id>
        <pub-id pub-id-type="pmid">14994223</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B7">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Bagwell</surname>
          <given-names>CB</given-names>
        </name>
        <article-title>DNA histogram analysis for node-negative breast cancer</article-title>
        <source>Cytometry A</source>
        <year>2004</year>
        <volume>58A</volume>
        <fpage>76</fpage>
        <lpage>78</lpage>
        <pub-id pub-id-type="doi">10.1002/cyto.a.90004</pub-id>
        <pub-id pub-id-type="pmid">14994225</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B8">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Keeney</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Gratama</surname>
          <given-names>JW</given-names>
        </name>
        <name>
          <surname>Sutherland</surname>
          <given-names>DR</given-names>
        </name>
        <article-title>Critical role of flow cytometry in evaluating peripheral blood hematopoietic stem cell grafts</article-title>
        <source>Cytometry A</source>
        <year>2004</year>
        <volume>58A</volume>
        <fpage>72</fpage>
        <lpage>75</lpage>
        <pub-id pub-id-type="doi">10.1002/cyto.a.10103</pub-id>
        <pub-id pub-id-type="pmid">14994224</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B9">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Bashashati</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Brinkman</surname>
          <given-names>RR</given-names>
        </name>
        <article-title>A survey of flow cytometry data analysis methods</article-title>
        <source>Adv Bioinf</source>
        <year>2009</year>
        <volume>584603</volume>
        <fpage>2009</fpage>
      </mixed-citation>
    </ref>
    <ref id="B10">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Krutzik</surname>
          <given-names>PO</given-names>
        </name>
        <name>
          <surname>Irish</surname>
          <given-names>JM</given-names>
        </name>
        <name>
          <surname>Nolan</surname>
          <given-names>GP</given-names>
        </name>
        <name>
          <surname>Perez</surname>
          <given-names>OD</given-names>
        </name>
        <article-title>Analysis of protein phosphorylation and cellular signaling events by flow cytometry: techniques and clinical applications</article-title>
        <source>Clin Immunol</source>
        <year>2004</year>
        <volume>110</volume>
        <issue>3</issue>
        <fpage>206</fpage>
        <lpage>221</lpage>
        <pub-id pub-id-type="doi">10.1016/j.clim.2003.11.009</pub-id>
        <pub-id pub-id-type="pmid">15047199</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B11">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Maecker</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>McCoy</surname>
          <given-names>P</given-names>
        </name>
        <name>
          <surname>Nussenblatt</surname>
          <given-names>R</given-names>
        </name>
        <article-title>Standardizing Immunophenotyping for the Human Immunology Project</article-title>
        <source>Nat Rev Immunol</source>
        <year>2012</year>
        <volume>12</volume>
        <issue>3</issue>
        <fpage>191</fpage>
        <lpage>200</lpage>
        <pub-id pub-id-type="pmid">22343568</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B12">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Pozarowski</surname>
          <given-names>P</given-names>
        </name>
        <name>
          <surname>Darzynkiewicz</surname>
          <given-names>Z</given-names>
        </name>
        <article-title>Analysis of cell cycle by flow cytometry</article-title>
        <source>Methods Mol Biol</source>
        <year>2004</year>
        <volume>281</volume>
        <fpage>301</fpage>
        <lpage>312</lpage>
        <pub-id pub-id-type="pmid">15220539</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B13">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Pala</surname>
          <given-names>P</given-names>
        </name>
        <name>
          <surname>Hussell</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Openshaw</surname>
          <given-names>PJ</given-names>
        </name>
        <article-title>Flow cytometric measurement of intracellular cytokines</article-title>
        <source>J Immunol Methods</source>
        <year>2000</year>
        <volume>243</volume>
        <issue>1-2</issue>
        <fpage>107</fpage>
        <lpage>124</lpage>
        <pub-id pub-id-type="doi">10.1016/S0022-1759(00)00230-1</pub-id>
        <pub-id pub-id-type="pmid">10986410</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B14">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Vermes</surname>
          <given-names>I</given-names>
        </name>
        <name>
          <surname>Haanen</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Reutelingsperger</surname>
          <given-names>C</given-names>
        </name>
        <article-title>Flow cytometry of apoptotic cell death</article-title>
        <source>J Immunol Methods</source>
        <year>2000</year>
        <volume>243</volume>
        <issue>1-2</issue>
        <fpage>167</fpage>
        <lpage>190</lpage>
        <pub-id pub-id-type="doi">10.1016/S0022-1759(00)00233-7</pub-id>
        <pub-id pub-id-type="pmid">10986414</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B15">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Lehmann</surname>
          <given-names>AK</given-names>
        </name>
        <name>
          <surname>Sornes</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Halstensen</surname>
          <given-names>A</given-names>
        </name>
        <article-title>Phagocytosis: measurement by flow cytometry</article-title>
        <source>J Immunol Methods</source>
        <year>2000</year>
        <volume>243</volume>
        <issue>1-2</issue>
        <fpage>229</fpage>
        <lpage>242</lpage>
        <pub-id pub-id-type="doi">10.1016/S0022-1759(00)00237-4</pub-id>
        <pub-id pub-id-type="pmid">10986417</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B16">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Shulman</surname>
          <given-names>N</given-names>
        </name>
        <name>
          <surname>Bellew</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Snelling</surname>
          <given-names>G</given-names>
        </name>
        <name>
          <surname>Carter</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Huang</surname>
          <given-names>Y</given-names>
        </name>
        <name>
          <surname>Li</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>Self</surname>
          <given-names>SG</given-names>
        </name>
        <name>
          <surname>McElrath</surname>
          <given-names>MJ</given-names>
        </name>
        <name>
          <surname>De</surname>
          <given-names>Rosa</given-names>
          <suffix>SC</suffix>
        </name>
        <article-title>Development of an automated analysis system for data from flow cytometric intracellular cytokine staining assays from clinical vaccine trials</article-title>
        <source>Cytometry Part A : j Int Soc Anal Cytology</source>
        <year>2008</year>
        <volume>73</volume>
        <issue>9</issue>
        <fpage>847</fpage>
        <lpage>856</lpage>
      </mixed-citation>
    </ref>
    <ref id="B17">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Nelson</surname>
          <given-names>EK</given-names>
        </name>
        <name>
          <surname>Piehler</surname>
          <given-names>B</given-names>
        </name>
        <name>
          <surname>Eckels</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Rauch</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Bellew</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Hussey</surname>
          <given-names>P</given-names>
        </name>
        <name>
          <surname>Ramsay</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Nathe</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Lum</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Krouse</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Stearns</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Connolly</surname>
          <given-names>B</given-names>
        </name>
        <name>
          <surname>Skillman</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Igra</surname>
          <given-names>M</given-names>
        </name>
        <article-title>LabKey Server: an open source platform for scientific data integration, analysis and collaboration</article-title>
        <source>BMC Bioinf</source>
        <year>2011</year>
        <volume>12</volume>
        <fpage>71</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-12-71</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B18">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Hahne</surname>
          <given-names>F</given-names>
        </name>
        <name>
          <surname>Le Meur</surname>
          <given-names>N</given-names>
        </name>
        <name>
          <surname>Brinkman</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Ellis</surname>
          <given-names>B</given-names>
        </name>
        <name>
          <surname>Haaland</surname>
          <given-names>P</given-names>
        </name>
        <name>
          <surname>Sarkar</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Spidlen</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Strain</surname>
          <given-names>E</given-names>
        </name>
        <name>
          <surname>Gentleman</surname>
          <given-names>R</given-names>
        </name>
        <article-title>flowCore: A Bioconductor software package for high throughput flow cytometry data analysis</article-title>
        <source>BMC Bioinf</source>
        <year>2009</year>
        <volume>10</volume>
        <fpage>106</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-10-106</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B19">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Gentleman</surname>
          <given-names>RC</given-names>
        </name>
        <name>
          <surname>Carey</surname>
          <given-names>VJ</given-names>
        </name>
        <name>
          <surname>Bates</surname>
          <given-names>DM</given-names>
        </name>
        <name>
          <surname>Bolstad</surname>
          <given-names>B</given-names>
        </name>
        <name>
          <surname>Dettling</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Dudoit</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Ellis</surname>
          <given-names>B</given-names>
        </name>
        <name>
          <surname>Gautier</surname>
          <given-names>L</given-names>
        </name>
        <name>
          <surname>Ge</surname>
          <given-names>Y</given-names>
        </name>
        <name>
          <surname>Gentry</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Hornik</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Hothorn</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Huber</surname>
          <given-names>W</given-names>
        </name>
        <name>
          <surname>Iacus</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Irizarry</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Leisch</surname>
          <given-names>F</given-names>
        </name>
        <name>
          <surname>Li</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Maechler</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Rossini</surname>
          <given-names>AJ</given-names>
        </name>
        <name>
          <surname>Sawitzki</surname>
          <given-names>G</given-names>
        </name>
        <name>
          <surname>Smith</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Smyth</surname>
          <given-names>G</given-names>
        </name>
        <name>
          <surname>Tierney</surname>
          <given-names>L</given-names>
        </name>
        <name>
          <surname>Yang</surname>
          <given-names>JYH</given-names>
        </name>
        <name>
          <surname>Zhang</surname>
          <given-names>J</given-names>
        </name>
        <article-title>Bioconductor: Open software development for computational biology and bioinformatics</article-title>
        <source>Genome Biol</source>
        <year>2004</year>
        <volume>5</volume>
        <issue>10</issue>
        <fpage>R80</fpage>
        <pub-id pub-id-type="doi">10.1186/gb-2004-5-10-r80</pub-id>
        <pub-id pub-id-type="pmid">15461798</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B20">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Hahne</surname>
          <given-names>F</given-names>
        </name>
        <name>
          <surname>Khodabakhshi</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Bashashati</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Wong</surname>
          <given-names>CJ</given-names>
        </name>
        <name>
          <surname>Gascoyne</surname>
          <given-names>RD</given-names>
        </name>
        <name>
          <surname>Weng</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Seyfert-Margolis</surname>
          <given-names>V</given-names>
        </name>
        <name>
          <surname>Bourcier</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Asare</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Lumley</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Gentleman</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Brinkman</surname>
          <given-names>R</given-names>
        </name>
        <article-title>Per-channel basis normalization methods for flow cytometry data</article-title>
        <source>Cytometry Part A</source>
        <year>2010</year>
        <volume>77A</volume>
        <fpage>121</fpage>
        <lpage>131</lpage>
      </mixed-citation>
    </ref>
    <ref id="B21">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Sarkar</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Le</surname>
          <given-names>Meur</given-names>
          <suffix>N</suffix>
        </name>
        <name>
          <surname>Gentleman</surname>
          <given-names>R</given-names>
        </name>
        <article-title>Using flowViz to visualize flow cytometry data</article-title>
        <source>Bioinformatics</source>
        <year>2008</year>
        <volume>24</volume>
        <issue>6</issue>
        <fpage>878</fpage>
        <lpage>879</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btn021</pub-id>
        <pub-id pub-id-type="pmid">18245128</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B22">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Gosink</surname>
          <given-names>JJ</given-names>
        </name>
        <name>
          <surname>Means</surname>
          <given-names>GD</given-names>
        </name>
        <name>
          <surname>Rees</surname>
          <given-names>WA</given-names>
        </name>
        <name>
          <surname>Su</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Rand</surname>
          <given-names>HA</given-names>
        </name>
        <article-title>Bridging the Divide between Manual Gating and Bioinformatics with the Bioconductor Package flowFlowJo</article-title>
        <source>Advances in Bioinformatics</source>
        <year>2009</year>
        <volume>809469</volume>
        <fpage>2009</fpage>
      </mixed-citation>
    </ref>
    <ref id="B23">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Rew</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Davis</surname>
          <given-names>G</given-names>
        </name>
        <article-title>NetCDF: an interface for scientific data access</article-title>
        <source>Computer Graphics and Applications, IEEE</source>
        <year>1990</year>
        <volume>10</volume>
        <issue>4</issue>
        <fpage>76</fpage>
        <lpage>82</lpage>
      </mixed-citation>
    </ref>
    <ref id="B24">
      <mixed-citation publication-type="other">
        <name>
          <surname>Mike Jiang NG Greg</surname>
          <given-names>Finak</given-names>
        </name>
        <article-title>ncdfFlow: ncdfFlow: A package that provides ncdf based storage for flow cytometry data</article-title>
        <comment>[
<ext-link ext-link-type="uri" xlink:href="http://bioconductor.org/packages/2.10/bioc/html/ncdfFlow.html">http://bioconductor.org/packages/2.10/bioc/html/ncdfFlow.html</ext-link>]</comment>
      </mixed-citation>
    </ref>
    <ref id="B25">
      <mixed-citation publication-type="book">
        <name>
          <surname>Chambers</surname>
          <given-names>JM</given-names>
        </name>
        <source>Programming with Data: A Guide to the S Language</source>
        <year>2004</year>
        <publisher-name>175 Fifth Avenue, NY 10010, USA: Springer–Verlag, New York, Inc.</publisher-name>
      </mixed-citation>
    </ref>
    <ref id="B26">
      <mixed-citation publication-type="other">
        <name>
          <surname>Lang</surname>
          <given-names>DT</given-names>
        </name>
        <source>XML: Tools for parsing and generating XML within R and S-Plus</source>
        <year>2012,</year>
        <comment>[
<ext-link ext-link-type="uri" xlink:href="http://CRAN.R-project.org/package=XML">http://CRAN.R-project.org/package=XML</ext-link>]. [R package version 3.9-4]</comment>
      </mixed-citation>
    </ref>
    <ref id="B27">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Chan</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Felber</surname>
          <given-names>P</given-names>
        </name>
        <name>
          <surname>Garofalakis</surname>
          <given-names>M</given-names>
        </name>
        <article-title>Efficient filtering of XML documents with XPath expressions</article-title>
        <source>VLDB J—Int J Very Large Data Bases</source>
        <year>2002</year>
        <volume>11</volume>
        <issue>4</issue>
        <fpage>354</fpage>
        <lpage>379</lpage>
        <pub-id pub-id-type="doi">10.1007/s00778-002-0077-6</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B28">
      <mixed-citation publication-type="other">
        <name>
          <surname>Yu</surname>
          <given-names>H</given-names>
        </name>
        <source>Rmpi: Interface (Wrapper) to MPI (Message-Passing Interface)</source>
        <year>2010,</year>
        <comment>[
<ext-link ext-link-type="uri" xlink:href="http://CRAN.R-project.org/package=Rmpi">http://CRAN.R-project.org/package=Rmpi</ext-link>]. [R package version 0.5-9]</comment>
      </mixed-citation>
    </ref>
    <ref id="B29">
      <mixed-citation publication-type="other">
        <name>
          <surname>Knaus</surname>
          <given-names>J</given-names>
        </name>
        <source>snowfall: Easier cluster computing (based on snow)</source>
        <year>2010,</year>
        <comment>[
<ext-link ext-link-type="uri" xlink:href="http://CRAN.R-project.org/package=snowfall">http://CRAN.R-project.org/package=snowfall</ext-link>]. [R package version 1.84]</comment>
      </mixed-citation>
    </ref>
    <ref id="B30">
      <mixed-citation publication-type="other">
        <name>
          <surname>Urbanek</surname>
          <given-names>S</given-names>
        </name>
        <source>multicore: Parallel processing of R code on machines with multiple cores or CPUs</source>
        <year>2011,</year>
        <comment>[
<ext-link ext-link-type="uri" xlink:href="http://CRAN.R-project.org/package=multicore">http://CRAN.R-project.org/package=multicore</ext-link>]. [R package version 0.1-7]</comment>
      </mixed-citation>
    </ref>
    <ref id="B31">
      <mixed-citation publication-type="other">
        <name>
          <surname>Feng</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Ekong</surname>
          <given-names>U</given-names>
        </name>
        <name>
          <surname>Lobritto</surname>
          <given-names>S</given-names>
        </name>
        <article-title>Clinical and histological predictors of operational tolerance in pediatric liver transplant recipients</article-title>
        <source>The 2011 Joint International Congress of ILTS , ELITA , &amp;amp; LICAGE Valencia, June 22-25, 2011; Spain Edited by Lake, J R and Roberts, JP</source>
        <volume>17</volume>
        <issue>suppl 1</issue>
        <fpage>S107</fpage>
        <pub-id pub-id-type="pmid">21618695</pub-id>
      </mixed-citation>
    </ref>
  </ref-list>
</back>
