<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8504643</article-id>
    <article-id pub-id-type="pmid">33970215</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btab337</article-id>
    <article-id pub-id-type="publisher-id">btab337</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Papers</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Gene Expression</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Differential gene expression analysis for multi-subject single-cell RNA-sequencing studies with <italic toggle="yes">aggregateBioVar</italic></article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-7777-4165</contrib-id>
        <name>
          <surname>Thurman</surname>
          <given-names>Andrew L</given-names>
        </name>
        <xref rid="btab337-cor1" ref-type="corresp"/>
        <aff><institution>Department of Internal Medicine, Roy J. and Lucille A. Carver College of Medicine, University of Iowa</institution>, Iowa City, IA 52242, <country country="US">USA</country></aff>
        <!--thurman@uiowa.edu-->
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ratcliff</surname>
          <given-names>Jason A</given-names>
        </name>
        <aff><institution>Iowa Institute of Human Genetics, Roy J. and Lucille A. Carver College of Medicine, University of Iowa</institution>, Iowa City, IA 52242, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Chimenti</surname>
          <given-names>Michael S</given-names>
        </name>
        <aff><institution>Iowa Institute of Human Genetics, Roy J. and Lucille A. Carver College of Medicine, University of Iowa</institution>, Iowa City, IA 52242, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-7544-5109</contrib-id>
        <name>
          <surname>Pezzulo</surname>
          <given-names>Alejandro A</given-names>
        </name>
        <xref rid="btab337-cor1" ref-type="corresp"/>
        <aff><institution>Department of Internal Medicine, Roy J. and Lucille A. Carver College of Medicine, University of Iowa</institution>, Iowa City, IA 52242, <country country="US">USA</country></aff>
        <!--alejandro-pezzulo@uiowa.edu-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Mathelier</surname>
          <given-names>Anthony</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btab337-cor1">To whom correspondence should be addressed. <email>thurman@uiowa.edu</email> or <email>alejandro-pezzulo@uiowa.edu</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <day>01</day>
      <month>10</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2021-05-10">
      <day>10</day>
      <month>5</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>10</day>
      <month>5</month>
      <year>2021</year>
    </pub-date>
    <volume>37</volume>
    <issue>19</issue>
    <fpage>3243</fpage>
    <lpage>3251</lpage>
    <history>
      <date date-type="received">
        <day>03</day>
        <month>9</month>
        <year>2020</year>
      </date>
      <date date-type="rev-recd">
        <day>07</day>
        <month>4</month>
        <year>2021</year>
      </date>
      <date date-type="editorial-decision">
        <day>29</day>
        <month>4</month>
        <year>2021</year>
      </date>
      <date date-type="accepted">
        <day>30</day>
        <month>4</month>
        <year>2021</year>
      </date>
      <date date-type="corrected-typeset">
        <day>11</day>
        <month>6</month>
        <year>2021</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2021. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2021</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btab337.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>Single-cell RNA-sequencing (scRNA-seq) provides more granular biological information than bulk RNA-sequencing; bulk RNA sequencing remains popular due to lower costs which allows processing more biological replicates and design more powerful studies. As scRNA-seq costs have decreased, collecting data from more than one biological replicate has become more feasible, but careful modeling of different layers of biological variation remains challenging for many users. Here, we propose a statistical model for scRNA-seq gene counts, describe a simple method for estimating model parameters and show that failing to account for additional biological variation in scRNA-seq studies can inflate false discovery rates (FDRs) of statistical tests.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>First, in a simulation study, we show that when the gene expression distribution of a population of cells varies between subjects, a naïve approach to differential expression analysis will inflate the FDR. We then compare multiple differential expression testing methods on scRNA-seq datasets from human samples and from animal models. These analyses suggest that a naïve approach to differential expression testing could lead to many false discoveries; in contrast, an approach based on pseudobulk counts has better FDR control.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>A software package, <italic toggle="yes">aggregateBioVar</italic>, is freely available on Bioconductor (<ext-link xlink:href="https://www.bioconductor.org/packages/release/bioc/html/aggregateBioVar.html" ext-link-type="uri">https://www.bioconductor.org/packages/release/bioc/html/aggregateBioVar.html</ext-link>) to accommodate compatibility with upstream and downstream methods in scRNA-seq data analysis pipelines.</p>
      </sec>
      <sec id="s5">
        <title>Supplementary information</title>
        <p>Raw gene-by-cell count matrices for pig scRNA-seq data are available as GEO accession GSE150211. <xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>National Institutes of Health</institution>
            <institution-id institution-id-type="DOI">10.13039/100000002</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>NHLBI K01HL140261</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>NIH</institution>
            <institution-id institution-id-type="DOI">10.13039/100000002</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>NIDDK DK54759</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>NIH</institution>
            <institution-id institution-id-type="DOI">10.13039/100000002</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>NIEHS ES005605</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="9"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Single-cell RNA-sequencing (scRNA-seq) enables analysis of the effects of different conditions or perturbations on specific cell types or cellular states. Multiple methods and bioinformatic tools exist for initial scRNA-seq data processing, including normalization, dimensionality reduction, visualization, cell type identification, lineage relationships and differential gene expression (DGE) analysis (<xref rid="btab337-B8" ref-type="bibr">Chen <italic toggle="yes">et al.</italic>, 2019</xref>; <xref rid="btab337-B18" ref-type="bibr">Hwang <italic toggle="yes">et al.</italic>, 2018</xref>; <xref rid="btab337-B26" ref-type="bibr">Luecken and Theis, 2019</xref>; <xref rid="btab337-B45" ref-type="bibr">Vieth <italic toggle="yes">et al.</italic>, 2019</xref>; <xref rid="btab337-B49" ref-type="bibr">Zaragosi <italic toggle="yes">et al.</italic>, 2020</xref>).</p>
    <p>A common use of DGE analysis for scRNA-seq data is to perform comparisons between pre-defined subsets of cells (referred to here as <italic toggle="yes">marker detection methods</italic>); many methods have been developed to perform this analysis (<xref rid="btab337-B5" ref-type="bibr">Butler <italic toggle="yes">et al.</italic>, 2018</xref>; <xref rid="btab337-B10" ref-type="bibr">Delmans and Hemberg, 2016</xref>; <xref rid="btab337-B11" ref-type="bibr">Finak <italic toggle="yes">et al.</italic>, 2015</xref>; <xref rid="btab337-B16" ref-type="bibr">Guo <italic toggle="yes">et al.</italic>, 2015</xref>; <xref rid="btab337-B20" ref-type="bibr">Kharchenko <italic toggle="yes">et al.</italic>, 2014</xref>; <xref rid="btab337-B22" ref-type="bibr">Korthauer <italic toggle="yes">et al.</italic>, 2016</xref>; <xref rid="btab337-B30" ref-type="bibr">Miao <italic toggle="yes">et al.</italic>, 2018</xref>; <xref rid="btab337-B32" ref-type="bibr">Qiu <italic toggle="yes">et al.</italic>, 2017a, b</xref>; <xref rid="btab337-B47" ref-type="bibr">Wang <italic toggle="yes">et al.</italic>, 2019</xref>; <xref rid="btab337-B48" ref-type="bibr">Wang and Nabavi, 2018</xref>). Marker detection methods allow quantification of variation between cells and exploration of expression heterogeneity within tissues. In scRNA-seq studies, where cells are collected from multiple subjects (e.g. healthy versus disease), an additional layer of variability is introduced. DGE methods to address this additional complexity, which have been referred to as differential state (DS) analysis are just being explored in the scRNA-seq field (<xref rid="btab337-B9" ref-type="bibr">Crowell <italic toggle="yes">et al.</italic>, 2020</xref>; <xref rid="btab337-B27" ref-type="bibr">Lun <italic toggle="yes">et al.</italic>, 2016</xref>; <xref rid="btab337-B29" ref-type="bibr">McCarthy <italic toggle="yes">et al.</italic>, 2017</xref>; <xref rid="btab337-B44" ref-type="bibr">Van den Berge <italic toggle="yes">et al.</italic>, 2019</xref>; <xref rid="btab337-B52" ref-type="bibr">Zimmerman <italic toggle="yes">et al.</italic>, 2021</xref>).</p>
    <p>In recent years, the reagent and effort costs of scRNA-seq have decreased dramatically as novel techniques have been developed (<xref rid="btab337-B1" ref-type="bibr">Aicher <italic toggle="yes">et al.</italic>, 2019</xref>; <xref rid="btab337-B4" ref-type="bibr">Briggs <italic toggle="yes">et al.</italic>, 2018</xref>; <xref rid="btab337-B6" ref-type="bibr">Cao <italic toggle="yes">et al.</italic>, 2017</xref>; <xref rid="btab337-B8" ref-type="bibr">Chen <italic toggle="yes">et al.</italic>, 2019</xref>; <xref rid="btab337-B13" ref-type="bibr">Gehring <italic toggle="yes">et al.</italic>, 2020</xref>; <xref rid="btab337-B15" ref-type="bibr">Gierahn <italic toggle="yes">et al.</italic>, 2017</xref>; <xref rid="btab337-B21" ref-type="bibr">Klein <italic toggle="yes">et al.</italic>, 2015</xref>; <xref rid="btab337-B28" ref-type="bibr">Macosko <italic toggle="yes">et al.</italic>, 2015</xref>; <xref rid="btab337-B31" ref-type="bibr">Natarajan <italic toggle="yes">et al.</italic>, 2019</xref>; <xref rid="btab337-B37" ref-type="bibr">Rosenberg <italic toggle="yes">et al.</italic>, 2018</xref>; <xref rid="btab337-B46" ref-type="bibr">Vitak <italic toggle="yes">et al.</italic>, 2017</xref>; <xref rid="btab337-B50" ref-type="bibr">Zhang <italic toggle="yes">et al.</italic>, 2019</xref>; <xref rid="btab337-B51" ref-type="bibr">Ziegenhain <italic toggle="yes">et al.</italic>, 2017</xref>), so that <italic toggle="yes">biological replication</italic>, meaning data collected from multiple independent biological units such as different research animals or human subjects, is becoming more feasible; biological replication allows generalization of results to the population from which the sample was drawn. However, in studies with biological replication, gene expression is influenced by both cell-specific and subject-specific effects. Therefore, as experiments that include biological replication become more common, statistical frameworks to account for multiple sources of biological variability will be critical, as recently described by Lähnemann <italic toggle="yes">et al.</italic> (<xref rid="btab337-B23" ref-type="bibr">Lahnemann <italic toggle="yes">et al.</italic>, 2020</xref>).</p>
    <p>Crowell <italic toggle="yes">et al.</italic> (<xref rid="btab337-B9" ref-type="bibr">Crowell <italic toggle="yes">et al.</italic>, 2020</xref>) provides a thorough comparison of a variety of DGE methods for scRNA-seq with biological replicates including: (i) marker detection methods, (ii) <italic toggle="yes">pseudobulk</italic> methods, where gene counts are aggregated between cells from different biological samples and (iii) mixed models, where models for gene expression are adjusted for sample-specific or batch effects. This study found that generally pseudobulk methods and mixed models had better statistical characteristics than marker detection methods, in terms of detecting differentially expressed genes with well-controlled false discovery rates (FDRs), and pseudobulk methods had fast computation times. In another study, mixed models were found to be superior alternatives to both pseudobulk and marker detection methods (<xref rid="btab337-B52" ref-type="bibr">Zimmerman <italic toggle="yes">et al.</italic>, 2021</xref>). Marker detection methods were found to have unacceptable FDR due to <italic toggle="yes">pseudoreplication bias</italic>, in which cells from the same individual are correlated but treated as independent replicates, and pseudobulk methods were found to be too conservative, in the sense that too many differentially expressed genes were undiscovered. Alternatively, batch correction methods have been proposed to remove inter-individual differences prior to DS analysis, however, this increases type I error rates and disturbs the rank-order of results as explained in Zimmerman <italic toggle="yes">et al.</italic> (<xref rid="btab337-B52" ref-type="bibr">Zimmerman <italic toggle="yes">et al.</italic>, 2021</xref>).</p>
    <p>Here, we introduce a mathematical framework for modeling different sources of biological variation introduced in scRNA-seq data, and we provide a mathematical justification for the use of pseudobulk methods for DS analysis. These methods provide interpretable results that generalize to a population of research subjects, account for important sources of biological and technical variability and provide adequate FDR control.</p>
    <p>We proceed as follows. First, we present a statistical model linking differences in gene counts at the cellular level to four sources: (i) subject-specific factors (e.g. disease and intervention), (ii) variation between subjects, (iii) variation between cells within subjects and (iv) technical variation introduced by sampling RNA molecules, library preparation and sequencing. Second, we make a formal argument for the validity of a DS test with subjects as the units of analysis and discuss our development of a Bioconductor package that can be incorporated into scRNA-seq analysis workflows. Third, we examine properties of DS testing in practice, comparing cells versus subjects as units of analysis in a simulation study and using available scRNA-seq data from humans and pigs. Finally, we discuss potential shortcomings and future work.</p>
  </sec>
  <sec>
    <title>2 Materials and methods</title>
    <sec>
      <title>2.1 Statistical model</title>
      <p>In bulk RNA-seq studies, gene counts are often assumed to follow a negative binomial distribution (<xref rid="btab337-B17" ref-type="bibr">Hardcastle and Kelly, 2010</xref>; <xref rid="btab337-B24" ref-type="bibr">Leng <italic toggle="yes">et al.</italic>, 2013</xref>; <xref rid="btab337-B25" ref-type="bibr">Love <italic toggle="yes">et al.</italic>, 2014</xref>; <xref rid="btab337-B35" ref-type="bibr">Robinson <italic toggle="yes">et al.</italic>, 2010</xref>). The negative binomial distribution has a convenient interpretation as a hierarchical model, which is particularly useful for sequencing studies. In the first stage of the hierarchy, gene expression for each sample is assumed to follow a gamma distribution with mean expression modeled as a function of sample-specific covariates. When samples correspond to different experimental subjects, the first stage characterizes biological variation in gene expression between subjects. In the second stage, the observed data for each gene, measured as a count, is assumed to follow a Poisson distribution with mean equal to the product of a size factor, such as sequencing depth, and gene expression generated in the first stage. The second stage represents technical variation introduced by the processes of sampling from a population of RNAs, building a cDNA library and sequencing. Increasing sequencing depth can reduce technical variation and achieve more precise expression estimates, and collecting samples from more subjects can increase power to detect differentially expressed genes.</p>
      <p>In contrast, single-cell experiments contain an additional source of biological variation between cells. We propose an extension of the negative binomial model to scRNA-seq data by introducing an additional stage in the model hierarchy.</p>
      <p>For clarity of exposition, we adopt and extend notations similar to (<xref rid="btab337-B25" ref-type="bibr">Love <italic toggle="yes">et al.</italic>, 2014</xref>). In a scRNA-seq experiment with multiple subjects, we assume that the observed data consist of gene counts for <inline-formula id="IE1"><mml:math id="IM1" display="inline" overflow="scroll"><mml:mi>G</mml:mi></mml:math></inline-formula> genes drawn from multiple cells among <inline-formula id="IE2"><mml:math id="IM2" display="inline" overflow="scroll"><mml:mi>n</mml:mi></mml:math></inline-formula> subjects. We also assume that cell types or states have been identified, DS analysis will be performed within each cell type of interest and henceforth, the notation corresponds to one cell type.</p>
      <p>Define <inline-formula id="IE3"><mml:math id="IM3" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ijc</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> to be the count for gene <inline-formula id="IE4"><mml:math id="IM4" display="inline" overflow="scroll"><mml:mi>i</mml:mi></mml:math></inline-formula> in cell <inline-formula id="IE5"><mml:math id="IM5" display="inline" overflow="scroll"><mml:mi>c</mml:mi><mml:mi mathvariant="normal"> </mml:mi></mml:math></inline-formula>collected from subject <inline-formula id="IE6"><mml:math id="IM6" display="inline" overflow="scroll"><mml:mi>j</mml:mi></mml:math></inline-formula>, and a <italic toggle="yes">size factor</italic> <inline-formula id="IE7"><mml:math id="IM7" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> related to the amount of information collected from cell <inline-formula id="IE8"><mml:math id="IM8" display="inline" overflow="scroll"><mml:mi>c</mml:mi></mml:math></inline-formula> in subject <inline-formula id="IE9"><mml:math id="IM9" display="inline" overflow="scroll"><mml:mi>j</mml:mi></mml:math></inline-formula> (<inline-formula id="IE10"><mml:math id="IM10" display="inline" overflow="scroll"><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mi>G</mml:mi></mml:math></inline-formula>; <inline-formula id="IE11"><mml:math id="IM11" display="inline" overflow="scroll"><mml:mi>c</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>;</mml:mo><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:math></inline-formula>). For example, a simple definition of <inline-formula id="IE12"><mml:math id="IM12" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the number of unique molecular identifiers (UMIs) collected from cell <inline-formula id="IE13"><mml:math id="IM13" display="inline" overflow="scroll"><mml:mi>c</mml:mi></mml:math></inline-formula> of subject <inline-formula id="IE14"><mml:math id="IM14" display="inline" overflow="scroll"><mml:mi>j</mml:mi></mml:math></inline-formula>. To measure heterogeneity in expression among different groups, we assume that mean expression for gene <inline-formula id="IE15"><mml:math id="IM15" display="inline" overflow="scroll"><mml:mi>i</mml:mi><mml:mi mathvariant="normal"> </mml:mi></mml:math></inline-formula>in subject <inline-formula id="IE16"><mml:math id="IM16" display="inline" overflow="scroll"><mml:mi>j</mml:mi></mml:math></inline-formula> is influenced by <inline-formula id="IE17"><mml:math id="IM17" display="inline" overflow="scroll"><mml:mi>R</mml:mi></mml:math></inline-formula> subject-specific covariates <inline-formula id="IE18"><mml:math id="IM18" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mo>.</mml:mo></mml:math></inline-formula> Let <inline-formula id="IE19"><mml:math id="IM19" display="inline" overflow="scroll"><mml:mi mathvariant="italic">Gamma</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula> denote the gamma distribution with shape parameter <inline-formula id="IE20"><mml:math id="IM20" display="inline" overflow="scroll"><mml:mi>a</mml:mi></mml:math></inline-formula> and scale parameter <inline-formula id="IE21"><mml:math id="IM21" display="inline" overflow="scroll"><mml:mi>b</mml:mi></mml:math></inline-formula>, <inline-formula id="IE22"><mml:math id="IM22" display="inline" overflow="scroll"><mml:mi mathvariant="italic">Poisson</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula> denote the Poisson distribution with mean <inline-formula id="IE23"><mml:math id="IM23" display="inline" overflow="scroll"><mml:mi>m</mml:mi></mml:math></inline-formula> and <inline-formula id="IE24"><mml:math id="IM24" display="inline" overflow="scroll"><mml:mfenced open="[" close="]" separators="|"><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>Y</mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula> denote the conditional distribution of random variable <inline-formula id="IE25"><mml:math id="IM25" display="inline" overflow="scroll"><mml:mi>X</mml:mi></mml:math></inline-formula> given random variable <inline-formula id="IE26"><mml:math id="IM26" display="inline" overflow="scroll"><mml:mi>Y</mml:mi></mml:math></inline-formula>. To characterize these sources of variation, we consider the following three-stage model:
</p>
      <list list-type="roman-lower">
        <list-item>
          <p>Expression of gene <inline-formula id="IE27"><mml:math id="IM27" display="inline" overflow="scroll"><mml:mi>i</mml:mi></mml:math></inline-formula> in subject <inline-formula id="IE28"><mml:math id="IM28" display="inline" overflow="scroll"><mml:mi>j</mml:mi></mml:math></inline-formula> follows a gamma distribution,
<disp-formula id="E1"><mml:math id="M1" display="block" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="normal">θ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mi mathvariant="normal">Gamma</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="normal">α</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mo>α</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>,</mml:mo></mml:math></disp-formula>where <inline-formula id="IE29"><mml:math id="IM29" display="inline" overflow="scroll"><mml:mi>log</mml:mi><mml:mfenced separators="|"><mml:msub><mml:mi>q</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mfenced><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mi>r</mml:mi></mml:munder><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi mathvariant="normal">β</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>. The dispersion parameter <inline-formula id="IE30"><mml:math id="IM30" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="normal">α</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> will be termed <italic toggle="yes">subject-level variance</italic>. The mean of <inline-formula id="IE31"><mml:math id="IM31" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="normal">θ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is <inline-formula id="IE32"><mml:math id="IM32" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, and its variance is <inline-formula id="IE33"><mml:math id="IM33" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="normal">α</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>.</p>
        </list-item>
        <list-item>
          <p>Given <italic toggle="yes">subject-level expression</italic> <inline-formula id="IE34"><mml:math id="IM34" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="normal">θ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, the <italic toggle="yes">cell-level expression</italic> in cell <inline-formula id="IE35"><mml:math id="IM35" display="inline" overflow="scroll"><mml:mi>c</mml:mi></mml:math></inline-formula>, <inline-formula id="IE36"><mml:math id="IM36" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="normal">λ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ijc</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, follows a gamma distribution,
<disp-formula id="E2"><mml:math id="M2" display="block" overflow="scroll"><mml:mfenced open="[" close="]" separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">λ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ijc</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">θ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>∼</mml:mo><mml:mi mathvariant="normal">Gamma</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="normal">σ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">θ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mi mathvariant="normal">σ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced><mml:mo>.</mml:mo></mml:math></disp-formula>The parameter <inline-formula id="IE37"><mml:math id="IM37" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi mathvariant="normal">σ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math></inline-formula> is termed the <italic toggle="yes">cell-level variance</italic> for subject <inline-formula id="IE38"><mml:math id="IM38" display="inline" overflow="scroll"><mml:mi>j</mml:mi></mml:math></inline-formula>, which is allowed to vary between genes and subjects. The mean of <inline-formula id="IE39"><mml:math id="IM39" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="normal">λ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ijc</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is <inline-formula id="IE40"><mml:math id="IM40" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="normal">θ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, and its variance is <inline-formula id="IE41"><mml:math id="IM41" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi mathvariant="normal">σ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>.</mml:mo></mml:math></inline-formula></p>
        </list-item>
        <list-item>
          <p>Conditional on the cell-level expression <inline-formula id="IE42"><mml:math id="IM42" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="normal">λ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ijc</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, gene counts are modeled using a Poisson distribution,
<disp-formula id="E3"><mml:math id="M3" display="block" overflow="scroll"><mml:mfenced open="[" close="]" separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ijc</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">λ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ijc</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>∼</mml:mo><mml:mi mathvariant="normal">Poisson</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="normal">λ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ijc</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>.</mml:mo></mml:math></disp-formula></p>
        </list-item>
      </list>
      <p>In stage i, variation in expression between subjects is due to differences in covariates via the regression function <inline-formula id="IE43"><mml:math id="IM43" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and residual subject-to-subject variation via the dispersion parameter <inline-formula id="IE44"><mml:math id="IM44" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="normal">α</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>. In stage ii, we assume that we have not measured cell-level covariates, so that variation in expression between cells of the same type occurs only through the dispersion parameter <inline-formula id="IE45"><mml:math id="IM45" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi mathvariant="normal">σ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math></inline-formula>. In stage iii, technical variation in counts is generated from a Poisson distribution. This model implicitly assumes that the only systematic variation in expression is due to subject-level covariates, and for a fixed level of covariates, any additional variation between subjects or cells is due to chance.</p>
      <p>Although, in this work, we only consider the simple model presented above, the model could be extended to allow for systematic variation between cells by imposing a regression model in stage ii. If <inline-formula id="IE46"><mml:math id="IM46" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>c</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>c</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">jcL</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> are <inline-formula id="IE47"><mml:math id="IM47" display="inline" overflow="scroll"><mml:mi>L</mml:mi></mml:math></inline-formula> cell-level covariates, then a log-linear regression model could take the form <inline-formula id="IE48"><mml:math id="IM48" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">log</mml:mi></mml:mrow><mml:mo>⁡</mml:mo><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">θ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ijc</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:munder><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">jcl</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="normal">γ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ijl</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>.</p>
    </sec>
    <sec>
      <title>2.2 Approximation for DS analysis</title>
      <p>It is helpful to inspect the proposed model under a simplifying assumption. Suppose that cell-level variance <inline-formula id="IE49"><mml:math id="IM49" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi mathvariant="normal">σ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>≈</mml:mo><mml:mn>0</mml:mn></mml:math></inline-formula>. Under this assumption, <inline-formula id="IE50"><mml:math id="IM50" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="normal">λ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>≈</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">θ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and the three-stage model reduces to a two-stage model. Define the <italic toggle="yes">aggregated counts</italic> <inline-formula id="IE51"><mml:math id="IM51" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ijc</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, and let <inline-formula id="IE52"><mml:math id="IM52" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>. The marginal distribution of <inline-formula id="IE53"><mml:math id="IM53" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is approximately negative binomial with mean <inline-formula id="IE54"><mml:math id="IM54" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="normal">μ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and variance <inline-formula id="IE55"><mml:math id="IM55" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="normal">μ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">α</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mi mathvariant="normal">μ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math></inline-formula>. This is the model used in DESeq2 (<xref rid="btab337-B25" ref-type="bibr">Love <italic toggle="yes">et al.</italic>, 2014</xref>).</p>
      <p>In practice, this assumption is unlikely to be satisfied, but if we make modest assumptions about the growth rates of the size factors and numbers of cells per subject, we can obtain a useful approximation.<statement id="mthst1"><p><sc>Theorem</sc> 1: The expected value of <inline-formula id="IE56"><mml:math id="IM56" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is <inline-formula id="IE57"><mml:math id="IM57" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="normal">μ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>. Further, if we assume that, for some constants <inline-formula id="IE58"><mml:math id="IM58" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula id="IE59"><mml:math id="IM59" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula>, <inline-formula id="IE60"><mml:math id="IM60" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mrow><mml:msub><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mo>→</mml:mo><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula id="IE61"><mml:math id="IM61" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mrow><mml:msub><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mrow><mml:mo>→</mml:mo><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> as <inline-formula id="IE62"><mml:math id="IM62" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>→</mml:mo><mml:mo>∞</mml:mo></mml:math></inline-formula>, then the variance of <inline-formula id="IE63"><mml:math id="IM63" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is <inline-formula id="IE64"><mml:math id="IM64" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="normal">μ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mfenced open="{" close="}" separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">α</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>o</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced><mml:msubsup><mml:mrow><mml:mi mathvariant="normal">μ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math></inline-formula>.</p></statement><statement id="mthst2"><p><sc>Proof</sc>:</p></statement></p>
      <p>The expected value of <inline-formula id="IE65"><mml:math id="IM65" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is computed by conditioning,
<disp-formula id="E4"><mml:math id="M4" display="block" overflow="scroll"><mml:msub><mml:mrow><mml:mi>E</mml:mi><mml:mo>(</mml:mo><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mi>E</mml:mi><mml:mfenced open="[" close="]" separators="|"><mml:mrow><mml:mi>E</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mfenced open="{" close="}" separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">λ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ijc</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>c</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:math></disp-formula>
 <disp-formula id="E5"><mml:math id="M5" display="block" overflow="scroll"><mml:mo>=</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mi>E</mml:mi><mml:mfenced open="[" close="]" separators="|"><mml:mrow><mml:mi>E</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mrow><mml:msub><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="normal">λ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ijc</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">θ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:math></disp-formula>
 <disp-formula id="E6"><mml:math id="M6" display="block" overflow="scroll"><mml:mo>=</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mi>E</mml:mi><mml:mfenced open="[" close="]" separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="normal">θ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math></disp-formula>
 <disp-formula id="E7"><mml:math id="M7" display="block" overflow="scroll"><mml:mo>=</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></disp-formula></p>
      <p>The variance of <inline-formula id="IE66"><mml:math id="IM66" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is computed using iterative applications of the total variance formula (<xref rid="btab337-B38" ref-type="bibr">Ross, 2019</xref>),
<disp-formula id="E8"><mml:math id="M8" display="block" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="normal">Var</mml:mi><mml:mo>(</mml:mo><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mi mathvariant="normal">Var</mml:mi><mml:mfenced open="[" close="]" separators="|"><mml:mrow><mml:mi>E</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mfenced open="{" close="}" separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">λ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ijc</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>c</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:mi>E</mml:mi><mml:mfenced open="[" close="]" separators="|"><mml:mrow><mml:mi mathvariant="normal">Var</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mfenced open="{" close="}" separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">λ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ijc</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>c</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:math></disp-formula>
 <disp-formula id="E9"><mml:math id="M9" display="block" overflow="scroll"><mml:mo>=</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mi mathvariant="normal">Var</mml:mi><mml:mfenced open="[" close="]" separators="|"><mml:mrow><mml:mrow><mml:msub><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="normal">λ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ijc</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:mi>E</mml:mi><mml:mfenced open="[" close="]" separators="|"><mml:mrow><mml:mrow><mml:msub><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="normal">λ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ijc</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:mfenced></mml:math></disp-formula>
 <disp-formula id="E10"><mml:math id="M10" display="block" overflow="scroll"><mml:mo>=</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mi mathvariant="normal">Var</mml:mi><mml:mfenced open="[" close="]" separators="|"><mml:mrow><mml:mi>E</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mrow><mml:msub><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="normal">λ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ijc</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">θ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:mi>E</mml:mi><mml:mfenced open="[" close="]" separators="|"><mml:mrow><mml:mi mathvariant="normal">Var</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mrow><mml:msub><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="normal">λ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ijc</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">θ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></disp-formula>
 <disp-formula id="E11"><mml:math id="M11" display="block" overflow="scroll"><mml:mo>=</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mi mathvariant="normal">Var</mml:mi><mml:mfenced open="[" close="]" separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="normal">θ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:mi>E</mml:mi><mml:mfenced open="[" close="]" separators="|"><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="normal">σ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:msub><mml:mrow><mml:mi mathvariant="normal">θ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:munder><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mrow></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></disp-formula>
 <disp-formula id="E12"><mml:math id="M12" display="block" overflow="scroll"><mml:mo>=</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:msubsup><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:msub><mml:mrow><mml:mi mathvariant="normal">α</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="normal">σ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mfenced separators="|"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:msub><mml:mrow><mml:mi mathvariant="normal">α</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced><mml:mfenced separators="|"><mml:mrow><mml:mrow><mml:munder><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mrow></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></disp-formula>
 <disp-formula id="E13"><mml:math id="M13" display="block" overflow="scroll"><mml:mo>=</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:msubsup><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mfenced open="{" close="}" separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">α</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="normal">σ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mfenced separators="|"><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">α</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mfenced separators="|"><mml:mrow><mml:mrow><mml:munder><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mrow></mml:mrow></mml:mfenced></mml:mrow><mml:mo>/</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mrow></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></disp-formula>
 <disp-formula id="E14"><mml:math id="M14" display="block" overflow="scroll"><mml:mo>=</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:msubsup><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mfenced open="{" close="}" separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">α</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="normal">σ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mfenced separators="|"><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">α</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mfenced separators="|"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mrow><mml:munder><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mrow></mml:mrow></mml:mfenced><mml:msubsup><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow><mml:mo>/</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mrow><mml:munder><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></disp-formula></p>
      <p>Applying the assumptions <inline-formula id="IE67"><mml:math id="IM67" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mrow><mml:msub><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mo>→</mml:mo><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula id="IE68"><mml:math id="IM68" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mrow><mml:msub><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mrow><mml:mo>→</mml:mo><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> completes the proof. <inline-formula id="IE69"><mml:math id="IM69" display="inline" overflow="scroll"><mml:mi mathvariant="normal">▪</mml:mi></mml:math></inline-formula></p>
      <p>To better illustrate the assumptions of the theorem, consider the case when the size factor <inline-formula id="IE70"><mml:math id="IM70" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mi mathvariant="normal"> </mml:mi></mml:math></inline-formula>is the same for all cells in a sample <inline-formula id="IE71"><mml:math id="IM71" display="inline" overflow="scroll"><mml:mi>j</mml:mi></mml:math></inline-formula> and denote the common size factor as <inline-formula id="IE72"><mml:math id="IM72" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">*</mml:mi></mml:mrow></mml:msubsup><mml:mo>.</mml:mo></mml:math></inline-formula> In this case, <inline-formula id="IE73"><mml:math id="IM73" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mrow><mml:msub><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">*</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> and <inline-formula id="IE74"><mml:math id="IM74" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mrow><mml:msub><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">*</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula>, and the theorem holds. The main idea of the theorem is that if gene counts are summed across cells and the number of cells grows large for each subject, the influence of cell-level variation on the summed counts is negligible.</p>
      <p>Because these assumptions are difficult to validate in practice, we suggest following the guidelines for library complexity in bulk RNA-seq studies. Consider a purified cell type (PCT) study design, in which many cells from a cell type of interest could be isolated and profiled using bulk RNA-seq. The observed counts for the PCT study are analogous to the aggregated counts for one cell type in a scRNA-seq study. Furthermore, guidelines for library complexity in bulk RNA-seq studies apply to data with heterogeneity between cell types, so these recommendations should be sufficient for both PCT and scRNA-seq studies, in which data have been stratified by cell type.<statement id="mthst3"><p><sc>Theorem</sc> 1 implies that when the number of cells per subject is large, the aggregated counts follow a distribution with the same mean and variance structure as the negative binomial model used in many software packages for DS analysis of bulk RNA-seq data.</p></statement></p>
    </sec>
    <sec>
      <title>2.3 Implementation via <italic toggle="yes">aggregateBioVar</italic></title>
      <p>Theorem 1 provides a straightforward approach to estimating regression coefficients <inline-formula id="IE75"><mml:math id="IM75" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="normal">β</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">β</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>R</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, testing hypotheses and constructing confidence intervals that properly account for variation in gene expression between subjects. As an example, consider a simple design in which we compare gene expression for control and treated subjects. We set <inline-formula id="IE76"><mml:math id="IM76" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:math></inline-formula> for all <inline-formula id="IE77"><mml:math id="IM77" display="inline" overflow="scroll"><mml:mi>j</mml:mi></mml:math></inline-formula> and define <inline-formula id="IE78"><mml:math id="IM78" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> as a dummy variable indicating that subject <inline-formula id="IE79"><mml:math id="IM79" display="inline" overflow="scroll"><mml:mi>j</mml:mi></mml:math></inline-formula> belongs to the treated group. Then the regression model from Section 2.1 simplifies to <inline-formula id="IE80"><mml:math id="IM80" display="inline" overflow="scroll"><mml:mi mathvariant="normal">log</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">β</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">β</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula>. The null and alternative hypotheses for the <inline-formula id="IE81"><mml:math id="IM81" display="inline" overflow="scroll"><mml:mi>i</mml:mi></mml:math></inline-formula>-th gene are <inline-formula id="IE82"><mml:math id="IM82" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:msubsup><mml:mo>:</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">β</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:math></inline-formula> and <inline-formula id="IE83"><mml:math id="IM83" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:msubsup><mml:mo>:</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">β</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>≠</mml:mo><mml:mn>0</mml:mn></mml:math></inline-formula>, respectively.</p>
      <p>We have developed the software package <italic toggle="yes">aggregateBioVar</italic> (available on Bioconductor) to facilitate broad adoption of pseudobulk-based DE testing; <italic toggle="yes">aggregateBioVar</italic> includes a detailed vignette, has low code complexity and minimal dependencies and is highly interoperable with existing RNA-seq analysis software using Bioconductor core data structures (<xref rid="btab337-F1" ref-type="fig">Fig. 1</xref>). See <xref rid="sup1" ref-type="supplementary-material">Supplementary Material</xref> for brief example code demonstrating the usage of <italic toggle="yes">aggregateBioVar</italic>.</p>
      <fig position="float" id="btab337-F1">
        <label>Fig. 1.</label>
        <caption>
          <p>Aggregation technique accounting for subject-level variation in DS analysis. For each subject, gene counts are summed for all cells. The resulting matrix contains counts of each genefor each subject and can be analyzed using software for bulk RNA-seq data</p>
        </caption>
        <graphic xlink:href="btab337f1" position="float"/>
      </fig>
    </sec>
  </sec>
  <sec>
    <title>3 Results</title>
    <p>In order to contrast DS analysis with cells as units of analysis versus subjects as units of analysis, we analysed both simulated and experimental data. In our simulation, the analysis focused on transcriptome-wide data simulated from the proposed model for scRNA-seq counts under different numbers of differentially expressed genes and different signal-to-noise ratios. To illustrate scalability and performance of various methods in real-world conditions, we show results in a porcine model of cystic fibrosis and analyses of skin, trachea and lung tissues in human sample datasets.</p>
    <sec>
      <title>3.1 Simulation</title>
      <p>We designed a simulation study to examine characteristics of using subjects or cells as units of analysis for DS testing under data simulated from the proposed model. Gene counts were simulated from the model in Section 2.1. To consider characteristics of a real dataset, we matched fixed quantities and parameters of the model to empirical values from a small airway secretory cell subset from the newborn pig data we present again in Section 3.2. Specifically, we considered a setting in which there were two groups of subjects to compare, containing four and three subjects, respectively with 21 731 genes. For each subject, the number of cells and numbers of UMIs per cell were matched to the pig data. The number of UMIs for cell <inline-formula id="IE84"><mml:math id="IM84" display="inline" overflow="scroll"><mml:mi mathvariant="normal">c</mml:mi></mml:math></inline-formula> was taken to be the size factor <inline-formula id="IE85"><mml:math id="IM85" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> in stage 3 of the proposed model.</p>
      <p>Further, the cell-level variance and subject-level variance parameters were matched to the pig data. Specifically, if <inline-formula id="IE86"><mml:math id="IM86" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ijc</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the count of gene <inline-formula id="IE87"><mml:math id="IM87" display="inline" overflow="scroll"><mml:mi>i</mml:mi></mml:math></inline-formula> in cell <inline-formula id="IE88"><mml:math id="IM88" display="inline" overflow="scroll"><mml:mi>c</mml:mi></mml:math></inline-formula> from pig <inline-formula id="IE89"><mml:math id="IM89" display="inline" overflow="scroll"><mml:mi>j</mml:mi></mml:math></inline-formula>, we defined <inline-formula id="IE90"><mml:math id="IM90" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ijc</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ijc</mml:mi></mml:mrow></mml:msub><mml:mo>/</mml:mo><mml:mrow><mml:msub><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">'</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msub><mml:mrow><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">'</mml:mi></mml:mrow></mml:msup><mml:mi>j</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> to be the normalized expression for cell <inline-formula id="IE91"><mml:math id="IM91" display="inline" overflow="scroll"><mml:mi>c</mml:mi></mml:math></inline-formula> from subject <inline-formula id="IE92"><mml:math id="IM92" display="inline" overflow="scroll"><mml:mi>j</mml:mi></mml:math></inline-formula> and <inline-formula id="IE93"><mml:math id="IM93" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:msubsup><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal"> </mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ijc</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mo>/</mml:mo><mml:mrow><mml:msubsup><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">'</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi mathvariant="normal"> </mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mrow><mml:msub><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">'</mml:mi></mml:mrow></mml:msup><mml:mi>j</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> to be the normalized expression for subject <inline-formula id="IE94"><mml:math id="IM94" display="inline" overflow="scroll"><mml:mi>j</mml:mi></mml:math></inline-formula>. Next, we matched the empirical moments of the distributions of <inline-formula id="IE95"><mml:math id="IM95" display="inline" overflow="scroll"><mml:mfenced open="{" close="}" separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi mathvariant="italic">j</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math></inline-formula> and <inline-formula id="IE96"><mml:math id="IM96" display="inline" overflow="scroll"><mml:mfenced open="{" close="}" separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math></inline-formula> to the population moments. If <inline-formula id="IE97"><mml:math id="IM97" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the sample mean of {<inline-formula id="IE98"><mml:math id="IM98" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>} over <inline-formula id="IE99"><mml:math id="IM99" display="inline" overflow="scroll"><mml:mi>j</mml:mi></mml:math></inline-formula>, <inline-formula id="IE100"><mml:math id="IM100" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the sample variance of {<inline-formula id="IE101"><mml:math id="IM101" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>} over <inline-formula id="IE102"><mml:math id="IM102" display="inline" overflow="scroll"><mml:mi>j</mml:mi></mml:math></inline-formula>, <inline-formula id="IE103"><mml:math id="IM103" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the sample mean of {<inline-formula id="IE104"><mml:math id="IM104" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ijc</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>} over <inline-formula id="IE105"><mml:math id="IM105" display="inline" overflow="scroll"><mml:mi>c</mml:mi></mml:math></inline-formula>, and <inline-formula id="IE106"><mml:math id="IM106" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the sample variance of {<inline-formula id="IE107"><mml:math id="IM107" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ijc</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>} over <inline-formula id="IE108"><mml:math id="IM108" display="inline" overflow="scroll"><mml:mi>c</mml:mi></mml:math></inline-formula>, we fixed the subject-level and cell-level variance parameters to be <inline-formula id="IE109"><mml:math id="IM109" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="normal">α</mml:mi></mml:mrow><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>/</mml:mo><mml:msubsup><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math></inline-formula> and <inline-formula id="IE110"><mml:math id="IM110" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="normal">σ</mml:mi></mml:mrow><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>/</mml:mo><mml:msubsup><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math></inline-formula>, respectively.</p>
      <p>The regression component of the model took the form <inline-formula id="IE111"><mml:math id="IM111" display="inline" overflow="scroll"><mml:mi mathvariant="normal">log</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">β</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="normal">β</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula>, where <inline-formula id="IE112"><mml:math id="IM112" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> is an indicator that subject <inline-formula id="IE113"><mml:math id="IM113" display="inline" overflow="scroll"><mml:mi>j</mml:mi></mml:math></inline-formula> is in group <inline-formula id="IE114"><mml:math id="IM114" display="inline" overflow="scroll"><mml:mn>2</mml:mn></mml:math></inline-formula>. The expression level of gene <inline-formula id="IE115"><mml:math id="IM115" display="inline" overflow="scroll"><mml:mi>i</mml:mi></mml:math></inline-formula> for group 1, <inline-formula id="IE116"><mml:math id="IM116" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="normal">β</mml:mi></mml:mrow><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula>, was matched to the pig data by setting <inline-formula id="IE117"><mml:math id="IM117" display="inline" overflow="scroll"><mml:msup><mml:mrow><mml:mi mathvariant="normal">e</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="normal">β</mml:mi></mml:mrow><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mrow><mml:msubsup><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal"> </mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mrow><mml:msubsup><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal"> </mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ijc</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>/</mml:mo><mml:mrow><mml:msubsup><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">'</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi mathvariant="normal"> </mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mrow><mml:msubsup><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal"> </mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mrow><mml:msubsup><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal"> </mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">'</mml:mi></mml:mrow></mml:msup><mml:mi>j</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>. The expression parameter for the difference between groups 1 and 2, <inline-formula id="IE118"><mml:math id="IM118" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="normal">β</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula>, was varied in order to evaluate the properties of DS analysis under a number of different scenarios.</p>
      <p>Nine simulation settings were considered. First, a random proportion of genes, <inline-formula id="IE119"><mml:math id="IM119" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">DE</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, were flagged as differentially expressed. If a gene was not differentially expressed, the value of <inline-formula id="IE120"><mml:math id="IM120" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="normal">β</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> was set to <inline-formula id="IE121"><mml:math id="IM121" display="inline" overflow="scroll"><mml:mn>0</mml:mn></mml:math></inline-formula>. If a gene was differentially expressed, <inline-formula id="IE122"><mml:math id="IM122" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="normal">β</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> was simulated from a normal distribution with mean <inline-formula id="IE123"><mml:math id="IM123" display="inline" overflow="scroll"><mml:mn>0</mml:mn></mml:math></inline-formula> and standard deviation (SD) <inline-formula id="IE124"><mml:math id="IM124" display="inline" overflow="scroll"><mml:mi mathvariant="normal">τ</mml:mi></mml:math></inline-formula>. The value of <inline-formula id="IE125"><mml:math id="IM125" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">DE</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> describes the relative number of differentially expressed genes in a simulated dataset, and the value of <inline-formula id="IE126"><mml:math id="IM126" display="inline" overflow="scroll"><mml:mi mathvariant="normal">τ</mml:mi></mml:math></inline-formula> controls the signal-to-noise ratio. As <inline-formula id="IE127"><mml:math id="IM127" display="inline" overflow="scroll"><mml:mi mathvariant="normal">τ</mml:mi></mml:math></inline-formula> increases, the width of the distribution of effect sizes increases, so that the signal-to-noise ratio for differentially expressed genes is larger. We considered three values for <inline-formula id="IE128"><mml:math id="IM128" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">DE</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mn>0.01</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mn>0.3</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mn>0.6</mml:mn><mml:mo>}</mml:mo></mml:math></inline-formula>, giving 1%, 30% and 60% of genes as differentially expressed, respectively, and we considered three values for <inline-formula id="IE129"><mml:math id="IM129" display="inline" overflow="scroll"><mml:mi mathvariant="normal">τ</mml:mi><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mn>0.5</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mn>1.0</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mn>1.5</mml:mn><mml:mo>}</mml:mo></mml:math></inline-formula>, representing low, medium and high signal-to-noise ratios, respectively. Comparisons of characteristics of the simulated and real data are shown in <xref rid="sup1" ref-type="supplementary-material">Supplementary Figures S1–S6</xref>.</p>
      <p>For each setting, 100 datasets were simulated, and we compared seven different DS methods. The method <italic toggle="yes">subject</italic> treated subjects as the units of analysis, and statistical tests were performed according to the procedure outlined in Sections 2.2 and 2.3. The other six methods involved DS testing with cells as the units of analysis. Four of the methods were applications of the FindMarkers function in the R package Seurat (<xref rid="btab337-B5" ref-type="bibr">Butler <italic toggle="yes">et al.</italic>, 2018</xref>; <xref rid="btab337-B39" ref-type="bibr">Satija <italic toggle="yes">et al.</italic>, 2015</xref>; <xref rid="btab337-B42" ref-type="bibr">Stuart <italic toggle="yes">et al.</italic>, 2019</xref>) with different options for the type of test performed: for the method <italic toggle="yes">wilcox</italic>, cell counts were normalized, log-transformed and a Wilcoxon rank sum test was performed for each gene; for the method <italic toggle="yes">NB</italic>, cell counts were modeled using a negative binomial generalized linear model; for the method <italic toggle="yes">MAST</italic>, cell counts were modeled using a hurdle model based on the MAST software (<xref rid="btab337-B11" ref-type="bibr">Finak <italic toggle="yes">et al.</italic>, 2015</xref>) and for the method <italic toggle="yes">DESeq2</italic>, cell counts were modeled using the DESeq2 software (<xref rid="btab337-B25" ref-type="bibr">Love <italic toggle="yes">et al.</italic>, 2014</xref>). The other two methods were <italic toggle="yes">Monocle</italic>, which utilized a negative binomial generalized additive model to test for differences in gene expression using the R package Monocle (<xref rid="btab337-B32" ref-type="bibr">Qiu <italic toggle="yes">et al.</italic>, 2017a, b</xref>; <xref rid="btab337-B43" ref-type="bibr">Trapnell <italic toggle="yes">et al.</italic>, 2014</xref>) and <italic toggle="yes">mixed</italic>, which modeled counts using a negative binomial generalized linear mixed model with a random effect to account for differences in gene expression between subjects and DS testing was performed using a Wald test. For each method, the computed <italic toggle="yes">P</italic>-values for all genes were adjusted to control the FDR using the Benjamini–Hochberg procedure (<xref rid="btab337-B3" ref-type="bibr">Benjamini and Hochberg, 1995</xref>).</p>
      <p><xref rid="btab337-F2" ref-type="fig">Figure 2</xref> shows precision-recall (PR) curves averaged over 100 simulated datasets for each simulation setting and method. For a sequence of cutoff values between 0 and 1, precision, also known as positive predictive value (PPV), is the fraction of genes with adjusted <italic toggle="yes">P</italic>-values less than a cutoff (<italic toggle="yes">detected genes</italic>) that are differentially expressed. The recall, also known as the true positive rate (TPR), is the fraction of differentially expressed genes that are detected. According to this criterion, the <italic toggle="yes">subject</italic> method had the best performance, and the degree to which <italic toggle="yes">subject</italic> outperformed the other methods improved with larger values of the signal-to-noise ratio parameter <inline-formula id="IE130"><mml:math id="IM130" display="inline" overflow="scroll"><mml:mi mathvariant="normal">τ</mml:mi></mml:math></inline-formula>.</p>
      <fig position="float" id="btab337-F2">
        <label>Fig. 2.</label>
        <caption>
          <p>PR curves for DS analysis methods. Each panel shows results for 100 simulated datasets in one simulation setting. Rows correspond to different proportions of differentially expressed genes, <inline-formula id="IE131"><mml:math id="IM131" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">DE</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and columns correspond to different SDs of (natural) log fold change, <inline-formula id="IE132"><mml:math id="IM132" display="inline" overflow="scroll"><mml:mi mathvariant="normal">τ</mml:mi></mml:math></inline-formula>. In each panel, PR curves are plotted for each of seven DS analysis methods: subject (red), wilcox (blue), NB (green), MAST (purple), DESeq2 (orange), Monocle (gold) and mixed (brown). The vertical axis gives the precision (PPV) and the horizontal axis gives recall (TPR)</p>
        </caption>
        <graphic xlink:href="btab337f2" position="float"/>
      </fig>
      <p><xref rid="btab337-F3" ref-type="fig">Figure 3a</xref> shows the area under the PR curve (AUPR) for each method and simulation setting. As we observed in <xref rid="btab337-F2" ref-type="fig">Figure 2</xref>, the <italic toggle="yes">subject</italic> method had a larger area under the curve than the other six methods in all simulation settings, with larger differences for higher signal-to-noise ratios. When only 1% of genes were differentially expressed, the <italic toggle="yes">mixed</italic> method had a larger area under the curve than the other five methods.</p>
      <fig position="float" id="btab337-F3">
        <label>Fig. 3.</label>
        <caption>
          <p>Performance measures for DS analysis of simulated data. (<bold>a</bold>) AUPR, (<bold>b</bold>) PPV with adjusted <italic toggle="yes">P</italic>-value cutoff 0.05 and (<bold>c</bold>) NPV with adjusted <italic toggle="yes">P</italic>-value cutoff 0.05 for 7 DS analysis methods. Each panel shows results for 100 simulated datasets in 1 simulation setting. Rows correspond to different proportions of differentially expressed genes, <inline-formula id="IE133"><mml:math id="IM133" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">DE</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and columns correspond to different SDs of (natural) log fold change, <inline-formula id="IE134"><mml:math id="IM134" display="inline" overflow="scroll"><mml:mi mathvariant="normal">τ</mml:mi></mml:math></inline-formula>. The implemented methods are subject (red), wilcox (blue), NB (green), MAST (purple), DESeq2 (orange), monocle (gold) and mixed (brown). The vertical axes give the performance measures, and the horizontal axes label each method</p>
        </caption>
        <graphic xlink:href="btab337f3" position="float"/>
      </fig>
      <p>In practice, often only one cutoff value for the adjusted <italic toggle="yes">P</italic>-value will be chosen to detect genes. <xref rid="btab337-F3" ref-type="fig">Figure 3(b and c)</xref> show the PPV and negative predictive value (NPV) for each method and simulation setting under an adjusted <italic toggle="yes">P</italic>-value cutoff of 0.05. NPV is the fraction of undetected genes that were not differentially expressed.</p>
      <p>The <italic toggle="yes">subject</italic> method had the highest PPV, and the <italic toggle="yes">NB</italic> method had the lowest PPV in all nine simulation settings. Among the other five methods, when the number of differentially expressed genes was small (<inline-formula id="IE135"><mml:math id="IM135" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">DE</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> = 0.01), the <italic toggle="yes">mixed</italic> method had the highest PPV values, whereas for higher numbers of differentially expressed genes (<inline-formula id="IE136"><mml:math id="IM136" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">DE</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> &gt; 0.01), the <italic toggle="yes">DESeq2</italic> method had the highest PPV values. The <italic toggle="yes">wilcox</italic>, <italic toggle="yes">MAST</italic> and <italic toggle="yes">Monocle</italic> methods had intermediate performance in these nine settings.</p>
      <p>Generally, the NPV values were more similar across methods. When only 1% of genes were differentially expressed (<inline-formula id="IE137"><mml:math id="IM137" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">DE</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> = 0.01), all methods had NPV values near 1. For higher numbers of differentially expressed genes (<inline-formula id="IE138"><mml:math id="IM138" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">DE</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> &gt; 0.01), the <italic toggle="yes">subject</italic> method had lower NPV values when <inline-formula id="IE139"><mml:math id="IM139" display="inline" overflow="scroll"><mml:mi mathvariant="normal">τ</mml:mi></mml:math></inline-formula> = 0.5 and similar or higher NPV values when <inline-formula id="IE140"><mml:math id="IM140" display="inline" overflow="scroll"><mml:mi mathvariant="normal">τ</mml:mi></mml:math></inline-formula> &gt; 0.5.</p>
      <p>Results for alternative performance measures, including receiver operating characteristic (ROC) curves, TPRs and false positive rates (FPRs) can be found in <xref rid="sup1" ref-type="supplementary-material">Supplementary Figures S7 and S8</xref>. In general, the method <italic toggle="yes">subject</italic> had lower area under the ROC curve and lower TPR but with lower FPR.</p>
      <p>The computations for each method were performed on the high-performance computing cluster at the University of Iowa. The cluster contains hundreds of computation nodes with varying numbers of processor cores and memory, but all jobs were submitted to the same job queue, ensuring that the relative computation times for these jobs were comparable. <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S9</xref> contains computation times for each method and simulation setting for the 100 simulated datasets. The <italic toggle="yes">subject</italic> method had the shortest average computation times, typically &lt;1 min. Four of the cell-level methods had somewhat longer average computation times, with <italic toggle="yes">MAST</italic> running for 7 min, <italic toggle="yes">wilcox</italic> and <italic toggle="yes">Monocle</italic> running for 9 min and <italic toggle="yes">NB</italic> running for 18 min. Two of the methods had much longer computation times with <italic toggle="yes">DESeq2</italic> running for 186 min and <italic toggle="yes">mixed</italic> running for 334 min.</p>
    </sec>
    <sec>
      <title>3.2 DS analysis of airway epithelial secretory cells in a porcine model of cystic fibrosis</title>
      <p>In addition to simulated data, we analysed an animal model dataset containing large and small airway epithelia from CF and non-CF pigs (<xref rid="btab337-B36" ref-type="bibr">Rogers <italic toggle="yes">et al.</italic>, 2008</xref>). Standard normalization, scaling, clustering and dimension reduction were performed using the R package Seurat version 3.1.1 (<xref rid="btab337-B5" ref-type="bibr">Butler <italic toggle="yes">et al.</italic>, 2018</xref>; <xref rid="btab337-B39" ref-type="bibr">Satija <italic toggle="yes">et al.</italic>, 2015</xref>; <xref rid="btab337-B42" ref-type="bibr">Stuart <italic toggle="yes">et al.</italic>, 2019</xref>). We identified cell types, and our DS analyses focused on comparing expression profiles between large and small airways and CF and non-CF pigs. Here, we present the DS results comparing CF and non-CF pigs only in secretory cells from the small airways. We performed DS analysis using the same seven methods as Section 3.1.</p>
      <p><xref rid="btab337-F4" ref-type="fig">Figure 4a</xref> shows volcano plots summarizing the DS results for the seven methods. The volcano plot for the <italic toggle="yes">subject</italic> method shows three genes with adjusted <italic toggle="yes">P</italic>-value &lt;0.05 (–log<sub>10</sub>(FDR) &gt; 1.3), whereas the other six methods detected a much larger number of genes. The number of genes detected by <italic toggle="yes">wilcox</italic>, <italic toggle="yes">NB</italic>, <italic toggle="yes">MAST</italic>, <italic toggle="yes">DESeq2</italic>, <italic toggle="yes">Monocle</italic> and <italic toggle="yes">mixed</italic> were 6928, 7943, 7368, 4512, 5982 and 821, respectively. Among the three genes detected by <italic toggle="yes">subject</italic>, the genes <italic toggle="yes">CFTR</italic> and <italic toggle="yes">CD36</italic> were detected by all methods, whereas only <italic toggle="yes">subject</italic>, <italic toggle="yes">wilcox</italic>, <italic toggle="yes">MAST</italic> and <italic toggle="yes">Monocle</italic> detected <italic toggle="yes">APOB</italic>. Importantly, although these results specifically target differences in small airway secretory cells and are not directly comparable with other transcriptome studies, previous bulk RNA-seq (<xref rid="btab337-B2" ref-type="bibr">Bartlett <italic toggle="yes">et al.</italic>, 2016</xref>) and microarray (<xref rid="btab337-B41" ref-type="bibr">Stoltz <italic toggle="yes">et al.</italic>, 2010</xref>) studies have suggested few gene expression differences in airway epithelial tissues between CF and non-CF pigs; true differential gene expression between genotypes at birth is therefore likely to be small, as detected by the <italic toggle="yes">subject</italic> method.</p>
      <fig position="float" id="btab337-F4">
        <label>Fig. 4.</label>
        <caption>
          <p>Results for analysis of CF and non-CF pig small airway secretory cells. (<bold>a</bold>) Volcano plots and (<bold>b</bold>) heatmaps of top 50 genes for 7 different DS analysis methods. In (a), vertical axes are negative log<sub>10</sub>-transformed adjusted <italic toggle="yes">P</italic>-values, and horizontal axes are log<sub>2</sub>-transformed fold changes. In (b), rows correspond to different genes, and columns correspond to different pigs. The top 50 genes for each method were defined to be the 50 genes with smallest adjusted <italic toggle="yes">P</italic>-values. Subject-level gene expression scores were computed as the average counts per million for all cells from each subject. NCF = non-CF</p>
        </caption>
        <graphic xlink:href="btab337f4" position="float"/>
      </fig>
      <p><xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S10</xref> shows concordance between adjusted <italic toggle="yes">P</italic>-values for each method. These methods appear to form two clusters: the cell-level methods (<italic toggle="yes">wilcox</italic>, <italic toggle="yes">NB</italic>, <italic toggle="yes">MAST</italic>, <italic toggle="yes">DESeq2</italic> and <italic toggle="yes">Monocle</italic>) and the subject-level method (<italic toggle="yes">subject</italic>), with <italic toggle="yes">mixed</italic> sharing modest concordance with both clusters.</p>
      <p><xref rid="btab337-F4" ref-type="fig">Figure 4b</xref> shows the top 50 genes for each method, defined by the smallest 50 adjusted <italic toggle="yes">P</italic>-values. The <italic toggle="yes">subject</italic> and <italic toggle="yes">mixed</italic> methods are composed of genes that have high inter-group (CF versus non-CF) and low intra-group (between subject) variability, whereas the <italic toggle="yes">wilcox</italic>, <italic toggle="yes">NB</italic>, <italic toggle="yes">MAST</italic>, <italic toggle="yes">DESeq2</italic> and <italic toggle="yes">Monocle</italic> methods tend to be sensitive to a highly variable gene expression pattern from the third CF pig.</p>
      <p>In order to determine the reliability of the unadjusted <italic toggle="yes">P</italic>-values computed by each method, we compared them to the unadjusted <italic toggle="yes">P</italic>-values obtained from a permutation test. First, the CF and non-CF labels were permuted between subjects. For this study, there were 35 distinct permutations of CF and non-CF labels between the 7 pigs. Then, for each method, we defined the permutation test statistic to be the unadjusted <italic toggle="yes">P</italic>-value generated by the method. To obtain <italic toggle="yes">permutation P-values</italic>, we measured the proportion of permutation test statistics less than or equal to the observed test statistic, which is the permutation test statistic under the observed labels. For each method, we compared the permutation <italic toggle="yes">P</italic>-values to the <italic toggle="yes">P</italic>-values directly computed by each method, which we define as the <italic toggle="yes">method P-values</italic>.</p>
      <p><xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S11</xref> shows cumulative distribution functions (CDFs) of permutation <italic toggle="yes">P</italic>-values and method <italic toggle="yes">P</italic>-values. Because the permutation test is calibrated so that the permuted data represent sampling under the null distribution of no gene expression difference between CF and non-CF, agreement between the distributions of the permutation <italic toggle="yes">P</italic>-values and method <italic toggle="yes">P</italic>-values indicate appropriate calibration of type I error control for each method. Overall, the <italic toggle="yes">subject</italic> and <italic toggle="yes">mixed</italic> methods had the highest concordance between permutation and method <italic toggle="yes">P</italic>-values. Specifically, the CDFs are in high agreement for the <italic toggle="yes">subject</italic> method in the range of <italic toggle="yes">P</italic>-values from 0 to 0.2, whereas the <italic toggle="yes">mixed</italic> method has a slight inflation of small <italic toggle="yes">P</italic>-values in the same range compared to the permutation test. All of the other methods compute <italic toggle="yes">P</italic>-values that are much smaller than those computed by the permutation tests. These results suggest that only the <italic toggle="yes">subject</italic> method will exhibit appropriate type I error rate control. The lists of genes detected by the other six methods likely contain many false discoveries.</p>
    </sec>
    <sec>
      <title>3.3 DS analysis of large and small airway ciliated cells in healthy pigs</title>
      <p>Our analysis of CF and non-CF pigs showed that the <italic toggle="yes">subject</italic> method better controlled the FPR of DS analysis when the expected rate of true positives is small; here, using the same animal model, we compare large and small airway ciliated cells which are expected to vary largely.</p>
      <p><xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S12a</xref> shows volcano plots for the results of the seven DS methods described. In this comparison, many genes were detected by all seven methods. We detected 6435, 13733, 12772, 13607, 13105, 14288 and 8318 genes by <italic toggle="yes">subject</italic>, <italic toggle="yes">wilcox</italic>, <italic toggle="yes">NB</italic>, <italic toggle="yes">MAST</italic>, <italic toggle="yes">DESeq2</italic>, <italic toggle="yes">Monocle</italic> and <italic toggle="yes">mixed</italic>, respectively. The volcano plots for <italic toggle="yes">subject</italic> and <italic toggle="yes">mixed</italic> show a stronger association between effect size (absolute log<sub>2</sub>-transformed fold change) and statistical significance (negative log<sub>10</sub>-transformed adjusted <italic toggle="yes">P</italic>-value).</p>
      <p><xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S13</xref> shows concordance between adjusted <italic toggle="yes">P</italic>-values for each method. If we omit <italic toggle="yes">DESeq2</italic>, which seems to be an outlier, the other six methods form two distinct clusters, with cluster 1 composed of <italic toggle="yes">wilcox</italic>, <italic toggle="yes">NB</italic>, <italic toggle="yes">MAST</italic> and <italic toggle="yes">Monocle</italic>, and cluster 2 composed of <italic toggle="yes">subject</italic> and <italic toggle="yes">mixed</italic>. The intra-cluster correlations are between 0.9 and 1, whereas the inter-cluster correlations are between 0.51 and 0.62. This figure suggests that the methods that account for between subject differences in gene expression (<italic toggle="yes">subject</italic> and <italic toggle="yes">mixed</italic>) will detect different sets of genes than the methods that treat cells as the units of analysis.</p>
      <p><xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S12b</xref> shows the top 50 genes for each method, defined as the genes with the 50 smallest adjusted <italic toggle="yes">P</italic>-values. All seven methods identify two distinct groups of genes: those with higher average expression in large airways and those with higher average expression in small airways. The <italic toggle="yes">subject</italic> and <italic toggle="yes">mixed</italic> methods show the highest ratios of inter-group to intra-group variation in gene expression, whereas the other five methods have substantial intra-group variation. This suggests that methods that fail to account for between subject differences in gene expression are more sensitive to biological variation between subjects, leading to more false discoveries.</p>
    </sec>
    <sec>
      <title>3.4 Marker detection for T cells and macrophages from human skin</title>
      <p>Next, we applied our approach for marker detection and DS analysis to published human datasets. Given the similar performances of <italic toggle="yes">wilcox</italic>, <italic toggle="yes">NB</italic>, <italic toggle="yes">MAST</italic>, <italic toggle="yes">DESeq2</italic> and <italic toggle="yes">Monocle</italic>, in the simulations and animal model analysis, we only show the results for <italic toggle="yes">subject</italic>, <italic toggle="yes">wilcox</italic> and <italic toggle="yes">mixed</italic>. We performed marker detection analysis of cells obtained from a study of five human skin punch biopsies (<xref rid="btab337-B40" ref-type="bibr">Sole-Boldo <italic toggle="yes">et al.</italic>, 2020</xref>). Because we are comparing different cells from the same subjects, the <italic toggle="yes">subject</italic> and <italic toggle="yes">mixed</italic> methods can also account for the matching of cells by subject in the regression models.</p>
      <p><xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S14</xref> shows the results of marker detection for T cells and macrophages. For each of these two cell types, the expression profiles are compared to all other cells as in traditional marker detection analysis. <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S14</xref>(c–d) show that generally the shapes of the volcano plots are more similar between the <italic toggle="yes">subject</italic> and <italic toggle="yes">mixed</italic> methods than the <italic toggle="yes">wilcox</italic> method.</p>
      <p>In <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S14(e–f)</xref>, we quantify the ability of each method to correctly identify markers of T cells and macrophages from a database of known cell type markers (<xref rid="btab337-B12" ref-type="bibr">Franzen <italic toggle="yes">et al.</italic>, 2019</xref>). First, the adjusted <italic toggle="yes">P</italic>-values for each method are sorted from smallest to largest. Then, we consider the top <italic toggle="yes">g</italic> genes for each method, which are the <italic toggle="yes">g</italic> genes with the smallest adjusted <italic toggle="yes">P</italic>-values, and find what percentage of these top genes are known markers. For the T cells, (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S14e</xref>), we find that the <italic toggle="yes">subject</italic> and <italic toggle="yes">wilcox</italic> methods produce ranked gene lists with higher frequencies of marker genes than the <italic toggle="yes">mixed</italic> method, with <italic toggle="yes">subject</italic> having a slightly higher detection of known markers than <italic toggle="yes">wilcox</italic>. For macrophages (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S14f</xref>), <italic toggle="yes">wilcox</italic> produces better ranked gene lists of known markers than both <italic toggle="yes">subject</italic> and <italic toggle="yes">wilcox</italic> and again, the <italic toggle="yes">mixed</italic> method has the worst performance. Overall, these results suggest that the current marker detection analysis tools used in common practice, such as <italic toggle="yes">wilcox</italic>, will produce a reliable set of markers.</p>
    </sec>
    <sec>
      <title>3.5 Marker detection for CD66+ and CD66- basal cells from human trachea</title>
      <p>In order to objectively measure the performance of our tested approaches in scRNA-seq DS analysis, we compared them to a gold standard consistent of bulk RNA-seq analysis of purified/sorted cell types. In a scRNA-seq study of human tracheal epithelial cells from healthy subjects and subjects with idiopathic pulmonary fibrosis (IPF), the authors found that the basal cell population contained specialized subtypes (<xref rid="btab337-B7" ref-type="bibr">Carraro <italic toggle="yes">et al.</italic>, 2020</xref>). One such subtype, defined by expression of CD66, was further processed by sorting basal cells according to detection of CD66 and profiling by bulk RNA-seq. Here, we compare the performance of <italic toggle="yes">subject</italic>, <italic toggle="yes">wilcox</italic> and <italic toggle="yes">mixed</italic> to detect cell subtype markers of CD66+ and CD66- basal cells with bulk RNA-seq data from corresponding PCTs. To avoid confounding the results by disease, this analysis is confined to data from six healthy subjects in the dataset.</p>
      <p><xref rid="btab337-F5" ref-type="fig">Figure 5</xref> shows the results of the marker detection analysis. Compared to the T cell and macrophage marker detection analysis in Section 3.4, we note that the CD66+ and CD66-basal cells are not as transcriptionally distinct (<xref rid="btab337-F5" ref-type="fig">Fig. 5a</xref>). The volcano plots for the three scRNA-seq methods have similar shapes, but the <italic toggle="yes">wilcox</italic> and <italic toggle="yes">mixed</italic> methods have inflated adjusted <italic toggle="yes">P</italic>-values relative to <italic toggle="yes">subject</italic> (<xref rid="btab337-F5" ref-type="fig">Fig. 5c</xref>).</p>
      <fig position="float" id="btab337-F5">
        <label>Fig. 5.</label>
        <caption>
          <p>Comparison of methods for detection of CD66+ and CD66- basal cell markers from human trachea. (<bold>a</bold>) t-SNE plot shows CD66+ (turquoise) and CD66- (salmon) basal cells from single-cell RNA-seq profiling of human trachea. (<bold>b</bold>) CD66+ basal cells were identified via detection of CEACAM5 or CEACAM6. (<bold>c</bold>) Volcano plots show results of three methods (subject, wilcox and mixed) used to identify CD66+ and CD66- basal cell marker genes. As a gold standard, results from bulk RNA-seq comparing CD66+ and CD66- basal cells (bulk). (<bold>d</bold>) ROC and PR curves for subject, wilcox and mixed methods using bulk RNA-seq as a gold standard. True positives were identified as those genes in the bulk RNA-seq analysis with FDR &lt; 0.05 and |log<sub>2</sub>(CD66+/CD66–)|&gt;1</p>
        </caption>
        <graphic xlink:href="btab337f5" position="float"/>
      </fig>
      <p><xref rid="btab337-F5" ref-type="fig">Figure 5d</xref> shows ROC and PR curves for the three scRNA-seq methods using the bulk RNA-seq as a gold standard. In the bulk RNA-seq, genes with adjusted <italic toggle="yes">P</italic>-values less than 0.05 and at least a 2-fold difference in gene expression between CD66+ and CD66-basal cells are considered true positives and all others are considered true negatives. <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref> shows performance measures derived from these curves. In terms of identifying the true positives, <italic toggle="yes">wilcox</italic> and <italic toggle="yes">mixed</italic> had better performance (TPR = 0.62 and 0.56, respectively) than <italic toggle="yes">subject</italic> (TPR = 0.34). On the other hand, <italic toggle="yes">subject</italic> had the smallest FPR (0.03) compared to <italic toggle="yes">wilcox</italic> and <italic toggle="yes">mixed</italic> (0.26 and 0.08, respectively) and had a higher PPV (0.38 compared to 0.10 and 0.23). Overall, <italic toggle="yes">mixed</italic> seems to have the best performance, with a good tradeoff between false positive and TPRs.</p>
    </sec>
    <sec>
      <title>3.6 DS analysis of healthy and fibrotic alveolar type II cells and alveolar macrophages from human lung</title>
      <p>We evaluated the performance of our tested approaches for human multi-subject DS analysis in health and disease. <xref rid="btab337-B34" ref-type="bibr">Reyfman <italic toggle="yes">et al.</italic> (2019)</xref> used scRNA-seq to profile cells from the lungs of healthy subjects and those with pulmonary fibrosis disease subtypes, including hypersensitivity pneumonitis, systemic sclerosis-associated and myositis-associated interstitial lung diseases and IPF (<xref rid="btab337-B34" ref-type="bibr">Reyfman <italic toggle="yes">et al.</italic>, 2019</xref>). Further, they used flow cytometry to isolate alveolar type II (AT2) cell and alveolar macrophage (AM) fractions from the lung samples and profiled these PCTs using bulk RNA-seq. We compared the performances of <italic toggle="yes">subject</italic>, <italic toggle="yes">wilcox</italic> and <italic toggle="yes">mixed</italic> for DS analysis of the scRNA-seq from healthy and IPF subjects within AT2 and AM cells using bulk RNA-seq of purified AT2 and AM cell type fractions as a gold standard, similar to the method used in Section 3.5.</p>
      <p>The results of our comparisons are shown in <xref rid="btab337-F6" ref-type="fig">Figure 6</xref>. First, we identified the AT2 and AM cells via clustering (<xref rid="btab337-F6" ref-type="fig">Fig. 6a</xref>) and plotting well-known markers of these two cell types (<xref rid="btab337-F6" ref-type="fig">Fig. 6b</xref>). Next, we used <italic toggle="yes">subject</italic>, <italic toggle="yes">wilcox</italic> and <italic toggle="yes">mixed</italic> to test for differences in expression between healthy and IPF subjects within the AT2 and AM cell populations. Overall, the volcano plots for <italic toggle="yes">subject</italic> and <italic toggle="yes">mixed</italic> look similar with a higher number of genes upregulated in the IPF group, while the <italic toggle="yes">wilcox</italic> method exhibits a much different shape with more genes highly downregulated in the IPF group. <xref rid="btab337-F6" ref-type="fig">Figure 6(e and f)</xref> shows ROC and PR curves for the three scRNA-seq methods using the bulk RNA-seq as a gold standard. As in Section 3.5, in the bulk RNA-seq, genes with adjusted <italic toggle="yes">P</italic>-values less than 0.05 and at least a 2-fold difference in gene expression between healthy and IPF are considered true positives and all others are considered true negatives. <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S2</xref> contains performance measures derived from the ROC and PR curves. For the AT2 cells (<xref rid="btab337-F6" ref-type="fig">Fig. 6e</xref>), <italic toggle="yes">subject</italic> and <italic toggle="yes">mixed</italic> have the same area under the ROC curve (0.82) while the <italic toggle="yes">wilcox</italic> method has slightly smaller area (0.78). Further, <italic toggle="yes">subject</italic> has the highest AUPR (0.21) followed by <italic toggle="yes">mixed</italic> (0.14) and <italic toggle="yes">wilcox</italic> (0.08). For the AM cells (<xref rid="btab337-F6" ref-type="fig">Fig. 6f</xref>), the results are similar to AT2 cells with <italic toggle="yes">subject</italic> having the highest areas under the ROC and PR curves (0.88 and 0.15, respectively), followed by <italic toggle="yes">mixed</italic> (0.86 and 0.05, respectively) and <italic toggle="yes">wilcox</italic> (0.83 and 0.01, respectively). The <italic toggle="yes">subject</italic> method has the strongest type I error rate control and highest PPVs, <italic toggle="yes">wilcox</italic> has the highest TPRs and <italic toggle="yes">mixed</italic> has intermediate performance with better TPRs than subject yet lower FPRs than <italic toggle="yes">wilcox</italic> (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S2</xref>).</p>
      <fig position="float" id="btab337-F6">
        <label>Fig. 6.</label>
        <caption>
          <p>Analysis of AT2 cells and AMs from healthy and IPF lungs. (<bold>a</bold>) t-SNE plot shows AT2 cells (red) and AM (green) from single-cell RNA-seq profiling of human lung from healthy subjects and subjects with IPF. (<bold>b</bold>) AT2 cells and AM express SFTPC and MARCO, respectively. (<bold>c</bold> and <bold>d</bold>) Volcano plots show results of three methods (subject, wilcox and mixed) used to find differentially expressed genes between IPF and healthy lungs in (c) AT2 cells and (d) AM. As a gold standard, results from bulk RNA-seq of isolated AT2 cells and AM comparing IPF and healthy lungs (bulk). (<bold>e</bold> and <bold>f</bold>) ROC and PR curves for subject, wilcox and mixed methods using bulk RNA-seq as a gold standard for (e) AT2 cells and (f) AM. True positives were identified as those genes in the bulk RNA-seq analysis with FDR &lt; 0.05 and |log2(IPF/healthy)|&gt;1</p>
        </caption>
        <graphic xlink:href="btab337f6" position="float"/>
      </fig>
    </sec>
  </sec>
  <sec>
    <title>4 Discussion</title>
    <p>In summary, here we (i) suggested a modeling framework for scRNA-seq data from multiple biological sources, (ii) showed how failing to account for biological variation could inflate the FDR of DS analysis and (iii) provided a formal justification for the validity of ‘pseudobulking’ to allow DS analysis to be performed on scRNA-seq data using software designed for DS analysis of bulk RNA-seq data (<xref rid="btab337-B9" ref-type="bibr">Crowell <italic toggle="yes">et al.</italic>, 2020</xref>; <xref rid="btab337-B27" ref-type="bibr">Lun <italic toggle="yes">et al.</italic>, 2016</xref>; <xref rid="btab337-B29" ref-type="bibr">McCarthy <italic toggle="yes">et al.</italic>, 2017</xref>). Pseudobulking has been tested in real scRNA-seq studies (<xref rid="btab337-B19" ref-type="bibr">Kang <italic toggle="yes">et al.</italic>, 2018</xref>) and benchmarked extensively via simulation (<xref rid="btab337-B9" ref-type="bibr">Crowell <italic toggle="yes">et al.</italic>, 2020</xref>). Because pseudobulk methods operate on gene-by-cell count matrices, they are broadly applicable to various single-cell technologies. It is important to emphasize that the aggregation of counts occurs within cell types or cell states, so that the advantages of single-cell sequencing are retained.</p>
    <p>As scRNA-seq studies grow in scope, due to technological advances making these studies both less labor-intensive and less expensive, biological replication will become the norm. Further, applying computational methods that account for all sources of variation will be necessary to gain better insights into biological systems, operating at the granular level of cells all the way up to the level of populations of subjects. The analyses presented here have illustrated how different results could be obtained when data were analysed using different units of analysis.</p>
    <p>Whereas the pseudobulk method is a simple approach to DS analysis, it has limitations. First, it is assumed that prerequisite steps in the bioinformatic pipeline produced cells that conform to the assumptions of the proposed model. As a counterexample, suppose cells were misclassified, such that cells classified as type A are in reality, composed of a mixture of cells of types A and B. If subjects are composed of different proportions of types A and B, DS results could be due to different cell compositions rather than different mean expression levels.</p>
    <p>Second, there may be imbalances in the numbers of cells collected from different subjects. In a study in which a treatment has the effect of altering the composition of cells, subjects in the treatment and control groups may have different numbers of cells of each cell type. Under normal circumstances, the DS analysis should remain valid because the pseudobulk method accounts for this imbalance via different size factors for each subject. In extreme cases, where only a few cells have been collected for some subjects, interpretation of gene expression differences should be handled with caution. This issue is most likely to arise with rare cell types, in which few or no cells are profiled for any subject. In practice, we have omitted comparisons of gene expression in rare cell types because the gene expression profiles had high variation, and the reliability of the comparisons was questionable.</p>
    <p>Third, the proposed model also ignores many aspects of the gene expression distribution in favor of simplicity. For example, consider a hypothetical gene having heterogeneous expression in CF pigs, where cells were either ‘low expressors’ or ‘high expressors’ versus homogeneous expression in non-CF pigs, where cells were ‘moderate expressors’. In that case, the number of modes in the expression distribution in the CF group (bimodal) and the non-CF group (unimodal) would be different, but the pseudobulk method may not detect a difference, because it is only able to detect differences in mean expression. A richer model might assume cell-level expression is drawn from a non-parametric family of distributions in the second stage of the proposed model rather than a gamma family.</p>
    <p>Improvements in type I and type II error rate control of the DS test could be considered by modeling cell-level gene expression adjusted for potential differences in gene expression between subjects, similar to the <italic toggle="yes">mixed</italic> method in Section 3. The study by Zimmerman <italic toggle="yes">et al.</italic> provides an argument for using mixed models over pseudobulk methods because pseudobulk methods discovered fewer differentially expressed genes. In our simulation study, we also found that the pseudobulk method was conservative, but in some settings, mixed models had inflated FDR. A more powerful statistical test that yields well-controlled FDR could be constructed by considering techniques that estimate all parameters of the hierarchical model. More conventional statistical techniques for hierarchical models, such as maximum likelihood or Bayesian maximum <italic toggle="yes">a posteriori</italic> estimation, could produce less noisy parameter estimates and hence, lead to a more powerful DS test (<xref rid="btab337-B14" ref-type="bibr">Gelman and Hill, 2007</xref>). These approaches will likely yield better type I and type II error rate control, but as we saw for the <italic toggle="yes">mixed</italic> method in our simulation, the computation times can be substantially longer and the computational burden of these methods scale with the number of cells, whereas the pseudobulk method scales with the number of subjects. Future work with mixed models for scRNA-seq data should focus on maintaining scalable and computationally efficient implementation in software.</p>
    <p>Our study highlights user-friendly approaches for analysis of scRNA-seq data from multiple biological replicates. These analyses provide guidance on strengths and weaknesses of different methods in practice. Generally, tests for marker detection, such as the <italic toggle="yes">wilcox</italic> method, are sufficient if type I error rate control is less of a concern than type II error rate and in circumstances where type I error rate is most important, methods like <italic toggle="yes">subject</italic> and <italic toggle="yes">mixed</italic> can be used. Until computationally efficient methods exist to fit hierarchical models incorporating all sources of biological variation inherent to scRNA-seq, we believe that pseudobulk methods are useful tools for obtaining time-efficient DS results with well-controlled FDR.</p>
  </sec>
  <sec sec-type="data-availability">
    <title>Data availability</title>
    <p>The data from pig airway epithelia underlying this article are available in GEO and can be accessed with GEO accession GSE150211. Data for the analysis of human skin biopsies were obtained from GEO accession GSE130973. Data for the analysis of human trachea were obtained from GEO accessions GSE143705 (bulk RNA-seq) and GSE143706 (scRNA-seq). The scRNA-seq data for the analysis of human lung tissue were obtained from GEO accession GSE122960, and the bulk RNA-seq of purified AT2 and AM fractions were shared by the authors immediately upon request.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btab337_supplementary_data</label>
      <media xlink:href="btab337_supplementary_data.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgements</title>
    <p>The authors thank Michael J. Welsh, Joseph Zabner, Kai Wang and Keyan Zarei for careful reading of the manuscript and helpful feedback that improved the clarity and content in the final draft. They also thank Paul A. Reyfman and Alexander V. Misharin for sharing bulk RNA-seq data used in this study. This research was supported in part through computational resources provided by The University of Iowa, Iowa City, Iowa.</p>
    <sec>
      <title>Funding</title>
      <p>This work was supported by the National Institutes of Health [NHLBI K01HL140261]; the Parker B. Francis Fellowship Program; the Cystic Fibrosis Foundation University of Iowa Research Development Program (Bioinformatics Core); a Pilot Grant from the University of Iowa Center for Gene Therapy [NIH NIDDK DK54759] and a Pilot Grant from the University of Iowa Environmental Health Sciences Research Center [NIH NIEHS ES005605].</p>
      <p><italic toggle="yes">Conflict of Interest</italic>: none declared.</p>
    </sec>
  </ack>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btab337-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Aicher</surname><given-names>T.P.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019</year>) <article-title>Seq-Well: a sample-efficient, portable picowell platform for massively parallel single-cell RNA sequencing</article-title>. <source>Methods Mol. Biol</source>., <volume>1979</volume>, <fpage>111</fpage>–<lpage>132</lpage>.<pub-id pub-id-type="pmid">31028635</pub-id></mixed-citation>
    </ref>
    <ref id="btab337-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bartlett</surname><given-names>J.A.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2016</year>) <article-title>Newborn cystic fibrosis pigs have a blunted early response to an inflammatory stimulus</article-title>. <source>Am. J. Respir. Crit. Care Med</source>., <volume>194</volume>, <fpage>845</fpage>–<lpage>854</lpage>.<pub-id pub-id-type="pmid">27027566</pub-id></mixed-citation>
    </ref>
    <ref id="btab337-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Benjamini</surname><given-names>Y.</given-names></string-name>, <string-name><surname>Hochberg</surname><given-names>Y.</given-names></string-name></person-group> (<year>1995</year>) <article-title>Controlling the false discovery rate: a practical and powerful approach to multiple testing</article-title>. <source>J. R. Stat. Soc. Ser. B</source>, <volume>57</volume>, <fpage>289</fpage>–<lpage>300</lpage>.</mixed-citation>
    </ref>
    <ref id="btab337-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Briggs</surname><given-names>J.A.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2018</year>) <article-title>The dynamics of gene expression in vertebrate embryogenesis at single-cell resolution</article-title>. <source>Science</source>, <volume>360</volume>, <fpage>eaar5780</fpage>.<pub-id pub-id-type="pmid">29700227</pub-id></mixed-citation>
    </ref>
    <ref id="btab337-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Butler</surname><given-names>A.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2018</year>) <article-title>Integrating single-cell transcriptomic data across different conditions, technologies, and species</article-title>. <source>Nat. Biotechnol</source>., <volume>36</volume>, <fpage>411</fpage>–<lpage>420</lpage>.<pub-id pub-id-type="pmid">29608179</pub-id></mixed-citation>
    </ref>
    <ref id="btab337-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Cao</surname><given-names>J.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2017</year>) <article-title>Comprehensive single-cell transcriptional profiling of a multicellular organism</article-title>. <source>Science</source>, <volume>357</volume>, <fpage>661</fpage>–<lpage>667</lpage>.<pub-id pub-id-type="pmid">28818938</pub-id></mixed-citation>
    </ref>
    <ref id="btab337-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Carraro</surname><given-names>G.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2020</year>) <article-title>Single-cell reconstruction of human basal cell diversity in normal and idiopathic pulmonary fibrosis lungs</article-title>. <source>Am. J. Respir. Crit. Care Med</source>., <volume>202</volume>, <fpage>1540</fpage>–<lpage>1550</lpage>.<pub-id pub-id-type="pmid">32692579</pub-id></mixed-citation>
    </ref>
    <ref id="btab337-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Chen</surname><given-names>G.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019</year>) <article-title>Single-cell RNA-seq technologies and related computational data analysis</article-title>. <source>Front. Genet</source>., <volume>10</volume>, <fpage>317</fpage>.<pub-id pub-id-type="pmid">31024627</pub-id></mixed-citation>
    </ref>
    <ref id="btab337-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Crowell</surname><given-names>H.L.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2020</year>) <article-title>Muscat detects subpopulation-specific state transitions from multi-sample multi-condition single-cell transcriptomics data</article-title>. <source>Nat. Commun</source>., <volume>11</volume>, <fpage>6077</fpage>.<pub-id pub-id-type="pmid">33257685</pub-id></mixed-citation>
    </ref>
    <ref id="btab337-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Delmans</surname><given-names>M.</given-names></string-name>, <string-name><surname>Hemberg</surname><given-names>M.</given-names></string-name></person-group> (<year>2016</year>) <article-title>Discrete distributional differential expression (D3E)–a tool for gene expression analysis of single-cell RNA-seq data</article-title>. <source>BMC Bioinformatics</source>, <volume>17</volume>, <fpage>110</fpage>.<pub-id pub-id-type="pmid">26927822</pub-id></mixed-citation>
    </ref>
    <ref id="btab337-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Finak</surname><given-names>G.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2015</year>) <article-title>MAST: a flexible statistical framework for assessing transcriptional changes and characterizing heterogeneity in single-cell RNA sequencing data</article-title>. <source>Genome Biol</source>., <volume>16</volume>, <fpage>278</fpage>.<pub-id pub-id-type="pmid">26653891</pub-id></mixed-citation>
    </ref>
    <ref id="btab337-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Franzen</surname><given-names>O.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019</year>) <article-title>PanglaoDB: a web server for exploration of mouse and human single-cell RNA sequencing data</article-title>. <source>Database (Oxford)</source>, <volume>2019</volume>, baz046.</mixed-citation>
    </ref>
    <ref id="btab337-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gehring</surname><given-names>J.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2020</year>) <article-title>Highly multiplexed single-cell RNA-seq by DNA oligonucleotide tagging of cellular proteins</article-title>. <source>Nat. Biotechnol</source>., <volume>38</volume>, <fpage>35</fpage>–<lpage>38</lpage>.<pub-id pub-id-type="pmid">31873215</pub-id></mixed-citation>
    </ref>
    <ref id="btab337-B14">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Gelman</surname><given-names>A.</given-names></string-name>, <string-name><surname>Hill</surname><given-names>J.</given-names></string-name></person-group> (<year>2007</year>) <source>Data Analysis Using Regression and Multilevel/Hierarchical Models</source>. <publisher-name>Cambridge University Press</publisher-name>, <publisher-loc>Cambridge</publisher-loc>, <publisher-loc>NY</publisher-loc>, <publisher-loc>USA</publisher-loc>.</mixed-citation>
    </ref>
    <ref id="btab337-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gierahn</surname><given-names>T.M.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2017</year>) <article-title>Seq-Well: portable, low-cost RNA sequencing of single cells at high throughput</article-title>. <source>Nat. Methods</source>, <volume>14</volume>, <fpage>395</fpage>–<lpage>398</lpage>.<pub-id pub-id-type="pmid">28192419</pub-id></mixed-citation>
    </ref>
    <ref id="btab337-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Guo</surname><given-names>M.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2015</year>) <article-title>SINCERA: a pipeline for single-cell RNA-seq profiling analysis</article-title>. <source>PLoS Comput. Biol</source>., <volume>11</volume>, <fpage>e1004575</fpage>.<pub-id pub-id-type="pmid">26600239</pub-id></mixed-citation>
    </ref>
    <ref id="btab337-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hardcastle</surname><given-names>T.J.</given-names></string-name>, <string-name><surname>Kelly</surname><given-names>K.A.</given-names></string-name></person-group> (<year>2010</year>) <article-title>baySeq: empirical Bayesian methods for identifying differential expression in sequence count data</article-title>. <source>BMC Bioinformatics</source>, <volume>11</volume>, <fpage>422</fpage>.<pub-id pub-id-type="pmid">20698981</pub-id></mixed-citation>
    </ref>
    <ref id="btab337-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hwang</surname><given-names>B.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2018</year>) <article-title>Single-cell RNA sequencing technologies and bioinformatics pipelines</article-title>. <source>Exp. Mol. Med</source>., <volume>50</volume>, <fpage>1</fpage>.</mixed-citation>
    </ref>
    <ref id="btab337-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kang</surname><given-names>H.M.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2018</year>) <article-title>Multiplexed droplet single-cell RNA-sequencing using natural genetic variation</article-title>. <source>Nat. Biotechnol</source>., <volume>36</volume>, <fpage>89</fpage>–<lpage>94</lpage>.<pub-id pub-id-type="pmid">29227470</pub-id></mixed-citation>
    </ref>
    <ref id="btab337-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kharchenko</surname><given-names>P.V.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2014</year>) <article-title>Bayesian approach to single-cell differential expression analysis</article-title>. <source>Nat. Methods</source>, <volume>11</volume>, <fpage>740</fpage>–<lpage>742</lpage>.<pub-id pub-id-type="pmid">24836921</pub-id></mixed-citation>
    </ref>
    <ref id="btab337-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Klein</surname><given-names>A.M.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2015</year>) <article-title>Droplet barcoding for single-cell transcriptomics applied to embryonic stem cells</article-title>. <source>Cell</source>, <volume>161</volume>, <fpage>1187</fpage>–<lpage>1201</lpage>.<pub-id pub-id-type="pmid">26000487</pub-id></mixed-citation>
    </ref>
    <ref id="btab337-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Korthauer</surname><given-names>K.D.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2016</year>) <article-title>A statistical approach for identifying differential distributions in single-cell RNA-seq experiments</article-title>. <source>Genome Biol</source>., <volume>17</volume>, <fpage>222</fpage>.<pub-id pub-id-type="pmid">27782827</pub-id></mixed-citation>
    </ref>
    <ref id="btab337-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lahnemann</surname><given-names>D.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2020</year>) <article-title>Eleven grand challenges in single-cell data science</article-title>. <source>Genome Biol</source>., <volume>21</volume>, <fpage>31</fpage>.<pub-id pub-id-type="pmid">32033589</pub-id></mixed-citation>
    </ref>
    <ref id="btab337-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Leng</surname><given-names>N.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2013</year>) <article-title>EBSeq: an empirical Bayes hierarchical model for inference in RNA-seq experiments</article-title>. <source>Bioinformatics</source>, <volume>29</volume>, <fpage>1035</fpage>–<lpage>1043</lpage>.<pub-id pub-id-type="pmid">23428641</pub-id></mixed-citation>
    </ref>
    <ref id="btab337-B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Love</surname><given-names>M.I.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2014</year>) <article-title>Moderated estimation of fold change and dispersion for RNA-seq data with DESeq2</article-title>. <source>Genome Biol</source>., <volume>15</volume>, <fpage>550</fpage>.<pub-id pub-id-type="pmid">25516281</pub-id></mixed-citation>
    </ref>
    <ref id="btab337-B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Luecken</surname><given-names>M.D.</given-names></string-name>, <string-name><surname>Theis</surname><given-names>F.J.</given-names></string-name></person-group> (<year>2019</year>) <article-title>Current best practices in single-cell RNA-seq analysis: a tutorial</article-title>. <source>Mol. Syst. Biol</source>., <volume>15</volume>, <fpage>e8746</fpage>.<pub-id pub-id-type="pmid">31217225</pub-id></mixed-citation>
    </ref>
    <ref id="btab337-B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lun</surname><given-names>A.T.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2016</year>) <article-title>A step-by-step workflow for low-level analysis of single-cell RNA-seq data with bioconductor</article-title>. <source>F1000Res</source>, <volume>5</volume>, <fpage>2122</fpage>.<pub-id pub-id-type="pmid">27909575</pub-id></mixed-citation>
    </ref>
    <ref id="btab337-B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Macosko</surname><given-names>E.Z.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2015</year>) <article-title>Highly parallel genome-wide expression profiling of individual cells using nanoliter droplets</article-title>. <source>Cell</source>, <volume>161</volume>, <fpage>1202</fpage>–<lpage>1214</lpage>.<pub-id pub-id-type="pmid">26000488</pub-id></mixed-citation>
    </ref>
    <ref id="btab337-B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>McCarthy</surname><given-names>D.J.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2017</year>) <article-title>Scater: pre-processing, quality control, normalization and visualization of single-cell RNA-seq data in R</article-title>. <source>Bioinformatics</source>, <volume>33</volume>, <fpage>1179</fpage>–<lpage>1186</lpage>.<pub-id pub-id-type="pmid">28088763</pub-id></mixed-citation>
    </ref>
    <ref id="btab337-B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Miao</surname><given-names>Z.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2018</year>) <article-title>DEsingle for detecting three types of differential expression in single-cell RNA-seq data</article-title>. <source>Bioinformatics</source>, <volume>34</volume>, <fpage>3223</fpage>–<lpage>3224</lpage>.<pub-id pub-id-type="pmid">29688277</pub-id></mixed-citation>
    </ref>
    <ref id="btab337-B31">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Natarajan</surname><given-names>K.N.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019</year>) <article-title>Comparative analysis of sequencing technologies for single-cell transcriptomics</article-title>. <source>Genome Biol</source>., <volume>20</volume>, <fpage>70</fpage>.<pub-id pub-id-type="pmid">30961669</pub-id></mixed-citation>
    </ref>
    <ref id="btab337-B32">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Qiu</surname><given-names>X.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2017a</year>) <article-title>Single-cell mRNA quantification and differential analysis with Census</article-title>. <source>Nat. Methods</source>, <volume>14</volume>, <fpage>309</fpage>–<lpage>315</lpage>.<pub-id pub-id-type="pmid">28114287</pub-id></mixed-citation>
    </ref>
    <ref id="btab337-B33">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Qiu</surname><given-names>X.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2017b</year>) <article-title>Reversed graph embedding resolves complex single-cell trajectories</article-title>. <source>Nat. Methods</source>, <volume>14</volume>, <fpage>979</fpage>–<lpage>982</lpage>.<pub-id pub-id-type="pmid">28825705</pub-id></mixed-citation>
    </ref>
    <ref id="btab337-B34">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Reyfman</surname><given-names>P.A.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019</year>) <article-title>Single-cell transcriptomic analysis of human lung provides insights into the pathobiology of pulmonary fibrosis</article-title>. <source>Am. J. Respir. Crit. Care Med</source>., <volume>199</volume>, <fpage>1517</fpage>–<lpage>1536</lpage>.<pub-id pub-id-type="pmid">30554520</pub-id></mixed-citation>
    </ref>
    <ref id="btab337-B35">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Robinson</surname><given-names>M.D.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2010</year>) <article-title>edgeR: a Bioconductor package for differential expression analysis of digital gene expression data</article-title>. <source>Bioinformatics</source>, <volume>26</volume>, <fpage>139</fpage>–<lpage>140</lpage>.<pub-id pub-id-type="pmid">19910308</pub-id></mixed-citation>
    </ref>
    <ref id="btab337-B36">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Rogers</surname><given-names>C.S.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2008</year>) <article-title>Disruption of the CFTR gene produces a model of cystic fibrosis in newborn pigs</article-title>. <source>Science</source>, <volume>321</volume>, <fpage>1837</fpage>–<lpage>1841</lpage>.<pub-id pub-id-type="pmid">18818360</pub-id></mixed-citation>
    </ref>
    <ref id="btab337-B37">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Rosenberg</surname><given-names>A.B.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2018</year>) <article-title>Single-cell profiling of the developing mouse brain and spinal cord with split-pool barcoding</article-title>. <source>Science</source>, <volume>360</volume>, <fpage>176</fpage>–<lpage>182</lpage>.<pub-id pub-id-type="pmid">29545511</pub-id></mixed-citation>
    </ref>
    <ref id="btab337-B38">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Ross</surname><given-names>S.M.</given-names></string-name></person-group> (<year>2019</year>) <source>A First Course in Probability</source>. <publisher-name>Pearson</publisher-name>, <publisher-loc>Boston</publisher-loc>.</mixed-citation>
    </ref>
    <ref id="btab337-B39">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Satija</surname><given-names>R.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2015</year>) <article-title>Spatial reconstruction of single-cell gene expression data</article-title>. <source>Nat. Biotechnol</source>., <volume>33</volume>, <fpage>495</fpage>–<lpage>502</lpage>.<pub-id pub-id-type="pmid">25867923</pub-id></mixed-citation>
    </ref>
    <ref id="btab337-B40">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sole-Boldo</surname><given-names>L.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2020</year>) <article-title>Single-cell transcriptomes of the human skin reveal age-related loss of fibroblast priming</article-title>. <source>Commun. Biol</source>., <volume>3</volume>, <fpage>188</fpage>.<pub-id pub-id-type="pmid">32327715</pub-id></mixed-citation>
    </ref>
    <ref id="btab337-B41">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Stoltz</surname><given-names>D.A.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2010</year>) <article-title>Cystic fibrosis pigs develop lung disease and exhibit defective bacterial eradication at birth</article-title>. <source>Sci. Transl. Med</source>., <volume>2</volume>, <fpage>29ra31</fpage>.</mixed-citation>
    </ref>
    <ref id="btab337-B42">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Stuart</surname><given-names>T.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019</year>) <article-title>Comprehensive integration of single-cell data</article-title>. <source>Cell</source>, <volume>177</volume>, <fpage>1888</fpage>–<lpage>1902 e1821</lpage>.<pub-id pub-id-type="pmid">31178118</pub-id></mixed-citation>
    </ref>
    <ref id="btab337-B43">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Trapnell</surname><given-names>C.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2014</year>) <article-title>The dynamics and regulators of cell fate decisions are revealed by pseudotemporal ordering of single cells</article-title>. <source>Nat. Biotechnol</source>., <volume>32</volume>, <fpage>381</fpage>–<lpage>386</lpage>.<pub-id pub-id-type="pmid">24658644</pub-id></mixed-citation>
    </ref>
    <ref id="btab337-B44">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Van den Berge</surname><given-names>K.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019</year>) <article-title>RNA sequencing data: Hitchhiker’s guide to expression analysis</article-title>. <source>Annu. Rev. Biomed. Da S</source>, <volume>2</volume>, <fpage>139</fpage>–<lpage>173</lpage>.</mixed-citation>
    </ref>
    <ref id="btab337-B45">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Vieth</surname><given-names>B.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019</year>) <article-title>A systematic evaluation of single cell RNA-seq analysis pipelines</article-title>. <source>Nat. Commun</source>., <volume>10</volume>, <fpage>4667</fpage>.<pub-id pub-id-type="pmid">31604912</pub-id></mixed-citation>
    </ref>
    <ref id="btab337-B46">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Vitak</surname><given-names>S.A.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2017</year>) <article-title>Sequencing thousands of single-cell genomes with combinatorial indexing</article-title>. <source>Nat. Methods</source>, <volume>14</volume>, <fpage>302</fpage>–<lpage>308</lpage>.<pub-id pub-id-type="pmid">28135258</pub-id></mixed-citation>
    </ref>
    <ref id="btab337-B47">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wang</surname><given-names>T.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019</year>) <article-title>Comparative analysis of differential gene expression analysis tools for single-cell RNA sequencing data</article-title>. <source>BMC Bioinformatics</source>, <volume>20</volume>, <fpage>40</fpage>.<pub-id pub-id-type="pmid">30658573</pub-id></mixed-citation>
    </ref>
    <ref id="btab337-B48">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wang</surname><given-names>T.</given-names></string-name>, <string-name><surname>Nabavi</surname><given-names>S.</given-names></string-name></person-group> (<year>2018</year>) <article-title>SigEMD: A powerful method for differential gene expression analysis in single-cell RNA sequencing data</article-title>. <source>Methods</source>, <volume>145</volume>, <fpage>25</fpage>–<lpage>32</lpage>.<pub-id pub-id-type="pmid">29702224</pub-id></mixed-citation>
    </ref>
    <ref id="btab337-B49">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zaragosi</surname><given-names>L.E.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2020</year>) <article-title>Using single-cell RNA sequencing to unravel cell lineage relationships in the respiratory tract</article-title>. <source>Biochem. Soc. Trans</source>., <volume>48</volume>, <fpage>327</fpage>–<lpage>336</lpage>.<pub-id pub-id-type="pmid">31922198</pub-id></mixed-citation>
    </ref>
    <ref id="btab337-B50">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhang</surname><given-names>X.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019</year>) <article-title>Comparative analysis of droplet-based ultra-high-throughput single-cell RNA-seq systems</article-title>. <source>Mol. Cell</source>, <volume>73</volume>, <fpage>130</fpage>–<lpage>142 e135</lpage>.<pub-id pub-id-type="pmid">30472192</pub-id></mixed-citation>
    </ref>
    <ref id="btab337-B51">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ziegenhain</surname><given-names>C.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2017</year>) <article-title>Comparative analysis of single-cell RNA sequencing methods</article-title>. <source>Mol. Cell</source>, <volume>65</volume>, <fpage>631</fpage>–<lpage>643 e634</lpage>.<pub-id pub-id-type="pmid">28212749</pub-id></mixed-citation>
    </ref>
    <ref id="btab337-B52">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zimmerman</surname><given-names>K.D.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2021</year>) <article-title>A practical solution to pseudoreplication bias in single-cell studies</article-title>. <source>Nat. Commun</source>., <volume>12</volume>, <fpage>738</fpage>.<pub-id pub-id-type="pmid">33531494</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
