<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 39.96?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS One</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS ONE</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-id journal-id-type="pmc">plosone</journal-id>
    <journal-title-group>
      <journal-title>PLoS ONE</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1932-6203</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, CA USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6822939</article-id>
    <article-id pub-id-type="publisher-id">PONE-D-19-16646</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pone.0221238</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Mathematical and Statistical Techniques</subject>
          <subj-group>
            <subject>Statistical Methods</subject>
            <subj-group>
              <subject>Forecasting</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Physical Sciences</subject>
        <subj-group>
          <subject>Mathematics</subject>
          <subj-group>
            <subject>Statistics</subject>
            <subj-group>
              <subject>Statistical Methods</subject>
              <subj-group>
                <subject>Forecasting</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Engineering and Technology</subject>
        <subj-group>
          <subject>Human Factors Engineering</subject>
          <subj-group>
            <subject>Man-Computer Interface</subject>
            <subj-group>
              <subject>Graphical User Interfaces</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Computer and Information Sciences</subject>
        <subj-group>
          <subject>Computer Architecture</subject>
          <subj-group>
            <subject>User Interfaces</subject>
            <subj-group>
              <subject>Graphical User Interfaces</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Mathematical and Statistical Techniques</subject>
          <subj-group>
            <subject>Mathematical Functions</subject>
            <subj-group>
              <subject>Transfer Functions</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Physical Sciences</subject>
        <subj-group>
          <subject>Mathematics</subject>
          <subj-group>
            <subject>Algebra</subject>
            <subj-group>
              <subject>Polynomials</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Physical Sciences</subject>
        <subj-group>
          <subject>Physics</subject>
          <subj-group>
            <subject>Electricity</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Earth Sciences</subject>
        <subj-group>
          <subject>Seasons</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Earth Sciences</subject>
        <subj-group>
          <subject>Atmospheric Science</subject>
          <subj-group>
            <subject>Atmospheric Chemistry</subject>
            <subj-group>
              <subject>Greenhouse Gases</subject>
              <subj-group>
                <subject>Carbon Dioxide</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Physical Sciences</subject>
        <subj-group>
          <subject>Chemistry</subject>
          <subj-group>
            <subject>Environmental Chemistry</subject>
            <subj-group>
              <subject>Atmospheric Chemistry</subject>
              <subj-group>
                <subject>Greenhouse Gases</subject>
                <subj-group>
                  <subject>Carbon Dioxide</subject>
                </subj-group>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Ecology and Environmental Sciences</subject>
        <subj-group>
          <subject>Environmental Chemistry</subject>
          <subj-group>
            <subject>Atmospheric Chemistry</subject>
            <subj-group>
              <subject>Greenhouse Gases</subject>
              <subj-group>
                <subject>Carbon Dioxide</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Physical Sciences</subject>
        <subj-group>
          <subject>Chemistry</subject>
          <subj-group>
            <subject>Chemical Compounds</subject>
            <subj-group>
              <subject>Carbon Dioxide</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Mathematical and Statistical Techniques</subject>
          <subj-group>
            <subject>Mathematical Models</subject>
            <subj-group>
              <subject>Random Walk</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Time series analysis and forecasting with ECOTOOL</article-title>
      <alt-title alt-title-type="running-head">Forecasting with ECOTOOL</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-4958-0969</contrib-id>
        <name>
          <surname>Pedregal</surname>
          <given-names>Diego J.</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Conceptualization</role>
        <role content-type="http://credit.casrai.org/">Data curation</role>
        <role content-type="http://credit.casrai.org/">Formal analysis</role>
        <role content-type="http://credit.casrai.org/">Investigation</role>
        <role content-type="http://credit.casrai.org/">Methodology</role>
        <role content-type="http://credit.casrai.org/">Project administration</role>
        <role content-type="http://credit.casrai.org/">Software</role>
        <role content-type="http://credit.casrai.org/">Supervision</role>
        <role content-type="http://credit.casrai.org/">Validation</role>
        <role content-type="http://credit.casrai.org/">Visualization</role>
        <role content-type="http://credit.casrai.org/">Writing – original draft</role>
        <role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff001"/>
        <xref ref-type="corresp" rid="cor001">*</xref>
      </contrib>
    </contrib-group>
    <aff id="aff001">
      <addr-line>ETSI Industriales, Universidad de Castilla-La Mancha, Ciudad Real, Spain</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Chen</surname>
          <given-names>Feng</given-names>
        </name>
        <role>Editor</role>
        <xref ref-type="aff" rid="edit1"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">
      <addr-line>Tongii University, CHINA</addr-line>
    </aff>
    <author-notes>
      <fn fn-type="COI-statement" id="coi001">
        <p><bold>Competing Interests: </bold>The author has declared that no competing interests exist.</p>
      </fn>
      <corresp id="cor001">* E-mail: <email>Diego.Pedregal@uclm.es</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>31</day>
      <month>10</month>
      <year>2019</year>
    </pub-date>
    <volume>14</volume>
    <issue>10</issue>
    <elocation-id>e0221238</elocation-id>
    <history>
      <date date-type="received">
        <day>12</day>
        <month>6</month>
        <year>2019</year>
      </date>
      <date date-type="accepted">
        <day>2</day>
        <month>8</month>
        <year>2019</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2019 Diego J. Pedregal</copyright-statement>
      <copyright-year>2019</copyright-year>
      <copyright-holder>Diego J. Pedregal</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:href="pone.0221238.pdf"/>
    <abstract>
      <p>This paper presents ECOTOOL, a new free MATLAB toolbox that embodies several routines for identification, validation and forecasting of dynamic models. The toolbox includes a wide range of exploratory, descriptive and diagnostic statistical tools with visual support, designed in easy-to-use Graphical User Interfaces. It also incorporates complex automatic procedures for identification, exact maximum likelihood estimation and outlier detection for many types of models available in the literature (like multi-seasonal ARIMA models, transfer functions, Exponential Smoothing, Unobserved Components, VARX). ECOTOOL is the outcome of a long period of programming effort with the aim of producing a user friendly toolkit such that, just a few lines of code written in MATLAB are able to perform a comprehensive analysis of time series. The toolbox is supplied with an in-depth documentation system and online help and is available on the internet. The paper describes the main functionalities of the toolbox, and its power is shown working on several real examples.</p>
    </abstract>
    <funding-group>
      <funding-statement>This work was supported by the Vicerrectorado de Investigación y Política Científica from UCLM through the research group fund program (PREDILAB; DOCM 24/01/2019 [2019/536]) and by the European Regional Development Fund.</funding-statement>
    </funding-group>
    <counts>
      <fig-count count="7"/>
      <table-count count="6"/>
      <page-count count="23"/>
    </counts>
    <custom-meta-group>
      <custom-meta id="data-availability">
        <meta-name>Data Availability</meta-name>
        <meta-value>Data are available on github: <ext-link ext-link-type="uri" xlink:href="https://github.com/djpt999/ECOTOOL">https://github.com/djpt999/ECOTOOL</ext-link>.</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
  <notes>
    <title>Data Availability</title>
    <p>Data are available on github: <ext-link ext-link-type="uri" xlink:href="https://github.com/djpt999/ECOTOOL">https://github.com/djpt999/ECOTOOL</ext-link>.</p>
  </notes>
</front>
<body>
  <sec sec-type="intro" id="sec001">
    <title>Introduction</title>
    <p>The rapid development of Information and Communication Technologies has open the door to the use of massive amounts of data in virtually any area of science and industry. When trying to forecast such amount of information, there is an imperative need for methods and tools capable of providing automatic, general, efficient and reliable solutions in many different contexts.</p>
    <p>One of such tools for time series analysis and forecasting is ECOTOOL, a new MATLAB toolbox introduced in this paper. It includes routines for well-know methods, like regression, ARIMA(X), Transfer Functions, VAR(X), ExponenTial Smoothing (ETS), but it also includes less common methods, mainly Unobserved Components models (UC). It offers abundant descriptive and diagnostic statistics in friendly Graphical User Interfaces (GUI), automatic procedures of identification and outliers detection, auxiliar functions for building calendar typical intervention variables, additional tools to make routine operations easy and a long list of demos.</p>
    <p>There are some commercial and open-source pieces of software similar and complementary to ECOTOOL: Econometrics and GARCH official MATLAB toolboxes [<xref rid="pone.0221238.ref001" ref-type="bibr">1</xref>], CAPTAIN [<xref rid="pone.0221238.ref002" ref-type="bibr">2</xref>], SCA [<xref rid="pone.0221238.ref003" ref-type="bibr">3</xref>], TRAMO/SEATS [<xref rid="pone.0221238.ref004" ref-type="bibr">4</xref>], forecast package in R [<xref rid="pone.0221238.ref005" ref-type="bibr">5</xref>], gretl [<xref rid="pone.0221238.ref006" ref-type="bibr">6</xref>], STAMP [<xref rid="pone.0221238.ref007" ref-type="bibr">7</xref>], Eviews [<xref rid="pone.0221238.ref008" ref-type="bibr">8</xref>], SAS [<xref rid="pone.0221238.ref009" ref-type="bibr">9</xref>], Stata [<xref rid="pone.0221238.ref010" ref-type="bibr">10</xref>], etc.</p>
    <p>ECOTOOL gathers in a single toolbox many flexible features scattered among other packages that served as inspiration. Many users might find similarities with other pieces of software, mainly CAPTAIN, SCA, TRAMO/SEATS and the forecast package. Most of such similarities have to do with visualisation interfaces, treatment of missing data, automatic identification methods, outliers detection procedures, diagnostic testing, etc.</p>
    <p>But, despite all the similarities with previous work, there are some unique features of ECOTOOL that very rarely are found elsewhere, to the author knowledge. Six most important are: i) automatic identification routines for multi seasonal ARIMA models; ii) estimation of UC and ETS models with inputs modeled as linear transfer functions (also linear regressions, as they are particular cases of transfer functions); iii) estimation of most models by Exact Maximum Likelihood, this is usual for many types of models, but rather unusual for ETS, see e.g. [<xref rid="pone.0221238.ref011" ref-type="bibr">11</xref>]; iv) automatic outliers detection in UC and ETS models; v) particular handy ways to specify transfer function and ARIMA models, since they are directly passed to ECOTOOL as string variables very similar to the analytical expression written on a paper (see the <xref ref-type="sec" rid="sec009">Toolbox overview</xref> section); vi) forecasting transfer function models with stochastic inputs taking into account the uncertainty around univariate forecasts of input variables.</p>
    <p>Further advantages of ECOTOOL, shared with other packages, is that it is integrated with the rest of toolboxes available in MATLAB as a unified environment and it is freely available at <ext-link ext-link-type="uri" xlink:href="https://github.com/djpt999/ECOTOOL">https://github.com/djpt999/ECOTOOL</ext-link>.</p>
    <p>The methods implemented in ECOTOOL have potential applications in many areas of research, from economics to engineering, including many other areas related to life and social sciences or environmental sciences, see e.g., [<xref rid="pone.0221238.ref002" ref-type="bibr">2</xref>, <xref rid="pone.0221238.ref012" ref-type="bibr">12</xref>–<xref rid="pone.0221238.ref019" ref-type="bibr">19</xref>]</p>
    <p>The rest of the paper is organised as follows. Next section shows the main methods available in ECOTOOL. Then, a quick guide to the most important features of the toolbox is presented. Afterwards, several real examples are discussed in depth to show the capabilities of ECOTOOL. Finally, the paper concludes with some relevant remarks.</p>
  </sec>
  <sec id="sec002">
    <title>Models and methods implemented in ECOTOOL</title>
    <p>ECOTOOL offers the possibility of identifying, estimating, testing and forecasting time series by methods with different degrees of complexity, from pure univariate to full multivariate systems. The next sub-sections show the full list of methods implemented.</p>
    <sec id="sec003">
      <title>Naïve methods</title>
      <p>The simplest methods, commonly used as benchmarks, are a set of naïve methods, i.e., mere rules of thumb that needs just simple computations or no computations at all. They are strictly correct under some severe restricting assumptions, but usually most of them have no meaning at all for many time series.</p>
      <p>Let’s call <italic>y</italic><sub><italic>t</italic></sub>, <italic>t</italic> = 1, 2, …, <italic>T</italic> a time series; <italic>s</italic> the seasonal period; <italic>l</italic> the forecasting horizon and ⌊<italic>x</italic>⌋ the integer part of <italic>x</italic>. Then, the <italic>l</italic> steps ahead forecasts conditional on all information available up to time <italic>T</italic> (i.e., <inline-formula id="pone.0221238.e001"><alternatives><graphic xlink:href="pone.0221238.e001.jpg" id="pone.0221238.e001g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M1"><mml:msub><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>T</mml:mi><mml:mo>+</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>) is estimated by each of the naïve methods as shown in <xref rid="pone.0221238.t001" ref-type="table">Table 1</xref>. It is assumed in general that if more sophisticated methods are better in forecasting terms, they should outperform all these naïve options. <italic>Mean</italic> forecasts are just the mean of the in-sample data; <italic>RW</italic> forecasts are just the last observation propagated into the future; <italic>seasonal RW</italic> is the repetition of the last seasonal cycle available; <italic>mean seasonal RW</italic> is the mean of the last seasonal cycle of data; <italic>drift</italic> is a linear forecast with a slope calculated by joining the last and the first observations; <italic>mean drift</italic> is similar but the slope is based on the <italic>mean seasonal RW</italic> forecast.</p>
      <table-wrap id="pone.0221238.t001" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0221238.t001</object-id>
        <label>Table 1</label>
        <caption>
          <title>Naïve methods implemented in function <monospace>modelNAIVE</monospace>.</title>
        </caption>
        <alternatives>
          <graphic id="pone.0221238.t001g" xlink:href="pone.0221238.t001"/>
          <table frame="box" rules="all" border="0">
            <colgroup span="1">
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th align="left" rowspan="1" colspan="1">Method</th>
                <th align="left" rowspan="1" colspan="1">Forecast calculation (<inline-formula id="pone.0221238.e002"><alternatives><graphic id="pone.0221238.e002g" xlink:href="pone.0221238.e002"/><mml:math id="M2"><mml:msub><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>T</mml:mi><mml:mo>+</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>)</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <italic>Mean</italic>
                </td>
                <td align="left" rowspan="1" colspan="1">
                  <inline-formula id="pone.0221238.e003">
                    <alternatives>
                      <graphic id="pone.0221238.e003g" xlink:href="pone.0221238.e003"/>
                      <mml:math id="M3">
                        <mml:mrow>
                          <mml:msubsup>
                            <mml:mo>∑</mml:mo>
                            <mml:mrow>
                              <mml:mi>t</mml:mi>
                              <mml:mo>=</mml:mo>
                              <mml:mn>1</mml:mn>
                            </mml:mrow>
                            <mml:mi>T</mml:mi>
                          </mml:msubsup>
                          <mml:msub>
                            <mml:mi>y</mml:mi>
                            <mml:mi>t</mml:mi>
                          </mml:msub>
                          <mml:mo>/</mml:mo>
                          <mml:mi>T</mml:mi>
                        </mml:mrow>
                      </mml:math>
                    </alternatives>
                  </inline-formula>
                </td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"><italic>Random Walk</italic> (RW)</td>
                <td align="left" rowspan="1" colspan="1">
                  <italic>y</italic>
                  <sub>
                    <italic>T</italic>
                  </sub>
                </td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <italic>Seasonal RW</italic>
                </td>
                <td align="left" rowspan="1" colspan="1">
                  <italic>y</italic>
                  <sub><italic>T</italic>+<italic>l</italic>−(⌊(<italic>l</italic>−1)/<italic>s</italic>⌋+1)<italic>s</italic></sub>
                </td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <italic>Mean Seasonal RW</italic>
                </td>
                <td align="left" rowspan="1" colspan="1"><inline-formula id="pone.0221238.e004"><alternatives><graphic id="pone.0221238.e004g" xlink:href="pone.0221238.e004"/><mml:math id="M4"><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mi>l</mml:mi><mml:mo>-</mml:mo><mml:mi>s</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>l</mml:mi></mml:msubsup><mml:msub><mml:mover accent="true"><mml:mi>z</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>T</mml:mi><mml:mo>+</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>, where <inline-formula id="pone.0221238.e005"><alternatives><graphic id="pone.0221238.e005g" xlink:href="pone.0221238.e005"/><mml:math id="M5"><mml:msub><mml:mover accent="true"><mml:mi>z</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>T</mml:mi><mml:mo>+</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> are the <italic>seasonal RW</italic> forecasts</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <italic>Drift</italic>
                </td>
                <td align="left" rowspan="1" colspan="1"><italic>y</italic><sub><italic>t</italic></sub> + (<italic>y</italic><sub><italic>T</italic></sub> − <italic>y</italic><sub>1</sub>) × <italic>l</italic>/(<italic>T</italic> − 1)</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <italic>Mean Drift</italic>
                </td>
                <td align="left" rowspan="1" colspan="1"><italic>y</italic><sub><italic>t</italic></sub> + (<italic>x</italic><sub><italic>T</italic></sub> − <italic>y</italic><sub>1</sub>) × <italic>l</italic>/(<italic>T</italic> − 1), where <italic>x</italic><sub><italic>T</italic></sub> is the mean of the data in the last season available</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
      </table-wrap>
      <p>All these naïve methods are implemented in the function <monospace>modelNAIVE</monospace>.</p>
    </sec>
    <sec id="sec004">
      <title>ARIMA</title>
      <p>The ARIMA models implemented in ECOTOOL in the function <monospace>modelTF</monospace> are rather general [<xref rid="pone.0221238.ref012" ref-type="bibr">12</xref>], since it allows for multiple seasonal polynomials. This is what some authors have called multi-seasonal ARIMA models. The general formulation is in <xref ref-type="disp-formula" rid="pone.0221238.e008">Eq (1)</xref>, where <italic>z</italic><sub><italic>t</italic></sub> is a stationary time series; <italic>B</italic> is the back-shift operator such that <italic>B</italic><sup><italic>l</italic></sup>
<italic>z</italic><sub><italic>t</italic></sub> = <italic>z</italic><sub><italic>t</italic>−<italic>l</italic></sub>; <inline-formula id="pone.0221238.e006"><alternatives><graphic xlink:href="pone.0221238.e006.jpg" id="pone.0221238.e006g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M6"><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:msub><mml:mi>Q</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mi>B</mml:mi><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msup><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pone.0221238.e007"><alternatives><graphic xlink:href="pone.0221238.e007.jpg" id="pone.0221238.e007g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M7"><mml:mrow><mml:msub><mml:mi>ϕ</mml:mi><mml:msub><mml:mi>P</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mi>B</mml:mi><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msup><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> are moving average and autoregressive polynomials of order <italic>Q</italic><sub><italic>i</italic></sub> and <italic>P</italic><sub><italic>i</italic></sub>, respectively, in which the exponent of the backshift operator in each summand is a multiple of the seasonal frequency, <italic>s</italic><sub><italic>i</italic></sub> (<italic>i</italic> = 1, 2, …, <italic>k</italic>); and <italic>a</italic><sub><italic>t</italic></sub> is a Gaussian serially independent white noise with zero mean and constant variance.
<disp-formula id="pone.0221238.e008"><alternatives><graphic xlink:href="pone.0221238.e008.jpg" id="pone.0221238.e008g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M8"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:msub><mml:mi>Q</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>B</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mi>ϕ</mml:mi><mml:msub><mml:mi>P</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>B</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mfrac><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:msub><mml:mi>Q</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mi>B</mml:mi><mml:msub><mml:mi>s</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:msup><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mi>ϕ</mml:mi><mml:msub><mml:mi>P</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mi>B</mml:mi><mml:msub><mml:mi>s</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:msup><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mfrac><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:msub><mml:mi>Q</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mi>B</mml:mi><mml:msub><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:msup><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mi>ϕ</mml:mi><mml:msub><mml:mi>P</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mi>B</mml:mi><mml:msub><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:msup><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>⋯</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:msub><mml:mi>Q</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mi>B</mml:mi><mml:msub><mml:mi>s</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:msup><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mi>ϕ</mml:mi><mml:msub><mml:mi>P</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mi>B</mml:mi><mml:msub><mml:mi>s</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:msup><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:msub><mml:mi>a</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(1)</label></disp-formula></p>
      <p>Time series <italic>z</italic><sub><italic>t</italic></sub> in <xref ref-type="disp-formula" rid="pone.0221238.e008">Eq (1)</xref> is assumed stationary, but usually is the result of applying the differencing operators to a non stationary time series <italic>y</italic><sub><italic>t</italic></sub>, as in <xref ref-type="disp-formula" rid="pone.0221238.e009">Eq (2)</xref>.
<disp-formula id="pone.0221238.e009"><alternatives><graphic xlink:href="pone.0221238.e009.jpg" id="pone.0221238.e009g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M9"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>B</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:msup><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msup><mml:mi>B</mml:mi><mml:msub><mml:mi>s</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:msup><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:msup><mml:mo>…</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msup><mml:mi>B</mml:mi><mml:msub><mml:mi>s</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:msup><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:msup><mml:msub><mml:mi>y</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(2)</label></disp-formula></p>
      <p>ECOTOOL offers an automatic identification procedure inspired in [<xref rid="pone.0221238.ref005" ref-type="bibr">5</xref>] applied to multi seasonal ARIMA models. It is effectively a much more complex process than [<xref rid="pone.0221238.ref014" ref-type="bibr">14</xref>] in the sense that identification is fully automatic and that it allows for moving average terms. As far as the author is concerned, this is the first time such identification procedure is implemented successfully in a time series package for multi seasonal models (see the ‘<xref ref-type="sec" rid="sec010">Case studies</xref>’ section below).</p>
    </sec>
    <sec id="sec005">
      <title>Unobserved Components (UC)</title>
      <p>ECOTOOL allows for UC models known as a Basic Structural Model of Harvey in the function <monospace>modelUC</monospace> [<xref rid="pone.0221238.ref013" ref-type="bibr">13</xref>]. The formulation of this model is shown in <xref ref-type="disp-formula" rid="pone.0221238.e010">Eq (3)</xref>, where a time series <italic>y</italic><sub><italic>t</italic></sub> is decomposed into a long term trend (<italic>T</italic><sub><italic>t</italic></sub>), a seasonal component (<italic>S</italic><sub><italic>t</italic></sub>) and an irregular component (<italic>I</italic><sub><italic>t</italic></sub>).
<disp-formula id="pone.0221238.e010"><alternatives><graphic xlink:href="pone.0221238.e010.jpg" id="pone.0221238.e010g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M10"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(3)</label></disp-formula></p>
      <p>Particular formulations are possible by selecting different alternatives of each component. For trend models, the possibilities are condensed in <xref ref-type="disp-formula" rid="pone.0221238.e015">Eq (4)</xref>, where <inline-formula id="pone.0221238.e011"><alternatives><graphic xlink:href="pone.0221238.e011.jpg" id="pone.0221238.e011g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M11"><mml:msubsup><mml:mi>T</mml:mi><mml:mi>t</mml:mi><mml:mo>*</mml:mo></mml:msubsup></mml:math></alternatives></inline-formula> is referred to as the trend ‘slope’, <italic>α</italic> is a parameter between zero and one, and <italic>η</italic><sub><italic>t</italic></sub> and <inline-formula id="pone.0221238.e012"><alternatives><graphic xlink:href="pone.0221238.e012.jpg" id="pone.0221238.e012g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M12"><mml:msubsup><mml:mi>η</mml:mi><mml:mi>t</mml:mi><mml:mo>*</mml:mo></mml:msubsup></mml:math></alternatives></inline-formula> are independent white noise sequences with variances <inline-formula id="pone.0221238.e013"><alternatives><graphic xlink:href="pone.0221238.e013.jpg" id="pone.0221238.e013g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M13"><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>η</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:math></alternatives></inline-formula> and <inline-formula id="pone.0221238.e014"><alternatives><graphic xlink:href="pone.0221238.e014.jpg" id="pone.0221238.e014g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M14"><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:msup><mml:mi>η</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:math></alternatives></inline-formula>, respectively.
<disp-formula id="pone.0221238.e015"><alternatives><graphic xlink:href="pone.0221238.e015.jpg" id="pone.0221238.e015g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M15"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo>[</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msubsup><mml:mi>T</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>*</mml:mo></mml:msubsup></mml:mtd></mml:mtr></mml:mtable><mml:mo>]</mml:mo><mml:mo>=</mml:mo><mml:mo>[</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:mi>α</mml:mi></mml:mtd><mml:mtd><mml:mn>1</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>1</mml:mn></mml:mtd></mml:mtr></mml:mtable><mml:mo>]</mml:mo><mml:mo>[</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mi>T</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msubsup><mml:mi>T</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mo>*</mml:mo></mml:msubsup></mml:mtd></mml:mtr></mml:mtable><mml:mo>]</mml:mo><mml:mo>+</mml:mo><mml:mo>[</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mi>η</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msubsup><mml:mi>η</mml:mi><mml:mi>t</mml:mi><mml:mo>*</mml:mo></mml:msubsup></mml:mtd></mml:mtr></mml:mtable><mml:mo>]</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(4)</label></disp-formula></p>
      <p>This model is called Generalised Random Walk Trend and subsumes the following specific cases implemented in ECOTOOL: i) Random Walk (RW), by eliminating the second equation and <italic>α</italic> = 1; ii) Integrated Random Walk (IRW) with <italic>α</italic> = 1 and <inline-formula id="pone.0221238.e016"><alternatives><graphic xlink:href="pone.0221238.e016.jpg" id="pone.0221238.e016g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M16"><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>η</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>; iii) Smoothed Random Walk (SRW) with <inline-formula id="pone.0221238.e017"><alternatives><graphic xlink:href="pone.0221238.e017.jpg" id="pone.0221238.e017g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M17"><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>η</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>; and iv) Local Linear Trend (LLT) with <italic>α</italic> = 1, see e.g., [<xref rid="pone.0221238.ref013" ref-type="bibr">13</xref>], [<xref rid="pone.0221238.ref002" ref-type="bibr">2</xref>] and [<xref rid="pone.0221238.ref020" ref-type="bibr">20</xref>].</p>
      <p>Seasonal components are included as the so called dummy seasonality [<xref rid="pone.0221238.ref013" ref-type="bibr">13</xref>], that depends on a single parameter, namely the variance of white noise <italic>ω</italic><sub><italic>t</italic></sub>, see <xref ref-type="disp-formula" rid="pone.0221238.e018">Eq (5)</xref>.
<disp-formula id="pone.0221238.e018"><alternatives><graphic xlink:href="pone.0221238.e018.jpg" id="pone.0221238.e018g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M18"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mo>[</mml:mo><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mn>3</mml:mn><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mo>⋮</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mtd></mml:mtr></mml:mtable><mml:mo>]</mml:mo><mml:mo>=</mml:mo><mml:mo mathvariant="bold">Ψ</mml:mo><mml:mo>[</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mn>3</mml:mn><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>⋮</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr></mml:mtable><mml:mo>]</mml:mo><mml:mo>+</mml:mo><mml:mo>[</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mi>ω</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>⋮</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr></mml:mtable><mml:mo>]</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mtext>with</mml:mtext><mml:mo mathvariant="bold">Ψ</mml:mo><mml:mo>=</mml:mo><mml:mo>[</mml:mo><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mo>⋯</mml:mo></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mn>1</mml:mn></mml:mtd><mml:mtd columnalign="left"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="left"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="left"><mml:mo>⋯</mml:mo></mml:mtd><mml:mtd columnalign="left"><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="left"><mml:mn>1</mml:mn></mml:mtd><mml:mtd columnalign="left"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="left"><mml:mo>⋯</mml:mo></mml:mtd><mml:mtd columnalign="left"><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mo>⋮</mml:mo></mml:mtd><mml:mtd columnalign="left"><mml:mo>⋮</mml:mo></mml:mtd><mml:mtd columnalign="left"><mml:mo>⋮</mml:mo></mml:mtd><mml:mtd columnalign="left"><mml:mo>⋱</mml:mo></mml:mtd><mml:mtd columnalign="left"><mml:mo>⋮</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="left"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="left"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="left"><mml:mo>⋯</mml:mo></mml:mtd><mml:mtd columnalign="left"><mml:mn>0</mml:mn></mml:mtd></mml:mtr></mml:mtable><mml:mo>]</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(5)</label></disp-formula></p>
      <p>The full UC model is built by assembling all the State Space models for the components. As a matter of fact, <xref ref-type="disp-formula" rid="pone.0221238.e010">Eq (3)</xref> is the observation equation of a State Space system and the block concatenation of all models for the trend in <xref ref-type="disp-formula" rid="pone.0221238.e015">Eq (4)</xref> and seasonal in <xref ref-type="disp-formula" rid="pone.0221238.e018">Eq (5)</xref> form the transition equation. The Kalman Filter and other recursive algorithm provides the optimal solution to state estimation, see details in [<xref rid="pone.0221238.ref002" ref-type="bibr">2</xref>, <xref rid="pone.0221238.ref013" ref-type="bibr">13</xref>, <xref rid="pone.0221238.ref020" ref-type="bibr">20</xref>].</p>
    </sec>
    <sec id="sec006">
      <title>ExponenTial Smoothing (ETS)</title>
      <p>The ETS models implemented in function <monospace>modelETS</monospace> are taken from [<xref rid="pone.0221238.ref011" ref-type="bibr">11</xref>], see <xref rid="pone.0221238.t002" ref-type="table">Table 2</xref> for the full list of possibilities. Multiplicative forms are possible by using the log transformation.</p>
      <table-wrap id="pone.0221238.t002" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0221238.t002</object-id>
        <label>Table 2</label>
        <caption>
          <title>ETS type of components in <monospace>modelETS</monospace>.</title>
        </caption>
        <alternatives>
          <graphic id="pone.0221238.t002g" xlink:href="pone.0221238.t002"/>
          <table frame="box" rules="all" border="0">
            <colgroup span="1">
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th align="left" rowspan="1" colspan="1">Code</th>
                <th align="left" rowspan="1" colspan="1">Model</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" rowspan="2" colspan="1">NN</td>
                <td align="left" rowspan="1" colspan="1"><italic>y</italic><sub><italic>t</italic></sub> = <italic>l</italic><sub><italic>t</italic>−1</sub> + <italic>e</italic><sub><italic>t</italic></sub></td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"><italic>l</italic><sub><italic>t</italic></sub> = <italic>l</italic><sub><italic>t</italic>−1</sub> + <italic>αe</italic><sub><italic>t</italic></sub></td>
              </tr>
              <tr>
                <td align="left" rowspan="3" colspan="1">AN</td>
                <td align="left" rowspan="1" colspan="1"><italic>y</italic><sub><italic>t</italic></sub> = <italic>l</italic><sub><italic>t</italic>−1</sub> + <italic>b</italic><sub><italic>t</italic>−1</sub> + <italic>e</italic><sub><italic>t</italic></sub></td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"><italic>l</italic><sub><italic>t</italic></sub> = <italic>l</italic><sub><italic>t</italic>−1</sub> + <italic>b</italic><sub><italic>t</italic>−1</sub> + <italic>αe</italic><sub><italic>t</italic></sub></td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"><italic>b</italic><sub><italic>t</italic></sub> = <italic>b</italic><sub><italic>t</italic>−1</sub> + <italic>βe</italic><sub><italic>t</italic></sub></td>
              </tr>
              <tr>
                <td align="left" rowspan="3" colspan="1">DN</td>
                <td align="left" rowspan="1" colspan="1"><italic>y</italic><sub><italic>t</italic></sub> = <italic>l</italic><sub><italic>t</italic>−1</sub> + <italic>b</italic><sub><italic>t</italic>−1</sub>+ <italic>e</italic><sub><italic>t</italic></sub></td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"><italic>l</italic><sub><italic>t</italic></sub> = <italic>l</italic><sub><italic>t</italic>−1</sub> + <italic>b</italic><sub><italic>t</italic>−1</sub> + <italic>αe</italic><sub><italic>t</italic></sub></td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"><italic>b</italic><sub><italic>t</italic></sub> = <italic>ϕb</italic><sub><italic>t</italic>−1</sub> + <italic>βe</italic><sub><italic>t</italic></sub></td>
              </tr>
              <tr>
                <td align="left" rowspan="2" colspan="1">NA</td>
                <td align="left" rowspan="1" colspan="1"><italic>y</italic><sub><italic>t</italic></sub> = <italic>S</italic><sub><italic>t</italic>−<italic>s</italic></sub> + <italic>e</italic><sub><italic>t</italic></sub></td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"><italic>S</italic><sub><italic>t</italic></sub> = <italic>S</italic><sub><italic>t</italic>−<italic>s</italic></sub> + <italic>γe</italic><sub><italic>t</italic></sub></td>
              </tr>
              <tr>
                <td align="left" rowspan="4" colspan="1">AA</td>
                <td align="left" rowspan="1" colspan="1"><italic>y</italic><sub><italic>t</italic></sub> = <italic>l</italic><sub><italic>t</italic>−1</sub> + <italic>b</italic><sub><italic>t</italic>−1</sub> + <italic>S</italic><sub><italic>t</italic>−<italic>s</italic></sub> + <italic>e</italic><sub><italic>t</italic></sub></td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"><italic>l</italic><sub><italic>t</italic></sub> = <italic>l</italic><sub><italic>t</italic>−1</sub> + <italic>b</italic><sub><italic>t</italic>−1</sub> + <italic>αe</italic><sub><italic>t</italic></sub></td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"><italic>b</italic><sub><italic>t</italic></sub> = <italic>b</italic><sub><italic>t</italic>−1</sub> + <italic>βe</italic><sub><italic>t</italic></sub></td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"><italic>S</italic><sub><italic>t</italic></sub> = <italic>S</italic><sub><italic>t</italic>−<italic>s</italic></sub> + <italic>γe</italic><sub><italic>t</italic></sub></td>
              </tr>
              <tr>
                <td align="left" rowspan="4" colspan="1">DA</td>
                <td align="left" rowspan="1" colspan="1"><italic>y</italic><sub><italic>t</italic></sub> = <italic>l</italic><sub><italic>t</italic>−1</sub> + <italic>b</italic><sub><italic>t</italic>−1</sub> + <italic>S</italic><sub><italic>t</italic>−<italic>s</italic></sub> + <italic>e</italic><sub><italic>t</italic></sub></td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"><italic>l</italic><sub><italic>t</italic></sub> = <italic>l</italic><sub><italic>t</italic>−1</sub> + <italic>b</italic><sub><italic>t</italic>−1</sub> + <italic>αe</italic><sub><italic>t</italic></sub></td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"><italic>b</italic><sub><italic>t</italic></sub> = <italic>ϕb</italic><sub><italic>t</italic>−1</sub> + <italic>βe</italic><sub><italic>t</italic></sub></td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"><italic>S</italic><sub><italic>t</italic></sub> = <italic>S</italic><sub><italic>t</italic>−<italic>s</italic></sub> + <italic>γe</italic><sub><italic>t</italic></sub></td>
              </tr>
            </tbody>
          </table>
        </alternatives>
      </table-wrap>
      <p>In <xref rid="pone.0221238.t002" ref-type="table">Table 2</xref>, <italic>l</italic><sub><italic>t</italic></sub>, <italic>b</italic><sub><italic>t</italic></sub>, <italic>S</italic><sub><italic>t</italic></sub> and <italic>e</italic><sub><italic>t</italic></sub> stand for the level, slope, seasonal and irregular components respectively; and <italic>α</italic>, <italic>β</italic>, <italic>γ</italic> and <italic>ϕ</italic> are unknown parameters that should be estimated. The code is composed of two letters and defines the model components, the first letter specifies the trend and the second letter is reserved for the seasonal component. ‘N’ indicates that the component is not present; ‘A’ implies that the component is additive; ‘D’ implies a damped component, applicable to trends only (with 0 &lt; <italic>ϕ</italic> &lt; 1). When specifying an ETS model with a seasonal component, the two letters ought to be followed by a number indicating the fundamental period in samples per cycle.</p>
    </sec>
    <sec id="sec007">
      <title>Transfer function (TF)</title>
      <p>Multiple Input Single Output TF models are implemented in ECOTOOL by means of the <monospace>modelTF</monospace> function. The model may be written as in <xref ref-type="disp-formula" rid="pone.0221238.e019">Eq (6)</xref>.
<disp-formula id="pone.0221238.e019"><alternatives><graphic xlink:href="pone.0221238.e019.jpg" id="pone.0221238.e019g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M19"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>h</mml:mi></mml:munderover><mml:mfrac><mml:mrow><mml:msub><mml:mi>ω</mml:mi><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>B</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mi>δ</mml:mi><mml:msub><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>B</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>N</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>B</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(6)</label></disp-formula></p>
      <p>In this equation, <inline-formula id="pone.0221238.e020"><alternatives><graphic xlink:href="pone.0221238.e020.jpg" id="pone.0221238.e020g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M20"><mml:mrow><mml:msub><mml:mi>ω</mml:mi><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>B</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>ω</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>ω</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mi>B</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>ω</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msup><mml:mi>B</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:mo>⋯</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mi>ω</mml:mi><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msub><mml:msup><mml:mi>B</mml:mi><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msup><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pone.0221238.e021"><alternatives><graphic xlink:href="pone.0221238.e021.jpg" id="pone.0221238.e021g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M21"><mml:mrow><mml:msub><mml:mi>δ</mml:mi><mml:msub><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>B</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mi>B</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msup><mml:mi>B</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:mo>⋯</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:msub><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msub><mml:msup><mml:mi>B</mml:mi><mml:msub><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msup><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> are polynomials in the backshift operator of order <italic>n</italic><sub><italic>i</italic></sub> and <italic>m</italic><sub><italic>i</italic></sub>, respectively; and <italic>N</italic>(<italic>B</italic>)<italic>a</italic><sub><italic>t</italic></sub> is a general representation for any of the univariate alternatives in ECOTOOL, namely ARIMA, UC, and ETS. Mind that linear regression is a particular case of model <xref ref-type="disp-formula" rid="pone.0221238.e019">(6)</xref> if all numerator and denominator polynomials are of order zero.</p>
      <p>When the noise model in <xref ref-type="disp-formula" rid="pone.0221238.e019">Eq (6)</xref> is specified as an AR, ARMA or ARIMA model, it is possible to transform the TF model into an ARX, ARMAX or ARIMAX, by setting appropriate constraints on the polynomials. This operation is straightforward in ECOTOOL due to the way the models are specified (see section <xref ref-type="sec" rid="sec010">Case studies</xref>).</p>
      <p>While linear regression or TF models with ARIMA noise have been used abundantly for a long time since the first edition of [<xref rid="pone.0221238.ref012" ref-type="bibr">12</xref>] in 1970, ETS or UC combined with TF models is a unique feature of ECOTOOL toolbox, as far as the author is concerned. Taking advantage of this feature, function <monospace>modelTF</monospace> also allows for the automatic detection of four types of outliers in ARIMA, UC and ETS models (see <xref ref-type="sec" rid="sec010">Case studies</xref> section). Once more, automatic identification of outliers in UC or ETS models is a unique feature of ECOTOOL.</p>
    </sec>
    <sec id="sec008">
      <title>VARX</title>
      <p>VARX models in <xref ref-type="disp-formula" rid="pone.0221238.e022">Eq (7)</xref> are the multivariate option implemented in ECOTOOL by means of the function <monospace>modelVARX</monospace>, where boldface letters indicate either matrices or vectors.
<disp-formula id="pone.0221238.e022"><alternatives><graphic xlink:href="pone.0221238.e022.jpg" id="pone.0221238.e022g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M22"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold">I</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mo mathvariant="bold">Φ</mml:mo><mml:mn>1</mml:mn></mml:msub><mml:mi>B</mml:mi><mml:mo>+</mml:mo><mml:mo>⋯</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mo mathvariant="bold">Φ</mml:mo><mml:mi>p</mml:mi></mml:msub><mml:msup><mml:mi>B</mml:mi><mml:mi>p</mml:mi></mml:msup><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mi mathvariant="bold">z</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mo mathvariant="bold">Ω</mml:mo><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mo mathvariant="bold">Ω</mml:mo><mml:mn>1</mml:mn></mml:msub><mml:mi>B</mml:mi><mml:mo>+</mml:mo><mml:mo>⋯</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mo mathvariant="bold">Ω</mml:mo><mml:mi>q</mml:mi></mml:msub><mml:msup><mml:mi>B</mml:mi><mml:mi>q</mml:mi></mml:msup><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mi mathvariant="bold">u</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi mathvariant="bold">a</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:math></alternatives><label>(7)</label></disp-formula></p>
      <p>In this equation, <bold>z</bold><sub><italic>t</italic></sub> stands for a vector of <italic>p</italic> stationary outputs (generally obtained by appropriate differencing of corresponding vector of non-stationary time series <bold>y</bold><sub><italic>t</italic></sub>); <bold>u</bold><sub><italic>t</italic></sub> represent a set of <italic>m</italic> inputs; <bold>Φ</bold><sub><italic>i</italic></sub> are a set of squared matrices of dimension <italic>p</italic> × <italic>p</italic>; <bold>Ω</bold><sub><italic>j</italic></sub> are a set of matrices of dimension <italic>p</italic> × <italic>m</italic>; and <bold>a</bold><sub><italic>t</italic></sub> are a vector of <italic>p</italic> white noises with zero mean and non-diagonal covariance matrix <bold>Γ</bold>.</p>
      <p>Optimal estimation of unconstrained VARX models is easy, since equation by equation estimation by least squares renders consistent and efficient estimates. ECOTOOL allows for imposing constraints on the coefficients for which iterative generalised least squares are used to reach efficient estimation with a number of iterations controlled by the user [<xref rid="pone.0221238.ref016" ref-type="bibr">16</xref>].</p>
    </sec>
  </sec>
  <sec id="sec009">
    <title>Toolbox overview</title>
    <p>ECOTOOL is user oriented in the sense that the coding effort demanded from the user is reduced to a minimum at the cost of the programmer elaborating long and comprehensive functions. The result is that it is possible to carry out an exhaustive analysis of time series with the recourse to a few functions. The main ones are listed on <xref rid="pone.0221238.t003" ref-type="table">Table 3</xref> in separated sections showing the GUI and demo tools, model functions, functions for the generation of calendar effects dummies and general purpose functions. The real number of functions in ECOTOOL is actually much greater because all the available options in the menus of the <monospace>toolTEST</monospace> GUI are actually implemented as separate functions that may be run independently, see the documentation. Some explanations about this functions are included in the next paragraphs and the way to use them is illustrated in the worked examples below.</p>
    <table-wrap id="pone.0221238.t003" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pone.0221238.t003</object-id>
      <label>Table 3</label>
      <caption>
        <title>Main ECOTOOL functions.</title>
      </caption>
      <alternatives>
        <graphic id="pone.0221238.t003g" xlink:href="pone.0221238.t003"/>
        <table frame="box" rules="all" border="0">
          <colgroup span="1">
            <col align="left" valign="middle" span="1"/>
            <col align="left" valign="middle" span="1"/>
          </colgroup>
          <tbody>
            <tr>
              <td align="center" colspan="2" rowspan="1">GUI and demos</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">
                <monospace>toolTEST</monospace>
              </td>
              <td align="left" rowspan="1" colspan="1">Exploratory, descriptive and diagnostic checking tool</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">
                <monospace>toolFORECAST</monospace>
              </td>
              <td align="left" rowspan="1" colspan="1">Forecasting tool</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">
                <monospace>ECOTOOLdemos</monospace>
              </td>
              <td align="left" rowspan="1" colspan="1">ECOTOOL demos</td>
            </tr>
            <tr>
              <td align="center" colspan="2" rowspan="1">Modeling functions</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">
                <monospace>modelAUTO</monospace>
              </td>
              <td align="left" rowspan="1" colspan="1">Automatic identification of ARIMA models</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">
                <monospace>modelETS</monospace>
              </td>
              <td align="left" rowspan="1" colspan="1">Exponential Smothing models</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">
                <monospace>modelNAIVE</monospace>
              </td>
              <td align="left" rowspan="1" colspan="1">Forecasting with several naive models</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">
                <monospace>modelTF</monospace>
              </td>
              <td align="left" rowspan="1" colspan="1">MISO Transfer Function analysis</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">
                <monospace>modelUC</monospace>
              </td>
              <td align="left" rowspan="1" colspan="1">Unobserved Components models</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">
                <monospace>modelVARX</monospace>
              </td>
              <td align="left" rowspan="1" colspan="1">VAR model with eXogenous variables analysis</td>
            </tr>
            <tr>
              <td align="center" colspan="2" rowspan="1">Calendar effects</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">
                <monospace>days</monospace>
              </td>
              <td align="left" rowspan="1" colspan="1">Dummy variable for number of days in months or quarters</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">
                <monospace>easter</monospace>
              </td>
              <td align="left" rowspan="1" colspan="1">General dummy Easter variables on monthly or quarterly data</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">
                <monospace>leapy</monospace>
              </td>
              <td align="left" rowspan="1" colspan="1">Dummy variable for leap year intervention</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">
                <monospace>trading</monospace>
              </td>
              <td align="left" rowspan="1" colspan="1">Trading day variables on monthly or quarterly frequency</td>
            </tr>
            <tr>
              <td align="center" colspan="2" rowspan="1">General purpose functions</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">
                <monospace>acft</monospace>
              </td>
              <td align="left" rowspan="1" colspan="1">Theoretical autocorrelation functions of ARMA processes</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">
                <monospace>varstep</monospace>
              </td>
              <td align="left" rowspan="1" colspan="1">Var impulse and step function analysis</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">
                <monospace>vboxcoxinv</monospace>
              </td>
              <td align="left" rowspan="1" colspan="1">Inverse of Box-Cox transformation</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">
                <monospace>vConv</monospace>
              </td>
              <td align="left" rowspan="1" colspan="1">Multiplication of vector polynomials</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">
                <monospace>vdif</monospace>
              </td>
              <td align="left" rowspan="1" colspan="1">Differenciation of a vector of variables</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">
                <monospace>vfilter</monospace>
              </td>
              <td align="left" rowspan="1" colspan="1">Filters a vector of inputs with a vector digital filter</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">
                <monospace>vRoots</monospace>
              </td>
              <td align="left" rowspan="1" colspan="1">Roots of a vector polynomial</td>
            </tr>
          </tbody>
        </table>
      </alternatives>
    </table-wrap>
    <p>The main features of ECOTOOL are:</p>
    <list list-type="bullet">
      <list-item>
        <p>As shown in the previous section, a number of time series methods are implemented, ranging from simple naïve univariate models to multivariate methods.</p>
      </list-item>
      <list-item>
        <p>Extensive and detailed documentation is available. All functions are provided with a thorough help accessible in the usual way. Eleven detailed demos with extensive explanations that show all the properties of the toolbox are also provided (accessed by <monospace>ECOTOOLdemos</monospace>).</p>
      </list-item>
      <list-item>
        <p>The design of the toolbox is such that it is possible to perform a full time series analysis with just a few MATLAB instructions. In this way, the memory effort demanded from the user is reduced to a minimum. In addition, function names are selected following mnemonic rules such that they are easy to remember and easy to look for.</p>
      </list-item>
      <list-item>
        <p>The toolbox is composed of four types of functions, see <xref rid="pone.0221238.t003" ref-type="table">Table 3</xref>: i) GUI tools to perform several tasks that are named as tool* (where ‘*’ stands for a name, at the moment two are available, <monospace>toolTEST</monospace> and <monospace>toolFORECAST</monospace>, see below); ii) Modeling methods that are named as model* (like <monospace>modelNAIVE</monospace>, <monospace>modelTF</monospace>, etc.); iii) functions that facilitates building dummy variables to deal with calendar effects; and iv) general purpose functions to perform a number of important tasks when dealing with time series analysis, like transforming the data (standardising, differencing, Box-Cox variance transforming, etc.) or doing other tasks (filtering and differencing vector time series, calculating convolutions of multivariate polynomials, calculating roots of multivariate polynomials, etc.).</p>
      </list-item>
      <list-item>
        <p>Specification of models is rather simple and flexible. All functions for estimation of models, i.e., model* functions, are written with a common syntax in order to make the model specification task easier to the user. Besides, in the case of <monospace>modelTF</monospace> for TF or ARIMA model estimation and forecasting, the way the models are specified is in fact very similar to its analytical expression according to Eqs <xref ref-type="disp-formula" rid="pone.0221238.e008">(1)</xref> and <xref ref-type="disp-formula" rid="pone.0221238.e009">(2)</xref>. For example, the MATLAB code for specifying an ARIMA(0, 1, 2) is ‘<monospace>(1+ma1*B+ma2*B2)/(1-B)</monospace>’, where <monospace>ma1</monospace> and <monospace>ma2</monospace> stand for two arbitrary names chosen to label the moving average coefficients and <monospace>B</monospace> is the back-shift operator.</p>
        <p>One advantage of this feature is that imposing constraints among parameters are straightforward. For example, if in the previous model for a given dataset the constraint <monospace>ma1 = ma2</monospace> wanted to be imposed, the model code would be ‘<monospace>(1+ma1*B+ma1*B2)/(1-B)</monospace>’ instead, and only the <monospace>ma1</monospace> parameter would be estimated.</p>
      </list-item>
      <list-item>
        <p>Either conditional or exact Maximum Likelihood (ML) estimation of ARIMA models are available, see e.g., [<xref rid="pone.0221238.ref012" ref-type="bibr">12</xref>]. Conditional ML is always used as a mean to obtain initial conditions for exact estimation, but it is convenient when the model involves very long time series or it is very complex, as is the case of models with multiple seasonal factors or many parameters.</p>
      </list-item>
      <list-item>
        <p>An algorithm for automatic identification of ARIMA models (function <monospace>modelAUTO</monospace>) is included, inspired in [<xref rid="pone.0221238.ref005" ref-type="bibr">5</xref>] and coded in the widespread forecast package in R. The procedure follows this reference except in the way differencing orders are identified. In particular, instead of relying on formal unit root tests, ECOTOOL selects difference orders by minimizing the variance of the resulting time series. This discrepancy is introduced due to many problems detected with formal unit root tests when applied to real time series. In addition, the automatic method is expanded to multi-seasonal models, making ECOTOOL the unique piece of software that implements this procedure, to the author knowledge.</p>
      </list-item>
      <list-item>
        <p>Automatic identification of four types of outliers are coded for ARIMA and TF models, following [<xref rid="pone.0221238.ref021" ref-type="bibr">21</xref>] and [<xref rid="pone.0221238.ref004" ref-type="bibr">4</xref>]. The types are additive, innovative, level shift and transitory change (coded in ECOTOOL as AO, IO, LS and TC). They are modeled as particular TFs applied to impulse dummy variables.</p>
      </list-item>
      <list-item>
        <p>ETS and UC models are estimated from their equivalent ‘reduced’ or ARIMA form, as in [<xref rid="pone.0221238.ref022" ref-type="bibr">22</xref>]. This allows to incorporate to these methods all the power ECOTOOL offers for modeling ARIMA processes. In particular, they may be estimated by exact ML, may include inputs as transfer functions and automatic detection of outliers may be carried out. All these are, once more, unique properties of ECOTOOL, as far as the author is concerned.</p>
      </list-item>
      <list-item>
        <p>The estimation output of any sort of models is rather exhaustive in tabular form. Such tables show parameter values with their standard errors and T tests, information criteria, correlation among parameters and, in the case of TF and ARIMA models, warnings about problems with unit roots in either numerator or denominator polynomials.</p>
      </list-item>
    </list>
    <p>There are two functions that produce GUI interfaces that deserve special attention, namely <monospace>toolTEST</monospace> and <monospace>toolFORECAST</monospace>.</p>
    <p><monospace>toolTEST</monospace> is conceived as a friendly and exhaustive environment for descriptive statistics, as well as an identification tool and model validation tool of multivariate time series. When it is invoked, three menus unfold in a standard figure window in addition to the usual figure menus: i) a comprehensive ‘Tests’ menu, briefly explained below; ii) a ‘Series’ menu if the input is multivariate and allows to apply the tests to any individual and/or to all the time series at once; and iii) an ‘Options’ menu to deal with specific options for each item in the ‘Tests’ menu.</p>
    <p>The ‘Tests’ menu offers a thorough combination of tabular and graphical information for many tests available. The following is a non-exhaustive list of such tests, classified in different categories:</p>
    <list list-type="bullet">
      <list-item>
        <p>Descriptive information: time plots, box plots, scatter plots, descriptive statistics, histograms, formal Gaussianity tests [<xref rid="pone.0221238.ref023" ref-type="bibr">23</xref>, <xref rid="pone.0221238.ref024" ref-type="bibr">24</xref>].</p>
      </list-item>
      <list-item>
        <p>Identification tools: univariate and multivariate sample autocorrelation and partial autocorrelation functions, Ljung-Box Q and Monti tests [<xref rid="pone.0221238.ref025" ref-type="bibr">25</xref>, <xref rid="pone.0221238.ref026" ref-type="bibr">26</xref>], information criteria, Akaike’s, Schwarz, Hannan and Quin, [<xref rid="pone.0221238.ref027" ref-type="bibr">27</xref>–<xref rid="pone.0221238.ref029" ref-type="bibr">29</xref>], Granger causality tests based on VAR models [<xref rid="pone.0221238.ref030" ref-type="bibr">30</xref>].</p>
      </list-item>
      <list-item>
        <p>Constant mean and heteroscedasticity tests: CUSUM and CUSUMSQ tests [<xref rid="pone.0221238.ref031" ref-type="bibr">31</xref>], mean vs standard deviation scatter plots, formal ratio of variances heteroscedasticity test, Box-Cox transformation estimation [<xref rid="pone.0221238.ref032" ref-type="bibr">32</xref>, <xref rid="pone.0221238.ref033" ref-type="bibr">33</xref>].</p>
      </list-item>
      <list-item>
        <p>Integration and cointegration tests: Dickey-Fuller and Perron unit root tests, Johansen cointegration tests [<xref rid="pone.0221238.ref034" ref-type="bibr">34</xref>–<xref rid="pone.0221238.ref036" ref-type="bibr">36</xref>].</p>
      </list-item>
      <list-item>
        <p>Non-linearity tests: [<xref rid="pone.0221238.ref026" ref-type="bibr">26</xref>, <xref rid="pone.0221238.ref037" ref-type="bibr">37</xref>–<xref rid="pone.0221238.ref039" ref-type="bibr">39</xref>], Schwarz criterion on squares.</p>
      </list-item>
      <list-item>
        <p>Frequency domain tools: cumulative periodogram, smoothed or raw periodogram, AR-spectrum [<xref rid="pone.0221238.ref016" ref-type="bibr">16</xref>, <xref rid="pone.0221238.ref040" ref-type="bibr">40</xref>].</p>
      </list-item>
    </list>
    <p>The second useful GUI is the so called <monospace>toolFORECAST</monospace>, that is designed to show graphically the forecasting output of the model functions in ECOTOOL and to print out tables with plenty of error metrics (see examples in <xref ref-type="sec" rid="sec010">Case studies</xref> section).</p>
    <p>Function <monospace>toolFORECAST</monospace> allows to plot one or several forecasts and forecasting errors for each time series in turn, selecting the output to be displayed interactively by menus. For long time series several pushbuttons permit to slide side-wise along the time series (as in <monospace>toolTEST</monospace>). Tabular results may be displayed in three different forms, i) actual values, forecasts, errors and error metrics for each time series and each forecasting step separately; ii) overall error metrics for one time series but many methods altogether to do fast comparisons; and iii) Diebold-Mariano test, sign test and Wilcoxon signed-rank test for testing statistical significant differences among several forecasting methods [<xref rid="pone.0221238.ref041" ref-type="bibr">41</xref>, <xref rid="pone.0221238.ref042" ref-type="bibr">42</xref>].</p>
  </sec>
  <sec id="sec010">
    <title>Case studies</title>
    <p>The present section considers three case studies chosen to illustrate ECOTOOL working on real data. Not all the capabilities of the toolbox are shown in these examples, due to space restrictions. The documentation shows a wide range of thorough examples, run step-by-step with their respective coding, covering all the models and tools available in ECOTOOL. There, the implementation is shown deploying the code necessary to run the examples, together with the output produced.</p>
    <p>The three forecasting cases shown below are designed following some common rules. They are rolling forecasting experiments in which the training in-sample data length, the testing out-of-sample data length, and the forecast origin are fixed initially depending on the properties of each dataset. The first round of forecasts with all the appropriate models is run and forecasted and the corresponding actual values stored. Then, the window is moved several samples ahead and all the forecasts are produced again with the models identified and estimated with the most recent information. This updating step is repeated to the end of the data.</p>
    <p>This exhaustive evaluation of forecasting performance of each model is completed with the help of two error metrics that have proven very useful in many applications and are free from some inconveniences, namely the symmetric Mean Absolute Percentage Error (sMAPE) and the Mean Absolute Scaled Error (MASE), see Eqs <xref ref-type="disp-formula" rid="pone.0221238.e023">(8)</xref> and <xref ref-type="disp-formula" rid="pone.0221238.e024">(9)</xref> and [<xref rid="pone.0221238.ref043" ref-type="bibr">43</xref>, <xref rid="pone.0221238.ref044" ref-type="bibr">44</xref>].
<disp-formula id="pone.0221238.e023"><alternatives><graphic xlink:href="pone.0221238.e023.jpg" id="pone.0221238.e023g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M23"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mtext>sMAPE</mml:mtext><mml:mi>h</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mi>h</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>h</mml:mi></mml:munderover><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mo>∣</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mo>∣</mml:mo></mml:mrow><mml:mrow><mml:mo>∣</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∣</mml:mo><mml:mo>+</mml:mo><mml:mo>∣</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mo>∣</mml:mo></mml:mrow></mml:mfrac><mml:mo>×</mml:mo><mml:mn>100</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(8)</label></disp-formula>
<disp-formula id="pone.0221238.e024"><alternatives><graphic xlink:href="pone.0221238.e024.jpg" id="pone.0221238.e024g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M24"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mtext>MASE</mml:mtext><mml:mi>h</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mi>h</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>h</mml:mi></mml:munderover><mml:mfrac><mml:mrow><mml:mo>∣</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mo>∣</mml:mo></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mi>s</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mi>s</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:mo>∣</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mo>-</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>∣</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(9)</label></disp-formula></p>
    <p>In Eqs <xref ref-type="disp-formula" rid="pone.0221238.e023">(8)</xref> and <xref ref-type="disp-formula" rid="pone.0221238.e024">(9)</xref>
<italic>y</italic><sub><italic>t</italic></sub> and <inline-formula id="pone.0221238.e025"><alternatives><graphic xlink:href="pone.0221238.e025.jpg" id="pone.0221238.e025g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M25"><mml:msub><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>t</mml:mi></mml:msub></mml:math></alternatives></inline-formula> are the actual and forecasted values at time <italic>t</italic>, respectively; <italic>h</italic> is the forecast horizon; <italic>s</italic> is the seasonal period of the data, if applicable, or just 1 if the data is not seasonal; and <italic>n</italic> is the number of observations in the fitting sample. The sMAPE metric avoids the distortions of the standard non-symmetric MAPE criterion and problems for values close to zero. The MASE metric compares the out-of-sample performance of the model with the in-sample performance of a simple seasonal RW (see <xref rid="pone.0221238.t001" ref-type="table">Table 1</xref>), i.e. assuming that the model for the data is <italic>y</italic><sub><italic>t</italic></sub> = <italic>y</italic><sub><italic>t</italic>−<italic>s</italic></sub> + <italic>a</italic><sub><italic>t</italic></sub>, with <italic>a</italic><sub><italic>t</italic></sub> white noise with zero mean, constant variance and serially independent.</p>
    <sec id="sec011">
      <title>Forecasting analysis of Mauna Loa CO<sub>2</sub> concentration data</title>
      <p>The measured CO<sub>2</sub> concentration at Mauna Loa is represented in <xref ref-type="fig" rid="pone.0221238.g001">Fig 1</xref> (<ext-link ext-link-type="ftp" xlink:href="ftp://aftp.cmdl.noaa.gov/products/trends/co2/co2_mm_mlo.txt">ftp://aftp.cmdl.noaa.gov/products/trends/co2/co2_mm_mlo.txt</ext-link>). It consists of sixty years of monthly data collected from March 1958 to May 2018. The data show a growing trend during the full period associated with long run emissions and a seasonal component rather stable related to the global net uptake and release of CO<sub>2</sub> in summer and winter.</p>
      <fig id="pone.0221238.g001" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0221238.g001</object-id>
        <label>Fig 1</label>
        <caption>
          <title>The Mauna Loa CO<sub>2</sub> concentration data from March 1958 to May 2018.</title>
        </caption>
        <graphic xlink:href="pone.0221238.g001"/>
      </fig>
      <p>The upward trend and the seasonal variations may be also checked out by either the pseudo-periodogram (pseudo because the time series is not mean-stationary) or the AR pseudo-spectrum available in the <monospace>toolTEST</monospace> GUI tool (not shown here to save space). Clear peaks appear for zero frequency related to the trend and the seasonal periods 12 and 6 samples per cycle. The rest of harmonics do not show up.</p>
      <p>To give the feeling of how the ECOTOOL code looks like, some coding is shown for this example. The next listing shows how to load the data, select the raw CO<sub>2</sub> data (stored in the fifth column of the matrix data downloaded from the official web page), avoid the first two years of monthly observations, select 480 months after that and select two parameters that will be used later on, namely the number of forecasts (<monospace>nofs</monospace>) and the seasonal period (<monospace>s</monospace>). The last line is useful for those users who want to try the variance stabilizing Box-Cox transformation of the data (applied to the first 480 months). It can also be accessed by the ‘Box-Cox Transformation’ option in the ‘Tests’ menu of the <monospace>toolTEST</monospace> GUI. By this command the λ parameter of the transformation is estimated according to [<xref rid="pone.0221238.ref033" ref-type="bibr">33</xref>] and returns the transformed variable (<monospace>ty</monospace>) and λ (<monospace>lambda</monospace>).</p>
      <p>
        <monospace>load maunaLoa.data         % Load data</monospace>
      </p>
      <p>
        <monospace>y = maunaLoa(25:504, 5);     % Select in-sample CO2</monospace>
      </p>
      <p>
        <monospace>nofs = 24;             % Number of forecasts</monospace>
      </p>
      <p>
        <monospace>s = 12;               % Seasonal period</monospace>
      </p>
      <p>
        <monospace>[ty, lambda] = vboxcox(y);   % Box-Cox transform</monospace>
      </p>
      <p>The models used in this case study are all those available in ECOTOOL that may sensibly applied to this data. In particular:</p>
      <list list-type="bullet">
        <list-item>
          <p><italic>Airline</italic>: ARIMA(0, 1, 1) × (0, 1, 1)<sub>12</sub> estimated with <monospace>modelTF</monospace>. The architecture of the model is maintained along the whole experiment, but the parameters are updated at each step.</p>
        </list-item>
        <list-item>
          <p><italic>Auto</italic>: ARIMA automatically identified by <monospace>modelAUTO</monospace>. Both architecture and parameters are updated.</p>
        </list-item>
        <list-item>
          <p><italic>AR</italic>: pure AR model automatically identified by a procedure similar to <monospace>modelAUTO</monospace> but truncated to avoid MA terms.</p>
        </list-item>
        <list-item>
          <p><italic>UC</italic>: Unobserved components model composed of a Local Linear Trend with a trigonommetric seasonal component of period 12 samples per cycle. This is provided by <monospace>modelUC</monospace> with model option ‘LLT12’.</p>
        </list-item>
        <list-item>
          <p><italic>ETS</italic>: additive Exponential Smoothing with level, slope and seasonal (<monospace>modelES</monospace> with model option ‘AA12’).</p>
        </list-item>
        <list-item>
          <p><italic>Naïve</italic>: seasonal naïve, i.e. forecasts are taken as the last observation of the same season available (third column of output from <monospace>modelNAIVE</monospace> function).</p>
        </list-item>
      </list>
      <p>The next listing shows how the previous models may be run for the first 480 months of the data (see details on how to use these functions in the toolbox documentation). Pure AR models are not included in the listing because they were produced with an ad-hoc particular function not included in ECOTOOL.</p>
      <p>
        <monospace>model = '(1+ma1*B)(1+ma12*B12)/(1-B)(1-B12)';</monospace>
      </p>
      <p>
        <monospace>m1 = modelTF(ty, [], model, nofs);    % Airline model</monospace>
      </p>
      <p>
        <monospace>m2 = modelAUTO(y, [], [1 s]);       % Auto ARIMA model</monospace>
      </p>
      <p>
        <monospace>m3 = modelUC(ty, [], 'LLT12', nofs);   % UC model</monospace>
      </p>
      <p>
        <monospace>m4 = modelETS(ty, [], 'AA12', nofs);   % ETS model</monospace>
      </p>
      <p>
        <monospace>m5 = modelNAIVE(ty, nofs, s);       % Naive models</monospace>
      </p>
      <p>Mind that the syntax for all models are very similar and that the first input to <monospace>modelAUTO</monospace> is the time series without Box-Cox transformation because such change is tested inside this particular function. The output variables <monospace>m1</monospace> to <monospace>m5</monospace> are MATLAB structures with all the relevant information about the model output, like residuals, forecasts, etc.</p>
      <p>The automatic ARIMA identification procedure implemented in ECOTOOL (by means of <monospace>modelAUTO</monospace> function) produces an ‘airline’ model, i.e. ARIMA(0, 1, 1) × (0, 1, 1)<sub>12</sub>. This model is perfectly supported by the Simple and Partial Autocorrelation functions for the differenced data shown in <xref ref-type="fig" rid="pone.0221238.g002">Fig 2</xref>. It certainly shows that the MA terms are essential to avoid over parameterisation if only AR terms are used, since finite order MA models are theoretically equivalent to infinite order AR models, as in [<xref rid="pone.0221238.ref014" ref-type="bibr">14</xref>].</p>
      <fig id="pone.0221238.g002" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0221238.g002</object-id>
        <label>Fig 2</label>
        <caption>
          <title>Simple and Partial Autocorrelation functions for the Mauna Loa differenced data.</title>
          <p>Dotted lines signal the seasonal lags.</p>
        </caption>
        <graphic xlink:href="pone.0221238.g002"/>
      </fig>
      <p><xref ref-type="fig" rid="pone.0221238.g002">Fig 2</xref> is the result of the following code, though it can also be produced by <monospace>toolTEST</monospace>.</p>
      <p>
        <monospace>z = vdif(ty, [1 1], [1 s]);    % Difference series</monospace>
      </p>
      <p>
        <monospace>vident(z);              % Identification</monospace>
      </p>
      <p>Calculating error metrics and statistical tests about forecast errors, and performing some graphical checks of forecasts are very simple with the help of the <monospace>toolFORECAST</monospace> function (actually a GUI). Next listing shows how to produce such outputs in the original scale of the variable. This requires to undo the Box-Cox transformation on the model forecasts, stored in field <monospace>.py</monospace> of all model structures (<monospace>m1</monospace> to <monospace>m5</monospace>).</p>
      <p>
        <monospace>ACTUAL = maunaLoa(505:528, 5);</monospace>
      </p>
      <p>
        <monospace>FORECASTS = vboxcoxinv([m1.py m2.py m3.py m4.py m5.py], lambda);</monospace>
      </p>
      <p>
        <monospace>toolFORECAST(ACTUAL, FORECASTS)</monospace>
      </p>
      <p>The forecast exercise consists of a rolling out experiment in which the initial forecast origin is chosen at 480 observations from the beginning (March 1998) and the forecast horizon is 24 months ahead. Then, one month is added to the sample and the whole process is repeated to the end of the sample. Therefore, 220 total rounds of 24 months-ahead forecasts from all models are produced. The average forecasting performance of all models used are shown in <xref rid="pone.0221238.t004" ref-type="table">Table 4</xref>. The table is divided in two parts reporting the average SMAPE and MASE metrics for each model for selected horizons ranging from 1 to 24 months.</p>
      <table-wrap id="pone.0221238.t004" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0221238.t004</object-id>
        <label>Table 4</label>
        <caption>
          <title>Average sMAPE and MASE metrics for different models on the Mauna Loa experiment.</title>
        </caption>
        <alternatives>
          <graphic id="pone.0221238.t004g" xlink:href="pone.0221238.t004"/>
          <table frame="box" rules="all" border="0">
            <colgroup span="1">
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th align="right" rowspan="1" colspan="1"/>
                <th align="center" colspan="6" rowspan="1">sMAPE</th>
                <th align="center" colspan="6" rowspan="1">MASE</th>
              </tr>
              <tr>
                <th align="right" style="border-bottom:thick" rowspan="1" colspan="1">Steps</th>
                <th align="right" style="border-bottom:thick" rowspan="1" colspan="1">Airline</th>
                <th align="right" style="border-bottom:thick" rowspan="1" colspan="1">Auto</th>
                <th align="right" style="border-bottom:thick" rowspan="1" colspan="1">AR</th>
                <th align="right" style="border-bottom:thick" rowspan="1" colspan="1">UC</th>
                <th align="right" style="border-bottom:thick" rowspan="1" colspan="1">ETS</th>
                <th align="right" style="border-bottom:thick" rowspan="1" colspan="1">Naïve</th>
                <th align="right" style="border-bottom:thick" rowspan="1" colspan="1">Airline</th>
                <th align="right" style="border-bottom:thick" rowspan="1" colspan="1">Auto</th>
                <th align="right" style="border-bottom:thick" rowspan="1" colspan="1">AR</th>
                <th align="right" style="border-bottom:thick" rowspan="1" colspan="1">UC</th>
                <th align="right" style="border-bottom:thick" rowspan="1" colspan="1">ETS</th>
                <th align="right" style="border-bottom:thick" rowspan="1" colspan="1">Naïve</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="right" rowspan="1" colspan="1">1</td>
                <td align="char" char="." rowspan="1" colspan="1">0.065</td>
                <td align="char" char="." rowspan="1" colspan="1">0.067</td>
                <td align="char" char="." rowspan="1" colspan="1">0.072</td>
                <td align="char" char="." rowspan="1" colspan="1">0.068</td>
                <td align="char" char="." rowspan="1" colspan="1">0.067</td>
                <td align="char" char="." rowspan="1" colspan="1">0.549</td>
                <td align="char" char="." rowspan="1" colspan="1">0.166</td>
                <td align="char" char="." rowspan="1" colspan="1">0.170</td>
                <td align="char" char="." rowspan="1" colspan="1">0.181</td>
                <td align="char" char="." rowspan="1" colspan="1">0.171</td>
                <td align="char" char="." rowspan="1" colspan="1">0.170</td>
                <td align="char" char="." rowspan="1" colspan="1">1.386</td>
              </tr>
              <tr>
                <td align="right" rowspan="1" colspan="1">2</td>
                <td align="char" char="." rowspan="1" colspan="1">0.072</td>
                <td align="char" char="." rowspan="1" colspan="1">0.074</td>
                <td align="char" char="." rowspan="1" colspan="1">0.077</td>
                <td align="char" char="." rowspan="1" colspan="1">0.077</td>
                <td align="char" char="." rowspan="1" colspan="1">0.075</td>
                <td align="char" char="." rowspan="1" colspan="1">0.549</td>
                <td align="char" char="." rowspan="1" colspan="1">0.182</td>
                <td align="char" char="." rowspan="1" colspan="1">0.187</td>
                <td align="char" char="." rowspan="1" colspan="1">0.196</td>
                <td align="char" char="." rowspan="1" colspan="1">0.194</td>
                <td align="char" char="." rowspan="1" colspan="1">0.189</td>
                <td align="char" char="." rowspan="1" colspan="1">1.386</td>
              </tr>
              <tr>
                <td align="right" rowspan="1" colspan="1">3</td>
                <td align="char" char="." rowspan="1" colspan="1">0.078</td>
                <td align="char" char="." rowspan="1" colspan="1">0.079</td>
                <td align="char" char="." rowspan="1" colspan="1">0.083</td>
                <td align="char" char="." rowspan="1" colspan="1">0.084</td>
                <td align="char" char="." rowspan="1" colspan="1">0.081</td>
                <td align="char" char="." rowspan="1" colspan="1">0.549</td>
                <td align="char" char="." rowspan="1" colspan="1">0.197</td>
                <td align="char" char="." rowspan="1" colspan="1">0.199</td>
                <td align="char" char="." rowspan="1" colspan="1">0.210</td>
                <td align="char" char="." rowspan="1" colspan="1">0.213</td>
                <td align="char" char="." rowspan="1" colspan="1">0.205</td>
                <td align="char" char="." rowspan="1" colspan="1">1.387</td>
              </tr>
              <tr>
                <td align="right" rowspan="1" colspan="1">4</td>
                <td align="char" char="." rowspan="1" colspan="1">0.082</td>
                <td align="char" char="." rowspan="1" colspan="1">0.083</td>
                <td align="char" char="." rowspan="1" colspan="1">0.088</td>
                <td align="char" char="." rowspan="1" colspan="1">0.090</td>
                <td align="char" char="." rowspan="1" colspan="1">0.086</td>
                <td align="char" char="." rowspan="1" colspan="1">0.550</td>
                <td align="char" char="." rowspan="1" colspan="1">0.209</td>
                <td align="char" char="." rowspan="1" colspan="1">0.212</td>
                <td align="char" char="." rowspan="1" colspan="1">0.224</td>
                <td align="char" char="." rowspan="1" colspan="1">0.227</td>
                <td align="char" char="." rowspan="1" colspan="1">0.218</td>
                <td align="char" char="." rowspan="1" colspan="1">1.388</td>
              </tr>
              <tr>
                <td align="right" rowspan="1" colspan="1">5</td>
                <td align="char" char="." rowspan="1" colspan="1">0.086</td>
                <td align="char" char="." rowspan="1" colspan="1">0.087</td>
                <td align="char" char="." rowspan="1" colspan="1">0.092</td>
                <td align="char" char="." rowspan="1" colspan="1">0.095</td>
                <td align="char" char="." rowspan="1" colspan="1">0.091</td>
                <td align="char" char="." rowspan="1" colspan="1">0.550</td>
                <td align="char" char="." rowspan="1" colspan="1">0.218</td>
                <td align="char" char="." rowspan="1" colspan="1">0.222</td>
                <td align="char" char="." rowspan="1" colspan="1">0.234</td>
                <td align="char" char="." rowspan="1" colspan="1">0.240</td>
                <td align="char" char="." rowspan="1" colspan="1">0.229</td>
                <td align="char" char="." rowspan="1" colspan="1">1.388</td>
              </tr>
              <tr>
                <td align="right" rowspan="1" colspan="1">6</td>
                <td align="char" char="." rowspan="1" colspan="1">0.089</td>
                <td align="char" char="." rowspan="1" colspan="1">0.091</td>
                <td align="char" char="." rowspan="1" colspan="1">0.095</td>
                <td align="char" char="." rowspan="1" colspan="1">0.099</td>
                <td align="char" char="." rowspan="1" colspan="1">0.094</td>
                <td align="char" char="." rowspan="1" colspan="1">0.550</td>
                <td align="char" char="." rowspan="1" colspan="1">0.226</td>
                <td align="char" char="." rowspan="1" colspan="1">0.231</td>
                <td align="char" char="." rowspan="1" colspan="1">0.242</td>
                <td align="char" char="." rowspan="1" colspan="1">0.250</td>
                <td align="char" char="." rowspan="1" colspan="1">0.238</td>
                <td align="char" char="." rowspan="1" colspan="1">1.388</td>
              </tr>
              <tr>
                <td align="right" rowspan="1" colspan="1">1 year</td>
                <td align="char" char="." rowspan="1" colspan="1">0.107</td>
                <td align="char" char="." rowspan="1" colspan="1">0.107</td>
                <td align="char" char="." rowspan="1" colspan="1">0.112</td>
                <td align="char" char="." rowspan="1" colspan="1">0.114</td>
                <td align="char" char="." rowspan="1" colspan="1">0.118</td>
                <td align="char" char="." rowspan="1" colspan="1">0.547</td>
                <td align="char" char="." rowspan="1" colspan="1">0.273</td>
                <td align="char" char="." rowspan="1" colspan="1">0.274</td>
                <td align="char" char="." rowspan="1" colspan="1">0.287</td>
                <td align="char" char="." rowspan="1" colspan="1">0.290</td>
                <td align="char" char="." rowspan="1" colspan="1">0.299</td>
                <td align="char" char="." rowspan="1" colspan="1">1.381</td>
              </tr>
              <tr>
                <td align="right" rowspan="1" colspan="1">2 years</td>
                <td align="char" char="." rowspan="1" colspan="1">0.139</td>
                <td align="char" char="." rowspan="1" colspan="1">0.137</td>
                <td align="char" char="." rowspan="1" colspan="1">0.144</td>
                <td align="char" char="." rowspan="1" colspan="1">0.145</td>
                <td align="char" char="." rowspan="1" colspan="1">0.168</td>
                <td align="char" char="." rowspan="1" colspan="1">0.818</td>
                <td align="char" char="." rowspan="1" colspan="1">0.355</td>
                <td align="char" char="." rowspan="1" colspan="1">0.351</td>
                <td align="char" char="." rowspan="1" colspan="1">0.370</td>
                <td align="char" char="." rowspan="1" colspan="1">0.371</td>
                <td align="char" char="." rowspan="1" colspan="1">0.426</td>
                <td align="char" char="." rowspan="1" colspan="1">2.068</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
      </table-wrap>
      <p><xref rid="pone.0221238.t004" ref-type="table">Table 4</xref> offers some interesting insights into the forecasting issue of the Mauna Loa data. Firstly, forecasts deteriorate with the horizon for all models, as expected. Secondly, all models show significant performance improvements over the Naïve, implying that they are really capturing the structure of the data beyond a naïve seasonal pattern. Thirdly, all errors are very small implying that the series can be forecast with great accuracy (take, for example, the Airline model that produces an average sMAPE of only 0.139% for 24 months ahead). Fourthly, no big differences in performance may be reported among models up to one year ahead with the exception of <italic>Naïve</italic>, though strictly speaking, <italic>Airline</italic> outperforms the rest at every single step. However, that is not the case for 24 steps ahead, where the best model is <italic>Auto</italic>, instead. Finally, <italic>AR</italic> model lies in a middle range, better than <italic>UC</italic> and <italic>ETS</italic>, while <italic>ETS</italic> deteriorates importantly for 24 months ahead.</p>
      <p>The overall conclusion is that ECOTOOL provides a set of models rather reasonable for modelling and forecasting the Mauna Loa data. Moreover, the Unobserved Components may be used to extract the trend of the data (stored in field <monospace>comp</monospace> of structure <monospace>m3</monospace>) and compared to the ‘official’ one reported in the original web page. <xref ref-type="fig" rid="pone.0221238.g003">Fig 3</xref> shows a detail of the data with the ‘official’ trend and the one estimated by <monospace>modelUC</monospace>. One single trend is visible because, though they are not exactly the same, both are consistent.</p>
      <fig id="pone.0221238.g003" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0221238.g003</object-id>
        <label>Fig 3</label>
        <caption>
          <title>Detail of Mauna Loa data with the ‘official’ and <monospace>modelUC</monospace> trends.</title>
        </caption>
        <graphic xlink:href="pone.0221238.g003"/>
      </fig>
    </sec>
    <sec id="sec012">
      <title>Hourly electricity demand in Spain</title>
      <p>The data for the Spanish electricity demand used in this case study is publicly available at the Iberian Energy Market Operator web page (OMIE: <ext-link ext-link-type="uri" xlink:href="http://www.omie.es">http://www.omie.es</ext-link>). The data is continuously updated from 29 June 2001. <xref ref-type="fig" rid="pone.0221238.g004">Fig 4</xref> shows a portion of such data, from 1 January 2017 to 12 June 2018.</p>
      <fig id="pone.0221238.g004" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0221238.g004</object-id>
        <label>Fig 4</label>
        <caption>
          <title>Spanish hourly electricity load demand from January 2017 to June 2018.</title>
        </caption>
        <graphic xlink:href="pone.0221238.g004"/>
      </fig>
      <p>These data are characterised by a number of periodic components superimposed that have to be dealt with, if a comprehensive model wants to be fitted. Firstly, the data exhibits a clear annual cycle with two peaks in winter and summer, respectively, closely related to temperatures. Secondly, a strong diurnal cycle, with different profiles depending on the season of the year. Thirdly, a weekly cycle is present with lower demand during weekends, mainly due to the absence of industrial activity. Finally, the data is affected by a number of special days, special events, moving festivals and holidays, etc.</p>
      <p>In general, it is common to avoid modelling the year cycle for short term forecasting with hourly data, for several reasons: i) the most important drivers of the data in the short run are the daily and weekly cycle, while the annual cycle would become of paramount importance for longer horizons (from one week onwards); ii) it is parametrically unfeasible and much research should be conducted if trivial extensions of existing models want to be avoided. The problem is that the annual cycle holds 8,760 hours and a trivial extension of models to take into account the periodic behaviour would involve 4,380 harmonics. One way to tackle with these problems is with the aid of time aggregation techniques, e.g., [<xref rid="pone.0221238.ref017" ref-type="bibr">17</xref>], but they are rather specific methods that require specialised software, far beyond the scope of this paper, that focuses on presenting a toolbox for general use.</p>
      <p>In this context is where ECOTOOL offers an important innovation, since automatic identification of ARIMA models is extended for these complex type of databases, namely the multi-seasonal ARIMA model, i.e., models that include as multiplicative seasonal factors as necessary. As far as the author is concerned, this is the first time that an automatic algorithm is developed for such complex cases. Certainly, in this case the model is composed of the multiplication of three ARMA factors, namely regular, daily and weekly seasonals. The general specification is in <xref ref-type="disp-formula" rid="pone.0221238.e026">Eq (10)</xref>, with the same nomenclature of <xref ref-type="disp-formula" rid="pone.0221238.e008">Eq (1)</xref>.
<disp-formula id="pone.0221238.e026"><alternatives><graphic xlink:href="pone.0221238.e026.jpg" id="pone.0221238.e026g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M26"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:msub><mml:mi>Q</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>B</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mi>ϕ</mml:mi><mml:msub><mml:mi>P</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>B</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mfrac><mml:mrow><mml:msub><mml:mo>Θ</mml:mo><mml:msub><mml:mi>Q</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mi>B</mml:mi><mml:mn>24</mml:mn></mml:msup><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mo>Φ</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mi>B</mml:mi><mml:mn>24</mml:mn></mml:msup><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mfrac><mml:mrow><mml:msub><mml:mo>Θ</mml:mo><mml:msub><mml:mi>Q</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mi>B</mml:mi><mml:mn>168</mml:mn></mml:msup><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mo>Φ</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mi>B</mml:mi><mml:mn>168</mml:mn></mml:msup><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:msub><mml:mi>a</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(10)</label></disp-formula></p>
      <p><italic>θ</italic><sub><italic>q</italic></sub>(<italic>B</italic>)/<italic>ϕ</italic><sub><italic>p</italic></sub>(<italic>B</italic>) is a ratio of polynomials in the back-shift operator of appropriate orders, respectively; <inline-formula id="pone.0221238.e027"><alternatives><graphic xlink:href="pone.0221238.e027.jpg" id="pone.0221238.e027g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M27"><mml:mrow><mml:msub><mml:mo>Θ</mml:mo><mml:msub><mml:mi>Q</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mi>B</mml:mi><mml:mn>24</mml:mn></mml:msup><mml:mo>)</mml:mo></mml:mrow><mml:mo>/</mml:mo><mml:msub><mml:mo>Φ</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mi>B</mml:mi><mml:mn>24</mml:mn></mml:msup><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> is similarly a ratio with orders <italic>Q</italic><sub>1</sub> and <italic>P</italic><sub>1</sub> in multiples of 24 hours per day; and <inline-formula id="pone.0221238.e028"><alternatives><graphic xlink:href="pone.0221238.e028.jpg" id="pone.0221238.e028g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M28"><mml:mrow><mml:msub><mml:mo>Θ</mml:mo><mml:msub><mml:mi>Q</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mi>B</mml:mi><mml:mn>168</mml:mn></mml:msup><mml:mo>)</mml:mo></mml:mrow><mml:mo>/</mml:mo><mml:msub><mml:mo>Φ</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mi>B</mml:mi><mml:mn>168</mml:mn></mml:msup><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> is similarly defined, though for 168 hours per week. The multi-seasonal extension of the ‘airline’ model used later is shown in <xref ref-type="disp-formula" rid="pone.0221238.e029">Eq (11)</xref>.
<disp-formula id="pone.0221238.e029"><alternatives><graphic xlink:href="pone.0221238.e029.jpg" id="pone.0221238.e029g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M29"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>θ</mml:mi><mml:mi>B</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>B</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mfrac><mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msub><mml:mo>Θ</mml:mo><mml:mn>24</mml:mn></mml:msub><mml:msup><mml:mi>B</mml:mi><mml:mn>24</mml:mn></mml:msup><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msup><mml:mi>B</mml:mi><mml:mn>24</mml:mn></mml:msup><mml:mo>)</mml:mo></mml:mrow></mml:mfrac><mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msub><mml:mo>Θ</mml:mo><mml:mn>168</mml:mn></mml:msub><mml:msup><mml:mi>B</mml:mi><mml:mn>168</mml:mn></mml:msup><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msup><mml:mi>B</mml:mi><mml:mn>168</mml:mn></mml:msup><mml:mo>)</mml:mo></mml:mrow></mml:mfrac><mml:msub><mml:mi>a</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(11)</label></disp-formula></p>
      <p><italic>y</italic><sub><italic>t</italic></sub> in <xref ref-type="disp-formula" rid="pone.0221238.e029">Eq (11)</xref> is the undifferenced time series because the differences are included explicitly in the model denominators.</p>
      <p>The automatic identification applied to these data suggests that daily differencing is not necessary, implying that the ‘airline’ model in <xref ref-type="disp-formula" rid="pone.0221238.e029">Eq (11)</xref> is strictly wrongly specified because of over-differentiation. However, manual identification of demand series imposing the differences implied by the ‘airline’ model (i.e., <inline-formula id="pone.0221238.e030"><alternatives><graphic xlink:href="pone.0221238.e030.jpg" id="pone.0221238.e030g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M30"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>B</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msup><mml:mi>B</mml:mi><mml:mn>24</mml:mn></mml:msup><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msup><mml:mi>B</mml:mi><mml:mn>168</mml:mn></mml:msup><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mtext>demand</mml:mtext><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>) produces a clear evidence in favour of the airline model except for the non-seasonal part of the correlogram (lags 1 to 11, see <xref ref-type="fig" rid="pone.0221238.g005">Fig 5</xref>). Therefore, the airline model will be kept as a benchmark to compare with.</p>
      <fig id="pone.0221238.g005" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0221238.g005</object-id>
        <label>Fig 5</label>
        <caption>
          <title>Simple and Partial Autocorrelation functions for the Spanish load demand data.</title>
          <p>Dotted lines signal daily lags.</p>
        </caption>
        <graphic xlink:href="pone.0221238.g005"/>
      </fig>
      <p>The models trained are: i) a weekly Naïve of period 168 hours per cycle as a bottom benchmark (<italic>Naïve</italic>, daily naïve with period 24 was also tried, but was discarded because the results were systematically worse); ii) multi-seasonal airline in <xref ref-type="disp-formula" rid="pone.0221238.e029">Eq (11)</xref> as a more sophisticated benchmark (<italic>Airline</italic>); iii) multi-seasonal model in <xref ref-type="disp-formula" rid="pone.0221238.e026">Eq (10)</xref> automatically identified with <monospace>modelAUTO</monospace> (<italic>Auto</italic>); and iv) multi-seasonal AR model identified in a similar manner (<italic>AR</italic>).</p>
      <p>All models were estimated and used to forecast a week ahead along a full year (from July 2017 to June 2018) with a rolling forecast origin every 6 hours and samples of 8 weeks length. Thence, 1,460 rounds of 168 hours-ahead forecasts were calculated with each model. The window size (8 weeks) allow the models to adapt for the changing profile of the seasonal components over the year. A full year of data was reserved as the test set to give a better overall idea of forecasting performance, since such performance varies with the season of the year.</p>
      <p>Results for sMAPE and MASE metrics are shown in <xref rid="pone.0221238.t005" ref-type="table">Table 5</xref> for a selection of forecast horizons. Some relevant observations follow. Firstly, the forecast performance deteriorates with the forecast horizon for all methods. Secondly, the <italic>Auto</italic> method is the best for all horizons when compared with <italic>Airline</italic>, meaning that the automatic identification implemented in ECOTOOL makes sense in terms of forecasting performance. Thirdly, <italic>Auto</italic> is better than <italic>AR</italic> as well, implying that including moving average terms in the models pays back in terms of forecasting performance. Finally, a striking result is that the deterioration of the <italic>Naïve</italic> model is much slower than in the rest of cases (though its performance for shorter horizons is rather poor), but it is the best options for the long horizons, for 6 and above days.</p>
      <table-wrap id="pone.0221238.t005" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0221238.t005</object-id>
        <label>Table 5</label>
        <caption>
          <title>Average sMAPE and MASE metrics for different models on electricity demand data.</title>
        </caption>
        <alternatives>
          <graphic id="pone.0221238.t005g" xlink:href="pone.0221238.t005"/>
          <table frame="box" rules="all" border="0">
            <colgroup span="1">
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th align="right" rowspan="1" colspan="1"/>
                <th align="center" colspan="4" rowspan="1">sMAPE</th>
                <th align="center" colspan="4" rowspan="1">MASE</th>
              </tr>
              <tr>
                <th align="right" rowspan="1" colspan="1">Steps</th>
                <th align="right" rowspan="1" colspan="1">Airline</th>
                <th align="right" rowspan="1" colspan="1">Auto</th>
                <th align="right" rowspan="1" colspan="1">AR</th>
                <th align="right" rowspan="1" colspan="1">Naïve</th>
                <th align="right" rowspan="1" colspan="1">Airline</th>
                <th align="right" rowspan="1" colspan="1">Auto</th>
                <th align="right" rowspan="1" colspan="1">AR</th>
                <th align="right" rowspan="1" colspan="1">Naïve</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="right" rowspan="1" colspan="1">1</td>
                <td align="char" char="." rowspan="1" colspan="1">1.945</td>
                <td align="char" char="." rowspan="1" colspan="1">1.910</td>
                <td align="char" char="." rowspan="1" colspan="1">2.101</td>
                <td align="char" char="." rowspan="1" colspan="1">6.061</td>
                <td align="char" char="." rowspan="1" colspan="1">0.236</td>
                <td align="char" char="." rowspan="1" colspan="1">0.232</td>
                <td align="char" char="." rowspan="1" colspan="1">0.255</td>
                <td align="char" char="." rowspan="1" colspan="1">0.774</td>
              </tr>
              <tr>
                <td align="right" rowspan="1" colspan="1">2</td>
                <td align="char" char="." rowspan="1" colspan="1">2.347</td>
                <td align="char" char="." rowspan="1" colspan="1">2.316</td>
                <td align="char" char="." rowspan="1" colspan="1">2.563</td>
                <td align="char" char="." rowspan="1" colspan="1">6.130</td>
                <td align="char" char="." rowspan="1" colspan="1">0.285</td>
                <td align="char" char="." rowspan="1" colspan="1">0.283</td>
                <td align="char" char="." rowspan="1" colspan="1">0.312</td>
                <td align="char" char="." rowspan="1" colspan="1">0.786</td>
              </tr>
              <tr>
                <td align="right" rowspan="1" colspan="1">3</td>
                <td align="char" char="." rowspan="1" colspan="1">2.607</td>
                <td align="char" char="." rowspan="1" colspan="1">2.575</td>
                <td align="char" char="." rowspan="1" colspan="1">2.844</td>
                <td align="char" char="." rowspan="1" colspan="1">6.200</td>
                <td align="char" char="." rowspan="1" colspan="1">0.320</td>
                <td align="char" char="." rowspan="1" colspan="1">0.317</td>
                <td align="char" char="." rowspan="1" colspan="1">0.350</td>
                <td align="char" char="." rowspan="1" colspan="1">0.798</td>
              </tr>
              <tr>
                <td align="right" rowspan="1" colspan="1">4</td>
                <td align="char" char="." rowspan="1" colspan="1">2.797</td>
                <td align="char" char="." rowspan="1" colspan="1">2.753</td>
                <td align="char" char="." rowspan="1" colspan="1">3.037</td>
                <td align="char" char="." rowspan="1" colspan="1">6.251</td>
                <td align="char" char="." rowspan="1" colspan="1">0.346</td>
                <td align="char" char="." rowspan="1" colspan="1">0.341</td>
                <td align="char" char="." rowspan="1" colspan="1">0.377</td>
                <td align="char" char="." rowspan="1" colspan="1">0.808</td>
              </tr>
              <tr>
                <td align="right" rowspan="1" colspan="1">5</td>
                <td align="char" char="." rowspan="1" colspan="1">2.928</td>
                <td align="char" char="." rowspan="1" colspan="1">2.863</td>
                <td align="char" char="." rowspan="1" colspan="1">3.163</td>
                <td align="char" char="." rowspan="1" colspan="1">6.276</td>
                <td align="char" char="." rowspan="1" colspan="1">0.364</td>
                <td align="char" char="." rowspan="1" colspan="1">0.356</td>
                <td align="char" char="." rowspan="1" colspan="1">0.395</td>
                <td align="char" char="." rowspan="1" colspan="1">0.812</td>
              </tr>
              <tr>
                <td align="right" rowspan="1" colspan="1">6</td>
                <td align="char" char="." rowspan="1" colspan="1">3.021</td>
                <td align="char" char="." rowspan="1" colspan="1">2.934</td>
                <td align="char" char="." rowspan="1" colspan="1">3.252</td>
                <td align="char" char="." rowspan="1" colspan="1">6.289</td>
                <td align="char" char="." rowspan="1" colspan="1">0.377</td>
                <td align="char" char="." rowspan="1" colspan="1">0.366</td>
                <td align="char" char="." rowspan="1" colspan="1">0.407</td>
                <td align="char" char="." rowspan="1" colspan="1">0.812</td>
              </tr>
              <tr>
                <td align="right" rowspan="1" colspan="1">7</td>
                <td align="char" char="." rowspan="1" colspan="1">3.135</td>
                <td align="char" char="." rowspan="1" colspan="1">3.032</td>
                <td align="char" char="." rowspan="1" colspan="1">3.382</td>
                <td align="char" char="." rowspan="1" colspan="1">6.257</td>
                <td align="char" char="." rowspan="1" colspan="1">0.391</td>
                <td align="char" char="." rowspan="1" colspan="1">0.378</td>
                <td align="char" char="." rowspan="1" colspan="1">0.423</td>
                <td align="char" char="." rowspan="1" colspan="1">0.806</td>
              </tr>
              <tr>
                <td align="right" rowspan="1" colspan="1">8</td>
                <td align="char" char="." rowspan="1" colspan="1">3.268</td>
                <td align="char" char="." rowspan="1" colspan="1">3.151</td>
                <td align="char" char="." rowspan="1" colspan="1">3.529</td>
                <td align="char" char="." rowspan="1" colspan="1">6.250</td>
                <td align="char" char="." rowspan="1" colspan="1">0.408</td>
                <td align="char" char="." rowspan="1" colspan="1">0.393</td>
                <td align="char" char="." rowspan="1" colspan="1">0.442</td>
                <td align="char" char="." rowspan="1" colspan="1">0.805</td>
              </tr>
              <tr>
                <td align="right" rowspan="1" colspan="1">9</td>
                <td align="char" char="." rowspan="1" colspan="1">3.398</td>
                <td align="char" char="." rowspan="1" colspan="1">3.260</td>
                <td align="char" char="." rowspan="1" colspan="1">3.666</td>
                <td align="char" char="." rowspan="1" colspan="1">6.260</td>
                <td align="char" char="." rowspan="1" colspan="1">0.424</td>
                <td align="char" char="." rowspan="1" colspan="1">0.407</td>
                <td align="char" char="." rowspan="1" colspan="1">0.460</td>
                <td align="char" char="." rowspan="1" colspan="1">0.807</td>
              </tr>
              <tr>
                <td align="right" rowspan="1" colspan="1">12</td>
                <td align="char" char="." rowspan="1" colspan="1">3.672</td>
                <td align="char" char="." rowspan="1" colspan="1">3.488</td>
                <td align="char" char="." rowspan="1" colspan="1">3.952</td>
                <td align="char" char="." rowspan="1" colspan="1">6.291</td>
                <td align="char" char="." rowspan="1" colspan="1">0.460</td>
                <td align="char" char="." rowspan="1" colspan="1">0.437</td>
                <td align="char" char="." rowspan="1" colspan="1">0.498</td>
                <td align="char" char="." rowspan="1" colspan="1">0.812</td>
              </tr>
              <tr>
                <td align="right" rowspan="1" colspan="1">1 day</td>
                <td align="char" char="." rowspan="1" colspan="1">4.399</td>
                <td align="char" char="." rowspan="1" colspan="1">4.084</td>
                <td align="char" char="." rowspan="1" colspan="1">4.734</td>
                <td align="char" char="." rowspan="1" colspan="1">6.289</td>
                <td align="char" char="." rowspan="1" colspan="1">0.557</td>
                <td align="char" char="." rowspan="1" colspan="1">0.516</td>
                <td align="char" char="." rowspan="1" colspan="1">0.602</td>
                <td align="char" char="." rowspan="1" colspan="1">0.812</td>
              </tr>
              <tr>
                <td align="right" rowspan="1" colspan="1">2 days</td>
                <td align="char" char="." rowspan="1" colspan="1">5.400</td>
                <td align="char" char="." rowspan="1" colspan="1">4.860</td>
                <td align="char" char="." rowspan="1" colspan="1">5.607</td>
                <td align="char" char="." rowspan="1" colspan="1">6.282</td>
                <td align="char" char="." rowspan="1" colspan="1">0.688</td>
                <td align="char" char="." rowspan="1" colspan="1">0.616</td>
                <td align="char" char="." rowspan="1" colspan="1">0.718</td>
                <td align="char" char="." rowspan="1" colspan="1">0.811</td>
              </tr>
              <tr>
                <td align="right" rowspan="1" colspan="1">3 days</td>
                <td align="char" char="." rowspan="1" colspan="1">6.216</td>
                <td align="char" char="." rowspan="1" colspan="1">5.369</td>
                <td align="char" char="." rowspan="1" colspan="1">6.205</td>
                <td align="char" char="." rowspan="1" colspan="1">6.282</td>
                <td align="char" char="." rowspan="1" colspan="1">0.795</td>
                <td align="char" char="." rowspan="1" colspan="1">0.682</td>
                <td align="char" char="." rowspan="1" colspan="1">0.797</td>
                <td align="char" char="." rowspan="1" colspan="1">0.811</td>
              </tr>
              <tr>
                <td align="right" rowspan="1" colspan="1">4 days</td>
                <td align="char" char="." rowspan="1" colspan="1">6.920</td>
                <td align="char" char="." rowspan="1" colspan="1">5.737</td>
                <td align="char" char="." rowspan="1" colspan="1">6.663</td>
                <td align="char" char="." rowspan="1" colspan="1">6.294</td>
                <td align="char" char="." rowspan="1" colspan="1">0.888</td>
                <td align="char" char="." rowspan="1" colspan="1">0.730</td>
                <td align="char" char="." rowspan="1" colspan="1">0.860</td>
                <td align="char" char="." rowspan="1" colspan="1">0.813</td>
              </tr>
              <tr>
                <td align="right" rowspan="1" colspan="1">5 days</td>
                <td align="char" char="." rowspan="1" colspan="1">7.634</td>
                <td align="char" char="." rowspan="1" colspan="1">6.096</td>
                <td align="char" char="." rowspan="1" colspan="1">7.074</td>
                <td align="char" char="." rowspan="1" colspan="1">6.303</td>
                <td align="char" char="." rowspan="1" colspan="1">0.982</td>
                <td align="char" char="." rowspan="1" colspan="1">0.778</td>
                <td align="char" char="." rowspan="1" colspan="1">0.917</td>
                <td align="char" char="." rowspan="1" colspan="1">0.814</td>
              </tr>
              <tr>
                <td align="right" rowspan="1" colspan="1">6 days</td>
                <td align="char" char="." rowspan="1" colspan="1">8.383</td>
                <td align="char" char="." rowspan="1" colspan="1">6.436</td>
                <td align="char" char="." rowspan="1" colspan="1">7.483</td>
                <td align="char" char="." rowspan="1" colspan="1">6.309</td>
                <td align="char" char="." rowspan="1" colspan="1">1.080</td>
                <td align="char" char="." rowspan="1" colspan="1">0.823</td>
                <td align="char" char="." rowspan="1" colspan="1">0.974</td>
                <td align="char" char="." rowspan="1" colspan="1">0.815</td>
              </tr>
              <tr>
                <td align="right" rowspan="1" colspan="1">7 days</td>
                <td align="char" char="." rowspan="1" colspan="1">9.106</td>
                <td align="char" char="." rowspan="1" colspan="1">6.711</td>
                <td align="char" char="." rowspan="1" colspan="1">7.819</td>
                <td align="char" char="." rowspan="1" colspan="1">6.314</td>
                <td align="char" char="." rowspan="1" colspan="1">1.175</td>
                <td align="char" char="." rowspan="1" colspan="1">0.859</td>
                <td align="char" char="." rowspan="1" colspan="1">1.024</td>
                <td align="char" char="." rowspan="1" colspan="1">0.816</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
      </table-wrap>
      <p>This latter observation means that standard time series models focus on short-term horizons and more sophisticated extensions should be provided for longer horizons. One clear extension would be to add the annual cycle into the models, since it could be the case that for horizons long enough the lack of a annual cycle starts to be felt.</p>
      <p>One final point worth considering is that the optimal forecasts of the Mauna Loa data in the previous case study are systematically much more accurate than the electricity demand forecasts, because of a much greater level of uncertainty in the latter case. This point may be checked by comparing <xref rid="pone.0221238.t004" ref-type="table">Table 4</xref> with the appropriate rows in <xref rid="pone.0221238.t005" ref-type="table">Table 5</xref>, bearing in mind that 12 and 24 hours ahead in <xref rid="pone.0221238.t005" ref-type="table">Table 5</xref> corresponds to 1 and 2 years in <xref rid="pone.0221238.t004" ref-type="table">Table 4</xref>, respectively. The sMAPE for electricity demand 24 steps ahead is about 30 times the sMAPE for the CO<sub>2</sub> concentration data.</p>
    </sec>
    <sec id="sec013">
      <title>Global Horizontal Irradiation forecasting at a photovoltaic plant in Ciudad Real, Spain</title>
      <p>This case study evaluates the forecasting performance of the models implemented in ECOTOOL when applied to the Global Horizontal Irradiation (GHI) data provided by the Spanish Meteorological Estate Agency (AEMET) weather station located at Ciudad Real, Spain. The original dataset consisted of 18 years of GHI hourly observations. <xref ref-type="fig" rid="pone.0221238.g006">Fig 6</xref> shows an overview of the last year of data that shows clearly the annual cycle and the variability among different days, sometimes weeks, depending mainly on the cloud cover.</p>
      <fig id="pone.0221238.g006" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0221238.g006</object-id>
        <label>Fig 6</label>
        <caption>
          <title>A full year of GHI data at a photovoltaic plant in Ciudad Real, Spain.</title>
        </caption>
        <graphic xlink:href="pone.0221238.g006"/>
      </fig>
      <p>One typical feature of the data is that GHI drops down to zero every night at different times within the day depending on the sunrise and sunset times. Consequently, the time series contains numerous zeros deterministically located along the year. In winter there are just 10 sun hours, while in summer the Sun shines for up to 16 hours. An efficient way to deal with this singularity of the data is removing such zeros before the modelling stage and inserting them back to build the final forecast for full days. In this way, at each forecast origin the periodicity of the data is different, depending on the time of the year.</p>
      <p>Due to this peculiarity, the data is rather heteroscedastic along the year. This problem may be alleviated by the Box-Cox transformation, that in ECOTOOL is implemented in the function vboxcox (that may be run directly or by a menu option within <monospace>toolTEST</monospace>), in which the optimal lambda is estimated following the model-independent approach by [<xref rid="pone.0221238.ref033" ref-type="bibr">33</xref>]. Lambda turned up to be close to 0 in most cases, meaning that the optimal transformation is the natural logarithm. <xref ref-type="fig" rid="pone.0221238.g007">Fig 7</xref> illustrates the convenience of these two transformations. Top panel shows two months of the original data, while the bottom panel shows the data in logs and after zero-removal. The sample length is drastically reduced (only 10 samples per day out of 24 remained in the case shown) and the natural logarithm transformation renders a time series with proper statistical properties, at least regarding homoskedasticity.</p>
      <fig id="pone.0221238.g007" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0221238.g007</object-id>
        <label>Fig 7</label>
        <caption>
          <title>Two months of original GHI data (top panel) and the data after transformation with Box-Cox and removal of night zero values.</title>
        </caption>
        <graphic xlink:href="pone.0221238.g007"/>
      </fig>
      <p>This case, unlike electricity demand, is not multi-seasonal, since only a diurnal period is observed on top of an annual cycle. The annual cycle is ignored because models used are sensible strictly for short run forecasting (see discussion on this issue in the previous case study). Then, the methods used in this case are the ones already used in the Mauna Loa case, but with time varying periods due to the zero values removal. More specifically the models are ARIMA <italic>Airline</italic>; ARIMA <italic>Auto</italic> identified by means of <monospace>modelAUTO</monospace>; automatic <italic>AR</italic> models; <italic>UC</italic> model; <italic>ETS</italic> and seasonal <italic>Naïve</italic> of period 24 hours.</p>
      <p>To illustrate ECOTOOL working on this data, the rolling experiment is conducted by selecting samples of 2 months of data previous to each forecasting origin. One week ahead of data is forecast at each step and the forecast origin is moved 6 hours forward. The evaluation is repeated along a full year of data, i.e., 1,460 total runs of each model.</p>
      <p>sMAPE metrics cannot be computed in this case due to the presence of simultaneous zeros in data and forecasts. Indeed, inspection of <xref ref-type="disp-formula" rid="pone.0221238.e023">Eq (8)</xref> shows this is one of few particular cases where sMAPE is not defined because both forecasts and actual values are zero. Cases like this highlights the utility of other metrics, like MASE that may be still be computed.</p>
      <p>Results are reported in <xref rid="pone.0221238.t006" ref-type="table">Table 6</xref>, showing clearly that the GHI data is less forecastable than the previous cases. The main reason for this is that all the MASE measurements are much bigger now. As an example, the <italic>Auto</italic> model renders MASE values that are about twice the electricity case and almost four times the Mauna Loa case for 12 steps ahead forecasts. But the main reason is that the <italic>Naïve</italic> model, i.e., projecting as forecasts into the future just the last seasonal cycle available, is rather good. Indeed, for horizons longer than 9 hours ahead, the <italic>Naïve</italic> model is the absolute winner, and it is the best than most of them for horizons longer than 6 hours ahead.</p>
      <table-wrap id="pone.0221238.t006" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0221238.t006</object-id>
        <label>Table 6</label>
        <caption>
          <title>MASE metrics for different models on a GHI data from a photovoltaic plan in Spain.</title>
        </caption>
        <alternatives>
          <graphic id="pone.0221238.t006g" xlink:href="pone.0221238.t006"/>
          <table frame="box" rules="all" border="0">
            <colgroup span="1">
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th align="right" rowspan="1" colspan="1">Steps</th>
                <th align="right" rowspan="1" colspan="1">Airline</th>
                <th align="right" rowspan="1" colspan="1">Auto</th>
                <th align="right" rowspan="1" colspan="1">AR</th>
                <th align="right" rowspan="1" colspan="1">UC</th>
                <th align="right" rowspan="1" colspan="1">ETS</th>
                <th align="right" rowspan="1" colspan="1">Naive</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="right" rowspan="1" colspan="1">1</td>
                <td align="char" char="." rowspan="1" colspan="1">0.578</td>
                <td align="char" char="." rowspan="1" colspan="1">0.582</td>
                <td align="char" char="." rowspan="1" colspan="1">0.648</td>
                <td align="char" char="." rowspan="1" colspan="1">0.586</td>
                <td align="char" char="." rowspan="1" colspan="1">0.753</td>
                <td align="char" char="." rowspan="1" colspan="1">0.924</td>
              </tr>
              <tr>
                <td align="right" rowspan="1" colspan="1">2</td>
                <td align="char" char="." rowspan="1" colspan="1">0.718</td>
                <td align="char" char="." rowspan="1" colspan="1">0.712</td>
                <td align="char" char="." rowspan="1" colspan="1">0.793</td>
                <td align="char" char="." rowspan="1" colspan="1">0.744</td>
                <td align="char" char="." rowspan="1" colspan="1">0.917</td>
                <td align="char" char="." rowspan="1" colspan="1">1.001</td>
              </tr>
              <tr>
                <td align="right" rowspan="1" colspan="1">3</td>
                <td align="char" char="." rowspan="1" colspan="1">0.847</td>
                <td align="char" char="." rowspan="1" colspan="1">0.821</td>
                <td align="char" char="." rowspan="1" colspan="1">0.924</td>
                <td align="char" char="." rowspan="1" colspan="1">0.926</td>
                <td align="char" char="." rowspan="1" colspan="1">1.108</td>
                <td align="char" char="." rowspan="1" colspan="1">1.049</td>
              </tr>
              <tr>
                <td align="right" rowspan="1" colspan="1">4</td>
                <td align="char" char="." rowspan="1" colspan="1">0.957</td>
                <td align="char" char="." rowspan="1" colspan="1">0.905</td>
                <td align="char" char="." rowspan="1" colspan="1">1.026</td>
                <td align="char" char="." rowspan="1" colspan="1">1.127</td>
                <td align="char" char="." rowspan="1" colspan="1">1.304</td>
                <td align="char" char="." rowspan="1" colspan="1">1.063</td>
              </tr>
              <tr>
                <td align="right" rowspan="1" colspan="1">5</td>
                <td align="char" char="." rowspan="1" colspan="1">1.036</td>
                <td align="char" char="." rowspan="1" colspan="1">0.953</td>
                <td align="char" char="." rowspan="1" colspan="1">1.101</td>
                <td align="char" char="." rowspan="1" colspan="1">1.290</td>
                <td align="char" char="." rowspan="1" colspan="1">1.462</td>
                <td align="char" char="." rowspan="1" colspan="1">1.054</td>
              </tr>
              <tr>
                <td align="right" rowspan="1" colspan="1">6</td>
                <td align="char" char="." rowspan="1" colspan="1">1.090</td>
                <td align="char" char="." rowspan="1" colspan="1">0.972</td>
                <td align="char" char="." rowspan="1" colspan="1">1.143</td>
                <td align="char" char="." rowspan="1" colspan="1">1.407</td>
                <td align="char" char="." rowspan="1" colspan="1">1.577</td>
                <td align="char" char="." rowspan="1" colspan="1">1.034</td>
              </tr>
              <tr>
                <td align="right" rowspan="1" colspan="1">7</td>
                <td align="char" char="." rowspan="1" colspan="1">1.135</td>
                <td align="char" char="." rowspan="1" colspan="1">0.991</td>
                <td align="char" char="." rowspan="1" colspan="1">1.177</td>
                <td align="char" char="." rowspan="1" colspan="1">1.485</td>
                <td align="char" char="." rowspan="1" colspan="1">1.659</td>
                <td align="char" char="." rowspan="1" colspan="1">1.019</td>
              </tr>
              <tr>
                <td align="right" rowspan="1" colspan="1">8</td>
                <td align="char" char="." rowspan="1" colspan="1">1.184</td>
                <td align="char" char="." rowspan="1" colspan="1">1.015</td>
                <td align="char" char="." rowspan="1" colspan="1">1.213</td>
                <td align="char" char="." rowspan="1" colspan="1">1.544</td>
                <td align="char" char="." rowspan="1" colspan="1">1.739</td>
                <td align="char" char="." rowspan="1" colspan="1">1.027</td>
              </tr>
              <tr>
                <td align="right" rowspan="1" colspan="1">9</td>
                <td align="char" char="." rowspan="1" colspan="1">1.235</td>
                <td align="char" char="." rowspan="1" colspan="1">1.042</td>
                <td align="char" char="." rowspan="1" colspan="1">1.261</td>
                <td align="char" char="." rowspan="1" colspan="1">1.590</td>
                <td align="char" char="." rowspan="1" colspan="1">1.812</td>
                <td align="char" char="." rowspan="1" colspan="1">1.040</td>
              </tr>
              <tr>
                <td align="right" rowspan="1" colspan="1">12</td>
                <td align="char" char="." rowspan="1" colspan="1">1.306</td>
                <td align="char" char="." rowspan="1" colspan="1">1.076</td>
                <td align="char" char="." rowspan="1" colspan="1">1.329</td>
                <td align="char" char="." rowspan="1" colspan="1">1.670</td>
                <td align="char" char="." rowspan="1" colspan="1">1.916</td>
                <td align="char" char="." rowspan="1" colspan="1">1.035</td>
              </tr>
              <tr>
                <td align="right" rowspan="1" colspan="1">1 day</td>
                <td align="char" char="." rowspan="1" colspan="1">1.346</td>
                <td align="char" char="." rowspan="1" colspan="1">1.110</td>
                <td align="char" char="." rowspan="1" colspan="1">1.403</td>
                <td align="char" char="." rowspan="1" colspan="1">1.653</td>
                <td align="char" char="." rowspan="1" colspan="1">1.855</td>
                <td align="char" char="." rowspan="1" colspan="1">1.036</td>
              </tr>
              <tr>
                <td align="right" rowspan="1" colspan="1">2 days</td>
                <td align="char" char="." rowspan="1" colspan="1">1.484</td>
                <td align="char" char="." rowspan="1" colspan="1">1.191</td>
                <td align="char" char="." rowspan="1" colspan="1">1.623</td>
                <td align="char" char="." rowspan="1" colspan="1">1.700</td>
                <td align="char" char="." rowspan="1" colspan="1">1.894</td>
                <td align="char" char="." rowspan="1" colspan="1">1.098</td>
              </tr>
              <tr>
                <td align="right" rowspan="1" colspan="1">3 days</td>
                <td align="char" char="." rowspan="1" colspan="1">1.602</td>
                <td align="char" char="." rowspan="1" colspan="1">1.257</td>
                <td align="char" char="." rowspan="1" colspan="1">1.910</td>
                <td align="char" char="." rowspan="1" colspan="1">1.724</td>
                <td align="char" char="." rowspan="1" colspan="1">1.916</td>
                <td align="char" char="." rowspan="1" colspan="1">1.144</td>
              </tr>
              <tr>
                <td align="right" rowspan="1" colspan="1">4 days</td>
                <td align="char" char="." rowspan="1" colspan="1">1.731</td>
                <td align="char" char="." rowspan="1" colspan="1">1.328</td>
                <td align="char" char="." rowspan="1" colspan="1">2.314</td>
                <td align="char" char="." rowspan="1" colspan="1">1.754</td>
                <td align="char" char="." rowspan="1" colspan="1">1.943</td>
                <td align="char" char="." rowspan="1" colspan="1">1.192</td>
              </tr>
              <tr>
                <td align="right" rowspan="1" colspan="1">5 days</td>
                <td align="char" char="." rowspan="1" colspan="1">1.860</td>
                <td align="char" char="." rowspan="1" colspan="1">1.397</td>
                <td align="char" char="." rowspan="1" colspan="1">2.911</td>
                <td align="char" char="." rowspan="1" colspan="1">1.777</td>
                <td align="char" char="." rowspan="1" colspan="1">1.961</td>
                <td align="char" char="." rowspan="1" colspan="1">1.222</td>
              </tr>
              <tr>
                <td align="right" rowspan="1" colspan="1">6 days</td>
                <td align="char" char="." rowspan="1" colspan="1">1.985</td>
                <td align="char" char="." rowspan="1" colspan="1">1.463</td>
                <td align="char" char="." rowspan="1" colspan="1">3.867</td>
                <td align="char" char="." rowspan="1" colspan="1">1.793</td>
                <td align="char" char="." rowspan="1" colspan="1">1.973</td>
                <td align="char" char="." rowspan="1" colspan="1">1.247</td>
              </tr>
              <tr>
                <td align="right" rowspan="1" colspan="1">7 days</td>
                <td align="char" char="." rowspan="1" colspan="1">2.112</td>
                <td align="char" char="." rowspan="1" colspan="1">1.526</td>
                <td align="char" char="." rowspan="1" colspan="1">5.608</td>
                <td align="char" char="." rowspan="1" colspan="1">1.803</td>
                <td align="char" char="." rowspan="1" colspan="1">1.982</td>
                <td align="char" char="." rowspan="1" colspan="1">1.268</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
      </table-wrap>
      <p>But still, this confusing evidence should not distract from other type of evidence. Firstly, for horizons shorter than 9 hours the best method is <italic>Auto</italic>. Secondly, the performance of <italic>ETS</italic> is rather poor, since is better than <italic>Naïve</italic> only for 1 and 2 hours ahead. Thirdly, <italic>AR</italic> is more accurate than <italic>UC</italic> and <italic>ETS</italic> for short horizons, but it deteriorates rather badly for longer horizons. Finally, <italic>Airline</italic> and <italic>Auto</italic> outperforms <italic>AR</italic> for any forecast horizon.</p>
      <p>Putting together all this evidence, several conclusions follow:</p>
      <list list-type="bullet">
        <list-item>
          <p>Forecasting GHI data is rather difficult because of its inherent volatility. Improving simple models for horizons longer than 9 hours ahead may require a lot of modelling effort. The improvements may be more related to the use of inputs (like cloud cover) than to other methods closer to Machine Learning that usually concentrate on very short forecast horizons. However, predicting cloud cover to use them as an input to GHI may be more complex than predicting GHI itself.</p>
        </list-item>
        <list-item>
          <p>Pure AR models are sub-optimal, especially bad in this case study. If ARIMA models want to be used, there is no doubt that MA terms are very helpful in relation to forecasting accuracy, in contrast to the view of [<xref rid="pone.0221238.ref014" ref-type="bibr">14</xref>].</p>
        </list-item>
        <list-item>
          <p>The automatic identification of ARIMA models implemented in ECOTOOL produces models that outperform the rest.</p>
        </list-item>
      </list>
    </sec>
  </sec>
  <sec sec-type="conclusions" id="sec014">
    <title>Conclusions</title>
    <p>This paper has introduced ECOTOOL, a toolbox intended mainly for professional practitioners, academic researchers, students, and anyone involved in the analysis of time series, forecasting or signal processing. ECOTOOL is composed of a number of powerful functions to estimate a wide range of models in a rather user friendly manner; with abundant tools for identification, validation and graphical representation of results.</p>
    <p>The main methods implemented are ARIMA, Exponential Smoothing, Unobserved Components, ARX, ARMAX, Transfer Function, Distributed Lag models and VARX. Several properties are the salient features of the toolbox, e.g. it is user-oriented; just a few MATLAB functions are enough to carry out a complete analysis of time series; model specification is rather simple and flexible; several estimation methods are implemented; automatic detection and estimation of four types of outliers is implemented; the toolbox is very robust making it useful in long automatic experiments in programming environments.</p>
    <p>The toolbox also provides a wide range of descriptive information of the data, both graphically and in tabular format; standard and not so standard identification tools; formal and visual tests for gaussianity, independence, causality, heteroscedasticity, non-linearity, unit root and cointegration; spectral tools; tests on forecasting performance; etc.</p>
    <p>Though many of the procedures implemented may be found in other software packages, some of them are exclusive to ECOTOOL, to the author knowledge. It is the case of the automatic identification of multi seasonal ARIMA models, automatic detection of outliers in Unobserved Components and Exponential Smoothing models, and the possibility of estimating Unobserved Components and Exponential Smoothing models by Exact Maximum Likelihood adding inputs specified as dynamic transfer functions.</p>
    <p>The toolbox is shown working on three case studies, in which several methods are tested on forecasting time series with different sampling interval and degrees of complexity, namely the monthly CO<sub>2</sub> concentration data at Mauna Loa, hourly electricity demand in Spain, and hourly global horizontal irradiation at a photovoltaic plant in Ciudad Real, Spain.</p>
    <p>Results show clearly that forecastability depends strongly on the case, being the global irradiation the worst case to forecast. In all cases, the automatic procedure of identification of ARIMA models shows great potentiallity as a general tool in forecasting tasks and including moving average terms in ARIMA models increases forecast accuracy.</p>
  </sec>
</body>
<back>
  <ref-list>
    <title>References</title>
    <ref id="pone.0221238.ref001">
      <label>1</label>
      <mixed-citation publication-type="other">The MathWorks Inc. MATLAB—The Language of Technical Computing, Version R2018a. Natick, Massachusetts. URL <ext-link ext-link-type="uri" xlink:href="http://www.mathworks.com/products/matlab/">http://www.mathworks.com/products/matlab/</ext-link>; 2018.</mixed-citation>
    </ref>
    <ref id="pone.0221238.ref002">
      <label>2</label>
      <mixed-citation publication-type="journal"><name><surname>Taylor</surname><given-names>CJ</given-names></name>, <name><surname>Pedregal</surname><given-names>DJ</given-names></name>, <name><surname>Young</surname><given-names>PC</given-names></name>, <name><surname>Tych</surname><given-names>W</given-names></name>. <article-title>Environmental Time Series Analysis and Forecasting with the Captain Toolbox</article-title>. <source>Environmental Modelling &amp; Software</source>. <year>2007</year>;<volume>22</volume>(<issue>6</issue>):<fpage>797</fpage>–<lpage>814</lpage>. <pub-id pub-id-type="doi">10.1016/j.envsoft.2006.03.002</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0221238.ref003">
      <label>3</label>
      <mixed-citation publication-type="book"><name><surname>Liu</surname><given-names>LM</given-names></name>. <source>Time Series Analysis and forecasting</source>. <publisher-name>Scientific Computing Associates Corp.</publisher-name>; <year>2009</year>.</mixed-citation>
    </ref>
    <ref id="pone.0221238.ref004">
      <label>4</label>
      <mixed-citation publication-type="book"><name><surname>Gómez</surname><given-names>V</given-names></name>, <name><surname>Maravall</surname><given-names>A</given-names></name>. <chapter-title>Automatic Modeling Methods for Univariate Series</chapter-title> In: <source>A Course in Time Series</source>. <publisher-name>John Wiley &amp; Sons, Inc.</publisher-name>; <year>2001</year> p. <fpage>171</fpage>–<lpage>201</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0221238.ref005">
      <label>5</label>
      <mixed-citation publication-type="journal"><name><surname>Hyndman</surname><given-names>RJ</given-names></name>, <name><surname>Khandakar</surname><given-names>Y</given-names></name>. <article-title>Automatic Time Series Forecasting: The Forecast Package for R</article-title>. <source>Journal of Statistical Software</source>. <year>2008</year>;<volume>3</volume>(<issue>27</issue>):<fpage>1</fpage>–<lpage>22</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0221238.ref006">
      <label>6</label>
      <mixed-citation publication-type="other">Cottrell A, R L. Gretl; 2018. <ext-link ext-link-type="uri" xlink:href="http://gretl.sourceforge.net/">http://gretl.sourceforge.net/</ext-link>.</mixed-citation>
    </ref>
    <ref id="pone.0221238.ref007">
      <label>7</label>
      <mixed-citation publication-type="book"><name><surname>Koopman</surname><given-names>S</given-names></name>, <name><surname>Harvey</surname><given-names>A</given-names></name>, <name><surname>Doornik</surname><given-names>J</given-names></name>, <name><surname>Shephard</surname><given-names>N</given-names></name>. <source>STAMP 8.2: Structural Time Series Analyser and Modeller and Predictor</source>. <publisher-name>Timberlake Consultants Limited</publisher-name>; <year>2009</year>.</mixed-citation>
    </ref>
    <ref id="pone.0221238.ref008">
      <label>8</label>
      <mixed-citation publication-type="journal"><name><surname>Bossche</surname><given-names>FV</given-names></name>. <article-title>Fitting State Space Models with EViews</article-title>. <source>Journal of Statistical Software</source>. <year>2011</year>;<volume>41</volume>(<issue>8</issue>):<fpage>1</fpage>–<lpage>16</lpage>. <pub-id pub-id-type="doi">10.18637/jss.v041.i08</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0221238.ref009">
      <label>9</label>
      <mixed-citation publication-type="journal"><name><surname>Selukar</surname><given-names>R</given-names></name>. <article-title>State Space Modeling Using SAS</article-title>. <source>Journal of Statistical Software</source>. <year>2011</year>;<volume>41</volume>(<issue>12</issue>):<fpage>1</fpage>–<lpage>13</lpage>. <pub-id pub-id-type="doi">10.18637/jss.v041.i12</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0221238.ref010">
      <label>10</label>
      <mixed-citation publication-type="journal"><name><surname>Drukker</surname><given-names>R</given-names></name>, <name><surname>Gates</surname><given-names>R</given-names></name>. <article-title>State Space Methods in Stata</article-title>. <source>Journal of Statistical Software</source>. <year>2011</year>;<volume>41</volume>(<issue>10</issue>):<fpage>1</fpage>–<lpage>25</lpage>. <pub-id pub-id-type="doi">10.18637/jss.v041.i10</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0221238.ref011">
      <label>11</label>
      <mixed-citation publication-type="book"><name><surname>Hyndman</surname><given-names>R</given-names></name>, <name><surname>Koehler</surname><given-names>AB</given-names></name>, <name><surname>Ord</surname><given-names>JK</given-names></name>, <name><surname>Snyder</surname><given-names>RD</given-names></name>. <source>Forecasting with Exponential Smoothing: the State Space Approach</source>. <publisher-name>Springer Science &amp; Business Media</publisher-name>; <year>2008</year>.</mixed-citation>
    </ref>
    <ref id="pone.0221238.ref012">
      <label>12</label>
      <mixed-citation publication-type="book"><name><surname>Box</surname><given-names>GEP</given-names></name>, <name><surname>Jenkins</surname><given-names>GM</given-names></name>, <name><surname>Reinsel</surname><given-names>GC</given-names></name>, <name><surname>Ljung</surname><given-names>GM</given-names></name>. <source>Time Series Analysis: Forecasting and Control</source>. <edition>5th ed</edition><publisher-name>John Wiley &amp; Sons</publisher-name>; <year>2015</year>.</mixed-citation>
    </ref>
    <ref id="pone.0221238.ref013">
      <label>13</label>
      <mixed-citation publication-type="book"><name><surname>Harvey</surname><given-names>AC</given-names></name>. <source>Forecasting, Structural Time Series Models and the Kalman Filter</source>. <publisher-name>Cambridge university press</publisher-name>; <year>1989</year>.</mixed-citation>
    </ref>
    <ref id="pone.0221238.ref014">
      <label>14</label>
      <mixed-citation publication-type="journal"><name><surname>Chen</surname><given-names>J</given-names></name>, <name><surname>Boccelli</surname><given-names>DL</given-names></name>. <article-title>Real-time forecasting and visualization toolkit for multi-seasonal time series</article-title>. <source>Environmental Modelling &amp; Software</source>. <year>2018</year>;<volume>105</volume>:<fpage>244</fpage>–<lpage>256</lpage>. <pub-id pub-id-type="doi">10.1016/j.envsoft.2018.03.034</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0221238.ref015">
      <label>15</label>
      <mixed-citation publication-type="journal"><name><surname>Zeng</surname><given-names>Q</given-names></name>, <name><surname>Wen</surname><given-names>H</given-names></name>, <name><surname>Huang</surname><given-names>H</given-names></name>, <name><surname>Pei</surname><given-names>X</given-names></name>, <name><surname>Wong</surname><given-names>SC</given-names></name>. <article-title>Incorporating temporal correlation into a multivariate random parameters Tobit model for modeling crash rate by injury severity</article-title>. <source>Transportmetrica A: Transport Science</source>. <year>2018</year>;<volume>14</volume>(<issue>3</issue>):<fpage>177</fpage>–<lpage>191</lpage>. <pub-id pub-id-type="doi">10.1080/23249935.2017.1353556</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0221238.ref016">
      <label>16</label>
      <mixed-citation publication-type="book"><name><surname>Wei</surname><given-names>WS</given-names></name>. <source>Time Series Analysis–Univariate and Multivariate Methods</source>. <publisher-name>Temple University</publisher-name><publisher-loc>USA</publisher-loc>; <year>2006</year>.</mixed-citation>
    </ref>
    <ref id="pone.0221238.ref017">
      <label>17</label>
      <mixed-citation publication-type="journal"><name><surname>Pedregal</surname><given-names>DJ</given-names></name>, <name><surname>Trapero</surname><given-names>JR</given-names></name>. <article-title>Mid-term hourly electricity forecasting based on a multi-rate approach</article-title>. <source>Energy Conversion and Management</source>. <year>2010</year>;<volume>51</volume>(<issue>1</issue>):<fpage>105</fpage>–<lpage>111</lpage>. <pub-id pub-id-type="doi">10.1016/j.enconman.2009.08.028</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0221238.ref018">
      <label>18</label>
      <mixed-citation publication-type="journal"><name><surname>Chen</surname><given-names>F</given-names></name>, <name><surname>Chen</surname><given-names>S</given-names></name>, <name><surname>Ma</surname><given-names>X</given-names></name>. <article-title>Analysis of hourly crash likelihood using unbalanced panel data mixed logit model and real-time driving environmental big data</article-title>. <source>Journal of Safety Research</source>. <year>2018</year>;<volume>65</volume>:<fpage>153</fpage>–<lpage>159</lpage>. <pub-id pub-id-type="doi">10.1016/j.jsr.2018.02.010</pub-id><?supplied-pmid 29776524?><pub-id pub-id-type="pmid">29776524</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0221238.ref019">
      <label>19</label>
      <mixed-citation publication-type="journal"><name><surname>Ma</surname><given-names>X</given-names></name>, <name><surname>Chen</surname><given-names>S</given-names></name>, <name><surname>Chen</surname><given-names>F</given-names></name>. <article-title>Multivariate space-time modeling of crash frequencies by injury severity levels</article-title>. <source>Analytic Methods in Accident Research</source>. <year>2017</year>;<volume>15</volume>:<fpage>29</fpage>–<lpage>40</lpage>. <pub-id pub-id-type="doi">10.1016/j.amar.2017.06.001</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0221238.ref020">
      <label>20</label>
      <mixed-citation publication-type="book"><name><surname>Durbin</surname><given-names>J</given-names></name>, <name><surname>Koopman</surname><given-names>SJ</given-names></name>. <source>Time Series Analysis by State Space Methods</source>. <edition>2nd ed</edition><publisher-name>Oxford University Press</publisher-name>; <year>2012</year>.</mixed-citation>
    </ref>
    <ref id="pone.0221238.ref021">
      <label>21</label>
      <mixed-citation publication-type="journal"><name><surname>Tsay</surname><given-names>RS</given-names></name>. <article-title>Time Series Model Specification in the Presence of Outliers</article-title>. <source>Journal of the American Statistical Association</source>. <year>1986</year>;<volume>81</volume>(<issue>393</issue>):<fpage>132</fpage>–<lpage>141</lpage>. <pub-id pub-id-type="doi">10.1080/01621459.1986.10478250</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0221238.ref022">
      <label>22</label>
      <mixed-citation publication-type="journal"><name><surname>Broze</surname><given-names>L</given-names></name>, <name><surname>Mélard</surname><given-names>G</given-names></name>. <article-title>Exponential smoothing: Estimation by maximum likelihood</article-title>. <source>Journal of Forecasting</source>. <year>1990</year>;<volume>9</volume>(<issue>5</issue>):<fpage>445</fpage>–<lpage>455</lpage>. <pub-id pub-id-type="doi">10.1002/for.3980090504</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0221238.ref023">
      <label>23</label>
      <mixed-citation publication-type="journal"><name><surname>Lilliefors</surname><given-names>HW</given-names></name>. <article-title>On the Kolmogorov-Smirnov Test for Normality with Mean and Variance Unknown</article-title>. <source>Journal of the American Statistical Association</source>. <year>1967</year>;<volume>62</volume>(<issue>318</issue>):<fpage>399</fpage>–<lpage>402</lpage>. <pub-id pub-id-type="doi">10.1080/01621459.1967.10482916</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0221238.ref024">
      <label>24</label>
      <mixed-citation publication-type="journal"><name><surname>Bera</surname><given-names>AK</given-names></name>, <name><surname>Jarque</surname><given-names>CM</given-names></name>. <article-title>Efficient tests for normality, homoscedasticity and serial independence of regression residuals: Monte Carlo Evidence</article-title>. <source>Economics Letters</source>. <year>1981</year>;<volume>7</volume>(<issue>4</issue>):<fpage>313</fpage>–<lpage>318</lpage>. <pub-id pub-id-type="doi">10.1016/0165-1765(81)90035-5</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0221238.ref025">
      <label>25</label>
      <mixed-citation publication-type="journal"><name><surname>Ljung</surname><given-names>GM</given-names></name>, <name><surname>Box</surname><given-names>GEP</given-names></name>. <article-title>On a measure of lack of fit in time series models</article-title>. <source>Biometrika</source>. <year>1978</year>;<volume>65</volume>(<issue>2</issue>):<fpage>297</fpage>–<lpage>303</lpage>. <pub-id pub-id-type="doi">10.1093/biomet/65.2.297</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0221238.ref026">
      <label>26</label>
      <mixed-citation publication-type="journal"><name><surname>Monti</surname><given-names>AC</given-names></name>. <article-title>A Proposal for a Residual Autocorrelation Test in Linear Models</article-title>. <source>Biometrika</source>. <year>1994</year>;<volume>81</volume>(<issue>4</issue>):<fpage>776</fpage>–<lpage>780</lpage>. <pub-id pub-id-type="doi">10.1093/biomet/81.4.776</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0221238.ref027">
      <label>27</label>
      <mixed-citation publication-type="journal"><name><surname>Akaike</surname><given-names>H</given-names></name>. <article-title>A New Look at the Statistical Model Identification</article-title>. <source>IEEE Transactions on Automatic Control</source>. <year>1974</year>;<volume>19</volume>:<fpage>716</fpage>–<lpage>723</lpage>. <pub-id pub-id-type="doi">10.1109/TAC.1974.1100705</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0221238.ref028">
      <label>28</label>
      <mixed-citation publication-type="journal"><name><surname>Schwarz</surname><given-names>GE</given-names></name>. <article-title>Estimating the Dimension of a Model</article-title>. <source>Annals of Statistics</source>. <year>1978</year>;<volume>6</volume>:<fpage>461</fpage>–<lpage>464</lpage>. <pub-id pub-id-type="doi">10.1214/aos/1176344136</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0221238.ref029">
      <label>29</label>
      <mixed-citation publication-type="journal"><name><surname>Hannan</surname><given-names>EJ</given-names></name>, <name><surname>Quinn</surname><given-names>BG</given-names></name>. <article-title>The Determination of the order of an autoregression</article-title>. <source>Journal of the Royal Statistical Society, Series B</source>. <year>1979</year>;<volume>41</volume>:<fpage>190</fpage>–<lpage>195</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0221238.ref030">
      <label>30</label>
      <mixed-citation publication-type="journal"><name><surname>Granger</surname><given-names>CWJ</given-names></name>. <article-title>Investigating Causal Relations by Econometric Models and Cross-spectral Methods</article-title>. <source>Econometrica</source>. <year>1969</year>;<volume>37</volume>(<issue>3</issue>):<fpage>424</fpage>–<lpage>438</lpage>. <pub-id pub-id-type="doi">10.2307/1912791</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0221238.ref031">
      <label>31</label>
      <mixed-citation publication-type="journal"><name><surname>Brown</surname><given-names>RL</given-names></name>, <name><surname>J</surname><given-names>D</given-names></name>, <name><surname>M</surname><given-names>EJ</given-names></name>. <article-title>Techniques for testing the constancy of regression relationships over time (with discussion)</article-title>. <source>Journal of the Royal Statistical Society B</source>. <year>1975</year>;<volume>37</volume>:<fpage>149</fpage>–<lpage>192</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0221238.ref032">
      <label>32</label>
      <mixed-citation publication-type="journal"><name><surname>Box</surname><given-names>GEP</given-names></name>, <name><surname>Cox</surname><given-names>DR</given-names></name>. <article-title>An Analysis of Transformations</article-title>. <source>Journal of the Royal Statistical Society Series B (Methodological)</source>. <year>1964</year>;<volume>26</volume>(<issue>2</issue>):<fpage>211</fpage>–<lpage>252</lpage>. <pub-id pub-id-type="doi">10.1111/j.2517-6161.1964.tb00553.x</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0221238.ref033">
      <label>33</label>
      <mixed-citation publication-type="journal"><name><surname>Guerrero</surname><given-names>VM</given-names></name>. <article-title>Time series analysis supported by power transformations</article-title>. <source>Journal of Forecasting</source>. <year>1993</year>;<volume>12</volume>(<issue>1</issue>):<fpage>37</fpage>–<lpage>48</lpage>. <pub-id pub-id-type="doi">10.1002/for.3980120104</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0221238.ref034">
      <label>34</label>
      <mixed-citation publication-type="journal"><name><surname>Dickey</surname><given-names>DA</given-names></name>, <name><surname>Fuller</surname><given-names>WA</given-names></name>. <article-title>Distribution of the Estimators for Autoregressive Time Series with a Unit Root</article-title>. <source>Journal of the American Statistical Association</source>. <year>1979</year>;<volume>74</volume>(<issue>366a</issue>):<fpage>427</fpage>–<lpage>431</lpage>. <pub-id pub-id-type="doi">10.2307/2286348</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0221238.ref035">
      <label>35</label>
      <mixed-citation publication-type="journal"><name><surname>Phillips</surname><given-names>PCB</given-names></name>, <name><surname>Perron</surname><given-names>P</given-names></name>. <article-title>Testing for a Unit Root in Time Series Regression</article-title>. <source>Biometrika</source>. <year>1988</year>;<volume>75</volume>(<issue>2</issue>):<fpage>335</fpage>–<lpage>346</lpage>. <pub-id pub-id-type="doi">10.1093/biomet/75.2.335</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0221238.ref036">
      <label>36</label>
      <mixed-citation publication-type="journal"><name><surname>Johansen</surname><given-names>S</given-names></name>. <article-title>Estimation and Hypothesis Testing of Cointegration Vectors in Gaussian Vector Autoregressive Models</article-title>. <source>Econometrica</source>. <year>1991</year>;<volume>59</volume>(<issue>6</issue>):<fpage>1551</fpage>–<lpage>1580</lpage>. <pub-id pub-id-type="doi">10.2307/2938278</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0221238.ref037">
      <label>37</label>
      <mixed-citation publication-type="journal"><name><surname>McLeod</surname><given-names>AI</given-names></name>, <name><surname>K</surname><given-names>LW</given-names></name>. <article-title>Diagnostic checking ARMA time series models using squared residual autocorrelations</article-title>. <source>Journal of Time Series Analysis</source>. <year>1983</year>;<volume>4</volume>:<fpage>269</fpage>–<lpage>273</lpage>. <pub-id pub-id-type="doi">10.1111/j.1467-9892.1983.tb00373.x</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0221238.ref038">
      <label>38</label>
      <mixed-citation publication-type="journal"><name><surname>Peña</surname><given-names>D</given-names></name>, <name><surname>Rodriguez</surname><given-names>J</given-names></name>. <article-title>Detecting nonlinearity in time series by model selection criteria</article-title>. <source>International Journal of Forecasting</source>. <year>2005</year>;<volume>21</volume>(<issue>4</issue>):<fpage>731</fpage>–<lpage>748</lpage>. <pub-id pub-id-type="doi">10.1016/j.ijforecast.2005.04.014</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0221238.ref039">
      <label>39</label>
      <mixed-citation publication-type="journal"><name><surname>Tsay</surname><given-names>RS</given-names></name>. <article-title>Nonlinearity tests for time series</article-title>. <source>Biometrika</source>. <year>1986</year>;<volume>73</volume>(<issue>2</issue>):<fpage>461</fpage>–<lpage>466</lpage>. <pub-id pub-id-type="doi">10.1093/biomet/73.2.461</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0221238.ref040">
      <label>40</label>
      <mixed-citation publication-type="journal"><name><surname>Young</surname><given-names>PC</given-names></name>, <name><surname>Pedregal</surname><given-names>DJ</given-names></name>, <name><surname>Tych</surname><given-names>W</given-names></name>. <article-title>Dynamic Harmonic Regression</article-title>. <source>Journal of Forecasting</source>. <year>1999</year>;<volume>18</volume>(<issue>6</issue>):<fpage>369</fpage>–<lpage>394</lpage>. <pub-id pub-id-type="doi">10.1002/(SICI)1099-131X(199911)18:6&lt;369::AID-FOR748&gt;3.0.CO;2-K</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0221238.ref041">
      <label>41</label>
      <mixed-citation publication-type="journal"><name><surname>Diebold</surname><given-names>FX</given-names></name>, <name><surname>Mariano</surname><given-names>RS</given-names></name>. <article-title>Comparing Predictive Accuracy</article-title>. <source>Journal of Business &amp; Economic Statistics</source>. <year>1995</year>;<volume>13</volume>(<issue>3</issue>):<fpage>253</fpage>–<lpage>263</lpage>. <pub-id pub-id-type="doi">10.1080/07350015.1995.10524599</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0221238.ref042">
      <label>42</label>
      <mixed-citation publication-type="journal"><name><surname>Wilcoxon</surname><given-names>F</given-names></name>. <article-title>Individual Comparisons by Ranking Methods</article-title>. <source>Biometrics Bulletin</source>. <year>1945</year>;<volume>1</volume>(<issue>6</issue>):<fpage>80</fpage>–<lpage>83</lpage>. <pub-id pub-id-type="doi">10.2307/3001968</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0221238.ref043">
      <label>43</label>
      <mixed-citation publication-type="journal"><name><surname>Makridakis</surname><given-names>S</given-names></name>, <name><surname>Hibon</surname><given-names>M</given-names></name>. <article-title>The M3-competition: results, conclusions and implications</article-title>. <source>International Journal of Forecasting</source>. <year>2000</year>;<volume>16</volume>(<issue>4</issue>):<fpage>451</fpage>–<lpage>476</lpage>. <pub-id pub-id-type="doi">10.1016/S0169-2070(00)00057-1</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0221238.ref044">
      <label>44</label>
      <mixed-citation publication-type="journal"><name><surname>Hyndman</surname><given-names>RJ</given-names></name>, <name><surname>Koehler</surname><given-names>AB</given-names></name>. <article-title>Another look at measures of forecast accuracy</article-title>. <source>International Journal of Forecasting</source>. <year>2006</year>;<volume>22</volume>(<issue>4</issue>):<fpage>679</fpage>–<lpage>688</lpage>. <pub-id pub-id-type="doi">10.1016/j.ijforecast.2006.03.001</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
