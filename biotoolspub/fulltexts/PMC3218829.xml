<?DTDIdentifier.IdentifierValue article.dtd?>
<?DTDIdentifier.IdentifierType system?>
<?SourceDTD.DTDName article.dtd?>
<?SourceDTD.Version 1.0?>
<?ConverterInfo.XSLTName bmc2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Genome Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">Genome Biol</journal-id>
    <journal-title-group>
      <journal-title>Genome Biology</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1465-6906</issn>
    <issn pub-type="epub">1465-6914</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">3218829</article-id>
    <article-id pub-id-type="publisher-id">gb-2011-12-7-r67</article-id>
    <article-id pub-id-type="pmid">21787385</article-id>
    <article-id pub-id-type="doi">10.1186/gb-2011-12-7-r67</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Method</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>ZINBA integrates local covariates with DNA-seq data to identify broad and narrow regions of enrichment, even within amplified genomic regions</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" equal-contrib="yes" id="A1">
        <name>
          <surname>Rashid</surname>
          <given-names>Naim U</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <email>naim@unc.edu</email>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes" id="A2">
        <name>
          <surname>Giresi</surname>
          <given-names>Paul G</given-names>
        </name>
        <xref ref-type="aff" rid="I2">2</xref>
        <email>paulg@email.unc.edu</email>
      </contrib>
      <contrib contrib-type="author" id="A3">
        <name>
          <surname>Ibrahim</surname>
          <given-names>Joseph G</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <email>ibrahim@bios.unc.edu</email>
      </contrib>
      <contrib contrib-type="author" corresp="yes" id="A4">
        <name>
          <surname>Sun</surname>
          <given-names>Wei</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <xref ref-type="aff" rid="I3">3</xref>
        <email>wsun@bios.unc.edu</email>
      </contrib>
      <contrib contrib-type="author" corresp="yes" id="A5">
        <name>
          <surname>Lieb</surname>
          <given-names>Jason D</given-names>
        </name>
        <xref ref-type="aff" rid="I2">2</xref>
        <email>jlieb@bio.unc.edu</email>
      </contrib>
    </contrib-group>
    <aff id="I1"><label>1</label>Department of Biostatistics, Gillings School of Global Public Health, The University of North Carolina at Chapel Hill, Chapel Hill, NC 27599, USA</aff>
    <aff id="I2"><label>2</label>Department of Biology, Carolina Center for Genome Sciences, and Lineberger Comprehensive Cancer Center, The University of North Carolina at Chapel Hill, Chapel Hill, NC 27599, USA</aff>
    <aff id="I3"><label>3</label>Department of Genetics and School of Medicine, University of North Carolina at Chapel Hill, Chapel Hill, NC 27599, USA</aff>
    <pub-date pub-type="ppub">
      <year>2011</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>25</day>
      <month>7</month>
      <year>2011</year>
    </pub-date>
    <volume>12</volume>
    <issue>7</issue>
    <fpage>R67</fpage>
    <lpage>R67</lpage>
    <history>
      <date date-type="received">
        <day>26</day>
        <month>4</month>
        <year>2011</year>
      </date>
      <date date-type="rev-recd">
        <day>11</day>
        <month>7</month>
        <year>2011</year>
      </date>
      <date date-type="accepted">
        <day>25</day>
        <month>7</month>
        <year>2011</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Copyright Â©2011 Rashid et al.; licensee BioMed Central Ltd.</copyright-statement>
      <copyright-year>2011</copyright-year>
      <copyright-holder>Rashid et al.; licensee BioMed Central Ltd.</copyright-holder>
      <license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/2.0">
        <license-p>This is an open access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/2.0">http://creativecommons.org/licenses/by/2.0</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="http://genomebiology.com/2011/12/7/R67"/>
    <abstract>
      <p>ZINBA (Zero-Inflated Negative Binomial Algorithm) identifies genomic regions enriched in a variety of ChIP-seq and related next-generation sequencing experiments (DNA-seq), calling both broad and narrow modes of enrichment across a range of signal-to-noise ratios. ZINBA models and accounts for factors that co-vary with background or experimental signal, such as G/C content, and identifies enrichment in genomes with complex local copy number variations. ZINBA provides a single unified framework for analyzing DNA-seq experiments in challenging genomic contexts.</p>
      <p>Software website: <ext-link ext-link-type="uri" xlink:href="http://code.google.com/p/zinba/">http://code.google.com/p/zinba/</ext-link></p>
    </abstract>
  </article-meta>
</front>
<body>
  <sec>
    <title>Background</title>
    <p>Next generation sequencing (NGS) technologies are now routinely utilized for genome-wide detection of DNA fragments isolated by a diverse set of assays interrogating genomic processes [<xref ref-type="bibr" rid="B1">1</xref>]. We refer to these collectively as DNA-seq experiments, which include chromatin immunoprecipitation (ChIP-seq), DNase hypersensitive site mapping (DNase-seq) [<xref ref-type="bibr" rid="B2">2</xref>], and formaldehyde-assisted isolation of regulatory elements (FAIRE-seq) [<xref ref-type="bibr" rid="B3">3</xref>], among others. Several algorithms are currently available for the identification of genomic regions enriched by a given experiment. Although each is well suited for the analysis of a particular intended data type, the underlying assumptions are not always suitable for the multitude of possible enrichment patterns found in DNA-seq datasets [<xref ref-type="bibr" rid="B4">4</xref>]. An algorithm capable of robust detection of enrichment across a multitude of enrichment patterns, with performance comparable to the existing set of algorithms specific to each data type, would have high utility.</p>
    <p>For example, regions of ChIP-seq enrichment for transcription factors [<xref ref-type="bibr" rid="B5">5</xref>-<xref ref-type="bibr" rid="B16">16</xref>] typically comprise a small proportion of the genome (&lt; 1%), are short (&lt; 500 bp), and have relatively high signal-to-noise ratios. Histone modification data [<xref ref-type="bibr" rid="B2">2</xref>,<xref ref-type="bibr" rid="B6">6</xref>] can vary widely in terms of length of enriched regions (Figure <xref ref-type="fig" rid="F1">1a</xref>), the proportion of the genome enriched [<xref ref-type="bibr" rid="B4">4</xref>], and the signal-to-noise ratio. To assess the statistical significance of an identified enriched region, assumptions regarding the distribution of signal in background and enriched regions must be made. The majority of algorithms perform optimally for the identification of transcription factor binding sites (TFBSs) from ChIP-seq data [<xref ref-type="bibr" rid="B17">17</xref>]. However, as the proportion of the genome that is enriched increases and/or the signal-to-noise ratio decreases compared with TFBS data [<xref ref-type="bibr" rid="B2">2</xref>,<xref ref-type="bibr" rid="B6">6</xref>,<xref ref-type="bibr" rid="B18">18</xref>-<xref ref-type="bibr" rid="B20">20</xref>] the performance of many existing tools declines [<xref ref-type="bibr" rid="B17">17</xref>,<xref ref-type="bibr" rid="B19">19</xref>,<xref ref-type="bibr" rid="B21">21</xref>-<xref ref-type="bibr" rid="B23">23</xref>]. Researchers interested in the analysis of several types of data for a given experiment must often combine results from different algorithms. In addition, NGS data often contain biases due to several factors, including G/C content [<xref ref-type="bibr" rid="B24">24</xref>-<xref ref-type="bibr" rid="B26">26</xref>] and mappability [<xref ref-type="bibr" rid="B6">6</xref>]. Data from a matched input control sample may control for the effects of such confounding factors [<xref ref-type="bibr" rid="B27">27</xref>], but input data are often not available, and it is unclear whether input alone is sufficient to model background signals in DNA-seq data.</p>
    <fig id="F1" position="float">
      <label>Figure 1</label>
      <caption>
        <p><bold>ZINBA provides a unified framework for the detection of enriched sites across a wide variety of DNA-seq datasets</bold>. <bold>(a) </bold>A 100-kb region of chromosome 2 at the <italic>ATF2 </italic>gene locus illustrating the diversity of enrichment patterns in DNA-seq data, which includes histone H3 lysine 36 tri-methylation (H3K36me3), CCCTC-binding factor (CTCF) and RNA polymerase II (RNA Pol II) ChIP-seq along with the FAIRE-seq and DNase-seq assays. Data for each of the DNA-seq experiments are displayed as the number of overlapping extended reads at each base pair, which was produced by the indicated groups and is available from the UCSC genome browser. <bold>(b) </bold>ZINBA comprises three steps that can each operate as an independent module. In step 1, the set of aligned reads from the experiment along with a set of covariate measures are collated for each contiguous non-overlapping window spanning the genome. In step 2, the component-specific model formulations of covariates are employed by the mixture regression framework to compute the posterior probability of each window belonging to either the zero-inflated, background or enriched components. The component-specific model formulations of covariates can be generated using an automated model selection procedure or specified by the user. In step 3, the windows exceeding the user-specified probability threshold (default 0.95) are merged to form broad regions of enrichment and a shape detection algorithm is employed on the read overlap representation of the data to refine the boundary estimates of distinct punctate peaks. BED, browser extensible data; BIC, Bayesian information criterion.</p>
      </caption>
      <graphic xlink:href="gb-2011-12-7-r67-1"/>
    </fig>
    <p>To address these issues, we introduce a flexible statistical framework called ZINBA (Zero-Inflated Negative Binomial Algorithm) that identifies genomic regions enriched for sequenced reads across a wide spectrum of signal patterns and experimental conditions. ZINBA implements a mixture regression approach, which probabilistically classifies genomic regions into three general components: background, enrichment, and an artificial zero count. The regression framework allows each of the components to be modeled separately using a set of covariates, which leads to better characterization of each component and subsequent classification outcomes. In addition, the mixture-modeling approach affords ZINBA the flexibility to determine the set of genomic regions comprising background without relying on any prior assumptions of the proportion of the genome that is enriched. Following classification, neighboring regions classified as enriched are merged and boundaries of punctate signal within enriched regions are determined, allowing the isolation of both broad and narrow elements.</p>
    <p>We applied ZINBA to FAIRE-seq and ChIP-seq of CCCTC-binding factor (CTCF), RNA polymerase II (RNA Pol II), and histone H3 lysine 36 tri-methylation (H3K36me3) (Figure <xref ref-type="fig" rid="F1">1a</xref>). These datasets represent a diversity of signal patterns ranging from narrow peaks with high signal-to-noise ratios (CTCF) to broad enrichment regions with low signal-to-noise ratios (H3K36me3). In addition to identifying biologically relevant signals in each of these datasets, ZINBA is capable of estimating the contribution of component-specific covariates to signal in each component. Incorporation of covariates into the model improved peak detection in difficult modeling situations, such as in amplified genomic regions. In the absence of input control, we show that other covariates allow for comparable performance as when input control is utilized. Lastly, we demonstrate that ZINBA's ability to isolate broad and narrow enrichment regions reveals functional differences in RNA Pol II elongation status. We conclude that ZINBA provides a general and flexible framework for the analysis of a diverse set of DNA-seq datasets.</p>
  </sec>
  <sec>
    <title>Results</title>
    <sec>
      <title>ZINBA overview</title>
      <p>ZINBA performs three steps: data preprocessing, determination of significantly enriched regions, and an optional boundary refinement for more narrow sites (Figure <xref ref-type="fig" rid="F1">1b</xref>). The first step involves tabulating the number of reads falling into contiguous non-overlapping windows (default 250 bp) tiled across each chromosome and scoring corresponding covariate information. Covariates can consist of any quantity that may co-vary with signal in a given region, including, for example, G/C content, a smoothed average of local background, read counts for an input control sample, or the proportion of mappable [<xref ref-type="bibr" rid="B28">28</xref>] bases, which we define as the mappability score (Materials and methods). Optionally, additional sets of contiguous windows with offset starting positions can be tabulated for increased resolution. Each set of offset windows is analyzed independently in the next step.</p>
      <p>In the second step, a novel mixture regression model is used to probabilistically classify each window into one of three components: background, enrichment, or zero-inflated. In this context, and throughout the manuscript, the term 'enrichment' will refer to genomic DNA sequences that were captured specifically as the result of the biological experiment under consideration. The term 'background' includes genomic DNA sequences that appear due to experimental noise, noise that arises in the sequencing process, or noise that arises in the computational processing of the data. The term 'zero-inflated' refers to those genomic locations at which we might expect coverage by a sequencing read derived from either the background or enrichment signal components, but that are not represented in the real data. Zero-inflation typically occurs due to a lack of sequencing depth and is common in many NGS datasets. Regions containing higher proportions of non-mappable bases are also more likely to be zero-inflated, as it is more difficult to assign reads to these regions during the mapping process.</p>
      <p>ZINBA utilizes an iterative approach [<xref ref-type="bibr" rid="B29">29</xref>] to determine for each window the relative likelihood of belonging to each component, in addition to estimating the relationship between average signal in each component and a set of covariates (Materials and methods). Each iteration consists of two steps. In the first step, a set of posterior probabilities of component membership is computed for each window, based on how well each window fits with the average signal level in each component, adjusted for covariate effects. In the next step, the average signal level in each component is modeled separately with its own formulation of covariates using weighted generalized linear models (GLMs). The posterior probabilities of component membership are used as regression weights and serve to partition the genome into likely background, enrichment, and zero-inflated regions to determine component signal. The model iterates between these two steps until the classification and component-specific covariate estimates cease to change.</p>
      <p>Adjusting for covariate effects is often beneficial or necessary for dissecting enrichment regions and background. For example, although signal in background regions is typically lower than in regions of enrichment, background regions in copy-number amplified regions may have higher signal than enrichment regions that occur in locations with a normal DNA copy number. Thus, adjusting for copy number changes is necessary for correct separation of background and enrichment regions. The set of covariates used to model each component can be selected based on either prior knowledge or an information criterion, such as the Bayesian information criterion (BIC). Covariates with no or weak relationships with mean signal in a component will have little effect on classification, but do contribute to model complexity. The BIC criterion helps to remove such covariates to balance model fit and model size.</p>
      <p>In the third step, all overlapping or adjacent windows classified as enriched are merged. For the detection of broader elements, especially helpful for histone modifications demarcating broad genomic regions (such as H3K36me3), an additional 'broad' setting is available that merges enriched windows within a fixed distance. An optional shape-detection algorithm may then be applied to identify sharp enrichment signals within broader enriched regions.</p>
    </sec>
    <sec>
      <title>Modeling signal components with relevant covariates improves enrichment detection</title>
      <p>To evaluate the utility of incorporating covariate information for the detection of enriched regions, we constructed simulated datasets, and used G/C content as one example of such a covariate. Simulated datasets were constructed to artificially control the relationship between G/C content and the enrichment, background, and zero-inflated components. Window count data were simulated to represent three types of common NGS signal patterns, ranging from TFBSs (high signal-to-noise ratio, 1% of genome belongs to enrichment component), FAIRE (moderate signal-to-noise ratio, 5% of genome belongs to enrichment component), to some histone modifications (low signal-to-noise ratio, 10% of genome belongs to enrichment component). For each data type, three sets of data were simulated, hence nine datasets in total. In each data set, G/C content always had a positive relationship with signal in the background component and a positive relationship with the probability of being zero-inflated. However, G/C content was simulated to have either a positive, neutral or negative relationship with enrichment. For each of the nine datasets, 100,000 windows were simulated. These consisted of 250-bp windows from human chromosome 22 (Materials and methods). G/C content was simulated from these windows as well.</p>
      <p>Now, for each of the nine simulated datasets, three different uses of the covariate were employed to model the simulated data: (a) model 1, no covariates; (b) model 2, G/C content is incorporated in modeling the zero-inflated and background components only; (c) model 3, G/C content is incorporated in modeling all three components.</p>
      <p>Our results show that models that properly accounted for the underlying simulated relationships with G/C content in each component resulted in the best classification outcomes. For example, when enrichment had an inverse relationship with G/C content (Figure <xref ref-type="fig" rid="F2">2a, b</xref>), model 3 consistently led to higher sensitivity and specificity relative to models 1 and 2 (Figure <xref ref-type="fig" rid="F2">2c, d</xref>). Simulated component-specific relationships between G/C content and signal were also correctly captured in model 3 (Figure <xref ref-type="fig" rid="F2">2e, f</xref>), with average enrichment signal decreasing and average background signal increasing with respect to G/C content. Ignoring the role of G/C content completely (model 1) resulted in classification based purely on signal, which misses informative trends in the data (Figure S1 in Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>). We find similar results for the simulated condition of positive and neutral relationships between G/C content and enrichment (Figures S2 and S3 in Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>). Thus, including relevant covariates to model each component provides a more informed assessment of enrichment versus background.</p>
      <fig id="F2" position="float">
        <label>Figure 2</label>
        <caption>
          <p><bold>Accounting for relevant component-specific covariates results in the optimal classification of background and enriched components for a simulated data set</bold>. <bold>(a, b) </bold>Density plots showing the distribution of background (blue shading) and enriched (black circles) simulated counts (y-axis) versus G/C content (x-axis). Window counts were simulated with either (a) a low proportion of high signal-to-noise sites or (b) a high proportion of low signal-to-noise sites. In this example G/C content had a positive and negative relationship with the background and enriched components, respectively. <bold>(c, d) </bold>Receiver operating characteristic (ROC) curves for the performance of three different component-specific covariate model formulations, including no covariates (model 1, red dashed line), G/C content modeling the background and zero-inflated components (model 2, green dashed line) and G/C content modeling the background, zero-inflated and enriched components (model 3, black solid line). Classification results for the simulated (c) low proportion of high signal-to-noise sites and (d) high proportion of low signal-to-noise sites. Utilization of relevant covariates in each component resulted in better classification outcomes (model 3). This impact is greater in lower signal-to-noise data (d), where it is more difficult to distinguish enrichment from background. <bold>(e, f) </bold>Scatter plot of G/C content (x-axis) versus simulated window counts (y-axis) using model 3 to estimate the posterior probability of a window being enriched, which is depicted as a color gradient. Lighter colors correspond to higher posterior probability and a greater likelihood of being enriched. Posterior probabilities for the simulated (e) low proportion of high signal-to-noise sites and (f) high proportion of low signal-to-noise sites are shown along with model estimates for the background (solid black line) and enriched components (dashed black line).</p>
        </caption>
        <graphic xlink:href="gb-2011-12-7-r67-2"/>
      </fig>
      <p>These results also serve to illuminate how ZINBA distinguishes the separate roles of component-specific covariates. For example, covariates that are relevant to the background component explain variability in background signal that may otherwise be confused for enrichment. This benefit of ZINBA is more apparent when the signal-to-noise ratio is low (Figure <xref ref-type="fig" rid="F2">2b, d, f</xref>) because, in that case, many background and enrichment windows contain similar numbers of reads, and the two states are difficult to distinguish by signal alone. In the situation where we simulated a neutral relationship of G/C content with enrichment, model 3 had similar performance to model 2, suggesting that the use of G/C content to model the enrichment component did not degrade classification performance. Rather, the estimated effect of G/C content in the enrichment component was close to zero, and thus had little effect on classification (Figure S2 in Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>) at the cost of greater model complexity.</p>
      <p>While we chose to simulate our data in this section with respect to only one covariate, the regression basis for the mixture model allows the inclusion of multiple covariates simultaneously, as is inherent in any regression-based framework. Regardless of whether the data consist of rare, high signal-to-noise enrichment or common, low signal-to-noise enrichment, the model performs better when each component is modeled with relevant sets of covariates. However, the performance gain when using relevant covariates is greatest in lower signal-to-noise data.</p>
    </sec>
    <sec>
      <title>Automated model selection</title>
      <p>Relevant covariates are not always known <italic>a priori</italic>. To discover the appropriate formulation of covariates for each component, ZINBA employs the BIC [<xref ref-type="bibr" rid="B30">30</xref>] to select the best model among all possible models, given a set of starting covariates (Materials and methods). BIC balances model fit and model complexity and has long been employed as a statistical assessment of model performance. The regression framework inherent in ZINBA also allows for the modeling of interactions between covariates. Therefore, all pair-wise and three-way interactions between the starting covariates for each component are considered in the model selection procedure. The automated model selection procedure was able to select the most appropriate model for all nine simulated conditions from the previous section.</p>
    </sec>
    <sec>
      <title>ZINBA detects relationships between covariates and component signal that vary by experiment</title>
      <p>Evaluation of the relationships between the set of component-specific covariates selected using the automated model selection procedure and the datasets shown in Figure <xref ref-type="fig" rid="F1">1a</xref>[<xref ref-type="bibr" rid="B31">31</xref>,<xref ref-type="bibr" rid="B32">32</xref>] revealed that our mappability score and input control were positively related with mean background signal in each ChIP-seq dataset, which is consistent with previous reports [<xref ref-type="bibr" rid="B5">5</xref>,<xref ref-type="bibr" rid="B28">28</xref>]. Each dataset exhibits distinctly different degrees of signal-to-noise ratio, length of enriched regions, and total proportion of the genome enriched. These differences can be attributed to both functional differences related to biological activity and technical aspects of the different assays. However, the relationship between G/C content and background signal was not consistent between different DNA-seq experiments (Table S1 in Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>), nor were they consistent between components of the same dataset.</p>
      <p>For the RNA Pol II and CTCF data, model estimates reveal that G/C content had a positive relationship in background regions, similar to previous reports on G/C content bias [<xref ref-type="bibr" rid="B24">24</xref>-<xref ref-type="bibr" rid="B26">26</xref>] (Figure <xref ref-type="fig" rid="F3">3a</xref>). However, in FAIRE-seq data, G/C content was negatively associated with the background component (Figure <xref ref-type="fig" rid="F3">3b</xref>). These differences can easily be observed from scatter plots of the raw read counts from windows classified as background versus the corresponding G/C content for the RNA Pol II ChIP-seq and FAIRE-seq datasets (Figure <xref ref-type="fig" rid="F3">3c, d</xref>). The exact cause of the differences in the relationship between G/C content and background signal between datasets, and whether it could be technical or biological, is not known.</p>
      <fig id="F3" position="float">
        <label>Figure 3</label>
        <caption>
          <p><bold>Estimates of covariate effects differ among DNA-seq data types</bold>. <bold>(a, b) </bold>Estimates for the set of BIC selected covariates for the background components of the (a) RNA Pol II ChIP-seq and (b) FAIRE-seq data from chromosome 22 in K562 cells. The set of covariates was standardized to a mean of 0 and variance of 1, which included G/C content ('GC'), mappability score ('Map'), the local background estimate ('BG'), and input control ('Input'). The G/C content covariate (yellow bars) had an opposing effect on the background component for the RNA Pol II (positive) (a) and FAIRE (negative) (b) data. <bold>(c, d) </bold>Density plots of G/C content (x-axis) versus the natural log of window read count (y-axis) in non-enriched windows (enrichment posterior probability &lt; 0.50) from the (c) RNA Pol II and (d) FAIRE data. Median regression lines fit to the set of background windows from each dataset parallel the ZINBA-estimated relationships between G/C content and signal in background regions.</p>
        </caption>
        <graphic xlink:href="gb-2011-12-7-r67-3"/>
      </fig>
      <p>The relationship for each covariate also differed in magnitude and direction across components of the same dataset. For example, in FAIRE-seq data, while there was a negative relationship with G/C content in background regions, there was a positive relationship in enriched regions (Table S1 in Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>). A similar difference between the relationship of G/C content in the background and enrichment regions was found for the RNA Pol II ChIP-seq data. Thus, the relationships of covariates with background signal may not be consistent across different data types, and may differ in their relationships to signal in background and enrichment regions of the same data type.</p>
      <p>An input control may be used to account for the relationships of G/C content and mappability with background signal. However, the model estimates suggest that input data alone may not explain all of the variability in DNA-seq background. Examination of the relationships of covariates with input signal and DNA-seq background reveals differences in the effects of covariates within each (Figure S4 in Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>). In the case of RNA Pol II (Figure S4a, b in Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>) and CTCF (Figure S4c, d in Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>), where the estimated relationship of G/C content with background DNA-seq signal is positive, in the matching input control sample the relationship with G/C content is relatively neutral. The reason for these differences is currently unknown, but may be related to sample handling differences between the ChIP and input samples.</p>
    </sec>
    <sec>
      <title>Incorporation of a covariate for copy number allows peak calling within amplified genomic regions</title>
      <p>One challenge for the analysis of DNA-seq data is fluctuations in background signal resulting from copy number variations (CNVs). If not properly accounted for, such changes in background can result in significant false positives. This is especially true if there are no input control samples for comparison, or if the input control samples are insufficiently sequenced. To account for this, we constructed a new covariate to measure local background, and included this covariate in our mixture regression framework to account for local copy number changes. Changes in background signal levels due to CNVs were estimated locally using the DNA-seq sample itself, supplemented by a change-point detection method to determine boundaries of likely CNVs (Materials and methods). Application of this approach provided an accurate estimation of signal changes due to local CNVs in a FAIRE-seq MCF-7 dataset, which is aneuploid and has extensive CNVs [<xref ref-type="bibr" rid="B33">33</xref>] (Figure <xref ref-type="fig" rid="F4">4a</xref>).</p>
      <fig id="F4" position="float">
        <label>Figure 4</label>
        <caption>
          <p><bold>Covariate-mediated adjustment of classification aids in the discrimination of background and enriched regions</bold>. <bold>(a) </bold>The local background (BG) estimate (red line) approximates a CNV detected by FAIRE-seq (black line) within a 2-Mbp region of chromosome 20 in MCF-7 cells. <bold>(b) </bold>Density plot of the window read counts for FAIRE-seq data in MCF-7 (chromosome 20) versus the posterior probability of a given window being classified as enriched, which included the local background estimate as a covariate in the ZINBA model formulation. The red box highlights a set of windows with high read counts (CNV background) being assigned a low posterior probability of being enriched. <bold>(c) </bold>The read overlap representation of MCF-7 FAIRE-seq data for all of chromosome 20 (top row) is displayed in the UCSC Genome Browser. The bottom panels zoom in on the black box outlining a CNV (same as panel (a)). Here a set of peak calls by F-Seq, MACS and ZINBA are shown as black boxes along with the FAIRE-seq data displayed using either an extended (top) or standard y-axis.</p>
        </caption>
        <graphic xlink:href="gb-2011-12-7-r67-4"/>
      </fig>
      <p>Using a BIC-selected model considering the local background estimate, G/C content, and mappability score as starting covariates, we found ZINBA was able to correctly classify background regions within CNVs (Figure <xref ref-type="fig" rid="F4">4b</xref>) and called 8 and 11 times fewer peaks (1,258) using a FAIRE-seq dataset in MCF-7 CNV regions in chromosome 20 [<xref ref-type="bibr" rid="B34">34</xref>] relative to MACS [<xref ref-type="bibr" rid="B5">5</xref>] and F-seq [<xref ref-type="bibr" rid="B35">35</xref>] (Figure <xref ref-type="fig" rid="F4">4c</xref>). Incorporation of this covariate also leads to the better recovery of relevant peak regions within ENCODE [<xref ref-type="bibr" rid="B36">36</xref>] datasets, as we demonstrate in later sections.</p>
      <p>Estimation of local background from the experimental data is only effective when local background is sampled from a sufficiently large window size, where these large windows (default 100 kb) will not be dominated by enriched signal. This is the case with the majority of data types, as most contain enriched features that span no more than several kilobases. In any case, the flexibility of ZINBA allows for CNV estimates from any source to be included into the model selection procedure and determination of enrichment. ZINBA also includes a 'CNV mode', which can be run on input DNA for a quick estimation of the extent of amplified genomic regions in a given sample. This mode utilizes 10-kb windows in the ZINBA mixture model without any covariates, aiming to detect extended region enrichment of input reads.</p>
    </sec>
    <sec>
      <title>Evaluation of ZINBA over a wide range of signal patterns and amplitudes</title>
      <p>We selected a variety of DNA-seq datasets, including FAIRE-seq, CTCF, RNA Pol II, and H3K36me3 ChIP-seq, to compare the performance of ZINBA with other existing methods across a range of signal-to-noise ratios, patterns of enrichment, and proportion of total genomic enrichment. For example, CTCF ChIP-seq data exhibit punctate, high signal-to-noise ratio peaks, FAIRE-seq data have broader, low signal-to-noise ratio peaks, and RNA Pol II ChIP-seq data contain a mixture of punctate high signal-to-noise and diffuse low signal-to-noise peaks. H3K36me3 enrichment encompasses very broad domains of many kilobases, extending over large portions of transcribed regions. For each dataset, we applied the automated model selection tool to determine the set of component-specific covariates to model each dataset (Materials and methods).</p>
      <p>ZINBA was compared with MACS [<xref ref-type="bibr" rid="B5">5</xref>] and F-Seq [<xref ref-type="bibr" rid="B2">2</xref>], which represent two classes of peak calling algorithms that also do not require an input control sample to call regions of enrichment. MACS [<xref ref-type="bibr" rid="B5">5</xref>] represents a class of algorithms that uses a sliding window approach for the detection of enriched regions compared to a matching input control sample or local background estimate. F-Seq [<xref ref-type="bibr" rid="B17">17</xref>] represents a class of algorithms that use kernel density estimation to estimate local read density and identifies enriched regions as those with a kernel density estimation larger than a user-defined threshold, which is estimated using simulations assuming random assortment of sample reads.</p>
      <p>For each algorithm, the top N set of ranked peaks (500, 1,000, 2,000, and so on) were selected. The performance of each was evaluated by calculating the average peak length, the proportion of peaks overlapping a set of biologically significant features (within 150 bp) and the average distance to these features. For ZINBA, the set of unrefined peak calls (merged enriched windows) and refined peak calls (boundaries of punctate peaks within merged regions) were evaluated separately to determine their relative utility in each dataset. For the H3K36me3 data, we utilized the ZINBA 'broad' setting (Materials and methods) to capture regions of enrichment that may extend for many kilobases.</p>
      <sec>
        <title>All algorithms perform comparably for the analysis of punctate high signal-to-noise datasets</title>
        <p>For the CTCF ChIP-seq data set, the set of ranked peaks for each algorithm was compared to the occurrence of the CTCF motif (JASPAR motif MA0139.1). The genome-wide set of motifs was identified using FIMO, part of the MEME suite [<xref ref-type="bibr" rid="B37">37</xref>], with default parameters. All of the algorithms were able to identify a high proportion of sites containing the CTCF motif (Figure <xref ref-type="fig" rid="F5">5a</xref>) and had comparable peak lengths (Figure <xref ref-type="fig" rid="F5">5c</xref>). Positioning of peaks called by ZINBA was slightly closer to the CTCF motifs (Figure <xref ref-type="fig" rid="F5">5b</xref>). These results are consistent with other comparisons of ChIP-seq peak calling algorithms [<xref ref-type="bibr" rid="B17">17</xref>], which revealed few differences in sensitivity and specificity when applied to high signal-to-noise ChIP-seq data. Of the 50,228 refined peaks called by ZINBA, 95.2% were in common with MACS (60,135 peaks) and 99.9% were in common with F-seq (276,879 peaks).</p>
        <fig id="F5" position="float">
          <label>Figure 5</label>
          <caption>
            <p><bold>Robust detection of biologically relevant features across a variety of DNA-seq data types by ZINBA</bold>. <bold>(a-i) </bold>For CTCF ChIP-seq (a-c), RNA Pol II ChIP-seq (d-f) and FAIRE-seq (g-i) data, the top N ranked peaks from MACS (red dashed line), F-Seq (green dashed line) and ZINBA unrefined regions (light blue dashed line), and ZINBA refined regions (blue solid line) were compared based on the proportion overlapping a biologically relevant set of features (a, d, g), average distance to the biologically relevant set of features (b, e, h) and average length of peaks (c, f, i). The biologically relevant set of features included the CTCF motif (a), transcription start sites (TSSs) for RNA Pol II (d) and DNase hypersensitive sites (DHSs) for FAIRE (g).</p>
          </caption>
          <graphic xlink:href="gb-2011-12-7-r67-5"/>
        </fig>
      </sec>
      <sec>
        <title>The set of broad and punctate peaks identified by ZINBA for RNA Pol II ChIP-seq data reflects the elongation status of the polymerase</title>
        <p>One unique feature of RNA Pol II ChIP-seq data is that enrichment consists of both punctate high signal-to-noise ratio peaks at transcription start sites (TSSs) and broader, low signal-to-noise peaks into the body of genes [<xref ref-type="bibr" rid="B4">4</xref>]. All of the algorithms were able to capture a large proportion of annotated TSSs (Figure <xref ref-type="fig" rid="F5">5d, e</xref>; Figure S5a in Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>). However, the set of refined peaks called by the shape detection algorithm within ZINBA resulted in a set of narrower peaks much more closely associated with the TSSs of genes (Figure <xref ref-type="fig" rid="F5">5e, f</xref>) compared with MACS, F-Seq, and unrefined ZINBA peak calls. A relatively high degree of overlap can be seen between each of the peak sets, although the overlap is not as strong compared to those observed for the CTCF dataset (Figure S5b in Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>).</p>
        <p>The ability to produce both a refined (punctate) and unrefined (broad) set of peak calls using ZINBA provides an opportunity to infer elongating versus stalled RNA Pol II. For the case of stalled RNA Pol II, one would expect a punctate peak at the TSS, but no broad peak within the body of the gene [<xref ref-type="bibr" rid="B38">38</xref>]. Under this expectation, we computed a 'stalling score' (Materials and methods), where smaller values correspond to a broad high-amplitude signal across the gene, and larger values to a punctate signal near the 5' end of the gene and lower-amplitude signal along the gene body. Previous computations of RNA Pol II stalling scores utilized a height ratio between the punctate peak at the TSS and the median height of the broader region [<xref ref-type="bibr" rid="B39">39</xref>] (Figure S6a in Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>). Using ZINBA, our stalling score further incorporates the lengths of the broad and punctate enriched regions found in the experimental sample. The stalling index had a strong negative relationship (<italic>P</italic>-value &lt; 10<sup>-10</sup>) to the expression of the nearby gene (Figure S6b in Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>) and explained more of the variance in measured gene expression (R<sup>2 </sup>= 3.5%) than a score utilizing only the ratio of punctate to broad signal height (R<sup>2 </sup>= 0.04%). The ability to calculate this metric reflects one potential use of the peak boundary refinement module within the ZINBA framework.</p>
      </sec>
      <sec>
        <title>ZINBA accurately identifies regions of enrichment in low signal-to-noise datasets without the use of input for background estimation</title>
        <p>FAIRE-seq [<xref ref-type="bibr" rid="B3">3</xref>,<xref ref-type="bibr" rid="B40">40</xref>] differs from ChIP-seq in that it is an antibody-free method that recovers DNA fragments that are relatively resistant to formaldehyde crosslinking to proteins. The crosslinking profile of chromatin is likely dominated by histone-DNA interactions, and therefore the sites preferentially recovered by FAIRE correspond to sites of nucleosome depletion. On average the size of each FAIRE site corresponds to the loss of approximately one nucleosome (200 to 300 bp). Compared to the binding events identified for TFBSs by ChIP-seq, the FAIRE-seq sites tend to have much lower signal-to-noise, have a slightly broader pattern of enrichment, and encompass a larger proportion (1 to 2%) of the genome. In addition, input control is often not available. Therefore, many of the assumptions utilized by existing algorithms, especially for the analysis of TFBS ChIP-seq, are not well-suited to the analysis of this data type [<xref ref-type="bibr" rid="B22">22</xref>].</p>
        <p>We analyzed a K562 FAIRE-seq dataset lacking a matching input control sample with each algorithm, and compared the resulting set of peaks from each algorithm to a set of DNase I hypersensitivity sites (DHSs) [<xref ref-type="bibr" rid="B31">31</xref>,<xref ref-type="bibr" rid="B32">32</xref>] isolated from the exact same set of cells. The DHSs were called by F-seq, and were selected as a standard because of the longstanding use of DNase as a method for identification of open chromatin sites. Both ZINBA and MACS called a high proportion of FAIRE sites that overlapped a DHS, but a low proportion of FAIRE sites called by F-seq were localized to a DHS (Figure <xref ref-type="fig" rid="F5">5g</xref>). The set of sites called by both MACS and F-Seq tended to be longer and more errant in K562 CNV regions [<xref ref-type="bibr" rid="B31">31</xref>,<xref ref-type="bibr" rid="B32">32</xref>] (Figure S7a in Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>), where approximately 37% of MACS and 27% of F-seq peaks were localized to a DHS, compared to 50% of ZINBA peaks. Overlap between called peak sets from ZINBA, MACS, and F-seq for FAIRE were more disparate than those found in high signal-to noise CTCF data (Figure S7b in Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>).</p>
        <p>Open chromatin regions tend to have strong correspondence to active regulatory elements and promoter regions of expressed genes [<xref ref-type="bibr" rid="B40">40</xref>]. Comparison of the set of ZINBA RNA Pol II and FAIRE-seq refined peak calls yielded a significantly higher degree of overlap compared to the other algorithms (Figure <xref ref-type="fig" rid="F6">6a</xref>), indicating consistency in ZINBA peak calls across data types.</p>
        <fig id="F6" position="float">
          <label>Figure 6</label>
          <caption>
            <p><bold>ZINBA calls broader regions of signal and selects sets of peaks that are coherent across datasets</bold>. <bold>(a) </bold>The proportion of the top cumulative sets of MACS (red dashed line), F-Seq (green dashed line) and ZINBA refined (light blue line) RNA Pol II peaks that uniquely overlap a FAIRE-seq peak called by the respective method. For comparison, overlap was also compared using randomly permuted RNA Pol II and FAIRE-seq ZINBA peak calls (black dashed line). <bold>(b) </bold>The average coverage of the cumulative sets of the top N ranked genes (expression, high to low) by H3K36me3 regions called by MACS (red dashed line), F-Seq (green dashed line) and ZINBA unrefined regions (light blue dashed line). The set of unrefined ZINBA H3K36me3 regions were further clustered throughout the genome to merge nearby peaks (blue solid line) and compared to the ranked list of genes in terms of gene body coverage. <bold>(c) </bold>Comparison of measured gene expression levels for the set of ZINBA H3K36me3 broad regions that either did or did not overlap a ZINBA RNA Pol II broad region. Those overlapping a ZINBA RNA Pol II broad region had three-fold higher median levels of measured gene expression than H3K36me3 regions that did not have any overlap. <bold>(d) </bold>Representative view of the set of H3K36me3 broad, FAIRE-seq refined and RNA Pol II refined ZINBA peak calls displayed in the UCSC Genome Browser along with the respective read overlap data. For reference, the set of genes (top row) and RNA-seq data (second row) are included. RPKM, reads per kilobase per million mapped reads.</p>
          </caption>
          <graphic xlink:href="gb-2011-12-7-r67-6"/>
        </fig>
      </sec>
      <sec>
        <title>ZINBA captures broad patterns of enrichment</title>
        <p>The deposition of H3K36me3 is mediated by enzymes that travel along with RNA Pol II during transcriptional elongation, and therefore this histone modification typically occurs in broad segments encompassing a large proportion of gene bodies [<xref ref-type="bibr" rid="B41">41</xref>]. Utilizing the 'broad' ZINBA setting (Materials and methods), the H3K36me3-enriched regions identified by ZINBA correspond to the broad patterns of enrichment covering actively transcribed gene bodies, as expected.</p>
        <p>On average, 80% of the lengths of the top 'N' most active UCSC gene bodies were covered by the set of H3K36me3 ZINBA peaks (Materials and methods; Figure <xref ref-type="fig" rid="F6">6b</xref>). A lower level of gene body coverage was found from other methods. Of the 40,180 H3k36me3 merged ZINBA peaks, 71% overlap a gene body, compared with only 59% of F-seq peaks merged in a similar fashion, suggesting higher specificity of these broad ZINBA regions to gene bodies. Of the set of ZINBA merged peak calls that overlapped a gene body, the median and 75th percentile of peak lengths was 5,374 and 18,370 bp respectively, indicative of the broader set of features that are being called (Figure S8 in Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>).</p>
        <p>Within the set of H3K36me3 enrichment regions identified by ZINBA, those that overlap ZINBA RNA Pol II broad regions also contain significantly higher levels of RNA expression compared to those that do not overlap broad RNA Pol II regions (Figure <xref ref-type="fig" rid="F6">6c</xref>). Approximately 85% of ZINBA H3K36me3 broad regions that overlap a ZINBA RNA Pol II broad region contain non-zero RNA-seq signal (7,585 out of 8,873 overlapping regions), compared to only 58% of those that do not (18,134 out of 31,312 non-overlapping regions). Furthermore, of ZINBA H3K36me3 regions with non-zero RNA-seq signal, those that overlapped a ZINBA RNA Pol II broad region had three-fold higher median RNA expression. The relationships we observe among our ZINBA calls recapitulates the biology of H3K36me3, where higher levels RNA Pol II activity correspond to higher levels of RNA transcription and histone modification (Figure <xref ref-type="fig" rid="F6">6d</xref>).</p>
      </sec>
    </sec>
    <sec>
      <title>ZINBA performs comparably with or without input control data</title>
      <p>Comparison of ZINBA peak calls from BIC-selected models considering input as a covariate versus those that do not reveal similar performance in isolating relevant enriched regions. For example, 94% of the CTCF ChIP-seq peaks discovered using a model that included input (Table S1 in Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>) were held in common with a model considering only G/C content, mappability score, and the local background estimate as starting covariates. Recovery of sites overlapping a CTCF motif was also very similar (Figure S9a in Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>). This similarity in performance with and without input extended to the lower signal-to-noise H3K36me3 ChIP-seq data (Figure S9b in Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>). Because of the broad nature of H3K36me3 enrichment, we only considered G/C content and the mappability score as potential covariates in the no-input model. These results demonstrate the ability of ZINBA to distinguish regions of enrichment from background in the absence of input control.</p>
    </sec>
    <sec>
      <title>Modeling enrichment covariates is especially beneficial in low signal-to-noise data</title>
      <p>Choosing not to model covariates in the enrichment component (Table S1 in Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>) resulted in almost uniform decreases in model confidence in the classification of 'enriched' windows relative to when enrichment covariates are considered (Figure S10 in Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>). This is especially severe in the low signal-to-noise FAIRE and H3K36me3 dataset (Figure S10a, b in Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>), in contrast to the higher signal-to-noise CTCF data (Figure S10c Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>). In H3K36me3 data, significantly fewer windows in chromosome 22 were classified as enriched over background (posterior probability of enrichment greater than 0.5) when enrichment covariates are ignored. Applying this model genome-wide, we find that 60% fewer windows were called at the default threshold prior to window merging, and post-merging we observe much lower coverage of active gene bodies (Figure S9a in Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>), in contrast to CTCF peaks, which change little as a result of ignoring enrichment covariates (Figure S9b in Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>). These results and the simulated data suggest that utilizing covariates provide an increased discriminatory power for distinguishing background and enriched regions, especially in low signal-to-noise data or when information such as an input control is lacking.</p>
    </sec>
  </sec>
  <sec>
    <title>Discussion</title>
    <p>A major challenge in the analysis of genomic experiments that employ NGS technology for detection is the reliable integration of information across a multitude of assays and data types, where such integration would provide a more complete picture of genome-wide cellular regulation. We have developed a statistical framework named ZINBA that addresses these issues by providing a platform that is flexible enough to identify genomic regions of enrichment for a variety of DNA-seq data types and signal patterns. ZINBA can also utilize potentially informative covariates to aid in the classification of genomic regions as likely background, enrichment, or zero-inflated regions.</p>
    <p>Application of our approach resulted in the recovery of relevant enriched sites across a wide variety of data types without the need for extensive user input to the analysis procedure. In addition, we show that ZINBA peak calls across different sets of data are highly consistent with known biological processes (Figure <xref ref-type="fig" rid="F6">6</xref>). Enriched regions can be identified in challenging situations, such as in the absence of input control or within DNA copy number amplifications. In the absence of input control, utilizing other covariates yielded similar results as to when input was used in real data.</p>
    <p>Previous studies have commented on the non-random nature of background signal in ChIP-seq data [<xref ref-type="bibr" rid="B4">4</xref>,<xref ref-type="bibr" rid="B27">27</xref>], and that accounting for this non-randomness can improve modeling of background regions and the ability to detect regions of enrichment. In some peak-finding applications, background models assume signal is completely random, and loci with signal greater than this background are deemed as enriched [<xref ref-type="bibr" rid="B2">2</xref>,<xref ref-type="bibr" rid="B6">6</xref>]. In datasets where certain covariates have strong effects on background signal, this assumption of randomness is violated. Thus, methods relying on this assumption may result in lower sensitivity and lower specificity to detect enriched sites. Our results suggest that this non-randomness may be due in some part to the effects of certain covariates, and their effects on signal may vary depending on the data being analyzed. We account for this non-randomness by modeling background signal with multiple covariates.</p>
    <p>The mixture regression framework used in ZINBA is a natural way to accommodate arbitrary sets of relevant covariates, probe for their relationships with component-specific signal, and account for their effects without the need for user specification of the proportion of background in the sample. One of the inherent advantages of our regression-based approach is that read sample and input read counts do not need to be normalized or scaled, and read coverage is accounted for by each component's regression model. This modeling approach is preferable over normalization procedures that adjust for covariate effects prior to enrichment detection for two reasons. First, these normalization procedures assume the covariates have the same effect on both background and enrichment signals, and thus normalize signal across each region in a similar manner. Second, these procedures cannot naturally account for the effects of multiple covariates simultaneously, which is an inherent feature in a regression framework. It is unknown to the user the impact of such normalization procedures on sensitivity, as the effects of covariates may vary between datasets or between background and enriched regions.</p>
    <p>As high-throughput sequencing technology matures, the ZINBA framework can allow for the continued evaluation of existing covariates and the addition of new covariates to model DNA-seq data. Examples of additional potential covariates could be scores for the presence of transcription factor motifs, strand cross-correlation, or local overlap with a particular feature of interest. While not implemented currently, we can easily apply our ZINBA to paired-end reads by assigning a paired-end read to a window if the center of the paired end read belongs to this window.</p>
    <p>A major drawback to our approach is the computationally intensive model selection process via BIC. We are currently developing a variable selection procedure based on penalized likelihood that will be able to efficiently select component variables. There are also several general factors that affect all methods regardless of the modeling assumptions used. One such covariate is the sequencing depth of a DNA-seq sample, which is directly related to the sensitivity of the assay to detect enriched sites [<xref ref-type="bibr" rid="B14">14</xref>]. Often overlooked, however, is the sequencing depth of the matching input control sample, which typically requires greater sequencing depth to obtain coverage levels similar to the experimental sample.</p>
  </sec>
  <sec>
    <title>Conclusions</title>
    <p>Two major challenges in the analysis of DNA-seq data are the diversity in signal patterns that exist across the wide range of possible experiments, and sample-specific issues such as CNV that may further complicate analysis. ZINBA is a flexible statistical framework capable of identifying regions of enrichment across a wide variety of DNA-seq data types, enrichment patterns, and experimental conditions. ZINBA's flexibility in modeling background and enrichment regions with sets of covariates allows for the identification of enriched regions in difficult modeling conditions, such as in datasets with complex local CNVs or lacking a matching input control sample. ZINBA can identify both broad and sharp regions of enrichment, and we demonstrate this capability in differentiating RNA Pol II elongation status. In addition, the statistical framework used is applicable to both high signal-to-noise data such as from CTCF ChIP-seq, as well as to low signal-to-noise data such as from FAIRE-seq. ZINBA produces peak calls that are consistent with known biological patterns, and performs favorably relative to existing specialized methods over a broad range of signal patterns and data types. ZINBA is implemented as a freely available R package.</p>
  </sec>
  <sec sec-type="materials|methods">
    <title>Materials and methods</title>
    <sec>
      <title>Datasets and model parameters</title>
      <p>All data were produced by members of the ENCODE Consortium [<xref ref-type="bibr" rid="B31">31</xref>,<xref ref-type="bibr" rid="B32">32</xref>] and downloaded as aligned reads (tagAlign) from the UCSC Genome Browser. The FAIRE-seq, RNA Pol-II ChIP-seq, and H3K36me3 ChIP-seq datasets were derived from K562 cells while the CTCF ChIP-seq dataset was derived from GM12878 cells. For data access and generation methods see Additional file <xref ref-type="supplementary-material" rid="S2">2</xref>. The MCF-7 FAIRE-seq data are not yet available through ENCODE, but access to the relevant portions of the data can be found in Additional file <xref ref-type="supplementary-material" rid="S2">2</xref>. All data were analyzed within ZINBA using 250-bp windows and an additional offsets of 125 bp. The set of covariates and all possible pair-wise and three-way interactions were evaluated using the BIC, with the best scoring model formulation being selected for subsequent downstream analyses. For the RNA Pol II, CTCF, and H3K36me3 ChIP-seq datasets we considered G/C content, mappability score, and input control as starting covariates in our model selection procedure unless stated otherwise. For FAIRE, we only considered G/C content, mappability score, and the local background estimate.</p>
    </sec>
    <sec>
      <title>ZINBA step 1: data preprocessing</title>
      <sec>
        <title>Calculation of signal values</title>
        <p>Raw NGS data are composed of millions of relatively short (25 to 75 bp) reads aligned to a reference genome sequence. A sequence read often does not represent the entire DNA fragment recovered with a given assay, but instead one or both ends of the fragment. Therefore, for single-end reads we attempt to approximate the center of each DNA fragment by extending the coordinates for each aligned read in the 3' direction to the average fragment length. For each ChIP-seq dataset, we used an average fragment length of 200 bp, and 134 bp for our FAIRE-seq dataset. The average fragment can be either specified by the user or estimated from the data directly using the cross-correlation function [<xref ref-type="bibr" rid="B14">14</xref>] implemented in ZINBA. All subsequent references to a read refer to the extended coordinates, and raw reads refer to the original coordinates.</p>
        <p>The genome-wide set of reads is summarized as the count of reads within a set of contiguous non-overlapping windows. Each read is assigned to a single genomic position based on the position of the central base. To avoid bisecting a potentially significant region, a similar set of contiguous non-overlapping windows can be produced that are offset from the starting position by a user specified distance.</p>
      </sec>
      <sec>
        <title>Calculation of covariate values</title>
        <p>A series of covariates are scored for each window, which include G/C content, mappability score, a local background estimate, and read counts from an input control sample (if available). The G/C content is calculated as the proportion of G and C bases in a given window. The tabulation of window read counts from the input control sample is handled exactly as reads from the experimental sample.</p>
        <p>The mappability score is calculated as the proportion of all bases within a window that met the criteria for uniqueness imposed during alignment of the raw reads. Typically, raw reads will only be aligned to positions that are unique throughout the genome. However, in some instances a more relaxed criterion may be used, such as with the FAIRE-seq data where raw reads could be aligned to a position that occurred four or less times throughout the genome. ZINBA implements the mappability software provided by PeakSeq [<xref ref-type="bibr" rid="B28">28</xref>] to calculate for each base pair the number of times a given k-mer (36 bp) starting at that base occurs throughout the genome. If a base pair receives a score of 1, then only one occurrence of the given k-mer exists throughout the genome and would be a mappable position under the absolute uniqueness criteria. Whereas if a base pair received a score of 5, then it would not be considered mappable for either the uniqueness or the relaxed criteria described above. Before the mappability scores are summarized into the windows, those bases that meet the specified criteria are assigned a new score of 1, while those that do not are assigned a new score of 0. Finally, since the central position of each extended read is used for window assignment, the mappability data are shifted in the same way, where for each base the score of 0 or 1 is shifted both plus and minus one half the average fragment length. As a result, each base in the genome has a score of 0, 1 or 2 depending on whether neither, one or both of the up- and downstream base pairs were mappable, respectively. The sum of mappability scores is tabulated and divided by two times the window size to derive the proportion of mappable bases in the window.</p>
        <p>The local background estimate aims to roughly approximate large-scale fluctuations in background signal resulting from local variations in genomic copy number. It is calculated using a sliding window approach where, by default, 100-kb windows are stepped every 2.5 kb across each chromosome. The size of these large windows was selected to be sufficiently large to prevent sites of enrichment from influencing the estimate, but small enough to preserve enough resolution to capture local fluctuation in background signal. The number of reads per mappable base pair is calculated for each window. Windows that span the boundaries of CNVs are problematic, resulting in artificially inflated and deflated estimates of local background. Therefore, an additional step is employed to identify these change points and any windows straddling these boundaries are removed (Additional file <xref ref-type="supplementary-material" rid="S2">2</xref>). For each ZINBA window, which is considerably smaller than 100 kb, the local background estimate is computed as the average number of reads per mappable base for all overlapping 100-kb windows, multiplied by the length of the ZINBA window.</p>
      </sec>
    </sec>
    <sec>
      <title>ZINBA step 2: data analysis</title>
      <p>Because of the discrete nature of window read counts, this summary of the data can be modeled by either the Poisson or the negative binomial distribution. The negative binomial distribution can be considered as an extension of Poisson distribution to handle over-dispersion, that is, the situation where the variance of the counts is larger than expected by a Poisson distribution. Instead of using a single Poisson or negative binomial distribution, we find that our approach of modeling DNA-seq data by a mixture of negative binomial distributions provides an adequate representation of the data (Figure S11 in Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>)</p>
      <sec>
        <title>Mixture regression to select enriched regions</title>
        <p>The mixture regression model is implemented using an EM algorithm [<xref ref-type="bibr" rid="B29">29</xref>] that consists of four major steps: initialization, expectation-Step, maximization-Step, and convergence checking. Given a model file from ZINBA step 1, windows that meet a user-defined enrichment posterior probability threshold are selected in the following manner (mathematical details are given in Additional file <xref ref-type="supplementary-material" rid="S2">2</xref>).</p>
        <sec>
          <title>Model initialization</title>
          <p>Initialization of the EM algorithm is the assignment of initial component memberships for each window. Each window has an associated posterior probability vector (<italic>Ï</italic><sub><italic>i</italic>0</sub>, Ï<sub><italic>i</italic>1</sub>, Ï<sub><italic>i</italic>2</sub>) describing its posterior probability of belonging to each component, where for window <italic>i</italic>, 0 corresponds to the zero-inflated component, 1 corresponds to the background component, 2 corresponds to the enrichment component, and <italic>Ï</italic><sub><italic>i</italic>0</sub>, <italic>Ï</italic><sub><italic>i</italic>1</sub>, <italic>Ï</italic><sub><italic>i</italic>2</sub>= 1. To initialize the model parameters, we create several starting partitions of the data and use these partitions to determine the initial values of model parameters for each component. Under the assumption that enrichment signal is generally larger than background signal, windows with largest window read counts are assigned to the enrichment component such that (<italic>Ï</italic><sub><italic>i</italic>0</sub>, <italic>Ï</italic><sub><italic>i</italic>1</sub>, Ï<sub><italic>i</italic>2</sub>) = (0,0,1). Multiple starting partitions are generated such that 0.1%, 1%, 5%, 10%, and 15% of the largest windows in terms of read count are assigned to the enrichment component, and all other windows with non-zero window read counts are assigned to background. All windows with zero read counts are assigned to the zero-inflated component. For each partition we run the EM algorithm multiple times cycling between the E and M steps and choose the partition that provides the best fit.</p>
        </sec>
        <sec>
          <title>M-step</title>
          <p>In the maximization-step (M-step), we apply weighted GLMs to each component, where <italic>Ï</italic><sub><italic>i</italic>0</sub>, <italic>Ï</italic><sub><italic>i</italic>1 </sub>and <italic>Ï</italic><sub><italic>i</italic>2 </sub>are used as the weights of the <italic>i</italic><sup>th </sup>window in the corresponding component. These weights represent current knowledge of the probabilistic classification of a window into each component and are updated in the E-step. Window counts in the enriched and background components are modeled using weighted negative binomial regression, allowing for over-dispersion in the distribution of window read counts.</p>
          <p>The prior probability that a window is zero-inflated <italic>Ï</italic><sub><italic>i</italic>0</sub>is directly modeled using weighted logistic regression. By using <italic>Ï</italic><sub><italic>i</italic>0</sub>, <italic>Ï</italic><sub><italic>i</italic>1</sub>, and <italic>Ï</italic><sub><italic>i</italic>2</sub>as regression weights for the zero-inflated, background, and enriched regression models, respectively, we are able to partition the same window count across three regression models in a manner proportional to the likelihood that it belongs to each component. For example, windows with a zero-inflation weight of 0, background weight of 1, and enrichment weight of 0 will contribute only to the estimation of the background regression model. Each weighted GLM is maximized using the iteratively reweighted least squares algorithm. At the end of this step, we have estimates of the component-specific covariate effects and the proportion of data belonging to the background and enrichment components (denoted by <italic>Ï</italic><sub>1 </sub>and <italic>Ï</italic><sub>2</sub>, respectively). These two proportions are derived from <italic>Ï</italic><sub>1 </sub>= <italic>Ï</italic><sub>11</sub>, <italic>Ï</italic><sub>21</sub>,... <italic>Ï</italic><sub><italic>n</italic>1</sub>and <italic>Ï</italic><sub>2 </sub>= <italic>Ï</italic><sub>12</sub>, <italic>Ï</italic><sub>22</sub>,... <italic>Ï</italic><sub><italic>n</italic>2</sub>, the vector of window posterior probabilities corresponding to enrichment and background, respectively.</p>
        </sec>
        <sec>
          <title>E-step</title>
          <p>In the Expectation-step (E-step), we update the posterior probability of component membership <italic>Ï</italic><sub><italic>i</italic>0</sub>, <italic>Ï</italic><sub><italic>i</italic>1</sub>, and <italic>Ï</italic><sub><italic>i</italic>2</sub>for each window given the regression estimates from the M-step. Given the read count of a window <italic>y<sub>i </sub></italic>and an associated covariate vector <italic>X<sub>i</sub></italic>, we update (<italic>Ï</italic><sub><italic>i</italic>0</sub>, <italic>Ï</italic><sub><italic>i</italic>1</sub>, Ï<sub><italic>i</italic>2</sub>) at iteration <italic>k </italic>such that:<disp-formula><graphic xlink:href="gb-2011-12-7-r67-i1.gif"/></disp-formula></p>
          <p>where<disp-formula><graphic xlink:href="gb-2011-12-7-r67-i2.gif"/></disp-formula></p>
          <p>and<disp-formula><graphic xlink:href="gb-2011-12-7-r67-i3.gif"/></disp-formula></p>
          <p>is the indicator function that <italic>y<sub>i </sub></italic>is equal to zero. Also:<disp-formula><graphic xlink:href="gb-2011-12-7-r67-i4.gif"/></disp-formula></p>
          <p>corresponding to the negative binomial distributions for the background component (<italic>j </italic>= 1) and the enrichment component (<italic>j </italic>= 2). The predicted mean for each window <inline-formula><inline-graphic xlink:href="gb-2011-12-7-r67-i5.gif"/></inline-formula> is dependent on the estimate of the component-specific covariate effects <inline-formula><inline-graphic xlink:href="gb-2011-12-7-r67-i6.gif"/></inline-formula>, the set of component-specific covariates for window <italic>i X<sub>ij</sub></italic>, and <inline-formula><inline-graphic xlink:href="gb-2011-12-7-r67-i7.gif"/></inline-formula> is the estimate for the dispersion parameter in component <italic>j</italic>. The value <inline-formula><inline-graphic xlink:href="gb-2011-12-7-r67-i8.gif"/></inline-formula> is the prior probability that a window is zero-inflated given the zero-inflated covariate estimates <italic>Î³</italic><sup>(<italic>k</italic>) </sup>from the M-step and associated set of covariates <italic>X</italic><sub><italic>i</italic>0</sub>(Additional file <xref ref-type="supplementary-material" rid="S2">2</xref>). Mixture proportions <inline-formula><inline-graphic xlink:href="gb-2011-12-7-r67-i9.gif"/></inline-formula> and <inline-formula><inline-graphic xlink:href="gb-2011-12-7-r67-i10.gif"/></inline-formula>are defined as before for iteration <italic>k</italic>. Each posterior probability <italic>Ï</italic><sub><italic>i</italic>0</sub>, <italic>Ï</italic><sub><italic>i</italic>1</sub>, and <italic>Ï</italic><sub><italic>i</italic>2</sub>can be thought of as the weighted likelihood that window <italic>i </italic>belongs to component <italic>j </italic>given a windows signal value, set covariates, and the estimated component-specific covariate relationships with average signal in each component. Because enrichment makes up a small proportion of the genome, enrichment covariates generally have a smaller role in influencing classification because of the smaller enrichment proportion <italic>Ï</italic><sub><italic>i</italic>2</sub>. In iteration <italic>k </italic>+ 1, <inline-formula><inline-graphic xlink:href="gb-2011-12-7-r67-i11.gif"/></inline-formula> are again used as regression weights for each component's weighted GLMs.</p>
        </sec>
        <sec>
          <title>Convergence</title>
          <p>The algorithm cycles between the E-step and the M-step until the absolute change in model log likelihood from 10 iterations prior is less than 10<sup>-5</sup>. Windows with posterior probabilities of enrichment greater than a user-specified threshold are considered to be enriched. By default the threshold is 0.95, although this can be lowered to 0.5 if needed. Windows with enrichment posterior probabilities close to 0.5 have ambiguous membership, although the majority of these probabilities for BIC selected models tend to be either close to zero or one (Figure S11b in Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>).</p>
          <p>In this modeling framework, there is an inherent assumption of the independence of neighboring windows; however, in real data, correlations between nearby windows are to be expected. This correlated structure is most similar to those found in the analysis of a time series of discrete counts, where neighboring counts are correlated in a serial fashion. More complicated models, such as hidden Markov models and related methods incorporating covariates, would be computationally intensive to implement given the model's complexity [<xref ref-type="bibr" rid="B42">42</xref>] and the size of each chromosome. With the default window size, the number of observations for the smallest chromosome is nearly 134,000 windows. One reasonable assumption of the correlation structure is a symmetric autoregressive structure such that the correlation between the <italic>i</italic><sup>th </sup>window and the <italic>l</italic><sup>th </sup>window is <italic>r</italic><sup>|<italic>i-l</italic>|</sup>, where <italic>r </italic>is the correlation parameter to be estimated. Under this assumption, previous studies have shown that ignoring local correlation leads to smaller standard errors of covariates but has little effect on the estimated covariate effects themselves in GLMs [<xref ref-type="bibr" rid="B43">43</xref>,<xref ref-type="bibr" rid="B44">44</xref>]. Therefore, we do not expect correlation to have a significant impact on covariate estimates; however, we still only discuss covariate effects in a qualitative fashion.</p>
        </sec>
        <sec>
          <title>Selecting relevant covariates using BIC</title>
          <p>Selecting the most optimal set of model covariates to achieve the best classification outcome and model fit is not a trivial task. ZINBA uses the BIC [<xref ref-type="bibr" rid="B30">30</xref>] to choose the most parsimonious set of covariates that best explains the variation seen within each mixture component. A typical set of covariates includes the mappability score, G/C content, and input control. When sequencing data from an input control sample are not available, the local background estimate can be considered to control for local fluctuations in copy number or other changes in local chromatin structure. Higher order pair-wise and three-way interaction terms are also included between covariates when their lower order effects are in the model. For example, a pair-wise interaction term between G/C content and mappability score will not be considered if any one of these two covariates is not included in the model. Due to the computational cost, the BIC calculations are performed on a restricted set of chromosomes. While the resulting model fit may not be optimal, ignoring interaction terms between starting covariates greatly reduces the number of models to be computed under the BIC procedure. This results in faster processing and does not adversely impact the recovery of relevant peaks (Figure S12 in Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>). We also provide an additional heuristic that further reduces the number of models considered by only considering covariates in the enriched and background components during model selection. With this heuristic and considering three starting covariates with interaction, model selection takes approximately 4 hours for FAIRE data using eight 2.8 GHz Intel Xeon processors (361 models considered).</p>
        </sec>
      </sec>
    </sec>
    <sec>
      <title>Step 3: peak boundary refinement</title>
      <sec>
        <title>Isolating exact peak boundaries within merged regions</title>
        <p>Following analysis using the mixture regression model, overlapping or adjacent windows with an enrichment probability greater than a user-specified threshold (default 0.95) are merged to form significant regions. ZINBA employs a shape detection algorithm to analyze the higher-resolution read overlap data (single base pair count) within each significant region to identify and refine the boundaries of potential punctate enrichment sites. This sequential detection of broader regions and then punctate regions within broader regions allows for more flexibility in detecting various enrichment patterns.</p>
        <p>The shape detection algorithm consists of two steps. First, the set of local maxima within the merged significant region is identified. Second, the boundaries of punctate enrichment sites surrounding these local maxima are determined. Specifically, local maximums are determined using a modified matrix-based algorithm from the massspecwavelet package in R. Local maxima greater than a user-defined quantile threshold are retained for boundary refinement. The boundaries are determined using best linear fit for the read overlap data on either side of each maximum. For each side, a simple linear model is fitted originating at the maxima and extending to the base pair position that maximizes the R<sup>2 </sup>of the linear model. Any local maxima within N bp of each other or whose boundaries overlap are merged into a single peak, where N is 100 bp by default. The set of chromosomal coordinates for each refined region is returned along with the position of the local maxima, the single base pair count score at the maxima, and the maximum posterior probability of the original windows within the merged region.</p>
        <p>In general, peak refinement is most useful when one expects a mix of punctate peaks within broader regions, as in RNA Pol II data (Figure S13 in Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>), where ZINBA peak refinement improves the results of other software. In CTCF ChIP-seq, refinement does not make much of a difference, as expected, and in FAIRE, ZINBA still performs favorably to other methods. In addition, ZINBA's peaks have much more favorable correspondence across data types in relation to ZINBA-refined peaks from other software (Figure S13d in Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>).</p>
      </sec>
    </sec>
    <sec>
      <title>Simulation of data</title>
      <p>Zero-inflated, background, and enriched window counts are simulated using a two-step procedure. In the first step, background and zero-inflated window counts are randomly simulated given a set of pre-specified covariates and their effects. A random subset of background windows is selected to be enriched and the read counts of these are adjusted according to conditioning on the selected covariates for enriched windows if desired.</p>
      <p>Let (<italic>X<sub>z</sub>, X<sub>B</sub></italic>) be covariate matrices for the zero-inflated component and background component. The number of rows in each matrix is the total number of windows sampled and the number of columns is equal to the number of chosen covariates plus the intercept. The covariates could include, for example, mappability score, G/C content, local background, and read counts from an input control sample in each window. According to the modeling assumptions in Additional file <xref ref-type="supplementary-material" rid="S2">2</xref>, the predicted background mean count of a window is given as <inline-formula><inline-graphic xlink:href="gb-2011-12-7-r67-i12.gif"/></inline-formula> and the probability that a window will be zero-inflated is <inline-formula><inline-graphic xlink:href="gb-2011-12-7-r67-i13.gif"/></inline-formula>, where <inline-formula><inline-graphic xlink:href="gb-2011-12-7-r67-i14.gif"/></inline-formula> are pre-specified covariate estimates for the zero-inflated and background components, respectively. These pre-specified parameters are taken from a previous real data analysis in order to simulate realistic background counts.</p>
      <p>For the vector of calculated background window means <italic>Î¼<sub>B </sub></italic>and dispersion parameter <inline-formula><inline-graphic xlink:href="gb-2011-12-7-r67-i15.gif"/></inline-formula>, a set of window counts is simulated using the negative binomial distribution in R. A window is randomly selected to be zero-inflated with probability <italic>Ï<sub>i, z</sub></italic>, where windows selected as zero-inflated are set to 0. To simulate enriched windows, the desired proportion of background windows are randomly selected as enriched. To incorporate relationship between the set of enriched windows and covariates, such as with G/C content, the count for enriched window <italic>i </italic>is simulated such that <italic>Y<sub>i, sim </sub></italic>~ <italic>NB</italic>(<italic>Î¼ </italic>= <italic>b Ã GC<sub>i </sub></italic>+ <italic>a, Î¸<sub>E</sub></italic>), where <italic>Y<sub>i, sim </sub></italic>is a random count from the negative binomial distribution with mean value <italic>b Ã GC<sub>i </sub></italic>+ <italic>a</italic>, and over-dispersion parameter of enrichment <italic>Î¸<sub>E</sub></italic>. The signal-to-noise ratio and the strength of the G/C content covariate effect on enrichment counts can be tuned by altering parameters <italic>a </italic>and <italic>b</italic>. For example, when <italic>b </italic>is 0 there is no relation between window read counts and G/C content; otherwise, the sign of <italic>b </italic>determines whether G/C content is positively or negatively related to window counts.</p>
    </sec>
    <sec>
      <title>Calculation of RNA pol II stalling score</title>
      <p>For ZINBA RNA Pol II peaks within 1 kb of genes with non-zero gene expression, we calculate an RNA Pol II 'stalling' index for each peak such that:<disp-formula><graphic xlink:href="gb-2011-12-7-r67-i16.gif"/></disp-formula></p>
      <p>where <italic>Length<sub>i, punctate </sub></italic>is the length of the punctate peak found within a broad ZINBA peak region, <italic>Length<sub>i, broad </sub></italic>is the length of the broader ZINBA peak, <italic>MAX</italic>(<italic>Height<sub>i, punctate</sub></italic>) is the maximum read overlap height corresponding to the punctate peak, and <italic>Median </italic>(<italic>Height<sub>i, broad</sub></italic>) is the median read overlap height of the broader region excluding the punctate peak. A pseudocount of 1 was added to the numerator and denominator of the height ratio to avoid dividing by zero. To determine the relationship between the stalling score and gene expression (in RPKM (reads per kilobase per million mapped reads)), a median regression line (robust to outliers) was fit to the natural log of the gene expression data using the stalling score as a covariate. To better capture broad regions, we merge enriched windows within 5 kb and then applied the ZINBA peak refinement to these broad regions to obtain the punctate sites within.</p>
    </sec>
    <sec>
      <title>Assessing performance across peak calling algorithms and datasets</title>
      <p>ZINBA, MACS and F-Seq were run using the default set of parameters with the goal of calling at least 50,000 peaks. Running MACS on FAIRE-seq data without an input control sample required the mfold parameter to be lowered to 10 and the <italic>P</italic>-value threshold increased to 0.001 to generate enough peaks. For the RNA Pol II ChIP-seq data the ZINBA posterior probability threshold had to be lowered to 0.5 to generate enough peaks.</p>
      <p>The set of ranked peaks for each algorithm was compared to a set of biologically relevant features. Ranked peaks were used because there was not a straightforward way to impose a single threshold for all algorithms due to differences in the assessment of significance (MACS uses <italic>P</italic>-values, F-Seq uses kernel density estimate, and ZINBA uses posterior probability). Peaks were considered to overlap a biologically relevant feature when the peak center was within 150 bp, which emphasized localization at the set of features. The set of metrics related to overlap, peak length and proximity to features was carried on an increasing cumulative set of the top N ranked peaks. It is common for ZINBA regions called as enriched to have a posterior enrichment probability of 1; therefore, these windows were further differentiated based on the maximum read overlap score.</p>
      <p>Overlap between the FAIRE-seq, RNA Pol II and H3K36me3 peaks with the set of active genes (UCSC knownGenes, hg18) was carried out using the intersectBed function in BEDTools [<xref ref-type="bibr" rid="B45">45</xref>] with default parameters. The broader set of enriched regions called by ZINBA for the H3K36me3 and RNA Pol II datasets were collapsed by clustering regions within 5 kb (optional) of each other into a single region. To generate a set of random peaks, the shuffleBed function in BEDTools was used to randomize the locations of ZINBA enriched regions, while maintaining localization on the same chromosome and ignoring centrometric regions using the -chrom and -excl options.</p>
      <p>Gene activity was measured as the isoform with the maximal value contained within UCSC gene bodies using RNA-seq data (RPKM), where a gene body was defined as from transcription start to stop. Therefore, each gene was assigned a signal score based on this measured value. Then, the average coverage by H3K36me3 peak regions of the set of N most active gene bodies by this measure was calculated using the coverageBed function in BEDTools for each method.</p>
    </sec>
    <sec>
      <title>Software implementation</title>
      <p>ZINBA (version 2.0) is implemented as an R package (Additional file <xref ref-type="supplementary-material" rid="S3">3</xref>), and updated versions can be accessed at the software website [<xref ref-type="bibr" rid="B46">46</xref>]. The core of the mixture regression framework is implemented in C to improve computational efficiency. ZINBA can be run on a desktop computer with at least 3 GB of RAM and a 2 GHz processor. The software is applicable to any species with a sequenced genome. ZINBA can be run using a GUI (graphical user interface) or from the command line, and is capable of being installed on multi-core computing clusters, allowing for extremely high-throughput capacity. Currently, ZINBA is available for Linux, UNIX, and Mac OSX.</p>
    </sec>
  </sec>
  <sec>
    <title>Abbreviations</title>
    <p>BIC: Bayesian information criterion; bp: base pair; ChIP: chromatin immunoprecipitation; CNV: copy number variation; CTCF: CCCTC-binding factor; DHS: DNase hypersensitivity site; FAIRE: formaldehyde-assisted isolation of regulatory elements; GLM: generalized linear model; H3K36me3: histone H3 lysine 36 tri-methylation; NGS: next generation sequencing; RNA Pol II: RNA polymerase II; RPKM: reads per kilobase per million mapped reads; TFBS: transcription factor binding site; TSS: transcription start site; ZINBA: Zero-Inflated Negative Binomial Algorithm.</p>
  </sec>
  <sec>
    <title>Competing interests</title>
    <p>The authors declare that they have no competing interests.</p>
  </sec>
  <sec>
    <title>Authors' contributions</title>
    <p>NR and PG conceived of the project under the direction of WS, JI, and JDL. NR, PG, WS, JI, and JDL wrote the manuscript. NR, PG, and WS coded the software. All authors read and approved the final manuscript.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="S1">
      <caption>
        <title>Additional file 1</title>
        <p><bold>Figures S1 to S13 and Table S1</bold>. Supplementary Figures S1 to S13, and Table S1, corresponding to parameter estimates from the ZINBA BIC-selected models.</p>
      </caption>
      <media xlink:href="gb-2011-12-7-r67-S1.PDF" mimetype="application" mime-subtype="pdf">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="S2">
      <caption>
        <title>Additional file 2</title>
        <p><bold>Supplementary methods</bold>. Mathematical details of the ZINBA mixture regression algorithm, in addition to data access details.</p>
      </caption>
      <media xlink:href="gb-2011-12-7-r67-S2.PDF" mimetype="application" mime-subtype="pdf">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="S3">
      <caption>
        <title>Additional file 3</title>
        <p><bold>ZINBA version 2.0</bold>. A freeze of the ZINBA software as of 9 July 2011, which is included in the manuscript for archival purposes only. We recommend that users download ZINBA from our website [<xref ref-type="bibr" rid="B46">46</xref>] to ensure that the most up-to-date version is installed.</p>
      </caption>
      <media xlink:href="gb-2011-12-7-r67-S3.GZ" mimetype="application" mime-subtype="x-zip-compressed">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <sec>
    <title>Acknowledgements</title>
    <p>We would like to thank the Iyer lab at the University of Texas-Austin and the Bernstein lab at the Broad Institute for generating the ENCODE DNA-seq data used in the evaluation of ZINBA. This work was supported by the NIH Biostatistics Training Grant in Cancer Genomics and NIH grants Bayesian Approaches to Model Selection for Survival Data (GM70335), Inference with Missing Covariates in Regression Models (CA74015), and ENCODE grant U54 HG004563.</p>
  </sec>
  <ref-list>
    <ref id="B1">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Park</surname>
          <given-names>PJ</given-names>
        </name>
        <article-title>ChIP-seq: advantages and challenges of a maturing technology.</article-title>
        <source>Nat Rev Genet</source>
        <year>2009</year>
        <volume>10</volume>
        <fpage>669</fpage>
        <lpage>680</lpage>
        <pub-id pub-id-type="pmid">19736561</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B2">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Boyle</surname>
          <given-names>AP</given-names>
        </name>
        <name>
          <surname>Davis</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Shulha</surname>
          <given-names>HP</given-names>
        </name>
        <name>
          <surname>Meltzer</surname>
          <given-names>P</given-names>
        </name>
        <name>
          <surname>Margulies</surname>
          <given-names>EH</given-names>
        </name>
        <name>
          <surname>Weng</surname>
          <given-names>Z</given-names>
        </name>
        <name>
          <surname>Furey</surname>
          <given-names>TS</given-names>
        </name>
        <name>
          <surname>Crawford</surname>
          <given-names>GE</given-names>
        </name>
        <article-title>High-resolution mapping and characterization of open chromatin across the genome.</article-title>
        <source>Cell</source>
        <year>2008</year>
        <volume>132</volume>
        <fpage>311</fpage>
        <lpage>322</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2007.12.014</pub-id>
        <pub-id pub-id-type="pmid">18243105</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B3">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Giresi</surname>
          <given-names>PG</given-names>
        </name>
        <name>
          <surname>Lieb</surname>
          <given-names>JD</given-names>
        </name>
        <article-title>Isolation of active regulatory elements from eukaryotic chromatin using FAIRE (formaldehyde assisted isolation of regulatory elements).</article-title>
        <source>Methods</source>
        <year>2009</year>
        <volume>48</volume>
        <fpage>233</fpage>
        <lpage>239</lpage>
        <pub-id pub-id-type="doi">10.1016/j.ymeth.2009.03.003</pub-id>
        <pub-id pub-id-type="pmid">19303047</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B4">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Pepke</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Wold</surname>
          <given-names>B</given-names>
        </name>
        <name>
          <surname>Mortazavi</surname>
          <given-names>A</given-names>
        </name>
        <article-title>Computation for ChIP-seq and RNA-seq studies.</article-title>
        <source>Nat Methods</source>
        <year>2009</year>
        <volume>6</volume>
        <issue>11 Suppl</issue>
        <fpage>S22</fpage>
        <lpage>S32</lpage>
        <pub-id pub-id-type="pmid">19844228</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B5">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Zhang</surname>
          <given-names>Y</given-names>
        </name>
        <name>
          <surname>Liu</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Meyer</surname>
          <given-names>CA</given-names>
        </name>
        <name>
          <surname>Eeckhoute</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Johnson</surname>
          <given-names>DS</given-names>
        </name>
        <name>
          <surname>Bernstein</surname>
          <given-names>BE</given-names>
        </name>
        <name>
          <surname>Nussbaum</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Myers</surname>
          <given-names>RM</given-names>
        </name>
        <name>
          <surname>Brown</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Li</surname>
          <given-names>W</given-names>
        </name>
        <name>
          <surname>Liu</surname>
          <given-names>XS</given-names>
        </name>
        <article-title>Model-based analysis of ChIP-Seq (MACS).</article-title>
        <source>Genome Biol</source>
        <year>2008</year>
        <volume>9</volume>
        <fpage>R137</fpage>
        <pub-id pub-id-type="doi">10.1186/gb-2008-9-9-r137</pub-id>
        <pub-id pub-id-type="pmid">18798982</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B6">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Auerbach</surname>
          <given-names>RK</given-names>
        </name>
        <name>
          <surname>Euskirchen</surname>
          <given-names>G</given-names>
        </name>
        <name>
          <surname>Rozowsky</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Lamarre-Vincent</surname>
          <given-names>N</given-names>
        </name>
        <name>
          <surname>Moqtaderi</surname>
          <given-names>Z</given-names>
        </name>
        <name>
          <surname>Lefrancois</surname>
          <given-names>P</given-names>
        </name>
        <name>
          <surname>Struhl</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Gerstein</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Snyder</surname>
          <given-names>M</given-names>
        </name>
        <article-title>Mapping accessible chromatin regions using Sono-Seq.</article-title>
        <source>Proc Natl Acad Sci USA</source>
        <year>2009</year>
        <volume>106</volume>
        <fpage>14926</fpage>
        <lpage>14931</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.0905443106</pub-id>
        <pub-id pub-id-type="pmid">19706456</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B7">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Valouev</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Johnson</surname>
          <given-names>DS</given-names>
        </name>
        <name>
          <surname>Sundquist</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Medina</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Anton</surname>
          <given-names>E</given-names>
        </name>
        <name>
          <surname>Batzoglou</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Myers</surname>
          <given-names>RM</given-names>
        </name>
        <name>
          <surname>Sidow</surname>
          <given-names>A</given-names>
        </name>
        <article-title>Genome-wide analysis of transcription factor binding sites based on ChIP-Seq data.</article-title>
        <source>Nat Methods</source>
        <year>2008</year>
        <volume>5</volume>
        <fpage>829</fpage>
        <lpage>834</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.1246</pub-id>
        <pub-id pub-id-type="pmid">19160518</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B8">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Tuteja</surname>
          <given-names>G</given-names>
        </name>
        <name>
          <surname>White</surname>
          <given-names>P</given-names>
        </name>
        <name>
          <surname>Schug</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Kaestner</surname>
          <given-names>KH</given-names>
        </name>
        <article-title>Extracting transcription factor targets from ChIP-Seq data.</article-title>
        <source>Nucleic Acids Res</source>
        <year>2009</year>
        <volume>37</volume>
        <fpage>e113</fpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkp536</pub-id>
        <pub-id pub-id-type="pmid">19553195</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B9">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Ji</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>Jiang</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>Ma</surname>
          <given-names>W</given-names>
        </name>
        <name>
          <surname>Johnson</surname>
          <given-names>DS</given-names>
        </name>
        <name>
          <surname>Myers</surname>
          <given-names>RM</given-names>
        </name>
        <name>
          <surname>Wong</surname>
          <given-names>WH</given-names>
        </name>
        <article-title>An integrated software system for analyzing ChIP-chip and ChIP-seq data.</article-title>
        <source>Nat Biotechnol</source>
        <year>2008</year>
        <volume>26</volume>
        <fpage>1293</fpage>
        <lpage>1300</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.1505</pub-id>
        <pub-id pub-id-type="pmid">18978777</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B10">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Jothi</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Cuddapah</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Barski</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Cui</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Zhao</surname>
          <given-names>K</given-names>
        </name>
        <article-title>Genome-wide identification of in vivo protein-DNA binding sites from ChIP-Seq data.</article-title>
        <source>Nucleic Acids Res</source>
        <year>2008</year>
        <volume>36</volume>
        <fpage>5221</fpage>
        <lpage>5231</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkn488</pub-id>
        <pub-id pub-id-type="pmid">18684996</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B11">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Hu</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Yu</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Taylor</surname>
          <given-names>JM</given-names>
        </name>
        <name>
          <surname>Chinnaiyan</surname>
          <given-names>AM</given-names>
        </name>
        <name>
          <surname>Qin</surname>
          <given-names>ZS</given-names>
        </name>
        <article-title>On the detection and refinement of transcription factor binding sites using ChIP-Seq data.</article-title>
        <source>Nucleic Acids Res</source>
        <year>2010</year>
        <volume>38</volume>
        <fpage>2154</fpage>
        <lpage>2167</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkp1180</pub-id>
        <pub-id pub-id-type="pmid">20056654</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B12">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Blahnik</surname>
          <given-names>KR</given-names>
        </name>
        <name>
          <surname>Dou</surname>
          <given-names>L</given-names>
        </name>
        <name>
          <surname>O'Geen</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>McPhillips</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Xu</surname>
          <given-names>X</given-names>
        </name>
        <name>
          <surname>Cao</surname>
          <given-names>AR</given-names>
        </name>
        <name>
          <surname>Iyengar</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Nicolet</surname>
          <given-names>CM</given-names>
        </name>
        <name>
          <surname>Ludascher</surname>
          <given-names>B</given-names>
        </name>
        <name>
          <surname>Korf</surname>
          <given-names>I</given-names>
        </name>
        <name>
          <surname>Farnham</surname>
          <given-names>PJ</given-names>
        </name>
        <article-title>Sole-Search: an integrated analysis program for peak detection and functional annotation using ChIP-seq data.</article-title>
        <source>Nucleic Acids Res</source>
        <year>2010</year>
        <volume>38</volume>
        <fpage>e13</fpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkp1012</pub-id>
        <pub-id pub-id-type="pmid">19906703</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B13">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Wang</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Xu</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Zhang</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Wilson</surname>
          <given-names>ZA</given-names>
        </name>
        <article-title>An effective approach for identification of in vivo protein-DNA binding sites from paired-end ChIP-Seq data.</article-title>
        <source>BMC Bioinformatics</source>
        <year>2010</year>
        <volume>11</volume>
        <fpage>81</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-11-81</pub-id>
        <pub-id pub-id-type="pmid">20144209</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B14">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Kharchenko</surname>
          <given-names>PV</given-names>
        </name>
        <name>
          <surname>Tolstorukov</surname>
          <given-names>MY</given-names>
        </name>
        <name>
          <surname>Park</surname>
          <given-names>PJ</given-names>
        </name>
        <article-title>Design and analysis of ChIP-seq experiments for DNA-binding proteins.</article-title>
        <source>Nat Biotechnol</source>
        <year>2008</year>
        <volume>26</volume>
        <fpage>1351</fpage>
        <lpage>1359</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.1508</pub-id>
        <pub-id pub-id-type="pmid">19029915</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B15">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Lun</surname>
          <given-names>DS</given-names>
        </name>
        <name>
          <surname>Sherrid</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Weiner</surname>
          <given-names>B</given-names>
        </name>
        <name>
          <surname>Sherman</surname>
          <given-names>DR</given-names>
        </name>
        <name>
          <surname>Galagan</surname>
          <given-names>JE</given-names>
        </name>
        <article-title>A blind deconvolution approach to high-resolution mapping of transcription factor binding sites from ChIP-seq data.</article-title>
        <source>Genome Biol</source>
        <year>2009</year>
        <volume>10</volume>
        <fpage>R142</fpage>
        <pub-id pub-id-type="doi">10.1186/gb-2009-10-12-r142</pub-id>
        <pub-id pub-id-type="pmid">20028542</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B16">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Nix</surname>
          <given-names>DA</given-names>
        </name>
        <name>
          <surname>Courdy</surname>
          <given-names>SJ</given-names>
        </name>
        <name>
          <surname>Boucher</surname>
          <given-names>KM</given-names>
        </name>
        <article-title>Empirical methods for controlling false positives and estimating confidence in ChIP-Seq peaks.</article-title>
        <source>BMC Bioinformatics</source>
        <year>2008</year>
        <volume>9</volume>
        <fpage>523</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-9-523</pub-id>
        <pub-id pub-id-type="pmid">19061503</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B17">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Wilbanks</surname>
          <given-names>EG</given-names>
        </name>
        <name>
          <surname>Facciotti</surname>
          <given-names>MT</given-names>
        </name>
        <article-title>Evaluation of algorithm performance in ChIP-seq peak detection.</article-title>
        <source>PLoS One</source>
        <year>2010</year>
        <volume>5</volume>
        <fpage>e11471</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0011471</pub-id>
        <pub-id pub-id-type="pmid">20628599</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B18">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Zang</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Schones</surname>
          <given-names>DE</given-names>
        </name>
        <name>
          <surname>Zeng</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Cui</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Zhao</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Peng</surname>
          <given-names>W</given-names>
        </name>
        <article-title>A clustering approach for identification of enriched domains from histone modification ChIP-Seq data.</article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>25</volume>
        <fpage>1952</fpage>
        <lpage>1958</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btp340</pub-id>
        <pub-id pub-id-type="pmid">19505939</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B19">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Hon</surname>
          <given-names>G</given-names>
        </name>
        <name>
          <surname>Ren</surname>
          <given-names>B</given-names>
        </name>
        <name>
          <surname>Wang</surname>
          <given-names>W</given-names>
        </name>
        <article-title>ChromaSig: a probabilistic approach to finding common chromatin signatures in the human genome.</article-title>
        <source>PLoS Comput Biol</source>
        <year>2008</year>
        <volume>4</volume>
        <fpage>e1000201</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1000201</pub-id>
        <pub-id pub-id-type="pmid">18927605</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B20">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Xu</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>Handoko</surname>
          <given-names>L</given-names>
        </name>
        <name>
          <surname>Wei</surname>
          <given-names>X</given-names>
        </name>
        <name>
          <surname>Ye</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Sheng</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Wei</surname>
          <given-names>CL</given-names>
        </name>
        <name>
          <surname>Lin</surname>
          <given-names>F</given-names>
        </name>
        <name>
          <surname>Sung</surname>
          <given-names>WK</given-names>
        </name>
        <article-title>A signal-noise model for significance analysis of ChIP-seq with negative control.</article-title>
        <source>Bioinformatics</source>
        <year>2010</year>
        <volume>26</volume>
        <fpage>1199</fpage>
        <lpage>1204</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btq128</pub-id>
        <pub-id pub-id-type="pmid">20371496</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B21">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Liu</surname>
          <given-names>ET</given-names>
        </name>
        <name>
          <surname>Pott</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Huss</surname>
          <given-names>M</given-names>
        </name>
        <article-title>Q&amp;A: ChIP-seq technologies and the study of gene regulation.</article-title>
        <source>BMC Biol</source>
        <year>2010</year>
        <volume>8</volume>
        <fpage>56</fpage>
        <pub-id pub-id-type="doi">10.1186/1741-7007-8-56</pub-id>
        <pub-id pub-id-type="pmid">20529237</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B22">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Laajala</surname>
          <given-names>TD</given-names>
        </name>
        <name>
          <surname>Raghav</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Tuomela</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Lahesmaa</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Aittokallio</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Elo</surname>
          <given-names>LL</given-names>
        </name>
        <article-title>A practical comparison of methods for detecting transcription factor binding sites in ChIP-seq experiments.</article-title>
        <source>BMC Genomics</source>
        <year>2009</year>
        <volume>10</volume>
        <fpage>618</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2164-10-618</pub-id>
        <pub-id pub-id-type="pmid">20017957</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B23">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Hawkins</surname>
          <given-names>RD</given-names>
        </name>
        <name>
          <surname>Hon</surname>
          <given-names>GC</given-names>
        </name>
        <name>
          <surname>Ren</surname>
          <given-names>B</given-names>
        </name>
        <article-title>Next-generation genomics: an integrative approach.</article-title>
        <source>Nat Rev Genet</source>
        <year>2010</year>
        <volume>11</volume>
        <fpage>476</fpage>
        <lpage>486</lpage>
        <pub-id pub-id-type="pmid">20531367</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B24">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Dohm</surname>
          <given-names>JC</given-names>
        </name>
        <name>
          <surname>Lottaz</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Borodina</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Himmelbauer</surname>
          <given-names>H</given-names>
        </name>
        <article-title>Substantial biases in ultra-short read datasets from high-throughput DNA sequencing.</article-title>
        <source>Nucleic Acids Res</source>
        <year>2008</year>
        <volume>36</volume>
        <fpage>e105</fpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkn425</pub-id>
        <pub-id pub-id-type="pmid">18660515</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B25">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Hillier</surname>
          <given-names>LW</given-names>
        </name>
        <name>
          <surname>Marth</surname>
          <given-names>GT</given-names>
        </name>
        <name>
          <surname>Quinlan</surname>
          <given-names>AR</given-names>
        </name>
        <name>
          <surname>Dooling</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Fewell</surname>
          <given-names>G</given-names>
        </name>
        <name>
          <surname>Barnett</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Fox</surname>
          <given-names>P</given-names>
        </name>
        <name>
          <surname>Glasscock</surname>
          <given-names>JI</given-names>
        </name>
        <name>
          <surname>Hickenbotham</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Huang</surname>
          <given-names>W</given-names>
        </name>
        <name>
          <surname>Magrini</surname>
          <given-names>VJ</given-names>
        </name>
        <name>
          <surname>Richt</surname>
          <given-names>RJ</given-names>
        </name>
        <name>
          <surname>Sander</surname>
          <given-names>SN</given-names>
        </name>
        <name>
          <surname>Stewart</surname>
          <given-names>DA</given-names>
        </name>
        <name>
          <surname>Stromberg</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Tsung</surname>
          <given-names>EF</given-names>
        </name>
        <name>
          <surname>Wylie</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Schedl</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Wilson</surname>
          <given-names>RK</given-names>
        </name>
        <name>
          <surname>Mardis</surname>
          <given-names>ER</given-names>
        </name>
        <article-title>Whole-genome sequencing and variant discovery in <italic>C. elegans</italic>.</article-title>
        <source>Nat Methods</source>
        <year>2008</year>
        <volume>5</volume>
        <fpage>183</fpage>
        <lpage>188</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.1179</pub-id>
        <pub-id pub-id-type="pmid">18204455</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B26">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Quail</surname>
          <given-names>MA</given-names>
        </name>
        <name>
          <surname>Kozarewa</surname>
          <given-names>I</given-names>
        </name>
        <name>
          <surname>Smith</surname>
          <given-names>F</given-names>
        </name>
        <name>
          <surname>Scally</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Stephens</surname>
          <given-names>PJ</given-names>
        </name>
        <name>
          <surname>Durbin</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Swerdlow</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>Turner</surname>
          <given-names>DJ</given-names>
        </name>
        <article-title>A large genome center's improvements to the Illumina sequencing system.</article-title>
        <source>Nat Methods</source>
        <year>2008</year>
        <volume>5</volume>
        <fpage>1005</fpage>
        <lpage>1010</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.1270</pub-id>
        <pub-id pub-id-type="pmid">19034268</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B27">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Zhang</surname>
          <given-names>ZD</given-names>
        </name>
        <name>
          <surname>Rozowsky</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Snyder</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Chang</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Gerstein</surname>
          <given-names>M</given-names>
        </name>
        <article-title>Modeling ChIP sequencing <italic>in silico </italic>with applications.</article-title>
        <source>PLoS Comput Biol</source>
        <year>2008</year>
        <volume>4</volume>
        <fpage>e1000158</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1000158</pub-id>
        <pub-id pub-id-type="pmid">18725927</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B28">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Rozowsky</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Euskirchen</surname>
          <given-names>G</given-names>
        </name>
        <name>
          <surname>Auerbach</surname>
          <given-names>RK</given-names>
        </name>
        <name>
          <surname>Zhang</surname>
          <given-names>ZD</given-names>
        </name>
        <name>
          <surname>Gibson</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Bjornson</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Carriero</surname>
          <given-names>N</given-names>
        </name>
        <name>
          <surname>Snyder</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Gerstein</surname>
          <given-names>MB</given-names>
        </name>
        <article-title>PeakSeq enables systematic scoring of ChIP-seq experiments relative to controls.</article-title>
        <source>Nat Biotechnol</source>
        <year>2009</year>
        <volume>27</volume>
        <fpage>66</fpage>
        <lpage>75</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.1518</pub-id>
        <pub-id pub-id-type="pmid">19122651</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B29">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Dempster</surname>
          <given-names>AP</given-names>
        </name>
        <name>
          <surname>Laird</surname>
          <given-names>NM</given-names>
        </name>
        <name>
          <surname>Rubin</surname>
          <given-names>DB</given-names>
        </name>
        <article-title>Maximum likelihood from incomplete data via Em algorithm.</article-title>
        <source>J Roy Stat Soc B Met</source>
        <year>1977</year>
        <volume>39</volume>
        <fpage>1</fpage>
        <lpage>38</lpage>
      </mixed-citation>
    </ref>
    <ref id="B30">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Schwarz</surname>
          <given-names>G</given-names>
        </name>
        <article-title>Estimating the dimension of a model.</article-title>
        <source>Ann Stat</source>
        <year>1978</year>
        <volume>6</volume>
        <fpage>461</fpage>
        <lpage>464</lpage>
        <pub-id pub-id-type="doi">10.1214/aos/1176344136</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B31">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Birney</surname>
          <given-names>E</given-names>
        </name>
        <name>
          <surname>Stamatoyannopoulos</surname>
          <given-names>JA</given-names>
        </name>
        <name>
          <surname>Dutta</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Guigo</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Gingeras</surname>
          <given-names>TR</given-names>
        </name>
        <name>
          <surname>Margulies</surname>
          <given-names>EH</given-names>
        </name>
        <name>
          <surname>Weng</surname>
          <given-names>Z</given-names>
        </name>
        <name>
          <surname>Snyder</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Dermitzakis</surname>
          <given-names>ET</given-names>
        </name>
        <name>
          <surname>Thurman</surname>
          <given-names>RE</given-names>
        </name>
        <name>
          <surname>Kuehn</surname>
          <given-names>MS</given-names>
        </name>
        <name>
          <surname>Taylor</surname>
          <given-names>CM</given-names>
        </name>
        <name>
          <surname>Neph</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Koch</surname>
          <given-names>CM</given-names>
        </name>
        <name>
          <surname>Asthana</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Malhotra</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Adzhubei</surname>
          <given-names>I</given-names>
        </name>
        <name>
          <surname>Greenbaum</surname>
          <given-names>JA</given-names>
        </name>
        <name>
          <surname>Andrews</surname>
          <given-names>RM</given-names>
        </name>
        <name>
          <surname>Flicek</surname>
          <given-names>P</given-names>
        </name>
        <name>
          <surname>Boyle</surname>
          <given-names>PJ</given-names>
        </name>
        <name>
          <surname>Cao</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>Carter</surname>
          <given-names>NP</given-names>
        </name>
        <name>
          <surname>Clelland</surname>
          <given-names>GK</given-names>
        </name>
        <name>
          <surname>Davis</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Day</surname>
          <given-names>N</given-names>
        </name>
        <name>
          <surname>Dhami</surname>
          <given-names>P</given-names>
        </name>
        <name>
          <surname>Dillon</surname>
          <given-names>SC</given-names>
        </name>
        <name>
          <surname>Dorschner</surname>
          <given-names>MO</given-names>
        </name>
        <name>
          <surname>Fiegler</surname>
          <given-names>H</given-names>
        </name>
        <etal/>
        <article-title>Identification and analysis of functional elements in 1% of the human genome by the ENCODE pilot project.</article-title>
        <source>Nature</source>
        <year>2007</year>
        <volume>447</volume>
        <fpage>799</fpage>
        <lpage>816</lpage>
        <pub-id pub-id-type="doi">10.1038/nature05874</pub-id>
        <pub-id pub-id-type="pmid">17571346</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B32">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Rhead</surname>
          <given-names>B</given-names>
        </name>
        <name>
          <surname>Karolchik</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Kuhn</surname>
          <given-names>RM</given-names>
        </name>
        <name>
          <surname>Hinrichs</surname>
          <given-names>AS</given-names>
        </name>
        <name>
          <surname>Zweig</surname>
          <given-names>AS</given-names>
        </name>
        <name>
          <surname>Fujita</surname>
          <given-names>PA</given-names>
        </name>
        <name>
          <surname>Diekhans</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Smith</surname>
          <given-names>KE</given-names>
        </name>
        <name>
          <surname>Rosenbloom</surname>
          <given-names>KR</given-names>
        </name>
        <name>
          <surname>Raney</surname>
          <given-names>BJ</given-names>
        </name>
        <name>
          <surname>Pohl</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Pheasant</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Meyer</surname>
          <given-names>LR</given-names>
        </name>
        <name>
          <surname>Learned</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Hsu</surname>
          <given-names>F</given-names>
        </name>
        <name>
          <surname>Hillman-Jackson</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Harte</surname>
          <given-names>RA</given-names>
        </name>
        <name>
          <surname>Giardine</surname>
          <given-names>B</given-names>
        </name>
        <name>
          <surname>Dreszer</surname>
          <given-names>TR</given-names>
        </name>
        <name>
          <surname>Clawson</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>Barber</surname>
          <given-names>GP</given-names>
        </name>
        <name>
          <surname>Haussler</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Kent</surname>
          <given-names>WJ</given-names>
        </name>
        <article-title>The UCSC Genome Browser database: update 2010.</article-title>
        <source>Nucleic Acids Res</source>
        <year>2010</year>
        <volume>38</volume>
        <fpage>D613</fpage>
        <lpage>619</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkp939</pub-id>
        <pub-id pub-id-type="pmid">19906737</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B33">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Hampton</surname>
          <given-names>OA</given-names>
        </name>
        <name>
          <surname>Den Hollander</surname>
          <given-names>P</given-names>
        </name>
        <name>
          <surname>Miller</surname>
          <given-names>CA</given-names>
        </name>
        <name>
          <surname>Delgado</surname>
          <given-names>DA</given-names>
        </name>
        <name>
          <surname>Li</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Coarfa</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Harris</surname>
          <given-names>RA</given-names>
        </name>
        <name>
          <surname>Richards</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Scherer</surname>
          <given-names>SE</given-names>
        </name>
        <name>
          <surname>Muzny</surname>
          <given-names>DM</given-names>
        </name>
        <name>
          <surname>Gibbs</surname>
          <given-names>RA</given-names>
        </name>
        <name>
          <surname>Lee</surname>
          <given-names>AV</given-names>
        </name>
        <name>
          <surname>Milosavljevic</surname>
          <given-names>A</given-names>
        </name>
        <article-title>A sequence-level map of chromosomal breakpoints in the MCF-7 breast cancer cell line yields insights into the evolution of a cancer genome.</article-title>
        <source>Genome Res</source>
        <year>2009</year>
        <volume>19</volume>
        <fpage>167</fpage>
        <lpage>177</lpage>
        <pub-id pub-id-type="pmid">19056696</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B34">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Miller</surname>
          <given-names>CA</given-names>
        </name>
        <name>
          <surname>Hampton</surname>
          <given-names>O</given-names>
        </name>
        <name>
          <surname>Coarfa</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Milosavljevic</surname>
          <given-names>A</given-names>
        </name>
        <article-title>ReadDepth: a parallel R package for detecting copy number alterations from short sequencing reads.</article-title>
        <source>PLoS One</source>
        <year>2011</year>
        <volume>6</volume>
        <fpage>e16327</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0016327</pub-id>
        <pub-id pub-id-type="pmid">21305028</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B35">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Boyle</surname>
          <given-names>AP</given-names>
        </name>
        <name>
          <surname>Guinney</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Crawford</surname>
          <given-names>GE</given-names>
        </name>
        <name>
          <surname>Furey</surname>
          <given-names>TS</given-names>
        </name>
        <article-title>F-Seq: a feature density estimator for high-throughput sequence tags.</article-title>
        <source>Bioinformatics</source>
        <year>2008</year>
        <volume>24</volume>
        <fpage>2537</fpage>
        <lpage>2538</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btn480</pub-id>
        <pub-id pub-id-type="pmid">18784119</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B36">
      <mixed-citation publication-type="journal">
        <collab>ENCODE Project Consortium</collab>
        <name>
          <surname>Birney</surname>
          <given-names>E</given-names>
        </name>
        <name>
          <surname>Stamatoyannopoulos</surname>
          <given-names>JA</given-names>
        </name>
        <name>
          <surname>Dutta</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>GuigÃ³</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Gingeras</surname>
          <given-names>TR</given-names>
        </name>
        <name>
          <surname>Margulies</surname>
          <given-names>EH</given-names>
        </name>
        <name>
          <surname>Weng</surname>
          <given-names>Z</given-names>
        </name>
        <name>
          <surname>Snyder</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Dermitzakis</surname>
          <given-names>ET</given-names>
        </name>
        <name>
          <surname>Thurman</surname>
          <given-names>RE</given-names>
        </name>
        <name>
          <surname>Kuehn</surname>
          <given-names>MS</given-names>
        </name>
        <name>
          <surname>Taylor</surname>
          <given-names>CM</given-names>
        </name>
        <name>
          <surname>Neph</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Koch</surname>
          <given-names>CM</given-names>
        </name>
        <name>
          <surname>Asthana</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Malhotra</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Adzhubei</surname>
          <given-names>I</given-names>
        </name>
        <name>
          <surname>Greenbaum</surname>
          <given-names>JA</given-names>
        </name>
        <name>
          <surname>Andrews</surname>
          <given-names>RM</given-names>
        </name>
        <name>
          <surname>Flicek</surname>
          <given-names>P</given-names>
        </name>
        <name>
          <surname>Boyle</surname>
          <given-names>PJ</given-names>
        </name>
        <name>
          <surname>Cao</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>Carter</surname>
          <given-names>NP</given-names>
        </name>
        <name>
          <surname>Clelland</surname>
          <given-names>GK</given-names>
        </name>
        <name>
          <surname>Davis</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Day</surname>
          <given-names>N</given-names>
        </name>
        <name>
          <surname>Dhami</surname>
          <given-names>P</given-names>
        </name>
        <article-title>Identification and analysis of functional elements in 1% of the human genome by the ENCODE pilot project.</article-title>
        <source>Nature</source>
        <year>2007</year>
        <volume>447</volume>
        <fpage>799</fpage>
        <lpage>816</lpage>
        <pub-id pub-id-type="doi">10.1038/nature05874</pub-id>
        <pub-id pub-id-type="pmid">17571346</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B37">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Bailey</surname>
          <given-names>TL</given-names>
        </name>
        <name>
          <surname>Boden</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Buske</surname>
          <given-names>FA</given-names>
        </name>
        <name>
          <surname>Frith</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Grant</surname>
          <given-names>CE</given-names>
        </name>
        <name>
          <surname>Clementi</surname>
          <given-names>L</given-names>
        </name>
        <name>
          <surname>Ren</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Li</surname>
          <given-names>WW</given-names>
        </name>
        <name>
          <surname>Noble</surname>
          <given-names>WS</given-names>
        </name>
        <article-title>MEME SUITE: tools for motif discovery and searching.</article-title>
        <source>Nucleic Acids Res</source>
        <year>2009</year>
        <volume>37</volume>
        <fpage>W202</fpage>
        <lpage>208</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkp335</pub-id>
        <pub-id pub-id-type="pmid">19458158</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B38">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Wu</surname>
          <given-names>JQ</given-names>
        </name>
        <name>
          <surname>Snyder</surname>
          <given-names>M</given-names>
        </name>
        <article-title>RNA polymerase II stalling: loading at the start prepares genes for a sprint.</article-title>
        <source>Genome Biol</source>
        <year>2008</year>
        <volume>9</volume>
        <fpage>220</fpage>
        <pub-id pub-id-type="doi">10.1186/gb-2008-9-5-220</pub-id>
        <pub-id pub-id-type="pmid">18466645</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B39">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Zeitlinger</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Stark</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Kellis</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Hong</surname>
          <given-names>JW</given-names>
        </name>
        <name>
          <surname>Nechaev</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Adelman</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Levine</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Young</surname>
          <given-names>RA</given-names>
        </name>
        <article-title>RNA polymerase stalling at developmental control genes in the <italic>Drosophila melanogaster </italic>embryo.</article-title>
        <source>Nat Genet</source>
        <year>2007</year>
        <volume>39</volume>
        <fpage>1512</fpage>
        <lpage>1516</lpage>
        <pub-id pub-id-type="doi">10.1038/ng.2007.26</pub-id>
        <pub-id pub-id-type="pmid">17994019</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B40">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Giresi</surname>
          <given-names>PG</given-names>
        </name>
        <name>
          <surname>Kim</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>McDaniell</surname>
          <given-names>RM</given-names>
        </name>
        <name>
          <surname>Iyer</surname>
          <given-names>VR</given-names>
        </name>
        <name>
          <surname>Lieb</surname>
          <given-names>JD</given-names>
        </name>
        <article-title>FAIRE (formaldehyde-assisted isolation of regulatory elements) isolates active regulatory elements from human chromatin.</article-title>
        <source>Genome Res</source>
        <year>2007</year>
        <volume>17</volume>
        <fpage>877</fpage>
        <lpage>885</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.5533506</pub-id>
        <pub-id pub-id-type="pmid">17179217</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B41">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Rando</surname>
          <given-names>OJ</given-names>
        </name>
        <name>
          <surname>Chang</surname>
          <given-names>HY</given-names>
        </name>
        <article-title>Genome-wide views of chromatin structure.</article-title>
        <source>Annu Rev Biochem</source>
        <year>2009</year>
        <volume>78</volume>
        <fpage>245</fpage>
        <lpage>271</lpage>
        <pub-id pub-id-type="doi">10.1146/annurev.biochem.78.071107.134639</pub-id>
        <pub-id pub-id-type="pmid">19317649</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B42">
      <mixed-citation publication-type="book">
        <name>
          <surname>FrÃ¼hwirth-Schnatter</surname>
          <given-names>S</given-names>
        </name>
        <source>Finite Mixture and Markov Switching Models</source>
        <year>2006</year>
        <publisher-name>Springer Verlag</publisher-name>
      </mixed-citation>
    </ref>
    <ref id="B43">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Zeger</surname>
          <given-names>S</given-names>
        </name>
        <article-title>A regression model for time series of counts.</article-title>
        <source>Biometrika</source>
        <year>1988</year>
        <volume>75</volume>
        <fpage>621</fpage>
        <pub-id pub-id-type="doi">10.1093/biomet/75.4.621</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B44">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Davis</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Wu</surname>
          <given-names>R</given-names>
        </name>
        <article-title>A negative binomial model for time series of counts.</article-title>
        <source>Biometrika</source>
        <year>2009</year>
        <volume>96</volume>
        <fpage>735</fpage>
        <lpage>749</lpage>
        <pub-id pub-id-type="doi">10.1093/biomet/asp029</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B45">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Quinlan</surname>
          <given-names>AR</given-names>
        </name>
        <name>
          <surname>Hall</surname>
          <given-names>IM</given-names>
        </name>
        <article-title>BEDTools: a flexible suite of utilities for comparing genomic features.</article-title>
        <source>Bioinformatics</source>
        <year>2010</year>
        <volume>26</volume>
        <fpage>841</fpage>
        <lpage>842</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btq033</pub-id>
        <pub-id pub-id-type="pmid">20110278</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B46">
      <mixed-citation publication-type="other">
        <article-title>ZINBA.</article-title>
        <ext-link ext-link-type="uri" xlink:href="http://code.google.com/p/zinba/">http://code.google.com/p/zinba/</ext-link>
      </mixed-citation>
    </ref>
  </ref-list>
</back>
